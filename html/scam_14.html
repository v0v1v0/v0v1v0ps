<div class="container">

<table style="width: 100%;"><tr>
<td>marginal.matrices.tesmi2.ps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructs marginal model matrices for "tesmi2" and "tesmd2" bivariate smooths in case of B-splines basis functions 
for both unconstrained marginal smooths 
</h2>

<h3>Description</h3>

<p>This function returns the marginal model matrices and the list of penalty matrices
for the tensor product bivariate smooth with the single monotone increasing or decreasing restriction 
along the second covariate. The marginal smooth functions of both covariates are constructed using the 
B-spline basis functions. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginal.matrices.tesmi2.ps(x, z, xk, zk, m, q1, q2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of the values of the first covariate at which to evaluate the B-spline marginal functions.
The values in <code>x</code> must be between <code>xk[m[1]+2]</code> and
<code>xk[length(xk) - m[1] - 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric vector of the values of the second covariate at which to evaluate the B-spline marginal functions.
The values in <code>z</code> must be between <code>zk[m[2]+2]</code> and
<code>zk[length(zk) - m[2] - 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xk</code></td>
<td>
<p>A numeric vector of knot positions for the first covariate, <code>x</code>,  with non-decreasing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zk</code></td>
<td>
<p>A numeric vector of knot positions for the second covariate,<code>z</code>, with non-decreasing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A pair of two numbers where <code>m[i]+1</code> denotes the order of the basis of the <code class="reqn">i^{th}</code> marginal smooth
(e.g. <code>m[i] = 2</code> for a cubic spline.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>
<p>A number denoting the basis dimension of the first marginal smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>
<p>A number denoting the basis dimension of the second marginal smooth.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is not called directly, but is rather used internally by the constructor
</p>
<p><code>smooth.construct.tesmi2.smooth.spec</code> and 
<code>smooth.construct.tesmd2.smooth.spec</code> . 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>Marginal model matrix for the first unconstrained marginal smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>Marginal model matrix for the second monotonic marginal smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A list of penalty matrices for this tensor product smooth.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>
<p>Wood S.N. (2006) Generalized Additive Models: An Introduction with R. Chapman and Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>smooth.construct.tesmi1.smooth.spec</code>, 
<code>smooth.construct.tesmi2.smooth.spec</code>, 
</p>
<p><code>marginal.matrices.tesmi1.ps</code>,
<code>smooth.construct.tesmd1.smooth.spec</code>, 
</p>
<p><code>smooth.construct.tesmd2.smooth.spec</code>
</p>


</div>