<div class="container">

<table style="width: 100%;"><tr>
<td>lavTestWald.mi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wald Test for Multiple Imputations</h2>

<h3>Description</h3>

<p>Wald test for testing a linear hypothesis about the parameters of lavaan
models fitted to multiple imputed data sets. Statistics for constraining
one or more free parameters in a model can be calculated from the pooled
point estimates and asymptotic covariance matrix of model parameters
using Rubin's (1987) rules, or by pooling the Wald  test statistics
across imputed data sets (Li, Meng, Raghunathan, &amp; Rubin, 1991).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lavTestWald.mi(object, constraints = NULL, test = c("D1", "D2"),
  asymptotic = FALSE, scale.W = !asymptotic, omit.imps = c("no.conv",
  "no.se"), verbose = FALSE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>lavaan.mi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>A <code>character</code> string (typically between single
quotes) containing one or more equality constraints.
See examples for more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p><code>character</code> indicating which pooling method to use.
<code>"D1"</code> or <code>"Rubin"</code> (default) indicates Rubin's (1987) rules
will be applied to the point estimates and the asymptotic covariance
matrix of model parameters, and those pooled values will be used to
calculate the Wald test in the usual manner. <code>"D2"</code>, <code>"LMRR"</code>,
or <code>"Li.et.al"</code> indicate that the complete-data Wald test statistic
should be calculated using each imputed data set, which will then be
pooled across imputations, as described in Li, Meng, Raghunathan, &amp; Rubin
(1991) and Enders (2010, chapter 8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymptotic</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code> (default), the pooled test
will be returned as an <em>F</em>-distributed statistic with numerator
(<code>df1</code>) and denominator (<code>df2</code>) degrees of freedom.
If <code>TRUE</code>, the pooled <em>F</em> statistic will be multiplied by its
<code>df1</code> on the assumption that its <code>df2</code> is sufficiently large
enough that the statistic will be asymptotically <code class="reqn">\chi^2</code> distributed
with <code>df1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.W</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code>, the pooled
asymptotic covariance matrix of model parameters is calculated as the
weighted sum of the within-imputation and between-imputation components.
Otherwise, the pooled asymptotic covariance matrix of model parameters is
calculated by scaling the within-imputation component by the
average relative increase in variance (ARIV; see Enders, 2010, p. 235),
which is <em>only</em> consistent when requesting the <em>F</em> test (i.e.,
<code>asymptotic = FALSE</code>.  Ignored (irrelevant) if <code>test = "D2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.imps</code></td>
<td>
<p><code>character</code> vector specifying criteria for omitting
imputations from pooled results.  Can include any of
<code>c("no.conv", "no.se", "no.npd")</code>, the first 2 of which are the
default setting, which excludes any imputations that did not
converge or for which standard errors could not be computed.  The
last option (<code>"no.npd"</code>) would exclude any imputations which
yielded a nonpositive definite covariance matrix for observed or
latent variables, which would include any "improper solutions" such
as Heywood cases. Specific imputation numbers can also be included in this
argument, in case users want to  apply their own custom omission criteria
(or simulations can use different numbers of imputations without
redundantly refitting the model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, print the restriction
matrix and the estimated restricted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, print warnings if they occur.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The constraints are specified using the <code>"=="</code> operator.
Both the left-hand side and the right-hand side of the equality can contain
a linear combination of model parameters, or a constant (like zero).
The model parameters must be specified by their user-specified labels from
the <code>link[lavaan]{model.syntax}</code>. Names of defined parameters
(using the ":=" operator) can be included too.
</p>


<h3>Value</h3>

<p>A vector containing the Wald test statistic (either an <code>F</code> or
<code class="reqn">\chi^2</code> statistic, depending on the <code>asymptotic</code> argument),
the degrees of freedom (numerator and denominator, if
<code>asymptotic = FALSE</code>), and a <em>p</em> value. If
<code>asymptotic = FALSE</code>, the relative invrease in variance (RIV, or
average for multiparameter tests: ARIV) used to calculate the denominator
<em>df</em> is also returned as a missing-data diagnostic, along with the
fraction missing information (FMI = ARIV / (1 + ARIV)).
</p>


<h3>Author(s)</h3>

<p>Terrence D. Jorgensen (University of Amsterdam;
<a href="mailto:TJorgensen314@gmail.com">TJorgensen314@gmail.com</a>)
</p>
<p>Adapted from <span class="pkg">lavaan</span> source code, written by
Yves Rosseel (Ghent University; <a href="mailto:Yves.Rosseel@UGent.be">Yves.Rosseel@UGent.be</a>)
</p>


<h3>References</h3>

<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>.
New York, NY: Guilford.
</p>
<p>Li, K.-H., Meng, X.-L., Raghunathan, T. E., &amp; Rubin, D. B. (1991).
Significance levels from repeated <em>p</em>-values with multiply-imputed
data. <em>Statistica Sinica, 1</em>(1), 65â€“92. Retrieved from
<a href="https://www.jstor.org/stable/24303994">https://www.jstor.org/stable/24303994</a>
</p>
<p>Rubin, D. B. (1987). <em>Multiple imputation for nonresponse in surveys</em>.
New York, NY: Wiley.
</p>


<h3>See Also</h3>

<p><code>lavTestWald</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
## impose missing data for example
HSMiss &lt;- HolzingerSwineford1939[ , c(paste("x", 1:9, sep = ""),
                                      "ageyr","agemo","school")]
set.seed(12345)
HSMiss$x5 &lt;- ifelse(HSMiss$x5 &lt;= quantile(HSMiss$x5, .3), NA, HSMiss$x5)
age &lt;- HSMiss$ageyr + HSMiss$agemo/12
HSMiss$x9 &lt;- ifelse(age &lt;= quantile(age, .3), NA, HSMiss$x9)

## impute missing data
library(Amelia)
set.seed(12345)
HS.amelia &lt;- amelia(HSMiss, m = 20, noms = "school", p2s = FALSE)
imps &lt;- HS.amelia$imputations

## specify CFA model from lavaan's ?cfa help page
HS.model &lt;- '
  visual  =~ x1 + b1*x2 + x3
  textual =~ x4 + b2*x5 + x6
  speed   =~ x7 + b3*x8 + x9
'

fit &lt;- cfa.mi(HS.model, data = imps)

## Testing whether a single parameter equals zero yields the 'chi-square'
## version of the Wald z statistic from the summary() output, or the
## 'F' version of the t statistic from the summary() output, depending
## whether asymptotic = TRUE or FALSE
lavTestWald.mi(fit, constraints = "b1 == 0")      # default D1 statistic
lavTestWald.mi(fit, constraints = "b1 == 0", test = "D2") # D2 statistic

## The real advantage is simultaneously testing several equality
## constraints, or testing more complex constraints:
con &lt;- '
   2*b1 == b3
   b2 - b3 == 0
'
lavTestWald.mi(fit, constraints = con) # default F statistic
lavTestWald.mi(fit, constraints = con, asymptotic = TRUE) # chi-squared


## End(Not run)

</code></pre>


</div>