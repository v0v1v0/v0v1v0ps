<div class="container">

<table style="width: 100%;"><tr>
<td>SCOPRO</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SCOPRO</h2>

<h3>Description</h3>

<p>The mean expression profile of <em>marker_stages_filter</em> genes is computed for each cluster in the in vivo and in vitro dataset.
For a given cluster, a connectivity matrix is computed with number of rows and number of columns equal to the length of <em>marker_stages_filter</em>. Each entry (i,j)  in the matrix can be 1 if the fold_change between gene i and gene j is above <em>fold_change</em>. Otherwise is 0.
Finally the connectivity matrix of a given <em>name_vivo</em> stage and all the clusters in the in vitro dataset are compared.
A gene i is considered to be conserved between <em>name_vivo</em> and an in vitro cluster if the jaccard index of the links of gene i is above <em>threshold</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SCOPRO(
  norm_vitro,
  norm_vivo,
  cluster_vitro,
  cluster_vivo,
  name_vivo,
  marker_stages_filter,
  threshold = 0.1,
  number_link = 1,
  fold_change = 3,
  threshold_fold_change = 0.1,
  marker_stages,
  selected_stages
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>norm_vitro</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm_vivo</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells) for in vivo dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_vitro</code></td>
<td>
<p>cluster for in vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_vivo</code></td>
<td>
<p>cluster for in vivo dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_vivo</code></td>
<td>
<p>name of the in vivo stage on which SCOPRO is run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_stages_filter</code></td>
<td>
<p>output from the function <em>filter_in_vitro</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Numeric value. For a given gene, the jaccard index between the links from the in vivo and in vitro datasets is computed. If the jaccard index is above <em>threshold</em>, then the gene is considered to be conserved between the two datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_link</code></td>
<td>
<p>Numeric value. For a given gene in the in vivo dataset with links above <em>number_link</em>, the jaccard index between the links from in vitro and in vivo dataset is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold_change</code></td>
<td>
<p>Numeric value. For a given gene, the fold change between all the other genes is computed. If fold change is above <em>fold_change</em>, then there is a link with weight 1 between the two genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_fold_change</code></td>
<td>
<p>Numeric value. Above <em>threshold</em> the fold change between genes is computed. Below <em>threshold</em> the difference between genes is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_stages</code></td>
<td>
<p>Second element of the list given as output by the function <em>select_top_markers</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected_stages</code></td>
<td>
<p>In vivo stages for which the markers where computed with the function <em>select_top_markers</em></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with five elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>common_link</code></td>
<td>
<p>Vector with the names of the genes conserved between <em>name_vivo</em> and all the clusters in the vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_common_link</code></td>
<td>
<p>Vector with the names of the genes not conserved between <em>name_vivo</em> and  the clusters in the vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link_kept</code></td>
<td>
<p>List with the names of the genes conserved between <em>name_vivo</em> and each single cluster in the vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link_no_kept</code></td>
<td>
<p>List with the names of the genes not conserved between <em>name_vivo</em> and each single cluster in the vitro dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_score</code></td>
<td>
<p>Numeric value, given by the fraction of conserved markers of <em>name_vivo</em> and each single cluster in the in vitro dataset</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">load(system.file("extdata", "norm_es_vitro_small.Rda", package = "SCOPRO"))
n_es= norm_es_vitro_small
load(system.file("extdata", "norm_vivo_small.Rda", package = "SCOPRO"))
n_v = norm_vivo_small
load(system.file("extdata", "cluster_es_vitro_small.Rda", package = "SCOPRO"))
c_es=cluster_es_vitro_small
load(system.file("extdata", "cluster_vivo_small.Rda", package = "SCOPRO"))
c_v=cluster_vivo_small
load(system.file("extdata", "marker_stages_filter.Rda", package = "SCOPRO"))
m_s_f = marker_stages_filter
load(system.file("extdata", "marker_stages.Rda", package = "SCOPRO"))
m_s = marker_stages
stages = c("Late_2_cell","epiblast_4.5","epiblast_5.5","epiblast_6.5")
output_SCOPRO = SCOPRO(n_es,n_v,c_es,c_v,"Late_2_cell",m_s_f,0.1,1,3,0.1,m_s,stages)
plot_score(output_SCOPRO,m_s,m_s_f,stages,"Late_2_cell","Score","Cluster","2-cells")


</code></pre>


</div>