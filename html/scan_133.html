<div class="container">

<table style="width: 100%;"><tr>
<td>rand_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomization Tests for single-case data</h2>

<h3>Description</h3>

<p>The <code>rand_test</code> function computes a randomization test for single or multiple
baseline single-case data.  The function is based on an algorithm from the
<code>SCRT</code> package (Bulte &amp; Onghena, 2009, 2012), but rewritten and extended for
the use in AB designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rand_test(
  data,
  dvar,
  pvar,
  statistic = c("Mean B-A", "Mean A-B", "Median B-A", "Median A-B", "Mean |A-B|",
    "Median |A-B|", "SMD hedges", "SMD glass", "W-test", "T-test", "NAP",
    "NAP decreasing", "Slope B-A", "Slope A-B"),
  number = 500,
  complete = FALSE,
  limit = 5,
  startpoints = NA,
  exclude.equal = FALSE,
  phases = c(1, 2),
  graph = FALSE,
  output = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A single-case data frame. See <code>scdf()</code> to learn about this
format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dvar</code></td>
<td>
<p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvar</code></td>
<td>
<p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Defines the statistic on which the comparison of phases A
and B is based on. Default setting is <code>statistic = "Mean B-A"</code>. The
following comparisons are possible: </p>
 <ul>
<li>
<p><code style="white-space: pre;">⁠Mean A-B⁠</code>: Uses
the difference between the mean of phase A and the mean of phase B. This is
appropriate if a decrease of scores was expected for phase B.
</p>
</li>
<li>
<p><code style="white-space: pre;">⁠Mean B-A⁠</code>: Uses the difference between the mean of phase B and
the mean of phase A. This is appropriate if an increase of scores was
expected for phase B.  </p>
</li>
<li>
<p><code style="white-space: pre;">⁠Mean |A-B|⁠</code>: Uses the absolute value of
the difference between the means of phases A and B.  </p>
</li>
<li>
<p><code style="white-space: pre;">⁠Median A-B⁠</code>: The same as <code style="white-space: pre;">⁠Mean A-B⁠</code>, but based on the median.
</p>
</li>
<li>
<p><code style="white-space: pre;">⁠Median B-A⁠</code>: The same as <code style="white-space: pre;">⁠Mean B-A⁠</code>, but based on the
median.  </p>
</li>
<li>
<p><code style="white-space: pre;">⁠SMD hedges / SMD glass⁠</code>: Standardizes mean difference of B-A
as Hedges's g or Glass' delta. </p>
</li>
<li>
<p><code>NAP</code>: Non-overlap of all pairs.
</p>
</li>
<li>
<p><code>W-test</code>: Wilcoxon-test statistic W.</p>
</li>
<li>
<p><code>T-test</code>: T-test statistic t.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>Sample size of the randomization distribution. The exactness of
the p-value can not exceed <code class="reqn">1/number</code> (i.e., <code>number = 100</code> results in
p-values with an exactness of one percent). Default is <code>number = 500</code>. For
faster processing use <code>number = 100</code>. For more precise p-values set <code>number = 1000</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>If TRUE, the distribution is based on a complete permutation
of all possible starting combinations. This setting overwrites the number
Argument. The default setting is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>Minimal number of data points per phase in the sample. The first
number refers to the A-phase and the second to the B-phase (e.g., <code>limit = c(5,3)</code>). If only one number is given, this number is applied to both
phases. Default is <code>limit = 5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoints</code></td>
<td>
<p>Alternative to the <code>limit</code>-parameter <code>startpoints</code> exactly
defines the possible start points of phase B (e.g., <code>startpoints = 4:9</code>
restricts the phase B start points to measurements 4 to 9. <code>startpoints</code>
overruns the <code>limit</code>-parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.equal</code></td>
<td>
<p>If set to <code>exclude.equal = FALSE</code>, which is the
default, random distribution values equal to the observed distribution are
counted as null-hypothesis conform. That is, they decrease the probability
of rejecting the null-hypothesis (increase the p-value).
<code>exclude.equal</code> should be set to <code>TRUE</code> if you analyse one single-case
design (not a multiple baseline data set) to reach a sufficient power. But
be aware, that it increases the chance of an alpha-error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phases</code></td>
<td>
<p>A vector of two characters or numbers indicating the two phases
that should be compared. E.g., <code>phases = c("A","C")</code> or <code>phases = c(2,4)</code>
for comparing the second to the fourth phase. Phases could be combined by
providing a list with two elements. E.g., <code>phases = list(A = c(1,3), B = c(2,4))</code> will compare phases 1 and 3 (as A) against 2 and 4 (as B). Default
is <code>phases = c(1,2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>If <code>graph = TRUE</code>, a histogram of the resulting distribution is
plotted. It is <code>FALSE</code> by default. <em>Note: use the more versatile
<code>plot_rand()</code> function instead.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>(deprecated and not implemented)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed number for the random generator.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Character string from function call (see
<code>Arguments</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of single-cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>Number of data points in phase A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>Number of data
points in phase B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>Numeric from function call (see
<code>Arguments</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoints</code></td>
<td>
<p>A vector defining the start points passed from the
function call (see <code>Arguments</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value of the
randomization test for the given data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>Sample size of
randomization distribution from function call (see <code>Arguments</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>Logical argument from function call (see <code>Arguments</code>
above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.statistic</code></td>
<td>
<p>Test statistic observed for the given
single-case data. (see <code>statistic</code> in the <code>Arguments</code> above.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Z-value of observed test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.z.single</code></td>
<td>
<p>Probability
of z-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>Test statistic distribution from randomized
data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>possible.combinations</code></td>
<td>
<p>Number of possible combinations
under the given restrictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto.corrected.number</code></td>
<td>
<p><code>TRUE</code>
indicates that a corrected number of combinations was used. This happens, if
the number of possible combinations (under the given restrictions) undercuts
the requested <code>number</code> of combinations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecxlude.equal</code></td>
<td>
<p>see argument
above</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juergen Wilbert
</p>


<h3>References</h3>

<p>Bulte, I., &amp; Onghena, P. (2009). Randomization tests for
multiple-baseline designs: An extension of the SCRT-R package.
<em>Behavior Research Methods, 41</em>, 477-485.
</p>
<p>Bulte, I., &amp; Onghena, P. (2012). <em>SCRT: Single-Case Randomization Tests</em>.
Available from: <a href="https://CRAN.R-project.org/package=SCRT">https://CRAN.R-project.org/package=SCRT</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compute a randomization test on the first case of the byHeart2011 data and include a graph
rand_test(byHeart2011[1], statistic = "Median B-A", graph = TRUE, seed = 123)

## Compute a randomization test on the Grosche2011 data using complete permutation
rand_test(Grosche2011, statistic = "Median B-A", complete = TRUE, limit = 4, seed = 123)

</code></pre>


</div>