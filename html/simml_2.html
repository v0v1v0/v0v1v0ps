<div class="container">

<table style="width: 100%;"><tr>
<td>fit.simml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Single-index models with multiple-links (workhorse function)</h2>

<h3>Description</h3>

<p><code>fit.simml</code> is the workhorse function for Single-index models with multiple-links (SIMML).
The function estimates a linear combination (a single-index) of covariates X, and models the treatment-specific outcome y, via treatment-specific nonparametrically-defined link functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.simml(y, A, X, Xm = NULL, aug = NULL, rho = 0,
  family = "gaussian", R = NULL, bs = "ps", k = 8, sp = NULL,
  linear.link = FALSE, method = "GCV.Cp", gamma = 1, max.iter = 20,
  eps.iter = 0.01, trace.iter = TRUE, ind.to.be.positive = NULL,
  scale.si.01 = FALSE, lambda = 0, pen.order = 0, scale.X = TRUE,
  center.X = TRUE, ortho.constr = TRUE, beta.ini = NULL,
  si.main.effect = FALSE, random.effect = FALSE, z = NULL,
  plots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a n-by-1 vector of treatment outcomes; y is a member of the exponential family; any distribution supported by <code>mgcv::gam</code>; y can also be an ordinal categorial response with <code>R</code> categories taking a value from 1 to <code>R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a n-by-1 vector of treatment variable; each element is assumed to take a value on a continuum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a n-by-p matrix of baseline covarates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xm</code></td>
<td>
<p>a n-by-q design matrix associated with an X main effect model; the defult is <code>NULL</code> and it is taken as a vector of zeros</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aug</code></td>
<td>
<p>a n-by-1 additional augmentation vector associated with the X main effect; the default is <code>NULL</code> and it is taken as a vector of zeros</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a tuning parameter associated with the additional augmentation vector <code>aug</code>; the default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>specifies the distribution of y; e.g., "gaussian", "binomial", "poisson"; can be any family supported by <code>mgcv::gam</code>; can also be "ordinal", for an ordinal categorical response y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the number of response categories for the case of family = "ordinal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>basis type for the treatment (A) and single-index domains, respectively; the defult is "ps" (p-splines); any basis supported by <code>mgcv::gam</code> can be used, e.g., "cr" (cubic regression splines); see <code>mgcv::s</code> for detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>basis dimension for the treatment (A) and single-index domains, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>smoothing paramter for the treatment-specific link functions; if <code>NULL</code>, then estimated from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.link</code></td>
<td>
<p>if <code>TRUE</code>, the link function is restricted to be linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the smoothing parameter estimation method; "GCV.Cp" to use GCV for unknown scale parameter and Mallows' Cp/UBRE/AIC for known scale; any method supported by <code>mgcv::gam</code> can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>increase this beyond 1 to produce smoother models. <code>gamma</code> multiplies the effective degrees of freedom in the GCV or UBRE/AIC (see <code>mgcv::gam</code> for detail); the default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>an integer specifying the maximum number of iterations for <code>beta.coef</code> update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.iter</code></td>
<td>
<p>a value specifying the convergence criterion of algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.iter</code></td>
<td>
<p>if <code>TRUE</code>, trace the estimation process and print the differences in <code>beta.coef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.to.be.positive</code></td>
<td>
<p>for identifiability of the solution <code>beta.coef</code>, the user can restrict the jth (e.g., j=1) component of <code>beta.coef</code> to be positive; by default, we match the "overall" sign of <code>beta.coef</code> with that of the linear estimate (i.e., the initial estimate), by restricting the inner product between the two to be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.si.01</code></td>
<td>
<p>if <code>TRUE</code>, re-scale the index coefficients to restrict the index to the interval [0,1]; in such a case, an intercept term is induced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a regularization parameter associated with the penalized LS for <code>beta.coef</code> update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.order</code></td>
<td>
<p>0 indicates the ridge penalty; 1 indicates the 1st difference penalty; 2 indicates the 2nd difference penalty, used in a penalized least squares (LS) estimation of <code>beta.coef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.X</code></td>
<td>
<p>if <code>TRUE</code>, scale X to have unit variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.X</code></td>
<td>
<p>if <code>TRUE</code>, center X to have zero mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho.constr</code></td>
<td>
<p>separates the interaction effects from the main effect (without this, the interaction effect can be confounded by the main effect; the default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.ini</code></td>
<td>
<p>an initial value for <code>beta.coef</code>; a p-by-1 vector; the defult is <code>NULL</code>, in which case a linear model estimate is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si.main.effect</code></td>
<td>
<p>if <code>TRUE</code>, once the convergence in the estimates of <code>beta.coef</code> is reached, include the main effect associated with the fitted single-index (beta.coef'X) to the final fit; the default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effect</code></td>
<td>
<p>if <code>TRUE</code>, as part of the main effects, the user can incorporate z-specific random intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a factor that specifies the random intercepts when <code>random.effect = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>if <code>TRUE</code>, produce a plot for the estimated effect contrast (for binary treatment cases) (on a linear predictor scale).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SIMML captures the effect of covariates via a single-index and their interaction with the treatment via nonparametric link functions.
Interaction effects are determined by distinct shapes of the link functions.
The estimated single-index is useful for comparing differential treatment efficacy.
The resulting <code>simml</code> object can be used to estimate an optimal treatment decision rule
for a new patient with pretreatment clinical information.
</p>


<h3>Value</h3>

<p>a list of information of the fitted SIMML including
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta.coef</code></td>
<td>
<p> the estimated single-index coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.fit</code></td>
<td>
<p>a <code>mgcv:gam</code> object containing information about the estimated treatment-specific link functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.ini</code></td>
<td>
<p>the initial value used in the estimation of <code>beta.coef</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.path</code></td>
<td>
<p>solution path of <code>beta.coef</code> over the iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.beta</code></td>
<td>
<p>records the change in <code>beta.coef</code> over the solution path, <code>beta.path</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.X</code></td>
<td>
<p>sd of pretreatment covariates X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.X</code></td>
<td>
<p>mean of pretreatment covariates X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of different treatment options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of pretreatment covariates X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.ci</code></td>
<td>
<p>(1-boot.alpha/2) percentile bootstrap CIs (LB, UB) associated with <code>beta.coef</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Park, Petkova, Tarpey, Ogden
</p>


<h3>See Also</h3>

<p><code>pred.simml</code>,  <code>simml</code>
</p>


</div>