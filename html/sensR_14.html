<div class="container">

<table style="width: 100%;"><tr>
<td>discrimPwr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensory discrimination power analysis</h2>

<h3>Description</h3>

<p>Computes the power of a difference or similarity test for a sensory
discrimination experiment using the binomial distribution.
<code>d.primePwr</code> is a convenience function that calls
<code>discrimPwr</code> but has arguments in terms of d-prime rather than
pd, the probability of discrimination.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discrimPwr(pdA, pd0 = 0, sample.size, alpha = 0.05, pGuess = 1/2,
           test = c("difference", "similarity"),
           statistic = c("exact", "normal", "cont.normal"))

d.primePwr(d.primeA, d.prime0 = 0, sample.size, alpha = 0.05,
           method = c("duotrio", "tetrad", "threeAFC", "twoAFC",
             "triangle", "hexad", "twofive", "twofiveF"),
           double = FALSE,
           test = c("difference", "similarity"),
           statistic = c("exact", "normal", "cont.normal"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdA</code></td>
<td>
<p>the probability of discrimination for the model under the
alternative hypothesis; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.primeA</code></td>
<td>
<p>d-prime for the model under the
alternative hypothesis; non-negative numerical scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd0</code></td>
<td>
<p>the probability of discrimination under the
null hypothesis; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.prime0</code></td>
<td>
<p>d-prime under the null hypothesis; non-negative
numerical scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>the sample size; a scalar positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the type I level of the test; scalar between zero and
one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the discrimination protocol for which the power should
be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>double</code></td>
<td>
<p>should the 'double' variant of the discrimination protocol
be used? Logical scalar. Currently not implemented for "twofive",
"twofiveF", and "hexad".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pGuess</code></td>
<td>
<p>the guessing probability for the discrimination
protocol, e.g. 1/2 for duo-trio and 2-AFC, 1/3 for
triangle, tetrad and 3-AFC, 1/10 for two-out-of-five and hexad
and 2/5 for two-out-of-five with forgiveness; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the type of one-sided binomial test (direction of the
alternative hypothesis): "difference" corresponds "greater" and
"similarity" corresponds to "less"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>should power determination be based on the 'exact'
binomial test, the normal approximation to this, or the
normal approximation with continuity correction?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power of the standard one-tailed difference test where the null
hypothesis is "no difference" is obtained with <code>pd0 = 0</code>.
</p>
<p>The probability under the null hypothesis is
given by <code>pd0 + pg * (1 - pd0)</code> where <code>pg</code> is the guessing
probability <code>pGuess</code>. Similarly, the probability of the
alternative hypothesis is given by <code>pdA + pg * (1 - pdA)</code>
</p>


<h3>Value</h3>

<p>The power; a numerical scalar.
</p>


<h3>Author(s)</h3>

<p>Rune Haubo B Christensen and Per Bruun Brockhoff</p>


<h3>References</h3>

<p>Brockhoff, P.B. and Christensen, R.H.B (2010). Thurstonian
models for sensory discrimination tests as generalized linear models.
Food Quality and Preference, 21, pp. 330-338.
</p>
<p>Bi, J. (2001) The double discrimination methods. Food Quality and
Preference, 12, pp. 507-513.
</p>


<h3>See Also</h3>

<p><code>findcr</code>,
<code>discrim</code>, <code>discrimSim</code>,
<code>AnotA</code>, <code>discrimSS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Finding the power of a discrimination test with d-prime = 1,
## a sample of size 30 and a type I level of .05:
pd &lt;- coef(rescale(d.prime = 1, method = "twoAFC"))$pd
discrimPwr(pd, sample.size = 30)
d.primePwr(1, sample.size = 30, method = "twoAFC")
## Obtaining the equivalent normal approximation with and without
## continuity correction:
discrimPwr(pd, sample.size = 30, statistic = "cont.normal")
discrimPwr(pd, sample.size = 30, statistic = "normal")

# Example from Bi (2001) with n=100 and 35 correct answers in a 
# double duotrio test:
p1 &lt;- 0.35
# Estimate of d-prime quoted by Bi(2001) was 1.06:
dp &lt;- psyinv(p1, method="duotrio", double=TRUE) 
# Power using normal approximation w/o continuity adjustment quoted by Bi(2001):
d.primePwr(dp, sample.size = 100, method="duotrio", 
           double=TRUE, stat="normal") # 0.73
# d.primePwr(dp, sample.size = 100, method="duotrio", double=TRUE, 
#            stat="cont.normal")

# Power of exact test:
d.primePwr(dp, sample.size = 100, method="duotrio", 
           double=TRUE, stat="exact") # 0.697

## A similarity example:
discrimPwr(pdA = 0.1, pd0 = 0.2, sample.size = 100, pGuess = 1/3,
           test = "similarity")


</code></pre>


</div>