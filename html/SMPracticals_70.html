<div class="container">

<table style="width: 100%;"><tr>
<td>poi.beta.laplace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Laplace Approximation for Posterior Density, Practical 11.2</h2>

<h3>Description</h3>

<p>This function computes the Laplace approximation to the posterior density
of the parameter beta in a Poisson regression model.  For more details see
Practical 11.2 of Davison (2003).
</p>


<h3>Usage</h3>

<pre><code class="language-R">poi.beta.laplace(data, alpha = get.alpha(data), phi = 1, nu = 0.1, 
                 beta = seq(from = 0, to = 7, length = 1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with vector components <code>y</code> and <code>x</code> of the same length.  
<code>y</code> contains the numbers of counts, and <code>x</code> the corresponding time intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Prior value of a parameter, estimated from the data by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Prior value of a parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> Prior value of a parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Values for which posterior density of beta should be provided. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is provided simply so that  readers spend less time typing. It is not intended to be
robust and general code.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>int </code></td>
<td>
<p>Estimated integral of posterior density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv </code></td>
<td>
<p>Did the routine for the Laplace optimization converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Values of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Values of posterior density</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anthony Davison (<code>anthony.davison@epfl.ch</code>)</p>


<h3>References</h3>

<p>Davison, A. C. (2003)  <em>Statistical Models</em>.  
Cambridge University Press. Practical 11.2.</p>


<h3>Examples</h3>

<pre><code class="language-R">## From Practical 11.2:
get.alpha &lt;- function(d)
{  # estimate alpha from data
  rho &lt;- d$y/d$x
  n &lt;- length(d$y)
  mean(rho)^2/( (n-1)*var(rho)/n - mean(rho)*mean(1/d$x) )
}
data(cloth)
attach(cloth)
plot(x,y)
beta &lt;- seq(from=0,to=10,length=1000)
beta.post &lt;- poi.beta.laplace(cloth,beta=beta,nu=1)
plot(beta.post,type="l",xlab="beta",ylab="Posterior density")
beta.post &lt;- poi.beta.laplace(cloth,beta=beta,nu=5)
lines(beta.post,lty=2)
</code></pre>


</div>