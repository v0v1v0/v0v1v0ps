<div class="container">

<table style="width: 100%;"><tr>
<td>Johnson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Johnson distributions</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, random generator and summary function for the Johnson distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dJohnson(x, parms, log=FALSE)
pJohnson(q, parms, lower.tail=TRUE, log.p=FALSE)
qJohnson(p, parms, lower.tail=TRUE, log.p=FALSE)
rJohnson(n, parms)
sJohnson(parms)
JohnsonFit(t,moment="quant") 
moments(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>vector of quantities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>observation vector, t=x, or moment vector, t=[mean,m2,m3,m4]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of numbers of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>list or list of lists each containing output of JohnsonFit()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment</code></td>
<td>
<p>character scalar specifying t: "quant" (default), or "use," or "find"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical vector; if TRUE, probabilities p are given as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical vector; if TRUE (default), probabilities are <code class="reqn">P[X &lt;= x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Johnson system (Johnson 1949) is a very flexible system for describing statistical distributions. It is defined by
</p>
<p style="text-align: center;"><code class="reqn">z=\gamma+\delta \log{f(u)}, u=(x-\xi)/\lambda</code>
</p>

<p>and where <code class="reqn">f( )</code> has four possible forms:
</p>

<table>
<tr>
<td style="text-align: left;">
	SL:</td>
<td style="text-align: left;"> <code class="reqn">f(u)=u</code> the log normal </td>
</tr>
<tr>
<td style="text-align: left;">
	SU:</td>
<td style="text-align: left;"> <code class="reqn">f(u)=u+\sqrt{1+u^2}</code> an unbounded distribution</td>
</tr>
<tr>
<td style="text-align: left;">
	SB:</td>
<td style="text-align: left;"> <code class="reqn">f(u)=u/(1-u)</code> a bounded distribution</td>
</tr>
<tr>
<td style="text-align: left;">
	SN:</td>
<td style="text-align: left;"> <code class="reqn">\exp(u)</code> the normal
</td>
</tr>
</table>
<p>Estimation of the Johnson parameters may be done from quantiles. The procedure of Wheeler (1980) is used.
</p>
<p>They may also be estimated from the moments.  Applied Statistics algorithm 99, due to Hill, Hill, and Holder (1976) has been translated into C for this implementation.  
</p>


<h3>Value</h3>

<p>The output values conform to the output from other such functions in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. <code>dJohnson()</code> gives the density, <code>pJohnson()</code> the distribution function and <code>qJohnson()</code> its inverse. <code>rJohnson()</code> generates random numbers. <code>sJohnson()</code> produces a list containing parameters corresponding to the arguments â€“ mean, median, mode, variance, sd, third cental moment, fourth central moment, Pearson's skewness, skewness, and kurtosis.
<br><code>moments()</code> calculates the moment statistics of x as a vector with elements (mu, sigma, skew, kurt), where mu is the mean of x, sigma the SD of x with divisor <code>length(x)</code>, skew is the skewness and kurt the kurtosis. 
<br><code>JohnsonFit()</code> outputs a list containing the Johnson parameters (gamma, delta, xi, lambda, type), where type is one of the Johnson types: "SN", "SL", "SB", or "SU". <code>JohnsonFit()</code> does this using 5 order statistics when moment="quant", when moment="find" it does this by using the first four moments of t calculated by the function <code>moments()</code>, when moment="use" it assumes that the vector t is [mean,m2,m3,m4], where mi is the ith moment about the mean. 
<br>
Fitting by moments is difficult numerically and often <code>JohnsonFit()</code> will report an error.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler 
</p>


<h3>References</h3>

<p>Hill, I.D., Hill, R., and Holder, R.L. (1976). Fitting Johnson curves by moments. <em>Applied Statistics.</em> AS99.
</p>
<p>Johnson, N.L. (1949). Systems of frequency curves generated by methods of translation. <em>Biometrika,</em> <b>36.</b> 149-176.
</p>
<p>Wheeler, R.E. (1980). Quantile estimators of Johnson curve parameters. <em>Biometrika.</em> <b>67-3</b> 725-728
</p>


<h3>Examples</h3>

<pre><code class="language-R">
xx&lt;-rnorm(500)
parms&lt;-JohnsonFit(xx)
sJohnson(parms)
plot(function(xx)dJohnson(xx,parms),-2,2)
pJohnson(1,parms)
parms2&lt;-JohnsonFit(rexp(50))
qJohnson(p=0.5,list(parms,parms2))

## JohnsonFit with moment="find" and moment="use" is not always possible,
## and even when possible, may produce odd results.
## parms&lt;-JohnsonFit(x,moment="find")

parms&lt;-JohnsonFit(c(0,1,-.5,4),moment="use")

sJohnson(parms) 

# Fit illustration
data(cars)
xx&lt;-cars$speed
parms&lt;-JohnsonFit(xx)
hist(xx,freq=FALSE)
plot(function(x)dJohnson(x,parms),0,25,add=TRUE)


</code></pre>


</div>