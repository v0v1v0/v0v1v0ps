<div class="container">

<table style="width: 100%;"><tr>
<td>scMANOVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate ANalysis Of VAriance Inference and Test with Ridge Regularization for Semicontinuous High-Dimensional Data
</h2>

<h3>Description</h3>

<p><code>scMANOVA</code> performs Multivariate ANalysis Of VAriance (MANOVA) inference and test with ridge regularization in presence of 
semicontinuous high-dimensional data. The test is based on a Likelihood Ratio Test statistic 
and the p-value can be computed using either asymptotic distribution (<code>p.value.perm = FALSE</code>) 
or via permutation procedure (<code>p.value.perm = TRUE</code>). There is the possibility to provide 
as input the regularization parameters or to choose them through an optimization procedure. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">scMANOVA(x, n, lambda = NULL, lambda0 = NULL, lambda.step = 0.1,
  ident = FALSE, tol = 1e-08, penalty = function(n, p) log(n),
  B = 500, p.value.perm = FALSE, fixed.lambda = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code> or <code>matrix</code> of data with units on the rows and variables on the columns 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p><code>vector</code>. The length corresponds to the number of groups, the elements to the number of observations in each group  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p><code>NULL</code>, a scalar or a <code>vector</code> of length 2. Ridge regularization parameter. The optimal value of <code>lambda</code> is searched in the interval [0,100] if <code>NULL</code>, and in the specified interval when it is a vector of length 2, otherwise it is used as the optimal value 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p><code>NULL</code>, a scalar or a <code>vector</code> of length 2. Ridge regularization parameter under null hypothesis. The optimal value of <code>lambda0</code> is searched in the interval [0,100] if <code>NULL</code>, and in the specified interval when it is a vector of length 2, otherwise it is used as the optimal value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.step</code></td>
<td>
<p>scalar. Step size used in the optimization procedure to find the smallest value of <code>lambda</code> (and <code>lambda0</code>) that makes the covariance matrices, under the alternative and under the null hypotheses, non singular
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ident</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, <code>lambda</code> times the identity matrix is added to the raw estimated covariance matrix, if <code>FALSE</code> the diagonal values of the raw estimated covariance matrix are used instead
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>scalar. Used in the optimization procedure to find the smallest value of <code>lambda</code> (and <code>lambda0</code>) that makes the covariance matrices, under the alternative and under the null, non singular 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p><code>function</code> with two arguments: sample size (<code>n</code>) and number of variables (<code>p</code>) used as penalty function in the definition of the Information Criterion to select the optimal values for <code>lambda</code> and <code>lambda0</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>scalar. Number of permutations to run in the permutation test 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.perm</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> a p-value from a permutation test is evaluated, otherwise an asymptotic value is reported
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.lambda</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> the optimal values for <code>lambda</code> and <code>lambda0</code> are evaluated just once for the observed dataset and kept fixed during the permutation test, otherwise, optimal values are evaluated for each permuted datsets
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to function <code>scMANOVApermTest</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>class</code> scMANOVA which is a list with the following components  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p><code>matrix</code>. Estimated proportion of missing values for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p><code>matrix</code>. Estimated mean vector for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaRidge</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix with ridge regularization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix by maximum likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p><code>vector</code>. Estimated proportion of missing values under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p><code>vector</code>. Estimated mean vector under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0Ridge</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix with ridge regularization under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix by maximum likelihood under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removed.vars</code></td>
<td>
<p><code>vector</code> or <code>NULL</code>. columns removed in the continuous part of the log-likelihood dues to insufficient number of observations in each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikPi</code></td>
<td>
<p>scalar. Log-likelihood for the discrete part of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>scalar. Log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikPi0</code></td>
<td>
<p>scalar. Log-likelihood for the discrete part of the model under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik0</code></td>
<td>
<p>scalar. Log-likelihood under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>scalar. Wilks statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>scalar. Regularization parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>scalar. Regularization parameter under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>scalar. Model degree of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df0</code></td>
<td>
<p>scalar. Model degree of freedom under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>scalar. Information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic0</code></td>
<td>
<p>scalar. Information criteria under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>scalar. p-value of the Wilks statistic</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni
</p>


<h3>References</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni (2024)
A regularized MANOVA test for semicontinuous high-dimensional data.
arXiv: <a href="http://arxiv.org/abs/2401.04036">http://arxiv.org/abs/2401.04036</a>
</p>


<h3>See Also</h3>

<p><code>scMANOVAestimation</code> and <code>scMANOVApermTest</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(1234)
  n &lt;- c(5,5)
  p &lt;- 20
  pmiss &lt;- 0.1
  x &lt;- scMANOVAsimulation(n=n, p=p, pmiss=pmiss)
  res.asy &lt;- scMANOVA(x=x, n=n) # Asymptotic p.value
  res.asy
  
    res.perm &lt;- scMANOVA(x=x, n=n, p.value.perm=TRUE) # p-value by permutation test 
    res.perm
  
</code></pre>


</div>