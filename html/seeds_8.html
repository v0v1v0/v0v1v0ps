<div class="container">

<table style="width: 100%;"><tr>
<td>DEN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Greedy method for estimating a sparse solution</h2>

<h3>Description</h3>

<p>The sparse gradient dynamic elastic net calculates controls based on a first optimization with gradient descent. IT should 
result in a sparse vector of hidden inputs. These hidden inputs try to minimize the discrepancy between a given model and the taken measurements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DEN(
  odeModel,
  alphaStep,
  Beta,
  alpha1,
  alpha2,
  x0,
  optW,
  measFunc,
  measData,
  sd,
  epsilon,
  parameters,
  systemInput,
  modelFunc,
  greedyLogical,
  plotEstimates,
  conjGrad,
  cString,
  nnStates,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>odeModel</code></td>
<td>
<p>a object of class <code>odeModel</code> from the package seeds. The class saves the details of an experiment for easier manipulation and analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaStep</code></td>
<td>
<p>the starting stepsize for the gradient descent
a fitting stepsize will be calculated based on a backtracking line search
if the algorithm converges to slow use a bigger stepsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>scaling parameter for the backtracking to approximate the stepsize of the gradient descent. Is set to  0.8
if no value is given to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>
<p>L1-norm parameter of the dynamic elastic net approach, is set to zero for this algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>
<p>L2-norm parameter of the dynamic elastic net approach
used for regulation purposes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>initial state of the ODE system. Can be supplied with  the odeModel class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optW</code></td>
<td>
<p>a vector that indicates for which knots of the network a input should be calculated. The default is all nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measFunc</code></td>
<td>
<p>a R-Function that is used for measurement of the states if the system is not completely
measurable; an empty argument will result in the assumption that all states of the system are
measurable. Can be supplied by the odeModel parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measData</code></td>
<td>
<p>a table that contains the measurements of the experiment. Used to calculate the needed inputs. Can be supplied with  the odeModel class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard deviation of the measurement. Is used to weight the errors of the estimates in the cost function. Optional parameter. Can be supplied with  the odeModel class. Should contain the time in the first column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>parameter that defines the stopping criteria for the algorithm, in this case percent change in cost function J[w]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>vector or named vector that contains the parameters of the ODE equation. Can be supplied with  the odeModel class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>systemInput</code></td>
<td>
<p>A dataset that describes the external input of the system. The time steps should be given in the first column for the interpolation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelFunc</code></td>
<td>
<p>a R-Function that states the ODE system for which the hidden inputs should be calculated. Can be supplied with  the odeModel class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>greedyLogical</code></td>
<td>
<p>a boolean that states if the greedy approach should be used;if set to FALSE the algorithm
will only use perform a calculation of the inputs for all knots without a sparse solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotEstimates</code></td>
<td>
<p>boolean that indicated if the current estimate should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conjGrad</code></td>
<td>
<p>Boolean that indicates the usage of conjugate gradient method over the normal steepest descent. Defaults to true if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cString</code></td>
<td>
<p>Optional parameter: A string that represents constants, can be used to calculate a hidden input for a component that gradient is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnStates</code></td>
<td>
<p>A bit vector indicating the states that should be non negative. Default behaviour will calculate positive and negative states. Can be supplied with  the odeModel class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean indicating if an output in the console should be created to display the gradient descent steps</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This algorithm uses a greedy approach to calculate the hidden inputs. Starting with a first estimation of the hidden inputs
the algorithm tries to optimize set of hidden inputs based on the area under the curve from the first run. The algorithm stops 
if a set of hidden gives a lower cost than a set with additional hidden inputs. 
</p>
<p>For a complete example of the usage take a look into the vignette of the package.
</p>


<h3>Value</h3>

<p>returns a list of results objects. The default plot function can be used to plot the results.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(uvbModel)

results &lt;- DEN(odeModel = uvbModel, alphaStep = 500, alpha2 = 0.0001,
                epsilon = 0.2, plotEstimates = TRUE)


</code></pre>


</div>