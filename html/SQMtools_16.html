<div class="container">

<table style="width: 100%;"><tr>
<td>plotHeatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a heatmap using ggplot2</h2>

<h3>Description</h3>

<p>Plot a ggplot2 heatmap from a matrix or data frame. The data should be in tabular format (e.g. features in rows and samples in columns).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotHeatmap(
  data,
  label_x = "Samples",
  label_y = "Features",
  label_fill = "Abundance",
  gradient_col = c("ghostwhite", "dodgerblue4"),
  base_size = 11,
  metadata_groups = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numeric matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_x</code></td>
<td>
<p>character Label for the x axis (default <code>"Samples"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_y</code></td>
<td>
<p>character Label for the y axis (default <code>"Features"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_fill</code></td>
<td>
<p>character Label for color scale (default <code>"Abundance"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_col</code></td>
<td>
<p>A vector of two colors representing the low and high ends of the color gradient (default <code>c("ghostwhite", "dodgerblue4")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>numeric. Base font size (default <code>11</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata_groups</code></td>
<td>
<p>list. Split the plot into groups defined by the user: list('G1' = c('sample1', sample2'), 'G2' = c('sample3', 'sample4')) default <code>NULL</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 plot object.
</p>


<h3>See Also</h3>

<p><code>plotFunctions</code> for plotting the top functional categories of a SQM object; <code>plotBars</code> for plotting a barplot with arbitrary data; <code>mostAbundant</code> for selecting the most abundant rows in a dataframe or matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Hadza)
topPFAM = mostAbundant(Hadza$functions$PFAM$tpm)
topPFAM = topPFAM[rownames(topPFAM) != "Unclassified",] # Take out the Unclassified ORFs.
plotHeatmap(topPFAM, label_x = "Samples", label_y = "PFAMs", label_fill = "TPM")
</code></pre>


</div>