<div class="container">

<table style="width: 100%;"><tr>
<td>ifreq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Instantaneous frequency</h2>

<h3>Description</h3>

<p>This function returns the instantaneous frequency (and/or phase) of a time wave
through the computation of the analytic signal (Hilbert transform).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ifreq(wave, f, channel = 1, phase = FALSE, threshold = NULL,
plot = TRUE, xlab = "Time (s)", ylab = NULL,
ylim = NULL, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>if <code>TRUE</code> and  <code>plot</code> is also <code>TRUE</code>
plots the instantaneous phase instead of the instantaneous frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>amplitude threshold for signal detection (in % ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the instantaneous frequency or phase
against time (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the range of y values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The instantaneous phase is the argument of the 
analytic signal obtained throught the Hilbert transform.<br>
The instantaneous phase is then unwrapped and derived against time to
get the instantaneous frequency.<br>
There may be some edge effects at both start and end of the time wave. 
</p>


<h3>Value</h3>

<p>If <code>plot</code> is <code>FALSE</code>, <code>ifreq</code>
returns a list of two components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>a two-column matrix, the first column corresponding to time in seconds
(<em>x</em>-axis) and the second column corresponding to instantaneous
frequency in kHz (<em>y</em>-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a two-column matrix, the first column corresponding to time in seconds
(<em>x</em>-axis) and the second column corresponding to wrapped
instantaneous phase in radians (<em>y</em>-axis).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is based on the analytic signal obtained with the 
Hilbert transform (see <code>hilbert</code>).<br>
The function requires the package <span class="pkg">signal</span>.<br>
The matrix describing the instantaneous phase has one more row than the
one describing the instantaneous frequency.
</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>References</h3>

<p>Mbu Nyamsi, R. G., Aubin, T. &amp; Bremond, J. C. 1994
On the extraction of some time dependent parameters of an acoustic signal
by means of the analytic signal concept.
Its application to animal sound study. <em>Bioacoustics</em>, 5: 187-203.</p>


<h3>See Also</h3>

<p><code>hilbert</code>, <code>zc</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># generate a sound with sine and linear frequency modulations
a&lt;-synth(d=1, f=8000, cf=1500, fm=c(200,10,1000,0,0))
# plot on a single graphical device the instantaneous frequency and phase
op&lt;-par(mfrow=c(2,1))
ifreq(a,f=8000,main="Instantaneous frequency")
ifreq(a,f=8000,phase=TRUE,main="Instantaneous phase")
par(op)
</code></pre>


</div>