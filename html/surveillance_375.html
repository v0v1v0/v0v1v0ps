<div class="container">

<table style="width: 100%;"><tr>
<td>sts_creation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Count Time Series with Outbreaks</h2>

<h3>Description</h3>

<p>Function for simulating a time series and creating an
<code>sts</code> object.
As the counts are generated using a negative binomial distribution
one also gets the (1-alpha) quantile for each timepoint (can be interpreted
as an in-control upperbound for in-control values).
The baseline and outbreaks are created as in Noufaily et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sts_creation(theta, beta, gamma1, gamma2, m, overdispersion, dates,
  sizesOutbreak, datesOutbreak, delayMax, alpha, densityDelay)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>baseline frequency of reports</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>time trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma1</code></td>
<td>
<p>seasonality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma2</code></td>
<td>
<p>seasonality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>seasonality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdispersion</code></td>
<td>
<p><code>size</code> parameter of <code>rnbinom</code> for
the parameterization with mean and dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>dates of the time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizesOutbreak</code></td>
<td>
<p>sizes of all the outbreaks (vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datesOutbreak</code></td>
<td>
<p>dates of all the outbreaks (vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delayMax</code></td>
<td>
<p>maximal delay in time units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>alpha for getting the (1-alpha) quantile of the negative
binomial distribution at each timepoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densityDelay</code></td>
<td>
<p>density distribution for the delay</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Noufaily, A., Enki, D.G., Farrington, C.P., Garthwaite, P., Andrews,
N.J., Charlett, A. (2012): An improved algorithm for outbreak
detection in multiple surveillance systems. Statistics in Medicine,
32 (7), 1206-1222.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12345)
# Time series parameters
scenario4 &lt;- c(1.6,0,0.4,0.5,2)
theta &lt;- 1.6
beta &lt;- 0
gamma1 &lt;-0.4
gamma2 &lt;- 0.5
overdispersion &lt;- 1
m &lt;- 1
# Dates
firstDate &lt;- "2006-01-01"
lengthT=350
dates &lt;- as.Date(firstDate) + 7 * 0:(lengthT - 1)
# Maximal delay in weeks
D=10
# Dates and sizes of the outbreaks
datesOutbreak &lt;- as.Date(c("2008-03-30","2011-09-25"))
sizesOutbreak &lt;- c(2,5)
# Delay distribution
data("salmAllOnset")
in2011 &lt;- which(isoWeekYear(epoch(salmAllOnset))$ISOYear == 2011)
rT2011 &lt;- salmAllOnset@control$reportingTriangle$n[in2011,]
densityDelay &lt;- apply(rT2011,2,sum, na.rm=TRUE)/sum(rT2011, na.rm=TRUE)
# alpha for the upperbound
alpha &lt;- 0.05
# Create the sts with the full time series
stsSim &lt;- sts_creation(theta=theta,beta=beta,gamma1=gamma1,gamma2=gamma2,m=m,
                       overdispersion=overdispersion,
                       dates=dates,
                       sizesOutbreak=sizesOutbreak,datesOutbreak=datesOutbreak,
                       delayMax=D,densityDelay=densityDelay,
                       alpha=alpha)
plot(stsSim)
</code></pre>


</div>