<div class="container">

<table style="width: 100%;"><tr>
<td>Single.Trial.RE.AA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conducts a surrogacy analysis based on the single-trial meta-analytic framework</h2>

<h3>Description</h3>

<p>The function <code>Single.Trial.RE.AA</code> conducts a surrogacy analysis based on the single-trial meta-analytic framework of Buyse &amp; Molenberghs (1998). See <b>Details</b> below. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Single.Trial.RE.AA(Dataset, Surr, True, Treat, Pat.ID, Alpha=.05, 
Number.Bootstraps=500, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, and a patient ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. The <code class="reqn">-1/1</code> coding is recommended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around Alpha (which is a parameter estimate of a model where the surrogate is regressed on the treatment indicator, see <b>Details</b> below), Beta, RE, and <code class="reqn">\gamma</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Number.Bootstraps</code></td>
<td>
<p>The number of bootstrap samples that are used to obtain the bootstrapp-based confidence intervals for RE and the adjusted association (<code class="reqn">\gamma</code>). Default <code class="reqn">500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed that is used to generate the bootstrap samples. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Relative Effect (RE) and the adjusted association (<code class="reqn">\gamma</code>) are based on the following bivariate regression model (when the surrogate and the true endpoints are continuous variables):
</p>
<p style="text-align: center;"><code class="reqn">S_{j}=\mu_{S}+\alpha Z_{j}+\varepsilon_{Sj},</code>
</p>
 
<p style="text-align: center;"><code class="reqn">T_{j}=\mu_{T}+\beta Z_{j}+\varepsilon_{Tj},</code>
</p>
 
<p>where the error terms have a joint zero-mean normal distribution with variance-covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma}=\left(\begin{array}{cc}
\sigma_{SS}\\
\sigma_{ST} &amp; \sigma_{TT}
\end{array}\right),</code>
</p>

<p>and where <code class="reqn">j</code> is the subject indicator, <code class="reqn">S_{j}</code> and <code class="reqn">T_{j}</code> are the surrogate and true endpoint values of patient <code class="reqn">j</code>, and <code class="reqn">Z_{j}</code> is the treatment indicator for patient <code class="reqn">j</code>. 
</p>
<p>The parameter estimates of the fitted regression model and the variance-covariance matrix of the residuals are used to compute RE and the adjusted association (<code class="reqn">\gamma</code>), respectively:
</p>
<p style="text-align: center;"><code class="reqn">RE=\frac{\beta}{\alpha},</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma=\frac{\sigma_{ST}}{\sqrt{\sigma_{SS}\sigma_{TT}}}.</code>
</p>

<p><b>Note</b>
</p>
<p>The single-trial meta-analytic framework is hampered by a number of issues (Burzykowski et al., 2005). For example, a key motivation to validate a surrogate endpoint is to be able to predict the effect of Z on T as based on the effect of Z on S in a new clinical trial where T is not (yet) observed. The RE allows for such a prediction, but this requires the assumption that the relation between <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> can be described by a linear regression model that goes through the origin. In other words, it has to be assumed that the RE remains constant across clinical trials. The constant RE assumption is unverifiable in a single-trial setting, but a way out of this problem is to combine the information of multiple clinical trials and generalize the RE concept to a multiple-trial setting (as is done in the multiple-trial meta-analytic approach, see <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, and <code>BimixedContCont</code>).  
</p>


<h3>Value</h3>

<p>An object of class <code>Single.Trial.RE.AA</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the parameter estimate for <code class="reqn">\alpha</code>, its standard error, and its confidence interval. Note that <code>Alpha</code> is not to be confused with the <code>Alpha</code> argument in the function call, which specifies the <code class="reqn">\alpha</code>-level of the confidence intervals of the parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the parameter estimate for <code class="reqn">\beta</code>, its standard error, and its confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on the Delta method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.Fieller</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on Fieller's theorem).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.Boot</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on bootstrapping). Note that the occurence of outliers in the sample of bootstrapped RE values may lead to standard errors and/or confidence intervals that are not trustworthy. Such problems mainly occur when the parameter estimate for <code class="reqn">\alpha</code> is close to 0 (taking its standard error into account). To detect possible outliers, studentized deleted residuals are computed (by fitting an intercept-only model with the bootstrapped RE values as the outcome variable). Bootstrapped RE values with an absolute studentized residual larger than <code class="reqn">t(1-\alpha/2n;n-2)</code> are marked as outliers (where n = the number of bootstrapped RE values; Kutner et al., 2005). A warning is given when outliers are found, and the position of the outlier(s) in the bootstrap sample is identified. Inspection of the vector of bootstrapped RE values (see <code>RE.Boot.Samples</code> below) is recommended in this situation, and/or the use of the confidence intervals that are based on the Delta method or Fieller's theorem (rather than the bootstrap-based confidence interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AA</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the adjusted association (i.e., <code class="reqn">\gamma</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AA.Boot</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the adjusted association (i.e., <code class="reqn">\gamma</code>), its standard error, and its confidence interval (based on a bootstrap procedure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE.Boot.Samples</code></td>
<td>
<p>A vector that contains the RE values that were generated during the bootstrap procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AA.Boot.Samples</code></td>
<td>
<p>A vector that contains the adjusted association (i.e., <code class="reqn">\gamma</code>) values that were generated during the bootstrap procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0T1}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained when the surrogate and the true endpoint are regressed on the treatment indicator.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., &amp; Molenberghs, G. (1998). The validation of surrogate endpoints in randomized experiments. <em>Biometrics, 54,</em> 1014-1029.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W. (2005). <em>Applied linear statistical models (5th ed.)</em>. New York: McGraw Hill.
</p>


<h3>See Also</h3>

<p><code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, <code>BimixedContCont</code>, <code>ICA.ContCont</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  # time consuming code part
# Example 1, based on the ARMD data:
data(ARMD)

# Assess surrogacy based on the single-trial meta-analytic approach:
Sur &lt;- Single.Trial.RE.AA(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Pat.ID=Id)

# Obtain a summary and plot of the results
summary(Sur)
plot(Sur)


# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients 
# and Rindiv=.8
# Simulate the data:
Sim.Data.STS(N.Total=2000, R.Indiv.Target=.8, Seed=123)

# Assess surrogacy:
Sur2 &lt;- Single.Trial.RE.AA(Dataset=Data.Observed.STS, Surr=Surr, True=True, Treat=Treat, 
Pat.ID=Pat.ID)

# Show a summary and plots of results
summary(Sur2)
plot(Sur2)

## End(Not run)
</code></pre>


</div>