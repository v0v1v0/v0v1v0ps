<div class="container">

<table style="width: 100%;"><tr>
<td>condrgp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conditional simulation of Gaussian random fields
</h2>

<h3>Description</h3>

<p>This function generates conditional simulation of Gaussian random fields
from the simple kriging predictor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">condrgp(n, coord, data.coord, data, cov.mod = "powexp", mean = 0, sill =
1, range = 1, smooth = 1, grid = FALSE, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of conditional simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A numeric vector or matrix specifying the coordinates
where the process has to be generated. If <code>coord</code> is a matrix,
each row specifies one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.coord</code></td>
<td>
<p>A numeric vector or matrix specifying the
coordinates where the process is conditioned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector giving the conditioning observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string specifying the covariance function
family. Must be one of "whitmat", "powexp", "cauchy" or "bessel" for
the Whittle-Mater, the powered exponential, the Cauchy or Bessel
covariance families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean,sill,range,smooth</code></td>
<td>
<p>The mean, sill, range and
smooth of the Gaussian process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical. Does <code>coord</code> specifies a grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A named list passing options to the simulation method
of Gaussian processes â€” see <code>rgp</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>The coordinates at which the process was simulated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond.sim</code></td>
<td>
<p>The simulated process;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.coord</code></td>
<td>
<p>The coordinates of the conditioning locations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The conditioning observations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>The covariance function family;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Does <code>coord</code> specifies a grid?</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>See Also</h3>

<p><code>kriging</code>, <code>rgp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Several conditional simulations
n.site &lt;- 50
n.sim &lt;- 512

x.obs &lt;- runif(n.site, -100, 100)
x.sim &lt;- seq(-100, 100, length = n.sim)

data &lt;- rgp(1, x.obs, "whitmat", sill = 1, range = 10, smooth = 0.75)

sim &lt;- condrgp(5, x.sim, x.obs, data, "whitmat", sill = 1, range =
10, smooth = 0.75)

matplot(x.sim, t(sim$cond.sim),  type = "l", lty = 1, xlab = "x", ylab =
expression(Y[cond](x)))
points(x.obs, data, pch = 21, bg = 1)
title("Five conditional simulations")

## Comparison between one conditional simulations and the kriging
## predictor on a grid
x.obs &lt;- matrix(runif(2 * n.site, -100, 100), ncol = 2)
x &lt;- y &lt;- seq(-100, 100, length = 100)
x.sim &lt;- cbind(x, y)

data &lt;- rgp(1, x.obs, "whitmat", sill = 1, range = 50, smooth = 0.75)

krig &lt;- kriging(data, x.obs, x.sim, "whitmat", sill = 1, range = 50,
smooth = 0.75, grid = TRUE)
sim &lt;- condrgp(1, x.sim, x.obs, data, "whitmat", sill = 1, range = 50,
smooth = 0.75, grid = TRUE)

z.lim &lt;- range(c(sim$cond.sim, data, krig$krig.est))
breaks &lt;- seq(z.lim[1], z.lim[2], length = 65)
col &lt;- heat.colors(64)
idx &lt;- as.numeric(cut(data, breaks))

op &lt;- par(mfrow = c(1,2))
image(x, y, krig$krig.est, col = col, breaks = breaks)
points(x.obs, bg = col[idx], pch = 21)
title("Kriging predictor")
image(x, y, sim$cond.sim, col = col, breaks = breaks)
points(x.obs, bg = col[idx], pch = 21)
title("Conditional simulation")
## Note how the background colors of the above points matches the ones
## returned by the image function
par(op)
</code></pre>


</div>