<div class="container">

<table style="width: 100%;"><tr>
<td>KS_scores_lambdas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional Kriging
</h2>

<h3>Description</h3>

<p>Linear Spatial functional prediction. Two predictors are possible: scores or lambda.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KS_scores_lambdas(SFD, newcoords, model, method = "lambda", name = NULL, fill.all = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SFD</code></td>
<td>
<p>object of class 'SpatFD'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newcoords</code></td>
<td>

<p>The N × 2 matrix or data.frame with the spatial coordinates corresponding to the N prediction locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>The scores variogram model. A variogramModel object. See gstat package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Prediction method: "lambda" or "scores". By default "lambda". See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>

<p>The variable to predict in SpatFD object. By default, the predictions is performed for the first variable in the SpatFD object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.all</code></td>
<td>

<p>gstat function parameter. If there are more than 1 score vector and not all models or a valid and complete linear model of coregionalization is given, fill all of the direct and cross variogram model with the only model given.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>"lambda" option corresponds to the predictor <code class="reqn">\breve{\chi}_{\bm s_0}(t)</code>, given by
</p>
<p style="text-align: center;"><code class="reqn">\breve{\chi}_{\bm s_0}(t)=\sum\limits_{i=1}^{n}\lambda_i\chi_{\bm s_i}(t)</code>
</p>

<p>and weigths are found such that minimize
<code class="reqn">\left\|\bm\chi_{\bm s_0}(t)-\breve{\chi}_{\bm s_0}(t)\right\|^2</code>.
</p>
<p>"scores" method performs kriging or cokriging directly on the scores and predictions are used to build the functional prediction
</p>
<p>It is used simple cokriging to predict the vector <code class="reqn">\bm f(\bm s_0)=\left(f_1(\bm s_0),...,f_K(\bm s_0)\right)^T</code> at the unsampled location <code class="reqn">\bm s_0</code>. The predictor is <code class="reqn">f^*(\bm s_0)</code>, so the prediction of the curve <code class="reqn">\chi_{\bm s_0}(t)</code> is <code class="reqn">\chi^*_{\bm s_0}(t)=\bm \xi^T(t)\bm f^*(\bm s_0),\;\;\;\;\;\;i=1,...,n</code>.
</p>


<h3>Value</h3>

<p>Returns a 'KS_pred' object with functional kriging:
weights (lambda) using the first method and kriging score predictions using the second method in Bohorquez, M., Giraldo, R., &amp; Mateu, J. (2016).
</p>


<h3>Author(s)</h3>

<p>Diego Sandoval <a href="mailto:diasandovalsk@unal.edu.co">diasandovalsk@unal.edu.co</a> &amp; Angie Villamil <a href="mailto:acvillamils@unal.edu.co">acvillamils@unal.edu.co</a>.
</p>


<h3>References</h3>

<p>Bohorquez, M., Giraldo, R., &amp; Mateu, J. (2016). Optimal sampling for spatial prediction of functional data. Statistical Methods &amp; Applications, 25(1), 39-54.
</p>
<p>Bohorquez, M., Giraldo, R., &amp; Mateu, J. (2016). Multivariate functional random fields: prediction and optimal sampling. Stochastic Environmental Research and Risk Assessment, 31, pages53–70 (2017).
</p>
<p>Bohorquez M.; Giraldo R. and Mateu J. Spatial prediction and optimal sampling of functional data in Geostatistical Functional Data Analysis: Theory and Methods (2021).  John Wiley  Sons, Chichester, UK. ISBN: 978-1-119-38784-8. https://www.wiley.com/en-us/Geostatistical+Functional+Data+Analysis-p-9781119387848.
</p>


<h3>See Also</h3>

<p><code>SpatFD</code>,<code>summary.KS_pred</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gstat)
data(AirQualityBogota)

newcoorden=data.frame(X=110000,Y=125000)

# Recibir los datos, suavizarlos y ACP
SFD_PM10 &lt;- SpatFD(PM10, coords = coord[,2:3], basis = "Bsplines",
nbasis = 17,norder=5, lambda = 0.00002, nharm=3)

#Variogram model for each component
modelos &lt;- list(vgm(psill = 2634000, "Exp", range = 2103.25, nugget =  0),
                vgm(psill = 101494.96, "Exp", range = 1484.57, nugget = 0),
                vgm(psill =53673, "Exp", range = 42406, nugget =  0))

#Genera los scores y los lambdas para predecir en nuevas coordenadas

#method = "lambda"
KS_SFD_PM10_l &lt;- KS_scores_lambdas(SFD_PM10, newcoorden ,method = "lambda",
model = modelos)
class(KS_SFD_PM10_l)

#method = "scores"
KS_SFD_PM10_sc &lt;- KS_scores_lambdas(SFD_PM10, newcoorden, method = "scores",
model = modelos)

#method = "both"
KS_SFD_PM10_both &lt;- KS_scores_lambdas(SFD_PM10, newcoorden, method = "both",
model = modelos)
</code></pre>


</div>