<div class="container">

<table style="width: 100%;"><tr>
<td>RK4adapt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> A function which uses the Fourth order Runge-Kutta method with adaptive step size to solve a system of ODE's. </h2>

<h3>Description</h3>

<p>This function simulates a discrete time Markov chain with transition matrix P, state space 0,1,..,n and 
and initial state i for nsteps transitions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RK4adapt(dydt, t0, y0, t1, h0 = 1, tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dydt</code></td>
<td>
<p> a function giving the gradient of y(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p> initial value of t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>initial value of y(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>system solved up to time t1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>initial step size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> tolerance for adapting step size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>pass arguments to function dydt.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We assume that <kbd>P</kbd> is well defined transition matrix with rows summing to 1.
</p>


<h3>Value</h3>

<p>Returns a list with elements t, a vector giving times, and y, a matrix whose rows give the solution at successive times.
</p>


<h3>References</h3>

<p>Jones, O.D., R. Maillardet, and A.P. Robinson.  2009.  An Introduction
to Scientific Programming and Simulation, Using R.  Chapman And Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class="language-R">LV &lt;- function(t=NULL, y, a, b, g, e, K=Inf)
  c(a*y[1]*(1 - y[1]/K) - b*y[1]*y[2], g*b*y[1]*y[2] - e*y[2])

xy &lt;- RK4adapt(LV, 0, c(100, 50), 200, 1, tol=1e-3, 
               a=0.05, K=Inf, b=0.0002, g=0.8, e=0.03)

par(mfrow = c(2,1))
plot(xy$y[,1], xy$y[,2], type='p', 
     xlab='prey', ylab='pred', main='RK4, adaptive h')
plot(xy$t, xy$y[,1], type='p', xlab='time', 
     ylab='prey circles pred triangles', main='RK4, adaptive h')
points(xy$t, xy$y[,2], pch=2)
par(mfrow=c(1,1))
</code></pre>


</div>