<div class="container">

<table style="width: 100%;"><tr>
<td>CRPSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Continuous Ranked Probability Skill Score</h2>

<h3>Description</h3>

<p>The Continuous Ranked Probability Skill Score (CRPSS; Wilks, 2011) is the 
skill score based on the Continuous Ranked Probability Score (CRPS; Wilks, 
2011). It can be used to assess whether a forecast presents an improvement or 
worsening with respect to a reference forecast. The CRPSS ranges between minus 
infinite and 1. If the CRPSS is positive, it indicates that the forecast has 
higher skill than the reference forecast, while a negative value means that it
has a lower skill. Examples of reference forecasts are the climatological 
forecast, persistence, a previous model version, or another model. It is 
computed as 'CRPSS = 1 - CRPS_exp / CRPS_ref. The statistical significance is 
obtained based on a Random Walk test at the specified confidence level 
(DelSole and Tippett, 2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CRPSS(
  exp,
  obs,
  ref = NULL,
  time_dim = "sdate",
  memb_dim = "member",
  dat_dim = NULL,
  Fair = FALSE,
  clim.cross.val = TRUE,
  sig_method.type = "two.sided.approx",
  alpha = 0.05,
  N.eff = NA,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>A named numerical array of the forecast with at least time 
dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A named numerical array of the observation with at least time 
dimension. The dimensions must be the same as 'exp' except 'memb_dim'
and 'dat_dim'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>A named numerical array of the reference forecast data with at 
least time and member dimension. The dimensions must be the same as 'exp' 
except 'memb_dim' and 'dat_dim'. If there is only one reference dataset,
it should not have dataset dimension. If there is corresponding reference 
for each experiment, the dataset dimension must have the same length as in
'exp'. If 'ref' is NULL, the climatological forecast is used as reference 
forecast. To build the climatological forecast, the observed values along
the whole time period are used as different members for all time steps. The 
parameter 'clim.cross.val' controls whether to build it using 
cross-validation. The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of the time dimension.
The default value is 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the name of the member dimension
to compute the probabilities of the forecast and the reference forecast. The
default value is 'member'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat_dim</code></td>
<td>
<p>A character string indicating the name of dataset dimension. 
The length of this dimension can be different between 'exp' and 'obs'. 
The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fair</code></td>
<td>
<p>A logical indicating whether to compute the FairCRPSS (the 
potential CRPSS that the forecast would have with an infinite ensemble 
size). The default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clim.cross.val</code></td>
<td>
<p>A logical indicating whether to build the climatological
forecast in cross-validation (i.e. excluding the observed value of the time 
step when building the probabilistic distribution function for that 
particular time step). Only used if 'ref' is NULL. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_method.type</code></td>
<td>
<p>A character string indicating the test type of the
significance method. Check <code>RandomWalkTest()</code> parameter 
<code>test.type</code> for details. The default is 'two.sided.approx', which is 
the default of <code>RandomWalkTest()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric of the significance level to be used in the statistical
significance test. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.eff</code></td>
<td>
<p>Effective sample size to be used in the statistical significance
test. It can be NA (and it will be computed with the s2dv:::.Eno), FALSE 
(and it will use the length of "obs" along "time_dim", so the 
autocorrelation is not taken into account), a numeric (which is used for 
all cases), or an array with the same dimensions as "obs" except "time_dim"
(for a particular N.eff to be used for each case). The default value is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>$crpss</code></td>
<td>

<p>A numerical array of the CRPSS with dimensions c(nexp, nobs, the rest 
dimensions of 'exp' except 'time_dim' and 'memb_dim' dimensions). nexp is 
the number of experiment (i.e., dat_dim in exp), and nobs is the number of 
observation (i.e., dat_dim in obs). If 'dat_dim' is NULL, nexp and nobs are
omitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$sign</code></td>
<td>

<p>A logical array of the statistical significance of the CRPSS with the same 
dimensions as $crpss.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wilks, 2011; https://doi.org/10.1016/B978-0-12-385022-5.00008-7
DelSole and Tippett, 2016; https://doi.org/10.1175/MWR-D-15-0218.1
</p>


<h3>Examples</h3>

<pre><code class="language-R">exp &lt;- array(rnorm(1000), dim = c(lat = 3, lon = 2, member = 10, sdate = 50))
obs &lt;- array(rnorm(1000), dim = c(lat = 3, lon = 2, sdate = 50))
ref &lt;- array(rnorm(1000), dim = c(lat = 3, lon = 2, member = 10, sdate = 50))
res &lt;- CRPSS(exp = exp, obs = obs) ## climatology as reference forecast
res &lt;- CRPSS(exp = exp, obs = obs, ref = ref) ## ref as reference forecast

</code></pre>


</div>