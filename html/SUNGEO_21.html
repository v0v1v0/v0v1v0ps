<div class="container">

<table style="width: 100%;"><tr>
<td>point2poly_krige</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Point-to-polygon interpolation, ordinary and universal Kriging method</h2>

<h3>Description</h3>

<p>Function for interpolating values from a source points layer to an overlapping destination polygon layer, using ordinary and universal kriging with automatic variogram fitting
</p>


<h3>Usage</h3>

<pre><code class="language-R">point2poly_krige(
  pointz,
  polyz,
  rasterz = NULL,
  yvarz = NULL,
  xvarz = NULL,
  pycno_yvarz = NULL,
  funz = base::mean,
  use_grid = FALSE,
  nz_grid = 25,
  blockz = 0,
  pointz_x_coord = NULL,
  pointz_y_coord = NULL,
  polyz_x_coord = NULL,
  polyz_y_coord = NULL,
  messagez = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pointz</code></td>
<td>
<p>Source points layer. <code>sf</code>, <code>sp</code>, or data frame object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polyz</code></td>
<td>
<p>Destination polygon layer. Must have identical CRS to <code>pointz</code>. <code>sf</code>, <code>sp</code>, or data frame object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rasterz</code></td>
<td>
<p>Source raster layer (or list of raster), with covariate(s) used for universal kriging. Must have identical CRS to <code>polyz</code>.  <code>RasterLayer</code> object or list of <code>RasterLayer</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvarz</code></td>
<td>
<p>Names of numeric variable(s) to be interpolated from source points layer to destination polygons. Character string or vector of character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvarz</code></td>
<td>
<p>Names of numeric variable(s) for universal Kriging, in which yvarz is linearly dependent. Character string or vector of character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pycno_yvarz</code></td>
<td>
<p>Names of spatially extensive numeric variables for which the pycnophylactic (mass-preserving) property should be preserved. Must be a subset of <code>yvarz</code>. Character string or vector of character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funz</code></td>
<td>
<p>Aggregation function to be applied to values in <code>rasterz</code> and to interpolated values. Must take as an input a vector <code>x</code>. Default is mean.  Function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_grid</code></td>
<td>
<p>Use regular grid as destination layer for interpolation, before aggregating to polygons? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nz_grid</code></td>
<td>
<p>Number of grid cells in x and y direction (columns, rows). Integer of length 1 or 2. Default is 25. Ignored if use_grid=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockz</code></td>
<td>
<p>Size of blocks used for Block Kriging, in meters. Integer of length 1 or 2. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointz_x_coord</code></td>
<td>
<p>Name of numeric variable corresponding to a measure of longitude (Easting) in a data frame object for <code>pointz</code>. Character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointz_y_coord</code></td>
<td>
<p>Name of numeric variable corresponding to a measure of Latitude (Northing) in a data frame object for <code>pointz</code>. Character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polyz_x_coord</code></td>
<td>
<p>Name of numeric variable corresponding to a measure of longitude (Easting) in a data frame object for <code>polyz</code>. Character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polyz_y_coord</code></td>
<td>
<p>Name of numeric variable corresponding to a measure of Latitude (Northing) in a data frame object for <code>polyz</code>. Character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messagez</code></td>
<td>
<p>Optional message to be printed during Kriging estimation. Character string.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs Ordinary and Universal Kriging, automatically selecting a variogram model with the smallest residual sum of squares from the sample variogram. See autofitVariogram.
</p>
<p>Unlike other available point-to-polygon interpolation techniques, this function currently only accepts numeric variables in <code>varz</code> and does not support interpolation of character strings.
</p>


<h3>Value</h3>

<p><code>sf</code> polygon object, with variables from <code>pointz</code> interpolated to the geometries of <code>polyz</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Ordinary Kriging with one variable
## Not run: 
data(clea_deu2009)
data(clea_deu2009_pt)
out_1 &lt;- point2poly_krige(pointz = clea_deu2009_pt,
                         polyz = clea_deu2009,
                         yvarz = "to1")
par(mfrow=c(1,2))
plot(clea_deu2009["to1"], key.pos = NULL, reset = FALSE)
plot(out_1["to1.pred"], key.pos = NULL, reset = FALSE)

## End(Not run)

# Ordinary Kriging with multiple variables
## Not run: 
out_2 &lt;- point2poly_krige(pointz = clea_deu2009_pt,
                         polyz = clea_deu2009,
                         yvarz = c("to1","pvs1_margin"))
par(mfrow=c(1,2))
plot(clea_deu2009["pvs1_margin"], key.pos = NULL, reset = FALSE)
plot(out_2["pvs1_margin.pred"], key.pos = NULL, reset = FALSE)

## End(Not run)

# Universal Kriging with one variable from a raster
## Not run: 
data(gpw4_deu2010)
data(clea_deu2009)
data(clea_deu2009_pt)
out_3 &lt;- point2poly_krige(pointz = clea_deu2009_pt,
                         polyz = clea_deu2009,
                         yvarz = "to1",
                         rasterz = gpw4_deu2010)
par(mfrow=c(1,2))
plot(clea_deu2009["to1"], key.pos = NULL, reset = FALSE)
plot(out_3["to1.pred"], key.pos = NULL, reset = FALSE)

## End(Not run)

# Block Kriging with block size of 100 km
## Not run: 
data(clea_deu2009)
data(clea_deu2009_pt)
out_4 &lt;- point2poly_krige(pointz = clea_deu2009_pt,
                         polyz = clea_deu2009,
                         yvarz = "to1",
                         blockz = 100000)
par(mfrow=c(1,2))
plot(clea_deu2009["to1"], key.pos = NULL, reset = FALSE)
plot(out_4["to1.pred"], key.pos = NULL, reset = FALSE)

## End(Not run)
</code></pre>


</div>