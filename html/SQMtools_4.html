<div class="container">

<table style="width: 100%;"><tr>
<td>exportPathway</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export the functions of a SQM object into KEGG pathway maps</h2>

<h3>Description</h3>

<p>This function is a wrapper for the pathview package (Luo <em>et al.</em>, 2017. <em>Nucleic acids research</em>, 45:W501-W508). It will generate annotated KEGG pathway maps showing which reactions are present in the different samples. It will also generate legends with the color scales for each sample in separate png files.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exportPathway(
  SQM,
  pathway_id,
  count = "tpm",
  samples = NULL,
  split_samples = FALSE,
  sample_colors = NULL,
  log_scale = FALSE,
  fold_change_groups = NULL,
  fold_change_colors = NULL,
  max_scale_value = NULL,
  color_bins = 10,
  output_suffix = "pathview"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SQM</code></td>
<td>
<p>A SQM or SQMlite object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway_id</code></td>
<td>
<p>character. The five-number KEGG pathway identifier. A list of all pathway identifiers can be found in <a href="https://www.genome.jp/kegg/pathway.html">https://www.genome.jp/kegg/pathway.html</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>character. Either <code>"abund"</code> for raw abundances, <code>"percent"</code> for percentages, <code>"bases"</code> for raw base counts, <code>"tpm"</code> for TPM normalized values or <code>"copy_number"</code> for copy numbers (default <code>"tpm"</code>). Note that a given count type might not available in this object (e.g. TPM or copy number in SQMlite objects originating from a SQM reads project).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>character. An optional vector with the names of the samples to export. If absent, all samples will be exported (default <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_samples</code></td>
<td>
<p>logical. Generate a different output file for each sample (default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_colors</code></td>
<td>
<p>character. An optional vector with the plotting colors for each sample (default <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_scale</code></td>
<td>
<p>logical. Use a base 10 logarithmic transformation for the color scale. Will have no effect if <code>fold_change_groups</code> is provided (default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold_change_groups</code></td>
<td>
<p>list. An optional list containing two vectors of samples. If provided, the function will generate a single plot displaying the log2 fold-change between the average abundances of both groups of samples ( log(second group / first group) ) (default <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold_change_colors</code></td>
<td>
<p>character. An optional vector with the plotting colors of both groups in the fold-change plot. Will be ignored if <code>fold_change_group</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_scale_value</code></td>
<td>
<p>numeric. Maximum value to include in the color scale. By default it is the maximum value in the selected samples (if plotting abundances in samples) or the maximum absolute log2 fold-change (if plotting fold changes) (default <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_bins</code></td>
<td>
<p>numeric. Number of bins used to generate the gradient in the color scale (default <code>10</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_suffix</code></td>
<td>
<p>character. Suffix to be added to the output files (default <code>"pathview"</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>No return value, but Pathview figures are produced in the current working directory.
</p>


<h3>See Also</h3>

<p><code>plotFunctions</code> for plotting the most functions taxa of a SQM object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Hadza)
exportPathway(Hadza, "00910", count = 'copy_number', 
              output_suffix = "nitrogen_metabolism", sample_colors = c("red", "blue"))
exportPathway(Hadza, "00250", count = 'tpm', 
              output_suffix = "ala_asp_glu_metabolism_FoldChange", 
              fold_change_groups = list(c("H1"), c("H12")), max_scale_value=2)

</code></pre>


</div>