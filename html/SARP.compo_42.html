<div class="container">

<table style="width: 100%;"><tr>
<td>coupures.Mp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Finding cut-offs for graph disjonctions
</h2>

<h3>Description</h3>

<p> These functions detect the experimental cut-offs to create
distinct subgraphs, and propose adapted graphical representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coupures.Mp( Mp )

## S3 method for class 'Coupures'
plot(x, seuil.p = 0.05, en.log = TRUE,
                        xlab = "Seuil de p", ylab = "Nombre de composantes",
                        col.trait = "black", lwd.trait = 1, lty.trait = 1,
                        col.seuil = "red"  , lwd.seuil = 1, lty.seuil = 1,
                        pch.fin = 19, cex.fin = 1, col.fin ="darkgreen",
                        pch.deb = ")", cex.deb = 1, col.deb = "darkgreen",
                        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mp</code></td>
<td>

<p>A square, symmetric matrix containing <em>p</em>-values. Element
in row <code class="reqn">i</code> and line <code class="reqn">j</code> should contain the <em>p</em>-value
for testing the <code class="reqn">\frac{i}{j}</code> ratio. The diagonal is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The set of critical values, as obtained by <code>coupures.Mp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seuil.p</code></td>
<td>

<p>Selected cut-off for analysis. Can also be a <code>SARPcompo.H0</code>
object, as returned by <code>choisir.seuil</code>, in which case
the bounds of the confidence interval are also drawn, with dashed
lines by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en.log</code></td>
<td>

<p>If <code>TRUE</code>, the <em>p</em>-values axis uses a decimal logarithm
scale. It may help visualisation of the small critical <em>p</em>-values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>

<p>Legends for the axes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.trait, lwd.trait, lty.trait, pch.fin, cex.fin, col.fin,
pch.deb, cex.deb, col.deb</code></td>
<td>

<p>Graphical parameters for drawing the number of components in
function of the cut-off. ‘trait’ refers to the function
itself, ‘deb’ to the first point of a region of constant
components number (that does not belong to it: the function is
right-discontinuous) and ‘fin’ to the last point of this
region (that belongs to it)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.seuil, lwd.seuil, lty.seuil</code></td>
<td>

<p>Graphical parameters for drawing the analysis cut-off
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additionnal parameters for <code>plot</code>,
which is used internally.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By increasing the cut-off from 0 to 1, more and more edges between
nodes are removed, and disjoint subgraphs appear. This function
detects in a matrix of <em>p</em>-values which are the “critical”
ones, that is the one for which the number of components changes.
</p>
<p>Because the edge removal is defined by <code class="reqn">p &lt; cut-off</code>, the cut-off
returned for a given number of components is to be understand as the
maximal one that gives this number of components.
</p>
<p>The <code>plot</code> method allows to visualize the evolution of the number
of components with the cut-off, and writes the critical cut-off values.
</p>


<h3>Value</h3>

<p> The <code>coupures.Mp</code> function returns a data.frame with
additionnal class ‘Coupures’. It contains three columns: one
with the <em>p</em>-value cut-offs, one with the opposite of their
decimal logarithm and one with the number of components when using
exactly this cut-off. The additionnal class allows to provide a
<code>plot</code> method.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>creer.Mp</code> to create a matrix of <em>p</em>-values for all
possible ratios of a compositional vector.
</p>
<p><code>grf.Mp</code> to convert such a matrix to a graph, once a
cut-off is selected.
</p>
<p><code>arbre.Mp</code> to convert such a matrix to a classification
tree of the components of the compositional vector.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # load the potery data set
   data( poteries )

   # Compute one-way ANOVA p-values for all ratios in this data set   
   Mp &lt;- creer.Mp( poteries, c( 'Al', 'Na', 'Fe', 'Ca', 'Mg' ),
                   f.p = anva1.fpc, v.X = 'Site' )

   # Where would be the cut-offs?
   seuils &lt;- coupures.Mp( Mp )
   seuils

   # Drawing this, in log10 scale
   plot( seuils, en.log = TRUE )
</code></pre>


</div>