<div class="container">

<table style="width: 100%;"><tr>
<td>loadCalculations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate annual loads and summarize trends</h2>

<h3>Description</h3>

<p>Function to calculate pesticide loads in kilograms per year and summarize trends.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loadCalculations(
  dailyDat,
  pestPredict,
  modRes,
  concTrends,
  yrtype = 1,
  alpha = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dailyDat</code></td>
<td>
<p>is the daily streamflow data in the form of a data frame
with three columns representing a station ID, date, and streamflow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pestPredict</code></td>
<td>
<p>is the continuous (daily) estimation of pesticide
concentrations for one or more pesticides at a single site. This should be
in the form of the fourth element of the list returned by <code>fitswavecav</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modRes</code></td>
<td>
<p>is the first element of the list returned by <code>fitswavecav</code> 
and includes the scale parameter for one or more pesticide trend models at
a single site. The scale parameter is used in the bias correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concTrends</code></td>
<td>
<p>the SEAWAVE-Q trend in flow-normalized annual load. Cannot 
be different (computationally) from the trend in flow-normalized annual 
concentration when there is no trend in flow (Oelsner and others, 2017).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrtype</code></td>
<td>
<p>allows one to calculate annual loads based on a calendar 
year or a water year, where a water year is the 12-month period October 1 
through September 30 designated by the calendar year in which it ends. A 
yrtype of 1 represents a calendar year and is the default because that
is the way the original model was developed. A yrtype of 2 represents a
water year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>is the significance level or alpha value for statistical
significance and confidence intervals.</p>
</td>
</tr>
</table>
<h3>Format</h3>

<p>The first data frame returned has one row for each pesticide-year at
a particular site and four columns. The general format is as follows: <br></p>

<table>
<tr>
<td style="text-align: left;">
 pstaid </td>
<td style="text-align: left;"> character </td>
<td style="text-align: left;"> the station identification number </td>
</tr>
<tr>
<td style="text-align: left;">
 pcode </td>
<td style="text-align: left;"> character </td>
<td style="text-align: left;"> the parameter code for which a load was calculated</td>
</tr>
<tr>
<td style="text-align: left;">
 year or wyear </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the year or water year for which a load was calculated </td>
</tr>
<tr>
<td style="text-align: left;">
 load </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load in kilograms per year </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The second data frame returned has one row for each pesticide at
a particular site and 11 columns. The general format is as follows: <br></p>

<table>
<tr>
<td style="text-align: left;">
 pcode </td>
<td style="text-align: left;"> character </td>
<td style="text-align: left;"> the parameter code for which a load trend was calculated</td>
</tr>
<tr>
<td style="text-align: left;">
 mclass </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
<td style="text-align: left;">
 mclass </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
<td style="text-align: left;">
 alpha </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> a significance level </td>
</tr>
<tr>
<td style="text-align: left;">
 ltndPpor </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load trend in percent over the period of record </td>
</tr>
<tr>
<td style="text-align: left;">
 luciPpor </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load upper confidence interval for the trend in</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
<td style="text-align: left;">
 llciPpor </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load lower confidence interval for the trend in</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
<td style="text-align: left;">
 baseLoad </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the base load, the load for the first year of trend period </td>
</tr>
<tr>
<td style="text-align: left;">
 ltndOrigPORPercentBase </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load trend in original units over</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> the period of record</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
<td style="text-align: left;">
 luciOrigPORPercentBase </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load trend upper confidence interval</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
<td style="text-align: left;">
 llciOrigPORPercentBase </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> the load trend lower confidence interval</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
<td style="text-align: left;">
 ltndlklhd </td>
<td style="text-align: left;"> numeric </td>
<td style="text-align: left;"> is the load trend likelihood </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameter load (mass) is the product of water-quality concentration 
(a mass per volume) and an associated streamflow rate (volume per time). This
function generates an annual time series of pesticide loads on either a
calendar year basis or a water year basis and summarizes load trends.
</p>


<h3>Value</h3>

<p>Two data frames, the first contains the annual loads, the second
contains the trend summary.
</p>


<h3>Note</h3>

<p>In this load calculation function, daily pesticide concentration 
estimates provided by the <code>fitswavecav</code> function are corrected for 
retransformation bias (the concentration model is built on the base-10 
logarithm of concentration; therefore, a bias correction is required when 
transforming back to the original units) and then used to calculate daily 
loads. The bias correction is based on the quasi-maximum likelihood estimator 
(Cohn and others, 1989) that was developed for natural logarithms, with an 
adjustment for the base-10 logarithm of the concentration. To calculate 
loads, the bias-corrected concentration estimates (assumed to be in 
micrograms per liter) are multiplied by daily streamflow and a constant, 
0.892998605, which converts the load units 
(micrograms per liter * cubic feet per second) to kilograms per year. 
Daily loads are summed to annual values. See page 70 and equation 26 of 
Oelsner and others (2017) for further details regarding the load 
calculation and bias correction.
Users may modify this function to convert to units other than kilograms
per year.
</p>


<h3>Author(s)</h3>

<p>Karen R. Ryberg
</p>


<h3>References</h3>

<p>Cohn, T.A., DeLong, L.L., Gilroy, E.J., Hirsch, R.M., and Wells, D.K., 1989, 
Estimating constituent loads: Water Resources Research, v. 25, no. 5, 
p. 937–942.
</p>
<p>Oelsner, G.P., Sprague, L.A., Murphy, J.C., Zuellig, R.E., Johnson, H.M., 
Ryberg, K.R., Falcone, J.A., Stets, E.G., Vecchia, A.V., Riskin, M.L., 
De Cicco, L.A., Mills, T.J., and Farmer, W.H., 2017, Water-quality trends in 
the Nation's rivers and streams, 1972–2012—Data preparation, statistical 
methods, and trend results (ver. 2.0, October 2017): U.S. Geological Survey 
Scientific Investigations Report 2017–5006, 136 p., 
<a href="https://doi.org/10.3133/sir20175006">https://doi.org/10.3133/sir20175006</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(swData)
modMoRivOmaha &lt;- combineData(qwdat = qwMoRivOmaha, cqwdat = cqwMoRivOmaha)
myfit1 &lt;- fitswavecav(cdat = modMoRivOmaha, cavdat = cqwMoRivOmaha, 
tanm = "myfit1", pnames = c("04035", "04037", "04041"), yrstart = 1995, 
yrend = 2003, tndbeg = 1995, tndend = 2003, iwcav = c("flowa30", "flowa1"), 
dcol = "dates", qwcols = c("R", "P"))
MoRivOmahaLoadsYr &lt;- loadCalculations(cqwMoRivOmaha[, 1:3], myfit1[[4]], 
myfit1[[1]], myfit1[[6]])
MoRivOmahaLoadsYr
</code></pre>


</div>