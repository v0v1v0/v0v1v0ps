<div class="container">

<table style="width: 100%;"><tr>
<td>add_duration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add duration variables to panel data</h2>

<h3>Description</h3>

<p>Builds a duration version of a data frame representing panel data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_duration(
  data,
  y,
  unitID,
  tID,
  freq = "month",
  sort = FALSE,
  ongoing = TRUE,
  slice.last = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame representing panel data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A binary indicator of the incidence of some event, e.g. a coup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitID</code></td>
<td>
<p>Name of the variable in the data frame identifying the 
cross-sectional units, e.g. <code>"country"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tID</code></td>
<td>
<p>Name of the variable in the data frame identifying the time unit, 
preferably as class <code>Date</code>. E.g. <code>"year"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>Frequency at which units are measured in <code>tID</code>. Currently 
yearly, monthly, and daily data are supported, i.e. <code>"year"</code>, 
<code>"month"</code>, or <code>"day"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Sort data by unit and time? Default is <code>FALSE</code>, i.e. return
data in original order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ongoing</code></td>
<td>
<p>If <code>TRUE</code>, successive 1's are considered ongoing events
and treated as <code>NA</code> after the first 1. If <code>FALSE</code>, successive 1's 
are all treated as failures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slice.last</code></td>
<td>
<p>Set to <code>TRUE</code> to create a slice of the last time 
period; used with <code>forecast.spdur</code>. For compatibility with CRISP 
and ICEWS projects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function processes a panel data frame by creating a failure 
variable from <code>y</code> and corresponding duration counter, as well as 
risk/immunity indicators. Supported time resolutions are year, month, and
day, and input data should be (dis-)aggregated to one of these levels.
</p>
<p>The returned data frame should have the same number of rows at the original. 
If <code>y</code> is an indicator of the incidence of some event, rather than an 
onset indicator, then ongoing spells of failure beyond the initial event are 
coded as NA (e.g. 000111 becomes a spell of 0001 NA NA). This is to preserve
compatibility with the base dataset. Note that the order of rows may be 
different though.
</p>
<p>There cannot be missing values ("<code>NA</code>") in any of the key variables 
<code>y</code>, <code>unitID</code>, or <code>tID</code>; they will stop the function.
</p>
<p>Furthermore, series that start with an event, e.g. (100), are treated as 
experiencing failure in the first time period. If those events are in fact 
ongoing, e.g. the last year of a war that started before the start time of 
the dataset, they should be dropped manually before using 
<code>buildDuration()</code>.
</p>
<p><code>t.0</code> is the starting time of the period of observation at <code>tID</code>. 
It is by default set as <code>duration - 1</code> and currently only serves as a 
placeholder to allow future expansion for varying observation times.
</p>


<h3>Value</h3>

<p>Returns the original data frame with 8 duration-specific additional 
variables:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>failure</code></td>
<td>
<p>Binary indicator of an event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ongoing</code></td>
<td>
<p>Binary indicator for ongoing events, not counting the initial 
failure time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end.spell</code></td>
<td>
<p>Binary indicator for the last observation in a spell, either
due to censoring or failure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cured</code></td>
<td>
<p>Binary indicator for spells that are coded as cured, or immune
from failure. Equal to 1 - <code>atrisk</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atrisk</code></td>
<td>
<p>Binary indicator for spells that are coded as at risk for 
failure. Equal to 1 - <code>cured</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>Binary indicator for right-censored spells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p><code>t</code>, counter for how long a spell has survived without
failure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.0</code></td>
<td>
<p>Starting time for period observed during <code>t</code>, by default
equals <code>duration</code> - 1.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>panel_lag</code> for lagging variables in a panel data frame 
before building duration data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Yearly data
data &lt;- data.frame(y=c(0,0,0,1,0), 
                   unitID=c(1,1,1,1,1), 
                   tID=c(2000, 2001, 2002, 2003, 2004))
dur.data &lt;- add_duration(data, "y", "unitID", "tID", freq="year")
dur.data

</code></pre>


</div>