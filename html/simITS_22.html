<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_series</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth a series using a static loess smoother</h2>

<h3>Description</h3>

<p>Use loess smoother on complete series of residuals including original data
pre-policy and synthetic data post policy (i.e., smooth the entire plausible
series).
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_series(res, outcomename, t0, smooth_k = SMOOTH_K, post.only = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A dataframe with a month column and an 'outcomename' column (which
is the column that will be smoothed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomename</code></td>
<td>
<p>String name of the outcome variable in dat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>last pre-policy timepoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth_k</code></td>
<td>
<p>A rough proxy for the number of observations to primarily
consider to kernal weight in the neighborhood of each timepoint (this is a
bandwidth, and the loess smoother gets smooth_k / n as a span value).  We
want to smooth with an absolute bandwidth, not one as function of how long
the time series is.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.only</code></td>
<td>
<p>If TRUE fit model and smooth post-policy only. WHY fit model
on post-policy data only?  Because this will make sure the fixed pre-policy
does not dominate too much?  We are focusing on post-policy so we want a
good fitting model for that so we can get our residuals as "white noise" as
possible before smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments (not used in this function).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method takes several parameters it does not use, to maintain
compatability with smooth_residuals.
</p>


<h3>Value</h3>

<p>An updated version of the 'res' dataframe with 'Ysmooth', the
smoothed predictions of the original Ystar outcome.  Also includes 'Ystar'
the original sequence to be smoothed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data( "newjersey" )
smooth = smooth_series( newjersey, outcomename = "n.warrant", t0= -8,
                        smooth_k = 30,
                        post.only = FALSE)
plot( newjersey$month, newjersey$n.warrant )
lines( newjersey$month, smooth, col="red" )  

mod =  make_fit_season_model( ~ temperature )
newjersey = add_lagged_covariates( newjersey, outcomename = "n.warrant", 
                                   covariates = c("temperature") )

smooth = smooth_residuals( newjersey, outcomename = "n.warrant", t0=-8,
                           smooth_k = 30,
                           post.only = FALSE,
                           fit_model = mod )
plot( newjersey$month, newjersey$n.warrant )
lines( newjersey$month, smooth, col="red" )  
</code></pre>


</div>