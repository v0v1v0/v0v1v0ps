<div class="container">

<table style="width: 100%;"><tr>
<td>cov.st</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculates spatio-temporal covariance
</h2>

<h3>Description</h3>

<p>Calculates spatial covariance matrix of the observed responses, and 
possibly, the responses to be predicted.  
If <code>pcoords</code> is not provided, then only <code>V</code>, 
the covariance matrix of the observed responses will be returned.  
If <code>pcoords</code> is provided, then <code>Vp</code> and <code>Vop</code> 
(the covariance matrix for predicted responses and between observed and 
predicted responses, respectively) will also be returned.	
</p>


<h3>Usage</h3>

<pre><code class="language-R">	cov.st(coords, time, sp.type = "exponential", 
	    sp.par = stop("specify sp.par argument"),
 	    error.var = 0, smoothness = 0.5, finescale.var = 0, 
	    t.type = "ar1", t.par = .5, 
	    pcoords = NULL, ptime = NULL, 
	    D = NULL, Dp = NULL, Dop = NULL, 
	    T = NULL, Tp = NULL, Top = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">n \times d</code> containing the observed data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">n \times 1</code> containing the times at which the data was observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.type</code></td>
<td>
<p>A character vector specifying the spatial covariance type.  Valid types are currently exponential, gaussian, matern, and spherical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.par</code></td>
<td>
<p>A vector of length 2 specifying the scale and dependence of the covariance function.  The first element refers to the variance of the hidden process (sometimes this is called the partial sill) while the second elements determines the strength of dependence between locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.var</code></td>
<td>
<p>A non-negative number indicating the variance of the error term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothness</code></td>
<td>
<p>A positive number indicating the variance of the error term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>finescale.var</code></td>
<td>
<p>A non-negative positive number indicating the finescale variability.  The is also called the microscale variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.type</code></td>
<td>
<p>A character vector indicating the temporal dependance structure.  Currently, only "ar1" is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.par</code></td>
<td>
<p>A numeric vector of length 1 indicating the strength of temporal dependence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcoords</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">np \times d</code> containing the locations of the responses to be predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptime</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">np \times 1</code> containing the times at which the responses are to be predicted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The Euclidean distance matrix for the coords matrix.  Must be of size <code class="reqn">n \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dp</code></td>
<td>
<p>The Eucliean distance matrix for the pcoords matrix.  Must be of size <code class="reqn">np \times np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dop</code></td>
<td>
<p>The Eucliean intersite distance matrix between the locations in coords and the locations in pcoords.  Must be of size <code class="reqn">n \times np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>The Euclidean distance matrix for the time matrix.  Must be of size <code class="reqn">n \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tp</code></td>
<td>
<p>The Eucliean distance matrix for the ptime matrix.  Must be of size <code class="reqn">np \times np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Top</code></td>
<td>
<p>The Eucliean intertime distance matrix between the times in <code>time</code> and <code>ptime</code>.  Must be of size <code class="reqn">n \times np</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At this point, this function only implements a separable spatio-temporal covariance funcation.  If <code class="reqn">h</code> is the distance between
two sites, and <code class="reqn">t</code> is the temporal lag between the times when the associated responses were observed, then the covariance function
<code class="reqn">C(h,t) = Cs(h) \times Ct(t)</code> where <code class="reqn">Cs</code> is a spatial covariance function corresponding to the 
exponential, matern, gaussian, or spherical and <code class="reqn">Ct</code> is the temporal covariance function corresponding to an ar1 process with 
<code class="reqn">Ct(t) = \phi ^ t</code>.
</p>
<p>The <code>D</code>, <code>Dp</code>, <code>Dop</code>, <code>T</code>, <code>Tp</code>, <code>Top</code> arguments are supplied to decrease the number of necessary computations needed when performing repetitive analysis or simulations.  It is probably in the user's interest to not supply these arguments unless the duration of analysis is an important consideration.  Note that these arguments override the information given in <code>coords</code>, <code>pcoords</code>, <code>time</code>, and <code>prime</code>, i.e., if dist1(coords) != D, then D is used in subsequent calculations, etc.  This could create problems.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p> The covariance matrix for the observed responses. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vp</code></td>
<td>
<p> The covariance matrix for the predicted responses.  Only returned if <code>pcoords</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vp</code></td>
<td>
<p> The covariance matrix between the observed responses and the predicted responses.  Only returned if <code>pcoords</code> is supplied.  Will be of size <code class="reqn">n \times np</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua French</p>


<h3>See Also</h3>

<p><code>simple.cov.sp</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">	coords &lt;- matrix(rnorm(30), ncol = 3)
	pcoords &lt;- matrix(rnorm(90), ncol = 3)
	time &lt;- 1:10
	ptime &lt;- 1:30
	cov.st(coords = coords, time = time, sp.type = "exponential", 
	    sp.par = c(2, 1), error.var = 1, t.type = "ar1", t.par = .5, 
	    pcoords = pcoords, ptime = ptime)
</code></pre>


</div>