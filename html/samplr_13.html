<div class="container">

<table style="width: 100%;"><tr>
<td>sampler_hmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hamiltonian Monte-Carlo Sampler (HMC)</h2>

<h3>Description</h3>

<p>Hamiltonian Monte-Carlo, also called Hybrid Monte Carlo, is a sampling algorithm that uses Hamiltonian Dynamics to approximate a posterior distribution. Unlike MH and MC3, HMC uses not only the current position, but also a sense of momentum, to draw future samples. An introduction to HMC can be read in Betancourt (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampler_hmc(
  start,
  distr_name = NULL,
  distr_params = NULL,
  epsilon = 0.5,
  L = 10,
  iterations = 1024,
  weights = NULL,
  custom_density = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Vector. Starting position of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_name</code></td>
<td>
<p>Name of the distribution from which to sample from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_params</code></td>
<td>
<p>Distribution parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Size of the leapfrog step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of leapfrog steps per iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If using a mixture distribution, the weights given to each constituent distribution. If none given, it defaults to equal weights for all distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_density</code></td>
<td>
<p>Instead of providing names, params and weights, the user may prefer to provide a custom density function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implementations assumes that the momentum is drawn from a normal distribution with mean 0 and identity covariance matrix (p ~ N (0, I)). Hamiltonian Monte Carlo does not support discrete distributions.
</p>
<p>This algorithm has been used to model human data in Aitchison and Lengyel (2016), Castillo et al. (2024) and Zhu et al. (2022) among others.
</p>


<h3>Value</h3>

<p>A named list containing
</p>

<ol>
<li>
<p>Samples: the history of visited places (an n x d matrix, n = iterations; d = dimensions)
</p>
</li>
<li>
<p>Momentums: the history of momentum values (an n x d matrix, n = iterations; d = dimensions). Nothing is proposed in the first iteration (the first iteration is the start value) and so the first row is NA
</p>
</li>
<li>
<p>Acceptance Ratio: The proportion of proposals that were accepted.
</p>
</li>
</ol>
<h3>References</h3>

<p>Aitchison L, Lengyel M (2016).
“The Hamiltonian Brain: Efficient Probabilistic Inference with Excitatory-Inhibitory Neural Circuit Dynamics.”
<em>PLOS Computational Biology</em>, <b>12</b>(12), e1005186.
<a href="https://doi.org/10.1371/journal.pcbi.1005186">doi:10.1371/journal.pcbi.1005186</a>.<br><br> Betancourt M (2018).
“A Conceptual Introduction to Hamiltonian Monte Carlo.”
<a href="http://arxiv.org/abs/1701.02434">http://arxiv.org/abs/1701.02434</a>.<br><br> Castillo L, León-Villagrá P, Chater N, Sanborn A (2024).
“Explaining the Flaws in Human Random Generation as Local Sampling with Momentum.”
<em>PLOS Computational Biology</em>, <b>20</b>(1), 1–24.
<a href="https://doi.org/10.1371/journal.pcbi.1011739">doi:10.1371/journal.pcbi.1011739</a>.<br><br> Zhu J, León-Villagrá P, Chater N, Sanborn AN (2022).
“Understanding the Structure of Cognitive Noise.”
<em>PLoS Computational Biology</em>, <b>18</b>(8), e1010312.
<a href="https://doi.org/10.1371/journal.pcbi.1010312">doi:10.1371/journal.pcbi.1010312</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">result &lt;- sampler_hmc(
    distr_name = "norm", distr_params = c(0,1), 
    start = 1, epsilon = .01, L = 100
    )
cold_chain &lt;- result$Samples
</code></pre>


</div>