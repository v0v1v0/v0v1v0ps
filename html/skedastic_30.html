<div class="container">

<table style="width: 100%;"><tr>
<td>horn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Horn's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the nonparametric test of
Horn (1981) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">horn(
  mainlm,
  deflator = NA,
  restype = c("ols", "blus"),
  alternative = c("two.sided", "greater", "less"),
  exact = (nres &lt;= 10),
  statonly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restype</code></td>
<td>
<p>A character specifying which residuals to use: <code>"ols"</code>
for OLS residuals (the default) or the <code>"blus"</code> for
BLUS residuals. The advantage of using BLUS residuals is
that, under the null hypothesis, the assumption that the random series
is independent and identically distributed is met (whereas with OLS
residuals it is not). The disadvantage of using BLUS residuals is that
only <code class="reqn">n-p</code> residuals are used rather than the full <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character specifying the form of alternative
hypothesis; one of <code>"two.sided"</code> (default), <code>"greater"</code>,
or <code>"less"</code>. <code>"two.sided"</code> corresponds to any trend in the
absolute residuals when ordered by <code>deflator</code>. <code>"greater"</code>
corresponds to a negative trend in the absolute residuals when ordered by
<code>deflator</code>. <code>"less"</code> corresponds to a positive trend in the
absolute residuals when ordered by <code>deflator</code>. (Notice that <code class="reqn">D</code>
tends to be small when there is a positive trend.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>A logical. Should exact <code class="reqn">p</code>-values be computed? If
<code>FALSE</code>, a normal approximation is used. Defaults to <code>TRUE</code>
only if the number of absolute residuals being ranked is <code class="reqn">\le 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional further arguments to pass to <code>blus</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test entails specifying a 'deflator', an explanatory variable
suspected of being related to the error variance. Residuals are ordered
by the deflator and the nonparametric trend statistic
<code class="reqn">D=\sum (R_i - i)^2</code> proposed by
Lehmann (1975) is
then computed on the absolute residuals and used to test for an
increasing or decreasing trend, either of which would correspond to
heteroskedasticity. Exact probabilities for the null distribution of
<code class="reqn">D</code> can be obtained from functions <code>dDtrend</code> and
<code>pDtrend</code>, but since computation time increases rapidly with
<code class="reqn">n</code>, use of a normal approximation is recommended for <code class="reqn">n&gt;10</code>.
Lehmann (1975) proves that <code class="reqn">D</code> is
asymptotically normally distributed and the approximation of the
statistic <code class="reqn">Z=(D-E(D))/\sqrt{V(D)}</code> to the standard normal
distribution is already quite good for <code class="reqn">n=11</code>.
</p>
<p>The expectation and variance of <code class="reqn">D</code> (when ties are absent) are
respectively <code class="reqn">E(D)=\frac{n^3-n}{6}</code> and
<code class="reqn">V(D)=\frac{n^2(n+1)^2(n-1)}{36}</code>; see
Lehmann (1975) for <code class="reqn">E(D)</code> and <code class="reqn">V(D)</code>
when ties are present. When ties are absent, a continuity correction
is used to improve the normal approximation. When
exact distribution is used, two-sided <code class="reqn">p</code>-value is computed by
doubling the one-sided <code class="reqn">p</code>-value, since the distribution of <code class="reqn">D</code>
is symmetric. The function does not support the exact distribution of
<code class="reqn">D</code> in the presence of ties, so in this case the normal approximation
is used regardless of <code class="reqn">n</code>.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Horn P (1981).
“Heteroscedasticity of Residuals: A Non-Parametric Alternative to the Goldfeld-Quandt Peak Test.”
<em>Communications in Statistics - Theory and Methods</em>, <b>10</b>(8), 795–808.<br><br> Lehmann EL (1975).
<em>Nonparametrics: Statistical Methods Based on Ranks</em>.
Holden-Day, San Francisco.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
horn(mtcars_lm, deflator = "qsec")
horn(mtcars_lm, deflator = "qsec", restype = "blus")

</code></pre>


</div>