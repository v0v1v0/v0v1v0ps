<div class="container">

<table style="width: 100%;"><tr>
<td>Q3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of the <code class="reqn">Q_3</code> Statistic (Yen, 1984)
</h2>

<h3>Description</h3>

<p>This function estimates the <code class="reqn">Q_3</code> statistic according to Yen (1984).
The statistic <code class="reqn">Q_3</code> is calculated for every item pair <code class="reqn">(i,j)</code>
which is the correlation between item residuals after fitting the Rasch model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Q3(dat, theta, b, progress=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>An <code class="reqn">N \times I</code> data frame of dichotomous item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Vector of length <code class="reqn">N</code> of person parameter estimates (e.g. obtained from
<code>wle.rasch</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Vector of length <code class="reqn">I</code> (e.g. obtained from <code>rasch.mml2</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Should iteration progress be displayed?
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q3.matrix</code></td>
<td>
<p>An <code class="reqn">I \times I</code> matrix of <code class="reqn">Q_3</code> statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q3.long</code></td>
<td>
<p>Just the <code>q3.matrix</code> in long matrix format where every row
corresponds to an item pair</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>An <code class="reqn">N \times I</code> matrix of expected probabilities
by the Rasch model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual</code></td>
<td>
<p>An <code class="reqn">N \times I</code> matrix of residuals obtained after
fitting the Rasch model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q3.stat</code></td>
<td>
<p>Vector with descriptive statistics of <code class="reqn">Q_3</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yen, W. M. (1984). Effects of local item dependence on the fit and equating
performance of the three-parameter logistic model.
<em>Applied Psychological Measurement, 8</em>, 125-145.
</p>


<h3>See Also</h3>

<p>For the estimation of the average <code class="reqn">Q_3</code> statistic within testlets see
<code>Q3.testlet</code>.
</p>
<p>For modeling testlet effects see <code>mcmc.3pno.testlet</code>.
</p>
<p>For handling local dependencies in IRT models see
<code>rasch.copula2</code>, <code>rasch.pml3</code> or <br><code>rasch.pairwise.itemcluster</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: data.read. The 12 items are arranged in 4 testlets
#############################################################################
data(data.read)

# estimate the Rasch model
mod &lt;- sirt::rasch.mml2( data.read)
# estmate WLEs
mod.wle &lt;- sirt::wle.rasch( dat=data.read, b=mod$item$b )
# calculate Yen's Q3 statistic
mod.q3 &lt;- sirt::Q3( dat=data.read, theta=mod.wle$theta, b=mod$item$b )
  ##   Yen's Q3 Statistic based on an estimated theta score
  ##   *** 12 Items | 66 item pairs
  ##   *** Q3 Descriptives
  ##        M     SD    Min    10%    25%    50%    75%    90%    Max
  ##   -0.085  0.110 -0.261 -0.194 -0.152 -0.107 -0.051  0.041  0.412

# plot Q3 statistics
I &lt;- ncol(data.read)
image( 1:I, 1:I, mod.q3$q3.matrix, col=gray( 1 - (0:32)/32),
        xlab="Item", ylab="Item")
abline(v=c(5,9)) # borders for testlets
abline(h=c(5,9))

## Not run: 
# obtain Q3 statistic from modelfit.sirt function which is based on the
# posterior distribution of theta and not on observed values
fitmod &lt;- sirt::modelfit.sirt( mod )
# extract Q3 statistic
q3stat &lt;- fitmod$itempairs$Q3
  ##  &gt; summary(q3stat)
  ##      Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
  ##  -0.21760 -0.11590 -0.07280 -0.05545 -0.01220  0.44710
  ##  &gt; sd(q3stat)
  ##  [1] 0.1101451

## End(Not run)
</code></pre>


</div>