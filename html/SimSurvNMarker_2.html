<div class="container">

<table style="width: 100%;"><tr>
<td>eval_marker</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast Evaluation of Time-varying Marker Mean Term</h2>

<h3>Description</h3>

<p>Evaluates the marker mean given by
</p>
<p style="text-align: center;"><code class="reqn">\vec\mu(s, \vec u) = \vec o + B^\top\vec g(s) + U^\top\vec m(s).</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">eval_marker(ti, B, g_func, U, m_func, offset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ti</code></td>
<td>
<p>numeric vector with time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>coefficient matrix for time-varying fixed effects.
Use <code>NULL</code> if there is no effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_func</code></td>
<td>
<p>basis function for <code>B</code> like <code>poly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>random effects matrix for time-varying random effects.
Use <code>NULL</code> if there is no effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_func</code></td>
<td>
<p>basis function for <code>U</code> like <code>poly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric vector with non-time-varying fixed effects.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># compare R version with this function
library(SimSurvNMarker)
set.seed(1)
n &lt;- 100L
n_y &lt;- 3L

ti &lt;- seq(0, 1, length.out = n)
offset &lt;- runif(n_y)
B &lt;- matrix(runif(5L * n_y), nr = 5L)
g_func &lt;- function(x)
  cbind(1, x, x^2, x^3, x^4)
U &lt;- matrix(runif(3L * n_y), nr = 3L)
m_func &lt;- function(x)
  cbind(1, x, x^2)

r_version &lt;- function(ti, B, g_func, U, m_func, offset){
  func &lt;- function(ti)
    drop(crossprod(B, drop(g_func(ti))) + crossprod(U, drop(m_func(ti))))

  vapply(ti, func, numeric(n_y)) + offset
}

# check that we get the same
stopifnot(isTRUE(all.equal(
  c(r_version  (ti[1], B, g_func, U, m_func, offset)),
    eval_marker(ti[1], B, g_func, U, m_func, offset))))
stopifnot(isTRUE(all.equal(
  r_version  (ti, B, g_func, U, m_func, offset),
  eval_marker(ti, B, g_func, U, m_func, offset))))

# check the computation time
system.time(replicate(100, r_version  (ti, B, g_func, U, m_func, offset)))
system.time(replicate(100, eval_marker(ti, B, g_func, U, m_func, offset)))

</code></pre>


</div>