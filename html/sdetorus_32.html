<div class="container">

<table style="width: 100%;"><tr>
<td>dTpdWou2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximation of the transition probability density of the WN diffusion in 2D</h2>

<h3>Description</h3>

<p>Computation of the transition probability density (tpd) for a WN diffusion (with diagonal diffusion matrix)
</p>


<h3>Usage</h3>

<pre><code class="language-R">dTpdWou2D(x, x0, t, alpha, mu, sigma, rho = 0, maxK = 2L, expTrc = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of dimension <code>c(n, 2)</code> containing angles. They all must be in <code class="reqn">[\pi,\pi)</code> so that the truncated wrapping by <code>maxK</code> windings is able to capture periodicity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a matrix of dimension <code>c(n, 2)</code> containing the starting angles. They all must be in <code class="reqn">[\pi,\pi)</code>. If all <code>x0</code> are the same, a matrix of dimension <code>c(1, 2)</code> can be passed for better performance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a scalar containing the times separating <code>x</code> and <code>x0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector of length <code>3</code> parametrizing the <code>A</code> matrix as in <code>alphaToA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of length <code>2</code> giving the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of length <code>2</code> containing the <strong>square root</strong> of the diagonal of <code class="reqn">\Sigma</code>, the diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>maximum absolute value of the windings considered in the computation of the WN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expTrc</code></td>
<td>
<p>truncation for exponential: <code>exp(x)</code> with <code>x &lt;= -expTrc</code> is set to zero. Defaults to <code>30</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function checks for positive definiteness. If violated, it resets <code>A</code> such that <code>solve(A) %*% Sigma</code> is positive definite.
</p>
<p>See Section 3.3 in García-Portugués et al. (2019) for details. See <code>dTpdWou</code> for the general case (less efficient for 1D).
</p>


<h3>Value</h3>

<p>A vector of size <code>n</code> containing the tpd evaluated at <code>x</code>.
</p>


<h3>References</h3>

<p>García-Portugués, E., Sørensen, M., Mardia, K. V. and Hamelryck, T. (2019) Langevin diffusions on the torus: estimation and applications. <em>Statistics and Computing</em>, 29(2):1–22. <a href="https://doi.org/10.1007/s11222-017-9790-2">doi:10.1007/s11222-017-9790-2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(3455267)
alpha &lt;- c(2, 1, -1)
sigma &lt;- c(1.5, 2)
rho &lt;- 0.9
Sigma &lt;- diag(sigma^2)
Sigma[1, 2] &lt;- Sigma[2, 1] &lt;- rho * prod(sigma)
A &lt;- alphaToA(alpha = alpha, sigma = sigma, rho = rho)
solve(A) %*% Sigma
mu &lt;- c(pi, 0)
x &lt;- t(euler2D(x0 = matrix(c(0, 0), nrow = 1), A = A, mu = mu,
               sigma = sigma, N = 500, delta = 0.1)[1, , ])

sum(sapply(1:49, function(i) log(dTpdWou(x = matrix(x[i + 1, ], ncol = 2),
                                         x0 = x[i, ], t = 1.5, A = A,
                                         Sigma = Sigma, mu = mu))))

sum(log(dTpdWou2D(x = matrix(x[2:50, ], ncol = 2),
                  x0 = matrix(x[1:49, ], ncol = 2), t = 1.5, alpha = alpha,
                  mu = mu, sigma = sigma, rho = rho)))

lgrid &lt;- 56
grid &lt;- seq(-pi, pi, l = lgrid + 1)[-(lgrid + 1)]
image(grid, grid, matrix(dTpdWou(x = as.matrix(expand.grid(grid, grid)),
                                 x0 = c(0, 0), t = 0.5, A = A,
                                 Sigma = Sigma, mu = mu),
                         nrow = 56, ncol = 56), zlim = c(0, 0.25),
      main = "dTpdWou")
image(grid, grid, matrix(dTpdWou2D(x = as.matrix(expand.grid(grid, grid)),
                                   x0 = matrix(0, nrow = 56^2, ncol = 2),
                                   t = 0.5, alpha = alpha, sigma = sigma,
                                   mu = mu),
                         nrow = 56, ncol = 56), zlim = c(0, 0.25),
      main = "dTpdWou2D")

x &lt;- seq(-pi, pi, l = 100)
t &lt;- 1
image(x, x, matrix(dTpdWou2D(x = as.matrix(expand.grid(x, x)),
                             x0 = matrix(rep(0, 100 * 2), nrow = 100 * 100,
                                         ncol = 2),
                             t = t, alpha = alpha, mu = mu, sigma = sigma,
                             maxK = 2, expTrc = 30),
                             nrow = 100, ncol = 100),
      zlim = c(0, 0.25))
points(stepAheadWn2D(x0 = rbind(c(0, 0)), delta = t / 500,
                     A = alphaToA(alpha = alpha, sigma = sigma), mu = mu,
                     sigma = sigma, N = 500, M = 1000, maxK = 2,
                     expTrc = 30))

</code></pre>


</div>