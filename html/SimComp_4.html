<div class="container">

<table style="width: 100%;"><tr>
<td>DfSattRat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> 
Degrees of Freedom Accoding to Satterthwaite (1946) for Ratios of Means 
</h2>

<h3>Description</h3>

<p>Degrees of freedom accoding to Satterthwaite (1946) for (multivariate)
<em>t</em>-distributions related to multiple contrast tests or corresponding
simultaneous confidence intervals for ratios of means. For contrasts 
representing a two-sample <em>t</em>-test, the degree of freedom coincides 
with the one of Welch (1938).
</p>


<h3>Usage</h3>

<pre><code class="language-R">DfSattRat(n, sd, type = "Dunnett", base = 1, Num.Contrast = NULL, Den.Contrast = NULL,
          Margin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> a vector of numbers of observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p> a vector of standard deviations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li>
<p> "Dunnett": many-to-one comparisons
</p>
</li>
<li>
<p> "Tukey": all-pair comparisons
</p>
</li>
<li>
<p> "Sequen": comparisons of consecutive groups
</p>
</li>
<li>
<p> "AVE": comparison of each group with average of all others
</p>
</li>
<li>
<p> "GrandMean": comparison of each group with grand mean of all
groups
</p>
</li>
<li>
<p> "Changepoint": differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li>
<p> "Marcus": Marcus contrasts
</p>
</li>
<li>
<p> "McDermott": McDermott contrasts
</p>
</li>
<li>
<p> "Williams": Williams trend tests
</p>
</li>
<li>
<p> "UmbrellaWilliams": Umbrella-protected Williams trend tests
</p>
</li>
</ul>
<p>note that <code>type</code> is ignored if <code>Num.Contrast</code> or 
<code>Den.Contrast</code> is specified by the user (see below) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p> a numerator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p> a denominator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin</code></td>
<td>
<p> a single numeric value, or a numeric vector with length equal to
the number of contrasts, default is 1 </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculation of critical values or (adjusted) <em>p</em>-values related to multiple
contrast tests or corresponding simultaneous confidence intervals is based on a
multivariate <em>t</em>-distribution. For homoscedastic data, the respective degree of
freedom only depends on the total sample size and the number of groups. A simple and
well-known special case is the usual <em>t</em>-test. If the data are heteroscedastic,
however, the degree of freedom of a <em>t</em>-test must be decreased according to 
Welch (1938) to come to an approximate solution. Degrees of freedom according to
Satterthwaite (1946) refer to any linear combinations (contrasts) of normal means.
They are applied, for example, when doing multiple contrast tests for heteroscedastic
data according to Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt; or 
Hasler (2014) &lt;doi:10.1515/ijb-2012-0015&gt;. Like Welch (1938), Satterthwaite (1946) 
approximated the degree of freedom by matching first and second moments. The 
resulting degree of freedom then depends on the numerator contrast, the denominator 
contrast, the (relative) margin to test against, and on the sample sizes and sample 
variances per group. If <code>Margin=1</code> or <code>Margin=NULL</code> (default), 
the result coincides with the result of <code>DfSattDiff()</code>.
</p>


<h3>Value</h3>

<p>A vector of degrees of freedom.
</p>


<h3>Note</h3>

<p>The commands <code>SimTestRat()</code> and <code>SimCiRat()</code> use these degrees of freedom 
automatically if <code>covar.equal=FALSE</code> (default). You don't need to apply 
<code>DfSattRat()</code> additionally.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17–28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793–800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Satterthwaite, F.E. (1946): An approximate distribution of estimates of variance
components. <em>Biometrics</em> 2, 110–114.
</p>
<p>Welch, B.L. (1938): The significance of the difference between two means when the
population variances are unequal. <em>Biometrika</em> 29, 350–362.
</p>


<h3>See Also</h3>

 <p><code>DfSattDiff</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1:
# Degrees of freedom for a non-inferiority test of group two and three against group one,
# assuming unequal standard deviations for the groups. This is an extension for the well-
# known Dunnett-test to the case of heteroscedasticity and in terms of ratios of means
# instead of differences.

# Either by specifying the type of contrast:
DfSattRat(n=c(10,6,6), sd=c(1,3,6), type="Dunnett", base=1, Margin=0.8)

# Or by specifying the contrast matrices:
DfSattRat(n=c(10,6,6), sd=c(1,3,6), Num.Contrast=rbind(c(0,1,0),c(0,0,1)),
  Den.Contrast=rbind(c(1,0,0),c(1,0,0)), Margin=0.8)

# Example 2:
# Degrees of freedom for an all-pair comparison of the groups B, H and S on endpoint ADP,
# assuming unequal standard deviations for the groups. This is an extension for the well-
# known Tukey-test to the case of heteroscedasticity and in terms of ratios of means
# instead of differences. The same degrees of freedom are used automatically by command 
# \code{SimTestRat()}.

data(coagulation)

DfSattRat(n=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=length),
  sd=tapply(X=coagulation$ADP, INDEX=coagulation$Group, FUN=sd),
  type="Tukey")
</code></pre>


</div>