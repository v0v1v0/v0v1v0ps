<div class="container">

<table style="width: 100%;"><tr>
<td>make.trait.model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model for trait evolution across the phylogeny</h2>

<h3>Description</h3>

<p>Create a model that dictates how a discrete or continuous trait evolves and affects the diversification of the phylogeny. This function creates a list that dictates how the trait affects hybridizations, how the trait is changes over time, and how the trait is inherited across speciation and hybridization events.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.trait.model(
  initial_states,
  hyb.event.fxn,
  hyb.compatibility.fxn,
  time.fxn = NULL,
  spec.fxn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>initial_states</code></td>
<td>
<p>the initial state on the phylogeny. if simulating networks with <code>twolineages=TRUE</code> then a vector of length two will be required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyb.event.fxn</code></td>
<td>
<p>A function that describes how the trait changes after hybridization events. See Details for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyb.compatibility.fxn</code></td>
<td>
<p>A function that describes whether hybridization events can occur between taxa based on their trait values. See Details for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.fxn</code></td>
<td>
<p>A function that describes how trait values changes over time. See Details for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.fxn</code></td>
<td>
<p>A function that describes how trait values change at speciation events. See Details for more information</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hyb.event.fxn</code> is a function that denotes the trait value of a hybrid child after a hybridization event. The function should have the argument <code>parent_states</code>, a vector with the trait states of the two parents to the hybrid child and <code>inheritance</code>. <code>parent_states</code> is vector with the states of the hybrid parents while <code>inheritance</code> is the inheritance probability of the first lineage denoted in <code>parent_states</code>. The function should return a single value for the trait state of the hybrid child.
</p>
<p><code>hyb.compatibility.fxn</code> describes when hybridization events can occur between two taxa based on their trait values. The function should have the arguments <code>parent_states</code>.  The function should return <code>TRUE</code> for when a hybridization event is allowed to proceed and <code>FALSE</code> otherwise.
</p>
<p><code>time.fxn</code> is a function that describes how trait values change over time. The function should have the arguments <code>trait_states</code> and <code>timestep</code> in that order. <code>trait_states</code> is a vector containing the ploidy of all taxa while <code>timestep</code> is the amount of time given for ploidy evolution. The function should return a vector with the updated ploidy states of all taxa.
The default value of <code>NULL</code> indicates that trait values will not evolve within a lineage over time. <strong>NOTE:</strong> Values can still change at speciation or hybridization events if allowed.
</p>
<p><code>spec.fxn</code> is a function that describes how trait values change at speciation events. The function should have the argument <code>tip_state</code> which has the state of the lineage just before speciation. The function should return a vector with two values, one denoting the trait of each of the two new species after the event.
The default value of <code>NULL</code> causes the two children lineage to inherit the same trait value as the parental lineage
</p>


<h3>Value</h3>

<p>A model for trait evolution to be used as the <code>trait.model</code> argument in a 'sim.bdh functionâ€œ
</p>


<h3>Examples</h3>

<pre><code class="language-R">initial_val&lt;-2 ## The root starts off at 2N

###function for what happens at hybridization event
hyb_e_fxn &lt;- function(parent_states,inheritance){
 ##For allopolyploidy we add the ploidy of both parents
 return(sum(parent_states))
}

##Function for determining whether hybridization occurs
hyb_c_fxn &lt;-function(parent_states,hybrid_state){
 ##Hybridization occurs only when the ploidy is the same
 return(parent_states[1]==parent_states[2])
}


##Function for how the trait changes over time
t_fxn &lt;- function(trait_states,timestep){
 ##We assume that autopolyploidy occur exponentially with rate lambda
 lambda&lt;- 2 ##Rate of autopolyploidy

 ##The number of autopolyploidy events that occur on each lineage over the timestep
 nevents&lt;-rpois(length(trait_states),timestep)

 ##each event doubles the ploidy
 new_states&lt;- trait_states * (2^nevents)
 return(new_states)
}

##Function for how the trait changes at speciation events
s_fxn &lt;-function(tip_state){
 ##Ploidy doesn't change at speciation events.
 ##Both daughter lineages have the same ploidy as the parent
 return(c(tip_state,tip_state))
}

trait_model&lt;-make.trait.model(initial_states = initial_val,
                             hyb.event.fxn = hyb_e_fxn,
                             hyb.compatibility.fxn = hyb_c_fxn,
                             time.fxn = t_fxn,
                             spec.fxn = s_fxn)

</code></pre>


</div>