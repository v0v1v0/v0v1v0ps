<div class="container">

<table style="width: 100%;"><tr>
<td>n.nb.gf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size Calculation for Comparing Two Groups when observing Longitudinal Count Data with marginal Negative Binomial Distribution and underlying Gamma Frailty with Autoregressive Correlation Structure of Order One</h2>

<h3>Description</h3>

<p><code>n.nb.gf</code> calculates required sample sizes for testing trend parameters in a Gamma frailty model
</p>


<h3>Usage</h3>

<pre><code class="language-R">n.nb.gf(
  alpha = 0.025,
  power = 0.8,
  lambda,
  size,
  rho,
  tp,
  k = 1,
  h,
  hgrad,
  h0,
  trend = c("constant", "exponential", "custom"),
  approx = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power (1 - type II error) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the set of trend parameters assumed to be true at the beginning prior to trial onset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>dispersion parameter (the shape parameter of the gamma mixing distribution). Must be strictly positive, need not be integer (see <code>rnbinom.gf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of the autoregressive correlation structure of the underlying Gamma frailty. Must be between 0 and 1 (see <code>rnbinom.gf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp</code></td>
<td>
<p>number of observed time points. (see <code>rnbinom.gf</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>hypothesis to be tested. The function must return a single value when evaluated on lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hgrad</code></td>
<td>
<p>gradient of function h</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>the value against which h is tested, see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>the trend which assumed to underlying in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>numer of iterations in numerical calculation of the sandwich estimator, see 'Details'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates required samples sizes for testing trend parameters of trends in longitudinal negative binomial data. The underlying
one-sided null-hypothesis is defined by <code class="reqn">H_0: h(\eta, \lambda) \geq h_0</code> vs. the alternative <code class="reqn">H_A: h(\eta, \lambda) &lt; h_0</code>. For testing
these hypothesis, the program therefore requires a function <code>h</code> and a value <code>h0</code>.
</p>
<p><code>n.nb.gf</code> gives back the required sample size for the control and treatment group, to prove an existing alternative <code class="reqn">h(\eta, \lambda) - h_0</code>
with a power of <code>power</code> when testing at level <code>alpha</code>. For sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the
sample size allocation factor, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>
<p>When calculating the expected sandwich estimator required for the sample size, certain terms can not be computed analytically and have
to be approximated numerically. The value <code>approx</code> defines how close the approximation is to the true expected sandwich estimator.
High values of <code>approx</code> provide better approximations but are compuationally more expensive.
</p>


<h3>Value</h3>

<p><code>n.nb.gf</code> returns the required sample size within the control group and treatment group.
</p>


<h3>Source</h3>

<p><code>n.nb.gf</code> uses code contributed by Thomas Asendorf.
</p>


<h3>See Also</h3>

<p><code>rnbinom.gf</code> for information on the Gamma frailty model, <code>fit.nb.gf</code> for calculating
initial parameters required when performing sample size estimation, <code>bssr.nb.gf</code> for blinded
sample size reestimation within a running trial.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##The example is commented as it may take longer than 10 seconds to run.
##Please uncomment prior to execution.

##Example for constant rates
#h&lt;-function(lambda.eta){
#   lambda.eta[2]
#}
#hgrad&lt;-function(lambda.eta){
#   c(0, 1, 0)
#}

##We assume the rate in the control group to be exp(lambda[1]) = exp(0) and an
##effect of lambda[2] = -0.3. The \code{size} is assumed to be 1 and the correlation
##coefficient \code{\rho} 0.5. At the end of the study, we would like to test
##the treatment effect specified in lambda[2], and therefore define function
##\code{h} and value \code{h0} accordingly.

#estimate&lt;-n.nb.gf(lambda=c(0,-0.3), size=1, rho=1, tp=6, k=1, h=h, hgrad=hgrad,
#   h0=0.2, trend="constant", approx=20)
#summary(estimate)

##Example for exponential trend
#h&lt;-function(lambda.eta){
#   lambda.eta[3]
#}
#hgrad&lt;-function(lambda.eta){
#   c(0, 0, 1, 0)
#}

#estimate&lt;-n.nb.gf(lambda=c(0, 0, -0.3/6), size=1, rho=0.5, tp=7, k=1, h=h, hgrad=hgrad,
#   h0=0, trend="exponential", approx=20)
#summary(estimate)

</code></pre>


</div>