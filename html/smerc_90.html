<div class="container">

<table style="width: 100%;"><tr>
<td>rflex.zones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine zones for flexibly shaped spatial scan test</h2>

<h3>Description</h3>

<p><code>rflex.zones</code> determines the unique zones to
consider for the flexibly shaped spatial scan test of
Tango and Takahashi (2012).  The algorithm uses a
breadth-first search to find all subgraphs connected to
each vertex (region) in the data set of size <code class="reqn">k</code> or
less with the constraint that the middle p-value of each
region must be less than <code>alpha1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rflex.zones(
  nn,
  w,
  cases,
  ex,
  alpha1 = 0.2,
  type = "poisson",
  pop = NULL,
  cl = NULL,
  loop = FALSE,
  verbose = FALSE,
  pfreq = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>An n by k matrix providing the k nearest
neighbors of each region, presumably produced by the
<code>knn</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A binary spatial adjacency matrix for the
regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>
<p>The middle p-value threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of scan statistic to compute. The
default is <code>"poisson"</code>. The other choice
is <code>"binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.  The default is <code>NULL</code> since this argument
is only needed for <code>type = "binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loop</code></td>
<td>
<p>A logical value indicating whether a loop
should be used to implement the function instead of
<code>pbapply</code>.  The default is
<code>FALSE</code>. If <code>TRUE</code>, then memory-saving steps
are also taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value indicating whether
progress messages should be provided.
The default is <code>FALSE</code>.  If both <code>loop</code> and
<code>verbose</code> are <code>TRUE</code>, informative messages
are displayed that can be useful for diagnosing where
the sequences of connected subgraphs are slowing down
or having problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfreq</code></td>
<td>
<p>The frequency that messages are reported
from the loop (if <code>verbose = TRUE</code>). The default
is <code>pfreq = 1</code>, meaning a message is returned for
each index of the loop.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of zones to consider for
clustering.  Each element of the list contains a vector
with the location ids of the regions in that zone.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Tango, T. and Takahashi, K. (2012), A
flexible spatial scan statistic with a restricted
likelihood ratio for detecting disease clusters.
Statist. Med., 31: 4207-4218. &lt;doi:10.1002/sim.5478&gt;
</p>


<h3>See Also</h3>

<p>rflex.midp
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
data(nyw)
coords &lt;- cbind(nydf$x, nydf$y)
nn &lt;- knn(coords, k = 5)
cases &lt;- floor(nydf$cases)
pop &lt;- nydf$pop
ex &lt;- pop * sum(cases) / sum(pop)
# zones for poisson model
pzones &lt;- rflex.zones(nn, w = nyw, cases = cases, ex = ex)
## Not run: 
pzones &lt;- rflex.zones(nn,
  w = nyw, cases = cases,
  ex = ex, verbose = TRUE
)
# zones for binomial model
bzones &lt;- rflex.zones(nn,
  w = nyw, cases = cases, ex = ex,
  type = "binomial", pop = pop
)

## End(Not run)
</code></pre>


</div>