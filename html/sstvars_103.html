<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.stvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate method for class 'stvar' objects</h2>

<h3>Description</h3>

<p><code>simulate.stvar</code> is a simulate method for class 'stvar' objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'stvar'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  ...,
  init_values = NULL,
  init_regime,
  ntimes = 1,
  burn_in = 1000,
  exo_weights = NULL,
  drop = TRUE,
  girf_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>'stvar'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of observations to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set seed for the random number generator?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not in use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_values</code></td>
<td>
<p>a size <code class="reqn">(p\times d)</code> matrix specifying the initial values, where d is the number
of time series in the system. The <strong>last</strong> row will be used as initial values for the first lag,
the second last row for second lag etc. If not specified, initial values will be drawn from
the regime specified in <code>init_regimes</code> (for Gaussian models only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_regime</code></td>
<td>
<p>an integer in <code class="reqn">1,...,M</code> specifying the regime from which
the initial values should be generated from. The initial values will be generated
from the stationary distribution of the specific regime. Due to the lack of
knowledge of the stationary distribution, models with other than Gaussian conditional distribution
uses a simulation procedure with a burn-in period. See the details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntimes</code></td>
<td>
<p>how many sets of simulations should be performed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>Burn-in period for simulating initial values from a regime when <code>cond_dist!="Gaussian"</code>.
See the details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exo_weights</code></td>
<td>
<p>if <code>weight_function="exogenous"</code>, provide a size <code class="reqn">(nsim \times M)</code> matrix of exogenous
transition weights for the regimes: <code>[t, m]</code> for a time <code class="reqn">t</code> and regime <code class="reqn">m</code> weight. Ignored
if <code>weight_function!="exogenous"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>if <code>TRUE</code> (default) then the components of the returned list are coerced to lower dimension if
<code>ntimes==1</code>, i.e., <code>$sample</code> and <code>$transition_weights</code> will be matrices, and <code>$component</code>
will be vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>girf_pars</code></td>
<td>
<p>This argument is used internally in the estimation of generalized impulse response functions
(see <code>?GIRF</code>). You should ignore it (specifying something else than null to it will change how the function behaves).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The stationary distribution of each regime is not known when <code>cond_dist!="Gaussian"</code>. Therefore, when using
<code>init_regime</code> to simulate the initial values from a given regime, we employ the following simulation procedure to
obtain the initial values. First, we set the initial values to the unconditional mean of the specified regime. Then,
we simulate a large number observations from that regime as specified in the argument <code>burn_in</code>. Then, we simulate
<code class="reqn">p + 100</code> observations more after the burn in period, and for the <code class="reqn">100</code> observations calculate the transition
weights for them and take the consecutive <code class="reqn">p</code> observations that yield the highest transition weight for the given regime.
For models with exogenous transition weights, takes just the last <code class="reqn">p</code> observations after the burn-in period.
</p>
<p>The argument <code>ntimes</code> is intended for forecasting, which is used by the predict method (see <code>?predict.stvar</code>).
</p>


<h3>Value</h3>

<p>Returns a list containing the simulation results. If <code>drop==TRUE</code> and <code>ntimes==1</code> (default),
contains the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>a size (<code>nsim</code><code class="reqn">\times d</code>) matrix containing the simulated time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transition weights:</code></td>
<td>
<p>a size (<code>nsim</code><code class="reqn">\times M</code>) matrix containing the transition weights corresponding
to the simulated sample.</p>
</td>
</tr>
</table>
<p>Otherwise, returns a list with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$sample</code></td>
<td>
<p>a size (<code>nsim</code><code class="reqn">\times d\times</code><code>ntimes</code>) array containing the samples: the dimension
<code>[t, , ]</code> is the time index, the dimension <code>[, d, ]</code> indicates the marginal time series, and the dimension
<code>[, , i]</code> indicates the i:th set of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$transition_weights</code></td>
<td>
<p>a size (<code>nsim</code><code class="reqn">\times M \times</code><code>ntimes</code>) array containing the transition weights
corresponding to the sample: the dimension <code>[t, , ]</code> is the time index, the dimension <code>[, m, ]</code> indicates the
regime, and the dimension <code>[, , i]</code> indicates the i:th set of simulations.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Anderson H., Vahid F. 1998. Testing multiple equation systems for common nonlinear components.
<em>Journal of Econometrics</em>, <strong>84</strong>:1, 1-36.
</p>
</li>
<li>
<p> Kheifets I.L., Saikkonen P.J. 2020. Stationarity and ergodicity of Vector STAR models.
<em>Econometric Reviews</em>, <strong>39</strong>:4, 407-414.
</p>
</li>
<li>
<p> Lanne M., Virolainen S. 2024. A Gaussian smooth transition vector autoregressive model:
An application to the macroeconomic effects of severe weather shocks. Unpublished working
paper, available as arXiv:2403.14216.
</p>
</li>
<li>
<p> Lütkepohl H. 2005. New Introduction to Multiple Time Series Analysis,
<em>Springer</em>.
</p>
</li>
<li>
<p> McElroy T. 2017. Computation of vector ARMA autocovariances.
<em>Statistics and Probability Letters</em>, <strong>124</strong>, 92-96.
</p>
</li>
<li>
<p> Kilian L., Lütkepohl H. 20017. Structural Vector Autoregressive Analysis. 1st edition.
<em>Cambridge University Press</em>, Cambridge.
</p>
</li>
<li>
<p> Tsay R. 1998. Testing and Modeling Multivariate Threshold Models.
<em>Journal of the American Statistical Association</em>, <strong>93</strong>:443, 1188-1202.
</p>
</li>
<li>
<p> Virolainen S. 2024. Identification by non-Gaussianity in structural threshold and
smooth transition vector autoregressive models. Unpublished working
paper, available as arXiv:2404.19707.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>predict.stvar</code>,<code>GIRF</code>, <code>GFEVD</code>,  <code>fitSTVAR</code>,
<code>fitSSTVAR</code> <code>STVAR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Gaussian STVAR(p=2, M=2) model with weighted relative stationary densities
 # of the regimes as the transition weight function:
 theta_222relg &lt;- c(0.356914, 0.107436, 0.356386, 0.08633, 0.13996, 0.035172,
   -0.164575, 0.386816, 0.451675, 0.013086, 0.227882, 0.336084, 0.239257, 0.024173,
   -0.021209, 0.707502, 0.063322, 0.027287, 0.009182, 0.197066, 0.205831, 0.005157,
   0.025877, 1.092094, -0.009327, 0.116449, 0.592446)
 mod222relg &lt;- STVAR(data=gdpdef, p=2, M=2, d=2, params=theta_222relg,
   weight_function="relative_dens")

 # Simulate T=200 observations using given initial values:
 init_vals &lt;- matrix(c(0.5, 1.0, 0.5, 1), nrow=2)
 sim1 &lt;- simulate(mod222relg, nsim=200, seed=1, init_values=init_vals)
 plot.ts(sim1$sample) # Sample
 plot.ts(sim1$transition_weights) # Transition weights

 # Simulate T=100 observations, with initial values drawn from the stationary
 # distribution of the 1st regime:
 sim2 &lt;- simulate(mod222relg, nsim=200, seed=1, init_regime=1)
 plot.ts(sim2$sample) # Sample
 plot.ts(sim2$transition_weights) # Transition weights

# Logistic Student's t STVAR with p=1, M=2, and the first lag of the second variable
# as the switching variable.
params12 &lt;- c(0.62906848, 0.14245295, 2.41245785, 0.66719269, 0.3534745, 0.06041779, -0.34909745,
  0.61783824, 0.125769, -0.04094521, -0.99122586, 0.63805416, 0.371575, 0.00314754, 0.03440824,
  1.29072533, -0.06067807, 0.18737385, 1.21813844, 5.00884263, 7.70111672)
fit12 &lt;- STVAR(data=gdpdef, p=1, M=2, params=params12, weight_function="logistic",
  weightfun_pars=c(2, 1), cond_dist="Student")

# Simulate T=100 observations with initial values drawn from the second regime.
# Since the stationary distribution of the Student's regime is not known, we
# use a simulation procedure that starts from the unconditional mean of the regime,
# then simulates a number of observations from the regime for a "burn-in" period,
# and finally takes the last p observations generated from the regime as the initial
# values for the simulation from the STVAR model:
sim3 &lt;- simulate(fit12, nsim=100, init_regime=1, burn_in=1000)
plot.ts(sim3$sample) # Sample
plot.ts(sim3$transition_weights) # Transition weights
</code></pre>


</div>