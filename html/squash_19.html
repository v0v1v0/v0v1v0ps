<div class="container">

<table style="width: 100%;"><tr>
<td>matapply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Apply a function over z coordinates, binned by their x, y coordinates</h2>

<h3>Description</h3>

<p>Divide the range of x and y into intervals, thus forming a matrix of bins, and apply an arbitrary function to the z values corresponding to each bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matapply(x, y = NULL, z = NULL, FUN,  
         nx = 50, ny = nx, 
         xlim = NULL, ylim = NULL, 
         xbreaks = NULL, ybreaks = NULL, 
         right = FALSE, include.lowest = TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y, z</code></td>
<td>
<p> Numeric vectors, or possibly a matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p> Function to summarize z values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx, ny</code></td>
<td>
<p> Approximate number of bins along x and y axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p> Limit the range of data points considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xbreaks, ybreaks</code></td>
<td>
<p> Breakpoints between bins along x and y axes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p> Logical; if TRUE, the intervals will be closed on the right (and open on the left). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.lowest</code></td>
<td>
<p> Logical, indicating if an <code>x[i]</code> equal to the lowest (or highest, for right = FALSE) <code>breaks</code> value should be included. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments to <code>FUN</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>x</code>, <code>y</code> and <code>z</code> values can be passed to <code>squash</code> in any form recognized by <code>xyz.coords</code> (e.g. individual vectors, list, data frame, formula).
</p>
<p>Alternatively, data that is already in a matrix can be passed in any format recognized by <code>xyzmat.coords</code>.
</p>
<p><code>FUN</code> should accept a numeric vector and return a single numeric value (e.g. <code>mean</code>, <code>median</code>, <code>min</code>, <code>max</code>, <code>sd</code>).
</p>
<p>If <code>xbreaks</code> is not specified, approximately <code>nx</code> breakpoints will be generated automatically to span the data; likewise for <code>ybreaks</code> and <code>ny</code>.
</p>
<p>The output can be visualized with <code>colorgram</code>, <code>image</code>, etc.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>Vector of breakpoints along the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>Vector of breakpoints along the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z </code></td>
<td>
<p>Matrix of values representing the summary for each bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab </code></td>
<td>
<p>A label for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab </code></td>
<td>
<p>A label for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlab </code></td>
<td>
<p>A label for the z-axis.</p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>The defaults of <code>right</code> and <code>include.lowest</code> are opposite the defaults used in <code>cut</code>.
</p>


<h3>See Also</h3>

  
<p>This function is essentially a souped-up version of <code>tapply</code>.
</p>
<p><code>squashgram</code> has similar functionality but with graphical output.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## earthquake depths as a function of longitude, latitude
  attach(quakes)
  quakedepth &lt;- matapply(depth ~ long + lat, FUN = mean)
  colorgram(quakedepth)

  ## iris petal length vs. sepal length and width
  ipl &lt;- matapply(iris[,1:3], FUN = median, nx = 20, ny = 15 )
  colorgram(ipl, main = 'iris')
    
  ## Example of matrix input; here used to downsample an image 
  colorgram(volcano, colFn = terrain.colors)
  volcano2 &lt;- matapply(volcano, FUN = mean, nx = 20)
  colorgram(volcano2, colFn = terrain.colors)
  
</code></pre>


</div>