<div class="container">

<table style="width: 100%;"><tr>
<td>comets</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comet orbits</h2>

<h3>Description</h3>

<p>Comet orbits data from the
<a href="https://ssd.jpl.nasa.gov/tools/sbdb_query.html">
JPL Small-Body Database Search Engine</a>. The normal vector of a comet orbit
represents is a vector on <code class="reqn">S^2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">comets
</code></pre>


<h3>Format</h3>

<p>A data frame with 3798 rows and 13 variables:
</p>

<dl>
<dt>id</dt>
<dd>
<p>database ID.</p>
</dd>
<dt>spkid</dt>
<dd>
<p>object primary SPK-ID.</p>
</dd>
<dt>full_name</dt>
<dd>
<p>full name/designation following the
<a href="https://www.iau.org/public/themes/naming/#comets">
IUA naming convention</a>.</p>
</dd>
<dt>pdes</dt>
<dd>
<p>object primary designation.</p>
</dd>
<dt>frag</dt>
<dd>
<p>flag indicating if the record is a comet fragment.</p>
</dd>
<dt>diameter</dt>
<dd>
<p>diameter from equivalent sphere (in km).</p>
</dd>
<dt>i</dt>
<dd>
<p>inclination; the orbit's plane angle with respect to the
ecliptic plane, in radians in <code class="reqn">[0, \pi]</code>.</p>
</dd>
<dt>om</dt>
<dd>
<p>longitude of the ascending node; the counterclockwise angle from
the vector pointing to the First Point of Aries and that pointing to
the ascending node (the intersection between orbit and ecliptic plane), in
radians in <code class="reqn">[0, 2\pi)</code>. (Both vectors are heliocentric and within
the ecliptic plane.)</p>
</dd>
<dt>per_y</dt>
<dd>
<p>sidereal orbital period (in years).</p>
</dd>
<dt>class</dt>
<dd>
<p>orbit classification. A factor with levels given below.</p>
</dd>
<dt>e</dt>
<dd>
<p>eccentricity of the orbit.</p>
</dd>
<dt>a</dt>
<dd>
<p>semi-major axis of the orbit (in AU).</p>
</dd>
<dt>w</dt>
<dd>
<p>argument of perihelion; the (shortest) angle between the vector
pointing to the ascending node and that pointing to the perihelion
(nearest orbit point to the Sun), in radians in <code class="reqn">[0, \pi]</code>. (Both
vectors are heliocentric and within the orbit's plane.)</p>
</dd>
<dt>first_obs, last_obs</dt>
<dd>
<p><code>Date</code> of the first and
last recorded observations used in the orbit fit.</p>
</dd>
<dt>ccf09</dt>
<dd>
<p>flag indicating if the comet was considered in the data
application in Cuesta-Albertos et al. (2009); see details below.</p>
</dd>
</dl>
<h3>Details</h3>

<p>The normal vector to the ecliptic plane of the comet with inclination
<code class="reqn">i</code> and longitude of the ascending node <code class="reqn">\omega</code> is
</p>
<p style="text-align: center;"><code class="reqn">(\sin(i) \sin(\omega), -\sin(i) \cos(\omega), \cos(i))'.</code>
</p>

<p>A prograde comet has positive <code class="reqn">\cos(i)</code>, negative
<code class="reqn">\cos(i)</code> represents a retrograde comet.
</p>
<p><code>class</code> has the following levels:
</p>

<ul>
<li> <p><code>COM</code>: comet orbit not matching any defined orbit class.
</p>
</li>
<li> <p><code>CTc</code>: Chiron-type comet, as defined by Levison and Duncan
(T_Jupiter &gt; 3; a &gt; a_Jupiter).
</p>
</li>
<li> <p><code>ETc</code>: Encke-type comet, as defined by Levison and Duncan
(T_Jupiter &gt; 3; a &lt; a_Jupiter).
</p>
</li>
<li> <p><code>HTC</code>: Halley-type comet, classical definition (20y &lt; P &lt; 200y).
</p>
</li>
<li> <p><code>HYP</code>: comets on hyperbolic orbits.
</p>
</li>
<li> <p><code>JFc</code>: Jupiter-family comet, as defined by Levison and Duncan
(2 &lt; T_Jupiter &lt; 3).
</p>
</li>
<li> <p><code>JFC</code>: Jupiter-family comet, classical definition (P &lt; 20y).
</p>
</li>
<li> <p><code>PAR</code>: comets on parabolic orbits.
</p>
</li>
</ul>
<p>Hyperbolic and parabolic comets are not periodic; only elliptical comets
are periodic.
</p>
<p>The <code>ccf09</code> variable gives the observations considered in
Cuesta-Albertos et al. (2009) after fetching in the database in 2007-12-14
for the comets such that <code>!(class %in% c("HYP", "PAR")) &amp;
per_y &gt;= 200</code>. Due to the dynamic nature of the data, more comets were added
to the database since 2007 and also some past records were updated.
</p>
<p>The script performing the data preprocessing is available at
<a href="https://github.com/egarpor/sphunif/blob/master/data-raw/comets.R">
<code>comets.R</code></a>. The data was retrieved on 2022-05-28. A previous version
of this dataset based on the old NASA's JPL Database (accessed on
2020-05-07) is available at
<a href="https://github.com/egarpor/sphunif/blob/master/data-raw/comets-old.rda">
<code>comets-old.rda</code></a> and was obtained with
<a href="https://github.com/egarpor/sphunif/blob/master/data-raw/comets-old.R">
<code>comets-old.R</code></a>.
</p>


<h3>Source</h3>

<p><a href="https://ssd.jpl.nasa.gov/tools/sbdb_query.html">https://ssd.jpl.nasa.gov/tools/sbdb_query.html</a>
</p>


<h3>References</h3>

<p>Cuesta-Albertos, J. A., Cuevas, A., Fraiman, R. (2009) On projection-based
tests for directional and compositional data. <em>Statistics and
Computing</em>, 19:367â€“380. <a href="https://doi.org/10.1007/s11222-008-9098-3">doi:10.1007/s11222-008-9098-3</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data("comets")

# Add normal vectors
comets$normal &lt;- cbind(sin(comets$i) * sin(comets$om),
                       -sin(comets$i) * cos(comets$om),
                       cos(comets$i))

# Tests to be performed
type_tests &lt;- c("PCvM", "PAD", "PRt")

# Excluding the C/1882 R1-X (Great September comet) records with X = B, C, D
comets_ccf09 &lt;- comets[comets$ccf09, ][-c(13:15), ]

# Sample size
nrow(comets_ccf09)

# Tests for the data in Cuesta-Albertos et al. (2009)
tests_ccf09 &lt;- unif_test(data = comets_ccf09$normal, type = type_tests,
                         p_value = "asymp")
tests_ccf09
</code></pre>


</div>