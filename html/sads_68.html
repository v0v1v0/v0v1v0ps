<div class="container">

<table style="width: 100%;"><tr>
<td>fitsad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML fitting of species abundance distributions</h2>

<h3>Description</h3>

<p>Fits probability distributions for
abundances of species in a sample or assemblage by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitsad(x, sad = c("bs","exp", "gamma","geom","lnorm","ls","mzsm","nbinom","pareto",
       "poilog","power", "powbend", "volkov","weibull"), ...)

fitbs(x, trunc, ...)

fitexp(x, trunc = NULL, start.value, ...)

fitgamma(x, trunc, start.value,  ...)

fitgeom(x, trunc = 0, start.value, ...)

fitlnorm(x, trunc, start.value,  ...)

fitls(x, trunc, start.value, upper = length(x), ...)

fitmzsm(x, trunc, start.value, upper = length(x), ...)

fitnbinom(x, trunc = 0, start.value, ...)

fitpareto(x, trunc, start.value,  upper = 20, ...)

fitpoilog(x, trunc = 0, ...)

fitpower(x, trunc, start.value, upper = 20, ...)

fitpowbend(x, trunc, start.value, ...)

fitvolkov(x, trunc, start.value, ...)

fitweibull(x, trunc, start.value,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of (positive integer) quantiles. In the context of
SADs, some abundance measurement (e.g., number of individuals,
biomass) of species in a sample or ecological assemblage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad</code></td>
<td>

<p>character; root name of community sad distribution to be fitted.
<kbd>"bs"</kbd> for broken-stick distribution,
<kbd>"exp"</kbd> for exponential distribution,
<kbd>"gamma"</kbd> for gamma distribution,
<kbd>"geom"</kbd> for geometric distributions (not geometric series rad model,
<code>dgs</code>),
<kbd>"lnorm"</kbd> for lognormal,
<kbd>"ls"</kbd> for Fisher's log-series,
<kbd>"mzsm"</kbd> for Alonso &amp; McKane's neutral metacommunity distribution,
<kbd>"nbinom"</kbd> for negative binomial,
<kbd>"pareto"</kbd> for Pareto distribution,
<kbd>"poilog"</kbd> for Poisson-lognormal distribution,
<kbd>"power"</kbd> for power-law distribution,
<kbd>"powbend"</kbd> for Pueyo's power-bend distribution,
<kbd>"volkov"</kbd> for Volkov's et al. neutral community distribution,
<kbd>"weibull"</kbd> for Weibull distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution. For "poilog", "geom" and "nbinom" set
trunc=NULL to avoid zero-truncation (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.value</code></td>
<td>

<p>named numeric vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function,
and in the same order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>real positive; upper bound for Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>in <code>fitsad</code> further arguments to be passed to the specific fitting
function (most used are <code>trunc</code>, <code>start.value</code>)
In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

 <p><code>fitsad</code> is simply a wrapper that calls the specific
functions to fit the distribution chosen with the argument
<code>sad</code>. Users can interchangeably use <code>fitsad</code> or the
individual functions detailed below (e.g. <code>fitsad(x, sad="geom",
  ...)</code> is the same as <code>fitgeom(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the maximum likelihood method using
numerical optimization, with <code>mle2</code>.  The resulting object is of
<code>fitsad-class</code> which can be handled with <code>mle2</code> methods for
fitted models and has also some additional methods for SADs models
(see <code>fitsad-class</code> and examples).
</p>
<p>Functions <code>fitexp</code>, <code>fitgamma</code>, <code>fitlnorm</code> and
<code>fitweibull</code> fit the standard continuous distributions most used
as SADs models.  As species with null abundances in the sample are in
general unknown, the fit to continuous distributions can be improved
by truncation to some value above zero (see example). Convergence
problems can occur when fitting with truncation, and can be solved
with sensible starting values.  <code>fitgamma</code> uses Chapman's (1956)
fitting method to find starting values for the truncated gamma
distribution, and <code>fitweibull</code> uses Rinne's (2009, p. 413) method
(thanks to Mario Jose Marques-Azevedo).
</p>
<p>Functions <code>fitgeom</code>, <code>fitnbinom</code> fits geometric and negative
binomial distributions which are two discrete standard distributions
also used to fit SADs. Since species with zero individuals in the
sample are in general unknown, these functions fit by default
zero-truncated distributions.  To avoid zero-truncation set
<code>trunc=NULL</code>.  Using the geometric distribution as a SAD model is
not to be confounded for fitting the Geometric series
<code>fitgs</code> as a rank-abundance distribution (RAD) model.
</p>
<p>Function <code>fitls</code> implements the original numerical recipe by
Fisher (1943) to fit the log-series distribution, given a vector of
species abundances.  Alonso et al. (2008, supplementary material)
showed that this recipe gives the maximum likelihood estimate of
Fisher's alpha, the single parameter of the log-series.  Fitting is
done through numerical optimization with the <code>uniroot</code> function,
following the code of the function <code>fishers.alpha</code> of the
<span class="pkg">untb</span> package. After that, the estimated value of alpha parameter
is used as the starting value to get the Log-likelihood from the
log-series density function <code>dls</code>, using the function
<code>mle2</code>.  The total number of individuals in the sample, <code>N</code>,
is treated as a fixed parameter in this implementation, in order to
maintain coherence with similar parameters from <code>fitvolkov</code> and
<code>fitmzsm</code> (see below).  Fixed parameters in the model
specification do not contribute to the model degrees of freedom, and
are not accounted in standard error calculations.
</p>
<p>Functions <code>fitpower</code>, <code>fitpowbend</code> and <code>fitpareto</code> fit
power-law distributions with one and two-parameters, that have been
suggested as SADs models.  The implementations of power and power-bend
are for discrete distributions that do not include zeroes. The Pareto
distribution is continuous and includes all non-negative numbers.
Fisher's logseries are a special case of the power-bend, see
<code>dpowbend</code> and Pueyo (2006).
</p>
<p>Function <code>fitbs</code> fits the Broken-stick distribution (MacArthur
1960). It is defined only by the observed number of elements <code>S</code>
in the collection and collection size <code>N</code>.  Thus once a sample is
taken, the Broken-stick has no free parameters.  Therefore, there is
no actual fitting, but still <code>fitbs</code> calls <code>mle2</code> with fixed
parameters <code>N</code> and <code>S</code> and <code>eval.only=TRUE</code> to return
an object of class <code>fitsad</code> to keep compatibility with other SADs
models fitted to the same data.  Therefore, the resulting objects
allows most of the operations with SAD models, such as comparison with
other models through model selection, diagnostic plots and so on (see
<code>fitsad-class</code>).
</p>
<p>Function <code>fitpoilog</code> fits the Poisson-lognormal distribution.
This is a compound distributions that describes the abundances of
species in Poisson sample of community that follows a lognormal
SAD. This is a sampling model of SAD, which is approximated by the
‘veil line’ truncation of the lognormal (Preston 1948). The
Poisson-lognormal is the analytic solution for this sampling model, as
Fisher's log-series is a analytic limit case for a Poisson-gamma
(a.k.a negative binomial) distribution. As geometric and negative
binomial distributions, the Poisson-lognormal includes zero, but the
fit is zero-truncated by default, as for <code>fitgeom</code>,
<code>fitnbinom</code>.  To avoid zero-truncation set <code>trunc=NULL</code>.
</p>
<p><code>fitmzsm</code> fits the metacommunity Zero-sum multinomial
distribution <code>dmzsm</code> from the Neutral Theory of
Biodiversity (Alonso and McKane 2004). The mZSM describes the SAD of a
sample taken from a neutral metacommunity under random drift.  It has
two parameters, the number of individuals in the sample <code>J</code> and
<code>theta</code>, the ‘fundamental biodiversity number’.  Because
<code>J</code> is known from the sample size, the fit resumes to estimate a
single parameter, <code>theta</code>. By default, <code>fitmzsm</code> fits mZSM
to a vector of abundances with Brent's one-dimensional method of
optimization (see <code>optim</code>). The log-series distribution (Fisher
et al. 1943) is a limiting case of mZSM (Hubbel 2001), and
<code>theta</code> tends to Fisher's alpha as <code>J</code> increases. In
practice the two models provide very similar fits to SADs (see
example).
</p>
<p>Function <code>fitvolkov</code> fits the SAD model for a community under
neutral drift with immigration (Volkov et al. 2003).  The model is a
stationary distribution deduced from a stochastic process compatible
with the Neutral Theory of Biodiversity (Hubbell 2001). It has two
free parameters, the ‘fundamental biodiversity number’
<code>theta</code>, and the immigration rate <code>m</code> (see
<code>dvolkov</code>) <code>fitvolkov</code> builds on function
<code>volkov</code> from package <span class="pkg">untb</span> to fit Volkov's <em>et al.</em>
SAD model to a vector of abundances.  The fit can be extremely slow
even for vectors of moderate size.  </p>


<h3>Value</h3>

<p>An object of <code>fitsad-class</code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle SADs models
(see <code>fitsad-class</code>).
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and
Andre Chalom,
after Ben Bolker, R Core Team, Robin Hanking, Vidar Grøtan and Steinar Engen.</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from <span class="pkg">bbmle</span> package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods;
<code>fitls</code> and <code>fitvolkov</code> use codes and functions from
<span class="pkg">untb</span> package (Hankin 2007); <code>fitpoilog</code> builds on
<span class="pkg">poilog</span> package (Grøtan &amp; Engen 2008).
</p>


<h3>References</h3>

<p>Alonso, D. and McKane, A.J.  2004.  Sampling Hubbell's neutral
model of biodiversity. <em>Ecology Letters 7</em>:901–910
</p>
<p>Alonso, D. and Ostling, A., and Etienne, R.S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. <em>Ecology Letters, 11</em>: 93-105.
</p>
<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Chapman, D. G. 1956. Estimating the parameters of a truncated gamma
distribution. <em>The Annals of Mathematical Statistics, 27(2)</em>:
498–506.
</p>
<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. (1943) The Relation
between the number of species and the number of individuals in a
random sample of an animal population.
<em>The Journal of Animal Ecology, 12(1)</em>: 42–58.
</p>
<p>Grøtan, V. and Engen, S. 2008. poilog: Poisson lognormal and
bivariate Poisson lognormal distribution. R package version 0.4.
</p>
<p>Hankin, R.K.S. 2007. Introducing untb, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package For Simulating Ecological Drift
Under the Unified Neutral Theory of Biodiversity. <em>Journal
of Statistical Software 22</em> (12). 
</p>
<p>Hubbell, S.P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press
</p>
<p>MacArthur, R.H. 1960. On the relative abundance of species.
<em>Am Nat 94</em>:25–36.
</p>
<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princenton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254–283.
</p>
<p>Pueyo, S. (2006) <em>Diversity: Between neutrality and structure</em>,
Oikos 112: 392-405.
</p>
<p>Rinne, H. 2009. <em>The Weibull distribution: a handbook</em>. CRC Press
</p>
<p>Volkov, I.,  Banavar, J. R., Hubbell, S. P., Maritan, A. 2003.
Neutral theory and relative species abundance in ecology.  <em>Nature 424</em>:1035–1037.
</p>


<h3>See Also</h3>

 <p><code>dls</code>, <code>dmzsm</code>, <code>dpareto</code>,
<code>dpoilog</code>, <code>dpower</code>,<code> dvolkov</code>,
<code>dpowbend</code> for corresponding density functions created for
fitting SADs; standard distributions <code>dexp</code>, <code>dgamma</code>,
<code>dgeom</code>, <code>dlnorm</code>, <code>dnbinom</code>, <code>dweibull</code>;
<code>fitsad-class</code>.  </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Magurran (1989) example 5:
## birds in an Australian forest
mag5 &lt;- c(103, 115, 13, 2, 67, 36, 51, 8, 6, 61, 10, 21,
          7, 65, 4, 49, 92, 37, 16, 6, 23, 9, 2, 6, 5, 4, 
          1, 3, 1, 9, 2)
mag5.bs &lt;- fitsad(mag5, "bs") 
summary(mag5.bs)## no estimated coefficient
coef(mag5.bs) ## fixed coefficients N and S
## Diagnostic plots
par(mfrow=c(2, 2))
plot(mag5.bs)
par(mfrow=c(1, 1))


data(moths) #Fisher's moths data
moths.mzsm &lt;- fitmzsm(moths) ## same as fitsad(moths, sad="mzsm")
## fit to log-series
moths.ls &lt;- fitsad(moths, sad="ls")
coef(moths.ls)
coef(moths.mzsm) ## Compare with theta=38.9, Alonso&amp;McKanne (2004)
## Diagnostic plots
par(mfrow=c(2, 2))
plot(moths.mzsm)
par(mfrow=c(1, 1))
## Graphical comparison
plot(rad(moths))
lines(radpred(moths.ls))
lines(radpred(moths.mzsm), col="red", lty=2)
legend("topright", c("log-series", "mZSM"), lty=1, col=c("blue","red"))
## Two more models: truncated lognormal and Poisson-lognormal
moths.ln &lt;- fitsad(moths, "lnorm", trunc=0.5)
moths.pln &lt;- fitsad(moths, "poilog")
## Model selection
AICtab(moths.ln, moths.pln, moths.ls, moths.mzsm, weights=TRUE)

## Biomass as abundance variable
data(ARN82.eB.apr77) #benthonic marine animals
AR.ln &lt;- fitsad(ARN82.eB.apr77, sad="lnorm")
AR.g &lt;- fitsad(ARN82.eB.apr77, sad="gamma")
AR.wb &lt;- fitsad(ARN82.eB.apr77, sad="weibull")
plot(octav(ARN82.eB.apr77))
lines(octavpred(AR.ln))
lines(octavpred(AR.g), col="red")
lines(octavpred(AR.wb), col="green")
legend("topright", c("lognormal", "gamma", "weibull"),lty=1, col=c("blue","red", "green"))
AICctab(AR.ln, AR.g, AR.wb, nobs=length(ARN82.eB.apr77), weights=TRUE) 
</code></pre>


</div>