<div class="container">

<table style="width: 100%;"><tr>
<td>waveIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Intensity Scale (IS) Verification
</h2>

<h3>Description</h3>

<p>Intensity Scale (IS) verification based on Casat et al (2004) and Casati (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">waveIS(x, th = NULL, J = NULL, wavelet.type = "haar", levels
                 = NULL, max.n = NULL, smooth.fun = "hoods2dsmooth",
                 smooth.params = NULL, rule = "&gt;=", verbose = FALSE,
                 ...)

## S3 method for class 'SpatialVx'
waveIS(x, th = NULL, J = NULL, wavelet.type = "haar", levels
                 = NULL, max.n = NULL, smooth.fun = "hoods2dsmooth",
                 smooth.params = NULL, rule = "&gt;=", verbose = FALSE,
                 ..., time.point = 1, obs = 1, model = 1 )

## Default S3 method:
waveIS(x, th = NULL, J = NULL, wavelet.type = "haar", levels
                 = NULL, max.n = NULL, smooth.fun = "hoods2dsmooth",
                 smooth.params = NULL, rule = "&gt;=", verbose = FALSE,
                 ...)

## S3 method for class 'waveIS'
plot(x, main1 = "X", main2 = "Y",
    which.plots = c("all", "mse", "ss", "energy"),
    level.label = NULL, ...)

## S3 method for class 'waveIS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For <code>waveIS</code> either a list object of class “SpatialVx”, a two-component list giving the two fields to be compared (the verification field is assumed to be the first one) or a named list with components “X” and “Xhat” giving the two fields to be compared.  list object returned by <code>waveIS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> list object returned by <code>waveIS</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main1,main2</code></td>
<td>
<p>character giving labels for the plots where <code>main1</code> refers to the verification field and <code>main2</code> to the forecast field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>character vector naming one or more specific plots to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level.label</code></td>
<td>
<p>optional character vector to use for level names on the plot(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>

<p>numeric integer giving the number of levels to use.  If NULL and the field is dyadic, this will be log2(min(dim(X))), where X is a field from the verification set.  If NULL and the field is not dyadic, then <code>J</code> is set equal to 4.  Note that if the fields are not dyadic, the function will be much slower.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavelet.type</code></td>
<td>

<p>character giving the name of the wavelet type to use as accepted by <code>dwt.2d</code> and <code>modwt.2d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p> list object with named components “X” and “Xhat” giving the thresholds to use for each field.  If null, taken from teh thresholds attribute for “SpatialVx” objects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.point</code></td>
<td>
<p>numeric or character indicating which time point from the “SpatialVx” verification set to select for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs, model</code></td>
<td>
<p>numeric indicating which observation/forecast model to select for the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>numeric vector giving the successive values of the smoothing parameter.  For example, for the default method, these are the neighborhood lengths over which the levels^2 nearest neighbors are averaged for each point.  Values should make sense for the specific smoothing function.  For example, for the default method, these should be odd integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.n</code></td>
<td>
<p>(optional) single numeric giving the maximum neighborhood length to use.  Only used if levels are NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.fun</code></td>
<td>
<p>character giving the name of a smoothing function to be applied.  Default is an average over the n^2 nearest neighbors, where n is taken to be each value of the <code>levels</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.params</code></td>
<td>
<p>list object containing any optional arguments to <code>smooth.fun</code>.  Use NULL if none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>If <code>type</code> is “binary”, return 0 when the rule applied to a grid point's value is not true in relation to the threshold value, and 1 elsewhere.  If <code>type</code> is “replace.below”, then return <code>replace.with</code> wherever the rule is not true and return the original value otherwise.  By default, it replaces values below the threshold with zero (hence its name), but if <code>rule</code> is, e.g., “&lt;=”, then it will replace values above with zero; or whatever value is chosen for <code>replace.with</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical, should progress information be printed to the screen?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used by <code>waveIS</code> (or its method functions) or <code>plot.waveIS</code>.  Only sort of used by <code>summary.waveIS</code>.  One can put the argument silent=TRUE so that nothing is printed to the screen (useful if you just want the values calculated and stored without writing to the screen).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function applies various statistics to the detail fields (in wavelet space) of a discrete wavelet decomposition (DWT) of the binary error fields for a verification set.  In particular, the statistics described in Casati et al (2004) and Casati (2010) are calculated.  This function depends on the <code>waverify2d</code> or <code>mowaverify2d</code> function (depending on whether the fields are dyadic or not, resp.), which themselves depend on the <code>dwt.2d</code> and <code>idwt.2d</code> or <code>modwt.2d</code> and <code>imodwt.2d</code> functions.
</p>
<p>See the references herein and the help files and references therein for <code>dwt.2d</code> and <code>modwt.2d</code> for more information on this approach, as well as Percival and Guttorp (1994) and Lindsay et al. (1996).
</p>


<h3>Value</h3>

<p>A list object of class “waveIS” that contains the entire prep object passed in by obj, as well as additional components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>EnVx,EnFcst</code></td>
<td>
<p>J by q matrices giving the energy for the verification and forecast fields, resp., for each threshold (columns) and scale (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE,SS </code></td>
<td>
<p>J by q matrices giving the mean square error and IS skill score for each threshold (column) and scale (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bias</code></td>
<td>
<p>numeric vector of length q giving the frequency bias of the original fields for each threshold.</p>
</td>
</tr>
</table>
<p>plot.waveIS does not return any value.  A plot is created on the current graphic device.
summary.waveIS returns a list invisibly with the same components as returned by waveIS along with extra components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MSEu,SSu,EnVx.u,EnFcst.u</code></td>
<td>
<p>length q numeric vectors giving the MSE, SS, and Vx and Fcst energy for each threshold (i.e., ignoring the wavelet decomposition).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSEperc,EnVx.perc,EnFcst.perc</code></td>
<td>
<p>J by q numeric matrices giving percentage form of MSE, Vx Energy and Fcst Energy values, resp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EnRelDiff</code></td>
<td>
<p>J by q numeric matrix giving the energy relative difference.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Casati, B., Ross, G. and Stephenson, D. B. (2004) A new intensity-scale approach for the verification of spatial precipitation forecasts. <em>Meteorol. Appl.</em> <b>11</b>, 141–154.
</p>
<p>Casati, B. (2010) New Developments of the Intensity-Scale Technique within the Spatial Verification Methods Inter-Comparison Project. <em>Wea. Forecasting</em> <b>25</b>, (1), 113–143, doi:10.1175/2009WAF2222257.1.
</p>
<p>Lindsay, R. W., Percival, D. B. and Rothrock, D. A. (1996)  The discrete wavelet transform and the scale analysis of the surface properties of sea ice.  <em>IEEE Transactions on Geoscience and Remote Sensing</em>, <b>34</b> (3), 771–787.
</p>
<p>Percival, D. B. and Guttorp, P. (1994)  Long-memory processes, the Allan variance and wavelets.  In <em>Wavelets in Geophysics</em>, Foufoula-Georgiou, E. and Kumar, P., Eds., New York: Academic, 325–343.
</p>


<h3>See Also</h3>

<p><code>IS</code>, <code>int.scale.verify</code> from package <span class="pkg">verification</span>,
</p>
<p><code>dwt.2d</code>, <code>modwt.2d</code>, <code>idwt.2d</code>, <code>imodwt.2d</code>, <code>hoods2d</code>
</p>
<p><code>thresholder</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( "UKobs6" )
data( "UKfcst6" )
data( "UKloc" )

hold &lt;- make.SpatialVx( UKobs6, UKfcst6,
    thresholds = c(0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 50),
    loc = UKloc, map = TRUE, field.type = "Rainfall", units = "mm/h",
    data.name = "Nimrod", obs.name = "UKobs6", model.name = "UKfcst6" )

look &lt;- waveIS(hold, J=8, levels=2^(8-1:8), verbose=TRUE)
plot(look, which.plots="mse") 
plot(look, which.plots="ss")
plot(look, which.plots="energy")
summary(look)

</code></pre>


</div>