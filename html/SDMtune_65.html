<div class="container">

<table style="width: 100%;"><tr>
<td>thinData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Thin Data</h2>

<h3>Description</h3>

<p>Remove all but one location per raster cell. The function removes NAs and if
more than one location falls within the same raster cell it selects randomly
one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">thinData(coords, env, x = "x", y = "y", verbose = TRUE, progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>data.frame or matrix with the coordinates, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>rast containing the environmental variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>character. Name of the column containing the x coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>character. Name of the column containing the y coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, if <code>TRUE</code> prints an informative message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>logical, if <code>TRUE</code> shows a progress bar.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li> <p><strong>coords</strong> and <strong>env</strong> must have the same coordinate reference
system.
</p>
</li>
<li>
<p> The <code>coords</code> argument can contain several columns. This is useful if the
user has information related to the coordinates that doesn't want to loose
with the thinning procedure. The function expects to have the x coordinates
in a column named "x", and the y coordinates in a column named "y". If this
is not the case, the name of the columns containing the coordinates can be
specified using the arguments <code>x</code> and <code>y</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>a matrix or a data frame with the thinned locations.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare background locations, by sampling  also on areas with NA values
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               xy = TRUE,
                               values = FALSE)
nrow(bg_coords)

# Thin the locations
# The function will remove the coordinates that have NA values for some
# predictors. Note that the function expects to have the coordinates in two
# columns named "x" and "y"

colnames(bg_coords)
thinned_bg &lt;- thinData(bg_coords,
                       env = predictors)
nrow(thinned_bg)

# Here we sample only on areas without NA values and then we double the
# coordinates
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

thinned_bg &lt;- thinData(rbind(bg_coords, bg_coords),
                       env = predictors)

nrow(thinned_bg)

# In case of a dataframe containing more than two columns (e.g. a dataframe
# with the coordinates plus an additional column with the age of the species)
# and custom column names, use the function in this way
age &lt;- sample(c(1, 2),
              size = nrow(bg_coords),
              replace = TRUE)

data &lt;- cbind(age, bg_coords)
colnames(data) &lt;- c("age", "X", "Y")

thinned_bg &lt;- thinData(data,
                       env = predictors,
                       x = "X",
                       y = "Y")
head(data)
</code></pre>


</div>