<div class="container">

<table style="width: 100%;"><tr>
<td>sk_vario_fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Theoretical variogram function</h2>

<h3>Description</h3>

<p>Computes the value of the variogram function w, defined by covariance model <code>pars</code>
at the component y and x lags supplied in <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sk_vario_fun(pars, d = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list of the form returned by <code>sk_pars</code> with entries 'y', 'x', 'eps', 'psill'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>numeric vector or list with vector entries 'y' and 'x', the distances to evaluate</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By definition w is Var( Z(s1) - Z(s2) ), where s1 and s2 are a pair of spatial
locations, and Z is the spatial process value. If Z is second-order stationary
then w only depends on the relative displacement, s1 - s2 = (dx, dy). <code>snapKrig</code>
models the variogram as W = 2 ( <code>eps</code> + <code>psill</code> ( 1 - cy(dy) cx(dx) ) ).
</p>
<p><code>sk_vario_fun</code> evaluates this function using the correlogram functions (cy and cx),
partial sill (<code>psill</code>) and nugget (<code>eps</code>) defined in <code>pars</code>, over the displacement
(dy and dx) supplied in <code>d</code>.
</p>
<p>NOTE: w is twice the semi-variogram, usually denoted by greek letter gamma. Variogram
w is therefore often written 2<em>gamma. This can (and does) lead to confusion in the
literature about whether to include a factor 2 in downstream calculations.
This function multiplies the semi-variogram function by 2, returning the variogram w
(ie 2</em>gamma), NOT the semi-variogram.
</p>
<p>If <code>d</code> is a list, its 'y' and 'x' components should supply the y and x component distances.
These must be equal-length non-negative numeric vectors. The function returns the corresponding
variogram values in a vector of the same length.
</p>
<p>If <code>d</code> is a numeric vector, it is interpreted as a set of distances at which to
evaluate the range of the variogram function. Anisotropic variograms will exhibit a range
of values for a given distance (depending on the relative sizes of the x and y components).
The function returns this range in a data frame with columns 'min' and 'max'.
</p>


<h3>Value</h3>

<p>data frame (for list <code>d</code>) or numeric vector (for vector <code>d</code>) of variogram values
</p>


<h3>See Also</h3>

<p>sk_pars
</p>
<p>Other variogram functions: 
<code>sk_add_bins()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set up example grid and parameters
gdim = c(10, 15)
d_max = sqrt(sum(gdim^2))
pars = sk_pars(gdim, 'mat')

# set up test distances
d_test = seq(0, d_max, length.out=1e2)

# evaluate and plot the variogram values for equal displacements along x and y
d_equal = stats::setNames(rep(list(sqrt(1/2)*d_test), 2), c('y', 'x'))
vario = sk_vario_fun(pars, d=d_equal)
plot(d_test, vario, pch=NA)
lines(d_test, vario, col='blue')

# evaluate and plot the range of variogram values (for all possible x and y displacements)
vario_lims = sk_vario_fun(pars, d=d_test)
lines(d_test, vario_lims[,1])
lines(d_test, vario_lims[,2])

</code></pre>


</div>