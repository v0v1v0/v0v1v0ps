<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_s_rss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate s in <code>susie_rss</code> Model Using Regularized LD</h2>

<h3>Description</h3>

<p>The estimated s gives information about the
consistency between the z scores and LD matrix. A larger <code class="reqn">s</code>
means there is a strong inconsistency between z scores and LD
matrix. The “null-mle” method obtains mle of <code class="reqn">s</code> under
<code class="reqn">z | R ~ N(0,(1-s)R + s I)</code>, <code class="reqn">0 &lt; s &lt; 1</code>. The
“null-partialmle” method obtains mle of <code class="reqn">s</code> under
<code class="reqn">U^T z | R ~ N(0,s I)</code>, in which <code class="reqn">U</code> is a matrix containing
the of eigenvectors that span the null space of R; that is, the
eigenvectors corresponding to zero eigenvalues of R. The estimated
<code class="reqn">s</code> from “null-partialmle” could be greater than 1. The
“null-pseudomle” method obtains mle of <code class="reqn">s</code> under
pseudolikelihood <code class="reqn">L(s) = \prod_{j=1}^{p} p(z_j | z_{-j}, s,
  R)</code>, <code class="reqn">0 &lt; s &lt; 1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_s_rss(z, R, n, r_tol = 1e-08, method = "null-mle")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A p-vector of z scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A p by p symmetric, positive semidefinite correlation
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size. (Optional, but highly recommended.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_tol</code></td>
<td>
<p>Tolerance level for eigenvalue check of positive
semidefinite matrix of R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string specifies the method to estimate <code class="reqn">s</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A number between 0 and 1.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n = 500
p = 1000
beta = rep(0,p)
beta[1:4] = 0.01
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
input_ss = compute_suff_stat(X,y,standardize = TRUE)
ss = univariate_regression(X,y)
R = cor(X)
attr(R,"eigen") = eigen(R,symmetric = TRUE)
zhat = with(ss,betahat/sebetahat)

# Estimate s using the unadjusted z-scores.
s0 = estimate_s_rss(zhat,R)

# Estimate s using the adjusted z-scores.
s1 = estimate_s_rss(zhat,R,n)

</code></pre>


</div>