<div class="container">

<table style="width: 100%;"><tr>
<td>gstslshet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GM estimation of a Cliff-Ord type model with Heteroskedastic Innovations</h2>

<h3>Description</h3>

<p>Multi step GM/IV estimation of a linear Cliff and Ord -type of model
of the form:
</p>
<p style="text-align: center;"><code class="reqn">y=\lambda W y + X \beta + u  </code>
</p>

<p style="text-align: center;"><code class="reqn">u=\rho W u + e</code>
</p>
<p>  with </p>
<p style="text-align: center;"><code class="reqn">e ~ N(0,\sigma^2_i) </code>
</p>

<p>The model allows for spatial lag in the dependent variable
and disturbances. The innovations in the disturbance process are assumed 
heteroskedastic of an unknown form.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gstslshet(formula, data = list(), listw, na.action = na.fail, 
           zero.policy = NULL, initial.value = 0.2, abs.tol = 1e-20, 
           rel.tol = 1e-10, eps = 1e-5, inverse = T, sarar = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a description of the model to be fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class data.frame. An optional data frame containing the variables
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>an object of class <code>listw</code> created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contains missing values.
See lm for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>See <code>lagsarlm</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.value</code></td>
<td>
<p>The initial value for <code class="reqn">\rho</code>. It can be either numeric (default is 0.2) or
set to <code>'SAR'</code>, in which case the optimization will start from the estimated coefficient of a regression of the 2SLS 
residuals over their spatial lag (i.e. a spatial AR model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.tol</code></td>
<td>
<p>Absolute tolerance. See nlminb for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>Relative tolerance. See nlminb for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance level for the approximation. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse</code></td>
<td>
<p><code>TRUE</code>. If <code>FALSE</code>, an appoximated inverse is calculated. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sarar</code></td>
<td>
<p><code>TRUE</code>. If <code>FALSE</code>, a spatial error model is estimated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure consists of two steps alternating GM and IV estimators. Each step consists of sub-steps.
In step one <code class="reqn">\delta = [\beta',\lambda]'</code> is estimated by 2SLS. The 2SLS residuals are first employed
to obtain an initial (consistent but not efficient) GM estimator of <code class="reqn">\rho</code> and then a consistent and efficient 
estimator (involving the variance-covariance matrix of the limiting distribution of the normalized sample moments). 
In step two, the spatial Cochrane-Orcutt transformed model is estimated by 2SLS. This corresponds to a GS2SLS procedure. 
The GS2SLS residuals are used to obtain a consistent and efficient GM estimator for <code class="reqn">\rho</code>. 
</p>
<p>The initial value for the optimization in step 1b is taken to be <code>initial.value</code>. The initial value in step 1c is the 
optimal parameter of step 1b. Finally, the initial value for the optimization of step 2b is the optimal parameter of step 1c.
</p>
<p>Internally, the object of class <code>listw</code> is transformed into a Matrix 
using the function listw2dgCMatrix.
</p>
<p>The expression of the estimated variance covariance matrix of the limiting 
distribution of the normalized sample moments based on 2SLS residuals 
involves the inversion of <code class="reqn">I-\rho W'</code>.
When <code>inverse</code> is <code>FALSE</code>, the inverse is calculated using the approximation 
<code class="reqn">I +\rho W' + \rho^2 W'^2 + ...+ \rho^n W'^n</code>. 
The powers considered depend on a condition. 
The  function will keep adding terms until the absolute value of the <code>sum</code> of all elements 
of the matrix <code class="reqn">\rho^i W^i</code> is greater than a fixed <code class="reqn">\epsilon</code> (<code>eps</code>). By default <code>eps</code>
is set to 1e-5.
</p>


<h3>Value</h3>

<p>A list object of class <code>sphet</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Generalized Spatial two stage least squares coefficient estimates of <code class="reqn">\delta</code> and GM estimator for <code class="reqn">\rho</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>variance-covariance matrix of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>GS2SLS residuals variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>GS2SLS residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>difference between GS2SLS residuals and response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to create this object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model matrix of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>'gs2slshac'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Wald test for both <code class="reqn">\rho</code> and <code class="reqn">\lambda</code> are zero</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianfranco Piras <a href="mailto:gpiras@mac.com">gpiras@mac.com</a>
</p>


<h3>References</h3>

<p>Arraiz, I. and Drukker, M.D. and Kelejian, H.H. and Prucha, I.R. (2007) 
A spatial Cliff-Ord-type Model with Heteroskedastic Innovations: Small and Large Sample Results,
<em>Department of Economics, University of Maryland</em>'
</p>
<p>Kelejian, H.H. and Prucha, I.R. (2007) 
Specification and Estimation of Spatial Autoregressive Models with Autoregressive and Heteroskedastic Disturbances,
<em>Journal of Econometrics</em>, forthcoming.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1999) 
A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model,
<em>International Economic Review</em>, <b>40</b>, pages 509–533.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1998) 
A Generalized Spatial Two Stage Least Square Procedure for Estimating a Spatial Autoregressive
Model with Autoregressive Disturbances,
<em>Journal of Real Estate Finance and Economics</em>, <b>17</b>, pages 99–121.
</p>


<h3>See Also</h3>

<p><code>stslshac</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(columbus, package = "spdep")
listw &lt;- spdep::nb2listw(col.gal.nb)
res &lt;- gstslshet(CRIME ~ HOVAL + INC, data = columbus, listw = listw)
summary(res)

</code></pre>


</div>