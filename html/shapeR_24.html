<div class="container">

<table style="width: 100%;"><tr>
<td>shapeR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>shapeR</h2>

<h3>Description</h3>

<p>Collection and analysis of otolith shape data
</p>
<p>a shapeR class
</p>


<h3>Usage</h3>

<pre><code class="language-R">shapeR(project.path, info.file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>project.path</code></td>
<td>
<p>The base project path where the images are stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info.file</code></td>
<td>
<p>The information file which store the information on the fish and otoliths. This is the base for the master.list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to 'read.csv' for reading the info.file</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>shapeR</code> object
</p>


<h3>Slots</h3>


<dl>
<dt><code>project.path</code></dt>
<dd>
<p>Path to the project where the images are stored</p>
</dd>
<dt><code>info.file</code></dt>
<dd>
<p>Info file containing fish and otolith information</p>
</dd>
<dt><code>master.list.org</code></dt>
<dd>
<p>The contents of the <code>info.file</code></p>
</dd>
<dt><code>master.list</code></dt>
<dd>
<p>The contents of the <code>info.file</code> with added shape parameters and descriptors</p>
</dd>
<dt><code>outline.list.org</code></dt>
<dd>
<p>A list of all the original otolith outlines</p>
</dd>
<dt><code>outline.list</code></dt>
<dd>
<p>A list of all the otolith outlines. It returns a list of smoothed if contour smoothing (using<code>smoothout</code>) has been conducted.</p>
</dd>
<dt><code>filter</code></dt>
<dd>
<p>A logical vector selecting the otoliths used for analysis</p>
</dd>
<dt><code>wavelet.coef.raw</code></dt>
<dd>
<p>The wavelet coefficients for all the otolith outlines</p>
</dd>
<dt><code>wavelet.coef</code></dt>
<dd>
<p>The wavelet coefficients after aligning with the <code>info.file</code>. The data is generated when enrich.master.list is run</p>
</dd>
<dt><code>wavelet.coef.std</code></dt>
<dd>
<p>The standardized wavelet coefficients. The data is generated when stdCoefs is run</p>
</dd>
<dt><code>wavelet.coef.std.removed</code></dt>
<dd>
<p>The index of the removed wavelet coefficients after standardization. The data is generated when stdCoefs is run</p>
</dd>
<dt><code>fourier.coef.raw</code></dt>
<dd>
<p>The Fourier coefficients for all the otolith outlines</p>
</dd>
<dt><code>fourier.coef</code></dt>
<dd>
<p>The Fourier coefficients for after aligning with the info file. The data is generated when enrich.master.list is run</p>
</dd>
<dt><code>fourier.coef.std</code></dt>
<dd>
<p>The standardized Fourier coefficients. The data is generated when stdCoefs is run</p>
</dd>
<dt><code>fourier.coef.std.removed</code></dt>
<dd>
<p>The index of the removed Fourier coefficents after standardization. The data is generated when stdCoefs is run</p>
</dd>
<dt><code>shape.coef.raw</code></dt>
<dd>
<p>The uncalibrated shape measurements for all the otoliths. The shape parameters are: otolith.area, otolith.length, otolith.width, otolith.perimeter</p>
</dd>
<dt><code>shape.coef</code></dt>
<dd>
<p>The shape measurements for after aligning with the info file. The shape parameters have been calibrated using the calibration parameter as registered in the datafile as the column 'cal'.</p>
</dd>
<dt><code>shape.std</code></dt>
<dd>
<p>The standardized shape measurements. The data is generated when stdCoefs is run</p>
</dd>
<dt><code>shape.std.removed</code></dt>
<dd>
<p>The index of the removed shape measurements after standardization. The data is generated when stdCoefs is run</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Lisa Anne Libungan &amp; Snaebjorn Palsson
</p>


<h3>References</h3>

<p>Libungan LA and Palsson S (2015) ShapeR: An R Package to Study Otolith Shape Variation among Fish Populations. PLoS ONE 10(3): e0121102. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121102</a>
</p>


<h3>See Also</h3>

<p><a href="https://github.com/lisalibungan/shapeR">https://github.com/lisalibungan/shapeR</a>
</p>
<p><code>plotWavelet</code>
</p>
<p><code>plotFourier</code>
</p>
<p><code>plotWaveletShape</code>
</p>
<p><code>plotFourierShape</code>
</p>
<p><code>capscale</code>
</p>
<p><code>cluster.plot</code>
</p>
<p><code>setFilter</code>
</p>
<p><code>lda</code>
</p>
<p><code>detect.outline</code>
</p>
<p><code>generateShapeCoefficients</code>
</p>
<p><code>enrich.master.list</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

# This example has two sections: (1) Demonstration of how a shapeR object
# is analyzed and (2) How to create a shapeR object from an archive of
# image files.

#-----------------------------------------
# Section 1: Analyzing a shapeR object

data(shape)

#Standardize coefficients
shape = stdCoefs(shape,"pop","length_cm")

#Visualize Wavelet and Fourier coefficients
plotWavelet(shape,level=5,class.name= "pop",useStdcoef=TRUE)
plotFourier(shape,class.name= "pop",useStdcoef=TRUE)

#Examine the mean shapes
plotWaveletShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)
plotFourierShape(shape, "pop",show.angle = TRUE,lwd=2,lty=1)

#Canonical analysis
library(vegan)
cap.res = capscale(getStdWavelet(shape) ~ getMasterlist(shape)$pop)
anova(cap.res)

#Visualize the canonical scores
eig=eigenvals(cap.res,constrained=TRUE)
eig.ratio = eig/sum(eig)

cluster.plot(scores(cap.res)$sites[,1:2],getMasterlist(shape)$pop
,plotCI=TRUE
,xlab=paste("CAP1 (",round(eig.ratio[1]*100,1),"%)",sep="")
,ylab=paste("CAP2 (",round(eig.ratio[2]*100,1),"%)",sep="")
,main="Canonical clustering"
)

#Only analyze Icelandic and Norwegian samples
shape = setFilter(shape, getMasterlist(shape, useFilter = FALSE)$pop %in% c("NO","IC"))

#Classifier on standardized wavelet
lda.res.w = lda(getStdWavelet(shape),getMasterlist(shape)$pop,CV=TRUE)
ct.w = table(getMasterlist(shape)$pop,lda.res.w$class)

diag(prop.table(ct.w, 1))

# Total percent correct
sum(diag(prop.table(ct.w)))

cap.res = capscale(getStdWavelet(shape) ~ getMasterlist(shape)$pop)
anova(cap.res)

#Classifier on canoncial values
lda.res.w = lda(scores(cap.res)$sites,getMasterlist(shape)$pop,CV=TRUE)
ct.w = table(getMasterlist(shape)$pop,lda.res.w$class)

diag(prop.table(ct.w, 1))

# Total percent correct
sum(diag(prop.table(ct.w)))

#-----------------------------------------
# Section 2: Creating a shapeR object from image files

# The following example requires the user to download an archive of JPEG
# files from https://github.com/lisalibungan/shapeR/
# place the ShapeAnalysis directory inside the working directory.

shape = shapeR("~/ShapeAnalysis/","FISH.csv")
shape = detect.outline(shape,write.outline.w.org = TRUE)

shape = generateShapeCoefficients(shape)
shape = enrich.master.list(shape)

## End(Not run)
</code></pre>


</div>