<div class="container">

<table style="width: 100%;"><tr>
<td>two_method_pathway_enrichment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>two_method_pathway_enrichment</h2>

<h3>Description</h3>

<p>Pathway analysis of each cell-type based on cell-type specificity and rank improvement by scMappR.
</p>


<h3>Usage</h3>

<pre><code class="language-R">two_method_pathway_enrichment(
  DEG_list,
  theSpecies,
  scMappR_vals,
  background_genes = NULL,
  output_directory = "output",
  plot_names = "reweighted",
  number_genes = -9,
  newGprofiler = TRUE,
  toSave = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DEG_list</code></td>
<td>
<p>Differentially expressed genes (gene_name, padj, log2fc).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theSpecies</code></td>
<td>
<p>Human, mouse, or a character that is compatible with g:ProfileR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scMappR_vals</code></td>
<td>
<p>cell weighted Fold-changes of differentially expressed genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_genes</code></td>
<td>
<p>A list of background genes to test against. NULL assumes all genes in g:profileR gene set databases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_directory</code></td>
<td>
<p>Path to the directory where files will be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_names</code></td>
<td>
<p>Names of output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_genes</code></td>
<td>
<p>Number of genes to if there are many, many DEGs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newGprofiler</code></td>
<td>
<p>Whether to use g:ProfileR or gprofiler2 (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function re-ranks cwFoldChanges based on their absolute cell-type specificity scores (per-celltype) as well as their rank increase in cell-type specificity before completing an ordered pathway analysis. In the second method, only genes with a rank increase in cell-type specificity were included.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rank_increase</code></td>
<td>
<p>A list containing the degree of rank change between bulk DE genes and cwFold-changes. Pathway enrichment and TF enrichment of these reranked genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>non_rank_increase</code></td>
<td>
<p>list of DFs containing the pathway and TF enrichment of cwFold-changes.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

# load data for scMappR
data(PBMC_example)
bulk_DE_cors &lt;- PBMC_example$bulk_DE_cors
bulk_normalized &lt;- PBMC_example$bulk_normalized
odds_ratio_in &lt;- PBMC_example$odds_ratio_in
case_grep &lt;- "_female"
control_grep &lt;- "_male"
max_proportion_change &lt;- 10
print_plots &lt;- FALSE
theSpecies &lt;- "human"

# calculate cwFold-changes
toOut &lt;- scMappR_and_pathway_analysis(count_file = bulk_normalized, 
                                      signature_matrix = odds_ratio_in, 
                                      DEG_list = bulk_DE_cors, case_grep = case_grep,
                                      control_grep = control_grep, rda_path = "", 
                                      max_proportion_change = 10, print_plots = TRUE, 
                                      plot_names = "tst1", theSpecies = "human", 
                                      output_directory = "tester",
                                      sig_matrix_size = 3000,
                                      up_and_downregulated = FALSE, 
                                      internet = FALSE)

# complete pathway enrichment using both methods
twoOutFiles &lt;- two_method_pathway_enrichment(DEG_list = bulk_DE_cors,theSpecies = "human",
scMappR_vals = toOut$cellWeighted_Foldchange, background_genes = rownames(bulk_normalized), 
output_directory = "newfun_test",plot_names = "nonreranked_", toSave = FALSE)


 
</code></pre>


</div>