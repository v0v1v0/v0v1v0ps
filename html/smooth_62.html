<div class="container">

<table style="width: 100%;"><tr>
<td>sma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple Moving Average</h2>

<h3>Description</h3>

<p>Function constructs state space simple moving average of predefined order
</p>


<h3>Usage</h3>

<pre><code class="language-R">sma(y, order = NULL, ic = c("AICc", "AIC", "BIC", "BICc"), h = 10,
  holdout = FALSE, silent = TRUE, fast = TRUE, ...)

sma_old(y, order = NULL, ic = c("AICc", "AIC", "BIC", "BICc"), h = 10,
  holdout = FALSE, cumulative = FALSE, interval = c("none", "parametric",
  "likelihood", "semiparametric", "nonparametric"), level = 0.95,
  silent = c("all", "graph", "legend", "output", "none"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector or ts object, containing data needed to be forecasted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Order of simple moving average. If <code>NULL</code>, then it is
selected automatically using information criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>The information criterion used in the model selection procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Length of forecasting horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>holdout</code></td>
<td>
<p>If <code>TRUE</code>, holdout sample of size <code>h</code> is taken from
the end of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>If <code>silent="none"</code>, then nothing is silent, everything is
printed out and drawn. <code>silent="all"</code> means that nothing is produced or
drawn (except for warnings). In case of <code>silent="graph"</code>, no graph is
produced. If <code>silent="legend"</code>, then legend of the graph is skipped.
And finally <code>silent="output"</code> means that nothing is printed out in the
console, but the graph is produced. <code>silent</code> also accepts <code>TRUE</code>
and <code>FALSE</code>. In this case <code>silent=TRUE</code> is equivalent to
<code>silent="all"</code>, while <code>silent=FALSE</code> is equivalent to
<code>silent="none"</code>. The parameter also accepts first letter of words ("n",
"a", "g", "l", "o").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>if <code>TRUE</code>, then the modified Ternary search is used to
find the optimal order of the model. This does not guarantee the optimal
solution, but gives a reasonable one (local minimum).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other non-documented parameters.  For example parameter
<code>model</code> can accept a previously estimated SMA model and use its
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulative</code></td>
<td>
<p>If <code>TRUE</code>, then the cumulative forecast and prediction
interval are produced instead of the normal ones. This is useful for
inventory control systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Type of interval to construct. This can be:
</p>

<ul>
<li> <p><code>"none"</code>, aka <code>"n"</code> - do not produce prediction
interval.
</p>
</li>
<li> <p><code>"parametric"</code>, <code>"p"</code> - use state-space structure of ETS. In
case of mixed models this is done using simulations, which may take longer
time than for the pure additive and pure multiplicative models. This type
of interval relies on unbiased estimate of in-sample error variance, which
divides the sume of squared errors by T-k rather than just T.
</p>
</li>
<li> <p><code>"likelihood"</code>, <code>"l"</code> - these are the same as <code>"p"</code>, but
relies on the biased estimate of variance from the likelihood (division by
T, not by T-k).
</p>
</li>
<li> <p><code>"semiparametric"</code>, <code>"sp"</code> - interval based on covariance
matrix of 1 to h steps ahead errors and assumption of normal / log-normal
distribution (depending on error type).
</p>
</li>
<li> <p><code>"nonparametric"</code>, <code>"np"</code> - interval based on values from a
quantile regression on error matrix (see Taylor and Bunn, 1999). The model
used in this process is e[j] = a j^b, where j=1,..,h.
</p>
</li>
</ul>
<p>The parameter also accepts <code>TRUE</code> and <code>FALSE</code>. The former means that
parametric interval are constructed, while the latter is equivalent to
<code>none</code>.
If the forecasts of the models were combined, then the interval are combined
quantile-wise (Lichtendahl et al., 2013).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence level. Defines width of prediction interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function constructs AR model in the Single Source of Error state space form
based on the idea that:
</p>
<p><code class="reqn">y_{t} = \frac{1}{n} \sum_{j=1}^n y_{t-j}</code>
</p>
<p>which is AR(n) process, that can be modelled using:
</p>
<p><code class="reqn">y_{t} = w' v_{t-1} + \epsilon_{t}</code>
</p>
<p><code class="reqn">v_{t} = F v_{t-1} + g \epsilon_{t}</code>
</p>
<p>Where <code class="reqn">v_{t}</code> is a state vector.
</p>
<p>For some more information about the model and its implementation, see the
vignette: <code>vignette("sma","smooth")</code>
</p>


<h3>Value</h3>

<p>Object of class "smooth" is returned. It contains the list of the
following values:
</p>

<ul>
<li> <p><code>model</code> - the name of the estimated model.
</p>
</li>
<li> <p><code>timeElapsed</code> - time elapsed for the construction of the model.
</p>
</li>
<li> <p><code>states</code> - the matrix of the fuzzy components of ssarima, where
<code>rows</code> correspond to time and <code>cols</code> to states.
</p>
</li>
<li> <p><code>transition</code> - matrix F.
</p>
</li>
<li> <p><code>persistence</code> - the persistence vector. This is the place, where
smoothing parameters live.
</p>
</li>
<li> <p><code>measurement</code> - measurement vector of the model.
</p>
</li>
<li> <p><code>order</code> - order of moving average.
</p>
</li>
<li> <p><code>initial</code> - Initial state vector values.
</p>
</li>
<li> <p><code>initialType</code> - Type of initial values used.
</p>
</li>
<li> <p><code>nParam</code> - table with the number of estimated / provided parameters.
If a previous model was reused, then its initials are reused and the number of
provided parameters will take this into account.
</p>
</li>
<li> <p><code>fitted</code> - the fitted values.
</p>
</li>
<li> <p><code>forecast</code> - the point forecast.
</p>
</li>
<li> <p><code>lower</code> - the lower bound of prediction interval. When
<code>interval=FALSE</code> then NA is returned.
</p>
</li>
<li> <p><code>upper</code> - the higher bound of prediction interval. When
<code>interval=FALSE</code> then NA is returned.
</p>
</li>
<li> <p><code>residuals</code> - the residuals of the estimated model.
</p>
</li>
<li> <p><code>errors</code> - The matrix of 1 to h steps ahead errors. Only returned when the
multistep losses are used and semiparametric interval is needed.
</p>
</li>
<li> <p><code>s2</code> - variance of the residuals (taking degrees of freedom into
account).
</p>
</li>
<li> <p><code>interval</code> - type of interval asked by user.
</p>
</li>
<li> <p><code>level</code> - confidence level for interval.
</p>
</li>
<li> <p><code>cumulative</code> - whether the produced forecast was cumulative or not.
</p>
</li>
<li> <p><code>y</code> - the original data.
</p>
</li>
<li> <p><code>holdout</code> - the holdout part of the original data.
</p>
</li>
<li> <p><code>ICs</code> - values of information criteria of the model. Includes AIC,
AICc, BIC and BICc.
</p>
</li>
<li> <p><code>logLik</code> - log-likelihood of the function.
</p>
</li>
<li> <p><code>lossValue</code> - Cost function value.
</p>
</li>
<li> <p><code>loss</code> - Type of loss function used in the estimation.
</p>
</li>
<li> <p><code>accuracy</code> - vector of accuracy measures for the
holdout sample. Includes: MPE, MAPE, SMAPE, MASE, sMAE, RelMAE, sMSE and
Bias coefficient (based on complex numbers). This is available only when
<code>holdout=TRUE</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ivan Svetunkov, <a href="mailto:ivan@svetunkov.ru">ivan@svetunkov.ru</a>
</p>


<h3>References</h3>


<ul>
<li>
<p> Svetunkov I. (2023) Smooth forecasting with the smooth package in R. arXiv:2301.01790.
<a href="https://doi.org/10.48550/arXiv.2301.01790">doi:10.48550/arXiv.2301.01790</a>.
</p>
</li>
<li>
<p> Svetunkov I. (2015 - Inf) "smooth" package for R - series of posts about the underlying
models and how to use them: <a href="https://openforecast.org/category/r-en/smooth/">https://openforecast.org/category/r-en/smooth/</a>.
</p>
</li>
</ul>
<ul><li>
<p> Svetunkov, I., &amp; Petropoulos, F. (2017). Old dog, new tricks: a
modelling view of simple moving averages. International Journal of
Production Research, 7543(January), 1-14.
<a href="https://doi.org/10.1080/00207543.2017.1380326">doi:10.1080/00207543.2017.1380326</a>
</p>
</li></ul>
<h3>See Also</h3>

<p><code>filter, adam, msarima</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# SMA of specific order
ourModel &lt;- sma(rnorm(118,100,3), order=12, h=18, holdout=TRUE)

# SMA of arbitrary order
ourModel &lt;- sma(rnorm(118,100,3), h=18, holdout=TRUE)

plot(forecast(ourModel, h=18, interval="empirical"))

</code></pre>


</div>