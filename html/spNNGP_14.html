<div class="container">

<table style="width: 100%;"><tr>
<td>spDiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model fit diagnostics</h2>

<h3>Description</h3>

<p>The function <code>spDiag</code> calculates measurements of model fit for
objects of class <code>NNGP</code> and <code>PGLogit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  spDiag(object, sub.sample, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>NNGP</code> or <code>PGLogit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.sample</code></td>
<td>
<p>an optional list that specifies the samples to included in
the computations. Valid tags are <code>start</code>,
<code>end</code>, and <code>thin</code>. Given the value associated with the tags,
the sample subset is selected using <code>seq(as.integer(start),
    as.integer(end), by=as.integer(thin))</code>. The default values are
<code>start=floor(0.5*n.samples)</code>, <code>end=n.samples</code> and
<code>thin=1</code>. If <code>sub.samples</code> is not specified, then it is
taken from <code>object</code>, or, if not aviable in <code>object</code> the
default values of <code>start</code>, <code>end</code>, and <code>thin</code> are
used. Note, if the <code>object</code> is a <code>NNGP</code> <code>response</code> model
and <code>n</code> is large, then computing the replicated data needed for
<code>GPD</code> and <code>GRS</code> can take a long time. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently no additional arguments.  </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following tags:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>
<p>a data frame holding Deviance information criterion (DIC) and associated values. Values in <code>DIC</code> include
<code>DIC</code> the criterion (lower is better), <code>D</code> a goodness of fit, and <code>pD</code> the effective
number of parameters, see Spiegelhalter et al. (2002) for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GPD</code></td>
<td>
<p>a data frame holding D=G+P and associated values. Values in
<code>GPD</code> include <code>G</code> a goodness of fit, <code>P</code> a penalty term, and <code>D</code> the
criterion (lower is better), see Gelfand
and Ghosh (1998) for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GRS</code></td>
<td>
<p>a scoring rule, see Equation 27 in Gneiting and Raftery
(2007) for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WAIC</code></td>
<td>
<p>a data frame hold Watanabe-Akaike information criteria (WAIC) and associated values. Values in
<code>WAIC</code> include <code>LPPD</code> log pointwise predictive density,
<code>P.1</code> penalty term defined in unnumbered equation above Equation
(11) in Gelman et al. (2014), <code>P.2</code> an alternative penalty
term defined in Equation (11), and the criteria <code>WAIC.1</code> and
<code>WAIC.2</code> (lower is better) computed using <code>P.1</code> and
<code>P.2</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.rep.samples</code></td>
<td>
<p>if <code>y.rep.samples</code> in <code>object</code> were not
used (or not available), then the newly computed <code>y.rep.samples</code> is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.fit.samples</code></td>
<td>
<p>if <code>y.fit.samples</code> in <code>object</code> were not
used (or not available), then the newly computed <code>y.fit.samples</code> is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.indx</code></td>
<td>
<p>the index of samples used for the computations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andrew O. Finley <a href="mailto:finleya@msu.edu">finleya@msu.edu</a>, <br>
Sudipto Banerjee <a href="mailto:sudipto@ucla.edu">sudipto@ucla.edu</a>
</p>


<h3>References</h3>

<p>Finley, A.O., A. Datta, S. Banerjee (2022) spNNGP R Package for
Nearest Neighbor Gaussian Process Models. <em>Journal of Statistical
Software</em>, <a href="https://doi.org/10.18637/jss.v103.i05">doi:10.18637/jss.v103.i05</a>.
</p>
<p>Gelfand A.E. and Ghosh, S.K. (1998). Model choice: a minimum posterior
predictive loss approach. <em>Biometrika</em>, 85:1-11.
</p>
<p>Gelman, A., Hwang, J., and  Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and
Computing</em>, 24:997-1016.
</p>
<p>Gneiting, T. and Raftery, A.E. (2007). Strictly proper scoring rules, prediction, and estimation.
<em>Journal of the American Statistical Association</em>, 102:359-378.
</p>
<p>Spiegelhalter, D.J., Best, N.G., Carlin, B.P., van der Linde, A. (2002). Bayesian measures of model complexity and fit (with discussion). <em>Journal of the Royal Statistical Society, Series B.</em>, 64:583-639.
</p>


</div>