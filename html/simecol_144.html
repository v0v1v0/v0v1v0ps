<div class="container">

<table style="width: 100%;"><tr>
<td>ssqOdeModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sum of Squares Between odeModel and Data</h2>

<h3>Description</h3>

<p>Compute the sum of squares between a given data and an <code>odeModel</code>
object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssqOdeModel(p, simObj, obstime, yobs, 
  sd.yobs = as.numeric(lapply(yobs, sd)), 
  initialize = TRUE, lower. = -Inf, upper. = Inf, weights = NULL,
  debuglevel = 0, ..., pnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of named parameter values of the model (can be a
subset),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simObj</code></td>
<td>
<p>a valid object of class <code>odeModel</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obstime</code></td>
<td>
<p>vector with time steps for which observational data are
available,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yobs</code></td>
<td>
<p>data frame with observational data for all or a subset of
state variables. Their names must correspond exacly with existing
names of state variables in the <code>odeModel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.yobs</code></td>
<td>
<p>vector of given standard deviations for all
observational variables given in <code>yobs</code>. If no standard
deviations are given, these are estimated from yobs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialize</code></td>
<td>
<p>optional boolean value whether the <code>simObj</code>
should be re-initialized after the assignment of new parameter
values. This can be necessary in certain models to assign consistent
values to initial state variables if they depend on parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower., upper.</code></td>
<td>
<p>named vectors with lower and upper bounds used
in the optimisation,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional weights to be used in the fitting process.
Should be <code>NULL</code> or a data frame with the same structure as
<code>yobs</code>.  If non-NULL, weighted least squares is used with
<code>weights</code> (that is, minimizing <code>sum(w*e^2)</code>); otherwise
ordinary least squares is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debuglevel</code></td>
<td>
<p>a positive number that specifies the amount of
debugging information printed,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to the solver method (e.g.
<code>lsoda</code>),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnames</code></td>
<td>
<p>names of the parameters, optionally passed from
fitOdeModel. This argument is a workaround for <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions below
2.8.1. It may be removed in future versions of <span class="pkg">simecol</span>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the default function called by function
<code>fitOdeModel</code>. The source code of this function can be
used as a starting point to develop user-defined optimization
criteria (cost functions).
</p>


<h3>Value</h3>

<p>The sum of squared differences between <code>yobs</code> and simulation,
by default weighted by the inverse of the standard deviations of the respective
variables.
</p>


<h3>See Also</h3>

<p><code>fitOdeModel</code>, <code>optim</code>,
<code>p.constrain</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(chemostat)
cs1 &lt;- chemostat

## generate some noisy data
parms(cs1)[c("vm", "km")] &lt;- c(2, 10)
times(cs1) &lt;- c(from = 0, to = 20, by = 2)
yobs &lt;- out(sim(cs1))
obstime &lt;- yobs$time
yobs$time &lt;- NULL
yobs$S &lt;- yobs$S + rnorm(yobs$S, sd = 0.1 * sd(yobs$S))*2
yobs$X &lt;- yobs$X + rnorm(yobs$X, sd = 0.1 * sd(yobs$X))

## SSQ between model and data
ssqOdeModel(NULL, cs1, obstime, yobs)

## SSQ between model and data, different parameter set
ssqOdeModel(p=c(vm=1, km=2), cs1, obstime, yobs)

## SSQ between model and data, downweight second observation
## (both variables)
weights &lt;- data.frame(X=rep(1, nrow(yobs)), S = rep(1, nrow=(yobs)))
ssqOdeModel(p=c(vm=1, km=2), cs1, obstime, yobs, weights=weights)

## downweight 3rd data set (row)
weights[3,] &lt;- 0.1
ssqOdeModel(p=c(vm=1, km=2), cs1, obstime, yobs, weights=weights)

## give one value double weight (e.g. 4th value of S)
weights$S[4] &lt;- 2
ssqOdeModel(p=c(vm=1, km=2), cs1, obstime, yobs, weights=weights)

</code></pre>


</div>