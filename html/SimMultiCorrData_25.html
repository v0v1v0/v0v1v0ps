<div class="container">

<table style="width: 100%;"><tr>
<td>findintercorr_pois_nb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Poisson - Negative Binomial Variables: Correlation Method 1</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_pois x k_nb</code> intermediate matrix of correlations for the
Poisson and Negative Binomial variables by extending the method of Yahav &amp; Shmueli (2012, doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>). The intermediate correlation
between Z1 and Z2 (the standard normal variables used to generate the Poisson and Negative Binomial variables Y1 and Y2
via the inverse cdf method) is calculated using a logarithmic transformation of the target correlation.
First, the upper and lower Frechet-Hoeffding bounds (mincor, maxcor) on <code class="reqn">\rho_{y1,y2}</code> are simulated.
Then the intermediate correlation is found as follows:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{z1,z2} = (1/b) * log((\rho_{y1,y2} - c)/a)</code>
</p>
<p>, where <code class="reqn">a = -(maxcor * mincor)/(maxcor + mincor)</code>,
<code class="reqn">b = log((maxcor + a)/a)</code>, and <code class="reqn">c = -a</code>.  The function adapts code from Amatya &amp; Demirtas' (2016) package
<code>PoisNor-package</code> by:
</p>
<p>1) allowing specifications for the number of random variates and the seed for reproducibility
</p>
<p>2) providing the following checks: if <code class="reqn">\rho_{z1,z2}</code> &gt;= 1, <code class="reqn">\rho_{z1,z2}</code> is set to 0.99; if <code class="reqn">\rho_{z1,z2}</code> &lt;= -1,
<code class="reqn">\rho_{z1,z2}</code> is set to -0.99
</p>
<p>3) simulating Negative Binomial variables.
The function is used in <code>findintercorr</code> and <code>rcorrvar</code>.
This function would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findintercorr_pois_nb(rho_pois_nb, lam, size, prob, mu = NULL,
  nrand = 100000, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho_pois_nb</code></td>
<td>
<p>a <code>k_pois x k_nb</code> matrix of target correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>a vector of lambda (&gt; 0) constants for the Poisson variables (see <code>Poisson</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector of size parameters for the Negative Binomial variables (see <code>NegBinomial</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of success probability parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of mean parameters (*Note: either <code>prob</code> or <code>mu</code> should be supplied for all Negative Binomial variables,
not a mixture; default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>the number of random numbers to generate in calculating the bound (default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used in random number generation (default = 1234)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the <code>k_pois x k_nb</code> intermediate correlation matrix whose rows represent the <code>k_pois</code> Poisson variables and
columns represent the <code>k_nb</code> Negative Binomial variables
</p>


<h3>References</h3>

<p>Please see references for <code>findintercorr_pois</code>.
</p>


<h3>See Also</h3>

<p><code>PoisNor-package</code>, <code>findintercorr_pois</code>,
<code>findintercorr_nb</code>,
<code>findintercorr</code>, <code>rcorrvar</code>
</p>


</div>