<div class="container">

<table style="width: 100%;"><tr>
<td>acoustat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistics on time and frequency STFT contours</h2>

<h3>Description</h3>

<p>This function returns statistics based on STFT time and
frequency contours.</p>


<h3>Usage</h3>

<pre><code class="language-R">acoustat(wave, f, channel = 1, wl = 512, ovlp = 0, wn = "hanning",
tlim = NULL, flim = NULL,
aggregate = sum, fraction = 90,
plot = TRUE, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>window length for the analysis
(even number of points) (by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default
<code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>modifications of the time limits of the analysis (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>modifications of the frequency limits of the analysis (in kHz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate</code></td>
<td>
<p>a character vector of length 1 specifying the function to be applied on the rows (time) and columns (frequency) of the STFT matrix. By default set to <code>sum</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fraction</code></td>
<td>
<p>a numeric vector of length 1, specifying a particular
fraction of the contours amplitude to be captured by the initial and
terminal percentile values (in %). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical, if <code>TRUE</code> a two-frame plot is returned
with the time and frequency contours and percentiles displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn. See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The principle of <code>acoustat</code> is as follows:
</p>

<ol>
<li>
<p> Compute the short-term Fourier transform (STFT) with usual
parameters (<code>wl</code> for window length, <code>ovlp</code> for overlap of
successive windows, and <code>wn</code> for the name of window shape).
</p>
</li>
<li>
<p> This results in a time * frequency matrix.
</p>
</li>
<li>
<p> Compute an aggregation function (specified with the argument
<code>aggregate</code> set by default to <code>sum</code>) accross rows and
columns of time * frequency matrix.)
</p>
</li>
<li>
<p> This results in two components: (<em>i</em>) the time contour,
and (<em>ii</em>) the frequency contour.
</p>
</li>
<li>
<p> Each contour is considered as a probability mass function
(PMF) and transformed into a cumulated distribution function (CDF).
</p>
</li>
<li>
<p> Measures are extracted from each CDF: median (M), initial
percentile (P1) value, terminal percentile (P2) value, interpercentile range (IPR). P1, P2 and IPR are defined using a fraction parameter
(<code>fraction</code>) that sets the percent of the contour amplitude to be captured by the initial and terminal percentile values. A fraction of 50% would result in the familiar quartiles and interquartile range. An energy fraction of 80% would return the 10th and 90th percentile values, and the width of the range in between.
</p>
</li>
</ol>
<h3>Value</h3>

<p>The function returns a list with 10 items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time.contour</code></td>
<td>
<p>the time contour as a two-column matrix, the
first colum being time (s) and the second colum being the amplitude
probability mass function (no scale).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.contour</code></td>
<td>
<p>the frequency contour as a two-column matrix,
the first colum being frequency (kHz) and the second colum being the
amplitude probability mass function (no scale).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.P1</code></td>
<td>
<p>the time initial percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.M</code></td>
<td>
<p>the time median</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.P2</code></td>
<td>
<p>the time terminal percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.IPR</code></td>
<td>
<p>the time interpercentile range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.P1</code></td>
<td>
<p>the frequency initial percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.M</code></td>
<td>
<p>the frequency median</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.P2</code></td>
<td>
<p>the frequency terminal percentile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.IPR</code></td>
<td>
<p>the frequency interpercentile range</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>acoustat</code> was originally developped in Matlab language by Kurt Fristrup and XXXX Watkins (1992) .<br>
The <abbr><span class="acronym">R</span></abbr> function was kindly checked by Kurt Fristrup.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>References</h3>

<p>Fristrup, K. M. and Watkins, W. A. 1992. Characterizing
acoustic features of marine animal sounds.
Woods Hole Oceanographic Institution Technical Report WHOI-92-04.</p>


<h3>See Also</h3>

<p><code>meanspec</code>, <code>specprop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico)
note &lt;- cutw(tico, from=0.5, to=0.9, output="Wave")
## default setting
acoustat(note)
## change the percentile fraction
acoustat(note, fraction=50)
## change the STFT parameters
acoustat(note, wl=1024, ovlp=80)
## change the function to compute the aggregate contours
## standard deviation instead of sum   
acoustat(note, aggregate=sd)
## direct time and frequency selection     
acoustat(tico, tlim=c(0.5,0.9), flim=c(3,6))
## some useless graphical changes
acoustat(note, type="o", col="blue") 
</code></pre>


</div>