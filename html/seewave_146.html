<div class="container">

<table style="width: 100%;"><tr>
<td>spectro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2D-spectrogram of a time wave</h2>

<h3>Description</h3>

<p>This function returns a two-dimension spectrographic representation of a time
wave. The function corresponds to short-term Fourier transform.
An amplitude contour plot can be overlaid.</p>


<h3>Usage</h3>

<pre><code class="language-R">spectro(wave, f, channel = 1, wl = 512, wn = "hanning", zp = 0,
ovlp = 0, noisereduction = NULL, fastdisp = FALSE,
complex = FALSE, norm = TRUE, correction="none",
fftw = FALSE, dB = "max0", dBref = NULL, plot = TRUE,
flog = FALSE, grid = TRUE, osc = FALSE, scale = TRUE, cont = FALSE,
collevels = NULL, palette = spectro.colors,
contlevels = NULL, colcont = "black",
colbg = "white", colgrid = "black",
colaxis = "black", collab="black",
cexlab = 1, cexaxis = 1, 
tlab = "Time (s)",
flab = "Frequency (kHz)",
alab = "Amplitude",
scalelab = "Amplitude\n(dB)",
main = NULL,
scalefontlab = 1, scalecexlab =0.75,
axisX = TRUE, axisY = TRUE, tlim = NULL, trel = TRUE,
flim = NULL, flimd = NULL,
widths = c(6,1), heights = c(3,1),
oma = rep(0,4),
listen=FALSE,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>window length for the analysis
(even number of points) (by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default
<code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zp</code></td>
<td>
<p>zero-padding (even number of points), see <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noisereduction</code></td>
<td>
<p>a numeric vector of length 1, if <code>1</code> a
noise reduction is applied along the rows of the spectrogram, if
<code>2</code> a noise reduction applied along the columns. See <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastdisp</code></td>
<td>
<p>faster graphic display for long <code>wave</code>. The
spectrogram/oscillogram is displayed/saved faster in the graphic device/
graphic file when set to <code>TRUE</code>, with a cost on graphical resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complex</code></td>
<td>
<p>if <code>TRUE</code> the STFT will be returned as complex
numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>if <code>TRUE</code> the STFT is normalised (i. e. scaled) by its maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>a character vector of length 1 to apply an
amplitude ("amplitude") or an energy ("energy") correction
to each FT window. This argument is useful only when one wish to obtain
absolute values that is when <code>norm=FALSE</code>.
By default no correction is applied ("none").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code>. See Notes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>a character string specifying the type dB to return: "max0"
(default) for a maximum dB value at 0, "A", "B", "C", "D", and "ITU" for
common dB weights. If set to <code>NULL</code>, then a linear scale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBref</code></td>
<td>
<p>a dB reference value. <code>NULL</code> by default
but should be set to 2*10e-5 for a 20 microPa reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the spectrogram
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flog</code></td>
<td>
<p>a logical to plot the frequency on a logarithmic scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>logical, if <code>TRUE</code> plots a y-axis grid
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>osc</code></td>
<td>
<p>logical, if <code>TRUE</code> plots an oscillogram beneath
the spectrogram (by default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical, if <code>TRUE</code> plots a dB colour scale on the right
side of the spectrogram (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont</code></td>
<td>
<p>logical, if <code>TRUE</code> overplots contour lines on the spectrogram
(by default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collevels</code></td>
<td>
<p>a set of levels which are used to partition
the amplitude range of the spectrogram (in dB).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>a color palette function to be used to assign colors in
the plot, see <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contlevels</code></td>
<td>
<p>a set of levels which are used to partition
the amplitude range for contour overplot (in dB).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colcont</code></td>
<td>
<p>colour for <code>cont</code> plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colbg</code></td>
<td>
<p>background colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colgrid</code></td>
<td>
<p>colour for <code>grid</code> plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colaxis</code></td>
<td>
<p>color of the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collab</code></td>
<td>
<p>color of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexlab</code></td>
<td>
<p>size of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexaxis</code></td>
<td>
<p>size of the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlab</code></td>
<td>
<p>label of the time axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flab</code></td>
<td>
<p>label of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alab</code></td>
<td>
<p>label of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalelab</code></td>
<td>
<p>amplitude scale label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>label of the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalefontlab</code></td>
<td>
<p>font of the amplitude scale label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalecexlab</code></td>
<td>
<p>cex of the amplitude scale label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axisX</code></td>
<td>
<p>logical, if <code>TRUE</code> plots time X-axis (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axisY</code></td>
<td>
<p>logical, if <code>TRUE</code> plots frequency Y-axis (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>modifications of the time X-axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trel</code></td>
<td>
<p>time X-axis with a relative scale when <code>tlim</code> is not null,
<em>i.e.</em> relative to <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>modifications of the frequency Y-axis limits (in kHz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flimd</code></td>
<td>
<p>dynamic modifications of the frequency Y-axis limits. New <code>wl</code>
and <code>ovlp</code> arguments are applied to increase time/frequency resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widths</code></td>
<td>
<p>a vector of length 2 to control the relative widths of columns on
the device when <code>scale</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights</code></td>
<td>
<p>a vector of length 2 to control the relative heights of rows on
the device when <code>osc</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oma</code></td>
<td>
<p>a vector of length 4 to control the size of outer margins
when either <code>scale</code> or <code>osc</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listen</code></td>
<td>
<p>if <code>TRUE</code> the sound is played back (by default
<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>contour</code> and <code>oscillo</code>
graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Following Heisenberg uncertainty principle, the short-term Fourier transform
cannot be precised in both time and frequency. The temporal and frequency
precisions of the function are actually dependent of the <code>wl</code> value.
Choosing a high <code>wl</code> value will increase the frequency resolution but
reduce the temporal one, and <em>vice versa</em>. The frequency precision is
obtained by calculating the ratio <code>f</code>/<code>wl</code>,
and the temporal precision is obtained by calculating the reverse ratio
<code>wl</code>/<code>f</code>. This problem can be reduced in some way with <code>zp</code> that
adds 0 values on both sides of the analysis window. This increases frequency
resolution without altering time resolution.<br>
Any colour palette can be used. In particular, it is possible to use other
palettes coming with <span class="pkg">seewave</span>: <code>temp.colors</code>, 
<code>reverse.gray.colors.1</code>,
<code>reverse.gray.colors.2</code>, <code>reverse.heat.colors</code>,
<code>reverse.terrain.colors</code>,
<code>reverse.topo.colors</code>,
<code>reverse.cm.colors</code> corresponding to the reverse of <code>heat.colors</code>, 
<code>terrain.colors</code>, <code>topo.colors</code>, <code>cm.colors</code>.<br>
Use <code>locator</code> to identify  points.
The noise reduction using the argument <code>noisereduction</code> is an
image filter, not a signal filter. The principle consists in
subtracting each spectrogram row or column by its median. Noise reduction alters
energy conservation, it should then be used for visual display only. 
</p>


<h3>Value</h3>

<p>This function returns a list of three items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>a numeric vector corresponding to the time axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>a numeric vector corresponding to the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp</code></td>
<td>
<p>a numeric or a complex matrix corresponding to the amplitude values.
Each column is a Fourier transform of length <code>wl/2</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The argument <code>fftw</code> can be used to try to speed up process
time. When set to <code>TRUE</code>, the Fourier transform is computed
through the function <code>FFT</code> of the package <code>fftw</code>. This pacakge is a
wrapper around the fastest Fourier transform of the free C subroutine
library FFTW (<a href="http://www.fftw.org/">http://www.fftw.org/</a>). FFT should be then installed on your OS.</p>


<h3>Note</h3>

<p>This function is based on <code>fft</code>, <code>contour</code> and
<code>filled.contour</code></p>


<h3>Author(s)</h3>

<p>Jerome Sueur and Caroline Simonis.</p>


<h3>References</h3>

<p>Hopp, S. L., Owren, M. J. and Evans, C. S. (Eds) 1998. <em>Animal acoustic 
communication</em>. Springer, Berlin, Heidelberg.</p>


<h3>See Also</h3>

<p><code>ggspectro</code>, <code>spectro3D</code>,
<code>lts</code>, <code>dynspec</code>, <code>wf</code>, 
<code>oscillo</code>, <code>dBscale</code>, <code>fft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(tico)
data(pellucens)
# simple plots
spectro(tico,f=22050)
spectro(tico,f=22050,osc=TRUE)
spectro(tico,f=22050,scale=FALSE)
spectro(tico,f=22050,osc=TRUE,scale=FALSE)
# change the dB scale by setting a different dB reference value (20microPa)
spectro(tico,f=22050, dBref=2*10e-5)
# unnormalised spectrogram with a linear amplitude scale
spectro(tico, dB=NULL, norm=FALSE, scale=FALSE)
# manipulating wl
op&lt;-par(mfrow=c(2,2))
spectro(tico,f=22050,wl=256,scale=FALSE)
title("wl = 256")
spectro(tico,f=22050,wl=512,scale=FALSE)
title("wl = 512")
spectro(tico,f=22050,wl=1024,scale=FALSE)
title("wl = 1024")
spectro(tico,f=22050,wl=4096,scale=FALSE)
title("wl = 4096")
par(op)
# vertical zoom using flim
spectro(tico,f=22050, flim=c(2,6))
spectro(tico,f=22050, flimd=c(2,6))
# a full plot
pellu2&lt;-cutw(pellucens,f=22050,from=1,plot=FALSE)
spectro(pellu2,f=22050,ovlp=85,zp=16,osc=TRUE,
    cont=TRUE,contlevels=seq(-30,0,20),colcont="red",
    lwd=1.5,lty=2,palette=reverse.terrain.colors)
# black and white spectrogram 
spectro(pellu2,f=22050,ovlp=85,zp=16,
    palette=reverse.gray.colors.1)
# colour modifications
data(sheep)
spectro(sheep,f=8000,palette=temp.colors,collevels=seq(-115,0,1))
spectro(pellu2,f=22050,ovlp=85,zp=16,
palette=reverse.cm.colors,osc=TRUE,colwave="orchid1") 
spectro(pellu2,f=22050,ovlp=85,zp=16,osc=TRUE,palette=reverse.heat.colors,
colbg="black",colgrid="white", colwave="white",colaxis="white",collab="white")

## End(Not run)
</code></pre>


</div>