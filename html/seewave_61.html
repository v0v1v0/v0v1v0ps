<div class="container">

<table style="width: 100%;"><tr>
<td>fund</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fundamental frequency track</h2>

<h3>Description</h3>

<p>This function estimates the fundamental frequency through a
short-term cepstral transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fund(wave, f, channel = 1, wl = 512, ovlp = 0, fmax = f/2, threshold = NULL,
at = NULL, from = NULL, to = NULL, 
plot = TRUE, xlab = "Time (s)", ylab = "Frequency (kHz)",
ylim = c(0, f/2000), pb = FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>if <code>at</code> is not null, length of the window for the analysis
(even number of points, by defaults = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>the maximum frequency to detect (in Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>amplitude threshold for signal detection (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>position where the estimate the fundamental frequency (in s)</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>start position where to compute the fundamental frequency (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>end position to compute the fundamental frequency (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the fundamental frequency
modulations against time (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the time axis (s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the frequency axis (Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the range of frequency values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>if <code>TRUE</code> returns a text progress bar in the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>plot</code> is <code>FALSE</code>, <code>fund</code> returns a two-column matrix, the first column corresponding to time in seconds (<em>x</em>-axis) and the second column corresponding to 
to fundamental frequency in kHz (<em>y</em>-axis).<br>
NA corresponds to pause sections in <code>wave</code> (see
<code>threshold</code>). <br>
No plot is produced when using <code>at</code>.
</p>


<h3>Note</h3>

<p>This function is based on <code>ceps</code>.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a>.</p>


<h3>References</h3>

<p>Oppenheim, A.V. and Schafer, R.W. 2004. From frequency
to quefrency: a history of the cepstrum. <em>Signal Processing Magazine IEEE</em>,
21: 95-106.</p>


<h3>See Also</h3>

<p><code>cepstro</code>, <code>ceps</code>, <code>autoc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(sheep)
# estimate the fundamental frequency at a single position
fund(sheep, f=8000, fmax=300, at=1, plot=FALSE)
# track the fundamental frequency along time
fund(sheep,f=8000,fmax=300,type="l")
# with 50% overlap between successive sliding windows, time zoom and 
# amplitude filter (threshold)
fund(sheep,f=8000,fmax=300,type="b",ovlp=50,threshold=5,ylim=c(0,1),cex=0.5)
# overlaid on a spectrogram
spectro(sheep,f=8000,ovlp=75,zp=16,scale=FALSE,palette=reverse.gray.colors.2)
par(new=TRUE)
fund(sheep,f=8000,fmax=300,type="p",pch=24,ann=FALSE,
  xaxs="i",yaxs="i",col="black",bg="red",threshold=6)
</code></pre>


</div>