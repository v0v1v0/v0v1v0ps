<div class="container">

<table style="width: 100%;"><tr>
<td>he10</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Measles in UK: spatPomp generator with shared or unit-specific parameters</h2>

<h3>Description</h3>

<p>Generate a spatPomp object for measles adding spatial coupling to
The model and data from He et al. (2010) with gravity transport as
in Park and Ionides (2020). Other transport models may be added in future.
The data in the object matches He et al. (2010). The model matches
that analysis in the specific case where there is no coupling and all
parameters are unit-specific.
</p>


<h3>Usage</h3>

<pre><code class="language-R">he10(
  U = 6,
  dt = 2/365,
  Tmax = 1964,
  expandedParNames = c("alpha", "iota", "R0", "cohort", "amplitude", "gamma", "sigma",
    "sigmaSE", "rho", "psi", "g", "S_0", "E_0", "I_0"),
  basic_params = c(alpha = 1, iota = 0, R0 = 30, cohort = 0, amplitude = 0.5, gamma = 52,
    sigma = 52, mu = 0.02, sigmaSE = 0.15, rho = 0.5, psi = 0.15, g = 400, S_0 = 0.032,
    E_0 = 5e-05, I_0 = 4e-05),
  towns_selected = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>A length-one numeric signifying the number of cities to be
represented in the spatPomp object. Default U=20 gives all the towns
studied by He et al., the 10 largest and 10 selected smaller towns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>a numeric (in unit of years) that is used as the Euler time-increment for simulating measles data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmax</code></td>
<td>
<p>Upper time for the window used to construct the object. The lower time is fixed at 1950.0. The default value matches He et al (2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expandedParNames</code></td>
<td>
<p>specifies the names of parameters which take unit-specific values. Remaining parameters take a single, shared value for all units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basic_params</code></td>
<td>
<p>A candidate parameter vector in the basic format, i.e., no unit-specific parameters or unit-related name extensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>towns_selected</code></td>
<td>
<p>A numeric vector of towns to be modeled. Defaults 
to 1:U, with cities ranked by decreasing population and 1 being London.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The code for this spatPomp has duplication with measles(), but in future
the two models may diverge. The measles() spatPomp is a simplified
situation useful for testing some methods. However, measles() does not
permit unit-specific parameters, which he10() allows. Also, 
the structure of this spatPomp is compatible with the spatiotemporal 
iterated filtering algorithm ibpf(). This requires shared parameters to
be represented with a value for each unit, which should be the same for each
unit in a valid model instance but may vary between units while optimizing.
</p>


<h3>Value</h3>

<p>An object of class ‘spatPomp’ representing a <code>U</code>-dimensional spatially coupled measles POMP model.
</p>


<h3>Relationship to published analysis</h3>

<p>The model generator <code>he10()</code> differs from <code>measles()</code> in some details necessitated to reproduce the results of He et al (2010).
The <code>measles()</code> model follows the decision of Park and Ionides (2020) and Ionides et al (2021) to apply the mixing exponent <code class="reqn">\alpha_u</code> to <code class="reqn">(I_u/P_u)</code> rather than just to <code class="reqn">I_u</code>.
<code>he10()</code> does this for the infections arising from individuals traveling to another town (which don't arise for the panel model of He et al (2010)).
However, for infections arising within a city, in order to reproduce the results of He et al (2010), <code>he10()</code> uses <code class="reqn">(I_u^{\alpha_u}/P_u)</code>.
This is not fully documented in the text of Ionides et al (2022).
Models fitted to data have <code class="reqn">alpha_u</code> close to <code class="reqn">1</code>, so this issue may be negligible in practice.
</p>
<p>Another discrepancy between the <code>he10()</code> code and the mathematical model written by Ionides et al (2022) arises in whether individuals traveling from <code class="reqn">u</code> to <code class="reqn">v</code> use mixing exponent <code class="reqn">\alpha_u</code> or <code class="reqn">\alpha_v</code>.
Ionides et al (2022) wrote <code class="reqn">u</code> but the code used implemented <code class="reqn">v</code>.
The implementation in <code>he10()</code> matches the implementation of Ionides et al (2022) and so uses <code class="reqn">v</code>.
</p>
<p>It might seem surprising that immigrant infections affect only the first term in the expression for <code class="reqn">\mu_{SE}</code> in Ionides et al (2022), and in the corresponding <code>he10()</code> code.
This immigration term is needed in the first term to make the model of He et al (2010) a proper sub-model, when coupling is removed by setting the gravitational constant parameter equal to zero.
When this constant is allowed to be positive, the role of immigrant infections transmitting to traveling individuals is anticipated to be a negligible, second-order effect which has been omitted from the model.
</p>


<h3>Note</h3>

<p>This function goes through a typical workflow of constructing
a typical spatPomp object (1-4 below). This allows the user to have a
file that replicates the exercise of model building as well as function
that creates a typical nonlinear model in epidemiology in case they want
to test a new inference methodology. We purposely do not modularize this
function because it is not an operational piece of the package and is
instead useful as an example.<br>
1. Getting a measurements data.frame with columns for times,
spatial units and measurements.<br>
2. Getting a covariates data.frame with columns for times,
spatial units and covariate data.<br>
3. Constructing model components (latent state initializer,
latent state transition simulator and measurement model). Depending
on the methods used, the user may have to supply a vectorfield to
be integrated that represents the deterministic skeleton of the latent
process.<br>
4. Bringing all the data and model components together to form a
spatPomp object via a call to spatPomp().
</p>


<h3>Author(s)</h3>

<p>Edward L. Ionides
</p>


<h3>References</h3>

<p>Asfaw, K., Park, J., Ho, A., King, A. A., and Ionides, E. L. (2020) Partially observed Markov processes with spatial structure via the R package spatPomp. <em>ArXiv</em>: 2101.01157. <a href="https://doi.org/10.48550/arXiv.2101.01157">doi:10.48550/arXiv.2101.01157</a>
</p>
<p>He, D., Ionides, E. L., and King, A. A. (2010). Plug-and-play inference for disease dynamics: measles in large and small populations as a case study. <em>Journal of the Royal Society Interface</em>, <b>7</b>(43), 271-283. <a href="https://doi.org/10.1098/rsif.2009.0151">doi:10.1098/rsif.2009.0151</a>
</p>
<p>Ionides, E. L., Asfaw, K., Park, J., and King, A. A. (2021). Bagged filters for partially observed interacting systems. <em>Journal of the American Statistical Association</em>, <a href="https://doi.org/10.1080/01621459.2021.1974867">doi:10.1080/01621459.2021.1974867</a>
</p>
<p>Ionides, E. L., Ning, N., and Wheeler, J. (2022). An iterated block particle filter for inference on coupled dynamic systems with shared and unit-specific parameters. <em>Statistica Sinica</em>, to appear. <a href="https://doi.org/10.48550/arXiv.2206.03837">doi:10.48550/arXiv.2206.03837</a>
</p>
<p>Park, J. and Ionides, E. L. (2020) Inference on high-dimensional implicit dynamic models using a guided intermediate resampling filter. <em>Statistics and Computing</em>, <a href="https://doi.org/10.1007/s11222-020-09957-3">doi:10.1007/s11222-020-09957-3</a>
</p>


<h3>See Also</h3>

<p><code>he10coordinates</code>, <code>he10measles</code>, <code>he10mle</code>, <code>he10demography</code>
</p>
<p>Other spatPomp model generators: 
<code>bm()</code>,
<code>bm2()</code>,
<code>gbm()</code>,
<code>lorenz()</code>,
<code>measles()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Complete examples are provided in the package tests
## Not run: 
m &lt;- he10(U = 5)
# See all the model specifications of the object
spy(m)

## End(Not run)
</code></pre>


</div>