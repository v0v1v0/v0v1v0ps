<div class="container">

<table style="width: 100%;"><tr>
<td>prince.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Heatmap of the associations between principal components and sample annotations
</h2>

<h3>Description</h3>

<p>This function uses the calculations performed by prince() and plots the log10
of p-values obtained by the linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prince.plot(prince, label = colnames(prince$o), smallest = -20, note = F, 
            notecol = "black", notecex = 1, 
            breaks = seq(-20,0,length.out=100), col = heat.colors(99), 
            margins = c(5, 7), key = T, cexRow = 1, cexCol = 1, 
            xlab = "Principal Components (Variation)", colsep = NULL, 
            rowsep = NULL, sepcolor = "black", sepwidth = c(0.05,0.05),
            Rsquared = F, breaksRsquared = seq(0,1,length.out=100) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prince</code></td>
<td>
<p>an object generated by the function prince()
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>vector containing names of the sample annotation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallest</code></td>
<td>
<p>a numeric value. log10(p-values) less than smallest are set to
smallest for plotting. default = -20.
e.g. a log10 p-value of -37 will be set to -20. Smallest has
to be less than 0.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>note</code></td>
<td>
<p>set to TRUE to print the p-values in the cells of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notecol</code></td>
<td>
<p>to determine the color of the notes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notecex</code></td>
<td>
<p>to determine the font size of the notes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>either a number (default=100) or a numeric
vector (default would be seq(-20,0,length.out=100)) of breaks for the colors
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors with a length of breaks-1. default=heat.colors(99).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>a vector with the margins for columns and rows. default=c(5,7).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>whether the color key should be printed, default=TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexRow</code></td>
<td>
<p>font size of label. default=1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexCol</code></td>
<td>
<p>font size of column labeling. default=1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>an additional character vector to print at the bottom.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colsep</code></td>
<td>
<p>same as in heatmap.2 function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowsep</code></td>
<td>
<p>same as in heatmap.2 function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepcolor</code></td>
<td>
<p>same as in heatmap.2 function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepwidth</code></td>
<td>
<p>same as in heatmap.2 function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsquared</code></td>
<td>
<p>set to TRUE to print Rsquared values instead of log10 p-values. 
Missing values in object o will flaw the comparability of p-values. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaksRsquared</code></td>
<td>
<p>same format as argument breaks. will be used when Rsquared=TRUE
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plot indicates batch effects, and shows the influence of the biological annotations
on the overall variation. The input has to be an object generated by the prince() function.
The plot is based on the heatmap.2 function from the gplots package. Colors, breaks,
font size and margins can be changed and cell notes can be added.
The log10 of p-values from linear model are plotted. If Rsquared is TRUE the
R-squared values from linear model are plotted instead.
</p>


<h3>Note</h3>

<p>requires the package gplots</p>


<h3>Author(s)</h3>

<p>Martin Lauss</p>


<h3>Examples</h3>

<pre><code class="language-R">## data as a matrix
set.seed(100)
g&lt;-matrix(nrow=1000,ncol=50,rnorm(1000*50),dimnames=list(paste("Feature",1:1000),
          paste("Sample",1:50)))
g[1:100,26:50]&lt;-g[1:100,26:50]+1 # the first 100 features show
# higher values in the samples 26:50
## patient annotations as a data.frame, annotations should be numbers and factors
# but not characters.
## rownames have to be the same as colnames of the data matrix 
set.seed(200)
o&lt;-data.frame(Factor1=factor(c(rep("A",25),rep("B",25))),
              Factor2=factor(rep(c("A","B"),25)),
              Numeric1=rnorm(50),row.names=colnames(g))
              
## calculate principal components and use linear models to calculate their 
## dependence on sample annotations
res1&lt;-prince(g,o,top=10)
## plot p-values as heatmap
prince.plot(prince=res1)
</code></pre>


</div>