<div class="container">

<table style="width: 100%;"><tr>
<td>correct_counts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correct data by setting all latent factors to their median values and reversing the regression model</h2>

<h3>Description</h3>

<p>This version does not need a matrix of Pearson residuals. It takes the count matrix as input and
calculates the residuals on the fly. The corrected UMI counts will be rounded to the nearest
integer and negative values clipped to 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">correct_counts(
  x,
  umi,
  cell_attr = x$cell_attr,
  scale_factor = NA,
  verbosity = 2,
  verbose = NULL,
  show_progress = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A list that provides model parameters and optionally meta data; use output of vst function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umi</code></td>
<td>
<p>The count matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_attr</code></td>
<td>
<p>Provide cell meta data holding latent data info</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_factor</code></td>
<td>
<p>Replace all values of UMI in the regression model by this value. Default is NA
which uses median of total UMI as the latent factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>An integer specifying whether to show only messages (1), messages and progress bars (2) or nothing (0) while the function is running; default is 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Deprecated; use verbosity instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_progress</code></td>
<td>
<p>Deprecated; use verbosity instead</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Corrected data as UMI counts
</p>


<h3>Examples</h3>

<pre><code class="language-R">
vst_out &lt;- vst(pbmc, return_cell_attr = TRUE)
umi_corrected &lt;- correct_counts(vst_out, pbmc)


</code></pre>


</div>