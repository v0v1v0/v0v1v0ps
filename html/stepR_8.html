<div class="container">

<table style="width: 100%;"><tr>
<td>compareBlocks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare fit blockwise with ground truth</h2>

<h3>Description</h3>

<p>Blockwise comparison of a fitted step function with a known ground truth using different criteria.</p>


<h3>Usage</h3>

<pre><code class="language-R">compareBlocks(truth, estimate, dist = 5e3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>truth</code></td>
<td>
<p>an object of class <code>stepblock</code> giving the ground truth, or a list of such objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>corresponding estimated object(s) of class <code>stepblock</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a single <code>numeric</code> specifying the distance for at which jumps will be considered as having matched in the qualitative criterion</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code>, containing just one row if two single <code>stepblock</code> were given, with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>true.num, est.num</code></td>
<td>
<p>the true / estimated number of blocks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.pos, false.pos, false.neg, sens.rate, prec.rate</code></td>
<td>
<p>the number of true / false positive, false negatives, as well as the corresponding sensitivity and precision rates, where an estimated block is considered a true positive if it there is a corresponding block in the ground truth with both endpoints within <code>dist</code> of each other</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpsle</code></td>
<td>
<p>false positive sensitive localization error: for each estimated block's midpoint find into which true block it falls, and sum distances of the respective borders</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fnsle</code></td>
<td>
<p>false negative sensitive localization error: for each true block's mid-point find into which estimated block it falls, and sum distances of the respective borders</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.le</code></td>
<td>
<p>total localization error: sum of <code>fpsle</code> and <code>fnsle</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>No differences between true and fitted parameter <em>values</em> are taking into account, only the precision of the detected blocks is considered; also, differing from the criteria in Elhaik et al.~(2010), no blocks are merged in the ground truth if its parameter values are close, as this may punish sensitive estimators. 
</p>
<p>Beware that these criteria compare <em>blockwise</em>, i.e. they do <em>not</em> compare the precision of single jumps but for each block both endpoints have to match well at the same time.
</p>


<h3>References</h3>

<p>Elhaik, E., Graur, D., Josić, K. (2010) Comparative testing of DNA segmentation algorithms using benchmark simulations. <em>Molecular Biology and Evolution</em> <b>27</b>(5), 1015-24.
</p>
<p>Futschik, A., Hotz, T., Munk, A. Sieling, H. (2014) Multiresolution DNA partitioning: statistical evidence for segments. <em>Bioinformatics</em>,  <b>30</b>(16), 2255–2262.
</p>


<h3>See Also</h3>

<p><code>stepblock</code>, <code>stepfit</code>, <code>contMC</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate two Gaussian hidden Markov models of length 1000 with 2 states each
# with identical transition rates being 0.01 and 0.05, resp, signal-to-noise ratio is 5
sim &lt;- lapply(c(0.01, 0.05), function(rate)
  contMC(1e3, 0:1, matrix(c(0, rate, rate, 0), 2), param=1/5))
plot(sim[[1]]$data)
lines(sim[[1]]$cont, col="red")
# use smuceR to estimate fit
fit &lt;- lapply(sim, function(s) smuceR(s$data$y, s$data$x))
lines(fit[[1]], col="blue")
# compare fit with (discretised) ground truth
compareBlocks(lapply(sim, function(s) s$discr), fit)
</code></pre>


</div>