<div class="container">

<table style="width: 100%;"><tr>
<td>starts_uni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions for the Univariate STARTS Model
</h2>

<h3>Description</h3>

<p>Functions for computing the covariance matrix and simulating data
from the univariate STARTS model (Kenny &amp; Zautra, 1995, 2001). The STARTS model can
be estimated with maximum likelihood, penalized maximum likelihood (i.e.,
maximum posterior estimation) or Markov Chain Monte Carlo.
See Luedtke, Robitzsch and Wagner (2018) for comparisons among estimation methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## estimation of univariate STARTS model
starts_uni_estimate(data=NULL, covmat=NULL, nobs=NULL, estimator="ML",
    pars_inits=NULL, prior_var_trait=c(3, 0.33), prior_var_ar=c(3, 0.33),
    prior_var_state=c(3, 0.33), prior_a=c(3, 0.5), est_var_trait=TRUE,
    est_var_ar=TRUE, est_var_state=TRUE, var_meas_error=0, constraints=TRUE,
    time_index=NULL, type="stationary", n.burnin=5000, n.iter=20000,
    verbose=FALSE, optim_fct="optim", use_rcpp=TRUE )

## S3 method for class 'starts_uni'
summary(object, digits=3, file=NULL, print_call=TRUE, ...)

## S3 method for class 'starts_uni'
plot(x, ...)

## S3 method for class 'starts_uni'
logLik(object, ...)

## S3 method for class 'starts_uni'
coef(object, ...)

## S3 method for class 'starts_uni'
vcov(object, ...)

## computation of covariance matrix
starts_uni_cov(W, var_trait, var_ar, var_state, a, time_index=NULL,
       add_meas_error=NULL)

## simulation of STARTS model
starts_uni_sim(N, W, var_trait, var_ar, var_state, a, time_index=NULL )

#--- deprecated functions
starts_cov(W, var_trait, var_ar, var_state, a)
starts_sim1dim(N, W, var_trait, var_ar, var_state, a )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame. Missing data must be coded as <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmat</code></td>
<td>

<p>Covariance matrix (not necessary if <code>data</code> is provided)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>

<p>Number of observations (not necessary if <code>data</code> is provided)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>

<p>Type of estimator: <code>"ML"</code> for maximum likelihood estimation
(using <code>LAM::pmle</code>),
<code>"PML"</code> for penalized maximum likelihood estimation (using <code>LAM::pmle</code>)
and <code>"MCMC"</code> for Markov chain Monte Carlo estimation
(using <code>LAM::amh</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_inits</code></td>
<td>

<p>Optional vector of initial parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_trait</code></td>
<td>

<p>Vector of length two specifying the inverse gamma prior for trait variance. The first entry
is the prior sample size, the second entry the guess of the proportion
of the variance that is attributed to the trait variance. See Luedtke et al. (2018)
for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_ar</code></td>
<td>

<p>Prior for autoregressive variance. See <code>prior_var_trait</code> for
details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_state</code></td>
<td>

<p>Prior for state variance. See <code>prior_var_trait</code> for
details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_a</code></td>
<td>

<p>Vector of length two for specification of the beta prior for stability parameter <code>a</code>.
The first entry corresponds to the prior sample size, the second entry corresponds
to the prior guess of the stability parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_var_trait</code></td>
<td>

<p>Logical indicating whether the trait variance should be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_var_ar</code></td>
<td>

<p>Logical indicating whether the autoregressive variance should be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_var_state</code></td>
<td>

<p>Logical indicating whether the state variance should be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_meas_error</code></td>
<td>

<p>Value of known measurement variance. Could be based on a reliability estimate of
internal consistency, for example.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>

<p>Logical indicating whether variances should be constrained to be positive
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_index</code></td>
<td>

<p>Integer vector of time indices. Time points can be non-equidistant, but must
be integer values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of starts model. Only <code>"stationary"</code> is implemented in this
package version.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burnin</code></td>
<td>
<p>Number of burn-in iterations (if <code>estimator="MCMC"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Total number of iterations (if <code>estimator="MCMC"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether iteration progress should be
displayed (if <code>estimator="ML"</code> or <code>estimator="PML"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_fct</code></td>
<td>
<p>Type of optimization function if <code>estimator="ML"</code> or
<code>estimator="PML"</code>. Can be <code>"optim"</code> for <code>stats::optim</code>
or <code>"nlminb"</code> for <code>stats::nlminb</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rcpp</code></td>
<td>
<p>Logical indicating whether <span class="pkg">Rcpp</span> code should be used in
estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>Number of measurement waves.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_trait</code></td>
<td>

<p>Variance of trait component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_ar</code></td>
<td>

<p>Variance of autoregressive component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_state</code></td>
<td>

<p>Variance of state component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>Sample size of persons
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>Stability parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>starts_uni</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimal in <code>summary</code> output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name for <code>summary</code> output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_call</code></td>
<td>
<p>Logical indicating whether call should be printed in <code>summary</code>
output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>starts_uni</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed. For the <code>plot</code> method,
see the <code>plot</code> method for the <code>LAM::amh</code>
function for arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_meas_error</code></td>
<td>
<p>Optional vector of measurement error variance which
should be added to the diagonal of the covariance matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Output of <code>starts_uni_estimate</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Vector of estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further values</p>
</td>
</tr>
</table>
<p>Output of <code>starts_uni_cov</code> is a covariance matrix.
</p>
<p>Output of <code>starts_uni_sim</code> is a data frame containing simulated values.
</p>


<h3>References</h3>

<p>Kenny, D. A., &amp; Zautra, A. (1995). The trait-state-error
model for multiwave data.
<em>Journal of Consulting and Clinical Psychology, 63</em>, 52-59.
doi: <a href="https://doi.org/10.1037/0022-006X.63.1.52">10.1037/0022-006X.63.1.52</a>
</p>
<p>Kenny, D. A., &amp; Zautra, A. (2001). Trait-state models for
longitudinal data. In L. M. Collins &amp; A. G. Sayer (Eds.),
<em>New methods for the analysis of change</em> (pp. 243-263).
Washington, DC, US: American Psychological Association.
doi: <a href="https://doi.org/10.1037/10409-008">10.1037/10409-008</a>
</p>
<p>Luedtke, O., Robitzsch, A., &amp; Wagner, J. (2018). More stable estimation of the STARTS model:
A Bayesian approach using Markov Chain Monte Carlo techniques.
<em>Psychological Methods, 23</em>(3), 570-593. doi: <a href="https://doi.org/10.1037/met0000155">10.1037/met0000155</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sirt)

#############################################################################
# EXAMPLE 1: STARTS model specification using starts_uni_estimate
#############################################################################

## use simulated dataset according to Luedtke et al. (2017)

data(data.starts01a, package="STARTS")
dat &lt;- data.starts01a

#--- covariance matrix and number of observations
covmat &lt;- stats::cov( dat[, paste0("E",1:5) ] )
nobs &lt;- nrow(dat)

#*** Model 1a: STARTS model with ML estimation
mod1a &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs)
summary(mod1a)

## Not run: 
#- estimate model based on input data
mod1a1 &lt;- STARTS::starts_uni_estimate( data=dat[, paste0("E",1:5) ])
summary(mod1a1)

#*** Model 1b: STARTS model with penalized ML estimation using the default priors
mod1b &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, estimator="PML")
summary(mod1b)

#*** Model 1c: STARTS model with MCMC estimation and default priors
set.seed(987)
mod1c &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, estimator="MCMC")

# assess convergence
plot(mod1c)
# summary
summary(mod1c)
# extract more information
logLik(mod1c)
coef(mod1c)
vcov(mod1c)

#*** Model 1d: MCMC estimation with different prior distributions
mod1d &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, estimator="MCMC",
             prior_var_trait=c(10, 0.5), prior_var_ar=c(10, 0.3),
             prior_var_state=c(10, 0.2), prior_a=c(1, 0.5) )
summary(mod1d)

#*** Model 2: remove autoregressive process
mod2 &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, est_var_ar=FALSE)
summary(mod2)

#*** Model 3: remove stable trait factor
mod3 &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, est_var_trait=FALSE)
summary(mod3)

#*** Model 4: remove state variance from the model
mod4 &lt;- STARTS::starts_uni_estimate( covmat=covmat, nobs=nobs, est_var_state=FALSE)
summary(mod4)

## End(Not run)
</code></pre>


</div>