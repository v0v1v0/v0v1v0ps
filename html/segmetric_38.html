<div class="container">

<table style="width: 100%;"><tr>
<td>subset_handling_functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subset handling functions</h2>

<h3>Description</h3>

<p>These functions are intended to be used in new metric extensions.
They handle <code>subset_sf</code> data (inherited from <code>sf</code> class) stored in
<code>segmetric</code> objects.
</p>

<ul>
<li> <p><code>sm_list()</code> lists subsets already computed and stored in a <code>segmetric</code>
object.
</p>
</li>
<li> <p><code>sm_exists()</code> verifies if a <code>subset_id</code> exists in a <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_subset()</code> evaluates and stores a <code>subset_sf</code> object.
</p>
</li>
<li> <p><code>sm_indirect()</code> finds the <code>subset_id</code> of a given <code>subset_sf</code> object stored
in a <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_segmetric()</code> returns the <code>segmetric</code> object that stores a given
<code>subset</code> object (either a <code>ref_sf</code>, a <code>seg_sf</code>, or a <code>subset_sf</code>).
</p>
</li>
<li> <p><code>sm_get()</code> retrieves a <code>subset_sf</code> object stored in a <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_inset()</code> operator equivalent to inner join but returns only objects
from <code>s1</code>, or its corresponding row in <code>s2</code> if parameter <code>return_index</code>
is <code>TRUE</code>.
</p>
</li>
<li> <p><code>sm_group_by()</code>: Apply a function to groups of <code>subset_sf</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">sm_list(m)

sm_exists(m, subset_id)

sm_subset(m, subset_id, expr = NULL)

sm_indirect(s)

sm_segmetric(s)

sm_get(m, subset_id)

sm_ref(m)

sm_seg(m)

sm_inset(s1, s2, return_index = FALSE)

## S3 method for class 'ref_sf'
sm_inset(s1, s2, return_index = FALSE)

## S3 method for class 'seg_sf'
sm_inset(s1, s2, return_index = FALSE)

## S3 method for class 'subset_sf'
sm_inset(s1, s2, return_index = FALSE)

sm_group_by(s, by, fn, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A <code>segmetric</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_id</code></td>
<td>
<p>A <code>character</code> value informing a subset name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>A valid piece of code in R inside curly braces. This
code is evaluated to generate a subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s, s1, s2</code></td>
<td>
<p>Either a <code>ref_sf</code>, a <code>seg_sf</code>, or a <code>subset_sf</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_index</code></td>
<td>
<p>A <code>logical</code> value indicating if the corresponding rows
in <code>s1</code> should be returned instead of the actual corresponding values
of <code>s2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>A <code>character</code> value with the column to group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>A <code>function</code> to apply on each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For <code>sm_group_by()</code>, extra parameter to pass to
<code>fn</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>sm_list()</code>: Return a <code>character</code> vector with all names of subsets stored
in the <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_exists()</code>: Return a <code>logical</code> value indicating if a given subset name is
stored in the <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_subset()</code>: Return a <code>subset_sf</code> object.
</p>
</li>
<li> <p><code>sm_indirect()</code>: Return the subset name of a given <code>subset_sf</code> object
stored in a <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_segmetric()</code>: Return a <code>segmetric</code> object that stores a given
<code>subset_sf</code> object.
</p>
</li>
<li> <p><code>sm_get()</code>: Return a <code>subset_sf</code> object stored in a <code>segmetric</code> object.
</p>
</li>
<li> <p><code>sm_inset()</code>: Return either a <code>subset_sf</code> object or an <code>integer</code> vector
with the index of corresponding rows of <code>s2</code> object.
</p>
</li>
<li> <p><code>sm_group_by()</code>: Return a <code>subset_sf</code> object.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># load sample datasets
data("sample_ref_sf", package = "segmetric")
data("sample_seg_sf", package = "segmetric")

# create segmetric object
m &lt;- sm_read(ref_sf = sample_ref_sf, seg_sf = sample_seg_sf)

# lists only 'ref_sf' and 'seg_sf'
sm_list(m)

# computes 'Y_tilde' subset and stores it as 'test_subset' subset id
# sm_ytilde(m) also stores a subset under 'Y_tilde' id
s &lt;- sm_subset(m, "test_subset", sm_ytilde(m))

# lists 'ref_sf', 'seg_sf', 'test_subset', and 'Y_tilde'
sm_list(m)

# which segmetric object stores `s` subset?
m2 &lt;- sm_segmetric(s)

# m is identical to m2
identical(m, m2)

# which name `s` subset is stored in `m` segmetric object?
sm_indirect(s)

# retrieve 'test_subset' data from `m` object
s2 &lt;- sm_get(m, 'test_subset')

# s is identical to s2
identical(s, s2)
</code></pre>


</div>