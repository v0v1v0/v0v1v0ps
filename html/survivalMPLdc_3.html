<div class="container">

<table style="width: 100%;"><tr>
<td>coxph_mpl_dc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas</h2>

<h3>Description</h3>

<p>Simultaneously estimate the regression coefficients and the baseline hazard function of proportional
hazard Cox models under dependent right censoring using maximum penalised likelihood (MPL) and Archimedean Copulas
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxph_mpl_dc(surv, cova, control,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>the outcome of survival data, with the first column X (observed time), second column
del (event indicator) and third column eta (dependent right censoring indicator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cova</code></td>
<td>
<p>the covariate matrix, with dimension of n rows and p columns, where 'n' is the sample size and 'p' is the number of covariates
Default is <code>cova=matrix(0,n,1)</code>, which the covariates are not considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>object of class <code>coxph_mpl_dc.control</code> specifying control options like basis choice,
refer to <code>coxph_mpl_dc.control</code> to see the defaults.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments. In <code>coxph_mpl_dc</code>, these elements, will be passed to <code>coxph_mpl_dc.control</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>coxph_mpl_dc allows to simultaneously estimate the regression coefficients and baseline hazard function of Cox proportional hazard models,
with dependent and independent right censored data, by maximizing a penalized likelihood,
in which a penalty function is used to smooth the baseline hazard estimates.
Note that the dependence between event and censoring times is modelled by an Archimedean copula.
</p>
<p>Optimization is achieved using an iterative algorithm, which combines Newton’s method and the multiplicative iterative algorithm proposed by Ma (2010),
and respects the non-negativity constraints on the baseline hazard estimate (refer to Ma et al (2014) and Xu et al (2018)).
</p>
<p>The centered covariate matrix <code class="reqn">Z</code> is used in the optimization process to get a better shaped (penalized) log-likelihood.
Baseline hazard parameter estimates and covariance matrix are then respectively corrected using a correction factor and the delta method.
</p>
<p>The estimates of zero are possible for baseline hazard parameters (e.g., when number of knots is relatively large to sample size) and
will correspond to active constraints as defined by Moore and Sadler (2008). Inference, as described by Ma et al (2014) or Xu et al (2018),
is then corrected accordingly (refer to Moore and Sadler (2008)) by adequately cutting the corresponding covariance matrix.
</p>
<p>There are currently three ways to perform inference on model parameters: Let <code class="reqn">H</code> denote the negative of Hessian matrix of the non-penalized likelihood,
<code class="reqn">Q</code> denote the product of the first order derivative of the penalized likelihood by its transpose,
and <code class="reqn">M_2</code> denote the negative of the second order derivative of the penalized likelihood.
Then the three estimated covariance matrices for the MPL estimates are <code class="reqn">M_{2}^{-1}</code>, <code class="reqn">M_{2}^{-1}HM_{2}^{-1}</code> and <code class="reqn">M_{2}^{-1}QM_{2}^{-1}</code>.
</p>
<p>Simulation studies the coverage levels of confidence intervals for the regression parameters seem to indicate
<code class="reqn">M_{2}^{-1}HM_{2}^{-1}</code> performs better when using the piecewise constant basis,
and that <code class="reqn">M_{2}^{-1}QM_{2}^{-1}</code>  performs better when using other bases.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mpl_theta</code></td>
<td>
<p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of T, i.e. theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_gamma</code></td>
<td>
<p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of C, i.e. gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_h0t</code></td>
<td>
<p>MPL estimates of the baseline hazard for T, i.e. h_0T(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_h0c</code></td>
<td>
<p>MPL estimates of the baseline hazard for C, i.e. h_0C(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_H0t</code></td>
<td>
<p>MPL estimates of the baseline cumulative hazard for T, i.e. H_0T(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_H0c</code></td>
<td>
<p>MPL estimates of the baseline cumulative hazard for C, i.e. H_0c(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_S0t</code></td>
<td>
<p>MPL estimates of the baseline survival for T, i.e. S_0T(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_S0c</code></td>
<td>
<p>MPL estimates of the baseline survival for C, i.e. S_0C(x_i)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_beta</code></td>
<td>
<p>MPL estimates of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_phi</code></td>
<td>
<p>MPL estimates of phi</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penloglik</code></td>
<td>
<p>the penalized log-likelihood function given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Ubeta</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to beta given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Uphi</code></td>
<td>
<p>the first derivative of penalized log-likelihood unction with respect to phi given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Utheta</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to theta given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Ugamma</code></td>
<td>
<p>the first derivative of penalized log-likelihood function with respect to gamma given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>a vector of length 3 indicating the number of iterations used to estimate the smoothing parameter
(first value, equal to 1 when the user specified a chosen value), the beta, phi, theta and gamma parameters during the entire process (second value),
and beta, phi, theta and gamma parameters during the last smoothing parameter iteration (third value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_cvl</code></td>
<td>
<p>the cross validation value given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_aic</code></td>
<td>
<p>the AIC value given the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_beta_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimated beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_phi_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimated phi</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_h0t_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of T, i.e. theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_h0c_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of C, i.e. gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_ht0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of T</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_hc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Ht0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of T</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Hc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_St0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline survival of T</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_Sc0_sd</code></td>
<td>
<p>the asymptotic standard deviation of the MPL estimates for the baseline survival of C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_est_cov</code></td>
<td>
<p>the asymptotic covariance matrix of the MPL estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpl_beta_phi_zp</code></td>
<td>
<p>the MPL estimates for regression coefficient with their corresponding standard deviations, z scores and p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwv</code></td>
<td>
<p>the width of each discretized bin of the observed times when piecewise constant approximation applied to the baseline hazards</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>the bin ID for each individual of the sample when piecewise constant approximation applied to the baseline hazards</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binedg</code></td>
<td>
<p>the edge for each discretized bin among the observed time vector X, which are the internal knots and boundaries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psix</code></td>
<td>
<p>basis function matrix psi(x_i) with dimension of n by m for baseline hazard, where m=number of internal knots+ordSp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psix</code></td>
<td>
<p>basis function matrix Psi(x_i) with dimension of n by m for baseline cumulative hazard</p>
</td>
</tr>
</table>
<p>Inputs defined in coxph_mpl_dc.control
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Ma, J. (2010). <em>"Positively constrained multiplicative iterative algorithm for maximum penalised likelihood tomographic reconstruction"</em>.
IEEE Transactions On Signal Processing 57, 181-192.
</p>
<p>Ma, J. and Heritier, S. and Lo, S. (2014). <em>"On the Maximum Penalised Likelihood Approach forProportional Hazard Models with Right Censored Survival Data"</em>.
Computational Statistics and Data Analysis 74, 142-156.
</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>"Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood"</em>.
Statistics in Medicine 37, 2238–2251.
</p>


<h3>See Also</h3>

<p><code>plot.coxph_mpl_dc</code>, <code>coxph_mpl_dc.control</code>, <code>coef.coxph_mpl_dc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 ##-- Copula types
 copula3 &lt;- 'frank'

 ##-- Marginal distribution for T, C, and A
 a &lt;- 2
 lambda &lt;- 2
 cons7 &lt;- 0.2
 cons9 &lt;- 10
 tau &lt;- 0.8
 betas &lt;- c(-0.5, 0.1)
 phis &lt;- c(0.3, 0.2)
 distr.ev &lt;- 'weibull'
 distr.ce &lt;- 'exponential'

 ##-- Sample size
 n &lt;- 200

 ##-- One sample Monte Carlo dataset
 cova &lt;- cbind(rbinom(n, 1, 0.5), runif(n, min=-10, max=10))
 surv &lt;- surv_data_dc(n, a, cova, lambda, betas, phis, cons7, cons9, tau, copula3,
                     distr.ev, distr.ce)
 n &lt;- nrow(cova)
 p &lt;- ncol(cova)
 ##-- event and dependent censoring proportions
 colSums(surv)[c(2,3)]/n
 X &lt;- surv[,1] # Observed time
 del&lt;-surv[,2] # failure status
 eta&lt;-surv[,3] # dependent censoring status

 ##-- control inputs for the coxph_mpl_dc function
 control &lt;- coxph_mpl_dc.control(ordSp = 4,
                             binCount = 100,
                             tau = 0.8, copula = copula3,
                             pent = 'penalty_mspl', smpart = 'REML',
                             penc = 'penalty_mspl', smparc = 'REML',
                             cat.smpar = 'No' )

 ##-- Fitting cox ph hazard model for T using MPL and an correct copula
 #with REML smoothing parameters
 coxMPLests5 &lt;- coxph_mpl_dc(surv, cova, control, )
 mpl_beta_phi_zp5 &lt;- coxMPLests5$mpl_beta_phi_zp
 mpl_h0t5 &lt;- coxMPLests5$mpl_h0t
 mpl_h0Ti5 &lt;- approx( X, mpl_h0t5, xout = seq(0, 5.4, 0.01),
                    method="constant", rule = 2, ties = mean)$y

 ##-- Real marginal baseline hazard for T
 ht0b &lt;- a * (seq(0, 5.4, 0.01) ^ (a - 1)) / (lambda ^ a)


 ##-- Fitting cox ph hazard model for T using MPL and an correct copula
 #with zero smoothing parameters
 coxMPLests3 &lt;- coxph_mpl_dc(surv, cova,
                          ordSp=4, binCount=100,
                          tau=0.8, copula=copula3,
                          pent='penalty_mspl', smpart=0, penc='penalty_mspl', smparc=0,
                          cat.smpar = 'No')
 mpl_beta_phi_zp3 &lt;- coxMPLests3$mpl_beta_phi_zp
 mpl_h0t3 &lt;- coxMPLests3$mpl_h0t
 mpl_h0Ti3 &lt;- approx( X, mpl_h0t3, xout = seq(0, 5.4, 0.01),
 method="constant", rule = 2, ties = mean)$y

 ##-- Plot the true and estimated baseline hazards for T
 t_up &lt;- 3.5
 y_uplim &lt;- 2
 Ti&lt;-seq(0, 5.4, 0.01)[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti&lt;-ht0b[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti5&lt;-mpl_h0Ti5[seq(0, 5.4, 0.01)&lt;=t_up]
 h0Ti3&lt;-mpl_h0Ti3[seq(0, 5.4, 0.01)&lt;=t_up]

 plot( x = Ti, y = h0Ti5,
      type="l", col="grey", lty=4, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim),
      xlab='Time', ylab='Hazard')
 lines(x = Ti, y = h0Ti,
      col="green",
      lty=1, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim)
      )
 lines(x = Ti, y = h0Ti3,
      col="blue",
      lty=4, lwd=3, cex.axis=1.6, cex.lab=1.6, ylim=c(0, y_uplim)
      )





</code></pre>


</div>