<div class="container">

<table style="width: 100%;"><tr>
<td>dmst.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dynamic Minimum Spanning Tree spatial scan test</h2>

<h3>Description</h3>

<p><code>dmst.test</code> implements the dynamic Minimum Spanning
Tree scan test of Assuncao et al. (2006). Starting with a
single region as a current zone, new candidate zones are
constructed by combining the current zone with the
connected region that maximizes the resulting likelihood
ratio test statistic.  This procedure is repeated until
the population or distance upper bounds are reached.  The
same procedure is repeated for each region.  The clusters
returned are non-overlapping, ordered from most
significant to least significant. The first cluster is
the most likely to be a cluster. If no significant
clusters are found, then the most likely cluster is
returned (along with a warning).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmst.test(
  coords,
  cases,
  pop,
  w,
  ex = sum(cases)/sum(pop) * pop,
  nsim = 499,
  alpha = 0.1,
  ubpop = 0.5,
  ubd = 1,
  longlat = FALSE,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>An <code class="reqn">n \times 2</code> matrix of centroid
coordinates for the regions in the form (x, y) or
(longitude, latitude) is using great circle distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A binary spatial adjacency matrix for the
regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations from which to
compute the p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level to determine whether
a cluster is signficant.  Default is 0.10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubpop</code></td>
<td>
<p>The upperbound of the proportion of the
total population to consider for a cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubd</code></td>
<td>
<p>A proportion in (0, 1].  The distance of
potential clusters must be no more than <code>ubd * m</code>,
where <code>m</code> is the maximum intercentroid distance
between all coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>The default is <code>FALSE</code>, which
specifies that Euclidean distance should be used. If
<code>longlat</code> is <code>TRUE</code>, then the great circle
distance is used to calculate the intercentroid
distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The maximum intercentroid distance can be found by
executing the command:
<code>gedist(as.matrix(coords), longlat = longlat)</code>,
based on the specified values of <code>coords</code> and
<code>longlat</code>.
</p>


<h3>Value</h3>

<p>Returns a <code>smerc_cluster</code> object.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Assuncao, R.M., Costa, M.A., Tavares, A. and
Neto, S.J.F. (2006). Fast detection of arbitrarily
shaped disease clusters, Statistics in Medicine, 25,
723-742.  &lt;doi:10.1002/sim.2411&gt;
</p>


<h3>See Also</h3>

<p><code>print.smerc_cluster</code>,
<code>summary.smerc_cluster</code>,
<code>plot.smerc_cluster</code>,
<code>scan.stat</code>, <code>scan.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
data(nyw)
coords &lt;- with(nydf, cbind(longitude, latitude))
out &lt;- dmst.test(
  coords = coords, cases = floor(nydf$cases),
  pop = nydf$pop, w = nyw,
  alpha = 0.12, longlat = TRUE,
  nsim = 2, ubpop = 0.05, ubd = 0.1
)
# better plotting
if (require("sf", quietly = TRUE)) {
   data(nysf)
   plot(st_geometry(nysf), col = color.clusters(out))
}
</code></pre>


</div>