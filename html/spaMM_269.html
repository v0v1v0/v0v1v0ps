<div class="container">

<table style="width: 100%;"><tr>
<td>negbin1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Alternative negative-binomial family  
</h2>

<h3>Description</h3>

<p>Returns a <code>family</code> object suitable as a <code>fitme</code> argument for fitting negative-binomial models with variance linearly (affinely) related to the mean <code class="reqn">\mu</code>: variance=<code class="reqn">\mu+\mu</code>/shape, where the shape parameter need or need not be specified, depending on usage. 
The model described by such a family is characterized by a linear predictor, a link function, and such a negative-binomial model for the residual variation. The zero-truncated variant of this family is also handled.
</p>
<p>A <b>fixed-effect</b> residual-dispersion model can be fitted, using the <code>resid.model</code> argument, which is used to specify the form of the logarithm of the shape parameter. Thus the variance of the response become <code class="reqn">\mu+\mu</code>/<code>exp(&lt;specified linear expression&gt;)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">negbin1(shape = stop("negbin1's 'shape' must be specified"), link = "log", trunc = -1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>

<p>Parameter controlling the mean-variance relationship of the <code>negbin1</code> distribution. This distribution can be represented as a Poisson-Gamma mixture, where the conditional Poisson mean is <code class="reqn">\mu</code> times a Gamma random variable with mean 1 and variance 1/(<code>shape*</code><code class="reqn">\mu</code>) as produced by <code>rgamma(., shape=sh,scale=1/sh)</code> where <code>sh=shape*</code><code class="reqn">\mu</code>, meaning that the family <code>shape</code> parameter controls, but differs from, the gamma <code>shape</code> parameter. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>log, sqrt or identity link, specified by any of the available ways for GLM links (name, character string, one-element character vector, or object of class <code>link-glm</code> as returned by <code>make.link</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>Either <code>0L</code> for zero-truncated distribution, or <code>-1L</code> for default untruncated distribution.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The name <code>NB_shape</code> should be used to set values of shape in optimization control arguments of the fitting functions (e.g., <code>fitme(.,init=list(NB_shape=1))</code>); but fixed values are set by the <code>shape</code> argument.
</p>
<p>The family should not be used as a <code>glm</code> argument as the results would not be correct.
</p>



<h3>Value</h3>

<p>A list, formally of class <code>c("LLF", "family")</code>. See <code>LL-family</code> for details about the structure and usage of such objects.
</p>


<h3>See Also</h3>

<p>Examples in <code>LL-family</code>. <code>resid.model</code> for an example with a residual-dispersion model.</p>


</div>