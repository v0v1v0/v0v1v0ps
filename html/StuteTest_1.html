<div class="container">

<table style="width: 100%;"><tr>
<td>stute_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linearity test from Stute (1997)</h2>

<h3>Description</h3>

<p>Linearity test from Stute (1997)
</p>


<h3>Usage</h3>

<pre><code class="language-R">stute_test(
  df,
  Y,
  D,
  group = NULL,
  time = NULL,
  order = 1,
  seed = NULL,
  brep = 500,
  baseline = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>(data.frame) A dataframe object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>(char) Outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>(char) Treatment/independent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>(char) Group variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>(char) Time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>(numeric) If this option is specified with <code>order = k</code>, the program tests whether the conditional expectation of <code class="reqn">Y</code> given <code class="reqn">D</code> is a <code class="reqn">k</code>-degree polynomial in <code class="reqn">D</code>. With <code>order = 0</code>, the command tests the hypothesis that the conditional mean of <code class="reqn">Y</code> given <code class="reqn">D</code> is constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>(numeric) This option allows to specify the seed for the wild bootstrap routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brep</code></td>
<td>
<p>(numeeric) This option allows to specify the number of wild bootstrap replications. The default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>(numeric) This option allows to select one of the periods in the data as the baseline or omitted period. For instance, in a dataset with the support  of <code>time</code> equal to <code class="reqn">(2001, 2002, 2003)</code>, <code>stute_test(..., baseline = 2001)</code> will test the hypotheses that the expectations of <code class="reqn">Y_2002 - Y_2001</code> and <code class="reqn">Y_2003 - Y_2001</code> are linear functions of <code class="reqn">D_2002 - D_2001</code> and <code class="reqn">D_2003 - D_2001</code>. This option can only be specified in <code>panel</code> mode.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with stute_test custom class that includes point estimates and p-values from the test. If the test is performed in panel mode with more than 1 periods, the returned object also includes the point estimate and p-value from a joint test on the sum of the individual test statistics.
</p>


<h3>Overview</h3>

<p>This program implements the non-parametric test that the expectation of Y given D is linear proposed by Stute (1997). In the companion vignette, we sketch the intuition behind the test, as to motivate the use of the package and its options. Please refer to Stute (1997) and Section 3 of de Chaisemartin and D'Haultfoeuille (2024) for further details.
</p>
<p>This package allows for two estimation settings:
</p>
<p>1. <code>cross-section</code>. The test is run using the full dataset, treating each observation as an independent realization of <code class="reqn">(Y,D)</code>. 
</p>
<p>2. <code>panel</code>. The test is run for all values of <code>time</code>, using a panel with <code class="reqn">G</code> groups/units and <code class="reqn">T</code> periods. In this mode, the test statistics will be computed among observations having the same value of <code>time</code>. The program will also return a joint test on the sum of the period-specific estimates. Due to the fact that inference on the joint statistic is performed via the bootstrap distribution of the  sum of the test statistics across time periods, this  mode requires a strongly balanced panel with no gaps.
</p>


<h3>References</h3>

<p>de Chaisemartin, C, D'Haultfoeuille, X (2024). [Two-way Fixed Effects and Difference-in-Difference Estimators in Heterogeneous Adoption Designs](https://ssrn.com/abstract=4284811).
</p>
<p>Stute, W (1997). [Nonparametric model checks for regression](https://www.jstor.org/stable/2242560).
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)
GG &lt;- 10; TT &lt;- 5;
data &lt;- as.data.frame(matrix(NA, nrow = GG * TT, ncol = 0))
data$G &lt;- (1:nrow(data) - 1) %% GG + 1
data$T &lt;- floor((1:nrow(data)-1)/GG) + 2000
data &lt;- data[order(data$G, data$T), ]
data$D &lt;- runif(n=nrow(data))
data$Y &lt;- runif(n=nrow(data))
stute_test(df = data, Y = "Y", D = "D")
stute_test(df = data, Y = "Y", D = "D", group = "G", time = "T")
stute_test(df = data, Y = "Y", D = "D", group = "G", time = "T", baseline = 2001)
</code></pre>


</div>