<div class="container">

<table style="width: 100%;"><tr>
<td>pois.cusum.arl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ARLs of Poisson CUSUM control charts</h2>

<h3>Description</h3>

<p>Computation of the (zero-state) Average Run Length (ARL) at given mean <code>mu</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">pois.cusum.arl(mu, km, hm, m, i0=0, sided="upper", rando=FALSE,
gamma=0, km2=0, hm2=0, m2=0, i02=0, gamma2=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>actual mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km</code></td>
<td>
<p>enumerator of rational approximation of reference value <code>k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hm</code></td>
<td>
<p>enumerator of rational approximation of reference value <code>h</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>denominator of rational approximation of reference value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i0</code></td>
<td>
<p>head start value as integer multiple of <code>1/m</code>; should be an element of <code>0:hm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between different one- and two-sided CUSUM control chart by choosing
<code>"upper"</code>, <code>"lower"</code> and <code>"two"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rando</code></td>
<td>
<p>Switch for activating randomization in order to allow continuous ARL control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Randomization probability. If the CUSUM statistic is equal to the threshold <code>h</code>,
an control chart alarm is triggered with probability <code>gamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km2,hm2,m2,i02,gamma2</code></td>
<td>
<p>corresponding values of the second CUSUM chart (to building a two-sided CUSUM scheme).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The monitored data follow a Poisson distribution with <code>mu</code>.
The ARL values of the resulting EWMA control chart are determined via Markov chain calculations.
We follow the algorithm given in Lucas (1985) expanded with some arithmetic 'tricks' (e.g., by deploying
Toeplitz matrix algebra). A paper explaining it is under preparation.
</p>


<h3>Value</h3>

<p>Returns a single value which resembles the ARL.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>J. M. Lucas (1985)
Counted data CUSUM's,
<em>Technometrics</em> 27(2), 129-144.
</p>
<p>C. H. White and J. B. Keats (1996)
ARLs and Higher-Order Run-Length Moments for the Poisson CUSUM,
<em>Journal of Quality Technology</em> 28(3), 363-369.
</p>
<p>C. H. White, J. B. Keats and J. Stanley (1997)
Poisson CUSUM versus c chart for defect data,
<em>Quality Engineering</em> 9(4), 673-679.
</p>
<p>G. Rossi and L. Lampugnani and M. Marchi (1999),
An approximate CUSUM procedure for surveillance of health events,
<em>Statistics in Medicine</em> 18(16), 2111-2122.
</p>
<p>S. W. Han, K.-L. Tsui, B. Ariyajunya, and S. B. Kim (2010),
A comparison of CUSUM, EWMA, and temporal scan statistics for detection of increases in poisson rates,
<em>Quality and Reliability Engineering International</em> 26(3), 279-289.
</p>
<p>M. B. Perry and J. J. Pignatiello Jr. (2011)
Estimating the time of step change with Poisson CUSUM and EWMA control charts,
<em>International Journal of Production Research</em> 49(10), 2857-2871.
</p>


<h3>See Also</h3>

<p>later.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Lucas 1985, upper chart (Tables 2 and 3)
k   &lt;- .25
h   &lt;- 10
m   &lt;- 4
km  &lt;- m * k
hm  &lt;- m * h
mu0 &lt;- 1 * k
ARL &lt;- pois.cusum.arl(mu0, km, hm-1, m)
# Lucas reported 438 (in Table 2, first block, row 10.0 .25 .0 ..., column 1.0
# Recall that Lucas and other trigger an alarm, if the CUSUM statistic is greater than
# or equal to the alarm threshold h
print(ARL)

ARL &lt;- pois.cusum.arl(mu0, km, hm-1, m, i0=round((hm-1)/2))
# Lucas reported 333 (in Table 3, first block, row 10.0 .25 .0 ..., column 1.0
print(ARL)

## Lucas 1985, lower chart (Tables 4 and 5)
ARL &lt;- pois.cusum.arl(mu0, km, hm-1, m, sided="lower")
# Lucas reported 437 (in Table 4, first block, row 10.0 .25 .0 ..., column 1.0
print(ARL)

ARL &lt;- pois.cusum.arl(mu0, km, hm-1, m, i0=round((hm-1)/2), sided="lower")
# Lucas reported 318 (in Table 5, first block, row 10.0 .25 .0 ..., column 1.0
print(ARL)
</code></pre>


</div>