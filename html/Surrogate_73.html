<div class="container">

<table style="width: 100%;"><tr>
<td>MufixedContCont.MultS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a multivariate fixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case with multiple surrogates)</h2>

<h3>Description</h3>

<p>The function <code>MufixedContCont.MultS</code> uses the multivariate fixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available and multiple surrogates are considered for a single true endpoint. The user can specify whether a (weighted or unweighted) full or reduced model should be fitted. See the <b>Details</b> section below. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">MufixedContCont.MultS(Dataset, Endpoints=True~Surr.1+Surr.2, 
 Treat="Treat", Trial.ID="Trial.ID", Pat.ID="Pat.ID", 
 Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, 
 Number.Bootstraps=0, Seed=123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains one or more  surrogate value(s), a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Endpoints</code></td>
<td>
<p>An equation in the form <code>True~Surr.1+Surr.2</code> that specifies the true endpoint followed by the surrogate endpoint(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code> or <code>Model=c("Reduced")</code>. For details, see below or Van der Elst <em>et al.</em> (2023). 
Default <code>Model=c("Full")</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain in order to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Number.Bootstraps</code></td>
<td>
<p>Lee's (Lee, 1971) approach is done by default to obtain confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Alternatively, a non-parametric bootstrap can be done. By default, <code>Number.Bootstraps=0</code> and thus no bootstrap is conducted. If a bootstrap is desired, specify the number of bootstrap samples used this argument. For example, <code>Number.Bootstraps=100</code> conducts a bootstrap with 100 bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed that is used in the bootstrap. Default <code>Seed=123</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the full multivariate mixed-effects model is fitted to assess surrogacy in the meta-analytic framework (for details, see Van der Elst <em>et al.</em>, 2023), computational issues often occur. In that situation, the use of simplified model-fitting strategies may be warranted (for details, see Burzykowski et al., 2005; Tibaldi et al., 2003).   
</p>
<p>The function <code>MufixedContCont.MultS</code> implements one such strategy, i.e., it uses a two-stage multivariate fixed-effects modelling approach to assess surrogacy. 
In the first stage of the analysis, a multivariate linear regression model is fitted. When a full model is requested (by using the argument <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S1_{ij}=\mu_{S1i}+\alpha_{S1i}Z_{ij}+\varepsilon_{S1ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">S2_{ij}=\mu_{S2i}+\alpha_{S2i}Z_{ij}+\varepsilon_{S2ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">SK_{ij}=\mu_{SKi}+\alpha_{SKi}Z_{ij}+\varepsilon_{SKij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{Ti}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S1i}</code>, <code class="reqn">\mu_{S2i}</code>, ..., <code class="reqn">\mu_{SKi}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for <code class="reqn">S1</code>, <code class="reqn">S2</code>, ... <code class="reqn">SK</code> and <code class="reqn">T</code>, and <code class="reqn">\alpha_{S1i}</code>, <code class="reqn">\alpha_{S2i}</code>, ..., <code class="reqn">\alpha_{SKi}</code> and <code class="reqn">\beta_{Ti}</code> are the trial-specific treatment effects on the surrogates and the true endpoint, respectively. When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S1_{ij}=\mu_{S1}+\alpha_{S1i}Z_{ij}+\varepsilon_{S1ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">S2_{ij}=\mu_{S2}+\alpha_{S2i}Z_{ij}+\varepsilon_{S2ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">SK_{ij}=\mu_{SK}+\alpha_{SKi}Z_{ij}+\varepsilon_{SKij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{Ti}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">\mu_{S1}</code>, <code class="reqn">\mu_{S2}</code>, ..., <code class="reqn">\mu_{SK}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for the surrogates and the true endpoint (i.e., it is assumed that the intercepts for the surrogates and the true endpoints are identical in all trials). The other parameters are the same as defined above. 
</p>
<p>In the above models, the error terms <code class="reqn">\varepsilon_{S1ij}</code>, <code class="reqn">\varepsilon_{S2ij}</code>, ..., <code class="reqn">\varepsilon_{SKij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>. 
</p>
<p>Next, the second stage of the analysis is conducted. When a full model is requested by the user (by using the argument  <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{Ti}=\lambda_{0}+\lambda_{1}\widehat{\mu}_{S1i}+
\lambda_{2}\widehat{\alpha}_{S1i}+\lambda_{3}\widehat{\mu}_{S2i}+\lambda_{4}\widehat{\alpha}_{S2i}+...+
\lambda_{2K-1}\widehat{\mu}_{SKi}+\lambda_{2K}\widehat{\alpha}_{SKi}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates are based on the full model that was fitted in stage 1. 
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code>), the <code class="reqn">\lambda_{1} \widehat{\mu}_{S1i}</code>, <code class="reqn">\lambda_{3} \widehat{\mu}_{S2i}</code>, ... and <code class="reqn">\lambda_{2K} \widehat{\mu}_{SKi}</code> components are dropped from the above expression. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>MufixedContCont.MultS</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate(s) and the true endpoints (when a full model is requested), or the trial-specific treatment effects for the surrogates and the true endpoints (when a reduced model is requested).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Residuals.Stage.1</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained in stage 1 of the analysis (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2.Adj.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the adjusted trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2.Adj.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the adjusted trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Indiv.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Indiv.R2.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fitted.Model.Stage.1</code></td>
<td>
<p>The fitted Stage 1 model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model.R2.Indiv</code></td>
<td>
<p>A linear model that regresses the residuals of T on the residuals of the different surrogates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.Equiv</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercept and treatment effects for the surrogates and true endpoints (when a full model is fitted, i.e., when <code>Model=c("Full")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogates and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).  The variance-covariance matrix <code>D.Equiv</code> is equivalent to the <code class="reqn">\bold{D}</code> matrix that would be obtained when a (full or reduced) mixed-effect approach is used; see function <code>MumixedContCont.MultS</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Lee, Y. S. (1971). Tables of the upper percentage points of the multiple correlation. <em>Biometrika, 59,</em> 175-189.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>
<p>Van der Elst <em>et al.</em> (2024). Multivariate surrogate endpoints for normally distributed continuous endpoints in the meta-analytic setting.
</p>


<h3>See Also</h3>

<p><code>MumixedContCont.MultS</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  # time consuming code part
data(PANSS)

# Do a surrogacy analysis with T=Total PANSS score, S1=Negative symptoms
# and S2=Positive symptoms
# Fit a full multivariate fixed-effects model with weighting according to the  
# number of patients in stage 2 of the two stage approach to assess surrogacy:
Fit.Neg.Pos &lt;- MufixedContCont.MultS(Dataset = PANSS, 
  Endpoints = Total ~ Neg+Pos, Model = "Full", 
  Treat = "Treat", Trial.ID = "Invest", Pat.ID = "Pat.ID")
  
# Obtain a summary of the results
summary(Fit.Neg.Pos)

## End(Not run)
</code></pre>


</div>