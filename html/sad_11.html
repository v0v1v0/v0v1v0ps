<div class="container">

<table style="width: 100%;"><tr>
<td>sadverif</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>dual-tree verification</h2>

<h3>Description</h3>

<p>verify the scale, anisotropy and direction of a number of forecasts
</p>


<h3>Usage</h3>

<pre><code class="language-R">sadverif(x, dec = TRUE, xmin = 0.1, log = TRUE, a = 1, nbr = 33,
  rsm = 0, Nx = NULL, Ny = NULL, J = NULL, boundaries = "pad",
  return_specs = FALSE)

## S3 method for class 'sadverif'
plot(x, ...)

## S3 method for class 'sadverif'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of equally sized matrices, the first element is assumed to be the observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>logical, do you want to use the decimated transform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>values smaller than <code>xmin</code> are set to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, do you want to log-transfrom the data? (recommended for precipitation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>relative weight of directional errors compared to scale errors in <code>semdd</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbr</code></td>
<td>
<p>number of breaks for the scale histograms, has no effect if <code>dec=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsm</code></td>
<td>
<p>number of pixels which are linearly smoothed at the edge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nx</code></td>
<td>
<p>size to which the data is extended in x-direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ny</code></td>
<td>
<p>size to which the data is extended in y-direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>largest scale considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundaries</code></td>
<td>
<p>how to handle the boundary conditions, either "pad", "mirror" or "periodic"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_specs</code></td>
<td>
<p>if <code>TRUE</code>, the spatial mean spectra are returned as well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, currently ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class sadverif</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>each element of x is transformed via <code>dtcwt</code> from the 'dualtrees' package. Scores and centres based on the mean spectra are calculated. If <code>dec=FALSE</code>, scale histograms and the corresponding score <code>hemd</code> are calcualted as well.
</p>


<h3>Value</h3>

<p>an object of class <code>sadverif</code>, containing the following elements
</p>

<dl>
<dt>settings</dt>
<dd>
<p> a dataframe containing the parameters that were originally passed to dtverif </p>
</dd>
<dt>centres</dt>
<dd>
<p> a matrix cotaining the anisotropy <code>rho</code>, angle <code>phi</code> and central scale <code>z</code> derived from the mean spectra. Rain area and sum are included as well.</p>
</dd>
<dt>detscores</dt>
<dd>
<p> a matrix containing the differences in centre components, the direction/anisotropy score <code>dxy</code>, the emd between direction-averaged spectra (<code>semd</code>) and the emd between the directional spectra (<code>semdd</code>). If <code>dec=FALSE</code>, the emd between the scale histograms, hemd, is included as well. </p>
</dd>
<dt>time</dt>
<dd>
<p> the time the calculation took in seconds </p>
</dd>
</dl>
<p>if there is more than one forecast, the ensemble scores SpEn and (if available), hemd are computed as well, treating all forecasts as members of the ensemble to be verified.
</p>


<h3>References</h3>

<p>Selesnick, I.W., R.G. Baraniuk, and N.C. Kingsbury (2005) &lt;doi:10.1109/MSP.2005.1550194&gt;
Buschow et al. (2019) &lt;doi:10.5194/gmd-12-3401-2019&gt;
Buschow and Friederichs (2020) &lt;doi:10.5194/ascmo-6-13-2020&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">oldpar &lt;- par(no.readonly=TRUE)
on.exit(par(oldpar))
data(rrain)
ra &lt;- as.sadforecast( list( rrain[1,1,,], rrain[1,2,,], rrain[2,1,,], rrain[3,1,,] ) )
plot(ra)
verif &lt;- sadverif( ra, log=FALSE, xmin=0 )
summary(verif)
par( mfrow=c(2,2) )
plot( verif )
</code></pre>


</div>