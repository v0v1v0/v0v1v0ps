<div class="container">

<table style="width: 100%;"><tr>
<td>sanon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-Parametric Covariable Adjustment for Stratified Rank Measures of Association</h2>

<h3>Description</h3>

<p>This is a function for computing a stratified multivariate Mann-Whitney estimator that addresses the comparison between two randomized groups for a strictly ordinal response variable.
Response variables may have some missing completely at random (MCAR) values for some patients. 
Non-parametric covariable adjustment is considered through the difference estimates between mean covariable and the weighted least squares method.
Although such estimators can be computed directly as weighted linear combinations of within-stratum Mann-Whitney estimators, consistent estimation of their covariance matrix is done using methods for multivariate U-statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sanon(outcome, ...)

## S3 method for class 'formula'
sanon(formula, data = list(), ...)

## Default S3 method:
sanon(
  outcome,
  group,
  strt = NULL,
  covar = NULL,
  catecovar = NULL,
  ref = NULL,
  covref = NULL,
  P = NULL,
  res.na.action = "default",
  ...
)

## S3 method for class 'sanon'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>vector of observations of length n, or a matrix with n rows for the response (or outcome) variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator, and the terms on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>numeric vector of observations of length n for treatment group. The reference group can be specified in <code>ref</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strt</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for covariable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catecovar</code></td>
<td>
<p>numeric or factor vector of observations of length n, or a matrix with n rows for categorical covariable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>character for the reference group for treatment group in <code>group</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covref</code></td>
<td>
<p>character vector for the reference group for categorical covariables in <code>catecovar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a matrix for weighted least squares estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.na.action</code></td>
<td>
<p>character for setting NA actions. "default", "LOCF1", "LOCF2", "replace", and "remove" are available. default is "default". see the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class "<code>sanon</code>", usually, a result of a call to <code>sanon</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sanon</code> has two specifications for the input, variable and formula based.
In the variable based input, one can specify R objects to outcome, group, and strata variables, and covariable.
In the formula based input, the formula consists of variable names in a data.frame. 
The strata and group variables, and covariable are recognized by functions <code>strt</code>, <code>grp</code>, <code>covar</code>, and <code>catecovar</code>.
<code>outcome</code> can be contained missing values, which should be coded by <code>NA</code>. 
Five options for the management of missing values can be specifed in the argument <code>res.na.action</code>; 
<code>"default"</code> = the method in Kawaguchi et al. (2011), <code>"LOCF1"</code> and <code>"LOCF2"</code> = last observation carried forward with respect to kernels of U-statistics and observed velues, repsectively, <code>"replace"</code> = missing values are managed as tied with all other values in the same stratum, and <code>"remove"</code> = the complete cases analaysis.
For <code>res.na.action = "LOCF1"</code> or <code>"LOCF2"</code>, the order in the outcome is considered as the time order in imputing.
if the baseline measurement is missing, then the corresponding subject is removed.
<code>outcome</code> can be also multiple (repeatly measured).
If more than two strata are specified, these are taking a cross-classification. 
The group variable can be specifies its reference group in the argument <code>ref</code> in the <code>sanon</code> or in the function <code>grp</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nna</code></td>
<td>
<p>tne number of subjects with missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nhik</code></td>
<td>
<p>Sample size in each strata, group, and response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nik</code></td>
<td>
<p>Sample size in each group and response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>(multivariate) Mann-Whitney estimate(s) that addresses the comparison between two randomized groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>the difference estimates between mean covariable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>a vector consisting of <code>xi</code> and <code>g</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vf</code></td>
<td>
<p>estimated covariance matrix of <code>f</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>fully adjustmented estimators for all covariables and the strata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vb</code></td>
<td>
<p>covariance matrix of <code>b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>standard error of <code>b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>test statistics for <code>b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>p-value for <code>b</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outnames</code></td>
<td>
<p>outcome or response names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covarnames</code></td>
<td>
<p>covariable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>advarnames</code></td>
<td>
<p>variable names adjusting in the weighted least squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bnames</code></td>
<td>
<p>variable names of adjusted in the weighted least squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reslevels</code></td>
<td>
<p>levels for response variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouplevels</code></td>
<td>
<p>levels for the group variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strtout</code></td>
<td>
<p>resulting (cross-classification) strata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strtlevels</code></td>
<td>
<p>resulting (cross-classification) strata levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strtnames</code></td>
<td>
<p>resulting (cross-classification) strata names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matP</code></td>
<td>
<p>design matrix used in the weighted least squares</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kawaguchi A., Koch, G. G. (2015). sanon: An R Package for Stratified Analysis with Nonparametric Covariable Adjustment. Journal of Statistical Software, 67(9), 1-37. doi:10.18637/jss.v067.i09
</p>
<p>Kawaguchi, A., Koch, G. G., Wang, X. (2011): Stratified Multivariate Mann-Whitney Estimators for the Comparison of Two Treatments with Randomization Based Covariance Adjustment. Statistics in Biopharmaceutical Research, Vol. 3, No. 2, 217-231.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##### Example 3.1 Randomized Clinical Trial of Chronic Pain #####
data(cpain)
out11 = sanon(response ~ grp(treat, ref="placebo") + strt(center) + strt(diagnosis), data=cpain)
out11
summary(out11)

# R objects are also available
attach(cpain)
out12 = sanon(outcome=response, group=treat, 
strt=cbind(center, diagnosis), ref="placebo")
out12
summary(out12)

##### Example 3.2 Randomized Clinical Trial of Respiratory Disorder #####
data(resp)
out21 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) 
~ grp(treatment, ref="P") + strt(center) + strt(sex) + covar(age), data=resp)
out21
summary(out21)

# the matrix P can be specified
P = rbind(rep(0, 4), diag(4), rep(0, 4))
out22 = sanon(cbind(baseline, visit1, visit2, visit3, visit4) 
~ grp(treatment, ref="P") + strt(center) + strt(sex) + covar(age), data=resp, P=P)
out22
summary(out22)

</code></pre>


</div>