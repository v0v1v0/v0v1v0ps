<div class="container">

<table style="width: 100%;"><tr>
<td>GenerateRV.CopApprox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates random variates from a copula approximation</h2>

<h3>Description</h3>

<p>Method to sample random variates from an object of <code>class</code> ‘CopApprox’.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CopApprox'
GenerateRV(obj, n, MH = FALSE, trace = FALSE,
  PDF = NULL, burnin = 500, thinning = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>object from which to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of items to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MH</code></td>
<td>
<p>logical, should a Metropolis-Hastings algorithm be used to refine the sample?  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical, indicating whether the function should be verbose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PDF</code></td>
<td>
<p>probability density function corresponding to copula used to create <code>obj</code>, only used if <code>MH</code> is <code>TRUE</code>; see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>the number of burn-in iterations of the MH sampler, only used if <code>MH</code> is <code>TRUE</code>, defaults to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>the thining parameter, only used if <code>MH</code> is <code>TRUE</code>, defaults to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If argument <code>MH</code> is <code>FALSE</code>, the default, random variates are directly sampled from the approximation, as described in Tajvidi and Turlach (2017).
</p>
<p>If <code>MH</code> is <code>TRUE</code>, <code>GenerateRV</code> uses additionally a Metropolis-Hastings refinement.  It first samples from the approximation, but uses those samples then as proposals in a Metropolis-Hastings algorithm.  The latter needs the probability density function of the copula.  This density function has either to be passed to the argument <code>PDF</code>, or the copula (stored in argument <code>obj</code>) belonging to the approximation must have the density function (with name ‘<code>pdfCopula</code>’) stored in its environment. In the latter case, the argument <code>PDF</code> can be <code>NULL</code> (its default).
</p>


<h3>Value</h3>

<p>A matrix of dimension <code>n</code> times <code>dim</code>, where <code>dim</code> is the dimension for which the copula approximation was determined.
</p>
<p>If <code>MH</code> was <code>TRUE</code> the return value has an attribute called ‘<code>AcceptanceRate</code>’, indicating the fraction of samples that were accepted in the Metropolis-Hastings step.  This fraction is based on all <code>burnin + (n-1)*thinning + 1</code> samples that are  initially generated from the approximation.
</p>


<h3>References</h3>

<p>Tajvidi, N. and Turlach, B.A. (2017). A general approach to generate random variates for multivariate copulae, <em>Australian &amp; New Zealand Journal of Statistics</em>. Doi:10.1111/anzs.12209.
</p>


<h3>See Also</h3>

<p><code>GetApprox</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">cop &lt;- NewBEVAsyMixedModelCopula(theta=1, phi=-0.25)
approx1 &lt;- GetApprox(cop)
approx2 &lt;- GetApprox(cop, type = 1)
sample1 &lt;- GenerateRV(approx1, 100)
plot(sample1)
sample2 &lt;- GenerateRV(approx2, 100)
plot(sample2)
sample1 &lt;- GenerateRV(approx1, 50, MH = TRUE, trace = TRUE)
plot(sample1)
sample2 &lt;- GenerateRV(approx2, 50, MH = TRUE)
plot(sample2)

</code></pre>


</div>