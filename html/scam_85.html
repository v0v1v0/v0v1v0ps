<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.po.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructor for SCOP-splines with positivity constraint
</h2>

<h3>Description</h3>

<p>This is a special method function
for creating univariate smooths subject to a positivity constraint which is built by 
the <code>mgcv</code> constructor function for smooth terms, <code>smooth.construct</code>. 
It is constructed using monotonic P-splines. This smooth is specified via model terms suach as 
<code>s(x,k,bs="po",m=2)</code>, 
where <code>k</code> denotes the basis dimension and <code>m+1</code> is the order of the B-spline basis.
</p>
<p>Note: Models that include this smooth should not have an intercept. See examples below. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'po.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A smooth specification object, generated by an <code>s</code> term in a GAM formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or list containing the data required by this term,
with names given by <code>object$term</code>. The <code>by</code> variable is the last element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing the knots supplied for basis setup.  
If it is <code>NULL</code> then the knot locations are generated automatically.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p> An object of class <code>"po.smooth"</code>. 
</p>


<h3>Author(s)</h3>

 
<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>


<h3>See Also</h3>

<p><code>smooth.construct.mpd.smooth.spec</code>,
<code>smooth.construct.cv.smooth.spec</code>,
</p>
<p><code>smooth.construct.cx.smooth.spec</code>,
<code>smooth.construct.mdcv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.mdcx.smooth.spec</code>, <code>smooth.construct.micv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.micx.smooth.spec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
##  SCOP-splines example with positivity constraint... 
  ## simulating data...
## Not run: 
   require(scam)
   set.seed(3)
   n &lt;- 100
   x &lt;- seq(-3,3,length.out=100)
   f &lt;- dnorm(x) 
   y &lt;- f + rnorm(n)*0.1  
   b &lt;- scam(y~s(x,bs="po")-1)
  
   b1 &lt;- scam(y~s(x)) ## unconstrained model
   plot(x,y)
   lines(x,f)
   lines(x,fitted(b),col=2)
   lines(x,fitted(b1),col=3)

  ## two-term example...
  set.seed(3)
  n &lt;- 200
  x1 &lt;- seq(-3,3,length.out=n)
  f1 &lt;- 3*exp(-x1^2) ## positively constrained smooth
  x2 &lt;- runif(n)*3-1;
  f2 &lt;- exp(4*x2)/(1+exp(4*x2)) ## increasing smooth 
  f &lt;- f1+f2
  y &lt;- f+rnorm(n)*0.3
  dat &lt;- data.frame(x1=x1,x2=x2,y=y)
  ## fit model, results, and plot...
  b2 &lt;- scam(y~s(x1,bs="po")+s(x2,bs="mpi")-1,data=dat)
  summary(b2)
  plot(b2,pages=1)

  b3 &lt;- scam(y~s(x1,bs="ps")+s(x2,bs="ps"),data=dat) ## unconstrained model
  summary(b3)
  plot(b3,pages=1) 
 
## End(Not run) 
</code></pre>


</div>