<div class="container">

<table style="width: 100%;"><tr>
<td>cspgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate periodogram</h2>

<h3>Description</h3>

<p>Calculate periodogram for a time-course using Lomb-Scargle, fast Fourier
transform, or selected version of chi-square. The <code>spectr</code> function is a
wrapper for the various methods. <code>lspgram</code> is in turn a wrapper for
<code>lomb::lsp()</code>, and <code>fftpgram</code> a wrapper for <code>stats::spec.pgram()</code>. Among the
versions of chi-square, it is highly recommended to use greedy, which has
lower bias than standard and lower variance than conservative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cspgram(
  x,
  deltat,
  periodRange = c(18, 32),
  method = c("greedy", "conservative", "standard"),
  na.action = stats::na.fail,
  dopar = FALSE
)

fftpgram(
  x,
  deltat,
  periodRange = c(18, 32),
  pad = 50,
  na.action = stats::na.fail,
  ...
)

lspgram(x, deltat, time, periodRange = c(18, 32), ofac = 50)

spectr(
  x,
  deltat,
  time,
  periodRange = c(18, 32),
  method = c("greedy_chisq", "conservative_chisq", "standard_chisq", "lombscargle",
    "fft"),
  ofac = 50,
  pad = 50,
  na.action = stats::na.fail,
  dopar = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector of measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltat</code></td>
<td>
<p>Numeric value of the interval between time-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodRange</code></td>
<td>
<p>Numeric vector of the minimum and maximum values of the
period to consider, in the same units as <code>deltat</code> or <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character indicating which method to use. Can be an unambiguous
substring of the full name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Function specifying how to handle <code>NA</code> values in <code>x</code>.
Default is <code>stats::na.fail()</code>, which gives an error if any values are
missing. Ignored for Lomb-Scargle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dopar</code></td>
<td>
<p>Logical indicating whether to run calculations in parallel if
a parallel backend is already set up, e.g., using
<code>doParallel::registerDoParallel()</code>. Only used for chi-square.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>Numeric value of the proportion of the length of <code>x</code> by which to
pad <code>x</code> with zeros. Must be &gt; 0. Only used for FFT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>stats::spec.pgram()</code> for FFT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Numeric vector of time-points. Can be specified instead of
<code>deltat</code> for Lomb-Scargle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofac</code></td>
<td>
<p>Integer value of the oversampling factor. Must be &gt;= 1. Only used
for Lomb-Scargle.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.table</code> with various columns depending on the method. For any
version of chi-square, columns will be <code>period</code>, <code>chisq</code>, <code>df</code>, and
<code>log_pval</code>. The log p-value is more reliable than the p-value, since R has
finite precision, so p-values less than about 5e-324 would be set to 0. For
Lomb-Scargle and FFT, columns will be <code>period</code> and <code>power</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library('data.table')

set.seed(1789)
deltat = 0.1
tau = 25
tt = seq(0, 24 * 3, deltat)
x = 3 * sin(tt / tau * 2 * pi) + rnorm(length(tt))

specCsp = spectr(x, deltat, method = 'greedy')
peakCsp = specCsp[which.min(log_pval)]

specLsp = spectr(x, deltat, method = 'lomb')
peakLsp = specLsp[which.max(power)]

specFft = spectr(x, deltat, method = 'fft')
peakFft = specFft[which.max(power)]

</code></pre>


</div>