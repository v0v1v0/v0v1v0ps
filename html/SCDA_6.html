<div class="container">

<table style="width: 100%;"><tr>
<td>SCSR_InfoCrit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatically select the optimal number of clusters based on likelihood information criteria (i.e., AIC, BIC and HQC) for a given SCSR model.</h2>

<h3>Description</h3>

<p>Computes the likelihood-based information criteria (i.e, Akaike's IC, Bayesian IC, and Hannanâ€“Quinn IC) for every SCSR model given by the combination of the G and Phi contained in the <code>G.set</code> and <code>Phi.set</code> inputs and provides the associated likelihood-based information criteria.
Given the minimization rule, <code>SCSR_InfoCrit</code> automatically identifies the optimal number of clusters for every criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SCSR_InfoCrit(
  Formula,
  Data_sf,
  listW,
  Phi.set = c(0.5, 1),
  G.set = c(2, 3, 4),
  Type = c("SCLM", "SCSAR", "SCSEM", "SCSLX"),
  CenterVars = TRUE,
  ScaleVars = TRUE,
  Maxitr = 200,
  RelTol = 10^-6,
  AbsTol = 10^-5,
  Verbose = TRUE,
  Seed = 123456789
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Formula</code></td>
<td>
<p>a symbolic description of the regression model to be fit. The details of model specification are given for <code>lm(...)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data_sf</code></td>
<td>
<p>A <code>data.frame</code> object of class <code>sf</code> with n rows (each one corresponding to a location/polygon) and a user-defined number of columns.
The data frame must contain the response variable and all the covariates to be used in the model. Also, it must include the <code>geometry</code> feature for spatial modelling and representation.
Typically, <code>sf</code> <code>data.frame</code> are built using the <code>st_as_sf(...)</code> command from the <code>sf</code> package (see its documentation for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listW</code></td>
<td>
<p><code>listw</code> object. It contains the spatial weights for the spatial autoregressive component.
Typically, listW is built using the <code>nb2listw(...)</code> command from the <code>spdep</code> package (see its documentation for details).
We suggest to adopt one of matrix styles suggested in the <code>spdep</code> package, such as <code>W</code> (row-standardized) or <code>B</code> (binary).
We also suggest to adopt a <code>zero.policy = TRUE</code> option to allow the computation of groups/clusters with isolated units. In this regard, we recall that if <code>zero.policy = FALSE</code> and <code>Type = "SCSAR"</code> causes <code>SCSR_Estim(...)</code> to terminate with an error.
See package <code>spatialreg</code> for details on the <code>zero.policy</code> input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi.set</code></td>
<td>
<p>Non-negative (&gt;=0) real-valued vector. Sequence of spatial penalty parameter. Default is <code>Phi = c(0.50,1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G.set</code></td>
<td>
<p>Integer vector. Sequence of clusters to be considered. Default is <code>G = c(2,3,4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>
<p>Character. Declares which model specification has to be estimated. Admitted strings are:
</p>

<ul>
<li>
<p><code>"SCLM"</code> for linear regression model without spatial effects (LM);
</p>
</li>
<li>
<p><code>"SCSAR"</code> for spatial autoregressive (SAR) model;
</p>
</li>
<li>
<p><code>"SCSEM"</code> for linear regression model with spatial autoregressive error term or spatial Durbin model (SEM);
</p>
</li>
<li>
<p><code>"SCSLX"</code> for linear regression model with spatially-lagged response variable and covariates (SLX);
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CenterVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be centered around the mean in the iterative algorithm to update memberships and group-wise parameters.
Centering is only use in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-centered) variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ScaleVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be scaled with respect to their standard deviation in the iterative algorithm to update memberships and group-wise parameters.
Scaling is only used in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-scaled) variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maxitr</code></td>
<td>
<p>Integer value. Maximum number of iterations for the iterative algorithm. Convergence criterion is fixed to  <code class="reqn">\varepsilon</code> = 10^(-5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RelTol</code></td>
<td>
<p>Tolerance for the relative improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Rel}</code> = 10^-6</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AbsTol</code></td>
<td>
<p>Tolerance for the absolute improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Abs}</code> = 10^-5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Verbose</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>). Toggle warnings and messages. If <code>verbose = TRUE</code> (default) the function
prints on the screen some messages describing the progress of the tasks. If <code>verbose = FALSE</code> any message about the progression is suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>Integer value. Define the random number generator (RNG) state for random number generation in R.
Deafult is <code>seed = 123456789</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the vectors G.set = c(2,3,4) and Phi.set = c(0.50,1), the function 'SCSR_InfoCrit' will compute 3x2=6 models, each at a given combination of G and Phi.
For computional details on the spatially-clustered models, we kindly refer to
Cerqueti, R., Maranzano, P. &amp; Mattera, R. "Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe". arXiv preprints (&lt;doi:10.48550/arXiv.2407.15874&gt;)
</p>


<h3>Value</h3>

<p>A list object containing the following outputs:
</p>

<ul>
<li>
<p>IC: a <code>data.frame</code> object containing one row for each combination of the supplied vectors G.set and Phi.set and 5 columns (G,Phi,AIC,BIC,HQC).
</p>
</li>
<li>
<p>OptimPars: a <code>data.frame</code> object with 3 rows (criteria) and 2 columns (Parameters) with the optimal combination of G and Phi for every criterion.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR_IC &lt;- SCSR_InfoCrit(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                          Data_sf = Data2020, listW=listW, Type="SCSAR",
                          Maxitr = 100, Phi.set = c(0.50,1), G.set=c(2,3))


</code></pre>


</div>