<div class="container">

<table style="width: 100%;"><tr>
<td>strata.bh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Stratification of a Population Given a Set of Boundaries </h2>

<h3>Description</h3>

<p>The function <code>strata.bh</code> stratifies a population given a set of boundaries. It calculates the stratum sample sizes and the anticipated coefficient of variation or relative root mean squared error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">strata.bh(x, bh, n = NULL, CV = NULL, Ls = 3, certain = NULL,
          alloc = list(q1 = 0.5, q2 = 0, q3 = 0.5), takenone = 0, 
          bias.penalty = 1, takeall = 0, takeall.adjust = TRUE, 
          rh = rep(1, Ls), model = c("none", "loglinear", "linear",
          "random"), model.control = list())      
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A vector containing the values of the stratification variable <code class="reqn">X</code> for every unit in the population. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bh</code></td>
<td>
<p> A vector of the <code class="reqn">L-1</code> stratum boundaries <code class="reqn">(b_1, b_2, \ldots, b_{L-1})</code> where <code class="reqn">L</code> is the total number of strata (excluding the certainty stratum, if any). Therefore, if <code>takenone=0</code> then <code class="reqn">L</code>=<code>Ls</code>, and if <code>takenone=1</code> then <code class="reqn">L</code>=<code>Ls</code>+1. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> A numeric: the target sample size. It has no default value. The argument <code>n</code> or the argument <code>CV</code> must be input. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p> A numeric: the target coefficient of variation or relative root mean squared error if <code>takenone</code>=1. It has no default value. The argument <code>CV</code> or the argument <code>n</code> must be input. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ls</code></td>
<td>
<p> A numeric: the number of sampled strata (take-none and certain strata are not counted in <code>Ls</code>). The default is 3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>certain</code></td>
<td>
<p> A vector giving the position, in the vector <code>x</code>, of the units that must be included in the sample (see <code>stratification-package</code>). By default <code>certain</code> is <code>NULL</code>, which means that no units are a priori chosen to be in the sample. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p> A list specifying the allocation scheme. The list must contain 3 numerics for the 3 exponents <code>q1</code>, <code>q2</code> and <code>q3</code> in the general allocation scheme (see <code>stratification-package</code>). The default is Neyman allocation (<code>q1</code>=<code>q3</code>=0.5 and <code>q2</code>=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takenone</code></td>
<td>
<p> A numeric: the number of take-none strata (0 or 1). The default is 0, i.e. no take-none stratum is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias.penalty</code></td>
<td>
<p> A numeric between 0 and 1 giving the penalty for the bias in the anticipated mean squared error (MSE) of the survey estimator (see <code>stratification-package</code>). This argument is relevant only if <code>takenone</code>=1. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takeall</code></td>
<td>
<p> A numeric: the number of take-all strata (one of {0, 1, ..., <code>Ls</code>-1}). The default is 0, i.e. no take-all stratum is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takeall.adjust</code></td>
<td>
<p> A logical. If <code>TRUE</code> (the default), when <code class="reqn">n_h &gt; N_h</code> for a take-some stratum, the <code>takeall</code> argument is increased by one and the allocation is carried out again. This is done as long as <code class="reqn">n_h \leq N_h</code> for every take-some stratum. If <code>FALSE</code>, no adjustment is made. Note: in other functions of the package <span class="pkg">stratification</span>, this adjustment is not optional; it is made automatically (see <code>stratification-package</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rh</code></td>
<td>
<p> A vector giving the anticipated response rates in each of the <code>Ls</code> sampled strata. A single number can be given if the rates do not vary among strata. The default is 1 in each stratum. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> A character string identifying the model used to describe the discrepancy between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>. It can be <code>"none"</code> if one assumes <code class="reqn">Y=X</code>, <code>"loglinear"</code> for the loglinear model with mortality, <code>"linear"</code> for the heteroscedastic linear model or <code>"random"</code> for the random replacement model (see <code>stratification-package</code> for a description of these models). The default is <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.control</code></td>
<td>
<p> A list of model parameters (see <code>stratification-package</code>). The default values of the parameters correspond to the model <code class="reqn">Y=X</code>. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Nh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the population sizes <code class="reqn">N_h</code>, i.e. the number of units in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the sample sizes <code class="reqn">n_h</code>, i.e. the number of units to sample in each stratum. See <code>stratification-package</code> for information about the rounding used to get these integer values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n </code></td>
<td>
<p>The total sample size (<code>sum(nh)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nhnonint </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the non-integer values of the sample sizes, obtained directly from applying the allocation rule (see <code>stratification-package</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>certain.info </code></td>
<td>
<p>A vector giving statistics for the certainty stratum (see <code>stratification-package</code>). It contains <code>Nc</code>, the number of units chosen a priori to be in the sample, and <code>meanc</code>, the anticipated mean of <code class="reqn">Y</code> for these units. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opti.nh </code></td>
<td>
<p>The final value of the criteria to optimize (either the total sample size <code class="reqn">n</code> if a target <code>CV</code> was given or the RRMSE if a target <code>n</code> was given) calculated with the integer stratum sample sizes <code>nh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opti.nhnonint </code></td>
<td>
<p>The final value of the criteria to optimize (either the total sample size <code class="reqn">n</code> if a target <code>CV</code> was given or the RRMSE if a target <code>n</code> was given) calculated with the non-integer stratum sample sizes <code>nhnonint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated means of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated variances of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean </code></td>
<td>
<p>A numeric: the anticipated global mean value of <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSE </code></td>
<td>
<p>A numeric: the root mean squared error (or standard error if <code>takenone</code>=0) of the anticipated global mean of <code class="reqn">Y</code>. This is defined as the squared root of: (<code>bias.penalty</code> x bias of the mean)^2 + variance of the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RRMSE </code></td>
<td>
<p>A numeric: the anticipated relative root mean squared error (or coefficient of variation if <code>takenone</code>=0) for the mean of <code class="reqn">Y</code>, i.e. <code>RMSE</code> divided by <code>mean</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relativebias </code></td>
<td>
<p>A numeric: the anticipated relative bias of the estimator, i.e. (<code>bias.penalty</code> x bias of the mean) divided by <code>mean</code>. If <code>takenone</code>=0, this numeric is zero. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propbiasMSE </code></td>
<td>
<p>A numeric: the proportion of the MSE attributable to the bias of the estimator, i.e. (<code>bias.penalty</code> x bias of the mean)^2 divided by the MSE of the <code>mean</code>. If <code>takenone</code>=0, this numeric is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratumID</code></td>
<td>
<p>A factor, having the same length as the input <code>x</code>, which values are either 1, 2, ..., <code class="reqn">L</code> or <code>"certain"</code>. The value <code>"certain"</code> is given to units a priori chosen to be in the sample. This factor identifies, for each observation, the stratum to which it has been assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takeall </code></td>
<td>
<p>The number of take-all strata in the final solution. Note: It is possible that <code class="reqn">n_h=N_h</code> for non take-all strata because the condition for an automatic addition of a take-all stratum is <code class="reqn">n_h&gt;N_h</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The function call (object of class "call").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date </code></td>
<td>
<p>A character string that contains the system date and time when the function ended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args </code></td>
<td>
<p>A list of all the argument values input to the function or set by default. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Sophie Baillargeon <a href="mailto:Sophie.Baillargeon@mat.ulaval.ca">Sophie.Baillargeon@mat.ulaval.ca</a> and<br>
Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> </p>


<h3>References</h3>

<p>Baillargeon, S. and  Rivest L.-P. (2011). The construction of stratified designs in R with the package stratification. <em>Survey Methodology</em>, <b>37</b>(1), 53-65.
</p>


<h3>See Also</h3>

 <p><code>print.strata</code>, <code>plot.strata</code>, <code>strata.cumrootf</code>, <code>strata.geo</code>, <code>strata.LH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">adjust &lt;- strata.geo(x=USbanks, CV=0.01, Ls=4, alloc=c(0.35,0.35,0))
adjust
adjust$nhnonint
noadjust &lt;- strata.bh(x=USbanks, bh=adjust$bh, CV=0.01, Ls=4,
            alloc=c(0.35,0.35,0), takeall=0, takeall.adjust=FALSE)
noadjust
noadjust$nhnonint
# without the adjustment for a take-all stratum, n is smaller than
# with the adjustment, but the target CV is not reached.
</code></pre>


</div>