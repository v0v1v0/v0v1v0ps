<div class="container">

<table style="width: 100%;"><tr>
<td>simIntOcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Single-Species Detection-Nondetection Data from Multiple Data Sources</h2>

<h3>Description</h3>

<p>The function <code>simIntOcc</code> simulates single-species detection-nondetection data from multiple data sources for simulation studies, power assessments, or function testing of integrated occupancy models. Data can optionally be simulated with a spatial Gaussian Process on the occurrence process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simIntOcc(n.data, J.x, J.y, J.obs, n.rep, n.rep.max, beta, alpha,
          sp = FALSE, cov.model, sigma.sq, phi, nu, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.data</code></td>
<td>
<p>an integer indicating the number of detection-nondetection data sources to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.x</code></td>
<td>
<p>a single numeric value indicating the number of sites across the region of interest along the horizontal axis. Total number of sites across the simulated region of interest is <code class="reqn">J.x \times J.y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.y</code></td>
<td>
<p>a single numeric value indicating the number of sites across the region of interest along the vertical axis. Total number of sites across the simulated region of interest is <code class="reqn">J.x \times J.y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.obs</code></td>
<td>
<p>a numeric vector of length <code>n.data</code> containing the number of sites to simulate each data source at. Data sources can be obtained at completely different sites, the same sites, or anywhere inbetween. Maximum number of sites a given data source is available at is equal to <code class="reqn">J = J.x \times J.y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep</code></td>
<td>
<p>a list of length <code>n.data</code>. Each element is a numeric vector with length corresponding to the number of sites that given data source is observed at (in <code>J.obs</code>). Each vector indicates the number of repeat visits at each of the sites for a given data source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep.max</code></td>
<td>
<p>a vector of numeric values indicating the maximum number of replicate surveys for each data set. This is an optional argument, with its default value set to <code>max(n.rep)</code> for each data set. This can be used to generate data sets with different types of missingness (e.g., simulate data across 20 days (replicate surveys) but sites are only sampled a maximum of ten times each).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a numeric vector containing the intercept and regression coefficient parameters for the occurrence portion of the single-species occupancy model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a list of length <code>n.data</code>. Each element is a numeric vector containing the intercept and regression coefficient parameters for the detection portion of the single-species occupancy model for each data source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>a logical value indicating whether to simulate a spatially-explicit occupancy model with a Gaussian process. By default set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.model</code></td>
<td>
<p>a quoted keyword that specifies the covariance function used to model the spatial dependence structure among the latent occurrence values.  Supported covariance model key words are: <code>"exponential"</code>, <code>"matern"</code>, <code>"spherical"</code>, and <code>"gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq</code></td>
<td>
<p>a numeric value indicating the spatial variance parameter. Ignored when <code>sp = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>a numeric value indicating the spatial range parameter. Ignored when <code>sp = FALSE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a numeric value indicating the spatial smoothness parameter. Only used when <code>sp = TRUE</code> and <code>cov.model = "matern"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently no additional arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list comprised of: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X.obs</code></td>
<td>
<p>a numeric design matrix for the occurrence portion of the model. This matrix contains the intercept and regression coefficients for only the observed sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.pred</code></td>
<td>
<p>a numeric design matrix for the occurrence portion of the model at sites where there are no observed data sources.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.p</code></td>
<td>
<p>a list of design matrices for the detection portions of the integrated occupancy model. Each element in the list is a design matrix of detection covariates for each data source.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.obs</code></td>
<td>
<p>a numeric matrix of coordinates of each observed site. Required for spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.pred</code></td>
<td>
<p>a numeric matrix of coordinates of each site in the study region without any data sources. Only used for spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.obs</code></td>
<td>
<p>a distance matrix of observed sites. Only used for spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.pred</code></td>
<td>
<p>a distance matrix of sites in the study region without any observed data. Only used for spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.obs</code></td>
<td>
<p>a matrix of the spatial random effects at observed locations. Only used to simulate data when <code>sp = TRUE</code></p>
</td>
</tr>
</table>
<p>. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>w.pred</code></td>
<td>
<p>a matrix of the spatial random random effects at locations without any observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.obs</code></td>
<td>
<p>a matrix of the occurrence probabilities for each observed site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.pred</code></td>
<td>
<p>a matrix of the occurrence probabilities for sites without any observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.obs</code></td>
<td>
<p>a vector of the latent occurrence states at each observed site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.pred</code></td>
<td>
<p>a vector of the latent occurrence states at each site without any observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a list of detection probability matrices for each of the <code>n.data</code> data sources.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a list of matrices of the raw detection-nondetection data for each site and replicate combination.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeffrey W. Doser <a href="mailto:doserjef@msu.edu">doserjef@msu.edu</a>, <br>
Andrew O. Finley <a href="mailto:finleya@msu.edu">finleya@msu.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(400)

# Simulate Data -----------------------------------------------------------
J.x &lt;- 15
J.y &lt;- 15
J.all &lt;- J.x * J.y
# Number of data sources.
n.data &lt;- 4
# Sites for each data source. 
J.obs &lt;- sample(ceiling(0.2 * J.all):ceiling(0.5 * J.all), n.data, replace = TRUE)
# Replicates for each data source.
n.rep &lt;- list()
for (i in 1:n.data) {
  n.rep[[i]] &lt;- sample(1:4, size = J.obs[i], replace = TRUE)
}
# Occupancy covariates
beta &lt;- c(0.5, 1, -3)
p.occ &lt;- length(beta)
# Detection covariates
alpha &lt;- list()
for (i in 1:n.data) {
  alpha[[i]] &lt;- runif(sample(1:4, 1), -1, 1)
}
p.det.long &lt;- sapply(alpha, length)
p.det &lt;- sum(p.det.long)
sigma.sq &lt;- 2
phi &lt;- 3 / .5
sp &lt;- TRUE

# Simulate occupancy data. 
dat &lt;- simIntOcc(n.data = n.data, J.x = J.x, J.y = J.y, J.obs = J.obs, 
                 n.rep = n.rep, beta = beta, alpha = alpha, sp = TRUE, 
                 cov.model = 'gaussian', sigma.sq = sigma.sq, phi = phi)
</code></pre>


</div>