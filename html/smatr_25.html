<div class="container">

<table style="width: 100%;"><tr>
<td>shift.com</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for no mean shift along a common (standardised) major axis</h2>

<h3>Description</h3>

<p>Test if several groups of observations have no shift in location along major axis or standardised major axis lines with a common slope. This can now be done via <code>sma(y~x+groups, type="shift")</code>, see help on the <code>sma</code> function.</p>


<h3>Usage</h3>

<pre><code class="language-R">shift.com( y, x, groups, data = NULL, method = 'SMA', 
   intercept = TRUE, robust = FALSE, V=array( 0, c( 2,2,length(unique(groups)))), 
   group.names=sort(unique(groups)) )</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The Y-variable for all observations (as a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The X-variable for all observations (as a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Coding variable identifying which group each observation belongs to (as a factor or vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The line fitting method:
</p>

<dl>
<dt>'SMA' or 1</dt>
<dd>
<p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt>
<dd>
<p>major axis</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p> (logical) Whether or not the line includes an  intercept.
</p>

<dl>
<dt>FALSE</dt>
<dd>
<p> no intercept, so the line is forced through the origin </p>
</dd>
<dt>TRUE</dt>
<dd>
<p> an intercept is fitted (this is the default) </p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>The estimated variance matrices of measurement error, for each group. This is a 3-dimensional array with measurement error in Y in the first row and column, error in X in the second row and column, and groups running along the third dimension. Default is that there is no measurement error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.names</code></td>
<td>
<p> (optional: rarely required). A vector containing the labels for ‘groups’. (Only actually useful for reducing computation time in simulation work). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates a Wald statistic to test for no shift along several MA's or SMA's of common slope. This is done by testing for equal fitted axis means across groups.
</p>
<p>Note that this test is only valid if it is reasonable to assume that the axes for the different groups all have the same slope.
</p>
<p>The test assumes the following:
</p>

<ol>
<li>
<p> each group of observations was independently sampled
</p>
</li>
<li>
<p> the axes fitted to all groups have a common slope
</p>
</li>
<li>
<p> y and x are linearly related within each group
</p>
</li>
<li>
<p> fitted axis scores independently follow a normal distribution with equal variance at all points along the line, within each group
</p>
</li>
</ol>
<p>Note that we do not need to assume equal variance across groups, unlike in tests comparing several linear regression lines.
</p>
<p>The assumptions can be visually checked by plotting residuals against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using 
</p>
<p><code>plot.sma(sma.object,which="residual")</code>. 
</p>
<p>On a residual plot, if there is a distinct increasing or decreasing trend within any of the groups, this suggests that all groups do not share a common slope.
</p>
<p>A plot of residual scores against fitted axis scores can also be used as a visual test for no shift. If fitted axis scores systematically differ across groups then this is evidence of a shift along the common axis.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>
<p>The common slope (<code class="reqn">\hat{\beta}</code>) is estimated from a maximum of 100 iterations, convergence is reached when the change in <code class="reqn">\hat{\beta}</code> is <code class="reqn">&lt; 10^{-6}</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>The Wald statistic testing for no shift along the common axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The P-value of the test. This is calculated assuming that stat has a chi-square distribution with (g-1) df, if there are g groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.mean</code></td>
<td>
<p>The fitted axis means for each group</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259–291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

<p><code>sma</code>, <code>plot.sma</code>, <code>line.cis</code>, <code>elev.com</code>, <code>shift.com</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#load leaf longevity data
data(leaflife)

#Test for common SMA slope amongst species at low rainfall sites
#with different levels of soil nutrients
leaf.low.rain=leaflife[leaflife$rain=='low',]
with(leaf.low.rain, slope.com(log10(longev), log10(lma), soilp))

#Now test for no shift along the axes of common slope, for sites
#with different soil nutrient levels but low rainfall:
with(leaf.low.rain, shift.com(log10(longev), log10(lma), soilp))

#Now test for no shift along the axes of common slope, for sites
#with different soil nutrient levels but low rainfall:
with(leaf.low.rain,shift.com(log10(longev), log10(lma), soilp, method='MA'))

</code></pre>


</div>