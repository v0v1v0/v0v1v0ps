<div class="container">

<table style="width: 100%;"><tr>
<td>Drought Index</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of Standardized Precipitation Index, using the Genetic Algorithm Method (SPIGA) and Maximum Likelihood (SPIML)</h2>

<h3>Description</h3>

<p>Calculate the standardized precipitation index (SPI) for monitoring drought using the technique of Genetic Algorithm (SPIGA) and Maximum Likelihood (SPIML) of a series of monthly rainfall for different time scales.</p>


<h3>Usage</h3>

<pre><code class="language-R">SPIGA(Pmon, scale = 3, population = 500, maxIter = 50, plotGA = FALSE, plotCDF = FALSE)

SPIML(Pmon, scale =3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pmon</code></td>
<td>
<p>monthly precipitation series ordered according to time. It is a data frame with columns: year, month, station 1, station 2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>an integer value representing the time scale of analysis. The most common are 1, 3, 6, 9, 12, 48, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>an integer value that sets the number of population for the use of the technique of Genetic Algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>an integer value that sets the maximum number of iterations also called cycles within the concept of Genetic Algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotGA</code></td>
<td>
<p>optional, value Boolean default false. Shows the performance versus the number of cycles in the Genetic Algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotCDF</code></td>
<td>
<p>optional, value Boolean default false. Shows the cumulative distribution function of each station. The graphics are monthly.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>SPIGA</code> and <code>SPIML</code>, are functions to calculate the SPI using Artificial Intelligence techniques - Genetic Algorithms (GA) and numerical method - Maximum Likelihood (ML) and both provide quantitative results for monitoring DROUGHT. The GA optimize the parameters alpha and beta of the probability function Gamma given by McKee.
</p>
<p>The <code>population</code> parameter must be an integer and balanced value, large values can generate higher time run, ie, high computational effort and small values can influence the accuracy of the results. By <code>plotGA</code> option and its corresponding graph, you can see the number of cycles to obtain a proper balance of the accuracy of the results and the computational effort.
</p>


<h4>Input data</h4>

<p>similar to <code>Pm_Pisco</code>.
</p>

<table>
<tr>
<td style="text-align: left;">
Year     </td>
<td style="text-align: left;"> Mon	</td>
<td style="text-align: left;"> st_1	        </td>
<td style="text-align: left;"> st_2	        </td>
<td style="text-align: left;"> st_3	 </td>
<td style="text-align: left;"> st_4 </td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 1	    </td>
<td style="text-align: left;"> 120.25	        </td>
<td style="text-align: left;"> 125.25	        </td>
<td style="text-align: left;"> 90.55    </td>
<td style="text-align: left;"> 150.25</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 2	    </td>
<td style="text-align: left;"> 145.25	        </td>
<td style="text-align: left;"> 140.25	        </td>
<td style="text-align: left;"> 120.70    </td>
<td style="text-align: left;"> 145.50</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 3	    </td>
<td style="text-align: left;"> 120.80	        </td>
<td style="text-align: left;"> 150.28	        </td>
<td style="text-align: left;"> 90.50    </td>
<td style="text-align: left;"> 130.40</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 4	    </td>
<td style="text-align: left;"> 90.25	        </td>
<td style="text-align: left;"> 80.25	        </td>
<td style="text-align: left;"> 70.52    </td>
<td style="text-align: left;"> 120.40</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 5	    </td>
<td style="text-align: left;"> 50.25	        </td>
<td style="text-align: left;"> 58.25	        </td>
<td style="text-align: left;"> 60.50    </td>
<td style="text-align: left;"> 80.50</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 6	    </td>
<td style="text-align: left;"> 40.25	        </td>
<td style="text-align: left;"> 38.45	        </td>
<td style="text-align: left;"> 80.25    </td>
<td style="text-align: left;"> 50.40</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 7	    </td>
<td style="text-align: left;"> 20.25	        </td>
<td style="text-align: left;"> 30.69	        </td>
<td style="text-align: left;"> 50.40    </td>
<td style="text-align: left;"> 40.40</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 8	    </td>
<td style="text-align: left;"> 1.25	        </td>
<td style="text-align: left;"> 8.85	        </td>
<td style="text-align: left;"> 10.40    </td>
<td style="text-align: left;"> 25.80</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 9	    </td>
<td style="text-align: left;"> 25.25	        </td>
<td style="text-align: left;"> 14.25	        </td>
<td style="text-align: left;"> 5.80    </td>
<td style="text-align: left;"> 20.80</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 10	    </td>
<td style="text-align: left;"> 13.25	        </td>
<td style="text-align: left;"> 10.23	        </td>
<td style="text-align: left;"> 10.50    </td>
<td style="text-align: left;"> 30.45</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 11	    </td>
<td style="text-align: left;"> 50.25	        </td>
<td style="text-align: left;"> 40.25	        </td>
<td style="text-align: left;"> 30.50    </td>
<td style="text-align: left;"> 80.50</td>
</tr>
<tr>
<td style="text-align: left;">
1981    </td>
<td style="text-align: left;"> 12	    </td>
<td style="text-align: left;"> 80.25	        </td>
<td style="text-align: left;"> 90.52	        </td>
<td style="text-align: left;"> 80.70    </td>
<td style="text-align: left;"> 90.40</td>
</tr>
<tr>
<td style="text-align: left;">
1982    </td>
<td style="text-align: left;"> 1	    </td>
<td style="text-align: left;"> 145.80	        </td>
<td style="text-align: left;"> 110.25	        </td>
<td style="text-align: left;"> 105.40    </td>
<td style="text-align: left;"> 120.25</td>
</tr>
<tr>
<td style="text-align: left;">
    .    </td>
<td style="text-align: left;"> .	    </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .      </td>
<td style="text-align: left;"> .</td>
</tr>
<tr>
<td style="text-align: left;">
    .    </td>
<td style="text-align: left;"> .	    </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .      </td>
<td style="text-align: left;"> .</td>
</tr>
<tr>
<td style="text-align: left;">
    .    </td>
<td style="text-align: left;"> .	    </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .	            </td>
<td style="text-align: left;"> .      </td>
<td style="text-align: left;"> .</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>Functions <code>SPIGA</code> and <code>SPIML</code> return values saved in .txt formats (Tabular) and .pdf (graphics). They are located in the working folder of <code>R</code> [getwd()].
</p>


<h3>Note</h3>

<p>Dependencies: the SPIGA function, depend on the library <code>GA</code>.</p>


<h3>Author(s)</h3>

<p>Iván Arturo Ayala Bizarro &lt;ivan.ayala@unh.edu.pe&gt;
</p>
<p>Jessica Zúñiga Mendoza &lt;zumeje@gmail.com&gt;
</p>


<h3>References</h3>

<p>McKee, Thomas B. and Doesken, Nolan J. and Kleist, John. 1993. The relationship of Drought Frequency and Duration to Time Scales. <em>Eighth Conference on Applied Climatology</em>
</p>
<p>A. Belauneh and J. Adamowski. Standard Precipitation Index Drought Forecasting Using Neural Networks, Wavelet Neural Networks, and Support Vector Regression. <em>Applied Computational Intelligence and Soft Computing</em>, http://dx.doi.org/10.1155/2012/794061

</p>


<h3>See Also</h3>

<p><code>SPIFromParameters</code> to calculate the standardized precipitation index, from alpha and beta parameter of the Gamma function.</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Load data
data(Pm_Pisco)
Pmon&lt;-Pm_Pisco      # dataframe Precipitation
summary(Pm_Pisco)   # view summary
Pmon&lt;-Pm_Pisco[,]

#### Computing SPI with Genetic Algorithms
pob     &lt;-50        # Define population number
iMax    &lt;-10        # Define Max iteration

# Total stations calculation. It may take some time.
#SPIGA(Pmon, scale=3, population=pob, maxIter = iMax, plotGA=TRUE, plotCDF=TRUE)

# station 1 computing
Pmon1&lt;-data.frame(Pmon[,1:2], Pmon$Pm_St1)
SPIGA(Pmon1, scale=3, population=pob, maxIter = iMax)

# station 2 computing
Pmon2&lt;-data.frame(Pmon[,1:2], Pmon$Pm_St2)
SPIGA(Pmon2, scale=3, population=pob, maxIter = iMax)

#### Computing SPI with Maximun Likelihood
SPIML(Pmon, scale=3)
</code></pre>


</div>