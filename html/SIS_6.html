<div class="container">

<table style="width: 100%;"><tr>
<td>SIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Iterative) Sure Independence Screening ((I)SIS) and Fitting in Generalized
Linear Models and Cox's Proportional Hazards Models</h2>

<h3>Description</h3>

<p>This function first implements the Iterative Sure Independence Screening for
different variants of (I)SIS, and then fits the final regression model using
the R packages <span class="pkg">ncvreg</span> and <span class="pkg">glmnet</span> for the SCAD/MCP/LASSO
regularized loglikelihood for the variables picked by (I)SIS.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SIS(
  x,
  y,
  family = c("gaussian", "binomial", "poisson", "cox"),
  penalty = c("SCAD", "MCP", "lasso"),
  concavity.parameter = switch(penalty, SCAD = 3.7, 3),
  tune = c("bic", "ebic", "aic", "cv"),
  nfolds = 10,
  type.measure = c("deviance", "class", "auc", "mse", "mae"),
  gamma.ebic = 1,
  nsis = NULL,
  iter = TRUE,
  iter.max = ifelse(greedy == FALSE, 10, floor(nrow(x)/log(nrow(x)))),
  varISIS = c("vanilla", "aggr", "cons"),
  perm = FALSE,
  q = 1,
  greedy = FALSE,
  greedy.size = 1,
  seed = NULL,
  standardize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The design matrix, of dimensions n * p, without an intercept. Each
row is an observation vector.  <code>SIS</code> standardizes the data and includes
an intercept by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector of dimension n * 1. Quantitative for
<code>family='gaussian'</code>, non-negative counts for <code>family='poisson'</code>,
binary (0-1) for <code>family='binomial'</code>. For <code>family='cox'</code>, <code>y</code>
should be an object of class <code>Surv</code>, as provided by the function
<code>Surv()</code> in the package <span class="pkg">survival</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type (see above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>The penalty to be applied in the regularized likelihood
subproblems. 'SCAD' (the default), 'MCP', or 'lasso' are provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concavity.parameter</code></td>
<td>
<p>The tuning parameter used to adjust the concavity
of the SCAD/MCP penalty. Default is 3.7 for SCAD and 3 for MCP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>Method for tuning the regularization parameter of the penalized
likelihood subproblems and of the final model selected by (I)SIS. Options
include <code>tune='bic'</code>, <code>tune='ebic'</code>, <code>tune='aic'</code>, and
<code>tune='cv'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of folds used in cross-validation. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.measure</code></td>
<td>
<p>Loss to use for cross-validation. Currently five
options, not all available for all models. The default is
<code>type.measure='deviance'</code>, which uses squared-error for gaussian models
(also equivalent to <code>type.measure='mse'</code> in this case), deviance for
logistic and poisson regression, and partial-likelihood for the Cox model.
Both <code>type.measure='class'</code> and <code>type.measure='auc'</code> apply only to
logistic regression and give misclassification error and area under the ROC
curve, respectively. <code>type.measure='mse'</code> or <code>type.measure='mae'</code>
(mean absolute error) can be used by all models except the <code>'cox'</code>;
they measure the deviation from the fitted mean to the response. For
<code>penalty='SCAD'</code> and <code>penalty='MCP'</code>, only
<code>type.measure='deviance'</code> is available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.ebic</code></td>
<td>
<p>Specifies the parameter in the Extended BIC criterion
penalizing the size of the corresponding model space. The default is
<code>gamma.ebic=1</code>. See references at the end for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsis</code></td>
<td>
<p>Number of pedictors recuited by (I)SIS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Specifies whether to perform iterative SIS. The default is
<code>iter=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>Maximum number of iterations for (I)SIS and its variants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varISIS</code></td>
<td>
<p>Specifies whether to perform any of the two ISIS variants
based on randomly splitting the sample into two groups. The variant
<code>varISIS='aggr'</code> is an aggressive variable screening procedure, while
<code>varISIS='cons'</code> is a more conservative approach. The default is
<code>varISIS='vanilla'</code>, which performs the traditional vanilla version of
ISIS. See references at the end for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>Specifies whether to impose a data-driven threshold in the size
of the active sets calculated during the ISIS procedures. The threshold is
calculated by first decoupling the predictors <code class="reqn">x_i</code> and response
<code class="reqn">y_i</code> through a random permutation <code class="reqn">\pi</code> of <code class="reqn">(1,...,n)</code> to form
a null model.  For this newly permuted data, marginal regression
coefficients for each predictor are recalculated.  As the marginal
regression coeffcients of the original data should be larger than most
recalculated coefficients in the null model, the data-driven threshold is
given by the <code class="reqn">q</code>th quantile of the null coefficients. This data-driven
threshold only allows a <code class="reqn">1-q</code> proportion of inactive variables to enter
the model when <code class="reqn">x_i</code> and <code class="reqn">y_i</code> are not related (in the null model).
The default is here is <code>perm=FALSE</code>. See references at the end for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Quantile for calculating the data-driven threshold in the
permutation-based ISIS. The default is <code>q=1</code> (i.e., the maximum
absolute value of the permuted estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>greedy</code></td>
<td>
<p>Specifies whether to run the greedy modification of the
permutation-based ISIS. The default is <code>greedy=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>greedy.size</code></td>
<td>
<p>Maximum size of the active sets in the greedy
modification of the permutation-based ISIS. The default is
<code>greedy.size=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed used for sample splitting, random permutation, and
cross-validation sampling of training and test sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Logical flag for x variable standardization, prior to
performing (iterative) variable screening.  The resulting coefficients are
always returned on the original scale. Default is <code>standardize=TRUE</code>.
If variables are in the same units already, you might not wish to
standardize.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object with </p>
<table>
<tr style="vertical-align: top;">
<td><code>sis.ix0</code></td>
<td>
<p>The vector of indices selected by
only SIS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ix</code></td>
<td>
<p> The vector of indices selected by
(I)SIS with regularization step.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.est</code></td>
<td>
<p> The vector of coefficients of the final model
selected by (I)SIS.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p> A fitted object of type <code>ncvreg</code>,
<code>cv.ncvreg</code>, <code>glmnet</code>, or <code>cv.glmnet</code> for the final model
selected by the (I)SIS procedure. If <code>tune='cv'</code>, the returned fitted
object is of type <code>cv.ncvreg</code> if <code>penalty='SCAD'</code> or
<code>penalty='MCP'</code>; otherwise, the returned fitted object is of type
<code>cv.glmnet</code>. For the remaining options of <code>tune</code>, the returned
object is of type <code>glmnet</code> if <code>penalty='lasso'</code>, and <code>ncvreg</code>
otherwise.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.index</code></td>
<td>
<p> The index along the solution path of
<code>fit</code> for which the criterion specified in <code>tune</code> is minimized.  </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jianqing Fan, Yang Feng, Diego Franco Saldana, Richard Samworth, and
Yichao Wu
</p>


<h3>References</h3>

<p>Diego Franco Saldana and Yang Feng (2018) SIS: An R package for Sure Independence Screening in
Ultrahigh Dimensional Statistical Models, <em>Journal of Statistical Software</em>, <b>83</b>, 2, 1-25.
</p>
<p>Jianqing Fan and Jinchi Lv (2008) Sure Independence Screening
for Ultrahigh Dimensional Feature Space (with discussion). <em>Journal of
Royal Statistical Society B</em>, <b>70</b>, 849-911.
</p>
<p>Jianqing Fan and Rui Song (2010) Sure Independence Screening in Generalized
Linear Models with NP-Dimensionality.  <em>The Annals of Statistics</em>,
<b>38</b>, 3567-3604.
</p>
<p>Jianqing Fan, Richard Samworth, and Yichao Wu (2009) Ultrahigh Dimensional
Feature Selection: Beyond the Linear Model. <em>Journal of Machine
Learning Research</em>, <b>10</b>, 2013-2038.
</p>
<p>Jianqing Fan, Yang Feng, and Yichao Wu (2010) High-dimensional Variable
Selection for Cox Proportional Hazards Model. <em>IMS Collections</em>,
<b>6</b>, 70-86.
</p>
<p>Jianqing Fan, Yang Feng, and Rui Song (2011) Nonparametric Independence
Screening in Sparse Ultrahigh Dimensional Additive Models. <em>Journal of
the American Statistical Association</em>, <b>106</b>, 544-557.
</p>
<p>Jiahua Chen and Zehua Chen (2008) Extended Bayesian Information Criteria for
Model Selection with Large Model Spaces. <em>Biometrika</em>, <b>95</b>,
759-771.
</p>


<h3>See Also</h3>

<p><code>predict.SIS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

set.seed(0)
n = 400; p = 50; rho = 0.5
corrmat = diag(rep(1-rho, p)) + matrix(rho, p, p)
corrmat[,4] = sqrt(rho)
corrmat[4, ] = sqrt(rho)
corrmat[4,4] = 1
corrmat[,5] = 0
corrmat[5, ] = 0
corrmat[5,5] = 1
cholmat = chol(corrmat)
x = matrix(rnorm(n*p, mean=0, sd=1), n, p)
x = x%*%cholmat

# gaussian response 
set.seed(1)
b = c(4,4,4,-6*sqrt(2),4/3)
y=x[, 1:5]%*%b + rnorm(n)
# SIS without regularization
model10 = SIS(x, y, family='gaussian', iter = FALSE)
model10$sis.ix0
# ISIS with regularization
model11=SIS(x, y, family='gaussian', tune='bic')
model12=SIS(x, y, family='gaussian', tune='bic', varISIS='aggr', seed=11)
model11$ix
model12$ix

## Not run: 
# binary response 
set.seed(2)
feta = x[, 1:5]%*%b; fprob = exp(feta)/(1+exp(feta))
y = rbinom(n, 1, fprob)
model21=SIS(x, y, family='binomial', tune='bic')
model22=SIS(x, y, family='binomial', tune='bic', varISIS='aggr', seed=21)
model21$ix
model22$ix

# poisson response
set.seed(3)
b = c(0.6,0.6,0.6,-0.9*sqrt(2))
myrates = exp(x[, 1:4]%*%b)
y = rpois(n, myrates)
model31=SIS(x, y, family='poisson', penalty = 'lasso', tune='bic', perm=TRUE, q=0.9, 
            greedy=TRUE, seed=31)
model32=SIS(x, y, family='poisson', penalty = 'lasso',  tune='bic', varISIS='aggr', 
            perm=TRUE, q=0.9, seed=32)
model31$ix
model32$ix

# Cox model
set.seed(4)
b = c(4,4,4,-6*sqrt(2),4/3)
myrates = exp(x[, 1:5]%*%b)
Sur = rexp(n,myrates); CT = rexp(n,0.1)
Z = pmin(Sur,CT); ind = as.numeric(Sur&lt;=CT)
y = survival::Surv(Z,ind)
model41=SIS(x, y, family='cox', penalty='lasso', tune='bic', 
           varISIS='aggr', seed=41)
model42=SIS(x, y, family='cox', penalty='lasso', tune='bic', 
             varISIS='cons', seed=41)
model41$ix
model42$ix

## End(Not run)

</code></pre>


</div>