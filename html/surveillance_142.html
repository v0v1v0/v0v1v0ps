<div class="container">

<table style="width: 100%;"><tr>
<td>findH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find decision interval for given in-control ARL and reference value</h2>

<h3>Description</h3>

<p>Function to find a decision interval <code>h</code>* for given reference value <code>k</code>
and desired ARL <code class="reqn">\gamma</code> so that the
average run length for a Poisson or Binomial CUSUM with in-control
parameter <code class="reqn">\theta_0</code>, reference value <code>k</code> and is approximately <code class="reqn">\gamma</code>,
i.e. <code class="reqn">\Big| \frac{ARL(h^*) -\gamma}{\gamma} \Big| &lt; \epsilon</code>,
or larger, i.e.
<code class="reqn">ARL(h^*) &gt; \gamma </code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findH(ARL0, theta0, s = 1, rel.tol = 0.03, roundK = TRUE,
      distr = c("poisson", "binomial"), digits = 1, FIR = FALSE, ...)

hValues(theta0, ARL0, rel.tol=0.02, s = 1, roundK = TRUE, digits = 1,
        distr = c("poisson", "binomial"), FIR = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ARL0</code></td>
<td>
<p> desired in-control ARL <code class="reqn">\gamma</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>in-control parameter <code class="reqn">\theta_0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>change to detect, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
 <p><code>"poisson"</code> or <code>"binomial"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>relative tolerance, i.e. the search for <code>h</code>* is
stopped if <code class="reqn">\Big| \frac{ARL(h^*) -\gamma}{\gamma} \Big| &lt; </code> <code>rel.tol</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the reference value <code>k</code> and the decision  interval <code>h</code>
are rounded to <code>digits</code> decimal places</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roundK</code></td>
<td>
<p> passed to <code>findK</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FIR</code></td>
<td>
<p>if <code>TRUE</code>, the decision interval that leads to the desired ARL
for a FIR CUSUM with head start
<code class="reqn">\frac{\code{h}}{2}</code> is returned </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments for the distribution function, i.e. number
of trials <code>n</code> for binomial cdf </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The out-of-control parameter used to determine the reference value <code>k</code>
is specified as:
</p>
<p style="text-align: center;"><code class="reqn">\theta_1 = \lambda_0 + s \sqrt{\lambda_0} </code>
</p>

<p>for a Poisson variate <code class="reqn">X \sim Po(\lambda)</code>
</p>
<p style="text-align: center;"><code class="reqn">\theta_1 = \frac{s \pi_0}{1+(s-1) \pi_0} </code>
</p>

<p>for a Binomial variate <code class="reqn">X \sim Bin(n, \pi) </code>
</p>


<h3>Value</h3>

<p><code>findH</code> returns a vector and <code>hValues</code> returns a matrix with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>in-control parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>decision interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>reference value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARL</code></td>
<td>
<p>ARL for a CUSUM with parameters <code>k</code> and <code>h</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>corresponds to <code class="reqn">\Big| \frac{ARL(h) -\gamma}{\gamma} \Big|</code> </p>
</td>
</tr>
</table>
</div>