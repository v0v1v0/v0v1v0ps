<div class="container">

<table style="width: 100%;"><tr>
<td>CalculateBarcodeInflections</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Barcode Distribution Inflection</h2>

<h3>Description</h3>

<p>This function calculates an adaptive inflection point ("knee") of the barcode distribution
for each sample group. This is useful for determining a threshold for removing
low-quality samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalculateBarcodeInflections(
  object,
  barcode.column = "nCount_RNA",
  group.column = "orig.ident",
  threshold.low = NULL,
  threshold.high = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barcode.column</code></td>
<td>
<p>Column to use as proxy for barcodes ("nCount_RNA" by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.column</code></td>
<td>
<p>Column to group by ("orig.ident" by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.low</code></td>
<td>
<p>Ignore barcodes of rank below this threshold in inflection calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.high</code></td>
<td>
<p>Ignore barcodes of rank above thisf threshold in inflection calculation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function operates by calculating the slope of the barcode number vs. rank
distribution, and then finding the point at which the distribution changes most
steeply (the "knee"). Of note, this calculation often must be restricted as to the
range at which it performs, so 'threshold' parameters are provided to restrict the
range of the calculation based on the rank of the barcodes. [BarcodeInflectionsPlot()]
is provided as a convenience function to visualize and test different thresholds and
thus provide more sensical end results.
</p>
<p>See [BarcodeInflectionsPlot()] to visualize the calculated inflection points and
[SubsetByBarcodeInflections()] to subsequently subset the Seurat object.
</p>


<h3>Value</h3>

<p>Returns Seurat object with a new list in the 'tools' slot, 'CalculateBarcodeInflections' with values:
</p>
<p>* 'barcode_distribution' - contains the full barcode distribution across the entire dataset
* 'inflection_points' - the calculated inflection points within the thresholds
* 'threshold_values' - the provided (or default) threshold values to search within for inflections
* 'cells_pass' - the cells that pass the inflection point calculation
</p>


<h3>Author(s)</h3>

<p>Robert A. Amezquita, <a href="mailto:robert.amezquita@fredhutch.org">robert.amezquita@fredhutch.org</a>
</p>


<h3>See Also</h3>

<p><code>BarcodeInflectionsPlot</code> <code>SubsetByBarcodeInflections</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("pbmc_small")
CalculateBarcodeInflections(pbmc_small, group.column = 'groups')

</code></pre>


</div>