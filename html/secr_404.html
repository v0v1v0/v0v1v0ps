<div class="container">

<table style="width: 100%;"><tr>
<td>addTelemetry</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine Telemetry and Detection Data</h2>

<h3>Description</h3>

<p>Animal locations determined by radiotelemetry can be used to augment
capture–recapture data.  The procedure in <span class="pkg">secr</span> is first to form a
capthist object containing the telemetry data and then to combine this
with true capture–recapture data (e.g. detections from hair-snag DNA)
in another capthist object.  <code>secr.fit</code> automatically detects the
telemetry data in the new object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
addTelemetry (detectionCH, telemetryCH, type = c('concurrent','dependent','independent'), 
   collapsetelemetry = TRUE, verify = TRUE) 

xy2CH (CH, inflation = 1e-08)

telemetrytype (object) &lt;- value

telemetrytype (object, ...)       

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>detectionCH</code></td>
<td>
<p>single-session capthist object, detector type ‘single’, ‘multi’, ‘proximity’ or ‘count’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>telemetryCH</code></td>
<td>
<p>single-session capthist object, detector type ‘telemetryonly’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapsetelemetry</code></td>
<td>
<p>logical; if TRUE then telemetry occasions are collapsed to one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verify</code></td>
<td>
<p>logical; if TRUE then <code>verify.capthist</code> is called on the output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CH</code></td>
<td>
<p>capthist object with telemetryxy attribute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inflation</code></td>
<td>
<p>numeric tolerance for polygon</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>secr traps object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>character telemetry type replacement value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that a number of animals have been radiotagged, and their telemetry data
(xy-coordinates) have been input to <code>telemetryCH</code>, perhaps using
<code>read.capthist</code> with <code>detector = "telemetryonly"</code> and <code>fmt =
  "XY"</code>, or with <code>read.telemetry</code>.
</p>
<p>A new capthist object is built comprising all the detection
histories in <code>detectionCH</code>, plus empty (all-zero) histories for
every telemetered animal not in <code>detectionCH</code>.  Telemetry is associated with new sampling occasions and a new detector (nominally at the same point as the first in <code>detectionCH</code>).  The number of telemetry fixes of each animal is recorded in the relevant cell of the new capthist object (CH[i, s, K+1] for animal i and occasion s if there were K detectors in detectionCH).
</p>
<p>The new sampling occasion(s) are assigned the detector type ‘telemetry’ in the traps attribute of the output capthist object, and the traps attribute <code>telemetrytype</code> is set to the value provided.  The telemetry type may be “independent” (no matching of individuals in captured and telemetered samples), “dependent” (telemetered animals are a subset of captured animals) or “concurrent” (histories may be capture-only, telemetry-only or both capture and telemetry).
</p>
<p>The telemetry locations are carried over from telemetryCH as attribute ‘xylist’ (each
component of xylist holds the coordinates of one animal; use
<code>telemetryxy</code> to extract).
</p>
<p>The default behaviour of 'addTelemetry' is to automatically collapse all telemetry occasions into one.  This is computationally more efficient than the alternative, but closes off some possible models.
</p>
<p><code>xy2CH</code> partly reverses <code>addTelemetry</code>: the location
information in the telemetryxy attribute is converted back to a capthist with
detector type ‘telemetry’.
</p>


<h3>Value</h3>

<p>A single-session capthist object with the same detector type as
<code>detectionCH</code>, but possibly with empty rows and an ‘telemetryxy’ attribute.
</p>


<h3>Note</h3>

<p>Telemetry provides independent data on the location and presence of a
sample of animals. These animals may be missed in the main sampling that
gives rise to detectionCH i.e., they may have all-zero detection
histories.
</p>
<p>The ‘telemetry’ detector type is used for telemetry occasions in a combined dataset.
</p>


<h3>See Also</h3>

<p><code>capthist</code>,
<code>make.telemetry</code>,
<code>read.telemetry</code>,
<code>telemetryxy</code>
<code>telemetered</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

# Generate some detection and telemetry data, combine them using
# addTelemetry, and perform analyses

# detectors
te &lt;- make.telemetry()
tr &lt;- make.grid(detector = "proximity")

# simulated population and 50% telemetry sample
totalpop &lt;- sim.popn(tr, D = 20, buffer = 100)
tepop &lt;- subset(totalpop, runif(nrow(totalpop)) &lt; 0.5)

# simulated detection histories and telemetry
# the original animalID (renumber = FALSE) are needed for matching
trCH &lt;- sim.capthist(tr,  popn = totalpop, renumber = FALSE, detectfn = "HHN")
teCH &lt;- sim.capthist(te, popn = tepop, renumber=FALSE, detectfn = "HHN",
    detectpar = list(lambda0 = 3, sigma = 25))

combinedCH &lt;- addTelemetry(trCH, teCH)

# summarise and display
summary(combinedCH)
plot(combinedCH, border = 150)
ncapt &lt;- apply(combinedCH,1,sum)
points(totalpop[row.names(combinedCH)[ncapt==0],], pch = 1)
points(totalpop[row.names(combinedCH)[ncapt&gt;0],], pch = 16)

# for later comparison of precision we must fix the habitat mask
mask &lt;- make.mask(tr, buffer = 100)
fit.tr &lt;- secr.fit(trCH, mask = mask, CL = TRUE, detectfn = "HHN")  ## trapping alone
fit.te &lt;- secr.fit(teCH, mask = mask, CL = TRUE, start = log(20),   ## telemetry alone
    detectfn = "HHN") 
fit2   &lt;- secr.fit(combinedCH, mask = mask, CL = TRUE,              ## combined
    detectfn = "HHN")                                 

# improved precision when focus on realised population
# (compare CVD)
derived(fit.tr, distribution = "binomial")
derived(fit2, distribution = "binomial")


# may also use CL = FALSE
secr.fit(combinedCH, CL = FALSE, detectfn = "HHN", trace = FALSE)

## End(Not run)

</code></pre>


</div>