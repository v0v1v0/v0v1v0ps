<div class="container">

<table style="width: 100%;"><tr>
<td>spectrum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral Density</h2>

<h3>Description</h3>

<p>Estimate the spectral density of a time series or compute the spectral
density associated with a time series model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectrum(x, standardize = TRUE, ...)

## Default S3 method:
spectrum(x, standardize = TRUE, raw = TRUE, taper = 0.1, 
         demean = FALSE, detrend = TRUE, ...)

## S3 method for class 'genspec'
print(x, n.head = min(length(x$spec), 6), sort = TRUE, ...)

## S3 method for class 'Arima'
spectrum(x, standardize = TRUE, ...)

## S3 method for class 'ArmaModel'
spectrum(x, standardize = TRUE, ...)

## S3 method for class 'SarimaModel'
spectrum(x, standardize = TRUE, ...)

## S3 method for class 'function'
spectrum(x, standardize = TRUE, param = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a model or a univariate or multivariate time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>

<p>if <code>TRUE</code>, the default method standardises the time series
before computing the periodogram, while the methods for models scale
the spectral density so that it is a probability density function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>

<p>if <code>TRUE</code>, the default, compute a completely raw periodogram,
unless further arguments request otherwise, see section Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper,demean,detrend</code></td>
<td>

<p>see <code>spec.pgram</code> and section ‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments for the default method. Currently not used by
other methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.head</code></td>
<td>
<p>how many rows to print?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p><code>TRUE</code>, <code>FALSE</code> or <code>"max"</code>, see section ‘Details'’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>

<p>a named list, specying model parameters for the <code>"function"</code>
method, see section ‘Details’.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>spectrum</code> in package <span class="pkg">sarima</span> is a generic function with a
default method its namesake in package <span class="pkg">stats</span>, see
<code>spectrum</code> for a full description of its
functionality.
</p>
<p>Autoprinting of objects returned by <code>spectrum</code> prints concise
information and plots the spectrum. This means that a plot is
produced, for example, when the result of a call to <code>spectrum()</code>
is not assigned to a variable or if a command containing just the name
of the object is executed. If you don't want the graph, just assign
the result to a variable. For more control over the printing (for
example, number of digits) use <code>print(object, ...)</code>
explicitly. In that case no plot is produced. If additional graphical
parameters are desired, call <code>plot, ...</code>.
</p>
<p>All methods print some basic information about the object and a table
giving the most influential frequencies and their contributions to the
spectrum.
</p>
<p>Methods for objects representing ARIMA and SARIMA models (fitted or
theoretical) compute the corresponding spectral densities. For
non-stationary models, the spectral density for the stationary part.
These methods for <code>spectrum</code> return objects from class
<code>"Spectrum"</code>.  If <code>standardize = TRUE</code> the spectral density
is scaled, so that it integrates to one (and so is a probability
density function).  For fitted models confidence bands are not
computed currently.
</p>
<p>The method for class <code>"function"</code> can be used to create objects
from class <code>"Spectrum"</code> using a user specified function. The
first argument of that function needs to be a vector of frequencies
for which to calculate the spectrum. It is conventionally called
<code>freq</code> but this is not required.  If there are parameters they
should not be part of the signature of the function but need to be
listed and given values as a named list via argument <code>param</code>, see
the examples for class <code>"Spectrum"</code>. This method is
somewhat experimental but the restrictions might be relaxed in a
future release.
</p>
<p>The rest of this section describes the default method. For futher
details on the other methods see <code>"Spectrum"</code>.
</p>


<h4>The default method for <code>spectrum</code>
</h4>

<p>The default method is a wrapper for <code>stats::spectrum()</code>.
</p>
<p>The default method returns an object from class "genspec". It
inherits from <code>"spec"</code>, the class returned by
<code>stats::spectrum</code>, and adds some additional components. The
main difference though is that it has a print method, which plots
the object as discussed above.  <code>raw = FALSE</code> with no further
arguments is equivalent to <code>stats::spectrum(object)</code> and
computes a raw periodogram (for the standardised time series if
<code>standardize = TRUE</code>). This still detrends and tapers the
series though.  <code>raw = TRUE</code> sets <code>detrend</code> to
<code>FALSE</code>, <code>taper</code> to zero, and <code>demean</code> to
<code>TRUE</code>, to compute a ‘completely raw’ periodogram. In
both cases, further arguments are respected.
</p>
<p>Argument <code>sort</code> of the <code>print</code> method for <code>"genspec"</code>
controls the sorting order of the columns of the printed table. If
<code>FALSE</code>, no sorting is done.  If <code>TRUE</code>, the spectrum is
sorted in decreasing order, so the first row contains the frequency
with the highest value of the spectrum. If <code>"max"</code>, the local
maxima are found and sorted in decreasing order, followed by the
rest, also sorted in decreasing order. Note that due to aliasing the
local maxima may be shifted from the “true” frequency
(e.g. not be exactly on the harmonics of the number of
seasons). Tapering and smoothing parameters may help.
</p>
<p>The plot method for class <code>"genspec"</code> is inherited from that
for <code>"spec"</code>, see <code>?plot.spec</code>.
</p>



<h3>Value</h3>

<p>for the default method, an object of class <code>"genspec"</code>, which
inherits from <code>"spec"</code>, and contains the following additional
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>TRUE or FALSE,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseasons</code></td>
<td>
<p>number of seasons,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.range</code></td>
<td>
<p><code>numeric(2)</code>, the frequency range - <code style="white-space: pre;">⁠(-m/2, m/2]⁠</code>,
where <code>m = floor(frequency(x))</code>;</p>
</td>
</tr>
</table>
<p>for the remaining methods, an object of class <code>"Spectrum"</code>.  
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>See Also</h3>

<p><code>spectrum</code> which is called by the default method to
do the work.
</p>
<p>class <code>"Spectrum"</code> for further details on the
methods for objects returned by <code>spectrum()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## spectral density of the stationary part of a fitted 'airline model'
fit0 &lt;- arima(AirPassengers, order = c(0,1,1),
              seasonal = list(order = c(0,1,1), period = 12))
spectrum(fit0)

## spectral densities of some ARMA models models from Chan and Gray ().
##   (TODO: complete the reference)
spectrum(ArmaModel(ma = c(-1, 0.6), sigma2 = 1))
spectrum(ArmaModel(ar = 0.5, sigma2 = 1))
spectrum(ArmaModel(ar = 0.5, ma = -0.8, sigma2 = 1))
spectrum(new("SarimaModel", ar = 0.5, sar = 0.9, nseasons = 12, sigma2 = 1))

mo &lt;- new("SarimaModel", ma = -0.4, sma = -0.9, nseasons = 12, sigma2 = 1)
sp1.mo &lt;- spectrum(mo)
## this also plots the object.  (if you are reading the web version, generated
##     by pkgdown, it may not be showing some of the graphs,
##     I haven't figured out why.)
show(sp1.mo)  # equivalently, just sp1.mo

print(sp1.mo)
print(sp1.mo, digits = 4)
plot(sp1.mo)
plot(sp1.mo, standardize = FALSE)

## the object can be used as a function:
head(sp1.mo())
sp1.mo(seq(0, 0.5, length.out = 12))
sp1.mo(seq(0, 0.5, length.out = 12), standardize = FALSE)

sarima1b &lt;- new("SarimaModel", ar = 0.9, ma = 0.1, sar = 0.5, sma = 0.9,
                nseasons = 12, sigma2 = 1)
spectrum(sarima1b)

## default method for spectrum()

## frequency range is c(-1/2, 1/2] since frequency(x) = 1
frequency(lh)
spectrum(lh)

## frequency range is c(-12/2, 12/2] since frequency(x) = 12
frequency(ldeaths)
( sp &lt;- spectrum(ldeaths) )
print(sp) # equivalently: print(sp, sort = TRUE)
print(sp, sort = FALSE, n.head = 3)
print(sp, sort = "max")
plot(sp)
plot(sp, log = "dB")  # see ?plot.spec for further arguments
</code></pre>


</div>