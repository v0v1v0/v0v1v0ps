<div class="container">

<table style="width: 100%;"><tr>
<td>CoxMI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox PH model with MI method
</h2>

<h3>Description</h3>

<p>CoxMI function estimated Cox model with uncertain endpoints by using MI method. Users have to provide survival data in a long format with rows for all potential events, together with corresponding event probabilities. The long format data should be transformed by the uc_data_transform function into a data list before feed into the function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CoxMI(data_list,nMI=1000,covariates=NULL,id=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_list</code></td>
<td>

<p>The data list which has been transformed from the long format by the uc_data_transform function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMI</code></td>
<td>

<p>Number of imputations (&gt;1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>Vector of covariates on the RHS of Cox model. Categorical variables need to be encoded as factor variables before entering the model. This encoding has to be done before the data transform step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>Vector of id variable if Andersen-Gill model is required.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments passed on to coxph().
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates the estimated parameters as in the usual Cox proportional hazards model when event uncertainties present. The data are assumed to consist of potential event times with probabilities or weights between 0 and 1 corresponding to the probability that an event occurred at each time.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Estimated vector of coefficients in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Estimated variance of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betamat</code></td>
<td>
<p>Matrix containing estimate of coefficient from each imputed dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var_mat</code></td>
<td>
<p>Array containing variances for each imputed dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Between Var</code></td>
<td>
<p>Between imputation variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Within Var</code></td>
<td>
<p>Mean within imputed dataset variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMI</code></td>
<td>
<p>Number of imputed datasets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Estimated two-sided p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en</code></td>
<td>
<p>Expected events count - mean event count of imputed datasets</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yiming Chen, John Lawrence
</p>


<h3>References</h3>

<p>[1] Rubin DB. Multiple Imputation for Nonresponse in Surveys. New York: Wiley; 1987
</p>


<h3>See Also</h3>

<p><code>Coxwt</code>, <code>CoxMI.summ</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(128)
df_x&lt;-data_sim(n=500,true_hr=0.8,haz_c=0.5/365)
df_x$f.trt&lt;-as.factor(df_x$trt_long)
data_intrim&lt;-uc_data_transform(data=df_x,
                               var_list=c("id_long","f.trt"),
                               var_list_new=c("id","trt"),
                               time="time_long",
                               prob="prob_long")
#nMI=10 used in the example below to reduce the time needed
#but a large number as nMI=1000 is recommended in practice

fit&lt;-CoxMI(data_list=data_intrim,nMI=10,covariates=c("trt"))
CoxMI.summ(fit)


fit&lt;-CoxMI(data_list=data_intrim,nMI=1000,covariates=c("trt"),id=c("id"))
CoxMI.summ(fit)

</code></pre>


</div>