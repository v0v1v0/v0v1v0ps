<div class="container">

<table style="width: 100%;"><tr>
<td>Authenticated encryption</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Authenticated Encryption</h2>

<h3>Description</h3>

<p>Exchange secure messages through curve25519 authenticated encryption.
</p>


<h3>Usage</h3>

<pre><code class="language-R">auth_encrypt(msg, key, pubkey, nonce = random(24))

auth_decrypt(bin, key, pubkey, nonce = attr(bin, "nonce"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>message to be encrypted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>your own private key</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pubkey</code></td>
<td>
<p>other person's public key</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonce</code></td>
<td>
<p>non-secret unique data to randomize the cipher</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>encrypted ciphertext generated by <code>secure_send</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Authenticated encryption implements best practices for secure messaging.
It requires that both sender and receiver have a keypair and know each
other's public key. Each message gets authenticated with the key of the
sender and encrypted with the key of the receiver.
</p>
<p>Even though public keys are not confidential, you should not exchange them
over the same insecure channel you are trying to protect. If the connection
is being tampered with, the attacker could simply replace the key with another
one to hijack the interaction.
</p>
<p>Most people share their public key by posting them on their website or on a
public keyserver. Another alternative is having your public key signed by a
mutually trusted third party. HTTPS does this using Certificate Authorities.
</p>


<h3>References</h3>

<p><a href="https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption">https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Bob's keypair:
bob_key &lt;- keygen()
bob_pubkey &lt;- pubkey(bob_key)

# Alice's keypair:
alice_key &lt;- keygen()
alice_pubkey &lt;- pubkey(alice_key)

# Bob sends encrypted message for Alice:
msg &lt;- charToRaw("TTIP is evil")
ciphertext &lt;- auth_encrypt(msg, bob_key, alice_pubkey)

# Alice verifies and decrypts with her key
out &lt;- auth_decrypt(ciphertext, alice_key, bob_pubkey)
stopifnot(identical(out, msg))

# Alice sends encrypted message for Bob
msg &lt;- charToRaw("Let's protest")
ciphertext &lt;- auth_encrypt(msg, alice_key, bob_pubkey)

# Bob verifies and decrypts with his key
out &lt;- auth_decrypt(ciphertext, bob_key, alice_pubkey)
stopifnot(identical(out, msg))
</code></pre>


</div>