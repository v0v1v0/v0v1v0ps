<div class="container">

<table style="width: 100%;"><tr>
<td>predict.ML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SEM-based out-of-sample prediction using node-wise ML</h2>

<h3>Description</h3>

<p>Predict method for ML objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ML'
predict(object, newdata, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A model fitting object from <code>SEMml()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A matrix containing new data with rows corresponding to
subjects, and columns to variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print predicted out-of-sample MSE values (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 2 objects:
</p>

<ol>
<li>
<p> "PE", vector of the prediction error equal to the Mean Squared Error
(MSE) for each out-of-bag prediction. The first value of PE is the AMSE,
where we average over all (sink and mediators) graph nodes.
</p>
</li>
<li>
<p> "Yhat", the matrix of continuous predicted values of graph nodes  
(excluding source nodes) based on out-of-bag samples. 
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Load Amyotrophic Lateral Sclerosis (ALS)
data&lt;- alsData$exprs; dim(data)
data&lt;- transformData(data)$data
ig&lt;- alsData$graph; gplot(ig)

#...with train-test (0.5-0.5) samples
set.seed(123)
train&lt;- sample(1:nrow(data), 0.5*nrow(data))

start&lt;- Sys.time()
# ... rf
res1&lt;- SEMml(ig, data, train, algo="rf", vimp=FALSE)
mse1&lt;- predict(res1, data[-train, ], verbose=TRUE)

# ... xgb
res2&lt;- SEMml(ig, data, train, algo="xgb", vimp=FALSE)
mse2&lt;- predict(res2, data[-train, ], verbose=TRUE)

# ... nn
res3&lt;- SEMml(ig, data, train, algo="nn", vimp=FALSE)
mse3&lt;- predict(res3, data[-train, ], verbose=TRUE)

# ... gam
res4&lt;- SEMml(ig, data, train, algo="gam", vimp=FALSE)
mse4&lt;- predict(res4, data[-train, ], verbose=TRUE)

# ... sem
res5&lt;- SEMml(ig, data, train, algo="sem", vimp=FALSE)
mse5&lt;- predict(res5, data[-train, ], verbose=TRUE)
end&lt;- Sys.time()
print(end-start)


</code></pre>


</div>