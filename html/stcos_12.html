<div class="container">

<table style="width: 100%;"><tr>
<td>car_precision</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CAR Precision Matrix</h2>

<h3>Description</h3>

<p>A convenience function to compute the CAR precision matrix
based on a given adjacency matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">car_precision(A, tau = 1, scale = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>An adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The CAR dependency parameter <code class="reqn">\tau \in [0,1]</code>.
See "Value". Default: <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Whether to scale matrix entries. See "Value".
Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose <code class="reqn">\bm{A}</code> is an <code class="reqn">n \times n</code> adjacency matrix and
<code class="reqn">
  \bm{D} = \textrm{Diag}(\bm{A} \bm{1})
  = \textrm{Diag}(a_{1+}, \ldots, a_{n+}).
</code>
If <code>scale</code> is <code>FALSE</code>, return the CAR precision matrix
</p>
<p style="text-align: center;"><code class="reqn">
  \bm{Q} = \bm{D} - \tau \bm{A}.
</code>
</p>

<p>If <code>scale</code> is <code>TRUE</code>, return a scaled version
</p>
<p style="text-align: center;"><code class="reqn">
  \tilde{\bm{Q}} = \bm{D}^{-1} \bm{Q}.
</code>
</p>

<p>An error is thrown if <code>scale = TRUE</code> and any of
<code class="reqn">\{ a_{1+}, \ldots, a_{n+} \}</code> are equal to 0.
Taking <code class="reqn">\tau = 1</code> corresponds to the Intrinsic CAR
precision matrix.
</p>
<p>Typically in a modeling context, the precision matrix will be
multiplied by a scaling parameter; e.g., a CAR model for
random effects <code class="reqn">\bm{\phi}</code> could be
</p>
<p style="text-align: center;"><code class="reqn">
  f(\bm{\phi} \mid \alpha) \propto
  \alpha^{-q} \exp\left\{ -\frac{1}{2 \alpha^2}
  \bm{\phi}^\top \bm{Q} \bm{\phi} \right\}.
</code>
</p>

<p>where <code class="reqn">q = \textrm{rank}(Q)</code>.
</p>


<h3>Value</h3>

<p>CAR precision matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("acs_sf")
dom = acs5_2013[1:4,]
A = adjacency_matrix(dom)
Q = car_precision(A)

</code></pre>


</div>