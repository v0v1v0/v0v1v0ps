<div class="container">

<table style="width: 100%;"><tr>
<td>FitAkdParameters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the 5 parameters used for affine kernel dressing by minimum CRPS estimation.</h2>

<h3>Description</h3>

<p>Fit the 5 parameters used for affine kernel dressing by minimum CRPS estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitAkdParameters(ens, obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ens</code></td>
<td>
<p>a N*R matrix. An archive of R-member ensemble forecasts for N time instances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>a vector of length N. The verifying observations corresponding to the N ensemble forecasts.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Affine Kernel Dressing transforms the discrete K-member forecast ensemble at time instance n, 'ens[n, ]', to a continuous distribution function for the target 'y' by the equation:
</p>
<p>p(y|ens) = 1 / K * sum dnorm(y, z.i, s) <br>
where   s = (4/3/K)^0.4 * (s1 + s2 * a^2 * var(ens)) <br>
and   z.i = r1 + r2 * mean(ens) + a * ens
</p>
<p>The parameters r1, r2, a, s1, s2 are fitted by minimizing the continuously ranked probability score (CRPS). The optimization is carried out using the R function 'optim(...)'.
</p>
<p>Since the evaluation of the CRPS is numerically expensive, the optimization can take a long time. Speed can be increased by optimizing the parameters only for a part of the forecast instances.
</p>


<h3>Value</h3>

<p>The function returns a list of 5 parameters for affine kernel dressing.
</p>


<h3>References</h3>

<p>Broecker J. and Smith L. (2008). From ensemble forecasts to predictive distribution functions. Tellus (2008), 60A, 663â€“678. doi: <a href="https://doi.org/10.1111/j.1600-0870.2008.00333.x">10.1111/j.1600-0870.2008.00333.x</a>.
</p>


<h3>See Also</h3>

<p>DressEnsemble, DressCrps, DressIgn, PlotDressedEns, GetDensity
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eurotempforecast)
FitAkdParameters(ens, obs)
</code></pre>


</div>