<div class="container">

<table style="width: 100%;"><tr>
<td>twinSIR_methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Print, Summary and Extraction Methods for <code>"twinSIR"</code> Objects
</h2>

<h3>Description</h3>

<p>Besides <code>print</code> and <code>summary</code> methods there are also some standard
extraction methods defined for objects of class <code>"twinSIR"</code>:
<code>vcov</code>, <code>logLik</code> and especially <code>AIC</code> and
<code>extractAIC</code>, which extract Akaike's Information Criterion.  Note that
special care is needed, when fitting models with parameter constraints such as
the epidemic effects <code class="reqn">\alpha</code> in <code>twinSIR</code> models.  Parameter
constraints reduce the average increase in the maximized loglikelihood - thus
the penalty for constrained parameters should be smaller than the factor 2 used
in the ordinary definition of AIC.  To this end, these two methods offer the
calculation of the so-called one-sided AIC (OSAIC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'twinSIR'
print(x, digits = max(3, getOption("digits") - 3), ...)
## S3 method for class 'twinSIR'
summary(object,
        correlation = FALSE, symbolic.cor = FALSE, ...)

## S3 method for class 'twinSIR'
AIC(object, ..., k = 2, one.sided = NULL, nsim = 1e3)
## S3 method for class 'twinSIR'
extractAIC(fit, scale = 0, k = 2, one.sided = NULL,
           nsim = 1e3, ...)

## S3 method for class 'twinSIR'
vcov(object, ...)
## S3 method for class 'twinSIR'
logLik(object, ...)

## S3 method for class 'summary.twinSIR'
print(x,
      digits = max(3, getOption("digits") - 3), symbolic.cor = x$symbolic.cor,
      signif.stars = getOption("show.signif.stars"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object, fit</code></td>
<td>
<p>an object of class <code>"twinSIR"</code>.<br>
For the <code>print</code> method of the <code>summary</code> method, an object of
class <code>"summary.twinSIR"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>integer, used for number formatting with <code>signif()</code>.  Minimum number of
significant digits to be printed in values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>

<p>logical. if <code>TRUE</code>, the correlation matrix of the estimated parameters
is returned and printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolic.cor</code></td>
<td>

<p>logical. If <code>TRUE</code>, print the correlations in a symbolic form (see
<code>symnum</code>) rather than as numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For the <code>summary</code> method: arguments passed to
<code>extractAIC.twinSIR</code>.<br>
For the <code>AIC</code> method, optionally more fitted model objects.<br>
For the <code>print</code>, <code>extractAIC</code>, <code>vcov</code> and
<code>logLik</code> methods: unused (argument of the generic).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>numeric specifying the "weight" of the <em>penalty</em> to be used;
in an unconstrained fit <code>k = 2</code> is the classical AIC.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one.sided</code></td>
<td>

<p>logical or <code>NULL</code> (the default).  Determines if the one-sided AIC
should be calculated instead of using the classical penalty <code>k*edf</code>. 
The default value <code>NULL</code> chooses classical AIC in the case of an
unconstrained fit and one-sided AIC in the case of constraints. The type of
the fit can be seen in <code>object$method</code> (or <code>fit$method</code>
respectively), where <code>"L-BFGS"</code> means constrained optimization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>when there are more than two epidemic covariates in the fit, the
weights in the OSAIC formula have to be determined by simulation. 
Default is to use 1000 samples. Note that package <span class="pkg">quadprog</span> is
additionally required in this case.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>unused (argument of the generic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, “significance
stars” are printed for each coefficient.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>print</code> and <code>summary</code> methods allow the compact or comprehensive
representation of the fitting results, respectively.  The former only prints
the original function call, the estimated coefficients and the maximum
log-likelihood value.  The latter prints the whole coefficient matrix with
standard errors, z- and p-values (see <code>printCoefmat</code>), and 
additionally the number of infections per log-baseline <code>interval</code>, 
the (one-sided) AIC and the number of log-likelihood evaluations.  They both
append a big “WARNING”, if the optimization algorithm did not converge.
</p>
<p>The estimated coefficients may be extracted by using the default
<code>coef</code>-method from package <span class="pkg">stats</span>.
</p>
<p>The two AIC functions differ only in that <code>AIC</code> can take more than one
fitted model object and that <code>extractAIC</code> always returns the number of
parameters in the model (<code>AIC</code> only does with more than one fitted model
object).
</p>
<p>Concerning the choice of one-sided AIC: parameter constraints – such as the
non-negative constraints for the epidemic effects alpha in <code>twinSIR</code>
models – reduce the average increase in the maximized loglikelihood.  Thus,
the penalty for constrained parameters should be smaller than the factor 2
used in the ordinary definition of AIC.  One-sided AIC (OSAIC) suggested by
Hughes and King (2003) is such a proposal when <code class="reqn">p</code> out of <code class="reqn">k = p + q</code>
parameters have non-negative constraints:
</p>
<p style="text-align: center;"><code class="reqn">OSAIC = -2 l(\theta, \tau) + 2 \sum_{g=0}^p w(p,g) (k-p+g)</code>
</p>

<p>where <code class="reqn">w(p,g)</code> are <code class="reqn">p</code>-specific weights.  For more details see
Section 5.2 in Höhle (2009).
</p>


<h3>Value</h3>

<p>The <code>print</code> methods return their first argument, invisibly, as
they always should. The <code>vcov</code> and <code>logLik</code>
methods return the estimated variance-covariance
matrix of the parameters (here, the inverse of the estimate of the
expected Fisher information matrix), and the maximum log-likelihood
value of the model, respectively.
The <code>summary</code> method returns a list containing some summary
statistics of the fitted model, which is nicely printed by the
corresponding <code>print</code> method.
For the <code>AIC</code> and <code>extractAIC</code> methods, see
the documentation of the corresponding generic functions.
</p>


<h3>Author(s)</h3>

<p>Michael Höhle and Sebastian Meyer
</p>


<h3>References</h3>

<p>Hughes A, King M (2003)
Model selection using AIC in the presence of one-sided information.
<em>Journal of Statistical Planning and Inference</em> <strong>115</strong>,
pp. 397–411.
</p>
<p>Höhle, M. (2009),
Additive-Multiplicative Regression Models for Spatio-Temporal
Epidemics, Biometrical Journal, 51(6):961-978.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hagelloch")

# a simplistic twinSIR model
fit &lt;- twinSIR(~ household + cox(AGE), data = hagelloch)

coef(fit)
vcov(fit)
logLik(fit)

summary(fit, correlation = TRUE, symbolic.cor = TRUE)

# AIC or OSAIC
AIC(fit)
AIC(fit, one.sided = FALSE)
extractAIC(fit)
extractAIC(fit, one.sided = FALSE)

# comparing models via AIC
fit2 &lt;- update(fit, nIntervals = 2)
AIC(fit, fit2)   # the 2nd column should be named "OSAIC" here
</code></pre>


</div>