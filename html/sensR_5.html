<div class="container">

<table style="width: 100%;"><tr>
<td>betabin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beta-binomial and chance-corrected beta-binomial models for
over-dispersed binomial data</h2>

<h3>Description</h3>

<p>Fits the beta-binomial model and the chance-corrected beta-binomial
model to (over-dispersed) binomial data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">betabin(data, start = c(.5,.5),
        method = c("duotrio", "tetrad", "threeAFC", "twoAFC",
          "triangle", "hexad", "twofive", "twofiveF"),
        vcov = TRUE, corrected = TRUE, gradTol = 1e-4, ...)

## S3 method for class 'betabin'
summary(object, level = 0.95, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix or data.frame with two columns; first column
contains the number of success and the second the total number of
cases. The number of rows should correspond to the number of
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values to be used in the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>logical, should the variance-covariance matrix of the
parameters be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the sensory discrimination protocol for which d-prime
and its standard error should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected</code></td>
<td>
<p>should the chance corrected or the standard beta
binomial model be estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradTol</code></td>
<td>
<p>a warning is issued if max|gradient| &lt; gradTol, where
'gradient' is the gradient at the values at which the optimizer
terminates. This is not used as a termination or convergence
criterion during model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class "betabin", i.e. the result of
<code>betabin()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level of the confidence intervals computed
by the summary method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>betabin</code>: The only recognized (hidden) argument is
<code>doFit</code> (boolean) which by default is <code>TRUE</code>. When
<code>FALSE</code> <code>betabin</code> returns an environment which facilitates
examination of the likelihood surface via the (hidden) functions
<code>sensR:::getParBB</code> and <code>sensR:::setParBB</code>.
Not used in <code>summary.betabin</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The beta-binomial models are parameterized in terms of mu and gamma,
where mu corresponds to a probability parameter and gamma measures
over-dispersion. Both parameters are restricted to the interval (0, 1).
The parameters of the standard (i.e. corrected = FALSE) beta-binomial
model refers to the mean (i.e. probability) and dispersion on the scale
of the observations, i.e. on the scale where we talk of a probability of
a correct answer (Pc). The parameters of the chance corrected (i.e. corrected
= TRUE) beta-binomial model refers to the mean and dispersion on the
scale of the "probability of discrimination" (Pd).
The mean parameter (mu) is therefore restricted to the
interval from zero to one in both models, but they have different
interpretations.
</p>
<p>The summary method use the estimate of mu to infer the parameters of the
sensory experiment; Pc, Pd and d-prime. These are restricted to their
allowed ranges, e.g. Pc is always at least as large as the guessing
probability.
</p>
<p>Confidens intervals are computed as Wald (normal-based) intervals on the
mu-scale and the confidence limits are subsequently transformed to the
Pc, Pd and d-prime scales. Confidence limits are restricted to the
allowed ranges of the parameters, for example no confidence limits will
be less than zero.
</p>
<p>Standard errors, and therefore also confidence intervals, are only
available if the parameters are not at the boundary of their allowed
range (parameter space). If parameters are close to the boundaries of
their allowed range, standard errors, and also confidence intervals, may
be misleading. The likelihood ratio tests are more accurate. More
accurate confidence intervals such as profile likelihood intervals may
be implemented in the future.
</p>
<p>The summary method provides a likelihood ratio test of over-dispersion
on one degree of freedom and a likelihood ratio test of association
(i.e. where the null hypothesis is "no difference" and the alternative
hypothesis is "any difference") on two degrees of
freedom (chi-square tests). Since the gamma parameter is tested on the
boundary of the
parameter space, the correct degree of freedom for the first test is
probably 1/2 rather than one, or somewhere in between, and the latter
test is probably also on less than two degrees of freedom. Research is
needed to determine the appropriate no. degrees of freedom to use in
each case. The choices used here are believed to be conservative, so the
stated p-values are probably a little too large.
</p>
<p>The log-likelihood of the standard beta-binomial model is
</p>
<p style="text-align: center;"><code class="reqn">\ell(\alpha, \beta; x, n) =
  \sum_{j=1}^N \left\{
  \log {n_j \choose x_j}
  - \log Beta(\alpha, \beta)
  + \log  Beta(\alpha + x_j, \beta - x_j + n_j) \right\}
  </code>
</p>

<p>and the log-likelihood of the chance corrected beta-binomial model is
</p>
<p style="text-align: center;"><code class="reqn">\ell(\alpha, \beta; x, n) =
  \sum_{j=1}^N \left\{ C
  + \log \left[ \sum_{i=0}^{x_j} {{x_j} \choose i}
  (1-p_g)^{n_j-x_j+i} p_g^{x_j-i}
  Beta(\alpha + i, n_j - x_j + \beta) \right] \right\}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">C =
  \log {n_j \choose x_j}
  - \log Beta(\alpha, \beta)
</code>
</p>

<p>and where <code class="reqn">\mu = \alpha/(\alpha + \beta)</code>,
<code class="reqn">\gamma = 1/(\alpha + \beta + 1)</code>, <code class="reqn">Beta</code> is the Beta
function, cf. <code>beta</code>,
<code class="reqn">N</code> is the number of independent binomial observations, i.e.~the
number of rows in <code>data</code>, and <code class="reqn">p_g</code> is the guessing
probability, <code>pGuess</code>.
</p>
<p>The variance-covariance matrix (and standard errors) is based on the
inverted Hessian at the optimum. The Hessian is obtained with the
<code>hessian</code> function from the numDeriv package.
</p>
<p>The gradient at the optimum is evaluated with <code>gradient</code> from the
numDeriv package.
</p>
<p>The bounded optimization is performed with the "L-BFGS-B" optimizer in
<code>optim</code>.
</p>
<p>The following additional methods are implemented objects of class
<code>betabin</code>: <code>print</code>, <code>vcov</code> and <code>logLik</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>betabin</code> with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance-covariance matrix of the parameter estimates if
<code>vcov = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data supplied to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the value of the log-likelihood at the MLEs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used for the fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>0 indicates convergence. For other error messages,
see <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>possible error message - see <code>optim</code> for
details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>the number of iterations used in the optimization - see
<code>optim</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected</code></td>
<td>
<p>is the chance corrected model estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikNull</code></td>
<td>
<p>log-likelihood of the binomial model with
prop = pGuess</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikMu</code></td>
<td>
<p>log-likelihood of a binomial model with
prop = sum(x)/sum(n)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rune Haubo B Christensen</p>


<h3>References</h3>

<p>Brockhoff, P.B. (2003). The statistical power of
replications in difference tests.
Food Quality and Preference, 14, pp. 405â€“417.
</p>


<h3>See Also</h3>

 <p><code>triangle</code>, <code>twoAFC</code>,
<code>threeAFC</code>, <code>duotrio</code>, <code>tetrad</code>
<code>twofive</code>, <code>twofiveF</code>, <code>hexad</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create data:
x &lt;- c(3,2,6,8,3,4,6,0,9,9,0,2,1,2,8,9,5,7)
n &lt;- c(10,9,8,9,8,6,9,10,10,10,9,9,10,10,10,10,9,10)
dat &lt;- data.frame(x, n)

## Chance corrected beta-binomial model:
(bb0 &lt;- betabin(dat, method = "duotrio"))
summary(bb0)
## Un-corrected beta-binomial model:
(bb &lt;- betabin(dat, corrected = FALSE, method = "duotrio"))
summary(bb)
vcov(bb)
logLik(bb)
AIC(bb)
coef(bb)

</code></pre>


</div>