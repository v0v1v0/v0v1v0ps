<div class="container">

<table style="width: 100%;"><tr>
<td>designSafeTwoProportions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Designs a Safe Experiment to Test Two Proportions in Stream Data</h2>

<h3>Description</h3>

<p>The design requires the number of observations one expects to collect in each group in each data block.
I.e., when one expects balanced data, one could choose <code>na = nb = 1</code> and would be allowed to analyse
the data stream each time a new observation in both groups has come in. The best results in terms of power
are achieved when the data blocks are chosen as small as possible, as this allows for analysing and updating
the safe test as often as possible, to fit the data best.
Further, the design requires two out of the following three parameters to be known:
</p>

<ul>
<li>
<p> the power one aims to achieve (<code>1 - beta</code>),
</p>
</li>
<li>
<p> the minimal relevant difference between the groups (<code>delta</code>)
</p>
</li>
<li>
<p> the number of blocks planned (<code>nBlocksPlan</code>),
</p>
</li>
</ul>
<p>where the unknown out of the three will be estimated. In the case of an exploratory "pilot" analysis,
one can also only provide the number of blocks planned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">designSafeTwoProportions(
  na,
  nb,
  nBlocksPlan = NULL,
  beta = NULL,
  delta = NULL,
  alternativeRestriction = c("none", "difference", "logOddsRatio"),
  alpha = 0.05,
  pilot = "FALSE",
  hyperParameterValues = NULL,
  previousSafeTestResult = NULL,
  M = 1000,
  simThetaAMin = NULL,
  simThetaAMax = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>number of observations in group a per data block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>number of observations in group b per data block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBlocksPlan</code></td>
<td>
<p>planned number of data blocks collected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>numeric in (0, 1) that specifies the tolerable type II error control necessary to calculate both "nBlocksPlan"
and "delta". Note that 1-beta defines the power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a priori minimal relevant divergence between group means b and a, either a numeric between -1 and 1 for
no alternative restriction or a restriction on difference, or a real for a restriction on the log odds ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternativeRestriction</code></td>
<td>
<p>a character string specifying an optional restriction on the alternative hypothesis; must be one of "none" (default),
"difference" (difference group mean b minus group b) or "logOddsRatio" (the log odds ratio between group means b and a).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric in (0, 1) that specifies the tolerable type I error control –independent on n– that the
designed test has to adhere to. Note that it also defines the rejection rule e10 &gt; 1/alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pilot</code></td>
<td>
<p>logical, specifying whether it's a pilot design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperParameterValues</code></td>
<td>
<p>named list containing numeric values for hyperparameters betaA1, betaA2, betaB1 and betaB2, with betaA1 and betaB1 specifying the parameter
equivalent to <code>shape1</code> in <code>stats::dbeta</code> for groups A and B, respectively, and betaA2 and betaB2 equivalent to <code>shape2</code>. By default
chosen to optimize evidence collected over subsequent experiments (REGRET). Pass in the following format:
<code>list(betaA1 = numeric1, betaA2 = numeric2, betaB1 = numeric3, betaB2 = numeric4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previousSafeTestResult</code></td>
<td>
<p>optionally, a previous safe test result can be provided. The posterior
of the hyperparameters of this test is then used for the hyperparameter settings. Default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of simulations used to estimate power or nBlocksPlan. Default <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simThetaAMin</code></td>
<td>
<p>minimal event rate in control group to simulate nPlan or power for.
Can be specified when specifically interested in planning studies for specific event rates.
Default <code>NULL</code>, then the entire parameter space (possibly restricted by delta) is used for simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simThetaAMax</code></td>
<td>
<p>maximal event rate in control group to simulate nPlan or power for. Default <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a 'safeDesign' object that includes:
</p>

<dl>
<dt>nPlan</dt>
<dd>
<p>the sample size(s) to plan for. Computed based on beta and meanDiffMin, or provided by the user
if known.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the safe test defining parameter: here the hyperparameters.</p>
</dd>
<dt>esMin</dt>
<dd>
<p>the minimally clinically relevant effect size provided by the user.</p>
</dd>
<dt>alpha</dt>
<dd>
<p>the tolerable type I error provided by the user.</p>
</dd>
<dt>beta</dt>
<dd>
<p>the tolerable type II error specified by the user.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>any of "twoSided", "greater", "less" based on the <code>alternativeRestriction</code> provided by the user.</p>
</dd>
<dt>testType</dt>
<dd>
<p>here 2x2</p>
</dd>
<dt>pilot</dt>
<dd>
<p>logical, specifying whether it's a pilot design.</p>
</dd>
<dt>call</dt>
<dd>
<p>the expression with which this function is called.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">#plan for an experiment to detect minimal difference of 0.6 with a balanced design
set.seed(3152021)
designSafeTwoProportions(na = 1,
                         nb = 1,
                         alpha = 0.1,
                         beta = 0.20,
                         delta = 0.6,
                         alternativeRestriction = "none",
                         M = 75)

#safe analysis of a pilot: number of samples already known
designSafeTwoProportions(na = 1,
                          nb = 1,
                          nBlocksPlan = 20,
                          pilot = TRUE)

#specify own hyperparameters
hyperParameterValues &lt;- list(betaA1 = 10, betaA2 = 1, betaB1 = 1, betaB2 = 10)
designSafeTwoProportions(na = 1,
                         nb = 1,
                         alpha = 0.1,
                         beta = 0.20,
                         delta = 0.6,
                         hyperParameterValues = hyperParameterValues,
                         alternativeRestriction = "none",
                         M = 75)

#restrict range of proportions for estimating nPlan in the control group
designSafeTwoProportions(na = 1,
                         nb = 1,
                         beta = 0.20,
                         delta = 0.3,
                         alternativeRestriction = "none",
                         M = 75,
                         simThetaAMin = 0.1, simThetaAMax = 0.2)

</code></pre>


</div>