<div class="container">

<table style="width: 100%;"><tr>
<td>plotTune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize parameter tuning for minNumMutations and minNumSeqMutations</h2>

<h3>Description</h3>

<p>Visualize results from minNumMutationsTune and minNumSeqMutationsTune
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotTune(
  tuneMtx,
  thresh,
  criterion = c("5mer", "3mer", "1mer", "3mer+1mer", "measured", "inferred"),
  pchs = 1,
  ltys = 2,
  cols = 1,
  plotLegend = TRUE,
  legendPos = "topright",
  legendHoriz = FALSE,
  legendCex = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tuneMtx</code></td>
<td>
<p>a <code>matrix</code> or a <code>list</code> of matrices produced by either 
minNumMutationsTune or minNumSeqMutationsTune.
In the case of a list, it is assumed that each matrix corresponds
to a sample and that all matrices in the list were produced using
the same set of trial values of <code>minNumMutations</code> or 
<code>minNumSeqMutations</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>a number or a vector of indicating the value or the range of values
of <code>minNumMutations</code> or <code>minNumSeqMutations</code> to plot. 
Should correspond to the columns of <code>tuneMtx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>one of <code>"5mer"</code>, <code>"3mer"</code>, <code>"1mer"</code>, or <code>"3mer+1mer"</code> 
(for <code>tuneMtx</code> produced by minNumMutationsTune), or either 
<code>"measured"</code> or <code>"inferred"</code> (for <code>tuneMtx</code> produced by 
minNumSeqMutationsTune).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchs</code></td>
<td>
<p>point types to pass on to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltys</code></td>
<td>
<p>line types to pass on to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>colors to pass on to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotLegend</code></td>
<td>
<p>whether to plot legend. Default is <code>TRUE</code>. Only applicable 
if <code>tuneMtx</code> is a named list with names of the matrices 
corresponding to the names of the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPos</code></td>
<td>
<p>position of legend to pass on to legend. Can be either a
numeric vector specifying x-y coordinates, or one of 
<code>"topright"</code>, <code>"center"</code>, etc. Default is <code>"topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendHoriz</code></td>
<td>
<p>whether to make legend horizontal. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendCex</code></td>
<td>
<p>numeric values by which legend should be magnified relative to 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>tuneMtx</code> produced by minNumMutationsTune, for each sample, depending on
<code>criterion</code>, the numbers of 5-mers for which substitution rates are directly computed
(<code>"5mer"</code>), inferred based on inner 3-mers (<code>"3mer"</code>), inferred based on 
central 1-mers (<code>"1mer"</code>), or inferred based on inner 3-mers and central 1-mers
(<code>"3mer+1mer"</code>) are plotted on the y-axis against values of <code>minNumMutations</code> 
on the x-axis.
</p>
<p>For <code>tuneMtx</code> produced by minNumSeqMutationsTune, for each sample, depending on
<code>criterion</code>, the numbers of 5-mers for which mutability rates are directly measured
(<code>"measured"</code>) or inferred (<code>"inferred"</code>) are plotted on the y-axis against values
of <code>minNumSeqMutations</code> on the x-axis.
</p>
<p>Note that legends will be plotted only if <code>tuneMtx</code> is a supplied as a named <code>list</code>
of matrices, ideally with names of each <code>matrix</code> corresponding to those of the samples 
based on which the matrices were produced, even if <code>plotLegend=TRUE</code>.
</p>


<h3>See Also</h3>

<p>See minNumMutationsTune and minNumSeqMutationsTune for generating 
<code>tuneMtx</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Subset example data to one isotype and 200 sequences
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call == "IGHA")
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=50)

tuneMtx = list()
for (i in 1:length(unique(db$sample_id))) {
    # Get data corresponding to current sample
    curDb = db[db[["sample_id"]] == unique(db[["sample_id"]])[i], ]
    
    # Count the number of mutations per 5-mer
    subCount = createSubstitutionMatrix(db=curDb, model="s", 
                                        sequenceColumn="sequence_alignment",
                                        germlineColumn="germline_alignment_d_mask",
                                        vCallColumn="v_call",
                                        multipleMutation="independent",
                                        returnModel="5mer", numMutationsOnly=TRUE)
    
    # Tune over minNumMutations = 5..50
    subTune = minNumMutationsTune(subCount, seq(from=5, to=50, by=5))
    
    tuneMtx = c(tuneMtx, list(subTune))
}

# Name tuneMtx after sample names 
names(tuneMtx) = unique(db[["sample_id"]])

# plot with legend for both samples for a subset of minNumMutations values
plotTune(tuneMtx, thresh=c(5, 15, 25, 40), criterion="3mer",
         pchs=16:17, ltys=1:2, cols=2:3, 
         plotLegend=TRUE, legendPos=c(25, 30))

# plot for only 1 sample for all the minNumMutations values (no legend)
plotTune(tuneMtx[[1]], thresh=seq(from=5, to=50, by=5), criterion="3mer")


</code></pre>


</div>