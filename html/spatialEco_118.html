<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.time.series</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth Raster Time-series</h2>

<h3>Description</h3>

<p>Smooths pixel-level data in raster time-series and can impute 
missing (NA) values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth.time.series(x, f = 0.8, smooth.data = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A terra SpatRaster with &gt; 8 layers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Smoothing parameter (see loess span argument)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.data</code></td>
<td>
<p>(FALSE/TRUE) Smooth all of the data or just impute NA values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to terra::app (for 
writing results to disk)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses a LOESS regression to smooth the time-series. If the data is 
smoothed, (using the smooth.data = TRUE argument) it will be entirely replaced by  
a loess estimate of the time-series (estimated distribution at the pixel-level). 
Alternately, with smooth.data = FALSE, the function can be used to impute missing 
pixel data (NA) in raster time-series (stacks/bricks).
The results can dramatically be effected by the choice of the smoothing 
parameter (f) so caution is warranted and the effect of this parameter tested.
</p>


<h3>Value</h3>

<p>A terra SpatRaster containing imputed or smoothed data.
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt;
</p>


<h3>See Also</h3>

<p><code>loess</code> for details on the loess regression
</p>
<p><code>app</code> for details on additional (...) arguments
</p>
<p><code>impute.loess</code> for details on imputation model
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(terra)
  random.raster &lt;- function(rows=50, cols=50, l=20, min=0, max=1){ 
    do.call(c, replicate(l, rast(matrix(runif(rows * cols, min, max), 
	        rows , cols))))
  }
r &lt;- random.raster()

#### Smooth time-series using raster stack/brick 
r.smooth &lt;- smooth.time.series(r, f = 0.4, smooth.data = TRUE)  

# extract pixel 100 for plotting
y &lt;- as.numeric(r[100])
ys &lt;- as.numeric(r.smooth[100])

# plot results	
plot(y, type="l")
  lines(ys, col="red")
    legend("bottomright", legend=c("original","smoothed"),
         lty=c(1,1), col=c("black","red"))	

</code></pre>


</div>