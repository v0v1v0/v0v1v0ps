<div class="container">

<table style="width: 100%;"><tr>
<td>Iest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the I-function</h2>

<h3>Description</h3>

<p>Estimates the summary function <code class="reqn">I(r)</code> for a multitype point pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  Iest(X, ..., eps=NULL, r=NULL, breaks=NULL, correction=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The observed point pattern, 
from which an estimate of <code class="reqn">I(r)</code> will be computed.
An object of class <code>"ppp"</code>, or data
in any format acceptable to <code>as.ppp()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>the resolution of the discrete approximation to Euclidean distance
(see below). There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Optional. Numeric vector of values for the argument <code class="reqn">r</code>
at which <code class="reqn">I(r)</code> 
should be evaluated. There is a sensible default.
First-time users are strongly advised not to specify this argument.
See below for important conditions on <code>r</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>This argument is for internal use only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>Optional. Vector of character strings specifying the edge correction(s)
to be used by <code>Jest</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">I</code> function 
summarises the dependence between types in a multitype point process
(Van Lieshout and Baddeley, 1999)
It is based on the concept of the <code class="reqn">J</code> function for an
unmarked point process (Van Lieshout and Baddeley, 1996).
See <code>Jest</code> for information about the <code class="reqn">J</code> function.
</p>
<p>The <code class="reqn">I</code> function is defined as 
</p>
<p style="text-align: center;"><code class="reqn"> %
    I(r) = \sum_{i=1}^m p_i J_{ii}(r) %
    - J_{\bullet\bullet}(r)</code>
</p>

<p>where <code class="reqn">J_{\bullet\bullet}</code> is the <code class="reqn">J</code> function for
the entire point process ignoring the marks, while 
<code class="reqn">J_{ii}</code> is the <code class="reqn">J</code> function for the
process consisting of points of type <code class="reqn">i</code> only,
and <code class="reqn">p_i</code> is the proportion of points which are of type <code class="reqn">i</code>.
</p>
<p>The <code class="reqn">I</code> function is designed to measure dependence between
points of different types, even if the points are
not Poisson. Let <code class="reqn">X</code> be a stationary multitype point process,
and write <code class="reqn">X_i</code> for the process of points of type <code class="reqn">i</code>.
If the processes <code class="reqn">X_i</code> are independent of each other,
then the <code class="reqn">I</code>-function is identically equal to <code class="reqn">0</code>. 
Deviations <code class="reqn">I(r) &lt; 1</code> or <code class="reqn">I(r) &gt; 1</code>
typically indicate negative and positive association, respectively,
between types.
See Van Lieshout and Baddeley (1999)
for further information.
</p>
<p>An estimate of <code class="reqn">I</code> derived from a multitype spatial point pattern dataset
can be used in exploratory data analysis and formal inference
about the pattern. The estimate of <code class="reqn">I(r)</code> is compared against the 
constant function <code class="reqn">0</code>.
Deviations <code class="reqn">I(r) &lt; 1</code> or <code class="reqn">I(r) &gt; 1</code>
may suggest negative and positive association, respectively.
</p>
<p>This algorithm estimates the <code class="reqn">I</code>-function
from the multitype point pattern <code>X</code>.
It assumes that <code>X</code> can be treated
as a realisation of a stationary (spatially homogeneous) 
random spatial marked point process in the plane, observed through
a bounded window. 
</p>
<p>The argument <code>X</code> is interpreted as a point pattern object 
(of class <code>"ppp"</code>, see <code>ppp.object</code>) and can
be supplied in any of the formats recognised by
<code>as.ppp()</code>. It must be a multitype point pattern
(it must have a <code>marks</code> vector which is a <code>factor</code>).
</p>
<p>The function <code>Jest</code> is called to 
compute estimates of the <code class="reqn">J</code> functions in the formula above.
In fact three different estimates are computed
using different edge corrections. See <code>Jest</code> for
information.
</p>


<h3>Value</h3>

<p>An object of class <code>"fv"</code>, see <code>fv.object</code>,
which can be plotted directly using <code>plot.fv</code>.
</p>
<p>Essentially a data frame containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>the vector of values of the argument <code class="reqn">r</code> 
at which the function <code class="reqn">I</code> has been  estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>the “reduced sample” or “border correction”
estimator of <code class="reqn">I(r)</code> computed from
the border-corrected estimates of <code class="reqn">J</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km</code></td>
<td>
<p>the spatial Kaplan-Meier estimator of <code class="reqn">I(r)</code> computed from
the Kaplan-Meier estimates of <code class="reqn">J</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>han</code></td>
<td>
<p>the Hanisch-style estimator of <code class="reqn">I(r)</code> computed from
the Hanisch-style estimates of <code class="reqn">J</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>un</code></td>
<td>
<p>the uncorrected estimate of <code class="reqn">I(r)</code>
computed from the uncorrected estimates of <code class="reqn">J</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theo</code></td>
<td>
<p>the theoretical value of <code class="reqn">I(r)</code>
for a stationary Poisson process: identically equal to <code class="reqn">0</code>
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Sizeable amounts of memory may be needed during the calculation.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>References</h3>

<p>Van Lieshout, M.N.M. and Baddeley, A.J. (1996)
A nonparametric measure of spatial interaction in point patterns.
<em>Statistica Neerlandica</em> <b>50</b>, 344–361.
</p>
<p>Van Lieshout, M.N.M. and Baddeley, A.J. (1999)
Indices of dependence between types in multivariate point patterns.
<em>Scandinavian Journal of Statistics</em> <b>26</b>, 511–532.
</p>


<h3>See Also</h3>

<p><code>Jest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   Ic &lt;- Iest(amacrine)
   plot(Ic, main="Amacrine Cells data")
   # values are below I= 0, suggesting negative association
   # between 'on' and 'off' cells.
</code></pre>


</div>