<div class="container">

<table style="width: 100%;"><tr>
<td>psp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tool to build the basis matrix and the penalty matrix of P-splines.</h2>

<h3>Description</h3>

<p><b>psp</b> builds the basis matrix and the penalty matrix to approximate a smooth function using a P-spline.</p>


<h3>Usage</h3>

<pre><code class="language-R">psp(xx, lambda, b.order, nknots, diff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>
<p>the explanatory variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>an optional positive value that represents the smoothing parameter value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.order</code></td>
<td>
<p>an optional positive integer that specifies the degree of the B-spline basis matrix. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknots</code></td>
<td>
<p>an optional positive integer that represents the number of internal knots of the P-spline. Default is <code class="reqn">m=[n^{\frac{1}{3}}]+3</code>.
The knots are located at the quantiles of order <code class="reqn">0/(m-1),1/(m-1),\ldots,(m-1)/(m-1)</code> of xx.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>an optional positive integer that specifies the order of the difference penalty term. Default is 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>
<p>the explanatory variable <code class="reqn">xx</code> with the following attributes: set of knots, B-spline basis matrix, penalty matrix
and  smoothing parameter (if it was specified).</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Luis Hernando Vanegas &lt;hvanegasp@gmail.com&gt; and Gilberto A. Paula</p>


<h3>References</h3>

<p>Eilers P.H.C. and Marx B.D. (1996). Flexible smoothing with B-splines and penalties. Statistical Science. 11, 89-121.</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 300
t &lt;- sort(round(runif(n),digits=2))

t2 &lt;- psp(t, diff=3)
N &lt;- attr(t2, "N") ## B-spline basis matrix
M &lt;- attr(t2, "K") ## Penalty Matrix
knots &lt;- attr(t2,"knots") ## Set of knots
</code></pre>


</div>