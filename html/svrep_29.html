<div class="container">

<table style="width: 100%;"><tr>
<td>make_ppswor_approx_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a quadratic form's matrix to represent a variance estimator
for PPSWOR designs, based on commonly-used approximations</h2>

<h3>Description</h3>

<p>Several variance estimators for designs that use
unequal probability sampling without replacement (i.e., PPSWOR),
variance estimation tends to be more accurate
when using an approximation estimator that uses the first-order
inclusion probabilities (i.e., the basic sampling weights)
and ignores the joint inclusion probabilities.
This function returns the matrix of the quadratic form used
to represent such variance estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_ppswor_approx_matrix(probs, method = "Deville-1")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A vector of first-order inclusion probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string specifying the approximation method to use.
See the "Details" section below.
Options include:
</p>

<ul>
<li>
<p> "Deville-1"
</p>
</li>
<li>
<p> "Deville-2"
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These variance estimators have been shown to be effective
for designs that use a fixed sample size with a high-entropy sampling method.
This includes most PPSWOR sampling methods,
but unequal-probability systematic sampling is an important exception.
</p>
<p>These variance estimators generally take the following form:
</p>
<p style="text-align: center;"><code class="reqn">
\hat{v}(\hat{Y}) = \sum_{i=1}^{n} c_i (\breve{y}_i - \frac{1}{\sum_{i=k}^{n}c_k}\sum_{k=1}^{n}c_k \breve{y}_k)^2
</code>
</p>

<p>where <code class="reqn">\breve{y}_i = y_i/\pi_i</code> is the weighted value of the the variable of interest,
and <code class="reqn">c_i</code> are constants that depend on the approximation method used.  <br><br>
The matrix of the quadratic form, denoted <code class="reqn">\Sigma</code>, has
its <code class="reqn">ij</code>-th entry defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">
  \sigma_{ii} = c_i (1 - \frac{c_i}{\sum_{k=1}^{n}c_k}) \textit{ when } i = j \\
  \sigma_{ij}=\frac{-c_i c_j}{\sum_{k=1}^{n}c_k} \textit{ when } i \neq j \\
</code>
</p>

<p>When <code class="reqn">\pi_{i} = 1</code> for every unit, then <code class="reqn">\sigma_{ij}=0</code> for all <code class="reqn">i,j</code>.
If there is only one sampling unit, then <code class="reqn">\sigma_{11}=0</code>; that is, the unit is treated as if it was sampled with certainty.
</p>
<p>The constants <code class="reqn">c_i</code> are defined for each approximation method as follows,
with the names taken directly from Matei and Tillé (2005).
</p>

<ul>
<li> <p><strong>"Deville-1"</strong>:
</p>
<p style="text-align: center;"><code class="reqn">c_i=\left(1-\pi_i\right) \frac{n}{n-1}</code>
</p>

</li>
<li> <p><strong>"Deville-2"</strong>:
</p>
<p style="text-align: center;"><code class="reqn">c_i = (1-\pi_i) \left[1 - \sum_{k=1}^{n} \left(\frac{1-\pi_k}{\sum_{k=1}^{n}(1-\pi_k)}\right)^2 \right]^{-1}</code>
</p>

</li>
</ul>
<p>Both of the approximations <strong>"Deville-1"</strong> and <strong>"Deville-2"</strong> were shown
in the simulation studies of Matei and Tillé (2005) to perform much better
in terms of MSE compared to the strictly-unbiased
Horvitz-Thompson and Yates-Grundy variance estimators.
In the case of simple random sampling without replacement (SRSWOR),
these estimators are identical to the usual Horvitz-Thompson variance estimator.
</p>


<h3>Value</h3>

<p>A symmetric matrix whose dimension matches the length of <code>probs</code>.
</p>


<h3>References</h3>

<p>Matei, Alina, and Yves Tillé. 2005.
“Evaluation of Variance Approximations and Estimators
in Maximum Entropy Sampling with Unequal Probability and Fixed Sample Size.”
Journal of Official Statistics 21(4):543–70.
</p>


</div>