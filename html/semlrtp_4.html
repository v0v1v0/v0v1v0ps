<div class="container">

<table style="width: 100%;"><tr>
<td>lrtp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Ratio Test P-Values</h2>

<h3>Description</h3>

<p>Compute the likelihood ratio
test (LRT) <em>p</em>-values for free
parameters in
a <code>lavaan</code> output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lrtp(
  fit,
  op = c("~", "~~"),
  no_variances = TRUE,
  no_error_variances = TRUE,
  no_error_covariances = TRUE,
  se_keep_bootstrap = FALSE,
  LRT_method = "default",
  scaled.shifted = TRUE,
  fallback_method = "satorra.2000",
  progress = TRUE,
  parallel = FALSE,
  ncores = parallel::detectCores(logical = FALSE) - 1,
  load_balancing = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A <code>lavaan</code>-class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>A character vector of
<code>lavaan</code> model syntax operators.
Free parameters of these operators
will be included, unless excluded
by other arguments. Default is
<code>c("~", "~~")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_variances</code></td>
<td>
<p>Logical. If
<code>TRUE</code>, the default, then all
free variances are excluded.
(Error variances are handled
by <code>no_error_variances</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_error_variances</code></td>
<td>
<p>Logical,
If <code>TRUE</code>, the default, then all
free error variances are excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_error_covariances</code></td>
<td>
<p>Logical.
If <code>TRUE</code>, the default, then all
free error covariances are excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_keep_bootstrap</code></td>
<td>
<p>Logical.
If <code>TRUE</code> and <code>fit</code> used
bootstrapping standard error
(with <code>se = "bootstrap"</code>), bootstrapping
will also be use in fitting the
restricted model. If <code>FALSE</code>, the
default, then <code>se</code> will be set
to <code>"standard"</code> if it is <code>"bootstrap"</code>
in <code>fit</code>, to speed up the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRT_method</code></td>
<td>
<p>String. Passed to
the <code>method</code> argument of
<code>lavaan::lavTestLRT()</code>. Default is
<code>"default"</code>, and let
<code>lavaan::lavTestLRT()</code> decide the
method based on <code>fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled.shifted</code></td>
<td>
<p>Logical.
Used when the method used in
<code>lavaan::lavTestLRT()</code> is
<code>"satorra.2000"</code>. Default is
<code>TRUE</code> and a scaled and shifted
test statistic is used, the same
default of <code>lavaan::lavTestLRT()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fallback_method</code></td>
<td>
<p>The default
method of <code>lavaan::lavTestLRT()</code>,
<code>"satorra.bentler.2001"</code>,
may sometimes fail. If failed,
this function will call
<code>lavaan::lavTestLRT()</code>
again using <code>fallback_method</code>. which
is <code>"satorra.2000"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
the default, a progress bar will be
displayed to show the progress (using
the <code>pbapply</code> package).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
parallel processing will be used to
compute the LRT <em>p</em>-values for
selected parameters. Default is
<code>FALSE</code>. Set it to <code>TRUE</code> if the
number of selected parameters is
large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Integer. The number of
CPU cores to use if <code>parallel</code> is
<code>TRUE</code>. Default is the number of
physical cores (determined by
<code>parallel::detectCores()</code>) minus 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>load_balancing</code></td>
<td>
<p>Logical. If
<code>TRUE</code>, the default, and <code>parallel</code>
is <code>TRUE</code>, then load balancing will
be used. May shorten the total
processing time if the time to
compute LRT <em>p</em>-values vary a lot
across parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to be
passed to <code>lavaan::parameterEstimates()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It finds free parameters in a
<code>lavaan</code>-class object, computes the
likelihood ratio test (LRT) <em>p</em>-value
for each of them when fixed to zero,
and returns a parameter estimates table
with the LRT <em>p</em>-values
included.
</p>
<p>By default, it only computes LRT
<em>p</em>-values for regression paths
and covariances, except for
error covariances. This default
can be overridden using arguments
such as <code>op</code>, <code>no_variances</code>,
<code>no_error_variances</code>,
and <code>no_error_covariances</code>.
</p>


<h4>Technical Details</h4>

<p>It first identify the parameters
to be processed, and then call
<code>lrt()</code> on each of them.
Please refer to
<a href="https://sfcheung.github.io/semlrtp/articles/internal_workflow.html">https://sfcheung.github.io/semlrtp/articles/internal_workflow.html</a>
for the internal workflow.
</p>



<h3>Value</h3>

<p>An <code>lrt</code>-class object, which is a
data-frame-like object similar to the
output of <code>lavaan::parameterEstimates()</code>,
with a column <code>LRTp</code> for the LRT
<em>p</em>-values, as well as other columns
such as the chi-square difference in
the test. it has a print method,
<code>print.lrtp()</code>.
</p>


<h3>Author(s)</h3>

<p>Shu Fai Cheung <a href="https://orcid.org/0000-0002-9871-9448">https://orcid.org/0000-0002-9871-9448</a>
</p>


<h3>See Also</h3>

<p><code>print.lrtp()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lavaan)
data(data_sem16)
mod &lt;-
"
f1 =~ x1 + x2 + x3
f2 =~ x4 + x5 + x6
f3 =~ x7 + x8 + x9
f4 =~ x10 + x11 + x12
f2 ~~ f1
f3 ~ f1 + f2
f4 ~ f3
"
fit &lt;- sem(mod, data_sem16)
lrtp(fit)
lrtp(fit, op = "~")

</code></pre>


</div>