<div class="container">

<table style="width: 100%;"><tr>
<td>avm.ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap Confidence Intervals for Linear Regression Error Variances</h2>

<h3>Description</h3>

<p>Uses bootstrap methods to compute approximate confidence intervals for
error variances in a heteroskedastic linear regression model based on
an auxiliary linear variance model (ALVM) or auxiliary nonlinear variance
model (ANLVM).
</p>


<h3>Usage</h3>

<pre><code class="language-R">avm.ci(
  object,
  bootobject = NULL,
  bootavmobject = NULL,
  jackobject = NULL,
  bootCImethod = c("pct", "bca", "stdnorm"),
  bootsampmethod = c("pairs", "wild"),
  Bextra = 500L,
  Brequired = 1000L,
  conf.level = 0.95,
  expand = TRUE,
  retune = FALSE,
  resfunc = c("identity", "hccme"),
  qtype = 6,
  rm_on_constraint = TRUE,
  rm_nonconverged = TRUE,
  jackknife_point = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>"alvm.fit"</code> or of class
<code>"anlvm.fit"</code>, containing information on a fitted ALVM or ANLVM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootobject</code></td>
<td>
<p>An object of class <code>"bootlm"</code>, containing information
on a set of <code class="reqn">B</code> bootstrapped versions of a linear regression model,
obtained by a nonparametric bootstrap method suitable for heteroskedastic
linear models. If set to <code>NULL</code> (the default), it is generated by
calling <code>bootlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootavmobject</code></td>
<td>
<p>An object of class <code>"bootavm"</code>, containing
information on an ALVM or ANLVM fit to <code class="reqn">B</code> bootstrapped linear
regression models. If set to <code>NULL</code> (the default), it is generated
by calling the non-exported function <code>bootavm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackobject</code></td>
<td>
<p>An object of class <code>"jackavm"</code>, containing
information on ALVMs or ANVLMs fit to jackknife versions of a linear
regression model. If set to <code>NULL</code> (the default), it is generated
by calling the non-exported function <code>jackavm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootCImethod</code></td>
<td>
<p>A character specifying the method to use when computing
the approximate bootstrap confidence interval. The default, <code>"pct"</code>,
corresponds to the percentile interval. <code>"bca"</code> corresponds to the
Bias-Corrected and accelerated (BCa) modification of the percentile
interval. <code>"stdnorm"</code> corresponds to a naive standard normal
interval with bootstrap standard error estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootsampmethod</code></td>
<td>
<p>A character specifying the method to use for
generating nonparametric bootstrap linear regression models. Corresponds
to the <code>sampmethod</code> argument of <code>bootlm</code> and defaults
to <code>"pairs"</code>. <strong>Warning:</strong> in simulations, bootstrap intervals
computed using the wild bootstrap have shown very poor coverage
probabilities. Ignored unless <code>bootobject</code> is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bextra</code></td>
<td>
<p>An integer indicating the maximum number of additional
bootstrap models that should be fitted in an attempt to obtain
<code>Brequired</code> appropriate sets of bootstrap variance estimates, as
explained above under <code>Brequired</code>. Defaults to <code>500L</code>.
Ignored if <code>rm_on_constraint</code> is set to <code>FALSE</code> (for an ALVM)
or if <code>rm_nonconverged</code> is set to <code>FALSE</code> (for an ANLVM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Brequired</code></td>
<td>
<p>An integer indicating the number of bootstrap regression
models that should be used to compute the bootstrap confidence intervals.
The default behaviour is to base the interval estimates only on bootstrap
ALVM variance estimates that are not on the constraint boundary or on
bootstrap ANLVMs where the estimation algorithm converged. Consequently,
if this is not the case for all of the first <code>Brequired</code> bootstrap
models, additional bootstrap models are used (up to a maximum of
<code>Bextra</code>). Defaults to <code>1000L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>A double representing the confidence level <code class="reqn">1-\alpha</code>;
must be between 0 and 1. Defaults to <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand</code></td>
<td>
<p>A logical specifying whether to implement the expansion
technique described in Hesterberg (2015).
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retune</code></td>
<td>
<p>A logical specifying whether to re-tune hyperparameters and
re-select features each time an ALVM or (in the case of feature
selection) ANLVM is fit to a bootstrapped regression model. If
<code>FALSE</code> (the default), the hyperparameter value and selected
features from the ALVM fit to the original model are reused in every
bootstrap model. Setting to <code>TRUE</code> is more theoretically sound but
increases computation time substantially.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resfunc</code></td>
<td>
<p>Either a character naming a function to call to apply a
transformation to the Ordinary Least Squares residuals, or a function
to apply for the same purpose. This argument is ignored if
<code>sampmethod</code> is <code>"pairs"</code>. The only two character values
accepted are <code>"identity"</code>, in which case no transformation is
applied to the residuals, and <code>"hccme"</code>, in which case the
transformation corresponds to a heteroskedasticity-consistent
covariance matrix estimator calculated from <code>hccme</code>. If
<code>resfunc</code> is a function, it is assumed that its first argument
is the numeric vector of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtype</code></td>
<td>
<p>A numeric corresponding to the <code>type</code> argument of
<code>quantile</code>. Defaults to <code>6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm_on_constraint</code></td>
<td>
<p>A logical specifying whether to exclude
bootstrapped ALVMs from the interval estimation method where the ALVM
parameter estimate falls on the constraint boundary. Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm_nonconverged</code></td>
<td>
<p>A logical specifying whether to exclude bootstrapped
ANLVMs from the interval estimation method where the optimisation
algorithm used in quasi-likelihood estimation of the ANLVM parameter did
not converge. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackknife_point</code></td>
<td>
<p>A logical specifying whether to replace the point
estimates of the error variances <code class="reqn">\omega</code> with jackknife estimates
based only on the leave-one-out auxiliary models where the parameter
estimates do not lie on the constraint boundary (in the ALVM case) or
where the quasi-likelihood estimation algorithm converged (in the ANLVM
case). Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass to non-exported helper functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code class="reqn">B</code> resampled versions of the original linear regression model
(which can be accessed using <code>object$ols</code>) are generated using a
nonparametric bootstrap method that is suitable for heteroskedastic
linear regression models, namely either the pairs bootstrap or the wild
bootstrap (bootstrapping residuals is <em>not</em> suitable). Depending on
the class of <code>object</code>, either an ALVM or an ANLVM is fit to each of
the bootstrapped regression models. The distribution of the <code class="reqn">B</code>
bootstrap estimates of each error variance <code class="reqn">\omega_i</code>,
<code class="reqn">i=1,2,\ldots,n</code>, is used to construct an approximate confidence
interval for <code class="reqn">\omega_i</code>. This is done using one of three methods.
The first is the percentile interval, which simply takes the empirical
<code class="reqn">\alpha/2</code> and <code class="reqn">1-\alpha/2</code> quantiles of the <code class="reqn">i</code>th bootstrap
variance estimates. The second is the Bias-Corrected and accelerated
(BCa) method as described in Efron and Tibshirani (1993),
which is intended to improve on the percentile interval (although
simulations have not found it to yield better coverage probabilities).
The third is the naive standard normal interval, which takes
<code class="reqn">\hat{\omega}_i \pm z_{1-\alpha/2} \widehat{\mathrm{SE}}</code>, where
<code class="reqn">\widehat{\mathrm{SE}}</code> is the standard deviation of the <code class="reqn">B</code>
bootstrap estimates of <code class="reqn">\omega_i</code>. By default, the expansion
technique described in Hesterberg (2015) is
also applied; evidence from simulations suggests that this <em>does</em>
improve coverage probabilities.
</p>
<p>Technically, the hyperparameters of the ALVM, such as <code class="reqn">\lambda</code> (for a
penalised polynomial or thin-plate spline model) or <code class="reqn">n_c</code> (for a
clustering model) should be re-tuned every time the ALVM is fitted to
another bootstrapped regression model. However, due to the computational
cost, this is not done by <code>avm.ci</code> unless <code>retune</code> is set to
<code>TRUE</code>.
</p>
<p>When obtained from ALVMs, bootstrap estimates of <code class="reqn">\omega_i</code> that fall on
the constraint boundary (i.e., are estimated to be near 0) are ignored
by default; there is an attempt to obtain <code>Brequired</code> bootstrap
estimates of each <code class="reqn">\omega_i</code> that do not fall on the constraint
boundary. This fine-tuning can be turned off by setting the
<code>rm_onconstraint</code> argument to <code>FALSE</code>; the amount of effort
put into obtaining non-boundary estimates is controlled using the
<code>Bextra</code> argument. When ANLVMs are used, the default behaviour is to
try to obtain <code>Brequired</code> bootstrap estimates of <code class="reqn">\omega</code> where
the Gauss-Newton algorithm applied for quasi-likelihood estimation
has converged, and ignore estimates obtained from non-convergent cases.
This behaviour can be toggled using the <code>rm_nonconverged</code> argument.
</p>


<h3>Value</h3>

<p>An object of class <code>"avm.ci"</code>, containing the following:
</p>

<ul>
<li> <p><code>climits</code>, an <code class="reqn">n\times 2</code> matrix with lower confidence
limits in the first column and upper confidence limits in the second
</p>
</li>
<li> <p><code>var.est</code>, a vector of length <code class="reqn">n</code> of point estimates
<code class="reqn">\hat{\omega}</code> of the error variances. This is the same vector
passed within <code>object</code>, unless <code>jackknife_point</code> is
<code>TRUE</code>.
</p>
</li>
<li> <p><code>conf.level</code>, corresponding to the eponymous argument
</p>
</li>
<li> <p><code>bootCImethod</code>, corresponding to the eponymous argument
</p>
</li>
<li> <p><code>bootsampmethod</code>, corresponding to the eponymous argument or
otherwise extracted from <code>bootobject</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Efron B, Tibshirani RJ (1993).
<em>An Introduction to the Bootstrap</em>.
Springer Science+Business Media, Dordrecht.<br><br> Hesterberg T (2015).
“What Teachers Should Know about the Bootstrap: Resampling in the Undergraduate Statistics Curriculum.”
</p>


<h3>See Also</h3>

<p><code>alvm.fit</code>, <code>anlvm.fit</code>,
Efron and Tibshirani (1993)
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
myalvm &lt;- alvm.fit(mtcars_lm, model = "cluster")
# Brequired would of course not be so small in practice
ci.alvm &lt;- avm.ci(myalvm, Brequired = 5)
</code></pre>


</div>