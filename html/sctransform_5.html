<div class="container">

<table style="width: 100%;"><tr>
<td>diff_mean_test_conserved</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find differentially expressed genes that are conserved across samples</h2>

<h3>Description</h3>

<p>Find differentially expressed genes that are conserved across samples
</p>


<h3>Usage</h3>

<pre><code class="language-R">diff_mean_test_conserved(
  y,
  group_labels,
  sample_labels,
  balanced = TRUE,
  compare = "each_vs_rest",
  pval_th = 1e-04,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix of counts; must be (or inherit from) class dgCMatrix; genes are rows,
cells are columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_labels</code></td>
<td>
<p>The group labels (i.e. clusters or time points); 
will be converted to factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_labels</code></td>
<td>
<p>The sample labels; will be converted to factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balanced</code></td>
<td>
<p>Boolean, see details for explanation; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compare</code></td>
<td>
<p>Specifies which groups to compare, see details; currently only 'each_vs_rest' 
(the default) is supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_th</code></td>
<td>
<p>P-value threshold used to call a gene differentially expressed when summarizing 
the tests per gene</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to diff_mean_test</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data frame of results
</p>


<h3>Details</h3>

<p>This function calls diff_mean_test repeatedly and aggregates the results per group and gene.
</p>
<p>If balanced is TRUE (the default), it is assumed that each sample spans multiple groups, 
as would be the case when merging or integrating samples from the same tissue followed by 
clustering. Here the group labels would be the clusters and cluster markers would have support
in each sample.
</p>
<p>If balanced is FALSE, an unbalanced design is assumed where each sample contributes to one
group. An example is a time series experiment where some samples are taken from time point 
1 while other samples are taken from time point 2. The time point would be the group label
and the goal would be to identify differentially expressed genes between time points that
are supported by many between-sample comparisons.
</p>
<p>Output columns:
</p>

<dl>
<dt>group1</dt>
<dd>
<p>Group label of the frist group of cells</p>
</dd>
<dt>group2</dt>
<dd>
<p>Group label of the second group of cells; currently fixed to 'rest'</p>
</dd>
<dt>gene</dt>
<dd>
<p>Gene name (from rownames of input matrix)</p>
</dd>
<dt>n_tests</dt>
<dd>
<p>The number of tests this gene participated in for this group</p>
</dd>
<dt>log2FC_min,median,max</dt>
<dd>
<p>Summary statistics for log2FC across the tests</p>
</dd>
<dt>mean1,2_median</dt>
<dd>
<p>Median of group mean across the tests</p>
</dd>
<dt>pval_max</dt>
<dd>
<p>Maximum of p-values across tests</p>
</dd>
<dt>de_tests</dt>
<dd>
<p>Number of tests that showed this gene having a log2FC going in the same
direction as log2FC_median and having a p-value &lt;= pval_th</p>
</dd>
</dl>
<p>The output is ordered by group1, -de_tests, -abs(log2FC_median), pval_max
</p>


<h3>Examples</h3>

<pre><code class="language-R">
clustering &lt;- 1:ncol(pbmc) %% 2
sample_id &lt;- 1:ncol(pbmc) %% 3
vst_out &lt;- vst(pbmc, return_corrected_umi = TRUE)
de_res &lt;- diff_mean_test_conserved(y = vst_out$umi_corrected, 
group_labels = clustering, sample_labels = sample_id)


</code></pre>


</div>