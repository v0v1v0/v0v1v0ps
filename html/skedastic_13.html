<div class="container">

<table style="width: 100%;"><tr>
<td>cook_weisberg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cook-Weisberg Score Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the score test of
Cook and Weisberg (1983) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cook_weisberg(
  mainlm,
  auxdesign = NA,
  hetfun = c("mult", "add", "logmult"),
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auxdesign</code></td>
<td>
<p>A <code>data.frame</code> or
<code>matrix</code> representing an auxiliary design matrix of
containing exogenous variables that (under alternative hypothesis) are
related to error variance, or a character "fitted.values" indicating
that the fitted <code class="reqn">\hat{y}_i</code> values from OLS should be used.
If set to <code>NA</code> (the default), the
design matrix of the original regression model is used. An intercept
is included in the auxiliary regression even if the first column of
<code>auxdesign</code> is not a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetfun</code></td>
<td>
<p>A character describing the form of <code class="reqn">w(\cdot)</code>, the error
variance function under the heteroskedastic alternative. Possible values
are <code>"mult"</code> (the default), corresponding to
<code class="reqn">w(Z_i,\lambda)=\exp\left\{\sum_{j=1}^{q}\lambda_j Z_{ij}\right\}</code>,
<code>"add"</code>, corresponding to
<code class="reqn">w(Z_i,\lambda)=\left(1+\sum_{j=1}^{q} \lambda_j Z_{ij}\right)^2</code>, and
<code>"logmult"</code>, corresponding to
<code class="reqn">w(Z_i,\lambda)=\exp\left\{\sum_{j=1}^{q}\lambda_j \log Z_{ij}\right\}</code>.
The multiplicative and log-multiplicative cases are considered in
Cook and Weisberg (1983); the additive case is discussed,
<em>inter alia</em>, by Griffiths and Surekha (1986).
Results for the additive and multiplicative models are identical for this
test. Partial matching is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Cook-Weisberg Score Test entails fitting an auxiliary
regression model in which the response variable is the vector of
standardised squared residuals <code class="reqn">e_i^2/\hat{\omega}</code> from the original
OLS model and the design matrix is some function of <code class="reqn">Z</code>, an
<code class="reqn">n \times q</code> matrix consisting of <code class="reqn">q</code> exogenous variables,
appended to a column of ones. The test statistic is half the residual sum
of squares from this auxiliary regression. Under the null hypothesis of
homoskedasticity, the distribution of the test statistic is
asymptotically chi-squared with <code class="reqn">q</code> degrees of freedom. The test is
right-tailed.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Cook RD, Weisberg S (1983).
“Diagnostics for Heteroscedasticity in Regression.”
<em>Biometrika</em>, <b>70</b>(1), 1–10.<br><br> Griffiths WE, Surekha K (1986).
“A Monte Carlo Evaluation of the Power of Some Tests for Heteroscedasticity.”
<em>Journal of Econometrics</em>, <b>31</b>(1), 219–231.
</p>


<h3>See Also</h3>

<p><code>car::ncvTest</code>, which implements the same
test. Calling <code>car::ncvTest</code> with <code>var.formula</code> argument omitted
is equivalent to calling <code>skedastic::cook_weisberg</code> with
<code>auxdesign = "fitted.values", hetfun = "additive"</code>. Calling
<code>car::ncvTest</code> with <code>var.formula = ~ X</code> (where <code>X</code> is the
design matrix of the linear model with the intercept column omitted) is
equivalent to calling <code>skedastic::cook_weisberg</code> with default
<code>auxdesign</code> and <code>hetfun</code> values. The
<code>hetfun = "multiplicative"</code> option has no equivalent in
<code>car::ncvTest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
cook_weisberg(mtcars_lm)
cook_weisberg(mtcars_lm, auxdesign = "fitted.values", hetfun = "logmult")

</code></pre>


</div>