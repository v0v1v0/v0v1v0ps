<div class="container">

<table style="width: 100%;"><tr>
<td>covmatrix.SSN2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a covariance matrix</h2>

<h3>Description</h3>

<p>Create a covariance matrix from a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ssn_lm'
covmatrix(object, newdata, cov_type, ...)

## S3 method for class 'ssn_glm'
covmatrix(object, newdata, cov_type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted model object (e.g., <code>ssn_lm()</code> or <code>ssn_glm()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>If omitted, the covariance matrix of
the observed data is returned. If provided, <code>newdata</code> is
a data frame or <code>sf</code> object that contains coordinate information
required to construct the covariance between <code>newdata</code> and
the observed data. If a data frame, <code>newdata</code>
must contain variables that represent coordinates having the same name as
the coordinates from the observed data used to fit <code>object</code>. If an
<code>sf</code> object, coordinates are obtained from the geometry of <code>newdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_type</code></td>
<td>
<p>The type of covariance matrix returned. If <code>newdata</code>
is omitted, the <code class="reqn">n \times n</code> covariance matrix of the observed
data is returned, where <code class="reqn">n</code> is the sample size used to fit <code>object</code>.
If <code>newdata</code> is provided and <code>cov_type</code> is <code>"pred.obs"</code> (the default),
the <code class="reqn">m \times n</code> covariance matrix of the predicted and observed data is returned,
where <code class="reqn">m</code> is the number of observations in the prediction data.
If <code>newdata</code> is provided and <code>cov_type</code> is <code>"obs.pred"</code>,
the <code class="reqn">n \times m</code> covariance matrix of the observed and prediction data is returned.
If <code>newdata</code> is provided and <code>cov_type</code> is <code>"pred.pred"</code>,
the <code class="reqn">m \times m</code> covariance matrix of the prediction data is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments. Not used (needed for generic consistency).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A covariance matrix (see <code>cov_type</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Copy the mf04p .ssn data to a local directory and read it into R
# When modeling with your .ssn object, you will load it using the relevant
# path to the .ssn data on your machine
copy_lsn_to_temp()
temp_path &lt;- paste0(tempdir(), "/MiddleFork04.ssn")
mf04p &lt;- ssn_import(temp_path, predpts = "CapeHorn", overwrite = TRUE)

ssn_mod &lt;- ssn_lm(
  formula = Summer_mn ~ ELEV_DEM,
  ssn.object = mf04p,
  tailup_type = "exponential",
  additive = "afvArea"
)
covmatrix(ssn_mod)
covmatrix(ssn_mod, "CapeHorn")
</code></pre>


</div>