<div class="container">

<table style="width: 100%;"><tr>
<td>SimSSMLinSDEFixed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Data from the
Linear Stochastic Differential Equation Model
using a State Space Model Parameterization
(Fixed Parameters)</h2>

<h3>Description</h3>

<p>This function simulates data from the
linear stochastic differential equation model
using a state space model parameterization.
It assumes that the parameters remain constant
across individuals and over time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimSSMLinSDEFixed(
  n,
  time,
  delta_t = 1,
  mu0,
  sigma0_l,
  iota,
  phi,
  sigma_l,
  nu,
  lambda,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_t</code></td>
<td>
<p>Numeric.
Time interval
(<code class="reqn">\Delta_t</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>Numeric vector.
Mean of initial latent variable values
(<code class="reqn">\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of initial latent variable values
(<code class="reqn">\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iota</code></td>
<td>
<p>Numeric vector.
An unobserved term that is constant over time
(<code class="reqn">\boldsymbol{\iota}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Numeric matrix.
The drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations
(<code class="reqn">\boldsymbol{\Phi}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(sigma))</code>)
of the covariance matrix of volatility
or randomness in the process
(<code class="reqn">\boldsymbol{\Sigma}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Numeric vector.
Vector of intercept values for the measurement model
(<code class="reqn">\boldsymbol{\nu}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Numeric matrix.
Factor loading matrix linking the latent variables
to the observed variables
(<code class="reqn">\boldsymbol{\Lambda}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_l</code></td>
<td>
<p>Numeric matrix.
Cholesky factorization (<code>t(chol(theta))</code>)
of the covariance matrix
of the measurement error
(<code class="reqn">\boldsymbol{\Theta}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Integer.
State space model type.
See Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Numeric matrix.
Matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Type 0</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{y}_{i, t}</code>,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
are random variables
and
<code class="reqn">\boldsymbol{\nu}</code>,
<code class="reqn">\boldsymbol{\Lambda}</code>,
and
<code class="reqn">\boldsymbol{\Theta}</code>
are model parameters.
<code class="reqn">\mathbf{y}_{i, t}</code>
represents a vector of observed random variables,
<code class="reqn">\boldsymbol{\eta}_{i, t}</code>
a vector of latent random variables,
and
<code class="reqn">\boldsymbol{\varepsilon}_{i, t}</code>
a vector of random measurement errors,
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>.
<code class="reqn">\boldsymbol{\nu}</code>
denotes a vector of intercepts,
<code class="reqn">\boldsymbol{\Lambda}</code>
a matrix of factor loadings,
and
<code class="reqn">\boldsymbol{\Theta}</code>
the covariance matrix of
<code class="reqn">\boldsymbol{\varepsilon}</code>.
</p>
<p>An alternative representation of the measurement error
is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \boldsymbol{\varepsilon}_{i, t}
    =
    \boldsymbol{\Theta}^{\frac{1}{2}}
    \mathbf{z}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \mathbf{z}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \mathbf{I}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\mathbf{z}_{i, t}</code> is a vector of
independent standard normal random variables and
<code class="reqn">
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)
    \left( \boldsymbol{\Theta}^{\frac{1}{2}} \right)^{\prime}
    =
    \boldsymbol{\Theta} .
  </code>
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\iota}</code>
is a term which is unobserved and constant over time,
<code class="reqn">\boldsymbol{\Phi}</code>
is the drift matrix
which represents the rate of change of the solution
in the absence of any random fluctuations,
<code class="reqn">\boldsymbol{\Sigma}</code>
is the matrix of volatility
or randomness in the process, and
<code class="reqn">\mathrm{d}\boldsymbol{W}</code>
is a Wiener process or Brownian motion,
which represents random fluctuations.
</p>



<h4>Type 1</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right) .
  </code>
</p>

<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t}
  </code>
</p>

<p>where
<code class="reqn">\mathbf{x}_{i, t}</code> represents a vector of covariates
at time <code class="reqn">t</code> and individual <code class="reqn">i</code>,
and <code class="reqn">\boldsymbol{\Gamma}</code> the coefficient matrix
linking the covariates to the latent variables.
</p>



<h4>Type 2</h4>

<p>The measurement model is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathbf{y}_{i, t}
    =
    \boldsymbol{\nu}
    +
    \boldsymbol{\Lambda}
    \boldsymbol{\eta}_{i, t}
    +
    \boldsymbol{\kappa}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\varepsilon}_{i, t},
    \quad
    \mathrm{with}
    \quad
    \boldsymbol{\varepsilon}_{i, t}
    \sim
    \mathcal{N}
    \left(
    \mathbf{0},
    \boldsymbol{\Theta}
    \right)
  </code>
</p>

<p>where
<code class="reqn">\boldsymbol{\kappa}</code> represents the coefficient matrix
linking the covariates to the observed variables.
</p>
<p>The dynamic structure is given by
</p>
<p style="text-align: center;"><code class="reqn">
    \mathrm{d} \boldsymbol{\eta}_{i, t}
    =
    \left(
    \boldsymbol{\iota}
    +
    \boldsymbol{\Phi}
    \boldsymbol{\eta}_{i, t}
    \right)
    \mathrm{d}t
    +
    \boldsymbol{\Gamma}
    \mathbf{x}_{i, t}
    +
    \boldsymbol{\Sigma}^{\frac{1}{2}}
    \mathrm{d}
    \mathbf{W}_{i, t} .
  </code>
</p>




<h4>State Space Parameterization</h4>

<p>The state space parameters
as a function of the linear stochastic differential equation model
parameters
are given by
</p>
<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\beta}_{\Delta t_{{l_{i}}}}
      =
      \exp{
        \left(
          \Delta t
          \boldsymbol{\Phi}
        \right)
      }
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \boldsymbol{\alpha}_{\Delta t_{{l_{i}}}}
      =
      \boldsymbol{\Phi}^{-1}
      \left(
        \boldsymbol{\beta} - \mathbf{I}_{p}
      \right)
      \boldsymbol{\iota}
  </code>
</p>

<p style="text-align: center;"><code class="reqn">
      \mathrm{vec}
      \left(
        \boldsymbol{\Psi}_{\Delta t_{{l_{i}}}}
      \right)
      =
      \left[
        \left(
          \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
        \right)
        +
        \left(
          \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
        \right)
      \right]
      \left[
        \exp
        \left(
          \left[
            \left(
              \boldsymbol{\Phi} \otimes \mathbf{I}_{p}
            \right)
            +
            \left(
              \mathbf{I}_{p} \otimes \boldsymbol{\Phi}
            \right)
          \right]
          \Delta t
        \right)
        -
        \mathbf{I}_{p \times p}
      \right]
      \mathrm{vec}
      \left(
        \boldsymbol{\Sigma}
      \right)
  </code>
</p>

<p>where <code class="reqn">p</code> is the number of latent variables and
<code class="reqn">\Delta t</code> is the time interval.
</p>



<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li>
</ul>
</li>
<li> <p><code>fun</code>: Function used.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303â€“332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>
<p>Chow, S.-M., Losardo, D., Park, J., &amp; Molenaar, P. C. M. (2023).
Continuous-time dynamic models:
Connections to structural equation models and other discrete-time models.
In R. H. Hoyle (Ed.),
Handbook of structural equation modeling (2nd ed.).
The Guilford Press.
</p>
<p>Harvey, A. C. (1990).
Forecasting, structural time series models and the Kalman filter.
Cambridge University Press.
<a href="https://doi.org/10.1017/cbo9781107049994">doi:10.1017/cbo9781107049994</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code>LinSDE2SSM()</code>,
<code>SimBetaN()</code>,
<code>SimPhiN()</code>,
<code>SimSSMFixed()</code>,
<code>SimSSMIVary()</code>,
<code>SimSSMLinGrowth()</code>,
<code>SimSSMLinGrowthIVary()</code>,
<code>SimSSMLinSDEIVary()</code>,
<code>SimSSMOUFixed()</code>,
<code>SimSSMOUIVary()</code>,
<code>SimSSMVARFixed()</code>,
<code>SimSSMVARIVary()</code>,
<code>TestPhi()</code>,
<code>TestStability()</code>,
<code>TestStationarity()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># prepare parameters
set.seed(42)
## number of individuals
n &lt;- 5
## time points
time &lt;- 50
delta_t &lt;- 0.10
## dynamic structure
p &lt;- 2
mu0 &lt;- c(-3.0, 1.5)
sigma0 &lt;- 0.001 * diag(p)
sigma0_l &lt;- t(chol(sigma0))
iota &lt;- c(0.317, 0.230)
phi &lt;- matrix(
  data = c(
    -0.10,
    0.05,
    0.05,
    -0.10
  ),
  nrow = p
)
sigma &lt;- matrix(
  data = c(
    2.79,
    0.06,
    0.06,
    3.27
  ),
  nrow = p
)
sigma_l &lt;- t(chol(sigma))
## measurement model
k &lt;- 2
nu &lt;- rep(x = 0, times = k)
lambda &lt;- diag(k)
theta &lt;- 0.001 * diag(k)
theta_l &lt;- t(chol(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- diag(x = 0.10, nrow = p, ncol = j)
kappa &lt;- diag(x = 0.10, nrow = k, ncol = j)

# Type 0
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinSDEFixed(
  n = n,
  time = time,
  delta_t = delta_t,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  iota = iota,
  phi = phi,
  sigma_l = sigma_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>


</div>