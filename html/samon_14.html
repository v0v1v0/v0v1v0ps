<div class="container">

<table style="width: 100%;"><tr>
<td>samon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivity Analysis for monotone missing data</h2>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial, produces estimates of the expected value of the outcome at the
final time-point for a range of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class="language-R">samon(mat, Npart = 10, InitialSigmaH = 1.0, HighSigmaH = 2.0,
InitialSigmaF = 1.0, HighSigmaF = 2.0, lb = 0, ub = 101, 
zeta1 = 1, zeta2 = 1,NSamples = 0, seed0 = 1, MaxIter = 25,
FAconvg = 1E-7, FRconvg = 1E-7, SAconvg = 1E-7, alphaList= c(0), 
MJackknife = FALSE, SJackknife = FALSE, retIFiM = FALSE, 
retIFiS = FALSE, Tfun= NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InitialSigmaF</code></td>
<td>
<p> Initial value when calculation optimal sigma F. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma F. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p> Lower bound for Y. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p> Upper bound for Y. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta1</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta2</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed0</code></td>
<td>
<p> Seed to use. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaList</code></td>
<td>
<p> a vector of sensitivity parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MJackknife</code></td>
<td>
<p> Jackknife main data (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SJackknife</code></td>
<td>
<p> Jackknife bootstrap samples (logical) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retIFiM</code></td>
<td>
<p> return individual IF estimates from main data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retIFiS</code></td>
<td>
<p> return individual IF estimates from samples. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tfun</code></td>
<td>
<p> n by 2 matrix with tilting function values. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point.
</p>
<p>The values in the first column of mat are the baseline values and should
not have missing values.  Samon creates one-step bias corrected estimates of
the mean value of Y at the last time-point for a number of specified
sensitivity parameters, alpha.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the "missingness" model and, sigma F, which represents
smoothing in the "outcome" model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model.  In a
similar vein InitialSigmaF is used as the initial value in the
optimization of the outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i)) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>
<p>Using the optimal values for sigma H and sigma F, samon produces
estimates of the mean value of the outcome at the last visit, for the
set of sensitivity parameters given in the vector alphaList.
</p>
<p>If the sensitivity parameters are applied to the cumulative beta function,
IB.  Four parameters are used to map the values of the outcome, y to the
domain of the  cumulative beta. r(y) = IB( (y-lb)/(ub-lb), zeta1,
zeta2) where zeta1 and zeta2 are the shape parameters.
</p>
<p>Alternatively samon may be called with a user specified sensitivity
function. This is given as an n by 2 matrix with the first column
holding the unique values of the data in mat and the second column the
value of the sensitivity function at that value.
</p>


<h3>Value</h3>

<p>samon returns a list which includes the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The "M" in the
name "HM" refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The "M" in the
name "FM" refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td>
</tr>
</table>
<p>The return code takes the following values:   
</p>
<table>
<tr style="vertical-align: top;">
<td><code>1</code></td>
<td>
<p> absolute function convergence was met </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2</code></td>
<td>
<p> relative function convergence was met </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>3</code></td>
<td>
<p> second derivative has become too small </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>4</code></td>
<td>
<p> maximum iterations reached </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>5</code></td>
<td>
<p> value reset to HighSigmaH or HighSigmaF </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>6</code></td>
<td>
<p> loss function smaller at HighSigmaH or HighSigmaF </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IFM</code></td>
<td>
<p> matrix with 7 columns containing one-step bias-corrected
estimates (sometimes referred to here as IF estimates). Columns are
sample, type, alpha, est0, se0, IFEst, IFVar.  The columns sample
and type take the value 0.  IFEst and IFVar are the one-step bias
corrected estimates and an estimate of their variance for the
original data, mat, at each value of the sensitivity parameters, alpha. </p>
</td>
</tr>
</table>
<p>In a similar manner, "HS", "FS", and "IFS" contain results from
parametric bootstraps (should NSamples be greater than 0).  The first
columns in this case contain the sample number, 1, 2, ...,
NSamples. In other respects these matrices have the same structure as
the corresponding matrix "HM", "FM" and "IFM".
</p>
<p>If MJackknife is set to TRUE, then, "HMjk", "FMjk", "IFMjk" are
produced, holding the jackknife results for the main data mat.  Again
the first column "sample" is set to 0, and the second column is termed
"Dropped" and gives the observation number dropped to form the
jackknife sample.
</p>
<p>Finally, if SJackknife is set to TRUE, then, "HSjk", "FSjk", "IFSjk"
are produced.  These hold the jackknife results for the bootstrap
samples.
</p>


<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("samonPANSS1")

Results1 &lt;- samon(
  mat            = samonPANSS1,
  Npart          =          10, # number of partitions
    
  InitialSigmaH  =        15.0, # initial value
  HighSigmaH     =        50.0, # high value for H
    
  InitialSigmaF  =         8.0, # initial value
  HighSigmaF     =        50.0, # high value for F
    
  lb             =          30, # parameters to
  ub             =         210, # cumulative 
  zeta1          =         4.0, # beta distribution
  zeta2          =         7.0,

  alphaList      =        -1:1 )
</code></pre>


</div>