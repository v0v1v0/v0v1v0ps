<div class="container">

<table style="width: 100%;"><tr>
<td>write.excel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exports an saeTrafo Object to an Excel file or OpenDocument Spreadsheet</h2>

<h3>Description</h3>

<p>Function <code>write.excel</code> enables the user to export point and MSE
estimates as well as diagnostics from the <code>summary</code> to an Excel file.
The user can choose if the results should be reported in one or several Excel
sheets. Furthermore, a selection of indicators can be specified.
Respectively the function <code>write.ods</code> enables the export to OpenDocument
Spreadsheets. Note that while <code>write.exel</code> will create a single document
<code>write.ods</code> will create a group of files.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.excel(
  object,
  file = "excel_output.xlsx",
  MSE = FALSE,
  CV = FALSE,
  split = FALSE
)

write.ods(
  object,
  file = "ods_output.ods",
  MSE = FALSE,
  CV = FALSE,
  split = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of type "saeTrafo", representing point and MSE
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>path and filename of the spreadsheet to create. It should end on
.xlsx or .ods respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>logical. If <code>TRUE</code>, the MSE of the saeTrafoObject is
exported.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>logical. If <code>TRUE</code>, the CV of the saeTrafoObject is exported.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>logical. If <code>TRUE</code>, point estimates, MSE and CV are written
to different sheets in the Excel file. In <code>write.ods</code> <code>TRUE</code> will
result in different files for point estimates and their precision.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions create an Excel file via the package
<span class="pkg">openxlsx</span> and ODS files via the package <span class="pkg">readODS</span>.
Both packages require a zip application to be available to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. If this is not
the case the authors of <span class="pkg">openxlsx</span> suggest the first of the
following two ways.
</p>

<ul>
<li>
<p> Install Rtools from: http://cran.r-project.org/bin/windows/Rtools/ and
modify the system PATH during installation.
</p>
</li>
<li>
<p> If Rtools is installed, but no system path variable is set. One can
set such a variable temporarily to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> by a command like:
<code>Sys.setenv("R_ZIPCMD" = "PathToTheRToolsFolder/bin/zip.exe")</code>.
</p>
</li>
</ul>
<p>To check if a zip application is available they recommend the command
<code>shell("zip")</code>.
</p>


<h3>Value</h3>

<p>An Excel file is created in your working directory, or at the given
path. Alternatively multiple ODS files are created at the given path.
</p>


<h3>See Also</h3>

<p><code>saeTrafoObject</code>, <code>NER_Trafo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Examples for exporting saeTrafoObject to an Excel file or OpenDocument
# Spreadsheet

## Not run: 
# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

# Example 1: Export estimates for all indicators and uncertainty measures and
# diagnostics to Excel
write.excel(NER_model, file = "excel_output.xlsx", MSE = TRUE, CV = TRUE)

# Example 2: Single Excel sheets for point, MSE and CV estimates
write.excel(NER_model, file = "excel_output_split.xlsx", MSE = TRUE,
            CV = TRUE, split = TRUE)

# Example 3: Same as example 1 but for an ODS output
write.ods(NER_model, file = "ods_output_all.ods", MSE = TRUE, CV = TRUE)

## End(Not run)

</code></pre>


</div>