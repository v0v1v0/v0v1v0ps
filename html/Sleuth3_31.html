<div class="container">

<table style="width: 100%;"><tr>
<td>case1502</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global Warming</h2>

<h3>Description</h3>

<p>The data are the temperatures (in degrees Celsius) averaged for the
northern hemisphere over a full year, for years 1850 to 2010. The
161-year average temperature has been subtracted, so each observation
is the temperature difference from the series average. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">case1502</code></pre>


<h3>Format</h3>

<p>A data frame with 161 observations on the following 2 variables.
</p>

<dl>
<dt>Year</dt>
<dd>
<p>year in which yearly average temperature was computed,
from 1850 to 2010</p>
</dd> 
<dt>Temperature</dt>
<dd>
<p>northern hemisphere temperature minus the 161-year
average (degrees Celsius)</p>
</dd> 
</dl>
<h3>Source</h3>

<p>Ramsey, F.L. and Schafer, D.W. (2013). <em>The Statistical Sleuth: A
Course in Methods of Data Analysis (3rd ed)</em>, Cengage Learning.
</p>


<h3>References</h3>

<p>Jones, P.D., D. E. Parker, T. J. Osborn, and K. R. Briffa, (2011) Global 
and Hemispheric Temperature Anomalies and and Marine Instrumental Records, 
CDIAC, http://cdiac.ornl.gov/trends/temp/jonescru/jones.html, August 4, 2011. 
</p>


<h3>See Also</h3>

<p><code>ex1519</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">str(case1502)
attach(case1502)

## EXPLORATION AND MODEL BUILDING
plot(Temperature ~ Year, type="b")  # Type = "b" for *both* points and lines

yearSquared &lt;- Year^2
yearCubed &lt;- Year^3
myLm1 &lt;- lm(Temperature ~ Year + yearSquared + yearCubed)
res1 &lt;- myLm1$res
myPacf &lt;- pacf(res1)  # Partial autocorrelation from residuals
r1 &lt;- myPacf$acf[1]  #First serial correlation coefficient    
n &lt;- length(Temperature)   # Series length = 161
v &lt;- Temperature[2:n]  -  r1*Temperature[1:(n-1)]   # Filtered response
ones &lt;- rep(1-r1, n-1)   # make a variable of all 1's
u1 &lt;- Year[2:n]          -  r1*Year[1:(n-1)]   # Filtered "ones"
u2 &lt;- yearSquared[2:n]  -  r1*yearSquared[1:(n-1)]  # Filtered X1
u3 &lt;- yearCubed[2:n]    -  r1*yearCubed[1:(n-1)]  # Filtered X2
myLm2 &lt;- lm(v ~  u1 + u2 + u3 )
res2 &lt;- myLm2$res                                       
pacf(res2)   # Looks fine; don't worry about lag 4 marginal significance
plot(myLm2, which=1)  # Residual plot
summary(myLm2) # Cubic term isn't needed.
myLm3    &lt;- update(myLm2, ~ . - u3) # Drop cubic term

## INFERENCE
summary(myLm3) # Everything remaining is statistically significant.

## GRAPHICAL DISPLAY FOR PRESENTATION
plot(Temperature ~ Year, xlab="Year",
  ylab=expression(paste("Annual Average Temperature (Difference From Average), ",
  degree,"C")),main="Annual Average Temperature in Northern Hemisphere; 1850-2010",
  type="b", pch=21, lwd=2, bg="green", cex=1.5)    
myFits &lt;- myLm3$fit
lines(myFits ~ Year[2:161], col="blue", lwd=2)  
legend(1850,0.6,"Quadratic Regression Fit, Adjusted for AR(1) Serial Correlation",
  col="blue", lwd=2, box.lty=0)

detach(case1502)

</code></pre>


</div>