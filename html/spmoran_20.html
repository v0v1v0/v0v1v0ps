<div class="container">

<table style="width: 100%;"><tr>
<td>weigen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract eigenvectors from a spatial weight matrix</h2>

<h3>Description</h3>

<p>This function extracts eigenvectors and eigenvalues from a spatial weight matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weigen( x = NULL, type = "knn", k = 4, threshold = 0.25, enum = NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix of spatial point coordinates (N x 2), sf polygon object (N spatial units), or an user-specified spatial weight matrix (N x N) (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of spatial weights. The currently available options are "knn" for the k-nearest neighbor-based weights, and "tri" for the Delaunay triangulation-based weights. If sf polygons are provided for x, type is ignored, and the rook-type neighborhood matrix is created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of nearest neighbors. It is used if type ="knn"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold for the eigenvalues (scalar). Suppose that lambda_1 is the maximum eigenvalue. Then, this fucntion extracts eigenvectors whose corresponding eigenvalues are equal or greater than [threshold x lambda_1]. It must be a value between 0 and 1. Default is 0.25 (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enum</code></td>
<td>
<p>Optional. The muximum acceptable mumber of eigenvectors to be used for spatial modeling (scalar)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If user-specified spatial weight matrix is provided for x, this function returns the eigen-pairs of the matrix. Otherwise, if sf polygon object is provided to x, the rook-type neighborhood matrix is created using this polygon, and eigen-decomposed. Otherwise, if point coordinats are provided to x, a spatial weight matrix is created according to type, and eigen-decomposed.
</p>
<p>By default, the ARPACK routine is implemented for fast eigen-decomposition.
</p>
<p>threshold = 0.25 (default) is a standard setting for topology-based ESF (see Tiefelsdorf and Griffith, 2007) while threshold = 0.00 is a usual setting for distance-based ESF.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>Matrix of the first L eigenvectors (N x L)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev</code></td>
<td>
<p>Vector of the first L eigenvalues (L x 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other</code></td>
<td>
<p>List of other outcomes, which are internally used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daisuke Murakami
</p>


<h3>References</h3>

<p>Tiefelsdorf, M. and Griffith, D.A. (2007) Semiparametric filtering of spatial autocorrelation: the eigenvector approach. Environment and Planning A, 39 (5), 1193-1221.
</p>
<p>Murakami, D. and Griffith, D.A. (2018) Low rank spatial econometric models. Arxiv, 1810.02956.
</p>


<h3>See Also</h3>

<p><code>meigen</code>, <code>meigen_f</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(spdep)
data(boston)

########## Rook adjacency-based W
poly	    &lt;- st_read(system.file("shapes/boston_tracts.shp",package="spData")[1])
weig1	    &lt;- weigen( poly )

########## knn-based W
coords    &lt;- boston.c[,c("LON", "LAT")]
weig2	    &lt;- weigen( coords, type = "knn" )

########## Delaunay triangulation-based W
coords    &lt;- boston.c[,c("LON", "LAT")]
weig3	    &lt;- weigen( coords, type = "tri")

########## User-specified W
dmat      &lt;- as.matrix(dist(coords))
cmat 	    &lt;- exp(-dmat)
diag(cmat)&lt;- 0
weig4	    &lt;- weigen( cmat, threshold = 0 )
</code></pre>


</div>