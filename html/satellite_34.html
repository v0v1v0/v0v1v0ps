<div class="container">

<table style="width: 100%;"><tr>
<td>calcTopoCorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correct for topographic effects.</h2>

<h3>Description</h3>

<p>Correct for topographic effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Satellite'
calcTopoCorr(x, mask = TRUE)

## S4 method for signature 'RasterStackBrick'
calcTopoCorr(x, hillsh, cloudmask = NULL, ...)

## S4 method for signature 'RasterLayer'
calcTopoCorr(x, hillsh, cloudmask = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>Satellite</code> or <code>Raster*</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, the cloudmask from the 
<code>Satellite</code> object (if available) will be considered in the regression 
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hillsh</code></td>
<td>
<p>A <code>RasterLayer</code> created with <code>hillShade</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloudmask</code></td>
<td>
<p>A <code>RasterLayer</code> in which clouds are masked with 
NA values, passed to <code>mask</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>writeRaster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method of Civco (1989) is applied on atmospherically corrected bands 
(if not already available in the Satellite object, 
<code>calcAtmosCorr</code> is performed with its default settings.):
First, an analytical hillshade image is created based on a DEM and sun 
elevation and sun zenith information from the metadata. A regression between
the hillshade (independent variable) and each channel is then calculated 
with consideration of a cloudmask (if available).
The regression coefficents are used to calibrate the hillshade raster 
(for each channel individually). 
Finally, the calibrated hillshade image is subtracted from the corresponding
channel and the mean value of the channel is added.
</p>


<h3>Value</h3>

<p>If x is a Satellite object, a Satellite object with added, 
topographic corrected layers; if x is a <code>raster::Raster*</code> object, a 
<code>raster::Raster*</code> object with converted layer(s).
</p>


<h3>References</h3>

<p>CIVCO, D.L. (1989): Topographic normalization of Landsat Thematic
Mapper digitalimagery. <em>Photogrammetric Engineering &amp; Remote Sensing</em>, 
55, 1303-1309.
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- system.file("extdata", package = "satellite")
files &lt;- list.files(path, pattern = glob2rx("LC08*.TIF"), full.names = TRUE)
sat &lt;- satellite(files)

## dem

files_dem &lt;- list.files(path, pattern = "DEM", full.names = TRUE)
DEM &lt;- raster(files_dem)

sat &lt;- addSatDataLayer(sat, data = DEM, info = NULL, bcde = "DEM", in_bcde="DEM")

## Not run: 
sat &lt;- calcTopoCorr(sat)

## End(Not run)
</code></pre>


</div>