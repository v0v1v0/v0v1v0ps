<div class="container">

<table style="width: 100%;"><tr>
<td>variogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample variogram
</h2>

<h3>Description</h3>

<p>Computes the sample variogram from an <code>SpATS</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'SpATS'
variogram(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>SpATS</code> as produced by <code>SpATS()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The present function computes the sample variogram on the basis of the (deviance) residuals of the fitted model. Currently, the function can only be applied for regular two-dimensional data, i.e, when the plots of the field are arranged in a regular two-dimensional array (usually defined by the column and row positions). 
For each pair of (deviance) residuals <code class="reqn">e_i</code> and <code class="reqn">e_j</code>, the half-squared difference is computed </p>
<p style="text-align: center;"><code class="reqn">v_{ij} = 0.5(e_i - e_j)^2,</code>
</p>
<p> as well as the corresponding column (<code class="reqn">cd_{ij}</code>) and row displacements (<code class="reqn">rd_{ij}</code>), with </p>
<p style="text-align: center;"><code class="reqn">cd_{ij} = |c_i - c_j|</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">rd_{ij} = |r_i - r_j|,</code>
</p>
<p> where <code class="reqn">c_k</code> and <code class="reqn">r_k</code> denote the column and row position of plot <code class="reqn">k</code> respectively. The sample variogram is then defined as the triplet </p>
<p style="text-align: center;"><code class="reqn">(cd_{ij}, rd_{ij}, \bar{v}_{ij}),</code>
</p>
<p> where <code class="reqn">\bar{v}_{ij}</code> denotes the average of the <code class="reqn">v_{ij}</code> that share the same column and row displacements. 
For a more detailed description, see Gilmour et al. (1997).  
</p>


<h3>Value</h3>

<p>An object of class <code>variogram.SpATS</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame including the following information: “value”: the value of the sample variogram at each pair of column and row displacements; and “length”: the number of observations used to compute the sample variogram at the corresponding pair of displacements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.displacement</code></td>
<td>
<p>numerical vector containing the column displacements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.displacement</code></td>
<td>
<p>numerical vector containing the row displacements</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Gilmour, A.R., Cullis, B.R., and Verbyla, A.P. (1997). Accounting for Natural and Extraneous Variation in the Analysis of Field Experiments. Journal of Agricultural, Biological, and Environmental Statistics, 2, 269 - 293.
</p>
<p>Stefanova, K.T., Smith, A.B. and Cullis, B.R. (2009). Enhanced Diagnostics for the Spatial Analysis of Field Trials. Journal of Agricultural, Biological, and Environmental Statistics, 14, 392 - 410.
</p>


<h3>See Also</h3>

<p><code>SpATS</code>, <code>plot.variogram.SpATS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpATS)
data(wheatdata)
wheatdata$R &lt;- as.factor(wheatdata$row)
wheatdata$C &lt;- as.factor(wheatdata$col)

m0 &lt;- SpATS(response = "yield", spatial = ~ SAP(col, row, nseg = c(10,20), degree = 3, pord = 2), 
genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, data = wheatdata, 
control =  list(tolerance = 1e-03))

# Compute the variogram
var.m0 &lt;- variogram(m0)
# Plot the variogram
plot(var.m0)
</code></pre>


</div>