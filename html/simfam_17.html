<div class="container">

<table style="width: 100%;"><tr>
<td>recomb_map_fix_ends_chr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extrapolate and shift recombination map of one chromosome to ends</h2>

<h3>Description</h3>

<p>Given an existing recombination map and a chromosome length in base pairs, extrapolates the map to ensure all positions are covered, and shifts to ensure position one in basepairs corresponds to position 0 in genetic position.
Recombination rates are extrapolated from the first and last 10Mb of data by default (separately per end).
Therefore fixes the fact that common maps start genetic position zero at base pair position <code style="white-space: pre;">⁠&gt;&gt; 1⁠</code> and do not extend to ends (some SNPs from modern projects fall out of range without fixes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">recomb_map_fix_ends_chr(map, pos_length, pos_delta = 10000000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A tibble with two columns: <code>pos</code> position in base pairs, and <code>posg</code> position in centiMorgans (cM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_length</code></td>
<td>
<p>The length of the chromosome in base pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_delta</code></td>
<td>
<p>The size of the window used to extrapolate recombination rates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The extrapolated recombination map, shifted so the first non-trivial position maps to the genetic distance expected from the extrapolated rate at the beginning, then added a first trivial position (<code style="white-space: pre;">⁠pos=1, posg=0⁠</code>) and final basepair position at length of chromosome and expected genetic position from end extrapolation.
</p>


<h3>See Also</h3>

<p><code>recomb_map_simplify_chr()</code> to simplify recombination maps to a desired numerical accuracy.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)
# create a toy recombination map with at least 10Mb at each end
map &lt;- tibble(
    pos  = c( 3L,  15L, 100L, 120L ) * 1e6L,
    posg = c(  0, 10.4, 90.1,  110 )
)
# and length
pos_length &lt;- 150L * 1e6L

# apply function!
map_fixed &lt;- recomb_map_fix_ends_chr( map, pos_length )
# inspect
map_fixed

</code></pre>


</div>