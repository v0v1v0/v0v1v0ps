<div class="container">

<table style="width: 100%;"><tr>
<td>get_enriched_themes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find over-represented themes in a collection</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt="[Maturing]"></a>
</p>
<p><code>get_enriched_themes()</code> calculates the top <code>m</code> most over-represented (or
enriched) themes in a sub-collection of interest from a background
collection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_enriched_themes(
  test_collection,
  background_collection = NULL,
  top_m = 10,
  weights = list(choice = 3, major = 2, minor = 1),
  explicit = TRUE,
  min_freq = 1,
  blacklist = NULL,
  metric = c("hgt", "tfidf")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>test_collection</code></td>
<td>
<p>A <code>Collection()</code> class object of stories to assay
for over-represented themes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_collection</code></td>
<td>
<p>A <code>Collection()</code> class object the stories of
are a superset of the <code>test_collection</code> stories.
</p>
<p>If <code>NULL</code>, the collection of all stories in the actively loaded
<abbr><span class="acronym">LTO</span></abbr> version is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_m</code></td>
<td>
<p>Maximum number of themes to report. The default is <code>top_m=10</code>.
</p>
<p>If <code>Inf</code>, all themes occurring at least <code>min_occurrence</code> times in the
collection are reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A list assigning nonnegative weights to choice, major, and
minor theme levels. The default weighting
<code>list(choice = 3, major = 2, minor = 1)</code> counts each <em>choice</em> usage
three times, each <em>major</em> theme usage twice, and each <em>minor</em>
theme usage once. Use the uniform weighting
<code>list(choice = 1, major = 1, minor = 1)</code> weights theme usages equally
regardless of level. At least one weight must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>explicit</code></td>
<td>
<p>Set to <code>FALSE</code> to include ancestor themes of the explicit
thematic annotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_freq</code></td>
<td>
<p>Drop themes occurring less than this number of times from
the analysis. The default <code>min_freq=1</code> results in no themes are discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blacklist</code></td>
<td>
<p>A <code>Themeset()</code> class object. A themeset containing themes
to be dropped from the analysis.
</p>
<p>If <code>NULL</code>, no themes are filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A character vector specifying the choice of scoring function.
Use <code>metric = "hgt"</code> for the <em>hypergeometric test</em>, and
<code>metric = "tfidf"</code> for <em>term frequency-inverse document frequency</em>.
The default specification of <code>metric = c("hgt", "tfidf")</code> results in
the hypergeometric test being used in the analysis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test collection of <code>n</code> stories, <code class="reqn">S[1], \ldots, S[n]</code>, is
represented as a weighted bag-of-words, where each <em>choice</em> theme in
story <code class="reqn">S[j] (j=1, \ldots, n)</code> is counted <code>weights$choice</code> times,
each <em>major</em> theme <code>weights$major</code> times, and each <em>minor</em>
theme <code>weights$choice</code> times.
</p>
<p>The background collection of <code>N</code> stories, <code class="reqn">S[1], \ldots, S[N]</code>, is a
superset of the test collection that is likewise represented as a weighted
bag-of-words.
</p>
<p>Theme enrichment scores are calculated according to the hypergeometric test
by default. Set <code>metric = "tfidf"</code> to use TF-IDF weights for the enrichment
scores.
</p>


<h3>Value</h3>

<p>Returns a <code>tibble</code> with <code>top_m</code> rows (themes)
and 10 columns:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>theme_name</code>: </td>
<td style="text-align: left;"> <code>m</code>-th most over-represented theme in the test
collection</td>
</tr>
<tr>
<td style="text-align: left;">
<code>k</code>: </td>
<td style="text-align: left;"> Number of test collection stories featuring the theme</td>
</tr>
<tr>
<td style="text-align: left;">
<code>k_bar</code>: </td>
<td style="text-align: left;"> Weighted counts of the theme summed over the test
collection stories</td>
</tr>
<tr>
<td style="text-align: left;">
<code>n</code>: </td>
<td style="text-align: left;"> Number of stories in the test collection</td>
</tr>
<tr>
<td style="text-align: left;">
<code>n_bar</code>: </td>
<td style="text-align: left;"> Sum of all weighted counts of test collection themes</td>
</tr>
<tr>
<td style="text-align: left;">
<code>K</code>: </td>
<td style="text-align: left;"> Number of background collection stories featuring the theme</td>
</tr>
<tr>
<td style="text-align: left;">
<code>K_bar</code>: </td>
<td style="text-align: left;"> Weighted counts of the theme summed over the background
collection stories</td>
</tr>
<tr>
<td style="text-align: left;">
<code>N</code>: </td>
<td style="text-align: left;"> Number of stories in the background collection</td>
</tr>
<tr>
<td style="text-align: left;">
<code>N_bar</code>: </td>
<td style="text-align: left;"> Sum of all weighted counts of background collection
themes</td>
</tr>
<tr>
<td style="text-align: left;">
<code>score</code>: </td>
<td style="text-align: left;"> Either the negative base 10 logarithm of the Hypergeometric
test (if <code>metric = "hgt"</code>) or TF-IDF (if <code>metric = "tfidf"</code>)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Mikael Onsjö, Paul Sheridan (2020). Theme Enrichment Analysis: A
Statistical Test for Identifying Significantly Enriched Themes in a List of
Stories with an Application to the Star Trek Television Franchise.
<em>Digital Studies/le Champ Numérique</em>, 10(1), 1. DOI:
<a href="https://doi.org/10.16995/dscn.316">doi:10.16995/dscn.316</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Retrieve the top 10 most enriched themes in "The Twilight Zone" (1959)
# series episodes with all demo version stories as background:
set_lto("demo")
test_collection &lt;- Collection$new(collection_id = "Collection: tvseries: The Twilight Zone (1959)")
result_tbl &lt;- get_enriched_themes(test_collection)
result_tbl

# Run the same analysis on "The Twilight Zone" (1959) series without
# including minor level themes:
result_tbl &lt;- get_enriched_themes(test_collection, weights = list(choice = 1, major = 1, minor = 0))
result_tbl

## End(Not run)
</code></pre>


</div>