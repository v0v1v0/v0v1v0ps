<div class="container">

<table style="width: 100%;"><tr>
<td>sgp.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for sparse group penalties</h2>

<h3>Description</h3>

<p>A function that performs k-fold cross-validation for sparse group penalties for a lambda sequence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sgp.cv(
  X,
  y,
  group = 1:ncol(X),
  Z = NULL,
  ...,
  nfolds = 10,
  seed,
  fold,
  type,
  returnY = FALSE,
  print.trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix without intercept with the variables to be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector indicating the group membership of each variable in X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The design matrix of the variables to be included in the model without penalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters of underlying basic functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>The number of folds for cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed provided by the user for the random number generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>A vector of folds specified by the user (default is a random assignment).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string indicating the type of regression model (linear or binomial).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnY</code></td>
<td>
<p>A Boolean value indicating whether the fitted values should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.trace</code></td>
<td>
<p>A Boolean value that specifies whether the beginning of a fold should be printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>cve</dt>
<dd>
<p>The average cross-validation error for each value of lambda.</p>
</dd>
<dt>cvse</dt>
<dd>
<p>The estimated standard error for each value of cve.</p>
</dd>
<dt>lambdas</dt>
<dd>
<p>The sequence of lambda values.</p>
</dd>
<dt>fit</dt>
<dd>
<p>The sparse group penalty model fitted to the entire data.</p>
</dd>
<dt>fold</dt>
<dd>
<p>The fold assignments for each observation for the cross-validation procedure.</p>
</dd>
<dt>min</dt>
<dd>
<p>The index of lambda corresponding to the minimum cross-validation error.</p>
</dd>
<dt>lambda.min</dt>
<dd>
<p>The value of lambda with the minimum cross-validation error.</p>
</dd>
<dt>null.dev</dt>
<dd>
<p>The deviance for the empty model.</p>
</dd>
<dt>pe</dt>
<dd>
<p>The cross-validation prediction error for each value of lambda (for binomial only).</p>
</dd>
<dt>pred</dt>
<dd>
<p>The fitted values from the cross-validation folds.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# Generate data
 n &lt;- 100
 p &lt;- 200
 nr &lt;- 10
 g &lt;- ceiling(1:p / nr)
 X &lt;- matrix(rnorm(n * p), n, p)
 b &lt;- c(-3:3)
 y_lin &lt;- X[, 1:length(b)] %*% b + 5 * rnorm(n)
 y_log &lt;- rbinom(n, 1, exp(y_lin) / (1 + exp(y_lin)))

# Linear regression
 lin_fit &lt;- sgp.cv(X, y_lin, g, type = "linear", penalty = "sgl")
 plot(lin_fit)
 predict(lin_fit, extract = "vars")
 lin_fit &lt;- sgp.cv(X, y_lin, g, type = "linear", penalty = "sgs")
 plot(lin_fit)
 predict(lin_fit, extract = "vars")
 lin_fit &lt;- sgp.cv(X, y_lin, g, type = "linear", penalty = "sgm")
 plot(lin_fit)
 predict(lin_fit, extract = "vars")
 lin_fit &lt;- sgp.cv(X, y_lin, g, type = "linear", penalty = "sge")
 plot(lin_fit)
 predict(lin_fit, extract = "vars")

# Logistic regression
 log_fit &lt;- sgp.cv(X, y_log, g, type = "logit", penalty = "sgl")
 plot(log_fit)
 predict(log_fit, extract = "vars")
 log_fit &lt;- sgp.cv(X, y_log, g, type = "logit", penalty = "sgs")
 plot(log_fit)
 predict(log_fit, extract = "vars")
 log_fit &lt;- sgp.cv(X, y_log, g, type = "logit", penalty = "sgm")
 plot(log_fit)
 predict(log_fit, extract = "vars")
 log_fit &lt;- sgp.cv(X, y_log, g, type = "logit", penalty = "sge")
 plot(log_fit)
 predict(log_fit, extract = "vars")


</code></pre>


</div>