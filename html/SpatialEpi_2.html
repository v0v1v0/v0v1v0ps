<div class="container">

<table style="width: 100%;"><tr>
<td>besag_newell</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Besag-Newell Cluster Detection Method</h2>

<h3>Description</h3>

<p>Besag-Newell cluster detection method.  There are differences with the original paper and our implementation:
</p>

<ul>
<li>
<p>we base our analysis on <code class="reqn">k</code> cases, rather than <code class="reqn">k</code> <em>other</em> cases as prescribed in the paper.
</p>
</li>
<li>
<p> we do not subtract 1 from the <em>accumulated numbers of other cases</em> and <em>accumulated numbers of others at risk</em>, as was prescribed in the paper to discount selection bias
</p>
</li>
<li>
<p> M is the total number of areas included, not the number of additional areas included.  i.e. <code class="reqn">M</code> starts at 1, not 0.
</p>
</li>
<li>
<p> p-values are not based on the original value of <code class="reqn">k</code>, rather the actual number of cases observed until we view <code class="reqn">k</code> or more cases.  Ex:  if <code class="reqn">k = 10</code>, but as we consider neighbors we encounter 1, 2, 9 then 12 cases, we base our <code class="reqn">p</code>-values on <code class="reqn">k=12</code>
</p>
</li>
<li>
<p> we do not provide a Monte-Carlo simulated <code class="reqn">R</code>:  the number of tests that attain significance at a fixed level <code class="reqn">\alpha</code>
</p>
</li>
</ul>
<p>The first two and last differences are because we view the testing on an area-by-area level, rather than a case-by-case level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">besag_newell(geo, population, cases, expected.cases = NULL, k, alpha.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geo</code></td>
<td>
<p>an <code style="white-space: pre;">⁠n x 2⁠</code> table of the (x,y)-coordinates of the area centroids</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>aggregated population counts for all <code>n</code> areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>aggregated case counts for all <code>n</code> areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected.cases</code></td>
<td>
<p>expected numbers of disease for all <code>n</code> areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of cases to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.level</code></td>
<td>
<p>alpha-level threshold used to declare significance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the <code>population</code> and <code>cases</code> tables, the rows are bunched by areas first, and then for each area, the counts for each strata are listed.  It is important that the tables are balanced:  the strata information are in the same order for each area, and counts for each area/strata combination appear exactly once (even if zero).
</p>


<h3>Value</h3>

<p>List containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>information on all clusters that are <code class="reqn">\alpha</code>-level significant, in decreasing order of the <code class="reqn">p</code>-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p>for each of the <code class="reqn">n</code> areas, <code class="reqn">p</code>-values of each cluster of size at least <code class="reqn">k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.values</code></td>
<td>
<p>for each of the <code class="reqn">n</code> areas, the number of areas need to observe at least <code class="reqn">k</code> cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.k.values</code></td>
<td>
<p>based on <code>m.values</code>, the actual number of cases used to compute the <code class="reqn">p</code>-values</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>clusters</code> list elements are themselves lists reporting:<br><br></p>

<table>
<tr>
<td style="text-align: left;">
<code>location.IDs.included</code> </td>
<td style="text-align: left;"> ID's of areas in cluster, in order of distance</td>
</tr>
<tr>
<td style="text-align: left;">
<code>population</code> </td>
<td style="text-align: left;"> population of cluster</td>
</tr>
<tr>
<td style="text-align: left;">
<code>number.of.cases</code> </td>
<td style="text-align: left;"> number of cases in cluster</td>
</tr>
<tr>
<td style="text-align: left;">
<code>expected.cases</code> </td>
<td style="text-align: left;"> expected number of cases in cluster</td>
</tr>
<tr>
<td style="text-align: left;">
<code>SMR</code> </td>
<td style="text-align: left;"> estimated SMR of cluster</td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.value</code> </td>
<td style="text-align: left;"> <code class="reqn">p</code>-value</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Albert Y. Kim
</p>


<h3>References</h3>

<p>Besag J. and Newell J. (1991) The Detection of Clusters in Rare Diseases <em>Journal of the Royal Statistical Society. Series A (Statistics in Society)</em>, <strong>154</strong>, 143–155
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Load Pennsylvania Lung Cancer Data
data(pennLC)
data &lt;- pennLC$data

## Process geographical information and convert to grid
geo &lt;- pennLC$geo[,2:3]
geo &lt;- latlong2grid(geo)

## Get aggregated counts of population and cases for each county
population &lt;- tapply(data$population,data$county,sum)
cases &lt;- tapply(data$cases,data$county,sum)

## Based on the 16 strata levels, computed expected numbers of disease
n.strata &lt;- 16
expected.cases &lt;- expected(data$population, data$cases, n.strata)

## Set Parameters
k &lt;- 1250
alpha.level &lt;- 0.05

# not controlling for stratas
results &lt;- besag_newell(geo, population, cases, expected.cases=NULL, k, 
                       alpha.level)

# controlling for stratas
results &lt;- besag_newell(geo, population, cases, expected.cases, k, alpha.level)

</code></pre>


</div>