<div class="container">

<table style="width: 100%;"><tr>
<td>meanspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean frequency spectrum of a time wave</h2>

<h3>Description</h3>

<p>This function returns the mean frequency spectrum (i.e. the mean relative amplitude of the
frequency distribution) of a time wave. Results can be expressed either in absolute 
or dB data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meanspec(wave, f, channel = 1, wl = 512, wn = "hanning", ovlp = 0, fftw = FALSE,
norm = TRUE, PSD = FALSE, PMF = FALSE, FUN = mean, correction = "none", dB = NULL,
dBref = NULL, from = NULL, to = NULL, identify = FALSE,
col = "black", cex = 1, plot = 1, flab = "Frequency (kHz)",
alab = "Amplitude", flim = NULL, alim = NULL, type ="l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis (even number of points, by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default <code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive analysis windows (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code>. See Notes of <code>spectro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>if <code>TRUE</code> the mean spectrum is normalised (i. e. scaled) by  its maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSD</code></td>
<td>
<p>if <code>TRUE</code> return Power Spectra Density,
<em>i. e.</em> the square of the spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PMF</code></td>
<td>
<p>if <code>TRUE</code> return Probability Mass Function,
<em>i. e.</em> the probability distribution of frequencie.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>the function to apply on the rows of the STFT matrix, by
default <code>mean</code> for a mean spectrum but could be other as
<code>median</code> or <code>var</code> for a median spectrum or variance spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>a character vector of length 1 to apply an
amplitude ("amplitude") or an energy ("energy") correction
to the FT window. This argument is useful only when one wish to obtain
absolute values that is when <code>norm=FALSE</code> and <code>PMF=FALSE</code>.
By default no correction is applied ("none").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>a character string specifying the type dB to return: "max0" for a
maximum dB value at 0, "A", "B", "C", "D", and "ITU" for common dB weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBref</code></td>
<td>
<p>a dB reference value when <code>dB</code> is not <code>NULL</code>. <code>NULL</code> by default
but should be set to 2*10e-5 for a 20 microPa reference (SPL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>start mark where to compute the spectrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>end mark where to compute the spectrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>to identify frequency and amplitude values on the plot
with the help of a cursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of the spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>pitch size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>1</code> returns frequency on x-axis, if <code>2</code> returns 
frequency on y-axis, (by default <code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alab</code></td>
<td>
<p>title of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>range of frequency axis (in kHz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alim</code></td>
<td>
<p>range of amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See examples of <code>spec</code>. This function is based on <code>fft</code>.
</p>


<h3>Value</h3>

<p>If <code>plot</code> is <code>FALSE</code>, <code>meanspec</code> returns  a two columns matrix,
the first column corresponding to the frequency axis, the second column
corresponding to the amplitude axis.<br> 
If <code>identify</code> is <code>TRUE</code>, <code>spec</code> returns a list with
two elements:<br></p>
<table><tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>the frequency of the points chosen on the spectrum</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>amp</code></td>
<td>
<p>the relative amplitude of the points chosen on the spectrum</p>
</td>
</tr></table>
<p><br></p>


<h3>Warning</h3>

<p>The argument <code>peaks</code> is no more available
(version &gt; 1.5.6). See the function <code>fpeaks</code>
for peak(s) detection.</p>


<h3>Note</h3>

<p>The argument <code>fftw</code> can be used to try to speed up process
time. When set to <code>TRUE</code>, the Fourier transform is computed
through the function <code>FFT</code> of the package <code>fftw</code>. This package is a
wrapper around the fastest Fourier transform of the free C subroutine
library FFTW (<a href="http://www.fftw.org/">http://www.fftw.org/</a>). FFT should be then installed on your OS.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>See Also</h3>

<p><code>spec</code>,<code>fpeaks</code>,
<code>localpeaks</code>, <code>dynspec</code>, 
<code>corspec</code>, <code>diffspec</code>, <code>simspec</code>, <code>fft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(orni)
# compute the mean spectrum of the whole time wave
meanspec(orni,f=22050)
# compute the mean spectrum of a time wave section (from 0.32 s to 0.39 s)
meanspec(orni,f=22050,from=0.32,to=0.39)
# different window lengths
op&lt;-par(mfrow=c(3,1))
meanspec(orni,f=22050,wl=256)
title("wl=256")
meanspec(orni,f=22050,wl=1024)
title("wl=1024")
meanspec(orni,f=22050,wl=4096)
title("wl=4096")
par(op)
# different overlap values (almost no effects here...)
op&lt;-par(mfrow=c(3,1))
meanspec(orni,f=22050)
title("ovlp=0")
meanspec(orni,f=22050,ovlp=50)
title("ovlp=50")
meanspec(orni,f=22050,ovlp=95)
title("ovlp=95")
par(op)
# use of flim to zoom in
op&lt;-par(mfrow=c(2,1))
meanspec(orni,f=22050)
title("zoom in")
meanspec(orni,f=22050,wl=512,flim=c(4,6))
par(op)
# comparaison of spectrum and mean spectrum
op&lt;-par(mfrow=c(2,1))
spec(orni,f=22050)
title("spec()")
meanspec(orni,f=22050)
title("meanspec()")
par(op)
# log scale on frequency axis
meanspec(orni, f=22050, log="x")
# median spectrum
meanspec(orni,f=22050, FUN=median)
# variance spectrum
meanspec(orni,f=22050, FUN=var)
</code></pre>


</div>