<div class="container">

<table style="width: 100%;"><tr>
<td>anova.sjSDM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Anova / Variation partitioning</h2>

<h3>Description</h3>

<p>Compute variance explained by the three fractions env, space, associations
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sjSDM'
anova(object, samples = 5000L, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>model of object <code>sjSDM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Number of Monte Carlo samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>, indicating whether progress should be printed or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments which are passed to the calculation of the logLikelihood</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ANOVA function removes each of the three fractions (Environment, Space, Associations) and measures the drop in variance explained, and thus the importance of the three fractions.
</p>
<p>Variance explained is measured by Deviance as well as the pseudo-R2 metrics of Nagelkerke and McFadden
</p>
<p>In downstream functions such as <code>plot.sjSDManova</code> or <code>plot.sjSDManova</code> with <code>add_shared=TRUE</code>.
The anova can get unstable for many species and few occurrences/observations. We recommend using large numbers for 'samples'.
</p>


<h3>Value</h3>

<p>An S3 class of type 'sjSDManova' including the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Data frame of results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to_print</code></td>
<td>
<p>Data frame, summarized results for type I anova.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of observations (sites).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>Logical, spatial model or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>individual species R2s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sites</code></td>
<td>
<p>individual site R2s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lls</code></td>
<td>
<p>individual site by species negative-log-likelihood values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model</p>
</td>
</tr>
</table>
<p>Implemented S3 methods are <code>print.sjSDManova</code> and <code>plot.sjSDManova</code>
</p>


<h3>See Also</h3>

<p><code>plot.sjSDManova</code>, <code>print.sjSDManova</code>,<code>summary.sjSDManova</code>, <code>plot.sjSDMinternalStructure</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(sjSDM)
# simulate community:
community = simulate_SDM(env = 3L, species = 10L, sites = 100L)

Occ &lt;- community$response
Env &lt;- community$env_weights
SP &lt;- data.frame(matrix(rnorm(200, 0, 0.3), 100, 2)) # spatial coordinates


# fit model:
model &lt;- sjSDM(Y = Occ, 
               env = linear(data = Env, formula = ~X1+X2+X3), 
               spatial = linear(data = SP, formula = ~0+X1*X2), 
               family=binomial("probit"),
               verbose = FALSE,
               iter = 20) # increase iter for real analysis

# Calculate ANOVA for env, space, associations, for details see ?anova.sjSDM
an = anova(model, samples = 10, verbose = FALSE) # increase iter for real analysis

# Show anova fractions
plot(an)

# ANOVA tables with different way to handle fractions
summary(an)
summary(an, fractions = "discard")
summary(an, fractions = "proportional")
summary(an, fractions = "equal")

# Internal structure
int = internalStructure(an, fractions = "proportional")

print(int)

plot(int) # default is negative values will be set to 0
plot(int, negatives = "scale") # global rescaling of all values to range 0-1
plot(int, negatives = "raw") # negative values will be discarded

plotAssemblyEffects(int)
plotAssemblyEffects(int, negatives = "floor")
plotAssemblyEffects(int, response = "sites", pred = as.factor(c(rep(1, 50), rep(2, 50))))
plotAssemblyEffects(int, response = "species", pred = runif(10))
plotAssemblyEffects(int, response = "species", pred = as.factor(c(rep(1, 5), rep(2, 5))))

## End(Not run)
</code></pre>


</div>