<div class="container">

<table style="width: 100%;"><tr>
<td>HTODemux</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Demultiplex samples based on data from cell 'hashing'</h2>

<h3>Description</h3>

<p>Assign sample-of-origin for each cell, annotate doublets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HTODemux(
  object,
  assay = "HTO",
  positive.quantile = 0.99,
  init = NULL,
  nstarts = 100,
  kfunc = "clara",
  nsamples = 100,
  seed = 42,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object. Assumes that the hash tag oligo (HTO) data has been added and normalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of the Hashtag assay (HTO by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive.quantile</code></td>
<td>
<p>The quantile of inferred 'negative' distribution for each hashtag - over which the cell is considered 'positive'. Default is 0.99</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Initial number of clusters for hashtags. Default is the # of hashtag oligo names + 1 (to account for negatives)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstarts</code></td>
<td>
<p>nstarts value for k-means clustering (for kfunc = "kmeans"). 100 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kfunc</code></td>
<td>
<p>Clustering function for initial hashtag grouping. Default is "clara" for fast k-medoids clustering on large applications, also support "kmeans" for kmeans clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>Number of samples to be drawn from the dataset used for clustering, for kfunc = "clara"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets the random seed. If NULL, seed is not set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Prints the output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The Seurat object with the following demultiplexed information stored in the meta data:
</p>

<dl>
<dt>hash.maxID</dt>
<dd>
<p>Name of hashtag with the highest signal</p>
</dd>
<dt>hash.secondID</dt>
<dd>
<p>Name of hashtag with the second highest signal</p>
</dd>
<dt>hash.margin</dt>
<dd>
<p>The difference between signals for hash.maxID and hash.secondID</p>
</dd>
<dt>classification</dt>
<dd>
<p>Classification result, with doublets/multiplets named by the top two highest hashtags</p>
</dd>
<dt>classification.global</dt>
<dd>
<p>Global classification result (singlet, doublet or negative)</p>
</dd>
<dt>hash.ID</dt>
<dd>
<p>Classification result where doublet IDs are collapsed</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>HTOHeatmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
object &lt;- HTODemux(object)

## End(Not run)

</code></pre>


</div>