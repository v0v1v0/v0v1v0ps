<div class="container">

<table style="width: 100%;"><tr>
<td>samp_discrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Species Sampling uncertainty - Trait Evolution Discrete Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of discrete (binary) characters, 
evaluating sampling uncertainty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">samp_discrete(
  data,
  phy,
  n.sim = 30,
  breaks = seq(0.1, 0.5, 0.1),
  model,
  transform = "none",
  bounds = list(),
  n.cores = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data vector for a single binary trait, with names matching tips in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>The number of times species are randomly deleted for each <code>break</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A vector containing the percentages of species to remove.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The Mkn model to use (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>The evolutionary model to transform the tree (see Details). Default is <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitDiscrete</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitDiscrete</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function randomly removes a given percentage of species (controlled by <code>breaks</code>),  
fits different models of discrete character evolution using <code>fitDiscrete</code>, 
repeats this this many times (controlled by <code>n.sim</code>), stores the results and calculates 
the effects on model parameters Currently, only binary discrete traits are supported.
</p>
<p>Different character model from <code>fitDiscrete</code> can be used, including <code>ER</code> (equal-rates), 
<code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion). 
</p>
<p>Transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used, i.e. <code>none</code>,
<code>EB</code>, <code>lambda</code>, <code>kappa</code> and<code>delta</code>.
</p>
<p>See <code>fitDiscrete</code> for more details on character models and tree transformations. 
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_discrete</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>data</code>: The original full data vector
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>
<p><code>full.model.estimates</code>: Parameter estimates (transition rates q12 and q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for the full model without deleted species.
</p>
<p><code>break.summary.tab</code>: Summary per <code>break</code> of the mean and median effects 
of species removal on percentage and absolute change in parameters q12 and q21.
</p>
<p><code>sensi.estimates</code>: Parameter estimates (transition rates q12 and q21),(percentual) difference 
in parameter estimate compared to the full model (DIFq12, sigsq.q12,sDIFq12, DIFq21, optpar.q21,sDIFq21),  
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for each analysis with a species deleted.
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Gustavo Paterno
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>
<p>Werner, G.D.A., Cornwell, W.K., Sprent, J.I., Kattge, J. &amp; Kiers, E.T. (2014). 
A single evolutionary innovation drives the deep evolution of symbiotic N2-fixation in angiosperms. Nature Communications, 5, 4087.
</p>


<h3>See Also</h3>

<p><code>fitDiscrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Load data:
data("primates")
#Create a binary trait factor 
adultMass_binary&lt;-ifelse(primates$data$adultMass &gt; 7350, "big", "small")
adultMass_binary&lt;-as.factor(as.factor(adultMass_binary))
names(adultMass_binary)&lt;-rownames(primates$data)
#Model trait evolution accounting for sampling size 
samp_binary&lt;-samp_discrete(data = adultMass_binary,phy = primates$phy[[1]],
n.sim=25,breaks=seq(.1,.3,.1),model = "SYM",transform = "none",n.cores = 2,track = TRUE)
#Print summary statistics
summary(samp_binary)
sensi_plot(samp_binary)
sensi_plot(samp_binary,graphs=1)
sensi_plot(samp_binary,graphs=2)
#Use a different evolutionary model or transformation 
samp_binary2&lt;-samp_discrete(data = adultMass_binary,phy = primates$phy[[1]],
n.sim=25,breaks=seq(.1,.3,.1),model = "ARD",transform = "lambda",n.cores = 2,track = TRUE)
summary(samp_binary2)
sensi_plot(samp_binary2)
sensi_plot(samp_binary2,graphs=1)
sensi_plot(samp_binary2,graphs=3)

## End(Not run)
</code></pre>


</div>