<div class="container">

<table style="width: 100%;"><tr>
<td>PeakFilling</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Peak filling of any missed peaks</h2>

<h3>Description</h3>

<p>This functions detects which samples (after grouping) are missing from every peak group and reanalyses the raw data to verify whether this peak is actually non-existent for this sample
</p>


<h3>Usage</h3>

<pre><code class="language-R">PeakFilling(
  Y.grouped,
  Y.spec,
  max.index.shift = 10,
  window.width = "small",
  nCPU = -1,
  FilMethod = "new"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y.grouped</code></td>
<td>
<p>Peaks groups (output from the 'PeakGrouper' function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.spec</code></td>
<td>
<p>The raw NMR spectra in matrix format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.index.shift</code></td>
<td>
<p>Maximal shift in index between a filled peak and the group it belongs to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.width</code></td>
<td>
<p>The width of the detection window for the wavelets. Because of the Fourier transform lengths of 512 ( window.width = 'small') of 1024 ( window.width = 'large') are preferable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCPU</code></td>
<td>
<p>The amount of cpu's to be used for peak detection. If set to '-1' all available cores minus 1 will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FilMethod</code></td>
<td>
<p>A more robust method for peak filling has been implemented. This is now the default. The former method can be used by specifying FilMethod == "old" however this will be deprecated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data frame with grouped peaks and possibly extra peaks obtained from the raw data (these peaks have SNR = NA).
</p>


<h3>Author(s)</h3>

<p>Charlie Beirnaert, <a href="mailto:charlie.beirnaert@uantwerpen.be">charlie.beirnaert@uantwerpen.be</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">subset &lt;- GetWinedata.subset()
# to reduce the example time we only select spectra 1 &amp; 2
subset.spectra = as.matrix(subset$Spectra)[1:2,] 
subset.ppm = as.numeric(subset$PPM)

test.peaks &lt;- getWaveletPeaks(Y.spec=subset.spectra, 
                              X.ppm=subset.ppm,
                              nCPU = 1) # nCPU set to 1 for the vignette build

test.grouped &lt;- PeakGrouper(Y.peaks = test.peaks)

test.filled &lt;- PeakFilling(Y.grouped = test.grouped, 
                           Y.spec = subset.spectra,  
                           nCPU = 1) # nCPU set to 1 for the vignette build


</code></pre>


</div>