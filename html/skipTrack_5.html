<div class="container">

<table style="width: 100%;"><tr>
<td>liMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs MCMC algorithm for performing inference using the model from Li et al. (2022)</h2>

<h3>Description</h3>

<p>This function performs inference on cycle length data, assuming the model from Li et al. (2022). It is important to note
that Li et al. does not actually use this algorithm as they target a particular analytic posterior predictive distribution,
and solve directly. However, we are targeting a different posterior and thus use this MCMC to perform inference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">liMCMC(
  Y,
  cluster,
  S,
  hyperparams = c(kappa = 180, gamma = 6, alpha = 2, beta = 20),
  initialParams = list(pi = c(1/3, 1/3, 1/3), lambdais = rep(30,
    length(unique(cycleDat$Individual))), piis = rep(0.2,
    length(unique(cycleDat$Individual))), ss = sample(0:S, nrow(cycleDat), replace =
    TRUE)),
  reps = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A vector of observed cycle lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A vector indicating the individual cluster/group membership for each observation Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Integer. The maximum number of skips to consider possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperparams</code></td>
<td>
<p>Named numeric vector of hyperparameters containing the
elements: kappa, gamma, alpha, beta. NOTE: MUST BE IN CORRECT ORDER.
</p>

<ul>
<li> <p><code>kappa</code>: Numeric value, shape parameter of Gamma distribution for Lambda_i.
</p>
</li>
<li> <p><code>gamma</code>: Numeric value, rate parameter of Gamma distribution for Lambda_i.
</p>
</li>
<li> <p><code>alpha</code>: Numeric value, shape1 parameter of Beta distribution for Pi_i.
</p>
</li>
<li> <p><code>beta</code>:  Numeric value, shape2 parameter of Beta distribution for Pi_i.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialParams</code></td>
<td>
<p>A list of initial parameter values for the MCMC algorithm.
Default values are provided for pi, lambdais, piis, ss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>The number of MCMC iterations (steps) to perform. Default is 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the MCMC draws for each parameter at each iteration. Each element
in the list is itself a list containing:
</p>

<dl>
<dt>ijDat</dt>
<dd>
<p>A data.frame with updated parameters at the individual-observation level: Individual, ys, lambdais, piis, ss.</p>
</dd>
<dt>iDat</dt>
<dd>
<p>A data.frame with updated parameters at the individual level: Individual, lambdas, pis.</p>
</dd>
<dt>kappa</dt>
<dd>
<p>Fixed value of hyperparameter kappa.</p>
</dd>
<dt>gamma</dt>
<dd>
<p>Fixed value of hyperparameter gamma.</p>
</dd>
<dt>alpha</dt>
<dd>
<p>Fixed value of hyperparameter alpha.</p>
</dd>
<dt>beta</dt>
<dd>
<p>Fixed value of hyperparamter beta.</p>
</dd>
<dt>S</dt>
<dd>
<p>Fixed input value S.</p>
</dd>
<dt>indFirst</dt>
<dd>
<p>A logical vector indicating the first occurrence of each individual.</p>
</dd>
</dl>
<h3>References</h3>

<p>Li, Kathy, et al. "A predictive model for next cycle start date that accounts for adherence in menstrual self-tracking." Journal of the American Medical Informatics Association 29.1 (2022): 3-11.
</p>


<h3>See Also</h3>

<p><code>gibbsStepLi</code>
</p>


</div>