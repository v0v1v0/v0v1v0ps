<div class="container">

<table style="width: 100%;"><tr>
<td>summarizeBaseline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate BASELINe summary statistics</h2>

<h3>Description</h3>

<p><code>summarizeBaseline</code> calculates BASELINe statistics such as the mean selection 
strength (mean Sigma), the 95% confidence intervals and p-values for the presence of
selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">summarizeBaseline(baseline, returnType = c("baseline", "df"), nproc = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p><code>Baseline</code> object returned by calcBaseline containing 
annotations and BASELINe posterior probability density functions 
(PDFs) for each sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnType</code></td>
<td>
<p>One of <code>c("baseline", "df")</code> defining whether
to return a <code>Baseline</code> object ("baseline") with an updated
<code>stats</code> slot or a data.frame ("df") of summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>number of cores to distribute the operation over. If 
<code>nproc</code> = 0 then the <code>cluster</code> has already been
set and will not be reset.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The returned p-value can be either positive or negative. Its magnitude 
(without the sign) should be interpreted as per normal. Its sign indicates 
the direction of the selection detected. A positive p-value indicates positive
selection, whereas a negative p-value indicates negative selection.
</p>


<h3>Value</h3>

<p>Either a modified <code>Baseline</code> object or data.frame containing the 
mean BASELINe selection strength, its 95% confidence intervals, and 
a p-value for the presence of selection.
</p>


<h3>References</h3>


<ol><li>
<p>  Uduman M, et al. Detecting selection in immunoglobulin sequences. 
Nucleic Acids Res. 2011 39(Web Server issue):W499-504.
</p>
</li></ol>
<h3>See Also</h3>

<p>See calcBaseline for generating <code>Baseline</code> objects and
groupBaseline for convolving groups of BASELINe PDFs.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Subset example data
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call == "IGHG")
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=100)

# Collapse clones
db &lt;- collapseClones(db, cloneColumn="clone_id",
                     sequenceColumn="sequence_alignment",
                     germlineColumn="germline_alignment_d_mask",
                     method="thresholdedFreq", minimumFrequency=0.6,
                     includeAmbiguous=FALSE, breakTiesStochastic=FALSE)
                     
# Calculate BASELINe
baseline &lt;- calcBaseline(db, 
                         sequenceColumn="clonal_sequence",
                         germlineColumn="clonal_germline", 
                         testStatistic="focused",
                         regionDefinition=IMGT_V,
                         targetingModel=HH_S5F,
                         nproc = 1)

# Grouping the PDFs by the sample annotation
grouped &lt;- groupBaseline(baseline, groupBy="sample_id")

# Get a data.frame of the summary statistics
stats &lt;- summarizeBaseline(grouped, returnType="df")
                     
</code></pre>


</div>