<div class="container">

<table style="width: 100%;"><tr>
<td>metropolisHastings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a Metropolis-Hastings MCMC algorithm for the parameters of a
Bayesian posterior distribution</h2>

<h3>Description</h3>

<p>Run a Metropolis-Hastings MCMC algorithm for the parameters of a
Bayesian posterior distribution. Note that the algorithm carries over
the old likelihood from the previous iteration, making it suitable for
problems with expensive likelihoods, and also for "exact approximate"
pseudo-marginal or particle marginal MH algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metropolisHastings(init, logLik, rprop, dprop=function(new, old, ...){1},
                   dprior=function(x, ...){1}, iters=10000, thin=10,
                   verb=TRUE, debug=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>An parameter vector with which to initialise the MCMC algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>A function which takes a parameter (such as <code>init</code>) as
its only required argument and returns the log-likelihood of the
data. Note that it is fine for this to return the log of an unbiased
estimate of the likelihood, in which case the algorithm will be an
"exact approximate" pseudo-marginal MH algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rprop</code></td>
<td>
<p>A function which takes a parameter as its only required
argument and returns a single sample from a proposal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dprop</code></td>
<td>
<p>A function which takes a new and old parameter as its
first two required arguments and returns the (log) density of the
new value conditional on the old. It should accept an optional
parameter <code>log</code>, and must return the log-density when <code>log</code> is
<code>TRUE</code>. Defaults to a flat function which causes this term to drop
out of the acceptance probability. It is fine to use the default for
_any_ _symmetric_ proposal, since the term will also drop out for
any symmetric proposal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dprior</code></td>
<td>
<p>A function which take a parameter as its only required
argument and returns the (log) density of the parameter value under
the prior. It should accept an optional
parameter <code>log</code>, and must return the log-density when <code>log</code> is
<code>TRUE</code>. Defaults to a flat function which causes this term to drop
out of the acceptance probability. People often use a flat prior
when they are trying to be "uninformative" or "objective", but this
is slightly naive. In particular, what is "flat" is clearly
dependent on the parametrisation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>The number of MCMC iterations required (_after_
thinning).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The required thinning factor. eg. only store every <code>thin</code>
iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>Boolean indicating whether some progress information
should be printed to the console. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>Boolean indicating whether debugging information is required. Prints
information about each iteration to console, to, eg., debug a crashing sampler.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with rows representing samples from the posterior distribution.
</p>


<h3>See Also</h3>

<p><code>pfMLLik</code>, <code>StepGillespie</code>, <code>abcRun</code>,
<code>simTs</code>, <code>stepLVc</code>, <code>metrop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## First simulate some synthetic data
data = rnorm(250,5,2)
## Now use MH to recover the parameters
llik = function(x) { sum(dnorm(data,x[1],x[2],log=TRUE)) }
prop = function(x) { rnorm(2,x,0.1) }
prior = function(x, log=TRUE) {
    l = dnorm(x[1],0,100,log=TRUE) + dgamma(x[2],1,0.0001,log=TRUE)
    if (log) l else exp(l)
}
out = metropolisHastings(c(mu=1,sig=1), llik, prop,
                         dprior=prior, verb=FALSE)
out = out[1000:10000,]
mcmcSummary(out, truth=c(5,2), rows=2, plot=FALSE)
</code></pre>


</div>