<div class="container">

<table style="width: 100%;"><tr>
<td>define_fact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define facts in a <code>dimensional_model</code> object</h2>

<h3>Description</h3>

<p>To define facts in a <code>dimensional_model</code> object, the essential data is a name
and a set of measurements that can be empty (does not have explicit
measurements). Associated with each measurement, an aggregation function is
required, which by default is SUM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">define_fact(
  st,
  name = NULL,
  measures = NULL,
  agg_functions = NULL,
  nrow_agg = "nrow_agg"
)

## S3 method for class 'dimensional_model'
define_fact(
  st,
  name = NULL,
  measures = NULL,
  agg_functions = NULL,
  nrow_agg = "nrow_agg"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>A <code>dimensional_model</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A string, name of the fact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measures</code></td>
<td>
<p>A vector of measure names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_functions</code></td>
<td>
<p>A vector of aggregation function names. If none is
indicated, the default is SUM. Additionally they can be MAX or MIN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow_agg</code></td>
<td>
<p>A string, measurement name for the number of rows aggregated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To get a star schema (a <code>star_schema</code> object) we need a flat table
(implemented through a <code>tibble</code>) and a <code>dimensional_model</code> object. The
definition of facts in the <code>dimensional_model</code> object is made from the flat
table column names. Using the <code>dput</code> function we can list the column names of
the flat table so that we do not have to type their names.
</p>
<p>Associated with each measurement there is an aggregation function that can be
SUM, MAX or MIN. Mean is not considered among the possible aggregation
functions: The reason is that calculating the mean by considering subsets of
data does not necessarily yield the mean of the total data.
</p>
<p>An additional measurement corresponding to the number of aggregated rows is
always added which, together with SUM, allows us to obtain the mean if
needed.
</p>


<h3>Value</h3>

<p>A <code>dimensional_model</code> object.
</p>


<h3>See Also</h3>

<p>Other star definition functions: 
<code>define_dimension()</code>,
<code>dimensional_model()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# dput(colnames(mrs_age))
#
# c(
#   "Reception Year",
#   "Reception Week",
#   "Reception Date",
#   "Data Availability Year",
#   "Data Availability Week",
#   "Data Availability Date",
#   "Year",
#   "WEEK",
#   "Week Ending Date",
#   "REGION",
#   "State",
#   "City",
#   "Age Range",
#   "Deaths"
# )

dm &lt;- dimensional_model() |&gt;
  define_fact(
    name = "mrs_age",
    measures = c("Deaths"),
    agg_functions = c("SUM"),
    nrow_agg = "nrow_agg"
  )

dm &lt;- dimensional_model() |&gt;
  define_fact(
    name = "mrs_age",
    measures = c("Deaths")
  )

dm &lt;- dimensional_model() |&gt;
  define_fact(name = "Factless fact")

</code></pre>


</div>