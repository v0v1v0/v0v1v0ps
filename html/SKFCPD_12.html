<div class="container">

<table style="width: 100%;"><tr>
<td>CPD_DLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Setting up the CPD_DLM model
</h2>

<h3>Description</h3>

<p>Implementing the robust GaSP model for estimating the changepoint locations. The range parameter and noise-to-signal ratio are estimated from the training samples by a Gaussian process model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  CPD_DLM(design, response, gamma,model_type, mu, sigma_2, eta,
         kernel_type, stop_at_first_cp, hazard_vec,
         truncate_at_prev_cp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>A matrix with dimension n x p. The design of the experiment. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A matrix with dimension n x q. The observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>A numeric variable of the range parameter for the covariance matrix. The default value of gamma is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_type</code></td>
<td>
<p>A numeric variable that can take values of 0, 1 and 2. Model_type=0 stands for a GP model with unknown mean and known variance. Model_type=1 stands for a GP model with known mean and unknown variance. Model_type=2 stands for a GP model with unknown mean and unknown variance. The default value of model_type is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A vector of the mean parameter at each coordinate. Ignored when model_type = 0 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_2</code></td>
<td>
<p>A vector of the variance parameter at each coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>A vector of the noise-to-signal ratio at each coordinate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_type</code></td>
<td>
<p>A character specifying the type of kernels of the input. <code>matern_5_2</code> are <code>Matern correlation</code> with roughness parameter 5/2. <code>exp</code> is power exponential correlation with roughness parameter alpha=2. The default choice is <code>matern_5_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_at_first_cp</code></td>
<td>
<p>A numeric variable that decides if the SKFCPD method stops when it detects the first changepoint. The default value of stop_at_first_cp is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard_vec</code></td>
<td>
<p>The hazard vector in the SKFCPD method. 1/vector is the prior probability that a changepoint occur at a vector of time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate_at_prev_cp</code></td>
<td>
<p>If TRUE, truncate the run length at the most recently detected changepoint. The default value of truncate_at_prev_cp is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>SKFCPD</code> returns a S4 object of class <code>SKFCPD</code> (see <code>SKFCPD-class</code>).
</p>


<h3>Author(s)</h3>

<p>Hanmo Li [aut, cre],
  Yuedong Wang [aut],
  Mengyang Gu [aut]
</p>
<p>Maintainer: Hanmo Li &lt;hanmo@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>Li, Hanmo, Yuedong Wang, and Mengyang Gu. <em>Sequential Kalman filter for fast online changepoint detection in longitudinal health records.</em> arXiv preprint arXiv:2310.18611 (2023).
</p>
<p>Fearnhead, Paul, and Zhen Liu. <em>On-line inference for multiple changepoint problems.</em> Journal of the Royal Statistical Society Series B: Statistical Methodology 69, no. 4 (2007): 589-605.
</p>
<p>Adams, Ryan Prescott, and David JC MacKay. <em>Bayesian online changepoint detection.</em> arXiv preprint arXiv:0710.3742 (2007).
</p>
<p>Hartikainen, Jouni, and Simo Sarkka. <em>Kalman filtering and smoothing solutions to temporal Gaussian process regression models.</em> In 2010 IEEE international workshop on machine learning for signal processing, pp. 379-384. IEEE, 2010.
</p>


</div>