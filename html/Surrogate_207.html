<div class="container">

<table style="width: 100%;"><tr>
<td>TwoStageSurvSurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess trial-level surrogacy for two survival endpoints using a two-stage approach</h2>

<h3>Description</h3>

<p>The function <code>TwoStageSurvSurv</code> uses a two-stage approach to estimate <code class="reqn">R^2_{trial}</code>. In stage 1, trial-specific Cox proportional hazard models are fitted and in stage 2 the trial-specific estimated treatment effects on <code class="reqn">T</code> are regressed on the trial-specific estimated treatment effects on <code class="reqn">S</code> (measured on the log hazard ratio scale). The user can specify whether a weighted or unweighted model should be fitted at stage 2. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">TwoStageSurvSurv(Dataset, Surr, SurrCens, True, TrueCens, Treat,
Trial.ID, Weighted=TRUE, Alpha=.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value and censoring indicator, a true endpoint value and censoring indicator, a treatment indicator, and a trial ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SurrCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the surrogate endpoint values (1 = event, 0 = censored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TrueCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the true endpoint values (1 = event, 0 = censored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A two-stage approach is used to estimate trial-level surrogacy, following a procedure proposed by Buyse et al. (2011). In stage 1, the following trial-specific Cox proportional hazard models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}(t)=S_{i0}(t) exp(\alpha_{i}Z_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}(t)=T_{i0}(t) exp(\beta_{i}Z_{ij}),</code>
</p>
 
<p>where <code class="reqn">S_{i0}(t)</code> and <code class="reqn">T_{i0}(t)</code> are the trial-specific baseline hazard functions, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific treatment effects on S and T, respectively. 
</p>
<p>Next, the second stage of the analysis is conducted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_{i}}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on the full model that was fitted in stage 1. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>TwoStageSurvSurv</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of trials that do not have at least three patients per treatment arm are excluded due to estimation constraints (Burzykowski et al., 2001). <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific log hazard ratio estimates of the treatment effects for the surrogate and the true endpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., Buyse, M., Geys, H., &amp; Renard, D. (2001). Validation of surrogate endpoints in multiple randomized clinical trials with failure-time endpoints. <em>Applied Statistics, 50,</em> 405-422. 
</p>
<p>Buyse, M., Michiels, S., Squifflet, P., Lucchesi, K. J., Hellstrand, K., Brune, M. L., Castaigne, S., Rowe, J. M. (2011). Leukemia-free survival as a surrogate end point for overall survival in the evaluation of maintenance therapy for patients with acute myeloid leukemia in complete remission. <em>Haematologica, 96,</em> 1106-1112.
</p>


<h3>See Also</h3>

<p>plot.TwoStageSurvSurv
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Open Ovarian dataset
data(Ovarian)

# Conduct analysis
Results &lt;- TwoStageSurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd, 
True = Surv, TrueCens = SurvInd, Treat = Treat, Trial.ID = Center)

# Examine results of analysis
summary(Results)
plot(Results)
</code></pre>


</div>