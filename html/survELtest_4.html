<div class="container">

<table style="width: 100%;"><tr>
<td>intELtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The integrated EL test</h2>

<h3>Description</h3>

<p><code>intELtest</code> gives a class of integrated EL statistics:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^{m}w_i\cdot \{-2\log R(t_i)\},</code>
</p>

<p>where <code class="reqn">R(t)</code> is the EL ratio that compares the survival functions at each given time <code class="reqn">t</code>,
<code class="reqn">w_i</code> is the weight at each <code class="reqn">t_i</code>, and <code class="reqn"> 0&lt;t_1&lt;\ldots&lt;t_m&lt;\infty</code> are the (ordered)
observed uncensored times at which the Kaplanâ€“Meier estimate is positive and less than <code class="reqn">1</code> for
each sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intELtest(
  formula,
  data = NULL,
  group_order = NULL,
  t1 = 0,
  t2 = Inf,
  sided = 2,
  nboot = 1000,
  wt = "p.event",
  alpha = 0.05,
  seed = 1011,
  nlimit = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object with a <code>Surv</code> object as the response on the left of the <code>~</code> operator and 
the grouping variable as the term on the right. The <code>Surv</code> object involves two variables: the observed survival 
and censoring times, and the censoring indicator, which takes a value of <code class="reqn">1</code> if the observed time is uncensored 
and <code class="reqn">0</code> otherwise. The grouping variable takes different values for different groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the <code>formula</code>: the observed survival and censoring times,
the censoring indicator, and the grouping variable. If not found in <code>data</code>, the variables in the <code>formula</code> should 
be already defined by the user or in attached <code>R</code> objects. The default is the data frame with three columns of 
variables taken from the formula: column 1 contains the observed survival and censoring times, column 2 the censoring 
indicator, and column 3 the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_order</code></td>
<td>
<p>a <code class="reqn">k</code>-vector containing the values of the grouping variable, with the <code class="reqn">j</code>-th element being the group
hypothesized to have the <code class="reqn">j</code>-th highest survival rates, <code class="reqn">j=1,\ldots,k</code>. The default is the vector of sorted grouping variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>the first endpoint of a prespecified time interval, if any, to which the comparison of the survival functions is restricted. 
The default value is <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>the second endpoint of a prespecified time interval, if any, to which the comparison of the survival 
functions is restricted. The default value is <code class="reqn">\infty</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p><code class="reqn">2</code> if two-sided test, and <code class="reqn">1</code> if one-sided test. The default value is <code class="reqn">2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replications in calculating critical values for the tests. 
The default value is <code class="reqn">1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>the name of the weight for the integrated EL statistics:
<code>"p.event"</code>, <code>"dF"</code>, or <code>"dt"</code>. The default is <code>"p.event"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the pre-specified significance level of the tests. The default value is <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed for the random number generator in <code>R</code>, for generating bootstrap samples needed 
to calculate the critical values for the tests. The default value is <code class="reqn">1011</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlimit</code></td>
<td>
<p>a number used to calculate <code>nsplit=</code> <code class="reqn">m</code><code>/nlimit</code>, the number of 
parts into which the calculation of the <code>nboot</code> bootstrap replications is split. 
The use of this variable can make computation faster when the number of time points <code class="reqn">m</code> is large. 
The default value for <code>nlimit</code> is 200.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are three options for the weight <code class="reqn">w_i</code>:
</p>

<ul>
<li>
<p> (<code>wt = "p.event"</code>) <br>
This default option is an objective weight,
</p>
<p style="text-align: center;"><code class="reqn">w_i=\frac{d_i}{n},</code>
</p>

<p>which assigns weight proportional to the number of events <code class="reqn">d_i</code>
at each observed uncensored time <code class="reqn">t_i</code>. Here <code class="reqn">n</code> is the total sample size.
</p>
</li>
<li>
<p> (<code>wt = "dF"</code>) <br>
Inspired by the integral-type statistics considered in Barmi and McKeague (2013),
another weigth function is
</p>
<p style="text-align: center;"><code class="reqn">w_i= \hat{F}(t_i)-\hat{F}(t_{i-1}),</code>
</p>

<p>for <code class="reqn">i=1,\ldots,m</code>, where <code class="reqn">\hat{F}(t)=1-\hat{S}(t)</code>, <code class="reqn">\hat{S}(t)</code> is the pooled KM estimator, and <code class="reqn">t_0 \equiv 0</code>.
This reduces to the objective weight when there is no censoring. The resulting <code class="reqn">I_n</code> can be seen as an empirical
version of the expected negative two times log EL ratio under <code class="reqn">H_0</code>.
</p>
</li>
<li>
<p> (<code>wt = "dt"</code>) <br>
Inspired by the integral-type statistics considered in Pepe and Fleming (1989), another weight function is
</p>
<p style="text-align: center;"><code class="reqn">w_i= t_{i+1}-t_i,</code>
</p>
 
<p>for <code class="reqn">i=1,\ldots,m</code>, where <code class="reqn">t_{m+1} \equiv t_{m}</code>. This gives more weight to the time intervals where 
there are fewer observed uncensored times, but can be affected by extreme observations.
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>intELtest</code> returns a <code>intELtest</code> object, a list with 15 elements:
</p>

<ul>
<li> <p><code>call</code> the function call
</p>
</li>
<li> <p><code>teststat</code> the resulting integrated EL statistics
</p>
</li>
<li> <p><code>critval</code> the critical value based on bootstrap
</p>
</li>
<li> <p><code>pvalue</code> the p-value of the test
</p>
</li>
<li> <p><code>formula</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>data</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>group_order</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>t1</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>t2</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>sided</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>nboot</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>wt</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>alpha</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>seed</code> the value of the input argument of intELtest
</p>
</li>
<li> <p><code>nlimit</code> the value of the input argument of intELtest
</p>
</li>
</ul>
<p>Methods defined for <code>intELtest</code> objects are provided for <code>print</code> and <code>summary</code>.
</p>


<h3>References</h3>


<ul>
<li>
<p> H. Chang, I.W. McKeague, "Nonparametric testing for multiple survival functions 
with non-inferiority margins," <em>Annals of Statistics</em>, Vol. 47, No. 1, pp. 205-232, (2019).
</p>
</li>
<li>
<p> M. S. Pepe and T. R. Fleming, "Weighted Kaplan-Meier
Statistics: A Class of Distance Tests for Censored Survival Data," <em>Biometrics</em>,
Vol. 45, No. 2, pp. 497-507 (1989).
<a href="https://www.jstor.org/stable/2531492?seq=1#page_scan_tab_contents">https://www.jstor.org/stable/2531492?seq=1#page_scan_tab_contents</a>
</p>
</li>
<li>
<p> H. E. Barmi and I.W. McKeague, "Empirical likelihood-based tests
for stochastic ordering," <em>Bernoulli</em>, Vol. 19, No. 1, pp. 295-307 (2013).
<a href="https://projecteuclid.org/euclid.bj/1358531751">https://projecteuclid.org/euclid.bj/1358531751</a>
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>hepatitis</code>, <code>supELtest</code>, <code>ptwiseELtest</code>, <code>nocrossings</code>, <code>print.intELtest</code>, <code>summary.intELtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survELtest)
intELtest(survival::Surv(hepatitis$time, hepatitis$censor) ~ hepatitis$group)

## OUTPUT:
## Call:
## intELtest(formula = survival::Surv(hepatitis$time, hepatitis$censor) ~ 
##     hepatitis$group)
## 
## Two-sided integrated EL test statistic = 1.42, p = 0.007
</code></pre>


</div>