<div class="container">

<table style="width: 100%;"><tr>
<td>random-effects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Structure of random effects
</h2>

<h3>Description</h3>

<p>The structure of random-effect models adjustable by spaMM can generally be described by the following steps. 
</p>
<p>First, independent and  identically distributed (iid) random effects <b>u</b> are drawn from one of the following distributions:  <b>Gaussian</b> with zero mean, unit variance, and identity link; <b>Beta</b>-distributed, where <code class="reqn">u</code> <code>~</code> <code class="reqn">B(1/(2\lambda),1/(2\lambda))</code> with mean=1/2, and var<code class="reqn">=\lambda/[4(1+\lambda)]</code>; and with logit link <code>v=logit(u)</code>;
<b>Gamma</b>-distributed random effects, where <code class="reqn">u</code><code> ~ Gamma(shape=</code>1+1/<code class="reqn">\lambda</code>,<b>scale=</b>1/<code class="reqn">\lambda</code>): see <code>Gamma</code> for allowed links and further details; and <b>Inverse-Gamma</b>-distributed random effects, where <code class="reqn">u</code> <code>~</code> inverse-Gamma(<code>shape=</code>1+1/<code class="reqn">\lambda</code>,<b>rate=</b>1/<code class="reqn">\lambda</code>): see <code>inverse.Gamma</code> for allowed links and further details.
</p>
<p>Second, a transformation <b>v</b><code class="reqn">=f</code>(<b>u</b>) is applied (this defines <b>v</b> whose elements are still iid). By default, <b>v</b>=<b>u</b> for gaussian random effects but not necessarily for other distributions of random effects (see <code>Gamma</code>).
</p>
<p>Third, correlated random effects are obtained as <b>Mv</b>, where the matrix <b>M</b> can describe spatial correlation between observed locations, block effects (or repeated observations in given locations), and possibly also correlations involving unobserved locations (as is often the case for autoregressive models). In most cases <b>M</b> is determined from the model formula, but it can also be controlled by covStruct argument. <b>M</b> takes the form <b>ZL</b> or <b>ZAL</b>, where <b>Z</b> is determined from the model formula, the optional <b>A</b> factor is given by the optional <code>"AMatrices"</code> attribute of argument <code>covStruct</code> of <code>HLCor</code> (also handled by <code>fitme</code> and <code>corrHLfit</code>), and <b>L</b> can be determined from the model formula or from <code>covStruct</code>. In particular:
</p>
<p><code style="white-space: pre;">⁠ * ⁠</code><b>Z</b> is typically an incidence matrix: its elements <code class="reqn">z_{ij}</code> are 1 if the <code class="reqn">i</code>th observation is affected by the <code class="reqn">j</code>th  element of <code>ALb</code>, and zero otherwise.<br></p>
<p><code style="white-space: pre;">⁠ * ⁠</code>For spatial random effects, <b>L</b> is typically the Cholesky “square root” of a correlation matrix determined by the random effect specification (e.g., <code>Matern(...)</code>), or given by the <code>covStruct</code> argument. This may be meaningful only for Gaussian random effects. Coefficients for each level of a random-coefficient model can also be represented as <b>Lv</b> where <b>L</b> is the “square root” of a correlation matrix.<br></p>
<p><code style="white-space: pre;">⁠ * ⁠</code>If there is one response value par location, <b>L</b> for a spatial random effect is thus a square matrix whose dimension is the number of observations. Alternatively, several observations may be taken in the same location, and a matrix <b>Z</b> (automatically constructed) tells which element of <b>Lv</b> affects each observation. The linear predictor then contains a term of the form <b>ZLv</b>, where <code>dim(Z)</code> is (number of observations,number of locations). 
</p>
<p><code style="white-space: pre;">⁠ * ⁠</code>in <code>IMRF</code> random effects (IMRF for Interpolated Markov Random Fields), the realized random effects in response locations are defined as linear combinations <b>ALv</b> of random effects <b>Lv</b> in distinct locations. In that case the dimension of <b>L</b> is the number of such distinct locations, an automatically constructed <b>A</b> matrix maps them to the observed locations, and <b>Z</b> again maps them to possibly repeated observations in observed locations.
</p>


</div>