<div class="container">

<table style="width: 100%;"><tr>
<td>network_knn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-nearest points on network</h2>

<h3>Description</h3>

<p>Calculate the K-nearest points for a set of points on a network.
</p>


<h3>Usage</h3>

<pre><code class="language-R">network_knn(
  origins,
  lines,
  k,
  destinations = NULL,
  maxdistance = 0,
  snap_dist = Inf,
  line_weight = "length",
  direction = NULL,
  grid_shape = c(1, 1),
  verbose = FALSE,
  digits = 3,
  tol = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>origins</code></td>
<td>
<p>A feature collection of points, for each point, its k nearest
neighbours will be found on the network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>A feature collection of linestrings representing the underlying network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer indicating the number of neighbours to find.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destinations</code></td>
<td>
<p>A feature collection of points, might be used if the neighbours
must be found in a separate set of points NULL if the neighbours must be found in
origins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdistance</code></td>
<td>
<p>The maximum distance between two observations to
consider them as neighbours. It is useful only if a grid is used, a
lower value will reduce calculating time, but one must be sure that the
k nearest neighbours are within this radius. Otherwise NAs will be present
in the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snap_dist</code></td>
<td>
<p>The maximum distance to snap the start and end points on
the network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_weight</code></td>
<td>
<p>The weighting to use for lines. Default is "length"
(the geographical length), but can be the name of a column. The value is
considered proportional to the geographical length of the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>The name of a column indicating authorized
travelling direction on lines. if NULL, then all lines can be used in both
directions. Must be the name of a column otherwise. The values of the
column must be "FT" (From - To), "TF" (To - From) or "Both".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_shape</code></td>
<td>
<p>A vector of length 2 indicating the shape of the grid to
use for splitting the dataset. Default is c(1,1), so all the calculation is
done in one go. It might be necessary to split it if the dataset is large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A Boolean indicating if the function should print its
progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to retain from the spatial coordinates (
simplification used to reduce risk of topological error)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A float indicating the minimum distance between the points and the
lines' extremities when adding the point to the network. When points are
closer, they are added at the extremity of the lines.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The k nearest neighbours of each point are found by using the network distance.
The results could not be exact if some points share the exact same location. As an example,
consider the following case. If A and B are two points at the exact same location, and C is
a third point close to A and B. If the 1 nearest neighbour is requested for C, the function
could return either A or B but not both. When such situation happens, a warning is raised by
the function.
</p>


<h3>Value</h3>

<p>A list with two matrices, one with the index of the neighbours and
one with the distances.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
    data(main_network_mtl)
    data(mtl_libraries)
    results &lt;- network_knn(mtl_libraries, main_network_mtl,
        k = 3, maxdistance = 1000, line_weight = "length",
        grid_shape=c(1,1), verbose = FALSE)

</code></pre>


</div>