<div class="container">

<table style="width: 100%;"><tr>
<td>MCdof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Monte Carlo Degrees of Freedom
</h2>

<h3>Description</h3>

<p>Estimate the distribution of the proportion of spatial locations that contain significant correlations with randomly generated data along the lines of Livezey and Chen (1983).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCdof(x, ntrials = 5000, field.sig = 0.05, zfun = "rnorm", zfun.args = NULL,
      which.test = c("t", "Z", "cor.test"), verbose = FALSE, ...)

sig.cor.t(r, len = 40, ...)

sig.cor.Z(r, len = 40, H0 = 0)

fisherz(r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>n by m numeric matrix whose rows represent temporal points, and whose columns are spatial locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrials</code></td>
<td>

<p>numeric/integer giving the number of times to generate random samples of size n, and correlate them with the columns of <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>field.sig</code></td>
<td>

<p>numeric between 0 and 1 giving the desired fields significance level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zfun</code></td>
<td>

<p>character naming a random number generator that takes <code>n</code> (the size of the sample to be drawn) as an argument, and any other arguments necessary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zfun.args</code></td>
<td>

<p>list object giving the values for additional arguments to the function named by <code>zfun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.test</code></td>
<td>

<p>character naming which type of test to do (default, “t”, is a t-test, calls <code>sig.cor.t</code>). “Z” does Fisher's Z transform (calls <code>sig.cor.Z</code>).   “cor.test” calls <code>cor.test</code> giving more options, but is also considerably slower than “t” or “Z”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>numeric giving the correlation value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>numeric giving the size of the data for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>numeric giving the null hypothesis value (not used by <code>MCdof</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical, should progress information (including total run time) be printed to the screen?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments to <code>sig.cor.t</code> (not used), <code>sig.cor.Z</code>, or <code>cor.test</code> depending on argument <code>which.test</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function does the Livezey and Chen (1983) Monte Carlo step 2 (a) from Elmore et al. (2006).  It generates a random sample of size n, and finds the p-values of a correlation test with this random sample and each column of <code>x</code>.  From this, it estimates the proportion of spatial locations that could contain significant bias purely by chance.
</p>


<h3>Value</h3>

<p>MCdof returns a list object with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MCprops </code></td>
<td>
<p>numeric vector of length ntrials giving the proportion of locations with significant bias found by chance for each repition of the experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsigcov </code></td>
<td>
<p> single numeric giving the 1 - field.sig quantile of the resulting proportions given by MCprops.</p>
</td>
</tr>
</table>
<p>sig.cor.t and sig.cor.Z return umeric vectors of p-values, and fisherz returns a numeric vector of test statistics.
</p>


<h3>Author(s)</h3>

<p>Kimberly L. Elmore, Kim.Elmore “at” noaa.gov, and Eric Gilleland
</p>


<h3>References</h3>

<p>Elmore, K. L., Baldwin, M. E. and Schultz, D. M. (2006) Field significance revisited: Spatial bias errors in forecasts as applied to the Eta model.  <em>Mon. Wea. Rev.</em>, <b>134</b>, 519–531.
</p>
<p>Livezey, R. E. and Chen, W. Y. (1983) Statistical field significance and its determination by Monte Carlo techniques.  <em>Mon. Wea. Rev.</em>, <b>111</b>, 46–59.
</p>


<h3>See Also</h3>

<p><code>spatbiasFS</code>, <code>LocSig</code>, <code>cor.test</code>, <code>rnorm</code>, <code>runif</code>, <code>rexp</code>, <code>rgamma</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( "GFSNAMfcstEx" )
data( "GFSNAMobsEx" )
data( "GFSNAMlocEx" )

id &lt;- GFSNAMlocEx[,"Lon"] &gt;=-90 &amp; GFSNAMlocEx[,"Lon"] &lt;= -75 &amp; GFSNAMlocEx[,"Lat"] &lt;= 40

look &lt;- MCdof(GFSNAMfcstEx[,id] - GFSNAMobsEx[,id], ntrials=500)

stats(look$MCprops)
look$minsigcov

fisherz( abs(cor(rnorm(10),rexp(10), use="pairwise.complete.obs")))

</code></pre>


</div>