<div class="container">

<table style="width: 100%;"><tr>
<td>StVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Student's t Vector Autoregression (StVAR)
</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of Student's t vector autoregression (VAR) model is the purpose of this function. It can be used to estimate the linear autoregressive function (conditional mean) and the quadratic 
autoskedastic function (conditional variance). Users can specify the model with deterministic variables such as trends and dummies in the matrix form.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StVAR(Data,Trend=1,lag=1,v=1,maxiter=1000,meth="BFGS",hes="FALSE",init="na")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>A data matrix with at least two columns. Cannot be empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trend</code></td>
<td>
<p>A matrix with columns representing deterministic variables like trends and dummies. If 1 (default), model with only constant intercept is estimated. If 0, the model is estimated without the intercept term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>A positive integer (default value is 1) as lag length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A scalar (default value is 1) greater than or equal to 1. Degrees of freedom parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iteration. Must be an integer bigger than 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p>One of the optimization method from <code>optim</code> function (default value is BFGS). See details of <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hes</code></td>
<td>
<p>Logical (default value is FALSE). If TRUE produces estimated hessian matrix and the standard errors of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>If na (default), initial values for optimization are generated from a uniform distribution. A vector of initial values can also be used
(not recommended). The length of the init vector must be equal to the number of parameters of the joint distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the functional form of the autoregressive function and the autoskedastic function, see Spanos (1994) and Poudyal (2012).</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>coefficients of the autoregressive function including the coefficients of trends in matrix form with standard errors and p-values. If some of the standard errors are 
NA's, the <code>StVAR()</code> function has to be run again.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.coef</code></td>
<td>
<p>coefficients of the autoskedastic (conditional variance) function, standard errors and p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>like</code></td>
<td>
<p>maximum log likelihood value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>contemporary variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvar</code></td>
<td>
<p><code>(v/(v+lag*l-2))*sigma*cvar</code> is the fitted value of the autoskedastic function where <code>l</code> is the rank of <code>Data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trends</code></td>
<td>
<p>estimated trends in the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>non-standardized residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>fitted values of the autoregressive function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>estimates of the joint distribution parameters. It can be used as new initial value <code>init</code> in <code>StVAR()</code> to improve optimization further.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hes</code></td>
<td>
<p>the estimated hessian matrix if <code>hes=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>variance covariance matrix of the joint distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.squared</code></td>
<td>
<p>R-squared of each equation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.stat</code></td>
<td>
<p>F-statistics of each equation of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ad</code></td>
<td>
<p>Anderson-Darling test for Student's t distribution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Niraj Poudyal <a href="mailto:niraj.poudyal@ku.edu.np">niraj.poudyal@ku.edu.np</a>
</p>


<h3>References</h3>

<p>Poudyal, N. and Spanos, A. (2022), Model Validation and DSGE Modeling. Econometrics, 10 (2), 17.
</p>
<p>Spanos, A. (1994), On Modeling Heteroskedasticity: the Student's t and Elliptical
Linear Regression Models. Econometric Theory, 10: 286-315.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## StVAR Model#####
  ## Random number seed
  set.seed(7504)

  ## Creating trend variable.
  t &lt;- seq(1,50,1)
  y &lt;- x &lt;- vector(length=50)
  y[1] &lt;- x[1] &lt;- 0
  # Generating data on y and x.
  ut &lt;- rt(50,df=5)
  for(i in 2:50)
  {
  y[i] &lt;-  0.004 + 0.0045*t[i] - 0.9*y[i-1] + .2*x[i-1] + ut[i]
  x[i] &lt;-  0.05 - 0.005*t[i] + 0.8*x[i-1] + 1*y[i-1] + ut[i]
  }

  # The trend matrix

  Trend &lt;- cbind(1,t)

  # Estimating the model
  stvar &lt;- StVAR(cbind(y,x),lag=1,Trend=Trend,v=6,maxiter=2000,hes=TRUE)
  
  # Generate arbitrary dates
  dates &lt;- seq(as.Date("2014/1/1"), as.Date("2016/1/1"), "weeks")

  ## Plotting the variable y, its estimated trend and the fitted value.
  oldpar &lt;- par(mfcol=c(3,1))
  matplot(dates[2:length(y)],cbind(y[2:length(y)],stvar$fit[,1],stvar$trend[,1]),xlab="Months",
  type='l',lty=c(1,2,3), lwd=c(1,1,3),col=c("black","blue","black"),ylab=" ",xaxt="n")
  axis.Date(1, at = seq(as.Date("2014/1/1"), as.Date("2016/1/1"), "months"),labels=TRUE)
  legend("bottomleft",legend=c("data","trend","fitted values"),lty=c(1,2,3),lwd=c(1,1,3),
  col=c("black","blue","black"),cex=.85)
  hist(stvar$res[,1],main="",xlab="") ## Histogram of y
  matplot(dates[2:length(y)],cbind(stvar$cvar),xlab="Months",type='l',lty=2,lwd=1,
  ylab="fitted variance",xaxt="n")
  axis.Date(1, at = seq(as.Date("2014/1/1"), as.Date("2016/1/1"), "months"),labels=TRUE)
  par(oldpar)

  ## Plotting the variable x, its estimated trend and the fitted value.
  oldpar &lt;- par(mfcol=c(3,1))
  matplot(dates[2:length(x)],cbind(x[2:length(x)],stvar$fit[,2],stvar$trend[,2]),
  xlab="Months",type='l',lty=c(1,2,3),lwd=c(1,1,3),col=c("black","blue","black"),ylab=" ",xaxt="n")
  axis.Date(1, at = seq(as.Date("2014/1/1"), as.Date("2016/1/1"), "months"),labels=TRUE)
  legend("bottomleft",legend=c("data","trend","fitted values"),lty=c(1,2,3),lwd=c(1,1,3),
  col=c("black","blue","black"),cex=.85)
  hist(stvar$res[,2],main="",xlab="") ## Histogram of x
  matplot(dates[2:length(x)],cbind(stvar$cvar),xlab="Months",type='l',lty=2,lwd=1,
  ylab="fitted variance",xaxt="n")
  axis.Date(1,at=seq(as.Date("2014/1/1"),as.Date("2016/1/1"),"months"),labels=TRUE)
  par(oldpar) 
</code></pre>


</div>