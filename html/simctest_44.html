<div class="container">

<table style="width: 100%;"><tr>
<td>mcp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function mcp in package ‘simctest’</h2>

<h3>Description</h3>

<p>An algorithm for the computation of the power of Monte Carlo tests with guaranteed precision</p>


<h3>Usage</h3>

<pre><code class="language-R">mcp(genstream,alpha=0.05,delta="adaptive",
cp=0.99,maxeffort=Inf,options = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genstream</code></td>
<td>
<p>a function that returns a function that returns a
random Bernoulli variable (each stream corresponds to a
dataset. 0 = (T&lt;t), 1= (T&gt;=t) where t is computed from the dataset
and T is a resampled test-statistic from that dataset.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the level of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the desired length of confidence interval, or "adaptive" if using adaptive delta. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeffort</code></td>
<td>
<p>maximum effort. Effort is total number of samples taken. Set to finite value if needed (the resulting confidence interval still has the guaranteed coverage probability, but may not be as ‘short’ as desired). Can also interrupt the algorithm during main loop and get a result of class <code>"mcpres"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp</code></td>
<td>
<p>the desired coverage probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Additional options. See details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>options$maxeffort</code>: set to maximum allowable effort.
</p>
<p><code>options$reports</code>: set to <code>FALSE</code> if onscreen reports are not wanted. 
</p>
<p><code>options$file</code>: optional file-name to save results to.
</p>
<p><code>options$pilotn</code>: number of streams in pilot (1000 by default).
</p>
<p><code>options$pilotmaxsteps</code>: maxsteps in pilot (1000 by default).
</p>
<p><code>options$gammapilotprop</code>: proportion of error spent on pilot CI
(0.1 by default)
</p>
<p><code>options$gammatestprop</code>: proportion of error spent on testing
remaining paths (default is 0.1)
</p>
<p><code>options$spendgammatest</code>: spending sequence for the testing
procedure on the remaining streams. Must be a non-negative function
of integers with positive limit 1 (<code class="reqn">t/(20+t)</code> by default).
</p>
<p><code>options$eta</code>: internal parameter to the testing procedure on the
remaining streams (0.05 by default).
</p>
<p><code>options$maxstepsbase</code>: initial maximum number of steps (500 by
default)
</p>
<p><code>options$maxstepsinc</code>: multiplier for the maximum number of steps
thereafter (1.5 by default).
</p>
<p><code>options$maxbatch</code>: multiplier for the maximum number of steps
thereafter (200000 by default).
</p>
<p><code>options$deltamid</code>: adaptive delta function. Describes the length
of the confidence interval desired depending on the midpoint of the
interval. By default the function requires 0.02 for intervals
containing 0.05 or lower or 0.95 or higher, and 0.1 otherwise. If
using non-default adaptive delta must also specify epsilon
(below).
</p>
<p><code>options$epsilon</code>: error probability for each stream. Only set if using non-standard adaptive delta.
</p>


<h3>Value</h3>

<p>An object of class <code>"mcpres"</code> with slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>confidence interval for power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp</code></td>
<td>
<p>coverage probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimate of power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the number of streams started in main loop (or in pilot if
stopped after pilot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effort</code></td>
<td>
<p>total number of samples generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescount</code></td>
<td>
<p>number of positive and negative outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncated</code></td>
<td>
<p>boolean indicating whether procedure was truncated by
user-specified maxeffort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taccepted</code></td>
<td>
<p>boolean indicating whether the procedure stopped as a
result of a hypothesis test or brute force (the confidence interval coverage probability is guaranteed in either case.)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Axel Gandy and Patrick Rubin-Delanchy</p>


<h3>References</h3>

<p>Gandy, A. and Rubin-Delanchy, P.  An algorithm to compute the power of Monte Carlo tests with guaranteed precision. Annals of Statistics, 41(1):125–142, 2013.</p>


<h3>See Also</h3>

<p><code>mkdeltamid</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#The following example takes a bit of computing time
## Not run: 
#Example where we know the power should be the level of the test
genstream &lt;- function(){p &lt;- runif(1); function(N){runif(N) &lt;= p}}

res &lt;- mcp(genstream, alpha=0.05, delta="adaptive", cp=0.99)

#should find confidence interval of length 0.02 centered around 0.05
res

## End(Not run)
</code></pre>


</div>