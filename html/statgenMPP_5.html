<div class="container">

<table style="width: 100%;"><tr>
<td>calcIBDMPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>IBD calculation for multi parental populations</h2>

<h3>Description</h3>

<p>IBD calculation for multi parental populations. Per cross IBD probabilities
are calculated using <code>calcIBD</code> in the statgenIBD package. These
probabilities are combined with optional phenotypic data and stored in a
single object of class <code>gDataMPP</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcIBDMPP(
  crossNames,
  markerFiles,
  pheno,
  popType,
  mapFile,
  evalDist,
  grid = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>crossNames</code></td>
<td>
<p>A character vector, the names of the crosses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markerFiles</code></td>
<td>
<p>A character vector indicating the locations of the files
with genotypic information for the populations. The files should be in
tab-delimited format with a header containing marker names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>A data.frame or a list of data.frames with phenotypic data,
with genotypes in the first column <code>genotype</code> and traits in the
following columns. The trait columns should be numerical columns only.
A list of data.frames can be used for replications, i.e. different
trials.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popType</code></td>
<td>
<p>A character string indicating the type of population. One of
DH, Fx, FxDH, BCx, BCxDH, BC1Sx, BC1SxDH, C3, C3DH, C3Sx, C3SxDH, C4, C4DH,
C4Sx, C4SxDH (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapFile</code></td>
<td>
<p>A character string indicating the location of the map file
for the population. The file should be in tab-delimited format. It should
consist of exactly three columns, marker, chromosome and position. There
should be no header. The positions in the file should be in centimorgan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalDist</code></td>
<td>
<p>A numeric value, the maximum distance in cM between
evaluation points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Should the extra markers that are added to assure the a
maximum distince of <code>evalDist</code> be on a grid (<code>TRUE</code>) or in between
marker existing marker positions (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should progress be printed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>IBD probabilities can be calculated for many different types of populations.
In the following table all supported populations are listed. Note that the
value of x in the population types is variable, with its maximum value
depicted in the last column.</p>

<table>
<tr>
<td style="text-align: left;">
   <strong>Population type</strong> </td>
<td style="text-align: left;"> <strong>Cross</strong> </td>
<td style="text-align: left;"> <strong>Description</strong> </td>
<td style="text-align: left;"> <strong>max. x</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
   DH </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> doubled haploid population </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   Fx </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> Fx population (F1, followed by x-1 generations of selfing) </td>
<td style="text-align: left;"> 8 </td>
</tr>
<tr>
<td style="text-align: left;">
   FxDH </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> Fx, followed by DH generation </td>
<td style="text-align: left;"> 8 </td>
</tr>
<tr>
<td style="text-align: left;">
   BCx </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> backcross, second parent is recurrent parent </td>
<td style="text-align: left;"> 9 </td>
</tr>
<tr>
<td style="text-align: left;">
   BCxDH </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> BCx, followed by DH generation </td>
<td style="text-align: left;"> 9 </td>
</tr>
<tr>
<td style="text-align: left;">
   BC1Sx </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> BC1, followed by x generations of selfing </td>
<td style="text-align: left;"> 7 </td>
</tr>
<tr>
<td style="text-align: left;">
   BC1SxDH </td>
<td style="text-align: left;"> biparental </td>
<td style="text-align: left;"> BC1, followed by x generations of selfing and DH </td>
<td style="text-align: left;"> 6 </td>
</tr>
<tr>
<td style="text-align: left;">
   C3 </td>
<td style="text-align: left;"> three-way </td>
<td style="text-align: left;"> three way cross: (AxB) x C </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   C3DH </td>
<td style="text-align: left;"> three-way </td>
<td style="text-align: left;"> C3, followed by DH generation </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   C3Sx </td>
<td style="text-align: left;"> three-way </td>
<td style="text-align: left;"> C3, followed by x generations of selfing </td>
<td style="text-align: left;"> 7 </td>
</tr>
<tr>
<td style="text-align: left;">
   C3SxDH </td>
<td style="text-align: left;"> three-way </td>
<td style="text-align: left;"> C3, followed by x generations of selfing and DH generation </td>
<td style="text-align: left;"> 6 </td>
</tr>
<tr>
<td style="text-align: left;">
   C4 </td>
<td style="text-align: left;"> four-way </td>
<td style="text-align: left;"> four-way cross: (AxB) x (CxD) </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   C4DH </td>
<td style="text-align: left;"> four-way </td>
<td style="text-align: left;"> C4, followed by DH generation </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   C4Sx </td>
<td style="text-align: left;"> four-way </td>
<td style="text-align: left;"> C4, followed by x generations of selfing </td>
<td style="text-align: left;"> 6 </td>
</tr>
<tr>
<td style="text-align: left;">
   C4SxDH </td>
<td style="text-align: left;"> four-way </td>
<td style="text-align: left;"> C4, followed by x generations of selfing and DH generation </td>
<td style="text-align: left;"> 6 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gDataMPP</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>a data.frame containing map data. Map is sorted by
chromosome and position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>a 3D matrix containing IBD probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>data.frame or list of data.frames containing phenotypic
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>a kinship matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>a data.frame with extra covariates (including the
name of the cross).</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Read phenotypic data.
pheno &lt;- read.delim(system.file("extdata/multipop", "AxBxCpheno.txt",
                               package = "statgenMPP"))
## Rename first column to genotype.
colnames(pheno)[1] &lt;- "genotype"


## Compute IBD probabilities for simulated population - AxB, AxC.
ABC &lt;- calcIBDMPP(crossNames = c("AxB", "AxC"),
                  markerFiles = c(system.file("extdata/multipop", "AxB.txt",
                                              package = "statgenMPP"),
                                  system.file("extdata/multipop", "AxC.txt",
                                              package = "statgenMPP")),
                  pheno = pheno,
                  popType = "F4DH",
                  mapFile = system.file("extdata/multipop", "mapfile.txt",
                                        package = "statgenMPP"),
                  evalDist = 5)

summary(ABC)

</code></pre>


</div>