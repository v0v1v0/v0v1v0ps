<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mrs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a fit based analysis of MRS data.</h2>

<h3>Description</h3>

<p>Note that TARQUIN and LCModel require these packages to be installed, and
the functions set_tqn_cmd and set_lcm_cmd (respectively) need to be used to
specify the location of these software packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mrs(
  metab,
  basis = NULL,
  method = "ABFIT",
  w_ref = NULL,
  opts = NULL,
  parallel = FALSE,
  cl = NULL,
  time = TRUE,
  progress = "text",
  extra = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metab</code></td>
<td>
<p>metabolite data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>basis class object or character vector to basis file in
LCModel .basis format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>'ABFIT' (default), 'VARPRO', 'VARPRO_3P', 'TARQUIN' or
'LCMODEL'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_ref</code></td>
<td>
<p>water reference data for concentration scaling (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>options to pass to the analysis method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>perform analyses in parallel (TRUE or FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>a parallel socket cluster required to run analyses in parallel.
Eg, cl &lt;- parallel::makeCluster(4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>measure the time taken for the analysis to complete
(TRUE or FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>option is passed to plyr::alply function to display a
progress bar during fitting. Default value is "text", set to "none" to
disable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>
<p>an optional data frame to provide additional variables for use
in subsequent analysis steps, eg id or grouping variables.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fitting approaches described in the following references:
ABfit
Wilson, M. Adaptive baseline fitting for 1H MR spectroscopy analysis. Magn
Reson Med 2012;85:13-29.
</p>
<p>VARPRO
van der Veen JW, de Beer R, Luyten PR, van Ormondt D. Accurate quantification
of in vivo 31P NMR signals using the variable projection method and prior
knowledge. Magn Reson Med 1988;6:92-98.
</p>
<p>TARQUIN
Wilson, M., Reynolds, G., Kauppinen, R. A., Arvanitis, T. N. &amp; Peet, A. C.
A constrained least-squares approach to the automated quantitation of in vivo
1H magnetic resonance spectroscopy data. Magn Reson Med 2011;65:1-12.
</p>
<p>LCModel
Provencher SW. Estimation of metabolite concentrations from localized in vivo
proton NMR spectra. Magn Reson Med 1993;30:672-679.
</p>


<h3>Value</h3>

<p>MRS analysis object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fname &lt;- system.file("extdata", "philips_spar_sdat_WS.SDAT", package =
"spant")
svs &lt;- read_mrs(fname)
## Not run: 
basis &lt;- sim_basis_1h_brain_press(svs)
fit_result &lt;- fit_mrs(svs, basis)

## End(Not run)
</code></pre>


</div>