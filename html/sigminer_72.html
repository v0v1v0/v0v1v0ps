<div class="container">

<table style="width: 100%;"><tr>
<td>read_copynumber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read Absolute Copy Number Profile</h2>

<h3>Description</h3>

<p>Read <strong>absolute</strong> copy number profile for preparing CNV signature
analysis. See detail part of <code>sig_tally()</code> to see how to handle sex to get correct
summary.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_copynumber(
  input,
  pattern = NULL,
  ignore_case = FALSE,
  seg_cols = c("Chromosome", "Start.bp", "End.bp", "modal_cn"),
  samp_col = "sample",
  add_loh = FALSE,
  loh_min_len = 10000,
  loh_min_frac = 0.05,
  join_adj_seg = TRUE,
  skip_annotation = FALSE,
  use_all = add_loh,
  min_segnum = 0L,
  max_copynumber = 20L,
  genome_build = c("hg19", "hg38", "T2T", "mm10", "mm9", "ce11"),
  genome_measure = c("called", "wg"),
  complement = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>a <code>data.frame</code> or a file or a directory contains copy number profile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>an optional regular expression used to select part of files if
<code>input</code> is a directory, more detail please see <code>list.files()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_case</code></td>
<td>
<p>logical. Should pattern-matching be case-insensitive?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg_cols</code></td>
<td>
<p>four strings used to specify chromosome, start position,
end position and copy number value in <code>input</code>, respectively.
Default use names from ABSOLUTE calling result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp_col</code></td>
<td>
<p>a character used to specify the sample column name. If <code>input</code>
is a directory and cannot find <code>samp_col</code>, sample names will use file names
(set this parameter to <code>NULL</code> is recommended in this case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_loh</code></td>
<td>
<p>if <code>TRUE</code>, add LOH labels to segments. <strong>NOTE</strong> a column
'minor_cn' must exist to indicate minor allele copy number value.
Sex chromosome will not be labeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loh_min_len</code></td>
<td>
<p>The length cut-off for labeling a segment as 'LOH'.
Default is <code style="white-space: pre;">⁠10Kb⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loh_min_frac</code></td>
<td>
<p>When <code>join_adj_seg</code> set to <code>TRUE</code>, only the length fraction
of LOH region is larger than this value will be labeled as 'LOH'.
Default is 30%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>join_adj_seg</code></td>
<td>
<p>if <code>TRUE</code> (default), join adjacent segments with
same copy number value. This is helpful for precisely count the number of breakpoint.
When set <code>use_all=TRUE</code>, the mean function will be applied to extra numeric columns
and unique string columns will be pasted by comma for joined records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_annotation</code></td>
<td>
<p>if <code>TRUE</code>, skip annotation step, it may affect some analysis
and visualization functionality, but speed up reading data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_all</code></td>
<td>
<p>default is <code>FALSE</code>. If <code>True</code>, use all columns from raw input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_segnum</code></td>
<td>
<p>minimal number of copy number segments within a sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_copynumber</code></td>
<td>
<p>bigger copy number within a sample will be reset to this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genome_build</code></td>
<td>
<p>genome build version, should be 'hg19', 'hg38', 'mm9' or 'mm10'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genome_measure</code></td>
<td>
<p>default is 'called', can be 'wg' or 'called'.
Set 'called' will use called segments size to compute total size for CNA burden calculation,
this option is useful for WES and target sequencing.
Set 'wg' will use autosome size from genome build, this option is useful for WGS, SNP etc..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complement</code></td>
<td>
<p>if <code>TRUE</code>, complement chromosome (except 'Y') does not show in input data
with normal copy 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters pass to <code>data.table::fread()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a CopyNumber object.
</p>


<h3>Author(s)</h3>

<p>Shixiang Wang <a href="mailto:w_shixiang@163.com">w_shixiang@163.com</a>
</p>


<h3>See Also</h3>

<p>read_maf for reading mutation data to MAF object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load toy dataset of absolute copynumber profile
load(system.file("extdata", "toy_segTab.RData",
  package = "sigminer", mustWork = TRUE
))


cn &lt;- read_copynumber(segTabs,
  seg_cols = c("chromosome", "start", "end", "segVal"),
  genome_build = "hg19", complement = FALSE
)
cn
cn_subset &lt;- subset(cn, sample == "TCGA-DF-A2KN-01A-11D-A17U-01")

# Add LOH
set.seed(1234)
segTabs$minor_cn &lt;- sample(c(0, 1), size = nrow(segTabs), replace = TRUE)
cn &lt;- read_copynumber(segTabs,
  seg_cols = c("chromosome", "start", "end", "segVal"),
  genome_measure = "wg", complement = TRUE, add_loh = TRUE
)
# Use tally method "S" (Steele et al.)
tally_s &lt;- sig_tally(cn, method = "S")

tab_file &lt;- system.file("extdata", "metastatic_tumor.segtab.txt",
  package = "sigminer", mustWork = TRUE
)
cn2 &lt;- read_copynumber(tab_file)
cn2

</code></pre>


</div>