<div class="container">

<table style="width: 100%;"><tr>
<td>smle_select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Elaborative post-screening selection with SMLE</h2>

<h3>Description</h3>

<p>The features retained after screening are still likely to contain some that 
are not related to the response. The function <code>smle_select()</code> is designed to 
further identify the relevant features using <code>SMLE()</code>.
Given a response and a set of <code class="reqn">K</code> features, this function
first runs <code>SMLE(fast = TRUE)</code> to generate a series of sub-models with
sparsity k varying from <code>k_min</code> to <code>k_max</code>.
It then selects the best model from the series based on a selection criterion.
</p>
<p>When criterion EBIC is used, users can choose to repeat the selection with
different values of the tuning parameter <code class="reqn">\gamma</code>, and
conduct importance voting for each feature. When <code>vote = T</code>, this function 
fits all the models with <code class="reqn">\gamma</code> specified in <code>gamma_seq</code> and features 
with frequency higher than <code>vote_threshold</code> will be selected in <code>ID_voted</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smle_select(object, ...)

## S3 method for class 'sdata'
smle_select(
  object,
  k_min = 1,
  k_max = NULL,
  subset = NULL,
  gamma_ebic = 0.5,
  vote = FALSE,
  keyset = NULL,
  criterion = "ebic",
  codingtype = c("DV", "standard", "all"),
  gamma_seq = c(seq(0, 1, 0.2)),
  vote_threshold = 0.6,
  parallel = FALSE,
  num_clusters = NULL,
  ...
)

## Default S3 method:
smle_select(
  object = NULL,
  Y = NULL,
  X = NULL,
  family = "gaussian",
  keyset = NULL,
  ...
)

## S3 method for class 'smle'
smle_select(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>'smle'</code> or <code>'sdata'</code>. Users can also
input a response vector and a feature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_min</code></td>
<td>
<p>The lower bound of candidate model sparsity. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_max</code></td>
<td>
<p>The upper bound of candidate model sparsity. Default is 
the number of columns in feature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An index vector indicating which features (columns of the
feature matrix) are to be selected.  Not applicable if a <code>'smle'</code>
object is the input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_ebic</code></td>
<td>
<p>The EBIC tuning parameter, in <code class="reqn">[0 , 1]</code>. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vote</code></td>
<td>
<p>The logical flag for whether to perform the voting procedure. Only available when <code>criterion = "ebic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keyset</code></td>
<td>
<p>A numeric vector with column indices for the key features that 
do not participate in feature screening and are forced to remain in the model. See SMLE for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Selection criterion. One of "<code>ebic</code>","<code>bic</code>","<code>aic</code>". Default is "<code>ebic</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>codingtype</code></td>
<td>
<p>Coding types for categorical features; for more details see <code>SMLE()</code> documentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_seq</code></td>
<td>
<p>The sequence of values for <code>gamma_ebic</code> when <code>vote = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vote_threshold</code></td>
<td>
<p>A relative voting threshold in percentage. A feature is
considered to be important when it receives votes passing the threshold. Default is 0.6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>A logical flag to use parallel computing to do voting selection.
Default is <code>FALSE</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_clusters</code></td>
<td>
<p>The number of compute clusters to use when 
<code>parallel = TRUE</code>. The default will be 2 times cores detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Input response vector (when <code>object = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Input features matrix (when <code>object = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Model assumption; see <code>SMLE()</code> documentation. Default is Gaussian linear.
</p>
<p>When input is a <code>'smle'</code> or <code>'sdata'</code> object, the same
model will be used in the selection.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function accepts three types of input objects; 
1) <code>'smle'</code> object, as the output from <code>SMLE()</code>; 
2) <code>'sdata'</code> object, as the output from <code>Gen_Data()</code>; 
3) other response and feature matrix input by users.
</p>
<p>Note that this function is mainly designed to conduct an elaborative selection
after feature screening. We do not recommend using it directly for
ultra-high-dimensional data without screening.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_selected</code></td>
<td>
<p>A list of selected features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_selected</code></td>
<td>
<p>Fitted model coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Fitted model intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion_value</code></td>
<td>
<p>Values of selection criterion for the candidate models with various sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>A logical flag whether the input feature matrix includes categorical features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_pool</code></td>
<td>
<p>A vector containing all features selected during voting. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID_voted</code></td>
<td>
<p>A vector containing the features selected when <code>vote = T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Indices of categorical features when <code>categorical = TRUE</code>.</p>
</td>
</tr>
</table>
<p><code>X</code>, <code>Y</code>, <code>family</code>, <code>gamma_ebic</code>, <code>gamma_seq</code>, <code>criterion</code>, <code>vote</code>,
<code>codyingtype</code>, <code>vote_threshold</code> are return of arguments passed in the function call.
</p>


<h3>References</h3>

<p>Chen. J. and Chen. Z. (2012). "Extended BIC for small-n-large-p sparse GLM."
<em>Statistica Sinica</em>, <b>22</b>(2), 555-574.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1)
Data&lt;-Gen_Data(correlation = "MA", family = "gaussian")
fit&lt;-SMLE(Y = Data$Y, X = Data$X, k = 20, family = "gaussian")

fit_bic&lt;-smle_select(fit, criterion = "bic")
summary(fit_bic)

fit_ebic&lt;-smle_select(fit, criterion = "ebic", vote = TRUE)
summary(fit_ebic)
plot(fit_ebic)


</code></pre>


</div>