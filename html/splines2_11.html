<div class="container">

<table style="width: 100%;"><tr>
<td>deriv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derivatives of Spline Basis Functions</h2>

<h3>Description</h3>

<p>Returns derivatives of given order for the given spline basis functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'BSpline'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'MSpline'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'ISpline'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'CSpline'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'BernsteinPoly'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'NaturalSpline'
deriv(expr, derivs = 1L, ...)

## S3 method for class 'NaturalSplineK'
deriv(expr, derivs = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>Objects of class <code>bSpline2</code>, <code>ibs</code>, <code>mSpline</code>,
<code>iSpline</code>, <code>cSpline</code>, <code>bernsteinPoly</code> or
<code>naturalSpline</code> with attributes describing <code>knots</code>,
<code>degree</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivs</code></td>
<td>
<p>A positive integer specifying the order of derivatives. By
default, it is <code>1L</code> for the first derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments that are not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At knots, the derivative is defined to be the right derivative except at the
right boundary knot. By default, the function returns the first derivatives.
For derivatives of order greater than one, nested function calls such as
<code>deriv(deriv(expr))</code> are supported but not recommended.  For a better
performance, argument <code>derivs</code> should be specified instead.
</p>
<p>This function is designed for objects produced by this package.  It
internally extracts necessary specification about the spline/polynomial
basis matrix from its attributes. Therefore, the function will not work if
the key attributes are not available after some operations.
</p>


<h3>Value</h3>

<p>A numeric matrix of the same dimension with the input <code>expr</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(splines2)

x &lt;- c(seq.int(0, 1, 0.1), NA)  # NA's will be kept.
knots &lt;- c(0.3, 0.5, 0.6)

## helper function
stopifnot_equivalent &lt;- function(...) {
    stopifnot(all.equal(..., check.attributes = FALSE))
}

## integal of B-splines and the corresponding B-splines integrated
ibsMat &lt;- ibs(x, knots = knots)
bsMat &lt;- bSpline(x, knots = knots)

## the first derivative
d1Mat &lt;- deriv(ibsMat)
stopifnot_equivalent(bsMat, d1Mat)

## the second derivative
d2Mat1 &lt;- deriv(bsMat)
d2Mat2 &lt;- deriv(ibsMat, derivs = 2L)
stopifnot_equivalent(d2Mat1, d2Mat2)

## nested calls are supported
d2Mat3 &lt;- deriv(deriv(ibsMat))
stopifnot_equivalent(d2Mat2, d2Mat3)

## C-splines, I-splines, M-splines and the derivatives
csMat &lt;- cSpline(x, knots = knots, intercept = TRUE, scale = FALSE)
isMat &lt;- iSpline(x, knots = knots, intercept = TRUE)
stopifnot_equivalent(isMat, deriv(csMat))

msMat &lt;- mSpline(x, knots = knots, intercept = TRUE)
stopifnot_equivalent(msMat, deriv(isMat))
stopifnot_equivalent(msMat, deriv(csMat, 2))
stopifnot_equivalent(msMat, deriv(deriv(csMat)))

dmsMat &lt;- mSpline(x, knots = knots, intercept = TRUE, derivs = 1)
stopifnot_equivalent(dmsMat, deriv(msMat))
stopifnot_equivalent(dmsMat, deriv(isMat, 2))
stopifnot_equivalent(dmsMat, deriv(deriv(isMat)))
stopifnot_equivalent(dmsMat, deriv(csMat, 3))
stopifnot_equivalent(dmsMat, deriv(deriv(deriv(csMat))))
</code></pre>


</div>