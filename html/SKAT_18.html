<div class="container">

<table style="width: 100%;"><tr>
<td>Power_Logistic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculation, Dichotomous traits</h2>

<h3>Description</h3>

<p>Compute an average power of SKAT and SKAT-O for testing association between a genomic region
and dichotomous phenotypes from case-control studies with a given disease model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
Power_Logistic(Haplotypes = NULL, SNP.Location = NULL, SubRegion.Length=-1
, Prevalence=0.01, Case.Prop=0.5, Causal.Percent=5, Causal.MAF.Cutoff=0.03
, alpha =c(0.01,10^(-3),10^(-6)), N.Sample.ALL = 500 * (1:10)
, Weight.Param=c(1,25), N.Sim=100, OR.Type = "Log"
, MaxOR=5, Negative.Percent=0)

Power_Logistic_R(Haplotypes = NULL, SNP.Location = NULL, SubRegion.Length=-1
, Prevalence=0.01, Case.Prop=0.5, Causal.Percent=5, Causal.MAF.Cutoff=0.03
, alpha =c(0.01,10^(-3),10^(-6)), N.Sample.ALL = 500 * (1:10)
, Weight.Param=c(1,25), N.Sim=100, OR.Type = "Log"
, MaxOR=5, Negative.Percent=0, r.corr=0)

 </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Haplotypes</code></td>
<td>
<p>a haplotype matrix with each row as a different individual and each column as a separate SNP (default= NULL). 
Each element of the matrix should be either 0 (major allel) or 1 (minor allele). 
If NULL, SKAT.haplotype dataset will be used to compute power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNP.Location</code></td>
<td>
<p>a numeric vector of SNP locations which should be matched with the SNPs in the Haplotype matrix (default= NULL). 
It is used to obtain subregions. When Haplotype=NULL, it should be NULL. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SubRegion.Length</code></td>
<td>
<p>a value of the length of subregions (default= -1). 
Each subregion will be randomly selected, and then the average power will be calculated by taking the average over the estimated powers of all subregions. 
If SubRegion.Length=-1 (default), the length of the subregion is the same as the length of the whole region, so there will no random selection of subregions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prevalence</code></td>
<td>
<p>a value of disease prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Case.Prop</code></td>
<td>
<p>a value of the proportion of cases. For example, Case.Prop=0.5 means 50 % of samples are cases and 50 % of samples are controls. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Causal.Percent</code></td>
<td>
<p>a value of the percentage of causal SNPs among rare SNPs (MAF &lt; Causal.MAF.Cutoff)(default= 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Causal.MAF.Cutoff</code></td>
<td>
<p>a value of MAF cutoff for the causal SNPs. Only SNPs that have MAFs smaller than this are considered as causal SNPs (default= 0.03).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a vector of the significance levels (default= c(0.01,10^(-3),10^(-6))). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.Sample.ALL</code></td>
<td>
<p>a vector of the sample sizes (default= 500 * (1:10)). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weight.Param</code></td>
<td>
<p>a vector of parameters of beta weights (default= c(1,25)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.Sim</code></td>
<td>
<p> a value of number of causal SNP/SubRegion sets to be generated to compute the average power (default= 100). Power will be computed for each causal SNP/SubRegion set, and then the average power will be obtained by taking mean of the computed powers. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR.Type</code></td>
<td>
<p>a function type of effect sizes (default= “Log”). “Log” indicates that log odds ratio of causal variants equal to <code class="reqn">c|log10(MAF)|</code>, 
and “Fixed” indicates that log odds ratio of all causal variants are the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxOR</code></td>
<td>
<p>a numeric value of the maximum odds ratio (default= 5). When OR.Type=“Log”, the maximum odds ratio is MaxOR (when MAF=0.0001). 
When OR.Type=“Fixed”, all causal variants have the same odds ratio (= MaxOR). See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Negative.Percent</code></td>
<td>
<p>a numeric value of the percentage of coefficients of causal variants that are negative (default= 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.corr</code></td>
<td>
<p>(Power_Logistic_R only) the <code class="reqn">\rho</code> parameter of new class of kernels with compound symmetric correlation structure for genotype effects  (default= 0). See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default it uses the haplotype information in the SKAT.haplotypes dataset. 
So you can left Haplotypes and SNP.Location as NULL if you want to use the SKAT.haplotypes dataset. 
</p>
<p>When OR.Type="Log", MaxOR is a odds ratio of the causal SNP at MAF <code class="reqn">= 10^{-4}</code> 
and used to obtain c value in the function <code class="reqn">\log OR = c|log10(MAF)|</code>. 
For example, if MaxOR=5, <code class="reqn">c = log(5)/4 = 0.402</code>. Then a variant with MAF=0.001 has log odds ratio = 1.206 and a variant with MAF=0.01 has log odds ratio = 0.804.
</p>
<p>When SubRegion.Length is small such as 3kb or 5kb, it is possible that you can have different estimated power for each run with N.Sim = <code class="reqn">50 \sim 100</code>. 
Then, please increase N.Sim to <code class="reqn">500 \sim 1000</code> to obtain stable results. 
</p>
<p>Power_Logistic_R computes the power with new class of kernels with the compound symmetric correlation structure. 
It uses a slightly different approach, and thus 
Power_Logistic and Power_Logistic_R can produce slightly different results although r.corr=0.
</p>
<p>If you want to computer power of SKAT-O by estimating the optimal r.corr, use r.corr=2. 
The estimated optimal r.corr is 
<code class="reqn">r.corr = p_1^2 ( 2p_2-1)^2</code>,
where <code class="reqn">p_1</code> is a proportion of causal variants, and <code class="reqn">p_2</code> is a proportion of negatively associated causal variants
among the causal variants.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Power</code></td>
<td>
<p>A matrix with each row as a different 
sample size and each column as a different significance level. Each element of the matrix is the estimated power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.corr</code></td>
<td>
<p>r.corr value. When r.corr=2 is used, it provides the estimated r.corr value. See details.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Seunggeun Lee</p>


<h3>Examples</h3>

<pre><code class="language-R">
#
#	Calculate the average power of randomly selected 3kb regions 
#	with the following conditions.
#
#	Causal percent = 20%
#	Negative percent = 20%
#	Max OR = 7 at MAF = 10^-4
#
#	When you use this function, please increase N.Sim (more than 100)	
#
out.b&lt;-Power_Logistic(SubRegion.Length=3000, 
Causal.Percent= 20, N.Sim=5 ,MaxOR=7,Negative.Percent=20)

out.b

#
#	Calculate the required sample sizes to achieve 80% power

Get_RequiredSampleSize(out.b, Power=0.8)

</code></pre>


</div>