<div class="container">

<table style="width: 100%;"><tr>
<td>rmult.acl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating Correlated Ordinal Responses Conditional on a Marginal
Adjacent-Category Logit Model Specification</h2>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming an adjacent-category logit
model for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmult.acl(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(),
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal adjacent-category logit model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>matrix with <code>(clsize * ncategories)</code> columns containing
realizations of the latent random vectors when the NORTA method is not
preferred. See details for more info.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal adjacent-category logit model is </p>
<p style="text-align: center;"><code class="reqn">log
\frac{Pr(Y_{it}=j |x_{it})}{Pr(Y_{it}=j+1 |x_{it})}=\beta_{tj0}
+ \beta^{'}_{t} x_{it}</code>
</p>

<p>For subject <code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th ordinal response
and <code class="reqn">x_{it}</code> is the associated covariates vector. Also <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{t}</code> is the regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is obtained by utilizing the threshold
approach described in the Vignette. This approach is based on the connection
between baseline-category and adjacent-category logit models.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in “long” format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O3}_{itj}</code> in the Vignette. To import
simulated values for the latent random vectors without utilizing the NORTA
method, the user can employ the <code>rlatent</code> argument. In this case,
row <code class="reqn">i</code> corresponds to subject <code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{O3}_{it1},...,e^{O3}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Ysim</code></td>
<td>
<p>the simulated
nominal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O3}_{itj}</code> in the Vignette.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557–561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79–91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633–640.
</p>


<h3>See Also</h3>

<p><code>rbin</code> for simulating correlated binary responses,
<code>rmult.clm</code> and <code>rmult.crm</code> for simulating
correlated ordinal responses, and <code>rmult.bcl</code> for simulating
nominal responses.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See Example 3.4 in the Vignette.
beta_intercepts &lt;- c(3, 1, 2)
beta_coefficients &lt;- c(1, 1)
sample_size &lt;- 500
cluster_size &lt;- 3
set.seed(321)
x1 &lt;- rep(rnorm(sample_size), each = cluster_size)
x2 &lt;- rnorm(sample_size * cluster_size)
xdata &lt;- data.frame(x1, x2)
identity_matrix &lt;- diag(4)
equicorrelation_matrix &lt;- toeplitz(c(1, rep(0.95, cluster_size - 1)))
latent_correlation_matrix &lt;- kronecker(equicorrelation_matrix,
  identity_matrix)
simulated_ordinal_dataset &lt;- rmult.acl(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients,
  xformula = ~ x1 + x2, xdata = xdata,
  cor.matrix = latent_correlation_matrix)
suppressPackageStartupMessages(library("multgee"))
ordinal_gee_model &lt;- ordLORgee(y ~ x1 + x2,
  data = simulated_ordinal_dataset$simdata, id = id, repeated = time,
  LORstr = "time.exch", link = "acl")
round(coef(ordinal_gee_model), 2)
</code></pre>


</div>