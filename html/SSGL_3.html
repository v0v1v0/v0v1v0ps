<div class="container">

<table style="width: 100%;"><tr>
<td>cv_SSGL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-Validation for Spike-and-Slab Group Lasso in Group-Regularized Generalized Linear Models (GLMs)</h2>

<h3>Description</h3>

<p>This function implements <code class="reqn">K</code>-fold cross-validation for group-regularized GLMs with the spike-and-slab group lasso (SSGL) penalty of Bai et al. (2022) and Bai (2023). The identity link function is used for Gaussian regression, the logit link is used for binomial regression, and the log link is used for Poisson, negative binomial, and gamma regression. 
</p>
<p>Although one can choose <code>lambda0</code> from cross-validation with this function, it can be very time-consuming to do so if the number of groups <code class="reqn">G</code> and/or the number of total covariantes <code class="reqn">p</code> is moderate to large. It is <em>strongly</em> recommended that the user simply run  the <code>SSGL</code> function on the training dataset and select the final model according to the <code>lambda0</code> that minimizes the generalized information criterion (GIC). See description of the <code>SSGL</code> function for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_SSGL(Y, X, groups, 
        family=c("gaussian","binomial","poisson","negativebinomial","gamma"), 
        nb_size=1, gamma_shape=1, group_weights, n_folds=5, n_lambda0=25,
        lambda0, lambda1=1, a=1, b=dim(X)[2], 
        max_iter=100, tol=1e-6, print_fold=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p><code class="reqn">n \times 1</code> vector of responses for training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code class="reqn">n \times p</code> design matrix for training data, where the <code class="reqn">j</code>th column corresponds to the <code class="reqn">j</code>th overall feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p><code class="reqn">p</code>-dimensional vector of group labels. The <code class="reqn">j</code>th entry in <code>groups</code> should contain either the group number <em>or</em> the factor level name that the feature in the <code class="reqn">j</code>th column of <code>X</code> belongs to. <code>groups</code> must be either a vector of integers or factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>exponential dispersion family of the response variables. Allows for <code>"gaussian"</code>, <code>"binomial"</code>, <code>"poisson"</code>, <code>"negativebinomial"</code>, and <code>"gamma"</code>. Note that for <code>"negativebinomial"</code>, the size parameter must be specified in advance, while for <code>"gamma"</code>, the shape parameter must be specified in advance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_size</code></td>
<td>
<p>known size parameter <code class="reqn">\alpha</code> in <code class="reqn">NB(\alpha,\mu_i)</code> distribution for the responses if the user specifies <code>family="negativebinomial"</code>. Default is <code>nb_size=1</code>. Ignored if <code>family</code> is not <code>"negativebinomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_shape</code></td>
<td>
<p>known shape parameter <code class="reqn">\nu</code> in <code class="reqn">G(\mu_i,\nu)</code> distribution for the responses if the user specifies <code>family="gamma"</code>. Default is <code>gamma_shape=1</code>. Ignored if <code>family</code> is not <code>"gamma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_weights</code></td>
<td>
<p>group-specific, nonnegative weights for the penalty. Default is to use the square roots of the group sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_folds</code></td>
<td>
<p>number of folds <code class="reqn">K</code> to use in <code class="reqn">K</code>-fold cross-validation. Default is <code>n_folds=5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lambda0</code></td>
<td>
<p>number of spike hyperparameters <code class="reqn">L</code>. Default is <code>n_lambda0=25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>grid of <code class="reqn">L</code> spike hyperparameters <code class="reqn">\lambda_0</code>. The user may specify either a scalar or a vector. If the user does not provide this, the program chooses the grid automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>slab hyperparameter <code class="reqn">\lambda_1</code> in the SSGL prior. Default is <code>lambda1=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>shape hyperparameter for the <code class="reqn">Beta(a,b)</code> prior on the mixing proportion in the SSGL prior. Default is <code>a=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>shape hyperparameter for the <code class="reqn">Beta(a,b)</code> prior on the mixing proportion in the SSGL prior. Default is <code>b=dim(X)[2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>maximum number of iterations in the algorithm. Default is <code>max_iter=100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence threshold for algorithm. Default is <code>tol=1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_fold</code></td>
<td>
<p>Boolean variable for whether or not to print the current fold in the algorithm. Default is <code>print_fold=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p><code class="reqn">L \times 1</code> vector of spike hyperparameters <code>lambda0</code> used to fit the model. <code>lambda0</code> is displayed in descending order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cve</code></td>
<td>
<p><code class="reqn">L \times 1</code> vector of mean cross-validation error across all <code class="reqn">K</code> folds. The <code class="reqn">k</code>th entry in <code>cve</code> corresponds to the <code class="reqn">k</code>th spike hyperparameter parameter in <code>lambda0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvse</code></td>
<td>
<p><code class="reqn">L \times 1</code> vector of standard errors for cross-validation error across all <code class="reqn">K</code> folds. The <code class="reqn">k</code>th entry in <code>cvse</code> corresponds to the <code class="reqn">k</code>th spike hyperparameter parameter in <code>lambda0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0_min</code></td>
<td>
<p>The value in <code>lambda0</code> that minimizes mean cross-validation error <code>cve</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_index</code></td>
<td>
<p>The index of <code>lambda0_min</code> in <code>lambda0</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bai, R. (2023). "Bayesian group regularization in generalized linear models with a continuous spike-and-slab prior." <em>arXiv pre-print arXiv:2007.07021</em>.
</p>
<p>Bai, R., Moran, G. E., Antonelli, J. L., Chen, Y., and Boland, M.R. (2022). "Spike-and-slab group lassos for grouped regression and sparse generalized additive models." <em>Journal of the American Statistical Association</em>, <b>117</b>:184-197.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate data
set.seed(12345)
X = matrix(runif(50*6), nrow=50)
n = dim(X)[1]
groups = c(1,1,1,2,2,2)
beta_true = c(-2,1,1.5,0,0,0)

## Generate responses from Gaussian distribution
Y = crossprod(t(X), beta_true) + rnorm(n)

## K-fold cross-validation 
## NOTE: If you do not specify lambda0, the function will automatically choose a suitable grid.
ssgl_mods = cv_SSGL(Y, X, groups, family="gaussian", lambda0=seq(from=16,to=4,by=-4))

## Plot cross-validation curve
plot(ssgl_mods$lambda0, ssgl_mods$cve, type="l", xlab="lambda0", ylab="CVE")
## lambda which minimizes mean CVE
ssgl_mods$lambda0_min
ssgl_mods$min_index


## Example with Poisson regression

## Generate count responses
eta = crossprod(t(X), beta_true)
Y = rpois(n,exp(eta))

## K-fold cross-validation 
## NOTE: If you do not specify lambda0, the program will automatically choose a suitable grid.
ssgl_poisson_mods = cv_SSGL(Y, X, groups, family="poisson", lambda0=seq(from=20,to=2,by=-4))

## Plot cross-validation curve
plot(ssgl_poisson_mods$lambda0, ssgl_poisson_mods$cve, type="l", xlab="lambda0", ylab="CVE")
## lambda which minimizes mean CVE
ssgl_poisson_mods$lambda0_min
ssgl_poisson_mods$min_index

</code></pre>


</div>