<div class="container">

<table style="width: 100%;"><tr>
<td>sctest.default</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structural Change Tests in Parametric Models</h2>

<h3>Description</h3>

<p>Performs model-based tests for structural change (or parameter instability)
in parametric models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
sctest(x, order.by = NULL, functional = maxBB,
  vcov = NULL, scores = estfun, decorrelate = TRUE, sandwich = TRUE,
  parm = NULL, plot = FALSE, from = 0.1, to = NULL, nobs = NULL,
  nrep = 50000, width = 0.15, xlab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a model object. The model class can in principle be arbitrary
but needs to provide suitable methods for extracting the <code>scores</code>
and associated variance-covariance matrix <code>vcov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.by</code></td>
<td>
<p>either a vector <code>z</code> or a formula with a single explanatory
variable like <code>~ z</code>. The observations in the model
are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
default) the observations are assumed to be ordered (e.g., a
time series).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functional</code></td>
<td>
<p>either a character specification of the functional
to be used or an <code>efpFunctional</code> object. For a list
of functionals see the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>a function to extract the covariance matrix
for the coefficients of the fitted model:
<code>vcov(x, order.by = order.by, data = data)</code>.
Alternatively, the character string <code>"info"</code>, for details see
below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>a function which extracts the scores or estimating
function from the fitted object: <code>scores(x)</code>, by default
this is <code>estfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decorrelate</code></td>
<td>
<p>logical. Should the process be decorrelated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sandwich</code></td>
<td>
<p>logical. Is the function <code>vcov</code> the full sandwich
estimator or only the meat?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>integer or character specifying the component of the estimating
functions which should be used (by default all components are used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Should the result of the test also be visualized?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from, to</code></td>
<td>
<p>numeric. In case the <code>functional</code> is <code>"supLM"</code>
(or equivalently <code>"maxLM"</code>), <code>from</code> and <code>to</code> can be
passed to the <code>supLM</code> functional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs, nrep</code></td>
<td>
<p>numeric. In case the <code>functional</code> is <code>"maxLMo"</code>,
<code>nobs</code> and <code>nrep</code> are passed to the <code>catL2BB</code> functional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>numeric. In case the <code>functional</code> is <code>"MOSUM"</code>,
the bandwidth <code>width</code> is passed to the <code>maxMOSUM</code>
functional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ...</code></td>
<td>
<p>graphical parameters passed to the plot method (in case
<code>plot = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sctest.default</code> is a convenience interface to <code>gefp</code> for
structural change tests (or parameter instability tests) in general
parametric models. It proceeds in the following steps:
</p>

<ol>
<li>
<p> The generalized empirical fluctuation process (or score-based CUSUM process)
is computed via <code>scus &lt;- gefp(x, fit = NULL, ...)</code> where <code>...</code>
comprises the arguments <code>order.by</code>, <code>vcov</code>, <code>scores</code>, <code>decorrelate</code>,
<code>sandwich</code>, <code>parm</code> that are simply passed on to <code>gefp</code>.
</p>
</li>
<li>
<p> The empirical fluctuation process is visualized (if <code>plot = TRUE</code>) via
<code>plot(scus, functional = functional, ...)</code>.
</p>
</li>
<li>
<p> The empirical fluctuation is assessed by the corresponding significance test
via <code>sctest(scus, functional = functional)</code>.
</p>
</li>
</ol>
<p>The main motivation for prociding the convenience interface is that these three
steps can be easily carried out in one go along with a two convenience options:
</p>

<ol>
<li>
<p> By default, the covariance is computed by an outer-product of gradients
estimator just as in <code>gefp</code>. This is always available based on the <code>scores</code>.
Additionally, by setting <code>vcov = "info"</code>, the corresponding information
matrix can be used. Then the average information is assumed to be provided by
the <code>vcov</code> method for the model class. (Note that this is only sensible
for models estimated by maximum likelihood.)
</p>
</li>
<li>
<p> Instead of providing the <code>functional</code> by an <code>efpFunctional</code>
object, the test labels employed by Merkle and Zeileis (2013) and Merkle, Fan,
and Zeileis (2013) can be used for convenience. Namely, for continuous numeric
orderings, the following functionals are available:
<code>functional = "DM"</code> or <code>"dmax"</code> provides the double-maximum test (<code>maxBB</code>).
<code>"CvM"</code> is the Cramer-von Mises functional <code>meanL2BB</code>.
<code>"supLM"</code> or equivalently <code>"maxLM"</code> is Andrews' supLM test
(<code>supLM</code>). <code>"MOSUM"</code> or <code>"maxMOSUM"</code> is the MOSUM
functional (<code>maxMOSUM</code>), and <code>"range"</code> is the range
functional <code>rangeBB</code>. Furthermore, several functionals suitable
for (ordered) categorical <code>order.by</code> variables are provided:
<code>"LMuo"</code> is the unordered LM test (<code>catL2BB</code>),
<code>"WDMo"</code> is the weighted double-maximum test for ordered variables
(<code>ordwmax</code>), and <code>"maxLMo"</code> is the maxLM test for
ordered variables (<code>ordL2BB</code>).
</p>
</li>
</ol>
<p>The theoretical model class is introduced in Zeileis and Hornik (2007) with a
unifying view in Zeileis (2005), especially from an econometric perspective.
Zeileis (2006) introduces the underling computational tools <code>gefp</code> and
<code>efpFunctional</code>.
</p>
<p>Merkle and Zeileis (2013) discuss the methods in the context of measurement
invariance which is particularly relevant to psychometric models for cross section
data. Merkle, Fan, and Zeileis (2014) extend the results to ordered categorical
variables.
</p>
<p>Zeileis, Shah, and Patnaik (2013) provide a unifying discussion in the context
of time series methods, specifically in financial econometrics.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the test statistic,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the corresponding p value,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string with the method used,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string with the data name.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Merkle E.C., Zeileis A. (2013), Tests of Measurement Invariance without Subgroups:
A Generalization of Classical Methods. <em>Psychometrika</em>, <b>78</b>(1), 59–82.
doi:10.1007/S11336-012-9302-4
</p>
<p>Merkle E.C., Fan J., Zeileis A. (2014), Testing for Measurement Invariance with
Respect to an Ordinal Variable. <em>Psychometrika</em>, <b>79</b>(4), 569–584.
doi:10.1007/S11336-013-9376-7.
</p>
<p>Zeileis A. (2005), A Unified Approach to Structural Change Tests Based on
ML Scores, F Statistics, and OLS Residuals. <em>Econometric Reviews</em>, <b>24</b>,
445–466. doi:10.1080/07474930500406053.
</p>
<p>Zeileis A. (2006), Implementing a Class of Structural Change Tests: An
Econometric Computing Approach. <em>Computational Statistics &amp; Data Analysis</em>, 
<b>50</b>, 2987–3008. doi:10.1016/j.csda.2005.07.001.
</p>
<p>Zeileis A., Hornik K. (2007), Generalized M-Fluctuation Tests for Parameter
Instability, <em>Statistica Neerlandica</em>, <b>61</b>, 488–508.
doi:10.1111/j.1467-9574.2007.00371.x.
</p>
<p>Zeileis A., Shah A., Patnaik I. (2010), Testing, Monitoring, and Dating Structural
Changes in Exchange Rate Regimes, <em>Computational Statistics and Data Analysis</em>,
<b>54</b>(6), 1696–1706. doi:10.1016/j.csda.2009.12.005.
</p>


<h3>See Also</h3>

<p><code>gefp</code>, <code>efpFunctional</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Zeileis and Hornik (2007), Section 5.3, Figure 6
data("Grossarl")
m &lt;- glm(cbind(illegitimate, legitimate) ~ 1, family = binomial, data = Grossarl,
  subset = time(fraction) &lt;= 1800)
sctest(m, order.by = 1700:1800, functional = "CvM")
</code></pre>


</div>