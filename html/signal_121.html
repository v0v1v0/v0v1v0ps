<div class="container">

<table style="width: 100%;"><tr>
<td>sgolay</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Savitzky-Golay smoothing filters </h2>

<h3>Description</h3>

<p>Computes the filter coefficients for all Savitzky-Golay smoothing
filters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sgolay(p, n, m = 0, ts = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> filter order. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> filter length (must be odd). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> return the m-th derivative of the filter coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p> time scaling factor. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The early rows of the result <code>F</code> smooth based on future values and later rows
smooth based on past values, with the middle row using half future
and half past.  In particular, you can use row <code>i</code> to estimate <code>x[k]</code>
based on the <code>i-1</code> preceding values and the <code>n-i</code> following values of x
values as <code>y[k] = F[i,] * x[(k-i+1):(k+n-i)]</code>.
</p>
<p>Normally, you would apply the first <code>(n-1)/2</code> rows to the first <code>k</code>
points of the vector, the last <code>k</code> rows to the last <code>k</code> points of the
vector and middle row to the remainder, but for example if you were
running on a realtime system where you wanted to smooth based on the
all the data collected up to the current time, with a lag of five
samples, you could apply just the filter on row <code>n-5</code> to your window
of length <code>n</code> each time you added a new sample.
</p>


<h3>Value</h3>

<p>An square matrix with dimensions <code>length(n)</code> that is of
class <code>'sgolayFilter'</code> (so it can be used with <code>filter</code>).</p>


<h3>Author(s)</h3>

<p> Original Octave version by Paul Kienzle
<a href="mailto:pkienzle@users.sf.net">pkienzle@users.sf.net</a>. Modified by Pascal Dupuis. Conversion to R by Tom Short. </p>


<h3>References</h3>

<p>William H. Press, Saul A. Teukolsky, William T. Vetterling, Brian
P. Flannery, <em>Numerical Recipes in C: The Art of Scientific Computing</em> ,
2nd edition, Cambridge Univ. Press, N.Y., 1992.
</p>
<p>Octave Forge <a href="https://octave.sourceforge.io/">https://octave.sourceforge.io/</a>
</p>


<h3>See Also</h3>

 <p><code>sgolayfilt</code>, <code>filter</code></p>


</div>