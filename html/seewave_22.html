<div class="container">

<table style="width: 100%;"><tr>
<td>combfilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comb filter</h2>

<h3>Description</h3>

<p>This function processes a feedforward comb filter and plots a spectrogram of the filtered wave asso-
ciated with the frequency response of the filter.</p>


<h3>Usage</h3>

<pre><code class="language-R">combfilter(wave, f, channel = 1, alpha, K, units = c("samples", "seconds"),
plot = FALSE, output = "matrix", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an <code>R</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency (in Hz). Does not need to be specified if
embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector of length 1 for the scaling factor. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a numeric vector of lenght 1 for the delay length, in
<code>units</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>units in which <code>K</code> is given, the default is
<code>'samples'</code> but can be set to <code>'seconds'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical, if <code>TRUE</code> plots the spectrogram of the
filtered <code>wave</code> and the frequency response of the comb filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>character string, the class of the object to return,
either <code>'matrix'</code>, <code>'Wave'</code>, <code>'Sample'</code>,
<code>'audioSample'</code> or <code>'ts'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>spectro</code>
except <code>scale</code> and <code>osc</code> that are set by default to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A comb filter consists in adding a delayed version of a signal to itself resulting in constructive and destructive interference. The feedforward version of a comb filter can be written following:
</p>
<p style="text-align: center;"><code class="reqn">y(n) = x(n) + \alpha \times x(n - K)</code>
</p>

<p>where alpha is the scaling factor and K the delay length.
The frequency response of the filter is obtained with:
</p>
<p style="text-align: center;"><code class="reqn">H(f) = \sqrt{(1+\alpha^2)+2 \times \cos(\omega K)}</code>
</p>

<p>The frequency response is periodic. The depth of the cycles is controlled with alpha and the number of cycles with K.
</p>


<h3>Value</h3>

<p>A new wave is returned. The class of the returned object is set with the argument <code>output</code>.</p>


<h3>Note</h3>

<p>Setting K to high values may generate unwanted results. <br>
The feedback form of the combfilter is not implemented yet.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>See Also</h3>

<p><code>combfilter</code>, <code>fir</code>, <code>squarefilter</code>, <code>drawfilter</code>, <code>ffilter</code>, <code>bwfilter</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
f &lt;- 44100
## chirp
s1 &lt;- synth(f=f, cf=1, d=2, fm=c(0,0,f/2,0,0), out="Wave")
combfilter(s1, alpha=1, K=50, plot=TRUE)
## harmonic sound
s2 &lt;- synth(f=f, d=2, cf=600, harmonics=rep(1, 35), output="Wave")
combfilter(s2, alpha=1, K=10, plot=TRUE)
## noise, units in seconds
s3 &lt;- noisew(d=2, f=44100, out="Wave")
combfilter(s3, alpha=0.5, K=1e-4, units="seconds", plot=TRUE)

## End(Not run)
</code></pre>


</div>