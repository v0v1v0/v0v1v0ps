<div class="container">

<table style="width: 100%;"><tr>
<td>soboljansen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimation of Sobol' Indices (improved formulas of Jansen (1999) and Saltelli et al. (2010))</h2>

<h3>Description</h3>

<p><code>soboljansen</code> implements the Monte Carlo estimation of
the Sobol' indices for both first-order and total indices at the same
time (alltogether <code class="reqn">2p</code> indices), at a total cost of <code class="reqn">(p+2)
    \times n</code> model evaluations. These are called the Jansen estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">soboljansen(model = NULL, X1, X2, nboot = 0, conf = 0.95, ...)
## S3 method for class 'soboljansen'
tell(x, y = NULL, return.var = NULL, ...)
## S3 method for class 'soboljansen'
print(x, ...)
## S3 method for class 'soboljansen'
plot(x, ylim = c(0, 1), y_col = NULL, y_dim3 = NULL, ...)
  ## S3 method for class 'soboljansen'
plotMultOut(x, ylim = c(0, 1), ...)
## S3 method for class 'soboljansen'
ggplot(data, mapping = aes(), ylim = c(0, 1), y_col = NULL,
                 y_dim3 = NULL, ..., environment = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>the first random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the second random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for bootstrap confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"soboljansen"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"soboljansen"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.var</code></td>
<td>
<p>a vector of character strings giving further
internal variables names to store in  the output object <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_col</code></td>
<td>
<p>an integer defining the index of the column of <code>x$y</code> to be
used for plotting the corresponding sensitivity indices (only applies if 
<code>x$y</code> is a matrix or an array). If set to <code>NULL</code> (as per default) 
and <code>x$y</code> is a matrix or an array, the first column (respectively the 
first element in the second dimension) of <code>x$y</code> is used (i.e. 
<code>y_col = 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_dim3</code></td>
<td>
<p>an integer defining the index in the third dimension of 
<code>x$y</code> to be used for plotting the corresponding sensitivity indices 
(only applies if <code>x$y</code> is an array). If set to <code>NULL</code> (as per 
default) and <code>x$y</code> is a three-dimensional array, the first element in 
the third dimension of <code>x$y</code> is used (i.e. <code>y_dim3 = 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>soboljansen</code>: any other arguments for <code>model</code> 
which are passed unchanged each time it is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This estimator is good for large first-order indices, and (large and small) total indices.
</p>
<p>This version of <code>soboljansen</code> also supports matrices and three-dimensional
arrays as output of <code>model</code>. If the model output is a matrix or an array, 
<code>V</code>, <code>S</code> and <code>T</code> are matrices or arrays as well (depending on the
type of <code>y</code> and the value of <code>nboot</code>).
</p>
<p>The bootstrap outputs <code>V.boot</code>, <code>S.boot</code> and <code>T.boot</code> can only be
returned if the model output is a vector (using argument <code>return.var</code>). For
matrix or array output, these objects can't be returned.
</p>


<h3>Value</h3>

<p><code>soboljansen</code> returns a list of class <code>"soboljansen"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>either a vector, a matrix or a three-dimensional array of model 
responses (depends on the output of <code>model</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of Variances of the Conditional Expectations
(VCE) with respect to each factor and also with respect to the
complementary set of each factor ("all but <code class="reqn">X_i</code>").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' first-order indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the estimations of the Sobol' total sensitivity indices.</p>
</td>
</tr>
</table>
<p>Users can ask more ouput variables with the argument
<code>return.var</code> (for example, bootstrap outputs <code>V.boot</code>,
<code>S.boot</code> and <code>T.boot</code>).
</p>


<h3>Author(s)</h3>

<p>Bertrand Iooss, with contributions from Frank Weber (2016)
</p>


<h3>References</h3>

<p>M.J.W. Jansen, 1999, <em>Analysis of variance designs for model output</em>,
Computer Physics Communication, 117, 35–43.
</p>
<p>A. Saltelli, P. Annoni, I. Azzini, F. Campolongo, M. Ratto and S. Tarantola, 2010,
<em>Variance based sensitivity analysis of model output. Design and estimator for the
total sensitivity index</em>, Computer Physics Communications 181, 259–270.
</p>


<h3>See Also</h3>

<p><code>sobol, sobol2002, sobolSalt, sobol2007, sobolmartinez, sobolEff, sobolmara, sobolMultOut</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case : the non-monotonic Sobol g-function

# The method of sobol requires 2 samples
# There are 8 factors, all following the uniform distribution
# on [0,1]

library(boot)
n &lt;- 1000
X1 &lt;- data.frame(matrix(runif(8 * n), nrow = n))
X2 &lt;- data.frame(matrix(runif(8 * n), nrow = n))

# sensitivity analysis

x &lt;- soboljansen(model = sobol.fun, X1, X2, nboot = 100)
print(x)
plot(x)

library(ggplot2)
ggplot(x)


# Only for demonstration purposes: a model function returning a matrix
sobol.fun_matrix &lt;- function(X){
  res_vector &lt;- sobol.fun(X)
  cbind(res_vector, 2 * res_vector)
}
x_matrix &lt;- soboljansen(model = sobol.fun_matrix, X1, X2)
plot(x_matrix, y_col = 2)
title(main = "y_col = 2")

# Also only for demonstration purposes: a model function returning a
# three-dimensional array
sobol.fun_array &lt;- function(X){
  res_vector &lt;- sobol.fun(X)
  res_matrix &lt;- cbind(res_vector, 2 * res_vector)
  array(data = c(res_matrix, 5 * res_matrix), 
        dim = c(length(res_vector), 2, 2))
}
x_array &lt;- soboljansen(model = sobol.fun_array, X1, X2)
plot(x_array, y_col = 2, y_dim3 = 2)
title(main = "y_col = 2, y_dim3 = 2")


</code></pre>


</div>