<div class="container">

<table style="width: 100%;"><tr>
<td>xewma.q</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute RL quantiles of EWMA control charts</h2>

<h3>Description</h3>

<p>Computation of quantiles of the Run Length (RL)
for EWMA control charts monitoring normal mean.</p>


<h3>Usage</h3>

<pre><code class="language-R">xewma.q(l, c, mu, alpha, zr=0, hs=0, sided="two", limits="fix", q=1, r=40)

xewma.q.crit(l, L0, mu, alpha, zr=0, hs=0, sided="two", limits="fix", r=40,
c.error=1e-12, a.error=1e-9, OUTPUT=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>critical value (similar to alarm limit) of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>true mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>quantile level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>reflection border for the one-sided chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (enables fast initial response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between one- and two-sided EWMA control chart 
by choosing <code>"one"</code> and <code>"two"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>distinguishes between different control limits behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>change point position. For <code class="reqn">q=1</code> and
<code class="reqn">\mu=\mu_0</code> and <code class="reqn">\mu=\mu_1</code>, the usual
zero-state ARLs for the in-control and out-of-control case, respectively,
are calculated. For <code class="reqn">q&gt;1</code> and <code class="reqn">\mu!=0</code> conditional delays, that is,
<code class="reqn">E_q(L-q+1|L\geq)</code>, will be determined.
Note that mu0=0 is implicitely fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of quadrature nodes, dimension of the resulting linear
equation system is equal to <code>r+1</code> (one-sided) or <code>r</code>
(two-sided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L0</code></td>
<td>
<p>in-control quantile value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.error</code></td>
<td>
<p>error bound for two succeeding values of the critical value
during applying the secant rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.error</code></td>
<td>
<p>error bound for the quantile level <code>alpha</code> during applying
the secant rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OUTPUT</code></td>
<td>
<p>activate or deactivate additional output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Instead of the popular ARL (Average Run Length) quantiles of the EWMA
stopping time (Run Length) are determined. The algorithm is based on
Waldmann's survival function iteration procedure.
If <code>limits</code> is not <code>"fix"</code>, then the method presented
in Knoth (2003) is utilized.
Note that for one-sided EWMA charts (<code>sided</code>=<code>"one"</code>), only
<code>"vacl"</code> and <code>"stat"</code> are deployed, while for two-sided ones
(<code>sided</code>=<code>"two"</code>) also <code>"fir"</code>, <code>"both"</code>
(combination of <code>"fir"</code> and <code>"vacl"</code>), and <code>"Steiner"</code> are
implemented. For details see Knoth (2004).
</p>


<h3>Value</h3>

<p>Returns a single value which resembles the RL quantile of order <code>q</code>.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>F. F. Gan (1993),
An optimal design of EWMA control charts based on the median run length,
<em>J. Stat. Comput. Simulation 45</em>, 169-184.
</p>
<p>S. Knoth (2003),
EWMA schemes with non-homogeneous transition kernels,
<em>Sequential Analysis 22</em>, 241-255.
</p>
<p>S. Knoth (2004),
Fast initial response features for EWMA Control Charts,
<em>Statistical Papers 46</em>, 47-64.
</p>
<p>S. Knoth (2015),
Run length quantiles of EWMA control charts monitoring normal mean or/and variance,
<em>International Journal of Production Research 53</em>, 4629-4647.
</p>
<p>K.-H. Waldmann (1986),
Bounds for the distribution of the run length of geometric moving 
average charts, <em>Appl. Statist. 35</em>, 151-158.
</p>


<h3>See Also</h3>

<p><code>xewma.arl</code> for zero-state ARL computation of EWMA control charts.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Gan (1993), two-sided EWMA with fixed control limits
## some values of his Table 1 -- any median RL should be 500
XEWMA.Q &lt;- Vectorize("xewma.q", c("l", "c"))
G.lambda &lt;- c(.05, .1, .15, .2, .25)
G.h &lt;- c(.441, .675, .863, 1.027, 1.177)
MEDIAN &lt;- ceiling(XEWMA.Q(G.lambda, G.h/sqrt(G.lambda/(2-G.lambda)),
0, .5, sided="two"))
print(cbind(G.lambda, MEDIAN))

## increase accuracy of thresholds

# (i) calculate threshold for given in-control median value by
#     deplyoing secant rule
XEWMA.q.crit &lt;- Vectorize("xewma.q.crit", "l")

# (ii) re-calculate the thresholds and remove the standardization step
L0 &lt;- 500
G.h.new &lt;- XEWMA.q.crit(G.lambda, L0, 0, .5, sided="two")
G.h.new &lt;- round(G.h.new * sqrt(G.lambda/(2-G.lambda)), digits=5)

# (iii) compare Gan's original values and the new ones with 5 digits
print(cbind(G.lambda, G.h.new, G.h))

# (iv) calculate the new medians
MEDIAN &lt;- ceiling(XEWMA.Q(G.lambda, G.h.new/sqrt(G.lambda/(2-G.lambda)),
0, .5, sided="two"))
print(cbind(G.lambda, MEDIAN))
</code></pre>


</div>