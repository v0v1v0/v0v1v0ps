<div class="container">

<table style="width: 100%;"><tr>
<td>scape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cytokine activity scores for a normalized matrix.</h2>

<h3>Description</h3>

<p>Computes cell-level estimates of cytokine activity for a normalized scRNA-seq
count matrix using the SCAPE method. SCAPE activity estimates are computed by scoring weighted genes
sets from the CytoSig or Reactome databases using the <code>VAM::vamForCollection()</code>
function. Individual gene sets for subsequent scoring can be reconstructed using
the <code>genesetCytoSig</code> and the <code>genesetReactome</code> functions
for the CytoSig and the Reactome database, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scape(counts.matrix, database = "cytosig", cytokine = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>counts.matrix</code></td>
<td>
<p>A <code class="reqn">m x n</code> normalized counts matrix with <code class="reqn">m</code> samples and <code class="reqn">n</code> genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database</code></td>
<td>
<p>Database used for gene set construction and set scoring.
</p>

<ul>
<li>
<p> "cytosig" performs scoring for up to 41 cytokines using the CytoSig database.
</p>
</li>
<li>
<p> "reactome" performs scoring for up to 30 cytokines using the Reactome database.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytokine</code></td>
<td>
<p>Vector of cytokine names to score for activity. The default value
of "all" will score all 41 cytokines supported by CytoSig or 31 supported by Reactome. Please see
function <code>supportedCytokines</code> to view all the CytoSig or the Reactome
specific scored cytokines.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code class="reqn">m x p</code> matrix consisting of the cell-level cytokine activity scores for <code class="reqn">p</code> cytokines.
</p>


<h3>See Also</h3>

<p><code>genesetCytoSig</code>, <code>genesetReactome</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(Seurat)
library(SeuratObject)
pbmc_small &lt;- NormalizeData(pbmc_small)
counts.matrix &lt;- as.data.frame(t(as.matrix(pbmc_small@assays$RNA@data)))
CytoSig.score.output &lt;- scape(counts.matrix = counts.matrix, 
database = "cytosig")
head(CytoSig.score.output)[,1:3]
CytoSig.score.output.specific &lt;- scape(counts.matrix = counts.matrix, 
database = "cytosig", cytokine = c("IL4", "IL13"))
head(CytoSig.score.output.specific)

</code></pre>


</div>