<div class="container">

<table style="width: 100%;"><tr>
<td>GenerateTissue</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Tissue</h2>

<h3>Description</h3>

<p>This function generates a simulated tissue using a specified number of
clusters and spatial parameters for each pattern in the simulation object.
The tissue is represented by a grid of points with probabilities of
belonging to tissue 1 or tissue 2, based on a Gaussian kernel density
estimate calculated for each pattern
</p>


<h3>Usage</h3>

<pre><code class="language-R">GenerateTissue(
  sim_object,
  k = NA,
  xmin = NA,
  xmax = NA,
  ymin = NA,
  ymax = NA,
  sdmin = 1/2,
  sdmax = 2,
  force = FALSE,
  density_heatmap = FALSE,
  step_size = 1,
  cores = 1,
  overwrite = FALSE,
  use_window = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code> created with
<code>CreateSimulationObject</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of clusters to generate for each pattern</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>Minimum x-coordinate for cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Maximum x-coordinate for cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>Minimum y-coordinate for cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>Maximum y-coordinate for cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdmin</code></td>
<td>
<p>Minimum standard deviation for cluster kernels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdmax</code></td>
<td>
<p>Maximum standard deviation for cluster kernels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>Logical, whether to force generation of tissue even if the
generated cluster centers would fall outside the simulation window. If
<code>FALSE</code>, an error will be thrown if cluster centers are outside the
window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_heatmap</code></td>
<td>
<p>Logical, whether to calculate a density heatmap for
the simulated tissue. If <code>TRUE</code>, a grid of points will be generated
covering the entire simulation window, and the probability of each grid
point belonging to tissue 1 will be calculated based on the generated tissue
probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_size</code></td>
<td>
<p>Grid step size for the density heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Number of cores to use for parallel processing of density
calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>boolean whether to overwrite if tissue kernels already exist</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_window</code></td>
<td>
<p>boolean whether to use the simulation window to set x and y limits</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates a simulated tissue for each pattern in the
simulation object by first generating k clusters within the specified x
and y ranges and with a standard deviation within the specified range.
Then, a Gaussian kernel density estimate is calculated for each pattern
using the generated clusters as center points and the specified standard
deviation as kernel size. The density estimates represent the probability
of each point in the simulation window belonging to tissue 1 or tissue 2.
If <code>density_heatmap = TRUE</code>, a density heatmap will be
calculated using a grid of points covering the entire simulation window.
Finally, for each simulated point, the probability of belonging to
tissue 1 is calculated based on the kernel density estimate, and the tissue
type is assigned with
probability proportional to the probability of belonging to tissue 1.
</p>


<h3>Value</h3>

<p>A modified 'Spatial Simulation Object' with updated tissue grids and
assigned tissue types for each simulated pattern.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create a simulation object with a window and point pattern
sim_object &lt;- CreateSimulationObject()

#simulate points
sim_object &lt;- GenerateSpatialPattern(sim_object, lambda = 20)

# Generate tissue with default parameters
sim_object &lt;- GenerateTissue(sim_object)

</code></pre>


</div>