<div class="container">

<table style="width: 100%;"><tr>
<td>contract</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contractions of <code class="reqn">k</code>-forms</h2>

<h3>Description</h3>

<p>A contraction is a natural linear map from <code class="reqn">k</code>-forms to <code class="reqn">k-1</code>-forms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contract(K,v,lose=TRUE)
contract_elementary(o,v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A <code class="reqn">k</code>-form</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p>Integer-valued vector corresponding to one row of an index
matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lose</code></td>
<td>
<p>Boolean, with default <code>TRUE</code> meaning to coerce a
<code class="reqn">0</code>-form to a scalar and <code>FALSE</code> meaning to return the
formal <code class="reqn">0</code>-form</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A vector; in function <code>contract()</code>, if a matrix,
interpret each column as a vector to contract with</p>
</td>
</tr>
</table>
<h3>Details</h3>

  
<p>Given a <code class="reqn">k</code>-form <code class="reqn">\phi</code> and a vector <code class="reqn">\mathbf{v}</code>,
the <dfn>contraction</dfn> <code class="reqn">\phi_\mathbf{v}</code> of <code class="reqn">\phi</code>
and <code class="reqn">\mathbf{v}</code> is a <code class="reqn">k-1</code>-form with
</p>
<p style="text-align: center;"><code class="reqn">
  \phi_\mathbf{v}\left(\mathbf{v}^1,\ldots,\mathbf{v}^{k-1}\right) =
  \phi\left(\mathbf{v},\mathbf{v}^1,\ldots,\mathbf{v}^{k-1}\right)
  </code>
</p>

<p>provided <code class="reqn">k&gt;1</code>; if <code class="reqn">k=1</code> we specify
<code class="reqn">\phi_\mathbf{v}=\phi(\mathbf{v})</code>.
</p>
<p>Function <code>contract_elementary()</code> is a low-level helper function
that translates elementary <code class="reqn">k</code>-forms with coefficient 1 (in the form
of an integer vector corresponding to one row of an index matrix) into
its contraction with <code class="reqn">\mathbf{v}</code>.
</p>
<p>There is an extensive vignette in the package,
<code>vignette("contract")</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>kform</code>.</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>

<p>Steven H. Weintraub 2014. “Differential forms: theory and
practice”, Elsevier (Definition 2.2.23, chapter 2, page 77).
</p>


<h3>See Also</h3>

<p><code>wedge</code>,<code>lose</code></p>


<h3>Examples</h3>

<pre><code class="language-R">contract(as.kform(1:5),1:8)
contract(as.kform(1),3)   # 0-form



contract_elementary(c(1,2,5),c(1,2,10,11,71))


## Now some verification [takes ~10s to run]:
#o &lt;- kform(spray(t(replicate(2, sample(9,4))), runif(2)))
#V &lt;- matrix(rnorm(36),ncol=4)
#jj &lt;- c(
#   as.function(o)(V),
#   as.function(contract(o,V[,1,drop=TRUE]))(V[,-1]), # scalar
#   as.function(contract(o,V[,1:2]))(V[,-(1:2),drop=FALSE]),
#   as.function(contract(o,V[,1:3]))(V[,-(1:3),drop=FALSE]),
#   as.function(contract(o,V[,1:4],lose=FALSE))(V[,-(1:4),drop=FALSE])
#)

#print(jj)
#max(jj) - min(jj) # zero to numerical precision

</code></pre>


</div>