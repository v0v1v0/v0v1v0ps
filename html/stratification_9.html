<div class="container">

<table style="width: 100%;"><tr>
<td>strata.rule</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Non-Iterative Methods of Strata Construction </h2>

<h3>Description</h3>

<p>These functions first determine boundaries to stratify a population. Then, in a second independent step, the sample sizes are calculated given a CV or the CV is computed given the total sample size. The function <code>strata.cumrootf</code> uses the cumulative root frequency method by Dalenius and Hodges (1959) and <code>strata.geo</code> uses the geometric method by Gunning and Horgan (2004). A model can be specified for the relationship between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>, but this model has no impact on the first step of boundary determination. It only influences the calculation of the n or of the CV by the use of anticipated means and variances of <code class="reqn">Y</code> instead of the empirical means and variances of <code class="reqn">X</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">strata.cumrootf(x, n = NULL, CV = NULL, Ls = 3, certain = NULL, 
       alloc = list(q1 = 0.5, q2 = 0, q3 = 0.5), rh = rep(1, Ls), 
       model = c("none", "loglinear", "linear", "random"),
       model.control = list(), nclass = NULL)

strata.geo(x, n = NULL, CV = NULL, Ls = 3, certain=NULL,
       alloc = list(q1 = 0.5, q2 = 0, q3 = 0.5), rh = rep(1, Ls),
       model = c("none", "loglinear", "linear", "random"),
       model.control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A vector containing the values of the stratification variable <code class="reqn">X</code> for every unit in the population. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> A numeric: the target sample size. It has no default value. The argument <code>n</code> or the argument <code>CV</code> must be input. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p> A numeric: the target coefficient of variation. It has no default value. The argument <code>CV</code> or the argument <code>n</code> must be input. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ls</code></td>
<td>
<p> A numeric: the number of sampled strata (take-none and certain strata are not counted in <code>Ls</code>, but here no take-none stratum can be added to the stratified design so <code>Ls</code> is in fact always equal to <code class="reqn">L</code>). The default is 3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>certain</code></td>
<td>
<p> A vector giving the position, in the vector <code>x</code>, of the units that must be included in the sample (see <code>stratification-package</code>). By default <code>certain</code> is <code>NULL</code>, which means that no units are chosen a priori to be in the sample. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alloc</code></td>
<td>
<p> A list specifying the allocation scheme. The list must contain 3 numerics for the 3 exponents <code>q1</code>, <code>q2</code> and <code>q3</code> in the general allocation scheme (see <code>stratification-package</code>). The default is Neyman allocation (<code>q1</code>=<code>q3</code>=0.5 and <code>q2</code>=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rh</code></td>
<td>
<p> A vector giving the anticipated response rates in each of the <code>Ls</code> sampled strata. A single number can be given if the rates do not vary among strata. The default is 1 in each stratum. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> A character string identifying the model used to describe the discrepancy between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>. It can be <code>"none"</code> if one assumes <code class="reqn">Y=X</code>, <code>"loglinear"</code> for the loglinear model with mortality, <code>"linear"</code> for the heteroscedastic linear model or <code>"random"</code> for the random replacement model (see <code>stratification-package</code> for a description of these models). The default is <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.control</code></td>
<td>
<p> A list of model parameters (see <code>stratification-package</code>). The default values of the parameters correspond to the model <code class="reqn">Y=X</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p> A numeric for the cumulative root frequency method only: the number of classes (Dalenius and Hodges 1959). The default (see <b>Details</b>) is <code>min(Ls*15, Nu)</code> where <code>Nu</code> is the number of unique values in the <code>x</code>-vector from which units in the certainty stratum, if any, heve been removed. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The efficiency of the cumulative root frequency method depends on the number of classes <code>nclass</code> (see Dalenius and Hodges (1959) for a description of these classes). However, there is no theory about how to choose the best value for <code>nclass</code> (Hedlin 2000). This is a limit of the method.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bh </code></td>
<td>
<p>A vector of the <code class="reqn">L-1</code> stratum boundaries proposed by the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclassh</code></td>
<td>
<p> A vector for the cumulative root frequency method only: the number of classes in each stratum (Dalenius and Hodges 1959). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the population sizes <code class="reqn">N_h</code>, i.e. the number of units in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the sample sizes <code class="reqn">n_h</code>, i.e. the number of units to sample in each stratum. See <code>stratification-package</code> for information about the rounding used to get these integer values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n </code></td>
<td>
<p>The total sample size (<code>sum(nh)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nhnonint </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the non-integer values of the sample sizes, obtained directly from applying the allocation rule (see <code>stratification-package</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>certain.info </code></td>
<td>
<p>A vector giving statistics for the certainty stratum (see <code>stratification-package</code>). It contains <code>Nc</code>, the number of units chosen a priori to be in the sample, and <code>meanc</code>, the anticipated mean of <code class="reqn">Y</code> for these units. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opti.nh </code></td>
<td>
<p>The final value of the criteria to optimize (either the total sample size <code class="reqn">n</code> if a target <code>CV</code> was given or the RRMSE if a target <code>n</code> was given) calculated with the integer stratum sample sizes <code>nh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opti.nhnonint </code></td>
<td>
<p>The final value of the criteria to optimize (either the total sample size <code class="reqn">n</code> if a target <code>CV</code> was given or the RRMSE if a target <code>n</code> was given) calculated with the non-integer stratum sample sizes <code>nhnonint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated means of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated variances of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean </code></td>
<td>
<p>A numeric: the anticipated global mean value of <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr </code></td>
<td>
<p>A numeric: the standard error of the anticipated global mean of <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>The anticipated coefficient of variation for the mean of <code class="reqn">Y</code>, i.e. <code>stderr</code> divided <code>mean</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratumID</code></td>
<td>
<p>A factor, having the same length as the input <code>x</code>, which values are either 1, 2, ..., <code class="reqn">L</code> or <code>"certain"</code>. The value <code>"certain"</code> is given to units a priori chosen to be in the sample. This factor identifies, for each observation, the stratum to which it has been assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takeall </code></td>
<td>
<p>The number of take-all strata in the final solution. Note: It is possible that <code class="reqn">n_h=N_h</code> for non take-all strata because the condition for an automatic addition of a take-all stratum is <code class="reqn">n_h&gt;N_h</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The function call (object of class "call").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date </code></td>
<td>
<p>A character string that contains the system date and time when the function ended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args </code></td>
<td>
<p>A list of all the argument values input to the function or set by default. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Sophie Baillargeon <a href="mailto:Sophie.Baillargeon@mat.ulaval.ca">Sophie.Baillargeon@mat.ulaval.ca</a> and<br>
Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> </p>


<h3>References</h3>

<p>Baillargeon, S. and  Rivest L.-P. (2011). The construction of stratified designs in R with the package stratification. <em>Survey Methodology</em>, <b>37</b>(1), 53-65.
</p>
<p>Dalenius, T. and Hodges, J.L., Jr. (1959). Minimum variance stratification. <em>Journal of the American Statistical Association</em>, <b>54</b>, 88-101.
</p>
<p>Gunning, P. and Horgan, J.M. (2004). A new algorithm for the construction of stratum boundaries in skewed populations. <em>Survey Methodology</em>, <b>30</b>(2), 159-166.
</p>
<p>Hedlin, D. (2000). A procedure for stratification by an extended Ekman rule. <em>Journal of Official Statistics</em>, <b>61</b>, 15-29.
</p>


<h3>See Also</h3>

 <p><code>print.strata</code>, <code>plot.strata</code>, <code>strata.LH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">### Example for strata.cumrootf
res &lt;- matrix(NA, nrow=20, ncol=2)
i &lt;- 1
for ( n in seq(100,2000,100)){
    cum &lt;- strata.cumrootf(x=MRTS, CV=0.01, Ls=4, alloc=c(0.5,0,0.5), nclass=n)
    res[i,] &lt;- c(n,cum$n)
    i &lt;- i + 1
}
plot(res, ylab="suggested sample size n", xlab="number of classes", main=expression(
     paste("Example of the effect of nclass on n for the cum",sqrt(f)," method")))

### Example for strata.geo
strata.geo(x=Sweden$REV84, CV=0.05, Ls=5, alloc=c(0.35,0.35,0), model="none")
strata.geo(x=Sweden$REV84, CV=0.05, Ls=5, alloc=c(0.35,0.35,0), model="loglinear",
       model.control=list(beta=1.058355, sig2=0.06593083, ph=1))
strata.geo(x=Sweden$REV84, CV=0.05, Ls=5, alloc=c(0.35,0.35,0), rh=0.85,
       model="loglinear", model.control=list(beta=1.058355, sig2=0.06593083, ph=1))
# When non-response or a model is added, the stratum boundaries do not change, 
# only the nh's do.

### Exemple of how a certainty stratum can be usefull with these methods
strata.cumrootf(x=Sweden$REV84, CV=0.05, Ls=4, alloc=c(0.35,0.35,0), model="none",
                nclass=50)
strata.cumrootf(x=sort(Sweden$REV84), CV=0.05, Ls=4, alloc=c(0.35,0.35,0), 
                certain=282:284, model="none", nclass=50)
# The certainty stratum is used here to ensure that the three large units in the
# Sweden$REV84 population are in the sample, since no take-all stratum can be forced 
# in the stratified design with the cumulative root frequency or geometric method.
# We see that this allows to reduce by more than half the suggested sample size n
# (47 vs 19). This example was presented in Baillargeon and Rivest (2011). 

</code></pre>


</div>