<div class="container">

<table style="width: 100%;"><tr>
<td>report_mig_mult-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Migration reports for multiple DC / species / stages</h2>

<h3>Description</h3>

<p>Migration counts for several Fish counting devices (DC), several taxa and several stages.
This migration count can be built either by the graphical interface or from the command line 
(see examples).
</p>


<h3>Slots</h3>


<dl>
<dt><code>dc</code></dt>
<dd>
<p>An object of class <code>ref_dc-class</code></p>
</dd>
<dt><code>taxa</code></dt>
<dd>
<p>An object of class <code>ref_taxa-class</code></p>
</dd>
<dt><code>stage</code></dt>
<dd>
<p>An object of class <code>ref_stage-class</code></p>
</dd>
<dt><code>timestep</code></dt>
<dd>
<p>An object of class <code>ref_timestep_daily-class</code></p>
</dd>
<dt><code>data</code></dt>
<dd>
<p>A data.frame containing raw data filled by the connect method</p>
</dd>
<dt><code>calcdata</code></dt>
<dd>
<p>A 'list' of calculated daily data, one per dc, filled in by the calcule method</p>
</dd>
<dt><code>coef_conversion</code></dt>
<dd>
<p>A data frame of daily weight to number conversion coefficients, filled in by the connect
method if any weight are found in the data slot.</p>
</dd>
<dt><code>time.sequence</code></dt>
<dd>
<p>A POSIXt time sequence</p>
</dd>
</dl>
<h3>Note</h3>

<p>A Migration report comes from a migration monitoring : the fishes are monitored in a section of river, this section is
called a control station (station). Most often, there is a dam, one or several fishways (DF) which comprise one or several counting devices (DC).
On each counting device, the migration is recorded. It can be either an instant recording (video control) or the use of traps,
Operations are monitoring operations during a period. For each operation, several species of fishes can be recorded (samples). In the case of migratory 
fishes the stage of development is important as it may indicate generic migrations, to and fro, between the river and the sea.
</p>
<p>Hence a Multiple Migration report is built from several one or several counting devices (DC), one or several Taxa (Taxon), one or several stages
(stage). The migration can be also recorded not as numbers, but in the case of glass eels, as weight, which will be later transformed to number, 
from daily conversion coefficients. The methods in this class test whether the counts are numbers or another type of quantity.
This class makes different calculations than report_mig, it does not handle escapement coefficients,
it uses quantities other than numbers if necessary (only used for glass eel in the connect method).
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>See Also</h3>

<p>Other report Objects: 
<code>report_annual-class</code>,
<code>report_dc-class</code>,
<code>report_df-class</code>,
<code>report_env-class</code>,
<code>report_ge_weight-class</code>,
<code>report_mig-class</code>,
<code>report_mig_char-class</code>,
<code>report_mig_env-class</code>,
<code>report_mig_interannual-class</code>,
<code>report_sample_char-class</code>,
<code>report_sea_age-class</code>,
<code>report_silver_eel-class</code>,
<code>report_species-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(stacomiR)

stacomi(database_expected=FALSE) 
## launches the application in the command line
## here an example of loading
## the following lines will only run if you have the program installed
## and the iav scheme available in the database
## this example generates the r_mig_mult dataset
# prompt for user and password but you can set appropriate options for host, port and dbname
## Not run: 
  stacomi(
	  database_expected=TRUE)	
if (interactive()){
	if (!exists("user")){
		user &lt;- readline(prompt="Enter user: ")
		password &lt;- readline(prompt="Enter password: ")	
	}	
}
options(					
		stacomiR.dbname = "bd_contmig_nat",
		stacomiR.host ="localhost",
		stacomiR.port = "5432",
		stacomiR.user = user,
		stacomiR.password = password						
)	
  r_mig_mult &lt;- new("report_mig_mult")
  r_mig_mult &lt;- choice_c(r_mig_mult,
	  dc=c(5,6,12),
	  taxa=c("Anguilla anguilla"),
	  stage=c("AGG","AGJ","CIV"),
    datedebut="2011-01-01",
    datefin="2011-12-31")
  r_mig_mult &lt;- charge(r_mig_mult)
  # launching charge will also load classes associated with the report
  # e.g. report_ope, report_df, report_dc
  r_mig_mult &lt;- connect(r_mig_mult)
  # calculations 
  r_mig_mult &lt;- calcule(r_mig_mult,silent=TRUE)

## End(Not run)

# Use this as example if you don't have a connexion to the database
data("r_mig_mult")
# The following re-create the object at the time of loading
# All three classes were created by the charge and connect 
# method of report_mig_mult in the previous example
data("r_mig_mult_ope")
assign("report_ope",r_mig_mult_ope,envir=envir_stacomi)
data("r_mig_mult_df")
assign("report_df",r_mig_mult_df,envir=envir_stacomi)
data("r_mig_mult_dc")
assign("report_dc",r_mig_mult_dc,envir=envir_stacomi)
# use the following to get the raw data loaded by the connect method
# not shown there as the database and program might not be installed

#Individual plot for all DC, taxa and stage where data present



## Not run: 	
plot(r_mig_mult,plot.type="standard",silent=TRUE)
# colors in the following order (glass eel)
# working, stopped, 1...5 types of operation,numbers, weight, 2 unused colors
# for yellow eel and other taxa
# stopped, 1...5 types of operation, ponctuel, expert, calcule,mesure,working,
  plot(r_mig_mult,plot.type="standard",
	  color=c("#DEF76B","#B950B5","#9ABDDA","#781A74","#BF9D6E","#FFC26E",
		  "#A66F24","#012746","#6C3E00","#DC7ED8","#8AA123"),
	  color_ope=c("#5589B5","#FFDB6E","#FF996E","#1C4D76"),
	  silent=TRUE)
#For the following plot, beware, all stages and DC are grouped. This can make sense
# for instance if you want to display the cumulated migration for one species
# in several counting devices located on the same dam...
  plot(r_mig_mult,plot.type="step",silent=TRUE)
  
  
# Combined plot for ggplot2
  plot(r_mig_mult,plot.type="multiple",silent=TRUE)
# Data will be written in the data directory specified in 
# the datawd argument to stacomi, default "~"
  summary(r_mig_mult,silent=FALSE)

## End(Not run)
</code></pre>


</div>