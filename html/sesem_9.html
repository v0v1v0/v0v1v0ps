<div class="container">

<table style="width: 100%;"><tr>
<td>make.covar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to calculate covariance matrices for a set of lag distance bins
</h2>

<h3>Description</h3>

<p>calculates variance covariance matrices for each lag distance bin and for a flat (non-spatial) bin
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.covar(datafile,dist.mat,binsize,binname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datafile</code></td>
<td>

<p>a dataset where the first two columns are x and y coordinates. Further columns contain observed variables for subsequent sesem modeling. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.mat</code></td>
<td>

<p>a vector containing distances between all X-Y sample pairs in a dataset. Produced by function calc.dist.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>

<p>A vector of bin size cutoff distances starting with zero. Produced using make.bin
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binname</code></td>
<td>

<p>A character vector of bin names. This vector has one element less than binsize.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates variance-covariance matrices for a series of lag distance bins and for a flat (non-spatial) bin. This function produces a list object with four components: [[1]]bin.summary, [[2]] variable names [[3]] flat covariance matrix, [[4]][,,i] covariance matrices for each bin i. A summary of the bins is printed.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>1</code></td>
<td>
<p>A bin summary with colums binname, lower cutoff distance, upper cutoff distance, and sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2</code></td>
<td>
<p>A list of observed variable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>3</code></td>
<td>
<p>the flat (non-spatial) variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>4</code></td>
<td>
<p>contains elements [[4]][,,i] where each i is the variance - covariance matrix for a particular lag distance bin</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kerrie Mengersen, Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code>make.bin</code>, <code>make.covar</code>, <code>runModels</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data=truelove
truelove_red&lt;-truelove[c(1:60),c(1:5)]
distancematrix&lt;-calc.dist(truelove_red)

#calc.dist and make.covar can be time consuming to run, 
# therefore only a small dataset utilized here

Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=5)
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

covariances&lt;-make.covar(truelove_red,distancematrix,binsize,binname)
covariances
</code></pre>


</div>