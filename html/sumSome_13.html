<div class="container">

<table style="width: 100%;"><tr>
<td>sumStats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>True Discovery Guarantee for Generic Statistics</h2>

<h3>Description</h3>

<p>This function determines confidence bounds for the number of true discoveries, the true discovery proportion
and the false discovery proportion within a set of interest.
The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sumStats(G, S = NULL, alternative = "greater", alpha = 0.05,
         truncFrom = NULL, truncTo = NULL, nMax = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>numeric matrix of statistics, where columns correspond to variables, and rows to data transformations (e.g. permutations).
The first transformation is the identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>vector of indices for the variables of interest (if not specified, all variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncFrom</code></td>
<td>
<p>truncation parameter: values less extreme than <code>truncFrom</code> are truncated.
If <code>NULL</code>, statistics are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, statistics are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMax</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Truncation parameters should be such that <code>truncTo</code> is not more extreme than <code>truncFrom</code>.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1), where
<code>B</code> is the number of data transformations (rows in <code>G</code>).
</p>


<h3>Value</h3>

<p><code>sumStats</code> returns an object of class <code>sumObj</code>, containing
</p>

<ul>
<li> <p><code>total</code>: total number of variables (columns in <code>G</code>)
</p>
</li>
<li> <p><code>size</code>: size of <code>S</code>
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries in <code>S</code>
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>iterations</code>: number of iterations of the algorithm
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>True discovery guarantee using p-values: <code>sumPvals</code>
</p>
<p>Access a <code>sumObj</code> object: <code>discoveries</code>, <code>tdp</code>, <code>fdp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate matrix of t-scores for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, p = FALSE, seed = 42)
 
# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
res &lt;- sumStats(G, S, alpha = 0.4, truncFrom = 0.7, truncTo = 0)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>


</div>