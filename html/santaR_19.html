<div class="container">

<table style="width: 100%;"><tr>
<td>santaR_auto_summary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summarise, report and save the results of a santaR analysis</h2>

<h3>Description</h3>

<p>After multiple variables have been analysed using <code>santaR_auto_fit</code>, <code>santaR_auto_summary</code> helps identify significant results and summarise them in an interpretable fashion. Correction for multiple testing can be applied to generate Bonferroni <cite>[1]</cite>, Benjamini-Hochberg <cite>[2]</cite> or Benjamini-Yekutieli <cite>[3]</cite> corrected <em>p</em>-values. <em>P</em>-values can be saved to disk in <code>.csv</code> files. For a given significance cut-off (<code>plotCutOff</code>), the number of variables significantly altered is reported and plots are automatically saved to disk by increasing <em>p</em>-value. The aspect of the plots can be altered such as the representation of confidence bands (<code>showConfBand</code>) or the generation of a mean curve across all samples (<code>showTotalMeanCurve</code>) to help assess difference between groups when group sizes are unbalanced.
</p>


<h3>Usage</h3>

<pre><code class="language-R">santaR_auto_summary(
  SANTAObjList,
  targetFolder = NA,
  summaryCSV = TRUE,
  CSVName = "summary",
  savePlot = TRUE,
  plotCutOff = 0.05,
  showTotalMeanCurve = TRUE,
  showConfBand = TRUE,
  legend = TRUE,
  fdrBH = TRUE,
  fdrBY = FALSE,
  fdrBonf = FALSE,
  CIpval = TRUE,
  plotAll = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SANTAObjList</code></td>
<td>
<p>A list of <em>SANTAObj</em> with <em>p</em>-values calculated, as generated by <code>santaR_auto_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetFolder</code></td>
<td>
<p>(NA or str) NA or the path to a folder in which to save summary.xls and plots. If NA no outputs are saved to disk. If <code>targetFolder</code> does not exist, folders will be created. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summaryCSV</code></td>
<td>
<p>If TRUE save the (<em>corrected if applicable</em>) <em>p</em>-values to <code>'CSVName'_summary.csv</code>, <code>'CSVName'_pvalue-all.csv</code>, <code>'CSVName'_pvalue-dist.csv</code>, <code>'CSVName'_pvalue-dist.csv</code> (<em>default <code>summary_summary.csv</code>,...</em>). Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CSVName</code></td>
<td>
<p>(string) Filename of the <em>csv</em> to save. Default is <code>'summary'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savePlot</code></td>
<td>
<p>If TRUE save to <code>targetFolder</code> all variables with <em>p</em> &lt; <code>plotCutOff</code> ordered by <em>p</em>-values. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotCutOff</code></td>
<td>
<p>(float) <em>P</em>-value cut-off value to save summary plots to disk. Default 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTotalMeanCurve</code></td>
<td>
<p>If TRUE add the mean curve across all groups on the plots. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showConfBand</code></td>
<td>
<p>If TRUE plot the confidence band for each group. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>If TRUE add a legend to the plots. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrBH</code></td>
<td>
<p>If TRUE add the Benjamini-Hochberg corrected <em>p</em>-value to the output. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrBY</code></td>
<td>
<p>If TRUE add the Benjamini-Yekutieli corrected <em>p</em>-value to the output. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrBonf</code></td>
<td>
<p>If TRUE add the Bonferroni corrected <em>p</em>-value to the output. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIpval</code></td>
<td>
<p>If TRUE add the upper and lower confidence interval on <em>p</em>-value to the output. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotAll</code></td>
<td>
<p>If TRUE override the <code>plotCutOff</code> parameter and plot all variables. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list: <code>result$pval.all</code> <code>data.frame</code> of <em>p</em>-values, with all variables as rows and different <em>p</em>-value corrections as columns. <code>result$pval.summary</code> <code>data.frame</code> of number of variables with a <em>p</em>-value inferior to a cut-off. Different metric and <em>p</em>-value correction as rows, different cut-off (<em>Inf 0.05</em>, <em>Inf 0.01</em>, <em>Inf 0.001</em>) as columns.
</p>


<h3>References</h3>

<p>[1] Bland, J. M. &amp; Altman, D. G. <em>Multiple significance tests: the Bonferroni method</em>. British Medial Journal <strong>310</strong>, 170 (1995).
</p>
<p>[2] Benjamini, Y. &amp; Hochberg, Y. <em>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</em>. Journal of the Royal Statistical Society <strong>57</strong>, 1, 289-300 (1995).
</p>
<p>[3] Benjamini, Y. &amp; Yekutieli, D. <em>The control of the false discovery rate in multiple testing under depencency</em>. The Annals of Statistics <strong>29</strong>, 1165-1188 (2001).
</p>


<h3>See Also</h3>

<p>Other AutoProcess: 
<code>santaR_auto_fit()</code>,
<code>santaR_plot()</code>,
<code>santaR_start_GUI()</code>
</p>
<p>Other Analysis: 
<code>get_grouping()</code>,
<code>get_ind_time_matrix()</code>,
<code>santaR_CBand()</code>,
<code>santaR_auto_fit()</code>,
<code>santaR_fit()</code>,
<code>santaR_plot()</code>,
<code>santaR_pvalue_dist()</code>,
<code>santaR_pvalue_fit()</code>,
<code>santaR_start_GUI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 2 variables, 56 measurements, 8 subjects, 7 unique time-points
## Default parameter values decreased to ensure an execution &lt; 2 seconds
inputData     &lt;- acuteInflammation$data[,1:2]
ind           &lt;- acuteInflammation$meta$ind
time          &lt;- acuteInflammation$meta$time
group         &lt;- acuteInflammation$meta$group
SANTAObjList  &lt;- santaR_auto_fit(inputData, ind, time, group, df=5, ncores=0, CBand=TRUE,
                                pval.dist=TRUE, nBoot=100, nPerm=100)
# Input data generated: 0.02 secs
# Spline fitted: 0.03 secs
# ConfBands done: 0.53 secs
# p-val dist done: 0.79 secs
# total time: 1.37 secs
result &lt;- santaR_auto_summary(SANTAObjList)
print(result)
# $pval.all
#              dist dist_upper  dist_lower     curveCorr    dist_BH
# var_1 0.03960396 0.09783202 0.015439223 -0.2429725352 0.03960396
# var_2 0.00990099 0.05432519 0.001737742  0.0006572238 0.01980198
#
# $pval.summary
#       Test Inf 0.05 Inf 0.01 Inf 0.001
# 1    dist        2        1         0
# 2 dist_BH        2        0         0

</code></pre>


</div>