<div class="container">

<table style="width: 100%;"><tr>
<td>seawaveQPlots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function that generates plots of data and model results.</h2>

<h3>Description</h3>

<p>seawaveQPlots is usually called from within <code>fitMod</code> but
can be invoked directly. It generates plots of data and model results, 
as well as diagnostic plots, and returns the observed and predicted 
concentrations so that users may plot the concentrations using 
their own functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seawaveQPlots(
  stpars,
  cmaxt,
  tseas,
  tseaspr,
  tndlin,
  tndlinpr,
  cdatsub,
  cavdat,
  cavmat,
  clog,
  centmp,
  yrstart,
  yrend,
  tyr,
  tyrpr,
  pnames,
  tanm,
  mclass = 1,
  plotfile = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stpars</code></td>
<td>
<p>is a matrix of information about the best seawaveQ model
for the concentration data, see <code>examplestpars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmaxt</code></td>
<td>
<p>is the decimal season of maximum chemical concentration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tseas</code></td>
<td>
<p>is the decimal season of each concentration value in 
cdatsub.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tseaspr</code></td>
<td>
<p>is the decimal season date used to model concentration 
using the continuous data set cavdat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tndlin</code></td>
<td>
<p>is the decimal time centered on the midpoint of the trend
for the sample data, cdatasub.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tndlinpr</code></td>
<td>
<p>is the decimal time centered on the midpoint of the 
trend for the continuous data, cavdat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdatsub</code></td>
<td>
<p>is the concentration data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cavmat</code></td>
<td>
<p>is a matrix containing the continuous ancillary 
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clog</code></td>
<td>
<p>is a vector of the base-10 logarithms of the concentration 
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centmp</code></td>
<td>
<p>is a logical vector indicating which concentration values
are censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tyr</code></td>
<td>
<p>is a vector of decimal dates for the concentration data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tyrpr</code></td>
<td>
<p>is a vector of decimal dates for the continuous ancillary
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnames</code></td>
<td>
<p>is the parameter (water-quality constituents) to 
analyze (if using USGS parameters, omit the starting 'P', such as 
"00945" for sulfate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tanm</code></td>
<td>
<p>is a character identifier that names the trend 
analysis run.  It is used to label output files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mclass</code></td>
<td>
<p>has not been implemented yet, but will provide
additional model options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotfile</code></td>
<td>
<p>is by default FALSE. True will write pdf files of plots to 
the user's file system.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A PDF file containing plots of the data and modeled 
concentrations and regression diagnostic plots and a list containing
the observed concentrations (censored and uncensored) and the predicted
concentrations used for the plot.
</p>


<h3>Note</h3>

<p>The plotting position used for representing censored values in 
the plots produced by <code>seawaveQPlots</code> is an important 
consideration for interpreting model fit. Plotting values obtained by 
using the censoring limit, or something smaller such as one-half of the 
censoring limit, produce plots that are difficult to interpret if there 
are a large number of censored values. Therefore, to make the plots 
more representative of diagnostic plots used for standard 
(non-censored) regression, a method for substituting randomized 
residuals in place of censored residuals was used. If a 
log-transformed concentration is censored at a particular limit, 
<code>logC &lt; L</code>, then the residual for that concentration is censored 
as well, <code>logC - fitted(logC) &lt; L - fitted(logC) = rescen</code>. In 
that case, a randomized residual was generated from a conditional 
normal distribution <br><br><code>resran  &lt;-  scl * qnorm(runif(1) * pnorm(rescen / scl))</code>, <br><br>
where <code>scl</code> is the scale parameter from the survival regression model, 
<code>pnorm</code> is the R function for computing cumulative normal 
probabilities, <code>runif</code> is the R function for generating a 
random variable from the uniform distribution, and <code>qnorm</code> 
is the R function for computing quantiles of the normal distribution.  
Under the assumption that the model residuals are uncorrelated, 
normally distributed random variables with mean zero and standard 
deviation <code>scl</code>, the randomized residuals generated in this manner are an 
unbiased sample of the true (but unknown) residuals for the censored 
data. This is an application of the probability integral transform 
(Mood and others, 1974) to generate random variables from continuous 
distributions. The plotting position used a censored concentration is 
<code>fitted(logC) + resran</code>. Note that each time a new model fit is 
performed, a new set of randomized residuals is generated and thus the 
plotting positions for censored values can change.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>References</h3>

<p>Mood, A.M., Graybill, F.A., and Boes, D.C., 1974, Introduction to the 
theory of statistics (3rd ed.): New York, McGraw-Hill, Inc., 564 p.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(swData)
myPlots &lt;- seawaveQPlots(stpars=examplestpars, cmaxt=0.4808743, 
tseas=exampletseas, tseaspr=exampletseaspr, tndlin=exampletndlin,
tndlinpr=exampletndlinpr, cdatsub=examplecdatsub, cavdat=examplecavdat, 
cavmat=examplecavmat, clog=exampleclog, centmp=examplecentmp, 
yrstart=1995, yrend=2003, tyr=exampletyr, tyrpr=exampletyrpr, 
pnames=c("04041"), tanm="examplePlots04041", plotfile = FALSE)
</code></pre>


</div>