<div class="container">

<table style="width: 100%;"><tr>
<td>shape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shape Selection</h2>

<h3>Description</h3>

<p>Given a predictor vector <code class="reqn">\bold{x}</code>, e.g., years, and a matrix <code class="reqn">\bold{ymat}</code> whose columns are response vectors, e.g., Landsat signals. The shape routine will select a shape that is the best fit for each response vector according to the Bayes information criterion (BIC) or the cone information criterion (CIC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">shape(x, ymat, infocrit = "CIC", flat = TRUE, dec = TRUE, jp = TRUE, 
invee = TRUE, vee = TRUE, inc = TRUE, db = TRUE, nsim = 1e+3, 
edf0 = NULL, get.edf0 = FALSE, random = FALSE, msg = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code class="reqn">n</code> by <code class="reqn">1</code> predictor vector, for example, years.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymat</code></td>
<td>
<p>A <code class="reqn">n</code> by <code class="reqn">N</code> matrix whose columns are response vectors corresponding to x, for example, Landsat signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infocrit</code></td>
<td>
<p>The criterion used to select the best shape for a scatterplot. It can either be the Bayes information criterion (BIC) or the cone information criterion (CIC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flat</code></td>
<td>
<p>A logical flag. If it is TRUE, there is a flat shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>A logical flag. If it is TRUE, there is a decreasing shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jp</code></td>
<td>
<p>A logical flag. If it is TRUE, there is a one-jump shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invee</code></td>
<td>
<p>A logical flag. If it is TRUE, there is an inverted-vee shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vee</code></td>
<td>
<p>A logical flag. If it is TRUE, there is a vee shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc</code></td>
<td>
<p>A logical flag. If it is TRUE, there is an increasing shape choice; otherwise, there is no such a shape option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>A logical flag. If it is TRUE, there is a double-jump shape choice; otherwise, there is no such a shape option. The routine is usually slower when there is a double-jump shape choice than it is when there is no such a choice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations used to get the edf0 vector. The default is nsim = 1e+3. See references in this section
for more details about edf0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edf0</code></td>
<td>
<p>The edf0 given by the user. When <code class="reqn">\bold{x}</code> is an equally spaced vector whose number of elements is between <code class="reqn">20</code> and <code class="reqn">40</code>. The user doesn't need to provide an edf0 vector; otherwise, the user has to set get.edf0 to be TRUE such that the shape routine will simulate an edf0 vector, or the user can choose to simulate an edf0 vector by the getedf0 routine and provide the edf0 vector to the shape routine with this argument. The default is edf0 = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get.edf0</code></td>
<td>
<p>A logical flag. When <code class="reqn">\bold{x}</code> is not an equally spaced vector whose number of elements is between <code class="reqn">20</code> and <code class="reqn">40</code>. The user has to set get.edf0 to be TRUE such that the shape routine will simulate an edf0 vector, or the user can choose to simulate an edf0 vector by the “getedf0” routine and provide the edf0 vector to the shape routine with the edf0 argument. The default is get.edf0 = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A parameter used by the maintainer to test if each shape option can be both included and excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>A logical flag. If msg is TRUE, then a warning message will be printed when there is a non-convergence problem; otherwise no warning message will be printed. The default is msg = FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a scatterplot of <code class="reqn">(x_i, y_i)</code>, <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">\bold{x}</code> could be a vector of years and <code class="reqn">\bold{y}</code> could be a vector of Landsat signals, constrained least-squares spline fits are obtained for the following shapes:
</p>

<ul>
<li>
<p>1. flat
</p>
</li>
<li>
<p>2. decreasing
</p>
</li>
<li>
<p>3. one-jump, i.e., decreasing, jump up, decreasing
</p>
</li>
<li>
<p>4. inverted vee (increasing then decreasing)
</p>
</li>
<li>
<p>5. vee (decreasing then increasing)
</p>
</li>
<li>
<p>6. linear increasing
</p>
</li>
<li>
<p>7. double-jump, i.e., decreasing, jump up, decreasing, jump up, decreasing.
</p>
</li>
</ul>
<p>The "shape" routine chooses one of the shapes allowed by the user based on the minimum Bayes information criterion (BIC) or the cone information criterion (CIC). It also returns the information criterion (IC) values for shapes allowed by the user. Fitting method is constrained quadratic B-splines, number of knots depends on number of observations. The cone projection algorithm used in this routine is implemented by the <b>R</b> package <b>coneproj</b>. 
</p>
<p>See references cited in this section and the official manual (<a href="https://cran.r-project.org/package=coneproj">https://cran.r-project.org/package=coneproj</a>) for the <b>R</b> package <b>coneproj</b> for more details.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p> A <code class="reqn">N</code> by <code class="reqn">1</code> vector. The <code class="reqn">i</code>th element is the best shape for each of the <code class="reqn">i</code>th scatterplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>A <code class="reqn">k</code> by <code class="reqn">N</code> matrix where the <code class="reqn">i</code>th column is the vector of "BIC" or "CIC" values used to choose the best shape for the <code class="reqn">i</code>th scatterplot. <code class="reqn">k</code> is the number of shapes allowed by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetab</code></td>
<td>
<p>A <code class="reqn">n</code> by <code class="reqn">N</code> matrix where the <code class="reqn">i</code>th column is the vector of predicted values for the chosen shape for the <code class="reqn">i</code>th scatterplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The argument x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymat</code></td>
<td>
<p>The argument ymat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infocrit</code></td>
<td>
<p>The argument infocrit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of knots used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>A list of coefficient vectors. Each vector is the vector of coefficients for regression basis functions for each scatterplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ijps</code></td>
<td>
<p>A list storing the position of the first jump for scatterplots whose best shape is one-jump or double-jump. It also stores the position of the knot from where <code class="reqn">\bold{f}</code> starts increasing (decreasing) for scatterplots whose best shape is vee (inverted vee).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jjps</code></td>
<td>
<p>A list storing the position of the second jump for scatterplots whose best shape is double-jump.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_is</code></td>
<td>
<p>A vector storing the centering values for the first ramp edge for scatterplots whose best shape is one-jump or double-jump.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_js</code></td>
<td>
<p>A vector storing the centering values for the second ramp edge for scatterplots whose best shape is double-jump.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tm</code></td>
<td>
<p>Total cpu running time.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mary C. Meyer and Xiyue Liao 
</p>


<h3>References</h3>

<p>Meyer, M. C. (2013a) Semi-parametric additive constrained regression. 
<em>Journal of Nonparametric Statistics <b>25(3)</b></em>, 715.
</p>
<p>Meyer, M. C. (2013b) A simple new algorithm for quadratic programming with applications in statistics. <em>Communications in Statistics <b>42(5)</b></em>, 1126–1139.  
</p>
<p>Liao, X. and M. C. Meyer (2014) coneproj: An R package for the primal or dual cone projections with routines for constrained regression. <em>Journal of Statistical Software <b>61(12)</b></em>, 1–22.
</p>


<h3>See Also</h3>

<p><code>plotshape</code>, <code>edf0s</code></p>


<h3>Examples</h3>

<pre><code class="language-R">	# import the matrix of Landsat signals 
	data("ymat")

	# define the predictor vector: the year 1985 to the year 2010	
	x &lt;- 1985:2010
## Not run: 
	# Example 1:	
	# call the shape routine allowing a double jump shape using "BIC"
	ans &lt;- shape(x, ymat, "BIC")
	plotshape(ans, ids = 1:6, both = TRUE, form = TRUE)

## End(Not run)
## Not run: 
	# Example 2:
	# call the shape routine not allowing a double jump shape using "CIC"
	ans &lt;- shape(x, ymat, "CIC", db = FALSE)
	plotshape(ans, ids = 1:6, both = TRUE, form = TRUE)

## End(Not run)
</code></pre>


</div>