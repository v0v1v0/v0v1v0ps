<div class="container">

<table style="width: 100%;"><tr>
<td>moran_bv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Global Bivariate Moran's I</h2>

<h3>Description</h3>

<p>Given two continuous numeric variables, calculate the bivariate Moran's I. See details for more.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moran_bv(x, y, listw, nsim = 499, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of same length as <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a listw object for example as created by <code>nb2listw()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>default <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Global Bivariate Moran is defined as
</p>
<p><code class="reqn">
I_B = \frac{\Sigma_i(\Sigma_j{w_{ij}y_j\times x_i})}{\Sigma_i{x_i^2}}
</code>
</p>
<p>It is important to note that this is a measure of autocorrelation of X
with the spatial lag of Y. As such, the resultant measure may overestimate the amount of
spatial autocorrelation which may be a product of the inherent correlation of X and Y. The output object is of class <code>"boot"</code>, so that plots and confidence intervals are available using appropriate methods.
</p>


<h3>Value</h3>

<p>An object of class <code>"boot"</code>, with the observed statistic in component <code>t0</code>.
</p>


<h3>Author(s)</h3>

<p>Josiah Parry <a href="mailto:josiah.parry@gmail.com">josiah.parry@gmail.com</a></p>


<h3>References</h3>

<p>Wartenberg, D. (1985), Multivariate Spatial Correlation: A Method for Exploratory Geographical Analysis. Geographical Analysis, 17: 263-283. <a href="https://doi.org/10.1111/j.1538-4632.1985.tb00849.x">doi:10.1111/j.1538-4632.1985.tb00849.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(boston, package = "spData")
x &lt;- boston.c$CRIM
y &lt;- boston.c$NOX
listw &lt;- nb2listw(boston.soi)
set.seed(1)
res_xy &lt;- moran_bv(x, y, listw, nsim=499)
res_xy$t0
boot::boot.ci(res_xy, conf=c(0.99, 0.95, 0.9), type="basic")
plot(res_xy)
set.seed(1)
lee_xy &lt;- lee.mc(x, y, listw, nsim=499, return_boot=TRUE)
lee_xy$t0
boot::boot.ci(lee_xy, conf=c(0.99, 0.95, 0.9), type="basic")
plot(lee_xy)
set.seed(1)
res_yx &lt;- moran_bv(y, x, listw, nsim=499)
res_yx$t0
boot::boot.ci(res_yx, conf=c(0.99, 0.95, 0.9), type="basic")
plot(res_yx)
set.seed(1)
lee_yx &lt;- lee.mc(y, x, listw, nsim=499, return_boot=TRUE)
lee_yx$t0
boot::boot.ci(lee_yx, conf=c(0.99, 0.95, 0.9), type="basic")
plot(lee_yx)
</code></pre>


</div>