<div class="container">

<table style="width: 100%;"><tr>
<td>get_alpha_mt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get the transition weights alpha_mt</h2>

<h3>Description</h3>

<p><code>get_alpha_mt</code> computes the transition weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_alpha_mt(
  data,
  Y2,
  p,
  M,
  d,
  weight_function = c("relative_dens", "logistic", "mlogit", "exponential", "threshold",
    "exogenous"),
  weightfun_pars = NULL,
  all_A,
  all_boldA,
  all_Omegas,
  weightpars,
  all_mu,
  epsilon,
  log_mvdvalues = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix or class <code>'ts'</code> object with <code>d&gt;1</code> columns. Each column is taken to represent
a univariate time series. Missing values are not supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y2</code></td>
<td>
<p>the data arranged as obtained from <code>reform_data(data, p)</code> but excluding the last row</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a positive integer specifying the autoregressive order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a positive integer specifying the number of regimes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the number of time series in the system, i.e., the dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_function</code></td>
<td>
<p>What type of transition weights <code class="reqn">\alpha_{m,t}</code> should be used?
</p>

<dl>
<dt>
<code>"relative_dens"</code>:</dt>
<dd>
<p><code class="reqn">\alpha_{m,t}=
    \frac{\alpha_mf_{m,dp}(y_{t-1},...,y_{t-p+1})}{\sum_{n=1}^M\alpha_nf_{n,dp}(y_{t-1},...,y_{t-p+1})}</code>, where
<code class="reqn">\alpha_m\in (0,1)</code> are weight parameters that satisfy <code class="reqn">\sum_{m=1}^M\alpha_m=1</code> and
<code class="reqn">f_{m,dp}(\cdot)</code> is the <code class="reqn">dp</code>-dimensional stationary density of the <code class="reqn">m</code>th regime corresponding to <code class="reqn">p</code>
consecutive observations. Available for Gaussian conditional distribution only.</p>
</dd>
<dt>
<code>"logistic"</code>:</dt>
<dd>
<p><code class="reqn">M=2</code>, <code class="reqn">\alpha_{1,t}=1-\alpha_{2,t}</code>,
and <code class="reqn">\alpha_{2,t}=[1+\exp\lbrace -\gamma(y_{it-j}-c) \rbrace]^{-1}</code>, where <code class="reqn">y_{it-j}</code> is the lag <code class="reqn">j</code>
observation of the <code class="reqn">i</code>th variable, <code class="reqn">c</code> is a location parameter, and <code class="reqn">\gamma &gt; 0</code> is a scale parameter.</p>
</dd>
<dt>
<code>"mlogit"</code>:</dt>
<dd>
<p><code class="reqn">\alpha_{m,t}=\frac{\exp\lbrace \gamma_m'z_{t-1} \rbrace}
    {\sum_{n=1}^M\exp\lbrace \gamma_n'z_{t-1} \rbrace}</code>, where <code class="reqn">\gamma_m</code> are coefficient vectors, <code class="reqn">\gamma_M=0</code>,
and <code class="reqn">z_{t-1}</code> <code class="reqn">(k\times 1)</code> is the vector containing a constant and the (lagged) switching variables.</p>
</dd>
<dt>
<code>"exponential"</code>:</dt>
<dd>
<p><code class="reqn">M=2</code>, <code class="reqn">\alpha_{1,t}=1-\alpha_{2,t}</code>,
and <code class="reqn">\alpha_{2,t}=1-\exp\lbrace -\gamma(y_{it-j}-c) \rbrace</code>, where <code class="reqn">y_{it-j}</code> is the lag <code class="reqn">j</code>
observation of the <code class="reqn">i</code>th variable, <code class="reqn">c</code> is a location parameter, and <code class="reqn">\gamma &gt; 0</code> is a scale parameter.</p>
</dd>
<dt>
<code>"threshold"</code>:</dt>
<dd>
<p><code class="reqn">\alpha_{m,t} = 1</code> if <code class="reqn">r_{m-1}&lt;y_{it-j}\leq r_{m}</code> and <code class="reqn">0</code> otherwise, where
<code class="reqn">-\infty\equiv r_0&lt;r_1&lt;\cdots &lt;r_{M-1}&lt;r_M\equiv\infty</code> are thresholds <code class="reqn">y_{it-j}</code> is the lag <code class="reqn">j</code>
observation of the <code class="reqn">i</code>th variable.</p>
</dd>
<dt>
<code>"exogenous"</code>:</dt>
<dd>
<p>Exogenous nonrandom transition weights, specify the weight series in <code>weightfun_pars</code>.</p>
</dd>
</dl>
<p>See the vignette for more details about the weight functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightfun_pars</code></td>
<td>

<dl>
<dt>If <code>weight_function == "relative_dens"</code>:</dt>
<dd>
<p>Not used.</p>
</dd>
<dt>If <code>weight_function %in% c("logistic", "exponential", "threshold")</code>:</dt>
<dd>
<p>a numeric vector with the switching variable
<code class="reqn">i\in\lbrace 1,...,d \rbrace</code> in the first and the lag <code class="reqn">j\in\lbrace 1,...,p \rbrace</code> in the second element.</p>
</dd>
<dt>If <code>weight_function == "mlogit"</code>:</dt>
<dd>
<p>a list of two elements:
</p>

<dl>
<dt>The first element <code>$vars</code>:</dt>
<dd>
<p>a numeric vector containing the variables that should used as switching variables
in the weight function in an increasing order, i.e., a vector with unique elements in <code class="reqn">\lbrace 1,...,d \rbrace</code>.</p>
</dd>
<dt>The second element <code>$lags</code>:</dt>
<dd>
<p>an integer in <code class="reqn">\lbrace 1,...,p \rbrace</code> specifying the number of lags to be
used in the weight function.</p>
</dd>
</dl>
</dd>
<dt>If <code>weight_function == "exogenous"</code>:</dt>
<dd>
<p>a size (<code>nrow(data) - p</code> x <code>M</code>) matrix containing the exogenous
transition weights as <code>[t, m]</code> for time <code class="reqn">t</code> and regime <code class="reqn">m</code>. Each row needs to sum to one and only weakly positive
values are allowed.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_A</code></td>
<td>
<p>4D array containing all coefficient matrices <code class="reqn">A_{m,i}</code>, obtained from <code>pick_allA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_boldA</code></td>
<td>
<p>3D array containing the <code class="reqn">((dp)x(dp))</code> "bold A" (companion form) matrices of each regime,
obtained from <code>form_boldA</code>. Will be computed if not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_Omegas</code></td>
<td>
<p>A 3D array containing the covariance matrix parameters obtain from <code>pick_Omegas</code>...
</p>

<dl>
<dt>If <code>cond_dist %in% c("Gaussian", "Student")</code>:</dt>
<dd>
<p>all covariance matrices <code class="reqn">\Omega_{m}</code> in <code>[, , m]</code>.</p>
</dd>
<dt>If <code>cond_dist=="ind_Student"</code>:</dt>
<dd>
<p>all impact matrices <code class="reqn">B_m</code> of the regimes in <code>[, , m]</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightpars</code></td>
<td>
<p>numerical vector containing the transition weight parameters, obtained from <code>pick_weightpars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_mu</code></td>
<td>
<p>an <code class="reqn">(d \times M)</code> matrix containing the unconditional regime-specific means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the smallest number such that its exponent is wont classified as numerically zero
(around <code>-698</code> is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_mvdvalues</code></td>
<td>
<p>a <code class="reqn">T x M</code> matrix containing log multivariate normal densities (can be used with
relative dens weight function only)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that we index the time series as <code class="reqn">-p+1,...,0,1,...,T</code>.
</p>


<h3>Value</h3>

<p>Returns the mixing weights a <code class="reqn">(T x M)</code> matrix, so that the t:th row is for the time point t
and m:th column is for the regime m.
</p>


<h3>References</h3>


<ul>
<li>
<p> Kheifets I.L., Saikkonen P.J. 2020. Stationarity and ergodicity of Vector STAR models.
<em>Econometric Reviews</em>, <strong>39</strong>:4, 407-414.
</p>
</li>
<li>
<p> LÃ¼tkepohl H. 2005. New Introduction to Multiple Time Series Analysis, <em>Springer</em>.
</p>
</li>
<li>
<p> Lanne M., Virolainen S. 2024. A Gaussian smooth transition vector autoregressive model:
An application to the macroeconomic effects of severe weather shocks. Unpublished working
paper, available as arXiv:2403.14216.
</p>
</li>
<li>
<p> Virolainen S. 2024. Identification by non-Gaussianity in structural threshold and
smooth transition vector autoregressive models. Unpublished working
paper, available as arXiv:2404.19707.
</p>
</li>
</ul>
<p>@keywords internal
</p>


</div>