<div class="container">

<table style="width: 100%;"><tr>
<td>SimControl-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "SimControl"</h2>

<h3>Description</h3>

<p>Class for controlling how simulation runs are performed.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("SimControl", ...)</code> or
<code>SimControl(...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>contControl</code>:</dt>
<dd>
<p>Object of class <code>"OptContControl"</code>; a
control object for contamination, or <code>NULL</code>.</p>
</dd>
<dt>
<code>NAControl</code>:</dt>
<dd>
<p>Object of class <code>"OptNAControl"</code>; a control
object for inserting missing values, or <code>NULL</code>.</p>
</dd>
<dt>
<code>design</code>:</dt>
<dd>
<p>Object of class <code>"character"</code> specifying
variables (columns) to be used for splitting the data into domains.  The
simulations, including contamination and the insertion of missing values
(unless <code>SAE=TRUE</code>), are then performed on every domain.</p>
</dd>
<dt>
<code>fun</code>:</dt>
<dd>
<p>Object of class <code>"function"</code> to be applied in each
simulation run.</p>
</dd>
<dt>
<code>dots</code>:</dt>
<dd>
<p>Object of class <code>"list"</code> containing additional
arguments to be passed to <code>fun</code>.</p>
</dd>
<dt>
<code>SAE</code>:</dt>
<dd>
<p>Object of class <code>"logical"</code> indicating whether
small area estimation will be used in the simulation experiment.</p>
</dd>
</dl>
<h3>Details</h3>

<p>There are some requirements for <code>fun</code>.  It must return a numeric vector,
or a list with the two components <code>values</code> (a numeric vector) and
<code>add</code> (additional results of any class, e.g., statistical models).
Note that the latter is computationally slightly more expensive.  A
<code>data.frame</code> is passed to <code>fun</code> in every simulation run.  The
corresponding argument must be called <code>x</code>.  If comparisons with the
original data need to be made, e.g., for evaluating the quality of imputation
methods, the function should have an argument called <code>orig</code>.  If
different domains are used in the simulation, the indices of the current
domain can be passed to the function via an argument called <code>domain</code>.
</p>
<p>For small area estimation, the following points have to be kept in mind.  The
<code>design</code> for splitting the data must be supplied and <code>SAE</code>
must be set to <code>TRUE</code>.  However, the data are not actually split into
the specified domains.  Instead, the whole data set (sample) is passed to
<code>fun</code>.  Also contamination and missing values are added to the whole
data (sample).  Last, but not least, the function must have a <code>domain</code>
argument so that the current domain can be extracted from the whole data
(sample).
</p>
<p>In every simulation run, <code>fun</code> is evaluated using <code>try</code>.  Hence
no results are lost if computations fail in any of the simulation runs.
</p>


<h3>Accessor and mutator methods</h3>


<dl>
<dt><code>getContControl</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>ContControl</code>.</p>
</dd>
<dt><code>setContControl</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>ContControl</code>.</p>
</dd>
<dt><code>getNAControl</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>NAControl</code>.</p>
</dd>
<dt><code>setNAControl</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>NAControl</code>.</p>
</dd>
<dt><code>getDesign</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>design</code>.</p>
</dd>
<dt><code>setDesign</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>design</code>.</p>
</dd>
<dt><code>getFun</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>fun</code>.</p>
</dd>
<dt><code>setFun</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>fun</code>.</p>
</dd>
<dt><code>getDots</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>dots</code>.</p>
</dd>
<dt><code>setDots</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>dots</code>.</p>
</dd>
<dt><code>getSAE</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: get slot
<code>SAE</code>.</p>
</dd>
<dt><code>setSAE</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: set slot
<code>SAE</code>.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt><code>clusterRunSimulation</code></dt>
<dd>
<p><code>signature(cl = "ANY",
      x = "data.frame", setup = "missing", nrep = "numeric",
      control = "SimControl")</code>: run a simulation experiment on a cluster.</p>
</dd>
<dt><code>clusterRunSimulation</code></dt>
<dd>
<p><code>signature(cl = "ANY",
      x = "data.frame", setup = "VirtualSampleControl", nrep = "missing",
      control = "SimControl")</code>: run a simulation experiment on a cluster.</p>
</dd>
<dt><code>clusterRunSimulation</code></dt>
<dd>
<p><code>signature(cl = "ANY",
      x = "data.frame", setup = "SampleSetup", nrep = "missing",
      control = "SimControl")</code>: run a simulation experiment on a cluster.</p>
</dd>
<dt><code>clusterRunSimulation</code></dt>
<dd>
<p><code>signature(cl = "ANY",
      x = "VirtualDataControl", setup = "missing", nrep = "numeric",
      control = "SimControl")</code>: run a simulation experiment on a cluster.</p>
</dd>
<dt><code>clusterRunSimulation</code></dt>
<dd>
<p><code>signature(cl = "ANY",
      x = "VirtualDataControl", setup = "VirtualSampleControl",
      nrep = "numeric", control = "SimControl")</code>: run a simulation experiment
on a cluster.</p>
</dd>
<dt><code>head</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: currently returns
the object itself.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "data.frame",
      setup = "VirtualSampleControl", nrep = "missing",
      control = "SimControl")</code>: run a simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "data.frame",
      setup = "SampleSetup", nrep = "missing", control = "SimControl")</code>: run a
simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "data.frame",
      setup = "missing", nrep = "numeric", control = "SimControl")</code>: run a
simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "data.frame",
      setup = "missing", nrep = "missing", control = "SimControl")</code>: run a
simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "VirtualDataControl",
      setup = "missing", nrep = "numeric", control = "SimControl")</code>: run a
simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "VirtualDataControl",
      setup = "missing", nrep = "missing", control = "SimControl")</code>: run a
simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "VirtualDataControl",
      setup = "VirtualSampleControl", nrep = "numeric",
      control = "SimControl")</code>: run a simulation experiment.</p>
</dd>
<dt><code>runSimulation</code></dt>
<dd>
<p><code>signature(x = "VirtualDataControl",
      setup = "VirtualSampleControl", nrep = "missing",
      control = "SimControl")</code>: run a simulation experiment.</p>
</dd>
<dt><code>show</code></dt>
<dd>
<p><code>signature(object = "SimControl")</code>: print the
object on the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> console.</p>
</dd>
<dt><code>summary</code></dt>
<dd>
<p><code>signature(object = "SimControl")</code>: currently
returns the object itself.</p>
</dd>
<dt><code>tail</code></dt>
<dd>
<p><code>signature(x = "SimControl")</code>: currently returns
the object itself.</p>
</dd>
</dl>
<h3>UML class diagram</h3>

<p>A slightly simplified UML class diagram of the framework can be found in
Figure 1 of the package vignette <em>An Object-Oriented Framework for
Statistical Simulation: The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package <code>simFrame</code></em>.  Use
<code>vignette("simFrame-intro")</code> to view this vignette.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons</p>


<h3>References</h3>

<p>Alfons, A., Templ, M. and Filzmoser, P. (2010) An Object-Oriented Framework for
Statistical Simulation: The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package <span class="pkg">simFrame</span>. <em>Journal of
Statistical Software</em>, <b>37</b>(3), 1â€“36. doi: <a href="https://doi.org/10.18637/jss.v037.i03">10.18637/jss.v037.i03</a>.
</p>


<h3>See Also</h3>

<p><code>runSimulation</code>, <code>"SimResults"</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### design-based simulation
set.seed(12345)  # for reproducibility
data(eusilcP)    # load data

## control objects for sampling and contamination
sc &lt;- SampleControl(size = 500, k = 50)
cc &lt;- DARContControl(target = "eqIncome", epsilon = 0.02,
    fun = function(x) x * 25)

## function for simulation runs
sim &lt;- function(x) {
    c(mean = mean(x$eqIncome), trimmed = mean(x$eqIncome, 0.02))
}

## combine these to "SimControl" object and run simulation
ctrl &lt;- SimControl(contControl = cc, fun = sim)
results &lt;- runSimulation(eusilcP, sc, control = ctrl)

## explore results
head(results)
aggregate(results)
tv &lt;- mean(eusilcP$eqIncome)  # true population mean
plot(results, true = tv)



#### model-based simulation
set.seed(12345)  # for reproducibility

## function for generating data
rgnorm &lt;- function(n, means) {
    group &lt;- sample(1:2, n, replace=TRUE)
    data.frame(group=group, value=rnorm(n) + means[group])
}

## control objects for data generation and contamination
means &lt;- c(0, 0.25)
dc &lt;- DataControl(size = 500, distribution = rgnorm,
    dots = list(means = means))
cc &lt;- DCARContControl(target = "value",
    epsilon = 0.02, dots = list(mean = 15))

## function for simulation runs
sim &lt;- function(x) {
    c(mean = mean(x$value),
        trimmed = mean(x$value, trim = 0.02),
        median = median(x$value))
}

## combine these to "SimControl" object and run simulation
ctrl &lt;- SimControl(contControl = cc, design = "group", fun = sim)
results &lt;- runSimulation(dc, nrep = 50, control = ctrl)

## explore results
head(results)
aggregate(results)
plot(results, true = means)
</code></pre>


</div>