<div class="container">

<table style="width: 100%;"><tr>
<td>skipTrack.MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform one chain of MCMC sampling for the skipTrack model.</h2>

<h3>Description</h3>

<p>This function runs a single Markov Chain Monte Carlo (MCMC) chain to update parameters in
the skipTrack hierarchical model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">skipTrack.MCMC(
  Y,
  cluster,
  X = matrix(1, nrow = length(cluster)),
  Z = matrix(1, nrow = length(cluster)),
  numSkips = 10,
  reps = 1000,
  fixedSkips = FALSE,
  initialParams = list(pi = rep(1/(numSkips + 1), numSkips + 1), muis = rep(log(30),
    length(unique(cluster))), tauis = rep(5, length(unique(cluster))), rho = 1, cijs =
    sample(1:3, length(Y), replace = TRUE), alphas = rep(1, numSkips + 1), Beta =
    matrix(rep(0, ncol(as.matrix(X))), 1), Gamma = matrix(rep(0, ncol(as.matrix(Z))), 1),
    rhoBeta = 0.01, rhoGamma = 1000, phi = 0.01, rhoPhi = 1000),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A vector of observed cycle lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A vector indicating the individual cluster/group membership for each observation Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix (length(Y) x length(Beta)) of covariates for cycle length mean. Default is a vector of 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A matrix (length(Y) x length(Gamma)) of covariates for cycle length precision. Default is a vector of 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numSkips</code></td>
<td>
<p>The maximum number of skips to allow. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>The number of MCMC iterations (steps) to perform. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedSkips</code></td>
<td>
<p>If TRUE cycle skip information (cijs) is not updated in sample steps and the inputs are instead assumed to be true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialParams</code></td>
<td>
<p>A list of initial parameter values for the MCMC algorithm.
Default values are provided for pi, muis, tauis, rho, cijs, alphas, Beta, Gamma, phi, rhoBeta, rhoGamma, and rhoPhi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If true progress bars and additional info are printed to the console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the MCMC draws for each parameter at each iteration. Each element
in the list is itself a list containing:
</p>

<dl>
<dt>ijDat</dt>
<dd>
<p>A data.frame with updated parameters at the individual-observation level: Individual, ys, cijs, muis, tauis.</p>
</dd>
<dt>iDat</dt>
<dd>
<p>A data.frame with updated parameters at the individual level: Individual, mus, taus, thetas.</p>
</dd>
<dt>rho</dt>
<dd>
<p>Updated value of the global parameter rho.</p>
</dd>
<dt>pi</dt>
<dd>
<p>Updated value of the global parameter pi.</p>
</dd>
<dt>Xi</dt>
<dd>
<p>Matrix of covariates for cycle length mean.</p>
</dd>
<dt>Zi</dt>
<dd>
<p>Matrix of covariates for cycle length precision.</p>
</dd>
<dt>Beta</dt>
<dd>
<p>Updated matrix of coefficients for cycle length mean.</p>
</dd>
<dt>Gamma</dt>
<dd>
<p>Updated matrix of coefficients for cycle length precision.</p>
</dd>
<dt>priorAlphas</dt>
<dd>
<p>Vector of prior alpha values for updating pi.</p>
</dd>
<dt>indFirst</dt>
<dd>
<p>A logical vector indicating the first occurrence of each individual.</p>
</dd>
<dt>rhoBeta</dt>
<dd>
<p>Hyperprior parameter rhoBeta, used to update Beta.</p>
</dd>
<dt>rhoGamma</dt>
<dd>
<p>Value of the proposal parameter rhoGamma.</p>
</dd>
<dt>phi</dt>
<dd>
<p>Updated value of the parameter phi.</p>
</dd>
<dt>rhoPhi</dt>
<dd>
<p>Value of the proposal parameter rhoPhi.</p>
</dd>
<dt>fixedSkips</dt>
<dd>
<p>Logical. Indicates if skips were fixed.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>sampleStep</code>
</p>


</div>