<div class="container">

<table style="width: 100%;"><tr>
<td>punchcard&lt;-</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set a template for where to record result during a simulation</h2>

<h3>Description</h3>

<p>Using a sparse result matrix can save a lot of memory if the model
contains many nodes and time-points, but where only a few of the
data points are of interest for post-processing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">punchcard(model) &lt;- value

## S4 replacement method for signature 'SimInf_model'
punchcard(model) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The <code>model</code> to set a template for where to
record result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>A <code>data.frame</code> that specify the nodes,
time-points and compartments to record the number of
individuals at <code>tspan</code>. Use <code>NULL</code> to reset the
model to record the number of inidividuals in each compartment
in every node at each time-point in tspan.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using a sparse result matrix can save a lot of memory if the model
contains many nodes and time-points, but where only a few of the
data points are of interest for post-processing. To use this
feature, a template has to be defined for which data points to
record. This is done using a <code>data.frame</code> that specifies the
time-points (column ‘time’) and nodes (column
‘node’) to record the state of the compartments, see
‘Examples’. The specified time-points, nodes and
compartments must exist in the model, or an error is raised. Note
that specifying a template only affects which data-points are
recorded for post-processing, it does not affect how the solver
simulates the trajectory.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## For reproducibility, call the set.seed() function and specify
## the number of threads to use. To use all available threads,
## remove the set_num_threads() call.
set.seed(123)
set_num_threads(1)

## Create an 'SIR' model with 6 nodes and initialize it to run over 10 days.
u0 &lt;- data.frame(S = 100:105, I = 1:6, R = rep(0, 6))
model &lt;- SIR(u0 = u0, tspan = 1:10, beta = 0.16, gamma = 0.077)

## Run the model.
result &lt;- run(model)

## Display the trajectory with data for every node at each
## time-point in tspan.
trajectory(result)

## Assume we are only interested in nodes '2' and '4' at the
## time-points '3' and '5'
df &lt;- data.frame(time = c(3, 5, 3, 5),
                 node = c(2, 2, 4, 4),
                 S = c(TRUE, TRUE, TRUE, TRUE),
                 I = c(TRUE, TRUE, TRUE, TRUE),
                 R = c(TRUE, TRUE, TRUE, TRUE))
punchcard(model) &lt;- df
result &lt;- run(model)
trajectory(result)

## We can also specify to record only some of the compartments in
## each time-step.
df &lt;- data.frame(time = c(3, 5, 3, 5),
                 node = c(2, 2, 4, 4),
                 S = c(FALSE, TRUE, TRUE, TRUE),
                 I = c(TRUE, FALSE, TRUE, FALSE),
                 R = c(TRUE, FALSE, TRUE, TRUE))
punchcard(model) &lt;- df
result &lt;- run(model)
trajectory(result)

## A shortcut to specify to record all of the compartments in
## each time-step is to only inlude node and time.
df &lt;- data.frame(time = c(3, 5, 3, 5),
                 node = c(2, 2, 4, 4))
punchcard(model) &lt;- df
result &lt;- run(model)
trajectory(result)

## It is possible to use an empty 'data.frame' to specify
## that no data-points should be recorded for the trajectory.
punchcard(model) &lt;- data.frame()
result &lt;- run(model)
trajectory(result)

## Use 'NULL' to reset the model to record data for every node at
## each time-point in tspan.
punchcard(model) &lt;- NULL
result &lt;- run(model)
trajectory(result)
</code></pre>


</div>