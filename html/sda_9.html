<div class="container">

<table style="width: 100%;"><tr>
<td>sda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shrinkage Discriminant Analysis 2: Training Step</h2>

<h3>Description</h3>

<p><code>sda</code> trains a LDA or DDA classifier using James-Stein-type shrinkage estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sda(Xtrain, L, lambda, lambda.var, lambda.freqs, diagonal=FALSE, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>A matrix  containing the training data set. Note that 
the rows correspond to observations and the columns
to variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>A factor with the class labels of the training samples. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Shrinkage intensity for the correlation matrix. If not specified it is 
estimated from the data. <code>lambda=0</code> implies no shrinkage
and <code>lambda=1</code> complete shrinkage. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.var</code></td>
<td>
<p>Shrinkage intensity for the variances. If not specified it is 
estimated from the data. <code>lambda.var=0</code> implies no shrinkage
and <code>lambda.var=1</code> complete shrinkage. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.freqs</code></td>
<td>
<p>Shrinkage intensity for the frequencies. If not specified it is 
estimated from the data. <code>lambda.freqs=0</code> implies no shrinkage (i.e. empirical frequencies)
and <code>lambda.freqs=1</code> complete shrinkage (i.e. uniform frequencies). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal</code></td>
<td>
<p>Chooses between LDA (default, <code>diagonal=FALSE</code>) and DDA (<code>diagonal=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print out some info while computing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to train the LDA or DDA classifier, three separate shrinkage estimators are employed:
</p>

<ul>
<li>
<p>class frequencies: the  estimator <code>freqs.shrink</code> 
from   Hausser and Strimmer (2008),
</p>
</li>
<li>
<p>variances: the estimator <code>var.shrink</code> from Opgen-Rhein and Strimmer (2007),  
</p>
</li>
<li>
<p>correlations: the estimator <code>cor.shrink</code> from Sch\"afer and Strimmer (2005).  
</p>
</li>
</ul>
<p>Note that the three corresponding regularization parameters
are obtained analytically without resorting to computer intensive resampling.
</p>


<h3>Value</h3>

<p><code>sda</code> trains the classifier and returns an <code>sda</code> object
with the following components needed for the subsequent prediction:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>regularization</code></td>
<td>
<p>a vector containing the three estimated shrinkage intensities,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>the estimated class frequencies,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector containing the intercepts used for prediction,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>matrix containing the coefficients used for prediction.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Miika Ahdesm\"aki and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Ahdesm\"aki, A., and K. Strimmer. 2010.  Feature selection in omics prediction problems 
using cat scores and false non-discovery rate control. Ann. Appl. Stat. 4: 503-519.
&lt;DOI:10.1214/09-AOAS277&gt;
</p>


<h3>See Also</h3>

<p><code>predict.sda</code>, <code>sda.ranking</code>,
<code>freqs.shrink</code>, 
<code>var.shrink</code>, 
<code>invcor.shrink</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load sda library
library("sda")

########################## 
# training and test data #
##########################

# data set containing the SRBCT samples
get.srbct = function()
{
  data(khan2001)
  idx = which( khan2001$y == "non-SRBCT" )
  x = khan2001$x[-idx,]
  y = factor(khan2001$y[-idx])
  descr = khan2001$descr[-idx]

  list(x=x, y=y, descr=descr)
}
srbct = get.srbct()

# training data
Xtrain = srbct$x[1:63,]
Ytrain = srbct$y[1:63]
Xtest = srbct$x[64:83,]
Ytest = srbct$y[64:83]


###################################################
# classification with correlation (shrinkage LDA) #
###################################################

sda.fit = sda(Xtrain, Ytrain)
ynew = predict(sda.fit, Xtest)$class # using all 2308 features
sum(ynew != Ytest) 

###########################################################
# classification with diagonal covariance (shrinkage DDA) #
###########################################################

sda.fit = sda(Xtrain, Ytrain, diagonal=TRUE)
ynew = predict(sda.fit, Xtest)$class # using all 2308 features
sum(ynew != Ytest) 

#################################################################
# for complete example scripts illustrating classification with #
# feature selection visit https://strimmerlab.github.io/software/sda/  #
#################################################################
</code></pre>


</div>