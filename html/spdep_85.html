<div class="container">

<table style="width: 100%;"><tr>
<td>globalG.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global G test for spatial autocorrelation</h2>

<h3>Description</h3>

<p>The global G statistic for spatial autocorrelation, complementing the local Gi LISA measures: <code>localG</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">globalG.test(x, listw, zero.policy=attr(listw, "zero.policy"), alternative="greater",
 spChk=NULL, adjust.n=TRUE, B1correct=TRUE, adjust.x=TRUE, Arc_all_x=FALSE,
 na.action=na.fail)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code>; if a sequence of distance bands is to be used, it is recommended that the weights style be binary (one of <code>c("B", "C", "U")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of "greater" (default), "less" or "two.sided".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.n</code></td>
<td>
<p>default TRUE, if FALSE the number of observations is not adjusted for no-neighbour observations, if TRUE, the number of observations is adjusted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B1correct</code></td>
<td>
<p>default TRUE, if TRUE, the erratum referenced below: "On page 195, the coefficient of W2 in B1, (just below center of the page) should be 6,  not 3." is applied; if FALSE, 3 is used (as in CrimeStat IV)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.x</code></td>
<td>
<p>default TRUE, if TRUE, x values of observations with no neighbours are omitted in the denominator of G</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Arc_all_x</code></td>
<td>
<p>default FALSE, if Arc_all_x=TRUE and adjust.x=TRUE, use the full x vector in part of the denominator term for G</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted. <code>na.pass</code> is not permitted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with class <code>htest</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the standard deviate of Getis-Ord G.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the value of the observed statistic, its expectation and variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hisaji ONO <a href="mailto:hi-ono@mn.xdsl.ne.jp">hi-ono@mn.xdsl.ne.jp</a> and Roger Bivand 
<a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Getis. A, Ord, J. K. 1992 The analysis of spatial association by 
use of distance statistics, <em>Geographical Analysis</em>, 24, p. 195; see
also Getis. A, Ord, J. K. 1993 Erratum, <em>Geographical Analysis</em>, 25, 
p. 276; Bivand RS, Wong DWS 2018 Comparing implementations of global and local indicators of spatial association. TEST, 27(3), 716â€“748 <a href="https://doi.org/10.1007/s11749-018-0599-x">doi:10.1007/s11749-018-0599-x</a></p>


<h3>See Also</h3>

<p><code>localG</code></p>


<h3>Examples</h3>

<pre><code class="language-R">nc.sids &lt;- st_read(system.file("shapes/sids.gpkg", package="spData")[1], quiet=TRUE)
sidsrate79 &lt;- (1000*nc.sids$SID79)/nc.sids$BIR79
dists &lt;- c(10, 20, 30, 33, 40, 50, 60, 70, 80, 90, 100)
ndists &lt;- length(dists)
ZG &lt;- vector(mode="list", length=ndists)
names(ZG) &lt;- as.character(dists)
milesxy &lt;- cbind(nc.sids$east, nc.sids$north)
for (i in 1:ndists) {
  thisnb &lt;- dnearneigh(milesxy, 0, dists[i])
  thislw &lt;- nb2listw(thisnb, style="B", zero.policy=TRUE)
  ZG[[i]] &lt;- globalG.test(sidsrate79, thislw, zero.policy=TRUE)
}
t(sapply(ZG, function(x) c(x$estimate[1], x$statistic, p.value=unname(x$p.value))))
for (i in 1:ndists) {
  thisnb &lt;- dnearneigh(milesxy, 0, dists[i])
  thislw &lt;- nb2listw(thisnb, style="B", zero.policy=TRUE)
  ZG[[i]] &lt;- globalG.test(sidsrate79, thislw, zero.policy=TRUE, alternative="two.sided")
}
t(sapply(ZG, function(x) c(x$estimate[1], x$statistic, p.value=unname(x$p.value))))
data(oldcol)
crime &lt;- COL.OLD$CRIME
is.na(crime) &lt;- sample(1:length(crime), 10)
res &lt;- try(globalG.test(crime, nb2listw(COL.nb, style="B"),
 na.action=na.fail))
res
globalG.test(crime, nb2listw(COL.nb, style="B"), zero.policy=TRUE,
 na.action=na.omit)
globalG.test(crime, nb2listw(COL.nb, style="B"), zero.policy=TRUE,
 na.action=na.exclude)
try(globalG.test(crime, nb2listw(COL.nb, style="B"), na.action=na.pass))
</code></pre>


</div>