<div class="container">

<table style="width: 100%;"><tr>
<td>MCM.sde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Parallel Monte-Carlo Methods for SDE's
</h2>

<h3>Description</h3>

<p>Generate <code>R</code> Monte-Carlo (version parallel) replicates of a statistic applied to SDE's (1,2 and 3 dim) for the two cases Ito and Stratonovich interpretations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCM.sde(model, ...)

## Default S3 method:
MCM.sde(model, statistic, R = 100, time, exact = NULL, 
         names = NULL, level = 0.95, parallel = c("no", "multicore", "snow"),
         ncpus = getOption("ncpus", 1L), cl = NULL, ...)

## S3 method for class 'MCM.sde'
plot(x,index = 1,type=c("all","hist","qqplot","boxplot","CI"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>an object from class <code>snssde1d</code>, <code>snssde2d</code> and <code>snssde3d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>

<p>a function which when applied to model returns a vector containing the statistic(s) of interest. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>the number of Monte-Carlo replicates. Usually this will be a single positive integer "R &gt; 1".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>the time when estimating the statistic(s) of interesttime between <code>t0</code> and <code>T</code>. The default <code>time = T</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>

<p>a named list giving the exact statistic(s) if it exists otherwise <code>exact = NULL</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>

<p>named the statistic(s) of interest. The default <code>names=c("mu1","mu2",...)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>the confidence level(s) of the required interval(s).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>the type of parallel operation to be used (if any). The default <code>parallel = "no"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>

<p>integer: number of processes to be used in parallel operation: typically one would chose this to the number of available CPUs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>an optional parallel or snow cluster for use if <code>parallel = "snow"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object inheriting from class <code>"MCM.sde"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>the index of the variable of interest within the output of <code>"MCM.sde"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>the type of plot of the Monte-Carlo estimation of the variable of interest. The default <code>type = "all"</code>.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>potentially further arguments for (non-default) methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We have here developed Monte-Carlo methods whose essence is the use of repeated experiments to evaluate a 
statistic(s) of interest in SDE's. For example estimation of moments as: mean, variance, covariance (and other as median, 
mode, quantile,...). With the standard error and the confidence interval for these estimators.
</p>
<p>An overview of this package, see <code>browseVignettes('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>"MCM.sde"</code>, containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>The SDE's used (class: <code>snssde1d</code>, <code>snssde2d</code> and <code>snssde3d</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>Dimension of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The original call to <code>"MCM.sde"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fn</code></td>
<td>
<p>The function statistic as passed to <code>"MCM.sde"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ech</code></td>
<td>
<p>A matrix with <code>sum(R)</code> column each of which is a Monte-Carlo replicate of the result of calling statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The time when estimating the statistic(s) of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>named of statistic(s) of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>Table contains simulation results of statistic(s) of interest: Estimate, Bias (if exact available), Std.Error and Confidence interval.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>When <code>parallel = "multicore"</code> is used are not available on Windows, <code>parallel = "snow"</code> is primarily intended to be used on multi-core Windows machine where <code>parallel = "multicore"</code> is not available. For more details see Q.E.McCallum and S.Weston (2011).
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
"Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc". 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1–82. doi:10.18637/jss.v096.i02
</p>
<p>Paul Glasserman (2003).
<em>Monte Carlo Methods in Financial Engineering</em>. 
Springer-Verlag New York.
</p>
<p>Jun S. Liu (2004).
<em>Monte Carlo Strategies in Scientific Computing</em>. 
Springer-Verlag New York.
</p>
<p>Christian Robert and George Casella (2010).
<em>Introducing Monte Carlo Methods with R</em>. 
Springer-Verlag New York.
</p>
<p>Nick T. Thomopoulos (2013).
<em>Essentials of Monte Carlo Simulation: Statistical Methods for Building Simulation Models</em>. 
Springer-Verlag New York.
</p>
<p>Q. Ethan McCallum and Stephen Weston (2011).
<em>Parallel R</em>. 
O'Reilly Media, Inc.
</p>


<h3>See Also</h3>

<p><code>MEM.sde</code> moment equations methods for SDE's.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1 : (1 dim)
## dX(t) = 3*(1-X(t)) dt + 0.5 * dW(t), X(0)=5, t in [0,10]
## set the model 1d
f &lt;- expression(3*(1-x));g &lt;- expression(0.5)
mod1d &lt;-  snssde1d(drift=f,diffusion=g,x0=5,T=10,M=50)

## function of the statistic(s) of interest.
sde.fun1d &lt;- function(data, i){
  d &lt;- data[i, ]
  return(c(mean(d),Mode(d),var(d)))
}

mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=100,exact=list(Me=1,Mo=1,Va=0.5^2/6),
                 names=c("Me(10)","Mo(10)","Va(10)"))
mc.sde1d
plot(mc.sde1d,index=1)
plot(mc.sde1d,index=2)
plot(mc.sde1d,index=3)

## Example 2 : with Parallel computing
## Not run: 
mod1d &lt;-  snssde1d(drift=f,diffusion=g,x0=5,T=10,M=1000)
## On Windows or Unix
mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=1000,exact=list(Me=1,Mo=1,Va=0.5^2/6),
           names=c("Me(10)","Mo(10)","Va(10)"),parallel="snow",ncpus=parallel::detectCores())
mc.sde1d
## On Unix only
mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=1000,exact=list(Me=1,Mo=1,Va=0.5^2/6),
           names=c("Me(10)","Mo(10)","Va(10)"),parallel="multicore",ncpus=parallel::detectCores())
mc.sde1d

## End(Not run)

## Example 3: (2 dim)
## dX(t) = 1/mu*(theta-X(t)) dt + sqrt(sigma) * dW1(t),
## dY(t) = X(t) dt + 0 * dW2(t)
## Not run: 
## Set the model 2d
mu=0.75;sigma=0.1;theta=2
x0=0;y0=0;init=c(x=0,y=0)
f &lt;- expression(1/mu*(theta-x), x)  
g &lt;- expression(sqrt(sigma),0)
OUI &lt;- snssde2d(drift=f,diffusion=g,M=1000,Dt=0.01,x0=init)

## function of the statistic(s) of interest.
sde.fun2d &lt;- function(data, i){
  d &lt;- data[i,]
  return(c(mean(d$x),mean(d$y),var(d$x),var(d$y),cov(d$x,d$y)))
}
## Monte-Carlo at time = 5
mc.sde2d_a = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=5,
                  parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_a
## Monte-Carlo at time = 10
mc.sde2d_b = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=10,
                  parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_b

## Compared with exact values at time 5 and 10
E_x &lt;- function(t) theta+(x0-theta)*exp(-t/mu)
V_x &lt;- function(t) 0.5*sigma*mu *(1-exp(-2*(t/mu)))
E_y &lt;- function(t) y0+theta*t+(x0-theta)*mu*(1-exp(-t/mu))
V_y &lt;- function(t) sigma*mu^3*((t/mu)-2*(1-exp(-t/mu))+0.5*(1-exp(-2*(t/mu))))
cov_xy &lt;- function(t) 0.5*sigma*mu^2 *(1-2*exp(-t/mu)+exp(-2*(t/mu)))

## at time=5
mc.sde2d_a = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=5,
    exact=list(m1=E_x(5),m2=E_y(5),S1=V_x(5),S2=V_y(5),C12=cov_xy(5)),
	parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_a
plot(mc.sde2d_a,index=1)
plot(mc.sde2d_a,index=2)
## at time=10
mc.sde2d_b = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=10,
    exact=list(m1=E_x(10),m2=E_y(10),S1=V_x(10),S2=V_y(10),C12=cov_xy(10)),
	parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_b
plot(mc.sde2d_b,index=1)
plot(mc.sde2d_b,index=2)

## End(Not run)

## Example 4: (3 dim)
## dX(t) = sigma*(Y(t)-X(t)) dt + 0.1 * dW1(t)
## dY(t) = (rho*X(t)-Y(t)-X(t)*Z(t)) dt + 0.1 * dW2(t)
## dZ(t) = (X(t)*Y(t)-bet*Z(t)) dt + 0.1 * dW3(t)
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma
## Not run: 
## Set the model 3d
sigma=10;rho=28; bet=8/3
f &lt;- expression(sigma*(y-x),rho*x-y-x*z,x*y-bet*z)
g &lt;- expression(0.1,0.1,0.1)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 
mod3d &lt;- snssde3d(x0=rep(0,3),drift=f,diffusion=g,M=1000,Dt=0.01,corr=Sigma)

## function of the statistic(s) of interest.
sde.fun3d &lt;- function(data, i){
  d &lt;- data[i,]
  return(c(mean(d$x),mean(d$y),mean(d$z)))
}
## Monte-Carlo at time = 10
mc.sde3d = MCM.sde(mod3d,statistic=sde.fun3d,R=100,parallel="snow",ncpus=parallel::detectCores())
mc.sde3d

## End(Not run)

</code></pre>


</div>