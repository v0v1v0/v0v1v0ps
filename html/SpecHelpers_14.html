<div class="container">

<table style="width: 100%;"><tr>
<td>plot2DNMRspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a 2D NMR Spectrum</h2>

<h3>Description</h3>

<p>This function simulates 2D NMR spectra.  Only 1st order coupling can be
handled â€“ there is currently no capacity for doublet of doublets and
other such peaks.  The field strength of the "instrument" is taken into
account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot2DNMRspec(peaks, x.range = c(0, 12), MHz = 300, ppHz = 1,
  type = "COSY", M = NULL, levels = seq(0.5, 1, by = 0.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p>A data frame with the following columns: delta, mult
(multiplicity), J, area, pw.  Multiplicity should be given by a number, so
use 2 for a doublet.  J is in Hz (use 0 for singlets).  pw is the peak width
at half-height in Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.range</code></td>
<td>
<p>A numeric vector of length 2 giving the ppm range desired.
Must be increasing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MHz</code></td>
<td>
<p>Integer.  The operating frequency of the instrument, in MHz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppHz</code></td>
<td>
<p>Points per Hz: The number of data points per Hz to use in
calculating the spectrum (passed as argument <code>dd</code> to <code>makeSpec</code>).
The default (1) works well for 1H NMR spectra.
Note that this function uses Hz internally so that the <code>x.range</code>, which
is in ppm, is multiplied by <code>Mhz</code> before being sent to
<code>makeSpec</code>, and once there, <code>makeSpec</code> will multiply it by
<code>ppHz</code>.  Thus the total data points used is <code>ppHz * Mhz *
abs(diff(x.range))</code>.  This approach ensures that peaks are not distorted
when changing <code>x.range</code> for the same <code>peak.list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of 2D spectrum desired.  One of <code>c("COSY", "TOCSY")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>An adjacency matrix indicating which peaks are coupled.
The order of rows and columns must be the same as in <code>peaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>A vector of levels for the contour plot.  Must be in (0...1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to be passed to the plotting function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a matrix.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University. <a href="mailto:hanson@depauw.edu">hanson@depauw.edu</a>
</p>


<h3>See Also</h3>

<p><code>makeSpec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### ethyl 2-ethyl-3-oxobutyrate
### Set up data

peaks1 &lt;- data.frame(
#             A     B     C     D     E     F
	delta = c(4.20, 3.34, 2.23, 1.88, 1.28, 0.94),
	mult = c(4, 3, 1, 5, 3, 3),
	J = c(14, 14, 0, 14, 14, 14),
	area = c(2, 1, 3, 2, 3, 3),
	pw = c(2, 2, 2, 2, 2, 2))

#              A, B, C, D, E, F
AM &lt;- matrix(c(0, 0, 0, 0, 1, 0,  # A
               0, 0, 0, 1, 0, 0,  # B
               0, 0, 0, 0, 0, 0,  # C
               0, 1, 0, 0, 0, 1,  # D
               1, 0, 0, 0, 0, 0,  # E
               0, 0, 0, 1, 0, 0), # F
			   ncol = 6)

### 1D 1H NMR plot for reference
# CRAN checks will skip some examples to save time


jnk &lt;- plotNMRspec(peaks = peaks1, x.range = c(0, 5), MHz = 500,
main = "1H NMR of ethyl 2-ethyl-3-oxobutyrate")

### 2D COSY plot

res &lt;- plot2DNMRspec(peaks = peaks1, x.range = c(0, 5), MHz = 500, ppHz = 1, M = AM,
main = "COSY of ethyl 2-ethyl-3-oxobutyrate")

### 2D TOCSY plot

## Not run: 

res &lt;- plot2DNMRspec(peaks = peaks1, x.range = c(0, 5), MHz = 500, ppHz = 1,
levels = c(0.85, 0.9, 0.95), type = "TOCSY",
main = "TOCSY of ethyl 2-ethyl-3-oxobutyrate")

## End(Not run)
</code></pre>


</div>