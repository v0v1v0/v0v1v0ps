<div class="container">

<table style="width: 100%;"><tr>
<td>colorGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Vertex and edge graph coloring on the base of fitting</h2>

<h3>Description</h3>

<p>Add vertex and edge color attributes to an igraph object,
based on a fitting results data.frame generated by
<code>SEMrun</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">colorGraph(
  est,
  graph,
  group,
  method = "none",
  alpha = 0.05,
  vcolor = c("lightblue", "white", "pink"),
  ecolor = c("royalblue3", "gray50", "red2"),
  ewidth = c(1, 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A data.frame of estimated parameters and p-values, derived
from the <code>fit</code> object returned by <code>SEMrun</code>.
As an alternative, the user may provide a "gest" or "dest" data.frame
generated by <code>SEMrun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>An igraph object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>group A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Multiple testing correction method. One of the values
available in <code>p.adjust</code>. By default, method is set
to "none" (i.e., no multiple test correction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for node and edge coloring
(by default, <code>alpha = 0.05</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcolor</code></td>
<td>
<p>A vector of three color names. The first color is given
to nodes with P-value &lt; alpha and beta &lt; 0, the third color is given
to nodes with P-value &lt; alpha and beta &gt; 0, and the second is given
to nodes with P-value &gt; alpha. By default,
<code>vcolor = c("lightblue", "white", "pink")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecolor</code></td>
<td>
<p>A vector of three color names. The first color is given
to edges with P-value &lt; alpha and regression coefficient &lt; 0, the
third color is given to edges with P-value &lt; alpha and regression
coefficient &gt; 0, and the second is given to edges with P-value &gt; alpha.
By default, <code>vcolor = c("blue", "gray50", "red2")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ewidth</code></td>
<td>
<p>A vector of two values. The first value refers to the
basic edge width (i.e., edges with P-value &gt; alpha), while the second
is given to edges with P-value &lt; alpha. By default ewidth = c(1, 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An igraph object with vertex and edge color and width attributes.
</p>


<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Model fitting: node perturbation
sem1 &lt;- SEMrun(graph = alsData$graph, data = alsData$exprs,
               group = alsData$group,
               fit = 1)
est1 &lt;- parameterEstimates(sem1$fit)

# Model fitting: edge perturbation
sem2 &lt;- SEMrun(graph = alsData$graph, data = alsData$exprs,
               group = alsData$group,
               fit = 2)
est20 &lt;- subset(parameterEstimates(sem2$fit), group == 1)[, -c(4, 5)]
est21 &lt;- subset(parameterEstimates(sem2$fit), group == 2)[, -c(4, 5)]

# Graphs
g &lt;- alsData$graph
x &lt;- alsData$group

old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,2), mar=rep(1,4))
gplot(colorGraph(est = est1, g, group = x, method = "BH"),
      main = "vertex differences")
gplot(colorGraph(est = sem2$dest, g, group = NULL),
      main = "edge differences")
gplot(colorGraph(est = est20, g, group = NULL),
      main = "edges for group = 0")
gplot(colorGraph(est = est21, g, group = NULL),
      main = "edges for group = 1")
par(old.par)


</code></pre>


</div>