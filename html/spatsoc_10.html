<div class="container">

<table style="width: 100%;"><tr>
<td>group_polys</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group Polygons</h2>

<h3>Description</h3>

<p><code>group_polys</code> groups rows into spatial groups by overlapping polygons (home
ranges). The function accepts a <code>data.table</code> with relocation data, individual
identifiers and an <code>area</code> argument.  The relocation data is transformed into
home range POLYGONs using <code>build_polys()</code> with adehabitatHR::mcp or
adehabitatHR::kernelUD. If the <code>area</code> argument is <code>FALSE</code>, <code>group_polys</code>
returns grouping calculated by spatial overlap. If the <code>area</code> argument is
<code>TRUE</code>, <code>group_polys</code> returns the area area and proportion of overlap.
Relocation data should be in two columns representing the X and Y
coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">group_polys(
  DT = NULL,
  area = NULL,
  hrType = NULL,
  hrParams = NULL,
  projection = NULL,
  id = NULL,
  coords = NULL,
  splitBy = NULL,
  sfPolys = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DT</code></td>
<td>
<p>input data.table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>boolean indicating either overlap group (when <code>FALSE</code>) or
area and proportion of overlap (when <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hrType</code></td>
<td>
<p>type of HR estimation, either 'mcp' or 'kernel'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hrParams</code></td>
<td>
<p>a named list of parameters for <code>adehabitatHR</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection</code></td>
<td>
<p>numeric or character defining the coordinate reference
system to be passed to sf::st_crs. For example, either
<code>projection = "EPSG:32736"</code> or <code>projection = 32736</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Character string of ID column name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Character vector of X coordinate and Y coordinate column names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitBy</code></td>
<td>
<p>(optional) character string or vector of grouping column
name(s) upon which the grouping will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sfPolys</code></td>
<td>
<p>Alternatively, provide solely a simple features object with
POLYGONs or MULTIPOLYGONs. If sfPolys are provided, id is required and
splitBy cannot be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>R-spatial evolution</h4>

<p>Please note, spatsoc has followed updates from R spatial, GDAL and PROJ for
handling projections, see more below and  details at
<a href="https://r-spatial.org/r/2020/03/17/wkt.html">https://r-spatial.org/r/2020/03/17/wkt.html</a>.
</p>
<p>In addition, <code>group_polys</code> previously used rgeos::gIntersection,
rgeos::gIntersects and rgeos::gArea but has been
updated to use sf::st_intersects, sf::st_intersection and sf::st_area
according to the R-spatial evolution, see more
at <a href="https://r-spatial.org/r/2022/04/12/evolution.html">https://r-spatial.org/r/2022/04/12/evolution.html</a>.
</p>



<h4>Notes on arguments</h4>

<p>The <code>DT</code> must be a <code>data.table</code>. If your data is a
<code>data.frame</code>, you can convert it by reference using
<code>data.table::setDT()</code>.
</p>
<p>The <code>id</code>, <code>coords</code> (and optional <code>splitBy</code>) arguments expect
the names of respective columns in <code>DT</code> which correspond to the
individual identifier, X and Y coordinates, and additional grouping columns.
</p>
<p>The <code>projection</code> argument expects a character string or numeric
defining the coordinate reference system to be passed to sf::st_crs.
For example, for UTM zone 36S (EPSG 32736), the projection
argument is <code>projection = "EPSG:32736"</code> or <code>projection = 32736</code>.
See <a href="https://spatialreference.org">https://spatialreference.org</a>
for a list of EPSG codes.
</p>
<p>The <code>hrType</code> must be either one of "kernel" or "mcp". The
<code>hrParams</code> must be a named list of arguments matching those of
<code>adehabitatHR::kernelUD()</code> or <code>adehabitatHR::mcp()</code>.
</p>
<p>The <code>splitBy</code> argument offers further control over grouping. If within
your <code>DT</code>, you have multiple populations, subgroups or other distinct
parts, you can provide the name of the column which identifies them to
<code>splitBy</code>. The grouping performed by <code>group_polys</code> will only
consider rows within each <code>splitBy</code> subgroup.
</p>



<h3>Value</h3>

<p>When <code>area</code> is <code>FALSE</code>, <code>group_polys</code> returns the input <code>DT</code> appended
with a <code>group</code> column. As with the other grouping functions,  the actual
value of <code>group</code> is arbitrary and represents the identity of a given group
where 1 or more individuals are assigned to a group. If the data was
reordered, the <code>group</code> may change, but the contents of each group would
not. When <code>area</code> is <code>TRUE</code>, <code>group_polys</code> returns a proportional area
overlap <code>data.table</code>. In this case, ID refers to the focal individual of
which the total area is compared against the overlapping area of ID2.
</p>
<p>If <code>area</code> is <code>FALSE</code>, a message is returned when a column named <code>group</code>
already exists in the input <code>DT</code>, because it will be overwritten.
</p>
<p>Along with changes to follow the R-spatial evolution, <code>group_polys</code> also
now returns area and proportion of overlap with units explicitly specified
through the <code>units</code> package.
</p>


<h3>See Also</h3>

<p><code>build_polys()</code> <code>group_times()</code>
</p>
<p>Other Spatial grouping: 
<code>group_lines()</code>,
<code>group_pts()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data.table
library(data.table)


# Read example data
DT &lt;- fread(system.file("extdata", "DT.csv", package = "spatsoc"))

# Cast the character column to POSIXct
DT[, datetime := as.POSIXct(datetime, tz = 'UTC')]

# EPSG code for example data
utm &lt;- 32736

group_polys(DT, area = FALSE, hrType = 'mcp',
            hrParams = list(percent = 95), projection = utm,
            id = 'ID', coords = c('X', 'Y'))

areaDT &lt;- group_polys(DT, area = TRUE, hrType = 'mcp',
                      hrParams = list(percent = 95), projection = utm,
                      id = 'ID', coords = c('X', 'Y'))
print(areaDT)
</code></pre>


</div>