<div class="container">

<table style="width: 100%;"><tr>
<td>Q</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Resonance quality factor of a frequency spectrum</h2>

<h3>Description</h3>

<p>This function estimates the frequency pureness of a time wave by returning the resonant
quality factor Q at a specific dB level.</p>


<h3>Usage</h3>

<pre><code class="language-R">Q(spec, f = NULL, level = -3, mel = FALSE, plot = TRUE, colval = "red",
cexval = 1, fontval = 1, flab = NULL,
alab = "Relative amplitude (dB)", type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>a data set resulting of a spectral analysis obtained
with <code>spec</code>, or <code>meanspec</code> (in dB).
This can be either a two-column matrix (col1 = frequency, col2 = amplitude)
or a vector (amplitude).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of the wave used to obtain <code>spec</code>
(in Hz). Not necessary if <code>spec</code> is a two columns matrix obtained
with <code>spec</code> or <code>meanspec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>frequency bandwidth set by an amplitude value relative
to <code>spectrum</code> (in dB).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mel</code></td>
<td>
<p>a logical, if <code>TRUE</code> the (htk-)mel scale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> returns the spectrum 
with Q plotted (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colval</code></td>
<td>
<p>colour of plotting Q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexval</code></td>
<td>
<p>character size of plotting Q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontval</code></td>
<td>
<p>font of plotting Q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alab</code></td>
<td>
<p>title of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A high Q value indicates a highly resonant system.</p>


<h3>Value</h3>

<p>A list is returned with the following four items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>a numeric vector of length 1 returning the Q factor (no units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfreq</code></td>
<td>
<p>a numeric vector of length 1 the dominant frequency (kHz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmin</code></td>
<td>
<p>a numeric vector of length 1 returning the minimum
frequency of the -dB level bandwidth (kHz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>a numeric vector of length 1 returning the minimum
frequency of the -dB level bandwidth (kHz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwd</code></td>
<td>
<p>a numeric vector of length 1 returning the bandwidth,
i. e. <code>fmax-fmin</code> (kHz)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is based on an linear interpolation of the spectrum
so that the result should be considered as an estimation, not an exact measure.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur, improved by Laurent Lellouch</p>


<h3>See Also</h3>

<p><code>spec</code>, <code>meanspec</code>, <code>corspec</code>,
<code>fft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># bird song
data(tico)
t&lt;-spec(tico,f=22050,at=1.1,plot=FALSE,dB="max0")
op&lt;-par(mfrow=c(2,1),las=1)
Q(t,type="l")
Q(t,type="l",xlim=c(3.8,4.2),ylim=c(-60,0))
title("zoom in")
par(op)
# cricket, changing the dB level
data(pellucens)
p&lt;-spec(pellucens,f=11025,at=0.5,plot=FALSE,dB="max0")
op&lt;-par(mfrow=c(3,1))
Q(p,type="l",xlim=c(1.8,2.6),ylim=c(-70,0))
title("level = - 3 (default value)",col.main="red")
Q(p,type="l",level=-6,
    xlim=c(1.8,2.6),ylim=c(-70,0),colval="blue")
title("level = - 6",col.main="blue")
Q(p,type="l",level=-9,
    xlim=c(1.8,2.6),ylim=c(-70,0),colval="green")
title("level = - 9",col.main="green")
par(op)
</code></pre>


</div>