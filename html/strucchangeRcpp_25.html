<div class="container">

<table style="width: 100%;"><tr>
<td>efpFunctional</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functionals for Fluctuation Processes</h2>

<h3>Description</h3>

<p>Computes an object for aggregating, plotting and testing
empirical fluctuation processes.</p>


<h3>Usage</h3>

<pre><code class="language-R">efpFunctional(functional = list(comp = function(x) max(abs(x)), time = max),
  boundary = function(x) rep(1, length(x)),
  computePval = NULL, computeCritval = NULL,
  plotProcess = NULL, lim.process = "Brownian bridge",
  nobs = 10000, nrep = 50000, nproc = 1:20, h = 0.5,
  probs = c(0:84/100, 850:1000/1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>functional</code></td>
<td>
<p>either a function for aggregating fluctuation processes
or a list with two functions names <code>"comp"</code> and <code>"time"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>a boundary function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computePval</code></td>
<td>
<p>a function for computing p values. If neither
<code>computePval</code> nor <code>computeCritval</code> are specified
critical values are simulated with settings as specified below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeCritval</code></td>
<td>
<p>a function for computing critical values. If neither
<code>computePval</code> nor <code>computeCritval</code> are specified
critical values are simulated with settings as specified below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotProcess</code></td>
<td>
<p>a function for plotting the empirical process,
if set to <code>NULL</code> a suitable function is set up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim.process</code></td>
<td>
<p>a string specifying the limiting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>integer specifying the number of observations of each
Brownian motion simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>integer specifying the number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>integer specifying for which number of processes
Brownian motions should be simulated. If set to <code>NULL</code> only
<code>nproc = 1</code> is used and all other values are derived from
a Bonferroni correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth parameter for increment processes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>numeric vector specifying for which probabilities 
critical values should be tabulated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>efpFunctional</code> computes an object of class <code>"efpFunctional"</code>
which then knows how to do inference based on empirical fluctuation processes
(currently only for <code>gefp</code> objects and not yet for <code>efp</code>
objects) and how to visualize the corresponding processes.   
</p>
<p><code>efpFunctional</code>s for many frequently used test statistics are provided:
<code>maxBB</code> for the double maximum statistic, <code>meanL2BB</code> for the Cramer-von Mises
statistic, or <code>rangeBB</code> for the range statistic. Furthermore, <code>supLM</code>
generates an object of class <code>"efpFunctional"</code> for a certain trimming parameter,
see the examples. More details can be found in Zeileis (2006). Based on
Merkle, Fan, and Zeileis (2014), further <code>efpFunctional</code> generators for
aggregating along (ordered) categorical variables have been added:
<code>catL2BB</code>, <code>ordL2BB</code>, <code>ordwmax</code>.
</p>
<p>For setting up an <code>efpFunctional</code>, the functions
<code>computeStatistic</code>, <code>computePval</code>, and <code>plotProcess</code> need to be
supplied. These should have the following interfaces:
<code>computeStatistic</code> should take a single argument which is the process
itself, i.e., essentially a n x k matrix where n is the number of
observations and k the number of processes (regressors).
<code>computePval</code> should take two arguments: a scalar test statistic and the
number of processes k.
<code>plotProcess</code> should take two arguments: an object of class <code>"gefp"</code>
and <code>alpha</code> the level of significance for any boundaries or critical
values to be visualized.
</p>


<h3>Value</h3>

<p><code>efpFunctional</code> returns a list of class <code>"efpFunctional"</code> with components including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>plotProcess</code></td>
<td>
<p>a function for plotting empirical fluctuation processes,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeStatistic</code></td>
<td>
<p>a function for computing a test statistic from an empirical fluctuation process,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computePval</code></td>
<td>
<p>a function for computing the corresponding p value,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeCritval</code></td>
<td>
<p>a function for computing critical values.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Merkle E.C., Zeileis A. (2013), Tests of Measurement Invariance without Subgroups:
A Generalization of Classical Methods. <em>Psychometrika</em>, <b>78</b>(1), 59–82.
doi:10.1007/S11336-012-9302-4
</p>
<p>Merkle E.C., Fan J., Zeileis A. (2014), Testing for Measurement Invariance with
Respect to an Ordinal Variable. <em>Psychometrika</em>, <b>79</b>(4), 569–584.
doi:10.1007/S11336-013-9376-7.
</p>
<p>Zeileis A. (2005), A Unified Approach to Structural Change Tests Based on
ML Scores, F Statistics, and OLS Residuals. <em>Econometric Reviews</em>, <b>24</b>,
445–466. doi:10.1080/07474930500406053.
</p>
<p>Zeileis A. (2006), Implementing a Class of Structural Change Tests: An
Econometric Computing Approach. <em>Computational Statistics &amp; Data Analysis</em>, 
<b>50</b>, 2987–3008. doi:10.1016/j.csda.2005.07.001.
</p>
<p>Zeileis A., Hornik K. (2007), Generalized M-Fluctuation Tests for Parameter
Instability, <em>Statistica Neerlandica</em>, <b>61</b>, 488–508.
doi:10.1111/j.1467-9574.2007.00371.x.
</p>


<h3>See Also</h3>

<p><code>gefp</code>, <code>supLM</code>, <code>catL2BB</code>, <code>sctest.default</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data("BostonHomicide")
gcus &lt;- gefp(homicides ~ 1, family = poisson, vcov = kernHAC,
  data = BostonHomicide)
plot(gcus, functional = meanL2BB)	 
gcus
sctest(gcus, functional = meanL2BB)

y &lt;- rnorm(1000)
x1 &lt;- runif(1000)
x2 &lt;- runif(1000)

## supWald statistic computed by Fstats()
fs &lt;- Fstats(y ~ x1 + x2, from = 0.1)
plot(fs)
sctest(fs)

## compare with supLM statistic
scus &lt;- gefp(y ~ x1 + x2, fit = lm)
plot(scus, functional = supLM(0.1))
sctest(scus, functional = supLM(0.1))

## seatbelt data
data("UKDriverDeaths")
seatbelt &lt;- log10(UKDriverDeaths)
seatbelt &lt;- cbind(seatbelt, lag(seatbelt, k = -1), lag(seatbelt, k = -12))
colnames(seatbelt) &lt;- c("y", "ylag1", "ylag12")
seatbelt &lt;- window(seatbelt, start = c(1970, 1), end = c(1984,12))

scus.seat &lt;- gefp(y ~ ylag1 + ylag12, data = seatbelt)

## double maximum test
plot(scus.seat)
## range test
plot(scus.seat, functional = rangeBB)
## Cramer-von Mises statistic (Nyblom-Hansen test)
plot(scus.seat, functional = meanL2BB)
## supLM test
plot(scus.seat, functional = supLM(0.1))
</code></pre>


</div>