<div class="container">

<table style="width: 100%;"><tr>
<td>blus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Best Linear Unbiased Scalar-Covariance (BLUS) residuals from a linear model</h2>

<h3>Description</h3>

<p>This function computes the Best Linear Unbiased Scalar-Covariance (BLUS)
residuals from a linear model, as defined in
Theil (1965) and explained further in
Theil (1968).
</p>


<h3>Usage</h3>

<pre><code class="language-R">blus(
  mainlm,
  omit = c("first", "last", "random"),
  keepNA = TRUE,
  exhaust = NA,
  seed = 1234
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>A numeric vector of length <code class="reqn">p</code> (the number of columns in the
linear model design matrix) giving the indices of <code class="reqn">p</code> observations to
omit in the BLUS residual vector; or a character partially matching
<code>"first"</code> (for the first <code class="reqn">p</code>) observations, <code>"last"</code> (for
the last <code class="reqn">p</code> observations), or <code>"random"</code> (for a random sample
of <code class="reqn">p</code> indices between 1 and <code class="reqn">n</code>). Defaults to <code>"first"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepNA</code></td>
<td>
<p>A logical. Should BLUS residuals for omitted observations be
returned as <code>NA_real_</code> to preserve the length of the residual vector?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exhaust</code></td>
<td>
<p>An integer. If singular matrices are encountered
using the passed value of <code>omit</code>, how many random combinations
of <code class="reqn">p</code> indices should be attempted before an error is thrown? If
<code>NA</code> (the default), all possible combinations are attempted
provided that <code class="reqn">{n \choose p} \le 10^4</code>; otherwise up to
<code class="reqn">10^4</code> random samples of size <code>p</code> from <code>1:n</code> are
attempted (with replacement). Integer values of <code>exhaust</code>
greater than <code>1e4L</code> are treated as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer specifying a seed to pass to
<code>set.seed</code> for random number generation. This allows
reproducibility of bootstrap results. The value <code>NA</code>
results in not setting a seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under the ideal linear model conditions, the BLUS residuals have a
scalar covariance matrix <code class="reqn">\omega I</code> (meaning they have a constant
variance and are mutually uncorrelated), unlike the OLS residuals, which
have covariance matrix <code class="reqn">\omega M</code> where <code class="reqn">M</code> is a function of
the design matrix. Use of BLUS residuals could improve the performance of
tests for heteroskedasticity and/or autocorrelation in the linear model.
A linear model with <code class="reqn">n</code> observations and an <code class="reqn">n\times p</code> design
matrix yields only <code class="reqn">n-p</code> BLUS residuals. The choice of which <code class="reqn">p</code>
observations will not be represented in the BLUS residuals is specified
within the algorithm.
</p>


<h3>Value</h3>

<p>A double vector of length <code class="reqn">n</code> containing the BLUS residuals
(with <code>NA_real_</code>) for omitted observations), or a double vector
of length <code class="reqn">n-p</code> containing the BLUS residuals only (if <code>keepNA</code>
is set to <code>FALSE</code>)
</p>


<h3>References</h3>

<p>Theil H (1965).
“The Analysis of Disturbances in Regression Analysis.”
<em>Journal of the American Statistical Association</em>, <b>60</b>(312), 1067–1079.<br><br> Theil H (1968).
“A Simplification of the BLUS Procedure for Analyzing Regression Disturbances.”
<em>Journal of the American Statistical Association</em>, <b>63</b>(321), 242–251.
</p>


<h3>See Also</h3>

<p>H. D. Vinod's online article,
<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2412740">Theil's
BLUS Residuals and R Tools for Testing and Removing Autocorrelation and
Heteroscedasticity</a>, for an alternative function for computing BLUS
residuals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
blus(mtcars_lm)
plot(mtcars_lm$residuals, blus(mtcars_lm))
# Same as first example
mtcars_list &lt;- list("y" = mtcars$mpg, "X" = cbind(1, mtcars$wt, mtcars$qsec, mtcars$am))
blus(mtcars_list)
# Again same as first example
mtcars_list2 &lt;- list("e" = mtcars_lm$residuals, "X" = cbind(1, mtcars$wt, mtcars$qsec, mtcars$am))
blus(mtcars_list2)
# BLUS residuals cannot be computed with `omit = "last"` in this example, so
# omitted indices are randomised:
blus(mtcars_lm, omit = "last")

</code></pre>


</div>