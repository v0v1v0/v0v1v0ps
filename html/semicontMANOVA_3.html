<div class="container">

<table style="width: 100%;"><tr>
<td>scMANOVApermTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate ANalysis Of VAriance log-likelihood Test with Ridge Regularization for Semicontinuous High-Dimensional Data
</h2>

<h3>Description</h3>

<p><code>scMANOVApermTest</code> uses a permutation procedure to perform a test
based on a Multivariate ANalysis Of VAriance(MANOVA) Likelihood Ratio test statistic with a ridge
regularization. The statistic is developed for semicontinuous and
high-dimensional data, but can be used also in low-dimensional scenarios.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scMANOVApermTest(x, n, lambda = NULL, lambda0 = NULL, lambda.step = 0.1,
  ident = FALSE, tol = 1e-08, penalty = function(n, p) log(n), B = 500,
  parallel = c("no", "multicore", "snow"), ncpus = 1L, cl = NULL,
  only.pvalue = TRUE, rm.vars = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code> or <code>matrix</code> of data with units on the rows and variables on the columns 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p><code>vector</code>. The length corresponds to the number of groups, the elements to the number of observations in each group  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>scalar or a <code>vector</code> of length 2. Ridge regularization parameter. The optimal value of <code>lambda</code> is searched in the specified interval when it is a vector of length 2, otherwise it is used as the optimal value 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p><code>NULL</code>, a scalar or a <code>vector</code> of length 2. Ridge regularization parameter under null hypothesis. The optimal value of <code>lambda0</code> is searched in the specified interval when it is a vector of length 2, otherwise it is used as the optimal value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.step</code></td>
<td>
<p>scalar. Step size used in the optimization procedure to find the smallest value of <code>lambda</code> (and <code>lambda0</code>) that makes the covariance matrices,  under the alternative and under the null hypothesis, non singular
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ident</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, <code>lambda</code> times the identity matrix is added to the raw estimated covariance matrix, if <code>FALSE</code> the diagonal values of the raw estimated covariance matrix are used instead
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>scalar. Used in the optimization procedure to find the smallest value of <code>lambda</code> (and <code>lambda0</code>) that makes the covariance matrices, under the alternative and under the null hypothesis, non singular 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p><code>function</code> with two arguments: sample size (<code>n</code>) and number of variables (<code>p</code>) used as penalty function in the definition of the Information Criterion to select the optimal values for <code>lambda</code> and <code>lambda0</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>scalar. Number of permutations to run in the permutation test 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>The type of parallel operation to be used (if any)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p><code>integer</code>. Number of processes to be used in parallel operation: typically one would chose this to the number of
available CPUs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>An optional <code>parallel</code> or <code>snow</code> cluster to use if <code>parallel = "snow"</code>. If not supplied, a cluster on the local
machine is created for the duration of the call
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.pvalue</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> only the p-value is returned
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.vars</code></td>
<td>
<p><code>vector</code>. It indicates the position of the variables to remove
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to <code>parallel::mclapply</code> in case of <code>parallel="multicore"</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>only.pvalue=TRUE</code> (default) a scalar which is the p-value of the Wilks statistic obtain by a permutation procedure, otherwise an object of <code>class</code> htest  
</p>


<h3>Author(s)</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni
</p>


<h3>References</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni (2024)
A regularized MANOVA test for semicontinuous high-dimensional data.
arXiv: <a href="http://arxiv.org/abs/2401.04036">http://arxiv.org/abs/2401.04036</a>
</p>


<h3>See Also</h3>

<p><code>scMANOVA</code> and <code>scMANOVAestimation</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(1234)
  n &lt;- c(5,5)
  p &lt;- 20
  pmiss &lt;- 0.1
  x &lt;- scMANOVAsimulation(n=n, p=p, pmiss=pmiss)
  res &lt;- scMANOVApermTest(x=x, n=n, lambda=3.59, lambda0=3.13,
    only.pvalue=FALSE)
  res
</code></pre>


</div>