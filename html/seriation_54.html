<div class="container">

<table style="width: 100%;"><tr>
<td>hmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Heat Map Reordered Using Seriation</h2>

<h3>Description</h3>

<p>Provides heatmaps reordered using several different seriation methods. This
includes dendrogram based reordering with optimal leaf order and matrix
seriation-based heat maps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmap(
  x,
  distfun = stats::dist,
  method = "OLO_complete",
  control = NULL,
  scale = c("none", "row", "column"),
  plot_margins = "auto",
  col = NULL,
  col_dist = grays(power = 2),
  row_labels = NULL,
  col_labels = NULL,
  ...
)

gghmap(
  x,
  distfun = stats::dist,
  method = "OLO_complete",
  control = NULL,
  scale = c("none", "row", "column"),
  prop = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or a dissimilarity matrix of class dist. If a
dissimilarity matrix is used, then the <code>distfun</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distfun</code></td>
<td>
<p>function used to compute the distance (dissimilarity) between
both rows and columns. For <code>gghmap()</code>, this
parameter is passed on in <code>control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character strings indicating the used seriation algorithm
(see <code>seriate.dist()</code>).
If the method results in a dendrogram then
<code>stats::heatmap()</code> is used to show the dendrograms, otherwise
reordered distance matrices are shown instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control options passed on to the seriation
algorithm specified in <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>character indicating if the values should be centered and
scaled in either the row direction or the column direction, or none. Default
is none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_margins</code></td>
<td>
<p>character indicating what to show in the margins. Options are:
<code>"auto"</code>, <code>"dendrogram"</code>, <code>"distances"</code>, or <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a list of colors used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_dist</code></td>
<td>
<p>colors used for displaying distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_labels, col_labels</code></td>
<td>
<p>a logical indicating if row and column labels
in <code>x</code> should be displayed.  If <code>NULL</code> then labels are displayed
if the <code>x</code> contains the appropriate dimname and the number of labels is
25 or less. A character vector of the appropriate length with labels can
also be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed on to <code>stats::heatmap()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>logical; change the aspect ratio so cells in the image have a
equal width and height.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For dendrogram based heat maps, the arguments are passed on to
<code>stats::heatmap()</code> in <span class="pkg">stats</span>. The following arguments for <code>heatmap()</code>
cannot be used: <code>margins</code>, <code>Rowv</code>, <code>Colv</code>, <code>hclustfun</code>, <code>reorderfun</code>.
</p>
<p>For seriation-based heat maps further arguments include:
</p>

<ul>
<li> <p><code>gp</code> an object of class <code>gpar</code> containing graphical
parameters (see <code>gpar()</code> in package <span class="pkg">grid</span>).
</p>
</li>
<li> <p><code>newpage</code> a logical indicating whether to start plot on a new
page
</p>
</li>
<li> <p><code>prop</code> a logical indicating whether the height and width of <code>x</code> should
be plotted proportional to its dimensions.
</p>
</li>
<li> <p><code>showdist</code> Display seriated dissimilarity matrices? Values are
<code>"none"</code>, <code>"both"</code>, <code>"rows"</code> or <code>"columns"</code>.
</p>
</li>
<li> <p><code>key</code> logical; show a colorkey?
</p>
</li>
<li> <p><code>key.lab</code> Label plotted next to the color key.
</p>
</li>
<li> <p><code>margins</code> bottom and right-hand-side margins are calculated
automatically or can be specifies as a vector of two numbers (in lines).
</p>
</li>
<li> <p><code>zlim</code> range of values displayed.
</p>
</li>
<li> <p><code>col</code>, <code>col_dist</code> color palettes used.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An invisible list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rowInd, colInd</code></td>
<td>
<p>index permutation vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_method</code></td>
<td>
<p>name of the method used to reorder the matrix.</p>
</td>
</tr>
</table>
<p>The list may contain additional elements (dendrograms, colors, etc).
</p>


<h3>Author(s)</h3>

<p>Michael Hahsler
</p>


<h3>See Also</h3>

<p>Other plots: 
<code>VAT()</code>,
<code>bertinplot()</code>,
<code>dissplot()</code>,
<code>palette()</code>,
<code>pimage()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("Wood")

# regular heatmap from package stats
heatmap(Wood, main = "Wood (standard heatmap)")

# Default heatmap does Euclidean distance, hierarchical clustering with
# complete-link and optimal leaf ordering. Note that the rows are
# ordered top-down in the seriation order (stats::heatmap orders in reverse)
hmap(Wood, main = "Wood (opt. leaf ordering)")
hmap(Wood, plot_margins = "distances", main = "Wood (opt. leaf ordering)")
hmap(Wood, plot_margins = "none", main = "Wood (opt. leaf ordering)")

# Heatmap with correlation-based distance, green-red color (greenred is
# predefined) and optimal leaf ordering and no row label
dist_cor &lt;- function(x) as.dist(sqrt(1 - cor(t(x))))
hmap(Wood, distfun = dist_cor, col = greenred(100),
  main = "Wood (reorded by corr. between obs.)")

# Heatmap with order based on the angle in two-dimensional MDS space.
hmap(Wood, method = "MDS_angle", col = greenred(100), row_labels = FALSE,
  main = "Wood (reorderd using ange in MDS space)")

# Heatmap for distances
d &lt;- dist(Wood)
hmap(d, main = "Wood (Euclidean distances)")

# order-based with dissimilarity matrices
hmap(Wood, method = "MDS_angle",
  col = greenred(100), col_dist = greens(100, power = 2),
  keylab = "norm. Expression", main = "Wood (reorderd with distances)")

# without the distance matrices
hmap(Wood, method = "MDS_angle", plot_margins = "none",
  col = greenred(100), main = "Wood (reorderd without distances)")

# Manually create a simple heatmap with pimage.
o &lt;- seriate(Wood, method = "heatmap",
   control = list(dist_fun = dist, seriation_method = "OLO_ward"))
o

pimage(Wood, o)

# Note: method heatmap calculates reorderd hclust objects which can be used
#       for many heatmap implementations like the standard implementation in
#       package stats.
heatmap(Wood, Rowv = as.dendrogram(o[[1]]), Colv = as.dendrogram(o[[2]]))

# ggplot 2 version does not support dendrograms in the margin (for now)
if (require("ggplot2")) {
  library("ggplot2")

  gghmap(Wood) + labs(title = "Wood", subtitle = "Optimal leaf ordering")

  # More parameters (see ? ggpimage): reverse column order and flip axes, make a proportional plot
  gghmap(Wood, reverse_columns = TRUE) +
    labs(title = "Wood", subtitle = "Optimal leaf ordering")

  gghmap(Wood, flip_axes = TRUE) +
    labs(title = "Wood", subtitle = "Optimal leaf ordering")

  gghmap(Wood, flip_axes = TRUE, prop = TRUE) +
    labs(title = "Wood", subtitle = "Optimal leaf ordering")

  dist_cor &lt;- function(x) as.dist(sqrt(1 - cor(t(x))))
  gghmap(Wood, distfun = dist_cor) +
    labs(title = "Wood", subtitle = "Reorded by correlation between observations") +
    scale_fill_gradient2(low = "darkgreen", high = "red")

  gghmap(d, prop = TRUE) +
    labs(title = "Wood", subtitle = "Euclidean distances, reordered")

  # Note: the ggplot2-based version currently cannot show distance matrices
  #      in the same plot.

  # Manually seriate and plot as pimage.
  o &lt;- seriate(Wood, method = "heatmap", control = list(dist_fun = dist,
    seriation_method = "OLO_ward"))
  o

  ggpimage(Wood, o)
}
</code></pre>


</div>