<div class="container">

<table style="width: 100%;"><tr>
<td>sclr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits the scaled logit model</h2>

<h3>Description</h3>

<p>Used to fit the scaled logit model from Dunning (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sclr(
  formula,
  data = NULL,
  ci_lvl = 0.95,
  tol = 10^(-7),
  algorithm = c("newton-raphson", "gradient-ascent"),
  nr_iter = 2000,
  ga_iter = 2000,
  n_conv = 3,
  conventional_names = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula": a symbolic description of the
model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_lvl</code></td>
<td>
<p>Confidence interval level for the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>Algorithms to run. "newton-raphson" or "gradient-ascent".
If a character vector, the algorithms will be applied in the order they
are present in the vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_iter</code></td>
<td>
<p>Maximum allowed iterations for Newton-Raphson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ga_iter</code></td>
<td>
<p>Maximum allowed iterations for gradient ascent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_conv</code></td>
<td>
<p>Number of times the algorithm has to converge (to work around
local maxima).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conventional_names</code></td>
<td>
<p>If <code>TRUE</code>, estimated parameter names will be
(Baseline), (Intercept) and the column names in the model matrix. Otherwise
- lambda, beta_0 and beta_ prefix in front of column names in the model
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the algorithms.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is logistic regression with an added parameter for the top
asymptote. That parameter is reported as <code>theta</code> (or <code>(Baseline)</code>
if <code>conventional_names = TRUE</code>). Note that it is reported on the logit
scale. See <code>vignette("sclr-math")</code> for model specification,
log-likelihood, scores and second derivatives. The main default optimisation
algorithm is Newton-Raphson. Gradient ascent is used as a fallback by
default. Computing engine behind the fitting is <code>sclr_fit</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>sclr</code>. This is a list with the following
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Maximum likelihood estimates of the parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance_mat</code></td>
<td>
<p>The variance-covariance matrix of the parameter
estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>Algorithm used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm_return</code></td>
<td>
<p>Everything the algorithm returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_converge</code></td>
<td>
<p>The number of Newton-Raphson iterations (including
resets) that were required for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Model matrix derived from <code>formula</code> and <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response matrix derived from <code>formula</code> and <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The original call to <code>sclr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model frame object derived from <code>formula</code> and
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>Terms object derived from model frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Confidence intervals of the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_likelihood</code></td>
<td>
<p>Value of log-likelihood calculated at the ML
estimates of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Passed formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Passed data.</p>
</td>
</tr>
</table>
<p>Methods supported: <code>print</code>,
<code>vcov</code>, <code>coef</code>,
<code>model.frame</code>,
<code>model.matrix</code>,
<code>summary</code>, <code>predict</code>,
<code>tidy</code> (<code>broom</code> package),
<code>logLik</code>.
</p>


<h3>References</h3>

<p>Dunning AJ (2006). "A model for immunological correlates of
protection." Statistics in Medicine, 25(9), 1485-1497.
<a href="https://doi.org/10.1002/sim.2282">https://doi.org/10.1002/sim.2282</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sclr)
fit1 &lt;- sclr(status ~ logHI, one_titre_data)
summary(fit1)
</code></pre>


</div>