<div class="container">

<table style="width: 100%;"><tr>
<td>get_sig_similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Similarity between Identified Signatures and Reference Signatures</h2>

<h3>Description</h3>

<p>The reference signatures can be either a <code>Signature</code> object specified by <code>Ref</code> argument
or known COSMIC signatures specified by <code>sig_db</code> argument.
Two COSMIC databases are used for comparisons - "legacy" which includes 30 signaures,
and "SBS" - which includes updated/refined 65 signatures. This function is modified
from <code>compareSignatures()</code> in <strong>maftools</strong> package.
<strong>NOTE</strong>: all reference signatures are generated from gold standard tool:
SigProfiler.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_sig_similarity(
  Signature,
  Ref = NULL,
  sig_db = c("SBS", "legacy", "DBS", "ID", "TSB", "SBS_Nik_lab", "RS_Nik_lab",
    "RS_BRCA560", "RS_USARC", "CNS_USARC", "CNS_TCGA", "CNS_TCGA176", "CNS_PCAWG176",
    "SBS_hg19", "SBS_hg38", "SBS_mm9", "SBS_mm10", "DBS_hg19", "DBS_hg38", "DBS_mm9",
    "DBS_mm10", "SBS_Nik_lab_Organ", "RS_Nik_lab_Organ", "latest_SBS_GRCh37",
    "latest_DBS_GRCh37", "latest_ID_GRCh37", "latest_SBS_GRCh38", "latest_DBS_GRCh38",
    "latest_SBS_mm9", "latest_DBS_mm9", "latest_SBS_mm10", "latest_DBS_mm10",
    "latest_SBS_rn6", "latest_DBS_rn6", "latest_CN_GRCh37", 
    
    "latest_RNA-SBS_GRCh37", "latest_SV_GRCh38"),
  db_type = c("", "human-exome", "human-genome"),
  method = "cosine",
  normalize = c("row", "feature"),
  feature_setting = sigminer::CN.features,
  set_order = TRUE,
  pattern_to_rm = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Signature</code></td>
<td>
<p>a <code>Signature</code> object or a component-by-signature matrix/<code>data.frame</code>
(sum of each column is 1) or a normalized component-by-sample matrix/<code>data.frame</code>
(sum of each column is 1).
More please see examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ref</code></td>
<td>
<p>default is <code>NULL</code>, can be a same object as <code>Signature</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_db</code></td>
<td>
<p>default 'legacy', it can be 'legacy' (for <a href="https://cancer.sanger.ac.uk/cosmic/signatures_v2.tt/">COSMIC v2 'SBS'</a>),
'SBS', 'DBS', 'ID' and 'TSB' (for <a href="https://cancer.sanger.ac.uk/cosmic/signatures/">COSMIV v3.1 signatures</a>)
for small scale mutations.
For more specific details, it can also be 'SBS_hg19', 'SBS_hg38',
'SBS_mm9', 'SBS_mm10', 'DBS_hg19', 'DBS_hg38', 'DBS_mm9', 'DBS_mm10' to use
COSMIC v3 reference signatures from Alexandrov, Ludmil B., et al. (2020) (reference #1).
In addition, it can be one of "SBS_Nik_lab_Organ", "RS_Nik_lab_Organ",
"SBS_Nik_lab", "RS_Nik_lab" to refer reference signatures from
Degasperi, Andrea, et al. (2020) (reference #2);
"RS_BRCA560", "RS_USARC" to reference signatures from BRCA560 and USARC cohorts;
"CNS_USARC" (40 categories), "CNS_TCGA" (48 categories) to reference copy number signatures from USARC cohort and TCGA;
"CNS_TCGA176" (176 categories) and "CNS_PCAWG176" (176 categories) to reference copy number signatures from PCAWG and TCGA separately.
<strong>UPDATE</strong>, the latest version of reference version can be automatically
downloaded and loaded from <a href="https://cancer.sanger.ac.uk/signatures/downloads/">https://cancer.sanger.ac.uk/signatures/downloads/</a>
when a option with <code>latest_</code> prefix is specified (e.g. "latest_SBS_GRCh37").
<strong>Note</strong>: the signature profile for different genome builds are basically same.
And specific database (e.g. 'SBS_mm10') contains less signatures than all COSMIC
signatures (because some signatures are not detected from Alexandrov, Ludmil B., et al. (2020)).
For all available options, check the parameter setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db_type</code></td>
<td>
<p>only used when <code>sig_db</code> is enabled.
"" for keeping default, "human-exome" for transforming to exome frequency of component,
and "human-genome" for transforming to whole genome frequency of component.
Currently only works for 'SBS'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>default is 'cosine' for cosine similarity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>one of "row" and "feature". "row" is typically used
for common mutational signatures. "feature" is designed by me to use when input
are copy number signatures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_setting</code></td>
<td>
<p>a <code>data.frame</code> used for classification.
<strong>Only used when method is "Wang" ("W")</strong>.
Default is CN.features. Users can also set custom input with "feature",
"min" and "max" columns available. Valid features can be printed by
<code>unique(CN.features$feature)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_order</code></td>
<td>
<p>if <code>TRUE</code>, order the return similarity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern_to_rm</code></td>
<td>
<p>patterns for removing some features/components in similarity
calculation. A vector of component name is also accepted.
The remove operation will be done after normalization. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, print extra info.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>list</code> containing smilarities, aetiologies if available, best match and RSS.
</p>


<h3>Author(s)</h3>

<p>Shixiang Wang <a href="mailto:w_shixiang@163.com">w_shixiang@163.com</a>
</p>


<h3>References</h3>

<p>Alexandrov, Ludmil B., et al. "The repertoire of mutational signatures in human cancer." Nature 578.7793 (2020): 94-101.
</p>
<p>Degasperi, Andrea, et al. "A practical framework and online tool for mutational signature analyses show intertissue variation and driver dependencies." Nature cancer 1.2 (2020): 249-263.
</p>
<p>Steele, Christopher D., et al. "Undifferentiated sarcomas develop through distinct evolutionary pathways." Cancer Cell 35.3 (2019): 441-456.
</p>
<p>Nik-Zainal, Serena, et al. "Landscape of somatic mutations in 560 breast cancer whole-genome sequences." Nature 534.7605 (2016): 47-54.
</p>
<p>Steele, Christopher D., et al. "Signatures of copy number alterations in human cancer." Nature 606.7916 (2022): 984-991.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load mutational signature
load(system.file("extdata", "toy_mutational_signature.RData",
  package = "sigminer", mustWork = TRUE
))

s1 &lt;- get_sig_similarity(sig2, Ref = sig2)
s1

s2 &lt;- get_sig_similarity(sig2)
s2
s3 &lt;- get_sig_similarity(sig2, sig_db = "SBS")
s3

# Set order for result similarity matrix
s4 &lt;- get_sig_similarity(sig2, sig_db = "SBS", set_order = TRUE)
s4

## Remove some components
## in similarity calculation
s5 &lt;- get_sig_similarity(sig2,
  Ref = sig2,
  pattern_to_rm = c("T[T&gt;G]C", "T[T&gt;G]G", "T[T&gt;G]T")
)
s5

## Same to DBS and ID signatures
x1 &lt;- get_sig_db("DBS_hg19")
x2 &lt;- get_sig_db("DBS_hg38")
s6 &lt;- get_sig_similarity(x1$db, x2$db)
s6
</code></pre>


</div>