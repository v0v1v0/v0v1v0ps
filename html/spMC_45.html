<div class="container">

<table style="width: 100%;"><tr>
<td>sim_path</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Simulation Based on Path Algorithms</h2>

<h3>Description</h3>

<p>The function simulates a random field through the Fixed Path algorithm or Random Path technique.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_path(x, data, coords, grid, radius, fixed = FALSE, entropy = FALSE)</code></pre>


<h3>Arguments</h3>








<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>multi_tpfit</code>, typically with the output of the function <code>multi_tpfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an <code class="reqn">m \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates in the simulation grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>a numerical value that specifies a proper radius to search the nearest observed points within a <code class="reqn">d</code>-D sphere.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, the fixed path algorithm is performed. The random path algorithm is performed by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entropy</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, the prediction uncertainties are computed through the entropy (and standardized entropy). The default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These methods compute an approximation of posterior probabilities
</p>
<p style="text-align: center;"><code class="reqn">\Pr\left(Z(\mathbf{s}_0) = z_k \left\vert \bigcap_{i = 1}^n Z(\mathbf{s}_i) = z(\mathbf{s}_i)\right.\right).</code>
</p>

<p><code class="reqn">\mbox{\hspace{0cm}}</code> Path algorithms are based on Pickard random fields, so that the states of such chain at any unsampled location depends on the state of its nearest known neighbours in axial directions.
</p>


<h3>Value</h3>

<p>A data frame containing the simulation grid, the simulated random field, predicted values and the approximated probabilities is returned. Two extra columns respectively denoting the entropy and standardized entorpy are bindend to the data frame when argument <code>entropy = TRUE</code>.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Li, W. (2007) A Fixed-Path Markov Chain Algorithm for Conditional Simulation of Discrete Spatial Variables. <em>Mathematical Geology</em>, <b>39</b>(2), 159-176.
</p>
<p>Li, W. (2007) Markov Chain Random Fields for Estimation of Categorical Variables. <em>Mathematical Geology</em>, <b>39</b>(June), 321-335.
</p>
<p>Pickard, D. K. (1980) Unilateral Markov Fields. <em>Advances in Applied Probability</em>, <b>12</b>(3), 655-671.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>sim_ck</code>, <code>sim_ik</code>, <code>sim_mcs</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Model parameters estimation for the
# multinomial categorical simulation
x &lt;- multi_tpfit(ACM$MAT5, ACM[, 1:3])

# Generate the simulation grid
mygrid &lt;- list()
mygrid$X &lt;- seq(min(ACM$X), max(ACM$X), length = 20)
mygrid$Y &lt;- seq(min(ACM$Y), max(ACM$Y), length = 20)
mygrid$Z &lt;- -40 * 0:9 - 1
mygrid &lt;- as.matrix(expand.grid(mygrid$X, mygrid$Y, mygrid$Z))

# Simulate the random field through
# the fixed path algorithm
myFixPathSim &lt;- sim_path(x, ACM$MAT5, ACM[, 1:3], mygrid,
                         radius = 50, fixed = TRUE)

# Simulate the random field through
# the random path algorithm
myRndPathSim &lt;- sim_path(x, ACM$MAT5, ACM[, 1:3], mygrid, radius = 50)
</code></pre>


</div>