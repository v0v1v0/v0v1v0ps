<div class="container">

<table style="width: 100%;"><tr>
<td>Exam3.9</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Example 3.9 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup(p-118)</h2>

<h3>Description</h3>

<p>Exam3.9 used to differentiate conditional and marginal binomial models with and without interaction for S2 variable.
</p>


<h3>Author(s)</h3>


<ol>
<li>
<p>  Muhammad Yaseen (<a href="mailto:myaseen208@gmail.com">myaseen208@gmail.com</a>)
</p>
</li>
<li>
<p> Adeela Munawar (<a href="mailto:adeela.uaf@gmail.com">adeela.uaf@gmail.com</a>)
</p>
</li>
</ol>
<h3>References</h3>


<ol><li>
<p> Stroup, W. W. (2012).
<em>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications</em>.
CRC Press.
</p>
</li></ol>
<h3>See Also</h3>

<p><code>DataSet3.2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#-----------------------------------------------------------------------------------
## Binomial conditional GLMM without interaction, logit link
#-----------------------------------------------------------------------------------
library(MASS)
DataSet3.2$trt &lt;- factor( x  =  DataSet3.2$trt )
DataSet3.2$loc &lt;- factor( x  =  DataSet3.2$loc )

Exam3.9.fm1   &lt;-
  glmmPQL(
      fixed    =  S2/Nbin~trt
    , random   = ~1|loc
    , family   =  quasibinomial(link = "logit")
    , data     =  DataSet3.2
    , niter    = 10
    , verbose  = TRUE
  )
summary(Exam3.9.fm1)
library(parameters)
model_parameters(Exam3.9.fm1)

#-------------------------------------------------------------
##  treatment means
#-------------------------------------------------------------
library(emmeans)
emmeans(object = Exam3.9.fm1, specs = ~trt, type = "response")
emmeans(object = Exam3.9.fm1, specs = ~trt, type = "link")
emmeans(object = Exam3.9.fm1, specs = ~trt, type = "logit")

##--- Normal Approximation
library(nlme)
Exam3.9fm2 &lt;-
  lme(
      fixed       = S2/Nbin~trt
    , data        = DataSet3.2
    , random      = ~1|loc
    , method      = c("REML", "ML")[1]
  )

Exam3.9fm2
model_parameters(Exam3.9fm2)

emmeans(object  = Exam3.9fm2, specs = ~trt)


##---Binomial GLMM with interaction
Exam3.9fm3   &lt;-
  glmmPQL(
      fixed       =  S2/Nbin~trt
    , random      = ~1|trt/loc
    , family      =  quasibinomial(link = "logit")
    , data        =  DataSet3.2
    , niter = 10
    , verbose = TRUE
  )
summary(Exam3.9fm3)
model_parameters(Exam3.9fm3)
emmeans(object = Exam3.9fm3, specs = ~trt)


##---Binomial Marginal GLMM(assuming compound symmetry)
Exam3.9fm4   &lt;-
  glmmPQL(
      fixed       =  S2/Nbin~trt
    , random      = ~1|loc
    , family      =  quasibinomial(link = "logit")
    , data        =  DataSet3.2
    , correlation =  corCompSymm(form = ~1|loc)
    , niter       = 10
    , verbose     = TRUE
  )
summary(Exam3.9fm4)
model_parameters(Exam3.9fm4)
emmeans(object  = Exam3.9fm4, specs  = ~trt)

</code></pre>


</div>