<div class="container">

<table style="width: 100%;"><tr>
<td>heckit5rob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Heckit Fit: Switching Regressions
</h2>

<h3>Description</h3>

<p>Fits the switching regression model with probit selection using a robust two-stage estimator
</p>


<h3>Usage</h3>

<pre><code class="language-R">heckit5rob(selection, outcome1, outcome2, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome1</code></td>
<td>

<p>formula, first outcome equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome2</code></td>
<td>

<p>formula, second outcome equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>heckit5rob</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute robust two-stage extimates of the switching regression model with probit selection. The robust probit is fitted in the first stage. In the second stage the Mallows type M-estimators are used.
The values of the tuning constants and the robustness weights can be modified in <code>heckitrob.control</code>.
</p>


<h3>Value</h3>

<p>Object of class "heckit5rob".

</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>object of class <code>glmrob</code> that contains (first stage) robust probit fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage21</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage first regime robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov1</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage22</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage second regime robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov2</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov1</code></td>
<td>
<p>variance matrix of the second stage first regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov2</code></td>
<td>
<p>variance matrix of the second stage second regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma1</code></td>
<td>
<p>the standard error of the error term of the outcome equation when y_1=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>the standard error of the error term of the outcome equation when y_1=0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IMR1</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IMR2</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of estimation, currently only "robust two-stage" is implemented</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical. Did all the estimators converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>list containing the numbers of iterations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a>
</p>


<h3>See Also</h3>

<p><code>glmrob</code>, <code>rlm</code>, <code>ssmrob</code>, <code>heckitrob</code>, <code>heckitrob.control</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(mvtnorm)
set.seed(2)
N &lt;- 5000
beta1 &lt;- c(0, 1.0, 1.0, 0.75)
beta21 &lt;- c(0, 1.5, 1.0, 0.5)
beta22 &lt;- c(1, -1.5, 1.0, 0.5)
covm &lt;- diag(3)
covm[lower.tri(covm)] &lt;- c(0.75, 0.5, 0.25)
covm[upper.tri(covm)] &lt;- covm[lower.tri(covm)]
eps &lt;- rmvnorm(N, rep(0, 3), covm)
x1 &lt;- rmvnorm(N, mean=c(0, -1, 1), sigma=diag(c(1, 0.5, 1)))
x21 &lt;- x1 
x22 &lt;- x1
x21[, 3] &lt;- rnorm(N, 1, 1)
x22[, 3] &lt;- rnorm(N, 1, 1)
x1beta1 &lt;- beta1[1] + x1[, 1]*beta1[2] + x1[, 2]*beta1[3] + x1[, 3]*beta1[4]
x21beta21 &lt;- beta21[1] + x21[, 1]*beta21[2] + x21[, 2]*beta21[3] + x21[, 3]*beta21[4]
x22beta22 &lt;- beta22[1] + x22[, 1]*beta22[2] + x22[, 2]*beta22[3] + x22[, 3]*beta22[4]
y1 &lt;- ifelse(x1beta1 + eps[, 1] &gt; 0, 1, 0)
y2 &lt;- ifelse(y1 &gt; 0.5, x21beta21 + eps[, 2],
x22beta22 + eps[, 3])
srsim.fit &lt;- ssmrob(y1 ~ x1, list(y2 ~ x21, y2 ~ x22), 
control = heckitrob.control(weights.x1 = "hat", weights.x2 = "covMcd"))
summary(srsim.fit)

## End(Not run)
</code></pre>


</div>