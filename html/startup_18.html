<div class="container">

<table style="width: 100%;"><tr>
<td>on_session_enter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Register functions to be evaluated at the beginning or end of the R session</h2>

<h3>Description</h3>

<p>Register functions to be evaluated at the beginning or end of the R session
</p>


<h3>Usage</h3>

<pre><code class="language-R">on_session_enter(fcn = NULL, append = TRUE, replace = FALSE)

on_session_exit(fcn = NULL, append = TRUE, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fcn</code></td>
<td>
<p>A function or an R expression. The function must accept zero
or more arguments (currently not used). If an expression, it will
automatically we wrapped up in an anonymous function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>If TRUE (default), the function will be evaluated after
previously registered ones, otherwise prepended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>if TRUE, the function replaces any previously registered
ones, otherwise it will be added (default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions register one or more functions to be called when the
current R session begins or ends.  The functions are evaluated in a local
environment and without exception handlers, which means that if one
produces an error, then none of the succeeding functions will be called.
</p>
<p>To list currently registered functions, use <code>fcns &lt;- on_session_enter()</code>
or <code>fcns &lt;- on_session_exit()</code>.
To remove all registered functions, use <code>on_session_enter(replace = TRUE)</code>
or <code>on_session_exit(replace = TRUE)</code>.
</p>
<p>The <code>on_session_enter()</code> function works by recording all <code>fcn</code>:s in an
internal list which will be evaluated via a custom
<code>.First()</code> function created in the global
environment. Any other <code>.First()</code> function on the search path, including
a pre-existing <code>.First()</code> function in the global environment, is called
at the end after registered functions have been called.
</p>
<p>The <code>on_session_exit()</code> function works by recording all <code>fcn</code>:s in an
internal list which will be evaluated via a custom function that is called
when the global environment is garbage collected, which happens at the very
end of the R shutdown process.
Contrary to a <code>.Last()</code> function, which is not be
called if <code>quit(runLast = FALSE)</code> is used, functions registered via
<code>on_session_exit()</code> are always processed.
Registered <code>on_session_exit()</code> functions are called <em>after</em> <code>quit()</code> saves
any workspace image to file (<code>./.RData</code>), and <em>after</em> any <code>.Last()</code> has
been called.
</p>


<h3>Value</h3>

<p>(invisible) the list of registered functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Summarize interactive session upon termination
if (interactive()) {
  startup::on_session_exit(local({
    t0 &lt;- Sys.time()
    function(...) {
      dt &lt;- difftime(Sys.time(), t0, units = "auto")
      msg &lt;- c(
        "Session summary:",
        sprintf(" * R version: %s", getRversion()),
        sprintf(" * Process ID: %d", Sys.getpid()),
        sprintf(" * Wall time: %.2f %s", dt, attr(dt, "units"))
      )
      msg &lt;- paste(msg, collapse = "\n")
      message(msg)
    }
  }))
}

## End(Not run)

</code></pre>


</div>