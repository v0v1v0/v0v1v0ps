<div class="container">

<table style="width: 100%;"><tr>
<td>hc_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Models for Soil Hydraulic Conductivity Functions
</h2>

<h3>Description</h3>

<p>The functions <code>hc_model</code> and <code>hcrel_model</code> compute, for given
capillary pressure head <code class="reqn">h</code>, the <em>hydraulic conductivity</em>
<code class="reqn">K(h)</code> and the <em>relative hydraulic conductivity</em> <code class="reqn">k(h)</code>
respectively, of a soil by parametrical models.  </p>


<h3>Usage</h3>

<pre><code class="language-R">hcrel_model(h, nlp, precBits = NULL, hcc_model = "vgm")

hc_model(h, nlp, lp, precBits = NULL, hcc_model = "vgm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a mandatory numeric vector with values of capillary pressure
head for which to compute the hydraulic conductivity.  For consistency
with other quantities, the unit of  head should be <b>meter</b>
[m].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlp</code></td>
<td>
<p>a mandatory named numeric vector, currently with elements
named <code>"alpha"</code>, <code>"n"</code> and <code>"tau"</code>, which are the
<em>nonlinear</em> parameters <code class="reqn">\boldsymbol{\nu}^\mathrm{T} = (\alpha, n, \tau)</code>, where
<code class="reqn">\alpha</code>, <code class="reqn">n</code> and <code class="reqn">\tau</code> are the inverse air entry pressure,
the shape and the tortuosity parameters, see <em>Details</em>.  For
consistency with other quantities, the unit of <code class="reqn">\alpha</code> should be
<b>1/meter</b> [<code class="reqn">\mathrm{m}^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lp</code></td>
<td>
<p>a mandatory named numeric vector, currently with a single
element named <code>"k0"</code>, which is the saturated hydraulic conductivity
<code class="reqn">K_0</code>, the only <em>linear</em> parameter of the model, see
<em>Details</em>.  For consistency with other quantities, the unit of
<code class="reqn">K_0</code> should be <b>meter/day</b> [<code class="reqn">\mathrm{m}\,\mathrm{d}^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precBits</code></td>
<td>
<p>an optional integer scalar defining the maximal precision
(in bits) to be used in high-precision computations by
<code>mpfr</code>.  If equal to <code>NULL</code> (default) then
<code>mpfr</code> is not used and the result of the function call
is of storage mode <code>double</code>, see <code>soilhypfitIntro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hcc_model</code></td>
<td>
<p>a keyword denoting the parametrical model for the
hydraulic conductivity function.  Currently, only the <em>Van
Genuchten-Mualem</em> model (<code>wrc_model = "vgm"</code>) is implemented, see
<em>Details</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions <code>hcrel_model</code> and <code>hc_model</code> currently model soil
hydraulic conductivity functions only by the simplified form of the Van
Genuchten-Mualem model (<cite>Van Genuchten, 1980</cite>) with the restriction
<code class="reqn">m = 1 - \frac{1}{n}</code>, i.e. by

</p>
<p style="text-align: center;"><code class="reqn">
  k_\mathrm{VGM}(h; \boldsymbol{\nu}) =
    S_\mathrm{VG}(h; \boldsymbol{\nu})^\tau \,
    \left[
      1 - \left(
        1 - S_\mathrm{VG}(h; \boldsymbol{\nu})^\frac{n}{n-1}
      \right)^\frac{n-1}{n}
    \right]^2,
</code>
</p>


<p style="text-align: center;"><code class="reqn">
  K_\mathrm{VGM}(h; \mbox{$\mu$}, \boldsymbol{\nu}) =
  K_0 \, k_\mathrm{VGM}(h; \boldsymbol{\nu}),
</code>
</p>


<p>where <code class="reqn">\mu = K_0</code> is the saturated hydraulic conductivity (<code class="reqn">K_0 &gt;
0</code>),
<code class="reqn">\boldsymbol{\nu}^\mathrm{T} = (\alpha, n, \tau)</code> are the inverse air entry pressure
(<code class="reqn">\alpha &gt; 0</code>), the shape (<code class="reqn">n &gt; 1</code>) and tortuosity parameter
(<code class="reqn">\tau &gt; -2</code>), and <code class="reqn">S_\mathrm{VG}(h;
\boldsymbol{\nu})</code> is the the volumetric
water saturation, see <code>sat_model</code> for an expression.
</p>
<p>Note that <code class="reqn">\mu</code> and <code class="reqn">\boldsymbol{\nu}^\mathrm{} </code> are passed to the functions by
the arguments <code>lp</code> and <code>nlp</code>, respectively.</p>


<h3>Value</h3>

<p>A numeric vector with values of (relative) hydraulic conductivity.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Van Genuchten, M. Th.  (1980) A closed-form equation for predicting the
hydraulic conductivity of unsaturated soils. <em>Soil Science Society of
America Journal</em>, <b>44</b>, 892â€“898,
<a href="https://doi.org/10.2136/sssaj1980.03615995004400050002x">doi:10.2136/sssaj1980.03615995004400050002x</a>.
</p>


<h3>See Also</h3>

<p><code>soilhypfitIntro</code> for a description of the models and a brief
summary of the parameter estimation approach;
</p>
<p><code>fit_wrc_hcc</code> for (constrained) estimation of parameters of
models for soil water retention and hydraulic conductivity data;
</p>
<p><code>control_fit_wrc_hcc</code> for options to control
<code>fit_wrc_hcc</code>;
</p>
<p><code>soilhypfitmethods</code> for common S3 methods for class
<code>fit_wrc_hcc</code>;
</p>
<p><code>vcov</code> for computing (co-)variances of the estimated
nonlinear parameters;
</p>




<p><code>evaporative-length</code> for physically constraining parameter
estimates of soil hydraulic material functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## define capillary pressure head (unit meters)
h &lt;- c(0.01, 0.1, 0.2, 0.3, 0.5, 1., 2., 5.,10.)

## compute (relative) hydraulic conductivity
hcrel &lt;- hcrel_model(h, nlp = c(alpha = 1.5, n = 2, tau = 0.5))
hc &lt;- hc_model(h, nlp = c(alpha = 1.5, n = 2, tau = 0.5), lp = c(k0 = 5))

## display hydraulic conductivity function
op &lt;- par(mfrow = c(1, 2))
plot(hcrel ~ h, log = "xy", type = "l")
plot(hc ~ h, log = "xy", type = "l")
on.exit(par(op))
</code></pre>


</div>