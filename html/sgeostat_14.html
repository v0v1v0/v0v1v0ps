<div class="container">

<table style="width: 100%;"><tr>
<td>krige</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kriging</h2>

<h3>Description</h3>

<p>Carry out spatial prediction (or kriging). </p>


<h3>Usage</h3>

<pre><code class="language-R">krige(s, point.obj, at, var.mod.obj, maxdist=NULL, extrap=FALSE, border) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a point object, generated by <code>point()</code>, at which prediction is carried out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.obj</code></td>
<td>
<p>a point object, generated by <code>point()</code>, containing the sample points and data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>the variable, contained in <code>point.obj</code>, for which
prediction will be carried out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.mod.obj</code></td>
<td>
<p>variogram object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>an optional maximum distance. If entered, then only sample points (i.e, in point.obj) within maxdist of each
prediction point will be used to do the prediction at that point. If not entered, then all n sample points will be used to make
the prediction at each point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrap</code></td>
<td>
<p>logical, indicates if prediction outside the convex hull of data points should be done, default <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>optional polygon (list with two components <code>x</code> and <code>y</code> of
same length) representing a (possibly non convex) region of interest to 
be used instead of the convex hull. Needs <code>extrap=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A point object which is a copy of the <code>s</code> object with two new variables, <code>zhat</code> and <code>sigma2hat</code>, which are,
repspectively, the predicted value and the kriging variance. </p>


<h3>References</h3>

<p>http://www.gis.iastate.edu/SGeoStat/homepage.html
</p>


<h3>See Also</h3>

<p><code>est.variogram</code>,<code>fit.variogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# a single point:
prdpnt &lt;- point(data.frame(list(x=180000,y=331000)))
prdpnt &lt;- krige(prdpnt, maas.point, 'zinc', maas.vmod)
prdpnt

# kriging on a grid (slow!)
grid &lt;- list(x=seq(min(maas$x),max(maas$x),by=100),
             y=seq(min(maas$y),max(maas$y),by=100))
grid$xr &lt;- range(grid$x)
grid$xs &lt;- grid$xr[2] - grid$xr[1]
grid$yr &lt;- range(grid$y)
grid$ys &lt;- grid$yr[2] - grid$yr[1]
grid$max &lt;- max(grid$xs, grid$ys)
grid$xy &lt;- data.frame(cbind(c(matrix(grid$x, length(grid$x), length(grid$y))),
             c(matrix(grid$y, length(grid$x), length(grid$y), byrow=TRUE))))
colnames(grid$xy) &lt;- c("x", "y")
grid$point &lt;- point(grid$xy)
data(maas.bank)
grid$krige &lt;- krige(grid$point,maas.point,'zinc',maas.vmod,
                    maxdist=1000,extrap=FALSE,border=maas.bank)
op &lt;- par(no.readonly = TRUE)
par(pty="s")
plot(grid$xy, type="n", xlim=c(grid$xr[1], grid$xr[1]+grid$max),
                    ylim=c(grid$yr[1], grid$yr[1]+grid$max))
image(grid$x,grid$y,
      matrix(grid$krige$zhat,length(grid$x),length(grid$y)),
      add=TRUE)
contour(grid$x,grid$y,
        matrix(grid$krige$zhat,length(grid$x),length(grid$y)),
        add=TRUE)
data(maas.bank)
lines(maas.bank$x,maas.bank$y,col="blue")
par(op)
</code></pre>


</div>