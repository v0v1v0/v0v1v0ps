<div class="container">

<table style="width: 100%;"><tr>
<td>Moran_I_ByRaster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Moran's I for a raster sampled from a mapunit extent</h2>

<h3>Description</h3>

<p>Compute Moran's I using a subset of sample collected within the extent of a mapunit. This is likely an under-estimate of SA because we are including pixels both inside/outside MU delineations
</p>


<h3>Usage</h3>

<pre><code class="language-R">Moran_I_ByRaster(
  r,
  mu.extent = NULL,
  n = NULL,
  k = NULL,
  do.correlogram = FALSE,
  cor.order = 5,
  crop.raster = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>single <code>SpatRaster</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.extent</code></td>
<td>
<p><code>SpatVector</code> representation of mapunit polygons bounding box (via <code>terra::ext()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of regular samples (what is a reasonable value?)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of neighbors used for weights matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.correlogram</code></td>
<td>
<p>compute correlogram?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.order</code></td>
<td>
<p>order of correlogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crop.raster</code></td>
<td>
<p>optionally disable cropping of the raster layer</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the <code>spdep::moran.test()</code> function
</p>


<h3>Value</h3>

<p>If <code>do.correlogram</code> is <code>TRUE</code> a list with estimated Moran's I (<code style="white-space: pre;">⁠$I⁠</code>) and the correlogram (<code style="white-space: pre;">⁠$correlogram⁠</code>), otherwise the estimated Moran's I value.
</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette
</p>


</div>