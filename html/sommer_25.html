<div class="container">

<table style="width: 100%;"><tr>
<td>covc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>covariance between random effects</h2>

<h3>Description</h3>

<p><code>covc</code> merges the incidence matrices and covariance matrices of two random effects to fit an unstructured model between 2 different random effects to be fitted with the <code>mmec</code> solver.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  covc(ran1, ran2, thetaC=NULL, theta=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ran1</code></td>
<td>
<p>the random call of the first random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ran2</code></td>
<td>
<p>the random call of the first random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaC</code></td>
<td>
<p>an optional matrix for constraints in the variance components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>an optional symmetric matrix for initial values of the variance-covariance components. When providing customized values, these values should be scaled with respect to the original variance. For example, to provide an initial value of 1 to a given variance component, theta would be built as:
</p>
<p>theta = matrix( 1 / var(response) ) 
</p>
<p>The symmetric matrix should have as many rows and columns as the number of levels in the factor 'x'. The values in the matrix define the initial values of the variance-covariance components that will be subject to the constraints provided in thetaC. If not provided, initial values will be calculated as:
</p>
<p>theta = diag(ncol(mm))*.05 + matrix(.1,ncol(mm),ncol(mm))
</p>
<p>where mm is the incidence matrix for the factor 'x'.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implementation aims to fit models where covariance between random variables is expected to exist. For example, indirect genetic effects.
</p>


<h3>Value</h3>


<dl>
<dt>$Z</dt>
<dd>
<p> a incidence matrix Z* = Z Gamma which is the original incidence matrix for the timevar multiplied by the loadings.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Giovanny Covarrubias-Pazaran
</p>


<h3>References</h3>

<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744
</p>
<p>Bijma, P. (2014). The quantitative genetics of indirect genetic effects: a selective review of modelling issues. Heredity, 112(1), 61-69.
</p>


<h3>See Also</h3>

<p>The function <code>vsc</code> to know how to use <code>covc</code> in the <code>mmec</code> solver.</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(DT_ige)
DT &lt;- DT_ige
covRes &lt;- with(DT, covc( vsc(isc(focal)) , vsc(isc(neighbour)) ) )
str(covRes)
# look at DT_ige help page to see how to fit an actual model

</code></pre>


</div>