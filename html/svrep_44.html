<div class="container">

<table style="width: 100%;"><tr>
<td>variance-estimators</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance Estimators</h2>

<h3>Description</h3>

<p>This help page describes variance estimators
which are commonly used for survey samples. These variance estimators
can be used as the basis of the generalized replication methods, implemented
with the functions <code>as_fays_gen_rep_design()</code>,
<code>as_gen_boot_design()</code>,
<code>make_fays_gen_rep_factors()</code>,
or <code>make_gen_boot_factors()</code>
</p>


<h3>Shared Notation</h3>

<p>Let <code class="reqn">s</code> denote the selected sample of size <code class="reqn">n</code>, with elements <code class="reqn">i=1,\dots,n</code>.
Element <code class="reqn">i</code> in the sample had probability <code class="reqn">\pi_i</code> of being included in the sample.
The <em>pair</em> of elements <code class="reqn">ij</code> was sampled with probability <code class="reqn">\pi_{ij}</code>.
</p>
<p>The population total for a variable is denoted <code class="reqn">Y = \sum_{i \in U}y_i</code>,
and the Horvitz-Thompson estimator for <code class="reqn">\hat{Y}</code> is
denoted <code class="reqn">\hat{Y} = \sum_{i \in s} y_i/\pi_i</code>. For convenience,
we denote <code class="reqn">\breve{y}_i = y_i/\pi_i</code>.
</p>
<p>The true sampling variance of <code class="reqn">\hat{Y}</code> is denoted <code class="reqn">V(\hat{Y})</code>,
while an estimator of this sampling variance is denoted <code class="reqn">v(\hat{Y})</code>.
</p>


<h3>Horvitz-Thompson</h3>

<p>The <strong>Horvitz-Thompson</strong> variance estimator:
</p>
<p style="text-align: center;"><code class="reqn">
  v(\hat{Y}) = \sum_{i \in s}\sum_{j \in s} (1 - \frac{\pi_i \pi_j}{\pi_{ij}}) \frac{y_i}{\pi_i} \frac{y_j}{\pi_j}
</code>
</p>



<h3>Yates-Grundy</h3>

<p>The <strong>Yates-Grundy</strong> variance estimator:
</p>
<p style="text-align: center;"><code class="reqn">
  v(\hat{Y}) = -\frac{1}{2}\sum_{i \in s}\sum_{j \in s} (1 - \frac{\pi_i \pi_j}{\pi_{ij}}) (\frac{y_i}{\pi_i} - \frac{y_j}{\pi_j})^2
</code>
</p>



<h3>Poisson Horvitz-Thompson</h3>

<p>The <strong>Poisson Horvitz-Thompson</strong> variance estimator
is simply the Horvitz-Thompson variance estimator, but
where <code class="reqn">\pi_{ij}=\pi_i \times \pi_j</code>, which is the case for Poisson sampling.
<br><br></p>


<h3>Stratified Multistage SRS</h3>

<p>The <strong>Stratified Multistage SRS</strong> variance estimator is the recursive variance estimator
proposed by Bellhouse (1985) and used in the 'survey' package's function svyrecvar.
In the case of simple random sampling without replacement (with one or more stages),
this estimator exactly matches the Horvitz-Thompson estimator.
</p>
<p>The estimator can be used for any number of sampling stages. For illustration, we describe its use
for two sampling stages.
</p>
<p style="text-align: center;"><code class="reqn">
  v(\hat{Y}) = \hat{V}_1 + \hat{V}_2
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
  \hat{V}_1 = \sum_{h=1}^{H} (1 - \frac{n_h}{N_h})\frac{n_h}{n_h - 1} \sum_{i=1}^{n_h} (y_{hi.} - \bar{y}_{hi.})^2
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
  \hat{V}_2 = \sum_{h=1}^{H} \frac{n_h}{N_h} \sum_{i=1}^{n_h}v_{hi}(y_{hi.})
</code>
</p>

<p>where <code class="reqn">n_h</code> is the number of sampled clusters in stratum <code class="reqn">h</code>,
<code class="reqn">N_h</code> is the number of population clusters in stratum <code class="reqn">h</code>,
<code class="reqn">y_{hi.}</code> is the weighted cluster total in cluster <code class="reqn">i</code> of stratum <code class="reqn">h</code>,
<code class="reqn">\bar{y}_{hi.}</code> is the mean weighted cluster total of stratum <code class="reqn">h</code>,
(<code class="reqn">\bar{y}_{hi.} = \frac{1}{n_h}\sum_{i=1}^{n_h}y_{hi.}</code>), and
<code class="reqn">v_{hi}(y_{hi.})</code> is the estimated sampling variance of <code class="reqn">y_{hi.}</code>.
<br><br></p>


<h3>Ultimate Cluster</h3>

<p>The <strong>Ultimate Cluster</strong> variance estimator is simply the stratified multistage SRS
variance estimator, but ignoring variances from later stages of sampling.
</p>
<p style="text-align: center;"><code class="reqn">
  v(\hat{Y}) = \hat{V}_1
</code>
</p>

<p>This is the variance estimator used in the 'survey' package when the user specifies
<code>option(survey.ultimate.cluster = TRUE)</code> or uses <code>svyrecvar(..., one.stage = TRUE)</code>.
When the first-stage sampling fractions are small, analysts often omit the finite population corrections <code class="reqn">(1-\frac{n_h}{N_h})</code>
when using the ultimate cluster estimator.
</p>


<h3>SD1 and SD2 (Successive Difference Estimators)</h3>

<p>The <strong>SD1</strong> and <strong>SD2</strong> variance estimators are "successive difference"
estimators sometimes used for systematic sampling designs.
Ash (2014) describes each estimator as follows:
</p>
<p style="text-align: center;"><code class="reqn">
  \hat{v}_{S D 1}(\hat{Y}) = \left(1-\frac{n}{N}\right) \frac{n}{2(n-1)} \sum_{k=2}^n\left(\breve{y}_k-\breve{y}_{k-1}\right)^2
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \hat{v}_{S D 2}(\hat{Y}) = \left(1-\frac{n}{N}\right) \frac{1}{2}\left[\sum_{k=2}^n\left(\breve{y}_k-\breve{y}_{k-1}\right)^2+\left(\breve{y}_n-\breve{y}_1\right)^2\right]
</code>
</p>

<p>where <code class="reqn">\breve{y}_k = y_k/\pi_k</code> is the weighted value of unit <code class="reqn">k</code>
with selection probability <code class="reqn">\pi_k</code>. The SD1 estimator is recommended by Wolter (1984).
The SD2 estimator is the basis of the successive difference replication estimator commonly
used for systematic sampling designs and is more conservative. See Ash (2014) for details.
<br><br>
For multistage samples, SD1 and SD2 are applied to the clusters at each stage, separately by stratum.
For later stages of sampling, the variance estimate from a stratum is multiplied by the product
of sampling fractions from earlier stages of sampling. For example, at a third stage of sampling,
the variance estimate from a third-stage stratum is multiplied by <code class="reqn">\frac{n_1}{N_1}\frac{n_2}{N_2}</code>,
which is the product of sampling fractions from the first-stage stratum and second-stage stratum.
</p>


<h3>Deville 1 and Deville 2</h3>

<p>The <strong>"Deville-1"</strong> and <strong>"Deville-2"</strong> variance estimators
are clearly described in Matei and Tillé (2005),
and are intended for designs that use
fixed-size, unequal-probability random sampling without replacement.
These variance estimators have been shown to be effective
for designs that use a fixed sample size with a high-entropy sampling method.
This includes most PPSWOR sampling methods,
but unequal-probability systematic sampling is an important exception.
</p>
<p>These variance estimators take the following form:
</p>
<p style="text-align: center;"><code class="reqn">
\hat{v}(\hat{Y}) = \sum_{i=1}^{n} c_i (\breve{y}_i - \frac{1}{\sum_{i=k}^{n}c_k}\sum_{k=1}^{n}c_k \breve{y}_k)^2
</code>
</p>

<p>where <code class="reqn">\breve{y}_i = y_i/\pi_i</code> is the weighted value of the the variable of interest,
and <code class="reqn">c_i</code> depend on the method used:
</p>

<ul>
<li> <p><strong>"Deville-1"</strong>: 
</p>
<p style="text-align: center;"><code class="reqn">c_i=\left(1-\pi_i\right) \frac{n}{n-1}</code>
</p>

</li>
<li> <p><strong>"Deville-2"</strong>: 
</p>
<p style="text-align: center;"><code class="reqn">c_i = (1-\pi_i) \left[1 - \sum_{k=1}^{n} \left(\frac{1-\pi_k}{\sum_{k=1}^{n}(1-\pi_k)}\right)^2 \right]^{-1}</code>
</p>

</li>
</ul>
<p>In the case of simple random sampling without replacement (SRSWOR),
these estimators are both identical to the usual stratified multistage SRS estimator
(which is itself a special case of the Horvitz-Thompson estimator).
</p>
<p>For multistage samples, "Deville-1" and "Deville-2" are applied to the clusters at each stage, separately by stratum.
For later stages of sampling, the variance estimate from a stratum is multiplied by the product
of sampling probabilities from earlier stages of sampling. For example, at a third stage of sampling,
the variance estimate from a third-stage stratum is multiplied by <code class="reqn">\pi_1 \times \pi_{(2 | 1)}</code>,
where <code class="reqn">\pi_1</code> is the sampling probability of the first-stage unit
and <code class="reqn">\pi_{(2|1)}</code> is the sampling probability of the second-stage unit
within the first-stage unit.
</p>


<h3>Deville-Tillé</h3>

<p>See Section 6.8 of Tillé (2020) for more detail on this estimator,
including an explanation of its quadratic form.
See Deville and Tillé (2005) for the results of a simulation study
comparing this and other alternative estimators for balanced sampling.
</p>
<p>The estimator can be written as follows:
</p>
<p style="text-align: center;"><code class="reqn">
  v(\hat{Y})=\sum_{k \in S} \frac{c_k}{\pi_k^2}\left(y_k-\hat{y}_k^*\right)^2,
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
  \hat{y}_k^*=\mathbf{z}_k^{\top}\left(\sum_{\ell \in S} c_{\ell} \frac{\mathbf{z}_{\ell} \mathbf{z}_{\ell}^{\prime}}{\pi_{\ell}^2}\right)^{-1} \sum_{\ell \in S} c_{\ell} \frac{\mathbf{z}_{\ell} y_{\ell}}{\pi_{\ell}^2}
</code>
</p>

<p>and <code class="reqn">\mathbf{z}_k</code> denotes the vector of auxiliary variables for observation <code class="reqn">k</code>
included in sample <code class="reqn">S</code>, with inclusion probability <code class="reqn">\pi_k</code>. The value <code class="reqn">c_k</code> is set to <code class="reqn">\frac{n}{n-q}(1-\pi_k)</code>,
where <code class="reqn">n</code> is the number of observations and <code class="reqn">q</code> is the number of auxiliary variables.
</p>


<h3>References</h3>

<p>Ash, S. (2014). "<em>Using successive difference replication for estimating variances</em>."
<strong>Survey Methodology</strong>, Statistics Canada, 40(1), 47–59.
</p>
<p>Bellhouse, D.R. (1985). "<em>Computing Methods for Variance Estimation in Complex Surveys</em>."
<strong>Journal of Official Statistics</strong>, Vol.1, No.3.
</p>
<p>Deville, J.‐C., and Tillé, Y. (2005). "<em>Variance approximation under balanced sampling.</em>"
<strong>Journal of Statistical Planning and Inference</strong>, 128, 569–591.
</p>
<p>Tillé, Y. (2020). "<em>Sampling and estimation from finite populations</em>." (I. Hekimi, Trans.). Wiley.
</p>
<p>Matei, Alina, and Yves Tillé. (2005).
“<em>Evaluation of Variance Approximations and Estimators
in Maximum Entropy Sampling with Unequal Probability and Fixed Sample Size.</em>”
<strong>Journal of Official Statistics</strong>, 21(4):543–70.
</p>


</div>