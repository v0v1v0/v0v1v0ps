<div class="container">

<table style="width: 100%;"><tr>
<td>extractClusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster extraction utility</h2>

<h3>Description</h3>

<p>Extract and fit clusters from an input graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extractClusters(
  graph,
  data,
  group = NULL,
  membership = NULL,
  map = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>Input network as an igraph object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. Group specification enables node perturbation
testing. By default, <code>group = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>membership</code></td>
<td>
<p>A vector of cluster membership IDs. If NULL, clusters
will be automatically generated with <code>clusterGraph</code>
using the edge betweenness clustering ("ebc") algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>Logical value. If TRUE, the plot of the input graph
(coloured by cluster membership) will be generated along with independent
module plots. If the input graph is very large, plotting could be
computationally intensive (by default, <code>map = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value. If TRUE, a plot will be showed for each
cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 3 objects:
</p>

<ol>
<li>
<p> "clusters", list of clusters as igraph objects;
</p>
</li>
<li>
<p> "fit", list of fitting results for each cluster as a lavaan object;
</p>
</li>
<li>
<p> "dfc", data.frame of summary results.
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Fernando Palluzzi <a href="mailto:fernando.palluzzi@gmail.com">fernando.palluzzi@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Nonparanormal(npn) transformation
als.npn &lt;- transformData(alsData$exprs)$data

adjdata &lt;- SEMbap(alsData$graph, als.npn)$data

# Clusters creation
clusters &lt;- extractClusters(alsData$graph, adjdata, alsData$group)
print(clusters$dfc)
head(parameterEstimates(clusters$fit$HM1))
head(parameterEstimates(clusters$fit$HM2))
head(parameterEstimates(clusters$fit$HM4))
gplot(clusters$clusters$HM2)

# Map cluster on the input graph
g &lt;- alsData$graph
c &lt;- clusters$clusters$HM2
V(g)$color &lt;- ifelse(V(g)$name %in% V(c)$name, "gold", "white")
gplot(g)


</code></pre>


</div>