<div class="container">

<table style="width: 100%;"><tr>
<td>replicateTTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Early Stopping Experiments</h2>

<h3>Description</h3>

<p>Simulate multiple data sets to show the effects of optional testing for safe (and frequentist) tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">replicateTTests(
  nPlan,
  deltaTrue,
  muGlobal = 0,
  sigmaTrue = 1,
  paired = FALSE,
  alternative = c("twoSided", "greater", "less"),
  lowN = 3,
  nSim = 1000L,
  alpha = 0.05,
  beta = 0.2,
  safeOptioStop = TRUE,
  parameter = NULL,
  freqOptioStop = FALSE,
  nPlanFreq = NULL,
  logging = TRUE,
  seed = NULL,
  pb = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nPlan</code></td>
<td>
<p>vector of max length 2 representing the planned sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaTrue</code></td>
<td>
<p>numeric, the value of the true standardised effect size (test-relevant parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muGlobal</code></td>
<td>
<p>numeric, the true global mean of a paired or two-sample t-test. Its value should not
matter for the test. This parameter is treated as a nuisance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaTrue</code></td>
<td>
<p>numeric &gt; 0,the true standard deviation of the data. Its value should not  matter
for the test.This parameter treated is treated as a nuisance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>logical, if <code>TRUE</code> then paired t-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis must be one of "twoSided" (default),
"greater" or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowN</code></td>
<td>
<p>integer that defines the smallest n of our search space for n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSim</code></td>
<td>
<p>the number of replications, that is, experiments with max samples nPlan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric in (0, 1) that specifies the tolerable type I error control –independent of n– that the
designed test has to adhere to. Note that it also defines the rejection rule e10 &gt; 1/alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>numeric in (0, 1) that specifies the tolerable type II error control necessary to calculate both
the sample sizes and deltaS, which defines the test. Note that 1-beta defines the power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>safeOptioStop</code></td>
<td>
<p>logical, <code>TRUE</code> implies that optional stopping simulation is performed for
the safe test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>numeric, the safe test defining parameter, i.e., deltaS (use designSafeT to find this).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqOptioStop</code></td>
<td>
<p>logical, <code>TRUE</code> implies that optional stopping simulation is performed for
the frequentist test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPlanFreq</code></td>
<td>
<p>the frequentist sample size(s) to plan for. Acquired from <code>designFreqT()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logging</code></td>
<td>
<p>logical, if <code>TRUE</code>, then return the simulated data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>To set the seed for the simulated data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>logical, if <code>TRUE</code>, then show progress bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class "safeTSim". An object of class "safeTSim" is a list containing at
least the following components:
</p>

<dl>
<dt>nPlan</dt>
<dd>
<p>the planned sample size(s).</p>
</dd>
<dt>deltaTrue</dt>
<dd>
<p>the value of the true standardised effect size (test-relevant parameter) provided by
the user.</p>
</dd>
<dt>muGlobal</dt>
<dd>
<p>the true global mean of a paired or two-sample t-test (nuisance parameter) provided by
the user.</p>
</dd>
<dt>paired</dt>
<dd>
<p>if <code>TRUE</code> then paired t-test.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>any of "twoSided", "greater", "less" provided by the user.</p>
</dd>
<dt>lowN</dt>
<dd>
<p>the smallest number of samples (first group) at which monitoring of the tests begins.</p>
</dd>
<dt>nSim</dt>
<dd>
<p>the number of replications of the experiment.</p>
</dd>
<dt>alpha</dt>
<dd>
<p>the tolerable type I error provided by the user.</p>
</dd>
<dt>beta</dt>
<dd>
<p>the tolerable type II error provided by the user.</p>
</dd>
<dt>testType</dt>
<dd>
<p>any of "oneSample", "paired", "twoSample" provided by the user.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameter (point prior) used in the safe test derived from the design.
Acquired from <code>designSafeT()</code>.</p>
</dd>
<dt>nPlanFreq</dt>
<dd>
<p>the frequentist planned sample size(s). Acquired from <code>designFreqT</code>()</p>
</dd>
<dt>safeSim</dt>
<dd>
<p>list with the simulation results of the safe test under optional stopping.</p>
</dd>
<dt>freqSim</dt>
<dd>
<p>list with the simulation results of the frequentist test under optional stopping.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# Design safe test
alpha &lt;- 0.05
beta &lt;- 0.20
designObj &lt;- designSafeT(1, alpha=alpha, beta=beta)

# Design frequentist test
freqObj &lt;- designFreqT(1, alpha=alpha, beta=beta)

# Simulate under the alternative with deltaTrue=deltaMin
simResults &lt;- replicateTTests(nPlan=designObj$nPlan, deltaTrue=1, parameter=designObj$parameter,
                              nPlanFreq=freqObj$nPlan, beta=beta, nSim=250)

# Should be about 1-beta
simResults$safeSim$powerAtN1Plan

# This is higher due to optional stopping
simResults$safeSim$powerOptioStop

# Optional stopping allows us to do better than n1PlanFreq once in a while
simResults$safeSim$probLeqN1PlanFreq
graphics::hist(simResults$safeSim$allN, main="Histogram of stopping times", xlab="n1",
               breaks=seq.int(designObj$nPlan[1]))

# Simulate under the alternative with deltaTrue &gt; deltaMin
simResults &lt;- replicateTTests(nPlan=designObj$nPlan, deltaTrue=1.5, parameter=designObj$parameter,
                              nPlanFreq=freqObj$nPlan, beta=beta, nSim=250)

# Should be larger than 1-beta
simResults$safeSim$powerAtN1Plan

# This is even higher due to optional stopping
simResults$safeSim$powerOptioStop

# Optional stopping allows us to do better than n1PlanFreq once in a while
simResults$safeSim$probLeqN1PlanFreq
graphics::hist(simResults$safeSim$allN, main="Histogram of stopping times", xlab="n1",
               breaks=seq.int(designObj$nPlan[1]))

# Under the null deltaTrue=0
simResults &lt;- replicateTTests(nPlan=designObj$nPlan, deltaTrue=0, parameter=designObj$parameter,
                              nPlanFreq=freqObj$nPlan, freqOptioStop=TRUE, beta=beta, nSim=250)

# Should be lower than alpha, because if the null is true, P(S &gt; 1/alpha) &lt; alpha for all n
simResults$safeSim$powerAtN1Plan

# This is a bit higher due to optional stopping, but if the null is true,
# then still P(S &gt; 1/alpha) &lt; alpha for all n
simResults$safeSim$powerOptioStop

# Should be lowr than alpha, as the experiment is performed as was planned
simResults$freqSim$powerAtN1Plan

# This is larger than alpha, due to optional stopping.
simResults$freqSim$powerOptioStop
simResults$freqSim$powerOptioStop &gt; alpha
</code></pre>


</div>