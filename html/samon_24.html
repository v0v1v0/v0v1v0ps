<div class="container">

<table style="width: 100%;"><tr>
<td>samonevalIM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluates the loss function at a range of smoothing parameters</h2>

<h3>Description</h3>

<p>Computes the loss function for a range of smoothing parameters</p>


<h3>Usage</h3>

<pre><code class="language-R">samonevalIM( mat, Npart = 10, sigmaList = c(1), inmodel =
inmodel, seed = 1, type="both")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p> matrix with (i,j) entry representing value for subject i at
time-point j. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Npart</code></td>
<td>
<p> number of parts to partition the data when evaluating
the loss functions lossH and lossF. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaList</code></td>
<td>
<p> vector of sigmas at which to evaluate the loss function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inmodel</code></td>
<td>
<p> NT by 6 matrix indicating which variables to include
in logistic model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p> seed to use when imputing intermittent data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> one of "H", "F" or "both" to evaluate lossH, lossF or
both for sigmaH or sigmaF in indicated range. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Stepping through the values in sigmaList this functions computes the
values of a loss function.  If type is set to "H" or "h" then the loss
function associated with dropout is computed.  If type is set to "F" or
"f" then the loss function associated with outcome is computed.  If type
is set any other value then both types of loss function are evaluated.
</p>
<p>Since the input matrix, mat, can possess intermittent missing data,
samonevalIM imputes these values using a logistic model.  This is the
model specified by inmodel.
</p>
<p>inmodel is an NT by 6 matrix and contains a row for each time-point
represented in the mat matrix.  Since there are no intermittent missing
data at time 1 and at time NT these rows should be set to zero.
</p>
<p>A separate logistic model is fit for each timepoint t0, with t0 ranging
from 2 to NT-1.  The dependent variable in these models is an indicator
indicating that an individual provided data at time t0.  Only
individuals who are on study at time t0+1 are considered in these models. 
Setting the ith column in inmodel to 1 indicates that the following
terms should be included in the model:
</p>

<dl>
<dt>1</dt>
<dd>
<p>the intercept.</p>
</dd>
<dt>2</dt>
<dd>
<p>the previous value of Y, that is the value of Y at t0-1.</p>
</dd>
<dt>3</dt>
<dd>
<p>the next available value of Y after time t0.</p>
</dd>
<dt>4</dt>
<dd>
<p>if the next available value of Y is at time t1, then this is
(t1 - t0 - 1).</p>
</dd>
<dt>5</dt>
<dd>
<p>an interaction between the variable in column 3 and column 4.</p>
</dd>
<dt>6</dt>
<dd>
<p>0 if an individual is last observed at time NT, 1 if they are
last observed at time NT - 1,  2 if they are last observed at
time NT - 2, etc.</p>
</dd>
</dl>
<p>For the model that runs at the penultimate time, NT-1, including all six
terms in the model will lead to over specification.
</p>
<p>To include as many terms as possible in each model set inmodel to be
</p>

<table>
<tr>
<td style="text-align: right;"> 
 0 </td>
<td style="text-align: right;">   0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1  </td>
<td style="text-align: right;">  1</td>
</tr>
<tr>
<td style="text-align: right;">
 . </td>
<td style="text-align: right;"> . </td>
<td style="text-align: right;"> . </td>
</tr>
<tr>
<td style="text-align: right;">
 . </td>
<td style="text-align: right;"> . </td>
<td style="text-align: right;"> . </td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>At a given timepoint t0, there may not be enough intermittent missing
data to support all six terms.  In such cases variables are removed
from the model until the regression converges.  If less than 4
observations have intermittent missing data at a given timepoint a
model fitting the mean is used.
</p>
<p>samonevalIM sequentially imputes intermittent missing data using these
models. Once the intermittent data is imputed a loss function is
evaluated on the data.
</p>


<h3>Value</h3>

<p>Returns an N by 2 matrix of results if type is "H" or "F" or an N by 4
matrix if type is "both". There is one row for each value of sigma. If
type is "P" then the columns are sigmaH and lossH, if type is "F" then
the columns are sigmaF and lossF, and, if type = "both" then the
columns are sigmaH, lossH, sigmaF, and lossF.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data("VAS1")

  ## inputation moddel.
  NT                &lt;- ncol(VAS1)
  inmodel           &lt;- matrix(1,NT,6)
  inmodel[1,]       &lt;- 0
  inmodel[NT,]      &lt;- 0
  inmodel[NT-1,4:6] &lt;- 0

  ## outcome loss function
  F1 &lt;- samonevalIM( mat = VAS1, Npart = 10,
           sigmaList = seq(1,10,by=1),
           inmodel = inmodel,
           seed = 26,
           type = "F" )
</code></pre>


</div>