<div class="container">

<table style="width: 100%;"><tr>
<td>weightsLinearInterp1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weights for linear interpolation in 1D and 2D</h2>

<h3>Description</h3>

<p>Computation of weights for linear interpolation in 1D and 2D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weightsLinearInterp1D(x, g1, g2, circular = FALSE)

weightsLinearInterp2D(x, y, gx1, gx2, gy1, gy2, circular = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>vectors of length <code>n</code> containing the points where the
weights should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1, g2, gx1, gx2, gy1, gy2</code></td>
<td>
<p>vectors of length <code>n</code> such that
<code>g1 &lt;= x &lt;= g2</code> for 1D and <code>gx1 &lt;= x &lt;= gx2</code> and
<code>gy1 &lt;= y &lt;= gy2</code> for 2D.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circular</code></td>
<td>
<p>flag to indicate whether the differences should be
circularly wrapped.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the examples for how to use the weights for linear binning.
</p>


<h3>Value</h3>


<ul>
<li>
<p> For 1D, a matrix of size <code>c(n, 2)</code> containing the weights for
lower (<code>g1</code>) and upper (<code>g1</code>) bins.
</p>
</li>
<li>
<p> For 2D, a matrix of size <code>c(n, 4)</code> containing the weights for
lower-lower (<code>g1x</code>, <code>g1y</code>), <em>upper-lower</em> (<code>g2x</code>,
<code>g1y</code>), <em>lower-upper</em> (<code>g1x</code>, <code>g2y</code>) and upper-upper
(<code>g2x</code>, <code>g2y</code>) bins. <code>cbind(g1x, g1y)</code>,
<code>cbind(g1x, g1y)</code>, <code>cbind(g1x, g1y)</code> and <code>cbind(g2x, g2y)</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># 1D, linear
x &lt;- seq(-4, 4, by = 0.5)
g1 &lt;- x - 0.25
g2 &lt;- x + 0.5
w &lt;- weightsLinearInterp1D(x = x, g1 = g1, g2 = g2)
f &lt;- function(x) 2 * x + 1
rowSums(w * cbind(f(g1), f(g2)))
f(x)

# 1D, circular
x &lt;- seq(-pi, pi, by = 0.5)
g1 &lt;- toPiInt(x - 0.25)
g2 &lt;- toPiInt(x + 0.5)
w &lt;- weightsLinearInterp1D(x = x, g1 = g1, g2 = g2, circular = TRUE)
f &lt;- function(x) 2 * sin(x) + 1
rowSums(w * cbind(f(g1), f(g2)))
f(x)

# 2D, linear
x &lt;- seq(-4, 4, by = 0.5)
y &lt;- 2 * x
gx1 &lt;- x - 0.25
gx2 &lt;- x + 0.5
gy1 &lt;- y - 0.75
gy2 &lt;- y + 0.25
w &lt;- weightsLinearInterp2D(x = x, y = y, gx1 = gx1, gx2 = gx2,
                           gy1 = gy1, gy2 = gy2)
f &lt;- function(x, y) 2 * x + 3 * y + 1
rowSums(w * cbind(f(gx1, gy1), f(gx2, gy1), f(gx1, gy2), f(gx2, gy2)))
f(x, y)

# 2D, circular
x &lt;- seq(-pi, pi, by = 0.5)
y &lt;- toPiInt(2 * x)
gx1 &lt;- toPiInt(x - 0.25)
gx2 &lt;- toPiInt(x + 0.5)
gy1 &lt;- toPiInt(y - 0.75)
gy2 &lt;- toPiInt(y + 0.25)
w &lt;- weightsLinearInterp2D(x = x, y = y, gx1 = gx1, gx2 = gx2,
                           gy1 = gy1, gy2 = gy2, circular = TRUE)
f &lt;- function(x, y) 2 * sin(x) + 3 * cos(y) + 1
rowSums(w * cbind(f(gx1, gy1), f(gx2, gy1), f(gx1, gy2), f(gx2, gy2)))
f(x, y)
</code></pre>


</div>