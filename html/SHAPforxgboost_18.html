<div class="container">

<table style="width: 100%;"><tr>
<td>shap.prep.stack.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare data for SHAP force plot (stack plot)</h2>

<h3>Description</h3>

<p>Make force plot for <code>top_n</code> features, optional to randomly plot certain
portion of the data in case the dataset is large.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shap.prep.stack.data(
  shap_contrib,
  top_n = NULL,
  data_percent = 1,
  cluster_method = "ward.D",
  n_groups = 10L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shap_contrib</code></td>
<td>
<p>shap_contrib is the SHAP value data returned from
predict, here an ID variable is added for each observation in
the <code>shap_contrib</code> dataset for better tracking, it is created in the
begining as <code>1:nrow(shap_contrib)</code>. The ID matches the output from
<code>shap.prep</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_n</code></td>
<td>
<p>integer, optional to show only top_n features, combine the rest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_percent</code></td>
<td>
<p>what percent of data to plot (to speed up the testing
plot). The accepted input range is (0,1], if observations left is too few,
there will be an error from the clustering function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_method</code></td>
<td>
<p>default to ward.D, please refer to <code>stats::hclust</code> for
details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_groups</code></td>
<td>
<p>a integer, how many groups to plot in
<code>shap.plot.force_plot_bygroup</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a dataset for stack plot
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# **SHAP force plot**
plot_data &lt;- shap.prep.stack.data(shap_contrib = shap_values_iris,
                                  n_groups = 4)
shap.plot.force_plot(plot_data)
shap.plot.force_plot(plot_data,  zoom_in_group = 2)

# plot all the clusters:
shap.plot.force_plot_bygroup(plot_data)
</code></pre>


</div>