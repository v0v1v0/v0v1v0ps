<div class="container">

<table style="width: 100%;"><tr>
<td>checkNorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checking the multivariate normal approximation.</h2>

<h3>Description</h3>

<p>Given an object of class <code>synlik</code> this routine provides a 
graphical check of whether the distribution of the random 
summary statistics is multivariate normal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">checkNorm(object, param = object@param, nsim = 1000, observed = NULL,
  cex.axis = 1, cex.lab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>synlik</code> or a matrix where each row is a random vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A vector of model's parameters at which the summary statistics will be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of summary statistics to be simulated if object is of class <code>synlik</code>, otherwise
it is not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>A vector of observed summary statistics. By default <code>NULL</code>, so <code>object@data</code> will be used as observed statistics.
It will be looked at only if <code>object</code> is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Axis scale expansion factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>Axis label expansion factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>object@simulator</code> and <code>object@summaries</code>.
In general I would avoid using it and including in <code>object@extraArgs</code> everything they need.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method is from section 7.5 of Krzanowski (1988). The replicate vectors of summary statistic <code>S</code> 
are transformed to variables which should be univariate chi squared r.v.s with DoF given by the number of rows of <code>S</code>. 
An appropriate QQ-plot is produced, and the proportion of the data differing substantially from the ideal 
line is reported. Deviations at the right hand end of the plot indicate that the tail behaviour of the Normal 
approximation is poor: in the context of synthetic likelihood this is of little consequence.  
Secondly, <code>s</code> is transformed to a vector which should be i.i.d. N(0,1) under
multivariate normality, and a QQ plot is produced. Unfortunately this approach is not very
useful unless the dimension of <code>s</code> is rather large. In simulations, perfectly MVN data produce 
highly variable results, so that the approach lacks any real power.
</p>


<h3>Value</h3>

<p>Mainly produces plots and prints output. Also an array indicating 
proportion of simulated statistics smaller than observed.
</p>


<h3>Author(s)</h3>

<p>Simon N. Wood, maintained by Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.
</p>


<h3>References</h3>

<p>Krzanowski, W.J. (1988) Principles of Multivariate Analysis. Oxford.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Create Object
data(ricker_sl)

#### Simulate from the object
ricker_sl@data &lt;- simulate(ricker_sl)
ricker_sl@extraArgs$obsData &lt;- ricker_sl@data 

#### Checking multivariate normality
checkNorm(ricker_sl)

# With matrix input
checkNorm(matrix(rnorm(200), 100, 2))
</code></pre>


</div>