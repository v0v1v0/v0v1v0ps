<div class="container">

<table style="width: 100%;"><tr>
<td>assimilation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Compute Assimilation Indices
</h2>

<h3>Description</h3>


<p>This is the main function in <span class="pkg">siplab</span> for computing assimilation indices. Optionally, it computes also a free-growing index, and/or the assimilation centroid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assimilation(plants, pixsize = 0.2, resource = 1, influence =
    gnomon_inf, infpar = NULL, asym = Inf, efficiency = flat_eff,
    effpar = NULL, plot = TRUE, afree = FALSE, centroid = FALSE)

assimilation_pix(plants, pixsize = 0.2, resource = 1, influence =
    gnomon_inf, infpar = NULL, asym = Inf, efficiency = flat_eff,
    effpar = NULL, plot = TRUE, afree = FALSE, centroid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>plants</code></td>
<td>


<p>A <span class="pkg">spatstat</span> point pattern object (class <code>ppp</code>). It contains the plants coordinates, and marks with the plant size and possibly other attributes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixsize</code></td>
<td>


<p>Resolution, approximate step size in the pixel grid. Default 0.2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resource</code></td>
<td>


<p>Either a pixel image (class <code>im</code>), or a function, or other object that can be converted to a pixel image, specifying the spatial distribution of resource availability. If an image, it should cover the <code>plants</code> window. It is adjusted to the <code>plants</code> window size and specified resolution if necessary. Default is 1, a uniform distribution with 1 unit of resource per unit area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>influence</code></td>
<td>


<p>Function for computing influence values. Must take arguments <code>(dx, dy, marks, par)</code>, where <code>dx</code> is a vector of points-to plant x-distances, <code>dy</code> is a vector of points-to plant y-distances, <code>marks</code> are the plant marks, and <code>par</code> receives the value of the <code>infpar</code> argument. Examples are provided in the functions <code>tass_inf()</code>, etc. (see influence). Default: <code>gnomon_inf</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infpar</code></td>
<td>


<p>Parameter(s) for <code>influence</code>, a list or vector. Default: <code>list(a=1, b=4, smark=1)</code>. Here <code>smark=1</code> indicates that the plant size variable is the first or only item in <code>marks</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asym</code></td>
<td>


<p>Asymmetry parameter <code class="reqn">\alpha</code> in the allotment function. Default is <code>Inf</code>, which corresponds to one-sided competition (tesselation models). In old versions of <span class="pkg">siplab</span> this parameter was called <code>partpar</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efficiency</code></td>
<td>


<p>Efficiency function for weighting the point-wise resource uptake. Must take arguments <code>(dx, dy, marks)</code> or <code>(dx, dy, marks, par)</code>, where <code>dx</code> is a vector of points-to plant x-distances, <code>dy</code> is a vector of points-to plant y-distances, <code>marks</code> are the plant marks, and <code>par</code> receives the value of the <code>effpar</code> argument if not <code>NULL</code>. Examples are provided in the functions <code>tass_eff()</code>, etc. (see efficiency). The default is <code>flat_eff</code>, no weighting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effpar</code></td>
<td>


<p>Parameter(s) for <code>efficiency</code>, usually a list or vector. Default: <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>


<p>If <code>TRUE</code>, the denominator of the allotment function is graphed as a pixel image, to visualize competition pressure (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afree</code></td>
<td>


<p>If <code>TRUE</code>, the free-growing assimilation is also computed. Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centroid</code></td>
<td>


<p>If <code>TRUE</code>, the centroid of the plant assimilation distribution is also computed. Default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p><code>assimilation()</code> and <code>assimilation_pix()</code> are functionally equivalent, but the code in <code>assimilation_pix()</code> is somewhat clearer and slower. It may be useful for documentation purposes, and as a basis for user modification.
</p>
<p>Computation starts with a resource intensity map at a spatial resolution given by <code>pixsize</code>. Typically the resource distribution is assumed to be uniform (the default). Plants exert competitive pressure depending on size and distance, described by the <code>influence</code> function. The resource available at each pixel is allotted to plants according to their influence and to an allotment rule parametrized by <code>asym</code>. Finally, the resource uptake is weighted by the <code>efficiency</code> function, and is spatially integrated to obtain the plant's assimilation index. Besides size, influence and efficiency functions can include other plant attributes, such as species.
</p>


<h3>Value</h3>






<p>Returns the input point pattern <code>plants</code>, with the marks replaced by a data frame containing the original marks followed by one or more columns containing the computed results. The additional column are the assimilation indices in column <code>aindex</code>, and optionally the free-growing index in <code>afree</code>, and/or the x and y centroid coordinates in <code>cx</code> and <code>cy</code>. 
</p>


<h3>Note</h3>


<p>Requires the <span class="pkg">spatstat</span> package.
</p>


<h3>Author(s)</h3>


<p>Oscar García.
</p>


<h3>References</h3>


<p><a href="https://github.com/ogarciav/siplab">https://github.com/ogarciav/siplab</a>.
</p>
<p>García, O. (2013) “A generic approach to spatial individual-based modelling and simulation of plant communities”. Mathematical and Computational Forestry and Nat.-Res. Sci. (MCFNS) 6(1), 36-47. 2014.
</p>


<h3>See Also</h3>


<p><code>influence</code>, <code>efficiency</code>, <code>edges</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">a &lt;- assimilation(finpines, infpar=list(a=1, b=4,
     smark="height"), afree=TRUE)
summary(a)
system.time(assimilation_pix(finpines))
system.time(assimilation(finpines))
</code></pre>


</div>