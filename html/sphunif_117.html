<div class="container">

<table style="width: 100%;"><tr>
<td>Gauss_Legen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gauss–Legendre quadrature</h2>

<h3>Description</h3>

<p>Convenience for computing the nodes <code class="reqn">x_k</code> and weights
<code class="reqn">w_k</code> of the <em>Gauss–Legendre</em> quadrature formula
in <code class="reqn">(a, b)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\int_a^b f(x) w(x)\,\mathrm{d}x\approx\sum_{k=1}^N w_k f(x_k).</code>
</p>
<p>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Gauss_Legen_nodes(a = -1, b = 1, N = 40L)

Gauss_Legen_weights(a = -1, b = 1, N = 40L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>scalars giving the interval <code class="reqn">(a, b)</code>. Defaults to
<code class="reqn">(-1, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of points used in the Gauss–Legendre quadrature. The
following choices are supported: <code>5</code>, <code>10</code>, <code>20</code>,
<code>40</code>, <code>80</code>, <code>160</code>, <code>320</code>, <code>640</code>, <code>1280</code>,
<code>2560</code>, and <code>5120</code>. Defaults to <code>40</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code class="reqn">C^\infty</code> functions, Gauss–Legendre quadrature
can be very efficient. It is exact for polynomials up to degree
<code class="reqn">2N - 1</code>.
</p>
<p>The nodes and weights up to <code class="reqn">N = 80</code> were retrieved from
<a href="https://dlmf.nist.gov/3.5#v">NIST</a> and have <code class="reqn">10^{-21}</code> precision.
For <code class="reqn">N = 160</code> onwards, the nodes and weights were computed with the
<code>gauss.quad</code> function from the <a href="https://CRAN.R-project.org/package=statmod">
<code>statmod</code></a> package (Smyth, 1998), and have <code class="reqn">10^{-15}</code> precision.
</p>


<h3>Value</h3>

<p>A matrix of size <code>c(N, 1)</code> with the nodes <code class="reqn">x_k</code>
(<code>Gauss_Legen_nodes</code>) or the corresponding weights <code class="reqn">w_k</code>
(<code>Gauss_Legen_weights</code>).
</p>


<h3>References</h3>

<p><em>NIST Digital Library of Mathematical Functions</em>. Release
1.0.20 of 2018-09-15. F. W. J. Olver, A. B. Olde Daalhuis, D. W. Lozier,
B. I. Schneider, R. F. Boisvert, C. W. Clark, B. R. Miller,
and B. V. Saunders, eds. <a href="https://dlmf.nist.gov/">https://dlmf.nist.gov/</a>
</p>
<p>Smyth, G. K. (1998). Numerical integration. In: <em>Encyclopedia of
Biostatistics</em>, P. Armitage and T. Colton (eds.), Wiley, London,
pp. 3088-3095.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Integration of a smooth function in (1, 10)

# Weights and nodes for integrating
x_k &lt;- Gauss_Legen_nodes(a = 1, b = 10, N = 40)
w_k &lt;- Gauss_Legen_weights(a = 1, b = 10, N = 40)

# Check quadrature
f &lt;- function(x) sin(x) * x^2 - log(x + 1)
integrate(f, lower = 1, upper = 10, rel.tol = 1e-12)
sum(w_k * f(x_k))

# Exact for polynomials up to degree 2 * N - 1
f &lt;- function(x) (((x + 0.5) / 1e3)^5 - ((x - 0.5)/ 5)^4 +
  ((x - 0.25) / 10)^2 + 1)^20
sum(w_k * f(x_k))
integrate(f, lower = -1, upper = 1, rel.tol = 1e-12)

## Integration on (0, pi)

# Weights and nodes for integrating
th_k &lt;- Gauss_Legen_nodes(a = 0, b = pi, N = 40)
w_k &lt;- Gauss_Legen_weights(a = 0, b = pi, N = 40)

# Check quadrature
p &lt;- 4
psi &lt;- function(th) -sin(th / 2)
w &lt;- function(th) sin(th)^(p - 2)
integrate(function(th) psi(th) * w(th), lower = 0, upper = pi,
          rel.tol = 1e-12)
sum(w_k * psi(th_k) * w(th_k))

# Integral with Gegenbauer polynomial
k &lt;- 3
C_k &lt;- function(th) drop(Gegen_polyn(theta = th, k = k, p = p))
integrate(function(th) psi(th) * C_k(th) * w(th), lower = 0, upper = pi,
          rel.tol = 1e-12)
th_k &lt;- drop(Gauss_Legen_nodes(a = 0, b = pi, N = 80))
w_k &lt;- drop(Gauss_Legen_weights(a = 0, b = pi, N = 80))
sum(w_k * psi(th_k) * C_k(th_k) * w(th_k))
</code></pre>


</div>