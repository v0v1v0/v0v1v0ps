<div class="container">

<table style="width: 100%;"><tr>
<td>snap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>snap</h2>

<h3>Description</h3>

<p>A simple wrapper to easily design vanilla deep neural networks using 'Tensorflow'/'Keras' backend for regression, classification and multi-label tasks, with some tweaks and tricks (skip shortcuts, embedding, feature selection and anomaly detection).
</p>


<h3>Usage</h3>

<pre><code class="language-R">snap(
  data,
  target,
  task = NULL,
  positive = NULL,
  skip_shortcut = FALSE,
  embedding = "none",
  embedding_size = 10,
  folds = 3,
  reps = 1,
  holdout = 0.3,
  layers = 1,
  activations = "relu",
  regularization_L1 = 0,
  regularization_L2 = 0,
  nodes = 32,
  dropout = 0,
  span = 0.2,
  min_delta = 0,
  batch_size = 32,
  epochs = 50,
  imp_thresh = 0,
  anom_thresh = 1,
  output_activation = NULL,
  optimizer = "Adam",
  loss = NULL,
  metrics = NULL,
  winsor = FALSE,
  q_min = 0.01,
  q_max = 0.99,
  normalization = TRUE,
  seed = 42,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame including all the features and targets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>String. Single label for target feature when task is "regr" or "classif". String vector with multiple labels for target features when task is "multilabel".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>task</code></td>
<td>
<p>String. Inferred by data type of target feature(s). Available options are: "regr", "classif", "multilabel". Default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>
<p>String. Positive class label (only for classification task). Default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_shortcut</code></td>
<td>
<p>Logical. Option to add a skip shortcut to improve network performance in case of many layers. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedding</code></td>
<td>
<p>String. Available options are: "none", "global" (when identical values for different features hold different meanings), "sequence" (when identical values for different features hold the same meaning). Default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedding_size</code></td>
<td>
<p>Integer. Output dimension for the embedding layer. Default: 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>Positive integer. Number of folds for repeated cross-validation. Default: 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Positive integer. Number of repetitions for repeated cross-validation. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>holdout</code></td>
<td>
<p>Positive numeric. Percentage of cases for holdout validation. Default: 0.3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>Positive integer. Number of layers for the neural net. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activations</code></td>
<td>
<p>String. String vector with the activation functions for each layer (for example, a neural net with 3 layers may have activations = c("relu", "gelu", "tanh")). Besides standard Tensorflow/Keras activations, you can also choose: "swish", "mish", "gelu", "bent". Default: "relu".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regularization_L1</code></td>
<td>
<p>Positive numeric. Value for L1 regularization of the loss function. Default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regularization_L2</code></td>
<td>
<p>Positive numeric. Value for L2 regularization of the loss function. Default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>Positive integer. Integer vector with the nodes for each layer (for example, a neural net with 3 layers may have nodes = c(32, 64, 16)). Default: 32.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout</code></td>
<td>
<p>Positive numeric. Value for the dropout parameter for each layer (for example, a neural net with 3 layers may have dropout = c(0, 0.5, 0.3)). Default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>Positive numeric. Percentage of epoch for the patience parameter. Default: 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_delta</code></td>
<td>
<p>Positive numeric. Minimum improvement on metric to trigger the early stop. Default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Positive integer. Maximum batch size for training. Default: 32.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Positive integer. Maximum number of forward and backward propagations. Default: 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imp_thresh</code></td>
<td>
<p>Positive numeric. Importance threshold (in percentiles) above which the features are included in the model (using ReliefFbestK metric by CORElearn). Default: 0 (all features included).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anom_thresh</code></td>
<td>
<p>Positive numeric. Anomaly threshold (in percentiles) above which the instances are excluded by the model (using lof by dbscan). Default: 1 (all instances included).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_activation</code></td>
<td>
<p>String. Default: NULL. If not specified otherwise, it will be "Linear" for regression task, "Softmax" for classification task, "Sigmoid" for multilabel task.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String. Standard Tensorflow/Keras Optimization methods are available. Default: "Adam".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Default: NULL. If not specified otherwise, it will be "mean_absolute_error" for regression task, "categorical_crossentropy" for classification task, "binary_crossentropy" for multilabel task.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>Default: NULL. If not specified otherwise, it will be "mean_absolute_error" for regression task, "categorical_crossentropy" for classification task, "binary_crossentropy" for multilabel task.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsor</code></td>
<td>
<p>Logical. Set to TRUE in case you want to perform Winsorization on regression tasks. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_min</code></td>
<td>
<p>Positive numeric. Minimum quantile threshold for Winsorization. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_max</code></td>
<td>
<p>Positive numeric. Maximum quantile threshold for Winsorization. Default: 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>
<p>Logical. After each layer it performs a batch normalization. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Positive integer. Seed value to control random processes. Default: 42.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Positive integer. Set the level of information from Keras. Default: 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li>
<p> task: kind of task solved
</p>
</li>
<li>
<p> configuration: main hyper-parameters describing the neural net (layers, activations, regularization_L1, regularization_L2, nodes, dropout)
</p>
</li>
<li>
<p> model: Keras standard model description
</p>
</li>
<li>
<p> pred_fun: function to use on the same data scheme to predict new values
</p>
</li>
<li>
<p> plot: Keras standard history plot
</p>
</li>
<li>
<p> testing_frame: testing set with the related predictions, including
</p>
</li>
<li>
<p> trials: statistics for each trial during the repeated cross-validation (train set and validation set):
</p>

<ul>
<li>
<p> task "classif": balanced accuracy (bac), precision (prc), sensitivity (sen), critical success index (csi), FALSE-score (fsc), Kappa (kpp), Kendall (kdl)
</p>
</li>
<li>
<p> task "regr": root mean square error(rmse), mean absolute error (mae), median absolute error (mdae), relative root square error (rrse), relative absolute error (rae), Pearson (prsn)
</p>
</li>
<li>
<p> task "multilabel": macro bac, macro prc, macro sensitivity, macro sen, macro csi, macro fsc, micro kpp, micro kdl
</p>
</li>
</ul>
</li>
<li>
<p> metrics: summary statistics as above for training, validation (both averaged over trials) and testing
</p>
</li>
<li>
<p> selected_feat: labels of features included within the model
</p>
</li>
<li>
<p> selected_inst: index of instances included within the model
</p>
</li>
<li>
<p> time_log
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul><li> <p><a href="https://rpubs.com/giancarlo_vercellino/snap">https://rpubs.com/giancarlo_vercellino/snap</a>
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
snap(friedman3, target="y")

snap(threenorm, target="classes", imp_thresh = 0.3, anom_thresh = 0.95)

snap(threenorm, "classes", layers = 2, activations = c("gelu", "swish"), nodes = c(32, 64))

## End(Not run)

</code></pre>


</div>