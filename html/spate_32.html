<div class="container">

<table style="width: 100%;"><tr>
<td>real.fft.TS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fast calculation of the two-dimensional real Fourier transform of a space-time field. For
each time point, the spatial field is transformed.
</h2>

<h3>Description</h3>

<p>This function calculates the two-dimensional real Fourier transform of
a space-time field. This is a wrapper
function for a C function which uses the complex FFT function from the
'fftw3' library. In contrast to using T times the function 'real.FFT',
R needs to communicate with C only once and not T times which saves
computational time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">real.fft.TS(w,n,T,inv=TRUE,indFFT=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>Spatio-temporal field in a stacked vector of length T x N. Stacking is done
first over space and then time. E.g., the first N=n^2 entries contain
the spatial field at time t=1. Note that the spatial field itself is
stacked as well, i.e., each spatial field is in a vector of length N=n^2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of grid points on each axis. n x n is the total number of spatial points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>

<p>Number of time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inv</code></td>
<td>

<p>Indicates whether the inverse Fourier transform should be calculated or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indFFT</code></td>
<td>

<p>A list of containing vectors of natural numbers representing indices
used to transform between the real and the complex Fourier transform.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of length T x N containing the (inverse) Fourier transform of 'w'.
</p>


<h3>Author(s)</h3>

<p>Fabio Sigrist
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 100
T &lt;- 4
spec &lt;- matern.spec(wave=spate.init(n=n,T=1)$wave,n=n,rho0=0.05,sigma2=1,norm=TRUE)
specsim &lt;- matrix(0,nrow=T,ncol=n*n)
for(t in 1:T) specsim[t,] &lt;- rnorm(n*n)*sqrt(spec)
maternsim &lt;- vect.to.TSmat(real.fft.TS(TSmat.to.vect(specsim),n=n,T=T,inv=FALSE),T=T)
opar &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,2))
for(t in 1:T) image(1:n,1:n,matrix(maternsim[t,],nrow=n),
                    main="Sample from Matern field",xlab="",ylab="")
par(opar) # Reset par() settings
</code></pre>


</div>