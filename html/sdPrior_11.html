<div class="container">

<table style="width: 100%;"><tr>
<td>hyperpar_mod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Scale Parameter for modular regression</h2>

<h3>Description</h3>

<p>Find Scale Parameter for modular regression
</p>


<h3>Usage</h3>

<pre><code class="language-R">hyperpar_mod(Z, K1, K2, A, c = 0.1, alpha = 0.1, omegaseq, omegaprob,
  R = 10000, myseed = 123, thetaseq = NULL, type = "IG",
  lowrank = FALSE, k = 5, mc = FALSE, ncores = 1, truncate = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>rows from the tensor product design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K1</code></td>
<td>
<p>precision matrix1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K2</code></td>
<td>
<p>precision matrix2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>constraint matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>threshold from eq. (8) in Klein &amp; Kneib (2016)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>probability parameter from eq. (8) in Klein &amp; Kneib (2016)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omegaseq</code></td>
<td>
<p>sequence of weights for the anisotropy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omegaprob</code></td>
<td>
<p>prior probabilities for the weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myseed</code></td>
<td>
<p>seed in case of simulation. default is 123.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaseq</code></td>
<td>
<p>possible sequence of thetas. default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of hyperprior for tau/tau^2; options: IG =&gt; IG(1,theta) for tau^2, SD =&gt; WE(0.5,theta) for tau^2, HN =&gt; HN(0,theta) for tau, U =&gt; U(0,theta) for tau, HC =&gt; HC(0,theta) for tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowrank</code></td>
<td>
<p>default is FALSE. If TRUE a low rank approximation is used for Z with k columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>only used if lowrank=TRUE. specifies target rank of low rank approximation. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>default is FALSE. only works im thetaseq is supplied. can parallel across thetaseq.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>default is 1. number of cores is mc=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>default is 1. If &lt; 1 the lowrank approximation is based on on cumsum(values)/sum(values).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the optimal value for theta
</p>


<h3>Author(s)</h3>

<p>Nadja Klein
</p>


<h3>References</h3>

<p>Kneib, T., Klein, N., Lang, S. and Umlauf, N. (2017) Modular Regression - A Lego System for Building Structured Additive Distributional Regression Models with Tensor Product Interactions 
<em>Working Paper</em>.
</p>


</div>