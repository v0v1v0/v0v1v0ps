<div class="container">

<table style="width: 100%;"><tr>
<td>sglasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lasso Method for the RCON(V, E) Models</h2>

<h3>Description</h3>

<p>Fit the weighted l1-penalized <em>RCON(V, E)</em> models using a cyclic coordinate algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sglasso(S, mask, w = NULL, flg = NULL, min_rho = 1.0e-02, nrho = 50,  
        nstep = 1.0e+05, algorithm = c("ccd","ccm"), truncate = 1e-05, 
        tol = 1.0e-03)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the empirical variance/covariance matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>a symmetric matrix used to specify the equality constraints on the entries of the concentration matrix. See the example bellow for more details;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a vector specifying the weights used to compute the weighted l1-norm of the parameters of the <em>RCON(V, E)</em> model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flg</code></td>
<td>
<p>a logical vector used to specify if a parameter is penalized, i.e., if <code>flg[i] = TRUE</code> then the i-th parameter is penalized, otherwise (<code>flg[i] = FALSE</code>) the maximum likelihood estimate is computed;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_rho</code></td>
<td>
<p>last value of the sequence of tuning parameters used to compute the sglasso solution path. If <code>nrho = 1</code>, then <code>min_rho</code> is the value used to compute the sglasso estimate. Default value is 1.0e-02;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrho</code></td>
<td>
<p>number of tuning parameters used to compute the sglasso solution path. Default is 50;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstep</code></td>
<td>
<p>nonnegative integer used to specify the maximun number of iterations of the two cyclic coordinate algorithms. Default is 1.0e+05;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>character by means of to specify the algorithm used to fit the model, i.e., a cyclic coordinate descente (<code>ccd</code>) algorithm or a cyclic coordinate minimization (<code>ccm</code>) algorithm. Default is <code>ccd</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>at convergence all estimates below this value will be set to zero. Default is 1e-05;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>value used for convergence. Default value is 1.0e-05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <em>RCON(V, E)</em> model (Hojsgaard et al., 2008) is a kind of restriction of the Gaussian Graphical Model defined using a coloured graph to specify a set of equality constraints on the entries of the concentration matrix. Roughly speaking, a coloured graph implies a partition of the vertex set into <code class="reqn">R</code> disjoint subsets, called vertex colour classes, and a partition of the edge set into <code class="reqn">S</code> disjoint subsets, called edge colour classes. At each vertex/edge colour class is associated a specific colour. If we denote by <code class="reqn">K = (k_{ij})</code> the concentration matrix, i.e. the inverse of the variance/covariance matrix <code class="reqn">\Sigma</code>, the coloured graph implies the following equality constraints:</p>

<ol>
<li> <p><code class="reqn">k_{ii} = \eta_n</code> for any index <code class="reqn">i</code> belonging to the <code class="reqn">n</code>th vertex colour class;
</p>
</li>
<li> <p><code class="reqn">k_{ij} = \theta_m</code> for any pair <code class="reqn">(i,j)</code> belonging to the <code class="reqn">m</code>th edge colour class.
</p>
</li>
</ol>
<p> Denoted with <code class="reqn">\psi = (\eta',\theta')'</code> the <code class="reqn">(R+S)</code>-dimensional parameter vector, the concentration matrix can be defined as </p>
<p style="text-align: center;"><code class="reqn">K(\psi) = \sum_{n=1}^R\eta_nD_n + \sum_{m=1}^S\theta_mT_m,</code>
</p>
<p> where <code class="reqn">D_n</code> is a diagonal matrix with entries <code class="reqn">D^n_{ii} = 1</code> if the index <code class="reqn">i</code> belongs to the <code class="reqn">n</code>th vertex colour class and zero otherwise. In the same way, <code class="reqn">T_m</code> is a symmetrix matrix with entries <code class="reqn">T^m_{ij} = 1</code> if the pair <code class="reqn">(i,j)</code> belongs to the <code class="reqn">m</code>th edge colour class. Using the previous specification of the concentration matrix, the structured graphical lasso (sglasso) estimator (Abbruzzo et al., 2014) is defined as </p>
<p style="text-align: center;"><code class="reqn">\hat\psi = \arg\max_{\psi} \log det K(\psi) - tr\{Sk(\psi)\} - \rho\sum_{m=1}^Sw_m|\theta_m|,</code>
</p>
<p> where <code class="reqn">S</code> is the empirical variance/covariance matrix, <code class="reqn">\rho</code> is the tuning parameter used to control the ammount of shrinkage and <code class="reqn">w_m</code> are weights used to define the weighted <code class="reqn">\ell_1</code>-norm. By default, the <code>sglasso</code> function sets the weights equal to the cardinality of the edge colour classes.
</p>


<h3>Value</h3>

<p><code>sglasso</code> returns an obejct with S3 class <code>"sglasso"</code>, i.e. a named list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call that produced this object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nv</code></td>
<td>
<p>number of vertex colour classes;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ne</code></td>
<td>
<p>number of edge colour classes;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the matrix of the sglasso estimates. The first <code>nv</code> rows correspond to the unpenalized parameters while the remaining rows correspond to the weighted l1-penalized parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the vector of weights used to define the weighted l1-norm;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p><code>nrho</code>-dimensional vector of the number of estimated nonzero parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p><code>nrho</code>-dimensional vector of the sequence of tuning parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grd</code></td>
<td>
<p>the matrix of the scores;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstep</code></td>
<td>
<p>nonnegative integer used to specify the maximum number of iterations of the algorithms;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrho</code></td>
<td>
<p>number of tuning parameters used to compute the sglasso solution path;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>the algorithm used to fit the model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>the value used to set to zero the estimated parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a nonnegative value used to define the convergence of the algorithms;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the empirical variace/covariance matrix used to compute the sglasso solution path;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>the <code>mask</code> used to define the equality constraints on the entries of the concentration matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of interations of the algorithm;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>an integer value used to encode the warnings related to the algorihtms. If <code>conv = 0</code> the convergence has been achieved otherwise the maximum number of iterations has been achieved.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luigi Augugliaro<br> 
Maintainer: Luigi Augugliaro <a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a></p>


<h3>References</h3>

<p>Abbruzzo, A., Augugliaro, L., Mineo, A. M. and Wit, E. C. (2014) 
Cyclic coordinate for penalized Gaussian Graphical Models with symmetry restrictions. In <em>Proceeding of COMPSTAT 2014 - 21th International Conference on Computational Statistics</em>, Geneva, August 19-24, 2014.
<br></p>
<p>Hojsgaard, S. and Lauritzen, S. L. (2008)
Graphical gaussian models with edge and vertex symmetries. <em>J. Roy. Statist. Soc. Ser. B.</em>, Vol. <b>70(5)</b>, 1005â€“1027.
</p>


<h3>See Also</h3>

<p><code>summary.sglasso</code>, <code>plot.sglasso</code> <code>gplot.sglasso</code> and methods.
</p>
<p>The function <code>Kh</code> extracts the estimated sparse structured concentration matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R">########################################################
# sglasso solution path
#
## structural zeros:
## there are two ways to specify structural zeros which are 
## related to the kind of mask. If mask is a numeric matrix
## NA is used to identify the structural zero. If mask is a
## character matrix then the structural zeros are specified
## using NA or ".".
N &lt;- 100
p &lt;- 5
X &lt;- matrix(rnorm(N * p), N, p)
S &lt;- crossprod(X) / N
mask &lt;- outer(1:p, 1:p, function(i,j) 0.5^abs(i-j))
mask[1,5] &lt;- mask[1,4] &lt;- mask[2,5] &lt;- NA
mask[5,1] &lt;- mask[4,1] &lt;- mask[5,2] &lt;- NA
mask

out.sglasso_path &lt;- sglasso(S, mask, tol = 1.0e-13)
out.sglasso_path

rho &lt;- out.sglasso_path$rho[20]
out.sglasso &lt;- sglasso(S, mask, nrho = 1, min_rho = rho, tol = 1.0e-13, algorithm = "ccm")
out.sglasso

out.sglasso_path$theta[, 20]
out.sglasso$theta[, 1]
</code></pre>


</div>