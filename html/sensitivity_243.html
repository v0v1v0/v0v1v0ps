<div class="container">

<table style="width: 100%;"><tr>
<td>soboltouati</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimation of Sobol' Indices (formulas of Martinez (2011) and Touati (2016))</h2>

<h3>Description</h3>

<p><code>soboltouati</code> implements the Monte Carlo estimation of
the Sobol' indices for both first-order and total indices using 
correlation coefficients-based formulas, at a total cost of 
<code class="reqn">(p+2) \times n</code> model evaluations. 
These are called the Martinez estimators. It also computes their
confidence intervals based on asymptotic properties of empirical 
correlation coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">soboltouati(model = NULL, X1, X2, conf = 0.95, ...)
## S3 method for class 'soboltouati'
tell(x, y = NULL, return.var = NULL, ...)
## S3 method for class 'soboltouati'
print(x, ...)
## S3 method for class 'soboltouati'
plot(x, ylim = c(0, 1), ...)
## S3 method for class 'soboltouati'
ggplot(data,  mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>the first random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the second random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for confidence intervals, or zero to
avoid their computation if they are not needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"soboltouati"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"soboltouati"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.var</code></td>
<td>
<p>a vector of character strings giving further
internal variables names to store in  the output object <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This estimator supports missing values (NA or NaN) which can occur during the
simulation of the model on the design of experiments (due to code failure) 
even if Sobol' indices are no more rigorous variance-based sensitivity 
indices if missing values are present. In this case, a warning is displayed. 
</p>


<h3>Value</h3>

<p><code>soboltouati</code> returns a list of class <code>"soboltouati"</code>, 
containing all the input arguments detailed before, plus the following 
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of normalized variances of the Conditional 
Expectations (VCE) with respect to each factor and also with respect 
to the complementary set of each factor ("all but <code class="reqn">X_i</code>").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' first-order indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the estimations of the Sobol' total sensitivity indices.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Taieb Touati, Khalid Boumhaout
</p>


<h3>References</h3>

<p>J-M. Martinez, 2011, <em>Analyse de sensibilite globale par decomposition 
de la variance</em>, Presentation in the meeting of GdR Ondes and GdR MASCOT-NUM, 
January, 13th, 2011, Institut Henri Poincare, Paris, France.
</p>
<p>T. Touati, 2016, Confidence intervals for Sobol' indices. 
Proceedings of the SAMO 2016 Conference, Reunion Island, France, December 2016.
</p>
<p>T. Touati, 2017, <em>Intervalles de confiance pour les indices de Sobol</em>,
49emes Journees de la SFdS, Avignon, France, Juin 2017.
</p>


<h3>See Also</h3>

<p><code>sobol, sobol2002, sobolSalt, sobol2007, soboljansen, sobolmartinez</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case : the non-monotonic Sobol g-function

# The method of sobol requires 2 samples
# There are 8 factors, all following the uniform distribution
# on [0,1]

library(boot)
n &lt;- 1000
X1 &lt;- data.frame(matrix(runif(8 * n), nrow = n))
X2 &lt;- data.frame(matrix(runif(8 * n), nrow = n))

# sensitivity analysis

x &lt;- soboltouati(model = sobol.fun, X1, X2)
print(x)
plot(x)

library(ggplot2)
ggplot(x)
</code></pre>


</div>