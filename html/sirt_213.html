<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc.2pnoh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC Estimation of the Hierarchical IRT Model for Criterion-Referenced
Measurement
</h2>

<h3>Description</h3>

<p>This function estimates the hierarchical IRT model for criterion-referenced
measurement which is based on a two-parameter normal ogive response
function (Janssen, Tuerlinckx, Meulders &amp; de Boeck, 2000).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc.2pnoh(dat, itemgroups, prob.mastery=c(.5,.8), weights=NULL,
      burnin=500, iter=1000, N.sampvalues=1000,
      progress.iter=50, prior.variance=c(1,1), save.theta=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Data frame with dichotomous item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itemgroups</code></td>
<td>
<p>Vector with characters or integers which define the
criterion to which an item is associated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.mastery</code></td>
<td>
<p>Probability levels which define nonmastery, transition
and mastery stage (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>An optional vector with student sample weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>

<p>Number of burnin iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>Total number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.sampvalues</code></td>
<td>

<p>Maximum number of sampled values to save
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress.iter</code></td>
<td>

<p>Display progress every <code>progress.iter</code>-th iteration. If no progress
display is wanted, then choose <code>progress.iter</code> larger than <code>iter</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.variance</code></td>
<td>
<p>Scale parameter of the inverse gamma distribution
for the <code class="reqn">\sigma^2</code> and <code class="reqn">\nu^2</code> item variance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.theta</code></td>
<td>

<p>Should theta values be saved?
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hierarchical IRT model for criterion-referenced measurement
(Janssen et al., 2000) assumes that every item <code class="reqn">i</code> intends
to measure a criterion <code class="reqn">k</code>. The item response function is defined as
</p>
<p style="text-align: center;"><code class="reqn"> P(X_{pik}=1 | \theta_p )=
        \Phi [ \alpha_{ik} ( \theta_p - \beta_{ik} ) ]
        \quad,  \quad \theta_p \sim N(0,1) </code>
</p>

<p>Item parameters <code class="reqn">(\alpha_{ik},\beta_{ik})</code> are hierarchically modeled, i.e.
</p>
<p style="text-align: center;"><code class="reqn"> \beta_{ik} \sim N( \xi_k, \sigma^2 ) \quad \mbox{and} \quad
    \alpha_{ik} \sim N( \omega_k, \nu^2 ) </code>
</p>

<p>In the <code>mcmc.list</code> output object, also the derived parameters
<code class="reqn">d_{ik}=\alpha_{ik} \beta_{ik}</code> and <code class="reqn">\tau_k=\xi_k \omega_k</code> are
calculated.
Mastery and nonmastery probabilities are based on a reference item <code class="reqn">Y_{k}</code>
of criterion <code class="reqn">k</code> and a response function
</p>
<p style="text-align: center;"><code class="reqn"> P(Y_{pk}=1 | \theta_p )=
        \Phi [ \omega_{k} ( \theta_p - \xi_{k} ) ]
        \quad,  \quad \theta_p \sim N(0,1) </code>
</p>

<p>With known item parameters and person parameters, response probabilities of
criterion <code class="reqn">k</code> are calculated. If a response probability of criterion <code class="reqn">k</code>
is larger than <code>prob.mastery[2]</code>, then a student is defined as a
master. If this probability is smaller than <code>prob.mastery[1]</code>, then
a student is a nonmaster. In all other cases, students are in a transition
stage.
</p>
<p>In the <code>mcmcobj</code> output object, the parameters <code>d[i]</code> are defined by
<code class="reqn">d_{ik}=\alpha_{ik} \cdot \beta_{ik}</code> while <code>tau[k]</code> are defined by
<code class="reqn"> \tau_k=\xi_k \cdot \omega_k </code>.
</p>


<h3>Value</h3>

<p>A list of class <code>mcmc.sirt</code> with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mcmcobj</code></td>
<td>
<p>Object of class <code>mcmc.list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.mcmcobj</code></td>
<td>
<p>Summary of the <code>mcmcobj</code> object. In this
summary the Rhat statistic and the mode estimate MAP is included.
The variable <code>PercSEratio</code> indicates the proportion of the Monte Carlo
standard error in relation to the total standard deviation of the
posterior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burnin iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Total number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\alpha_{ik}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\beta_{ik}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\xi_{k}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\omega_{k}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\sigma</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\nu</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\theta_p</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance.chain</code></td>
<td>
<p>Sampled values of Deviance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EAP.rel</code></td>
<td>
<p>EAP reliability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with EAP person parameter estimates for
<code class="reqn">\theta_p</code> and their corresponding posterior standard
deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Used data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Used student weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further values</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Janssen, R., Tuerlinckx, F., Meulders, M., &amp; De Boeck, P. (2000).
A hierarchical IRT model for criterion-referenced measurement.
<em>Journal of Educational and Behavioral Statistics, 25</em>, 285-306.
</p>


<h3>See Also</h3>

<p>S3 methods: <code>summary.mcmc.sirt</code>, <code>plot.mcmc.sirt</code>
</p>
<p>The two-parameter normal ogive model can be estimated with
<code>mcmc.2pno</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Simulated data according to Janssen et al. (2000, Table 2)
#############################################################################

N &lt;- 1000
Ik &lt;- c(4,6,8,5,9,6,8,6,5)
xi.k &lt;- c( -.89, -1.13, -1.23, .06, -1.41, -.66, -1.09, .57, -2.44)
omega.k &lt;- c(.98, .91, .76, .74, .71, .80, .79, .82, .54)

# select 4 attributes
K &lt;- 4
Ik &lt;- Ik[1:K] ; xi.k &lt;- xi.k[1:K] ; omega.k &lt;- omega.k[1:K]
sig2 &lt;- 3.02
nu2 &lt;- .09
I &lt;- sum(Ik)
b &lt;- rep( xi.k, Ik ) + stats::rnorm(I, sd=sqrt(sig2) )
a &lt;- rep( omega.k, Ik ) + stats::rnorm(I, sd=sqrt(nu2) )
theta1 &lt;- stats::rnorm(N)
t1 &lt;- rep(1,N)
p1 &lt;- stats::pnorm( outer(t1,a) * ( theta1 - outer(t1,b) ) )
dat &lt;- 1  * ( p1 &gt; stats::runif(N*I)  )
itemgroups &lt;- rep( paste0("A", 1:K ), Ik )

# estimate model
mod &lt;- sirt::mcmc.2pnoh(dat, itemgroups, burnin=200, iter=1000 )
# summary
summary(mod)
# plot
plot(mod$mcmcobj, ask=TRUE)
# write coda files
mcmclist2coda( mod$mcmcobj, name="simul_2pnoh" )

## End(Not run)
</code></pre>


</div>