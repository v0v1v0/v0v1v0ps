<div class="container">

<table style="width: 100%;"><tr>
<td>cv.svyglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CV for <code>svyglm</code> objects</h2>

<h3>Description</h3>

<p>Wrapper function which takes a <code>svyglm</code> object
(which itself contains a <code>svydesign</code> object)
and passes it through <code>cv.svydesign</code> to <code>cv.svy</code>.
Chooses linear or logistic regression based on the <code>svyglm</code> object's value of <code>family</code>.
Returns survey CV estimates of the mean loss for each model
(MSE for linear models, or binary cross-entropy for logistic models).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.svyglm(glm_object, nfolds = 5, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>glm_object</code></td>
<td>
<p>Name of a <code>svyglm</code> object created from the <code>survey</code> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of folds to be used during cross validation, defaults to
5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Whether to drop cases with missing values when taking 'svymean'
of test losses</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If you have created a <code>svydesign</code> object and want to compare several <code>svyglm</code> models,
you may prefer the function <code>cv.svydesign</code>.
</p>
<p>For models other than linear or logistic regression,
you can use <code>folds.svy</code> or <code>folds.svydesign</code> to generate
CV fold IDs that respect any stratification or clustering in the survey design.
You can then carry out K-fold CV as usual,
taking care to also use the survey design features and survey weights
when fitting models in each training set
and also when evaluating models against each test set.
</p>


<h3>Value</h3>

<p>Object of class <code>svystat</code>, which is a named vector with the survey CV estimate of the mean loss
(MSE for linear models, or binary cross-entropy for logistic models)
for the model in the <code>svyglm</code> object provided to <code>glm_object</code>;
and with a <code>var</code> attribute giving the variance.
See <code>surveysummary</code> for details.
</p>


<h3>See Also</h3>

<p><code>surveysummary</code>, <code>svydesign</code>, <code>svyglm</code>
</p>
<p><code>cv.svydesign</code> to use with a <code>svydesign</code> object for comparing several <code>svyglm</code> models
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate CV MSE and its SE under one `svyglm` linear model
# for a stratified sample and a one-stage cluster sample,
# using data from the `survey` package
library(survey)
data("api", package = "survey")
# stratified sample
dstrat &lt;- svydesign(id = ~1, strata = ~stype, weights = ~pw, data = apistrat,
                    fpc = ~fpc)
glmstrat &lt;- svyglm(api00 ~ ell+meals+mobility, design = dstrat)
cv.svyglm(glmstrat, nfolds = 5)
# one-stage cluster sample
dclus1 &lt;- svydesign(id = ~dnum, weights = ~pw, data = apiclus1, fpc = ~fpc)
glmclus1 &lt;- svyglm(api00 ~ ell+meals+mobility, design = dclus1)
cv.svyglm(glmclus1, nfolds = 5)

# Calculate CV MSE and its SE under one `svyglm` linear model
# for a stratified cluster sample with clusters nested within strata
data(NSFG_data)
library(splines)
NSFG.svydes &lt;- svydesign(id = ~SECU, strata = ~strata, nest = TRUE,
                         weights = ~wgt, data = NSFG_data)
NSFG.svyglm &lt;- svyglm(income ~ ns(age, df = 3), design = NSFG.svydes)
cv.svyglm(glm_object = NSFG.svyglm, nfolds = 4)

# Logistic regression example, using the same stratified cluster sample;
# instead of CV MSE, we calculate CV binary cross-entropy loss,
# where (as with MSE) lower values indicate better fitting models
# (NOTE: na.rm=TRUE is not usually ideal;
#  it's used below purely for convenience, to keep the example short,
#  but a thorough analysis would look for better ways to handle the missing data)
NSFG.svyglm.logreg &lt;- svyglm(KnowPreg ~ ns(age, df = 2),
                             design = NSFG.svydes, family = quasibinomial())
cv.svyglm(glm_object = NSFG.svyglm.logreg, nfolds = 4, na.rm = TRUE)
</code></pre>


</div>