<div class="container">

<table style="width: 100%;"><tr>
<td>glmsmurf-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class of Multi-Type Regularized GLMs Fitted Using the SMuRF Algorithm</h2>

<h3>Description</h3>

<p>The functions <code>glmsmurf</code> and <code>glmsmurf.fit</code> return objects of the S3 class '<code>glmsmurf</code>'
which partially inherits from the '<code>glm</code>' and '<code>lm</code>' classes.
</p>


<h3>Value</h3>

<p>An object of class '<code>glmsmurf</code>' is a list with at least following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Coefficients of the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Working residuals of the estimated model, see <code>glm</code>: <code class="reqn">((y_1-\mu_1)/(d\mu/d\eta(\eta_1)), \ldots, (y_n-\mu_n)/(d\mu/d\eta(\eta_n)))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Fitted mean values of the estimated model <code class="reqn">(\mu_1, \ldots, \mu_n)=(g^{-1}(\eta_1), \ldots, g^{-1}(\eta_n))</code> with <code class="reqn">g^{-1}</code> the inverse link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>Numeric rank of the estimated model, i.e. the number of unique non-zero coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The used <code>family</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>Linear fit of the estimated model on the link scale <code class="reqn">(\eta_1, \ldots, \eta_n)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Deviance of the estimated model: minus twice the log-likelihood, up to a constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Akaike Information Criterion of the estimated model: <code class="reqn">-2\times L + 2\times rank</code> with <code class="reqn">L</code> the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion of the estimated model: <code class="reqn">-2\times L + \ln(n^*)\times rank</code> with <code class="reqn">n^*</code> the number of observations excluding those with weight 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv</code></td>
<td>
<p>Generalized Cross-Validation score of the estimated model: <code class="reqn">deviance / (n^* \times (1 - rank / n^*)^2).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.deviance</code></td>
<td>
<p>Deviance of the null model, i.e. the model with only an intercept and offset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>Residual degrees of freedom of the estimated model, i.e. the number of observations (excluding those with weight 0) minus the rank of the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.null</code></td>
<td>
<p>Residual degrees of freedom for the null model, i.e. the number of observations (excluding those with weight 0) minus the rank of the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj.fun</code></td>
<td>
<p>Value of the objective function of the estimated model: minus the regularized scaled log-likelihood of the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The prior weights that were initially supplied. 
Note that they are called <code>prior.weights</code> in the output of <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>The used offset vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The used penalty parameter: initially supplied by the user, or selected in-sample, out-of-sample or using cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>The used penalty parameter for the <code class="reqn">L_1</code>-penalty in Sparse (Generalized) Fused Lasso or 
Sparse Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>The used penalty parameter for the <code class="reqn">L_2</code>-penalty in Group (Generalized) Fused Lasso or 
Group Graph-Guided Fused Lasso is <code class="reqn">\lambda \times \lambda_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations that are performed to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>An integer code indicating whether the algorithm converged successfully:
</p>

<dl>
<dt>0</dt>
<dd>
<p>Successful convergence.</p>
</dd>
<dt>1</dt>
<dd>
<p>Maximum number of iterations reached.</p>
</dd>
<dt>2</dt>
<dd>
<p>Two subsequent restarts were performed.</p>
</dd>
<dt>3</dt>
<dd>
<p>Low step size (i.e. below 1e-14).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final.stepsize</code></td>
<td>
<p>Final step size used in the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.par.cov</code></td>
<td>
<p>List with number of parameters to estimate per predictor (covariate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.cov</code></td>
<td>
<p>List with penalty type per predictor (covariate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.cov</code></td>
<td>
<p>List with group of each predictor (covariate) for Group Lasso where 0 means no group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refcat.cov</code></td>
<td>
<p>List with number of the reference category in the original order of the levels of each predictor (covariate) where 0 indicates no reference category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The used control list, see <code>glmsmurf.control</code>.</p>
</td>
</tr>
</table>
<p>Optionally, following elements are also included:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The model matrix, only returned when the argument <code>x.return</code> in <code>glmsmurf</code> or <code>glmsmurf.fit</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector, only returned when the argument <code>y.return</code> in <code>glmsmurf</code> or <code>glmsmurf.fit</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.weights</code></td>
<td>
<p>List with the vector of penalty weights per predictor (covariate), only returned when the argument <code>pen.weights.return</code> in <code>glmsmurf</code> or <code>glmsmurf.fit</code> is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<p>When the model is re-estimated, i.e. <code>reest = TRUE</code> in <code>glmsmurf.control</code>, 
the following components are also present:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>glm.reest</code></td>
<td>
<p>Output from the call to <code>glm</code> to fit the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients.reest</code></td>
<td>
<p>Coefficients of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.reest</code></td>
<td>
<p>Working residuals of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values.reest</code></td>
<td>
<p>Fitted mean values of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.reest</code></td>
<td>
<p>Numeric rank of the re-estimated model, i.e. the number of unique non-zero re-estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors.reest</code></td>
<td>
<p>Linear fit of the re-estimated model on the link scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance.reest</code></td>
<td>
<p>Deviance of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.reest</code></td>
<td>
<p>AIC of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic.reest</code></td>
<td>
<p>BIC of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv.reest</code></td>
<td>
<p>GCV score of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual.reest</code></td>
<td>
<p>Residual degrees of freedom of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj.fun.reest</code></td>
<td>
<p>Value of the objective function of the re-estimated model: minus the regularized scaled log-likelihood of the re-estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.reest</code></td>
<td>
<p>The model matrix used in the re-estimation, only returned when the argument <code>x.return</code> in <code>glmsmurf</code> or <code>glmsmurf.fit</code> is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<p>When lambda is not given as input but selected in-sample, out-of-sample or using cross-validation, 
i.e. the <code>lambda</code> argument in <code>glmsmurf</code> or <code>glmsmurf.fit</code> is a string describing the selection method, 
the following components are also present:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambda.method</code></td>
<td>
<p>Method (in-sample, out-of-sample or cross-validation (possibly with the one standard error rule)) and measure (AIC, BIC, GCV score, deviance, MSE or DSS) used to select <code>lambda</code>.
E.g. <code>"is.bic"</code> indicates in-sample selection of lambda with the BIC as measure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.vector</code></td>
<td>
<p>Vector of <code>lambda</code> values that were considered in the selection process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.measures</code></td>
<td>
<p>List with for each of the relevant measures a matrix containing for each considered value of <code>lambda</code> (rows) 
the measure for the whole data (in-sample), for the validation data (out-of-sample) or per cross-validation fold (cross-validation) (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.coefficients</code></td>
<td>
<p>Matrix containing for each considered value of <code>lambda</code> (rows) the estimated (when <code>lambda.reest = FALSE</code> in <code>glmsmurf.control</code>)
or re-estimated (when <code>lambda.reest = TRUE</code>) coefficients when selecting lambda in-sample or out-of-sample (or using cross-validation with one fold); and <code>NULL</code> otherwise.</p>
</td>
</tr>
</table>
<p>When the object is output from <code>glmsmurf</code>, following elements are also included:   
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The supplied formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The <code>terms</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>The contrasts used (when relevant).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>The levels of the factors used in fitting (when relevant).</p>
</td>
</tr>
</table>
<h3>S3 generics</h3>

<p>Following S3 generic functions are available for an object of class "<code>glmsmurf</code>":
</p>

<dl>
<dt><code>coef</code></dt>
<dd>
<p>Extract coefficients of the estimated model.</p>
</dd>
<dt><code>coef_reest</code></dt>
<dd>
<p>Extract coefficients of the re-estimated model, when available.</p>
</dd>
<dt><code>deviance</code></dt>
<dd>
<p>Extract deviance of the estimated model.</p>
</dd>
<dt><code>deviance_reest</code></dt>
<dd>
<p>Extract deviance of the re-estimated model, when available.</p>
</dd>
<dt><code>family</code></dt>
<dd>
<p>Extract family object.</p>
</dd>
<dt><code>fitted</code></dt>
<dd>
<p>Extract fitted values of the estimated model.</p>
</dd>
<dt><code>fitted_reest</code></dt>
<dd>
<p>Extract fitted values of the re-estimated model, when available.</p>
</dd>   
<dt><code>plot</code></dt>
<dd>
<p>Plot coefficients of the estimated model.</p>
</dd> 
<dt><code>plot_reest</code></dt>
<dd>
<p>Plot coefficients of the re-estimated model, when available.</p>
</dd> 
<dt><code>plot_lambda</code></dt>
<dd>
<p>Plot goodness-of-fit statistics or information criteria
as a function of lambda, when lambda is selected in-sample, out-of-sample or 
using cross-validation.</p>
</dd> 
<dt><code>predict</code></dt>
<dd>
<p>Obtain predictions using the estimated model.</p>
</dd>
<dt><code>predict_reest</code></dt>
<dd>
<p>Obtain predictions using the re-estimated model, when available.</p>
</dd>   
<dt><code>residuals</code></dt>
<dd>
<p>Extract residuals of the estimated model.</p>
</dd> 
<dt><code>residuals_reest</code></dt>
<dd>
<p>Extract residuals of the re-estimated model, when available.</p>
</dd> 
<dt><code>summary</code></dt>
<dd>
<p>Print a summary of the estimated model, and of the re-estimated model (when available).</p>
</dd>    
</dl>
<h3>See Also</h3>

<p><code>glmsmurf</code>, <code>glm</code>, <code>lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See example(glmsmurf) for examples

</code></pre>


</div>