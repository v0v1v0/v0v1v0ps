<div class="container">

<table style="width: 100%;"><tr>
<td>matrix-op</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>vech, tr and other matrix operators</h2>

<h3>Description</h3>

<p>vech and other matrix operators</p>


<h3>Usage</h3>

<pre><code class="language-R">vech(A)
vech2mat(v)
duplicationMatrix(n)
tr(x)
blockDiag(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a (symmetric) square numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>a numeric vector such that <code>length(v)=n*(n+1)/2</code> for some
positive integer <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer number; default is <code>n=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a square numeric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>an abitrary numer of matrices or objects coercible into matrices.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector in case of <code>vech</code>, a scalar in case of <code>tr</code>, 
otherwise a matrix.</p>


<h3>Details</h3>


<p>For a  square matrix <code>A</code>, <code>vech(A)</code> returns the vector formed
by the lower triangular portion of the matrix, including the diagonal; 
usually, this only makes sense for a symmetric matrix of numeric values. 
If <code>v=vech(M)</code> where <code>M</code> is a symmetric numeric matrix, 
<code>vech2mat(v)</code> performs the inverse operation and returns the original 
matrix <code>M</code>; this explain the requirement on <code>length(v)</code>.
</p>
<p>For a positive integer <code>n</code>, <code>D=duplicationMatrix(n)</code> is a matrix 
of dimension <code>(n^2, n*(n+1)/2)</code> such that <code>D %*% vech(M)</code> returns 
the <code>vec</code>-form of a symmetric matrix <code>M</code> of 
order <code>n</code>, that is, the vector which stacks the columns of <code>M</code>;
for more information, see Section 3.8 of Magnus and Neudecker (1988). 
</p>
<p>For a square numeric matrix <code>x</code>, <code>tr(x)</code> returns its trace.
</p>
<p><code>blockDiag(...)</code> creates a block-diagonal matrix from a set of matrices 
or objects coercible into matrices. Generally, this is useful only for
numeric objects.
</p>


<h3>Author</h3>

<p>Adelchi Azzalini; 
the original Octave code of <code>duplicationMatrix</code> is by Kurt Hornik.</p>


<h3>References</h3>

<p>Magnus, Jan R. and Neudecker, Heinz (1988). <em>Matrix differential
calculus with application in statistics and econometrics</em>. 
Wiley series in probability and statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- toeplitz(1:4)
v &lt;- vech(M)
vech2mat(v) - M
D &lt;- duplicationMatrix(ncol(M))
# D %*% vech(M) - as.vector(M), must be a one-column matrix of 0s
tr(outer(1:4,2:5))
blockDiag(M[1:2,], 1:2, diag(5:6))
</code></pre>


</div>