<div class="container">

<table style="width: 100%;"><tr>
<td>Map_Invalsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display a map of Invalsi scores</h2>

<h3>Description</h3>

<p>This function displays either a static or interactive map of the Invalsi scores, either at the municipality or province level.
It supports two kinds of map:
</p>

<ul>
<li>
<p> Interactive map (default option), which allows the user to visualize all the data in scope through the interactive popup, and
</p>
</li>
<li>
<p> Static map (ggplot), which can be easily exported in <code>.pdf</code> objects.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">Map_Invalsi(
  data = NULL,
  Year = 2023,
  subj_toplot = "ITA",
  grade = 8,
  level = "LAU",
  main = "",
  main_pos = "top",
  region_code = c(1:20),
  plot = "mapview",
  pal = "Blues",
  WLE = FALSE,
  col_rev = FALSE,
  popup_height = 200,
  verbose = TRUE,
  input_shp = NULL,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The raw Invalsi survey data that has to be filtered, obtained as output of the <code>Get_Invalsi_IS</code> function.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Year</code></td>
<td>
<p>Numeric or character value. Reference school year for the data (last available is 2022/23).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022</code>. <code>2022</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subj_toplot</code></td>
<td>
<p>Character. The school subject to display in the map,
The school subject to include, one among:
<code>"Englis_listening"</code>/<code>"ELI"</code>, <code>"English_reading"</code>/<code>"ERE"</code>, <code>"Italian"</code>/<code>"ITA"</code> and <code>"Mathematics"</code>/<code>"MAT"</code>. <code>"ITA"</code> (Italian) by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grade</code></td>
<td>
<p>Numeric. The school grade to chose. Either <code>2</code> (2nd year of primary school), <code>5</code> (last year of primary school), <code>8</code> (last year of middle shcool), <code>10</code> (2nd year of high school) or <code>13</code> (last year of school). <code>8</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Character. The level of aggregation of Invalsi census data. Either <code>"NUTS-3"</code>, <code>"Province"</code>, <code>"LAU"</code>, <code>"Municipality"</code>.
If an input dataframe is provided, please select the same level of aggregation.
<code>"LAU"</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Character. A customary title to the map. If <code>NULL</code>, the title will mention: subject, year and school grade. Empty by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_pos</code></td>
<td>
<p>Character.Where the header should be placed if the <code>ggplot</code> mode is chosen.
The header is located on the top if <code>"top"</code> is given as input, and above the legend scale otherwise. <code>"top"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region_code</code></td>
<td>
<p>Numeric. The NUTS-2 codes of the units that must be displayed.
If the level is set to <code>"LAU"</code>, choosing a limited number of regions is recommended.
By default, <code>c(1,3,5:20)</code>, i.e. all Italian regions except the provinces of Aosta, Trento and Bozen which have data availability issues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Character. The type of map to display; either <code>"mapview"</code> for interactive maps, or <code>"ggplot"</code> for static maps. <code>"mapview"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pal</code></td>
<td>
<p>Character. The palette to use if the <code>"mapview"</code> mode is chose. <code>"Blues"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WLE</code></td>
<td>
<p>Logical. Whether the variable to chose should be the average WLE score rather that the percentage of sufficient tests, if both are available. <code>FALSE</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_rev</code></td>
<td>
<p>Logical. Whether the scale of the colour palette should be reverted or not, if the <code>mapview</code> mode is chosen. <code>FALSE</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popup_height</code></td>
<td>
<p>Numeric. The height of the popup table in terms of pixels if the <code>"mapview"</code> mode is chosen. <code>200</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>. The relevant shapefiles of Italian administrative boudaries,
at the selected level of detail (LAU or NUTS-3). If <code>NULL</code>, it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>plot == "mapview"</code>, an object of class <code>mapview</code>. Otherwise, if <code>plot == "ggplot"</code>, an object of class <code>gg</code> and <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">



 Map_Invalsi(subj = "Italian", grade = 13, level = "NUTS-3", Year = 2023, WLE = FALSE,
  data = example_Invalsi23_prov, input_shp = example_Prov22_shp, plot = "ggplot")

 Map_Invalsi(subj = "Italian", grade = 5, level = "NUTS-3", Year = 2023, WLE = TRUE,
  data = example_Invalsi23_prov, input_shp = example_Prov22_shp, plot = "ggplot")





</code></pre>


</div>