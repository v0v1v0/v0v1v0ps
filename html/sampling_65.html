<div class="container">

<table style="width: 100%;"><tr>
<td>vartaylor_ratio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Taylor-series linearization variance estimation of a ratio</h2>

<h3>Description</h3>

<p>Computes the Taylor-series linearization variance estimation of the ratio </p>
<p style="text-align: center;"><code class="reqn">\frac{\widehat{Y}_s}{\widehat{X}_s}.</code>
</p>
 
<p>The estimators in the ratio are Horvitz-Thompson type estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vartaylor_ratio(Ys,Xs,pikls)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>vector of the first observed variable; its length is equal to n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p>vector of the second observed variable; its length is equal to n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikls</code></td>
<td>
<p>matrix of joint inclusion probabilities of the sample units; its dimension is nxn.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function implements the following estimator:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Var}(\frac{\widehat{Ys}}{\widehat{Xs}})=\sum_{i\in s}\sum_{j\in s}\frac{\pi_{ij}-\pi_i\pi_j}{\pi_{ij}}\frac{\widehat{z_i}\widehat{z_j}}{\pi_i\pi_j}</code>
</p>
 
<p>where <code class="reqn">\widehat{z_i}=(Ys_i-\widehat{r}Xs_i)/\widehat{X}_s, \widehat{r}=\widehat{Y}_s/\widehat{X}_s, \widehat{Y}_s=\sum_{i\in s}{Ys_i/\pi_i}, \widehat{X}_s=\sum_{i\in s}{Xs_i/\pi_i}</code>.
</p>


<h3>References</h3>

 
<p>Woodruff, R. (1971). <em>A Simple Method for Approximating the Variance of a Complicated Estimate</em>, Journal of the American Statistical Association, Vol. 66,  No. 334 , pp. 411â€“414.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(belgianmunicipalities)
attach(belgianmunicipalities)
# inclusion probabilities, sample size 200
pik=inclusionprobabilities(Tot04,200)
# the first variable (population level)
Y=Men04
# the second variable (population level)
X=Women04
# population size
N=length(pik)             
# joint inclusion probabilities for Poisson sampling
pikl=outer(pik,pik,"*")
diag(pikl)=pik
# draw a sample using Poisson sampling 
s=UPpoisson(pik)           
# sample inclusion probabilities
piks=pik[s==1]            
# the first observed variable (sample level)  
Ys=Y[s==1]
# the second observed variable (sample level)  
Xs=X[s==1]              
# matrix of joint inclusion prob. (sample level)          
pikls=pikl[s==1,s==1] 
# ratio estimator and its estimated variance
vartaylor_ratio(Ys,Xs,pikls)
</code></pre>


</div>