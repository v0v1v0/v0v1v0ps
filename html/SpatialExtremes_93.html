<div class="container">

<table style="width: 100%;"><tr>
<td>rmaxlin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation from max-linear models</h2>

<h3>Description</h3>

<p>This function generates realisations from a max-linear
model.</p>


<h3>Usage</h3>

<pre><code class="language-R">rmaxlin(n, coord, cov.mod = "gauss", dsgn.mat, grid = FALSE, p = 500,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A vector or matrix that gives the coordinates of each
location. Each row corresponds to one location - if any. May be
missing if <code>dsgn.mat</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string that specifies the max-linear
model. Currently only the discretized Smith model is implemented,
i.e., <code>cov.mod = "gauss"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsgn.mat</code></td>
<td>
<p>The design matrix of the max-linear model — see
Section Details. May be missing if <code>coord</code> and <code>cov.mod</code>
are given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical. Does <code>coord</code> defines a grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An integer corresponding to the number of unit Frechet random
variable used in the max-linear model — see Section Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The parameters of the max-stable model — see Section
Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A max-linear process <code class="reqn">\{Y(x)\}</code> is defined by
</p>
<p style="text-align: center;"><code class="reqn">Y(x) = \max_{j=1, \ldots, p} f_j(x) Z_j, \qquad x \in
    R^d,</code>
</p>

<p>where <code class="reqn">p</code> is a positive integer, <code class="reqn">f_j</code> are non
negative functions and <code class="reqn">Z_j</code> are independent unit Frechet
random variables. Most often, the max-linear process will be generated
at locations <code class="reqn">x_1, \ldots, x_k \in R^d</code> and an alternative but equivalent formulation is
</p>
<p style="text-align: center;"><code class="reqn">\bf{Y} = A \odot \bf{Z},</code>
</p>
<p> where <code class="reqn">\mathbf{Y} =
    \{Y(x_1), \ldots, Y(x_k)\}</code>,
<code class="reqn">\mathbf{Z} = (Z_1, \ldots, Z_p)</code>,
<code class="reqn">\odot</code> is the max-linear operator, see the first equation, and
<code class="reqn">A</code> is the design matrix of the max-linear model. The design
matrix <code class="reqn">A</code> is a <code class="reqn">k \times p</code> matrix with non
negative entries and whose <code class="reqn">i</code>-th row is <code class="reqn">\{f_1(x_i),
    \ldots, f_p(x_i)\}</code>.
</p>
<p>Currently only the discretized Smith model is implemented for which
<code class="reqn">f_j(x) = c(p) \varphi(x - u_j ; \Sigma)</code> where <code class="reqn">\varphi(\cdot; \Sigma)</code> is the
zero mean (multivariate) normal density with covariance matrix
<code class="reqn">\Sigma</code>, <code class="reqn">u_j</code> is a sequence of deterministic
points appropriately chosen and <code class="reqn">c(p)</code> is a constant
ensuring unit Frechet margins. Hence if this max-linear model is used,
users must specify <code>var</code> for one dimensional processes, and
<code>cov11</code>, <code>cov12</code>, <code>cov22</code> for two dimensional
processes.
</p>


<h3>Value</h3>

<p>A matrix containing observations from the max-linear model. Each
column represents one stations. If <code>grid = TRUE</code>, the function
returns an array of dimension nrow(coord) x nrow(coord) x n.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Wang, Y. and Stoev, S. A. (2011) Conditional Sampling for Max-Stable
Random Fields. <em>Advances in Applied Probability</em>.
</p>


<h3>See Also</h3>

<p><code>condrmaxlin</code>, <code>rmaxstab</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## A one dimensional simulation from a design matrix. This design matrix
## corresponds to a max-moving average process MMA(alpha)
n.site &lt;- 250
x &lt;- seq(-10, 10, length = n.site)

## Build the design matrix
alpha &lt;- 0.8
dsgn.mat &lt;- matrix(0, n.site, n.site)
dsgn.mat[1,1] &lt;- 1

for (i in 2:n.site){
dsgn.mat[i,1:(i-1)] &lt;- alpha * dsgn.mat[i-1,1:(i-1)]
dsgn.mat[i,i] &lt;- 1 - alpha
}

data &lt;- rmaxlin(3, dsgn.mat = dsgn.mat)
matplot(x, t(log(data)), pch = 1, type = "l", lty = 1, ylab =
expression(log(Y(x))))

## One realisation from the discretized Smith model (2d sim)
x &lt;- y &lt;- seq(-10, 10, length = 100)
data &lt;- rmaxlin(1, cbind(x, y), cov11 = 3, cov12 = 1, cov22 = 4, grid =
TRUE, p = 2000)
image(x, y, log(data), col = heat.colors(64))
</code></pre>


</div>