<div class="container">

<table style="width: 100%;"><tr>
<td>crossvalidation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform cross validation to select the regularization parameter.</h2>

<h3>Description</h3>

<p>Perform cross validation to select the regularization parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crossvalidation(auxfun, X, y, param, K = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>auxfun</code></td>
<td>
<p>A complete fitting function which takes as arguments a data matrix <code class="reqn">X</code>, a response vector <code class="reqn">y</code>, and some parameter <code class="reqn">p</code> (to be tuned), and returns the estimator (<code class="reqn">betavector</code>) (minimizer) of the regression operator under investigation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A vector of regularization parameters which are to be evaluated via cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of folds for cross validation (should divide the number of rows of <code class="reqn">X</code>). The default is <code class="reqn">10</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of average errors over all folds. The entries in the returned vector correspond to the entries in the vector <code class="reqn">param</code> in the same order.
</p>


<h3>References</h3>

<p>Hahn, G., Lutz, S., Laha, N., and Lange, C. (2020). A framework to efficiently smooth L1 penalties for linear regression. bioRxiv:2020.09.17.301788.
</p>
<p>Tibshirani, R. (2013). Model selection and validation 1: Cross-validation. https://www.stat.cmu.edu/~ryantibs/datamining/lectures/18-val1.pdf
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(smoothedLasso)
n &lt;- 1000
p &lt;- 100
betavector &lt;- runif(p)
X &lt;- matrix(runif(n*p),nrow=n,ncol=p)
y &lt;- X %*% betavector
auxfun &lt;- function(X,y,lambda) {
		temp &lt;- standardLasso(X,y,lambda)
	obj &lt;- function(z) objFunction(z,temp$u,temp$v,temp$w)
		objgrad &lt;- function(z) objFunctionGradient(z,temp$w,temp$du,temp$dv,temp$dw)
	return(minimizeFunction(p,obj,objgrad))
}
lambdaVector &lt;- seq(0,1,by=0.1)
print(crossvalidation(auxfun,X,y,lambdaVector,10))

</code></pre>


</div>