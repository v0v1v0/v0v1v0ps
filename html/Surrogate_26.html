<div class="container">

<table style="width: 100%;"><tr>
<td>fit_copula_model_BinCont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit copula model for binary true endpoint and continuous surrogate endpoint</h2>

<h3>Description</h3>

<p>The function <code>fit_copula_model_BinCont()</code> fits the copula model for a
continuous surrogate endpoint and binary true endpoint. Because the bivariate
distributions of the surrogate-true endpoint pairs are functionally
independent across treatment groups, a bivariate distribution is fitted in
each treatment group separately.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_copula_model_BinCont(
  data,
  copula_family,
  marginal_surrogate,
  marginal_surrogate_estimator = NULL,
  twostep = FALSE,
  fitted_model = NULL,
  maxit = 500,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame in the correct format (See details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula_family</code></td>
<td>
<p>One of the following parametric copula families:
<code>"clayton"</code>, <code>"frank"</code>, <code>"gaussian"</code>, or <code>"gumbel"</code>. The first element in
<code>copula_family</code> corresponds to the control group, the second to the
experimental group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_surrogate</code></td>
<td>
<p>Marginal distribution for the surrogate. For all
available options, see <code>?Surrogate::cdf_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_surrogate_estimator</code></td>
<td>
<p>Not yet implemented</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twostep</code></td>
<td>
<p>(boolean) if <code>TRUE</code>, the two step estimator implemented in
<code>twostep_BinCont()</code> is used for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_model</code></td>
<td>
<p>Fitted model from which initial values are extracted. If
<code>NULL</code> (default), standard initial values are used. This option intended
for when a model is repeatedly fitted, e.g., in a bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations for the numeric optimization,
defaults to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>WIP
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load Schizophrenia data set.
data("Schizo_BinCont")
# Perform listwise deletion.
na = is.na(Schizo_BinCont$CGI_Bin) | is.na(Schizo_BinCont$PANSS)
X = Schizo_BinCont$PANSS[!na]
Y = Schizo_BinCont$CGI_Bin[!na]
Treat = Schizo_BinCont$Treat[!na]
# Ensure that the treatment variable is binary.
Treat = ifelse(Treat == 1, 1, 0)
data = data.frame(X,
                  Y,
                  Treat)
# Fit copula model.
fitted_model = fit_copula_model_BinCont(data, "clayton", "normal", twostep = FALSE)
# Perform sensitivity analysis with a very low number of replications.
sens_results = sensitivity_analysis_BinCont_copula(
  fitted_model,
  10,
  lower = c(-1,-1,-1,-1),
  upper = c(1, 1, 1, 1),
  n_prec = 1e3
)

</code></pre>


</div>