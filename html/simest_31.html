<div class="container">

<table style="width: 100%;"><tr>
<td>simestgcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Single Index Model Estimation: Objective Function Approach.
</h2>

<h3>Description</h3>

<p>This function provides an estimate of the non-parametric function and the index vector by minimizing an objective function specified by the method argument and also by choosing tuning parameter using GCV.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simestgcv(x, y, w = NULL, beta.init = NULL, nmulti = NULL,
                lambda = NULL, maxit = 100, bin.tol = 1e-06, 
                beta.tol = 1e-05, agcv.iter = 100, progress = TRUE)

## Default S3 method:
simestgcv(x, y, w = NULL, beta.init = NULL, nmulti = NULL,
            lambda = NULL, maxit = 100, bin.tol = 1e-06, 
            beta.tol = 1e-05, agcv.iter = 100, progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix giving the values of the predictor variables or covariates. For functions plot and print, ‘x’ is an object of class ‘sim.est’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector giving the values of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a numeric vector giving lower and upper bounds for penalty used in <code>cvx.pen</code> and <code>cvx.lip</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an optional numeric vector of the same length as <code class="reqn">x</code>; Defaults to all 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.init</code></td>
<td>
<p>An numeric vector giving the initial value for the index vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmulti</code></td>
<td>
<p>An integer giving the number of multiple starts to be used for iterative algorithm. If beta.init is provided then the nmulti is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agcv.iter</code></td>
<td>
<p>An integer providing the number of random numbers to be used in estimating GCV. See <code>smooth.pen.reg</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>A logical denoting if progress of the algorithm to be printed. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.tol</code></td>
<td>
<p>A tolerance level upto which the x values used in regression are recognized as distinct values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.tol</code></td>
<td>
<p>A tolerance level for stopping iterative algorithm for the index vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>An integer specifying the maximum number of iterations for each initial <code class="reqn">\beta</code> vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function minimizes 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^n w_i(y_i - f(x_i^{\top}\beta))^2 + \lambda\int\{f''(x)\}^2dx</code>
</p>

<p>with no constraints on f. The penalty parameter <code class="reqn">\lambda</code> is choosen by the GCV criterion between the bounds given by <code>lambda</code>. Plot and predict function work as in the case of <code>sim.est</code> function.
</p>


<h3>Value</h3>

<p>An object of class ‘sim.est’, basically a list including the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A numeric vector storing the estimate of the index vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmulti</code></td>
<td>
<p>Number of multistarts used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.mat</code></td>
<td>
<p>the input ‘x’ matrix with possibly aggregated rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaInit</code></td>
<td>
<p>a matrix storing the initial vectors taken or given for the index parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Given input <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer storing the row index of <code>BetaInit</code> which lead to the estimator <code>beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaPath</code></td>
<td>
<p>a list containing the paths taken by each initial index vector for nmulti times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObjValPath</code></td>
<td>
<p>a matrix with nmulti rows storing the path of objective function value for multiple starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a numeric storing convergence status for the index parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itervec</code></td>
<td>
<p>a vector of length nmulti storing the number of iterations taken by each of the multiple starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>a numeric giving the total number of iterations taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method is always set to "smooth.pen.reg".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regress</code></td>
<td>
<p>An output of the regression function used needed for predict.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.values</code></td>
<td>
<p>sorted ‘x.betahat’ values obtained by the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.values</code></td>
<td>
<p>corresponding ‘y’ values in input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.values</code></td>
<td>
<p>corresponding fit values of same length as that of <code class="reqn">x\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>corresponding values of the derivative of same length as that of <code class="reqn">x\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals obtained from the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvalue</code></td>
<td>
<p>minimum value of the objective function attained.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arun Kumar Kuchibhotla, arunku@wharton.upenn.edu</p>


<h3>Source</h3>

<p>Kuchibhotla, A. K., Patra, R. K. and Sen, B. (2015+). On Single Index Models with Convex Link.
</p>


<h3>Examples</h3>

<pre><code class="language-R">args(sim.est)
x &lt;- matrix(runif(20*2,-1,1),ncol = 2)
b0 &lt;- rep_len(1,2)/sqrt(2)
y &lt;- (x%*%b0)^2 + rnorm(20,0,0.3)
tmp2 &lt;- simestgcv(x, y, lambda = c(20^{1/6}, 20^{1/4}), nmulti = 1, 
					agcv.iter = 10, maxit = 10, beta.tol = 1e-03)
print(tmp2)
plot(tmp2)
predict(tmp2, newdata = c(0,0))
</code></pre>


</div>