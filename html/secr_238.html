<div class="container">

<table style="width: 100%;"><tr>
<td>contour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contour Detection Probability</h2>

<h3>Description</h3>

<p>Display contours of the net probability of detection p.(X), or the
area within a specified distance of detectors.  <code>bufferContour</code>
adds a conventional ‘boundary strip’ to a detector (trap) array, where
<code>buffer</code> equals the strip width.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
pdotContour(traps, border = NULL, nx = 64, detectfn = 0,
    detectpar = list(g0 = 0.2, sigma = 25, z = 1), noccasions = NULL,
    binomN = NULL, levels = seq(0.1, 0.9, 0.1), poly =
    NULL, poly.habitat = TRUE, plt = TRUE, add = FALSE, fill = NULL, ...)

bufferContour(traps, buffer, nx = 64, convex = FALSE, ntheta = 100,
     plt = TRUE, add = FALSE, poly = NULL, poly.habitat = TRUE, 
     fill = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>traps</code></td>
<td>
 <p><code>traps</code> object (or mask for <code>bufferContour</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p> width of blank margin around the outermost detectors </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p> dimension of interpolation grid in x-direction </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectfn</code></td>
<td>
<p> integer code or character string for shape of
detection function 0 = halfnormal etc. – see detectfn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectpar</code></td>
<td>
<p> list of values for named parameters of detection
function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noccasions</code></td>
<td>
<p> number of sampling occasions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binomN</code></td>
<td>
<p> integer code for discrete distribution (see
<code>secr.fit</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p> vector of levels for p.(X)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly</code></td>
<td>
<p> matrix of two columns, the x and y
coordinates of a bounding polygon (optional) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly.habitat</code></td>
<td>
<p> logical as in <code>make.mask</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p> logical to plot contours </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p> logical to add contour(s) to an existing plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p> vector of colours to fill contours (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other arguments to pass to <code>contour</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p> vector of buffer widths </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convex</code></td>
<td>
<p> logical, if TRUE the plotted contour(s) will be convex </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntheta</code></td>
<td>
<p> integer value for smoothness of convex contours </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pdotContour</code> constructs a rectangular mask and applies <code>pdot</code> to
compute the p.(X) at each mask point.
</p>
<p>If <code>convex = FALSE</code>, <code>bufferContour</code> constructs a mask and
contours the points on the basis of distance to the nearest detector at the
levels given in <code>buffer</code>.
</p>
<p>If <code>convex = TRUE</code>, <code>bufferContour</code> constructs a set of
potential vertices by adding points on a circle of radius =
<code>buffer</code> to each detector location; the desired contour is the
convex hull of these points (this algorithm derives from Efford, 2012).
</p>
<p>If <code>traps</code> has a usage attribute then <code>noccasions</code> is
set accordingly; otherwise it must be provided.
</p>
<p>If <code>traps</code> is for multiple sessions then detectpar should be a list
of the same length, one component per session, and noccasions may be a
numeric vector of the same length.
</p>
<p>Increase <code>nx</code> for smoother lines, at the expense of speed.
</p>


<h3>Value</h3>

<p>Coordinates of the plotted contours are returned as a list with one
component per polygon. The list is returned invisibly if <code>plt =
    TRUE</code>.
</p>
<p>For multi-session input (<code>traps</code>) the value is a list of such
lists, one per session.
</p>


<h3>Note</h3>

<p>The precision (smoothness) of the fitted line in <code>bufferContour</code>
is controlled by <code>ntheta</code> rather than <code>nx</code> when <code>convex
    = TRUE</code>.
</p>
<p>To suppress contour labels, include the argument <code>drawlabels =
  FALSE</code> (this will be passed via ... to <code>contour</code>). Other useful
arguments of <code>contour</code> are <code>col</code> (colour of contour lines)
and <code>lwd</code> (line width).
</p>
<p>You may wish to consider function st_buffer in package <span class="pkg">sf</span> as an
alternative to <code>bufferContour</code>.
</p>
<p><code>bufferContour</code> failed with multi-session <code>traps</code> before
<span class="pkg">secr</span> 2.8.0.
</p>


<h3>References</h3>

<p>Efford, M. G. (2012) <em>DENSITY 5.0: software for spatially
explicit capture–recapture</em>. Department of Mathematics and Statistics,
University of Otago, Dunedin, New Zealand
<a href="https://www.otago.ac.nz/density/">https://www.otago.ac.nz/density/</a>.
</p>


<h3>See Also</h3>

<p><code>pdot</code>, <code>make.mask</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
possumtraps &lt;- traps(possumCH)

## convex and concave buffers
plot(possumtraps, border = 270)
bufferContour(possumtraps, buffer = 100, add = TRUE, col = "blue")
bufferContour(possumtraps, buffer = 100, convex = TRUE, add = TRUE)

## areas
buff.concave &lt;- bufferContour(possumtraps, buffer = 100,
    plt = FALSE)
buff.convex  &lt;- bufferContour(possumtraps, buffer = 100,
    plt = FALSE, convex = TRUE)
sum (sapply(buff.concave, polyarea)) ## sum over parts
sapply(buff.convex, polyarea)

## effect of nx on area
buff.concave2 &lt;- bufferContour(possumtraps, buffer = 100,
    nx = 128, plt = FALSE)
sum (sapply(buff.concave2, polyarea))

## Not run: 

plot(possumtraps, border = 270)
pdotContour(possumtraps, detectfn = 0, nx = 128, detectpar =
    detectpar(possum.model.0), levels = c(0.1, 0.01, 0.001),
    noccasions = 5, add = TRUE)

## clipping to polygon
olddir &lt;- setwd(system.file("extdata", package = "secr"))
possumtraps &lt;- traps(possumCH)
possumarea &lt;- read.table("possumarea.txt", header = TRUE)
par(xpd = TRUE, mar = c(1,6,6,6))
plot(possumtraps, border = 400, gridlines = FALSE)
pdotContour(possumtraps, detectfn = 0, nx = 256, detectpar =
    detectpar(possum.model.0), levels = c(0.1, 0.01, 0.001),
    noccasions = 5, add = TRUE, poly = possumarea, col = "blue")
lines(possumarea)
setwd(olddir)
par(xpd = FALSE, mar = c(5,4,4,2) + 0.1)    ## reset to default


## End(Not run)

</code></pre>


</div>