<div class="container">

<table style="width: 100%;"><tr>
<td>siland</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of landscape influence using siland method (Spatial Influence Function)
</h2>

<h3>Description</h3>

<p>Function estimating landscape effect (and eventual local effects) using siland method, i.e. estimating simultaneously : the SIF parameter (i.e. mean distance of SIF) and the effect of each landscape variable (and the effect of each local variable).
</p>


<h3>Usage</h3>

<pre><code class="language-R">siland(formula,land,data,family ="gaussian",sif="exponential", init = 100,
 border=F,wd=50,maxD=3000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a symbolic description (see lm() or glm()) of the model to be fitted. The details of model specification are given under 'Details'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>land</code></td>
<td>

<p>an object of class sf containing the landscape variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a dataframe containing the response variable and the local variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>the distribution of response variable. <code>family</code> can be "gaussian", "poisson" or "binomial" and the associated link function are identity, log and logit respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sif</code></td>
<td>

<p>the family of the Spatial Influence Function. <code>sif</code> can be "exponential", "gaussian" or "uniform".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>a vector indicating the starting values for SIF parameters in the estimation procedure. By default, starting values of SIF parameters of all landscape variable are equal to 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>

<p>a logical indicating wether the spatial influence of the polygon where observations are located is taken into account.
If <code>border=FALSE</code>, all pixels of a landscape variable have a spatial influence whether or not they belong to the polygon where the observation is located. If <code>border=TRUE</code>, only pixels outside the polygon of the observation, i.e. from the border of the polygon have an influence on this observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wd</code></td>
<td>

<p>a numeric, the size of pixels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxD</code></td>
<td>

<p>a numeric, give the maximum distance used to evaluate the influence of pixel on each observation. It is recommanded that maxD is greater than three times the greatest SIF value.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The siland method is based on the model:
</p>
<p style="text-align: center;"><code class="reqn"> E(Y_i)= \mu + \sum_l \alpha_l x_{l,i}+ \sum_k \beta_k (\sum_r f_{\delta_k}(d_{r,i})z^k_r) </code>
</p>

<p>with
</p>

<ul>
<li>
<p> Y_i, response variable,
</p>
</li>
<li>
<p> x_l,i, local variable l,
</p>
</li>
<li>
<p> r, the discritzation of study site in pixels r
</p>
</li>
<li>
<p> z^k_r, the value of the landscape variable k at the pixel r. If the landscape variable k is a presence/absence variable, z^k_r is equal to one or zero.
</p>
</li>
<li> <p><code class="reqn">\mu</code>, the intercept
</p>
</li>
<li> <p><code class="reqn">\alpha_l</code> and <code class="reqn">\beta_k</code>, the effects of local and landscape variables, respectively.
</p>
</li>
<li> <p><code class="reqn">f_{\delta_k}</code>,the SIF associated with the landscape variable k with parameter <code class="reqn">\delta_k</code> (the mean distance of the SIF, see detail further)
</p>
</li>
<li>
<p> d_r,i the distance between the center of pixel r and the observation at site i.
</p>
</li>
</ul>
<p>All parameters, <code class="reqn">\mu</code>, <code class="reqn"> {\alpha_1,\dots,\alpha_L}</code>, <code class="reqn"> {\beta_1,\dots,\beta_K}</code>  but also <code class="reqn"> {\delta_1,\dots,\delta_K}</code> SIF parameters of the landscape variables are simultaneously estimated by likelihood maximization.
</p>
<p>Models for <var>siland</var> have the form <code>response ~ terms</code>  where <code>response</code> is the columns name of the response variable in <code>data</code> and <code>terms</code> is a series of terms which specifies the names of landscape and local explanatory variables. The explanatory variables described in <code>data</code> are considered as local in the model, those described in the sf object <code>land</code> are considered as landscape variables.
</p>
<p>For local variables, random effects can be considered using the syntax <code>(1|x)</code> similar to package lme4 (see lmer() function in package lme4). Interaction terms are not yet implemented in <code>siland</code> contrary to <code>Bsiland</code>.
</p>
<p>The explanatory variables are added using the symbol <code>"+"</code>. Interaction terms can be considered using the usual symbols  <code>"*"</code> or  <code>":"</code>. Notice that only interactions between local x local and local x landscape variables are considered.
</p>
<p>Two families of SIF are currently implemented in the siland package, exponential and Gaussian families defined as  <code class="reqn">f_\delta(d)=2/(\pi\delta^2)exp(-2d/\delta)</code> and  <code class="reqn">f\delta(d)=1/(2\delta \sqrt \pi)exp(-d\pi/(2\delta))^2</code>, respectively. By definition,  <code class="reqn">\delta</code> represents the mean distance of these SIF.
</p>
<p>The computation of the spatial influence of landscape variables is based on an approximation through the description of landscape variables distribution along a regular grid (modelisation of spatial influence of each pixel of landscape variable). The choice of <code>wd</code>, the size of pixels can have an impact on the estimation. The smaller the pixels, the more accurate the approximation, but also the longer the computation time. In our experience, we recommend using a pixel size at most three times smaller than the smallest estimated mean distance among the landscape variables SIF.
</p>


<h3>Value</h3>

<p>siland returns an object of type siland, a list :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramSIF</code></td>
<td>
<p>a vector of the estimated parameters of SIF</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class formula that indicates the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>landcontri</code></td>
<td>
<p>a dataframe of estimated cumulative influence of each landscape variable (in columns) on each observation (in rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the estimated maximum loglikelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik0</code></td>
<td>
<p>the estimated maximum loglikelihood of the local model (no landscape variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>a lm/glm/lmer object that corresponds to the model estimate knowing the estimated SIF parameters of landscape variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>the fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sif</code></td>
<td>
<p>the family of the SIF</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resoptim</code></td>
<td>
<p>an object of class optim or optimize giving informations about the optimization procedure see optim() or optimize() for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>the akaike information criterion of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC0</code></td>
<td>
<p>the akaike information criterion of the local model (no landscape variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nparam</code></td>
<td>
<p>the number of parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval0</code></td>
<td>
<p>the p.value of the test of the landscape effect (the global effect of all spatial variables). Issued from the likelihood ratio test of the (complete) model vs the local model (complete model without landscape variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family distribution for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.error</code></td>
<td>
<p>the estimated standard error for gaussian family, NA in other case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.Type</code></td>
<td>
<p>the type of local model: GLM for generalised model, LMM for linear mixed model or GLMM for generalised linear mixed model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand.StdDev</code></td>
<td>
<p>the estimated standard deviation of random effects for LMM or GLMM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>the estimated residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>a logical indicating the value used for estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wd</code></td>
<td>
<p>a number indicating the size of pixels</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Carpentier, F. and Martin, O.
</p>


<h3>References</h3>

<p>Carpentier, F., &amp; Martin, O. (2019). SILand: an R package for estimating the spatial influence of landscape. bioRxiv, 692566.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(dataSiland)
data(landSiland)
res=siland(obs~x1+L1+L2,land=landSiland,data=dataSiland,sif="exponential")
res
res$AIC


</code></pre>


</div>