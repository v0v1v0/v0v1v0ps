<div class="container">

<table style="width: 100%;"><tr>
<td>Ano_CrossValid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute anomalies in cross-validation mode</h2>

<h3>Description</h3>

<p>Compute the anomalies from the arrays of the experimental and observational 
data output by subtracting the climatologies computed with a leave-one-out 
cross validation technique and a per-pair method (Garcia-Serrano and 
Doblas-Reyes, CD, 2012).
Per-pair climatology means that only the start dates covered by the 
whole experiments/observational datasets will be used. In other words, the 
startdates which do not all have values along 'dat_dim' dimension of both
the 'exp' and 'obs' are excluded when computing the climatologies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ano_CrossValid(
  exp,
  obs,
  time_dim = "sdate",
  dat_dim = c("dataset", "member"),
  memb_dim = "member",
  memb = TRUE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>A named numeric array of experimental data, with at least 
dimensions 'time_dim' and 'dat_dim'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A named numeric array of observational data, same dimensions as
parameter 'exp' except along 'dat_dim'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of the time dimension.
The default value is 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat_dim</code></td>
<td>
<p>A character vector indicating the name of the dataset and 
member dimensions. When calculating the climatology, if data at one 
startdate (i.e., 'time_dim') is not complete along 'dat_dim', this startdate
along 'dat_dim' will be discarded. If there is no dataset dimension, it can be NULL.
The default value is 
"c('dataset', 'member')".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the name of the member 
dimension. Only used when parameter 'memb' is FALSE. It must be one element
in 'dat_dim'. The default value is 'member'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb</code></td>
<td>
<p>A logical value indicating whether to subtract the climatology 
based on the individual members (TRUE) or the ensemble mean over all
members (FALSE) when calculating the anomalies. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 2:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$exp</code></td>
<td>

<p>A numeric array with the same dimensions as 'exp'. The dimension order may
change.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$obs</code></td>
<td>

<p>A numeric array with the same dimensions as 'obs'.The dimension order may
change.
</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Load sample data as in Load() example:
example(Load)
anomalies &lt;- Ano_CrossValid(sampleData$mod, sampleData$obs)
## Not run: 
PlotAno(anomalies$exp, anomalies$obs, startDates, 
       toptitle = paste('anomalies'), ytitle = c('K', 'K', 'K'), 
       legends = 'ERSST', biglab = FALSE)

## End(Not run)
</code></pre>


</div>