<div class="container">

<table style="width: 100%;"><tr>
<td>subcopem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bivariate Empirical Subcopula
</h2>

<h3>Description</h3>

<p>Calculation of bivariate empirical subcopula matrix, induced partitions, standardized bivariate sample, and dependence measures for a given bivariate sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">subcopem(mat.xy, display = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a random vector <code class="reqn">(X,Y)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>

<p>logical value indicating if graphs and dependence measures should be displayed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each of the random variables <code class="reqn">X</code> and <code class="reqn">Y</code> may be of any kind (discrete, continuous, or mixed). NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>depMon </code></td>
<td>
<p>monotone standardized supremum distance in <code class="reqn">[-1,1].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depMonNonSTD </code></td>
<td>
<p>monotone non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depSup </code></td>
<td>
<p>standardized supremum distance in <code class="reqn">[0,1].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depSupNonSTD </code></td>
<td>
<p>non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix </code></td>
<td>
<p>matrix with empirical subcopula values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part1 </code></td>
<td>
<p>vector with partition induced by first variable <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part2 </code></td>
<td>
<p>vector with partition induced by second variable <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size </code></td>
<td>
<p>numeric value of sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.sample </code></td>
<td>
<p>2-column matrix with the standardized bivariate sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample </code></td>
<td>
<p>2-column matrix with the original bivariate sample of <code class="reqn">(X,Y)</code>.</p>
</td>
</tr>
</table>
<p>If <code>display = TRUE</code> then the values of <code>depMon</code>, <code>depMonNonSTD</code>, <code>depSup</code>, and <code>depSupNonSTD</code> will be displayed, and the following graphs will be generated: marginal histograms of <code class="reqn">X</code> and <code class="reqn">Y</code>, scatterplots of the original and the standardized bivariate sample, contour and image bivariate graphs of the empirical subcopula.
</p>


<h3>Note</h3>

<p>If both <code class="reqn">X</code> and <code class="reqn">Y</code> are continuous random variables it is faster and better to use <code>subcopemc</code>.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Durante, F. and Sempi, C. (2016) <em>Principles of Copula Theory</em>. Taylor and Francis Group, Boca Raton.
</p>
<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p><code>subcopemc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1: Discrete-discrete Poisson positive dependence
n &lt;- 1000  # sample size
X &lt;- rpois(n, 5)  # Poisson(parameter = 5)
p &lt;- 2  # another parameter
Y &lt;- mapply(rpois, rep(1, n), 1 + p*X)  # creating dependence
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopem(XY, display = TRUE)
str(SC)

## Example 2: Continuous-discrete non-monotone dependence
n &lt;- 1000      # sample size
X &lt;- rnorm(n)                  # Normal(0,1)
Y &lt;- 2*(X &gt; 1) - 1*(X &gt; -1)    # Discrete({-1, 0, 1})
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopem(XY, display = TRUE)
str(SC)
</code></pre>


</div>