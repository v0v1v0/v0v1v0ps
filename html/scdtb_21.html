<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_gls_once</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate and Analyze Generalized Least Squares</h2>

<h3>Description</h3>

<p>This function simulates data and fits a Generalized Least Squares (GLS) model
to the simulated data. It can handle multiple phases, multiple subjects (IDs),
and various covariate specifications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_gls_once(
  n_timepoints_per_phase,
  rho,
  n_phases = 2,
  n_IDs = 1,
  betas,
  formula,
  covariate_specs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_timepoints_per_phase</code></td>
<td>
<p>Integer. The number of timepoints in each phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Numeric. The autocorrelation parameter for the AR(1) error structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_phases</code></td>
<td>
<p>Integer. The number of phases in the design. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_IDs</code></td>
<td>
<p>Integer. The number of subjects (IDs) to simulate. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>Named numeric vector. The true coefficient values for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula object. The model formula to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate_specs</code></td>
<td>
<p>List of lists. Specifications for generating covariates.
Each inner list should contain elements 'vars' (variable names), 'dist'
(distribution function name), args' (list of distribution parameters), and
optionally 'expr' (a function to generate data).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>success</code></td>
<td>
<p>Logical. TRUE if the model converged, FALSE otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>Named numeric vector. Estimated coefficients from the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_errors</code></td>
<td>
<p>Named numeric vector. Standard errors of the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_values</code></td>
<td>
<p>Named numeric vector. P-values for the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p>Named numeric vector. Bias of the estimated coefficients (estimate - true value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse</code></td>
<td>
<p>Numeric. Root Mean Square Error of the estimated coefficients.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Simple example with 2 phases, 10 timepoints per phase, and no covariates
result &lt;- simulate_gls_once(
  n_timepoints_per_phase = 10,
  rho = 0.2,
  betas = c("(Intercept)" = 0, "phase1" = 1),
  formula = y ~ phase
)

</code></pre>


</div>