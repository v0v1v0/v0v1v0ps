<div class="container">

<table style="width: 100%;"><tr>
<td>smacofConstraint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SMACOF Constraint</h2>

<h3>Description</h3>

<p>SMACOF with internal constraints on the configurations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smacofConstraint(delta, constraint = "unrestricted", external, ndim = 2, 
                 type = c("ratio", "interval", "ordinal", "mspline"), weightmat = NULL,
                 init = NULL, ties = "primary", verbose = FALSE, modulus = 1, 
                 itmax = 1000, eps = 1e-6, spline.intKnots = 4, spline.degree = 2, 
                 constraint.type = c("ratio", "interval", "ordinal", "spline", 
                 "mspline"), constraint.ties = "primary", 
                 constraint.spline.intKnots = 2, constraint.spline.degree = 2)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Either a symmetric dissimilarity matrix or an object of class <code>"dist"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint</code></td>
<td>
<p>Type of constraint: <code>"unrestricted"</code>, <code>"unique"</code>, <code>"diagonal"</code>, or a user-specified function (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external</code></td>
<td>
<p>Data frame or matrix with external covariates, or list for simplex and circumplex (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Number of dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>MDS type: <code>"interval"</code>, <code>"ratio"</code>, <code>"ordinal"</code> (nonmetric MDS), or <code>"mspline"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightmat</code></td>
<td>
<p>Optional matrix with dissimilarity weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Optional matrix with starting values for configurations. If <code>NULL</code> random starts are used (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties</code></td>
<td>
<p>Tie specification for non-metric MDS only: <code>"primary"</code>, <code>"secondary"</code>, or <code>"tertiary"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, intermediate stress is printed out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modulus</code></td>
<td>
<p>Number of smacof iterations per monotone regression call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>
<p>Maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline.degree</code></td>
<td>
<p>Degree of the spline for <code>"mspline"</code> MDS type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline.intKnots</code></td>
<td>
<p>Number of interior knots of the spline for <code>"mspline"</code> MDS type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint.type</code></td>
<td>
<p>Transformation for <code>external</code> covariates: <code>"ratio"</code>,
<code>"interval"</code>, <code>"ordinal"</code>, <code>"spline"</code>, or         
<code>"mspline"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint.ties</code></td>
<td>
<p>Tie specification for <code>external</code> covariates with 
<code>constraint.type = "ordinal"</code>: <code>"primary"</code>, 
<code>"secondary"</code>, or <code>"tertiary"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint.spline.intKnots</code></td>
<td>
<p>Number of interior knots for <code>external</code> covariates
with <code>constraint.type = "spline"</code> or <code>"mspline"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint.spline.degree</code></td>
<td>
<p>Degree of the spline for <code>external</code> covariates
with <code>constraint.type = "spline"</code> or <code>"mspline"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>external</code> is mandatory to specify and requires a data frame (or matrix) of dimension (n x q). Alternatively, for simplex fitting the user can specify a list of the following structure: <code>external = list("simplex", dim2)</code> with <code>dim2</code> denoting the dimension of the simplex with dim2 &lt; n. For a circumplex fitting, the list has to be of the following form: <code>external = list("circumplex", dim2, k1, k2)</code> with <code class="reqn">1 \leq k1 \leq k2 \leq n</code> (see also examples section). k1 and k2 denote the circumplex width.
</p>
<p>In constraint smacof, the configuration matrix <code class="reqn">X</code> is subject to a constraint based on the external scales (predictors <code class="reqn">Z</code> specified using <code>external</code>) of the following linear form: <code class="reqn">X = ZC</code>. The type of constraint in <code class="reqn">C</code> can be specified using the <code>constraint</code> argument. We provide the following standard setting: 
</p>
<p>For <code>constraint = "unrestricted"</code>, <code class="reqn">C</code> is unrestricted. Note that <code>"linear"</code> still works as well for backward compatibility.  
</p>
<p>The same for <code>constraint = "diagonal"</code> where <code class="reqn">X</code> needs to be of dimension <code class="reqn">(n x q)</code> where <code class="reqn">q</code> is the number of columns of the external scale matrix (and thus number of dimensions). Here, <code class="reqn">C</code> is restricted to be diagonal. 
</p>
<p>For <code>constraint = "unrestricted"</code> or <code>"diagonal"</code>, the external covariates <code class="reqn">Z</code> can be optimally transformed as specified by <code>constraint.type</code>. Choosing the number of covariates equal to the number of dimensions together with <code>constraint.type = "ordinal"</code>, <code>constraint.ties = "primary"</code> will effectively restrict the configuration to parallel regions defined by the categories of the covariates. Note that missing values of the covariates are estimated by the model.
</p>
<p>For <code>constraint = "unique"</code> we get the Bentler-Weeks uniqueness model. Hence <code class="reqn">X</code> is of dimension <code class="reqn">(n x (n + p))</code>. This implies that we fit a certain number of dimensions p and, in addition we extract n additional dimensions where each object is scored on a separate dimension. More technical details can be found in the corresponding JSS article (reference see below).
</p>
<p>In addition, the user can specify his own constraint function with the following arguments: configuration matrix with starting values (<code>init</code>) (mandatory in this case), matrix <code class="reqn">V</code> (<code>weightmat</code>; based on the weight matrix, see package vignette), external scale matrix (<code>external</code>). The function must return a matrix of resulting configurations. 
</p>
<p>If no starting configuration is provided, a random starting solution is used. In most applications, this is not a good idea in order to find a well fitting model. The user can fit an exploratory MDS using <code>mds()</code> first, and use the resulting configurations as starting configuration for <code>smacofConstraint()</code>. Alternatively, if the user has starting configurations determined by some underlying theory, they can be used as well. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Observed dissimilarities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsdiss</code></td>
<td>
<p>Observed dissimilarities, normalized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confdist</code></td>
<td>
<p>Configuration dissimilarities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Matrix of final configurations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Matrix with restrictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stress</code></td>
<td>
<p>Stress-1 value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spp</code></td>
<td>
<p>Stress per point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resmat</code></td>
<td>
<p>Matrix with squared residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss</code></td>
<td>
<p>Residual sum-of-squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightmat</code></td>
<td>
<p>Weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Number of dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extvars</code></td>
<td>
<p>List for each external covariate with a list of class <code>"optscal"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Starting configuration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Type of smacof model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobj</code></td>
<td>
<p>Number of objects</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>De Leeuw, J. &amp; Mair, P. (2009). Multidimensional scaling using majorization: The R package smacof. Journal of Statistical Software, 31(3), 1-30, <a href="https://doi.org/10.18637/jss.v031.i03">doi:10.18637/jss.v031.i03</a>
</p>
<p>Mair, P., Groenen, P. J. F., De Leeuw, J. (2022). More on multidimensional scaling in R: smacof version 2. 
Journal of Statistical Software, 102(10), 1-47. <a href="https://doi.org/10.18637/jss.v102.i10">doi:10.18637/jss.v102.i10</a>
</p>
<p>De Leeuw, J., &amp; Heiser, W. (1980). Multidimensional scaling with restrictions on the configurations. In P. R. Krishnaiah (eds.), Multivariate Analysis V, pp. 501-522. North-Holland. 
</p>
<p>Borg, I., &amp; Lingoes, J. C. (1980). A model and algorithm for multidimensional scaling with external constraints on the distances. Psychometrika, 45, 25-38.
</p>


<h3>See Also</h3>

<p><code>smacofSym</code>, <code>smacofRect</code>, <code>smacofIndDiff</code>, <code>smacofSphere</code></p>


<h3>Examples</h3>

<pre><code class="language-R">

## theoretical grid restrictions (rectangles; keep covariate ties tied)
fit.rect1 &lt;- mds(rectangles, type = "ordinal", init = rect_constr) 
fit.rect2 &lt;- smacofConstraint(rectangles, type = "ordinal", ties = "secondary",
                        constraint = "diagonal", init = fit.rect1$conf, 
                        external = rect_constr, constraint.type = "ordinal")
plot(fit.rect2)

## regional restrictions morse code data (signal length, strength)
fitMorse1 &lt;- mds(morse, type = "ordinal")
fitMorse1
fitMorse2 &lt;- smacofConstraint(morse, type = "ordinal", constraint = "unrestricted",
                              external = morsescales[,2:3], 
                              constraint.type = "ordinal", 
                              init = fitMorse1$conf)
fitMorse2
plot(fitMorse2)

## facial expression data I (axial restriction, C diagonal)
Delta &lt;- FaceExp
attr(Delta, "Labels") &lt;- NULL            
fitFace &lt;- mds(Delta, type = "ordinal")   ## starting solution
Z &lt;- FaceScale[, c(1,3)]                  ## external variables
fitFaceC1 &lt;- smacofConstraint(Delta, type = "ordinal", 
  constraint = "diagonal", external = Z, constraint.type = "ordinal", 
  init = fitFace$conf)
fitFaceC1$C 
plot(fitFaceC1, xlab = "Pleasant-Unpleasant", ylab = "Tension-Sleep", 
  main = "Face Expression (Diagonal Restriction)")

## facial expression data II (C unrestricted)
fitFaceC3 &lt;- smacofConstraint(Delta, type = "ordinal", 
  constraint = "unrestricted", external = Z, constraint.type = "ordinal", 
  init = fitFace$conf)
fitFaceC3$C   
plot(fitFaceC3, main = "Face Expression (C Unrestricted, Ordinal Transformation)")
</code></pre>


</div>