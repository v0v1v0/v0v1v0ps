<div class="container">

<table style="width: 100%;"><tr>
<td>slim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a slendr model in SLiM</h2>

<h3>Description</h3>

<p>This function will execute a SLiM script generated by the <code>compile</code>
function during the compilation of a slendr demographic model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">slim(
  model,
  sequence_length,
  recombination_rate,
  samples = NULL,
  output = NULL,
  burnin = 0,
  max_attempts = 1,
  spatial = !is.null(model$world),
  coalescent_only = TRUE,
  method = c("batch", "gui"),
  random_seed = NULL,
  run = TRUE,
  verbose = FALSE,
  load = TRUE,
  locations = NULL,
  slim_path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model object created by the <code>compile</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence_length</code></td>
<td>
<p>Total length of the simulated sequence (in base-pairs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recombination_rate</code></td>
<td>
<p>Recombination rate of the simulated sequence (in
recombinations per basepair per generation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A data frame of times at which a given number of individuals
should be remembered in the tree-sequence (see <code>schedule_sampling</code> for a
function that can generate the sampling schedule in the correct format). If
missing, only individuals present at the end of the simulation will be
recorded in the tree-sequence output file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Path to the output tree-sequence file. If <code>NULL</code> (the default),
tree sequence will be saved to a temporary file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Length of the burnin (in model's time units, i.e. years)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_attempts</code></td>
<td>
<p>How many attempts should be made to place an offspring
near one of its parents? Serves to prevent infinite loops on the SLiM
backend. Default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>Should the model be executed in spatial mode? By default, if a
world map was specified during model definition, simulation will proceed in
a spatial mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coalescent_only</code></td>
<td>
<p>Should <code>initializeTreeSeq(retainCoalescentOnly =
  &lt;...&gt;)</code> be set to <code>TRUE</code> (the default) or <code>FALSE</code>? See
"retainCoalescentOnly" in the SLiM manual for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>How to run the script? ("gui" - open in SLiMgui, "batch" - run
on the command line)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>Random seed (if <code>NULL</code>, a seed will be generated between
0 and the maximum integer number available)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>Should the SLiM engine be run? If <code>FALSE</code>, the command line SLiM
command will be printed (and returned invisibly as a character vector) but not executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Write the SLiM output log to the console (default
<code>FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>load</code></td>
<td>
<p>Should the final tree sequence be immediately loaded and returned?
Default is <code>TRUE</code>. The alternative (<code>FALSE</code>) is useful when a tree-sequence
file is written to a custom location to be loaded at a later point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>If <code>NULL</code>, locations are not saved. Otherwise, the
path to the file where locations of each individual throughout the simulation
will be saved (most likely for use with <code>animate_model</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slim_path</code></td>
<td>
<p>Path to the appropriate SLiM binary (this is useful if the
<code>slim</code> binary is not on the <code>$PATH</code>). Note that this argument must
be specified if the function is being run on Windows.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tree-sequence object loaded via Python-R reticulate interface function <code>ts_load</code>
(internally represented by the Python object <code>tskit.trees.TreeSequence</code>). Optionally,
depending on the value of the arguments <code>load =</code> or <code>run =</code>, nothing or a character
vector, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
init_env()

# load an example model
model &lt;- read_model(path = system.file("extdata/models/introgression", package = "slendr"))

# afr and eur objects would normally be created before slendr model compilation,
# but here we take them out of the model object already compiled for this
# example (in a standard slendr simulation pipeline, this wouldn't be necessary)
afr &lt;- model$populations[["AFR"]]
eur &lt;- model$populations[["EUR"]]
chimp &lt;- model$populations[["CH"]]

# schedule the sampling of a couple of ancient and present-day individuals
# given model at 20 ky, 10 ky, 5ky ago and at present-day (time 0)
modern_samples &lt;- schedule_sampling(model, times = 0, list(afr, 5), list(eur, 5), list(chimp, 1))
ancient_samples &lt;- schedule_sampling(model, times = c(30000, 20000, 10000), list(eur, 1))

# sampling schedules are just data frames and can be merged easily
samples &lt;- rbind(modern_samples, ancient_samples)

# run a simulation using the SLiM back end from a compiled slendr model object and return
# a tree-sequence output
ts &lt;- slim(model, sequence_length = 1e5, recombination_rate = 0, samples = samples)

# automatic loading of a simulated output can be prevented by `load = FALSE`, which can be
# useful when a custom path to a tree-sequence output is given for later downstream analyses
output_file &lt;- tempfile(fileext = ".trees")
slim(model, sequence_length = 1e5, recombination_rate = 0, samples = samples,
     output = output_file, load = FALSE)
# ... at a later stage:
ts &lt;- ts_load(output_file, model)

ts
</code></pre>


</div>