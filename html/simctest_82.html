<div class="container">

<table style="width: 100%;"><tr>
<td>simctest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential implementation of Monte Carlo
tests</h2>

<h3>Description</h3>

<p>Wrapper function for convenient use of the sequential implementation
of the Monte Carlo test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simctest(gensample, level=0.05, epsilon=1e-3, maxsteps=1e4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gensample</code></td>
<td>
<p>function that performs one sampling step. 
Returns 0 (sampled test statistic does not exceed the observation)
or 1 (sampled test static exceeds the observation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>level passed to <code>getalgonthefly</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>error bound epsilon passed to <code>getalgonthefly</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>maximal number of steps to take</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>sampalgres</code>.
</p>


<h3>Author(s)</h3>

<p>Axel Gandy</p>


<h3>References</h3>

<p>Gandy, A. (2009) Sequential Implementation of Monte Carlo Tests 
with Uniformly Bounded Resampling Risk. JASA 104(488):1504-1511.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  #Example used in the above paper
  dat &lt;- matrix(nrow=5,ncol=7,byrow=TRUE,
                c(1,2,2,1,1,0,1, 2,0,0,2,3,0,0, 0,1,1,1,2,7,3, 1,1,2,0,0,0,1, 0,1,1,1,1,0,0))
  loglikrat &lt;- function(data){
    cs &lt;- colSums(data)
    rs &lt;- rowSums(data)
    mu &lt;- outer(rs,cs)/sum(rs)
    2*sum(ifelse(data&lt;=0.5, 0,data*log(data/mu)))
  }
  resample &lt;- function(data){
    cs &lt;- colSums(data)
    rs &lt;- rowSums(data)
    n &lt;- sum(rs)
    mu &lt;- outer(rs,cs)/n/n
    matrix(rmultinom(1,n,c(mu)),nrow=dim(data)[1],ncol=dim(data)[2])
  }
  t &lt;- loglikrat(dat);

  # function to generate samples
  gen &lt;- function(){loglikrat(resample(dat))&gt;=t}

  #using simctest
  simctest(gen,maxsteps=10000)

  #now trying simctest.cont
  res &lt;- simctest(gen,maxsteps=500)
  res

  cont(res,20000)

</code></pre>


</div>