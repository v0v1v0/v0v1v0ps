<div class="container">

<table style="width: 100%;"><tr>
<td>eblupFH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> EBLUPs based on a Fay-Herriot model.</h2>

<h3>Description</h3>

<p> This function gives the EBLUP (or EB predictor under normality) based on a Fay-Herriot model. Fitting method can be chosen between ML, REML and FH methods.</p>


<h3>Usage</h3>

<pre><code class="language-R">eblupFH(formula, vardir, method = "REML", MAXITER = 100, PRECISION = 0.0001, 
        B = 0, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> an object of class <code>formula</code> (or one that can be coerced to that class): 
a symbolic description of the model to be fitted. The variables included in <code>formula</code>
must have a length equal to the number of domains <code>D</code>. Details of model 
specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p> vector containing the <code>D</code> sampling variances of direct estimators for each domain. The values must be sorted as the variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> type of fitting method, to be chosen between <code>"ML"</code>, <code>"REML"</code> or <code>"FH"</code> methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p> maximum number of iterations allowed in the Fisher-scoring algorithm.
Default is 100 iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p> convergence tolerance limit for the Fisher-scoring algorithm. Default value is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replicates to calculate the goodness-of-fit measures proposed by Marhuenda et al. (2014). Default value is <code>0</code> indicating that these measures are not calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>vardir</code>. By default the variables are taken from the environment from which <code>eblupFH</code> is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A typical model has the form response ~ terms where response is the (numeric) response vector and terms is a series of terms which specifies a linear predictor for response. A terms specification of the form first + second indicates all the terms in first together with all the terms in second with duplicates removed. 
</p>
<p>A formula has an implied intercept term. To remove this use either y ~ x - 1 or y ~ 0 + x. See <code>formula</code>  for more details of allowed formulae. 
</p>


<h3>Value</h3>

 
<p>The function returns a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>eblup</code></td>
<td>
<p>vector with the values of the estimators for the domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a list containing the following objects:
</p>

<ul>
<li>
<p><code>method</code>: type of fitting method applied (<code>"REML"</code>, <code>"ML"</code>or <code>"FH"</code>).
</p>
</li>
<li>
<p><code>convergence</code>: a logical value equal to <code>TRUE</code> if Fisher-scoring algorithm converges in less than <code>MAXITER</code> iterations.
</p>
</li>
<li>
<p><code>iterations</code>: number of iterations performed by the Fisher-scoring algorithm.
</p>
</li>
<li>
<p><code>estcoef</code>: a data frame with the estimated model coefficients in the first column (<code>beta</code>), 
their asymptotic standard errors in the second column (<code>std.error</code>), 
the <code class="reqn">t</code> statistics in the third column <code>(tvalue)</code> and the p-values of the significance 
of each coefficient in last column <code>(pvalue)</code>.
</p>
</li>
<li>
<p><code>refvar</code>: estimated random effects variance.
</p>
</li>
<li>
<p><code>goodness</code>: vector containing several goodness-of-fit measures: loglikehood, AIC, BIC, KIC and the measures proposed by Marhuenda et al. (2014): AICc, AICb1, AICb2, KICc, KICb1, KICb2. <code>B</code> must be must be greater than 0 to obtain these last measures.
</p>
</li>
</ul>
</td>
</tr>
</table>
<p>In case that <code>formula</code> or <code>vardir</code> contain NA values a message is printed and no action is done.
</p>


<h3>References</h3>

<p>- Fay, R.E. and Herriot, R.A. (1979). Estimation of income from small places: An application of James-Stein procedures to census data. Journal of the American Statistical Association 74, 269-277.
</p>
<p>- Marhuenda, Y., Morales, D. and Pardo, M.C. (2014). Information criteria for Fay-Herriot model selection. Computational Statistics and Data Analysis 70, 268-280.
</p>
<p>- Rao, J.N.K. (2003). Small Area Estimation. Wiley, London.
</p>


<h3>See Also</h3>

<p><code>mseFH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data set  
data(milk)   
attach(milk)

# Fit FH model using REML method with indicators of 4 Major Areas as 
# explanatory variables.
resultREML &lt;- eblupFH(yi ~ as.factor(MajorArea), SD^2)
resultREML

#Fit FH model using FH method
resultFH &lt;- eblupFH(yi ~ as.factor(MajorArea), SD^2, method="FH")
resultFH

detach(milk)
</code></pre>


</div>