<div class="container">

<table style="width: 100%;"><tr>
<td>rsad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling from a species abundance distribution
</h2>

<h3>Description</h3>

<p>A given number of realizations of a probability distribution (species
abundances in a community) is sampled with replacement by a Poisson or
Negative Binomial process, or without replacement by a hypergeometric process. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsad(S = NULL, frac, sad = c("bs","gamma","geom","lnorm","ls","mzsm","nbinom","pareto",
                             "poilog","power", "powbend", "volkov", "weibull"), 
                 coef, trunc=NaN, sampling=c("poisson", "nbinom", "hypergeometric"), 
                 k, zeroes=FALSE, ssize=1) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>positive integer; number of species in the community, which is the number of random deviates
generated by the probability distribution given by argument <code>sad</code>. Notice that for some
distributions, the value of <code>S</code> is deduced from the coefficients, so this value is ignored
(see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>

<p>single numeric <code>0 &lt; frac &lt;= 1</code>; fraction of the community
sampled. Usually the proportion of total number of individuals or of
total area or volume sampled. Notice that assumptions of Poisson and binomial sampling
are only valid for small values of <code>frac</code> (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad</code></td>
<td>

<p>numeric; a vector of positive real numbers depicting abundances of
species in a community or sample OR
character; root name of community sad distribution - e.g., <kbd>lnorm</kbd>
for the lognormal distribution <code>rlnorm</code>; <kbd>geom</kbd> for the geometric distribution
<code>rgeom</code> or <kbd>ls</kbd> for the lognormal distribution <code>ls</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>

<p>list with named arguments to be passed to the probability function defined by the
argument <kbd>sad</kbd>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>The truncation point at which the random distribution defined in
argument <kbd>sad</kbd> should be truncated; see <code>rtrunc</code>.
The default value of <code>NaN</code> means that no truncation is performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>

<p>character; if <kbd>poisson</kbd> the sampling process is Poisson (independent sampling of
individuals with replacement); if <kbd>nbinom</kbd> negative binomial
sampling is used to simulate aggregation of individuals in sampling
units with replacement;
finally, <kbd>hypergeometric</kbd> samples a fixed number of <code>frac</code> times the number of 
individuals in the simulated community, without replacement. Partial matching is allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>positive; size parameter for the sampling binomial negative. This parameter is ignored for other sampling
techniques.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroes</code></td>
<td>

<p>logical; should zero values be included in the returned vector?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssize</code></td>
<td>

<p>positive integer; sample size: number of draws taken from the community.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function simulates one or more random samples taken from a community with <code>S</code>
species. The expected species abundances in the sampled community can
(i) follow a
probability distribution given by the argument <code>sad</code> or (ii) be a
numeric vector provided by the user through this same argument.
A fraction <code>frac</code> of
the whole set of units that made up the community (usually
individuals) is sampled. Hence the expected abundance in the sample of each
species is <code>frac*n</code>, where n is the species' expected abundance in the
community.
</p>
<p>Three sampling processes can be simulated.
Sampling with replacement can be done with Poisson
(individuals are sampled independently) or negative binomial sampling
(where individuals of each species are aggregated over sampling
units). The "hypergeometric" sampling scheme draws <code>frac * n</code>
individuals without replacement.
</p>
<p>For Poisson and negative binomial schemes the species abundances in
the sample are statistically independent.
In general terms, these two sampling schemes takes a Poisson or negative
binomial sampling with replacement of a vector of <code>S</code> realizations of a random variable,
with the sampling intensity given by <code>frac</code>. The resulting values are
realizations of a Poisson (or a Negative Binomial) random variable where the
parameter that corresponds to the mean (=expected value of the variable) follows a probability
distribution or the numeric vector given by the argument <code>sad</code>. Because these two
sampling schemes assume replacement but the sampled community is
finite, they are valid only when the
fraction of the sampled community is small (<code>frac</code>&lt;&lt;1).
</p>
<p>The "hypergeometric" scheme simulates a sample of a fixed total number of
individuals from the community. Therefore, abundances of the species
in the sample are interdependent (Connoly et al. 2009).
Sampling is carried out with <code>base::sample(..., replace = FALSE)</code>.
This scheme samples without replacement a finite community and
therefore provides valid results for any value of
<code>frac</code>.
</p>
<p>For the broken-stick, logseries, MZSM and Volkov distributions, the expected value of <code>S</code>
is deduced from the coefficients provided in the argument <code>coef</code>; thus, the value of the parameter
<code>S</code> is ignored and may be left blank. The expressions for the number of species in each case are:
</p>
<p>* Broken-stick: coefficient S
* Log-series: alpha log(1 + N/alpha)
* MZSM: sum_x=1^J theta/x (1 - x/J)^(theta - 1)
* Volkov: sum of the unnormalized PDF from 1 to J, see <code>dvolkov</code>
</p>


<h3>Value</h3>

<p>if <kbd>ssize=1</kbd> a vector of (zero truncated) abundances in the sample;
if <kbd>ssize&gt;1</kbd> a data frame with sample identification, species identification, and (zero truncated) abundances.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom.
</p>


<h3>References</h3>

<p>Pielou, E.C. 1977. <em>Mathematical Ecology</em>. New York: John Wiley
and Sons.
</p>
<p>Green, J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. <em>Ecology Letters 10</em>:1037–1045
</p>
<p>Connolly, S.R., Dornelas, M., Bellwood, D.R. and Hughes,
T.P. 2009. Testing species abundance models: a new bootstrap approach
applied to Indo-Pacific coral reefs. <em>Ecology, 90</em>(11):
3138–3149.
</p>


<h3>See Also</h3>

<p><code>dpoix</code>, <code>dpoig</code> and <code>dpoilog</code> for
examples of compound Poisson probability distributions like those
simulated by <code>rsad</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##A Poisson sample from a community with a lognormal sad
samp2 &lt;- rsad(S = 100, frac=0.1, sad="lnorm", coef=list(meanlog=5, sdlog=2))
## Preston plot
plot(octav(samp2))
## Once this is a Poisson sample of a lognormal community, the abundances
## in the sample should follow a Poisson-lognormal distribution.
## Adds line of theoretical Poisson-lognormal with
## mu=meanlog+log(frac) and sigma=sdlog)
## Predicted by the theoretical Poisson-lognormal truncated at zero
samp2.pred &lt;- octavpred(samp2, sad="poilog", coef= list(mu=5+log(0.1), sig=2), trunc=0)
## Adding the line in the Preston plot
lines(samp2.pred)
</code></pre>


</div>