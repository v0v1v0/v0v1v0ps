<div class="container">

<table style="width: 100%;"><tr>
<td>group_enrichment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General Group Enrichment Analysis</h2>

<h3>Description</h3>

<p>This function takes a <code>data.frame</code> as input, compares proportion of positive
cases or mean measure in one subgroup and the remaining samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">group_enrichment(
  df,
  grp_vars = NULL,
  enrich_vars = NULL,
  cross = TRUE,
  co_method = c("t.test", "wilcox.test"),
  ref_group = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp_vars</code></td>
<td>
<p>character vector specifying group variables to split samples
into subgroups (at least 2 subgroups, otherwise this variable will be skipped).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enrich_vars</code></td>
<td>
<p>character vector specifying measure variables to be compared.
If variable is not numeric, only binary cases are accepted in the form of
<code>TRUE/FALSE</code> or <code>P/N</code> (P for positive cases and N for negative cases).
Of note, <code>NA</code> values set to negative cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cross</code></td>
<td>
<p>logical, default is <code>TRUE</code>, combine all situations provided by
<code>grp_vars</code> and <code>enrich_vars</code>. For examples, <code>c('A', 'B')</code> and <code>c('C', 'D')</code>
will construct 4 combinations(i.e. "AC", "AD", "BC" and "BD"). A variable can
not be in both <code>grp_vars</code> and <code>enrich_vars</code>, such cases will be automatically
drop. If <code>FALSE</code>, use pairwise combinations, see section "examples" for use cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co_method</code></td>
<td>
<p>test method for continuous variable, default is 't.test'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_group</code></td>
<td>
<p>reference group set in <code>grp_vars</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>data.table</code> with following columns:
</p>

<ul>
<li> <p><code>grp_var</code>: group variable name.
</p>
</li>
<li> <p><code>enrich_var</code>: enrich variable (variable to be compared) name.
</p>
</li>
<li> <p><code>grp1</code>: the first group name, should be a member in <code>grp_var</code> column.
</p>
</li>
<li> <p><code>grp2</code>: the remaining samples, marked as 'Rest'.
</p>
</li>
<li> <p><code>grp1_size</code>: sample size for <code>grp1</code>.
</p>
</li>
<li> <p><code>grp1_pos_measure</code>: for binary variable, it stores the proportion of
positive cases in <code>grp1</code>; for continuous variable, it stores mean value.
</p>
</li>
<li> <p><code>grp2_size</code>: sample size for <code>grp2</code>.
</p>
</li>
<li> <p><code>grp2_pos_measure</code>: same as <code>grp1_pos_measure</code> but for <code>grp2</code>.
</p>
</li>
<li> <p><code>measure_observed</code>: for binary variable, it stores odds ratio;
for continuous variable, it stores scaled mean ratio.
</p>
</li>
<li> <p><code>measure_tested</code>: only for binary variable, it stores
estimated odds ratio and its 95% CI from <code>fisher.test()</code>.
</p>
</li>
<li> <p><code>p_value</code>: for binary variable, it stores p value from <code>fisher.test()</code>;
for continuous variable, it stores value from <code>wilcox.test()</code> or <code>t.test()</code>.
</p>
</li>
<li> <p><code>type</code>: one of "binary" and "continuous".
</p>
</li>
<li> <p><code>method</code>: one of "fish.test", "wilcox.test" and "t.test".
</p>
</li>
</ul>
<h3>See Also</h3>

<p>show_group_enrichment
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
df &lt;- dplyr::tibble(
  g1 = factor(abs(round(rnorm(99, 0, 1)))),
  g2 = rep(LETTERS[1:4], c(50, 40, 8, 1)),
  e1 = sample(c("P", "N"), 99, replace = TRUE),
  e2 = rnorm(99)
)

print(str(df))
print(head(df))

# Compare g1:e1, g1:e2, g2:e1 and g2:e2
x1 &lt;- group_enrichment(df, grp_vars = c("g1", "g2"), enrich_vars = c("e1", "e2"))
x1

# Only compare g1:e1, g2:e2
x2 &lt;- group_enrichment(df,
  grp_vars = c("g1", "g2"),
  enrich_vars = c("e1", "e2"),
  co_method = "wilcox.test",
  cross = FALSE
)
x2


# Visualization
p1 &lt;- show_group_enrichment(x1, fill_by_p_value = TRUE)
p1
p2 &lt;- show_group_enrichment(x1, fill_by_p_value = FALSE)
p2
p3 &lt;- show_group_enrichment(x1, return_list = TRUE)
p3

</code></pre>


</div>