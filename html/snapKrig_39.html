<div class="container">

<table style="width: 100%;"><tr>
<td>sk_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random draw from multivariate normal distribution for sk grids</h2>

<h3>Description</h3>

<p>Generates a random draw from the multivariate Gaussian distribution for the
covariance model <code>pars</code> on grid <code>g</code>, with mean zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sk_sim(g, pars = sk_pars(g), n_layer = 1, fac = NULL, sk_out = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>an sk object or any grid object accepted by <code>sk</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list, covariance parameters in form returned by <code>sk_pars</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_layer</code></td>
<td>
<p>positive integer, the number of draws to return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>list, optional pre-computed factorization of component correlation matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sk_out</code></td>
<td>
<p>logical, if TRUE an sk grid is returned</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pars</code> and <code>g</code> define the model's covariance matrix V. This function uses <code>base::rnorm</code>
to get a vector of independent standard normal variates, which it multiplies by the square
root of the covariance matrix, V, for the desired model (as defined by <code>pars</code> and <code>g</code>). The
result has a multivariate normal distribution with mean zero and covariance V.
</p>
<p>Multiple independent draws can be computed more efficiently by reusing the factorization
of V. This can be pre-computed with <code>sk_var</code> and supplied in <code>fac</code>, or users can set
<code>n_layer</code> and the function will do this automatically.
</p>


<h3>Value</h3>

<p>sk grid or its vectorized form (vector for single-layer case, matrix for multi-layer case)
</p>


<h3>See Also</h3>

<p>sk sk_pars base::rnorm
</p>
<p>Other variance-related functions: 
<code>sk_GLS()</code>,
<code>sk_LL()</code>,
<code>sk_cmean()</code>,
<code>sk_nLL()</code>,
<code>sk_var()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example grid and covariance parameters
gdim = c(100, 200)
g = sk(gdim)
pars_gau = sk_pars(g)

# this example has a large nugget effect
g_sim = sk_sim(g, pars_gau)
plot(g_sim)

# repeat with smaller nugget effect for less noisy data
pars_smooth = utils::modifyList(pars_gau, list(eps=1e-2))
g_sim = sk_sim(g, pars_smooth)
plot(g_sim)

# the nugget effect can be very small, but users should avoid eps=0
pars_smoother = utils::modifyList(pars_gau, list(eps=1e-12))
g_sim = sk_sim(g, pars_smoother)
plot(g_sim)

# multi-layer example
g_sim_multi = sk_sim(g, pars_smoother, n_layer=3)
plot(g_sim_multi, layer=1)
plot(g_sim_multi, layer=2)
plot(g_sim_multi, layer=3)

</code></pre>


</div>