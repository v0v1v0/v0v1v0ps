<div class="container">

<table style="width: 100%;"><tr>
<td>deseq_fc_ecdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the ECDF for DESeq2 log2(Fold Changes)</h2>

<h3>Description</h3>

<p>This functions will take DESeq2 results as a <code>data.frame</code> and
plot the ecdf for the input <code>gene.lists</code>.
</p>
<p>The gene sets to plot should be provided as a list of lists.
</p>
<p>Example:
</p>
<p><code>gene.lists = list("Background" = c("gene1", "gene2"), "Target" = c("gene2", "gene3"), "Overlap" = c("gene2"))</code>
</p>
<p>This function will also perform statistical testing if <code>plot.hist</code> is TRUE.
The output will be saved to a PDF if an <code>output.filename</code> is provided.
</p>
<p>Users can define the groups that are to be compared in the statistical test
using the <code>null.name</code> and <code>target.name</code> arguments. The names must be found
in <code>gene.lists</code>. The <code>factor.order</code> is used to order the groups in the
analysis.
</p>
<p>This functions returns:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠$plot⁠</code>: The ECDF plot
</p>
</li>
<li> <p><code style="white-space: pre;">⁠$stats⁠</code>: The stats results object
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">deseq_fc_ecdf(
  res,
  gene.lists,
  title = "ECDF",
  output.filename = NULL,
  palette = SeedMatchR.palette,
  factor.order = NULL,
  x.lims = c(-1, 1),
  stats.test = NULL,
  alternative = "greater",
  null.name = 1,
  target.name = 2,
  height = 5,
  width = 5,
  dpi = 320
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>The DESeq2 results dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.lists</code></td>
<td>
<p>A nest list of gene names. Example:
gene.lists = list("Background" = gene.list2, "Target" = gene.list1,
"Overlap" = gene.list3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The tile of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.filename</code></td>
<td>
<p>If the output filename is provided, then the plot is
saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>The color palette to use for your curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.order</code></td>
<td>
<p>The order to use for the legends</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lims</code></td>
<td>
<p>The xlimits range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats.test</code></td>
<td>
<p>The statistic test to use. Options: KS, Kuiper, DTS, CVM,
AD, Wass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The alternative hypothesis to test. Options: greater, less, two.sided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.name</code></td>
<td>
<p>The name in the gene.list to use as the null for ecdf plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.name</code></td>
<td>
<p>The name in the gene.list to use as the target for ecdf plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>Plot height in inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Plot width in inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpi</code></td>
<td>
<p>The dpi resolution for the figure</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object for the ECDF plot
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)

guide.seq = "UUAUAGAGCAAGAACACUGUUUU"

anno.db = load_species_anno_db("human")

features = get_feature_seqs(anno.db$tx.db, anno.db$dna)

# Load test data
get_example_data("sirna")

sirna.data = load_example_data("sirna")

res &lt;- sirna.data$Schlegel_2022_Ttr_D1_30mkg

# Filter DESeq2 results for SeedMatchR
res = filter_deseq(res, fdr.cutoff=1, fc.cutoff=0, rm.na.log2fc = TRUE)

res = SeedMatchR(res, anno.db$gtf, features$seqs, guide.seq, "mer7m8")

# Gene set 1
mer7m8.list = res$gene_id[res$mer7m8 &gt;= 1]

# Gene set 2
background.list = res$gene_id[!(res$mer7m8 %in% mer7m8.list)]

ecdf.results = deseq_fc_ecdf(res,
list("Background" = background.list, "mer7m8" = mer7m8.list),
stats.test = "KS",
factor.order = c("Background", "mer7m8"),
null.name = "Background",
target.name = "mer7m8")

</code></pre>


</div>