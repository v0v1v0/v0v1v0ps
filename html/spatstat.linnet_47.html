<div class="container">

<table style="width: 100%;"><tr>
<td>bw.relrisk.lpp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross Validated Bandwidth Selection for Relative Risk Estimation
on a Network
</h2>

<h3>Description</h3>

<p>Uses cross-validation to select a smoothing bandwidth
for the estimation of relative risk on a linear network.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'lpp'
bw.relrisk(X, ...,
    method = c("likelihood", "leastsquares", "KelsallDiggle", "McSwiggan"),
    distance=c("path", "euclidean"),
    hmin = NULL, hmax = NULL, nh = NULL,
    fast = TRUE, fastmethod = "onestep",
    floored = TRUE, reference = c("thumb", "uniform", "sigma"),
    allow.infinite = TRUE, epsilon = 1e-20, fudge = 0,
    verbose = FALSE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A multitype point pattern on a linear network (object of class
<code>"lpp"</code> which has factor-valued marks).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to <code>density.lpp</code> to control the
resolution of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Character string (partially matched)
determining the cross-validation method.
See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>

<p>Character string (partially matched)
specifying the type of smoothing kernel.
See <code>density.lpp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmin,hmax</code></td>
<td>

<p>Optional. Numeric values.
Range of trial values of smoothing bandwith <code>sigma</code>
to consider. There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>

<p>Number of trial values of smoothing bandwidth <code>sigma</code>
to consider.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>

<p>Logical value specifying whether the leave-one-out density estimates
should be computed using a fast approximation (<code>fast=TRUE</code>, the
default) or exactly (<code>fast=FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastmethod, floored</code></td>
<td>

<p>Developer use only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>

<p>Character string (partially matched) specifying the
bandwidth for calculating the
reference intensities used in the McSwiggan method
(modified Kelsall-Diggle method).
<code>reference="sigma"</code> means the maximum bandwidth considered,
which is given by the argument <code>sigma</code>.
<code>reference="thumb"</code> means the bandwidths selected by
Scott's rule of thumb <code>bw.scott.iso</code>.
<code>reference="uniform"</code> means infinite bandwidth corresponding to
uniform intensity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.infinite</code></td>
<td>

<p>Logical value indicating whether an infinite bandwidth
(corresponding to a constant relative risk) should be permitted
as a possible choice of bandwidth.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>A small constant value added to the reference density in some
of the cross-validation calculations, to improve performance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fudge</code></td>
<td>

<p>Fudge factor to prevent very small density estimates in the
leave-one-out calculation. If <code>fudge &gt; 0</code>,
then the lowest permitted value
for a leave-one-out estimate of intensity is
<code>fudge/L</code>, where <code>L</code> is the total length of the
network. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>

<p>Logical. If <code>TRUE</code>, issue a warning if the minimum of
the cross-validation criterion occurs at one of the ends of the
search interval.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a method for the generic <code>bw.relrisk</code>.
It computes an optimal value of smoothing bandwidth
for the nonparametric estimation of relative risk on a linear network
using <code>relrisk.lpp</code>.
The optimal value is found by minimising a cross-validation criterion.
</p>
<p>The cross-validation criterion is selected by the argument <code>method</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>method="likelihood"</code> </td>
<td style="text-align: left;"> (negative) likelihood cross-validation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>method="leastsquares"</code> </td>
<td style="text-align: left;"> least squares cross-validation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>method="KelsallDiggle"</code> </td>
<td style="text-align: left;"> Kelsall and Diggle (1995) density
  ratio cross-validation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>method="McSwiggan"</code> </td>
<td style="text-align: left;"> McSwiggan et al (2019) modified
  density ratio cross-validation </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>See McSwiggan et al (2019) for details.
</p>
<p>The result is a numerical value giving the selected bandwidth <code>sigma</code>.
The result also belongs to the class <code>"bw.optim"</code>
allowing it to be printed and plotted. The plot shows the cross-validation
criterion as a function of bandwidth.
The ‘optimal’ bandwidth is the value of bandwidth
which minimises the cross-validation criterion. 
</p>
<p>The range of values for the smoothing bandwidth <code>sigma</code>
is set by the arguments <code>hmin, hmax</code>. There is a sensible default,
based on the linear network version of Scott's rule
<code>bw.scott.iso</code>.
</p>
<p>If the optimal bandwidth is achieved at an endpoint of the
interval <code>[hmin, hmax]</code>, the algorithm will issue a warning
(unless <code>warn=FALSE</code>). If this occurs, then it is probably advisable
to expand the interval by changing the arguments <code>hmin, hmax</code>.
</p>
<p>The cross-validation procedure is based on kernel estimates
of intensity, which are computed by <code>density.lpp</code>.
Any arguments <code>...</code> are passed to <code>density.lpp</code>
to control the kernel estimation procedure. This includes the
argument <code>distance</code> which specifies the type of kernel.
The default is <code>distance="path"</code>;
the fastest option is <code>distance="euclidean"</code>.
</p>


<h3>Value</h3>

<p>A single numerical value giving the selected bandwidth.
The result also belongs to the class <code>"bw.optim"</code>
(see <code>bw.optim.object</code>)
which can be plotted to show the bandwidth selection criterion
as a function of <code>sigma</code>.
</p>


<h3>Author(s)</h3>

<p>Greg McSwiggan and Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Kelsall, J.E. and Diggle, P.J. (1995)
Kernel estimation of relative risk.
<em>Bernoulli</em> <b>1</b>, 3–16.
</p>
<p>McSwiggan, G., Baddeley, A. and Nair, G. (2019)
Estimation of relative risk for events on a linear network.
<em>Statistics and Computing</em> <b>30</b> (2) 469–484.
</p>


<h3>See Also</h3>

<p><code>relrisk.lpp</code>, <code>bw.relrisk</code>,
<code>bw.optim.object</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   set.seed(2020)
   X &lt;- superimpose(A=runiflpp(20, simplenet),
                    B=runifpointOnLines(20, as.psp(simplenet)[1]))
   plot(bw.relrisk(X, hmin=0.13, hmax=0.22, method="McSwiggan"))
   plot(bw.relrisk(X, hmin=0.1, hmax=0.2, nh=8, distance="euclidean"))
</code></pre>


</div>