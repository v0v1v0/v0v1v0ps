<div class="container">

<table style="width: 100%;"><tr>
<td>fitmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum Likelihood Estimation (MLE) of a k-th order Markov chain</h2>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the transition matrix and
initial distribution of a k-th order Markov chain starting from one or
several sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitmm(sequences, states, k = 1, init.estim = "mle")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sequences</code></td>
<td>
<p>A list of vectors representing the sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Vector of state space (of length s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Order of the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.estim</code></td>
<td>
<p>Optional. <code>init.estim</code> gives the method used to estimate
the initial distribution. The following methods are proposed:
</p>

<ul>
<li> <p><code>init.estim = "mle"</code>: the classical Maximum Likelihood Estimator
is used to estimate the initial distribution <code>init</code>;
</p>
</li>
<li> <p><code>init.estim = "stationary"</code>: the initial distribution is replaced by
the stationary distribution of the Markov chain (if the order of the
Markov chain is more than one, the transition matrix is converted
into a square block matrix in order to estimate the stationary
distribution);
</p>
</li>
<li> <p><code>init.estim = "freq"</code>: the initial distribution is estimated by
taking the frequencies of the words of length <code>k</code> for all sequences;
</p>
</li>
<li> <p><code>init.estim = "prod"</code>: <code>init</code> is estimated by using the product
of the frequencies of each letter (for all the sequences) in the word
of length <code>k</code>;
</p>
</li>
<li> <p><code>init.estim = "unif"</code>: the initial probability of each state is
equal to <code class="reqn">1 / s</code>, with <code class="reqn">s</code> the number of states.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">X_1, X_2, ..., X_n</code> be a trajectory of length <code class="reqn">n</code> of
the Markov chain <code class="reqn">X = (X_m)_{m \in N}</code> of order <code class="reqn">k = 1</code> with
transition matrix <code class="reqn">p_{trans}(i,j) = P(X_{m+1} = j | X_m = i)</code>. The
maximum likelihood estimation of the transition matrix is
<code class="reqn">\widehat{p_{trans}}(i,j) = \frac{N_{ij}}{N_{i.}}</code>, where <code class="reqn">N_{ij}</code>
is the number of transitions from state <code class="reqn">i</code> to state <code class="reqn">j</code> and
<code class="reqn">N_{i.}</code> is the number of transition from state <code class="reqn">i</code> to any state.
For <code class="reqn">k &gt; 1</code> we have similar expressions.
</p>
<p>The initial distribution of a k-th order Markov chain is defined as
<code class="reqn">\mu_i = P(X_1 = i)</code>. Five methods are proposed for the estimation
of the latter :
</p>

<dl>
<dt>Maximum Likelihood Estimator: </dt>
<dd>
<p>The Maximum Likelihood Estimator
for the initial distribution. The formula is:
<code class="reqn">\widehat{\mu_i} = \frac{Nstart_i}{L}</code>, where <code class="reqn">Nstart_i</code> is
the number of occurences of the word <code class="reqn">i</code> (of length <code class="reqn">k</code>) at
the beginning of each sequence and <code class="reqn">L</code> is the number of sequences.
This estimator is reliable when the number of sequences <code class="reqn">L</code> is high.</p>
</dd>
<dt>Stationary distribution: </dt>
<dd>
<p>The stationary distribution is used as
a surrogate of the initial distribution. If the order of the Markov
chain is more than one, the transition matrix is converted into a
square block matrix in order to estimate the stationary distribution.
This method may take time if the order of the Markov chain is high
(more than three (3)).</p>
</dd>
<dt>Frequencies of each word: </dt>
<dd>
<p>The initial distribution is estimated
by taking the frequencies of the words of length <code>k</code> for all sequences.
The formula is <code class="reqn">\widehat{\mu_i} = \frac{N_i}{N}</code>, where <code class="reqn">N_i</code>
is the number of occurences of the word <code class="reqn">i</code> (of length <code class="reqn">k</code>) in
the sequences and <code class="reqn">N</code> is the sum of the lengths of the sequences.</p>
</dd>
<dt>Product of the frequencies of each state: </dt>
<dd>
<p>The initial distribution
is estimated by using the product of the frequencies of each state
(for all the sequences) in the word of length <code class="reqn">k</code>.</p>
</dd>
<dt>Uniform distribution: </dt>
<dd>
<p>The initial probability of each state is
equal to <code class="reqn">1 / s</code>, with <code class="reqn">s</code>, the number of states.</p>
</dd>
</dl>
<h3>Value</h3>

<p>An object of class S3 <code>mmfit</code> (inheriting from the S3 class mm).
The S3 class <code>mmfit</code> contains:
</p>

<ul>
<li>
<p> All the attributes of the S3 class mm;
</p>
</li>
<li>
<p> An attribute <code>M</code> which is an integer giving the total length of
the set of sequences <code>sequences</code> (sum of all the lengths of the list
<code>sequences</code>);
</p>
</li>
<li>
<p> An attribute <code>loglik</code> which is a numeric value giving the value
of the log-likelihood of the specified Markov model based on the
<code>sequences</code>;
</p>
</li>
<li>
<p> An attribute <code>sequences</code> which is equal to the parameter
<code>sequences</code> of the function <code>fitmm</code> (i.e. a list of sequences used to
estimate the Markov model).
</p>
</li>
</ul>
<h3>See Also</h3>

<p>mm, simulate.mm
</p>


<h3>Examples</h3>

<pre><code class="language-R">states &lt;- c("a", "c", "g", "t")
s &lt;- length(states)
k &lt;- 2
init &lt;- rep.int(1 / s ^ k, s ^ k)
p &lt;- matrix(0.25, nrow = s ^ k, ncol = s)

# Specify a Markov model of order 2
markov &lt;- mm(states = states, init = init, ptrans = p, k = k)

seqs &lt;- simulate(object = markov, nsim = c(1000, 10000, 2000), seed = 150)

est &lt;- fitmm(sequences = seqs, states = states, k = 2)

</code></pre>


</div>