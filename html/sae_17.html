<div class="container">

<table style="width: 100%;"><tr>
<td>mseSFH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean squared error estimator of the spatial EBLUP under a spatial Fay-Herriot model.</h2>

<h3>Description</h3>

<p>Calculates analytical mean squared error estimates of the spatial EBLUPs obtained from the fit of a spatial Fay-Herriot model, in which area effects follow a Simultaneously Autorregressive (SAR) process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mseSFH(formula, vardir, proxmat, method = "REML", MAXITER = 100, 
       PRECISION = 0.0001, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): 
a symbolic description of the model to be fitted. The variables included in <code>formula</code>
must have a length equal to the number of domains <code>D</code>. Details of model specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>vector containing the <code>D</code> sampling variances of direct estimators for each domain. 
The values must be sorted as the variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxmat</code></td>
<td>
<p><code>D*D</code> proximity matrix or data frame with values in the interval <code>[0,1]</code> containing the proximities between the row and column domains. The rows add up to 1. The rows and columns of this matrix must be sorted as the variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> type of fitting method, to be chosen between <code>"REML"</code> or <code>"ML"</code>. Default value is <code>REML</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p>maximum number of iterations allowed for the Fisher-scoring algorithm. Default value is <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>vardir</code>. By default the variables are taken from the environment from which <code>mseSFH</code> is called.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>a list with the results of the estimation process: <code>eblup</code> and <code>fit</code>. For the description of these objects, see Value of  <code>eblupSFH</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse </code></td>
<td>
<p>a vector with the analytical mean squared error estimates of the spatial EBLUPs.</p>
</td>
</tr>
</table>
<p>In case that <code>formula</code>, <code>vardir</code> or <code>proxmat</code> contain NA values a message is printed and no action is done.
</p>


<h3>Author(s)</h3>

<p>Isabel Molina, Monica Pratesi and Nicola Salvati.</p>


<h3>References</h3>

 
<p>- Small Area Methods for Poverty and Living Conditions Estimates (SAMPLE), 
funded by European Commission, Collaborative Project 217565, Call identifier FP7-SSH-2007-1.
</p>
<p>- Molina, I., Salvati, N. and Pratesi, M. (2009). Bootstrap for estimating the MSE of
the Spatial EBLUP. Computational Statistics 24, 441-458.
</p>
<p>- Singh, B., Shukla, G. and Kundu, D. (2005). Spatio-temporal models in small area estimation. Survey Methodology 31, 183-195.
</p>


<h3>See Also</h3>

<p><code>eblupSFH</code>, <code>npbmseSFH</code>, <code>pbmseSFH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(grapes)       # Load data set
data(grapesprox)   # Load proximity matrix 

# Calculate analytical MSE estimates using REML method
result &lt;- mseSFH(grapehect ~ area + workdays - 1, var, grapesprox, data=grapes)
result
</code></pre>


</div>