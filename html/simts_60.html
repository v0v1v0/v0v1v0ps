<div class="container">

<table style="width: 100%;"><tr>
<td>deriv_2nd_arma11</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analytic D matrix for ARMA(1,1) process</h2>

<h3>Description</h3>

<p>Obtain the second derivative of the ARMA(1,1) process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">deriv_2nd_arma11(phi, theta, sigma2, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A <code>double</code> corresponding to the phi coefficient of an ARMA(1,1) process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A <code>double</code> corresponding to the theta coefficient of an ARMA(1,1) process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>A <code>double</code> corresponding to the error term of an ARMA(1,1) process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A <code>vec</code> containing the scales e.g. <code class="reqn">2^{\tau}</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>matrix</code> with:
</p>

<ul>
<li>
<p> The <strong>first</strong> column containing the second partial derivative with respect to <code class="reqn">\phi</code>;
</p>
</li>
<li>
<p> The <strong>second</strong> column containing the second partial derivative with respect to <code class="reqn">\theta</code>;
</p>
</li>
<li>
<p> The <strong>third</strong> column contains the second partial derivative with respect to <code class="reqn">\sigma ^2</code>.
</p>
</li>
<li>
<p> The <strong>fourth</strong> column contains the partial derivative with respect to <code class="reqn">\phi</code> and <code class="reqn">\theta</code>.
</p>
</li>
<li>
<p> The <strong>fiveth</strong> column contains the partial derivative with respect to <code class="reqn">\sigma ^2</code> and <code class="reqn">\phi</code>.
</p>
</li>
<li>
<p> The <strong>sixth</strong> column contains the partial derivative with respect to <code class="reqn">\sigma ^2</code> and <code class="reqn">\theta</code>.
</p>
</li>
</ul>
<h3>Process Haar WV Second Derivative</h3>

<p>Taking the second derivative with respect to <code class="reqn">\phi</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{{{\partial ^2}}}{{\partial {\phi ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^5}{{(\phi  + 1)}^3}\tau _j^2}}\left( \begin{array}{cc}
&amp;{(\phi  - 1)^2}\left( {{{(\phi  + 1)}^2}\left( {{\theta ^2}\phi  + \theta {\phi ^2} + \theta  + \phi } \right)\tau _j^2\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} + \left( {{\phi ^2} - 1} \right)\left( {{\theta ^2}( - \phi ) + \theta \left( {{\phi ^2} + 4\phi  + 1} \right) - \phi } \right){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 2}} - 2{{(\theta  - 1)}^2}\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
&amp;- 12{(\phi  + 1)^2}\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
&amp;+ 6(\phi  + 1)(\phi  - 1)\left( {\frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} + (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) + (\phi  + 1)\left( { - (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} - \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) - {{(\theta  + 1)}^2}\phi {\tau _j}} \right)} \right) \\ 
\end{array}  \right)</code>
</p>

<p>Taking the second derivative with respect to <code class="reqn">\theta</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{{{\partial ^2}}}{{\partial {\theta ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{{2{\sigma ^2}\left( {\left( {{\phi ^2} - 1} \right){\tau _j} + 2\phi \left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)}}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}} </code>
</p>

<p>Taking the second derivative with respect to <code class="reqn">\sigma ^2</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{{{\partial ^2}}}{{\partial {\sigma ^4}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = 0 </code>
</p>

<p>Taking the derivative with respect to <code class="reqn">\sigma^2</code> and <code class="reqn">\theta</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^3}(\phi  + 1)\tau _j^2}}\left( {(\theta  + 1)\left( {{\phi ^2} - 1} \right){\tau _j} + \left( {2\theta \phi  + {\phi ^2} + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right)</code>
</p>

<p>Taking the derivative with respect to <code class="reqn">\sigma^2</code> and <code class="reqn">\phi</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial }{{\partial \phi }}\frac{\partial }{{\partial {\sigma ^2}}}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) = \frac{2}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{array}{ll}
&amp;- (\phi  - 1)(\phi  + 1)\left( \begin{array}{ll}
                               &amp;- (\theta  + \phi )(\theta \phi  + 1){\tau _j}\left( {{\phi ^{\frac{{{\tau _j}}}{2}}} - 2} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
                               &amp;- \theta (\theta  + \phi )\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
                               &amp;- (\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\
                               &amp;- {(\theta  + 1)^2}\phi {\tau _j} \\ 
                               \end{array}  \right) \\
&amp;+ (\phi  - 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\
&amp;+ 3(\phi  + 1)\left( { - \frac{1}{2}{{(\theta  + 1)}^2}\left( {{\phi ^2} - 1} \right){\tau _j} - (\theta  + \phi )(\theta \phi  + 1)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right)} \right) \\ 
\end{array}  \right)</code>
</p>

<p>Taking the derivative with respect to <code class="reqn">\phi</code> and <code class="reqn">\theta</code> yields:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial }{{\partial \theta }}\frac{\partial }{{\partial \phi }}\nu _j^2\left( {\phi ,\theta ,{\sigma ^2}} \right) =  - \frac{{2{\sigma ^2}}}{{{{(\phi  - 1)}^4}{{(\phi  + 1)}^2}\tau _j^2}}\left( \begin{array}{cc}
&amp;{\tau _j}\left( \begin{array}{cc}
                &amp;2(\theta  + 1)(\phi  - 1){(\phi  + 1)^2} \\
                &amp;+ 2\left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{\frac{{{\tau _j}}}{2} - 1}} \\
                &amp;- \left( {{\phi ^2} - 1} \right)\left( {2\theta \phi  + {\phi ^2} + 1} \right){\phi ^{{\tau _j} - 1}} \\ 
                \end{array}  \right) \\
&amp;+ 2\left( {\theta (\phi (3\phi  + 2) + 1) + \phi \left( {{\phi ^2} + \phi  + 3} \right) + 1} \right)\left( {{\phi ^{{\tau _j}}} - 4{\phi ^{\frac{{{\tau _j}}}{2}}} + 3} \right) \\ 
\end{array}  \right)</code>
</p>



<h3>Author(s)</h3>

<p>James Joseph Balamuta (JJB)
</p>


</div>