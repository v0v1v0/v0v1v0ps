<div class="container">

<table style="width: 100%;"><tr>
<td>SimCiDiff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simultaneous Confidence Intervals for General Contrasts (Differences) of 
Means of Multiple Endpoints </h2>

<h3>Description</h3>

<p>Simultaneous confidence intervals for general contrasts (linear functions) of 
normal means (e.g., "Dunnett", "Tukey", "Williams" ect.), and for single or 
multiple endpoints (primary response variables) simultaneously. The procedure of 
Hasler and Hothorn (2011) &lt;doi:10.2202/1557-4679.1258&gt; is applied for 
differences of means of normally distributed data. The variances/ covariance 
matrices of the treatment groups (containing the covariances between the 
endpoints) may be assumed to be equal or possibly unequal for the different 
groups (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single 
endpoint and unequal covariance matrices (variances), the procedure coincides 
with the PI procedure of Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
SimCiDiff(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, ContrastMat = NULL, alternative = "two.sided", covar.equal = FALSE, 
  conf.level = 0.95, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimCiDiff(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> a new 
experimental version is used (details will follow soon) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li>
<p> "Dunnett": many-to-one comparisons
</p>
</li>
<li>
<p> "Tukey": all-pair comparisons
</p>
</li>
<li>
<p> "Sequen": comparisons of consecutive groups
</p>
</li>
<li>
<p> "AVE": comparison of each group with average of all others
</p>
</li>
<li>
<p> "GrandMean": comparison of each group with grand mean of all
groups
</p>
</li>
<li>
<p> "Changepoint": differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li>
<p> "Marcus": Marcus contrasts
</p>
</li>
<li>
<p> "McDermott": McDermott contrasts
</p>
</li>
<li>
<p> "Williams": Williams trend tests
</p>
</li>
<li>
<p> "UmbrellaWilliams": Umbrella-protected Williams trend tests
</p>
</li>
</ul>
<p>note that <code>type</code> is ignored if <code>ContrastMat</code> is specified
by the user (see below) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ContrastMat</code></td>
<td>
<p> a contrast matrix, where columns correspond to groups and rows
correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a numeric value defining the simultaneous confidence level </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments to be passed to SimCiDiff.default </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The interest is in simultaneous confidence intervals for several linear combinations
(contrasts) of treatment means in a one-way ANOVA model, and for single or 
multiple endpoints simultaneously. For example, corresponding intervals for the all-
pair comparison of Tukey (1953) and the many-to-one comparison of Dunnett (1955) are 
implemented, but allowing for heteroscedasticity and multiple endpoints. The user is 
also free to create other interesting problem-specific contrasts. Approximate 
multivariate <em>t</em>-distributions are used to calculate lower and upper limits 
(Hasler and Hothorn, 2011 &lt;doi:10.2202/1557-4679.1258&gt;). Simultaneous tests based on 
these intervals control the familywise error rate in admissible ranges and in the 
strong sense. The variances/ covariance matrices of the treatment groups (containing 
the covariances between the endpoints) can be assumed to be equal 
(<code>covar.equal=TRUE</code>) or unequal (<code>covar.equal=FALSE</code>). If being equal, the 
pooled variance/ covariance matrix is used, otherwise approximations to the degrees 
of freedom (Satterthwaite, 1946) are used (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;; 
Hasler and Hothorn, 2008 &lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices 
occure if variances or correlations of some endpoints differ depending on the 
treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimCi containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> a matrix of estimated differences </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) lower limits </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.raw</code></td>
<td>
<p> a matrix of raw (unadjusted) upper limits </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p> a matrix of lower limits adjusted for multiplicity </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p> a matrix of upper limits adjusted for multiplicity </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All intervals have the same direction for all comparisons and endpoints
(<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17–28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2011): A Dunnett-type procedure for multiple endpoints.
<em>The International Journal of Biostatistics</em> 7, Article 3, &lt;doi:10.2202/1557-4679.1258&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793–800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>See Also</h3>

 <p><code>SimTestDiff</code>, <code>SimTestRat</code>, 
<code>SimCiRat</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1:
# Simultaneous confidence intervals related to a comparison of the groups
# B and H against the standard S, for endpoint Thromb.count, assuming unequal
# variances for the groups. This is an extension of the well-known Dunnett-
# intervals to the case of heteroscedasticity.

data(coagulation)

interv1 &lt;- SimCiDiff(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
interv1
plot(interv1)

# Example 2:
# Simultaneous confidence intervals related to a comparisons of the groups
# B and H against the standard S, simultaneously for all endpoints, assuming
# unequal covariance matrices for the groups. This is an extension of the well-
# known Dunnett-intervals to the case of heteroscedasticity and multiple
# endpoints.

data(coagulation)

interv2 &lt;- SimCiDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(interv2)
plot(interv2)
</code></pre>


</div>