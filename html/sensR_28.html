<div class="container">

<table style="width: 100%;"><tr>
<td>dod_utils</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utility functions for the Degree-of-Difference model</h2>

<h3>Description</h3>

<p>Various utility functions supporting the Degree-of-Difference (DOD)
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
optimal_tau(d.prime, d.prime0 = 0, ncat=3,
            method=c("equi.prob", "LR.max", "se.min"),
            tau.start=NULL, equi.tol = 1e-4, grad.tol = 1e-2,
            do.warn=TRUE)

par2prob_dod(tau, d.prime)

dod_nll(tau, d.prime, same, diff, integer.tol=1e-8)

dod_null(same, diff, integer.tol=1e-8)

dod_null_tau(same, diff)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d.prime</code></td>
<td>
<p>the value of d-prime; non-negative numerical scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.prime0</code></td>
<td>
<p>d-prime under the null hypothesis; only used in
<code>optimal_tau</code> when <code>method = "LR.max"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>the number of response categories in the DOD model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method with which to choose the boundary
parameters â€” see <code>dodSim</code> for details on the methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.start</code></td>
<td>
<p>optional vector of starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equi.tol</code></td>
<td>
<p>convergence tolerence for the <code>"equi.prob"</code>
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad.tol</code></td>
<td>
<p>gradient convergence tolerence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.warn</code></td>
<td>
<p>issue warning if estimation of optimal tau does not
converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same</code></td>
<td>
<p>The answers to same-pairs; either 1) a numeric vector of
counts of length equal to the number of response categories
ordered appropriately or 2) a
factor where the levels indicate the response categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>the answers to different-pairs in the same format as
<code>same</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>vector of boundary parameters in the DOD model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integer.tol</code></td>
<td>
<p>tolerence for when <code>same</code> or <code>diff</code>
arguments are considered non-integer counts: a warning is issued if
non-integer counts are encountered.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>optimal_tau</code></td>
<td>
<p>computes optimal boundary parameters (tau)
using various criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2prob_dod</code></td>
<td>
<p>computes the multinomial probability vectors from
DOD model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dod_nll</code></td>
<td>
<p>implements the negative log-likelihood function for the
DOD model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dod_null</code></td>
<td>
<p>implements the negative log-likelihood function for
the DOD model where d-prime = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dod_null_tau</code></td>
<td>
<p>Estimates tau for the DOD model where
d-prime = 0.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rune Haubo B Christensen</p>


<h3>See Also</h3>

 <p><code>dod</code>, <code>dod_fit</code>,
<code>dodSim</code>, <code>dodPwr</code>,
<code>dodControl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compute optimal boundary parameters using the LR.max criterion for
## d.prime=1 with 4 categories:
dp &lt;- 1
(Tau &lt;- optimal_tau(d.prime=dp, d.prime0 = 0, ncat=4,
                    method="LR.max")$tau)
##  [1] 1.244642 2.109140 3.098985
## This set of boundary parameters optimize the power of the DOD test
## with d.prime = 1 under the alternative hypothesis.

## Compute the probability that an observation will fall in each of
## the (here 2*4=8) response categories given values of tau and d.prime:
par2prob_dod(tau=Tau, d.prime=dp)
##              [,1]      [,2]      [,3]       [,4]
##  p.same 0.6211921 0.2429480 0.1074307 0.02842911
##  p.diff 0.5124361 0.2571691 0.1596425 0.07075227

## Compute the negative log-likelihood given data and parameters:
Same &lt;- c(10, 20, 30, 20)
Diff &lt;- c(10, 10, 20, 40)
dod_nll(tau=Tau, d.prime=dp, same=Same,
        diff=Diff)
##  [1] 334.0986

## Compute the negative log-likelihood under the null hypothesis
## (where d.prime = 0):
dod_null(same=Same, diff=Diff)
##  [1] 208.8154
##  ## The boundary parameters for this:
(Tau0 &lt;- dod_null_tau(same=Same, diff=Diff))
##  [1] 0.2224709 0.5688675 1.2546147

## Some equalities:
stopifnot(
    dod_nll(tau=Tau0, d.prime=0, same=Same, diff=Diff) ==
    dod_null(same=Same, diff=Diff))
stopifnot(
    dod_null(same=Same, diff=Diff) ==
    -dod_fit(same=Same, diff=Diff, d.prime=0)$logLik
    )
stopifnot(
    dod_nll(same=Same, diff=Diff, tau=Tau, d.prime=dp) ==
    -dod_fit(same=Same, diff=Diff, tau=Tau, d.prime=dp)$logLik
    )
stopifnot(all(
    dod_null_tau(same=Same, diff=Diff) ==
    dod_fit(Same, Diff, d.prime=0)$tau))


</code></pre>


</div>