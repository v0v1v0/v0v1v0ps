<div class="container">

<table style="width: 100%;"><tr>
<td>SDPDm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial dynamic panel data lag model with fixed effects maximum likelihood estimation.</h2>

<h3>Description</h3>

<p>This function estimates spatial panel model with fixed effects for static or dynamic model. It includes the transformation approach suggested by Yu et al (2008) and Lee and Yu (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SDPDm(
  formula,
  data,
  W,
  index,
  model = "sar",
  effect = "individual",
  ldet = NULL,
  lndetspec = list(p = NULL, m = NULL, sd = NULL),
  dynamic = FALSE,
  tlaginfo = list(ind = NULL, tl = TRUE, stl = TRUE),
  LYtrans = FALSE,
  incr = NULL,
  rintrv = TRUE,
  demn = FALSE,
  DIRtrans = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description for the (static) model to be estimated, not including the dynamic component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial weights matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>the indexes (Names of the variables for the spatial and time component. The spatial is first and the time second.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a models to be calculated, c("sar","sdm"), default = "sar"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>type of fixed effects, c("none","individual","time","twoways"), default ="individual"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ldet</code></td>
<td>
<p>type of computation of log-determinant, c("full","mc"). Default "full" for smaller problems, "mc" for large problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lndetspec</code></td>
<td>
<p>specifications for the calculation of the log-determinant for mcmc calculation. Default list(p=NULL,m=NULL,sd=NULL), if the number of spatial units is &gt;1000 then list(p=30,m=30,sd=12345)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dynamic</code></td>
<td>
<p>logical, if TRUE time lag of the dependent variable is included. Default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlaginfo</code></td>
<td>
<p>specification for the time lag, default = list(ind=NULL,tl=FALSE,stl=FALSE), see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LYtrans</code></td>
<td>
<p>logical, default FALSE. If the Lee-Yu transformation should be used for bias correction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incr</code></td>
<td>
<p>increment for vector of values for rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rintrv</code></td>
<td>
<p>logical, default TRUE, calculates eigenvalues of W. If FALSE, the interval for rho is (-1,1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demn</code></td>
<td>
<p>logical, if Lee-Yu transformation for demeaning of the variables to remove fixed effects is performed (only used in static models). Default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIRtrans</code></td>
<td>
<p>logical, if direct transformation of variables should be used. Default, FALSE (only used in dynamic models with "twoways" effects)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on MatLab functions sar_jihai.m, sar_jihai_time.m and sar_panel_FE.m
</p>
<p>In <em>tlaginfo = list(ind = NULL, tl = TRUE, stl = TRUE)</em>:
</p>
<p><em>ind</em> i-th column in <em>data</em> which represents the time lag,
if not specified then the lag from the dependent variable is created and the
panel is reduced from n<em>t to n</em>(t-1)
</p>
<p><em>tl</em> logical, default TRUE. If TRUE <code class="reqn">y_{t-1}</code>
(the lagged dependent variable in time is included)
</p>
<p><em>stl</em> logical, default TRUE. If TRUE <code class="reqn">Wy_{t-1}</code>
(the lagged dependent variable in space and time is included)
</p>


<h3>Value</h3>

<p>An object of class "SDPDm"
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>coefficients estimate of the model parameters (<em>coefficients1</em> for dynamic model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>spatial coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sige</code></td>
<td>
<p>residuals variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llik</code></td>
<td>
<p>the value of the log likelihood function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rozeta Simonovska
</p>


<h3>References</h3>

<p>Yu, J., De Jong, R., &amp; Lee, L. F. (2008). Quasi-maximum likelihood estimators for spatial dynamic panel data with fixed effects when both n and T are large. <em>Journal of Econometrics</em>, 146(1), 118-134.
</p>
<p>Lee, L. F., &amp; Yu, J. (2010). Estimation of spatial autoregressive panel data models with fixed effects. <em>Journal of Econometrics</em>, 154(2), 165-185.
</p>
<p>Lee, L. F., &amp; Yu, J. (2010). A spatial dynamic panel data model with both time and individual fixed effects. <em>Econometric Theory</em>, 564-597.
</p>


<h3>See Also</h3>

<p><code>vignette("spatial_model", package = "SDPDmod")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("SDPDmod")
data(Produc, package = "plm")
data(usaww, package = "splm")
form1 &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
mod1  &lt;- SDPDm(formula = form1, data = Produc, W = usaww, index = c("state","year"),
               model = "sar", effect = "individual", LYtrans = TRUE)
summary(mod1)
imp1  &lt;- impactsSDPDm(mod1)
summary(imp1)
mod2  &lt;- SDPDm(formula = form1, data = Produc, W = usaww, index = c("state","year"),
               model = "sdm", effect = "twoways", LYtrans = TRUE,
               dynamic = TRUE, tlaginfo=list(ind = NULL, tl = TRUE, stl = TRUE))
summary(mod2)

</code></pre>


</div>