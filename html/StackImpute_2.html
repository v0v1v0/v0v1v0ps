<div class="container">

<table style="width: 100%;"><tr>
<td>Bootstrap_Variance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap_Variance</h2>

<h3>Description</h3>

<p>This function takes a dataset with stacked multiple imputation and a model fit and applies bootstrap to estimate the covariance matrix accounting for imputation uncertainty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bootstrap_Variance(fit, stack, M, n_boot = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>object with corresponding vcov method (e.g. glm, coxph, survreg, etc.) from fitting to the (weighted) stacked dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stack</code></td>
<td>
<p>data frame containing stacked dataset across multiple imputations. Could have 1 or M rows for each subject with complete data. Should have M rows for each subject with imputed data. Must contain the following named columns: (1) stack$.id, which correspond to a unique identifier for each subject. This column can be easily output from MICE. (2) stack$wt, which corresponds to weights assigned to each row. Standard analysis of stacked multiple imputations should set these weights to 1 over the number of times the subject appears in the stack. (3) stack$.imp, which indicates the multiply imputed dataset (from 1 to M). This column can be easily output from MICE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of multiple imputations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_boot</code></td>
<td>
<p>number of bootstrap samples</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the bootstrap-based estimation method for stacked multiple imputations proposed by Dr. Paul Bernhardt in â€œA Comparison of Stacked and Pooled Multiple Imputation" at the Joint Statistical Meetings, 2019.
</p>


<h3>Value</h3>

<p>Variance, estimated covariance matrix accounting for within and between imputation variation
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(stackExample)

fit = stackExample$fit
stack = stackExample$stack

bootcovar = Bootstrap_Variance(fit, stack, M = 5, n_boot = 10)
VARIANCE_boot = diag(bootcovar)

</code></pre>


</div>