<div class="container">

<table style="width: 100%;"><tr>
<td>stepSGB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stepwise backward elimination for SGB regression
</h2>

<h3>Description</h3>

<p>Stepwise elimination of the non significant regression parameters. Possibility to assign a fixed value   <code> shape1</code> to the overall shape parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepSGB(obj0, d, u,  weight = rep(1, dim(d)[1]), shape10 = obj0[["par"]][1],
  bound = 2.1, shape1 = NULL, Mean2 = TRUE, maxiter = 10, 
  control.optim = list(fnscale = -1), 
  control.outer = list(itmax = 1000, ilack.max = 200, trace = TRUE,
   kkt2.check = TRUE, method = "BFGS") )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj0</code></td>
<td>

<p>object of class regSGB, see <code>regSGB</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>data matrix of explanatory variables (without constant vector) <code class="reqn">(n \times m)</code>; <code class="reqn">n</code>: sample size, 
<code class="reqn">m</code>: number of auxiliary variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>data matrix of compositions (independent variables) <code class="reqn">(n \times D)</code>; <code class="reqn">D</code>: number of parts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>vector of length <code class="reqn">n</code>; positive observation weights, default <code>rep(1,n)</code>. Should be scaled to sum to  <code class="reqn">n</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape10</code></td>
<td>

<p>positive number, initial value of the overall shape parameter, 
default obj0[["par"]][1].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>

<p>inequality constraints on the estimates of shapes:<br><code>shape1*shape2[i] &gt; bound, i=1,...,D.</code> <br>
By default <code>bound = 2.1</code>, see <code>InequalityConstr</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>

<p>fixed value of the overall shape parameter. Default is NULL (no fixed value).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean2</code></td>
<td>

<p>logical, if TRUE (default), the initial shape2 parameters are each replaced by their average. See <code>initpar.SGB</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>maximum number of iterations, i.e. attempts to set a parameter to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.optim</code></td>
<td>

<p>list of control parameters for optim, see <code>optim</code>. Default is from <code>auglag</code>, except <code>list(fnscale = -1)</code>. Always specify <code>fnscale = -1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.outer</code></td>
<td>

<p>list of control parameters to be used by the outer loop in constrOptim.nl, see <code>auglag</code>. 
Default is from <code>auglag</code>, except <code>list(itmax = 1000, ilack.max = 200)</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an experimental procedure for searching a set of non-significant parameters that will be set to zero. The shape parameters are excluded from the elimination procedure. The algorithm starts with <code>obj0</code>, output of regSGB.  The p-values for the regression parameters in <code>summary(obj0)</code> are taken in decreasing order. The parameter with the largest p-value is set to zero and <code>regSGB</code> computes the regression with this constraint. If the AIC value is smaller than the AIC in <code>obj0</code>, the parameter with the next largest p-value in <code>obj0</code> is set to zero and the regression with the two constraints is computed. The process iterates until either a larger AIC is found or <code>maxiter</code> is attained.<br>
The initial value of the overall shape parameter is set to the estimated value in the full model <code>obj0</code>. The other initial values are computed as in <code>regSGB</code>. <br>
There is the possibility to fix the value of the overvall shape parameter, if <code>shape1</code> is given a positive number <code class="reqn">a_0</code> (default NULL, no fixed value). <br>
If <code>regSGB</code> was called without <code>Formula</code>, the data-frame with auxiliary variables for <code>stepSGB</code> follows the same rules as for the initial regSGB object, see Example 1 in <code>regSGB</code>.
</p>


<h3>Value</h3>

<p>A list of class 'stepSGB' with the following 5 components:<br></p>
<table><tr style="vertical-align: top;">
<td><code>reg </code></td>
<td>
<p>A list with the following components: <br><code>full</code> Object of class regSGB, same as <code>obj0</code>, see <code>regSGB</code>. <br><code>iter1</code> Object of class regSGB obtained at iteration 1. <br>
... <br><code>iterk</code> Object of class regSGB obtained at iteration k.
</p>
</td>
</tr></table>
<p><br></p>
<table>
<tr style="vertical-align: top;">
<td><code>Formula </code></td>
<td>
<p>The original formula, or NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p>Value of k, the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab </code></td>
<td>
<p>Data frame with <code>k+1</code> columns, overall results and <code>k</code>  iterations. The rows are <br><code>value</code> Log-likelihood <br><code>n.par</code> Total number of parameters (including the shape2 param.) <br><code>n.par.fixed</code> Number of fixed parameters. <br><code>AIC</code> Value of the AIC criterion. <br><code>convergence</code> 0 if converged. <br><code>kkt1</code> 1 if first Karush-Kuhn-Tucker criterion fulfilled, zero otherwise. <br><code>kkt2</code> 1 if second Karush-Kuhn-Tucker criterion fulfilled, zero otherwise. <br><code>counts.function</code> Number of times the objective function (the log-likelihood) was evaluated. <br><code>counts.gradient</code> Number of times  the gradient was evaluated. \
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>Arguments for calling <code>stepSGB</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><a href="../doc/vignette.pdf"><code>vignette("SGB regression", package = "SGB")</code></a>
</p>


<h3>See Also</h3>

<p><code>regSGB</code>, <code>initpar.SGB</code>, <code>auglag</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(carseg)
## Extract the compositions
uc &lt;- as.matrix(carseg[,(1:5)])
## Initial regression
data(ocar)

step_ocar &lt;- stepSGB(ocar, carseg, uc, bound=2.1, control.outer=list(trace=FALSE))

summary(step_ocar[["reg"]][["full"]])
summary(step_ocar[["reg"]][["iter4"]])
step_ocar[["tab"]]

</code></pre>


</div>