<div class="container">

<table style="width: 100%;"><tr>
<td>power.cmh.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power and sample size calculation for the Cochran-Mantel-Haenszel test</h2>

<h3>Description</h3>

<p>Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in <em>J</em> stratified 2 x 2
tables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.cmh.test(
  p1 = NULL,
  p2 = NULL,
  theta = NULL,
  N = NULL,
  sig.level = 0.05,
  power = 0.8,
  alternative = c("two.sided", "less", "greater"),
  s = 0.5,
  t = 1/J,
  correct = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>Vector of proportions of the <em>J</em> case groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>Vector of proportions of the <em>J</em> control groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Vector of odds ratios relating to the <em>J</em> 2 x 2 tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Total number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Significance level (Type I error probability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Power of test (1 minus Type II error probability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Two- or one-sided test. If one-sided, the direction of the
association must be defined (less than 1 or greater than 1). Can be
abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Proportion (weight) of case versus control in <em>J</em> stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Proportion (weight) of total number of cases of <em>J</em> stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>Logical indicating whether to apply continuity correction.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This sample size calculation is based on the derivations described in the
Woolson <em>et al.</em> (1986). It is designed for case-control studies where
one margin is fixed. The method is "based on the Cochran-Mantel-Haenszel
statistic expressed as a weighted difference in binomial proportions."
</p>
<p>Continuity corrected sample size is described in Nam's 1992 paper. This uses
the weighted binomial sample size calculation described in Woolson <em>et
al.</em> (1986) but is enhanced for use with the continuity corrected Cochran's
test.
</p>
<p>Power calculations are based on the writings of Wittes and Wallenstein
(1987). They are functionally equivalent to the derivations of the sample
size calculation described by Woolson and others and Nam, but have slightly
added precision.
</p>
<p>Terminology and symbolic conventions are borrowed from Woolson <em>et al.</em>
(1986). The <code>p1</code> group is dubbed the <em>Case</em> group and <code>p2</code>
group is called the <em>Control</em> group.
</p>


<h3>Value</h3>

<p>An object of class <code>"power.cmh"</code>: a list of the original arguments and
the calculated sample size or power. Also included are vectors of n's per
each group, an indicator or whether continuity correction was used, the
original function call, and <code>N.effective</code>.
</p>
<p>The vectors of n's per each group, <code>n1</code> and <code>n2</code>, are the
fractional n's required to achieve a final total N specified by the
calculation while satisfying the constraints of <code>s</code> and <code>t</code>.
However, the effective N, given the requirement of cell counts populated by
whole numbers is provided by <code>N.effective</code>. By default, the print method
is set to <code>n.frac = FALSE</code>, which will round each cell n up to the
nearest whole number.
</p>


<h3>Arguments</h3>

<p>To calculate <strong>power</strong>, the <code>power</code> parameter must be set to
<code>NULL</code>. To calculate <strong>sample size</strong>, the <code>N</code> parameter must
be set to <code>NULL</code>.
</p>
<p>The <code>J</code> number of groups will be inferred by the maximum length of
<code>p1</code>, <code>p2</code>, or <code>theta</code>.
</p>
<p>Effect size must be specified using one of the following combinations of
arguments.
</p>

<ul>
<li>
<p> Both case and control proportion vectors, ex.,
</p>
<ul><li> <p><code>p1</code> and <code>p2</code> with <code>theta = NULL</code>.</p>
</li></ul>
</li>
<li>
<p> One proportion vector and an effect size, ex.,
</p>

<ul>
<li> <p><code>p1</code> and <code>theta</code> with <code>p2 = NULL</code>, <strong>or</strong>
</p>
</li>
<li> <p><code>p2</code> and <code>theta</code> with <code>p1 = NULL</code>.
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Paul W. Egeler, M.S.
</p>


<h3>References</h3>

<p>Gail, M. (1973). "The determination of sample sizes for trials involving
several 2 x 2 tables."
<em>Journal of Chronic Disease</em> <strong>26</strong>: 669-673.
</p>
<p>Munoz, A. and B. Rosner. (1984). "Power and sample size for a collection of 2
x 2 tables." <em>Biometrics</em> <strong>40</strong>: 995-1004.
</p>
<p>Nam, J. (1992). "Sample size determination for case-control studies and the
comparison of stratified and unstratified analyses."
<em>Biometrics</em> <strong>48</strong>: 389-395.
</p>
<p>Wittes, J. and S. Wallenstein. (1987). "The power of the Mantel-Haenszel
test." <em>Journal of the American Statistical Association</em> <strong>82</strong>:
1104-1109.
</p>
<p>Woolson, R. F., Bean, J. A., and P. B. Rojas. (1986).
"Sample size for case-control studies using Cochran's statistic."
<em>Biometrics</em> <strong>42</strong>: 927-932.
</p>


<h3>See Also</h3>

<p>power.prop.test,
mantelhaen.test,
BreslowDayTest
</p>


<h3>Examples</h3>

<pre><code class="language-R"># From "Sample size determination for case-control studies and the comparison
# of stratified and unstratified analyses", (Nam 1992). See references.

# Uncorrected sample size estimate first introduced
# by Woolson and others in 1986
sample_size_uncorrected &lt;- power.cmh.test(
  p2 = c(0.75,0.70,0.65,0.60),
  theta = 3,
  power = 0.9,
  t = c(0.10,0.40,0.35,0.15),
  alternative = "greater",
  correct = FALSE
)

print(sample_size_uncorrected, detail = FALSE)

# We see that the N is 171, the same as calculated by Nam
sample_size_uncorrected$N


# Continuity corrected sample size estimate added by Nam
sample_size_corrected &lt;- power.cmh.test(
  p2 = c(0.75,0.70,0.65,0.60),
  theta = 3,
  power = 0.9,
  t = c(0.10,0.40,0.35,0.15),
  alternative = "greater",
  correct = TRUE
)

print(sample_size_corrected, n.frac = TRUE)

# We see that the N is indeed equal to that which is reported in the paper
sample_size_corrected$N

</code></pre>


</div>