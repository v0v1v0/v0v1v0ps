<div class="container">

<table style="width: 100%;"><tr>
<td>fastSTB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneous Tolerance Bands Using a Fast C-Implementation.</h2>

<h3>Description</h3>

<p>This function represents the interface to a C-implementation of the bisection algorithm for computing
simultaneous tolerance bounds as described in Schuetzenmeister et al. 2012.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fastSTB(
  mat,
  alpha = 0.05,
  tol = 1e-04,
  max.iter = 100L,
  Ncpu = 2,
  timer = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>(numeric) matrix with rows representing simulations of 'ncol' values, rows are supposed to be sorted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(numeric) 100(1-alpha)% simultaneous tolerance level (coverage)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(numeric) convergence tolerance level for the bisection algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>(integer) number of bisection-steps for the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncpu</code></td>
<td>
<p>(integer) specifying the number of processors (CPUs, cores, ...) to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timer</code></td>
<td>
<p>(logical) TRUE = the time spent for computing the STB will be printed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quantiles will be computed according to SAS PCTLDEF5 definition of quantiles, which is identical to 'type=2' 
in function <code>quantile</code>. This is also the default-option throughout this package. Function <code>SASquantile</code>
is a R-implementation identical to the C-implementation used here.
</p>


<h3>Value</h3>

<p>(list) with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>(numeric) matrix with sorted random vector stored in rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCol</code></td>
<td>
<p>(integer) number of columns of 'mat'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nRow</code></td>
<td>
<p>(integer) number of rows of 'mat'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(numeric) values used for the 100(1-alpha)% STB</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(numeric) the tolerance value used as stopping criterion for the bisection algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>(integer) the max. number of iteration of the bisection algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>(numeric) matrix with 2 rows, corresponding to the bounds of the STB (1st row = lower bounds, 2nd row = upper bounds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>(numeric) value corresponding to the actual coverage of the STB</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andre Schuetzenmeister <a href="mailto:andre.schuetzenmeister@roche.com">andre.schuetzenmeister@roche.com</a>
</p>


<h3>References</h3>

<p>Schuetzenmeister, A., Jensen, U., Piepho, H.P. (2011), Checking assumptions of normality and homoscedasticity in the general linear model. 
Communications in Statistics - Simulation and Computation; S. 141-154
</p>


<h3>See Also</h3>

<p>getSTB stb
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
### example for 10000 x 30 matrix
 set.seed(333)
 mat &lt;- t(apply(matrix(rnorm(10000*30), ncol=30), 1, sort))
 stb.obj1 &lt;- fastSTB(mat, timer=TRUE)
 stb.obj1$coverage
	stb.obj2 &lt;- fastSTB(mat, timer=TRUE, Ncpu=4)
 stb.obj3 &lt;- fastSTB(mat, timer=TRUE, Ncpu=6)
 stb.obj4 &lt;- fastSTB(mat, timer=TRUE, Ncpu=8)

## End(Not run)
</code></pre>


</div>