<div class="container">

<table style="width: 100%;"><tr>
<td>get_adj_p</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get Adjust P Values from Group Comparison</h2>

<h3>Description</h3>

<p>Setting <code>aes(label=..p.adj..)</code> in <code>ggpubr::compare_means()</code> does not
show adjust p values. The returned result of this function can be combined with <code>ggpubr::stat_pvalue_manual()</code> to fix
this problem.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_adj_p(
  data,
  .col,
  .grp = "Sample",
  comparisons = NULL,
  method = "wilcox.test",
  p.adjust.method = "fdr",
  p.digits = 3L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> containing column for groups and column for comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.col</code></td>
<td>
<p>column name for comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.grp</code></td>
<td>
<p>column name for groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparisons</code></td>
<td>
<p>Default is <code>NULL</code>, use all combination in group column.
It can be a list of length-2 vectors. The entries in the vector are either
the names of 2 values on the x-axis or the 2 integers that correspond to the
index of the groups of interest, to be compared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which method to be used for comparing means.
It can be 't.test', 'wilcox.test' etc..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>correction method, default is 'fdr'. Run <code>p.adjust.methods</code> to
see all available options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>how many significant digits are to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>ggpubr::compare_means()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More info see <code>ggpubr::compare_means()</code>, <code>ggpubr::stat_compare_means()</code> and <code>stats::p.adjust()</code>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> containing comparison result
</p>


<h3>Source</h3>

<p>https://github.com/kassambara/ggpubr/issues/143
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggpubr)
# T-test
stat.test &lt;- compare_means(
  len ~ dose,
  data = ToothGrowth,
  method = "t.test",
  p.adjust.method = "fdr"
)
stat.test
# Create a simple box plot
p &lt;- ggboxplot(ToothGrowth, x = "dose", y = "len")
p

# Add p values
my_comparisons &lt;- list(c("0.5", "1"), c("1", "2"), c("0.5", "2"))
p + stat_compare_means(method = "t.test", comparisons = my_comparisons)

# Try adding adjust p values
# proposed by author of ggpubr
# however it does not work
p + stat_compare_means(aes(label = ..p.adj..), method = "t.test", comparisons = my_comparisons)

# Solution:
# calculate adjust p values and their location
# then use stat_pvalue_manual() function
p_adj &lt;- get_adj_p(ToothGrowth, .col = "len", .grp = "dose")
p_adj
p + stat_pvalue_manual(p_adj, label = "p.adj")

# Show selected comparisons
# Of note, p value is ajusted
# for three comparisons, but only
# two are showed in figure
p_adj &lt;- get_adj_p(ToothGrowth,
  .col = "len", .grp = "dose",
  comparisons = list(c("0.5", "1"), c("1", "2"))
)
p + stat_pvalue_manual(p_adj, label = "p.adj")
</code></pre>


</div>