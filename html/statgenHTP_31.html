<div class="container">

<table style="width: 100%;"><tr>
<td>removeSingleOut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Replace outliers for single observations by NA</h2>

<h3>Description</h3>

<p>Function for replacing outliers for single observations by NA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">removeSingleOut(TP, singleOut, trait = attr(x = singleOut, which = "trait"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>An object of class TP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singleOut</code></td>
<td>
<p>A data.frame with at least the columns plotId and
timePoint with values corresponding to those in TP. If a column outlier is
present, as in the output of <code>detectSingleOut</code>, only plotId x
timePoint combinations for which outlier = 1 will be set to NA. If no
column outlier is present, all observations in singleOut will be set to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>The trait that should be set to NA. Can be ignored when using
the output of <code>detectSingleOut</code> as input.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class TP, the input with the outlier replaced by NA.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code>detectSingleOut()</code>,
<code>detectSingleOutMaize()</code>,
<code>plot.singleOut()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a TP object containing the data from the Phenovator.
PhenovatorDat1 &lt;- PhenovatorDat1[!PhenovatorDat1$pos %in%
                                 c("c24r41", "c7r18", "c7r49"), ]
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## First select a subset of plants, for example here 9 plants.
plantSel &lt;- phenoTP[[1]]$plotId[1:9]
# Then run on the subset
resuVatorHTP &lt;- detectSingleOut(TP = phenoTP,
                                trait = "EffpsII",
                                plotIds = plantSel,
                                confIntSize = 3,
                                nnLocfit = 0.1)

## Replace the studied trait by NA for the plants marked as outliers.
phenoTPOut &lt;- removeSingleOut(phenoTP, resuVatorHTP)

</code></pre>


</div>