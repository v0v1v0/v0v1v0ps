<div class="container">

<table style="width: 100%;"><tr>
<td>.nll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate negative log-likelihood</h2>

<h3>Description</h3>

<p>Same as <code>log_likelihood()</code>, except negated and requiring lambda on log scale (used in combination with <code>nlm()</code>, to ensure that the optimization search doesn't stray into negative values of <code>lambda</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">.nll(log.lambda, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>log.lambda</code></td>
<td>
<p>natural logarithm of incidence rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>log_likelihood</code>
</p>

<dl>
<dt><code>pop_data</code></dt>
<dd>
<p>a <code>data.frame()</code> with cross-sectional serology data per antibody and age, and additional columns</p>
</dd>
<dt><code>antigen_isos</code></dt>
<dd>
<p>Character vector listing one or more antigen isotypes. Values must match <code>pop_data</code>.</p>
</dd>
<dt><code>curve_params</code></dt>
<dd>
<p>a <code>data.frame()</code> containing MCMC samples of parameters from the Bayesian posterior distribution of a longitudinal decay curve model. The parameter columns must be named:
</p>

<ul>
<li> <p><code>antigen_iso</code>: a <code>character()</code> vector indicating antigen-isotype combinations
</p>
</li>
<li> <p><code>iter</code>: an <code>integer()</code> vector indicating MCMC sampling iterations
</p>
</li>
<li> <p><code>y0</code>: baseline antibody level at <code class="reqn">t=0</code> (<code class="reqn">y(t=0)</code>)
</p>
</li>
<li> <p><code>y1</code>: antibody peak level (ELISA units)
</p>
</li>
<li> <p><code>t1</code>: duration of infection
</p>
</li>
<li> <p><code>alpha</code>: antibody decay rate (1/days for the current longitudinal parameter sets)
</p>
</li>
<li> <p><code>r</code>: shape factor of antibody decay
</p>
</li>
</ul>
</dd>
<dt><code>noise_params</code></dt>
<dd>
<p>a <code>data.frame()</code> (or <code>tibble::tibble()</code>) containing the following variables, specifying noise parameters for each antigen isotype:
</p>

<ul>
<li> <p><code>antigen_iso</code>: antigen isotype whose noise parameters are being specified on each row
</p>
</li>
<li> <p><code>nu</code>: biological noise
</p>
</li>
<li> <p><code>eps</code>: measurement noise
</p>
</li>
<li> <p><code>y.low</code>: lower limit of detection for the current antigen isotype
</p>
</li>
<li> <p><code>y.high</code>: upper limit of detection for the current antigen isotype
</p>
</li>
</ul>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>logical: if TRUE, print verbose log information to console</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the negative log-likelihood of the data with the current parameter values
</p>


</div>