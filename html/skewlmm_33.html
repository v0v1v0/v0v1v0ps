<div class="container">

<table style="width: 100%;"><tr>
<td>smn.lmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML estimation of scale mixture of normal linear mixed models
</h2>

<h3>Description</h3>

<p>It fits a scale mixture of normal linear mixed model with possible within-subject dependence structure, using an EM-type algorithm (via the DAAREM method, by default).
It provides estimates and standard errors of parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smn.lmm(data, formFixed, groupVar, formRandom = ~1, depStruct = "UNC",
        timeVar = NULL, distr = "norm", covRandom = "pdSymm",
        pAR = 1, control = lmmControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables named in <code>formFixed</code>, <code>formRandom</code>, <code>groupVar</code>, and <code>timeVar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formFixed</code></td>
<td>
<p>A two-sided linear formula object describing the fixed effects part of the model, with the response on the left of a <code>~</code> operator and the covariates, separated by <code>+</code> operators, on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupVar</code></td>
<td>
<p>A character containing the name of the variable which represents the subjects or groups in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formRandom</code></td>
<td>
<p>A one-sided linear formula object describing the random effects part of the model, with the covariates, separated by <code>+</code> operators, on the right of a <code>~</code> operator. By default, a model with random intercept is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure should be used. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) – p is <code>length(phi)</code>–, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>A character containing the name of the variable which represents the time in <code>data</code>. Meaningless if <code>depStruct="UNC"</code> or <code>depStruct="CS"</code>. For other structures, if <code>is.null(timeVar)</code> the observations are considered equally spaced and ordered. If <code>depStruct="ARp"</code>, timeVar must be an index, preferably starting at 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character indicating which distribution should be used. <code>"norm"</code> for normal, <code>"t"</code> for t, <code>"sl"</code> for slash, and <code>"cn"</code> for contaminated normal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covRandom</code></td>
<td>
<p>A character indicating which structure should be used for the random
effects scale matrix (either <code>"pdSymm"</code> (default), for a general positive-definite matrix, or <code>"pdDiag"</code>, for a diagonal matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAR</code></td>
<td>
<p>If <code>depStruct="ARp"</code>, pAR indicates the order of the autoregressive process that should be used. Otherwise, it is meaningless.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object resulting from the function <code>lmmControl()</code>, containing additional options for the estimation algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It fits the model <code class="reqn">Y_i = X_i \beta + Z_i b_i + \epsilon_i</code>, for <code class="reqn">i=1,\dots,n</code>, where <code class="reqn">Y_i</code> is a vector with <code class="reqn">n_i</code> observed continuous responses, <code class="reqn">b_i ~ SMN(0, D; H)</code> and <code class="reqn">\epsilon_i ~ SMN(0, \Sigma_i; H)</code>, indexed by the same mixing distribution.
</p>
<p>For efficiency, the DAAREM method is used for parameter estimation. In case of numerical errors, please try passing to  <code>lmmControl(algorithm = "DAAREM")</code> to the <code>control</code> argument.
</p>
<p>For details see Schumacher, Lachos &amp; Matos (2021).
</p>


<h3>Value</h3>

<p>An object of class "SMN" representing the SMN-LMM fit. Generic functions such as print and summary have methods to show the results of the fit. The functions fitted and ranef can be used to extract some of its components.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Named vector with parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations runned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>A named list containing parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uhat</code></td>
<td>
<p>Estimated weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik.track</code></td>
<td>
<p>Vector containing the log-likelihood value from each iteration of the estimation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effects</code></td>
<td>
<p>Estimated random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.error</code></td>
<td>
<p>A vector with standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elapsedTime</code></td>
<td>
<p>Time elapsed in processing, in seconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Convergence criterion at last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The <code>smn.lmm</code> call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>A list with AIC and BIC criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame used on <code>smn.lmm</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A list containing the formulas used on <code>smn.lmm</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covRandom</code></td>
<td>
<p>A character indicating which structure was used for the random effects scale matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character indicating which distribution was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of observations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of individuals/groups used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupVar</code></td>
<td>
<p>A character indicating the name of the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The control list used in the function's call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>A character indicating the name of the time variable, if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>A vector of fitted values, if <code>calc.bi=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Henderson, N. C. and R. Varadhan (2019). Damped anderson acceleration with restarts
and monotonicity control for accelerating EM and EM-like algorithms. Journal of
Computational and Graphical Statistics 28(4), 834-846.
</p>
<p>Lachos, V. H., P. Ghosh, and R. B. Arellano-Valle (2010). Likelihood based inference for skew-normal independent linear mixed models. Statistica Sinica 20, 303-322.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code>lmmControl</code>, <code>update</code>, <code>predict.SMN</code>, <code>residuals.SMN</code>, <code>plot.SMN</code>, <code>smsn.lmm</code>, <code>smn.clmm</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">#simple example
dat1 = as.data.frame(nlme::Orthodont)
fm1 = smn.lmm(dat1, formFixed=distance ~ age, groupVar="Subject",
                control=lmmControl(max.iter=30))
fm1

#fitting for several distributions / dependence structures
fm1 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject")
fm2 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              distr="t")
fm3 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              distr="sl")
fm4 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              depStruct="ARp", pAR=1)
criteria(list(fm1=fm1, fm2=fm2, fm3=fm3, fm4=fm4))
summary(fm3)

#some diagnostic tools
plot(fm3)
acf3 = acfresid(fm3, calcCI=TRUE, MCiter=100)
plot(acf3)
plot(mahalDist(fm3), nlabels=2)
healy.plot(fm3)

</code></pre>


</div>