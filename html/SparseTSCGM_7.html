<div class="container">

<table style="width: 100%;"><tr>
<td>sparse.tscgm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sparse time series chain graphical models
</h2>

<h3>Description</h3>

<p>Computes sparse vector autoregressive coefficients matrices of order 1 and 
order 2   and precision matrix estimates for time series chain graphical 
models using SCAD penalty. In time series chain graphs <code>directed</code>
edges are identified by nonzero entries of the autoregressive 
coefficients matrix and <code>undirected</code> edges  are identified by 
nonzero entries  of the precision matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparse.tscgm(data = data, lam1 = NULL, lam2 = NULL, nlambda = NULL, 
      model = c("ar1", "ar2"), penalty=c("scad","lasso"),
      optimality = c("NULL", "bic", "bic_ext", "bic_mod", "aic", "gic"), 
      control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Longitudinal data format.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam1</code></td>
<td>

<p>Either a scalar or a vector of tuning parameter values for the 
SCAD penalty on the precision matrix. The default is <code>lam1</code>=NULL and 
the program generates a sequence of tuning parameter values based on 
<code>nlambda</code>. The user can also specify a sequence to change the default 
sequence. If <code>lam1</code> is a vector with length at least 2, information 
criteria based model selection will be performed to select the optimal 
tuning parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam2</code></td>
<td>

<p>Either a scalar or a vector of tuning parameter values for the 
SCAD penalty on the precision matrix. The default is <code>lam2</code>=NULL and 
the program generates a sequence of tuning parameter values based on 
<code>nlambda</code>. The user can also specify a sequence to chance the default 
sequence. If <code>lam2</code> is a vector with length at least 2, information 
criteria based model selection will be performed to select the optimal 
tuning parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>

<p>The number of values used in <code>lam1</code> and <code>lam2</code>. Default value is 10.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>This specifies the order of vector autoregressive models. Vector autoregressive 
model of order 1 is applied if <code>model</code> = "ar1" and Vector autoregressive 
model of order 2 is applied if  method = "ar2". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>This specifies the type of penalty function uto be used. SCAD penalty function 
is applied if <code>penalty</code> = "scad" and GLASSO is applied if
<code>penalty</code> = "lasso". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimality</code></td>
<td>

<p>This specifies the type of information based model selection criteria. When
optimality is "NULL" it computes the time series chain graphical model 
solutions   for specified scalar values of the tuning parameters <code>lam1</code> 
and <code>lam2</code>. The rest optimality criteria first selects the optimal SCAD
tuning parameter values using the minimum information criterion from vectors
of tuning parameters for <code>lam1</code> and <code>lam2</code> then computes the time 
series chain graphical model solutions based on the optimal tuning parameter
values. 
These are:  "BIC" (Bayesian Information Criteria),
"bic_ext" (Extended Bayesian Information Criteria),
"bic_mod" (Modified Bayesian Information Criteria)
"aic" (Akakie Information Criteria), and
"gic" (Generalized Information Criteria).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>The argument <code>control</code> includes a list of control parameters passed to 
the main function. The user can specify its own control parameter values to 
replace the default values. 
</p>
<p>control = list(maxit.out = 5, maxit.in = 50, tol.out = 1e-04, 
silent = TRUE)  
</p>
<p><code>maxit.out</code> : The maximum allowable outer iterations of the algorithm. 
The outer-loop iterates alternatively to estimate the precision matrix and 
the autoregression matrix until convergence. Default is 5.  
<code>maxit.in</code>: The maximum allowable iterations of the algorithm that 
minimizes with respect to the autoregression coefficient matrix. 
Default is 50.
<code>tol.out</code>: Convergence tolerance for outer-loop of the algorithm that 
alternate between the estimation of precision matrix and autoregressive 
coefficients matrix.Default is 1e-04.
<code>silent</code>: Either <code>TRUE</code> or <code>FALSE</code>.  If <code>silent=FALSE</code> 
this function will display progress updates to the screen. Default is TRUE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For description of the objective functions and computational details 
see Abegaz and Wit (2013).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Precision matrix estimate. The nonzero estimates of 
the precision matrix are used for constructing <code>undirected</code> graphs that 
represent conditional independences at time lag 0 or instantaneous interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Autoregressive coefficients matrix estimate. The nonzero estimates
of the autoregression matrix are used for constructing <code>directed</code> graphs 
that represent conditional independences at time lag 1, time lag 2 or dynamic 
interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam1.opt</code></td>
<td>
<p>The optimal tuning parameter for SCAD penalty on the precision
matrix selected with minimum information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam2.opt</code></td>
<td>
<p>The optimal tuning parameter for SCAD penalty on the 
autoregressive coefficients matrix selected with minimum BIC criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.ic</code></td>
<td>
<p>Minimum value of the optimality criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tun.ic</code></td>
<td>
<p>A matrix containing the list of tuning parameter values and the 
corresponding model selection or optimality values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam1.seq</code></td>
<td>
<p>The sequence of tuning parameter values related to 
precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam2.seq</code></td>
<td>
<p>The sequence of tuning parameter values related to 
autoregression matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.theta</code></td>
<td>
<p>Sparsity level of the precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.gamma</code></td>
<td>
<p>Sparsity level of the autoregression coefficients matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Fentaw Abegaz and Ernst Wit
</p>


<h3>References</h3>

<p><cite>Fentaw Abegaz and Ernst Wit (2013). Sparse time series chain graphical
models for reconstructing genetic networks. <em>Biostatistics</em>.
<b>14</b>, 3: 586-599.</cite>
</p>
<p><cite>Rothman, A.J., Levina, E., and Zhu, J. (2010). Sparse multivariate 
regression with covariance estimation. <em>Journal of Computational 
and Graphical Statistics</em>. <b>19</b>: 947â€“962.</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
seed = 321
datas &lt;- sim.data(model="ar1", time=10,n.obs=10, n.var=5,seed=seed,prob0=0.35,
         network="random")
data.fit &lt;-  datas$data1
prec_true &lt;- datas$theta
autoR_true &lt;- datas$gamma
    
   
res.tscgm &lt;- sparse.tscgm(data=data.fit, lam1=NULL, lam2=NULL, nlambda=NULL, 
 model="ar1", penalty="scad",optimality="bic_mod",control=list(maxit.out = 10, maxit.in = 100))
   
#Estimated sparse precision and autoregression matrices
prec &lt;- res.tscgm$theta
autoR &lt;- res.tscgm$gamma

#Optimal tuning parameter values
lambda1.opt &lt;- res.tscgm$lam1.opt
lambda2.opt &lt;- res.tscgm$lam2.opt

#Sparsity levels
sparsity_theta &lt;- res.tscgm$s.theta
sparsity_gamma &lt;- res.tscgm$s.gamma

#Graphical visualization
oldpar &lt;- par(mfrow=c(2,2))
plot.tscgm(datas, mat="precision",main="True precision matrix")         
plot.tscgm(res.tscgm, mat="precision",main="Estimated precision matrix")     
plot.tscgm(datas, mat="autoregression",main="True autoregression coef. matrix")     
plot.tscgm(res.tscgm, mat="autoregression",
             main="Estimated autoregression coef. matrix") 
par(oldpar)

</code></pre>


</div>