<div class="container">

<table style="width: 100%;"><tr>
<td>inserer_formule.moodle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Insérer une formule mathématique, comme image, grâce à latex
</h2>

<h3>Description</h3>

<p>Cette fonction permet de convertir une formule mathématique au format
Latex en image prête à insérer dans un texte.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inserer_formule.moodle( formule, filtre.Moodle = FALSE,
                        displaystyle = TRUE, marge = 2, 
                        couleurs = TRUE, enjoliver = TRUE,
                        cmd.latex = "latex -shell-escape --interaction errorstopmode",
                        packages = c( "amsfonts", "amsmath",
                                      "amssymb" , "dsfont" ),
                        options.convert = list( 'density' = 150,
                                                'outext'  = ".png" ) )

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formule</code></td>
<td>
<p>Une chaîne de caractères contenant la formule
mathématique à convertir, au format latex (sans les délimiteurs).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtre.Moodle</code></td>
<td>
<p>Si <code>TRUE</code>, la formule est entourée des
marqueurs permettant à Moodle de faire la conversion, en utilisant
son filtre (qui va dépendre de la configuration faite sur le
serveur).  Cela a l'avantage de faire une base plus légère (pas
d'image...) et un affichage plus harmonieux, mais aussi plus lent et
avec moins de souplesse, puisque les bibliothèques disponibles sont
fonction de l'installation faite. Sinon, elle est convertie en image
localement avec latex et l'image est insérée dans le fichier XML.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displaystyle</code></td>
<td>
<p>Si <code>TRUE</code>, la commande latex
<code>\displaystyle</code> est ajoutée en début de formule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marge</code></td>
<td>
<p>La marge à laisser autour de la formule (en points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>couleurs</code></td>
<td>
<p>Si <code>TRUE</code>, le package “xcolor” est inclus
et les noms de couleurs usuels sont utilisables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enjoliver</code></td>
<td>
<p>Si <code>TRUE</code>, quelques adaptations de la formule
sont faites pour avoir un résultat plus esthétique. Actuellement,
cela correspond à protéger la virgule entre deux chiffres par des
accolades (évitant ainsi une espace après la virgule) et à remplacer
les symboles inégalité large par défaut (“\leq” et
“\geq”) par leur version avec l'égalité parallèle au signe
(“\leqslant” et “\geqslant”).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmd.latex</code></td>
<td>
<p>Une chaîne de caractères indiquant la commande à
utiliser pour lancer latex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>packages</code></td>
<td>
<p>Un vecteur de chaînes de caractères indiquant les noms
des packages latex à inclure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options.convert</code></td>
<td>
<p>Une liste d'options à passer au package
“standalone”, utilisé pour créer l'image.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Cette fonction permet de créer une image d'une formule mathématique, à
partir du code latex correspondant.
</p>
<p>La taille de l'image dépend de la longueur de la formule, mais aussi
de la définition choisie pour créer l'image. Il n'est pas très facile
de prévoir la qualité du résultat, puisque la taille du texte dans
Moodle dépend, elle, de la feuille de style choisie et des réglages du
navigateur.  L'option “density” (par défaut à 150) permet de
modifier cette taille: plus elle est élevée, plus l'image sera grande.
</p>
<p>La conversion est faite avec latex et le package “standalone”:
les deux doivent être installés et latex exécutable par R pour que la
conversion puisse avoir lieu.
</p>
<p>Les commandes des formules latex commencent par le caractère \, qui
sert de code d'échappement dans R. Il faut donc les protéger en les
doublant (\\) dans les formules.
</p>


<h3>Value</h3>

<p>Une chaîne de caractère contenant le code XML nécessaire pour inclure
une image (contenant la formule créée), et qu'elle soit incluse au
fichier XML au moment de la création de la question.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code>inserer_SMILES.moodle</code> pour convertir un code SMILES en
une formule chimique et l'insérer dans une question Moodle.
</p>
<p><code>lier_image.moodle</code> pour insérer une image quelconque.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Création d'une question demandant la définition de la tangente
  #  (Non exécuté car latex non nécessairement installé)
## Not run: 
  # Commencer un nouveau questionnaire
  q &lt;- debuter_xml.moodle( "tangente" )

  # Catégorie : exemples
  categorie.moodle( "Exemples SARP/Latex" )

  # Le format par défaut, avec deux bonnes réponses et trois mauvaises,
  qcm.moodle( "Quelle est la définition de la tangente&amp;thinsp;?",
              inserer_formule.moodle( "\\frac{\\sin x}{\\cos x}" ),
              inserer_formule.moodle( "\\frac{\\cos x}{\\sin x}" ) )

  # On termine le questionnaire
  finir_xml.moodle( )

  # Importez le fichier tangente.xml dans Moodle pour voir le résultat...
  print( "Importez le fichier exemple.xml dans Moodle pour voir le résultat..." )

## End(Not run)
</code></pre>


</div>