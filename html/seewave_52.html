<div class="container">

<table style="width: 100%;"><tr>
<td>fdoppler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Doppler effect</h2>

<h3>Description</h3>

<p>This function computes the altered frequency of a moving source due to the Doppler effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdoppler(f, c = 340, vs, vo = 0, movs = "toward", movo = "toward")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>original frequency produced by the source (in Hz or kHz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>speed of sound in meters/second.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vs</code></td>
<td>
<p>speed of the source in meters/second.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vo</code></td>
<td>
<p>speed of the observer in meters/second. The observer is static by default
<em>i.e.</em> <code>vo</code> = 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>movs</code></td>
<td>
<p>movement direction of the source in relation with observer position,
either <code>"toward"</code> (by default) or <code>"away"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>movo</code></td>
<td>
<p>movement direction of the observer in relation with the source position,
either <code>"toward"</code> (by default, but be aware that
the observer is static by default) or <code>"away"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The altered frequency <em>f'</em> is computed according to:<br></p>
<p style="text-align: center;"><code class="reqn">f{'} = f\times{\frac{c \pm v_{o}}{c \pm v_{s}}}</code>
</p>

<p>with <em>f</em> = original frequency produced by the source (in Hz or kHz),<br><em>vs</em> = speed of the source,<br><em>vo</em> = speed of the observer.
</p>


<h3>Value</h3>

<p>The altered frequency is returned in a vector.</p>


<h3>Note</h3>

<p>You can use <code>wasp</code> to have exact values of <code>c</code>.
See examples.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>See Also</h3>

<p><code>wasp</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># a 400 Hz source moving toward or away from the observer at 85 m/s
fdoppler(f=400,vs=85)
# [1] 533.3333
fdoppler(f=400,vs=85,movs="away")
# [1] 320
# use wasp() if you wish to have exact sound speed at a specific temperature
fdoppler(f=wasp(f=400,t=25)$c, vs=85)
# [1] 461.8667
# Doppler effect at different source speeds
f&lt;-seq(1,10,by=1); lf&lt;-length(f)
v&lt;-seq(10,300,by=20); lv&lt;-length(v)
res&lt;-matrix(numeric(lf*lv),ncol=lv)
for(i in 1:lv) res[,i]&lt;-fdoppler(f=f,vs=v[i])
op&lt;-par(bg="lightgrey")
matplot(x=f,y=res,type="l",lty=1,las=1,col= spectro.colors(lv),
xlab="Source frequency (kHz)", ylab="Altered frequency (kHz)")
legend("topleft",legend=paste(as.character(v),"m/s"),
lty=1,col= spectro.colors(lv))
title(main="Doppler effect at different source speeds")
par(op)
</code></pre>


</div>