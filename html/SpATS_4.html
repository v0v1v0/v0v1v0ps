<div class="container">

<table style="width: 100%;"><tr>
<td>obtain.spatialtrend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predictions of the spatial trend from an <code>SpATS</code> object 
</h2>

<h3>Description</h3>

<p>Takes a fitted <code>SpATS</code> object produced by <code>SpATS()</code> and produces predictions of the spatial trend on a regular two-dimensional array.
</p>


<h3>Usage</h3>

<pre><code class="language-R">obtain.spatialtrend(object, grid = c(100, 100), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>SpATS</code> as produced by <code>SpATS()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a numeric vector with the number of grid points along the x- and y- coordinates respectively. Atomic values are recycled. The default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each spatial coordinate, <code>grid[k]</code> equally spaced values between the minimum and the maximum are computed (k = 1, 2). The spatial trend is then predicted on the regular two-dimensional array defined by each combination of the x- and y- coordinate values. 
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>col.p</code></td>
<td>
<p>x-coordinate values at which predictions have been computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.p</code></td>
<td>
<p>y-coordinate values at which predictions have been computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a matrix of dimension length(row.p) x length(col.p) with the predicted spatial trend (excluding the intercept).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfit</code></td>
<td>
<p>for the PS-ANOVA approach, a list with 6 matrices of dimension length(row.p) x length(col.p) with each predicted spatial component (bilinear component, 2 main effects, 2 linear-by-smooth components and 1 smooth-by-smooth component).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lee, D.-J., Durban, M., and Eilers, P.H.C. (2013). Efficient two-dimensional smoothing with P-spline ANOVA mixed models and nested bases. Computational Statistics and Data Analysis, 61, 22 - 37.
</p>
<p>Rodriguez-Alvarez, M.X, Boer, M.P., van Eeuwijk, F.A., and Eilers, P.H.C. (2018). Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics, 23, 52 - 71. https://doi.org/10.1016/j.spasta.2017.10.003.
</p>


<h3>See Also</h3>

<p><code>SpATS</code>, <code>plot.SpATS</code>, <code>predict.SpATS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpATS)
data(wheatdata)
wheatdata$R &lt;- as.factor(wheatdata$row)
wheatdata$C &lt;- as.factor(wheatdata$col)

m0 &lt;- SpATS(response = "yield", spatial = ~ SAP(col, row, nseg = c(10,20)), 
 genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, 
 data = wheatdata, control =  list(tolerance = 1e-03))

spat.trend.1 &lt;- obtain.spatialtrend(m0)
spat.trend.2 &lt;- obtain.spatialtrend(m0, grid = c(10, 10))

colors = topo.colors(100)
op &lt;- par(mfrow = c(1,2))
fields::image.plot(spat.trend.1$col.p, spat.trend.1$row.p, t(spat.trend.1$fit), 
 main = "Prediction on a grid of 100 x 100", col = colors, xlab = "Columns", ylab = "Rows")
fields::image.plot(spat.trend.2$col.p, spat.trend.2$row.p, t(spat.trend.2$fit), 
 main = "Prediction on a grid of 10 x 10", col = colors, xlab = "Columns", ylab = "Rows")
par(op)
</code></pre>


</div>