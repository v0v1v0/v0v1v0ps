<div class="container">

<table style="width: 100%;"><tr>
<td>kupiec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method to backtest VaR violation using the Kupiec statistics</h2>

<h3>Description</h3>

<p>An S4 method that performs backtest for VaR models using the Kupiec statistics. For a sample of <code class="reqn">n</code> observations, 
the Kupiec test statistics takes the form of likelihood ratio
</p>
<p><code class="reqn">LR_{PoF}= -2 \log\left(\frac{(1-\alpha)^{T-n_f}\alpha^{n_f}}
                         {\left(1-\frac{n_f}{T}\right)^{T-n_f}\left(\frac{n_f}{T}\right)^{n_f}}\right)</code>
</p>
<p><code class="reqn">LR_{TFF}= -2 \log\left
 (\frac{\alpha(1-\alpha)^{t_f -1}} {\left ( \frac{1}{t_f}\right
 )\left ( 1- \frac{1}{t_f}\right )^{t_f-1}}\right),
</code>
</p>
<p>where <code class="reqn">n_f</code> denotes the number of failures occurred and 
<code class="reqn">t_f</code> the number of days until the first failure within the <code class="reqn">n</code>
observations. Under <code class="reqn">H_0</code>, both <code class="reqn">LR_{PoF}</code> and <code class="reqn">LR_{TFF}</code> are asymptotically
<code class="reqn">\chi^2_1</code>-distributed, and their exceedance of the critical value implies that the VaR model is inadequate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kupiec(y, VaR, VaR_level, verbose = TRUE, test = "PoF")

## S4 method for signature 'ANY'
kupiec(y, VaR, VaR_level, verbose = TRUE, test = "PoF")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The time series to apply a VaR model (a single asset rerurn or portfolio return).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR</code></td>
<td>
<p>The forecast VaR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR_level</code></td>
<td>
<p>The VaR level, typically 95% or 99%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code> show the outcome. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Choose between PoF or TFF. Default is <code>PoF</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kupiec, P. "Techniques for Verifying the Accuracy of Risk Management Models." Journal of Derivatives. Vol. 3, 1995, pp. 73â€“84.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pw.CCC.obj = new("simMGarch")
pw.CCC.obj@d = 10
pw.CCC.obj@n = 1000
pw.CCC.obj@changepoints = c(250,750)
pw.CCC.obj = pc_cccsim(pw.CCC.obj)
y_out_of_sample = t(pw.CCC.obj@y[,900:1000])
w=rep(1/pw.CCC.obj@d,pw.CCC.obj@d) #an equally weighted portfolio
#VaR = quantile(t(pw.CCC.obj@y[,1:899])%*%w,0.05)
#ts.plot(y_out_of_sample%*%w,ylab="portfolio return");abline(h=VaR,col="red")
#kupiec(y_out_of_sample%*%w,rep(VaR,100),.95,verbose=TRUE,test="PoF")
</code></pre>


</div>