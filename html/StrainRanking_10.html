<div class="container">

<table style="width: 100%;"><tr>
<td>DGobj.simul.mechanistic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of a DG object under a mechanistic model
</h2>

<h3>Description</h3>

<p>Simulation of a DG object under a mechanistic model generating a multi-strain epidemic with multiple introductions over a square grid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DGobj.simul.mechanistic(sqrtn, size1, size2, theta, beta, M, delta, 
 plots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sqrtn</code></td>
<td>

<p>[Positive integer] Side size of the square grid over which the epidemic is simulated. The inter-node distance in the grid is one in the horizontal and vertical directions. The total number of grid nodes is sqrtn^2. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size1</code></td>
<td>

<p>[Positive integer] Maximum number of grid nodes where pathogen isolates are collected (sampling sites).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size2</code></td>
<td>

<p>[Positive integer] Maximum number of pathogen isolates sampled in each sampling site.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>[Vector of positive numerics] Fitness coefficients of the strains. The length of this vector determines the number of strains in the epidemic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>[Vector of postive numerics of size 2] Immigration parameters. The first component is the expected number of immigration nodes for every strain. The second component is the expected number of pathogen units in each immigration node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>[Positive integer] Number of time steps of the epidemic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>[Positive numeric] Dispersal parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>

<p>[Logical] If TRUE, plots are produced. The plots show the curse of the epidemic for each strain and the proportion of each strain in space at the final time step.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The effective number of sampling sites is the maximum of <code>size1</code> and the number of sites occupied at the last time of the simulation.
</p>
<p>In each sampling site, the effective number of sampled isolates is the maximum of <code>size2</code> and the number of pathogen isolates in the site.
</p>
<p>The immigration time <code class="reqn">T^{immigr}_s</code> at which the sub-epidemic due to strain <code class="reqn">s</code>  is initiated is randomly drawn between 1 and <code>M</code> with probabilities <code class="reqn">P(T^{immigr}_s=t)=(M-t)^2/\sum_{k=1}^M (M-k)^2</code>. 
</p>
<p>The number of immigration nodes is drawn from the binomial distribution with size <code>sqrtn</code><code class="reqn">^2</code> and with expectation given by the first component of <code>beta</code>. The immigration nodes are uniformly drawn in the grid.
</p>
<p>At time <code class="reqn">T^{immigr}_s</code>, the numbers of pathogen units of strain <code class="reqn">s</code>  at the immigration nodes are independently drawn under the Poisson distribution with mean equal to the second component of <code>beta</code>.
</p>


<h3>Value</h3>

<p>An object from the DG class.
</p>


<h3>Note</h3>

<p>Demographic measurements, say <code class="reqn">Y_i(M-1)</code> and <code class="reqn">Y_i(M)</code>, made at the grid nodes and at times <code>M</code>-1 and <code>M</code>, are transformed into the values 
<code class="reqn"> Z_i=\log\left(\frac{1+Y_i(M-1)}{1+Y_i(M)}\right)</code> characterizing the temporal growth of the epidemic in space at the end of the epidemic. The growth variable <code class="reqn">Z_i</code> is given in the thrid column of the demographic slot of the returned DG object.
</p>


<h3>Author(s)</h3>

<p>Soubeyrand, S., Tollenaere, C., Haon-Lasportes, E. and Laine, A.-L. 
</p>


<h3>References</h3>

<p>Soubeyrand S., Tollenaere C., Haon-Lasportes E. &amp; Laine A.-L. (2014). Regression-based ranking of pathogen strains with respect to their contributions to natural epidemics. PLOS ONE 9(1): e86591.
</p>


<h3>See Also</h3>

<p>DGobj-class, DGobj.rawdata, DGobj.simul.regression
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulation of a data set
DGmech=DGobj.simul.mechanistic(sqrtn=10, size1=30, size2=10, theta=c(1.5,2,3), 
	beta=c(5,5), M=7, delta=0.2)
summary(DGmech)

## Simulation of a data set and plots of the sub-epidemics for the strains and their
## proportions in space at the final time step
DGmech=DGobj.simul.mechanistic(sqrtn=10, size1=30, size2=10, theta=c(1.5,2,3), 
	beta=c(5,5), M=7, delta=0.2, plots=TRUE)
summary(DGmech)
</code></pre>


</div>