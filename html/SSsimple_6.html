<div class="container">

<table style="width: 100%;"><tr>
<td>SS.ID</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
System Identification
</h2>

<h3>Description</h3>

<p>Perform non-iterative, subspace grey-box system identification
</p>


<h3>Usage</h3>

<pre><code class="language-R">SS.ID(Z, d, rsN = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>A <em>T</em> x <em>n</em> data matrix 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>A scalar integer.  The system “order.”
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsN</code></td>
<td>

<p>A 3-element integer vector, containing <em>r</em>, <em>s</em>, <em>N</em> as described by Ljung.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only works when <em>T</em> &gt;&gt; <em>n</em> (one resolved to using <code>SS.ID</code> when this is not true is free to pluck columns from Z until it is).
</p>
<p>Complaints issued from this function to the effect that a matrix that is some function of “PP” cannot be inverted might be remedied by turning <em>r</em> and <em>s</em> down (the first two elements of the <code>rsN</code> argument), or perhaps by adding a small amount of noise to Z.
</p>
<p>This is subspace estimation.  <code>SS.ID</code> estimates system hyperparameters from data.  One can usually henceforth solve (using <code>SS.solve</code>) for good quality observation-space estimates, but should not assume the resulting state estimates are anywhere near truth.  One may wish to use estimates generated with this function as initial values for iterative estimation techniques, e.g., package <code>Stem</code>.
</p>


<h3>Value</h3>

<p>A named list.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F.hat</code></td>
<td>
<p>A <em>d</em> x <em>d</em> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H.hat</code></td>
<td>
<p>An <em>n</em> x <em>d</em> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.hat</code></td>
<td>
<p>A <em>d</em> x <em>d</em> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.hat</code></td>
<td>
<p>An <em>n</em> x <em>n</em> matrix.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lennart Ljung.  <em>System Identification, Theory for the User</em>.  Prentice Hall, 1999.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Q &lt;- diag(1/10, 2)
R &lt;- diag(2, 3)
H &lt;- matrix(1, 3, 2)
F &lt;- diag(0.99, 2)

set.seed(9999)
xs &lt;- SS.sim(F, H, Q, R, 2000, rep(0, 2))

## notice that while the parameter estimates appear somewhat inaccurate ...
ssid &lt;- SS.ID( xs$Z , 2,  c(3, 6, 900) ) ; ssid

## the observation estimate:
sss &lt;- SS.solve( xs$Z, ssid$F.hat, ssid$H.hat, ssid$Q.hat, ssid$R.hat, nrow(xs$Z), 10^5, c(0,0)) 
Z.hat &lt;- t( ssid$H.hat %*% t( sss$B.apri ) )
sqrt( mean( (xs$Z - Z.hat)^2 ) )

## is nontheless very close to that using true hyperparameter values:
sss.true &lt;- SS.solve( xs$Z, F, H, Q, R, nrow(xs$Z), 10^5, c(0,0)) 
Z.hat &lt;- t( H %*% t( sss.true$B.apri ) )
sqrt( mean( (xs$Z - Z.hat)^2 ) )
</code></pre>


</div>