<div class="container">

<table style="width: 100%;"><tr>
<td>sewma.crit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute critical values of EWMA control charts (variance charts)</h2>

<h3>Description</h3>

<p>Computation of the critical values (similar to alarm limits)
for different types of EWMA control charts (based on the sample variance
<code class="reqn">S^2</code>) monitoring normal variance.</p>


<h3>Usage</h3>

<pre><code class="language-R">sewma.crit(l,L0,df,sigma0=1,cl=NULL,cu=NULL,hs=NULL,s2.on=TRUE,
sided="upper",mode="fixed",ur=4,r=40,qm=30)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L0</code></td>
<td>
<p>in-control ARL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>actual degrees of freedom, corresponds to subgroup size (for known mean it is equal to the subgroup size,
for unknown mean it is equal to subgroup size minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0</code></td>
<td>
<p>in-control standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>deployed for <code>sided</code>=<code>"Rupper"</code>, that is, upper variance control chart
with lower reflecting barrier <code>cl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cu</code></td>
<td>
<p>for two-sided (<code>sided</code>=<code>"two"</code>) and fixed upper
control limit (<code>mode</code>=<code>"fixed"</code>) a value larger than <code>sigma0</code>
has to been given, for all other cases <code>cu</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (enables fast initial response); the default (<code>NULL</code>)
yields the expected in-control value of <code class="reqn">S^2</code> (1) and <code class="reqn">S</code> (<code class="reqn">c_4</code>),
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2.on</code></td>
<td>
<p>distinguishes between <code class="reqn">S^2</code> and <code class="reqn">S</code> chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between one- and two-sided
two-sided EWMA-<code class="reqn">S^2</code> control charts
by choosing <code>"upper"</code> (upper chart
without reflection at <code>cl</code> – the actual value of
<code>cl</code> is not used),
<code>"Rupper"</code> (upper chart with reflection at <code>cl</code>),
<code>"Rlower"</code> (lower chart with reflection at <code>cu</code>),
and <code>"two"</code> (two-sided chart),
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>only deployed for <code>sided</code>=<code>"two"</code> – with <code>"fixed"</code>
an upper control limit (see <code>cu</code>) is set and only the lower is
calculated to obtain the in-control ARL <code>L0</code>, while with <code>"unbiased"</code>
a certain unbiasedness of the ARL function is guaranteed (here, both the
lower and the upper control limit are calculated). With <code>"vanilla"</code> limits symmetric
around 1 (the in-control value of the variance)
are determined, while for <code>"eq.tails"</code> the in-control ARL values of two single EWMA
variance charts (decompose the two-sided
scheme into one lower and one upper scheme) are matched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ur</code></td>
<td>
<p>truncation of lower chart for <code>eq.tails</code> mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>dimension of the resulting linear equation system
(highest order of the collocation polynomials).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qm</code></td>
<td>
<p>number of quadrature nodes for calculating the collocation definite integrals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sewma.crit</code> determines the critical values (similar to alarm limits)
for given in-control ARL <code>L0</code>
by applying secant rule and using <code>sewma.arl()</code>.
In case of <code>sided</code>=<code>"two"</code> and <code>mode</code>=<code>"unbiased"</code>
a two-dimensional secant rule is applied that also ensures that the
maximum of the ARL function for given standard deviation is attained
at <code>sigma0</code>. See Knoth (2010) and the related example.
</p>


<h3>Value</h3>

<p>Returns the lower and upper control limit <code>cl</code> and <code>cu</code>.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>H.-J. Mittag and D. Stemann and B. Tewes (1998),
EWMA-Karten zur \"Uberwachung der Streuung von Qualit\"atsmerkmalen,
<em>Allgemeines Statistisches Archiv 82</em>, 327-338,
</p>
<p>C. A. Acosta-Mej\'ia and J. J. Pignatiello Jr. and B. V. Rao (1999),
A comparison of control charting procedures for monitoring process dispersion,
<em>IIE Transactions 31</em>, 569-579.
</p>
<p>S. Knoth (2005),
Accurate ARL computation for EWMA-<code class="reqn">S^2</code> control charts,
<em>Statistics and Computing 15</em>, 341-352.
</p>
<p>S. Knoth (2006a),
Computation of the ARL for CUSUM-<code class="reqn">S^2</code> schemes,
<em>Computational Statistics &amp; Data Analysis 51</em>, 499-512.
</p>
<p>S. Knoth (2006b), 
The art of evaluating monitoring schemes – how to measure the performance of control charts?
in <em>Frontiers in Statistical Quality Control 8</em>,
H.-J. Lenz and P.-T. Wilrich (Eds.),
Physica Verlag, Heidelberg, Germany, 74-99.
</p>
<p>S. Knoth (2010),
Control Charting Normal Variance – Reflections, Curiosities, and Recommendations,
in <em>Frontiers in Statistical Quality Control 9</em>,
H.-J. Lenz and P.-T. Wilrich (Eds.),
Physica Verlag, Heidelberg, Germany, 3-18.
</p>


<h3>See Also</h3>

<p><code>sewma.arl</code> for calculation of ARL of variance charts.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Mittag et al. (1998)
## compare their upper critical value 2.91 that
## leads to the upper control limit via the formula shown below
## (for the usual upper EWMA \eqn{S^2}{S^2}).
## See Knoth (2006b) for a discussion of this EWMA setup and it's evaluation.

l  &lt;- 0.18
L0 &lt;- 250
df &lt;- 4
limits &lt;- sewma.crit(l, L0, df)
limits["cu"]

limits.cu.mittag_et_al &lt;- 1 + sqrt(l/(2-l))*sqrt(2/df)*2.91
limits.cu.mittag_et_al

## Knoth (2005)
## reproduce the critical value given in Figure 2 (c=1.661865) for
## upper EWMA \eqn{S^2}{S^2} with df=1

l  &lt;- 0.025
L0 &lt;- 250
df &lt;- 1
limits &lt;- sewma.crit(l, L0, df)
cv.Fig2 &lt;- (limits["cu"]-1)/( sqrt(l/(2-l))*sqrt(2/df) )
cv.Fig2

## the small difference (sixth digit after decimal point) stems from
## tighter criterion in the secant rule implemented in the R package.

## demo of unbiased ARL curves
## Deploy, please, not matrix dimensions smaller than 50 -- for the
## sake of accuracy, the value 80 was used.
## Additionally, this example needs between 1 and 2 minutes on a 1.6 Ghz box. 

## Not run: 
l  &lt;- 0.1
L0 &lt;- 500
df &lt;- 4
limits &lt;- sewma.crit(l, L0, df, sided="two", mode="unbiased", r=80)
SEWMA.arl &lt;- Vectorize(sewma.arl, "sigma")
SEWMA.ARL &lt;- function(sigma) 
  SEWMA.arl(l, limits[1], limits[2], sigma, df, sided="two", r=80)
layout(matrix(1:2, nrow=1))
curve(SEWMA.ARL, .75, 1.25, log="y")
curve(SEWMA.ARL, .95, 1.05, log="y")
## End(Not run)
# the above stuff needs about 1 minute

## control limits for upper and lower EWMA charts with reflecting barriers
## (reflection at in-control level sigma0 = 1)
## examples from Knoth (2006a), Tables 4 and 5

## Not run: 
## upper chart with reflection at sigma0=1 in Table 4: c = 2.4831
l &lt;- 0.15
L0 &lt;- 100
df &lt;- 4
limits &lt;- sewma.crit(l, L0, df, cl=1, sided="Rupper", r=100)
cv.Tab4 &lt;- (limits["cu"]-1)/( sqrt(l/(2-l))*sqrt(2/df) )
cv.Tab4

## lower chart with reflection at sigma0=1 in Table 5: c = 2.0613
l &lt;- 0.115
L0 &lt;- 200
df &lt;- 5
limits &lt;- sewma.crit(l, L0, df, cu=1, sided="Rlower", r=100)
cv.Tab5 &lt;- -(limits["cl"]-1)/( sqrt(l/(2-l))*sqrt(2/df) )
cv.Tab5
## End(Not run)
</code></pre>


</div>