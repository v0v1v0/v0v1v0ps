<div class="container">

<table style="width: 100%;"><tr>
<td>dmzsm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metacommunity zero-sum multinomial distribution</h2>

<h3>Description</h3>

<p>Density, distribution, quantile function and random generation
for Alonso &amp; McKane's mZSM distribution with parameter <code>theta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmzsm(x, J, theta, log = FALSE)
pmzsm(q, J, theta, lower.tail=TRUE, log.p=FALSE)
qmzsm(p, J, theta, lower.tail = TRUE, log.p = FALSE)
rmzsm(n, J, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a
vector of abundance of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>

<p>positive integer 0 &lt; J &lt; Inf, sample size.  In the context of
species abundance distributions, usually the number of individuals in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>positive real theta &gt; 0; Hubbell's ‘fundamental biodiversity number’
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The metacommunity Zero-sum multinomial distribution
(mZSM)
describes the probabilities
of abundances (population sizes)
in a random sample of size J taken from a
collection 
of populations (the metacommunity).
The total number of individuals in the metacommunity is fixed (zero-sum assumption).
The populations in the metacommunity undergo a stochastic
birth-death-immigration process,
with equal demographic rates (neutrality or ecological
equivalence assumption, Hubbell 2001).
Alonso and McKane (2004) proposed an approximation for the density
function for a large Poisson sample (J&gt;100):
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{N(x)}{\sum_1^S N(x)}</code>
</p>

<p>where S is the number of populations in the sample, and
N(x) is the expected number of sampled populations of size x :
</p>
<p style="text-align: center;"><code class="reqn">N(x) = \frac{\theta}{x (1 - x/J)^{\theta -1}}</code>
</p>

<p>Therefore, the mZSM 
is a model for species
abundances distributions (SAD)
in a sample taken from a community under
the assumptions that (a) species
abundances in the community follows the stationary distribution
of a neutral, zero-sum stochastic process of birth, death and speciation (or migration);
(b) sampling is a Poisson process with expected
value well approximated by N(x), (c) individuals are sampled with replacement, or the
fraction of total individuals sampled is small enough to approximate a
sample with replacement.
</p>


<h3>Value</h3>

<p><code>dmzsm</code> gives the (log) density function, <code>pmzsm</code> gives the (log)
distribution function, and <code>qmzsm</code> gives the quantile function.
</p>
<p>Invalid values for parameters <code>J</code> or <code>theta</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and Andre Chalom</p>


<h3>References</h3>

<p>Alonso, D. and McKane, A.J.  2004.  Sampling Hubbell's neutral
model of biodiversity. <em>Ecology Letters 7</em>:901-910.
</p>
<p>Hubbell, S.P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press.
</p>


<h3>See Also</h3>

<p><code>fitmzsm</code> for maximum likelihood estimation;
<code>alonso.eqn12</code>
in package <span class="pkg">untb</span> which is based on the exact formulation of mZSM.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Alonso &amp; McKanne (2004) figure 2
data(moths) #Fisher's moths data
m.tab &lt;- hist(moths, breaks = 2^(0:12), plot = FALSE)
plot(m.tab$density~m.tab$mids, log="xy",
     xlab = "Abundance", ylab = "Probability density",
     ylim=c(1e-7,1))
X &lt;- 1:max(moths)
Y &lt;- dmzsm(X, J = sum(moths), theta = 39.8)
lines(Y ~ X)
</code></pre>


</div>