<div class="container">

<table style="width: 100%;"><tr>
<td>kriging</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simple kriging interpolation
</h2>

<h3>Description</h3>

<p>This function interpolates a zero mean Gaussian random field using the
simple kriging predictor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kriging(data, data.coord, krig.coord, cov.mod = "whitmat", sill, range,
smooth, smooth2 = NULL, grid = FALSE, only.weights = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or matrix. If <code>data</code> is a matrix
then the simple kriging predictor is given for each realisation,
i.e., each row of <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.coord</code></td>
<td>
<p>A numeric vector or matrix specifying the
coordinates of the observed data. If <code>data.coord</code> is a matrix,
each row must corresponds to one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krig.coord</code></td>
<td>
<p>A numeric vector or matrix specifying the
coordinates where the kriging predictor has to be computed. If
<code>krig.coord</code> is a matrix, each row must correspond to one
location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string specifying the covariance function
family. Must be one of "whitmat", "powexp", "cauchy", "bessel" or
"caugen" for the Whittle-Matern, the powered exponential, the
Cauchy, the Bessel or the generalized Cauchy covariance families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sill,range,smooth,smooth2</code></td>
<td>
<p>Numerics specifiying the sill, range,
smooth and, if any, the second smooth parameters of the covariance
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical. Does <code>krig.coord</code> specifies a grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.weights</code></td>
<td>
<p>Logical. Should only the kriging weights be
computed? If <code>FALSE</code>, the kriging predictor isn't computed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>The coordinates where the kriging predictor has been
computed;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krig.est</code></td>
<td>
<p>The kriging predictor estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Does <code>coord</code> define a grid?;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A matrix giving the kriging weights: each column
corresponds to one prediction location.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathieu Ribatet
</p>


<h3>References</h3>

<p>Chiles, J.-P. and Delfiner, P. (1999) <em>Geostatistics, Modeling
Spatial Uncertainty</em> Wiley Series in Probability and Statistics.
</p>


<h3>See Also</h3>

<p><code>condrgp</code>, <code>rgp</code>, <code>covariance</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Kriging from a single realisation
n.site &lt;- 50
n.pred &lt;- 512

x.obs &lt;- runif(n.site, -100, 100)
x.pred &lt;- seq(-100, 100, length = n.pred)

data &lt;- rgp(1, x.obs, "whitmat", sill = 1, range = 10, smooth = 0.75)

krig &lt;- kriging(data, x.obs, x.pred, "whitmat", sill = 1, range = 10,
smooth = 0.75)

plot(krig$coord, krig$krig.est, type = "l", xlab = "x", ylab =
expression(hat(Y)(x)))
points(x.obs, data, col = 2, pch = 21, bg = 2)

## Kriging from several realisations
n.real &lt;- 3
data &lt;- rgp(n.real, x.obs, "whitmat", sill = 1, range = 10, smooth = 0.75)

krig &lt;- kriging(data, x.obs, x.pred, "whitmat", sill = 1, range = 10,
smooth = 0.75)

matplot(krig$coord, t(krig$krig.est), type = "l", xlab = "x", ylab =
expression(hat(Y)(x)), lty = 1)
matpoints(x.obs, t(data), pch = 21, col = 1:n.real, bg = 1:n.real)
title("Three kriging predictors in one shot")

## Two dimensional kriging on a grid
x.obs &lt;- matrix(runif(2 * n.site, -100, 100), ncol = 2)
x &lt;- y &lt;- seq(-100, 100, length = 100)
x.pred &lt;- cbind(x, y)

data &lt;- rgp(1, x.obs, "whitmat", sill = 1, range = 10, smooth = 0.75)

krig &lt;- kriging(data, x.obs, x.pred, "whitmat", sill = 1, range = 10,
smooth = 0.75, grid = TRUE)

z.lim &lt;- range(c(data, krig$krig.est))
breaks &lt;- seq(z.lim[1], z.lim[2], length = 65)
col &lt;- heat.colors(64)
idx &lt;- as.numeric(cut(data, breaks))

image(x, y, krig$krig.est, col = col, breaks = breaks)
points(x.obs, bg = col[idx], pch = 21)
## Note how the background colors of the above points matches the ones
## returned by the image function
</code></pre>


</div>