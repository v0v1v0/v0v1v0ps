<div class="container">

<table style="width: 100%;"><tr>
<td>cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the penalty coefficient from the cross-validation
criterion</h2>

<h3>Description</h3>

<p>Estimates the penalty coefficient from the cross-validation
criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv(y, x, knots, degree, plot = TRUE, n.points = 150, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector/matrix giving the values of the predictor
variable(s). If <code>x</code> is a matrix, each row corresponds to one
observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>A vector givint the coordinates of the knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The degree of the penalized smoothing spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the evolution of the CV
score as the penalty increases is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>
<p>A numeric giving the number of CV computations needed
to produce the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options to be passed to the <code>nlm</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For every linear smoother e.g. <code class="reqn">\hat{y} = S_\lambda y</code>, the cross-validation criterion consists in minimizing
the following quantity:
</p>
<p style="text-align: center;"><code class="reqn">CV(\lambda) = \sum_{i=1}^n \left(\frac{y_i - \hat{y}_i}{1 -
      S_{\lambda,ii}} \right)^2</code>
</p>

<p>where <code class="reqn">\lambda</code> is the penalty coefficient, <code class="reqn">n</code> the
number of observations and <code class="reqn">S_{\lambda,ii}</code> the
i-th diagonal element of the matrix <code class="reqn">S_\lambda</code>.
</p>


<h3>Value</h3>

<p>A list with components 'penalty', 'cv' and 'nlm.code' which give the
location of the minimum, the value of the cross-validation
criterion at that point and the code returned by the <code>nlm</code>
function - useful to assess for convergence issues.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Ruppert, D. Wand, M.P. and Carrol, R.J. (2003) <em>Semiparametric
Regression</em> Cambridge Series in Statistical and Probabilistic
Mathematics.
</p>


<h3>See Also</h3>

<p><code>cv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 200
x &lt;- runif(n)
fun &lt;- function(x) sin(3 * pi * x)
y &lt;- fun(x) + rnorm(n, 0, sqrt(0.4))
knots &lt;- quantile(x, prob = 1:(n/4) / (n/4 + 1))
cv(y, x, knots = knots, degree = 3)
</code></pre>


</div>