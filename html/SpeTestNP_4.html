<div class="container">

<table style="width: 100%;"><tr>
<td>SpeTest_Stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric specification test statistic
</h2>

<h3>Description</h3>

<p><code>SpeTest</code> computes the nonparametric specification test statistic for one of five different tests
</p>


<h3>Usage</h3>

<pre><code class="language-R">SpeTest_Stat(eq, type="icm", norma="no", ker="normal", knorm="sd",
cch="default", hv="default", nbeta="default", direct="default", 
alphan="default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eq</code></td>
<td>

<p>A fitted model of class <code>lm</code> or <code>nls</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Test statistic type
</p>
<p>If <code>type = "icm"</code> the test statistic of Bierens (1982) is returned (default)
</p>
<p>If <code>type = "zheng"</code> the test statistic of Zheng (1996) is returned
</p>
<p>If <code>type = "esca"</code> the test statistic of Escanciano (2006) is returned, significantly increases computing time
</p>
<p>If <code>type = "pala"</code> the test statistic of Lavergne and Patilea (2008) is returned
</p>
<p>If <code>type = "sicm"</code> the test statistic of Lavergne and Patilea (2012) is returned
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norma</code></td>
<td>

<p>Normalization of the test statistic
</p>
<p>If <code>norma = "no"</code> the test statistic is not normalized (default)
</p>
<p>If <code>norma = "naive"</code> the test statistic is normalized with a naive estimator of the variance of its components
</p>
<p>If <code>norma = "np"</code> the test statistic is normalized with a nonparametric estimator of the variance of its components
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ker</code></td>
<td>

<p>Kernel function used in the central matrix and for the nonparametric covariance estimator
</p>
<p>If <code>ker = "normal"</code> the central matrix kernel function is the normal p.d.f (default)
</p>
<p>If <code>ker = "triangle"</code> the central matrix kernel function is the triangular p.d.f
</p>
<p>If <code>ker = "logistic"</code> the central matrix kernel function is the logistic p.d.f
</p>
<p>If <code>ker = "sinc"</code> the central matrix kernel function is the sine cardinal function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knorm</code></td>
<td>

<p>Normalization of the kernel function
</p>
<p>If <code>knorm = "sd"</code> then the standard deviation using the kernel function equals 1 (default)
</p>
<p>If <code>knorm ="sq"</code> then the integral of the squared kernel function equals 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cch</code></td>
<td>

<p>Central matrix kernel bandwidth 
</p>
<p>If <code>type = "icm"</code> or <code>type = "esca"</code> then <code>cch</code> always equals <code>1</code>
</p>
<p>If <code>type = "zheng"</code> the <code>"default"</code> bandwidth is the scaled
rule of thumb: <code>cch = 1.06*n^(-1/(4+k))</code> where <code>k</code> is
the number of regressors
</p>
<p>If <code>type = "sicm"</code> or <code>type = "pala"</code> the <code>"default"</code>
bandwidth is the scaled rule of thumb: <code>cch = 1.06*n^(-1/5)</code>
</p>
<p>The user may change the bandwidth when <code>type = "zheng"</code>, <code>type = "sicm"</code> or <code>type = "pala"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hv</code></td>
<td>

<p>If <code>norma = "np"</code> or <code>rejection = "bootstrap"</code> and <code>boot = "smooth"</code>, <code>hv</code> is the bandwidth of the nonparametric errors covariance estimator, by <code>"default"</code> the bandwidth is the scaled rule of thumb <code>hv = 1.06*n^(-1/(4+k))</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbeta</code></td>
<td>

<p>If <code>type = "pala"</code> or <code>type = "sicm"</code>, <code>nbeta</code> is the number of "betas" in the unit hypersphere used to compute the statistic, computing time increases as <code>nbeta</code> gets larger
</p>
<p>By <code>"default"</code> it is equal to 20 times the square root of the number of exogenous control variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direct</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>direct</code> is the favored direction for beta, by <code>"default"</code> it is the OLS estimator if <code>class(eq) = "lm"</code>
</p>
<p>If <code>type = "sicm"</code>, <code>direct</code> is the initial direction for beta. This direction should be a vector of <code>0</code> (for no direction), <code>1</code> (for positive direction) and <code>-1</code> (for negative direction)
</p>
<p>For ex, <code>c(1,-1,0)</code> indicates that the user thinks that the first regressor has a positive effect on the dependent variable, that the second regressor has a negative effect on the dependent variable, and that he has no idea about the effect of the third regressor
</p>
<p>By <code>"default"</code> no direction is given to the hypersphere
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphan</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>alphan</code> is the weight given to the favored direction for beta, by <code>"default"</code> it is equal to <code>log(n)*n^(-3/2)</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To compute the specification test statistic the only argument needed is a model <code>eq</code> of class <code>lm</code> or of class <code>nls</code>.
But other options can and should be specified: the test statistic type <code>type</code>, the normalization of the test statistic <code>norma</code>, the central matrix kernel function <code>ker</code> and its standardization <code>ker</code>, the bandwidths <code>cch</code> and <code>hv</code>. If the user has knowledge of the tests coined by Lavergne and Patilea he may choose a higher number of betas for the hypersphere (which may significantly increase computational time) and an initial "direction" to the hypersphere for the SICM test (none is given by <code>"default"</code>) or a starting beta for the PALA test (which is the OLS estimator by <code>"default"</code> if <code>class(eq) = "nls"</code>).
</p>
<p>The statistic can be normalized with a naive estimator of the conditional covariance of its elements as in Zheng (1996), or with a nonparametric estimator of the conditional covariance of its elements as in in Yin, Geng, Li, Wang (2010).
</p>


<h3>Value</h3>

<p><code>SpeTest_Stat</code> returns the nonparametric specification test statistic
</p>


<h3>Note</h3>

<p>The data used to obtain the fitted model <code>eq</code> should not contain factors, factor variables should be transformed into dummy variables a priori
</p>
<p>Requires the packages <code>stats</code>  (already installed and loaded by default in Rstudio), <code>foreach</code>, <code>parallel</code> and <code>doParallel</code> (if parallel computing is used to generate the vector) to be installed
</p>
<p>For more information and to be able to use the package to its full potential see the references
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>References</h3>

<p>H.J. Bierens (1982), "Consistent Model Specification Test",
<cite>Journal of Econometrics</cite>, 20 (1), 105-134
</p>
<p>J.C. Escanciano (2006), "A Consistent Diagnostic Test for Regression Models using Projections",
<cite>Economic Theory</cite>, 22 (6), 1030-1051
</p>
<p>P.L. Gozalo (1997), "Nonparametric Bootstrap Analysis with Applications to Demographic Effects in Demand Functions",
<cite>Journal of Econometrics</cite>, 81 (2), 357-393
</p>
<p>P. Lavergne and V. Patilea (2008), "Breaking the Curse of Dimensionality in Nonparametric Testing", <cite>Journal of Econometrics</cite>, 143 (1), 103-122
</p>
<p>P. Lavergne and V. Patilea (2012), "One for All and All for One: Regression Checks with Many Regressors",
<cite>Journal of Business and Economic Statistics</cite>, 30 (1), 41-52
</p>
<p>C.F.J. Wu (1986), "Jackknife, bootstrap and other resampling methods in regression analysis (with discussion)", <cite>Annals of Statistics</cite>, 14 (4), 1261-1350
</p>
<p>J. Yin, Z. Geng, R. Li, H. Wang (2010), "Nonparametric covariance model",
<cite>Statistica Sinica</cite>, 20 (1), 469-479
</p>
<p>J.X. Zheng (1996), "A Consistent Test of Functional Form via Nonparametric Estimation Techniques",
<cite>Journal of Econometrics</cite>, 75 (2), 263-289
</p>


<h3>See Also</h3>

<p><code>SpeTest</code> is the function which performs a specification test and records it along with all its options in an object of class <code>STNP</code>
</p>
<p><code>SpeTest_Dist</code> generates a vector drawn from the distribution of the test statistic under the null hypothesis using the bootstrap
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)

SpeTest_Stat(eq=eq,type="icm")

eq&lt;-nls(out~expla1*a+b*expla2+c,start=list(a=0,b=4,c=2),
data=data.frame(out=y,expla1=x[,1],expla2=x[,2]))

SpeTest_Stat(eq=eq,type="icm")

</code></pre>


</div>