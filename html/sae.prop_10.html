<div class="container">

<table style="width: 100%;"><tr>
<td>saeFH.mprop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EBLUPs based on a Multivariate Fay Herriot model with Additive Logistic Transformation</h2>

<h3>Description</h3>

<p>This function gives the transformed EBLUP and Empirical Best Predictor (EBP) based on a multivariate Fay-Herriot model. This function is used for multinomial compositional data. If data has <code class="reqn">P</code> as proportion and total of <code class="reqn">q</code> categories <code class="reqn">(P_{1} + P_{2} + \dots + P_{q} = 1)</code>, then function should be used to estimate <code class="reqn">{P_{1}, P_{2}, \dots, P_{q-1}}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">saeFH.mprop(formula, vardir, MAXITER = 100, PRECISION = 1e-04, L = 1000, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> that describe the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>sampling variances of direct estimations. If data is defined, it is a vector containing names of sampling variance columns. If data is not defined, it should be a data frame of sampling variances of direct estimators. The order is <code class="reqn">var1, var2, \dots, var(q-1), cov12, \dots, cov1(q-1), cov23, \dots, cov(q-2)(q-1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of Monte Carlo iterations in calculating Empirical Best Predictor (EBP), Default: <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>vardir</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table><tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>a list containing data frame of the estimators for each domains.</p>
</td>
</tr></table>
<ul>
<li> <p><code>PC</code> : transformed EBLUP estimators using inverse alr for each category.
</p>
</li>
<li> <p><code>EBP</code> : Empirical Best Predictor using Monte Carlo for each category.
</p>
</li>
</ul>
<table><tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a list containing the following objects (model is fitted using REML):</p>
</td>
</tr></table>
<ul>
<li> <p><code>convergence</code> : a logical value equal to <code>TRUE</code> if Fisher-scoring algorithm converges in less than <code>MAXITER</code> iterations.
</p>
</li>
<li> <p><code>iterations</code> : number of iterations performed by the Fisher-scoring algorithm.
</p>
</li>
<li> <p><code>estcoef</code> : a data frame that contains the estimated model coefficients, standard errors, t-statistics, and p-values of each coefficient.
</p>
</li>
<li> <p><code>refvar</code> : estimated covariance matrix of random effects.
</p>
</li>
</ul>
<table><tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>a list containing the following objects:</p>
</td>
</tr></table>
<ul>
<li> <p><code>random.effects</code> : data frame containing estimated random effect values of the fitted model for each category.
</p>
</li>
<li> <p><code>residuals</code> : data frame containing residuals of the fitted model for each category.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Load dataset
data(datasaem)

## If data is defined
Fo = list(Y1 ~ X1,
          Y2 ~ X2,
          Y3 ~ X3)
vardir = c("v1", "v2", "v3", "v12", "v13", "v23")
model.data &lt;- saeFH.mprop(Fo, vardir, data = datasaem)

Fo = list(datasaem$Y1 ~ datasaem$X1,
          datasaem$Y2 ~ datasaem$X2,
          datasaem$Y3 ~ datasaem$X3)
vardir = datasaem[, c("v1", "v2", "v3", "v12", "v13", "v23")]
model &lt;- saeFH.mprop(Fo, vardir)

## See the estimators
model$est

## End(Not run)

</code></pre>


</div>