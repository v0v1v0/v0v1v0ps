<div class="container">

<table style="width: 100%;"><tr>
<td>spsur-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial Seemingly Unrelated Regression Models.</h2>

<h3>Description</h3>

<p><span class="pkg">spsur</span> offers the user a collection of functions to estimate Spatial 
Seemingly Unrelated Regression (SUR) models by maximum likelihood or 
three-stage least squares, using spatial instrumental variables. 
Moreover, <span class="pkg">spsur</span> obtains a collection of misspecification
tests for omitted or wrongly specified spatial structure. The user will 
find spatial models more popular in applied research such as the SUR-SLX, 
SUR-SLM, SUR-SEM, SUR-SDM, SUR-SDEM SUR-SARAR and SUR-GNM 
plus the spatially independent SUR, or SUR-SIM.
</p>


<h3>Details</h3>

<p>Some functionalities that have been included in <span class="pkg">spsur</span> package are:
</p>


<h3>1. Testing for spatial effects</h3>

<p>The function <code>lmtestspsur</code> provides a collection of 
Lagrange Multipliers, LM, for testing different forms of spatial 
dependence in SUR models. They are extended versions of
the well-known LM tests for omitted lags of the explained variable in 
the right hand side of the equation, LM-SLM, the LM tests for omitted 
spatial errors, LM-SEM, the join test of omitted spatial lags and 
spatial errors, LM-SARAR, and the robust version of the firt
two Lagrange Multipliers, LM*-SLM  and LM*-SEM. <br>
These tests can be applied to models always with a SUR nature. Roughly, 
we may distinguish two situations:
</p>

<ul>
<li>
<p> Datasets with a single equation <em>G=1</em>, for different time 
periods <em>Tm&gt;1</em> and a certain number of spatial units in the 
cross-sectional dimension, <em>N</em>. This is what we call
<em>spatial panel datasets</em>. In this case, the SUR structure appears 
in form of (intra) serial dependence in the errors of each spatial unit.
</p>
</li>
<li>
<p> Datasets with a several equations <em>G&gt;1</em>, different time 
periods <em>Tm&gt;1</em> and a certain number of spatial units, <em>N</em>. 
The SUR structure appears, as usual, because the errors
of the spatial units for different equations are contemporaneously 
correlated.
</p>
</li>
</ul>
<h3>2. Estimation of the Spatial SUR models</h3>

<p>As indicated above, <span class="pkg">spsur</span> package may work with a list of 
different spatial specifications.
They are the following:
</p>

<ul>
<li> <p><em>SUR-SIM</em>: SUR model without spatial effects
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} =  X_{tg} \beta_{g} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SLX</em>: SUR model with spatial lags of the regresors
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = X_{tg} \beta_{g} + 
                           WX_{tg} \theta_{g} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SLM</em>: SUR model with spatial lags of the endogenous
</p>
<p style="text-align: center;"><code class="reqn">y_{tg} = \rho_{g} Wy_{tg} + X_{tg} \beta_{g} + 
                          \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SEM</em>: SUR model with spatial errors
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = X_{tg} \beta_{g} + u_{tg} </code>
</p>

<p style="text-align: center;"><code class="reqn"> u_{tg} = \lambda_{g} Wu_{tg} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SDM</em>: SUR model with spatial lags of the endogenous 
variable and of the regressors or Spatial Durbin model
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = \rho_{g} Wy_{tg} + X_{tg} \beta_{g} + 
                            WX_{tg} \theta_{g} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SDEM</em>: SUR model with spatial errors and spatial 
lags of the endogenous variable and of the regressors
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = X_{tg} \beta_{g} + WX_{tg} \theta_{g} + u_{tg} </code>
</p>

<p style="text-align: center;"><code class="reqn"> u_{tg} = \lambda_{g} W u_{tg} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-SARAR</em>: Spatial lag model with spatial errors
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = \rho_{g} Wy_{tg} + X_{tg} \beta_{g} + 
                             u_{tg} </code>
</p>

<p style="text-align: center;"><code class="reqn"> u_{tg} = \lambda_{g} W u_{tg} + \epsilon_{tg} </code>
</p>

</li>
<li> <p><em>SUR-GNM</em>: SUR model with spatial lags of the explained 
variables, regressors and spatial errors
</p>
<p style="text-align: center;"><code class="reqn"> y_{tg} = \rho_{g} Wy_{tg} + X_{tg} \beta_{g} + 
                        WX_{tg} \theta_{g} + u_{tg} </code>
</p>

<p style="text-align: center;"><code class="reqn"> u_{tg} = \lambda_{g} W u_{tg} + \epsilon_{tg} </code>
</p>

</li>
</ul>
<p>where <code class="reqn">y_{tg}</code>, <code class="reqn">u_{tg}</code> and <code class="reqn">\epsilon_{tg}</code> are 
<em>(Nx1)</em> vectors; <code class="reqn">X_{tg}</code> is a matrix of regressors of 
order <em>(NxP)</em>; <code class="reqn">\rho_{g}</code> and <code class="reqn">\lambda_{g}</code> are 
parameters of spatial dependence and <em>W</em> is the
<em>(NxN)</em> spatial weighting matrix.
</p>
<p>These specifications can be estimated by maximum-likelihood 
methods, using the function <code>spsurml</code>. Moroever, 
the models that include spatial lags of the explained
variables in the right hand side of the equations, and the 
errors are assumed to be spatially incorrelated (namely, the 
SUR-SLM and the SUR-SDM), can also be estimated using
three-stage least-squares, <code>spsur3sls</code>, 
using spatial instrumental variable to correct for the problem of
endogeneity present in these cases.
</p>


<h3>3. Diagnostic tests</h3>

<p>Testing for inconsistencies or misspecifications in the results of an 
estimated (SUR) model should be a primary task for the user. <span class="pkg">spsur</span> 
focuses, especifically, on two main question such as omitted
or wrongly specified spatial structure and the existence of structural 
breaks or relevant restrictions
in the parameters of the model. In this sense, the user will find:
</p>

<ol>
<li> <p><em>Marginal tests</em> <br>
The Marginal Multipliers test for omitted or wrongly specified spatial 
structure in the equations. They are routinely part of the output of 
the maximum-likelihood estimation, shown by <code>spsurml</code>. 
In particular, the LM(<code class="reqn">\rho</code>|<code class="reqn">\lambda</code>) tests for omitted 
spatial lags in a model specified with spatial errors (SUR-SEM; 
SUR-SDEM). The LM(<code class="reqn">\lambda</code>|<code class="reqn">\rho</code>) tests for omitted 
spatial error in a model specified with spatial lags
of the explained variable (SUR-SLM; SUR-SDM).
</p>
</li>
<li> <p><em>Coefficients stability tests</em> <br><span class="pkg">spsur</span> includes two functions designed to test for linear 
restrictions on the <code class="reqn">\beta</code> coefficients of the models and on 
the spatial coefficients (<code class="reqn">\rho</code>s and <code class="reqn">\lambda</code>s terms). 
The function for the first case is <code>wald_betas</code> and
<code>wald_deltas</code> that of the second case. The user has 
ample flexibility to define different forms of linear restrictions, 
so that it is possible, for example,
to test for their time constancy to identify structural breaks.
</p>
</li>
</ol>
<h3>4. Marginal effects</h3>

<p>In recent years, since the publication of LeSage and Pace (2009), 
it has become popular in
spatial econometrics to evaluate the multiplier effects that a change in 
the value of a regressor, in a point in the space, has on the explained 
variable. <span class="pkg">spsur</span> includes a function, <code>impacts</code>, 
that computes these effects. Specifically, <code>impacts</code> obtains
the average, over the <em>N</em> spatial units and <em>Tm</em> time periods, 
of such a change on the contemporaneous value of the explained variable 
located in the same point as the modified variable. This is the 
so-called <em>Average Direct effect</em>. The <em>Average Indirect 
effect</em> measure the proportion of the impact that spills-over to other 
locations. The sum of the two effects is the <em>Average Total effect</em>. 
<br>
These estimates are complemented with a measure of statistical 
significance, following the randomization approach suggested by 
LeSage and Pace (2009).
</p>


<h3>5. Additional functionalities</h3>

<p>A particular feature of <span class="pkg">spsur</span> is that the package allows to 
obtain simulated datasets with a SUR nature and the spatial structure 
decided by the user. This is the purpose of the function 
<code>dgp_spsur</code>. The function can be inserted into a more 
general code to solve, for example, Monte Carlo studies related to 
these type of models or, simply, to show some of the stylized 
characteristics of a SUR model with certain spatial structure.
</p>


<h3>Datasets</h3>

<p><span class="pkg">spsur</span> includes three different datasets: spc, NCOVR and spain.covid. These 
sets are used to 
illustrate the capabilities of different functions. Briefly, their 
main characteristics are the following <br></p>

<ul>
<li>
<p> The <em>spc</em> dataset (Spatial Phillips-Curve) is a 
classical dataset taken from Anselin (1988, p. 203), of small 
dimensions.
</p>
</li>
<li>
<p> The <em>NCOVR</em> dataset comprises Homicides and a list of 
selected socio-economic variables for continental U.S. counties 
in four decennial census years: 1960, 1970, 1980 and 1990. 
It is freely available from
<a href="https://geodacenter.github.io/data-and-lab/ncovr/">https://geodacenter.github.io/data-and-lab/ncovr/</a>. 
<em>NCOVR</em> is a typical spatial panel dataset <em>(G=1)</em>.
</p>
</li>
<li>
<p> The <em>spain.covid</em> dataset comprises Within and Exit mobility index 
together with the weeklly incidence COVID-19 at Spain provinces from 
February 21 to May 21 2020. 
<a href="https://www.mitma.gob.es/ministerio/covid-19/evolucion-movilidad-big-data">https://www.mitma.gob.es/ministerio/covid-19/evolucion-movilidad-big-data</a>
</p>
</li>
</ul>
<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;">
  Fernando Lopez  </td>
<td style="text-align: left;"> <a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Roman Minguez  </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Jesus Mur  </td>
<td style="text-align: left;"> <a href="mailto:jmur@unizar.es">jmur@unizar.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Breusch T, Pagan A (1980). The Lagrange multiplier test
and its applications to model specification in econometrics.
<em>Review of Economic Studies</em> 47: 239-254.
</p>
</li>
<li>
<p> LeSage, J., and Pace, R. K. (2009). <em>Introduction to
spatial econometrics</em>. Chapman and Hall/CRC.
</p>
</li>
<li>
<p> Lopez, F.A., Mur, J., and Angulo, A. (2014). Spatial model
selection strategies in a SUR framework. The case of regional
productivity in EU. <em>Annals of Regional Science</em>,
53(1), 197-220.
&lt;doi:10.1007/s00168-014-0624-2&gt;
</p>
</li>
<li>
<p> Lopez, F.A., Martinez-Ortiz, P.J., and Cegarra-Navarro, J.G.
(2017). Spatial spillovers in public expenditure on a municipal
level in Spain. <em>Annals of Regional Science</em>, 58(1), 39-65.
&lt;doi:10.1007/s00168-016-0780-7&gt;
</p>
</li>
<li>
<p> Minguez, R., Lopez, F.A. and Mur, J.  (2022).
spsur: An R Package for Dealing with Spatial 
Seemingly Unrelated Regression Models. 
<em>Journal of Statistical Software</em>, 
104(11), 1â€“43.
&lt;doi:10.18637/jss.v104.i11&gt;
</p>
</li>
<li>
<p> Mur, J., Lopez, F., and Herrera, M. (2010). Testing for spatial
effects in seemingly unrelated regressions. <em>Spatial Economic
Analysis</em>, 5(4), 399-440.
&lt;doi:10.1080/17421772.2010.516443&gt;
</p>
</li>
</ul>
</div>