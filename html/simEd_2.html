<div class="container">

<table style="width: 100%;"><tr>
<td>accrej</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Acceptance-Rejection Algorithm Visualization</h2>

<h3>Description</h3>

<p>This function animates the process of generating variates via
acceptance-rejection for a specified density function (pdf) bounded
by a specified majorizing function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">accrej(
  n = 20,
  pdf = function(x) dbeta(x, 3, 2),
  majorizingFcn = NULL,
  majorizingFcnType = NULL,
  support = c(0, 1),
  seed = NA,
  maxTrials = Inf,
  plot = TRUE,
  showTitle = TRUE,
  plotDelay = plot * -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of variates to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>desired probability density function from which random
variates are to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>majorizingFcn</code></td>
<td>
<p>majorizing function.  Default value is NULL,
corresponding to a constant majorizing function that is
1.01 times the maximum value of the pdf. May
alternatively be provided as a user-specified function,
or as a data frame requiring additional notation as
either piecewise-constant or piecewise-linear.  See
examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>majorizingFcnType</code></td>
<td>
<p>used to indicate whether a majorizing function that
is provided via data frame is to be interpreted as
either piecewise-constant (<code>"pwc"</code>) or
piecewise-linear (<code>"pwl"</code>).  If the majorizing
function is either the default or a user-specified
function (closure), the value of this parameter is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support</code></td>
<td>
<p>the lower and upper bounds of the support of the
probability distribution of interest, specified as a
two-element vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>initial seed for the uniform variates used during generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxTrials</code></td>
<td>
<p>maximum number of accept-reject trials; infinite by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if TRUE, visual display will be produced.  If FALSE,
generated variates will be returned without visual display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTitle</code></td>
<td>
<p>if TRUE, display title in the main plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotDelay</code></td>
<td>
<p>wait time, in seconds, between plots; -1 (default) for interactive
mode, where the user is queried for input to progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are three modes for visualizing the acceptance-rejection
algorithm for generating random variates from a particular
probability distribution:
</p>

<ul>
<li>
<p> interactive advance (<code>plotDelay = -1</code>), where
pressing the 'ENTER' key advances to the next step
(an accepted random variate) in the algorithm,
typing 'j #' jumps ahead # steps,
typing 'q' quits immediately,
and typing 'e' proceeds to the end;
</p>
</li>
<li>
<p> automatic advance (<code>plotDelay</code> &gt; 0); or
</p>
</li>
<li>
<p> final visualization only (<code>plotDelay = 0</code>).
</p>
</li>
</ul>
<p>As an alternative to visualizing, variates can be generated
</p>


<h3>Value</h3>

<p>Returns the n generated variates accepted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
accrej(n = 20, seed = 8675309, plotDelay = 0)
accrej(n = 10, seed = 8675309, plotDelay = 0.1)

# interactive mode
if (interactive()) {
  accrej(n = 10, seed = 8675309, plotDelay = -1)
}

# Piecewise-constant majorizing function
m &lt;- function(x) {
  if      (x &lt; 0.3)  1.0 
  else if (x &lt; 0.85) 2.5
  else               1.5
}
accrej(n = 10, seed = 8675309, majorizingFcn = m, plotDelay = 0)

# Piecewise-constant majorizing function as data frame
m &lt;- data.frame(
  x = c(0.0, 0.3, 0.85, 1.0),
  y = c(1.0, 1.0, 2.5,  1.5))
accrej(n = 10, seed = 8675309, majorizingFcn = m, 
       majorizingFcnType = "pwc", plotDelay = 0)

# Piecewise-linear majorizing function as data frame
m &lt;- data.frame(
   x = c(0.0, 0.1, 0.3, 0.5, 0.7, 1.0), 
   y = c(0.0, 0.5, 1.1, 2.2, 1.9, 1.0))
accrej(n = 10, seed = 8675309, majorizingFcn = m, 
       majorizingFcnType = "pwl", plotDelay = 0)

# invalid majorizing function; should give warning
try(accrej(n = 20, majorizingFcn = function(x) dbeta(x, 1, 3), plotDelay = 0))

# Piecewise-linear majorizing function with power-distribution density function
m &lt;- data.frame(x = c(0, 1, 2), y = c(0, 0.375, 1.5))
samples &lt;- accrej(n = 10, pdf = function(x) (3 / 8) * x ^ 2, support = c(0,2),
                  majorizingFcn = m, majorizingFcnType = "pwl", plotDelay = 0)

</code></pre>


</div>