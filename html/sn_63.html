<div class="container">

<table style="width: 100%;"><tr>
<td>st.prelimFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute preliminary estimates for a linear model with ST-distributed error term
</h2>

<h3>Description</h3>

<p>For a univariate or multivariate linear model where the error term
is assumed to have skew-<em>t</em> (ST) distribution and the location parameter
is a linear function of a set of explanatory values, the functions compute
preliminary estimates to be used as initial values for a subsequent
maximization of the likelihood function.
These functions are mainly intended for internal package use.</p>


<h3>Usage</h3>

<pre><code class="language-R">st.prelimFit(x, y, w, quick = TRUE, verbose = 0, max.nu = 30, SN=FALSE)
mst.prelimFit(x, y, w, quick = TRUE, verbose = 0, max.nu = 30, SN=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>design matrix of numeric values. It may be missing;
if present, the first column must contain all 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of observations of length <code>n</code>,
or a matrix with <code>n</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a vector of non-negative integer weights of length <code>n</code>; 
if missing, a vector of all 1's is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quick</code></td>
<td>
<p>logical value which regulates whether a very quick estimate 
is produced (default value <code>TRUE</code>); 
see ‘Details’ for additional information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an integer value which regulates the amount of messages
printed out; default value is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.nu</code></td>
<td>
<p>threshold for the estimated degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SN</code></td>
<td>
<p>logical value (default value: <code>FALSE</code>); 
if <code>TRUE</code>, a <abbr><span class="acronym">SN</span></abbr> distribution is assumed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The underlying methodology is the one presented by Azzalini and Salehi (2020).
In its essence, it is based on the selection of parameter values achieving the 
best matching between certain quantile-based summaries of the ST distribution
and the corresponding empirical quantities for the sample or, in the presence 
of explanatory variables, the same quantities computed from the residuals 
after fitting a median regression.
</p>
<p>Argument <code>quick</code> selects whether the above-described matching is performed
in a quick or in an accurate way. Since the output values of this function are 
intended to be only initial values for subsequent likelihood maximization,
this explains the default option <code>quick=TRUE</code>. Other possible values
are <code>FALSE</code> and <code>NULL</code>; the latter simply sets <code>alpha=0</code>
and <code>nu=10</code>.
</p>
<p>Since the methodology hinges on some selected sample quantiles, 
it can occasionally be spoiled by poor behaviour of these basic quantiles,
especially for small or moderate sample sizes.
The more visible effect of such situation is a very large value of the
estimated degrees of freedom, which then hampers rather than help a
subsequent likelihood maximization. It is therefore appropriate to set
an upper limit <code>max.nu</code> to this component.
</p>
<p>Argument <code>x</code> may be missing. In this case, a one-column matrix with
all elements 1 is created.
</p>


<h3>Value</h3>

<p>A call to <code>st.prelimFit</code> returns a list with these components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>a vector of estimates in the DP parameterization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a vector of residual values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the corresponding log-likelihood value</p>
</td>
</tr>
</table>
<p>A call to <code>mst.prelimFit</code> returns a list with these components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>a list with the estimates in the DP parameterization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink.steps</code></td>
<td>
<p>the number of shrinking steps applied to the original 
estimate of the scale matrix to obtain an admissible matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp.matrix</code></td>
<td>
<p>a numeric matrix formed by the component-wise DP estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the corresponding log-likelihood value</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>These functions are mainly intended to be called by <code>selm</code>,
but they could be of interest for people developing their own procedures.</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. and Salehi, M. (2020).
Some computational aspects of maximum likelihood estimation of the 
skew-<em>t</em> distribution.
In: <em>Computational and Methodological Statistics and Biostatistics</em>,
edited by  Andriëtte Bekker, Ding-Geng Chen and Johannes T. Ferreira.
Springer. DOI: 10.1007/978-3-030-42196-0

</p>


<h3>See Also</h3>

<p><code>selm</code> and  either <code>dst</code> or 
<code>dmst</code> for explanation of the DP parameters</p>


<h3>Examples</h3>

<pre><code class="language-R">data(barolo)
attach(barolo)  
A75 &lt;- (reseller=="A" &amp; volume==75)  
log.price &lt;- log(price[A75], 10)
prelimFit &lt;- st.prelimFit(y=log.price)
detach(barolo)
# 
data(ais)
attach(ais)
prelim32 &lt;- mst.prelimFit(y=cbind(BMI, LBM), x=cbind(1, Ht, Wt))
detach(ais)
</code></pre>


</div>