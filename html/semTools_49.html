<div class="container">

<table style="width: 100%;"><tr>
<td>kd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate data via the Kaiser-Dickman (1962) algorithm.</h2>

<h3>Description</h3>

<p>Given a covariance matrix and sample size, generate raw data that correspond
to the covariance matrix.  Data can be generated to match the covariance
matrix exactly, or to be a sample from the population covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kd(covmat, n, type = c("exact", "sample"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covmat</code></td>
<td>
<p>a symmetric, positive definite covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size for the data that will be generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of data generation. <code>exact</code> generates data that
exactly correspond to <code>covmat</code>.  <code>sample</code> treats <code>covmat</code> as
a poulation covariance matrix, generating a sample of size <code>n</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, R's <code>cov()</code> function divides by <code>n</code>-1.  The data
generated by this algorithm result in a covariance matrix that matches
<code>covmat</code>, but you must divide by <code>n</code> instead of <code>n</code>-1.
</p>


<h3>Value</h3>

<p><code>kd</code> returns a data matrix of dimension <code>n</code> by
<code>nrow(covmat)</code>.
</p>


<h3>Author(s)</h3>

<p>Ed Merkle (University of Missouri; <a href="mailto:merklee@missouri.edu">merklee@missouri.edu</a>)
</p>


<h3>References</h3>

<p>Kaiser, H. F. and Dickman, K. (1962).  Sample and population
score matrices and sample correlation matrices from an arbitrary population
correlation matrix.  <em>Psychometrika, 27</em>(2), 179â€“182.
<a href="https://doi.org/10.1007/BF02289635">doi:10.1007/BF02289635</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#### First Example

## Get data
dat &lt;- HolzingerSwineford1939[ , 7:15]
hs.n &lt;- nrow(dat)

## Covariance matrix divided by n
hscov &lt;- ((hs.n-1)/hs.n) * cov(dat)

## Generate new, raw data corresponding to hscov
newdat &lt;- kd(hscov, hs.n)

## Difference between new covariance matrix and hscov is minimal
newcov &lt;- (hs.n-1)/hs.n * cov(newdat)
summary(as.numeric(hscov - newcov))

## Generate sample data, treating hscov as population matrix
newdat2 &lt;- kd(hscov, hs.n, type = "sample")

#### Another example

## Define a covariance matrix
covmat &lt;- matrix(0, 3, 3)
diag(covmat) &lt;- 1.5
covmat[2:3,1] &lt;- c(1.3, 1.7)
covmat[3,2] &lt;- 2.1
covmat &lt;- covmat + t(covmat)

## Generate data of size 300 that have this covariance matrix
rawdat &lt;- kd(covmat, 300)

## Covariances are exact if we compute sample covariance matrix by
## dividing by n (vs by n - 1)
summary(as.numeric((299/300)*cov(rawdat) - covmat))

## Generate data of size 300 where covmat is the population covariance matrix
rawdat2 &lt;- kd(covmat, 300)

</code></pre>


</div>