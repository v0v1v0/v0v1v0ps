<div class="container">

<table style="width: 100%;"><tr>
<td>igeom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualization of Random Variate Generation for the Geometric Distribution</h2>

<h3>Description</h3>

<p>Generates random variates from the Geometric distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability mass
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">igeom(
  u = runif(1),
  prob,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPMF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Probability of success in each trial (0 <code class="reqn">&lt;</code> <code>prob</code> <code class="reqn">\le</code> 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPMF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PMF plot appears,
otherwise PMF plot is suppressed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PMF,
1: ECDF; sum for desired combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>populationColor</code></td>
<td>
<p>Color used to display population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates random variates from the Geometric distribution, and optionally,
illustrates
</p>

<ul>
<li>
<p> the use of the inverse-CDF technique,
</p>
</li>
<li>
<p> the effect of random sampling variability in relation to the PMF and CDF.
</p>
</li>
</ul>
<p>When all of the graphics are requested,
</p>

<ul>
<li>
<p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li>
<p> the second graph illustrates the effect of random sampling variability
by graphing the population PMF and the histogram associated with the
random variates, and
</p>
</li>
<li>
<p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li>
</ul>
<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The geometric distribution with parameter <code>prob</code> = <code class="reqn">p</code> has density
</p>
<p style="text-align: center;"><code class="reqn">p(x) = p (1-p)^x</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>, where <code class="reqn">0 &lt; p \le 1</code>.
</p>
<p>The algorithm for generating random variates from the geometric distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated geometric random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qgeom</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PMF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PMF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li>
<p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li>
<p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li>
</ul>
<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PMF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Geometric random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br>
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br>
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code>stats::rgeom</code>
</p>
<p><code>stats::runif</code>,
<code>simEd::vunif</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> igeom(0.5, prob = 0.25)

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE)

 set.seed(8675309)
 igeom(runif(10), 0.4, showECDF = TRUE)

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE, showCDF = FALSE)

 igeom(runif(100), 0.4, showPMF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PMF and CDF without any variates
 igeom(NULL, 0.4, showPMF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PMF using show
 igeom(runif(10), 0.4, show = c(1,1,0))
 igeom(runif(10), 0.4, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 igeom(vunif(10), 0.4, show = c(1,0,1))
 igeom(vunif(10), 0.4, show = 5)

 # plot CDF with inversion, PMF, and ECDF using show
 igeom(vunif(10), 0.4, show = c(1,1,1))
 igeom(vunif(10), 0.4, show = 7)

 # plot three different CDF+PMF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = FALSE)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 igeom(runif(10), 0.4, show = 7, plotDelay = 0.1)

 # display animation of CDF and PMF components only
 igeom(runif(10), 0.4, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   igeom(runif(10), 0.4, show = 7, plotDelay = -1)
 }

</code></pre>


</div>