<div class="container">

<table style="width: 100%;"><tr>
<td>calibSample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrate sample weights</h2>

<h3>Description</h3>

<p>Calibrate sample weights according to known marginal population totals.
Based on initial sample weights, the so-called <em>g</em>-weights are computed
by generalized raking procedures.
</p>


<h3>Details</h3>

<p>The methods return a list containing both the <em>g</em>-weights (slot
<code>g_weights</code>) as well as the final weights (slot <code>final_weights</code>)
(initial sampling weights adjusted by the <em>g</em>-weights.
</p>


<h3>Methods</h3>

<p>The function provides methods with the following
signatures.  </p>
<dl>
<dt>list("signature(inp=\"df_or_dataObj_or_simPopObj\",
totals=\"dataFrame_or_Table\",...)")</dt>
<dd>
<p> Argument 'inp' must be an object of
class <code>data.frame</code>, <code>dataObj</code> or
<code>simPopObj</code> and the totals must be specified in either
objects of class <code>table</code> or <code>data.frame</code>. If argument 'totals' is
a data.frame it must be provided in a way that in the first columns
n-columns the combinations of variables are listed. In the last column, the
frequency counts must be specified. Furthermore, variable names of all but
the last column must be available also from the sample data specified in
argument 'inp'. If argument 'total' is a table (e.g. created with function
<code>tableWt</code>, it must be made sure that the dimnames match the
variable names (and levels) of the specified input data set.  </p>
</dd> </dl>
<h3>Note</h3>

<p>This is a faster implementation of parts of
<code>calib</code> from package <code>sampling</code>. Note that the
default calibration method is raking and that the truncated linear method is
not yet implemented.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons and Bernhard Meindl
</p>


<h3>References</h3>

<p>Deville, J.-C. and Saerndal, C.-E. (1992)
Calibration estimators in survey sampling. <em>Journal of the American
Statistical Association</em>, <b>87</b>(418), 376–382.  Deville, J.-C.,
Saerndal, C.-E. and Sautory, O. (1993) Generalized raking
procedures in survey sampling. <em>Journal of the American Statistical
Association</em>, <b>88</b>(423), 1013–1020.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eusilcS)
eusilcS$agecut &lt;- cut(eusilcS$age, 7)
## Not run: 
inp &lt;- specifyInput(data=eusilcS, hhid="db030", hhsize="hsize", strata="db040", weight="db090")

## for simplicity, we are using population data directly from the sample, but you get the idea
totals1 &lt;- tableWt(eusilcS[, c("agecut","rb090")], weights=eusilcS$rb050)
totals2 &lt;- tableWt(eusilcS[, c("rb090","agecut")], weights=eusilcS$rb050)
totals3 &lt;- tableWt(eusilcS[, c("rb090","agecut","db040")], weights=eusilcS$rb050)
totals4 &lt;- tableWt(eusilcS[, c("agecut","db040","rb090")], weights=eusilcS$rb050)

weights1 &lt;- calibSample(inp, totals1)
totals1.df &lt;- as.data.frame(totals1)
weights1.df &lt;- calibSample(inp, totals1.df)
identical(weights1, weights1.df)

# we can also use a data.frame and an optional weight vector as input
df &lt;- as.data.frame(inp@data)
w &lt;- inp@data[[inp@weight]]
weights1.x &lt;- calibSample(df, totals1.df, w=inp@data[[inp@weight]])
identical(weights1, weights1.x)

weights2 &lt;- calibSample(inp, totals2)
totals2.df &lt;- as.data.frame(totals2)
weights2.df &lt;- calibSample(inp, totals2.df)
identical(weights2, weights2.df)

## End(Not run)

## Not run: 
## approx 10 seconds computation time ...
weights3 &lt;- calibSample(inp, totals3)
totals3.df &lt;- as.data.frame(totals3)
weights3.df &lt;- calibSample(inp, totals3.df)
identical(weights3, weights3.df)

## approx 10 seconds computation time ...
weights4 &lt;- calibSample(inp, totals4)
totals4.df &lt;- as.data.frame(totals4)
weights4.df &lt;- calibSample(inp, totals4.df)
identical(weights4, weights4.df)

## End(Not run)
</code></pre>


</div>