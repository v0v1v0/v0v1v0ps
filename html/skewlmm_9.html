<div class="container">

<table style="width: 100%;"><tr>
<td>healy.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Healy-type plot from a smn.lmm or smsn.lmm object

</h2>

<h3>Description</h3>

<p>It creates a Healy-type plot from a smn.lmm or smsn.lmm object, for goodness-of-fit assessment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">healy.plot(object, dataPlus = NULL, dotsize = 0.4, calcCI = FALSE,
           levelCI, MCiter, seed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataPlus</code></td>
<td>
<p>Optional. Expanded dataset that should be used instead the one used for fitting. This is necessary for unbalanced datasets, since Haley's plot requires all subject to have the same number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dotsize</code></td>
<td>
<p>Optional. Dotsize used in ggplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcCI</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default). A logical value indicating if Monte Carlo confidence intervals should be computed for the conditionally independent model, which can be used for testing if the autocorrelations are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levelCI</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the confidence level that should be used in the Monte Carlo confidence intervals. Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCiter</code></td>
<td>
<p>An optional discrete value indicating the number of Monte Carlo samples that should be used to compute the confidence intervals. Default is <code>300</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional value used to specify seeds inside the function. Default is to use a random seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It constructs a Healy-type plot (Healy, 1968) by plotting the nominal probability values <code class="reqn">1/n,2/n,...,n/n</code> against the theoretical cumulative probabilities of the ordered observed Mahalanobis distances. If the fitted model is appropriate, the plot
should resemble a straight line through the origin with unit slope.
If <code>calcCI=TRUE</code>, the plot presents two dashed blue lines containing approximated confidence intervals by considering that the fitted model is correct.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Healy, M. J. R. (1968). Multivariate normal plotting. Journal of the Royal Statistical Society: Series C (Applied Statistics), 17(2), 157-161.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.</p>


<h3>See Also</h3>

<p><code>ggplot</code>, <code>smn.lmm</code>, <code>smsn.lmm</code>,
<code>mahalDist</code>, <code>acfresid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
healy.plot(fm1)

## computing simulated bands
healy.plot(fm1, calcCI=TRUE)

</code></pre>


</div>