<div class="container">

<table style="width: 100%;"><tr>
<td>estimateSoup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get expression profile of soup</h2>

<h3>Description</h3>

<p>This is usually called by <code>SoupChannel</code>, rather than directly by the user.  Uses the empty droplets in the range provided to calculate the expression profile of the soup under the assumption that these droplets only contain background.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateSoup(sc, soupRange = c(0, 100), keepDroplets = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>A <code>SoupChannel</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soupRange</code></td>
<td>
<p>Droplets with total UMI count in this range (excluding endpoints) are used to estimate soup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepDroplets</code></td>
<td>
<p>Storing the full table of counts for all droplets uses a lot of space and is really only used to estimate the soup profile.  Therefore, it is dropped after the soup profile has been estimated unless this is set to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A modified version of <code>sc</code> with an extra <code>soupProfile</code> entry containing a data.frame with the soup profile and confidence limits for all genes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load droplet and count tables
tod = Seurat::Read10X(system.file('extdata','toyData','raw_gene_bc_matrices','GRCh38',
                                  package='SoupX'))
toc = Seurat::Read10X(system.file('extdata','toyData','filtered_gene_bc_matrices','GRCh38',
                                  package='SoupX'))
#Suppress calculation of soup profile automatically on load
sc = SoupChannel(tod,toc,calcSoupProfile=FALSE)
#Retain table of droplets
sc = estimateSoup(sc,keepDroplets=TRUE)
#Or use non-default values
sc = estimateSoup(sc,soupRange=c(60,100))
</code></pre>


</div>