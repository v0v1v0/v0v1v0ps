<div class="container">

<table style="width: 100%;"><tr>
<td>rsmsn.clmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate data from SMSN-CLMM with censored responses

</h2>

<h3>Description</h3>

<p>It creates a simulated data set from SMSN-CLMM with several possible dependence structures, with an established censoring rate or a fixed limit of detectation (LOD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">  rsmsn.clmm(time, ind, x, z, sigma2, D, beta, lambda=rep(0, nrow(D)),
             depStruct="UNC", phi=NULL, distr="norm", nu=NULL, type="left",
             pcens=0.10, LOD=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Vector of length <code class="reqn">N</code> containing times that should be used in data generation, where <code class="reqn">N</code> indicates the total number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>Vector of length <code class="reqn">N</code> containing the variable which represents the subjects or groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Design matrix for fixed effects of dimension <code class="reqn">N\times p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Design matrix for random effects of dimension <code class="reqn">N \times q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Common variance parameter, such that <code class="reqn">\Sigma=\sigma^2*R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Variance matrix for random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Vector of fixed effects parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Skewness parameter of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>Dependence structure. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) – p is <code>length(phi)</code>–, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, <code>"CAR1"</code> for continuous-time AR(1), and <code>"MA1"</code> for moving average of order 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Parameter vector indexing the dependence structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>Distribution that should be used. <code>"norm"</code> for normal, <code>"t"</code> for Student-t, <code>"sn"</code> for skew-normal, and <code>"st"</code> for skew-t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Degrees of freedom for Student-t and skew-t distributions. It must be greater than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>left</code> for left censoring and <code>right</code> for right censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcens</code></td>
<td>
<p>Desired censoring rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOD</code></td>
<td>
<p>Desired limit of detectation. If <code>LOD</code> is provided, then <code>pcens</code> will be discarded.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame containing time, the variable indicating groups (<code>ind</code>), the generated response variable (<code>y</code>), the censoring indicator variable (<code>ci</code>), the lower censoring limit (<code>lcl</code>), the upper censoring limit (<code>ucl</code>), and possible covariates.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>References</h3>

<p>Matos, L. A., Prates, M. O., Chen, M. H., and Lachos, V. H. (2013). Likelihood-based inference for mixed-effects models with censored response using the multivariate-t distribution. Statistica Sinica 23(3), 1323-1345.
</p>
<p>Lachos, V. H., A. Matos, L., Castro, L. M., and Chen, M. H. (2019). Flexible longitudinal linear mixed models for multiple censored responses data. Statistics in medicine, 38(6), 1074-1102.
</p>


<h3>See Also</h3>

<p><code>smn.clmm</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)

# Generating a sample for m=25 individuals with 5 times
nj1 = 5
m = 25
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))

# Considering 10% of right censoring responses and normal distribution
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=.25,
                  D=0.5*diag(1), beta=c(1,2), depStruct="ARp", phi=0.5,
                  type="right")
head(dat1)
ggplot(dat1, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=1.5) +
  geom_line(aes(x=x,y=lcl), color="red", linetype="dashed")

# Considering LOD=4, left censoring, and Student-t distribution
dat2 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=.25,
                  D=0.5*diag(1), beta=c(1,2), depStruct="CS", phi=0.2,
                  distr="t", nu=4, LOD=4)
mean(dat2$ci) #censoring rate
ggplot(dat2, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=1.5) +
  geom_line(aes(x=x,y=ucl), color="red", linetype="dashed")
</code></pre>


</div>