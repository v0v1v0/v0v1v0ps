<div class="container">

<table style="width: 100%;"><tr>
<td>unpmle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unconditional NPML estimator for the SPECIES number</h2>

<h3>Description</h3>

<p>This function calculate the unconditional NPML estimator of the species number by Norris and Pollock 1996, 1998.
This estimator was obtained from the full likelihood based on a Poisson mixture model. The confidence interval is 
calculated based on a bootstrap procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unpmle(n,t=15,C=0,method="W-L",b=200,conf=.95,seed=NULL,dis=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the “frequency of frequencies” data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a positive integer. <code>t</code> specifies the cutoff value to define the relatively less abundant species to be used in estimation.  The default value for t=15. The estimator is fairly insensitive to the choice of <code>t</code>. The recommendation is
to use <code class="reqn">t \ge 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>integer either 0 or 1. It specifies whether bootstrap confidence interval should be calculated. “<code>C</code>=1” for YES and “<code>C</code>=0” for NO.The default of <code>C</code> is set as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string either “N-P” or “W-L”(default). If <code>method</code>=“N-P”, unconditional NPMLE will be used using an algorithm by  Bonhing and Schon (2005). 
Sometimes this method can be extremely slow. Alternatively one can use method “W-L”, an approximate method (but with high precision and much faster) by Wang and Lindsay 2005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>integer. <code>b</code> specifies the number of bootstrap samples for confidence interval. It is ignored if “<code>C</code>=0”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a single value, interpreted as an integer. Seed for random number generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>0 or 1. 1 for on-screen display of the mixture output, and 0 for none.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The computing is intensive if <code>method</code>=“N-P” is used particularly when extrapolation is large. 
It may takes hours to compute the bootstrap confidence interval. If <code>method</code>=“W-L” is used, computing usually 
is much much faster. Estimates from both methods are often identical.</p>


<h3>Value</h3>

<p>The function <code>unpmle</code> returns a list of:  <code>Nhat</code>, <code>CI</code> (if “<code>C</code>=1”)
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Nhat</code></td>
<td>
<p>point estimate of N</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>bootstrap confidence interval.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The unconditional NPML estimator is unstable from either <code>method='N-P'</code> or <code>method='W-L'</code>. Extremely large estimates may occur. 
This is also reflected in that the upper confidence bound often greatly vary from different runs of bootstrap procedure. In contrast the penalized NPMLE by <code>pnpmle</code> function is much more stable.</p>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University</p>


<h3>References</h3>

 
<p>Norris, J. L. I., and Pollock, K. H. (1996), Nonparametric MLE Under Two Closed Capture-Recapture Models With Heterogeneity, Biometrics, 52,639-649. 
</p>
<p>Norris, J. L. I., and Pollock, K. H.(1998), Non-Parametric MLE for Poisson Species Abundance Models Allowing for Heterogeneity Between Species, Environmental and Ecological Statistics, 5, 391-402.
</p>
<p>Bonhing, D. and Schon, D.,  (2005), Nonparametric maximum likelihood estimation of population size based on the counting distribution, Journal of the Royal Statistical Society,
Series C: Applied Statistics, 54, 721-737.
</p>
<p>Wang, J.-P. Z. and Lindsay, B. G. ,(2005), A penalized nonparametric maximum likelihood approach to species richness estimation. Journal of American Statistical Association, 2005,100(471):942-959
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SPECIES)

##load data from the package, 
## "butterfly" is the famous butterfly data by Fisher 1943.

data(butterfly)


##output estimate without confidence interval using cutoff t=15
#unpmle(butterfly,t=15,C=0)

##output estimate with confidence interval using cutoff t=15
#unpmle(butterfly,t=15,C=1,b=200)

</code></pre>


</div>