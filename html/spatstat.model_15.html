<div class="container">

<table style="width: 100%;"><tr>
<td>AreaInter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Area Interaction Point Process Model</h2>

<h3>Description</h3>

<p>Creates an instance of the Area Interaction point process model
(Widom-Rowlinson penetrable spheres model) 
which can then be fitted to point pattern data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  AreaInter(r)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The radius of the discs in the area interaction process</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function defines the interpoint interaction structure of a point
process called the Widom-Rowlinson penetrable sphere model
or area-interaction process. It can be used to fit this model to
point pattern data.
</p>
<p>The function <code>ppm()</code>, which fits point process models to 
point pattern data, requires an argument 
of class <code>"interact"</code> describing the interpoint interaction
structure of the model to be fitted. 
The appropriate description of the area interaction structure is
yielded by the function <code>AreaInter()</code>. See the examples below.
</p>
<p>In <b>standard form</b>, the area-interaction process
(Widom and Rowlinson, 1970;
Baddeley and Van Lieshout, 1995) with disc radius <code class="reqn">r</code>,
intensity parameter <code class="reqn">\kappa</code> and interaction parameter
<code class="reqn">\gamma</code> is a point process with probability density
</p>
<p style="text-align: center;"><code class="reqn">
    f(x_1,\ldots,x_n) =
    \alpha \kappa^{n(x)} \gamma^{-A(x)}
  </code>
</p>

<p>for a point pattern <code class="reqn">x</code>, where 
<code class="reqn">x_1,\ldots,x_n</code> represent the 
points of the pattern, <code class="reqn">n(x)</code> is the number of points in the
pattern, and <code class="reqn">A(x)</code> is the area of the region formed by
the union of discs of radius <code class="reqn">r</code> centred at the points
<code class="reqn">x_1,\ldots,x_n</code>.
Here <code class="reqn">\alpha</code> is a normalising constant.
</p>
<p>The interaction parameter <code class="reqn">\gamma</code> can be any positive number.
If <code class="reqn">\gamma = 1</code> then the model reduces to a Poisson
process with intensity <code class="reqn">\kappa</code>.
If <code class="reqn">\gamma &lt; 1</code> then the process is regular,
while if <code class="reqn">\gamma &gt; 1</code> the process is clustered.
Thus, an area interaction process can be used to model either
clustered or regular point patterns. Two points interact if the
distance between them is less than <code class="reqn">2r</code>.
</p>
<p>The standard form of the model, shown above, is a little
complicated to interpret in practical applications.
For example, each isolated point of the pattern <code class="reqn">x</code> contributes a factor
<code class="reqn">\kappa \gamma^{-\pi r^2}</code>
to the probability density. 
</p>
<p>In <span class="pkg">spatstat</span>, the model is parametrised in a different form,
which is easier to interpret.
In <b>canonical scale-free form</b>, the probability density is rewritten as
</p>
<p style="text-align: center;"><code class="reqn">
    f(x_1,\ldots,x_n) =
    \alpha \beta^{n(x)} \eta^{-C(x)}
  </code>
</p>

<p>where <code class="reqn">\beta</code> is the new intensity parameter,
<code class="reqn">\eta</code> is the new interaction parameter, and
<code class="reqn">C(x) = B(x) - n(x)</code> is the interaction potential. Here
</p>
<p style="text-align: center;"><code class="reqn">
    B(x) = \frac{A(x)}{\pi r^2}
  </code>
</p>

<p>is the normalised area (so that the discs have unit area).
In this formulation, each isolated point of the pattern contributes a
factor <code class="reqn">\beta</code> to the probability density (so the
first order trend is <code class="reqn">\beta</code>). The quantity 
<code class="reqn">C(x)</code> is a true interaction potential, in the sense that
<code class="reqn">C(x) = 0</code> if the point pattern <code class="reqn">x</code> does not contain any
points that lie close together (closer than <code class="reqn">2r</code> units
apart).
</p>
<p>When a new point <code class="reqn">u</code> is added to an existing point pattern
<code class="reqn">x</code>, the rescaled potential <code class="reqn">-C(x)</code> increases by
a value between 0 and 1. 
The increase is zero if <code class="reqn">u</code> is not close to any point of <code class="reqn">x</code>.
The increase is 1 if the disc of radius <code class="reqn">r</code> centred at <code class="reqn">u</code>
is completely contained in the union of discs of radius <code class="reqn">r</code>
centred at the data points <code class="reqn">x_i</code>. Thus, the increase in
potential is a measure of how close the new point <code class="reqn">u</code> is to the
existing pattern <code class="reqn">x</code>. Addition of the point
<code class="reqn">u</code> contributes a factor <code class="reqn">\beta \eta^\delta</code>
to the probability density, where <code class="reqn">\delta</code> is the
increase in potential. 
</p>
<p>The old parameters <code class="reqn">\kappa,\gamma</code> of the
standard form are related to
the new parameters <code class="reqn">\beta,\eta</code> of the canonical
scale-free form, by
</p>
<p style="text-align: center;"><code class="reqn">
    \beta = \kappa \gamma^{-\pi r^2} = \kappa /\eta
  </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
    \eta = \gamma^{\pi r^2}
  </code>
</p>

<p>provided <code class="reqn">\gamma</code> and <code class="reqn">\kappa</code> are positive and finite.
</p>
<p>In the canonical scale-free form, the parameter <code class="reqn">\eta</code>
can take any nonnegative value. The value <code class="reqn">\eta = 1</code>
again corresponds to a Poisson process, with intensity <code class="reqn">\beta</code>.
If <code class="reqn">\eta &lt; 1</code> then the process is regular,
while if <code class="reqn">\eta &gt; 1</code> the process is clustered.
The value <code class="reqn">\eta = 0</code> corresponds to a hard core process
with hard core radius <code class="reqn">r</code> (interaction distance <code class="reqn">2r</code>).
</p>
<p>The <em>nonstationary</em> area interaction process is similar except that 
the contribution of each individual point <code class="reqn">x_i</code>
is a function <code class="reqn">\beta(x_i)</code>
of location, rather than a constant beta. 
</p>
<p>Note the only argument of <code>AreaInter()</code> is the disc radius <code>r</code>.
When <code>r</code> is fixed, the model becomes an exponential family.
The canonical parameters <code class="reqn">\log(\beta)</code>
and <code class="reqn">\log(\eta)</code>
are estimated by <code>ppm()</code>, not fixed in
<code>AreaInter()</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"interact"</code>
describing the interpoint interaction
structure of the area-interaction process with disc radius <code class="reqn">r</code>.
</p>


<h3>Warnings</h3>

<p>The interaction distance of this process is equal to
<code>2 * r</code>. Two discs of radius <code>r</code> overlap if their centres
are closer than <code>2 * r</code> units apart.
</p>
<p>The estimate of the interaction parameter <code class="reqn">\eta</code>
is unreliable if the interaction radius <code>r</code> is too small
or too large. In these situations the model is approximately Poisson
so that <code class="reqn">\eta</code> is unidentifiable.
As a rule of thumb, one can inspect the empty space function
of the data, computed by <code>Fest</code>. The value <code class="reqn">F(r)</code>
of the empty space function at the interaction radius <code>r</code> should
be between 0.2 and 0.8. 
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and
Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>References</h3>

<p>Baddeley, A.J. and Van Lieshout, M.N.M. (1995).
Area-interaction point processes.
<em>Annals of the Institute of Statistical Mathematics</em>
<b>47</b> (1995) 601–619.
</p>
<p>Widom, B. and Rowlinson, J.S. (1970).
New model for the study of liquid-vapor phase transitions.
<em>The Journal of Chemical Physics</em>
<b>52</b> (1970) 1670–1684.
</p>


<h3>See Also</h3>

<p><code>ppm</code>,
<code>pairwise.family</code>,
<code>ppm.object</code>
</p>
<p><code>ragsAreaInter</code> and <code>rmh</code> for simulation
of area-interaction models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   

   # prints a sensible description of itself
   AreaInter(r=0.1)

   # Note the reach is twice the radius
   reach(AreaInter(r=1))

   # Fit the stationary area interaction process to Swedish Pines data
   ppm(swedishpines ~1, AreaInter(r=7))

   # Fit the stationary area interaction process to `cells'
   ppm(cells ~1, AreaInter(r=0.06))
   # eta=0 indicates hard core process.

   # Fit a nonstationary area interaction with log-cubic polynomial trend
   
     ppm(swedishpines ~polynom(x/10,y/10,3), AreaInter(r=7))
   

   
</code></pre>


</div>