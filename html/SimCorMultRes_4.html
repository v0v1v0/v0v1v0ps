<div class="container">

<table style="width: 100%;"><tr>
<td>rmult.bcl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating Correlated Nominal Responses Conditional on a Marginal
Baseline-Category Logit Model Specification</h2>

<h3>Description</h3>

<p>Simulates correlated nominal responses assuming a baseline-category logit
model for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmult.bcl(clsize = clsize, ncategories = ncategories, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(),
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncategories</code></td>
<td>
<p>integer indicating the number of nominal response
categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>matrix with <code>(clsize * ncategories)</code> columns containing
realizations of the latent random vectors when the NORTA method is not
preferred. See details for more info.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal baseline category logit model is </p>
<p style="text-align: center;"><code class="reqn">log
\frac{Pr(Y_{it}=j |x_{it})}{Pr(Y_{it}=J |x_{it})}=(\beta_{tj0}-\beta_{tJ0})
+ (\beta^{'}_{tj}-\beta^{'}_{tJ}) x_{it}=\beta^{*}_{tj0}+ \beta^{*'}_{tj}
x_{it}</code>
</p>
<p> For subject <code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th nominal response
and <code class="reqn">x_{it}</code> is the associated covariates vector. Also <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The nominal response <code class="reqn">Y_{it}</code> is obtained by extending the principle of
maximum random utility (<cite>McFadden, 1974</cite>) as suggested in
<cite>Touloumis (2016)</cite>.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{tj0}=\beta_{j0}</code> and <code class="reqn">\beta_{tj}=\beta_j</code> for all <code class="reqn">t</code>.
Otherwise, <code>betas</code> must be provided as a numeric matrix with
<code>clsize</code> rows such that the <code class="reqn">t</code>-th row contains the value of
(<code class="reqn">\beta_{t10},\beta_{t1},\beta_{t20},\beta_{t2},...,\beta_{tJ0},
\beta_{tJ}</code>). In either case, <code>betas</code> should reflect the order of the
terms implied by <code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in “long” format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{NO}_{itj}</code> in <cite>Touloumis (2016)</cite>. In this
case, the algorithm forces <code>cor.matrix</code> to respect the assumption of
choice independence. To import simulated values for the latent random
vectors without utilizing the NORTA method, the user can employ the
<code>rlatent</code> argument. In this case, row <code class="reqn">i</code> corresponds to subject
<code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{NO}_{it1},...,e^{NO}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Ysim</code></td>
<td>
<p>the simulated
nominal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{NO}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557–561.
</p>
<p>McFadden, D. (1974) <em>Conditional logit analysis of qualitative choice
behavior</em>. New York: Academic Press, 105–142.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79–91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633–640.
</p>


<h3>See Also</h3>

<p><code>rbin</code> for simulating correlated binary responses,
<code>rmult.clm</code>, <code>rmult.crm</code> and
<code>rmult.acl</code> for simulating correlated ordinal responses.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See Example 3.1 in the Vignette.
betas &lt;- c(1, 3, 2, 1.25, 3.25, 1.75, 0.75, 2.75, 2.25, 0, 0, 0)
sample_size &lt;- 500
categories_no &lt;- 4
cluster_size &lt;- 3
set.seed(1)
x1 &lt;- rep(rnorm(sample_size), each = cluster_size)
x2 &lt;- rnorm(sample_size * cluster_size)
xdata &lt;- data.frame(x1, x2)
equicorrelation_matrix &lt;- toeplitz(c(1, rep(0.95, cluster_size - 1)))
identity_matrix &lt;- diag(categories_no)
latent_correlation_matrix &lt;- kronecker(equicorrelation_matrix,
  identity_matrix)
simulated_nominal_dataset &lt;- rmult.bcl(clsize = cluster_size,
  ncategories = categories_no, betas = betas, xformula = ~ x1 + x2,
  xdata = xdata, cor.matrix = latent_correlation_matrix)
suppressPackageStartupMessages(library("multgee"))
nominal_gee_model &lt;- nomLORgee(y ~ x1 + x2,
  data = simulated_nominal_dataset$simdata, id = id, repeated = time,
  LORstr = "time.exch")
round(coef(nominal_gee_model), 2)
</code></pre>


</div>