<div class="container">

<table style="width: 100%;"><tr>
<td>doublesigmoidalFitFormula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Double Sigmoidal Formula</h2>

<h3>Description</h3>

<p>Calculates intensities using the double-sigmoidal model fit and the parameters (maximum, final asymptote intensity, slope1Param, midpoint1Param, slope2Param, and mid point distance).
</p>


<h3>Usage</h3>

<pre><code class="language-R">doublesigmoidalFitFormula(
  x,
  finalAsymptoteIntensityRatio,
  maximum,
  slope1Param,
  midPoint1Param,
  slope2Param,
  midPointDistanceParam
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the "time" (time) column of the dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>finalAsymptoteIntensityRatio</code></td>
<td>
<p>This is the ratio between asymptote intensity and maximum intensity of the fitted curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum</code></td>
<td>
<p>the maximum intensity that the double sigmoidal function reach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope1Param</code></td>
<td>
<p>the slope parameter of the sigmoidal function at the steppest point in the exponential phase of the viral production.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midPoint1Param</code></td>
<td>
<p>the x axis value of the steppest point in the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope2Param</code></td>
<td>
<p>the slope parameter of the sigmoidal function at the steppest point in the lysis phase. i.e when the intensity is decreasing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midPointDistanceParam</code></td>
<td>
<p>the distance between the time of steppest increase and steppest decrease in the intensity data. In other words the distance between the x axis values of arguments of slope1Param and slope2Param.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the predicted intensities for the given time points with the double-sigmoidal fitted parameters for the double sigmoidal fit.
</p>


<h3>Examples</h3>

<pre><code class="language-R">time &lt;- seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- doublesigmoidalFitFormula(time,
                                      finalAsymptoteIntensityRatio = .3,
                                      maximum = 4,
                                      slope1Param = 1,
                                      midPoint1Param = 7,
                                      slope2Param = 1,
                                      midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- doublesigmoidalFitFunction(normalizedInput, tryCounter = 2)


#Check the results
if(parameterVector$isThisaFit){
 intensityTheoretical &lt;-
       doublesigmoidalFitFormula(
               time,
               finalAsymptoteIntensityRatio = parameterVector$finalAsymptoteIntensityRatio_Estimate,
               maximum = parameterVector$maximum_Estimate,
               slope1Param = parameterVector$slope1Param_Estimate,
               midPoint1Param = parameterVector$midPoint1Param_Estimate,
               slope2Param = parameterVector$slope2Param_Estimate,
               midPointDistanceParam = parameterVector$midPointDistanceParam_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical)) +
   expand_limits(x = 0, y = 0)
   }

if(!parameterVector$isThisaFit){
  print(parameterVector)
  }


</code></pre>


</div>