<div class="container">

<table style="width: 100%;"><tr>
<td>Volcano</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Volcano Plot
</h2>

<h3>Description</h3>

<p>Volcano plot with the option to label the significant results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Volcano(
    resFrame, 
    stats, 
    p.value, 
    group = NULL, 
    xlab = "logFC", 
    ylab = "-log10(p value)", 
    title = NULL, 
    vline.col = "orange", 
    hline.col = "dodgerblue", 
    vline = list(xintercept = c(-1, 1), label = c(-1, 1)), 
    hline = list(
        yintercept = c(-log10(0.05), 
                       -log10(0.05/nrow(resFrame)), 
                       -log10(max(resFrame[p.adjust(resFrame[, p.value], 
                                       method = "fdr") &lt;= 0.05, p.value]))), 
        label = c("p value: 0.05", "Bonferroni: 0.05", "FDR: 0.05")), 
    rowname.var = NULL, 
    point.size = 3, 
    theme_classic = TRUE, 
    addThemeFlag = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resFrame</code></td>
<td>

<p>A data frame stored information about the results, including gene id, statistic (e.g., log fold change, odds ratio), p-value, and significance of a gene. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>

<p>character. The column name of <code>resFrame</code> that indicates the effect of a gene.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>

<p>character. The column name of <code>resFrame</code> that indicates the p-value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>character. The column name of <code>resFrame</code> that indicates the significance of a gene.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>x axis label
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>y axis label
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>title of the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vline.col</code></td>
<td>

<p>color of the vertical lines (default: “orange”)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hline.col</code></td>
<td>

<p>color of the horizontal lines (default: “dodgerblue”)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vline</code></td>
<td>

<p>A list with two elements: “xintercept” and “label”,
where the former element is a numeric vector indicating the x-axis location to draw vertical color lines and the latter element is list of labels for the elements in “xintercept”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hline</code></td>
<td>

<p>A list with two elements: “yintercept” and “label”,
where the former element is a numeric vector indicating the y-axis location to draw horizontal color lines and the latter element is list of labels for the elements in “xintercept”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowname.var</code></td>
<td>

<p>character. The column name of <code>resFrame</code> that indicates which variable will be used to label the significant results in the volcano plot. The elements of this column for non-significant results should be set to be <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>

<p>size of data points in the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme_classic</code></td>
<td>

<p>logical. Use classic background without grids (default: TRUE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addThemeFlag</code></td>
<td>

<p>logical. Indicates if light blue background and white grid should be added to the figure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other input parameters for facet &amp; theme
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 9 elements.
<code>data</code>, <code>layers</code>, <code>scales</code>, <code>mapping</code>,
<code>theme</code>, <code>coordinates</code>,
<code>facet</code>       <code>plot_env</code>, and <code>labels</code>.
</p>


<h3>Author(s)</h3>

<p>Wenfei Zhang &lt;Wenfei.Zhang@sanofi.com&gt;,
Weiliang Qiu &lt;Weiliang.Qiu@sanofi.com&gt;,
Xuan Lin &lt;Xuan.Lin@sanofi.com&gt;,
Donghui Zhang &lt;Donghui.Zhang@sanofi.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggrepel)
library(limma)

# load the simulated dataset
data(esSim)
print(esSim)

# expression levels
y = exprs(esSim)
print(dim(y))
print(y[1:2,])

# phenotype data
pDat = pData(esSim)
print(dim(pDat))
print(pDat)

# design matrix
design = model.matrix(~grp, data = pDat)
print(design)

options(digits = 3)

# Ordinary fit
fit &lt;- lmFit(y, design)
fit2 &lt;- eBayes(fit)

# get result data frame
resFrame = topTable(fit2,coef = 2, number = nrow(esSim))
print(dim(resFrame))
print(resFrame[1:2,])
resFrame$sigFlag  =  resFrame$adj.P.Val &lt; 0.05

resFrame$probe  =  rownames(resFrame)
# make sure set NA to genes non-differentially expressed
resFrame$probe[which(resFrame$sigFlag == FALSE)] = NA

print(resFrame[1:2,])
print(table(resFrame$sigFlag, useNA = "ifany"))

statVisual(type = 'Volcano',
           resFrame = resFrame, 
           stats = 'logFC', 
           p.value = 'P.Value', 
           group = 'sigFlag', 
           rowname.var = 'probe', 
           point.size = 1)

Volcano(
  resFrame = resFrame, 
  stats = 'logFC', 
  p.value = 'P.Value', 
  group = 'sigFlag', 
  rowname.var = 'probe', 
  point.size = 1)


</code></pre>


</div>