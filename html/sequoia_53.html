<div class="container">

<table style="width: 100%;"><tr>
<td>PedPolish</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fix Pedigree</h2>

<h3>Description</h3>

<p>Ensure all parents &amp; all genotyped individuals are included,
remove duplicates, rename columns, and replace 0 by NA or v.v..
</p>


<h3>Usage</h3>

<pre><code class="language-R">PedPolish(
  Pedigree,
  gID = NULL,
  ZeroToNA = TRUE,
  NAToZero = FALSE,
  DropNonSNPd = TRUE,
  FillParents = FALSE,
  KeepAllColumns = TRUE,
  KeepAllRows = FALSE,
  NullOK = FALSE,
  LoopCheck = TRUE,
  StopIfInvalid = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pedigree</code></td>
<td>
<p>dataframe where the first 3 columns are id, dam, sire.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gID</code></td>
<td>
<p>character vector with ids of genotyped individuals
(rownames of genotype matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZeroToNA</code></td>
<td>
<p>logical, replace 0's for missing values by NA's (defaults to
<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAToZero</code></td>
<td>
<p>logical, replace NA's for missing values by 0's. If
<code>TRUE</code>, ZeroToNA is automatically set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DropNonSNPd</code></td>
<td>
<p>logical, remove any non-genotyped individuals (but keep
non-genotyped parents), &amp; sort pedigree in order of <code>gID</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FillParents</code></td>
<td>
<p>logical, for individuals with only 1 parent assigned, set
the other parent to a dummy (without assigning siblings or grandparents).
Makes the pedigree compatible with R packages and software that requires
individuals to have either 2 or 0 parents, such as
<code>kinship</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KeepAllColumns</code></td>
<td>
<p>Keep all columns in <code>Pedigree</code> (TRUE, default), or
only id - dam - sire (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KeepAllRows</code></td>
<td>
<p>Keep all rows in <code>Pedigree</code> (TRUE), or drop rows
where id = <code>NA</code> (FALSE, default). Duplicated rows are always removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NullOK</code></td>
<td>
<p>logical, is it OK for Ped to be NULL? Then NULL will be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LoopCheck</code></td>
<td>
<p>logical, check for invalid pedigree loops by calling
<code>getGenerations</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StopIfInvalid</code></td>
<td>
<p>if a pedigree loop is detected, stop with an error
(TRUE, default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Recognized column names are an exact or partial match with (case is
ignored):
</p>

<dl>
<dt>id</dt>
<dd>
<p>"id", "iid", "off"</p>
</dd>
<dt>dam</dt>
<dd>
<p>"dam", "mother", "mot", "mom", "mum", "mat"</p>
</dd>
<dt>sire</dt>
<dd>
<p>"sire", "father", "fat", "dad", "pat"</p>
</dd>
</dl>
<p><code>sequoia</code> requires the column order id - dam - sire; columns 2 and 3 are
swapped by this function if necessary.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# To get the output pedigree into kinship2 compatible format:
PedP &lt;- sequoia::PedPolish(SeqOUT$Pedigree, DropNonSNPd=FALSE,
                           FillParents = TRUE)
PedP$Sex &lt;- with(PedP, ifelse(id %in% dam, "female",  "male"))
# default to 'male' to avoid warning: "More than 25% of the gender values are
#  'unknown'"

Ped.fix &lt;- with(PedP, kinship2::fixParents(id=id, dadid=sire, momid=dam,
                                           sex=Sex))
Ped.k &lt;- with(Ped.fix, kinship2::pedigree(id, dadid, momid, sex, missid=0))

## End(Not run)

</code></pre>


</div>