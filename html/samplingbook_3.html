<div class="container">

<table style="width: 100%;"><tr>
<td>htestimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Horvitz-Thompson Estimator</h2>

<h3>Description</h3>

<p>Calculates Horvitz-Thompson estimate with different methods for variance estimation such as Yates and Grundy, Hansen-Hurwitz and Hajek.</p>


<h3>Usage</h3>

<pre><code class="language-R">htestimate(y, N, PI, pk, pik, method = 'yg')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>integer for population size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI</code></td>
<td>
<p>square matrix of second order inclusion probabilities with <code>n</code> rows and cols. It is necessary to be specified for variance estimation by methods <code>'ht'</code> and <code>'yg'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>vector of first order inclusion probabilities of length <code>n</code> for the sample elements. It is necessary to be specified for variance estimation by methods <code>'hh'</code> and <code>'ha'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik</code></td>
<td>
<p>an optional vector of first order inclusion probabilities of length <code>N</code> for the population elements . It can be used for variance estimation by method <code>'ha'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to be used for variance estimation. Options are <code>'yg'</code> (Yates and Grundy) and <code>'ht'</code> (Horvitz-Thompson), approximate options are <code>'hh'</code> (Hansen-Hurwitz) and <code>'ha'</code> (Hajek).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For using methods <code>'yg'</code> or <code>'ht'</code> has to be provided matrix <code>PI</code>, and for <code>'hh'</code> and <code>'ha'</code> has to be specified vector <code>pk</code> of inclusion probabilities. 
Additionally, for Hajek method <code>'ha'</code> can be specified <code>pik</code>. Unless, an approximate Hajek method is used.
</p>


<h3>Value</h3>

<p>The function <code>htestimate</code> returns a value, which is a list consisting of the components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>is a list of call components: <code>y</code> observations, <code>N</code> population size, <code>PI</code> inclusion probabilities, <code>pk</code> inclusion probabilities of sample, <code>pik</code> full inclusion probabilities and <code>method</code> method for variance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>mean estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>standard error of the mean estimate</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juliane Manitz</p>


<h3>References</h3>

<p>Kauermann, Goeran/Kuechenhoff, Helmut (2010): Stichproben. Methoden und praktische Umsetzung mit R. Springer.
</p>


<h3>See Also</h3>

<p><code>pps.sampling</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(influenza)
summary(influenza)

# pps.sampling()
set.seed(108506)
pps &lt;- pps.sampling(z=influenza$population,n=20,method='midzuno')
sample &lt;- influenza[pps$sample,]
# htestimate()
N &lt;- nrow(influenza)
# exact variance estimate
PI &lt;- pps$PI
htestimate(sample$cases, N=N, PI=PI, method='yg')
htestimate(sample$cases, N=N, PI=PI, method='ht')
# approximate variance estimate
pk &lt;- pps$pik[pps$sample]
htestimate(sample$cases, N=N, pk=pk, method='hh')
pik &lt;- pps$pik
htestimate(sample$cases, N=N, pk=pk, pik=pik, method='ha')
# without pik just approximate calculation of Hajek method
htestimate(sample$cases, N=N, pk=pk, method='ha') 
# calculate confidence interval based on normal distribution for number of cases
est.ht &lt;- htestimate(sample$cases, N=N, PI=PI, method='ht')
est.ht$mean*N  
lower &lt;- est.ht$mean*N - qnorm(0.975)*N*est.ht$se
upper &lt;- est.ht$mean*N + qnorm(0.975)*N*est.ht$se
c(lower,upper) 
# true number of influenza cases
sum(influenza$cases)
</code></pre>


</div>