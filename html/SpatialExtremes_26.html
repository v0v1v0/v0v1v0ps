<div class="container">

<table style="width: 100%;"><tr>
<td>fitcovariance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the covariance function for the Schlather's model</h2>

<h3>Description</h3>

<p>Estimates the covariance function for the Schlather's model using
non-parametric estimates of the pairwise extremal coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitcovariance(data, coord, cov.mod, marge = "emp", control = list(),
..., start, weighted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing the data. Each column corresponds to
one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A matrix that gives the coordinates of each
location. Each row corresponds to one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string corresponding the the covariance
model in the Schlather's model. Must be one of "whitmat", "cauchy",
"powexp", "bessel" or "caugen" for the Whittle-Matern, the Cauchy,
the Powered Exponential, the Bessel and the Generalized Cauchy
correlation families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marge</code></td>
<td>
<p>Character string specifying how margins are transformed
to unit Frechet. Must be one of "emp", "frech" or "mle" - see
function <code>fitextcoeff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The control arguments to be passed to the
<code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to be passed to the <code>optim</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values for the
parameters over which the weighted sum of square is to be
minimized. If <code>start</code> is omitted the routine attempts to find
good starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical. Should weighted least squares be used?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fitting procedure is based on weighted least squares. More
precisely, the fitting criteria is to minimize:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i,j} \left(\frac{\tilde{\theta}_{i,j} -
      \hat{\theta}_{i,j}}{s_{i,j}}\right)^2</code>
</p>

<p>where <code class="reqn">\tilde{\theta}_{i,j}</code> is a non
parametric estimate of the extremal coefficient related to location
<code>i</code> and <code>j</code>, <code class="reqn">\hat{\theta}_{i,j}</code> is
the fitted extremal coefficient derived from the Schlather's model and
<code class="reqn">s_{i,j}</code> are the standard errors related to the
estimates <code class="reqn">\tilde{\theta}_{i,j}</code>.
</p>


<h3>Value</h3>

<p>An object of class maxstab.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Smith, R. L. (1990) Max-stable processes and spatial
extremes. Unpublished manuscript.
</p>


<h3>See Also</h3>

<p><code>fitcovmat</code>, <code>fitmaxstab</code>,
<code>fitextcoeff</code></p>


<h3>Examples</h3>

<pre><code class="language-R">n.site &lt;- 50
locations &lt;- matrix(runif(2*n.site, 0, 10), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulating a max-stable process using RandomFields
##This is the Schlather's approach
data &lt;- rmaxstab(50, locations, cov.mod = "whitmat", nugget = 0, range =
30, smooth = 1)

fitcovariance(data, locations, "whitmat")
</code></pre>


</div>