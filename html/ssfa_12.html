<div class="container">

<table style="width: 100%;"><tr>
<td>ssfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial stochastic frontier estimation</h2>

<h3>Description</h3>

<p>This function estimates the Spatial Stochastic Frontier model introduced by Fusco and Vidoli (2013) in the following form:
</p>
<p style="text-align: center;"><code class="reqn">log(y_{i}) = log(f(x_{i};\beta_i)) +v_{i}-u_{i}</code>
</p>

<p style="text-align: center;"><code class="reqn">u_{i}=\rho \sum_{i}w_{i.}u_{i} + \widetilde{u_{i}}</code>
</p>

<p>where <code class="reqn">y_i</code> are the outputs, <code class="reqn">x_i</code> the inputs, <code class="reqn">v_i</code> the stochastic noise, <code class="reqn">u_{i}</code> the inefficiency term, <code class="reqn">rho</code> the spatial lag, <code class="reqn">w_{i.}</code> a standardized row of the spatial weights matrix and <code class="reqn">\widetilde{u_{i}}</code> the stochastic noise of the inefficiency term.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">ssfa(formula, data = NULL, data_w = NULL, intercept = TRUE, pars = NULL, par_rho = TRUE, 
                 form = "cost")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that
class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_w</code></td>
<td>
<p>a data frame containing the spatial weight matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical. If true the model includes intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>initial values for the parameters to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_rho</code></td>
<td>
<p>logical. If true the function estimates the Spatial Stochastic Frontier (SSFA) otherwise the classical Stochastic Frontier (SFA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>specifies the form of the frontier model as "cost" or "production".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>ssfa</code> returns the following objects of class <code>ssfa</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>the form of the frontier model estimated (-1 = cost, 1 = production).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>a symmetric matrix giving an estimate of the Hessian at the solution found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the value of the log likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ols</code></td>
<td>
<p>the linear model for the LR-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau2</code></td>
<td>
<p>the estimation of sigmau2 (only if par_rho=FALSE): value of inefficiency variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau2_dmu</code></td>
<td>
<p>the estimation of sigmau2_dmu (only if par_rho=TRUE): value of the part of the inefficiency variance due to DMU's specificities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmau2_sar</code></td>
<td>
<p>the estimation of sigmau2_sar: value of the part of the inefficiency variance due to the spatial correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmav2</code></td>
<td>
<p>the estimation of sigmav2: value of the stochastic error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>the estimation of sigma2: value of the total variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the estimation of the spatial lag parameter rho.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>the distribution of the inefficiency term u.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_w</code></td>
<td>
<p>a listw object from <code>nb2listw</code> (See nb2listw).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>NOTE 1: In this version the distribution of the inefficiency term <code class="reqn">u</code> is only "half-normal". <br></p>
<p>NOTE 2: The method used to maximize the log likelihood function is the Newton-Raphson. Please see the R function <code>maxNR</code> of the <code>maxLik</code> package for details (Henningsen and Toomet (2011)). <br></p>
<p>NOTE 3: Please note that the classical SFA inefficiency variance <code>sigmau2</code>, in the SSFA, is decomposed into <code>sigmau2_dmu</code> and <code>sigmau2_sar</code>, respectively the part of inefficiency variance due to DMU's specificities and to the spatial dependence, <em>i.e.</em> <code>sigmau2 = sigmau2_dmu + sigmau2_sar</code> and consequently the total variance is given by <code>sigma2 = sigmau2_dmu + sigmau2_sar + sigmav2</code>.
</p>


<h3>Author(s)</h3>

<p>Fusco E. and Vidoli F.</p>


<h3>References</h3>

<p>Battese, G. E., and T. J. Coelli (1995). <em>A Model for Technical Inefficiency Effects in a
Stochastic Frontier Production Function for Panel Data.</em> Empirical Economics 20(2):
325-332.
</p>
<p>Fusco, E. and Vidoli, F. (2013). <em>Spatial stochastic frontier models: controlling spatial global and local heterogeneity</em>, International Review of Applied Economics, 27(5) 679-694.
</p>
<p>Fusco, E. (2020). <em>Spatial Dependence in Efficiency Parametric Models: A Generalization and Simulation Studies</em>, "Scienze Regionali, Italian Journal of Regional Science" Speciale/2021, 595-618.
</p>
<p>Kumbhakar, S. C., and C. A. K. Lovell (2000). <em>Stochastic Frontier Analysis</em>, Cambridge University Press.
</p>
<p>Henningsen, A. and Toomet, O. (2011). <em>maxLik: A package for maximum likelihood estimation in R</em>. Computational Statistics 26(3), 443-458.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ssfa) 
data(SSFA_example_data)
data(Italian_W)
ssfa &lt;- ssfa(log_y ~ log_x, data = SSFA_example_data, 
             data_w=Italian_W, form = "production", par_rho=TRUE)

### SSFA total variance decomposition 
sigma2 = ssfa$sigmau2_dmu + ssfa$sigmau2_sar + ssfa$sigmav2
sigma2
ssfa$sigma2
</code></pre>


</div>