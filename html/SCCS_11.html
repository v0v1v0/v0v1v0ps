<div class="container">

<table style="width: 100%;"><tr>
<td>eventdepenexp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SCCS with event-dependent exposure

</h2>

<h3>Description</h3>

<p>One of the assumptions of the self-controlled case series model is that occurence of an event does not affect subsequent exposure. This function fits the modified SCCS model when the assumption is not satisfied, see Farrington et al (2009). This modified method assumes that no exposure is possible following a unique event. It requires that exposure is of a fixed finite length and that the end of observation that would have applied in the absence of the event is known.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eventdepenexp(indiv, astart, aend, aevent, adrug, aedrug, expogrp=0,
             sameexpopar=T,agegrp=NULL, dataformat="stack", verbose=F,
             tolerance=1e-8,itermax=100, data)
</code></pre>


<h3>Arguments</h3>




<table>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at which the observation periods start 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods, that would have applied in the absence of the event 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event (one event per case)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a vector of ages at which exposure starts or a matrix if there are multiple episodes of the same exposure type (<code>dataformat</code> multi). Multiple exposures of the same exposure type can be recorded as multiple rows (<code>dataformat</code> stack). In this method only one exposure type can be included unlike the <code>standardsccs</code> where multiple exposure types can be analayzed in the same model 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a vector of ages at which exposure-related risk ends or a matrix if there are multiple episodes of the same exposure type. The dimension of <code>aedrug</code> should be equal to the dimension of <code>adrug</code>, that is <code>aedrug</code> should be given for each column in <code>adrug</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expogrp</code></td>
<td>

<p>a vector of days to the start of exposure-related risk, counted from <code>adrug</code>. E.g if the risk period is [<code>adrug</code>+c,<code>aedrug</code>], use expogrp = list(c) or expogrp = c. The DEFAULT is a <code>expogrp</code>= 0 where the exposure-related risk period is [<code>adrug</code>, <code>aedrug</code>].
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>sameexpopar</code></td>
<td>

<p>a logical value. If TRUE (the default) no dose effect is assumed: the same exposure parameters are used for multiple doses/episodes of the same exposure type presented in <code>dataformat</code> 'multi'. If FALSE different relative incidences are estimated for different doses/episodes of the same exposure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agegrp</code></td>
<td>

<p>a vector of cut points for the age groups where each value represents the start of an age catagory. The first element in the vector is the start of the second age group. The first age group starts at the minimum of <code>astart</code>, the start of observation period. The default is NULL (i.e no age effects included). 
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>dataformat</code></td>
<td>

<p>the way the input data are assembled. It accepts "multi" or "stack" (the default), where "multi" refers to a data assembled with one row representing one event and "stack" refers to a data frame where repeated exposures of the same type are stacked in one column. In the "multi" <code>dataformat</code> different episodes of the same exposure type are recorded as separate columns in the dataframe. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>a logical value indicating whether information about the iterations should be printed. Default is FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>

<p>the convergence tolerance when estimating the parameters. Defaults to 1e-8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>

<p>maximum number of iterations. 100 is the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the input data. The data should be in 'stack' or 'multi' (see <code>dataformat</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This model fits a SCCS model with event-dependent exposures. 
</p>


<h3>Value</h3>

<p>Relative incidence estimates along with their 95% confidence intervals. 





</p>


<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington. 
</p>


<h3>References</h3>

<p>Farrington, C. P., Whitaker H.J., and Hocine M.N. (2009). Case series analysis for censored, perturbed or curtailed post-event exposures. Biotatistics, 10(1), 3-16.
</p>
<p>Farrington P., Whitaker H., and Ghebremichael-Weldeselassie Y. (2018). Self-controlled Case Series Studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press. 
</p>



<h3>See Also</h3>

<p><code>semisccs</code>, <code>standardsccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SCCS)

# Analysis of rotavirus vaccination and intussusception data
# Model 1: Three doses of the same vaccine exposure OPV (OPV, OPV2 and opv3), 
# only one risk period [adrug, aedrug]


   rot.mod1 &lt;- eventdepenexp(indiv=case, astart=sta, aend=end,
                         aevent=intus, adrug=cbind(rv,rvd2), 
                         expogrp=1,aedrug=cbind(rv+21,rvd2+21), 
                         agegrp=seq(56,168,14), dataformat="multi", data=rotdat)

   rot.mod1

# Model 2: Two doses with two riks periods, 1-7 and 8-21 


   rot.mod2 &lt;- eventdepenexp(indiv=case, astart=sta, aend=end,
                            aevent=intus, adrug=cbind(rv,rvd2),
                            aedrug=cbind(rv+21,rvd2+21), expogrp=c(1,8),
                            agegrp=seq(56,168,14), dataformat="multi", 
                            data=rotdat)   

   rot.mod2

</code></pre>


</div>