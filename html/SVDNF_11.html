<div class="container">

<table style="width: 100%;"><tr>
<td>modelSim.dynamicsSVM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation from Stochastic Volatility Models with Jumps
</h2>

<h3>Description</h3>

<p>The <code>modelSim</code> function generates returns and variances for a wide class of stochastic volatility models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dynamicsSVM'
modelSim(dynamics, t, init_vol = 0.032, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dynamics</code></td>
<td>
<p>A <code>dynamicsSVM</code> object representing the model dynamics to be used for simulating data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Number of observations to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_vol</code></td>
<td>
<p>Initial value of the volatility factor (e.i., value of <code>x_0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>volatility_factor</code></td>
<td>
<p>Vector of the instantaneous volatility factor values generated by the <code>modelSim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returns</code></td>
<td>
<p>Vector of the returns generated by the <code>modelSim</code> function.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
# Generate 250 returns from the DuffiePanSingleton model
DuffiePanSingleton_mod &lt;- dynamicsSVM(model = "DuffiePanSingleton") 
DuffiePanSingleton_sim &lt;- modelSim(t = 200, dynamics = DuffiePanSingleton_mod) 

# Plot the volatility factor and returns that were generated
plot(DuffiePanSingleton_sim$volatility_factor, type = 'l',
  main = 'DuffiePanSingleton Model Simulated Volatility Factor', ylab = 'Volatility Factor')
 
plot(DuffiePanSingleton_sim$returns, type = 'l',
  main = 'DuffiePanSingleton Model Simulated Returns', ylab = 'Returns')
 
# Generate 250 steps from a custom model
# Set parameters
kappa &lt;- 100; theta &lt;- 0.05; sigma &lt;- 2.3; h &lt;- 1/252 ; mu &lt;- 0.04
rho &lt;- -0.8; omega &lt;- 5; alpha &lt;- -0.025; nu &lt;- 0.01; rho_z &lt;- -1; delta &lt;- 0.025
# Jump compensator
alpha_bar &lt;- exp(alpha + 0.5 * delta^2) / (1 - rho_z * nu) - 1

# Define returns drift and diffusion functions
# Returns drift and diffusion
mu_y &lt;- function(x, mu, alpha_bar, omega, h){
  return(h * (mu - x / 2 - alpha_bar * omega))
}
mu_y_params &lt;- list(mu, alpha_bar, omega , h)
sigma_y &lt;- function(x, h, sigma){
  return(sigma * sqrt(h) * pmax(x,0))
}
sigma_y_params &lt;- list(h, sigma)

# Volatility factor drift and diffusion functions
mu_x &lt;- function(x, h, kappa, theta){
  return(x + h * kappa * pmax(0,x) * (theta - pmax(0,x)))
}
mu_x_params &lt;- list(h, kappa, theta)

sigma_x &lt;- function(x, sigma, h){
  return(sigma * sqrt(h) * pmax(0,x))
}
sigma_x_params &lt;- list(sigma, h)

# Include simultaneous return and volatility factor jumps
# based on the Poisson distribution for jump times
jump_dist &lt;- rpois
jump_params &lt;- list(omega * h)
custom_mod &lt;- dynamicsSVM(model = "Custom", mu_x = mu_x, mu_y = mu_y,
  sigma_x = sigma_x, sigma_y = sigma_y,
  mu_x_params = mu_x_params, mu_y_params = mu_y_params,
  sigma_x_params = sigma_x_params, sigma_y_params = sigma_y_params,
  jump_dist = jump_dist, jump_params = jump_params, 
  nu = nu, rho_z = rho_z, omega = omega, alpha = alpha, delta = delta)
custom &lt;- modelSim(t = 250, dynamics = custom_mod)
  
plot(custom$volatility_factor, type = 'l',
  main = 'Custom Model Simulated Volatility Factor', ylab = 'Volatility Factor')
plot(custom$returns, type = 'l',
  main = 'Custom Model Simulated Returns', ylab = 'Returns')
</code></pre>


</div>