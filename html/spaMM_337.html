<div class="container">

<table style="width: 100%;"><tr>
<td>is_separated</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Checking for (quasi-)separation in binomial-response model.
</h2>

<h3>Description</h3>

<p>Separation occurs in binomial response models when a combination of the predictor variables perfectly predict a level of the response. In such a case the estimates of the coefficients for these variables diverge to (+/-)infinity, and the numerical algorithms typically fail. To anticipate such a problem, the fitting functions in <code>spaMM</code> try to check for separation by default. The check may take much time, and is skipped if the “problem size” exceeds a threshold defined by <code>spaMM.options(separation_max=&lt;.&gt;)</code>, in which case a message will tell users by how much they should increase <code>separation_max</code> to force the check (its exact meaning and default value are subject to changes without notice but the default value aims to correspond to a separation check time of the order of 1s on the author's computer). 
</p>
<p><code>is_separated</code> is a convenient interface to procedures from the <code>ROI</code> package, allowing them to be called explicitly by the user to check bootstrap samples (see Example in <code>anova</code>). 
<code>is_separated.formula</code> is a variant (not yet a formal S3 method) that performs the same check, but using arguments similar to those of <code>fitme(., family=binomial())</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">is_separated(x, y, verbose = TRUE, solver=spaMM.getOption("sep_solver"))
is_separated.formula(formula, ..., separation_max=spaMM.getOption("separation_max"),
                     solver=spaMM.getOption("sep_solver"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Design matrix for fixed effects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Numeric response vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>A model formula
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p><code>data</code> and possibly other arguments of a <code>fitme</code> call. <code>family</code> is ignored if present.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separation_max</code></td>
<td>

<p>numeric: non-default value allow for easier local control of this spaMM option.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver</code></td>
<td>

<p>character: name of linear programming solver used to assess separation; passed to <code>ROI_solve</code>'s <code>solver</code> argument. One can select another solver if the corresponding ROI plugin is installed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Whether to print some messages (e.g., pointing model terms that cause separation) or not.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a boolean; <code>TRUE</code> means there is (quasi-)separation. Screen output may give further information, such as pointing model terms that cause separation.
</p>


<h3>References</h3>

<p>The method accessible by <code>solver="glpk"</code> implements algorithms described by
</p>
<p>Konis, K. 2007. Linear Programming Algorithms for Detecting Separated Data in Binary Logistic Regression Models. DPhil Thesis, Univ. Oxford. <a href="https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a">https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a</a>.
</p>


<h3>See Also</h3>

<p>See also the 'safeBinaryRegression' and 'detectseparation' package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
d &lt;- data.frame(success = rbinom(10, size = 1, prob = 0.9), x = 1:10)
is_separated.formula(formula= success~x, data=d) # FALSE
is_separated.formula(formula= success~I(success^2), data=d) # TRUE
</code></pre>


</div>