<div class="container">

<table style="width: 100%;"><tr>
<td>plot.stabsel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot and Print Methods for Stability Selection
</h2>

<h3>Description</h3>

<p>Display results of stability selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'stabsel'
plot(x, main = deparse(x$call), type = c("maxsel", "paths"),
     xlab = NULL, ylab = NULL, col = NULL, ymargin = 10, np = sum(x$max &gt; 0),
     labels = NULL, ...)
## S3 method for class 'stabsel'
print(x, decreasing = FALSE, print.all = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>stabsel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>plot type; either stability paths (<code>"paths"</code>) or a
plot of the maximum selection frequency (<code>"maxsel"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>labels for the x- and y-axis of the plot. Per
default, sensible labels are used depending on the <code>type</code> of
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors; Typically, one can specify a single
color or one color for each variable. Per default, colors depend on
the maximal selection frequency of the variable and range from grey
to red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymargin</code></td>
<td>
<p>(temporarily) specifies the y margin of of the plot in
lines (see argument <code>"mar"</code> of function <code>par</code>).
This only affects the right margin for <code>type = "paths"</code> and
the left margin for <code>type = "maxsel"</code>. Explicit user specified
margins are kept and are not overwritten.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of variables to plot for the maximum selection
frequency plot (<code>type = "maxsel"</code>); the first <code>np</code>
variables with highest selection frequency are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>variable labels for the plot; one label per variable / effect
must be specified. Per default, the names of <code>x$max</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>logical. Should the selection frequencies be printed
in descending order (<code>TRUE</code>) or in ascending order
(<code>FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.all</code></td>
<td>
<p>logical. Should all selection frequencies be
displayed or only those that are greater than zero?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>plot</code> and <code>print</code>
functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the stability selection procedure
by Meinshausen and Buehlmann (2010) and the improved error bounds by
Shah and Samworth (2013).
</p>
<p>Two of the three arguments <code>cutoff</code>, <code>q</code> and <code>PFER</code>
<em>must</em> be specified. The per-family error rate (PFER), i.e., the
expected number of false positives <code class="reqn">E(V)</code>, where <code class="reqn">V</code> is the
number of false positives, is bounded by the argument <code>PFER</code>.
</p>
<p>As controlling the PFER is more conservative as controlling the
family-wise error rate (FWER), the procedure also controlls the FWER,
i.e., the probability of selecting at least one non-influential
variable (or model component) is less than <code>PFER</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>stabsel</code> with a special <code>print</code> method.
The object has the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>phat</code></td>
<td>
<p>selection probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>
<p>elements with maximal selection probability greater
<code>cutoff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>maximum of selection probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>cutoff used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>average number of selected variables used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER</code></td>
<td>
<p>per-family error rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.type</code></td>
<td>
<p>the sampling type used for stability selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assumption</code></td>
<td>
<p>the assumptions made on the selection
probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>B. Hofner, L. Boccuto and M. Goeker (2015), Controlling false
discoveries in high-dimensional situations: Boosting with stability
selection. <em>BMC Bioinformatics</em>, 16:144.<br>
doi: <a href="https://doi.org/10.1186/s12859-015-0575-3">10.1186/s12859-015-0575-3</a>.
</p>
<p>N. Meinshausen and P. Buehlmann (2010), Stability selection.
<em>Journal of the Royal Statistical Society, Series B</em>,
<b>72</b>, 417–473.
</p>
<p>R.D. Shah and R.J. Samworth (2013), Variable selection with error
control: another look at stability selection. <em>Journal of the Royal
Statistical Society, Series B</em>, <b>75</b>, 55–80.
</p>


<h3>See Also</h3>

<p><code>stabsel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  if (require("TH.data")) {
      ## make data set available
      data("bodyfat", package = "TH.data")
  } else {
      ## simulate some data if TH.data not available. 
      ## Note that results are non-sense with this data.
      bodyfat &lt;- matrix(rnorm(720), nrow = 72, ncol = 10)
  }
  
  ## set seed
  set.seed(1234)

  ####################################################################
  ### using stability selection with Lasso methods:

  if (require("lars")) {
      (stab.lasso &lt;- stabsel(x = bodyfat[, -2], y = bodyfat[,2],
                             fitfun = lars.lasso, cutoff = 0.75,
                             PFER = 1))
      par(mfrow = c(2, 1))
      plot(stab.lasso, ymargin = 6)
      opar &lt;- par(mai = par("mai") * c(1, 1, 1, 2.7))
      plot(stab.lasso, type = "paths")
  }
</code></pre>


</div>