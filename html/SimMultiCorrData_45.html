<div class="container">

<table style="width: 100%;"><tr>
<td>plot_sim_theory</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Simulated Data and Target Distribution Data by Name or Function for Continuous or Count Variables</h2>

<h3>Description</h3>

<p>This plots simulated continuous or count data and overlays data (if <code>overlay</code> = TRUE) generated from the target
distribution, which is specified by name (plus up to 4 parameters) or pdf function <code>fx</code> (plus support bounds).
Due to the integration involved in evaluating the cdf using <code>fx</code>, only continuous <code>fx</code> may be supplied.  Both are plotted
as histograms.  If a continuous target distribution is specified (<code>cont_var = TRUE</code>), the simulated data <code class="reqn">y</code> is
scaled and then transformed (i.e. <code class="reqn">y = sigma * scale(y) + mu</code>) so that it has the same mean (<code class="reqn">mu</code>) and variance (<code class="reqn">sigma^2</code>) as the
target distribution.  If the variable is Negative Binomial, the parameters must be size and success probability (not mu).
It returns a <code>ggplot2-package</code> object so the user can modify as necessary.
The graph parameters (i.e. <code>title</code>, <code>power_color</code>, <code>target_color</code>,
<code>target_lty</code>) are <code>ggplot2-package</code> parameters.  It works for valid or invalid power method pdfs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_sim_theory(sim_y, title = "Simulated Data Values", ylower = NULL,
  yupper = NULL, power_color = "dark blue", overlay = TRUE,
  cont_var = TRUE, target_color = "dark green", nbins = 100,
  Dist = c("Benini", "Beta", "Beta-Normal", "Birnbaum-Saunders", "Chisq",
  "Dagum", "Exponential", "Exp-Geometric", "Exp-Logarithmic", "Exp-Poisson",
  "F", "Fisk", "Frechet", "Gamma", "Gaussian", "Gompertz", "Gumbel",
  "Kumaraswamy", "Laplace", "Lindley", "Logistic", "Loggamma", "Lognormal",
  "Lomax", "Makeham", "Maxwell", "Nakagami", "Paralogistic", "Pareto", "Perks",
  "Rayleigh", "Rice", "Singh-Maddala", "Skewnormal", "t", "Topp-Leone",
  "Triangular", "Uniform", "Weibull", "Poisson", "Negative_Binomial"),
  params = NULL, fx = NULL, lower = NULL, upper = NULL, seed = 1234,
  sub = 1000, legend.position = c(0.975, 0.9), legend.justification = c(1,
  1), legend.text.size = 10, title.text.size = 15, axis.text.size = 10,
  axis.title.size = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim_y</code></td>
<td>
<p>a vector of simulated data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title for the graph (default = "Simulated Data Values")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylower</code></td>
<td>
<p>the lower y value to use in the plot (default = NULL, uses minimum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yupper</code></td>
<td>
<p>the upper y value (default = NULL, uses maximum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_color</code></td>
<td>
<p>the histogram fill color for the simulated variable (default = "dark blue")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay</code></td>
<td>
<p>if TRUE (default), the target distribution is also plotted given either a distribution name (and parameters)
or pdf function fx (with support bounds = lower, upper)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont_var</code></td>
<td>
<p>TRUE (default) for continuous variables, FALSE for count variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_color</code></td>
<td>
<p>the histogram fill color for the target distribution (default = "dark green")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>the number of bins to use when creating the histograms (default = 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dist</code></td>
<td>
<p>name of the distribution. The possible values are: "Benini", "Beta", "Beta-Normal", "Birnbaum-Saunders", "Chisq",
"Exponential", "Exp-Geometric", "Exp-Logarithmic", "Exp-Poisson", "F", "Fisk", "Frechet", "Gamma", "Gaussian", "Gompertz",
"Gumbel", "Kumaraswamy", "Laplace", "Lindley", "Logistic", "Loggamma", "Lognormal", "Lomax", "Makeham", "Maxwell",
"Nakagami", "Paralogistic", "Pareto", "Perks", "Rayleigh", "Rice", "Singh-Maddala", "Skewnormal", "t", "Topp-Leone", "Triangular",
"Uniform", "Weibull", "Poisson", and "Negative_Binomial".
Please refer to the documentation for each package (either <code>stats-package</code>, <code>VGAM-package</code>, or
<code>triangle</code>) for information on appropriate parameter inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a vector of parameters (up to 4) for the desired distribution (keep NULL if <code>fx</code> supplied instead)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>a pdf input as a function of x only, i.e. fx &lt;- function(x) 0.5*(x-1)^2; must return a scalar
(keep NULL if <code>Dist</code> supplied instead)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower support bound for a supplied fx, else keep NULL (note: if an error is thrown from <code>uniroot</code>,
try a slightly higher lower bound; i.e., 0.0001 instead of 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the upper support bound for a supplied fx, else keep NULL (note: if an error is thrown from <code>uniroot</code>,
try a lower upper bound; i.e., 100000 instead of Inf)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed value for random number generation (default = 1234)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>the number of subdivisions to use in the integration to calculate the cdf from fx; if no result, try increasing
sub (requires longer computation time; default = 1000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>the position of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.justification</code></td>
<td>
<p>the justification of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>the size of the legend labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.text.size</code></td>
<td>
<p>the size of the plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.size</code></td>
<td>
<p>the size of the axes text (tick labels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.size</code></td>
<td>
<p>the size of the axes titles</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot2-package</code> object.
</p>


<h3>References</h3>

<p>Please see the references for <code>plot_cdf</code>.
</p>
<p>Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.
</p>


<h3>See Also</h3>

<p><code>calc_theory</code>,
<code>ggplot2-package</code>, <code>geom_histogram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Logistic Distribution: mean = 0, variance = 1
seed = 1234

# Find standardized cumulants
stcum &lt;- calc_theory(Dist = "Logistic", params = c(0, 1))

# Simulate without the sixth cumulant correction
# (invalid power method pdf)
Logvar1 &lt;- nonnormvar1(method = "Polynomial", means = 0, vars = 1,
                       skews = stcum[3], skurts = stcum[4],
                       fifths = stcum[5], sixths = stcum[6],
                       n = 10000, seed = seed)

# Plot simulated variable (invalid) and data from theoretical distribution
plot_sim_theory(sim_y = Logvar1$continuous_variable,
                title = "Invalid Logistic Simulated Data Values",
                overlay = TRUE, Dist = "Logistic", params = c(0, 1),
                seed = seed)

# Simulate with the sixth cumulant correction
# (valid power method pdf)
Logvar2 &lt;- nonnormvar1(method = "Polynomial", means = 0, vars = 1,
                       skews = stcum[3], skurts = stcum[4],
                       fifths = stcum[5], sixths = stcum[6],
                       Six = seq(1.5, 2, 0.05), n = 10000, seed = seed)

# Plot simulated variable (valid) and data from theoretical distribution
plot_sim_theory(sim_y = Logvar2$continuous_variable,
                title = "Valid Logistic Simulated Data Values",
                overlay = TRUE, Dist = "Logistic", params = c(0, 1),
                seed = seed)

# Simulate 2 Negative Binomial distributions and correlation 0.3
# using Method 1
NBvars &lt;- rcorrvar(k_nb = 2, size = c(10, 15), prob = c(0.4, 0.3),
                   rho = matrix(c(1, 0.3, 0.3, 1), 2, 2), seed = seed)

# Plot pdfs of 1st simulated variable and theoretical distribution
plot_sim_theory(sim_y = NBvars$Neg_Bin_variable[, 1], overlay = TRUE,
                cont_var = FALSE, Dist = "Negative_Binomial",
                params = c(10, 0.4))


## End(Not run)

</code></pre>


</div>