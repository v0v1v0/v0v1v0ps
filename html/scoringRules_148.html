<div class="container">

<table style="width: 100%;"><tr>
<td>scores_mixnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating scores for a mixture of normal distributions.</h2>

<h3>Description</h3>

<p>Calculating scores for a mixture of normal distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crps_mixnorm(y, m, s, w = NULL)

crps_mixnorm_int(y, m, s, w = NULL, rel_tol = 1e-06)

logs_mixnorm(y, m, s, w = NULL)

dss_mixnorm(y, m, s, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>matrix of mean parameters; rows represent observations, columns represent mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>matrix of scale parameters; same structure as <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>optional; matrix of non-negative weights; same structure as <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_tol</code></td>
<td>
<p>relative accuracy for numerical integration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>logs_mixnorm</code> and <code>crps_mixnorm</code> calculate scores via analytical formulas. <code>crps_mixnorm_int</code> uses numerical integration for the CRPS; this can be faster if there are many mixture components (i.e., if <code>m</code>, <code>s</code> and <code>w</code> have many columns). See examples below.
</p>


<h3>Value</h3>

<p>A vector of score values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1: 100 observations, 15 mixture components
mval &lt;- matrix(rnorm(100*15), nrow = 100)
sdval &lt;- matrix(rgamma(100*15, shape = 2), nrow = 100)
weights &lt;- matrix(rep(1/15, 100*15), nrow = 100)
y &lt;- rnorm(100)
crps1 &lt;- crps_mixnorm(y = y, m = mval, s = sdval, w = weights)
crps2 &lt;- crps_mixnorm_int(y = y, m = mval, s = sdval, w = weights)

## Not run: 
# Example 2: 2 observations, 10000 mixture components
mval &lt;- matrix(rnorm(2*10000), nrow = 2)
sdval &lt;- matrix(rgamma(2*10000, shape = 2), nrow = 2)
weights &lt;- matrix(rep(1/10000, 2*10000), nrow = 2)
y &lt;- rnorm(2)
# With many mixture components, numerical integration is much faster
system.time(crps1 &lt;- crps_mixnorm(y = y, m = mval, s = sdval, w = weights))
system.time(crps2 &lt;- crps_mixnorm_int(y = y, m = mval, s = sdval, w = weights))

## End(Not run)
</code></pre>


</div>