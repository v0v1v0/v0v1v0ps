<div class="container">

<table style="width: 100%;"><tr>
<td>relltest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RELL Test for Phylogenetic Inference</h2>

<h3>Description</h3>

<p>Performs the RELL test for finding the largest item. This
calculates AU p-values for each item via the multiscale bootstrap resampling.
This is particularly useful for testing tree topologies in phylogenetic analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
relltest(dat,nb=10000,sa=9^seq(-1,1,length=13),ass=NULL,
         cluster=NULL,nofit=FALSE,models=NULL,seed=100)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a matrix. Row vectors are to be resampled. Each column
vector gives score values to be evaluated for an item. For the
phylogenetic analysis, <code>dat[i,j]</code> is the site-wise log-likelihood value
at site-i for tree-j, and we are to find the tree with the largest
expected value of <code>sum(dat[,j])</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>Number of replicates for each scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sa</code></td>
<td>
<p>Scales in sigma squared (<code class="reqn">\sigma^2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ass</code></td>
<td>
<p>A list of association vectors for testing edges as well as
trees. If <code>ass=NULL</code>, then only the results for trees are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p><span class="pkg">parallel</span> cluster object which may be generated by
function <code>makeCluster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nofit</code></td>
<td>
<p>logical. Passed to <code>sbfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>character vectors. Passed to <code>sbfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>If non NULL, then a random seed is set. Specifying a seed is
particularly important when <code>cluster</code> is non NULL, in this
case <code>seed + seq(along=cluster)</code> are set to cluster nodes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>relltest</code> performs the resampling of estimated log-likelihoods
(RELL) method of Kishino et al. (1990). For resampling indices stored
in a vector <code>i</code>, the resampled log-likelihood for a tree-j is
approximately calculated by <code>sum(dat[i,j])</code>. This approximation
avoids time-consuming recalculation of the maximum likelihood
estimates of tree parameters, which are to be calculated by an
external phylogenetic software such as PAML as described in
<code>mam15</code>. In the implementation of <code>relltest</code>, the
resampled log-likelihood is calculated by
<code>sum(dat[i,j])</code><code>*nrow(dat)/length(i)</code> so that the statistic is
comparable to the case when <code class="reqn">n'=n</code>.
</p>
<p><code>relltest</code> first calls <code>scaleboot</code> internally for
multiscale bootstrap resampling, and then <code>scaleboot</code>
calls <code>sbfit</code> for fitting models to the bootstrap
probabilities. The AU p-values (named "k.3") produced
by the <code>summary</code> method are improvements
of the third-order p-values calculated by CONSEL software (Shimodaira
and Hasegawa 2001).  In addition,
<code>relltest</code> calls <code>scaleboot</code> with <code>sa=1</code> for
calculating p-values via the Shimodaira-Hasegawa test (SH-test) of
Shimodaira and Hasegawa (1999).
</p>
<p>See <code>mam15</code> for details through an example.
</p>


<h3>Value</h3>

<p><code>relltest</code> returns an object of class <code>"relltest"</code> that is
inherited from the class
<code>"scalebootv"</code> by adding two extra components called "stat"
and "shtest". "stat" is a vector of the test statistics from the
SH-test (i.e., the log-likelihood differences), and
"shtest" is a list with two components: "pv", a vector of SH-test
p-values, and "pe", a vector of standard errors of the
p-values.  The results of multiscale bootstrap resampling are stored
in the <code>"scalebootv"</code> components returned by a call to
<code>sbfit</code>.
</p>


<h3>Author(s)</h3>

<p>Hidetoshi Shimodaira</p>


<h3>References</h3>

<p>Kishino, H., Miyata, T. and Hasegawa, M. (1990). Maximum likelihood
inference of  protein phylogeny and the origin of
chloroplasts.,  <em>J. Mol. Evol.</em>, 30, 151-160.
</p>
<p>Shimodaira, H. and Hasegawa, M. (1999). Multiple comparisons of
log-likelihoods with applications to phylogenetic inference,
<em>Molecular Biology and Evolution</em>, 16, 1114-1116.
</p>
<p>Shimodaira, H. and Hasegawa, M. (2001). CONSEL: for assessing the
confidence of phylogenetic tree selection, <em>Bioinformatics</em>, 17,
1246-1247 (software is available from
<a href="http://stat.sys.i.kyoto-u.ac.jp/prog/consel/">http://stat.sys.i.kyoto-u.ac.jp/prog/consel/</a>).
</p>
<p>Luke Tierney, A. J. Rossini, Na Li and H. Sevcikova. snow: Simple
Network of Workstations. R package version 0.2-1.
</p>


<h3>See Also</h3>

<p><code>sbfit</code>, <code>scaleboot</code>, <code>mam15</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## a quick example
data(mam15) # loading mam15.mt
mam15.trees &lt;- relltest(mam15.mt,nb=1000) # nb=10000 is default
mam15.trees # SH-test p-values and result of fitting
summary(mam15.trees) # AU p-values

## End(Not run)

## Not run: 
## An example from data(mam15).
## It may take 20 mins to run relltest below.
mam15.mt &lt;- read.mt("mam15.mt") # site-wise log-likelihoods
mam15.trees &lt;- relltest(mam15.mt) # resampling and fitting
summary(mam15.trees) # AU p-values

## End(Not run)

</code></pre>


</div>