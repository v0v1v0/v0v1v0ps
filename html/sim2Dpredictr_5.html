<div class="container">

<table style="width: 100%;"><tr>
<td>corr_fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Specify the Correlation Function between Two Locations</h2>

<h3>Description</h3>

<p>This is primarily for use within correlation builder, and may be 
altered/expanded to handle more complicated correlation functions
if desired.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corr_fun(
  corr.structure,
  im.res,
  corr.min = NULL,
  rho = NULL,
  phi = NULL,
  neighborhood = "none",
  round.d = FALSE,
  w = NULL,
  h = NULL,
  r = NULL,
  i,
  j,
  k,
  v
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>corr.structure</code></td>
<td>
<p>One of <code>"ar1"</code>, <code>"exponential"</code>, 
<code>"gaussian"</code>, or <code>"CS"</code>. Correlations between locations i 
and j are <code>rho</code><code class="reqn">^{d}</code> for <code>corr.structure = "ar1"</code>, 
<code class="reqn">exp(-phi * d)</code> for <code>corr.structure = "exponential"</code>,
<code class="reqn">exp(-phi * d ^ 2)</code> for <code>corr.structure = "gaussian"</code>, and 
<code>rho</code> when <code>corr.structure = "CS"</code>. Note that <code>d</code> is the
Euclidean distance between locations i and j.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>im.res</code></td>
<td>
<p>A vector defining the dimension of spatial data. The first
entry is the number of rows and the second  entry is the number of columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr.min</code></td>
<td>
<p>Scalar value to specify the minimum non-zero correlation. 
Any correlations below <code>corr.min</code> are set to 0. Especially for high 
image resolution using this option can result in a sparser covariance 
matrix, which may significantly speed up draws when using <code>spam</code>.
This option is preferred to using <code>neighborhood</code> and associated 
arguments when the primary concern is to avoid very small correlations 
and improve computation efficiency. Default is <code>NULL</code>, which places
no restrictions on the correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>This is the maximum possible correlation between locations i and
j. For all i,j <code>rho</code> MUST be between -1 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A scalar value greater than 0 that determines the decay of 
correlation. This argument is only utilized when <code>corr.structure 
%in% c("exponential", "gaussian")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighborhood</code></td>
<td>
<p>Defines the neighborhood within which marginal 
correlations are non-zero. The default is <code>"none"</code>, which allows 
marginal correlations to extend indefinitely. <code>neighborhood = "round"</code>
defines a circular neighborhood about locations and 
<code>neighborhood = "rectangle"</code> defines a rectangular neighborhood about
locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round.d</code></td>
<td>
<p>If <code>round.d = TRUE</code>, then d is rounded to the nearest
whole number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w, h</code></td>
<td>
<p>If <code>neighborhood = "rectangle"</code> then w and h are the number
of locations to the left/right and above/below a location i that define its
neighborhood. Any locations outside this neighborhood have have zero 
correlation with location i.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>If <code>neighborhood = "round"</code>, then if locations i,j are 
separated by distance <code class="reqn">d \ge r</code>, the correlation between them is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i, j, k, v</code></td>
<td>
<p>These are the coordinates for the two locations. Location 
1 has coordinates (i, j) and location 2 has coordinates (k, v).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A single element vector containing the correlation between spatial 
locations with indices (i, j) and (k, v).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## examples
corr_fun(corr.structure = "ar1", im.res = c(3, 3), rho = 0.5,
         neighborhood = "round", r = 6, i = 1, j = 2, k = 2, v = 3)

corr_fun(corr.structure = "ar1", im.res = c(3, 3), rho = 0.5,
         neighborhood = "rectangle", w = 1, h = 1, 
         i = 1, j = 2, k = 2, v = 3)

</code></pre>


</div>