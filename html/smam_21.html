<div class="container">

<table style="width: 100%;"><tr>
<td>fitMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Moving-Moving Model with 2 Embedded Brownian Motion</h2>

<h3>Description</h3>

<p>Fit a Moving-Moving Model with 2 Embedded Brownian Motion with animal
movement data at discretely observation times by maximizing a full
likelihood constructed from the marginal density of increment.
'estVarMM' uses parametric bootstrap to obtain variance matrix
of estimators from 'fitMM'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitMM(
  data,
  start,
  logtr = FALSE,
  method = "Nelder-Mead",
  optim.control = list(),
  integrControl = integr.control()
)

estVarMM(
  est_theta,
  data,
  nBS,
  detailBS = FALSE,
  numThreads = 1,
  integrControl = integr.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data used to process estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value of the model, a vector of four components
in the order of rate for moving1, rate for moving2,
and volatility1(larger), volatility2(smaller).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtr</code></td>
<td>
<p>logical, if TRUE parameters are estimated on the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method argument to feed <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>a list of control to be passed to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>a list of control parameters for the <code>integrate</code>
function: rel.tol, abs.tol, subdivision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_theta</code></td>
<td>
<p>estimators of MRME model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBS</code></td>
<td>
<p>number of bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detailBS</code></td>
<td>
<p>whether or not output estimation results during bootstrap,
which can be used to generate bootstrap CI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numThreads</code></td>
<td>
<p>the number of threads for parallel computation. If its value
is greater than 1, then parallel computation will be processed. Otherwise,
serial computation will be processed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the esimated parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>maximized loglikelihood or composite loglikelihood
evaluated at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>convergence code from <code>optim</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yan, J., Chen, Y., Lawrence-Apfel, K., Ortega, I. M., Pozdnyakov, V.,
Williams, S., and Meyer, T. (2014) A moving-resting process with an
embedded Brownian motion for animal movements.
Population Ecology. 56(2): 401â€“415.
</p>
<p>Pozdnyakov, V., Elbroch, L., Labarga, A., Meyer, T., and Yan, J.
(2017) Discretely observed Brownian motion governed by telegraph
process: estimation. Methodology and Computing in Applied Probability.
doi:10.1007/s11009-017-9547-6.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## time consuming example
tgrid &lt;- seq(0, 100, length=100)
set.seed(123)
dat &lt;- rMM(tgrid, 1, 0.1, 1, 0.1, "m1")

## fit whole dataset to the MR model
fit &lt;- fitMM(dat, start=c(1, 0.1, 1, 0.1))
fit

var &lt;- estVarMM(fit$estimate, dat, nBS = 10, numThreads = 6)
var

## End(Not run)
</code></pre>


</div>