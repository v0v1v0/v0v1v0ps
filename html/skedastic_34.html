<div class="container">

<table style="width: 100%;"><tr>
<td>pRQF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probabilities for a Ratio of Quadratic Forms in a Normal Random Vector</h2>

<h3>Description</h3>

<p>This function computes cumulative probabilities (lower or upper tail) on a
ratio of quadratic forms in a vector of normally distributed
random variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pRQF(
  r,
  A,
  B,
  Sigma = diag(nrow(A)),
  algorithm = c("imhof", "davies", "integrate"),
  lower.tail = TRUE,
  usenames = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A double representing the value(s) for which <code class="reqn">\Pr(R\le r)</code> or
<code class="reqn">\Pr(R \ge r)</code> should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A numeric, symmetric matrix that is symmetric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A numeric, symmetric, non-negative definite matrix having the same
dimensions as <code>A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A numeric, symmetric matrix with the same dimensions as
<code>A</code> and <code>B</code>, denoting the covariance matrix of the normal
random vector. Defaults to the identity matrix, corresponding to the case
in which the normal random variables are independent and identically
distributed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>A character, either <code>"imhof"</code>, <code>"davies"</code>, or
<code>"integrate"</code>. Values <code>"imhof"</code> and <code>"integrate"</code>
both implement the Imhof algorithm. The difference is that <code>"imhof"</code>
means that <code>imhof</code> is used, whereas
<code>"integrate"</code> means that <code>integrate</code> is
used (which is slower). The Imhof algorithm is more precise than the
Davies algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the cumulative distribution
function <code class="reqn">\Pr(R \le r)</code> is computed; if <code>FALSE</code>, the survival
function <code class="reqn">\Pr(R \ge r)</code> is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usenames</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the function value has a
<code>names</code> attribute corresponding to <code>r</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Most of the work is done by other functions, namely
<code>imhof</code>, <code>davies</code>,
or <code>integrate</code> (depending on the <code>algorithm</code>
argument). It is assumed that the ratio of quadratic forms can be
expressed as
</p>
<p style="text-align: center;"><code class="reqn">R = \displaystyle\frac{x' A x}{x' B x}</code>
</p>
<p> where <code class="reqn">x</code> is an
<code class="reqn">n</code>-dimensional normally distributed random variable with mean vector
<code class="reqn">\mu</code> and covariance matrix <code class="reqn">\Sigma</code>, and <code class="reqn">A</code> and
<code class="reqn">B</code> are real-valued, symmetric <code class="reqn">n\times n</code> matrices. Matrix
<code class="reqn">B</code> must be non-negative definite to ensure that the denominator of
the ratio of quadratic forms is nonzero.
</p>
<p>The function makes use of the fact that a probability statement involving a
ratio of quadratic forms can be rewritten as a probability statement
involving a quadratic form. Hence, methods for computing probabilities
for a quadratic form in normal random variables, such as the Imhof
algorithm (Imhof 1961) or the Davies algorithm
(Davies 1980) can be applied to the rearranged
expression to obtain the probability for the ratio of quadratic forms.
Note that the Ruben-Farebrother algorithm (as implemented in
<code>farebrother</code>) cannot be used here because the
<code class="reqn">A</code> matrix within the quadratic form (after rearrangement of the
probability statement involving a ratio of quadratic forms) is not in
general positive semi-definite.
</p>


<h3>Value</h3>

<p>A double denoting the probability/ies corresponding to the value(s)
<code>r</code>.
</p>


<h3>References</h3>

<p>Davies RB (1980).
“Algorithm AS 155: The Distribution of a Linear Combination of <code class="reqn">\chi^2</code> Random Variables.”
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, <b>29</b>, 323–333.<br><br> Imhof JP (1961).
“Computing the Distribution of Quadratic Forms in Normal Variables.”
<em>Biometrika</em>, <b>48</b>(3/4), 419–426.
</p>


<h3>See Also</h3>

<p>Duchesne and de Micheaux (2010), the article associated
with the <code>imhof</code> and
<code>davies</code> functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 20
A &lt;- matrix(data = 1, nrow = n, ncol = n)
B &lt;- diag(n)
pRQF(r = 1, A = A, B = B)
pRQF(r = 1, A = A, B = B, algorithm = "integrate")
pRQF(r = 1:3, A = A, B = B, algorithm = "davies")

</code></pre>


</div>