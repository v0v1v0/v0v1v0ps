<div class="container">

<table style="width: 100%;"><tr>
<td>controlSpATS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Used to set various parameters controlling the fitting process
</h2>

<h3>Description</h3>

<p>This function can be used to modify some default parameters that control the estimation of an SpATS model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">controlSpATS(maxit = 200, tolerance = 0.001, monitoring = 2, update.psi = FALSE, 
	update.psi.gauss = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>numerical value indicating the maximum number of iterations. Default set to 200 (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>numerical value indicating the tolerance for the convergence criterion. Default set to 0.001 (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitoring</code></td>
<td>
<p>numerical value determining the level of printing which is done during the estimation. The value of 0 means that no printing is produced, a value of 1 means that only the computing times are printed, and a value of 2 means that, at each iteration, the (REML) deviance and the effective dimensions of the random components are printed. Default set to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update.psi</code></td>
<td>
<p>logical. If TRUE, the dispersion parameter of the exponential family is updated at each iteration of the estimation algorithm. Default is FALSE, except for <code>family = gaussian()</code>, where the dispersion parameter (or residual variance), is updated (jointly with the rest of variance components) unless <code>update.psi.gauss</code> is set to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update.psi.gauss</code></td>
<td>
<p>logical. Only applies to <code>family = gaussian()</code>. If set to FALSE (default is TRUE) the residual variance is not updated at each iteration of the estimation algorithm but fixed at 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimation procedure implemented in the SpATS package is an extension of the SAP (Separation of anisotropic penalties) algorithm by Rodriguez - Alvarez et al. (2015). In this case, besides the spatial trend, modelled as a two-dimensional P-spline, the estimation algorithm allows for the incorporation of both fixed and (sets of i.i.d) random effects on the (generalised) linear mixed model. 
For Gaussian response variables, the algorithm is an iterative procedure, with the fixed and random effects as well as the variance components being updated at each iteration. To check the convergence of this iterative procedure, the (REML) deviance is monitored.
For non-Gaussian response variables, estimation is based on Penalized Quasi-likelihood (PQL) methods. Here, the algorithm is a two-loop algorithm: the outer loop corresponds to the Fisher-Scoring algorithm (monitored on the basis of the change in the linear predictor between consecutive iterations), and the inner loop corresponds to that described for the Gaussian case. 
</p>


<h3>Value</h3>

<p>a list with components for each of the possible arguments.
</p>


<h3>References</h3>

<p>Rodriguez-Alvarez, M.X., Lee, D.-J., Kneib, T., Durban, M., and Eilers, P.H.C. (2015). Fast smoothing parameter separation in multidimensional generalized P-splines: the SAP algorithm. Statistics and Computing, 25, 941 - 957.
</p>


<h3>See Also</h3>

<p><code>SpATS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpATS)
data(wheatdata)
wheatdata$R &lt;- as.factor(wheatdata$row)
wheatdata$C &lt;- as.factor(wheatdata$col)

# Default control parameters
m0 &lt;- SpATS(response = "yield", spatial = ~ SAP(col, row, nseg = c(10,20)), 
 genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, 
 data = wheatdata)

# Modified the number of iterations, the tolerance, and the monitoring
m1 &lt;- SpATS(response = "yield", spatial = ~ SAP(col, row, nseg = c(10,20)), 
 genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, 
 data = wheatdata, control = list(maxit = 50, tolerance = 1e-06, monitoring = 1))
</code></pre>


</div>