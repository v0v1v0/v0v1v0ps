<div class="container">

<table style="width: 100%;"><tr>
<td>fitSSTVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimation of a structural STVAR model based on preliminary estimates from
a reduced form model.</h2>

<h3>Description</h3>

<p><code>fitSSTVAR</code> uses a robust method and a variable metric algorithm to estimate
a structural STVAR model based on preliminary estimates from a reduced form model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitSSTVAR(
  stvar,
  identification = c("recursive", "heteroskedasticity", "non-Gaussianity"),
  B_constraints = NULL,
  maxit = 1000,
  maxit_robust = 1000,
  robust_method = c("Nelder-Mead", "SANN", "none"),
  print_res = TRUE,
  calc_std_errors = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stvar</code></td>
<td>
<p>a an object of class <code>'stvar'</code>, created by, e.g., <code>fitSTVAR</code>,
specifying a reduced form or a structural model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identification</code></td>
<td>
<p>Which identification should the structural model use?
(see the vignette or the references for details)
</p>

<dl>
<dt>
<code>"recursive"</code>:</dt>
<dd>
<p>The usual lower-triangular recursive identification of the shocks via their impact responses.</p>
</dd>
<dt>
<code>"heteroskedasticity"</code>:</dt>
<dd>
<p>Identification by conditional heteroskedasticity, which imposes constant relative
impact responses for each shock.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_constraints</code></td>
<td>
<p>Employ further constraints on the impact matrix?
A <code class="reqn">(d \times d)</code> matrix with its entries imposing constraints on the impact matrix <code class="reqn">B_t</code>:
<code>NA</code> indicating that the element is unconstrained, a positive value indicating strict positive sign constraint,
a negative value indicating strict negative sign constraint, and zero indicating that the element is constrained to zero.
Currently only available for models with <code>identification="heteroskedasticity"</code> due to the (in)availability of appropriate
parametrizations that allow such constraints to be imposed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the maximum number of iterations in the variable metric algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit_robust</code></td>
<td>
<p>the maximum number of iterations on the first phase robust estimation, if employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust_method</code></td>
<td>
<p>Should some robust estimation method be used in the estimation before switching
to the gradient based variable metric algorithm? See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_res</code></td>
<td>
<p>should summaries of estimation results be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_std_errors</code></td>
<td>
<p>should approximate standard errors be calculated?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the structural model does not impose overidentifying constraints, it is directly
obtained from the reduced form model, and estimation is not required. When overidentifying constraints
are imposed, the model is estimated via ..
</p>
<p>Structural models can be provided in the argument <code>stvar</code> if overidentifying constraints should be
imposed.
</p>
<p>Using the robust estimation method before switching to the variable metric can be useful if the initial
estimates are not very close to the ML estimate of the structural model, as the variable metric algorithm
(usually) converges to a nearby local maximum or saddle point. However, if the initial estimates are far from
the ML estimate, the resulting solution is likely local only due to the complexity of the model. Note that
Nelder-Mead algorithm is much faster than SANN but can get stuck at a local solution.
This is particularly the case when the imposed overidentifying restrictions are such that the unrestricted
estimate is not close to satisfying them. Nevertheless, in most practical cases, the model is just identified
and estimation is not required, and often reasonable overidentifying constraints are close to the unrestricted estimate.
</p>
<p>Employs the estimation function <code>optim</code> from the package <code>stats</code> that implements the optimization
algorithms. See <code>?optim</code> for the documentation on the
</p>


<h3>Value</h3>

<p>Returns an S3 object of class <code>'stvar'</code> defining a smooth transition VAR model. The returned list
contains the following components (some of which may be <code>NULL</code> depending on the use case):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input time series data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A list describing the model structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>The parameters of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_errors</code></td>
<td>
<p>Approximate standard errors of the parameters, if calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transition_weights</code></td>
<td>
<p>The transition weights of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regime_cmeans</code></td>
<td>
<p>Conditional means of the regimes, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_cmeans</code></td>
<td>
<p>Total conditional means of the model, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_ccovs</code></td>
<td>
<p>Total conditional covariances of the model, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncond_moments</code></td>
<td>
<p>A list of unconditional moments including regime autocovariances, variances, and means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals_raw</code></td>
<td>
<p>Raw residuals, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals_std</code></td>
<td>
<p>Standardized residuals, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structural_shocks</code></td>
<td>
<p>Recovered structural shocks, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood of the model, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>The values of the information criteria (AIC, HQIC, BIC) for the model, if data is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_estimates</code></td>
<td>
<p>The parameter estimates from all estimation rounds, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_logliks</code></td>
<td>
<p>The log-likelihood of the estimates from all estimation rounds, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_converged</code></td>
<td>
<p>Indicators of which estimation rounds converged, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_round</code></td>
<td>
<p>Indicators of which round of optimization each estimate belongs to, if applicable.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Kilian L., Lütkepohl H. 20017. Structural Vector Autoregressive Analysis. 1st edition.
<em>Cambridge University Press</em>, Cambridge.
</p>
</li>
<li>
<p> Lütkepohl H., Netšunajev A. 2017. Structural vector autoregressions with smooth transition in variances.
<em>Journal of Economic Dynamics &amp; Control</em>, <strong>84</strong>, 43-57.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fitSTVAR</code>, <code>STVAR</code>, <code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## These are long running examples that take approximately 1 minute to run.

## Estimate first a reduced form Gaussian STVAR p=3, M=2 model with the weighted relative
# stationary densities of the regimes as the transition weight function, and the means and
# AR matrices constrained to be identical across the regimes:
fit32cm &lt;- fitSTVAR(gdpdef, p=3, M=2, AR_constraints=rbind(diag(3*2^2), diag(3*2^2)),
  weight_function="relative_dens", mean_constraints=list(1:2), parametrization="mean",
  nrounds=1, seeds=1, ncores=1)

# Then, we estimate/create various structural models based on the reduced form model.
# Create a structural model with the shocks identified recursively:
fit32cms_rec &lt;- fitSSTVAR(fit32cm, identification="recursive")

# Create a structural model with the shocks identified by conditional heteroskedasticity:
fit32cms_hetsked &lt;- fitSSTVAR(fit32cm, identification="heteroskedasticity")
fit32cms_hetsked # Print the estimates

# Estimate a structural model with the shocks identified by conditional heteroskedasticity
# and overidentifying constraints imposed on the impact matrix: positive diagonal element
# and zero upper right element:
fit32cms_hs2 &lt;- fitSSTVAR(fit32cm, identification="heteroskedasticity",
 B_constraints=matrix(c(1, NA, 0, 1), nrow=2))

# Estimate a structural model with the shocks identified by conditional heteroskedasticity
# and overidentifying constraints imposed on the impact matrix: positive diagonal element
# and zero off-diagonal elements:
fit32cms_hs3 &lt;- fitSSTVAR(fit32cms_hs2, identification="heteroskedasticity",
 B_constraints=matrix(c(1, 0, 0, 1), nrow=2))

# Estimate first a reduced form three-regime Student's t Threshold VAR p=3 model with
# the first lag of the second variable as the switching variable, the means and AR
# matrices constrained to be identical across the regimes:
fit32cml &lt;- fitSTVAR(gdpdef, p=3, M=3, cond_dist="Student",
 AR_constraints=rbind(diag(3*2^2), diag(3*2^2), diag(3*2^2)),
 weight_function="threshold", weightfun_pars=c(2, 1), mean_constraints=list(1:3),
 parametrization="mean", nrounds=1, seeds=1, ncores=1)

# Then, we estimate/create various structural models based on the reduced form model.
# Create a structural model with the shocks identified recusively:
fit32cmls_rec &lt;- fitSSTVAR(fit32cml, identification="recursive")

# Estimate a structural model with the shocks identified by conditional heteroskedasticity,
# the model is overidentifying, as it has more than two regimes:
fit32cmls_hs &lt;- fitSSTVAR(fit32cml, identification="heteroskedasticity")
fit32cmls_hs # Print the estimates

# Estimate a structural model with the shocks identified by conditional heteroskedasticity
# and overidentifying constraints imposed on the impact matrix: zero lower left element,
# estimation without employing a robust estimation method:
fit32cmls_hs2 &lt;- fitSSTVAR(fit32cmls_hs, identification="heteroskedasticity",
 B_constraints=matrix(c(NA, 0, NA, NA), nrow=2),
 robust_method="none")

# Relax the zero constraint on the impact matrix and re-estimate the model:
fit32cmls_hs3 &lt;- fitSSTVAR(fit32cmls_hs2, identification="heteroskedasticity",
 B_constraints=matrix(c(NA, NA, NA, NA), nrow=2),
 robust_method="none")

</code></pre>


</div>