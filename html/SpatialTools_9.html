<div class="container">

<table style="width: 100%;"><tr>
<td>krige.sk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Performs simple kriging
</h2>

<h3>Description</h3>

<p>Performs simple kriging using <code>y</code>, a vector of length <code class="reqn">n</code>,
<code>V</code>, the (positive definite) covariance matrix of the 
observed responses, <code>Vp</code>, the 
<code class="reqn">np \times np</code>
covariance matrix of the responses to be predicted, <code>Vop</code>, 
the <code class="reqn">n \times np</code> matrix of covariances between the observed 
responses and the responses to be predicted, and <code>m</code>, a numeric vector 
of length 1 identifying the value of the mean
for each response.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	krige.sk(y, V, Vp, Vop, m = 0, nsim = 0, Ve.diag = NULL, method = "eigen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The vector of observed responses.
Should be a matrix of size <code class="reqn">n \times 1</code> or a vector of 
length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>The covariance matrix of the observed responses.  
The size is <code class="reqn">n \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vp</code></td>
<td>
<p>The covariance matrix of the responses to be predicted.
The size is <code class="reqn">np \times np</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vop</code></td>
<td>
<p>The cross-covariance between the observed responses 
and the responses to be predicted.  The size is 
<code class="reqn">n \times np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>A numeric vector of length 1 giving the mean of each response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulated data sets to sample from the conditional predictive distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ve.diag</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> specifying the measure error variances of the observed data.  Only needed if <code>nsim</code> &gt; 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for decomposing <code>V</code> in conditional simulation.  Default is "eigen", for the Eigen decomposition.  Alternatives are "chol" (Cholesky) and "svd" (Singular Value Decomposition).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that there are <code class="reqn">n</code> observed data values
and that we wish to make predictions at <code class="reqn">np</code> locations.
The mean is subtracted from each value of <code>y</code> before determining the kriging weights, 
and then the mean is added onto the predicted response.
</p>
<p>If doing conditional simulation, the Cholesky decomposition should not work when there are coincident locations between the observed data locations and the predicted data locations.    Both the Eigen and Singular Value Decompositions should work.
</p>
<p>If user specifies <code>nsim</code> to be a positive integer, then <code>nsim</code> conditional realizations of the predictive distribution will be generated.  If this is less than 1, then no conditional simulation is done.  If <code>nsim</code> is a positive integer, then <code>Ve.diag</code> must also be supplied.  <code>Ve.diag</code> is should be a vector of length <code class="reqn">n</code> specifying the measurement error variances of the observed data.  This information is only used for conditional simulation, so this argument is only needed when <code>nsim</code> &gt; 0.  When conditional simulation is desired, then the argument <code>method</code> can be to specify the method used to decompose <code>V</code>.  Options are "eigen", "chol", or "svd" (Eigen decomposition, Cholesky decomposition, or Singular value decomposition, respectively).  This information is only used for conditional simulation, so this argument is only applicable when <code>nsim</code> &gt; 0.
</p>


<h3>Value</h3>

<p>The function returns a list containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A vector of length <code class="reqn">np</code> containing the predicted
responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mspe</code></td>
<td>
<p>A vector of length <code class="reqn">np</code> containing the 
mean-square prediction error of the predicted
responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulations</code></td>
<td>
<p>An <code class="reqn">n \times nsim</code> matrix containing the <code>nsim</code> realizations of the conditional realizations.  Each column of the matrix represents a realization of the conditional normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>The mean value (m) originally provided to the function</p>
</td>
</tr>
</table>
<p>.  
If <code>nsim</code> &gt; 0, this list has class "krigeConditionalSample".
</p>


<h3>Author(s)</h3>

<p>Joshua French</p>


<h3>References</h3>

<p> Statistical Methods for Spatial Data Analysis, Schabenberger and Gotway (2003).  See p. 226-228.</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(toydata)
	y &lt;- as.vector(toydata$y)
	V &lt;- toydata$V
	Vp &lt;- toydata$Vp
	Vop &lt;- toydata$Vop
	krige.sk(y, V, Vp, Vop, m = 2)
</code></pre>


</div>