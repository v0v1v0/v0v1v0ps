<div class="container">

<table style="width: 100%;"><tr>
<td>scglrCrossVal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function that fits and selects the number of component by cross-validation.</h2>

<h3>Description</h3>

<p>Function that fits and selects the number of component by cross-validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scglrCrossVal(formula, data, family, K = 1, nfolds = 5,
  type = "mspe", size = NULL, offset = NULL, subset = NULL,
  na.action = na.omit, crit = list(), method = methodSR(),
  mc.cores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "Formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame to be modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a vector of character of length q specifying the distributions of the responses. Bernoulli, binomial, poisson and gaussian are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of components, default is one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>number of folds, default is 5.
Although nfolds can be as large as the sample size (leave-one-out CV),
it is not recommended for large datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>loss function to use for cross-validation.
Currently six options are available depending on whether the responses are of the same distribution family.
If the responses are all bernoulli distributed, then the prediction performance may be measured
through the area under the ROC curve: type = "auc"
In any other case one can choose among the following five options ("likelihood","aic","aicc","bic","mspe").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>specifies the number of trials of the binomial variables included in the model.  A (n*qb) matrix is expected
for qb binomial variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>used for the poisson dependent variables.
A vector or a matrix of size: number of observations * number of Poisson dependent variables is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default is set to the <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>a list of two elements : maxit and tol, describing respectively the maximum number of iterations and
the tolerance convergence criterion for the Fisher scoring algorithm. Default is set to 50 and 10e-6 respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Regularization criterion type. Object of class "method.SCGLR"
built by <code>methodSR</code> for Structural Relevance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>max number of cores to use when using parallelization (Not available in windows yet and strongly discouraged if in interactive mode).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix containing the criterion values for each response (rows) and each number of components (columns).
</p>


<h3>References</h3>

<p>Bry X., Trottier C., Verron T. and Mortier F. (2013) Supervised Component Generalized Linear Regression using a PLS-extension of the Fisher scoring algorithm. <em>Journal of Multivariate Analysis</em>, 119, 47-60.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(SCGLR)

# load sample data
data(genus)

# get variable names from dataset
n &lt;- names(genus)
ny &lt;- n[grep("^gen",n)]    # Y &lt;- names that begins with "gen"
nx &lt;- n[-grep("^gen",n)]   # X &lt;- remaining names

# remove "geology" and "surface" from nx
# as surface is offset and we want to use geology as additional covariate
nx &lt;-nx[!nx%in%c("geology","surface")]

# build multivariate formula
# we also add "lat*lon" as computed covariate
form &lt;- multivariateFormula(ny,c(nx,"I(lat*lon)"),A=c("geology"))

# define family
fam &lt;- rep("poisson",length(ny))

# cross validation
genus.cv &lt;- scglrCrossVal(formula=form, data=genus, family=fam, K=12,
 offset=genus$surface)

# find best K
mean.crit &lt;- colMeans(log(cv))

#plot(mean.crit, type="l")

## End(Not run)
</code></pre>


</div>