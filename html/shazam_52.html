<div class="container">

<table style="width: 100%;"><tr>
<td>minNumMutationsTune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter tuning for minNumMutations</h2>

<h3>Description</h3>

<p><code>minNumMutationsTune</code> helps with picking a threshold value for <code>minNumMutations</code>
in createSubstitutionMatrix by tabulating the number of 5-mers for which 
substitution rates would be computed directly or inferred at various threshold values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">minNumMutationsTune(subCount, minNumMutationsRange)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>subCount</code></td>
<td>
<p><code>data.frame</code> returned by createSubstitutionMatrix
with <code>numMutationsOnly=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumMutationsRange</code></td>
<td>
<p>a number or a vector indicating the value or range of values
of <code>minNumMutations</code> to try.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At a given threshold value of <code>minNumMutations</code>, for a given 5-mer,
if the total number of mutations is greater than the threshold and there
are mutations to every other base, substitution rates are computed directly
for the 5-mer using its mutations. Otherwise, mutations from 5-mers with 
the same inner 3-mer as the 5-mer of interest are aggregated. If the number 
of such mutations is greater than the threshold and there are mutations to 
every other base, these mutations are used for inferring the substitution 
rates for the 5-mer of interest; if not, mutations from all 5-mers with the 
same center nucleotide are aggregated and used for inferring the substitution
rates for the 5-mer of interest (i.e. the 1-mer model).
</p>


<h3>Value</h3>

<p>A 3xn <code>matrix</code>, where n is the number of trial values of <code>minNumMutations</code>
supplied in <code>minNumMutationsRange</code>. Each column corresponds to a value
in <code>minNumMutationsRange</code>. The rows correspond to the number of 5-mers
for which substitution rates would be computed directly using the 5-mer itself 
(<code>"5mer"</code>), using its inner 3-mer (<code>"3mer"</code>), and using the central 
1-mer (<code>"1mer"</code>), respectively.
</p>


<h3>References</h3>


<ol><li>
<p>  Yaari G, et al. Models of somatic hypermutation targeting and substitution based 
on synonymous mutations from high-throughput immunoglobulin sequencing data. 
Front Immunol. 2013 4(November):358.
</p>
</li></ol>
<h3>See Also</h3>

<p>See argument <code>numMutationsOnly</code> in createSubstitutionMatrix 
for generating the required input <code>data.frame</code> <code>subCount</code>. 
See argument <code>minNumMutations</code> in createSubstitutionMatrix
for what it does.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Subset example data to one isotype and sample as a demo
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call == "IGHA" &amp; sample_id == "-1h")

# Count the number of mutations per 5-mer
subCount &lt;- createSubstitutionMatrix(db, sequenceColumn="sequence_alignment",
                                     germlineColumn="germline_alignment_d_mask",
                                     vCallColumn="v_call",
                                     model="s", multipleMutation="independent",
                                     returnModel="5mer", numMutationsOnly=TRUE)

# Tune minNumMutations
minNumMutationsTune(subCount, seq(from=10, to=80, by=10))
                                      
</code></pre>


</div>