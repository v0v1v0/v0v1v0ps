<div class="container">

<table style="width: 100%;"><tr>
<td>lnam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Fit a Linear Network Autocorrelation Model </h2>

<h3>Description</h3>

<p><code>lnam</code> is used to fit linear network autocorrelation models.  These include standard OLS as a special case, although <code>lm</code> is to be preferred for such analyses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lnam(y, x = NULL, W1 = NULL, W2 = NULL, theta.seed = NULL, 
    null.model = c("meanstd", "mean", "std", "none"), method = "BFGS", 
    control = list(), tol=1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> a vector of responses. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a vector or matrix of covariates; if the latter, each column should contain a single covariate. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W1</code></td>
<td>
<p> one or more (possibly valued) graphs on the elements of <code>y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W2</code></td>
<td>
<p> one or more (possibly valued) graphs on the elements of <code>y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.seed</code></td>
<td>
<p> an optional seed value for the parameter vector estimation process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p> the null model to be fit; must be one of <code>"meanstd"</code>, <code>"mean"</code>, <code>"std"</code>, or <code>"none"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> method to be used with <code>optim</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> optional control parameters for <code>optim</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> convergence tolerance for the MLE (expressed as change in deviance).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lnam</code> fits the linear network autocorrelation model given by
</p>
<p style="text-align: center;"><code class="reqn">y = W_1 y + X \beta + e, \quad e = W_2 e + \nu</code>
</p>

<p>where <code class="reqn">y</code> is a vector of responses, <code class="reqn">X</code> is a covariate matrix, <code class="reqn">\nu \sim N(0,\sigma^2)</code>,  
</p>
<p style="text-align: center;"><code class="reqn">W_1 = \sum_{i=1}^p \rho_{1i} W_{1i}, \quad W_2 = \sum_{i=1}^q \rho_{2i} W_{2i},</code>
</p>

<p>and <code class="reqn">W_{1i}</code>, <code class="reqn">W_{2i}</code> are (possibly valued) adjacency matrices.
</p>
<p>Intuitively, <code class="reqn">\rho_1</code> is a vector of “AR”-like parameters (parameterizing the autoregression of each <code class="reqn">y</code> value on its neighbors in the graphs of <code class="reqn">W_1</code>) while <code class="reqn">\rho_2</code> is a vector of “MA”-like parameters (parameterizing the autocorrelation of each <em>disturbance</em> in <code class="reqn">y</code> on its neighbors in the graphs of <code class="reqn">W_2</code>).  In general, the two models are distinct, and either or both effects may be selected by including the appropriate matrix arguments.
</p>
<p>Model parameters are estimated by maximum likelihood, and asymptotic standard errors are provided as well; all of the above (and more) can be obtained by means of the appropriate <code>print</code> and <code>summary</code> methods.  A plotting method is also provided, which supplies fit basic diagnostics for the estimated model.  For purposes of comparison, fits may be evaluated against one of four null models:
</p>

<ol>
<li> <p><code>meanstd</code>: mean and standard deviation estimated (default).
</p>
</li>
<li> <p><code>mean</code>: mean estimated; standard deviation assumed equal to 1.
</p>
</li>
<li> <p><code>std</code>: standard deviation estimated; mean assumed equal to 0.
</p>
</li>
<li> <p><code>none</code>: no parameters estimated; data assumed to be drawn from a standard normal density.
</p>
</li>
</ol>
<p>The default setting should be appropriate for the vast majority of cases, although the others may have use when fitting “pure” autoregressive models (e.g., without covariates).  Although a major use of the <code>lnam</code> is in controlling for network autocorrelation within a regression context, the model is subtle and has a variety of uses.  (See the references below for suggestions.)
</p>


<h3>Value</h3>

<p>An object of class <code>"lnam"</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response vector used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if supplied, the coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W1</code></td>
<td>
<p>if supplied, the W1 array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W2</code></td>
<td>
<p>if supplied, the W2 array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a code indicating the model terms fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infomat</code></td>
<td>
<p>the estimated Fisher information matrix for the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acvm</code></td>
<td>
<p>the estimated asymptotic covariance matrix for the model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p>a string indicating the null model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnlik.null</code></td>
<td>
<p>the log-likelihood of y under the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.null.resid</code></td>
<td>
<p>the residual degrees of freedom under the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.null</code></td>
<td>
<p>the model degrees of freedom under the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.param</code></td>
<td>
<p>parameter estimates for the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnlik.model</code></td>
<td>
<p>the log-likelihood of y under the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.model</code></td>
<td>
<p>the model degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.total</code></td>
<td>
<p>the total degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho1</code></td>
<td>
<p>if applicable, the MLE for rho1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho1.se</code></td>
<td>
<p>if applicable, the asymptotic standard error for rho1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>if applicable, the MLE for rho2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2.se</code></td>
<td>
<p>if applicable, the asymptotic standard error for rho2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the MLE for sigma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.se</code></td>
<td>
<p>the standard error for sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>if applicable, the MLE for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.se</code></td>
<td>
<p>if applicable, the asymptotic standard errors for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals (response minus fitted); note that these correspond to <code class="reqn">\hat{e}</code> in the model equation, not <code class="reqn">\hat{\nu}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disturbances</code></td>
<td>
<p>the estimated disturbances, i.e., <code class="reqn">\hat{\nu}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Actual optimization is performed by calls to <code>optim</code>.  Information on algorithms and control parameters can be found via the appropriate man pages. </p>


<h3>Author(s)</h3>

<p> Carter T. Butts <a href="mailto:buttsc@uci.edu">buttsc@uci.edu</a> </p>


<h3>References</h3>

 
<p>Leenders, T.Th.A.J.  (2002)  “Modeling Social Influence Through Network Autocorrelation: Constructing the Weight Matrix”  <em>Social Networks</em>, 24(1), 21-47. 
</p>
<p>Anselin, L.  (1988)  <em>Spatial Econometrics: Methods and Models.</em>  Norwell, MA: Kluwer.
</p>


<h3>See Also</h3>

 <p><code>lm</code>, <code>optim</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Construct a simple, random example:
w1&lt;-rgraph(100)               #Draw the AR matrix
w2&lt;-rgraph(100)               #Draw the MA matrix
x&lt;-matrix(rnorm(100*5),100,5) #Draw some covariates
r1&lt;-0.2                       #Set the model parameters
r2&lt;-0.1
sigma&lt;-0.1
beta&lt;-rnorm(5)
#Assemble y from its components:
nu&lt;-rnorm(100,0,sigma)          #Draw the disturbances
e&lt;-qr.solve(diag(100)-r2*w2,nu) #Draw the effective errors
y&lt;-qr.solve(diag(100)-r1*w1,x%*%beta+e)  #Compute y

#Now, fit the autocorrelation model:
fit&lt;-lnam(y,x,w1,w2)
summary(fit)
plot(fit)

## End(Not run)
</code></pre>


</div>