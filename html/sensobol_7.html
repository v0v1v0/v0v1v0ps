<div class="container">

<table style="width: 100%;"><tr>
<td>metafunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random metafunction based on Becker (2020)'s metafunction.</h2>

<h3>Description</h3>

<p>Random metafunction based on Becker (2020)'s metafunction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metafunction(data, k_2 = 0.5, k_3 = 0.2, epsilon = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric matrix where each column is a model input and each row a sampling point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_2</code></td>
<td>
<p>Numeric value indicating the fraction of active pairwise interactions (between 0 and 1).
Default is <code>k_2 = 0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_3</code></td>
<td>
<p>Numeric value indicating the fraction of active three-wise interactions
(between 0 and 1). Default is <code>k_2 = 0.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Integer value. It fixes the seed for the random number generator.
The default is <code>epsilon = NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The metafunction randomly combines the following functions in a metafunction of dimension <code class="reqn">k</code>:
</p>

<ul>
<li> <p><code class="reqn">f(x) = x ^ 3</code> (cubic).
</p>
</li>
<li> <p><code class="reqn">f(x) = 1~\mbox{if}(x &gt; 0.5), 0~\mbox{otherwise}</code> (discontinuous).
</p>
</li>
<li> <p><code class="reqn">f(x) = \frac{e ^ x}{e - 1}</code> (exponential).
</p>
</li>
<li> <p><code class="reqn">f(x) = \frac{10 - 1}{1.1} ^ {-1} (x + 0.1) ^ {-1}</code> (inverse).
</p>
</li>
<li> <p><code class="reqn">f(x) = x</code> (linear)
</p>
</li>
<li> <p><code class="reqn">f(x) = 0</code> (no effect).
</p>
</li>
<li> <p><code class="reqn">f(x) = 4(x - 0.5) ^  2</code> (non-monotonic).
</p>
</li>
<li> <p><code class="reqn">f(x) = \frac{\sin (2 \pi x)}{2}</code> (periodic).
</p>
</li>
<li> <p><code class="reqn">f(x) = x ^ 2</code> (quadratic).
</p>
</li>
<li> <p><code class="reqn">f(x) = \cos(x)</code> (trigonometric).
</p>
</li>
</ul>
<p>It is constructed as follows:
</p>
<p style="text-align: center;"><code class="reqn">y=\sum_{i=1}^{k}\alpha_i f^{u_i}(x_i) \\
 + \sum_{i=1}^{k_2}\beta_i f^{u_{V_{i,1}}}(x_{V_{i,1}}) f^{u_{V_{i,2}}} (x_{V_{i,2}}) \\
+ \sum_{i=1}^{k_3}\gamma_i f^{u_{W_{i,1}}}(x_{W_{i,1}}) f^{u_{W_{i,2}}}(x_{W_{i,2}}) f^{u_{W_{i,3}}} (x_{W_{i,3}})</code>
</p>

<p>where <code class="reqn">k</code> is the model dimensionality, <code class="reqn">u</code> is a <code class="reqn">k</code>-length vector formed by randomly
sampling with replacement the ten functions mentioned above, <code class="reqn">V</code> and <code class="reqn">W</code> are two matrices specifying the
number of pairwise and three-wise interactions given the model dimensionality,
and <code class="reqn">\mathbf{\alpha}, \mathbf{\beta}, \mathbf{\gamma}</code> are three
vectors of length <code class="reqn">k</code> generated by sampling from a mixture of two normal distributions
<code class="reqn">\Psi=0.3\mathcal{N}(0, 5) + 0.7\mathcal{N}(0, 0.5)</code>.
See Puy et al. (2020) and Becker (2020) for a full
mathematical description of the metafunction approach.
</p>


<h3>Value</h3>

<p>A numeric vector with the function output.
</p>


<h3>References</h3>

<p>Becker W (2020).
“Metafunctions for benchmarking in sensitivity analysis.”
<em>Reliability Engineering and System Safety</em>, <b>204</b>, 107189.
<a href="https://doi.org/10.1016/j.ress.2020.107189">doi:10.1016/j.ress.2020.107189</a>.<br><br> Puy A, Becker W, Piano SL, Saltelli A (2020).
“The battle of total-order sensitivity estimators.”
<em>arXiv</em>.
2009.01147, <a href="https://arxiv.org/abs/2009.01147">https://arxiv.org/abs/2009.01147</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define settings (number of model inputs = 86)
N &lt;- 100; params &lt;- paste("X", 1:86, sep = "")

# Create sample matrix
mat &lt;- sobol_matrices(N = N, params = params)

# Compute metafunction
Y &lt;- metafunction(mat)
</code></pre>


</div>