<div class="container">

<table style="width: 100%;"><tr>
<td>mlf.zones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine zones for the maxima likelihood
first algorithm.</h2>

<h3>Description</h3>

<p><code>mlf.zones</code> determines the most likely cluster zone
obtained by implementing the maxima likelihood first
scann method of Yao et al. (2011).  Note that this is
really just a special case of the dynamic minimum
spanning tree (DMST) algorithm of Assuncao et al. (2006)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlf.zones(
  coords,
  cases,
  pop,
  w,
  ex = sum(cases)/sum(pop) * pop,
  ubpop = 0.5,
  ubd = 1,
  longlat = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>An <code class="reqn">n \times 2</code> matrix of centroid
coordinates for the regions in the form (x, y) or
(longitude, latitude) is using great circle distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A binary spatial adjacency matrix for the
regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubpop</code></td>
<td>
<p>The upperbound of the proportion of the
total population to consider for a cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubd</code></td>
<td>
<p>A proportion in (0, 1].  The distance of
potential clusters must be no more than <code>ubd * m</code>,
where <code>m</code> is the maximum intercentroid distance
between all coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>The default is <code>FALSE</code>, which
specifies that Euclidean distance should be used. If
<code>longlat</code> is <code>TRUE</code>, then the great circle
distance is used to calculate the intercentroid
distance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each step of the mlf scan test seeks to maximize the
likelihood ratio test statistic used in the original
spatial scan test (Kulldorff 1997).  The first zone
considered is the region that maximizes this likelihood
ration test statistic, providing that no more than
<code>ubpop</code> proportion of the total population is in the
zone.  The second zone is the first zone and the
connected region that maximizes the scan statistic,
subject to the population and distance constraints.  This
pattern continues until no additional zones can be added
due to population or distance constraints.
</p>
<p>Every zone considered must have a total population less
than <code>ubpop * sum(pop)</code> in the study area.
Additionally, the maximum intercentroid distance for the
regions within a zone must be no more than <code>ubd *
the maximum intercentroid distance across all regions</code>.
</p>


<h3>Value</h3>

<p>Returns a list with elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>zones</code></td>
<td>
<p>A list
contained the location ids of each potential cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikrat</code></td>
<td>
<p>The loglikelihood ratio for each zone
(i.e., the log of the test statistic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The observed number of cases in each
zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>The expected number of cases
each zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The total population in each
zone.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Yao, Z., Tang, J., &amp; Zhan, F. B. (2011).
Detection of arbitrarily-shaped clusters using a
neighbor-expanding approach: A case study on murine
typhus in South Texas. International Journal of Health
Geographics, 10(1), 1.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
data(nyw)
coords &lt;- as.matrix(nydf[, c("x", "y")])
mlf.zones(coords,
  cases = floor(nydf$cases),
  pop = nydf$pop, w = nyw, longlat = TRUE
)
</code></pre>


</div>