<div class="container">

<table style="width: 100%;"><tr>
<td>ivreg_ss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inference in an IV regression with a shift-share instrument</h2>

<h3>Description</h3>

<p>Computes confidence intervals and p-values in an instrumental variables
regression in which the instrument has a shift-share structure, as in Bartik
(1991). Several different inference methods can computed, as specified by
<code>method</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ivreg_ss(
  formula,
  X,
  data,
  W,
  subset,
  weights,
  method,
  beta0 = 0,
  alpha = 0.05,
  region_cvar = NULL,
  sector_cvar = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class <code>"formula"</code> (or one that can be
coerced to that class) of the form <code>outcome ~ controls |
endogenous_regressor</code>. For a regression with no controls (only an
intercept), it takes the form <code>outcome ~ 1 | endogenous_regressor</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Shift-share vector with length <code>N</code> of sectoral shocks,
aggregated to regional level using the share matrix <code>W</code>. That is,
each element of <code>X</code> corresponds to a region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible
by <code>as.data.frame</code> to a data frame) containing the outcome and
running variables in the model. If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>, typically the
environment from which the function is called. Each row in the data frame
corresponds to a region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>A matrix of sector shares, so that <code>W[i, s]</code> corresponds to
share of sector <code>s</code> in region <code>i</code>. The ordering of the regions
must coincide with that in the other inputs, such as <code>X</code>. The
ordering of the sectors in the columns of <code>W</code> is irrelevant but the
identity of the sectors in must coincide with those used to construct
<code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting
process. Should be <code>NULL</code> or a numeric vector, with each row
corresponding to a region. If non-<code>NULL</code>, for computing the first
stage and the reduced form, weighted least squares is used with weights
<code>weights</code> (that is, we minimize <code>sum(weights*residuals^2)</code>);
otherwise ordinary least squares is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Vector specifying which inference methods to use. The vector
elements have to be one or more of the following strings:
</p>

<dl>
<dt><code>"homosk"</code></dt>
<dd>
<p>Assume i.i.d. homoskedastic errors</p>
</dd>
<dt><code>"ehw"</code></dt>
<dd>
<p>Eicker-Huber-White standard errors</p>
</dd>
<dt><code>"region_cluster"</code></dt>
<dd>
<p>Standard errors clustered at regional level</p>
</dd>
<dt><code>"akm"</code></dt>
<dd>
<p>Adão-Kolesár-Morales</p>
</dd>
<dt><code>"akm0"</code></dt>
<dd>
<p>Adão-Kolesár-Morales with null imposed. Note the
reported standard error for this method corresponds to the normalized
standard error, given by the length of the confidence interval divided by
<code class="reqn">2z_{1-\alpha/2}</code></p>
</dd>
<dt><code>"all"</code></dt>
<dd>
<p>All of the methods above</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>null that is tested (only affects reported p-values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Determines confidence level of reported confidence intervals,
which will have coverage <code>1-alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region_cvar</code></td>
<td>
<p>A vector with length <code>N</code> of cluster variables, for
method <code>"cluster_region"</code>. If the vector <code>1:N</code> is used,
clustering is effectively equivalent to <code>ehw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sector_cvar</code></td>
<td>
<p>A vector with length <code>S</code> of cluster variables, if
sectors are to be clustered, for methods <code>"akm"</code> and <code>"akm0"</code>.
If the vector <code>1:S</code> is used, this is equivalent to not clustering.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class <code>"SSResults"</code> containing the
estimation and inference results. The <code>print</code> function can be used
to print a summary of the results. The object is a list with at least the
following components: </p>

<dl>
<dt>beta</dt>
<dd>
<p>Point estimate of the effect of interest <code class="reqn">\beta</code></p>
</dd>
<dt>se, p</dt>
<dd>
<p>A vector of standard errors and a vector of p-values of the null
<code class="reqn">H_{0}\colon \beta = \beta_{0}</code> for the inference
methods in <code>method</code>, with <code class="reqn">\beta_{0}</code> specified by the
argument <code>beta0</code>. For the method <code>"akm0"</code>, the standard error
corresponds to the effective standard error (length of the confidence
interval divided by <code>2*stats::qnorm(1-alpha/2)</code>)</p>
</dd>
<dt>ci.l, ci.r</dt>
<dd>
<p>Upper and lower endpoints of the confidence interval for
the effect of interest <code class="reqn">\beta</code>, for each of the methods in
<code>method</code></p>
</dd>
</dl>
<h3>Note</h3>

<p><code>subset</code> is evaluated in the same way as variables in
<code>formula</code>, that is first in <code>data</code> and then in the environment
of <code>formula</code>.
</p>


<h3>References</h3>


<p><cite>Bartik, Timothy J., Who Benefits from State and Local Economic
Development Policies?, Kalamazoo, MI: W.E. Upjohn Institute for Employment
Research, 1991.</cite>
</p>
<p><cite>Adão, Rodrigo, Kolesár, Michal, and Morales, Eduardo,
"Shift-Share Designs: Theory and Inference", Quarterly Journal of Economics
2019, 134 (4), 1949-2010. doi: <a href="https://doi.org/10.1093/qje/qjz025">10.1093/qje/qjz025</a>.</cite>
</p>



<h3>Examples</h3>

<pre><code class="language-R">## Use ADH data from Autor, Dorn, and Hanson (2013)
ivreg_ss(d_sh_empl ~ 1 | shock, X=IV, data=ADH$reg, W=ADH$W,
         method=c("ehw", "akm", "akm0"))
</code></pre>


</div>