<div class="container">

<table style="width: 100%;"><tr>
<td>harrison_mccabe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Harrison and McCabe's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the method of
Harrison and McCabe (1979) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">harrison_mccabe(
  mainlm,
  deflator = NA,
  m = 0.5,
  alternative = c("less", "greater", "two.sided"),
  twosidedmethod = c("doubled", "kulinskaya"),
  qfmethod = "imhof",
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Either a <code>double</code> giving the proportion of the <code class="reqn">n</code>
diagonal elements of <code class="reqn">A</code> that are ones, or an <code>integer</code>
giving the index <code class="reqn">m</code> up to which the diagonal elements are ones.
Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character specifying the form of alternative
hypothesis. If it is suspected that the error variance is positively
associated with the deflator variable, <code>"less"</code>. If it is
suspected that the error variance is negatively associated with deflator
variable, <code>"greater"</code>. If no information is available on the suspected
direction of the association, <code>"two.sided"</code>. Defaults to
<code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosidedmethod</code></td>
<td>
<p>A character indicating the method to be used to compute
two-sided <code class="reqn">p</code>-values for the parametric test when <code>alternative</code>
is <code>"two.sided"</code>. The argument is passed to
<code>twosidedpval</code> as its <code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qfmethod</code></td>
<td>
<p>A character, either <code>"imhof"</code>, <code>"davies"</code>, or
<code>"integrate"</code>, corresponding to the <code>algorithm</code> argument
of <code>pRQF</code>. The default is <code>"imhof"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test assumes that heteroskedasticity, if present, is
monotonically related to one of the explanatory variables (known as the
deflator). The OLS residuals <code class="reqn">e</code> are placed in increasing order of
the deflator variable and we let <code class="reqn">A</code> be an <code class="reqn">n\times n</code> selector
matrix whose first <code class="reqn">m</code> diagonal elements are 1 and all other elements
are 0. The alternative hypothesis posits that the error variance changes
around index <code class="reqn">m</code>. Under the null hypothesis of homoskedasticity, the
ratio of quadratic forms <code class="reqn">Q=\frac{e' A e}{e'e}</code> should be close to
<code class="reqn">\frac{m}{n}</code>. Since the test statistic <code class="reqn">Q</code> is a ratio of
quadratic forms in the errors, the Imhof algorithm is used to compute
<code class="reqn">p</code>-values (with normality of errors assumed).
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Harrison MJ, McCabe BPM (1979).
“A Test for Heteroscedasticity Based on Ordinary Least Squares Residuals.”
<em>Journal of the American Statistical Association</em>, <b>74</b>(366), 494–499.
</p>


<h3>See Also</h3>

<p><code>lmtest::hmctest</code>, another
implementation of the Harrison-McCabe Test. Note that the <code class="reqn">p</code>-values
from that function are simulated rather than computed from the
distribution of a ratio of quadratic forms in normal random vectors.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
harrison_mccabe(mtcars_lm, deflator = "qsec")

</code></pre>


</div>