<div class="container">

<table style="width: 100%;"><tr>
<td>teffEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>STFIT Temporal Effect Estimation</h2>

<h3>Description</h3>

<p>STFIT Temporal Effect Estimation
</p>


<h3>Usage</h3>

<pre><code class="language-R">teffEst(
  ids,
  doy,
  rmat,
  doyeval = seq(min(doy), max(doy)),
  h.cov = 100,
  h.sigma2 = 300,
  weight.cov = NULL,
  weight.sigma2 = NULL,
  pve = 0.99,
  t.grid = NULL,
  t.grid.num = 50,
  var.est = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>ids for 'group', for data with repeated measurement over years, year is ids; 
for pixels belong to certain clusters, cluster is ids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doy</code></td>
<td>
<p>vecotr of DOY (day of the year)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmat</code></td>
<td>
<p>residual matrix with rows corresponding to <code>doy</code> and columns corresponding to pixel index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doyeval</code></td>
<td>
<p>a vector of DOY on which to get the temporal imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.cov</code></td>
<td>
<p>bandwidth for temporal covariance estimation; ignored if <code>weight.cov</code> is supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.sigma2</code></td>
<td>
<p>bandwidth for temporal variance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.cov</code></td>
<td>
<p>weight vector for temporal covariance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.sigma2</code></td>
<td>
<p>weight vector for temporal variance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>percentage of variance explained; used for number of eigen values selection. Default is 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.grid</code></td>
<td>
<p>a vector of grid points on which to calculate the temporal covariance function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.grid.num</code></td>
<td>
<p>number of grid points to use for temporal covariance estimation. Ignored if <code>t.grid</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.est</code></td>
<td>
<p>Whether to estimate the variance of the temporal effect. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of length 2 with entries:
</p>

<ul>
<li>
<p> teff_array: 3-d array with first dimention 'ids', second dimention 'doy' and third
dimention pixel index.
</p>
</li>
<li>
<p> teff_var_array: same structure as <code>teff_array</code> if <code>var.est</code> is TRUE,
otherwise NULL.
</p>
</li>
</ul>
</div>