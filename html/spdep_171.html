<div class="container">

<table style="width: 100%;"><tr>
<td>LOSH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local spatial heteroscedasticity</h2>

<h3>Description</h3>

<p>Local spatial heteroscedasticity is calculated for each location based on the spatial weights object used. The statistic is:
</p>
<p style="text-align: center;"><code class="reqn">H_i = \frac{\sum_j^n w_{ij} \cdot |e_j|^a}{h_1 \cdot \sum_j^n w_{ij}}</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn">e_j = x_j - \bar{x}_j</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\bar{x}_j = \frac{\sum_k^n w_{jk} \cdot x_k}{\sum_k^n w_{jk}}</code>
</p>

<p>Its expectation and variance are given in Ord &amp; Getis (2012). The exponent <em>a</em> allows for investigating different types of mean dispersal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  LOSH(x, listw, a=2, var_hi=TRUE, zero.policy=attr(listw, "zero.policy"),
 na.action=na.fail, spChk=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the exponent applied to the local residuals; the default value of 2 leads to a measure of heterogeneity in the spatial variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_hi</code></td>
<td>
<p>default TRUE, the moments and the test statistics are calculated for each location; if FALSE, only the plain LOSH measures, <code class="reqn">\bar{x}_i</code> and <code class="reqn">e_i</code> are calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted. If <code>na.pass</code> is used, zero is substituted for NA values in calculating the spatial lag. (Note that na.exclude will only work properly starting from R 1.9.0, na.omit and na.exclude assign the wrong classes in 1.8.*)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In addition to the LOSH measure, the values returned include local spatially weighted mean values <code class="reqn">\bar{x}_i</code> and local residuals <code class="reqn">e_i</code> estimated about these means. These values facilitate the interpretation of LOSH values. Further, if specified through <code>var_hi</code>, the statistical moments and the test statistics as proposed by Ord &amp; Getis (2012) are also calculated and returned.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Hi</code></td>
<td>
<p>LOSH statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E.Hi</code></td>
<td>
<p>(optional) expectation of LOSH</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.Hi</code></td>
<td>
<p>(optional) variance of LOSH</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z.Hi</code></td>
<td>
<p>(optional) the approximately Chi-square distributed test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_bar_i</code></td>
<td>
<p>local spatially weighted mean values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ei</code></td>
<td>
<p>residuals about local spatially weighted mean values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>René Westerholt <a href="mailto:rene.westerholt@tu-dortmund.de">rene.westerholt@tu-dortmund.de</a></p>


<h3>References</h3>

<p>Ord, J. K., &amp; Getis, A. 2012. Local spatial heteroscedasticity (LOSH),
The Annals of Regional Science, 48 (2), 529–539.</p>


<h3>See Also</h3>

<p><code>LOSH.cs</code>, <code>LOSH.mc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">    data(boston, package="spData")
    resLOSH &lt;- LOSH(boston.c$NOX, nb2listw(boston.soi))
    hist(resLOSH[,"Hi"])
    mean(resLOSH[,"Hi"])
  </code></pre>


</div>