<div class="container">

<table style="width: 100%;"><tr>
<td>spm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A central function that estimates Stochastic Process Model parameters a from given dataset.</h2>

<h3>Description</h3>

<p>A central function that estimates Stochastic Process Model parameters a from given dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm(
  x,
  model = "discrete",
  formulas = list(at = "a", f1t = "f1", Qt = "Q", ft = "f", bt = "b", mu0t = "mu0"),
  start = NULL,
  tol = NULL,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  pinv.tol = 0.01,
  theta.range = seq(0.01, 0.2, by = 0.001),
  verbose = FALSE,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A dataset: is the output from prepare_data(...) function and consists of two separate data tables:
(1) a data table for continuous-time model and (2) a data table for discrete-time model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A model type. Choices are: "discrete", "continuous" or "time-dependent".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulas</code></td>
<td>
<p>A list of parameter formulas used in the "time-dependent" model.
Default: <code>formulas=list(at="a", f1t="f1", Qt="Q", ft="f", bt="b", mu0t="mu0")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A starting values of coefficients in the "time-dependent" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A tolerance threshold for matrix inversion (NULL by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopifbound</code></td>
<td>
<p>A flag (default=FALSE) if it is set then the optimization stops 
when any of the parametrs achives lower or upper boundary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Lower boundary, default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Upper boundary, default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pinv.tol</code></td>
<td>
<p>A tolerance threshold for matrix pseudo-inverse. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.range</code></td>
<td>
<p>A user-defined range of the parameter <code>theta</code> used in 
discrete-time optimization and estimating of starting point for continuous-time optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A verbosing output indicator (FALSE by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 and Q are used:
mu0 = mu0*exp(theta*t), Q = Q*exp(theta*t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For "discrete" (dmodel) and "continuous" (cmodel) model types: 
(1) a list of model parameter estimates for the discrete model type described in 
"Life tables with covariates: Dynamic Model for Nonlinear Analysis of Longitudinal Data", 
Akushevich et al, 2005.&lt;DOI:10.1080/08898480590932296&gt;,  and  
(2) a list of model parameter estimates for the continuous model type described in 
"Stochastic model for analysis of longitudinal data on aging and mortality", 
Yashin et al, 2007, Math Biosci.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>
<p>For the "time-dependent" model (model parameters depend on time): a set of model parameter estimates.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.
</p>
<p>Akushevich I., Kulminski A. and Manton K. (2005). Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. Mathematical Popu-lation Studies, 12(2), pp.: 51-80.
&lt;DOI: 10.1080/08898480590932296&gt;.
</p>
<p>Yashin, A. et al (2007), Health decline, aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
library(stpm)
data.continuous &lt;- simdata_cont(N=1000)
data.discrete &lt;- simdata_discr(N=1000)
data &lt;- list(data.continuous, data.discrete)
p.discr.model &lt;- spm(data)
p.discr.model
p.cont.model &lt;- spm(data, model="continuous")
p.cont.model
p.td.model &lt;- spm(data, 
model="time-dependent",f=list(at="aa*t+bb", f1t="f1", Qt="Q", ft="f", bt="b", mu0t="mu0"), 
start=list(a=-0.001, bb=0.05, f1=80, Q=2e-8, f=80, b=5, mu0=1e-3))
p.td.model

## End(Not run)
</code></pre>


</div>