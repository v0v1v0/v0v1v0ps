<div class="container">

<table style="width: 100%;"><tr>
<td>plot.smw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the dissimilarity profiles</h2>

<h3>Description</h3>

<p>Plot results from <code>smw</code> and <code>dp</code> objects. The command is a shortcut for extracting and plotting <code>SMW</code> resuts. Auxiliary arguments from <code>extract</code> (i.e.  <code>sig</code>, <code>z</code>, <code>BPs</code> and <code>seq.sig</code>) can be passed to <code>plot.smw</code>.  The auxilary method <code>bgDP</code> is available for the returned <code>dp</code> object when the argument <code>bg</code> is not NULL (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'smw'
plot(x, w = NULL, sig = "z", z = 1.85, BPs = "max",
  seq.sig = 3, w.effect = F, values = c("zscore", "diss"),
  pchs = c(16, 16, 17), cols = c("black", "red", "blue"), bg = NULL,
  bg_alpha = 0.1, wcols = "rainbow", legend = TRUE, ...)

## S3 method for class 'dp'
bgDP(dp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"smw"</code> resulted from the function <code>SMW</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The window size from which results will be plotted. Only effective if <code>length(smw)&gt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>Significance test for detecting dissimilarity values that differs significantly from those appearing in a random pattern. If <code>NULL</code> the significance test is ommited from the plot.The following tests are considered with default to <code>sig.test="z"</code>:
</p>

<ul>
<li> <p><code>'z'</code> consider normalized dissimilarity (z-scores) discontinuities that exceed a "z" critical value;
</p>
</li>
<li> <p><code>'sd'</code> consider dissimilarity discontinuities that exceed mean plus one standard deviation;
</p>
</li>
<li> <p><code>'SD2'</code> consider dissimilarity discontinuities that exceed mean plus two standard deviation;
</p>
</li>
<li> <p><code>'tail1'</code> Consider dissimilarity discontinuities that exceed 95 percent confidence limits.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The critical value for the significance of z-values. Defaults to <code>'z=1.85'</code> (Erd√∂s et.al, 2014).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BPs</code></td>
<td>
<p>Defines if the breakpoints should be chosen as those sample positions corresponding to the maximum dissimilarity in a sequence of significant values (<code>"max"</code>) or as those sample positions corresponding to the median position of the sequence (<code>"median"</code>). Defaults to <code>BPs="max"</code>. If <code>NULL</code> the breakpoints are not computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq.sig</code></td>
<td>
<p>The maximum length of consecutive, significant values of dissimilarity that will be considered in defining the community breakpoints. Defaults to <code>seq.sig=3</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.effect</code></td>
<td>
<p>Logical, if <code>TRUE</code> draws a  dissimilarity profile using different windows sizes and returns an invisible data.frame with the breakpoint frequencies. Only effective if <code>length(smw)&gt;1</code>. The function uses <code>extract</code> with defaults parameters to define the breakpoint positions for each of the evaluated window sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Character. <code>"zscore"</code> for plotting z-scores, <code>"diss"</code> for plotting dissimilarity values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchs</code></td>
<td>
<p>A numerical vector of the form <code>c(d,s,b)</code> which modifies the default symbols of the plot. The default <code>pch = c(16,16,17)</code> describes respectively the dissimilarity values, significant dissimilarity values and breakpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Vector of length 3 specifying the colors of the plot in the same way as the pch argument. Defaults to <code>colors=c("black","red","blue")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>Optional. Sets background colors according to the breakpoints. It can be expressed either by a vector of colors or by the name of a pallet function (e.g. <code>"rainbow"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg_alpha</code></td>
<td>
<p>Factor modifying the opacity alpha of the backgroud [0,1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcols</code></td>
<td>
<p>Sets the colors for the window sizes (lines) when <code>w.effect=TRUE</code>. It can be expressed by a vector of colors or by the name of a pallet function. Defaults to <code>wcol="rainbow"</code> which uses the colour palette <code>rainbow</code> from R stats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Logical. Should a default legend appear?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>An object of class <code>dp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>bg</code> is not <code>NULL</code>, the attribute <code>params$bg</code> is added to the returned <code>dp</code>. This attribute contains the  sample colors used by the argument <code>bg</code>. The auxilary method <code>bgDP</code> can be used for accessing this color vector.
</p>


<h3>Value</h3>

<p>The function returns invisibly an object of class <code>"dp"</code> (see Details).
</p>


<h3>Author(s)</h3>

<p>Danilo Candido Vieira
</p>


<h3>See Also</h3>

<p><code>SMW</code>, <code>extract</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sim1)
sim1o&lt;-OrdData(sim1$envi,sim1$comm)


ws20&lt;-SMW(yo=sim1o$yo,ws=20)
pool&lt;-SMW(yo=sim1o$yo,ws=c(20,30,40))
plot(ws20)
plot(pool, w.effect=TRUE)

</code></pre>


</div>