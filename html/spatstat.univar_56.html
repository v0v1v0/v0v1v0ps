<div class="container">

<table style="width: 100%;"><tr>
<td>unnormdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted kernel smoother
</h2>

<h3>Description</h3>

<p>An unnormalised version of kernel density estimation
where the weights are not required to sum to 1.
The weights may be positive, negative or zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unnormdensity(x, ..., weights = NULL, defaults)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numeric vector of data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Optional arguments passed to <code>density.default</code>.
Arguments must be <em>named</em>.
</p>
</td>
</tr>
</table>
<p>'
</p>
<table>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional numeric vector of weights for the data.
The default is equivalent to assuming a weight of 1 for each observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaults</code></td>
<td>

<p>Optional, named list of arguments passed to
<code>density.default</code>. These will be overridden by
arguments in <code>...</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an alternative to the standard <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> kernel density estimation function
<code>density.default</code>.
</p>
<p>The standard <code>density.default</code>
requires the <code>weights</code> to be nonnegative numbers that add up to 1,
and returns a probability density (a function that integrates to 1).
</p>
<p>This function <code>unnormdensity</code> does not impose any requirement
on the <code>weights</code> except that they be finite. Individual weights may be
positive, negative or zero. The result is a function that does not
necessarily integrate to 1 and may be negative. The result is
the convolution of the kernel <code class="reqn">k</code> with the weighted data,
</p>
<p style="text-align: center;"><code class="reqn">
    f(x) = \sum_i w_i k(x- x_i)
  </code>
</p>

<p>where <code class="reqn">x_i</code> are the data points and <code class="reqn">w_i</code> are the
weights.
</p>
<p>The argument <code>weights</code> should be a numeric vector of the same
length as <code>x</code>, or a single numeric value. The default is to
assume a weight of 1 for each observation in <code>x</code>.
</p>
<p>The algorithm first selects the kernel bandwidth by
applying <code>density.default</code> to the data
<code>x</code> with normalised, positive weight vector
<code>w = abs(weights)/sum(abs(weights))</code> and
extracting the selected bandwidth.
Then the result is computed by applying
applying <code>density.default</code> to <code>x</code> twice
using the normalised positive and negative parts of the weights.
</p>
<p>Note that the arguments <code>...</code> must be passed by name,
i.e. in the form (<code>name=value</code>). Arguments that do not match
an argument of <code>density.default</code> will be ignored
<em>silently</em>.
</p>


<h3>Value</h3>

<p>Object of class <code>"density"</code> as described in
<code>density.default</code>.
</p>


<h3>Warning</h3>

<p>If <code>weights</code> is not specified,
the default is to assign a weight <code class="reqn">w_i=1</code> to each
observation <code class="reqn">x_i</code>.
</p>
<p>This is not the same behaviour as in <code>density.default</code> which
effectively assumes a weight of <code class="reqn">1/n</code> for each observation <code class="reqn">x_i</code>
where <code>n=length(x)</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>See Also</h3>

<p><code>density.default</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  d &lt;- unnormdensity(1:3, weights=c(-1,0,1), bw=0.3)
  if(interactive()) plot(d)
</code></pre>


</div>