<div class="container">

<table style="width: 100%;"><tr>
<td>markcrosscorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Mark Cross-Correlation Function
</h2>

<h3>Description</h3>

<p>Given a spatial point pattern with several columns of marks,
this function computes the mark correlation function between
each pair of columns of marks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  markcrosscorr(X, r = NULL,
                correction = c("isotropic", "Ripley", "translate"),
                method = "density", ..., normalise = TRUE, Xname = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The observed point pattern.
An object of class <code>"ppp"</code> or something acceptable to
<code>as.ppp</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Optional. Numeric vector. The values of the argument <code class="reqn">r</code>
at which the mark correlation function 
<code class="reqn">k_f(r)</code> should be evaluated.
There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>A character vector containing any selection of the
options <code>"isotropic"</code>, <code>"Ripley"</code>, <code>"translate"</code>,
<code>"translation"</code>, <code>"none"</code> or <code>"best"</code>.
It specifies the edge correction(s) to be applied.
Alternatively <code>correction="all"</code> selects all options.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>A character vector indicating the user's choice of
density estimation technique to be used. Options are
<code>"density"</code>, 
<code>"loess"</code>,
<code>"sm"</code> and <code>"smrep"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to the density estimation routine
(<code>density</code>, <code>loess</code> or <code>sm.density</code>)
selected by <code>method</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalise</code></td>
<td>

<p>If <code>normalise=FALSE</code>,
compute only the numerator of the expression for the
mark correlation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xname</code></td>
<td>

<p>Optional character string name for the dataset <code>X</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First, all columns of marks are converted to numerical values.
A factor with <code class="reqn">m</code> possible levels is converted to
<code class="reqn">m</code> columns of dummy (indicator) values.
</p>
<p>Next, each pair of columns is considered, and the mark
cross-correlation is defined as
</p>
<p style="text-align: center;"><code class="reqn">
    k_{mm}(r) = \frac{E_{0u}[M_i(0) M_j(u)]}{E[M_i,M_j]}
  </code>
</p>

<p>where <code class="reqn">E_{0u}</code> denotes the conditional expectation
given that there are points of the process at the locations
<code class="reqn">0</code> and <code class="reqn">u</code> separated by a distance <code class="reqn">r</code>.
On the numerator,
<code class="reqn">M_i(0)</code> and <code class="reqn">M_j(u)</code>
are the marks attached to locations <code class="reqn">0</code> and <code class="reqn">u</code> respectively
in the <code class="reqn">i</code>th and <code class="reqn">j</code>th columns of marks respectively.
On the denominator, <code class="reqn">M_i</code> and <code class="reqn">M_j</code> are
independent random values drawn from the
<code class="reqn">i</code>th and <code class="reqn">j</code>th columns of marks, respectively,
and <code class="reqn">E</code> is the usual expectation.
</p>
<p>Note that <code class="reqn">k_{mm}(r)</code> is not a “correlation”
in the usual statistical sense. It can take any 
nonnegative real value. The value 1 suggests “lack of correlation”:
if the marks attached to the points of <code>X</code> are independent
and identically distributed, then
<code class="reqn">k_{mm}(r) \equiv 1</code>.
</p>
<p>The argument <code>X</code> must be a point pattern (object of class
<code>"ppp"</code>) or any data that are acceptable to <code>as.ppp</code>.
It must be a marked point pattern.
</p>
<p>The cross-correlations are estimated in the same manner as
for <code>markcorr</code>.
</p>


<h3>Value</h3>

<p>A function array (object of class <code>"fasp"</code>) containing
the mark cross-correlation functions for each possible pair
of columns of marks.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code>markcorr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # The dataset 'betacells' has two columns of marks:
  #       'type' (factor)
  #       'area' (numeric)
  if(interactive()) plot(betacells)
  plot(markcrosscorr(betacells))
</code></pre>


</div>