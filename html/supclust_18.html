<div class="container">

<table style="width: 100%;"><tr>
<td>predict.pelora</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict Method for Pelora</h2>

<h3>Description</h3>

<p>Yields fitted values, predicted class labels and
conditional probability estimates for training and test data, which
are based on the gene groups <code>pelora</code> found, and on its internal
penalized logistic regression classifier.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pelora'
predict(object, newdata = NULL, newclin = NULL,
               type = c("fitted", "probs", "class"), noc = object$noc, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of <code>class</code> <code>"pelora"</code>,
typically the result of <code>pelora()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Numeric matrix with the same number of explanatory
variables as the original <code>x</code>-matrix (<code class="reqn">p</code> variables in
columns, <code class="reqn">r</code> cases in rows). For example, these can be
additional microarray gene expression data which should be
predicted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newclin</code></td>
<td>
<p>Numeric matrix with the same number of additional
(clinical) explanatory variables as the original <code>u</code>-matrix
(<code class="reqn">m</code> variables in columns, <code class="reqn">r</code> cases in rows) that are used
in the (penalized logistic regression) prediction model, but neither
grouped nor averaged. Only needs to be given, if the model fit
included an <code>u</code>-matrix. For example, these can be 'traditional'
clinical variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string, describing whether fitted values
<code>"fitted"</code>, estimated conditional probabilites <code>"probs"</code>
or class labels <code>"class"</code> should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noc</code></td>
<td>
<p>Integer, saying with how many clusters the fitted values,
probability estimates or class labels should be determined. Also
numeric vectors are allowed as an argument. The output is then a
numeric matrix with fitted values, probability estimates or class
labels for a multiple number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to and from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>newdata = NULL</code>, then the in-sample fitted values,
probability estimates and class label predictions are returned.
</p>


<h3>Value</h3>

<p>Depending on whether <code>noc</code> is a single number or a numeric
vector. In the first case, a numeric vector of length <code class="reqn">r</code> is
returned, which contains fitted values for <code>noc</code> clusters, or
probability estimates/class label predictions with <code>noc</code>
clusters.
</p>
<p>In the latter case, a numeric matrix with <code>length(noc)</code> columns,
each containing fitted values for <code>noc</code> clusters, or
probability estimates/class label predictions with <code>noc</code>
clusters, is returned.
</p>


<h3>Author(s)</h3>

<p>Marcel Dettling, <a href="mailto:dettling@stat.math.ethz.ch">dettling@stat.math.ethz.ch</a></p>


<h3>See Also</h3>

<p><code>pelora</code>, also for references.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Working with a "real" microarray dataset
data(leukemia, package="supclust")

## Generating random test data: 3 observations and 250 variables (genes)
set.seed(724)
xN &lt;- matrix(rnorm(750), nrow = 3, ncol = 250)

## Fitting Pelora
fit &lt;- pelora(leukemia.x, leukemia.y, noc = 3)

## Fitted values and class probabilities for the training data
predict(fit, type = "cla")
predict(fit, type = "prob")

## Predicting fitted values and class labels for the random test data
predict(fit, newdata = xN)
predict(fit, newdata = xN, type = "cla", noc = c(1,2,3))
predict(fit, newdata = xN, type = "pro", noc = c(1,3))

## Fitting Pelora such that the first 70 variables (genes) are not grouped
fit &lt;- pelora(leukemia.x[, -(1:70)], leukemia.y, leukemia.x[,1:70])

## Fitted values and class probabilities for the training data
predict(fit, type = "cla")
predict(fit, type = "prob")

## Predicting fitted values and class labels for the random test data
predict(fit, newdata = xN[, -(1:70)], newclin = xN[, 1:70])
predict(fit, newdata = xN[, -(1:70)], newclin = xN[, 1:70], "cla", noc  = 1:10)
predict(fit, newdata = xN[, -(1:70)], newclin = xN[, 1:70], type = "pro")
</code></pre>


</div>