<div class="container">

<table style="width: 100%;"><tr>
<td>sits_mlp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train multi-layer perceptron models using torch</h2>

<h3>Description</h3>

<p>Use a multi-layer perceptron algorithm to classify data.
This function uses the R "torch" and "luz" packages.
Please refer to the documentation of those package for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sits_mlp(
  samples = NULL,
  samples_validation = NULL,
  layers = c(512, 512, 512),
  dropout_rates = c(0.2, 0.3, 0.4),
  optimizer = torch::optim_adamw,
  opt_hparams = list(lr = 0.001, eps = 1e-08, weight_decay = 1e-06),
  epochs = 100,
  batch_size = 64,
  validation_split = 0.2,
  patience = 20,
  min_delta = 0.01,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Time series with the training samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples_validation</code></td>
<td>
<p>Time series with the validation samples. if the
<code>samples_validation</code> parameter is provided,
the <code>validation_split</code> parameter is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>Vector with number of hidden nodes in each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout_rates</code></td>
<td>
<p>Vector with the dropout rates (0,1)
for each layer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>Optimizer function to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_hparams</code></td>
<td>
<p>Hyperparameters for optimizer:
lr : Learning rate of the optimizer
eps: Term added to the denominator
to improve numerical stability..
weight_decay:       L2 regularization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Number of iterations to train the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Number of samples per gradient update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation_split</code></td>
<td>
<p>Number between 0 and 1.
Fraction of the training data for validation.
The model will set apart this fraction
and will evaluate the loss and any model metrics
on this data at the end of each epoch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patience</code></td>
<td>
<p>Number of epochs without improvements until
training stops.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_delta</code></td>
<td>
<p>Minimum improvement in loss function
to reset the patience counter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity mode (TRUE/FALSE). Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A torch mlp model to be used for classification.
</p>


<h3>Note</h3>

<p>The default parameters for the MLP have been chosen based on the work by
Wang et al. 2017 that takes multilayer perceptrons as the baseline
for time series classifications:
(a) Three layers with 512 neurons each, specified by the parameter 'layers';
(b) dropout rates of 10
(c) the "optimizer_adam" as optimizer (default value);
(d) a number of training steps ('epochs') of 100;
(e) a 'batch_size' of 64, which indicates how many time series
are used for input at a given steps;
(f) a validation percentage of 20
will be randomly set side for validation.
(g) The "relu" activation function.
</p>


<h3>Author(s)</h3>

<p>Gilberto Camara, <a href="mailto:gilberto.camara@inpe.br">gilberto.camara@inpe.br</a>
</p>


<h3>References</h3>

<p>Zhiguang Wang, Weizhong Yan, and Tim Oates,
"Time series classification from scratch with deep neural networks:
A strong baseline",
2017 international joint conference on neural networks (IJCNN).
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (sits_run_examples()) {
    # create an MLP model
    torch_model &lt;- sits_train(samples_modis_ndvi,
           sits_mlp(epochs = 20, verbose = TRUE))
    # plot the model
    plot(torch_model)
    # create a data cube from local files
    data_dir &lt;- system.file("extdata/raster/mod13q1", package = "sits")
    cube &lt;- sits_cube(
        source = "BDC",
        collection = "MOD13Q1-6.1",
        data_dir = data_dir
    )
    # classify a data cube
    probs_cube &lt;- sits_classify(
        data = cube, ml_model = torch_model, output_dir = tempdir()
    )
    # plot the probability cube
    plot(probs_cube)
    # smooth the probability cube using Bayesian statistics
    bayes_cube &lt;- sits_smooth(probs_cube, output_dir = tempdir())
    # plot the smoothed cube
    plot(bayes_cube)
    # label the probability cube
    label_cube &lt;- sits_label_classification(
        bayes_cube,
        output_dir = tempdir()
    )
    # plot the labelled cube
    plot(label_cube)
}
</code></pre>


</div>