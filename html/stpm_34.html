<div class="container">

<table style="width: 100%;"><tr>
<td>spm_pobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Continuous-time multi-dimensional optimization for SPM with partially observed covariates (multidimensional GenSPM)</h2>

<h3>Description</h3>

<p>Continuous-time multi-dimensional optimization for SPM with partially observed covariates (multidimensional GenSPM)
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm_pobs(
  x = NULL,
  y = NULL,
  aH = -0.05,
  aL = -0.01,
  f1H = 60,
  f1L = 80,
  QH = 2e-08,
  QL = 2.5e-08,
  fH = 60,
  fL = 80,
  bH = 4,
  bL = 5,
  mu0H = 8e-06,
  mu0L = 1e-05,
  thetaH = 0.08,
  thetaL = 0.1,
  p = 0.25,
  stopifbound = FALSE,
  algorithm = "NLOPT_LN_NELDERMEAD",
  lb = NULL,
  ub = NULL,
  maxeval = 500,
  verbose = FALSE,
  pinv.tol = 0.01,
  mode = "observed",
  gomp = TRUE,
  ftol_rel = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data table with genetic component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A data table without genetic component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aH</code></td>
<td>
<p>A k by k matrix. Characterizes the rate of the adaptive response for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aL</code></td>
<td>
<p>A k by k matrix. Characterize the rate of the adaptive response for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1H</code></td>
<td>
<p>A deviation from the norm (or optimal) state for Z = 1.
This is a vector of length k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1L</code></td>
<td>
<p>A deviation from the norm (or optimal) for Z = 0. 
This is a vector of length k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QH</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QL</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fH</code></td>
<td>
<p>A vector with length of k. Represents the normal (or optimal) state for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fL</code></td>
<td>
<p>A vector with length of k. Represents the normal (or optimal) state for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bH</code></td>
<td>
<p>A diffusion coefficient, k by k matrix for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bL</code></td>
<td>
<p>A diffusion coefficient, k by k matrix for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0H</code></td>
<td>
<p>A baseline mortality for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0L</code></td>
<td>
<p>A baseline mortality for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaH</code></td>
<td>
<p>A displacement coefficient for Z = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaL</code></td>
<td>
<p>A displacement coefficient for Z = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a hyphotetical percentage of presence of partially observed covariate in a population (default p=0.25).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopifbound</code></td>
<td>
<p>If TRUE then estimation stops if at least one parameter achieves lower or upper boundaries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>An optimization algorithm used, can be one of those provided by <code>nloptr</code>. 
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Lower bound of parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Upper bound of parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeval</code></td>
<td>
<p>Maximum number of iterations of the algorithm for <code>nloptr</code> optimization. 
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>An indicator of verbosing output (FALSE by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Can be one of the following: "observed" (default), "unobserved" or "combined". 
mode = "observed" represents analysing only dataset with observed variable Z.
mode = "unobserved" represents analysing only dataset of unobserved variable Z.
mode = "combined" denoted joint analysis of both observed and unobserved datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol_rel</code></td>
<td>
<p>Relative tolerance threshold for likelihood function (defalult: 1e-6), 
see http://ab-initio.mit.edu/wiki/index.php/NLopt_Reference</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A set of estimated parameters aH, aL, f1H, f1H, QH, QL, fH, fL, bH, bL, mu0H, mu0L, thetaH, thetaL, p and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>


<h3>References</h3>

<p>Arbeev, K.G. et al (2009). Genetic model for longitudinal studies of aging, health, and longevity
</p>
<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(stpm)
#Reading the data:
data &lt;- sim_pobs(N=1000)
head(data)
#Parameters estimation:
pars &lt;- spm_pobs(x=data)
pars

## End(Not run)
</code></pre>


</div>