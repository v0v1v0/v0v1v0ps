<div class="container">

<table style="width: 100%;"><tr>
<td>glisser_deposer.moodle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Créer une question demandant de placer des éléments à des positions
précises d'une image
</h2>

<h3>Description</h3>

<p> Cette fonction permet de créer une question dans laquelle
le but est de placer des éléments sur une image.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glisser_deposer.moodle( texte, titre = "Glisser-d\u00e9poser...",
                        f.creer_figure,
                        fichier.image,
                        x.zones, y.zones, txt.zones,
                        indications = paste0( "Zone ", 1:n.zones ),
                        img.zones = NULL, zone.unique = TRUE,
                        grp.zones = rep( 1, n.zones ),
                        ordre.aleatoire = TRUE,
                        commentaire.global = NA,
                        penalite = NA, note.question = NA, idnum = NA,
                        temps,
                        fichier.xml = get( "fichier.xml",
                                           envir = SARP.Moodle.env ),
                        ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>texte</code></td>
<td>
<p> L'énoncé de la question (une chaîne de caractères). Cet
énoncé peut contenir n'importe quel caractère (codage en UTF-8) et
n'importe quelles balises HTML.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titre</code></td>
<td>
<p> L'intitulé de la question, en HTML. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.creer_figure</code></td>
<td>
<p> La fonction qui va construire l'image et les
zones sur lesquelles déposer les éléments (voyez les détails,
ci-dessous). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fichier.image</code></td>
<td>
<p> Le nom du fichier contenant l'image à
légender. Ignoré si <code>f.creer_figure</code> est fournie.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.zones,y.zones</code></td>
<td>
<p> Les coordonnées des coins supérieurs, gauches
des zones à définir sur l'image. Ignoré si <code>f.creer_figure</code> est
fournie. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.zones</code></td>
<td>
<p> Les textes à utiliser pour les marques à placer sur
les zones (dans le même ordre que les coordonnées). Ignoré si
<code>f.creer_figure</code> est fournie. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indications</code></td>
<td>
<p> Les textes à afficher sur les zones de l'image
pour les identifier. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>img.zones</code></td>
<td>
<p> Les noms des fichiers contenant les images à
utiliser pour chaque marque.  Ignoré si <code>f.creer_figure</code> est
fournie. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zone.unique</code></td>
<td>
<p> Un vecteur aussi long que le nombre de zones,
indiquant si l'étiquette associée peut être réutilisée après avoir
été placée dans une zone (<code>FALSE</code>) ou non (<code>TRUE</code>). Ignoré
si <code>f.creer_figure</code> est fournie.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp.zones</code></td>
<td>
<p> Un vecteur d'entiers aussi long que le nombre de
zones, indiquant à quel groupe d'étiquette appartient chacune des
étiquettes. L'apparence de l'étiquette (forme, couleur) dépend de ce
groupe.  Ignoré si <code>f.creer_figure</code> est fournie.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordre.aleatoire</code></td>
<td>
<p>Si <code>TRUE</code>, l'ordre des marques est permuté
aléatoirement dans le fichier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commentaire.global, penalite, note.question, idnum</code></td>
<td>
<p>Options
communes à toutes les questions Moodle, voyez
<code>debut_question.moodle</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temps</code></td>
<td>
<p> Le temps conseillé pour répondre à la question, en
minutes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fichier.xml</code></td>
<td>
<p> Le fichier correspondant au questionnaire qui
contiendra cette question (par défaut, le dernier créé).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Arguments additionnels qui seront passés à
<code>f.creer_figure</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Ce type de question affiche une image et, en-dessous, des
étiquettes textuelles ou formées d'une image à placer sur l'image. Les
étiquettes ont toutes la même apparence (taille, forme, couleur). Les
zones où les placer sont indiquées sur l'image en surimpression et
font la même taille que les étiquettes.  Il est possible de créer des
groupes d'étiquettes (mais ce n'est intéressant que s'il y a au moins
deux étiquettes par groupe, sans quoi la taille de la zone affichée
sur l'image donne la réponse...); la forme et la couleur des
étiquettes varie d'un groupe à l'autre. Attention, les étiquettes d'un
groupe donné ne peuvent pas être placées sur les zones des étiquettes
des autres groupes.  Par défaut, toutes les étiquettes appartiennent
au premier groupe (étiquettes rectangulaires, blanches). La taille des
étiquettes est identique dans un même groupe, définie pour pouvoir
contenir le texte ou l'image le plus grand du groupe.
</p>
<p><b>Utilisation de la fonction <code>f.creer_figure</code></b>
</p>
<p>Avec cette méthode, la fonction se charge de créer le fichier d'image
(au format PNG, dans le dossier temporaire de R) avant d'appeler
<code>f.creer_figure</code>. La fonction <code>f.creer_figure</code> peut alors
utiliser tous les outils graphiques basiques de R pour créer une
figure et les zones à légender sur cette figure. Elle <em>ne</em> doit
<em>pas</em> clore la figure (pas d'appel à <code>dev.off()</code> ou à
<code>graphics.off</code>).
</p>
<p>La fonction <code>f.creer_figure</code> doit renvoyer une <code>data.frame</code>
dont chaque ligne correspond à une zone, et contenant au moins trois
colonnes:
</p>

<ul>
<li> <p>‘<code>X</code>’ et ‘<code>Y</code>’, indiquant les
coordonnées du coin supérieur, gauche de la zone, exprimées dans le
système d'unité natif du graphe créé avec R (elles seront ensuite
converties en pixels grâce aux fonctions <code>grconvertX</code> et
<code>grconvertY</code>).;
</p>
</li>
<li> <p>‘<code>Texte</code>’, indiquant le texte de l'étiquette
associée à la zone.
</p>
</li>
</ul>
<p>La taille de la zone sera déterminée par Moodle en fonction de la
taille de l'étiquette associée à la zone.
</p>
<p>De façon optionnelle, il peut y avoir une colonne ‘Indications’
qui contient une indication textuelle sur la zone, une colonne
‘Images’ qui contient le nom du fichier contenant l'image à
associer à la zone, une colonne ‘Groupes’ qui précise à quelle
groupe d'étiquette appartient l'étiquette associée à la zone et une
colonne ‘Unique’ qui indique si l'étiquette disparaît des
propositions après avoir été placée (<code>TRUE</code>) ou si elle reste,
pouvant alors être placée sur plusieurs zones (<code>FALSE</code>).  Si ces
colonnes sont absentes, l'indication est “Zone n°” et le numéro
de la zone (de sa ligne dans la <code>data.frame</code>), toutes les
étiquettes ne contiennent que du texte, sont placées dans le même
groupe et ne sont utilisables qu'une seule fois.
</p>
<p>Il est possible de créer des étiquettes ne correspondant à aucune zone
(“distracteurs”) en indiquant <code>NA</code> pour leurs coordonnées.
</p>
<p><b>Utilisation directe</b>
</p>
<p>Il est aussi possible de préciser une image quelconque, grâce à
l'option <code>fichier.image</code>. Dans ce cas, les options
<code>x.zones</code>, <code>y.zones</code>, <code>txt.zones</code>, <code>indications</code>,
<code>img.zones</code>, <code>grp.zones</code> et <code>zone.unique</code> permettent de
préciser les caractéristiques de chaque zone à définir. Les
coordonnées doivent être indiquées en pixels.  </p>


<h3>Value</h3>

<p>Aucune valeur n'est renvoyée par cette fonction.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis <a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>
</p>


<h3>See Also</h3>

<p><code>legender_image.moodle</code> pour une autre façon de
demander à placer des éléments sur une image;
<code>glisser_textes.moodle</code> pour faire glisser des textes dans
un texte à trou.  </p>


</div>