<div class="container">

<table style="width: 100%;"><tr>
<td>plot.fitMod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot function for class fitMod</h2>

<h3>Description</h3>

<p>Plotting function for objects of class <code>fitMod</code>. Seven different types
of plots can be made for an object of class <code>fitMod</code>. A detailed
description and optional extra parameters for the different plots is given
in the sections below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fitMod'
plot(
  x,
  ...,
  plotType = c("rawPred", "corrPred", "herit", "effDim", "variance", "timeLapse",
    "spatial"),
  timePoints = names(x),
  title = NULL,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class fitMod.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra plot options. Described per plotType in their respective
section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time points
to be plotted. When using a character string to reference a time point, the
value has to be an exact match to one of the existing timePoints. When using
a number it will be matched by its number ("timeNumber") in the timePoints
attribute of the TP object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFile</code></td>
<td>
<p>A character string indicating the .pdf file or .gif file
(for <code>plotType</code> = "timeLapse") to which the plots should be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code>pdf</code> for all possible options.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Depending on the plot type either a ggplot object or a list of
ggplot objects is invisibly returned.
</p>


<h3>rawPred plot</h3>

<p>Plots the raw data (colored dots) overlayed with the predicted values from
the fitted model (black dots). For each genotype a plot is made per
plot/plant over time. These plots are put together in a 5x5 grid. By using
the parameter <code>genotypes</code> a selection of genotypes can be plotted.
Extra parameter options:
</p>

<dl>
<dt>genotypes</dt>
<dd>
<p>A character vector indicating the genotypes to be plotted.</p>
</dd>
<dt>plotChecks</dt>
<dd>
<p>Should the check genotypes be included in the plot?</p>
</dd>
<dt>plotLine</dt>
<dd>
<p>Should the data be displayed as lines? Default is
<code>FALSE</code>.</p>
</dd>
</dl>
<h3>corrPred plot</h3>

<p>Plots the spatially corrected data (colored dots) overlayed with the
predicted values from the fitted model (black dors). For each genotype a plot
is made per plot/plant over time. These plots are put together in a 5x5 grid.
By using the parameter <code>genotypes</code> a selection of genotypes can be
plotted. Extra parameter options:
</p>

<dl>
<dt>genotypes</dt>
<dd>
<p>A character vector indicating the genotypes to be plotted.</p>
</dd>
<dt>plotChecks</dt>
<dd>
<p>Should the check genotypes be included in the plot?</p>
</dd>
<dt>plotLine</dt>
<dd>
<p>Should the data be displayed as lines? Default is
<code>FALSE</code>.</p>
</dd>
</dl>
<h3>herit plot</h3>

<p>Plots the heritability over time. This plot is only available when genotype
is fitted as random factor in the model. If <code>geno.decomp</code> is used when
fitting the model, heritabilities are plotted for each level of geno.decomp
in a single plot. Extra parameter options:
</p>

<dl>
<dt>yLim</dt>
<dd>
<p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>
<h3>effDim plot</h3>

<p>Plots the effective dimension over time for models fitted using SpATS.
Extra parameter options:
</p>

<dl>
<dt>whichED</dt>
<dd>
<p>A character vector indicating which effective dimensions
should be plotted. This should be a subset of "colId", "rowId", "fCol",
"fRow", "fColRow", "colfRow", "fColfRow" and "surface". When
<code>useRepId = TRUE</code>, the effective dimensions of "colId" and "rowId"
become "RepId:colId" and "RepId:rowId". Default all effective dimensions
are plotted.</p>
</dd>
<dt>EDType</dt>
<dd>
<p>A character string specifying if the effective dimension
("dimension") or the ratio of effective dimensions ("ratio") should be
plotted. Default the dimensions are plotted.</p>
</dd>
<dt>yLim</dt>
<dd>
<p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>
<h3>variance plot</h3>

<p>Plots the residual, column and row variances over time for the fitted models.
Extra parameter options:
</p>

<dl>
<dt>yLim</dt>
<dd>
<p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>
<h3>timeLapse plot</h3>

<p>Creates a time lapse of the spatial trends of models fitted using SpATS over
time.
</p>


<h3>spatial plot</h3>

<p>Creates five plots per time point, spatial plots of the raw data,
fitted values, residuals and either BLUEs or BLUPs, and a histogram of the
BLUEs or BLUPs. When SpATS was used for modeling an extra plot with the
fitted spatial trend is included Extra parameter options:
</p>

<dl>
<dt>spaTrend</dt>
<dd>
<p>A character string indicating how the spatial trend should
be displayed. Either "raw" for raw values, or "percentage" for displaying
as a percentage of the original phenotypic values.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code>fitModels()</code>,
<code>getCorrected()</code>,
<code>getEffDims()</code>,
<code>getGenoPred()</code>,
<code>getHerit()</code>,
<code>getVar()</code>,
<code>summary.fitMod()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Using the first example dataset (PhenovatorDat1):
## Create an object of class TP.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on three points:
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 36))

## Plot the spatial trends for one time point:
plot(modPhenoSp,
     timePoints = 36,
     plotType = "spatial",
     spaTrend = "percentage")


## Not run: 
## Create a time lapse of all available time points:
plot(modPhenoSp,
     plotType = "timeLapse",
     outFile = "TimeLapse_modPhenoSp.gif")

## End(Not run)


## Plot the corrected values for a subset of four genotypes:
plot(modPhenoSp,
     plotType = "corrPred",
     genotypes = c("check1", "check2", "G007", "G058") )

## Plot the effective dimensions of all available time points in the model
## for a subset of effective dimensions:
plot(modPhenoSp,
     plotType = "effDim",
     whichED = c("colId", "rowId", "fColRow","colfRow"),
     EDType = "ratio")


</code></pre>


</div>