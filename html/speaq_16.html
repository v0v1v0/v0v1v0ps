<div class="container">

<table style="width: 100%;"><tr>
<td>getWaveletPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert raw NMR spectra to peak data by using wavelets</h2>

<h3>Description</h3>

<p>This function converts phase corrected NMR spectra to peak data by using wavelet based peak detection (with the MassSpecWavelet package)
</p>


<h3>Usage</h3>

<pre><code class="language-R">getWaveletPeaks(
  Y.spec,
  X.ppm,
  sample.labels = NULL,
  window.width = "small",
  window.split = 4,
  scales = seq(1, 16, 1),
  baselineThresh = 1000,
  SNR.Th = -1,
  nCPU = -1,
  include_nearbyPeaks = TRUE,
  raw_peakheight = FALSE,
  duplicate_detection_multiplier = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y.spec</code></td>
<td>
<p>The spectra in matrix format (rows = samples, columns = measurement points ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.ppm</code></td>
<td>
<p>The x/ppm values of the spectra (in single vector or matrix format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.labels</code></td>
<td>
<p>The sample labels (optional), if not supplied these will simply be the sample numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.width</code></td>
<td>
<p>The width of the detection window for the wavelets. Because of the Fourier transform lengths of 512 ( window.width = 'small') of 1024 ( window.width = 'large') are preferable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.split</code></td>
<td>
<p>A positive, even and whole number indicating in how many parts the sliding window is split up. With every iteration the window slides one part further.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>The scales to be used in the wavelet based peak detection, see peakDetectionCWT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineThresh</code></td>
<td>
<p>Peaks with a peakValue lower than this threshold will be removed (default = 1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR.Th</code></td>
<td>
<p>The Signal-to-noise threshold, see peakDetectionCWT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCPU</code></td>
<td>
<p>The amount of cpu's to be used for peak detection. If set to '-1' all available cores minus 1 will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_nearbyPeaks</code></td>
<td>
<p>If set to TRUE small peaks in the tails of larger ones will be included in the peak data, see peakDetectionCWT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw_peakheight</code></td>
<td>
<p>(default = FALSE) Whether to use the raw peak height of a peak instead of the optimal CWT coefficient (which is a measure for AUC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duplicate_detection_multiplier</code></td>
<td>
<p>(default 1) In case users want to process other spectra besides NMR, this parameter will increase the limit for two peaks to be considered a duplicate detection. When dealing with more distorted spectra this parameter can be increased (recommended to not increase above 10).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The peaks detected with the wavelets.
</p>


<h3>Author(s)</h3>

<p>Charlie Beirnaert, <a href="mailto:charlie.beirnaert@uantwerpen.be">charlie.beirnaert@uantwerpen.be</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">subset &lt;- GetWinedata.subset()
# to reduce the example time we only select spectra 1 &amp; 2
subset.spectra = as.matrix(subset$Spectra)[1:2,] 
subset.ppm = as.numeric(subset$PPM)

test.peaks &lt;- getWaveletPeaks(Y.spec=subset.spectra, 
                              X.ppm=subset.ppm ,
                              nCPU = 1) # nCPU set to 2 for the vignette build

</code></pre>


</div>