<div class="container">

<table style="width: 100%;"><tr>
<td>balancedstratification</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Balanced stratification</h2>

<h3>Description</h3>

<p>Selects a stratified balanced sample (a vector of 0 and 1).
Firstly, the flight phase is applied in each stratum. Secondly, the strata
are aggregated and the flight phase is applied on the whole population.
Finally, the landing phase is applied on the whole population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">balancedstratification(X,strata,pik,comment=TRUE,method=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of auxiliary variables on which the sample must be balanced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>vector of integers that specifies the stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik</code></td>
<td>
<p>vector of inclusion probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comment</code></td>
<td>
<p>a comment is written during the execution if <code>comment</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the used method in the function <code>samplecube</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

 
<p>Tillé, Y. (2006), <em>Sampling Algorithms</em>, Springer.<br>
Chauvet, G. and Tillé, Y. (2006). A fast algorithm of balanced sampling. <em>Computational Statistics</em>, 21/1:53–62. <br>
Chauvet, G. and Tillé, Y. (2005). New SAS macros for balanced sampling. In INSEE, editor, <em>Journées de Méthodologie Statistique</em>, Paris.<br>
Deville, J.-C. and Tillé, Y. (2004). Efficient balanced sampling: the cube method. <em>Biometrika</em>, 91:893–912.<br>
Deville, J.-C. and Tillé, Y. (2005). Variance approximation under balanced sampling. <em>Journal of Statistical Planning and Inference</em>, 128/2:411–425. 
</p>


<h3>See Also</h3>

<p><code>samplecube</code>, <code>fastflightcube</code>, <code>landingcube</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# variable of stratification (3 strata)
strata=c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
# matrix of balancing variables
X=cbind(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))
# Vector of inclusion probabilities.
# the sample has its size equal to 9.
pik=rep(3/5,times=15)
# selection of a stratified sample
s=balancedstratification(X,strata,pik,comment=TRUE)
# the sample is
(1:length(pik))[s==1]
############
## Example 2
############
data(MU284)
X=cbind(MU284$P75,MU284$CS82,MU284$SS82,MU284$S82,MU284$ME84)
strata=MU284$REG
pik=inclusionprobabilities(MU284$P75,80)
s=balancedstratification(X,strata,pik,TRUE)
#the selected units are
MU284$LABEL[s==1]
</code></pre>


</div>