<div class="container">

<table style="width: 100%;"><tr>
<td>C_fSolD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Daily apparent movement of the Sun from the Earth
</h2>

<h3>Description</h3>

<p>Compute the daily apparent movement of the Sun from the Earth. This movement is mainly described (for the simulation of photovoltaic systems) by the declination angle, the sunrise angle and the daily extra-atmospheric irradiation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fSolD(lat, BTd, method = 'michalsky')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Latitude (degrees) of the point of the Earth where calculations are needed. It is positive for locations above the Equator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BTd</code></td>
<td>
<p>Daily temporal base, a <code>POSIXct</code> object which  may be
the result of <code>fBTd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>character</code>, method for the sun geometry
calculations to be chosen from 'cooper', 'spencer', 'michalsky' and
'strous'. See references for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>zoo</code> object with these components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>decl</code></td>
<td>
<p>Declination angle (radians) for each day of year in <code>dn</code> or <code>BTd</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eo</code></td>
<td>
<p>Factor of correction due the eccentricity of orbit of the Earth around the Sun.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ws</code></td>
<td>
<p>Sunrise angle (in radians) for each day of year. Due to the convention which considers that the solar hour angle is negative before midday, this angle is negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bo0d</code></td>
<td>
<p>Extra-atmospheric daily irradiation (watt-hour per
squared meter) incident on a horizontal surface</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EoT</code></td>
<td>
<p>Equation of Time.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The latitude is stored as the attribute <code>lat</code> of the result,
and thus it is accessible with <code>attr(object, 'lat')</code>.
</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro.
</p>


<h3>References</h3>

 <ul>
<li>
<p>Cooper, P.I., Solar Energy, 12, 3
(1969). "The Absorption of Solar Radiation in Solar Stills"
</p>
</li>
<li>
<p>Spencer, Search 2 (5), 172,
<a href="https://www.mail-archive.com/sundial@uni-koeln.de/msg01050.html">https://www.mail-archive.com/sundial@uni-koeln.de/msg01050.html</a>
</p>
</li>
<li>
<p>Strous:
<a href="https://www.aa.quae.nl/en/reken/zonpositie.html">https://www.aa.quae.nl/en/reken/zonpositie.html</a>
</p>
</li>
<li>
<p>Michalsky, J., 1988: The Astronomical Almanac's algorithm for
approximate solar position (1950-2050), Solar Energy 40, 227-235
</p>
</li>
<li>
<p> Perpiñán, O, Energía Solar Fotovoltaica, 2015.
(<a href="https://oscarperpinan.github.io/esf/">https://oscarperpinan.github.io/esf/</a>)
</p>
</li>
<li>
<p> Perpiñán, O. (2012), "solaR: Solar Radiation and Photovoltaic
Systems with R", Journal of Statistical Software, 50(9), 1-32,
doi: <a href="https://doi.org/10.18637/jss.v050.i09">10.18637/jss.v050.i09</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">BTd &lt;- fBTd(mode = 'serie')

lat &lt;- 37.2
fSolD(lat, BTd[100])
fSolD(lat, BTd[100], method = 'strous')
fSolD(lat, BTd[100], method = 'spencer')
fSolD(lat, BTd[100], method = 'cooper')

lat &lt;- -37.2
fSolD(lat, BTd[283])

#Solar angles along the year
SolD &lt;- fSolD(lat, BTd = fBTd())

library(lattice)
xyplot(SolD)

#Calculation of the daylength for several latitudes
library(latticeExtra)

Lats &lt;- c(-60, -40, -20, 0, 20, 40, 60)
NomLats &lt;- ifelse(Lats &gt; 0, paste(Lats,'N', sep = ''),
                  paste(abs(Lats), 'S', sep = ''))
NomLats[Lats == 0] &lt;- '0'

mat &lt;- matrix(nrow = 365, ncol = length(Lats))
colnames(mat) &lt;- NomLats
WsZ &lt;- zoo(mat, fBTd(mode = 'serie'))

for (i in seq_along(Lats)){
    SolDaux &lt;- fSolD(lat = Lats[i], BTd = fBTd(mode = 'serie'));
    WsZ[,i] &lt;- r2h(2*abs(SolDaux$ws))}

p = xyplot(WsZ, superpose = TRUE,
        ylab = expression(omega[s] (h)), auto.key = FALSE)
plab &lt;- p+glayer(panel.text(x[1], y[1], NomLats[group.number], pos = 2))
print(plab)
</code></pre>


</div>