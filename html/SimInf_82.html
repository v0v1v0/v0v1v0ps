<div class="container">

<table style="width: 100%;"><tr>
<td>SimInf_events</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a <code>SimInf_events</code> object</h2>

<h3>Description</h3>

<p>The argument events must be a <code>data.frame</code> with the following
columns:
</p>

<dl>
<dt>event</dt>
<dd>
<p>Four event types are supported by the current solvers:
<em>exit</em>, <em>enter</em>, <em>internal transfer</em>, and
<em>external transfer</em>.  When assigning the events, they can
either be coded as a numerical value or a character string:
<em>exit;</em> <code>0</code> or <code>'exit'</code>, <em>enter;</em> <code>1</code>
or <code>'enter'</code>, <em>internal transfer;</em> <code>2</code> or
<code>'intTrans'</code>, and <em>external transfer;</em> <code>3</code> or
<code>'extTrans'</code>.  Internally in <span class="pkg">SimInf</span>, the event type
is coded as a numerical value.
</p>
</dd>
<dt>time</dt>
<dd>
<p>When the event occurs i.e., the event is processed when time
is reached in the simulation. Can be either an <code>integer</code>
or a <code>Date</code> vector.  A <code>Date</code> vector is coerced to a
numeric vector as days, where <code>t0</code> determines the offset
to match the time of the events to the model <code>tspan</code>
vector.
</p>
</dd>
<dt>node</dt>
<dd>
<p>The node that the event operates on. Also the source node for
an <em>external transfer</em> event.
1 &lt;= <code>node[i]</code> &lt;= Number of nodes.
</p>
</dd>
<dt>dest</dt>
<dd>
<p>The destination node for an <em>external transfer</em> event
i.e., individuals are moved from <code>node</code> to <code>dest</code>,
where 1 &lt;= <code>dest[i]</code> &lt;= Number of nodes.  Set <code>event
    = 0</code> for the other event types.  <code>dest</code> is an integer
vector.
</p>
</dd>
<dt>n</dt>
<dd>
<p>The number of individuals affected by the event. n[i] &gt;= 0.
</p>
</dd>
<dt>proportion</dt>
<dd>
<p>If <code>n[i]</code> equals zero, the number of individuals affected
by <code>event[i]</code> is calculated by sampling the number of
individuals from a binomial distribution using the
<code>proportion[i]</code> and the number of individuals in the
compartments. Numeric vector.  0 &lt;= proportion[i] &lt;= 1.
</p>
</dd>
<dt>select</dt>
<dd>
<p>To process an <code>event[i]</code>, the compartments affected by
the event are specified with <code>select[i]</code> together with
the matrix <code>E</code>, where <code>select[i]</code> determines which
column in <code>E</code> to use.  The specific individuals affected
by the event are sampled from the compartments corresponding
to the non-zero entries in the specified column in <code>E[,
    select[i]]</code>, where <code>select</code> is an integer vector.
</p>
</dd>
<dt>shift</dt>
<dd>
<p>Determines how individuals in <em>internal transfer</em> and
<em>external transfer</em> events are shifted to enter another
compartment.  The sampled individuals are shifted according to
column <code>shift[i]</code> in matrix <code>N</code> i.e., <code>N[,
    shift[i]]</code>, where <code>shift</code> is an integer vector.  See
above for a description of <code>N</code>. Unsued for the other
event types.
</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">SimInf_events(E = NULL, N = NULL, events = NULL, t0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Each row corresponds to one compartment in the model. The
non-zero entries in a column indicates the compartments to
include in an event.  For the <em>exit</em>, <em>internal
transfer</em> and <em>external transfer</em> events, a non-zero
entry indicate the compartments to sample individuals from.
For the <em>enter</em> event, all individuals enter first
non-zero compartment. <code>E</code> is sparse matrix of class
<code>dgCMatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Determines how individuals in <em>internal transfer</em>
and <em>external transfer</em> events are shifted to enter
another compartment.  Each row corresponds to one compartment
in the model.  The values in a column are added to the current
compartment of sampled individuals to specify the destination
compartment, for example, a value of <code>1</code> in an entry
means that sampled individuals in this compartment are moved
to the next compartment.  Which column to use for each event
is specified by the <code>shift</code> vector (see below).  <code>N</code>
is an integer matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>A <code>data.frame</code> with events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>If <code>events$time</code> is a <code>Date</code> vector, then
<code>t0</code> determines the offset to match the time of the
events to the model <code>tspan</code> vector, see details. If
<code>events$time</code> is a numeric vector, then <code>t0</code> must be
<code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>S4 class <code>SimInf_events</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Let us illustrate how movement events can be used to transfer
## individuals from one node to another.  Use the built-in SIR
## model and start with 2 nodes where all individuals are in the
## first node (100 per compartment).
u0 &lt;- data.frame(S = c(100, 0), I = c(100, 0), R = c(100, 0))

## Then create 300 movement events to transfer all individuals,
## one per day, from the first node to the second node. Use the
## fourth column in the select matrix where all compartments
## can be sampled with equal weight.
events &lt;- data.frame(event      = rep("extTrans", 300),
                     time       = 1:300,
                     node       = 1,
                     dest       = 2,
                     n          = 1,
                     proportion = 0,
                     select     = 4,
                     shift      = 0)

## Create an SIR model without disease transmission to
## demonstrate the events.
model &lt;- SIR(u0      = u0,
             tspan  = 1:300,
             events = events,
             beta   = 0,
             gamma  = 0)

## Run the model and plot the number of individuals in
## the second node.  As can be seen in the figure, all
## indivuduals have been moved to the second node when
## t = 300.
plot(run(model), index = 1:2, range = FALSE)

## Let us now double the weight to sample from the 'I'
## compartment and rerun the model.
model@events@E[2, 4] &lt;- 2
plot(run(model), index = 1:2, range = FALSE)

## And much larger weight to sample from the I compartment.
model@events@E[2, 4] &lt;- 10
plot(run(model), index = 1:2, range = FALSE)

## Increase the weight for the R compartment.
model@events@E[3, 4] &lt;- 4
plot(run(model), index = 1:2, range = FALSE)
</code></pre>


</div>