<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrap_pvals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate one or multiple bootstrap p-values</h2>

<h3>Description</h3>

<p>Calculate one or multiple bootstrap p-values, given a bootstrap
sample of test statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrap_pvals(
  boot_stat,
  stat,
  alternative = "two-sided",
  B_vals = length(boot_stat),
  reps = 1L,
  enlist = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>boot_stat</code></td>
<td>
<p>vector of bootstrap replications of a test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>numeric value of the test statistic based on the original sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of <code>"two-sided"</code> (the default), <code>"greater"</code> or
<code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_vals</code></td>
<td>
<p>vector of sub-sample sizes for which to calculate p-values.
Setting <code>B_vals = length(boot_stat)</code> (the default) will return a
single p-value calculated on the full set of bootstrap replications. For
<code>B_vals &lt; length(boot_stat)</code>, p-values will be calculated after
sub-sampling (without replacement) the bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>integer value for the number of sub-sample p-values to generate
when <code>B_vals &lt; length(boot_stat)</code>, with a default of <code>reps = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enlist</code></td>
<td>
<p>logical indicating whether to wrap the returned values in an
unnamed list, with a default of <code>FALSE</code>. Setting <code>enlist = TRUE</code>
makes it easier to store the output as a single entry in a <code>tibble</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Single numeric value to which the random number generator seed
will be set. Default is <code>NULL</code>, which does not set a seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>p-values are calculated by comparing <code>stat</code> to the distribution
of <code>boot_stat</code>, which is taken to represent the null distribution of
the test statistic. If <code>alternative = "two-sided"</code> (the default), then
the p-value is the proportion of the bootstrap sample where the absolute
value of the bootstrapped statistic exceeds the absolute value of the
original statistic. If <code>alternative = "greater"</code>, then the p-value is
the proportion of the bootstrap sample where the value of the bootstrapped
statistic is larger than the original statistic. If <code>alternative =
  "less"</code>, then the p-value is the proportion of the bootstrap sample where
the value of the bootstrapped statistic is less than the original
statistic.
</p>


<h3>Value</h3>

<p>The format of the output depends on several contingencies. If only a
single value of <code>B_vals</code> is specified and <code>reps = 1</code>, then the
function returns a vector with a single p-value. If only a single value of
<code>B_vals</code> is specified but <code>B_vals &lt; length(boot_stat)</code> and
<code>reps &gt; 1</code>, then the function returns a vector p-values, with an entry
for each sub-sample replication. If <code>B_vals</code> is a vector of multiple
values, then the function returns a list with one entry per entry of
<code>B_vals</code>, where each entry is a vector of length <code>reps</code> with
entries for each sub-sample replication.
</p>
<p>If <code>enlist = TRUE</code>, then results will be wrapped in an unnamed list,
which makes it easier to sore the output in a tibble.
</p>


<h3>References</h3>

<p>Davison, A.C. and Hinkley, D.V. (1997). _Bootstrap Methods and
Their Application_, Chapter 4. Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data from two distinct populations
dat &lt;- data.frame(
  group = rep(c("A","B"), c(40, 50)),
  y = c(
    rgamma(40, shape = 7, scale = 2),
    rgamma(50, shape = 3, scale = 4)
  )
)
stat &lt;- t.test(y ~ group, data = dat)$statistic

# create bootstrap replications under the null of no difference
boot_dat &lt;- dat
booties &lt;- replicate(399, {
  boot_dat$group &lt;- sample(dat$group)
  t.test(y ~ group, data = boot_dat)$statistic
})

# calculate bootstrap p-values from full set of bootstrap replicates
bootstrap_pvals(boot_stat = booties, stat = stat)

# calculate multiple bootstrap p-values using sub-sampling of replicates
bootstrap_pvals(
  boot_stat = booties, stat = stat,
  B_vals = 199,
  reps = 4L
)

# calculate multiple bootstrap p-values using sub-sampling of replicates,
# for each of several sub-sample sizes.
bootstrap_pvals(
  boot_stat = booties, stat = stat,
  B_vals = c(49,99,199),
  reps = 4L
)

</code></pre>


</div>