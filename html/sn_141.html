<div class="container">

<table style="width: 100%;"><tr>
<td>sn-st.info</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected and observed Fisher information for <abbr><span class="acronym">SN</span></abbr> 
and <abbr><span class="acronym">ST</span></abbr> distributions</h2>

<h3>Description</h3>

<p>Computes Fisher information for parameters of simple sample having
skew-normal (<abbr><span class="acronym">SN</span></abbr>) or skew-<code class="reqn">t</code> (<abbr><span class="acronym">ST</span></abbr>) distribution or
for a regression model with errors term having such distributions, in the
<abbr><span class="acronym">DP</span></abbr> and <abbr><span class="acronym">CP</span></abbr> parametrizations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sn.infoUv(dp=NULL, cp=NULL, x=NULL, y, w, penalty=NULL,  norm2.tol=1e-06) 
    
sn.infoMv(dp, x=NULL, y, w, penalty=NULL, norm2.tol=1e-06, at.MLE=TRUE)

st.infoUv(dp = NULL, cp = NULL, x = NULL, y, w, fixed.nu = NULL, 
    symmetr = FALSE, penalty = NULL, norm2.tol = 1e-06) 

st.infoMv(dp, x = NULL, y, w, fixed.nu = NULL, symmetr = FALSE, 
    penalty = NULL, norm2.tol = 1e-06) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dp, cp</code></td>
<td>
<p>direct or centred parameters, respectively; one of them
can be a non-<code>NULL</code> argument. For the univariate <abbr><span class="acronym">SN</span></abbr>
distribution, <code>sn.infoUv</code> is to be used, and these arguments are
vectors. In the multivariate case, <code>sn.infoMv</code> is to be used and these
arguments are lists. See <code>dp2cp</code> for their description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an optional matrix which represents the design matrix of a 
regression model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector (for <code>sn.infoUv</code> and <code>st.infoUv</code>)
or a matrix (for <code>sn.infoMv</code> and <code>st.infoMv</code>) representing the
response.  In the <abbr><span class="acronym">SN</span></abbr> case ( <code>sn.infoUv</code> and
<code>sn.infoMv</code>), <code>y</code> can be missing, and in this case the expected
information matrix is computed; otherwise the observed information is
computed. In the <abbr><span class="acronym">ST</span></abbr> case (<code>st.infoUv</code> and <code>st.infoMv</code>),
<code>y</code> is a required argument, since only the observed information matrix
for <abbr><span class="acronym">ST</span></abbr> distributions is implemented. See ‘Details’ for
additional information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an optional vector of weights (only meaningful for the observed 
information, hence if <code>y</code> is missing); if missing, a vector of 1's is
generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.nu</code></td>
<td>
<p>an optional numeric value which declares a fixed value of the
degrees of freedom, <code>nu</code>. If not <code>NULL</code>, the information matrix
has a dimension reduced by 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetr</code></td>
<td>
<p>a logical flag which indicates whether a symmetry condition of 
the distribution is being imposed; default is <code>symmetr=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>a optional character string with the name of the penalty 
function used in the call to <code>selm</code>; see this function for its
description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm2.tol</code></td>
<td>
<p>for the observed information case, the Mahalanobis squared
distance of the score function from 0 is evaluated; if it exceeds
<code>norm2.tol</code>, a warning message is issued, since the ‘information
matrix’ so evaluated may be not positive-definite.  See ‘Details’ for
additional information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.MLE</code></td>
<td>
<p>a logical flag; if <code>at.MLE=TRUE</code> (default value), 
it generates  a warning if the information matrix is not positive 
definite or an error if the observed information matrix is not evaluated 
at a maximum of the log-likelihood function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dp, cp</code></td>
<td>
<p>one of the two arguments is the one supplied on input; 
the other one matches the previous one in the alternative parametrization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of information matrix: "observed" or "expected".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info.dp, info.cp</code></td>
<td>
<p>matrices of Fisher (observed or expected) 
information in the two parametrizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asyvar.dp, asyvar.cp</code></td>
<td>
<p>inverse matrices of Fisher information in the two
parametrizations, when available; See ‘Details’ for additional
information. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>a list containing auxiliary elements, depending of the selected 
function and the type of computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the univariate <abbr><span class="acronym">SN</span></abbr> case, when <code>x</code> is not set, then a simple
random sample is assumed and a matrix <code>x</code> with a single column of all 
1's is constructed; in this case, the supplied vector <code>dp</code> or <code>cp</code>
must have length 3.  If <code>x</code> is set, then the supplied vector of parameters,
<code>dp</code> or <code>cp</code>, must have length <code>ncol(x)+2</code>.
In the multivariate case, a direct extension of this scheme applies.
</p>
<p>If the observed information matrix is required, <code>dp</code> or <code>cp</code> should
represent the maximum likelihood estimates (MLE) for the given <code>y</code>,
otherwise the information matrix may fail to be positive-definite and it
would be meaningless anyway. 
Therefore, the squared Mahalobis norm of the score vector is evaluated and compared with <code>norm2.tol</code>. 
If it exceeds this threshold, this is taken as an indication that the supplied
parameter list is not at the <abbr><span class="acronym">MLE</span></abbr> and a warning message is issued.
The returned list still includes <code>info.dp</code> and <code>info.cp</code>, but in 
this case these represent merely the matrices of second derivatives;
<code>asyvar.dp</code> and <code>asyvar.cp</code> are set to <code>NULL</code>.
</p>


<h3>Background</h3>

<p>The information matrix for the the univariate <abbr><span class="acronym">SN</span></abbr> distribution in
the two stated parameterizations in discussed in Sections 3.1.3–4 of 
Azzalini and Capitanio (2014). For the multivariate distribution,   
Section 5.2.2 of this monograph summarizes briefly the findings of 
Arellano-Valle and Azzalini (2008).
</p>
<p>For <abbr><span class="acronym">ST</span></abbr> distributions, only the observed information matrix is 
provided, at the moment. Computation for the univariate case is based on 
DiCiccio and Monti (2011). For the multivariate case, the score function is
computed using an expression of Arellano-Valle (2010) followed by numerical
differentiation.
</p>


<h3>References</h3>

<p>Arellano-Valle, R. B. (2010).
The information matrix of the multivariate skew-<em>t</em> distribution.
<em>Metron</em>, <b>LXVIII</b>, 371–386.
</p>
<p>Arellano-Valle, R. B., and Azzalini, A. (2008).
The centred parametrization for the multivariate skew-normal distribution.
<em>J. Multiv. Anal.</em> <b>99</b>, 1362–1382.
Corrigendum: <b>100</b> (2009), 816.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>
<p>DiCiccio,  T. J. and Monti, A. C. (2011).  
Inferential aspects of the skew <code class="reqn">t</code>-distribution.
<em>Quaderni di Statistica</em> <b>13</b>, 1–21.
</p>


<h3>See Also</h3>

<p><code>dsn</code>, <code>dmsn</code>, <code>dp2cp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">infoE &lt;- sn.infoUv(dp=c(0,1,5))           # expected information
set.seed(1); rnd &lt;- rsn(100, dp=c(0, 1, 3))
fit &lt;- selm(rnd~1, family="SN")
infoO &lt;- sn.infoUv(cp=coef(fit), y=rnd)   # observed information
#
data(wines)
X &lt;- model.matrix(~ pH + wine, data=wines)
fit &lt;- sn.mple(x=X, y=wines$alcohol)
infoE &lt;- sn.infoUv(cp=fit$cp, x=X)
infoO &lt;- sn.infoUv(cp=fit$cp, x=X, y=wines$alcohol)
</code></pre>


</div>