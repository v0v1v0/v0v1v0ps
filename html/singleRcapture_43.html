<div class="container">

<table style="width: 100%;"><tr>
<td>estfun.singleRStaticCountData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heteroscedasticity-Consistent Covariance Matrix Estimation for singleRStaticCountData class</h2>

<h3>Description</h3>

<p>S3 method for <code>vcovHC</code> to handle <code>singleRStaticCountData</code> class objects.
Works exactly like <code>vcovHC.default</code> the only difference being that this method handles vector generalised linear models.
Updating the covariance matrix in variance/standard error estimation for population size estimator can be done via <code>redoPopEstimation()</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'singleRStaticCountData'
estfun(x, ...)

## S3 method for class 'singleRStaticCountData'
bread(x, ...)

## S3 method for class 'singleRStaticCountData'
vcovHC(
  x,
  type = c("HC3", "const", "HC", "HC0", "HC1", "HC2", "HC4", "HC4m", "HC5"),
  omega = NULL,
  sandwich = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted <code>singleRStaticCountData</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>vcovHC</code> additional optional arguments passed to the following functions:
</p>

<ul>
<li> <p><code>estfun</code> – for empirical estimating functions.
</p>
</li>
<li> <p><code>hatvalues</code> – for diagonal elements of projection matrix.
</p>
</li>
<li> <p><code>sandwich</code> – only if <code>sandwich</code> argument in function call was set to <code>TRUE</code>.
</p>
</li>
<li> <p><code>vcov</code> – when calling <code>bread</code> internally.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string specifying the estimation type, same as in <code>sandwich::vcovHC.default</code>. HC3 is the default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>a vector or a function depending on the arguments residuals (i.e. the derivative of log-likelihood with respect to each linear predictor), diaghat (the diagonal of the corresponding hat matrix) and df (the residual degrees of freedom), same as in <code>sandwich::vcovHC.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sandwich</code></td>
<td>
<p>logical. Should the sandwich estimator be computed? If set to FALSE only the meat matrix is returned. Same as in <code>sandwich::vcovHC()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Variance-covariance matrix estimation corrected for heteroscedasticity of regression errors.
</p>


<h3>Author(s)</h3>

<p>Piotr Chlebicki, Maciej Beręsewicz
</p>


<h3>See Also</h3>

<p><code>sandwich::vcovHC()</code> <code>redoPopEstimation()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
N &lt;- 10000
gender &lt;- rbinom(N, 1, 0.2)
eta &lt;- -1 + 0.5*gender
counts &lt;- rpois(N, lambda = exp(eta))
df &lt;- data.frame(gender, eta, counts)
df2 &lt;- subset(df, counts &gt; 0)
mod1 &lt;-  estimatePopsize(
  formula = counts ~ 1 + gender, 
  data = df2, 
  model = "ztpoisson", 
  method = "optim", 
  popVar = "analytic"
)
require(sandwich)
HC &lt;- sandwich::vcovHC(mod1, type = "HC4")
Fisher &lt;- vcov(mod1, "Fisher") # variance covariance matrix obtained from 
#Fisher (expected) information matrix
HC
Fisher
# usual results
summary(mod1)
# updated results
summary(mod1, cov = HC,
popSizeEst = redoPopEstimation(mod1, cov = HC))
# estimating equations
mod1_sims &lt;- sandwich::estfun(mod1)
head(mod1_sims)
# bread method
all(vcov(mod1, "Fisher") * nrow(df2) == sandwich::bread(mod1, type = "Fisher"))
</code></pre>


</div>