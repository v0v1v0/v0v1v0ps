<div class="container">

<table style="width: 100%;"><tr>
<td>fit.nb.inar1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Longitudinal Data with Negative Binomial Marginal Distribution and Autoregressive Correlation Structure of Order One: NB-INAR(1)</h2>

<h3>Description</h3>

<p><code>fit.nb.inar1</code> fits data using the maximum likelihood of a reparametrized NB-INAR(1) model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.nb.inar1(
  x,
  lower = rep(10, 3)^-5,
  upper = c(10^5, 10^5, 1 - 10^-5),
  method = "L-BFGS-B",
  start
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame containing count data which is to be fitted. Columns correspond to time points, rows to observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>vector of lower bounds for estimated parameters <code>mu</code>, <code>size</code> and <code>rho</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>vector of upper bounds for estimated parameters <code>mu</code>, <code>size</code> and <code>rho</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>algorithm used for minimization of the likelihood, see <code>optim</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>vector of starting values for estimated parameters <code>mu</code>, <code>size</code> and <code>rho</code>, respectively, used for optimization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the function <code>fit.nb.inar1</code> fits a reparametrization of the NB-INAR(1) model as found in McKenzie (1986). The reparametrized model
assumes equal means and dispersion parameter between time points with an autoregressive correlation structure. The function is especially useful
for estimating parameters for an initial sample size calculation using <code>n.nb.inar1</code>. The fitting function allows for incomplete follow up,
but not for intermittent missingness.
</p>


<h3>Value</h3>

<p><code>fit.nb.inar1</code> return estimates of the mean <code>mu</code>, dispersion parameter <code>size</code> and correlation coefficient <code>rho</code>.
</p>


<h3>Source</h3>

<p><code>fit.nb.inar1</code> uses code contributed by Thomas Asendorf.
</p>


<h3>References</h3>

<p>McKenzie Ed (1986), Autoregressive Moving-Average Processes with Negative-Binomial and Geometric Marginal Distributions. <em>Advances in Applied Probability</em> Vol. 18, No. 3, pp. 679-705.
</p>


<h3>See Also</h3>

<p><code>rnbinom.inar1</code> for information on the NB-INAR(1) model, <code>n.nb.inar1</code> for calculating
initial sample size required when performing inference, <code>bssr.nb.inar1</code> for blinded
sample size reestimation within a running trial, <code>optim</code> for more information on the used minimization algorithms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Generate data from the NB-INAR(1) model
set.seed(8)
random&lt;-rnbinom.inar1(n=1000, size=1.5, mu=2, rho=0.6, tp=7)

estimate&lt;-fit.nb.inar1(random)
estimate
</code></pre>


</div>