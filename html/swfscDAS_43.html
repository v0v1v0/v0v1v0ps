<div class="container">

<table style="width: 100%;"><tr>
<td>das_intersects_strata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DAS strata - points</h2>

<h3>Description</h3>

<p>Determine if swfscDAS outputs intersect with strata polygons
</p>


<h3>Usage</h3>

<pre><code class="language-R">das_intersects_strata(x, ...)

## S3 method for class 'list'
das_intersects_strata(x, strata.files, ...)

## S3 method for class 'data.frame'
das_intersects_strata(
  x,
  strata.files,
  x.lon = "Lon",
  x.lat = "Lat",
  strata.which = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data frame (such as an object of class <code>das_df</code>) or a list.
If <code>x</code> is a list, then it must be the output of
<code>das_effort</code> or <code>das_effort_sight</code>.
If <code>x</code> is a data frame, the user must also specify
the coordinate columns of <code>x</code> using <code>x.lon</code> and <code>x.lat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata.files</code></td>
<td>
<p>list of path(s) of the CSV file(s) with points defining each stratum.
The CSV files must contain headers and be a closed polygon.
The list may be named; see 'Value' section for how these names are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lon</code></td>
<td>
<p>character; name of the longitude column of <code>x</code>.
Ignored if <code>x</code> is a list; default is "Lon"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lat</code></td>
<td>
<p>character; name of the latitude column of <code>x</code>.
Ignored if <code>x</code> is a list; default is "Lat"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata.which</code></td>
<td>
<p>logical; indicates if the numeric column 'strata_which' should
be included in the output data frame.
Ignored if <code>x</code> is a list; default is <code>FALSE</code>.
See 'Value' section for more details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assigns DAS event points or segment midpoints to strata polygons
using <code>st_intersects</code>.
</p>
<p>If <code>x</code> is a list, then 1) it must be the output of
<code>das_effort</code> or <code>das_effort_sight</code> and
2) the segment midpoints (column names mlon and mlat, respectively)
are the points checked if they intersect with each provided stratum.
If <code>x</code> is a data frame, then the user must provide the columns
that specify the point coordinates to check.
</p>
<p><code>x</code> should not be an object of class <code>das_dfr</code>,
or an object of class <code>das_df</code> created with <code>add.dtll.sight = FALSE</code>,
because the ? and numeric event codes will have NA latitude and longitude values.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a data frame, then logical columns are added to <code>x</code>
indicating if each point intersected with the corresponding stratum polygon.
The names of these columns are the names of <code>strata.files</code>;
the element(s) of <code>strata.files</code> will have the name InPoly#,
where '#' is the index of that stratum polygon in <code>strata.files</code>.
If <code>strata.which</code>, then the column 'strata_which' is added to the end of the data frame.
This column contains either a 0 if the point intersects with no strata or
2) a numeric indicating the index (in <code>strata.files</code>) of
the (first) strata polygon that the point intersects with.
</p>
<p>Otherwise, i.e. if <code>x</code> is a list and thus the output of one of the effort functions,
then the stratum columns are added to both the segdata and sightinfo data frames.
However, note that the columns added to the sightinfo data frame still indicate
whether or not the segment midpoint was in the corresponding stratum,
rather than the sighting point itself.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- system.file("das_sample.das", package = "swfscDAS")
y.proc &lt;- das_process(y)
y.eff &lt;- das_effort(y.proc, method = "section", num.cores = 1)

stratum.file &lt;- system.file("das_sample_stratum.csv", package = "swfscDAS")
das_intersects_strata(y.eff, list(InPoly = stratum.file), x.lon = "Lon", x.lat = "Lat")

das_intersects_strata(y.proc, list(stratum.file))

# Visualize effort midpoints and stratum polygon
require(sf)
y.eff.strata &lt;- das_intersects_strata(y.eff, list(InPoly = stratum.file))
segdata &lt;- st_as_sf(y.eff.strata$segdata, coords = c("mlon", "mlat"), crs = 4326)

# Make stratum polygon
stratum.df &lt;- read.csv(stratum.file)
stratum.sfc &lt;- st_sfc(
  st_polygon(list(matrix(c(stratum.df$Lon, stratum.df$Lat), ncol = 2))),
  crs = 4326
)

plot(segdata["InPoly"], axes = TRUE, reset = FALSE,
     xlim = c(-137, -142.5), ylim = c(42, 47))
plot(stratum.sfc, add = TRUE)

</code></pre>


</div>