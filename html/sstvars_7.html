<div class="container">

<table style="width: 100%;"><tr>
<td>calc_gradient</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate gradient or Hessian matrix</h2>

<h3>Description</h3>

<p><code>calc_gradient</code> or <code>calc_hessian</code> calculates the gradient or Hessian matrix
of the given function at the given point using central difference numerical approximation.
<code>get_gradient</code> or <code>get_hessian</code> calculates the gradient or Hessian matrix of the
log-likelihood function at the parameter estimates of a class <code>'stvar'</code> object. <code>get_soc</code>
returns eigenvalues of the Hessian matrix, and <code>get_foc</code> is the same as <code>get_gradient</code>
but named conveniently.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_gradient(x, fn, h = 6e-06, ...)

calc_hessian(x, fn, h = 6e-06, ...)

get_gradient(stvar)

get_hessian(stvar)

get_foc(stvar)

get_soc(stvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector specifying the point where the gradient or Hessian should be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>a function that takes in argument <code>x</code> as the <strong>first</strong> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>difference used to approximate the derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>fn</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stvar</code></td>
<td>
<p>object of class <code>"stvar"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In particular, the functions <code>get_foc</code> and <code>get_soc</code> can be used to check whether
the found estimates denote a (local) maximum point, a saddle point, or something else. Note that
profile log-likelihood functions can be conveniently plotted with the function <code>profile_logliks</code>.
</p>


<h3>Value</h3>

<p>Gradient functions return numerical approximation of the gradient and Hessian functions return
numerical approximation of the Hessian. <code>get_soc</code> returns eigenvalues of the Hessian matrix.
</p>


<h3>Warning</h3>

<p>No argument checks!
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create a simple function:
foo &lt;- function(x) x^2 + x

# Calculate the gradient at x=1 and x=-0.5:
calc_gradient(x=1, fn=foo)
calc_gradient(x=-0.5, fn=foo)

# Create a more complicated function
foo &lt;- function(x, a, b) a*x[1]^2 - b*x[2]^2

# Calculate the gradient at x=c(1, 2) with parameter values a=0.3 and b=0.1:
calc_gradient(x=c(1, 2), fn=foo, a=0.3, b=0.1)

# Create a linear Gaussian VAR p=1 model:
theta_112 &lt;- c(0.649526, 0.066507, 0.288526, 0.021767, -0.144024, 0.897103,
 0.601786, -0.002945, 0.067224)
mod112 &lt;- STVAR(data=gdpdef, p=1, M=1, params=theta_112)

# Calculate the gradient of the log-likelihood function about the parameter values:
get_foc(mod112)

# Calculate the eigenvalues of the Hessian matrix of the log-likelihood function
# about the parameter values:
get_soc(mod112)
</code></pre>


</div>