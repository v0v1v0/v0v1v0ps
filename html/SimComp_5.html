<div class="container">

<table style="width: 100%;"><tr>
<td>ermvnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multivariate Normal Random Numbers with Exact Parameters </h2>

<h3>Description</h3>

<p>Random numbers of the multivariate normal distribution with EXACT mean vector, EXACT
variance vector and approximate correlation matrix. This function is based on the
function <code>rmvnorm</code> of the package <span class="pkg">mvtnorm</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ermvnorm(n, mean, sd, corr = diag(rep(1, length(mean))), mnt = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> a number of observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p> a mean vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p> a vector of standard deviations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p> a correlation matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mnt</code></td>
<td>
<p> a maximum number of tries for the computation </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unfortunately, it's very common to present only summary statistics in the literature
when evaluating real data. This makes it hard to retrace or to verify the related
statistical evaluation. Also, the use of such data as an example for other
statistical tests is hardly possible. For that reason, <code>ermvnorm</code> allows to
reproduce data by simulation. In contrast to <code>rmvnorm</code> of the package mvtnorm,
the function <code>ermvnorm</code> produces random numbers which have EXACTLY the same
paramer values as specified by <code>mean</code> and <code>sd</code>. The correlation matrix
<code>corr</code> is met only approximately.
</p>
<p>The simple idea behind <code>ermvnorm</code> is to apply <code>rmvnorm</code> of the package
mvtnorm, but only for the first n-2 random numbers. The remaining 2 numbers are
obtained by solving a quadratic equation to achieve the specified values for the
mean vector and for the vector of standard deviations. Depending on the n-2 random
numbers, the underlying quadratic equation can possibly have no solution. In this
case, <code>ermvnorm</code> creates a new set of n-2 random numbers until a valid data
set is obtained, or until the maximum number of tries <code>mnt</code> is reached.
</p>


<h3>Value</h3>

<p>A matrix of random numbers with dimension n * length(mean).
</p>


<h3>Note</h3>

<p>This function is to be used only with caution. Usually, random numbers with exact
mean and standard deviation are not intended to be used. For example, simulations
concerning type I error or power of statistical tests cannot be based on
<code>ermvnorm</code>.
</p>


<h3>Author(s)</h3>

<p> Gemechis Djira Dilba and Mario Hasler</p>


<h3>References</h3>

<p>Hothorn, T. et al. (2001): On Multivariate <em>t</em> and Gauss Probabilities in R.
<em>R News</em> 1, 27â€“29.
</p>


<h3>See Also</h3>

 <p><code>rmvnorm</code>, <code>rcm</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1:
# A dataset representing one endpoint.

set.seed(1234)
dataset1 &lt;- ermvnorm(n=10,mean=100,sd=10)
dataset1
mean(dataset1)
sd(dataset1)

# Example 2:
# A dataset representing two correlated endpoints.

set.seed(5678)
dataset2 &lt;- ermvnorm(n=10,mean=c(10,120),sd=c(1,10),corr=rbind(c(1,0.7),c(0.7,1)))
dataset2
mean(dataset2[,1]); mean(dataset2[,2])
sd(dataset2[,1]); sd(dataset2[,2])
round(cor(dataset2),3)
pairs(dataset2)

# Example 3:
# A dataset representing three uncorrelated endpoints.

set.seed(9101)
dataset3 &lt;- ermvnorm(n=20,mean=c(1,12,150),sd=c(0.5,2,20))
dataset3
mean(dataset3[,1]); mean(dataset3[,2]); mean(dataset3[,3])
sd(dataset3[,1]); sd(dataset3[,2]); sd(dataset3[,3])
pairs(dataset3)

# Example 4:
# A dataset representing four randomly correlated endpoints.

set.seed(1121)
dataset4 &lt;- ermvnorm(n=10,mean=c(2,10,50,120),sd=c(1,4,8,10),corr=rcm(ncol=4))
dataset4
mean(dataset4[,1]); mean(dataset4[,2]); mean(dataset4[,3]); mean(dataset4[,4])
sd(dataset4[,1]); sd(dataset4[,2]); sd(dataset4[,3]); sd(dataset4[,4])
round(cor(dataset4),3)
pairs(dataset4)
</code></pre>


</div>