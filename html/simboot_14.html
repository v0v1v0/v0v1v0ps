<div class="container">

<table style="width: 100%;"><tr>
<td>mcpHill</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multiplicity-adjusted p-values for comparing biodiversity via
simultaneous inference of a user-defined selection of diversity
indices </h2>

<h3>Description</h3>

<p> The function mcpHill allows for comparing
biological diversities of two or more groups. It simultaneously tests
a user-defined selection of Hill numbers of orders q, which are
considered appropriate and useful indices for measuring diversity
(Jost 2008). As an output mcpHill gives p-values adjusted for
multiplicity according to the method of Westfall &amp; Young (1993).  </p>


<h3>Usage</h3>

<pre><code class="language-R"> mcpHill(dataf, fact, align = FALSE, block, boots = 5000, udmat
  = FALSE, usermat, mattype = "Dunnett", dunbase = 1, qval = seq(-1, 3),
  opt = "two.sided") </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataf</code></td>
<td>
<p>	Data frame containing numerical values (e.g. species
counts or relative abundances).  Rows represent repeated
observations of the (two or more) groups, columns
represent taxonomic units (usually species, or phyla,
classes etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p> Vector assigning (two or
more) factor levels to the observations, i.e. the groups
to be compared. The length of fact must equal the number
of rows in dataf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align</code></td>
<td>
<p>	Logical
indicating whether a block alignment should be carried
out. If TRUE, the blocks must be specified as a vector
in block. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>	Vector
assigning which block an observation belongs to. Only
required if align=TRUE.  The length of block must equal
the number of rows in dataf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boots</code></td>
<td>
<p>	Number
of bootstrap replications. Values lower than 999 are
rejected. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>udmat</code></td>
<td>
<p>	Logical
indicating whether used-defined contrasts are applied
for multiple testing. If TRUE, a contrast matrix has to
be specified via usermat. Default is FALSE, meaning that
the contrast matrix is specified by a catchword
(e.g. "Tukey", "Dunnett" etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usermat</code></td>
<td>

<p>Matrix specifying user-defined multiple testing
contrasts. Only required if udmat=TRUE.  The row sums in
the matrix must equal zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mattype</code></td>
<td>
<p>	Type of
contrast matrix for multiple comparisons of
groups. Hence only required for comparisons of more than
two groups. Can be specified by the catchwords used in
function <code>contrMat</code> (e.g. "Dunnett",
"Tukey", "GrandMean", "AVE", "Williams", "Changepoint"
etc.). Default is "Dunnett".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dunbase</code></td>
<td>
<p>	Integer determining the factor group (in alphanumerical order)
to be considered the baseline or control and therefore
only needed for Dunnett-type multiple contrasts.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qval</code></td>
<td>
<p>	Vector containing the
requested selection of q-values in order to specify the
Hill numbers of orders q to be investigated. Default is
seq(-1,3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>	"greater" performs an
upper-tailed test, "less" a lower-tailed test and
"two.sided" a two-tailed test. Default is "two.sided".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p> The output of mcpHill is a matrix containing the chosen
selection of Hill numbers (their orders q) in the first column. The
multiplicity-adjusted p-values for each hypothesis tested are in the
second column.  The names of the rows denote which groups are being
compared.  </p>


<h3>Author(s)</h3>

<p> Philip Pallmann </p>


<h3>References</h3>

<p><em>Pallmann, P. et al. (2012)</em> Assessing group differences in
biodiversity by simultaneously testing a user-defined selection of
diversity indices. Molecular ecology resources 12, 1068–78.
</p>
<p><em>Jost, L. (2008)</em> G(ST) and its relatives do not measure
differentiation. Molecular Ecology, 17, 4015–4026.
</p>
<p><em>Westfall, P.H. and Young S.S. (1993)</em> Resampling-based multiple
testing: examples and methods for p-value adjustment. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Multiple testing with user-defined contrasts after block alignment

data(predatGM)

mymat &lt;- rbind( "GM - S1" = c(1,-1,0,0), "GM - S2" = c(1,0,-1,0), "GM -
  S3" = c(1,0,0,-1), "S1 - S2" = c(0,1,-1,0), "S1 - S3" = c(0,1,0,-1) )

# example runs with only 100 bootstrap steps. For estimation use 2000 or more.
mcpHill(dataf=predatGM[,3:35], fact=predatGM[,2], align=TRUE,
block=predatGM[,1], boots=100, udmat=TRUE, usermat=mymat, qval=seq(-1,
3, by=0.5))

# with Dunnett-type contrast matrix
mcpHill(dataf=predatGM[,3:35], fact=predatGM[,2], align=TRUE,
block=predatGM[,1], boots=100, udmat=FALSE, mattype = "Dunnett", qval=seq(-1,
3, by=0.5))

</code></pre>


</div>