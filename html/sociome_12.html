<div class="container">

<table style="width: 100%;"><tr>
<td>get_adi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get Area Deprivation Index (ADI) and Berg Indices (ADI-3)</h2>

<h3>Description</h3>

<p>Returns the ADI and ADI-3 of user-specified areas.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_adi(
  geography,
  state = NULL,
  county = NULL,
  geoid = NULL,
  zcta = NULL,
  year,
  dataset = c("acs5", "acs3", "acs1", "decennial"),
  geometry = FALSE,
  keep_indicators = FALSE,
  raw_data_only = FALSE,
  cache_tables = TRUE,
  key = NULL,
  seed = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geography</code></td>
<td>
<p>A character string denoting the level of census geography
whose ADIs and ADI-3s you'd like to obtain. Must be one of <code>c("state", "county", "tract", "block group", "zcta")</code>. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state</code></td>
<td>
<p>A character string specifying states whose ADI and ADI-3 data is
desired. Defaults to <code>NULL</code>. Can contain full state names, two-letter state
abbreviations, or a two-digit FIPS code/GEOID (must be a vector of strings,
so use quotation marks and leading zeros if necessary). Must be left as
<code>NULL</code> if using the <code>geoid</code> or <code>zcta</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>county</code></td>
<td>
<p>A vector of character strings specifying the counties whose ADI
and ADI-3 data you're requesting. Defaults to <code>NULL</code>. If not <code>NULL</code>, the
<code>state</code> parameter must have a length of 1. County names and three-digit
FIPS codes are accepted (must contain strings, so use quotation marks and
leading zeros if necessary). Must be blank if using the <code>geoid</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geoid</code></td>
<td>
<p>A character vector of GEOIDs (use quotation marks and leading
zeros). Defaults to <code>NULL</code>. Must be blank if <code>state</code>, <code>county</code>, or <code>zcta</code>
is used. Can contain different levels of geography (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zcta</code></td>
<td>
<p>A character vector of ZCTAs or the leading digit(s) of ZCTAs (use
quotation marks and leading zeros). Defaults to <code>NULL</code>. Must be blank if
<code>state</code>, <code>county</code>, or <code>geoid</code> is used.
</p>
<p>Strings under 5 digits long will yield all ZCTAs that begin with those
digits.
</p>
<p>Requires that <code>geography = "zcta"</code>. If <code>geography = "zcta"</code> and <code>zcta = NULL</code>, all ZCTAs in the US will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Single integer specifying the year of US Census data to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>The data set used to calculate ADIs and ADI-3s. Must be one of
<code>c("acs5", "acs3", "acs1", "decennial")</code>, denoting the 5-, 3-, and 1-year
ACS along with the decennial census. Defaults to <code>"acs5"</code>.
</p>
<p>When <code>dataset = "decennial"</code>, <code>year</code> must be in <code>c(1990, 2000, 2010)</code>.
</p>
<p>The 2010 decennial census did not include the long-form questionnaire used
in the 1990 and 2000 censuses, so this function uses the 5-year estimates
from the 2010 ACS to supply the data not included in the 2010 decennial
census. In fact, the only 2010 decennial variables used are H003002,
H014002, P020002, and P020008.
</p>
<p>Important: data are not always available depending on the level of
geography and data set chosen. See
<a href="https://www.census.gov/programs-surveys/acs/guidance/estimates.html">https://www.census.gov/programs-surveys/acs/guidance/estimates.html</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geometry</code></td>
<td>
<p>Logical value indicating whether or not shapefile data should
be included in the result, making the result an <code>sf</code> object
instead of a plain <code>tibble</code>. Defaults to <code>FALSE</code>.
</p>
<p>The shapefile data that is returned is somewhat customizable by passing
certain arguments along to the <code>tidycensus</code> functions via <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_indicators</code></td>
<td>
<p>Logical value indicating whether or not the resulting
<code>tibble</code> or <code>sf</code> object will contain the
socioeconomic measures used to calculate the ADI and ADI-3 values. Defaults
to <code>FALSE</code>.
</p>
<p>See <code>acs_vars</code> and <code>decennial_vars</code> for basic descriptions of the raw
census variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw_data_only</code></td>
<td>
<p>Logical, indicating whether or not to skip calculation
of the ADI and ADI-3 and only return the census variables. Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache_tables</code></td>
<td>
<p>The plural version of the <code>cache_table</code> argument in
<code>tidycensus::get_acs()</code> or <code>tidycensus::get_decennial()</code>. (<code>get_adi()</code>
calls the necessary <code>tidycensus</code> function many times in order to return
ADIs and ADI-3s, so many tables are cached if <code>TRUE</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>Your Census API key as a character string. Obtain one at
<a href="http://api.census.gov/data/key_signup.html">http://api.census.gov/data/key_signup.html</a>. Defaults to <code>NULL</code>. Not
necessary if you have already loaded your key with <code>census_api_key()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Passed to <code>calculate_adi()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed onto <code>tidycensus::get_acs()</code> or
<code>tidycensus::get_decennial()</code>. These must all be named. Must not match any
of the <code>tidycensus</code> formal arguments that <code>sociome</code> needs to set
explicitly.
</p>
<p>This may be found to be helpful when setting <code>geometry = TRUE</code>, since the
<code>tidycensus</code> functions pass <code>...</code> onto the appropriate <code>tigris</code> function
(namely, one of <code>tigris::states()</code>, <code>tigris::counties()</code>,
<code>tigris::tracts()</code>, <code>tigris::block_groups()</code>, or <code>tigris::zctas()</code>,
according to the the value of <code>geography</code>). This enables the user to
somewhat customize the shapefile data obtained.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Returns a <code>tibble</code> or <code>sf</code> object of the Area
Deprivation Indices (ADIs) and Berg Indices (ADI-3s) of user-specified
locations in the United States, utilizing US Census data. Locations that are
listed as having zero households are excluded from ADI and ADI-3 calculation:
their ADI and ADI-3 values will be <code>NA</code>.
</p>


<h3>Value</h3>

<p>If <code>geometry = FALSE</code>, (the default) a <code>tibble</code>. If
<code>geometry = TRUE</code> is specified, an <code>sf</code>.
</p>


<h3>Reference area</h3>

<p><strong>The concept of "reference area" is important to
understand when using this function.</strong> The algorithm that produced the
original ADIs employs factor analysis. As a result, the ADI is a relative
measure; the ADI of a particular location is dynamic, varying depending on
which other locations were supplied to the algorithm. In other words, <strong>ADI
will vary depending on the reference area you specify.</strong>
</p>
<p>For example, the ADI of Orange County, California is <em>x</em> when calculated
alongside all other counties in California, but it is <em>y</em> when calculated
alongside all counties in the US. The <code>get_adi()</code> function enables the user
to define a <strong>reference area</strong> by feeding a vector of GEOIDs to its <code>geoid</code>
parameter (or alternatively for convenience, states and/or counties to
<code>state</code> and <code>county</code>). The function then gathers data from those specified
locations and performs calculations using their data alone.
</p>
<p>The Berg Indices (ADI-3) were developed with this principle of relativity
in mind, and as such there is no set of seminal ADI-3 values. Thus, the
terms "Berg Indices" and "ADI-3" refer more nearly to any values generated
using the algorithm employed in this package.
</p>
<p>Areas listed as having zero households are excluded from the reference
area, and their ADI and ADI-3 values will be <code>NA</code>.
</p>


<h3>The <code>geoid</code> parameter</h3>

<p>Elements of <code>geoid</code> can represent different
levels of geography, but they all must be either 2 digits (for states), 5
digits (for counties), 11 digits (for tracts), or 12 digits (for block
groups). It must contain character strings, so use quotation marks as well
as leading zeros where applicable.
</p>


<h3>ADI and ADI-3 factor loadings</h3>

<p>The returned
<code>tibble</code> or <code>sf</code> is of class <code>adi</code>, and it
contains an attribute called <code>loadings</code>, which contains a tibble of the PCA
loadings of each factor. This is accessible through
<code>attr</code><code style="white-space: pre;">⁠(name_of_tibble, "loadings")⁠</code>.
</p>


<h3>Missingness and imputation</h3>

<p>While this function allows flexibility
in specifying reference areas (see the <strong>Reference area</strong> section above),
data from the US Census are masked for sparsely populated places, resulting
in many missing values.
</p>
<p>Imputation is attempted via <code>mice::mice</code><code style="white-space: pre;">⁠(m = 1, maxit = 50, method = "pmm", seed = seed)⁠</code>. If imputation is unsuccessful, an error is thrown,
but the dataset of indicators on which imputation was unsuccessful is
available via <code>rlang::last_error()</code><code style="white-space: pre;">⁠$adi_indicators⁠</code> and the raw census
data are available via <code>rlang::last_error()</code><code style="white-space: pre;">⁠$adi_raw_data⁠</code>. The former
excludes areas with zero households, but the latter includes them.
</p>
<p>One of the indicators of both ADI and the Financial Strength component of
ADI-3 is median family income, but methodological issues with the 2015 and
2016 ACS have rendered this variable unavailable at the block group level
for those years. When requested, this function will use median household
income in its place, with a <code>warning()</code>. See
<a href="https://www.census.gov/programs-surveys/acs/technical-documentation/user-notes/2016-01.html">https://www.census.gov/programs-surveys/acs/technical-documentation/user-notes/2016-01.html</a>.
</p>


<h3>API-related error handling</h3>

<p>Depending on user input, this function
may call its underlying functions (<code>tidycensus::get_acs()</code> or
<code>tidycensus::get_decennial()</code>) many times in order to accommodate their
behavior. When these calls are broken up by state or by state and county, a
message is printed indicating the state or state and county whose data is
being pulled. These calls are wrapped in
<code>purrr::insistently</code><code>(</code><code>purrr::rate_delay()</code><code style="white-space: pre;">⁠, quiet = FALSE)⁠</code>, meaning
that they are attempted over and over until success, and <code>tidycensus</code> error
messages are printed as they occur.
</p>


<h3>Warnings and disclaimers</h3>

<p>Please note that this function calls data
from US Census servers, so execution may take a long time depending on the
user's internet connection and the amount of data requested.
</p>
<p>For advanced users, if changing the <code>dataset</code> argument, be sure to know the
advantages and limitations of the 1-year and 3-year ACS estimates. See
<a href="https://www.census.gov/programs-surveys/acs/guidance/estimates.html">https://www.census.gov/programs-surveys/acs/guidance/estimates.html</a> for
details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Wrapped in \dontrun{} because all these examples take &gt;5 seconds
# and require a Census API key.

# ADI of all census tracts in Cuyahoga County, Ohio
get_adi(geography = "tract", year = 2017, state = "OH", county = "Cuyahoga")

# ADI and ADI-3 of all counties in Connecticut, using the 2014 ACS1 survey.
# Returns a warning because there are only 8 counties.
# A minimum of 30 locations is recommended.
get_adi(geography = "county", state = "CT", year = 2014, dataset = "acs1")

# Areas with zero households will have an ADI and ADI-3 of NA:
queens &lt;-
  get_adi(
    "tract",
    year = 2017,
    state = "NY",
    county = "Queens",
    keep_indicators = TRUE,
    geometry = TRUE
  )
queens %&gt;%
  dplyr::as_tibble() %&gt;%
  dplyr::select(GEOID, NAME, ADI, households = B11005_001) %&gt;%
  dplyr::filter(is.na(ADI) | households == 0) %&gt;%
  print(n = Inf)

# geoid argument allows for highly customized reference populations.
# ADI of all census tracts in the GEOIDs stored in "delmarva" below:
# Notice the mixing of state- ("10") and county-level GEOIDs (the others).
delmarva_geoids &lt;- c("10", "51001", "51131", "24015", "24029", "24035",
                     "24011", "24041", "24019", "24045", "24039", "24047")
delmarva &lt;-
  get_adi(
    geography = "tract",
    geoid = delmarva_geoids,
    dataset = "acs5",
    year = 2009,
    geometry = TRUE
  )

# Demonstration of geom_sf() integration:
require(ggplot2)

# The na.value argument changes the fill of NA ADI areas.
delmarva %&gt;% ggplot() + geom_sf(aes(fill = ADI), lwd = 0)

# Setting direction = -1 makes the less deprived areas the lighter ones
# The argument na.value changes the color of zero-household areas
queens %&gt;%
  ggplot() +
  geom_sf(aes(fill = ADI), lwd = 0) +
  scale_fill_viridis_c(na.value = "red", direction = -1)

# Obtain factor loadings:
attr(queens, "loadings")

## End(Not run)
</code></pre>


</div>