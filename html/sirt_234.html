<div class="container">

<table style="width: 100%;"><tr>
<td>mle.pcm.group</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum Likelihood Estimation of Person or Group Parameters
in the Generalized Partial Credit Model
</h2>

<h3>Description</h3>

<p>This function estimates person or group parameters in the
partial credit model (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mle.pcm.group(dat, b, a=rep(1, ncol(dat)), group=NULL,
    pid=NULL, adj_eps=0.3, conv=1e-04, maxiter=30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>A numeric <code class="reqn">N \times I</code> matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Matrix with item thresholds
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>Vector of item slopes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Vector of group identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>

<p>Vector of person identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj_eps</code></td>
<td>

<p>Numeric value which is used in <code class="reqn">\varepsilon</code> adjustment
of the likelihood. A value of zero (or a very small
<code class="reqn">\varepsilon&gt;0</code>) corresponds to the usual maximum
likelihood estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that the generalized partial credit model holds.
In case one estimates a person parameter <code class="reqn">\theta_p</code>,
the log-likelihood is maximized and the following
estimating equation results: (see Penfield &amp; Bergeron, 2005):
</p>
<p style="text-align: center;"><code class="reqn"> 0=( \log L )'=\sum_i a_i \cdot [ \tilde{x}_{pi} -
    E(X_{pi} | \theta_p ) ] </code>
</p>

<p>where <code class="reqn">E(X_{pi} | \theta_p )</code> denotes the expected item response
conditionally on <code class="reqn">\theta_p</code>.
</p>
<p>With the method of <code class="reqn">\varepsilon</code>-adjustment (Bertoli-Barsotti &amp; Punzo, 2012;
Bertoli-Barsotti, Lando &amp; Punzo, 2014),
the observed item responses <code class="reqn">x_{pi}</code> are transformed such that
no perfect scores arise and bias is reduced. If <code class="reqn">S_p</code>
is the sum score of person <code class="reqn">p</code> and <code class="reqn">M_p</code> the maximum
score of this person, then the transformed sum scores <code class="reqn">\tilde{S}_p</code>
are
</p>
<p style="text-align: center;"><code class="reqn"> \tilde{S}_p=\varepsilon + \frac{M_p - 2 \varepsilon}{M_p} S_p</code>
</p>

<p>However, the adjustment is directly conducted on item responses
to also handle the case of the generalized partial credit
model with item slope parameters different from 1.
</p>
<p>In case one estimates a group parameter <code class="reqn">\theta_g</code>,
the following estimating equation is used:
</p>
<p style="text-align: center;"><code class="reqn"> 0=(\log L )'=\sum_p \sum_i a_i \cdot [ \tilde{x}_{pgi} -
    E(X_{pgi} | \theta_g ) ] </code>
</p>

<p>where persons <code class="reqn">p</code> are nested within a group <code class="reqn">g</code>.
The <code class="reqn">\varepsilon</code>-adjustment is then performed at the
group level, not at the individual level.
</p>


<h3>Value</h3>

<p>A list with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with person or group parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_adjeps</code></td>
<td>
<p>Modified dataset according to the
<code class="reqn">\varepsilon</code> adjustment.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bertoli-Barsotti, L., &amp; Punzo, A. (2012).
Comparison of two bias reduction techniques for the Rasch model.
<em>Electronic Journal of Applied Statistical Analysis, 5</em>, 360-366.
</p>
<p>Bertoli-Barsotti, L., Lando, T., &amp; Punzo, A. (2014).
Estimating a Rasch Model via fuzzy empirical probability functions.
In D. Vicari, A. Okada, G. Ragozini &amp;  C. Weihs (Eds.).
<em>Analysis and Modeling of Complex Data in Behavioral and Social Sciences</em>,
Springer.
</p>
<p>Penfield, R. D., &amp; Bergeron, J. M. (2005). Applying a weighted
maximum likelihood latent trait estimator to the generalized
partial credit model. <em>Applied Psychological Measurement,
29</em>, 218-233.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Estimation of a group parameter for only one item per group
#############################################################################

data(data.si01)
dat &lt;- data.si01
# item parameter estimation (partial credit model) in TAM
library(TAM)
mod &lt;- TAM::tam.mml( dat[,2:3], irtmodel="PCM")
# extract item difficulties
b &lt;- matrix( mod$xsi$xsi, nrow=2, byrow=TRUE )
# groupwise estimation
res1 &lt;- sirt::mle.pcm.group( dat[,2:3], b=b, group=dat$idgroup )
# individual estimation
res2 &lt;- sirt::mle.pcm.group( dat[,2:3], b=b  )

#############################################################################
# EXAMPLE 2: Data Reading data.read
#############################################################################

data(data.read)
# estimate Rasch model
mod &lt;- sirt::rasch.mml2( data.read )
score &lt;- rowSums( data.read )
data.read &lt;- data.read[ order(score), ]
score &lt;- score[ order(score) ]
# compare different epsilon-adjustments
res30 &lt;- sirt::mle.pcm.group( data.read, b=matrix( mod$item$b, 12, 1 ),
               adj_eps=.3 )$person
res10 &lt;- sirt::mle.pcm.group( data.read, b=matrix( mod$item$b, 12, 1 ),
             adj_eps=.1 )$person
res05 &lt;- sirt::mle.pcm.group( data.read, b=matrix( mod$item$b, 12, 1 ),
              adj_eps=.05 )$person
# plot different scorings
plot( score, res05$theta, type="l", xlab="Raw score", ylab=expression(theta[epsilon]),
         main="Scoring with different epsilon-adjustments")
lines( score, res10$theta, col=2, lty=2 )
lines( score, res30$theta, col=4, lty=3 )

## End(Not run)
</code></pre>


</div>