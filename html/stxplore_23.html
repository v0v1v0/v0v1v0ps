<div class="container">

<table style="width: 100%;"><tr>
<td>emp_spatial_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes empirical spatial covariance using a dataframe or a stars object</h2>

<h3>Description</h3>

<p>Computes empirical spatial covariance by removing trends and examining residuals. It can compute lag-0 or log-1
empirical covariance either by latitude or longitude. You can split up the spatial domain by latitude or
longitude and plot the covariance for each longitudinal/latitudinal strips.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emp_spatial_cov(
  x,
  lat_or_lon_strips = "lon",
  quadratic_time = FALSE,
  quadratic_space = FALSE,
  num_strips = 1,
  lag = 0,
  ...
)

## S3 method for class 'data.frame'
emp_spatial_cov(
  x,
  lat_or_lon_strips = "lon",
  quadratic_time = FALSE,
  quadratic_space = FALSE,
  num_strips = 1,
  lag = 0,
  lat_col,
  lon_col,
  t_col,
  z_col,
  ...
)

## S3 method for class 'stars'
emp_spatial_cov(
  x,
  lat_or_lon_strips = "lon",
  quadratic_time = FALSE,
  quadratic_space = FALSE,
  num_strips = 1,
  lag = 0,
  ...
)

## S3 method for class 'spatialcov'
autoplot(object, xlab = "Latitude", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A stars object or a dataframe. Arguments differ according to the input type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_or_lon_strips</code></td>
<td>
<p>Takes the values <code>lat</code> or <code>lon</code>. The value <code>lat</code> produces latitudinal strips,
i.e., covariance plots over longitude for different latitudinal strips. The value <code>lon</code> produces longitudinal
strips, i.e., covariance plots over latitude for different longitudinal strips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadratic_time</code></td>
<td>
<p>If <code>TRUE</code>  a linear model with quadratic time is fitted and residuals computed. If <code>FALSE</code>
the model is fitted with linear space and time coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadratic_space</code></td>
<td>
<p>If <code>TRUE</code>  a linear model with quadratic space is fitted and residuals computed. If <code>FALSE</code>
the model is fitted with linear space and time coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_strips</code></td>
<td>
<p>The number of latitudinal/longitudinal strips to produce. This is used when plotting using autoplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>Lag can be either 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments currently ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_col</code></td>
<td>
<p>For dataframes: the column or the column name giving the latitude. The y coordinate can be used instead of latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_col</code></td>
<td>
<p>For dataframes: the column or the column name giving the longitude. The x coordinate can be used instead of longitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_col</code></td>
<td>
<p>For dataframes: the time column. Time must be a set of discrete integer values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_col</code></td>
<td>
<p>For dataframes: the The quantity of interest that will be plotted. Eg. temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>For autoplot: the output of the function ‘emp_spatial_cov’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>For autoplot: the label for x-axis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A spatialcov object with empirical covariance data organised spatially according to the
number of strips and the lagged covariance.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Dataframe example
library(dplyr)
data(NOAA_df_1990)
Tmax &lt;- filter(NOAA_df_1990,
  proc == "Tmax" &amp;
  month %in% 5:6 &amp;
  year == 1993)
Tmax$t &lt;- Tmax$julian - min(Tmax$julian) + 1
emp_df &lt;- emp_spatial_cov(Tmax,
                lat_col = "lat",
                lon_col = "lon",
                t_col ="t",
                z_col = "z",
                lat_or_lon_strips = "lon",
                num_strips = 4,
                lag = 1)
autoplot(emp_df)

# Stars example
library(stars)
# Create a stars object from a data frame
precip_df &lt;- NOAA_df_1990[NOAA_df_1990$proc == 'Precip', ] %&gt;%
  filter(date &gt;= "1992-02-01" &amp; date &lt;= "1992-02-05")
precip &lt;- precip_df[ ,c('lat', 'lon', 'date', 'z')]
st_precip &lt;- st_as_stars(precip, dims = c("lon", "lat", "date"))
emp_spatial_cov(st_precip)
</code></pre>


</div>