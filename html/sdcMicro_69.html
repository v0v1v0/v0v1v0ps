<div class="container">

<table style="width: 100%;"><tr>
<td>rankSwap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank Swapping</h2>

<h3>Description</h3>

<p>Swapping values within a range so that, first, the correlation structure of
original variables are preserved, and second, the values in each record are
disturbed.  To be used on numeric or ordinal variables where the rank can be
determined and the correlation coefficient makes sense.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rankSwap(
  obj,
  variables = NULL,
  TopPercent = 5,
  BottomPercent = 5,
  K0 = NULL,
  R0 = NULL,
  P = NULL,
  missing = NA,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a <code>sdcMicroObj-class</code>-object or a <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>names or index of variables for that rank swapping is
applied.  For an object of class <code>sdcMicroObj-class</code>, all numeric key variables are
selected if variables=NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TopPercent</code></td>
<td>
<p>Percentage of largest values that are grouped together
before rank swapping is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BottomPercent</code></td>
<td>
<p>Percentage of lowest values that are grouped together
before rank swapping is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K0</code></td>
<td>
<p>Subset-mean preservation factor. Preserves the means before and
after rank swapping within a range based on K0.  K0 is the subset-mean
preservation factor such that <code class="reqn">| X_1 -X_2 | \leq \frac{2 K_0
X_1}{\sqrt(N_S)}</code>, where <code class="reqn">X_1</code>
and <code class="reqn">X_2</code> are the subset means of the field before and after
swapping, and <code class="reqn">N_S</code> is the sample size of the subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>Multivariate preservation factor. Preserves the correlation
between variables within a certain range based on the given constant R0.  We
can specify the preservation factor as <code class="reqn">R_0=\frac{R_1}{R_2}</code> where <code class="reqn">R_1</code> is the correlation coefficient of the two
fields after swapping, and <code class="reqn">R_2</code> is the correlation coefficient of
the two fields before swapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Rank range as percentage of total sample size. We can specify the
rank range itself directly, noted as <code class="reqn">P</code>, which is the percentage of
the records. So two records are eligible for swapping if their ranks,
<code class="reqn">i</code> and <code class="reqn">j</code> respectively, satisfy <code class="reqn">| i-j | \le \frac{P
N}{100}</code>, where <code class="reqn">N</code> is the total sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>missing - the value to be used as missing value
in the C++ routine instead of NA. If NA, a suitable value is calculated internally.
Note that in the returned dataset, all NA-values (if any) will be replaced with
this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rank swapping sorts the values of one numeric variable by their numerical
values (ranking).  The restricted range is determined by the rank of two
swapped values, which cannot differ, by definition, by more than P
percent of the total number of observations. Only positive P, R0 and K0 are
used and only one of it must be supplied. If none is supplied, sdcMicro sets
parameter r0 to 0.95 internally.
</p>


<h3>Value</h3>

<p>The rank-swapped data set or a modified <code>sdcMicroObj-class</code> object.
</p>


<h3>Author(s)</h3>

<p>Alexander Kowarik for the interface, Bernhard Meindl for improvements.
</p>
<p>For the underlying C++ code: This work is being supported by the
International Household Survey Network (IHSN) and funded by a DGF Grant
provided by the World Bank to the PARIS21 Secretariat at the Organisation
for Economic Co-operation and Development (OECD).  This work builds on
previous work which is elsewhere acknowledged.
</p>


<h3>References</h3>

<p>Moore, Jr.R. (1996) Controlled data-swapping techniques for
masking public use microdata, U.S. Bureau of the Census <em>Statistical
Research Division Report Series</em>, RR 96-04.
</p>
<p>Kowarik, A. and Templ, M. and Meindl, B. and Fonteneau, F. and Prantner, B.:
<em>Testing of IHSN Cpp Code and Inclusion of New Methods into sdcMicro</em>,
in: Lecture Notes in Computer Science, J. Domingo-Ferrer, I. Tinnirello
(editors.); Springer, Berlin, 2012, ISBN: 978-3-642-33626-3, pp. 63-77.
<a href="https://doi.org/10.1007/978-3-642-33627-0_6">doi:10.1007/978-3-642-33627-0_6</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(testdata2)
data_swap &lt;- rankSwap(
  obj = testdata2,
  variables = c("age", "income", "expend", "savings")
)

## for objects of class sdcMicro:
data(testdata2)
sdc &lt;- createSdcObj(
  dat = testdata2,
  keyVars = c("urbrur", "roof", "walls", "water", "electcon", "relat", "sex"),
  numVars = c("expend", "income", "savings"),
  w = "sampling_weight")
sdc &lt;- rankSwap(sdc)
</code></pre>


</div>