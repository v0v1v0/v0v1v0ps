<div class="container">

<table style="width: 100%;"><tr>
<td>run_SpaCCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run SpaCCI Analysis</h2>

<h3>Description</h3>

<p>This function runs the SpaCCI analysis to infer cell-cell interactions based on ligand-receptor pairs at global, regional, or local spatial scales. It integrates gene expression data, cell type proportions, and spatial coordinates with a user-specified ligand-receptor database.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_SpaCCI(
  gene_spot_expression_dataframe,
  spot_cell_proportion_dataframe,
  spatial_coordinates_dataframe,
  LR_database_list,
  specific_LR_pair = NULL,
  analysis_scale,
  region_spot_IDs = NULL,
  local_scale_proportion = 1,
  neighborhood_radius = 2.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gene_spot_expression_dataframe</code></td>
<td>
<p>A data frame of gene expression values, where row names are genes and column names are spot IDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spot_cell_proportion_dataframe</code></td>
<td>
<p>A data frame of cell type proportions, where row names are spot IDs and column names are cell types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial_coordinates_dataframe</code></td>
<td>
<p>A data frame containing the spatial coordinates of the spots. The columns should include <code>"Spot_ID"</code>, <code>"imagerow"</code>, and <code>"imagecol"</code>. And the row names must be the names of <code>"Spot_ID"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LR_database_list</code></td>
<td>
<p>A list containing ligand-receptor pairs and additional information, generated by functions using <code>`LR_database()`</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specific_LR_pair</code></td>
<td>
<p>Required if <code>analysis_scale</code> is <code>"local"</code>. A vector of ligand-receptor pair names for localized analysis. The names should match those in row names in <code>`LR_database_list$possible_LR_pairs_info`</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysis_scale</code></td>
<td>
<p>A string specifying the scale of analysis: <code>"global"</code>, <code>"regional"</code>, or <code>"local"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region_spot_IDs</code></td>
<td>
<p>Required if <code>analysis_scale</code> is "regional". A vector of spot IDs defining the region for regional analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_scale_proportion</code></td>
<td>
<p>Optional. A numeric value ranging from 0 to 1, (0,1] specifying the proportion of spots to use for localized analysis. Default is <code>1</code>, meaning using <code>100</code>% proportion of spots. One could modified if want to reducing computing time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighborhood_radius</code></td>
<td>
<p>Optional. A numeric value specifying the radius of the neighborhood for localized analysis. Default is <code>2.5</code>, according to the 10X Visium ST data accounting for 200-250 <code class="reqn">\mu</code>m interacting distance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function supports three scales of analysis:
</p>

<dl>
<dt><code>global</code></dt>
<dd>
<p>Analyzes interactions across the entire dataset.</p>
</dd>
<dt><code>regional</code></dt>
<dd>
<p>Analyzes interactions within a specified region of spots. Requires <code>region_spot_IDs</code>.</p>
</dd>
<dt><code>local</code></dt>
<dd>
<p>Analyzes localized hotspot of interactions for specific ligand-receptor pairs on the entire slides. Requires <code>specific_LR_pair</code>.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>If <code>analysis_scale</code> is <code>"local"</code>:</dt>
<dd>
<p>A list containing:
</p>

<dl>
<dt><code>dataframelist</code></dt>
<dd>
<p>A list of data frames, each representing the inferred interactions for a specific center spot. Each data frame includes information on ligand and receptor cell types, P-values, and adjusted P-values.</p>
</dd>
<dt><code>RegionIDs_matrix</code></dt>
<dd>
<p>A list of matrices, each containing the IDs of the spots within the specified radius of each center spot.</p>
</dd>
</dl>
</dd>
<dt>If <code>analysis_scale</code> is <code>"regional"</code> or <code>"global"</code>:</dt>
<dd>
<p>A list containing:
</p>

<dl>
<dt><code>pvalue_df</code></dt>
<dd>
<p>A data frame of inferred interactions within the specified region or globally, including information on ligand and receptor cell types, P-values, and adjusted P-values.</p>
</dd>
</dl>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">library(SpaCCI)
library(nnls)
#Load the example data
data(test_data)
gene_spot_df &lt;- test_data$gene_spot_df
cell_prop_df &lt;- test_data$cell_prop_df
spatial_coords_df &lt;- test_data$spatial_coords_df

result &lt;- LR_database(species = "Human",
                      database_name = "CellChat",
                      gene_spot_expression_dataframe = gene_spot_df)
# global
result_global &lt;- run_SpaCCI(gene_spot_expression_dataframe = gene_spot_df,
                            spot_cell_proportion_dataframe = cell_prop_df,
                            spatial_coordinates_dataframe = spatial_coords_df,
                            LR_database_list = result,
                            analysis_scale = "global")

# local
result_local &lt;- run_SpaCCI(gene_spot_expression_dataframe = gene_spot_df,
                          spot_cell_proportion_dataframe = cell_prop_df,
                          spatial_coordinates_dataframe = spatial_coords_df,
                          LR_database_list = result,
                          specific_LR_pair = "EDN2_EDNRA",
                          analysis_scale = "local",
                          local_scale_proportion = 0.1,
                          neighborhood_radius = 2.5)

</code></pre>


</div>