<div class="container">

<table style="width: 100%;"><tr>
<td>catL2BB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generators for efpFunctionals along Categorical Variables</h2>

<h3>Description</h3>

<p>Generators for <code>efpFunctional</code> objects suitable for aggregating
empirical fluctuation processes to test statistics along (ordinal)
categorical variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">catL2BB(freq)
ordL2BB(freq, nproc = NULL, nrep = 1e5, probs = c(0:84/100, 850:1000/1000), ...)
ordwmax(freq, algorithm = mvtnorm::GenzBretz(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>object specifying the category frequencies for the
categorical variable to be used for aggregation: either a
<code>gefp</code> object, a <code>factor</code>, or a numeric
vector with either absolute or relative category frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>numeric. Number of processes used for simulating
from the asymptotic distribution (passed to <code>efpFunctional</code>).
If <code>feq</code> is a <code>gefp</code> object, then its number of
processes is used by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>numeric. Number of replications used for simulating
from the asymptotic distribution (passed to <code>efpFunctional</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>numeric vector specifying for which probabilities 
critical values should be tabulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>efpFunctional</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>algorithm specification passed to <code>pmvnorm</code>
for computing the asymptotic distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Merkle, Fan, and Zeileis (2014) discuss three functionals that are 
suitable for aggregating empirical fluctuation processes along categorical
variables, especially ordinal variables. The functions <code>catL2BB</code>,
<code>ordL2BB</code>, and <code>ordwmax</code> all require a specification of the
relative frequencies within each category (which can be computed from
various specifications, see arguments). All of them employ
<code>efpFunctional</code> (Zeileis 2006) internally to set up an
object that can be employed with <code>gefp</code> fluctuation
processes.
</p>
<p><code>catL2BB</code> results in a chi-squared test. This is essentially
the LM test counterpart to the likelihood ratio test that assesses
a split into unordered categories.
</p>
<p><code>ordL2BB</code> is the ordinal counterpart to <code>supLM</code>
where aggregation is done along the ordered categories (rather than
continuously). The asymptotic distribution is non-standard and needs
to be simulated for every combination of frequencies and number of
processes. Hence, this is somewhat more time-consuming compared to
the closed-form solution employed in <code>catL2BB</code>. It is also
possible to store the result of <code>ordL2BB</code> in case it needs to
be applied several <code>gefp</code> fluctuation processes.
</p>
<p><code>ordwmax</code> is a weighted double maximum test based on ideas
previously suggested by Hothorn and Zeileis (2008) in the context of
maximally selected statistics. The asymptotic distribution is
(multivariate) normal and computed by means of <code>pmvnorm</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>efpFunctional</code>.
</p>


<h3>References</h3>

<p>Hothorn T., Zeileis A. (2008), Generalized Maximally Selected Statistics.
<em>Biometrics</em>, <b>64</b>, 1263–1269.
</p>
<p>Merkle E.C., Fan J., Zeileis A. (2014), Testing for Measurement Invariance with
Respect to an Ordinal Variable. <em>Psychometrika</em>, <b>79</b>(4), 569–584.
doi:10.1007/S11336-013-9376-7.
</p>
<p>Zeileis A. (2006), Implementing a Class of Structural Change Tests: An
Econometric Computing Approach. <em>Computational Statistics &amp; Data Analysis</em>, 
<b>50</b>, 2987–3008. doi:10.1016/j.csda.2005.07.001.
</p>


<h3>See Also</h3>

<p><code>efpFunctional</code>, <code>gefp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## artificial data
set.seed(1)
d &lt;- data.frame(
  x = runif(200, -1, 1),
  z = factor(rep(1:4, each = 50)),
  err = rnorm(200)
)
d$y &lt;- rep(c(0.5, -0.5), c(150, 50)) * d$x + d$err

## empirical fluctuation process
scus &lt;- gefp(y ~ x, data = d, fit = lm, order.by = ~ z)

## chi-squared-type test (unordered LM-type test)
LMuo &lt;- catL2BB(scus)
plot(scus, functional = LMuo)
sctest(scus, functional = LMuo)

## ordinal maxLM test (with few replications only to save time)
maxLMo &lt;- ordL2BB(scus, nrep = 10000)
plot(scus, functional = maxLMo)
sctest(scus, functional = maxLMo)

## ordinal weighted double maximum test
WDM &lt;- ordwmax(scus)
plot(scus, functional = WDM)
sctest(scus, functional = WDM)
</code></pre>


</div>