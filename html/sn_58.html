<div class="container">

<table style="width: 100%;"><tr>
<td>Qpenalty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalty function for log-likelihood of <code>selm</code> models</h2>

<h3>Description</h3>

<p>Penalty function for the log-likelihood of <code>selm</code> models 
when <code>method="MPLE"</code>. <code>Qpenalty</code> is the default function;
<code>MPpenalty</code> is an example of a user-defined function effectively
corresponding to a prior distributio on <code>alpha</code>. </p>


<h3>Usage</h3>

<pre><code class="language-R">Qpenalty(alpha_etc, nu = NULL, der = 0)

MPpenalty(alpha, der = 0)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha_etc, alpha</code></td>
<td>
<p>in the univariate case, a single value <code>alpha</code>; 
in the multivariate case, a two-component list whose first component is 
the vector <code>alpha</code>, the second one is matrix <code>cov2cor(Omega)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>degrees of freedom, only required if <code>selm</code> is called
with <code>family="ST"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>der</code></td>
<td>
<p>a numeric value in the set <kbd>0,1,2</kbd> which indicates the
required numer of derivatives of the function. In the multivariate case
the function will only be called with <code>der</code> equal to 0 or 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The penalty is a function of <code>alpha</code>, but its expression may
depend on other ingredients, specifically <code>nu</code> and <code>cov2cor(Omega)</code>.
See ‘Details’ of <code>selm</code> for additional information.
</p>
<p>The penalty mechanism allows to introduce a prior distribution <code class="reqn">\pi</code> 
for <code class="reqn">\alpha</code> by setting <code class="reqn">Q=-\log\pi</code>, 
leading to a maximum <em>a posteriori</em> estimate in the stated sense. 
</p>
<p>As a simple illustration of this mechanism, function <code>MPpenalty</code>
implements the ‘matching prior’ distribution for the univariate <abbr><span class="acronym">SN</span></abbr>
distribution studied by Cabras <em>et al.</em> (2012); a brief summary of the
proposal is provided in Section 3.2 of Azzalini and Capitanio (2014). Note
that, besides <code>alpha=+/-Inf</code>, this choice also penalizes <code>alpha=0</code>
with <code>Q=Inf</code>, effectively removing <code>alpha=0</code> from the parameter
space.  
</p>
<p>Starting from the code of function <code>MPpenalty</code>, a user should be able 
to introduce an alternative prior distribution if so desired.
</p>


<h3>Value</h3>

<p>A positive number <code>Q</code> representing the penalty, possibly
with attributes <code>attr(Q, "der1")</code> and <code>attr(Q, "der2")</code>, 
depending onthe input value <code>der</code>.</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>
<p>Cabras, S., Racugno, W., Castellanos, M. E., and Ventura, L. (2012).
A matching prior for the shape parameter of the skew-normal distribution.
<em>Scand. J. Statist.</em> <b>39</b>, 236–247.
</p>


<h3>See Also</h3>

<p><code>selm</code> function</p>


<h3>Examples</h3>

<pre><code class="language-R">data(frontier)
m2 &lt;- selm(frontier ~ 1)  # no penalty
m2a &lt;- selm(frontier ~ 1, method="MPLE") # penalty="Qpenalty" is implied here
m2b &lt;- selm(frontier ~ 1, method="MPLE", penalty="MPpenalty")    
</code></pre>


</div>