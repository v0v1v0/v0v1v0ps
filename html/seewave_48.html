<div class="container">

<table style="width: 100%;"><tr>
<td>env</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Amplitude envelope of a time wave</h2>

<h3>Description</h3>

<p>This function returns the absolute or Hilbert
amplitude envelope of a time wave.</p>


<h3>Usage</h3>

<pre><code class="language-R">env(wave, f, channel = 1, envt = "hil", 
msmooth = NULL, ksmooth = NULL, ssmooth = NULL,
asmooth = NULL,
fftw = FALSE, norm = FALSE,
plot = TRUE, k = 1, j = 1, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envt</code></td>
<td>
<p>the type of envelope to be returned: either "abs" for absolute
amplitude envelope or "hil" for Hilbert amplitude envelope. See Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msmooth</code></td>
<td>
<p>a vector of length 2 to smooth the amplitude envelope with a 
mean sliding window. The first component is the window length
(in number of points). The second component is the overlap between
successive windows (in %). See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksmooth</code></td>
<td>
<p>kernel smooth via <code>kernel</code>. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssmooth</code></td>
<td>
<p>length of the sliding window used for a sum smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asmooth</code></td>
<td>
<p>length of the sliding window used for an autocorrelation smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code> for faster computation for the Hilbert amplitude
envelope (<code>envt="hil"</code>) and/or for kernell smoothing
(<code>ksmooth</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>a logical, if <code>TRUE</code> the amplitude of the envelope
is normalised between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> returns a plot
of <code>wave</code> envelope (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of horizontal sections when <code>plot</code> is <code>TRUE</code>
(by default =1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>number of vertical sections when <code>plot</code> is <code>TRUE</code>
(by default =1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>oscillo</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>envt</code> is set as "abs", the amplitude envelope returned
is the absolute value of <code>wave</code>.<br>
When <code>envt</code> is set as "hil", the amplitude envelope returned is the modulus
(<code>Mod</code>) of the analytical signal of <code>wave</code>
obtained through the Hilbert transform (<code>hilbert</code>).
</p>


<h3>Value</h3>

<p>Data are returned as one-column matrix when <code>plot</code> is <code>FALSE</code>.</p>


<h3>Note</h3>

<p>Be aware that smoothing with either <code>msmooth</code> or <code>ksmooth</code>
changes the original number of points describing <code>wave</code>.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur. Implementation of 'fftw' argument by Jean Marchal
and Francois Fabianek. Implementation of 'asmooth' by Thibaut Marin-Cudraz.</p>


<h3>See Also</h3>

<p><code>oscillo</code>,<code>hilbert</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico)
# Hilbert amplitude envelope
env(tico)
# absolute amplitude envelope
env(tico, envt="abs")
# smoothing with a 10 points and 50% overlaping mean sliding window
env(tico, msmooth=c(10,50))
# smoothing kernel
env(tico, ksmooth=kernel("daniell",10))
# sum smooth
env(tico, ssmooth=50)
# autocorrelation smooth
env(tico, asmooth=50)
# overplot of oscillographic and envelope representations
oscillo(tico)
par(new=TRUE)
env(tico, colwave=2)
</code></pre>


</div>