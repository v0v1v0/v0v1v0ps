<div class="container">

<table style="width: 100%;"><tr>
<td>sample_index</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample the biomass with observation error</h2>

<h3>Description</h3>

<p>This function creates an index of abundance sampled from the expected
available biomass for given fleets in given years. Let <code>B_y</code> be the biomass
from the operating model for year y. Then the sampled value is calculated as:
<code>B_y*exp(rnorm(1, 0, sds_obs)-sds_obs^2/2)</code>. The second term
adjusts the random samples so that their expected value is <code>B_y</code> (i.e. the
log-normal bias correction).
If used with <code>run_ss3sim</code> the case file should be named
<code>index</code>. A suggested (default) case letter is <code>D</code> for data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_index(dat_list, outfile = NULL, fleets, years, sds_obs,
  make_plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code>SS_readdat</code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sds_obs</code></td>
<td>
<p>*A list the same length as <code>fleets</code>. The list should
contain either single values or numeric vectors of the same length as the
number of years which represent the standard deviation of the observation
error. Single values are repeated for all years.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make_plot</code></td>
<td>
<p>A logical switch for whether to make a crude plot showing
the results. Useful for testing and exploring the function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code>run_ss3sim</code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Kotaro Ono
</p>


<h3>See Also</h3>

<p>Other sampling functions: <code>clean_data</code>,
<code>sample_agecomp</code>,
<code>sample_calcomp</code>, <code>sample_lcomp</code>,
<code>sample_mlacomp</code>,
<code>sample_wtatage</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Find the example data location:
d &lt;- system.file("extdata", package = "ss3sim")
f_in &lt;- file.path(d, "example-om", "ss3_expected_values.dat")
dat_list &lt;- r4ss::SS_readdat(f_in, version = NULL, verbose = FALSE)
# Note the initial expected values for the index data:
dat_list$CPUE # Only has expected values for fleet 2 in every other year from
# 76 to 100, so can only sample from fleet 2 during every other year between
# 76 and 100
sam_yrs &lt;- seq(76, 100, by = 2)
ex1 &lt;- sample_index(dat_list,
                   outfile = NULL,
                   fleets = 2,
                   years = list(sam_yrs),
                   sds_obs=list(seq(.001, .1,
                     length.out = length(sam_yrs))))
ex1$CPUE
# could sample from less years, but not more:
ex2 &lt;- sample_index(dat_list,
                    outfile = NULL,
                    fleets = 2,
                    years = list(sam_yrs[c(-1, -2)]),
                    sds_obs=list(seq(.001, .1,
                      length.out = length(sam_yrs[c(-1, -2)]))))
ex2$CPUE
# Also, sd can be fixed across years:
ex3 &lt;- sample_index(dat_list,
                    outfile = NULL,
                    fleets = 2,
                    years = list(sam_yrs),
                    sds_obs=list(0.01))
ex3$CPUE
# If fleet 1 also had expected values in the index that you wanted to sample:
# ex4 &lt;- sample_index(dat_list,
#                     outfile = NULL,
#                     fleets = c(1,2),
#                     years = list(sam_yrs, sam_yrs),
#                     sds_obs=list(0.01, 0.01))

## End(Not run)
</code></pre>


</div>