<div class="container">

<table style="width: 100%;"><tr>
<td>emp_orth_fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes empirical orthogonal functions using a dataframe or a stars object.</h2>

<h3>Description</h3>

<p>Computes empirical orthogonal functions of the data. Function autoplot can plot the output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">emp_orth_fun(x, ...)

## S3 method for class 'data.frame'
emp_orth_fun(x, values_df, ...)

## S3 method for class 'stars'
emp_orth_fun(x, ...)

## S3 method for class 'emporthfun'
autoplot(
  object,
  EOF_num = 1,
  palette = "Spectral",
  only_EOF = FALSE,
  only_TS = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The dataframe or stars object. If it is a dataframe, then it should have the locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments currently ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values_df</code></td>
<td>
<p>For dataframes: the dataframe of dimension <code>length(times) x length(locations)</code> containing the quantity of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>For autoplot: the output of the function ‘emp_orth_fun’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EOF_num</code></td>
<td>
<p>For autoplot: the number of Empirical Orthogonal Functions (EOFs) to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>The color palette. Default is <code>Spectral</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_EOF</code></td>
<td>
<p>For autoplot: if <code>TRUE</code>, only the spatial EOF function would be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_TS</code></td>
<td>
<p>For autoplot: if <code>TRUE</code>, only the PC time series would be plotted. If both are set to <code>FALSE</code>,
both plots would be displayed. Both cannot be set to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An emporthfun object with temporal PCs and spatial EOFs.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># dataframe example
data(SSTlonlatshort)
data(SSTdatashort)
data(SSTlandmaskshort)
delete_rows &lt;- which(SSTlandmaskshort  ==  1)
SSTdatashort   &lt;- SSTdatashort[-delete_rows, 1:396]
emp1 &lt;- emp_orth_fun(SSTlonlatshort[-delete_rows,  ],
                     SSTdatashort)
autoplot(emp1,
         EOF_num = 1)


# stars example
library(dplyr)
library(stars)
# Create a stars object from a data frame
precip_df &lt;- NOAA_df_1990[NOAA_df_1990$proc == 'Precip', ] %&gt;%
  filter(date &gt;= "1992-02-01" &amp; date &lt;= "1992-02-05")
precip &lt;- precip_df[ ,c('lat', 'lon', 'date', 'z')]
st_precip &lt;- st_as_stars(precip, dims = c("lon", "lat", "date"))
emp &lt;- emp_orth_fun(st_precip)
autoplot(emp, only_TS = TRUE)

</code></pre>


</div>