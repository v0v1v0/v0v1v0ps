<div class="container">

<table style="width: 100%;"><tr>
<td>stepfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitted step function</h2>

<h3>Description</h3>

<p>Constructs an object containing a step function fitted to some data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepfit(cost, family, value, param = NULL, leftEnd, rightEnd, x0,
  leftIndex = leftEnd, rightIndex = rightEnd)
## S3 method for class 'stepfit'
x[i, j, drop = if(missing(i)) TRUE else
  if(missing(j)) FALSE else length(j) == 1, refit = FALSE] 
## S3 method for class 'stepfit'
print(x, ...)
## S3 method for class 'stepfit'
plot(x, dataspace = TRUE, ...)
## S3 method for class 'stepfit'
lines(x, dataspace = TRUE, ...)
## S3 method for class 'stepfit'
fitted(object, ...)
## S3 method for class 'stepfit'
residuals(object, y, ...)
## S3 method for class 'stepfit'
logLik(object, df = NULL, nobs = object$rightIndex[nrow(object)], ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>the value of the cost-functional used for the fit: RSS for family <code>gauss</code>, log-likelihood (up to a constant) for families <code>poisson</code> and <code>binomial</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>distribution of the errors, either <code>"gauss"</code>, <code>"poisson"</code> or <code>"binomial"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a numeric vector containing the fitted values for each block; its length gives the number of blocks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>additional paramters specifying the distribution of the errors, the number of trials for family <code>"binomial"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftEnd</code></td>
<td>
<p>a numeric vector of the same length as <code>value</code> containing the left end of each block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightEnd</code></td>
<td>
<p>a numeric vector of the same length as <code>value</code> containing the left end of each block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a single numeric giving the last unobserved sample point directly before sampling started, i.e. before <code>leftEnd[0]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftIndex</code></td>
<td>
<p>a numeric vector of the same length as <code>value</code> containing the index of the sample points corresponding to the block's left end, cf. <code>stepcand</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightIndex</code></td>
<td>
<p>a numeric vector of the same length as <code>value</code> containing the index of the sample points corresponding to the block's right end, cf. <code>stepcand</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector containing the data with which to compare the fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the number of estimated parameters: by default the number of blocks for families <code>poisson</code> and <code>binomial</code>, one more (for the variance) for family <code>gauss</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of observations used for estimating</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for generic methods only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i,j,drop</code></td>
<td>
<p>see <code>"[.data.frame"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p><code>logical</code>; determines whether the function will be refitted after subselection, i.e. whether the selection should be interpreted as a fit with fewer jumps); in that case, for <code>family = "gaussKern"</code>, <code>refit</code> needs to be set to the original data, i.e. <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataspace</code></td>
<td>
<p><code>logical</code> determining whether the expected value should be plotted instead of the fitted parameter value, useful e.g. for <code>family = "binomial"</code>, where it will plot the fitted success probability times the number of trials per observation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stepfit</code></td>
<td>
<p>an object of class <code>stepfit</code> which extends <code>stepblock</code>, additionally containing <code>attr</code>ibutes <code>cost</code>, <code>family</code> and <code>param</code>, as well as columns <code>leftIndex</code> and <code>rightIndex</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>[.stepfit</code></td>
<td>
<p>an object of class <code>stepfit</code> which contains the selected subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.stepfit</code></td>
<td>
<p>a numeric vector of length <code>rightIndex[length(rightIndex)]</code> giving the fit at the original sample points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.stepfit</code></td>
<td>
<p>a numeric vector of length <code>rightIndex[length(rightIndex)]</code> giving the residuals at the original sample points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik.stepfit</code></td>
<td>
<p>an object of class <code>logLik</code> giving the likelihood of the data given this fit, e.g. for use with <code>AIC</code> and <code>stepsel</code>; this will (incorrectly) treat <code>family = "gaussKern"</code> as if it were fitted with <code>family = "gauss"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.stepfit, plot.stepfit</code></td>
<td>
<p>the corresponding functions for <code>stepblock</code> are called</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>stepblock</code>, <code>stepbound</code>, <code>steppath</code>, <code>stepsel</code>, family, <code>"[.data.frame"</code>, <code>fitted</code>, <code>residuals</code>, <code>logLik</code>, <code>AIC</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 5 blocks (4 jumps) within a total of 100 data points
b &lt;- c(sort(sample(1:99, 4)), 100)
p &lt;- rep(runif(5), c(b[1], diff(b))) # success probabilities
# binomial observations, each with 10 trials
y &lt;- rbinom(100, 10, p)
# find solution with 5 blocks
fit &lt;- steppath(y, family = "binomial", param = 10)[[5]]
plot(y, ylim = c(0, 10))
lines(fit, col = "red")
# residual diagnostics for Gaussian data
yg &lt;- rnorm(100, qnorm(p), 1)
fitg &lt;- steppath(yg)[[5]]
plot(yg, ylim = c(0, 10))
lines(fitg, col = "red")
plot(resid(fitg, yg))
qqnorm(resid(fitg, yg))
</code></pre>


</div>