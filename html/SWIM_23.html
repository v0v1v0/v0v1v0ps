<div class="container">

<table style="width: 100%;"><tr>
<td>sensitivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivities of a Stressed Model</h2>

<h3>Description</h3>

<p>Provides different sensitivity measures that compare the stressed
and the baseline model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sensitivity(
  object,
  xCol = "all",
  wCol = "all",
  type = c("Gamma", "Kolmogorov", "Wasserstein", "reverse", "all"),
  f = NULL,
  k = NULL,
  s = NULL,
  p = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>SWIM</code> or <code>SWIMw</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xCol</code></td>
<td>
<p>Numeric or character vector, (names of) the columns
of the underlying data of the <code>object</code>
(<code>default = "all"</code>). If <code>xCol = NULL</code>, only
the transformed data <code>f(x)</code> is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wCol</code></td>
<td>
<p>Vector, the columns of the scenario weights 
of the <code>object</code> corresponding to different 
stresses (<code>default = "all"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character, one of <code>"Gamma", "Kolmogorov",
"Wasserstein", "reverse", "all"</code> (<code>default = "all"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A function, or list of functions, that, applied to
<code>x</code>, constitute the transformation of the data
for which the sensitivity is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A vector or list of vectors, same length as <code>f</code>,
indicating which columns of <code>x</code> each function
in <code>f</code> operates on.<br>
When <code>f</code> is a list, <code>k[[i]]</code> corresponds
to the input variables of <code>f[[i]]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A function that, applied to <code>x</code>, defines the reverse
sensitivity measure. If <code>type = "reverse"</code> and 
<code>s = NULL</code>, defaults to <code>type = "Gamma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Numeric vector, the p-th moment of Wasserstein distance (<code>default = 1</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Provides sensitivity measures that compare the stressed and
the baseline model. Implemented sensitivity measures:
</p>

<ol>
<li>
<p><code>Gamma</code>, the <em>Reverse Sensitivity Measure</em>, defined
for a random variable <code>Y</code> and scenario weights <code>w</code> by
</p>
<p style="text-align: center;"><code class="reqn">Gamma = ( E(Y * w) - E(Y) ) / c,</code>
</p>

<p>where <code>c</code> is a normalisation constant such that
<code>|Gamma| &lt;= 1</code>, see
(Pesenti et al. 2019). Loosely speaking, the
Reverse Sensitivity Measure is the normalised difference
between the first moment of the stressed and the baseline
distributions of <code>Y</code>.
</p>
</li>
<li>
<p><code>Kolmogorov</code>, the Kolmogorov distance, defined for
distribution functions <code>F,G</code> by
</p>
<p style="text-align: center;"><code class="reqn">Kolmogorov = sup |F(x) - G(x)|.</code>
</p>

</li>
<li>
<p><code>Wasserstein</code>, the Wasserstein distance of order 1, defined
for two distribution functions <code>F,G</code> by
</p>
<p style="text-align: center;"><code class="reqn">Wasserstein = \int |F(x) - G(x)| dx.</code>
</p>

</li>
<li>
<p><code>reverse</code>, the <em>General Reverse Sensitivity Measure</em>, defined
for a random variable <code>Y</code>, scenario weights <code>w</code>, and a function
<code>s:R -&gt; R</code> by </p>
<p style="text-align: center;"><code class="reqn">epsilon = ( E(s(Y) * w) - E(s(Y)) ) / c,</code>
</p>

<p>where <code>c</code> is a normalisation constant such that
<code>|epsilon| &lt;= 1</code>. <code>Gamma</code> is a special instance of
the reverse sensitivity measure when <code>s</code> is the identity function.
</p>
</li>
</ol>
<p>If <code>f</code> and <code>k</code> are provided, the sensitivity of the
transformed data is returned.
</p>


<h3>Value</h3>

<p>A data.frame containing the sensitivity measures of the
stressed model with rows corresponding to different random
variables. The first two rows specify the <code>stress</code> and
<code>type</code> of the sensitivity measure.
</p>


<h3>Author(s)</h3>

<p>Silvana M. Pesenti, Zhuomin Mao
</p>


<h3>References</h3>

<p>Pesenti SM, Millossovich P, Tsanakas A (2019).
“Reverse sensitivity testing: What does it take to break the model?”
<em>European Journal of Operational Research</em>, <b>274</b>(2), 654–670.
</p>


<h3>See Also</h3>

<p>See <code>importance_rank</code> for ranking of random
variables according to their sensitivities,
<code>plot_sensitivity</code> for plotting
sensitivity measures and <code>summary</code> for
summary statistics of a stressed model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example with a stress on VaR
set.seed(0)
x &lt;- as.data.frame(cbind(
  "log-normal" = rlnorm(1000),
  "gamma" = rgamma(1000, shape = 2)))
res1 &lt;- stress(type = "VaR", x = x,
  alpha = c(0.9, 0.95), q_ratio = 1.05)

sensitivity(res1, wCol = 1, type = "all")
## sensitivity of log-transformed data
sensitivity(res1, wCol = 1, type = "all",
  f = list(function(x)log(x), function(x)log(x)), k = list(1,2))

## Consider the portfolio Y = X1 + X2 + X3 + X4 + X5,
## where (X1, X2, X3, X4, X5) are correlated normally
## distributed with equal mean and different standard deviations,
## see the README for further details.


## Not run: 
set.seed(0)
SD &lt;- c(70, 45, 50, 60, 75)
Corr &lt;- matrix(rep(0.5, 5 ^ 2), nrow = 5) + diag(rep(1 - 0.5, 5))
if (!requireNamespace("mvtnorm", quietly = TRUE))
   stop("Package \"mvtnorm\" needed for this function
   to work. Please install it.")
x &lt;- mvtnorm::rmvnorm(10 ^ 5,
   mean =  rep(100, 5),
   sigma = (SD %*% t(SD)) * Corr)
data &lt;- data.frame(rowSums(x), x)
names(data) &lt;- c("Y", "X1", "X2", "X3", "X4", "X5")
rev.stress &lt;- stress(type = "VaR", x = data,
   alpha = c(0.75, 0.9), q_ratio = 1.1, k = 1)

sensitivity(rev.stress, type = "all")
## sensitivity to sub-portfolios X1 + X2 and X3 + X4
sensitivity(rev.stress, xCol = NULL, type = "Gamma",
  f = rep(list(function(x)x[1] + x[2]), 2), k = list(c(2, 3), c(4, 5)))
plot_sensitivity(rev.stress, xCol = 2:6, type = "Gamma")
importance_rank(rev.stress, xCol = 2:6, type = "Gamma")

## End(Not run)

</code></pre>


</div>