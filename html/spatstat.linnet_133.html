<div class="container">

<table style="width: 100%;"><tr>
<td>lineardisc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute Disc of Given Radius in Linear Network
</h2>

<h3>Description</h3>

<p>Computes the ‘disc’ of given radius and centre
in a linear network.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  lineardisc(L, x = locator(1), r, plotit = TRUE,
             cols=c("blue", "red","green"), add=TRUE)

  lineardisclength(L, x = locator(1), r)

  countends(L, x = locator(1), r, toler=NULL, internal=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>

<p>Linear network (object of class <code>"linnet"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Location of centre of disc.
Either a point pattern (object of class <code>"ppp"</code>)
containing exactly 1 point, or a numeric vector of length 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>Radius of disc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>

<p>Logical. Whether to plot the disc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>Logical. If <code>add=TRUE</code> (the default),
the disc will be plotted on the current plot frame.
If <code>add=FALSE</code>, a new plot frame will be started,
the entire network will be displayed, and then
the disc will be plotted over this.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>

<p>Colours for plotting the disc. A numeric or character vector of
length 3 specifying the colours of the disc centre, disc lines and
disc endpoints respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>

<p>Optional. Distance threshold for <code>countends</code>. See Details.
There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>Argument for internal use by the package.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ‘disc’ <code class="reqn">B(u,r)</code> of centre <code class="reqn">x</code> and radius <code class="reqn">r</code>
in a linear network <code class="reqn">L</code> is the set of all points
<code class="reqn">u</code> in <code class="reqn">L</code> such that the shortest path distance from <code class="reqn">x</code>
to <code class="reqn">u</code> is less than or equal to <code class="reqn">r</code>. This is a union of line
segments contained in <code class="reqn">L</code>.
</p>
<p>The <em>relative boundary</em> of the disc <code class="reqn">B(u,r)</code>
is the set of points <code class="reqn">v</code> such that the shortest path distance from
<code class="reqn">x</code> to <code class="reqn">u</code> is <em>equal</em> to <code class="reqn">r</code>.
</p>
<p>The function <code>lineardisc</code> computes the
disc of radius <code class="reqn">r</code> and its relative boundary,
optionally plots them, and returns them.
The faster function <code>lineardisclength</code> computes only the total
length of the disc, and <code>countends</code> computes only the number of
endpoints of the disc.
</p>
<p>Note that <code>countends</code> requires the linear network <code>L</code>
to be given in the non-sparse matrix format (see the argument
<code>sparse</code> in <code>linnet</code> or <code>as.linnet</code>)
while <code>lineardisc</code> and <code>lineardisclength</code> accept
both sparse and non-sparse formats.
</p>
<p>The optional threshold <code>toler</code> is used to suppress numerical
errors in <code>countends</code>.
If the distance from <code class="reqn">u</code> to a network vertex <code class="reqn">v</code>
is between <code>r-toler</code> and <code>r+toler</code>, the vertex
will be treated as lying on the relative boundary.    
</p>


<h3>Value</h3>

<p>The value of <code>lineardisc</code> is a list with two entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lines </code></td>
<td>
<p>Line segment pattern (object of class <code>"psp"</code>)
representing the interior disc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endpoints</code></td>
<td>
<p>Point pattern (object of class <code>"ppp"</code>)
representing the relative boundary of the disc.
</p>
</td>
</tr>
</table>
<p>The value of <code>lineardisclength</code> is a single number
giving the total length of the disc.
</p>
<p>The value of <code>countends</code> is an integer giving the number of
points in the relative boundary.
</p>


<h3>Author(s)</h3>

<p>Ang Qi Wei <a href="mailto:aqw07398@hotmail.com">aqw07398@hotmail.com</a> and
Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>References</h3>

<p>Ang, Q.W. (2010)
<em>Statistical methodology for events on a network</em>.
Master's thesis, School of Mathematics and Statistics, University of
Western Australia.
</p>
<p>Ang, Q.W., Baddeley, A. and Nair, G. (2012)
Geometrically corrected second-order analysis of 
events on a linear network, with applications to
ecology and criminology.
<em>Scandinavian Journal of Statistics</em> <b>39</b>, 591–617.
</p>


<h3>See Also</h3>

<p><code>linnet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    # letter 'A' 
    v &lt;- ppp(x=(-2):2, y=3*c(0,1,2,1,0), c(-3,3), c(-1,7))
    edg &lt;- cbind(1:4, 2:5)
    edg &lt;- rbind(edg, c(2,4))
    letterA &lt;- linnet(v, edges=edg)
    plot(letterA)

   di &lt;- lineardisc(letterA, c(0,3), 1.6)
   di

   # count the endpoints more efficiently
   countends(letterA, c(0,3), 1.6)
   # cross-check 
   npoints(di$endpoints)

   # measure the length more efficiently
   lineardisclength(letterA, c(0,3), 1.6)
   # cross-check
   sum(lengths_psp(di$lines))
</code></pre>


</div>