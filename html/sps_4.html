<div class="container">

<table style="width: 100%;"><tr>
<td>inclusion_prob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate inclusion probabilities</h2>

<h3>Description</h3>

<p>Calculate stratified (first-order) inclusion probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inclusion_prob(x, n, strata = gl(1, length(x)), alpha = 0.001, cutoff = Inf)

becomes_ta(x, alpha = 0.001, cutoff = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A positive and finite numeric vector of sizes for units in the
population (e.g., revenue for drawing a sample of businesses).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer vector giving the sample size for each stratum,
ordered according to the levels of <code>strata</code>. A single value is recycled
for all strata. Non-integers are truncated towards 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>A factor, or something that can be coerced into one, giving
the strata associated with units in the population. The default is to place
all units into a single stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric vector with values between 0 and 1 for each stratum,
ordered according to the levels of <code>strata</code>. Units with inclusion
probabilities greater than or equal to 1 - <code>alpha</code> are set to 1 for
each stratum. A single value is recycled for all strata. The default is
slightly larger than 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>A positive numeric vector of cutoffs for each stratum, ordered
according to the levels of <code>strata</code>. Units with <code>x &gt;= cutoff</code> get
an inclusion probability of 1 for each stratum. A single value is recycled
for all strata. The default does not apply a cutoff.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Within a stratum, the inclusion probability for a unit is given by
<code class="reqn">\pi = nx / \sum x</code>. These values can be greater
than 1 in practice, and so they are constructed iteratively by taking units
with <code class="reqn">\pi \geq 1 - \alpha</code> (from largest to smallest)
and assigning these units an inclusion probability of 1, with the remaining
inclusion probabilities recalculated at each step. If <code class="reqn">\alpha &gt; 0</code>, then
any ties among units with the same size are broken by their position.
</p>
<p>The <code>becomes_ta()</code> function reverses this operations and finds the critical
sample size at which a unit enters the take-all stratum. This value is
undefined for units that are always included in the sample (because their
size exceeds <code>cutoff</code>) or never included.
</p>


<h3>Value</h3>

<p><code>inclusion_prob()</code> returns a numeric vector of inclusion probabilities for
each unit in the population.
</p>
<p><code>becomes_ta()</code> returns an integer vector giving the sample size at which a
unit enters the take-all stratum.
</p>


<h3>See Also</h3>

<p><code>sps()</code> for drawing a sequential Poisson sample.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make inclusion probabilities for a population with units
# of different size
x &lt;- c(1:10, 100)
(pi &lt;- inclusion_prob(x, 5))

# The last unit is sufficiently large to be included in all
# samples with two or more units
becomes_ta(x)

# Use the inclusion probabilities to calculate the variance of the
# sample size for Poisson sampling
sum(pi * (1 - pi))

</code></pre>


</div>