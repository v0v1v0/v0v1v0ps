<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.tesmi1.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tensor product smoothing constructor for a bivariate function monotone increasing
in the first covariate
</h2>

<h3>Description</h3>

<p>This is a special method function
for creating tensor product bivariate smooths monotone increasing in the first covariate which is built by 
the <code>mgcv</code> constructor function for smooth terms, <code>smooth.construct</code>. 
It is constructed from a pair of single penalty
marginal smooths. This tensor product is specified by model terms such as <code>s(x1,x2,k=c(q1,q2),bs="tesmi1",m=2)</code>.
The basis for the second marginal smooth can be specified as a two letter character string  of the argument <code>xt</code> (eg <code>xt="cc"</code> to specify cyclic cubic regression spline). See example below. The default basis for the second marginal smooth is P-spline. Cyclic cubic regression spline (<code>"cc"</code>) is implemented in addition to the P-spline. See an example below on how to call for it. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tesmi1.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A smooth specification object, generated by an <code>s</code> term in a GAM formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or list containing the values of the elements of <code>object$term</code>,
with names given by <code>object$term</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing the knots corresponding to <code>object$term</code>. 
If it is <code>NULL</code> then the knot locations are generated automatically.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"tesmi1.smooth"</code>. In addition to the usual 
elements of a smooth class documented under <code>smooth.construct</code> of the <code>mgcv</code> library, 
this object contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.ident</code></td>
<td>
<p>A vector of 0's and 1's for model parameter identification: 
1's indicate parameters which will be exponentiated, 0's - otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zc</code></td>
<td>
<p>A matrix of identifiability constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin.bs</code></td>
<td>
<p>A two letter character string indicating the (penalized) smoothing basis to use for the second unconstrained marginal smooth. (eg <code>"cc"</code> for cyclic cubic regression spline).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>


<h3>See Also</h3>

<p><code>smooth.construct.tesmi2.smooth.spec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
## tensor product `tesmi1' example... 
  ## simulating data...
   require(scam)
   set.seed(2)
   n &lt;- 30
   x1 &lt;- sort(runif(n)*4-1)
   x2 &lt;- sort(runif(n))
   f &lt;- matrix(0,n,n)
   for (i in 1:n) for (j in 1:n) 
        f[i,j] &lt;- exp(4*x1[i])/(1+exp(4*x1[i]))+2*sin(pi*x2[j])
   f &lt;- as.vector(t(f))
   y &lt;- f+rnorm(length(f))*.3
   x11 &lt;-  matrix(0,n,n)
   x11[,1:n] &lt;- x1
   x11 &lt;- as.vector(t(x11))
   x22 &lt;- rep(x2,n)
   dat &lt;- list(x1=x11,x2=x22,y=y)
## fit model ...
   b &lt;- scam(y~s(x1,x2,bs="tesmi1",k=c(10,10)), data=dat)
## plot results ...
   old.par&lt;- par(mfrow=c(2,2))
   plot(b,se=TRUE)
   plot(b,pers=TRUE,theta = 30, phi = 40)
   plot(y,b$fitted.values,xlab="Simulated data",ylab="Fitted data")
   par(old.par)
   vis.scam(b,theta=40,phi=20)

## example with cyclic cubic regression spline along the second covariate...
   set.seed(2)
   n &lt;- 30
   x1 &lt;- sort(runif(n)*4-1)
   x2 &lt;- sort(runif(n))
   f &lt;- matrix(0,n,n)
   for (i in 1:n) for (j in 1:n) 
        f[i,j] &lt;- exp(4*x1[i])/(1+exp(4*x1[i]))+sin(2*pi*x2[j])
   f &lt;- as.vector(t(f))
   y &lt;- f+rnorm(length(f))*.2
   x11 &lt;-  matrix(0,n,n)
   x11[,1:n] &lt;- x1
   x11 &lt;- as.vector(t(x11))
   x22 &lt;- rep(x2,n)
   dat &lt;- list(x1=x11,x2=x22,y=y)
## fit model ...
   b1 &lt;- scam(y~s(x1,x2,bs="tesmi1",xt=list("cc"),k=10), data=dat)
## plot results ...
   old.par&lt;- par(mfrow=c(2,2))
   plot(b1,se=TRUE)
   plot(b1,pers=TRUE,theta = 30, phi = 40)
   plot(y,b1$fitted.values,xlab="Simulated data",ylab="Fitted data")
   par(old.par)
   vis.scam(b1,theta=40,phi=20)

 
## End(Not run)
</code></pre>


</div>