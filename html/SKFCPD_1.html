<div class="container">

<table style="width: 100%;"><tr>
<td>SKFCPD-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Dynamic Linear Model for Online Changepoint Detection
</h2>

<h3>Description</h3>

<p>The 'SKFCPD' package provides estimation of changepoint locations using the Dynamic Linear Model (DLM) within the Bayesian Online Changepoint Detection (BOCPD) framework. The efficient computation is achieved through implementation of the Sequential Kalman filter. The range parameter and noise-to-signal ratio are estimated from training samples via a Gaussian process model. This package is capable of handling multidimensional data with temporal correlations and random missing patterns.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> SKFCPD</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Fast Online Changepoint Detection for Temporally Correlated Data</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 0.2.4</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-02-15</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(person(given="Hanmo",family="Li",role=c("aut", "cre"),
    email="hanmo@pstat.ucsb.edu"), 
    person(given="Yuedong",family="Wang", role=c("aut"),
    email="yuedong@pstat.ucsb.edu"),
    person(given="Mengyang",family="Gu", role=c("aut"),
    email="mengyang@pstat.ucsb.edu"))</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Hanmo Li &lt;hanmo@pstat.ucsb.edu&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Hanmo Li [aut, cre],
  Yuedong Wang [aut],
  Mengyang Gu [aut]</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Sequential Kalman filter for scalable online changepoint detection by temporally correlated data. It enables fast single and multiple change points with missing values. See the reference: Hanmo Li, Yuedong Wang, Mengyang Gu (2023), &lt;arXiv:2310.18611&gt;.</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.5.0), methods (&gt;= 4.2.2), rlang (&gt;= 1.0.6), ggplot2
(&gt;= 3.4.0), ggpubr (&gt;= 0.5.0), reshape2 (&gt;= 1.4.4), FastGaSP
(&gt;= 0.5.2)</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> Rcpp (&gt;= 1.0.9)</td>
</tr>
<tr>
<td style="text-align: left;">
LinkingTo: </td>
<td style="text-align: left;"> Rcpp, RcppEigen</td>
</tr>
<tr>
<td style="text-align: left;">
NeedsCompilation: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
Encoding: </td>
<td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
<td style="text-align: left;">
Packaged: </td>
<td style="text-align: left;"> 2024-02-15 11:15:56 UTC; lihan</td>
</tr>
<tr>
<td style="text-align: left;">
Archs: </td>
<td style="text-align: left;"> x64</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
Estimate_GP_params      Estimate parameters from fast computation of
                        GaSP model
SKFCPD                  Getting the results of the SKFCPD model
SKFCPD-class            Class '"SKFCPD"'
SKFCPD-package          Dynamic Linear Model for Online Changepoint
                        Detection
plot_SKFCPD             Plot for SKFCPD model
</pre>
<p>Implements a fast online changepoint detection algorithm using dynamic linear model based on Sequential Kalman filter. It's for temporally correlated data and accepts multi-dimensional datasets with missing values.
</p>


<h3>Author(s)</h3>

<p>Hanmo Li [aut, cre],
  Yuedong Wang [aut],
  Mengyang Gu [aut]
</p>
<p>Maintainer: Hanmo Li &lt;hanmo@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>Li, Hanmo, Yuedong Wang, and Mengyang Gu. <em>Sequential Kalman filter for fast online changepoint detection in longitudinal health records.</em> arXiv preprint arXiv:2310.18611 (2023).
</p>
<p>Fearnhead, Paul, and Zhen Liu. <em>On-line inference for multiple changepoint problems.</em> Journal of the Royal Statistical Society Series B: Statistical Methodology 69, no. 4 (2007): 589-605.
</p>
<p>Adams, Ryan Prescott, and David JC MacKay. <em>Bayesian online changepoint detection.</em> arXiv preprint arXiv:0710.3742 (2007).
</p>
<p>Hartikainen, Jouni, and Simo Sarkka. <em>Kalman filtering and smoothing solutions to temporal Gaussian process regression models.</em> In 2010 IEEE international workshop on machine learning for signal processing, pp. 379-384. IEEE, 2010.
</p>
<p>Gu, Mengyang, and Yanxun Xu. <em>Fast nonseparable Gaussian stochastic process with application to methylation level interpolation.</em> Journal of Computational and Graphical Statistics 29, no. 2 (2020): 250-260.
</p>
<p>Gu, Mengyang, and Weining Shen. <em>Generalized probabilistic principal component analysis of correlated data.</em> The Journal of Machine Learning Research 21, no. 1 (2020): 428-468.
</p>
<p>Gu, Mengyang, Xiaojing Wang, and James O. Berger. <em>Robust Gaussian stochastic process emulation.</em> The Annals of Statistics 46, no. 6A (2018): 3038-3066.
</p>


<h3>See Also</h3>

<p><code>SKFCPD</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  library(SKFCPD)
  
  #------------------------------------------------------------------------------
  # Example: fast online changepoint detection with DEPENDENT data.
  # 
  # Data generation: Data follows a multidimensional Gaussian process with Matern 2.5 kernel.
  #------------------------------------------------------------------------------
  # Data Generation
  set.seed(1)
  
  n_obs = 150
  n_dim = 2
  seg_len = c(70, 30, 20,30)
  mean_each_seg = c(0,1,-1,0)
  
  x_mat=matrix(1:n_obs)
  y_mat=matrix(NA, nrow=n_obs, ncol=n_dim)
  
  gamma = rep(5, n_dim) # range parameter of the covariance matrix
  
  # compute the matern 2.5 kernel
  construct_cor_matrix = function(input, gamma){
    n = length(input)
    R0=abs(outer(input,(input),'-'))
    matrix_one = matrix(1, n, n)
    const = sqrt(5) * R0 / gamma
    Sigma = (matrix_one + const + const^2/3) * (exp(-const))
    return(Sigma)
  }
  
  for(j in 1:n_dim){
    y_each_dim = c()
    for(i in 1:length(seg_len)){
      nobs_per_seg = seg_len[i]
      Sigma = construct_cor_matrix(1:nobs_per_seg, gamma[j])
      L=t(chol(Sigma))
      theta=rep(mean_each_seg[i],nobs_per_seg)+L%*%rnorm(nobs_per_seg)
      y_each_dim = c(y_each_dim, theta+0.1*rnorm(nobs_per_seg))
    }
    y_mat[,j] = y_each_dim
  }
  
  ## Detect changepoints by SKFCPD
  Online_CPD_1 = SKFCPD(design = x_mat,
                        response = y_mat,
                        train_prop = 1/3)
  
  ## visulize the results
  plot_SKFCPD(Online_CPD_1)
</code></pre>


</div>