<div class="container">

<table style="width: 100%;"><tr>
<td>dotPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dot plot adapted from Seurat:::DotPlot, see ?Seurat:::DotPlot for details</h2>

<h3>Description</h3>

<p>Dot plot adapted from Seurat:::DotPlot, see ?Seurat:::DotPlot for details
</p>


<h3>Usage</h3>

<pre><code class="language-R">dotPlot(
  markers,
  count.matrix,
  cell.groups,
  marker.colour = "black",
  cluster.colour = "black",
  xlab = "Marker",
  ylab = "Cluster",
  n.cores = 1,
  text.angle = 45,
  gene.order = NULL,
  cols = c("blue", "red"),
  col.min = -2.5,
  col.max = 2.5,
  dot.min = 0,
  dot.scale = 6,
  scale.by = "radius",
  scale.center = FALSE,
  scale.min = NA,
  scale.max = NA,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>Vector of gene markers to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count.matrix</code></td>
<td>
<p>Merged count matrix, cells in rows and genes in columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.groups</code></td>
<td>
<p>Named factor containing cell groups (clusters) and cell names as names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.colour</code></td>
<td>
<p>Character or numeric vector (default="black")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.colour</code></td>
<td>
<p>Character or numeric vector (default="black")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>string X-axis title (default="Marker")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>string Y-axis title (default="Cluster")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>integer Number of cores (default=1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.angle</code></td>
<td>
<p>numeric Angle of text displayed (default=45)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.order</code></td>
<td>
<p>Either factor of genes passed to dplyr::mutate(levels=gene.order), or a boolean. (default=NULL) If TRUE, gene.order is set to the unique markers. If FALSE, gene.order is set to NULL. If NULL, the argument is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Colors to plot (default=c("blue", "red")). The name of a palette from 'RColorBrewer::brewer.pal.info', a pair of colors defining a gradient, or 3+ colors defining multiple gradients (if 'split.by' is set).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.min</code></td>
<td>
<p>numeric Minimum scaled average expression threshold (default=-2.5). Everything smaller will be set to this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.max</code></td>
<td>
<p>numeric Maximum scaled average expression threshold (default=2.5). Everything larger will be set to this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot.min</code></td>
<td>
<p>numeric The fraction of cells at which to draw the smallest dot (default=0). All cell groups with less than this expressing the given gene will have no dot drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot.scale</code></td>
<td>
<p>numeric Scale the size of the points, similar to cex (default=6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.by</code></td>
<td>
<p>string Scale the size of the points by 'size' or by 'radius' (default="radius")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.center</code></td>
<td>
<p>boolean Center scaling, see 'scale()' argument 'center' (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.min</code></td>
<td>
<p>numeric Set lower limit for scaling, use NA for default (default=NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.max</code></td>
<td>
<p>numeric Set upper limit for scaling, use NA for default (default=NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean Verbose output (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional inputs passed to sccore::plapply(), see man for description.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
## Create merged count matrix
## In this example, cms is a list of count matrices from, e.g., Cellranger count,
## where cells are in columns and genes in rows
## cm &lt;- sccore:::mergeCountMatrices(cms, transposed = FALSE) %&gt;% Matrix::t()

## If coming from Conos, this can be extracted like so
## cm &lt;- conos.obj$getJointCountMatrix(raw = FALSE) # Either normalized or raw values can be used

## Here, we create a random sparse matrix
cm &lt;- Matrix::rsparsematrix(30,3,0.5) %&gt;% abs(.) %&gt;%
            `dimnames&lt;-`(list(1:30,c("gene1","gene2","gene3")))

## Create marker vector
markers &lt;- c("gene1","gene2","gene3")

## Additionally, color vectors can be included.
## These should have the same length as the input (markers, cell groups)
## Otherwise, they are recycled
col.markers &lt;- c("black","black","red") # or c(1,1,2)
col.clusters &lt;- c("black","red","black") # or c(1,2,1)

## Create annotation vector
annotation &lt;- c(rep("cluster1",10),rep("cluster2",10),rep("cluster3",10)) %&gt;%
    factor() %&gt;% setNames(1:30)

## Plot. Here, the expression colours range from gray (low expression) to purple (high expression)
sccore:::dotPlot(markers = markers, count.matrix = cm, cell.groups = annotation,
    marker.colour = col.markers, cluster.colour = col.clusters, cols=c("gray","purple"))

</code></pre>


</div>