<div class="container">

<table style="width: 100%;"><tr>
<td>ksmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric invariant density, drift, and diffusion coefficient estimation</h2>

<h3>Description</h3>

<p>Implementation of simple Nadaraya-Watson nonparametric 
estimation of drift and diffusion
coefficient, and plain kernel density estimation of the invariant density
for a  one-dimensional diffusion process.</p>


<h3>Usage</h3>

<pre><code class="language-R">ksdrift(x, bw, n = 512)
ksdiff(x, bw, n = 512)
ksdens(x, bw, n = 512)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>ts</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of points in which to calculate the estimates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions return the nonparametric estimate of the drift or
diffusion coefficients for data <code>x</code> using the Nadaraya-Watson estimator 
for diffusion processes.
</p>
<p><code>ksdens</code> returns the density estimates of the invariant density.
</p>
<p>If not provided, the bandwidth <code>bw</code>
is calculated using Scott's rule (i.e., 
<code>bw = len^(-1/5)*sd(x)</code>) where <code>len=length(x)</code> 
is the number of observed points of the diffusion path.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>val</code></td>
<td>
<p>an invisible list of <code>x</code> and <code>y</code> coordinates 
and an object of class <code>density</code> in the case of invariant
density estimation</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Stefano Maria Iacus</p>


<h3>References</h3>

<p>Ait-Sahalia, Y. (1996) Nonparametric pricing of interest rate 
derivative securities, <em>Econometrica</em>, 64, 527-560.
</p>
<p>Bandi, F., Phillips, P. (2003) Fully nonparametric estimation of  
scalar diffusion models, <em>Econometrica</em>, 71, 241-283.
</p>
<p>Florens-Zmirou, D. (1993) On estimating the diffusion coefficient 
from discrete observations,  <em>Journal of Applied Probability</em>, 30, 790-804.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
theta &lt;- c(6,2,1)
X &lt;- sde.sim(X0 = rsCIR(1, theta), model="CIR", theta=theta,
     N=1000,delta=0.1)

b &lt;- function(x)
 theta[1]-theta[2]*x

sigma &lt;- function(x)
 theta[3]*sqrt(x)
  
minX &lt;- min(X)
maxX &lt;- max(X)

par(mfrow=c(3,1))
curve(b,minX,maxX)
lines(ksdrift(X),lty=3)

curve(sigma,minX, maxX)
lines(ksdiff(X),lty=3)

f &lt;-function(x) dsCIR(x, theta)
curve(f,minX,maxX)
lines(ksdens(X),lty=3)
</code></pre>


</div>