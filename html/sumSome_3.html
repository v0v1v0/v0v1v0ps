<div class="container">

<table style="width: 100%;"><tr>
<td>brainScores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation t-Scores for Brain Imaging</h2>

<h3>Description</h3>

<p>This function computes t-scores for different permutations of brain imaging data.
A voxel's score is calculated by performing the one-sample t test
for the null hypothesis that its mean contrast over the different subjects is zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brainScores(copes, mask = NULL, alternative = "two.sided", alpha = 0.05, B = 200,
            seed = NULL, truncFrom = 3.2, truncTo = 0, squares = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copes</code></td>
<td>
<p>list of 3D numeric arrays (contrasts maps for each subject).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain, or character for a Nifti file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncFrom</code></td>
<td>
<p>truncation parameter: values less extreme than <code>truncFrom</code> are truncated.
If <code>NULL</code>, statistics are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, statistics are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squares</code></td>
<td>
<p>logical, <code>TRUE</code> to use squared t-scores.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Truncation parameters should be such that <code>truncTo</code> is not more extreme than <code>truncFrom</code>.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1).
</p>


<h3>Value</h3>

<p><code>brainScores</code> returns an object of class <code>sumBrain</code>, containing
</p>

<ul>
<li> <p><code>statistics</code>: numeric matrix of t-scores, where columns correspond to voxels inside the brain, and rows to permutations.
The first permutation is the identity
</p>
</li>
<li> <p><code>mask</code>: 3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>truncFrom</code>: transformed first truncation parameter
</p>
</li>
<li> <p><code>truncTo</code>: transformed second truncation parameter
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging using p-values: <code>brainPvals</code>
</p>
<p>True discovery guarantee for cluster analysis: <code>clusterAnalysis</code>
</p>
<p>Suprathreshold clusters: <code>findClusters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain
res &lt;- brainScores(copes = copes, alpha = 0.2, seed = 42, truncFrom = thr)
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>


</div>