<div class="container">

<table style="width: 100%;"><tr>
<td>clusterTimeseries</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster a processed time-series with k-means.</h2>

<h3>Description</h3>

<p>Performs <code>kmeans</code> clustering of a
time-series object <code>tset</code> provided by
<code>processTimeseries</code>, and calculates cluster-cluster
and cluster-position similarity matrices as required for
<code>segmentClusters</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterTimeseries(tset, K = 16, iter.max = 1e+05, nstart = 100,
  nui.thresh = -Inf, verb = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tset</code></td>
<td>
<p>a "timeseries" object returned by
<code>processTimeseries</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of clusters to be calculated, ie. the argument
<code>centers</code> of <code>kmeans</code>, but here
multiple clusterings can be calculated, ie. <code>K</code> can be an
integer vector. Note that a smaller cluster number is automatically
chosen, if the data doesn't have more then K different values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>the maximum number of iterations allowed in
<code>kmeans</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>number of randomized initializations of
<code>kmeans</code>: "how many random sets should
be chosen?"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nui.thresh</code></td>
<td>
<p>threshold correlation of a data point to a
cluster center; if below the data point will be added to
nuisance cluster 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>level of verbosity, 0: no output, 1: progress messages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs one or more time-series clustering(s)
using <code>kmeans</code>, and the output of
<code>processTimeseries</code> as input. It further calculates
cluster centers, cluster-cluster and cluster-position similarity
matrices (Pearson correlation) that will be used by the main function
of this package, <code>segmentClusters</code>, to split the cluster
association sequence into segments, and assigns each segment to
the "winning" input cluster.
</p>
<p>The argument <code>K</code> is an integer vector that sets the requested
cluster numbers (argument <code>centers</code> in
<code>kmeans</code>). However, to avoid errors in batch
use, a smaller <code>K</code> is chosen, if the data contains less then
<code>K</code> distinct values.
</p>
<p>Nuisance Cluster:
values that were removed during time-series processing, such as
rows that only contain 0 or NA values, will be assigned to
the "nuisance cluster" with cluster label "0". Additionally, a minimal
correlation to any cluster center can be specified, argument
<code>nui.thresh</code>, and positions without any correlation higher
then this, will also be assigned to the "nuisance" cluster.
Resulting "nuisance segments" will not be shown in the results.
</p>
<p>Cluster Sorting and Coloring:
additionally the cluster labels in the result object will be sorted by
cluster-cluster similarity (see <code>sortClusters</code>) and cluster
colors assigned (see <code>colorClusters</code>) for convenient data
inspection with the plot methods available for each data processing
step (see examples).
</p>
<p>Note that the function, in conjunction with
<code>processTimeseries</code>, can also be used as a stand-alone
tool for time-series clusterings, specifically implementing the
strategy of clustering the Discrete Fourier Transform of periodic
time-series developed by Machne &amp; Murray (2012)
&lt;doi:10.1371/journal.pone.0037906&gt;, and further analyzed in Lehmann
et al. (2013) &lt;doi:10.1186/1471-2105-14-133&gt;, such as transcriptome
data from circadian or yeast respiratory oscillation systems.
</p>


<h3>Value</h3>

<p>Returns a list of class "clustering" comprising of a matrix
of clusterings, lists of cluster centers, cluster-cluster and
cluster-position similarity matrices (Pearson correlation) used
by <code>segmentClusters</code>, and additional information
such as a cluster sorting by similarity and cluster colors that
allow to track clusters in plots. A plot method exists that
allows to plot clusters aligned to "timeseries" and "segment"
plots.
</p>


<h3>References</h3>

<p>Machne &amp; Murray (2012)
&lt;doi:10.1371/journal.pone.0037906&gt;, and Lehmann et al. (2013)
&lt;doi:10.1186/1471-2105-14-133&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(primseg436)
## Discrete Fourier Transform of the time-series, 
## see ?processTimeseries for details
tset &lt;- processTimeseries(ts=tsd, na2zero=TRUE, use.fft=TRUE,
                          dft.range=1:7,  dc.trafo="ash", use.snr=TRUE)
## ... and cluster the transformed time-series
cset &lt;- clusterTimeseries(tset)
## plot methods for both returned objects allow aligned plots
par(mfcol=c(3,1))
plot(tset)
plot(cset)
</code></pre>


</div>