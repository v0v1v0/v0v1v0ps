<div class="container">

<table style="width: 100%;"><tr>
<td>perspPoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draw Points or Lines on a Surface Viewed in Perspective
</h2>

<h3>Description</h3>

<p>After a surface has been plotted in a perspective view
using <code>persp.im</code>, these functions can be used to
draw points or lines on the surface.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perspPoints(x, y=NULL, ..., Z, M, occluded=TRUE)

perspLines(x, y = NULL, ..., Z, M, occluded=TRUE)

perspSegments(x0, y0 = NULL, x1 = NULL, y1 = NULL, ..., Z, M, occluded=TRUE)

perspContour(Z, M, ...,
             nlevels=10, levels=pretty(range(Z), nlevels),
             occluded=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>

<p>Spatial coordinates,
acceptable to <code>xy.coords</code>,
for the points or lines on the horizontal plane.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>Pixel image (object of class <code>"im"</code>)
specifying the surface heights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Projection matrix returned from <code>persp.im</code>
when <code>Z</code> was plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Graphical arguments passed to
<code>points</code>,
<code>lines</code> or
<code>segments</code>
to control the drawing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0,y0,x1,y1</code></td>
<td>

<p>Spatial coordinates of the line segments, on the
horizontal plane. Alternatively <code>x0</code> can be a
line segment pattern (object of class <code>"psp"</code>)
and <code>y0,x1,y1</code> can be <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>Number of contour levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Vector of heights of contours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occluded</code></td>
<td>

<p>Logical value specifying whether parts of the surface
can be obscured by other parts of the surface. See Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After a surface has been plotted in a perspective view,
these functions can be used to draw points or lines on the surface.
</p>
<p>The user should already have called <code>persp.im</code>
to display the perspective view of the surface <code>Z</code>
and to obtain the perspective matrix <code>M</code> by typing
<code>M &lt;- persp(Z, ...)</code>. The points and lines will be drawn in
their correct three-dimensional position according to the same
perspective.
</p>
<p>If <code>occluded=TRUE</code> (the default), then the surface is
treated as if it were opaque. The code will
draw only those points and lines which are visible
from the viewer's standpoint, and not obscured by other parts
of the surface lying closer to the viewer.
The user should already have called <code>persp.im</code>
in the form <code>M &lt;- persp(Z, visible=TRUE, ...)</code> 
to compute the visibility information.
</p>
<p>If <code>occluded=FALSE</code>, then the surface is treated
as if it were transparent. 
All the specified points and lines will be drawn on the
surface.
</p>


<h3>Value</h3>

<p>Same as the return value from
<code>points</code>
or <code>segments</code>. 
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>
</p>


<h3>See Also</h3>

<p><code>persp.im</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  M &lt;- persp(bei.extra$elev, colmap=terrain.colors(128),
             apron=TRUE, theta=-30, phi=20,
             zlab="Elevation", main="", 
             expand=6, visible=TRUE, shade=0.3)

  perspContour(bei.extra$elev, M=M, col="pink", nlevels=12)
  perspPoints(bei, Z=bei.extra$elev, M=M, pch=16, cex=0.3, col="chartreuse")
</code></pre>


</div>