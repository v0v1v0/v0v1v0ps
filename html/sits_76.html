<div class="container">

<table style="width: 100%;"><tr>
<td>sits_classify</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classify time series or data cubes</h2>

<h3>Description</h3>

<p>This function classifies a set of time series or data cube given
a trained model prediction model created by <code>sits_train</code>.
</p>
<p>SITS supports the following models:
(a) support vector machines:  <code>sits_svm</code>;
(b) random forests:  <code>sits_rfor</code>;
(c) extreme gradient boosting: <code>sits_xgboost</code>;
(d) multi-layer perceptrons: <code>sits_mlp</code>;
(e) 1D CNN: <code>sits_tempcnn</code>;
(f) self-attention encoders: <code>sits_lighttae</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sits_classify(
  data,
  ml_model,
  ...,
  filter_fn = NULL,
  multicores = 2L,
  progress = TRUE
)

## S3 method for class 'sits'
sits_classify(
  data,
  ml_model,
  ...,
  filter_fn = NULL,
  impute_fn = impute_linear(),
  multicores = 2L,
  gpu_memory = 4,
  progress = TRUE
)

## S3 method for class 'raster_cube'
sits_classify(
  data,
  ml_model,
  ...,
  roi = NULL,
  filter_fn = NULL,
  impute_fn = impute_linear(),
  start_date = NULL,
  end_date = NULL,
  memsize = 8L,
  multicores = 2L,
  gpu_memory = 4,
  output_dir,
  version = "v1",
  verbose = FALSE,
  progress = TRUE
)

## S3 method for class 'derived_cube'
sits_classify(data, ml_model, ...)

## S3 method for class 'tbl_df'
sits_classify(data, ml_model, ...)

## S3 method for class 'segs_cube'
sits_classify(
  data,
  ml_model,
  ...,
  roi = NULL,
  filter_fn = NULL,
  impute_fn = impute_linear(),
  start_date = NULL,
  end_date = NULL,
  memsize = 8L,
  multicores = 2L,
  gpu_memory = 4,
  output_dir,
  version = "v1",
  n_sam_pol = NULL,
  verbose = FALSE,
  progress = TRUE
)

## Default S3 method:
sits_classify(data, ml_model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data cube (tibble of class "raster_cube")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml_model</code></td>
<td>
<p>R model trained by <code>sits_train</code>
(closure of class "sits_model")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters for specific functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_fn</code></td>
<td>
<p>Smoothing filter to be applied - optional
(closure containing object of class "function").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicores</code></td>
<td>
<p>Number of cores to be used for classification
(integer, min = 1, max = 2048).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical: Show progress bar?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute_fn</code></td>
<td>
<p>Imputation function to remove NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpu_memory</code></td>
<td>
<p>Memory available in GPU in GB (default = 4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roi</code></td>
<td>
<p>Region of interest (either an sf object, shapefile,
or a numeric vector with named XY values
("xmin", "xmax", "ymin", "ymax") or
named lat/long values
("lon_min", "lat_min", "lon_max", "lat_max").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_date</code></td>
<td>
<p>Start date for the classification
(Date in YYYY-MM-DD format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_date</code></td>
<td>
<p>End date for the classification
(Date in YYYY-MM-DD format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memsize</code></td>
<td>
<p>Memory available for classification in GB
(integer, min = 1, max = 16384).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>Valid directory for output file.
(character vector of length 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>Version of the output
(character vector of length 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical: print information about processing time?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sam_pol</code></td>
<td>
<p>Number of time series per segment to be classified
(integer, min = 10, max = 50).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Time series with predicted labels for
each point (tibble of class "sits")
or a data cube with probabilities for each class
(tibble of class "probs_cube").
</p>


<h3>Note</h3>

<p>The <code>roi</code> parameter defines a region of interest. It can be
an sf_object, a shapefile, or a bounding box vector with
named XY values (<code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>) or
named lat/long values (<code>lon_min</code>, <code>lon_max</code>,
<code>lat_min</code>, <code>lat_max</code>)
</p>
<p>Parameter <code>filter_fn</code> parameter specifies a smoothing filter
to be applied to each time series for reducing noise. Currently, options
are Savitzky-Golay (see <code>sits_sgolay</code>) and Whittaker
(see <code>sits_whittaker</code>) filters.
</p>
<p>Parameter <code>memsize</code> controls the amount of memory available
for classification, while <code>multicores</code>  defines the number of cores
used for processing. We recommend using as much memory as possible.
</p>
<p>When using a GPU for deep learning, <code>gpu_memory</code> indicates the
memory of available in the graphics card.
It is not possible to have an exact idea of the size of Deep Learning
models in GPU memory, as the complexity of the model and factors
such as CUDA Context increase the size of the model in memory.
Therefore, we recommend that you leave at least 1GB free on the
video card to store the Deep Learning model that will be used.
</p>
<p>For classifying vector data cubes created by
<code>sits_segment</code>,
<code>n_sam_pol</code> controls is the number of time series to be
classified per segment.
</p>
<p>Please refer to the sits documentation available in
&lt;https://e-sensing.github.io/sitsbook/&gt; for detailed examples.
</p>


<h3>Author(s)</h3>

<p>Rolf Simoes, <a href="mailto:rolf.simoes@inpe.br">rolf.simoes@inpe.br</a>
</p>
<p>Gilberto Camara, <a href="mailto:gilberto.camara@inpe.br">gilberto.camara@inpe.br</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (sits_run_examples()) {
    # Example of classification of a time series
    # Retrieve the samples for Mato Grosso
    # train a random forest model
    rf_model &lt;- sits_train(samples_modis_ndvi, ml_method = sits_rfor)

    # classify the point
    point_ndvi &lt;- sits_select(point_mt_6bands, bands = c("NDVI"))
    point_class &lt;- sits_classify(
        data = point_ndvi, ml_model = rf_model
    )
    plot(point_class)

    # Example of classification of a data cube
    # create a data cube from local files
    data_dir &lt;- system.file("extdata/raster/mod13q1", package = "sits")
    cube &lt;- sits_cube(
        source = "BDC",
        collection = "MOD13Q1-6.1",
        data_dir = data_dir
    )
    # classify a data cube
    probs_cube &lt;- sits_classify(
        data = cube,
        ml_model = rf_model,
        output_dir = tempdir(),
        version = "ex_classify"
    )
    # label the probability cube
    label_cube &lt;- sits_label_classification(
        probs_cube,
        output_dir = tempdir(),
        version = "ex_classify"
    )
    # plot the classified image
    plot(label_cube)
    # segmentation
    # segment the image
    segments &lt;- sits_segment(
        cube = cube,
        seg_fn = sits_slic(step = 5,
                       compactness = 1,
                       dist_fun = "euclidean",
                       avg_fun = "median",
                       iter = 50,
                       minarea = 10,
                       verbose = FALSE
                       ),
        output_dir = tempdir()
    )
    # Create a classified vector cube
    probs_segs &lt;- sits_classify(
        data = segments,
        ml_model = rf_model,
        output_dir = tempdir(),
        multicores = 4,
        version = "segs"
    )
    # Create a labelled vector cube
    class_segs &lt;- sits_label_classification(
        cube = probs_segs,
        output_dir = tempdir(),
        multicores = 2,
        memsize = 4,
        version = "segs_classify"
    )
    # plot class_segs
    plot(class_segs)
}

</code></pre>


</div>