<div class="container">

<table style="width: 100%;"><tr>
<td>sumPvals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>True Discovery Guarantee for p-Value Combinations</h2>

<h3>Description</h3>

<p>This function determines confidence bounds for the number of true discoveries, the true discovery proportion
and the false discovery proportion within a set of interest, when using p-values as test statistics.
The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sumPvals(G, S = NULL, alpha = 0.05, truncFrom = NULL, truncTo = 0.5,
         type = "vovk.wang", r = 0, nMax = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>numeric matrix of p-values, where columns correspond to variables, and rows to data transformations (e.g. permutations).
The first transformation is the identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>vector of indices for the variables of interest (if not specified, all variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncFrom</code></td>
<td>
<p>truncation parameter: values greater than <code>truncFrom</code> are truncated.
If <code>NULL</code>, it is set to <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, p-values are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>p-value combination among <code>edgington</code>, <code>fisher</code>, <code>pearson</code>, <code>liptak</code>,
<code>cauchy</code>, <code>vovk.wang</code> (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>parameter for Vovk and Wang's p-value combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMax</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A p-value <code>p</code> is transformed as following.
</p>

<ul>
<li>
<p> Edgington: <code>-p</code>
</p>
</li>
<li>
<p> Fisher: <code>-log(p)</code>
</p>
</li>
<li>
<p> Pearson: <code>log(1-p)</code>
</p>
</li>
<li>
<p> Liptak: <code>-qnorm(p)</code>
</p>
</li>
<li>
<p> Cauchy: <code>tan(0.5 - p)/p</code>
</p>
</li>
<li>
<p> Vovk and Wang: <code>- sign(r)p^r</code>
</p>
</li>
</ul>
<p>An error message is returned if the transformation produces infinite values.
</p>
<p>Truncation parameters should be such that <code>truncTo</code> is not smaller than <code>truncFrom</code>.
As Pearson's and Liptak's transformations produce infinite values in 1, for such methods
<code>truncTo</code> should be strictly smaller than 1.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1), where
<code>B</code> is the number of data transformations (rows in <code>G</code>).
</p>


<h3>Value</h3>

<p><code>sumPvals</code> returns an object of class <code>sumObj</code>, containing
</p>

<ul>
<li> <p><code>total</code>: total number of variables (columns in <code>G</code>)
</p>
</li>
<li> <p><code>size</code>: size of <code>S</code>
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries in <code>S</code>
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>iterations</code>: number of iterations of the algorithm
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>True discovery guarantee using generic statistics: <code>sumStats</code>
</p>
<p>Access a <code>sumObj</code> object: <code>discoveries</code>, <code>tdp</code>, <code>fdp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>


</div>