<div class="container">

<table style="width: 100%;"><tr>
<td>f</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defining smooth terms in SOP formulae</h2>

<h3>Description</h3>

<p>Auxiliary function used to define smooth terms within <code>sop()</code> model formulae. The function does not evaluate the smooth - it exists purely to help set up a model using P-spline based smoothers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">f(..., nseg = 10, pord = 2 , degree = 3)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a list of up to three variables to construct the smooth term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of segments for the (marginal) B-spline bases used to represent the smooth term. Numerical vector of length equal to the number of covariates. Atomic values are also valid, being recycled. The default value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>penalty order. Numerical vector of length equal to the number of covariates. Atomic values are also valid, being recycled. The default value is 2 (second-order penalty).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the order of the polynomial for the (marginal) B-spline bases for this term. Numerical vector of length equal to the number of covariates. Atomic values are also valid, being recycled. The default value is 3 (cubic B-splines).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions <code>f()</code> is designed to represent either a one dimensional smooth functions for main effects of an continuous explanatory variable or two or three dimensional smooth functions representing two way and three way interactions of continuous variables. By default, the values of the arguments  <code>nseg</code>, <code>pord</code> and <code>degree</code>  are repeated to the length of the explanatory covariates. The two and three dimensional smooth terms are constructed using the tensor-product of marginal (one-dimensional) B-spline bases and anisotropic penalties are considered.
</p>



<h3>Value</h3>

 
<p>The function is interpreted in the formula of a <code>sop</code> model and creates the right framework for fitting the smoother. List containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>names of the covariates involved in the smooth term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nseg</code></td>
<td>
<p>the number of segments for the (marginal) B-spline basis for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pord</code></td>
<td>
<p>the penalty order (numerical vector of length equal to the number of covariates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the order of the polynomial for the (marginal) B-Spline bases for this term (numerical vector of length equal to the number of covariates). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>The dimension of the smoother - i.e. the number of covariates that it is a function of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>labels terms.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>ad</code>, <code>rae</code>, <code>sop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(SOP)
# Simulate the data
set.seed(123)
n &lt;- 1000
sigma &lt;- 0.5
x &lt;- runif(n)
f0 &lt;- function(x) 2*sin(pi*x)
f &lt;- f0(x)
y &lt;- f + rnorm(n, 0, sigma)
dat &lt;- data.frame(x = x, y = y)

# Fit the model
m0 &lt;- sop(formula = y ~ f(x, nseg = 10), data = dat)
summary(m0)

# Plot results
plot(y ~ x, data = dat)
ox &lt;- order(dat$x)
lines(f[ox] ~ dat$x[ox], lwd = 2)
lines(fitted(m0)[ox] ~ dat$x[ox], col = "red", lwd = 2)
</code></pre>


</div>