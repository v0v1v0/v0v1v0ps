<div class="container">

<table style="width: 100%;"><tr>
<td>knsmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of Nonparametric Trend Functions via Kernel Regression</h2>

<h3>Description</h3>

<p>This function estimates the nonparametric trend function in an equidistant
time series with Nadaraya-Watson kernel regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">knsmooth(y, mu = 1, b = 0.15, bb = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector that contains the time series data ordered from
past to present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>an integer <code>0</code>, <code>1</code>, <code>2</code>, ... that represents the
smoothness parameter of the second order kernel function that will be used;
is set to <code>1</code> by default.
</p>

<table>
<tr>
<td style="text-align: center;">
<strong>Number (<code>mu</code>)</strong> </td>
<td style="text-align: left;"> <strong>Kernel</strong>
</td>
</tr>
<tr>
<td style="text-align: center;">
<code>0</code> </td>
<td style="text-align: left;"> Uniform Kernel</td>
</tr>
<tr>
<td style="text-align: center;">
<code>1</code> </td>
<td style="text-align: left;"> Epanechnikov Kernel</td>
</tr>
<tr>
<td style="text-align: center;">
<code>2</code> </td>
<td style="text-align: left;"> Bisquare Kernel</td>
</tr>
<tr>
<td style="text-align: center;">
<code>3</code> </td>
<td style="text-align: left;"> Triweight Kernel</td>
</tr>
<tr>
<td style="text-align: center;">
<code>...</code> </td>
<td style="text-align: left;"> ...
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a real number <code class="reqn">0 &lt;</code> <code>b</code> <code class="reqn">&lt; 0.5</code>; represents the
relative bandwidth that will be used for the smoothing process; is set to
<code>0.15</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bb</code></td>
<td>
<p>can be set to <code>0</code> or <code>1</code>; the parameter controlling the
bandwidth used at the boundary; is set to <code>0</code> by default.
</p>

<table>
<tr>
<td style="text-align: center;">
<strong>Number (<code>bb</code>)</strong> </td>
<td style="text-align: left;"> <strong>Estimation procedure at boundary
points</strong>
</td>
</tr>
<tr>
<td style="text-align: center;">
<code>0</code> </td>
<td style="text-align: left;"> Fixed bandwidth on one side with possible large
bandwidth on the other side at the boundary</td>
</tr>
<tr>
<td style="text-align: center;">
<code>1</code> </td>
<td style="text-align: left;"> The k-nearest neighbor method will be used
</td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The trend is estimated based on the additive
nonparametric regression model for an equidistant time series
</p>
<p style="text-align: center;"><code class="reqn">y_t = m(x_t) + \epsilon_t,</code>
</p>

<p>where <code class="reqn">y_t</code> is the observed time series, <code class="reqn">x_t</code> is the rescaled time
on the interval <code class="reqn">[0, 1]</code>, <code class="reqn">m(x_t)</code> is a smooth and deterministic
trend function and <code class="reqn">\epsilon_t</code> are stationary errors with
<code class="reqn">E(\epsilon_t) = 0</code>.
</p>
<p>This function is part of the package <code>smoots</code> and is used for
the estimation of trends in equidistant time series. The applied method
is a kernel regression with arbitrarily selectable second order
kernel, relative bandwidth and boundary method. Especially the chosen
bandwidth has a strong impact on the final result and has thus to be
selected carefully. This approach is not recommended by the authors of this
package.
</p>


<h3>Value</h3>

<p>The output object is a list with different components:
</p>

<dl>
<dt>b</dt>
<dd>
<p>the chosen (relative) bandwidth; input argument.</p>
</dd>
<dt>bb</dt>
<dd>
<p>the chosen bandwidth option at the boundaries; input argument.</p>
</dd>
<dt>mu</dt>
<dd>
<p>the chosen smoothness parameter for the second order kernel; input
argument.</p>
</dd>
<dt>n</dt>
<dd>
<p>the number of observations.</p>
</dd>
<dt>orig</dt>
<dd>
<p>the original input series; input argument.</p>
</dd>
<dt>res</dt>
<dd>
<p>a vector with the estimated residual series.</p>
</dd>
<dt>ye</dt>
<dd>
<p>a vector with the estimates of the nonparametric trend.</p>
</dd>
</dl>
<h3>Author(s)</h3>


<ul>
<li>
<p> Yuanhua Feng (Department of Economics, Paderborn University), <br>
Author of the Algorithms <br>
Website: <a href="https://wiwi.uni-paderborn.de/en/dep4/feng/">https://wiwi.uni-paderborn.de/en/dep4/feng/</a>
</p>
</li>
<li>
<p> Dominik Schulz (Research Assistant) (Department of Economics, Paderborn
University), <br>
Package Creator and Maintainer
</p>
</li>
</ul>
<h3>References</h3>

<p>Feng, Y. (2009). Kernel and Locally Weighted Regression. Verlag f√ºr
Wissenschaft und Forschung, Berlin.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Logarithm of test data
test_data &lt;- gdpUS
y &lt;- log(test_data$GDP)

#Applied knmooth function for the trend with two different bandwidths
trend1 &lt;- knsmooth(y, mu = 1, b = 0.28, bb = 1)$ye
trend2 &lt;- knsmooth(y, mu = 1, b = 0.05, bb = 1)$ye

# Plot of the results
t &lt;- seq(from = 1947, to = 2019.25, by = 0.25)
plot(t, y, type = "l", xlab = "Year", ylab = "log(US-GDP)", bty = "n",
 lwd = 2,
 main = "Estimated trend for log-quarterly US-GDP, Q1 1947 - Q2 2019")
points(t, trend1, type = "l", col = "red", lwd = 1)
points(t, trend2, type = "l", col = "blue", lwd = 1)
legend("bottomright", legend = c("Trend (b = 0.28)", "Trend (b = 0.05)"),
 fill = c("red", "blue"), cex = 0.6)
title(sub = expression(italic("Figure 1")), col.sub = "gray47",
 cex.sub = 0.6, adj = 0)


</code></pre>


</div>