<div class="container">

<table style="width: 100%;"><tr>
<td>moran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Moran's I</h2>

<h3>Description</h3>

<p>A simple function to compute Moran's I, called by <code>moran.test</code> and <code>moran.mc</code>;
</p>
<p style="text-align: center;"><code class="reqn">I = \frac{n}{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}}
\frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i-\bar{x})(x_j-\bar{x})}{\sum_{i=1}^{n}(x_i - \bar{x})^2}
</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">moran(x, listw, n, S0, zero.policy=attr(listw, "zero.policy"), NAOK=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of zones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>global sum of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAOK</code></td>
<td>
<p>if 'TRUE' then any 'NA' or 'NaN' or 'Inf' values in x are passed on to the foreign function.  If 'FALSE', the presence of 'NA' or 'NaN' or 'Inf' values is regarded as an error.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Moran's I</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>sample kurtosis of x</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 17.</p>


<h3>See Also</h3>

<p><code>moran.test</code>, <code>moran.mc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(oldcol)
col.W &lt;- nb2listw(COL.nb, style="W")
crime &lt;- COL.OLD$CRIME
str(moran(crime, col.W, length(COL.nb), Szero(col.W)))
is.na(crime) &lt;- sample(1:length(crime), 10)
str(moran(crime, col.W, length(COL.nb), Szero(col.W), NAOK=TRUE))
</code></pre>


</div>