<div class="container">

<table style="width: 100%;"><tr>
<td>sample_copula_parameters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Unidentifiable Copula Parameters</h2>

<h3>Description</h3>

<p>The <code>sample_copula_parameters()</code> function samples the unidentifiable copula
parameters for the partly identifiable D-vine copula model, see for example
<code>fit_copula_model_BinCont()</code> and <code>fit_model_SurvSurv()</code> for more information
regarding the D-vine copula model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_copula_parameters(
  copula_family2,
  n_sim,
  eq_cond_association = FALSE,
  lower = c(-1, -1, -1, -1),
  upper = c(1, 1, 1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>Number of copula parameter vectors to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eq_cond_association</code></td>
<td>
<p>(boolean) Indicates whether <code class="reqn">\rho_{13;2}</code> and
<code class="reqn">\rho_{24;3}</code> are set equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the lower limit,
<code class="reqn">\boldsymbol{a} = (a_{23}, a_{13;2}, a_{24;3},
  a_{14;23})'</code>. Defaults to <code>c(-1, -1, -1, -1)</code>. If the provided lower limit
is smaller than what is allowed for a particular copula family, then the
copula family's lowest possible value is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the upper limit,
<code class="reqn">\boldsymbol{b} = (b_{23}, b_{13;2}, b_{24;3},
  b_{14;23})'</code>. Defaults to <code>c(1, 1, 1, 1)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>n_sim</code> by <code>4</code> numeric matrix where each row corresponds to a
sample for <code class="reqn">\boldsymbol{\theta}_{unid}</code>.
</p>


<h3>Sampling</h3>

<p>In the D-vine copula model in the Information-Theoretic Causal Inference
(ITCI) framework, the following copulas are not identifiable: <code class="reqn">c_{23}</code>,
<code class="reqn">c_{13;2}</code>, <code class="reqn">c_{24;3}</code>, <code class="reqn">c_{14;23}</code>. Let the corresponding
copula
parameters be </p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\theta}_{unid} = (\theta_{23}, \theta_{13;2},
\theta_{24;3}, \theta_{14;23})'.</code>
</p>

<p>The allowable range for this parameter vector depends on the corresponding
copula families. For parsimony and comparability across different copula
families, the sampling procedure consists of two steps:
</p>

<ol>
<li>
<p> Sample Spearman's rho parameters from a uniform distribution,
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\rho}_{unid} = (\rho_{23}, \rho_{13;2}, \rho_{24;3},
  \rho_{14;23})' \sim U(\boldsymbol{a}, \boldsymbol{b}).</code>
</p>

</li>
<li>
<p> Transform the sampled Spearman's rho parameters to the copula parameter
scale, <code class="reqn">\boldsymbol{\theta}_{unid}</code>.
</p>
</li>
</ol>
<p>These two steps are repeated <code>n_sim</code> times.
</p>


<h3>Conditional Independence</h3>

<p>In addition to range restrictions through the <code>lower</code> and <code>upper</code> arguments,
we allow for so-called conditional independence assumptions.
These assumptions entail that <code class="reqn">\rho_{13;2} = 0</code> and <code class="reqn">\rho_{24;3} =
0</code>. Or in other words, <code class="reqn">U_1 \perp U_3 \, | \, U_2</code> and <code class="reqn">U_2 \perp U_4 \, | \, U_3</code>.
In the context of a surrogate evaluation trial (where <code class="reqn">(U_1, U_2, U_3,
U_4)'</code> corresponds to the probability integral transformation of <code class="reqn">(T_0,
S_0, S_1, T_1)'</code>) this assumption could be justified by subject-matter knowledge.
</p>


</div>