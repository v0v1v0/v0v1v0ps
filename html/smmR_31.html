<div class="container">

<table style="width: 100%;"><tr>
<td>smmparametric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric semi-Markov model specification</h2>

<h3>Description</h3>

<p>Creates a parametric model specification for a semi-Markov model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smmparametric(
  states,
  init,
  ptrans,
  type.sojourn = c("fij", "fi", "fj", "f"),
  distr,
  param,
  cens.beg = FALSE,
  cens.end = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Vector of state space of length <code class="reqn">s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Vector of initial distribution of length <code class="reqn">s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrans</code></td>
<td>
<p>Matrix of transition probabilities of the embedded Markov
chain <code class="reqn">J=(J_m)_{m}</code> of dimension <code class="reqn">(s, s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.sojourn</code></td>
<td>
<p>Type of sojourn time (for more explanations, see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>

<ul>
<li>
<p> Matrix of distributions of dimension <code class="reqn">(s, s)</code> if <code>type.sojourn = "fij"</code>;
</p>
</li>
<li>
<p> Vector of distributions of length <code class="reqn">s</code> if <code>type.sojourn = "fi"</code> or <code style="white-space: pre;">⁠"fj⁠</code>;
</p>
</li>
<li>
<p> A distribution if <code>type.sojourn = "f"</code>.
</p>
</li>
</ul>
<p>where the distributions to be used can be one of <code>unif</code>, <code>geom</code>, <code>pois</code>, <code>dweibull</code> or <code>nbinom</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Parameters of sojourn time distributions:
</p>

<ul>
<li>
<p> Array of distribution parameters of dimension <code class="reqn">(s, s, 2)</code>
(2 corresponds to the maximal number of distribution parameters) if <code>type.sojourn = "fij"</code>;
</p>
</li>
<li>
<p> Matrix of distribution parameters of dimension <code class="reqn">(s, 2)</code> if <code>type.sojourn = "fi"</code> or <code>"fj"</code>;
</p>
</li>
<li>
<p> Vector of distribution parameters of length 2 if <code>type.sojourn = "f"</code>.
</p>
</li>
</ul>
<p>When parameters/values are not necessary (e.g. the Poisson distribution has
only one parameter that is <code class="reqn">\lambda</code>, leave the value <code>NA</code> for the
second parameter in the argument <code>param</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.beg</code></td>
<td>
<p>Optional. A logical value indicating whether or not
sequences are censored at the beginning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.end</code></td>
<td>
<p>Optional. A logical value indicating whether or not
sequences are censored at the end.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a semi-Markov model object in the parametric
case, taking into account the type of sojourn time and the censoring
described in references. For the parametric specification, several discrete
distributions are considered (see below).
</p>
<p>The difference between the Markov model and the semi-Markov model concerns
the modeling of the sojourn time. With a Markov chain, the sojourn time
distribution is modeled by a Geometric distribution (in discrete time).
With a semi-Markov chain, the sojourn time can be any arbitrary distribution.
In this package, the available distribution for a semi-Markov model are :
</p>

<ul>
<li>
<p> Uniform: <code class="reqn">f(x) = 1/n</code> for <code class="reqn">a \le x \le b</code>, with <code class="reqn">n = b-a+1</code>;
</p>
</li>
<li>
<p> Geometric: <code class="reqn">f(x) = \theta (1-\theta)^x</code> for <code class="reqn">x = 0, 1, 2,\ldots,n</code>, <code class="reqn">0 &lt; \theta &lt; 1</code>, with <code class="reqn">n &gt; 0</code> and <code class="reqn">\theta</code> is the probability of success;
</p>
</li>
<li>
<p> Poisson: <code class="reqn">f(x) = (\lambda^x exp(-\lambda))/x!</code> for <code class="reqn">x = 0, 1, 2,\ldots,n</code>, with <code class="reqn">n &gt; 0</code> and <code class="reqn">\lambda &gt; 0</code>;
</p>
</li>
<li>
<p> Discrete Weibull of type 1: <code class="reqn">f(x)=q^{(x-1)^{\beta}}-q^{x^{\beta}}, x=1,2,3,\ldots,n</code>, with <code class="reqn">n &gt; 0</code>, <code class="reqn">q</code> is the first parameter and <code class="reqn">\beta</code> is the second parameter;
</p>
</li>
<li>
<p> Negative binomial: <code class="reqn">f(x)=\frac{\Gamma(x+\alpha)}{\Gamma(\alpha) x!} p^{\alpha} (1 - p)^x</code>,
for <code class="reqn">x = 0, 1, 2,\ldots,n</code>, <code class="reqn">\Gamma</code> is the Gamma function,
<code class="reqn">\alpha</code> is the parameter of overdispersion and <code class="reqn">p</code> is the
probability of success, <code class="reqn">0 &lt; p &lt; 1</code>;
</p>
</li>
<li>
<p> Non-parametric.
</p>
</li>
</ul>
<p>We define :
</p>

<ul>
<li>
<p> the semi-Markov kernel <code class="reqn">q_{ij}(k) = P( J_{m+1} = j, T_{m+1} - T_{m} = k | J_{m} = i )</code>;
</p>
</li>
<li>
<p> the transition matrix <code class="reqn">(p_{trans}(i,j))_{i,j} \in states</code> of the embedded Markov chain <code class="reqn">J = (J_m)_m</code>, <code class="reqn">p_{trans}(i,j) = P( J_{m+1} = j | J_m = i )</code>;
</p>
</li>
<li>
<p> the initial distribution <code class="reqn">\mu_i = P(J_1 = i) = P(Z_1 = i)</code>, <code class="reqn">i \in 1, 2, \dots, s</code>;
</p>
</li>
<li>
<p> the conditional sojourn time distributions <code class="reqn">(f_{ij}(k))_{i,j} \in states,\ k \in N ,\ f_{ij}(k) = P(T_{m+1} - T_m = k | J_m = i, J_{m+1} = j )</code>,
<code class="reqn">f</code> is specified by the argument <code>param</code> in the parametric case.
</p>
</li>
</ul>
<p>In this package we can choose different types of sojourn time.
Four options are available for the sojourn times:
</p>

<ul>
<li>
<p> depending on the present state and on the next state (<code class="reqn">f_{ij}</code>);
</p>
</li>
<li>
<p> depending only on the present state (<code class="reqn">f_{i}</code>);
</p>
</li>
<li>
<p> depending only on the next state (<code class="reqn">f_{j}</code>);
</p>
</li>
<li>
<p> depending neither on the current, nor on the next state (<code class="reqn">f</code>).
</p>
</li>
</ul>
<p>If  <code>type.sojourn = "fij"</code>, <code>distr</code> is a matrix of dimension <code class="reqn">(s, s)</code>
(e.g., if the row 1 of the 2nd column is <code>"pois"</code>, that is to say we go from
the first state to the second state following a Poisson distribution).
If <code>type.sojourn = "fi"</code> or <code>"fj"</code>, <code>distr</code> must be a vector (e.g., if the
first element of vector is <code>"geom"</code>, that is to say we go from the first
state to any state according to a Geometric distribution).
If <code>type.sojourn = "f"</code>, <code>distr</code> must be one of <code>"unif"</code>, <code>"geom"</code>, <code>"pois"</code>,
<code>"dweibull"</code>, <code>"nbinom"</code> (e.g., if <code>distr</code> is equal to <code>"nbinom"</code>, that is
to say that the sojourn times when going from any state to any state follows
a Negative Binomial distribution).
For the non-parametric case, <code>distr</code> is equal to <code>"nonparametric"</code> whatever
type of sojourn time given.
</p>
<p>If the sequence is censored at the beginning and/or at the end, <code>cens.beg</code>
must be equal to <code>TRUE</code> and/or <code>cens.end</code> must be equal to <code>TRUE</code>.
All the sequences must be censored in the same way.
</p>


<h3>Value</h3>

<p>Returns an object of class smmparametric.
</p>


<h3>References</h3>

<p>V. S. Barbu, N. Limnios. (2008). Semi-Markov Chains and Hidden Semi-Markov
Models Toward Applications - Their Use in Reliability and DNA Analysis.
New York: Lecture Notes in Statistics, vol. 191, Springer.
</p>


<h3>See Also</h3>

<p>simulate, fitsmm, smmnonparametric
</p>


<h3>Examples</h3>

<pre><code class="language-R">states &lt;- c("a", "c", "g", "t")
s &lt;- length(states)

# Creation of the initial distribution
vect.init &lt;- c(1 / 4, 1 / 4, 1 / 4, 1 / 4)

# Creation of the transition matrix
pij &lt;- matrix(c(0, 0.2, 0.5, 0.3,
                0.2, 0, 0.3, 0.5,
                0.3, 0.5, 0, 0.2,
                0.4, 0.2, 0.4, 0),
              ncol = s, byrow = TRUE)

# Creation of the distribution matrix

distr.matrix &lt;- matrix(c(NA, "pois", "geom", "nbinom",
                         "geom", NA, "pois", "dweibull",
                         "pois", "pois", NA, "geom",
                         "pois", "geom", "geom", NA),
                       nrow = s, ncol = s, byrow = TRUE)

# Creation of an array containing the parameters
param1.matrix &lt;- matrix(c(NA, 2, 0.4, 4,
                          0.7, NA, 5, 0.6,
                          2, 3, NA, 0.6,
                          4, 0.3, 0.4, NA),
                        nrow = s, ncol = s, byrow = TRUE)

param2.matrix &lt;- matrix(c(NA, NA, NA, 0.6,
                          NA, NA, NA, 0.8,
                          NA, NA, NA, NA,
                          NA, NA, NA, NA),
                        nrow = s, ncol = s, byrow = TRUE)

param.array &lt;- array(c(param1.matrix, param2.matrix), c(s, s, 2))

# Specify the semi-Markov model
semimarkov &lt;- smmparametric(states = states, init = vect.init, ptrans = pij, 
                            type.sojourn = "fij", distr = distr.matrix, 
                            param = param.array)
semimarkov

</code></pre>


</div>