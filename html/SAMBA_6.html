<div class="container">

<table style="width: 100%;"><tr>
<td>sensitivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate sensitivity</h2>

<h3>Description</h3>

<p><code>sensitivity</code> estimates (1) marginal sensitivity and (2) sensitivity as
a function of covariates X for a misclassified binary outcome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sensitivity(Dstar, X, prev, r = NULL, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dstar</code></td>
<td>
<p>Numeric vector containing observed disease status. Should be
coded as 0/1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric matrix with covariates in sensitivity model. Set to NULL
to fit model with no covariates in sensitivity model. 'X' should not
contain an intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev</code></td>
<td>
<p>marginal disease prevalence <code class="reqn">P(D = 1)</code> or patient-specific
<code class="reqn">P(D = 1|X)</code> in population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>(optional) marginal sampling ratio, <code class="reqn">P(S = 1|D = 1) / P(S = 1|D = 0)</code>.
Only one of 'r' and 'weights' can be specified. Default is 'NULL'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of patient-specific weights used for
selection bias adjustment. Only one of r and weights can be specified.
Default is 'NULL'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We are interested in modeling the relationship between binary disease status
and covariates <code class="reqn">Z</code> using a logistic regression model. However, <code class="reqn">D</code>
may be misclassified, and our observed data may not well-represent the
population of interest. In this setting, we estimate parameters from the
disease model using the following modeling framework.
</p>
<p>Notation:
</p>

<dl>
<dt>D</dt>
<dd>
<p>Binary disease status of interest.</p>
</dd>
<dt>D*</dt>
<dd>
<p>Observed binary disease status. Potentially a misclassified
version of D. We assume D = 0 implies D* = 0.</p>
</dd>
<dt>S</dt>
<dd>
<p>Indicator for whether patient from population of interest is
included in the analytical dataset.</p>
</dd>
<dt>Z</dt>
<dd>
<p>Covariates in disease model of interest.</p>
</dd>
<dt>W</dt>
<dd>
<p>Covariates in model for patient inclusion in analytical dataset
(selection model).</p>
</dd>
<dt>X</dt>
<dd>
<p>Covariates in model for probability of observing disease given
patient has disease (sensitivity model).</p>
</dd>
</dl>
<p>Model Structure:
</p>

<dl>
<dt>Disease Model</dt>
<dd>
<p style="text-align: center;"><code class="reqn">logit(P(D=1|X)) = theta_0 + theta_Z Z</code>
</p>
</dd>
<dt>Selection Model</dt>
<dd>
<p style="text-align: center;"><code class="reqn">P(S=1|W,D)</code>
</p>
</dd>
<dt>Sensitivity Model</dt>
<dd>
<p style="text-align: center;"><code class="reqn">logit(P(D* = 1| D = 1, S = 1, X)) = beta_0 + beta_X X</code>
</p>
</dd>
</dl>
<h3>Value</h3>

<p>a list with two elements: (1) 'c_marg', marginal sensitivity estimate
<code class="reqn">P(D* = 1|D = 1, S = 1)</code>, and (2) 'c_X', sensitivity as a function of
X <code class="reqn">P(D* = 1| D = 1, S = 1, X)</code>
</p>


<h3>References</h3>

<p>Statistical inference for association studies using electronic health records:
handling both selection bias and outcome misclassification
Lauren J Beesley and Bhramar Mukherjee
medRxiv <a href="https://doi.org/10.1101/2019.12.26.19015859">2019.12.26.19015859</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SAMBA)
# These examples are generated from the vignette. See it for more details.

# Generate IPW weights from the true model
expit &lt;- function(x) exp(x) / (1 + exp(x))
prob.WD &lt;- expit(-0.6 + 1 * samba.df$D + 0.5 * samba.df$W)
weights &lt;- nrow(samba.df) * (1  / prob.WD) / (sum(1 / prob.WD))

# Using marginal sampling ratio r ~ 2 and P(D=1)
sens &lt;- sensitivity(samba.df$Dstar, samba.df$X, mean(samba.df$D),
                    r = 2)
# Using inverse probability of selection weights and P(D=1)
sens &lt;- sensitivity(samba.df$Dstar, samba.df$X, prev = mean(samba.df$D),
                    weights = weights)
</code></pre>


</div>