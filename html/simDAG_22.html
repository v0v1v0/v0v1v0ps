<div class="container">

<table style="width: 100%;"><tr>
<td>node_negative_binomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a Node Using Negative Binomial Regression
</h2>

<h3>Description</h3>

<p>Data from the parents is used to generate the node using negative binomial regression by applying the betas to the design matrix and sampling from the <code>rnbinom</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">node_negative_binomial(data, parents, formula=NULL, betas,
                       intercept, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A <code>data.table</code> (or something that can be coerced to a <code>data.table</code>) containing all columns specified by <code>parents</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>

<p>A character vector specifying the names of the parents that this particular child node has. If non-linear combinations or interaction effects should be included, the user may specify the <code>formula</code> argument instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An optional <code>formula</code> object to describe how the node should be generated or <code>NULL</code> (default). If supplied it should start with <code>~</code>, having nothing else on the left hand side. The right hand side may contain any valid formula syntax, such as <code>A + B</code> or <code>A + B + I(A^2)</code>, allowing non-linear effects. If this argument is defined, there is no need to define the <code>parents</code> argument. For example, using <code>parents=c("A", "B")</code> is equal to using <code>formula= ~ A + B</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>

<p>A numeric vector with length equal to <code>parents</code>, specifying the causal beta coefficients used to generate the node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>A single number specifying the intercept that should be used when generating the node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>A single number specifying the theta parameter (<code>size</code> argument in <code>rnbinom</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the linear predictor defined by the <code>betas</code> and the input design matrix to sample from a subject-specific negative binomial distribution. It does to by calculating the linear predictor using the <code>data</code>, <code>betas</code> and <code>intercept</code>, exponentiating it and passing it to the <code>mu</code> argument of the <code>rnbinom</code> function of the <span class="pkg">stats</span> package.
</p>


<h3>Value</h3>

<p>Returns a numeric vector of length <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Robin Denz
</p>


<h3>See Also</h3>

<p><code>empty_dag</code>, <code>node</code>, <code>node_td</code>, <code>sim_from_dag</code>, <code>sim_discrete_time</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(simDAG)

set.seed(124554)

dag &lt;- empty_dag() +
  node("age", type="rnorm", mean=50, sd=4) +
  node("sex", type="rbernoulli", p=0.5) +
  node("smoking", type="negative_binomial", theta=0.05,
       formula= ~ -2 + sexTRUE*1.1 + age*0.4)

sim_dat &lt;- sim_from_dag(dag=dag, n_sim=100, sort_dag=FALSE)
</code></pre>


</div>