<div class="container">

<table style="width: 100%;"><tr>
<td>simTOcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Multi-Season Single-Species Detection-Nondetection Data</h2>

<h3>Description</h3>

<p>The function <code>simTOcc</code> simulates multi-season single-species occurrence data for simulation studies, power assessments, or function testing. Data can be optionally simulated with a spatial Gaussian Process in the occurrence portion of the model. Non-spatial random intercepts can also be included in the detection or occurrence portions of the occupancy model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simTOcc(J.x, J.y, n.time, n.rep, n.rep.max, beta, alpha, sp.only = 0, trend = TRUE, 
        psi.RE = list(), p.RE = list(), sp = FALSE, svc.cols = 1, cov.model, 
        sigma.sq, phi, nu, ar1 = FALSE, rho, sigma.sq.t, x.positive = FALSE, 
	mis.spec.type = 'none', scale.param = 1, avail, grid, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>J.x</code></td>
<td>
<p>a single numeric value indicating the number of sites to simulate detection-nondetection data along the horizontal axis. Total number of sites with simulated data is <code class="reqn">J.x \times J.y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.y</code></td>
<td>
<p>a single numeric value indicating the number of sites to simulate detection-nondetection data along the vertical axis. Total number of sites with simulated data is <code class="reqn">J.x \times J.y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.time</code></td>
<td>
<p>a single numeric value indicating the number of primary time periods (denoted T) over which sampling occurs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep</code></td>
<td>
<p>a numeric matrix indicating the number of replicates at each site during each primary time period. The matrix must have <code class="reqn">J = J.x \times J.y</code> rows and T columns, where T is the number of primary time periods (e.g., years or seasons) over which sampling occurs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep.max</code></td>
<td>
<p>a single numeric value indicating the maximum number of replicate surveys. This is an optional argument, with its default value set to <code>max(n.rep)</code>. This can be used to generate data sets with different types of missingness (e.g., simulate data across 20 days (replicate surveys) but sites are only sampled a maximum of ten times each).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a numeric vector containing the intercept and regression coefficient parameters for the occupancy portion of the single-species occupancy model. Note that if <code>trend = TRUE</code>, the second value in the vector corresponds to the estimated occurrence trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector containing the intercept and regression coefficient parameters for the detection portion of the single-species occupancy model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.only</code></td>
<td>
<p>a numeric vector specifying which occurrence covariates should only vary over space and not over time. The numbers in the vector correspond to the elements in the vector of regression coefficients (<code>beta</code>). By default, all simulated occurrence covariates are assumed to vary over both space and time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, a temporal trend will be used to simulate the detection-nondetection data and the second element of <code>beta</code> is assumed to be the trend parameter. If <code>FALSE</code> no trend is used to simulate the data and all elements of <code>beta</code> (except the first value which is the intercept) correspond to covariate effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.RE</code></td>
<td>
<p>a list used to specify the unstructured random intercepts included in the occupancy portion of the model. The list must have two tags: <code>levels</code> and <code>sigma.sq.psi</code>. <code>levels</code> is a vector of length equal to the number of distinct random intercepts to include in the model and contains the number of levels there are in each intercept. <code>sigma.sq.psi</code> is a vector of length equal to the number of distinct random intercepts to include in the model and contains the variances for each random effect. An additional tag <code>site.RE</code> can be set to <code>TRUE</code> to simulate data with a site-specific non-spatial random effect on occurrence. If not specified, no random effects are included in the occupancy portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.RE</code></td>
<td>
<p>a list used to specify the unstructured random intercepts included in the detection portion of the model. The list must have two tags: <code>levels</code> and <code>sigma.sq.p</code>. <code>levels</code> is a vector of length equal to the number of distinct random intercepts to include in the model and contains the number of levels there are in each intercept. <code>sigma.sq.p</code> is a vector of length equal to the number of distinct random intercepts to include in the model and contains the variances for each random effect. If not specified, no random effects are included in the detection portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>a logical value indicating whether to simulate a spatially-explicit occupancy model with a Gaussian process. By default set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svc.cols</code></td>
<td>
<p>a vector indicating the variables whose effects will be
estimated as spatially-varying coefficients. <code>svc.cols</code> is an
integer vector with values indicating the order of covariates specified
in the model formula (with 1 being the intercept if specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.model</code></td>
<td>
<p>a quoted keyword that specifies the covariance function used to model the spatial dependence structure among the latent occurrence values.  Supported covariance model key words are: <code>"exponential"</code>, <code>"matern"</code>, <code>"spherical"</code>, and <code>"gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq</code></td>
<td>
<p>a numeric value indicating the spatial variance parameter. Ignored when <code>sp = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>a numeric value indicating the spatial decay parameter. Ignored when <code>sp = FALSE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a numeric value indicating the spatial smoothness parameter. Only used when <code>sp = TRUE</code> and <code>cov.model = "matern"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar1</code></td>
<td>
<p>a logical value indicating whether to simulate a temporal random effect with an AR(1) process. By default, set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a numeric value indicating the AR(1) temporal correlation parameter. Ignored when <code>ar1 = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq.t</code></td>
<td>
<p>a numeric value indicating the AR(1) temporal variance parameter. Ignored when <code>ar1 = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.positive</code></td>
<td>
<p>a logical value indicating whether the simulated covariates should be simulated as random standard normal covariates (<code>x.positive = FALSE</code>) or restricted to positive values (<code>x.positive = TRUE</code>). If <code>x.positive = TRUE</code>, covariates are simulated from a random normal and then the minimum value is added to each covariate value to ensure non-negative covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mis.spec.type</code></td>
<td>
<p>a quoted keyword indicating the type of model mis-specification to use when simulating the data. These correspond to model mis-specification of the functional relationship between occupancy/detection probability and covariates. Valid keywords are: <code>"none"</code> (no model mis-specification, i.e., logit link), <code>"scale"</code> (scaled logistic link), <code>"line"</code> (linear link), and <code>"probit"</code> (probit link). Defaults to <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.param</code></td>
<td>
<p>a positive number between 0 and 1 that indicates the scale parameter for the occupancy portion of the model when <code>mis.spec.type = 'scale'</code>. When specified, <code>scale.param</code> corresponds to the scale parameter for the occupancy portion of the model, while the reciprocal of <code>scale.param</code> is used for the detection portion of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avail</code></td>
<td>
<p>a site x primary time period x visit array indicating the availability probability of the species during each survey simulated at the given site/primary time period/visit combination. This can be used to assess impacts of non-constant availability across replicate surveys in simulation studies. Values should fall between 0 and 1. When not specified, availability is set to 1 for all surveys.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an atomic vector used to specify the grid across which to simulate the latent spatial processes. This argument is used to simulate the underlying spatial processes at a different resolution than the coordinates (e.g., if coordinates are distributed across a grid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently no additional arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list comprised of: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code class="reqn">J \times T \times p.occ</code> numeric array containing the design matrix for the occurrence portion of the occupancy model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.p</code></td>
<td>
<p>a four-dimensional numeric array with dimensions corresponding to sites, primary time periods, repeat visits, and number of detection regression coefficients. This is the design matrix used for the detection portion of the occupancy model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>a <code class="reqn">J \times 2</code> numeric matrix of coordinates of each occupancy site. Required for spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a <code class="reqn">J \times 1</code> matrix of the spatial random effects. Only used to simulate data when <code>sp = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>a <code class="reqn">J \times T</code> matrix of the occupancy probabilities for each site during each primary time period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a  <code class="reqn">J \times T</code> matrix of the latent occupancy states at each site during each primary time period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a <code>J x T x max(n.rep)</code> array of the detection probabilities for each site, primary time period, and replicate combination. Site/time periods with fewer than <code>max(n.rep)</code> replicates will contain <code>NA</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>J x T x max(n.rep)</code> array of the raw detection-nondetection data for each sit, primary time period, and replicate combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.p.re</code></td>
<td>
<p>a four-dimensional numeric array containing the levels of any detection random effect included in the model. Only relevant when detection random effects are specified in <code>p.RE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.re</code></td>
<td>
<p>a numeric matrix containing the levels of any occurrence random effect included in the model. Only relevant when occurrence random effects are specified in <code>psi.RE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.star</code></td>
<td>
<p>a numeric vector that contains the simulated detection random effects for each given level of the random effects included in the detection model. Only relevant when detection random effects are included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.star</code></td>
<td>
<p>a numeric vector that contains the simulated occurrence random effects for each given level of the random effects included in the occurrence model. Only relevant when occurrence random effects are included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>a <code class="reqn">T \times 1</code> matrix of the latent AR(1) random effects. Only included when <code>ar1 = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeffrey W. Doser <a href="mailto:doserjef@msu.edu">doserjef@msu.edu</a>, <br></p>


<h3>References</h3>

<p>Stoudt, S., P. de Valpine, and W. Fithian. Non-parametric identifiability in species distribution and abundance models: why it matters and how to diagnose a lack of fit using simulation. Journal of Statistical Theory and Practice 17, 39 (2023). https://doi.org/10.1007/s42519-023-00336-5.
</p>


<h3>Examples</h3>

<pre><code class="language-R">J.x &lt;- 10
J.y &lt;- 10
J &lt;- J.x * J.y
# Number of time periods sampled
n.time &lt;- sample(10, J, replace = TRUE)
n.time.max &lt;- max(n.time)
# Replicates
n.rep &lt;- matrix(NA, J, max(n.time))
for (j in 1:J) {
  n.rep[j, 1:n.time[j]] &lt;- sample(1:4, n.time[j], replace = TRUE)
}
# Occurrence --------------------------
# Fixed
beta &lt;- c(0.4, 0.5, -0.9)
trend &lt;- TRUE 
sp.only &lt;- 0
psi.RE &lt;- list(levels = c(10), 
               sigma.sq.psi = c(1))
# Detection ---------------------------
alpha &lt;- c(-1, 0.7, -0.5)
p.RE &lt;- list(levels = c(10), 
             sigma.sq.p = c(0.5))
# Spatial parameters ------------------
sp &lt;- TRUE
cov.model &lt;- "exponential"
sigma.sq &lt;- 2
phi &lt;- 3 / .4
nu &lt;- 1
# Temporal parameters -----------------
ar1 &lt;- TRUE
rho &lt;- 0.5
sigma.sq.t &lt;- 0.8
# Get all the data
dat &lt;- simTOcc(J.x = J.x, J.y = J.y, n.time = n.time, n.rep = n.rep, 
               beta = beta, alpha = alpha, sp.only = sp.only, trend = trend, 
               psi.RE = psi.RE, p.RE = p.RE, 
               sp = sp, cov.model = cov.model, sigma.sq = sigma.sq, phi = phi, 
               ar1 = ar1, rho = rho, sigma.sq.t = sigma.sq.t)
str(dat)
</code></pre>


</div>