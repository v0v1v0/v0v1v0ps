<div class="container">

<table style="width: 100%;"><tr>
<td>simexaft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> SIMEX Algorithm for Accelerated Failure Time Model with Covariates Subject to Measurement Error </h2>

<h3>Description</h3>

<p>Implementation of the SIMEX algorithm for Accelerated Failure Time model with covariates subject to measurement error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simexaft(formula = formula(data), data = parent.frame(), 
        SIMEXvariable, repeated = FALSE, repind = list(), 
        err.mat = err.mat, B = 50, lambda = seq(0, 2, 0.1), 
        extrapolation = "quadratic", dist = "weibull")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> specifies the model to be fitted, with the variables coming with data. This argument has the same format as the formula argument in the existing R function "survreg". </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> optional data frame in which to interpret the varialbes occurring in the formula.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIMEXvariable</code></td>
<td>
<p> the index of the covariate variables that are subject to measurement error. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated</code></td>
<td>
<p> set to TRUE or FALSE to indicate if there are repeated measurements for the mis-measured variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repind</code></td>
<td>
<p> the index of the repeated measurement variables for each mis-measured variable. It has an R list form. If repeated = TRUE, repind must be specify.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.mat</code></td>
<td>
<p> specifies the variables with measurement error, If repeated = FALSE, err.mat must be specify. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> the number of simulated samples for the simulation step. The default is set to be 50.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> the vector of lambdas, the grids for the extrapolation step.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolation</code></td>
<td>
<p> specifies the function form for the extrapolation step. The options are linear, quadratic and both. The default is set to be quadratic.(first 4 letters are enough) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p> specifies a parametric distribution that is assumed in AFT model. This argument is the same as the dist option in the existing R function "survreg". These include "weibull", "exponential", "gaussian", "logistic", "lognormal", and "loglogistic". </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the SIMEXvariable is repeated measured then you only need to use arguments 
repeated and repind without mention err.mat. The summary.simex will contain repind. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>the corrected coefficients of the AFT model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the standard deviation of each coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>the p-value for the hypothesis of that coefficient equal zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalreg</code></td>
<td>
<p>the estimate of the scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the estimates for every B and lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> the vector of lambdas for which the simulation step should be done</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> the number of simulated samples for the simulation step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> the model to be fitted in the survreg function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.mat</code></td>
<td>
<p> the covariance matrix of the variables with measurement error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repind</code></td>
<td>
<p> the list contiains the names of the repeat measument variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolation</code></td>
<td>
<p> the extrapolation method: linear ,quadratic are implemented (first 4 letters are enough)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIMEXvariable</code></td>
<td>
<p> the vector contains the names of the variables with meansurement error</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Juan Xiong, Wenqing He and Grace Y. Yi</p>


<h3>References</h3>

<p>Genz, A., Bretz, F., Miwa, T., Mi, X., Leisch, F., Scheipl, F. and Hothorn, T. (2011). mvtnorm: Multivariate Normal and t Distributions. R package version 0.9-9991, URL http://CRAN.
R-project.org/package=mvtnorm.
</p>
<p>He, W., Yi, G. Y. and Xiong, J. (2007). Accelerated Failure Time Models with Covariates Subject to Measurement Error. <em>Statistics in Medicine</em>, 26, 4817-4832.
</p>
<p>Therneau, T. and Lumley, T. (2011). survival: Survival Analysis, Including Penalised Likelihood. R package version 2.36-10, URL http://CRAN.R-project.org/package=survival.
</p>


<h3>See Also</h3>

<p><code>survreg</code>, <code>plotsimexaft</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library("simexaft")
library("survival")
data("BHS")

dataset &lt;- BHS

dataset$SBP &lt;- log(dataset$SBP - 50)

###Naive AFT approach
formula &lt;- Surv(SURVTIME,DTHCENS) ~ SBP + CHOL + AGE + BMI + SMOKE1 + SMOKE2

out1 &lt;- survreg(formula = formula, data = dataset, dist = "weibull")

summary(out1)


###fit a AFT model with quadratic extrapolation
set.seed(120)

ind &lt;- c("SBP", "CHOL")

err.mat &lt;- diag(rep(0.5625, 2))

out2 &lt;- simexaft(formula = formula, data = dataset, SIMEXvariable = ind, 
        repeated = FALSE, repind = list(), err.mat = err.mat, B = 50,
        lambda = seq(0, 2, 0.1),extrapolation = "quadratic", dist = "weibull")

summary(out2)







    #################### repeated measurements #################################
    data("rhDNase")

    ###true model
    rhDNase$fev.ave &lt;- (rhDNase$fev + rhDNase$fev2)/2

    output1 &lt;- survreg(Surv(time2, status) ~ trt + fev.ave, data = rhDNase, 
                    dist = "weibull")

    summary(output1)


    ####sensitive analysis#####
    set.seed(120)

    fev.error &lt;- rhDNase$fev + rnorm(length(rhDNase$fev), mean = 0, 
                                    sd = 0.15 * sd(rhDNase$fev))

    fev.error2 &lt;- rhDNase$fev2 + rnorm(length(rhDNase$fev2),mean = 0, 
                                    sd = 0.15 * sd(rhDNase$fev2))

    dataset2 &lt;- cbind(rhDNase[, c("time2", "status", "trt")], fev.error, fev.error2)

    formula &lt;- Surv(time2, status) ~ trt + fev.error

    ind &lt;- "fev.error"


    ########naive model using the average FEV value####################
    fev.error.c &lt;- (fev.error + fev.error2)/2

    output2 &lt;- survreg(Surv(time2, status) ~ trt + fev.error.c, data = rhDNase, 
                    dist = "weibull")

    summary(output2)


    ######use simexaft and apply the quadratic extrapolation######
    formula &lt;- Surv(time2, status) ~ trt + fev.error

    output3 &lt;- simexaft(formula = formula, data = dataset2, SIMEXvariable = ind, 
            repeated=TRUE,repind=list(c("fev.error", "fev.error2")), err.mat=NULL, 
            B=50, lambda=seq(0,2, 0.1), extrapolation="quadratic", dist="weibull")
            
    summary(output3)


</code></pre>


</div>