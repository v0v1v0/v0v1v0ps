<div class="container">

<table style="width: 100%;"><tr>
<td>xewma.arl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ARLs of EWMA control charts</h2>

<h3>Description</h3>

<p>Computation of the (zero-state) Average Run Length (ARL)
for different types of EWMA control charts monitoring normal mean.</p>


<h3>Usage</h3>

<pre><code class="language-R">xewma.arl(l,cE,mu,zr=0,hs=0,sided="one",limits="fix",q=1,
steady.state.mode="conditional",r=40)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cE</code></td>
<td>
<p>critical value (similar to alarm limit) of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>true mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>reflection border for the one-sided chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (enables fast initial response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between one- and two-sided EWMA control chart 
by choosing <code>"one"</code> and <code>"two"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>distinguishes between different control limits behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>change point position. For <code class="reqn">q=1</code> and
<code class="reqn">\mu=\mu_0</code> and <code class="reqn">\mu=\mu_1</code>, the usual
zero-state ARLs for the in-control and out-of-control case, respectively,
are calculated. For <code class="reqn">q&gt;1</code> and <code class="reqn">\mu!=0</code> conditional delays, that is,
<code class="reqn">E_q(L-q+1|L\ge q)</code>, will be determined. Note that mu0=0 is implicitely fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steady.state.mode</code></td>
<td>
<p>distinguishes between two steady-state modes â€“ conditional and cyclical
(needed for <code>q&gt;1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of quadrature nodes, dimension of the resulting linear
equation system is equal to <code>r+1</code> (one-sided) or <code>r</code>
(two-sided).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In case of the EWMA chart with fixed control limits,
<code>xewma.arl</code> determines the Average Run Length (ARL) by numerically
solving the related ARL integral equation by means of the Nystroem method
based on Gauss-Legendre quadrature.
If <code>limits</code> is not <code>"fix"</code>, then the method presented in Knoth (2003) is utilized.
Note that for one-sided EWMA charts (<code>sided</code>=<code>"one"</code>), only
<code>"vacl"</code> and <code>"stat"</code> are deployed, while for two-sided ones
(<code>sided</code>=<code>"two"</code>) also <code>"fir"</code>, <code>"both"</code>
(combination of <code>"fir"</code> and <code>"vacl"</code>), <code>"Steiner"</code> and <code>"cfar"</code> are implemented.
For details see Knoth (2004).
</p>


<h3>Value</h3>

<p>Except for the fixed limits EWMA charts it returns a single value which resembles the ARL.
For fixed limits charts, it returns a vector of length <code>q</code> which resembles the ARL and the
sequence of conditional expected delays for
<code>q</code>=1 and <code>q</code>&gt;1, respectively.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>K.-H. Waldmann (1986),
Bounds for the distribution of the run length of geometric moving 
average charts, <em>Appl. Statist. 35</em>, 151-158.
</p>
<p>S. V. Crowder (1987),
A simple method for studying run-length distributions of
exponentially weighted moving average charts,
<em>Technometrics 29</em>, 401-407.
</p>
<p>J. M. Lucas and M. S. Saccucci (1990),
Exponentially weighted moving average control schemes: Properties
and enhancements, <em>Technometrics 32</em>, 1-12.
</p>
<p>S. Chandrasekaran, J. R. English and R. L. Disney (1995), 
Modeling and analysis of EWMA control schemes with variance-adjusted 
control limits, <em>IIE Transactions 277</em>, 282-290.
</p>
<p>T. R. Rhoads, D. C. Montgomery and C. M. Mastrangelo (1996),
Fast initial response scheme for exponentially weighted moving average
control chart, <em>Quality Engineering 9</em>, 317-327.
</p>
<p>S. H. Steiner (1999),
EWMA control charts with time-varying control limits and fast initial response, 
<em>Journal of Quality Technology 31</em>, 75-86.
</p>
<p>S. Knoth (2003),
EWMA schemes with non-homogeneous transition kernels,
<em>Sequential Analysis 22</em>, 241-255.
</p>
<p>S. Knoth (2004),
Fast initial response features for EWMA Control Charts,
<em>Statistical Papers 46</em>, 47-64.
</p>


<h3>See Also</h3>

<p><code>xcusum.arl</code> for zero-state ARL computation of CUSUM control charts
and <code>xewma.ad</code> for the steady-state ARL.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Waldmann (1986), one-sided EWMA
l &lt;- .75
round(xewma.arl(l,2*sqrt((2-l)/l),0,zr=-4*sqrt((2-l)/l)),digits=1)
l &lt;- .5
round(xewma.arl(l,2*sqrt((2-l)/l),0,zr=-4*sqrt((2-l)/l)),digits=1)
## original values are 209.3 and 3907.5 (in Table 2).

## Waldmann (1986), two-sided EWMA with fixed control limits
l &lt;- .75
round(xewma.arl(l,2*sqrt((2-l)/l),0,sided="two"),digits=1)
l &lt;- .5
round(xewma.arl(l,2*sqrt((2-l)/l),0,sided="two"),digits=1)
## original values are 104.0 and 1952 (in Table 1).

## Crowder (1987), two-sided EWMA with fixed control limits
l1 &lt;- .5
l2 &lt;- .05
cE &lt;- 2
mu &lt;- (0:16)/4
arl1 &lt;- sapply(mu,l=l1,cE=cE,sided="two",xewma.arl)
arl2 &lt;- sapply(mu,l=l2,cE=cE,sided="two",xewma.arl)
round(cbind(mu,arl1,arl2),digits=2)

## original results are (in Table 1)
## 0.00 26.45 127.53
## 0.25 20.12  43.94
## 0.50 11.89  18.97
## 0.75  7.29  11.64
## 1.00  4.91   8.38
## 1.25  3.95*  6.56
## 1.50  2.80   5.41
## 1.75  2.29   4.62
## 2.00  1.94   4.04
## 2.25  1.70   3.61
## 2.50  1.51   3.26
## 2.75  1.37   2.99
## 3.00  1.26   2.76
## 3.25  1.18   2.56
## 3.50  1.12   2.39
## 3.75  1.08   2.26
## 4.00  1.05   2.15  (* -- in Crowder (1987) typo!?)

## Lucas/Saccucci (1990)
## two-sided EWMA

## with fixed limits
l1 &lt;- .5
l2 &lt;- .03
c1 &lt;- 3.071
c2 &lt;- 2.437
mu &lt;- c(0,.25,.5,.75,1,1.5,2,2.5,3,3.5,4,5)
arl1 &lt;- sapply(mu,l=l1,cE=c1,sided="two",xewma.arl)
arl2 &lt;- sapply(mu,l=l2,cE=c2,sided="two",xewma.arl)
round(cbind(mu,arl1,arl2),digits=2)

## original results are (in Table 3)
## 0.00 500.   500.
## 0.25 255.    76.7
## 0.50  88.8   29.3
## 0.75  35.9   17.6
## 1.00  17.5   12.6
## 1.50   6.53   8.07
## 2.00   3.63   5.99
## 2.50   2.50   4.80
## 3.00   1.93   4.03
## 3.50   1.58   3.49
## 4.00   1.34   3.11
## 5.00   1.07   2.55

## Not run: 
## with fir feature
l1 &lt;- .5
l2 &lt;- .03
c1 &lt;- 3.071
c2 &lt;- 2.437
hs1 &lt;- c1/2
hs2 &lt;- c2/2
mu &lt;- c(0,.5,1,2,3,5)
arl1 &lt;- sapply(mu,l=l1,cE=c1,hs=hs1,sided="two",limits="fir",xewma.arl)
arl2 &lt;- sapply(mu,l=l2,cE=c2,hs=hs2,sided="two",limits="fir",xewma.arl)
round(cbind(mu,arl1,arl2),digits=2)

## original results are (in Table 5)
## 0.0 487.   406.
## 0.5  86.1   18.4
## 1.0  15.9    7.36
## 2.0   2.87   3.43
## 3.0   1.45   2.34
## 5.0   1.01   1.57

## Chandrasekaran, English, Disney (1995)
## two-sided EWMA with fixed and variance adjusted limits (vacl)

l1 &lt;- .25
l2 &lt;- .1
c1s &lt;- 2.9985
c1n &lt;- 3.0042
c2s &lt;- 2.8159
c2n &lt;- 2.8452
mu &lt;- c(0,.25,.5,.75,1,2)
arl1s &lt;- sapply(mu,l=l1,cE=c1s,sided="two",xewma.arl)
arl1n &lt;- sapply(mu,l=l1,cE=c1n,sided="two",limits="vacl",xewma.arl)
arl2s &lt;- sapply(mu,l=l2,cE=c2s,sided="two",xewma.arl)
arl2n &lt;- sapply(mu,l=l2,cE=c2n,sided="two",limits="vacl",xewma.arl)
round(cbind(mu,arl1s,arl1n,arl2s,arl2n),digits=2)

## original results are (in Table 2)
## 0.00 500.   500.   500.   500.
## 0.25 170.09 167.54 105.90  96.6
## 0.50  48.14  45.65  31.08  24.35
## 0.75  20.02  19.72  15.71  10.74
## 1.00  11.07   9.37  10.23   6.35
## 2.00   3.59   2.64   4.32   2.73

## The results in Chandrasekaran, English, Disney (1995) are not
## that accurate. Let us consider the more appropriate comparison

c1s &lt;- xewma.crit(l1,500,sided="two")
c1n &lt;- xewma.crit(l1,500,sided="two",limits="vacl")
c2s &lt;- xewma.crit(l2,500,sided="two")
c2n &lt;- xewma.crit(l2,500,sided="two",limits="vacl")
mu &lt;- c(0,.25,.5,.75,1,2)
arl1s &lt;- sapply(mu,l=l1,cE=c1s,sided="two",xewma.arl)
arl1n &lt;- sapply(mu,l=l1,cE=c1n,sided="two",limits="vacl",xewma.arl)
arl2s &lt;- sapply(mu,l=l2,cE=c2s,sided="two",xewma.arl)
arl2n &lt;- sapply(mu,l=l2,cE=c2n,sided="two",limits="vacl",xewma.arl)
round(cbind(mu,arl1s,arl1n,arl2s,arl2n),digits=2)

## which demonstrate the abilities of the variance-adjusted limits
## scheme more explicitely.

## Rhoads, Montgomery, Mastrangelo (1996)
## two-sided EWMA with fixed and variance adjusted limits (vacl),
## with fir and both features

l &lt;- .03
cE &lt;- 2.437
mu &lt;- c(0,.5,1,1.5,2,3,4)
sl &lt;- sqrt(l*(2-l))
arlfix  &lt;- sapply(mu,l=l,cE=cE,sided="two",xewma.arl)
arlvacl &lt;- sapply(mu,l=l,cE=cE,sided="two",limits="vacl",xewma.arl)
arlfir  &lt;- sapply(mu,l=l,cE=cE,hs=c/2,sided="two",limits="fir",xewma.arl)
arlboth &lt;- sapply(mu,l=l,cE=cE,hs=c/2*sl,sided="two",limits="both",xewma.arl)
round(cbind(mu,arlfix,arlvacl,arlfir,arlboth),digits=1)

## original results are (in Table 1)
## 0.0 477.3* 427.9* 383.4* 286.2*
## 0.5  29.7   20.0   18.6   12.8
## 1.0  12.5    6.5    7.4    3.6
## 1.5   8.1    3.3    4.6    1.9
## 2.0   6.0    2.2    3.4    1.4
## 3.0   4.0    1.3    2.4    1.0
## 4.0   3.1    1.1    1.9    1.0
## * -- the in-control values differ sustainably from the true values!

## Steiner (1999)
## two-sided EWMA control charts with various modifications

## fixed vs. variance adjusted limits

l &lt;- .05
cE &lt;- 3
mu &lt;- c(0,.25,.5,.75,1,1.5,2,2.5,3,3.5,4)
arlfix &lt;- sapply(mu,l=l,cE=cE,sided="two",xewma.arl)
arlvacl &lt;- sapply(mu,l=l,cE=cE,sided="two",limits="vacl",xewma.arl)
round(cbind(mu,arlfix,arlvacl),digits=1)

## original results are (in Table 2)
## 0.00 1379.0   1353.0
## 0.25  135.0    127.0
## 0.50   37.4     32.5 
## 0.75   20.0     15.6
## 1.00   13.5      9.0
## 1.50    8.3      4.5
## 2.00    6.0      2.8
## 2.50    4.8      2.0
## 3.00    4.0      1.6
## 3.50    3.4      1.3
## 4.00    3.0      1.1

## fir, both, and Steiner's modification

l &lt;- .03
cfir &lt;- 2.44
cboth &lt;- 2.54
cstein &lt;- 2.55
hsfir &lt;- cfir/2
hsboth &lt;- cboth/2*sqrt(l*(2-l))
mu &lt;- c(0,.5,1,1.5,2,3,4)
arlfir &lt;- sapply(mu,l=l,cE=cfir,hs=hsfir,sided="two",limits="fir",xewma.arl)
arlboth &lt;- sapply(mu,l=l,cE=cboth,hs=hsboth,sided="two",limits="both",xewma.arl)
arlstein &lt;- sapply(mu,l=l,cE=cstein,sided="two",limits="Steiner",xewma.arl)
round(cbind(mu,arlfir,arlboth,arlstein),digits=1)

## original values are (in Table 5)
## 0.0 383.0   384.0   391.0
## 0.5  18.6    14.9    13.8
## 1.0   7.4     3.9     3.6
## 1.5   4.6     2.0     1.8
## 2.0   3.4     1.4     1.3
## 3.0   2.4     1.1     1.0
## 4.0   1.9     1.0     1.0

## SAS/QC manual 1999
## two-sided EWMA control charts with fixed limits

l &lt;- .25
cE &lt;- 3
mu &lt;- 1
print(xewma.arl(l,cE,mu,sided="two"),digits=11)

# original value is 11.154267016.

## Some recent examples for one-sided EWMA charts
## with varying limits and in the so-called stationary mode

# 1. varying limits = "vacl"

lambda &lt;- .1
L0 &lt;- 500

## Monte Carlo results (10^9 replicates)
# mu    ARL      s.e.
# 0     500.00   0.0160
# 0.5   21.637   0.0006
# 1     6.7596   0.0001
# 1.5   3.5398   0.0001
# 2     2.3038   0.0000
# 2.5   1.7004   0.0000
# 3     1.3675   0.0000

zr &lt;- -6
r &lt;- 50
cE &lt;- xewma.crit(lambda, L0, zr=zr, limits="vacl", r=r)
Mxewma.arl &lt;- Vectorize(xewma.arl, "mu")
mus &lt;- (0:6)/2
arls &lt;- round(Mxewma.arl(lambda, cE, mus, zr=zr, limits="vacl", r=r), digits=4)
data.frame(mus, arls)

# 2. stationary mode, i. e. limits = "stat"

## Monte Carlo results (10^9 replicates)
# mu    ARL      s.e.
# 0     500.00   0.0159
# 0.5   22.313   0.0006
# 1     7.2920   0.0001
# 1.5   3.9064   0.0001
# 2     2.5131   0.0000
# 2.5   1.7983   0.0000
# 3     1.4029   0.0000

cE &lt;- xewma.crit(lambda, L0, zr=zr, limits="stat", r=r)
arls &lt;- round(Mxewma.arl(lambda, cE, mus, zr=zr, limits="stat", r=r), digits=4)
data.frame(mus, arls)

## End(Not run)
</code></pre>


</div>