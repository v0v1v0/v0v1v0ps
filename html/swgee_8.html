<div class="container">

<table style="width: 100%;"><tr>
<td>swgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation Extrapolation Inverse Probability Weighted Generalized Estimating Equations 
</h2>

<h3>Description</h3>

<p>Implementation of the SIMEX inverse probability weighted GEE method for longitudinal data with missing observations and measurement error in covariates
</p>


<h3>Usage</h3>

<pre><code class="language-R">swgee(formula, data = parent.frame(), id, family = family, 
    corstr = "independence", missingmodel, SIMEXvariable, SIMEX.err, 
    repeated = FALSE, repind = NULL, B = 50, lambda = seq(0, 2, 0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>specifies the model to be fitted, with the variables coming with data. This argument has the same format as the formula argument in the function <code>geeglm</code> from
package <span class="pkg">geepack</span>, of the form <code>response ~ predictors</code>. See documentation of <code>geeglm</code> and <code>formula</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to interpret the variables occurring in the formula, along with the id variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>a vector which identifies the clusters. The length of id should be the same as the number of observations. Data are assumed to be sorted so that observations 
on a cluster are contiguous rows for all entities in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a family object as the family argument in the function <code>gee</code> from package <span class="pkg">gee</span>. Families supported in <code>swgee</code> are <code>gaussian</code>, 
<code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, and <code>quasi</code>. See documentation of <code>gee</code> and <code>family</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character string specifying the correlation structure. The following are permitted: <code>"independence"</code>, <code>"fixed"</code>, <code>"stat_M_dep"</code>, 
<code>"non_stat_M_dep"</code>, <code>"exchangeable"</code>, <code>"AR-M"</code> and <code>"unstructured"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingmodel</code></td>
<td>
<p>specifies the misisng model to be fitted, of the form <code>O~ predictors</code>, where O is the missing data indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIMEXvariable</code></td>
<td>
<p>a vector of characters containing the name of the covariates subject to measurement error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIMEX.err</code></td>
<td>
<p>specifies the covariance matrix of measurement errors in error model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated</code></td>
<td>
<p>This is the indicator if there are repeated measurements for the covariates with measurement error. The default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repind</code></td>
<td>
<p>This is the index of the repeated measurement variables for each covariate with measurement error. It has an R list form. If repeated = TRUE, repind must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of simulated samples for the simulation step. The default is set to be 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector of lambdas for which the simulation step should be done.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The quadratic extrapolation method is implemented as described in Cook and Stefanski
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>correlation structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIMEXvariable</code></td>
<td>
<p>a vector of characters containing the name of the covariates subject to measurement error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the coefficients associated with the response process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the coefficients associated with the missing process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simex.plot</code></td>
<td>
<p>the estimates for every B and lambda</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juan Xiong&lt;jxiong@szu.edu.cn&gt;, Grace Y. Yi&lt;yyi@uwaterloo.ca&gt;
</p>


<h3>References</h3>

<p>Cook, J.R. and Stefanski, L.A. (1994) Simulation-extrapolation estimation in parametric measurement error models. <em>Journal of the American Statistical Association</em>, 89, 1314-1328.
</p>
<p>Carrol, R.J., Ruppert, D., Stefanski, L.A. and Crainiceanu, C. (2006) Measurement error in nonlinear models: A modern perspective., Second Edition. London: Chapman and Hall.
</p>
<p>Yi, G. Y. (2008) A simulation-based marginal method for longitudinal data with dropout and mismeasured covariates. <em>Biostatistics</em>, 9, 501-512.
</p>


<h3>See Also</h3>

<p><code>geeglm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">require(gee)
data(BMI)
bmidata &lt;- BMI

rho &lt;- 0
sigma1 &lt;- 0.5
sigma2 &lt;- 0.5

sigma &lt;- matrix(0,2,2)
sigma[1,1] &lt;- sigma1*sigma1
sigma[1,2] &lt;- rho*sigma1*sigma2
sigma[2,1] &lt;- sigma[1,2]
sigma[2,2] &lt;- sigma2*sigma2

set.seed(1000)
##naive method, ignore missingness and measurement error 
output1 &lt;- gee(bbmi~sbp+chol+age, id = id, data = bmidata,
            family = binomial(link="logit"), corstr = "independence")

##swgee method ##########
output2 &lt;- swgee(bbmi~sbp+chol+age, data = bmidata, id = id, 
            family = binomial(link="logit"),corstr = "independence", 
            missingmodel = O~bbmi+sbp+chol+age, SIMEXvariable = c("sbp","chol"), 
            SIMEX.err = sigma, repeated = FALSE, B = 20, lambda = seq(0, 2, 0.5))

summary(output2)
</code></pre>


</div>