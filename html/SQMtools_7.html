<div class="container">

<table style="width: 100%;"><tr>
<td>loadSQM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load a SqueezeMeta project into R</h2>

<h3>Description</h3>

<p>This function takes the path to a project directory generated by <a href="https://github.com/jtamames/SqueezeMeta">SqueezeMeta</a> (whose name is specified in the <code>-p</code> parameter of the SqueezeMeta.pl script) and parses the results into a SQM object. Alternatively, it can load the project data from a zip file produced by <code>sqm2zip.py</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loadSQM(
  project_path,
  tax_mode = "prokfilter",
  trusted_functions_only = FALSE,
  engine = "data.table"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>project_path</code></td>
<td>
<p>character, project directory generated by SqueezeMeta, or zip file generated by <code>sqm2zip.py</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_mode</code></td>
<td>
<p>character, which taxonomic classification should be loaded? SqueezeMeta applies the identity thresholds described in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4005636/">Luo <em>et al.</em>, 2014</a>. Use <code>allfilter</code> for applying the minimum identity threshold to all taxa, <code>prokfilter</code> for applying the threshold to Bacteria and Archaea, but not to Eukaryotes, and <code>nofilter</code> for applying no thresholds at all (default <code>prokfilter</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trusted_functions_only</code></td>
<td>
<p>logical. If <code>TRUE</code>, only highly trusted functional annotations (best hit + best average) will be considered when generating aggregated function tables. If <code>FALSE</code>, best hit annotations will be used (default <code>FALSE</code>). Will only have an effect if the <code>project_dir/results/tables</code> is not already present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>character. Engine used to load the ORFs and contigs tables. Either <code>data.frame</code> or <code>data.table</code> (significantly faster if your project is large). Default <code>data.table</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>SQM object containing the parsed project.
</p>


<h3>Prerequisites</h3>


<p>Run <a href="https://github.com/jtamames/SqueezeMeta">SqueezeMeta</a>! An example call for running it would be:
</p>
<p><code>/path/to/SqueezeMeta/scripts/SqueezeMeta.pl</code><br><code>-m coassembly -f fastq_dir -s samples_file -p project_dir</code>

</p>


<h3>The SQM object structure</h3>


<p>The SQM object is a nested list which contains the following information:
</p>

<table>
<tr>
<td style="text-align: left;">
<b>lvl1</b>         </td>
<td style="text-align: left;"> <b>lvl2</b>               </td>
<td style="text-align: left;"> <b>lvl3</b>          </td>
<td style="text-align: left;"> <b>type</b>             </td>
<td style="text-align: left;"> <b>rows/names</b> </td>
<td style="text-align: left;"> <b>columns</b> </td>
<td style="text-align: left;"> <b>data</b>        </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$orfs</b>        </td>
<td style="text-align: left;"> <b>$table</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>dataframe</em>        </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> misc. data     </td>
<td style="text-align: left;"> misc. data         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$abund</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$bases</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cov</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cpm</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tpm</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> tpm                </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$seqs</b>              </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> sequences          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tax</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character matrix</em> </td>
<td style="text-align: left;"> orfs              </td>
<td style="text-align: left;"> tax. ranks     </td>
<td style="text-align: left;"> taxonomy           </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$contigs</b>     </td>
<td style="text-align: left;"> <b>$table</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>dataframe</em>        </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> misc. data     </td>
<td style="text-align: left;"> misc. data         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$abund</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$bases</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cov</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cpm</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tpm</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> tpm                </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$seqs</b>              </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> sequences          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tax</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character matrix</em> </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> tax. ranks     </td>
<td style="text-align: left;"> taxonomies         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$bins</b>              </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character matrix</em> </td>
<td style="text-align: left;"> contigs           </td>
<td style="text-align: left;"> bin. methods   </td>
<td style="text-align: left;"> bins               </td>
</tr>
<tr>
<td style="text-align: left;">
$bins               </td>
<td style="text-align: left;"> <b>$table</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>dataframe</em>        </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> misc. data     </td>
<td style="text-align: left;"> misc. data         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$length</b>            </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric vector</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> length             </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$abund</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$percent</b>           </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$bases</b>             </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cov</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$cpm</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tax</b>               </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character matrix</em> </td>
<td style="text-align: left;"> bins              </td>
<td style="text-align: left;"> tax. ranks     </td>
<td style="text-align: left;"> taxonomy           </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$taxa</b>        </td>
<td style="text-align: left;"> <b>$superkingdom</b>      </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> superkingdoms     </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> superkingdoms     </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$phylum</b>            </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> phyla             </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> phyla             </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$class</b>             </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> classes           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> classes           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$order</b>             </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orders            </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> orders            </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$family</b>            </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> families          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> families          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$genus</b>             </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> genera            </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> genera            </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$species</b>           </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> species           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$percent</b>      </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> species           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> percentages        </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$functions</b>   </td>
<td style="text-align: left;"> <b>$KEGG</b>              </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$bases</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cov</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$tpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> tpm                </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$copy_number</b>  </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> avg. copies        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$COG</b>               </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$bases</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cov</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$tpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> tpm                </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$copy_number</b>  </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> avg. copies        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$PFAM</b>              </td>
<td style="text-align: left;"> <b>$abund</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (reads) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$bases</b>        </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> abundances (bases) </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cov</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> coverages          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$cpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> covs. / 10^6 reads </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$tpm</b>          </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> tpm                </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$copy_number</b>  </td>
<td style="text-align: left;"> <em>numeric matrix</em>   </td>
<td style="text-align: left;"> PFAM ids          </td>
<td style="text-align: left;"> samples        </td>
<td style="text-align: left;"> avg. copies        </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$total_reads</b> </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>numeric vector</em>   </td>
<td style="text-align: left;"> samples           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> total reads        </td>
</tr>
<tr>
<td style="text-align: left;">
<b>$misc</b>        </td>
<td style="text-align: left;"> <b>$project_name</b>      </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> (empty)           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> project name       </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$samples</b>           </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> (empty)           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> samples            </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tax_names_long</b>    </td>
<td style="text-align: left;"> <b>$superkingdom</b> </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$phylum</b>       </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$class</b>        </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$order</b>        </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$family</b>       </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$genus</b>        </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;">                           </td>
<td style="text-align: left;"> <b>$species</b>      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> short names       </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> full names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$tax_names_short</b>   </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> full names        </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> short names        </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$KEGG_names</b>        </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> KEGG names         </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$KEGG_paths</b>        </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> KEGG ids          </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> KEGG hiararchy     </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$COG_names</b>         </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> COG names          </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$COG_paths</b>         </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> COG hierarchy      </td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> <b>$ext_annot_sources</b> </td>
<td style="text-align: left;">                      </td>
<td style="text-align: left;"> <em>character vector</em> </td>
<td style="text-align: left;"> COG ids           </td>
<td style="text-align: left;"> (n/a)          </td>
<td style="text-align: left;"> external databases </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>If external databases for functional classification were provided to SqueezeMeta via the <code>-extdb</code> argument, the corresponding abundance (reads and bases), coverages, tpm and copy number profiles will be present in <code>SQM$functions</code> (e.g. results for the CAZy database would be present in <code>SQM$functions$CAZy</code>). Additionally, the extended names of the features present in the external database will be present in <code>SQM$misc</code> (e.g. <code>SQM$misc$CAZy_names</code>).

</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## (outside R)
## Run SqueezeMeta on the test data.
 /path/to/SqueezeMeta/scripts/SqueezeMeta.pl -p Hadza -f raw -m coassembly -s test.samples
## Now go into R.
library(SQMtools)
Hadza = loadSQM("Hadza") # Where Hadza is the path to the SqueezeMeta output directory.

## End(Not run)

data(Hadza) # We will illustrate the structure of the SQM object on the test data
# Which are the ten most abundant KEGG IDs in our data?
topKEGG = names(sort(rowSums(Hadza$functions$KEGG$tpm), decreasing=TRUE))[1:11]
topKEGG = topKEGG[topKEGG!="Unclassified"]
# Which functions do those KEGG IDs represent?
Hadza$misc$KEGG_names[topKEGG]
# What is the relative abundance of the Gammaproteobacteria class across samples?
Hadza$taxa$class$percent["Gammaproteobacteria",]
# Which information is stored in the orf, contig and bin tables?
colnames(Hadza$orfs$table)
colnames(Hadza$contigs$table)
colnames(Hadza$bins$table)
# What is the GC content distribution of my metagenome?
boxplot(Hadza$contigs$table[,"GC perc"]) # Not weighted by contig length or abundance!
</code></pre>


</div>