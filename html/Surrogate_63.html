<div class="container">

<table style="width: 100%;"><tr>
<td>mean_S_before_T_plot_scr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness of fit plot for the fitted copula</h2>

<h3>Description</h3>

<p>The <code>mean_S_before_T_plot_scr()</code> and <code>prob_dying_without_progression_plot()</code>
functions build plots to assess the goodness-of-fit of the copula model
fitted by <code>fit_model_SurvSurv()</code>. Specifically, these two functions focus on
the appropriateness of the copula. Note that to assess the appropriateness of
the marginal functions, two other functions are available:
<code>marginal_gof_scr_S_plot()</code> and <code>marginal_gof_scr_T_plot()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mean_S_before_T_plot_scr(fitted_model, plot_method = NULL, grid, treated, ...)

prob_dying_without_progression_plot(
  fitted_model,
  plot_method = NULL,
  grid,
  treated,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted_model</code></td>
<td>
<p>Returned value from <code>fit_model_SurvSurv()</code>. This object
essentially contains the estimated identifiable part of the joint
distribution for the potential outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_method</code></td>
<td>
<p>Defaults to <code>NULL</code>. Should not be modified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Grid of time-points at which the model-based estimated regression
functions, survival functions, or probabilities are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treated</code></td>
<td>
<p>(numeric) Treatment group. Should be <code>0</code> or <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>plot()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Progression Before Death</h3>

<p>If a patient progresses before death, this means that <code class="reqn">S_k &lt; T_k</code>. For
these patients, we can look at the expected progression time given that the
patient has died at <code class="reqn">T_k = t</code>: </p>
<p style="text-align: center;"><code class="reqn">E(S_k | T_k = t, S_k &lt; T_k).</code>
</p>
<p> The
<code>mean_S_before_T_plot_scr()</code> function plots the model-based estimate of this
regression function together with a non-parametric estimate.
</p>
<p>This regression function can also be estimated non-parametrically by
regressing <code class="reqn">S_k</code> onto <code class="reqn">T_k</code> in the subset of uncensored patients.
This non-parametric estimate is obtained via <code>mgcv::gam(y~s(x))</code> with
additionally <code>family = stats::quasi(link = "log", variance = "mu")</code> because
this tends to describe survival data better. The 95% confidence intervals are
added for this non-parametric estimate; although, they should be interpreted
with caution because the Poisson mean-variance relation may be wrong.
</p>


<h3>Death Before Progression</h3>

<p>If a patient dies before progressing, this means that <code class="reqn">S_k = T_k</code>. This
probability can be modeled as a function of time, i.e., </p>
<p style="text-align: center;"><code class="reqn">	\pi_k(t) =
P(S_k = t  \, | \, T_k = t).</code>
</p>
<p> The <code>prob_dying_without_progression_plot()</code>
function plots the model-based estimate of this regression function together
with a non-parametric estimate.
</p>
<p>This regression function can also be estimated non-parametrically by
regressing the censoring indicator for <code class="reqn">S_k</code>, <code class="reqn">\delta_{S_k}</code>,
onto <code class="reqn">T_k</code> in the subset of patients with uncensored <code class="reqn">T_k</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Define grid for GoF plots.
grid = seq(from = 1e-3,
           to = 2.5,
           length.out = 30)
# Assess marginal goodness-of-fit in the control group.
marginal_gof_scr_S_plot(fitted_model, grid = grid, treated = 0)
marginal_gof_scr_T_plot(fitted_model, grid = grid, treated = 0)
# Assess goodness-of-fit of the association structure, i.e., the copula.
prob_dying_without_progression_plot(fitted_model, grid = grid, treated = 0)
mean_S_before_T_plot_scr(fitted_model, grid = grid, treated = 0)
</code></pre>


</div>