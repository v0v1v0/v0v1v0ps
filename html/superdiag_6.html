<div class="container">

<table style="width: 100%;"><tr>
<td>superdiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Markov Chain Nonconvergence</h2>

<h3>Description</h3>

<p>The <code>superdiag</code> function takes MCMC samples as input. It provides a comprehensive
test suite for Markov chain nonconvergence, which integrates five standard
empirical MCMC convergence diagnostics: Gelman-Rubin, Geweke, Heidelberger-Welch,
Raftery-Lewis, Hellinger distance. It can also present trace plots and density
histograms along with the diagnostics as options.
</p>


<h3>Usage</h3>

<pre><code class="language-R">superdiag(
  mcmcoutput,
  burnin,
  terms = "all",
  plot = FALSE,
  confidence.gr = 0.95,
  frac1.gw = 0.1,
  frac2.gw = 0.5,
  eps.hw = 0.1,
  pvalue.hw = 0.05,
  q.rl = 0.025,
  r.rl = 0.005,
  s.rl = 0.95,
  eps.rl = 0.001,
  bins = 5,
  binwidth = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcmcoutput</code></td>
<td>
<p>A <code>mcmc</code> or <code>mcmc.list</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burn-in iterations. Defaults to half of the chain(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The convergence diagnostic methods. Defaults to all five methods.
Users can also specify one or more particular methods chosen from "<code>geweke</code>",
"<code>heidel</code>", "<code>raftery</code>", "<code>gelman</code>", "<code>hellinger</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical values indicates whether a graph of <code>superdiagPlot</code>
should be presented with a run of the function. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence.gr</code></td>
<td>
<p>(1-<code class="reqn">\alpha</code>)% for the Gelman and Rubin test. The upper
95% credible interval is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac1.gw</code></td>
<td>
<p>frac1 for the Geweke test. The proportion of the early era of
the chain, defaulted to 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac2.gw</code></td>
<td>
<p>frac2 for the Geweke test. The proportion of the late era of
the chain, defaulted to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.hw</code></td>
<td>
<p><code>epsilon</code> for the Heidelberger and Welch test. The accuracy
parameter determines whether the halfwidth is passed or not, defaulted to 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue.hw</code></td>
<td>
<p>p-value for the Heidelberger and Welch test. The halfwidth of
the test calculates a (1-<code class="reqn">\alpha</code>)% credible interval around the sample
mean for each parameter dimension. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.rl</code></td>
<td>
<p>q-parameter for the Raftery and Lewis test. The posterior tail threshold
of interest, defaulted to 0.025.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.rl</code></td>
<td>
<p>r-parameter for the Raftery and Lewis test. The tolerance for the
tail threshold, defaulted to 0.0005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.rl</code></td>
<td>
<p>s-parameter for the Raftery and Lewis test. The desired probability
of being within the tolerance, defaulted to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.rl</code></td>
<td>
<p>convergence epsilon for the Raftery and Lewis test. The convergence
tolerance value, which is used to determine a stopping point based on a parallel chain process, defaulted to 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Number of bins for within-chain Hellinger distance test. Defaults to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>Alternative specification for <code>bins</code>. The size of bin for each batch
of the chain(s) for computing the distance between batches.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If only one chain is analyzed, the default settings in <code>boa</code> and
<code>coda</code> for Geweke, Raftery-Lewis, and Heidelberger-Welch diagnostics are
used. If multiple chains are provided, only the first chain uses the defaults
and all other chain analyses get random values as follows. For Geweke test,
random non-overlapping proportions up from the start of the chain and down
from the end of the chain are generated. For Heidelberger-Welch test, the
value of <code>pvalue.hw</code> is sampled with replacement from common <code class="reqn">\alpha</code>
values; the value of <code>eps.hw</code> is sampled uniformly in the interval [0.01:0.2].
For Raftery-Lewis test, each of these four parameters are sample from a vector
(changeable by users) of values around the defaults (larger and smaller) to
provide a reasonable range of alternatives. For Hellinger distance, if only
one chain is analyzed, only within-chain distance will be reported.
</p>


<h3>Value</h3>

<p>A list object including the results for all the diagnostics. A <code>superdiagPlot</code>
including both traceplot(s) and density histogram will also be returned if <code>plot=TRUE</code>.
</p>


<h3>References</h3>

<p>Tsai, Tsung-han and Gill, Jeff (2012). “superdiag: A Comprehensive Test
Suite for Markov Chain Non-Convergence.” <em>The Political Methodologist</em>,
19 (2), 12-18.
</p>
<p>Plummer, Martyn, Nicky Best, Kate Cowles, and Karen Vines (2006). "CODA: convergence
diagnosis and output analysis for MCMC." <em>R news</em>, 6 (1), 7-11.
</p>


<h3>See Also</h3>

<p><code>superdiagPlot</code>, <code>gelman.diag</code>, <code>heidel.diag</code>,
<code>raftery.diag</code>, <code>gelman.diag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

data(tobit.list)
summary(tobit.list[1])

# FOR mcmc.list OBJECT
superdiag(tobit.list, burnin=0)

# FOR mcmc OBJECT
tobit.diag &lt;- superdiag(tobit.list[[1]], burnin=0, plot=TRUE)
tobit.diag

## End(Not run)

</code></pre>


</div>