<div class="container">

<table style="width: 100%;"><tr>
<td>s_soda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
S-SODA algorithm for general index model variable selection
</h2>

<h3>Description</h3>

<p>S-SODA is an extension of SODA to conduct variable selection for general index models with continuous response. S-SODA first evenly discretizes the continuous response into H slices, and then apply SODA on the discretized response. Compared with existing variable selection methods based on the Sliced Inverse Regression (SIR), SODA requires neither the linearity nor the constant variance condition and is much more robust.
</p>


<h3>Usage</h3>

<pre><code class="language-R">s_soda(x, y, H = 5, gam = 0, minF = 3, norm = F, debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The design matrix, of dimensions n * p, without an intercept. Each row is an observation vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The response vector of dimension n * 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>The number of slices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>

<p>EBIC penalization coefficient parameter for SODA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minF</code></td>
<td>

<p>Minimum number of steps in forward interaction screening. Default is minF=3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>

<p>If set as True, S-SODA first marginally quantile-normalize each predictor to the standard normal distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>

<p>If print debug information.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>

<p>Trace of extended Bayesian information criterion (EBIC) score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var</code></td>
<td>

<p>Trace of selected variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Term</code></td>
<td>

<p>Trace of selected main and interaction terms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best_BIC</code></td>
<td>

<p>Final selected term set EBIC score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best_Var</code></td>
<td>

<p>Final selected variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best_Term</code></td>
<td>

<p>Final selected main and interaction terms.
</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># # (uncomment the code to run)
# # Simulation:  x1 / (1 + x2^2) example 
# N = 500
# x1 = runif(N, -3, +3)
# x2 = runif(N, -3, +3)
# x3 = x1 / exp(x2^2) + rnorm(N, 0, 0.2)
# ss = s_soda_model(cbind(x1,x2), x3, H=25)
# 
# # true surface in grid
# MM = 50
# xx1 = seq(-3, +3, length.out = MM)
# xx2 = seq(-3, +3, length.out = MM)
# yyy = matrix(0, MM, MM)
# for(i in 1:MM)
#   for(j in 1:MM)
#     yyy[i,j] = xx1[i] / exp(xx2[j]^2)
# 
# # predicted surface
# ppp = s_soda_pred_grid(xx1, xx2, ss, po=1)
# 
# par(mfrow=c(1, 2), mar=c(1.75, 3, 1.25, 1.5))
# persp(xx1, xx2, yyy, theta=-45, xlab="X1", ylab="X2", zlab="Y")
# persp(xx1, xx2, ppp, theta=-45, xlab="X1", ylab="X2", zlab="Pred")
# 
# # Pumadyn dataset
# #data(pumadyn);
# #s_soda(pumadyn_isample_x, pumadyn_isample_y, H=25, gam=0)
</code></pre>


</div>