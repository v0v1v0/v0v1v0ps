<div class="container">

<table style="width: 100%;"><tr>
<td>HRSIP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(MW-)HR-SIP analysis</h2>

<h3>Description</h3>

<p>Conduct (multi-window) high resolution stable isotope probing (HR-SIP) analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HRSIP(
  physeq,
  design,
  density_windows = data.frame(density_min = c(1.7), density_max = c(1.75)),
  sparsity_threshold = seq(0, 0.3, 0.1),
  sparsity_apply = "all",
  l2fc_threshold = 0.25,
  padj_method = "BH",
  padj_cutoff = NULL,
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>Phyloseq object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p><code>design</code> parameter used for DESeq2 analysis.
This is usually used to differentiate labeled-treatment and unlabeld-control samples.
See <code>DESeq2::DESeq</code> for more details on the option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_windows</code></td>
<td>
<p>The buoyant density window(s) used for for calculating log2
fold change values. Input can be a vector (length 2) or a data.frame with a 'density_min'
and a 'density_max' column (each row designates a density window).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity_threshold</code></td>
<td>
<p>All OTUs observed in less than this portion (fraction: 0-1)
of gradient fraction samples are pruned. This is a form of indepedent filtering.
The sparsity cutoff with the most rejected hypotheses is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity_apply</code></td>
<td>
<p>Apply sparsity threshold to all gradient fraction samples ('all')
or just 'heavy' fraction samples ('heavy'), where 'heavy' samples are designated
by the <code>density_windows</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2fc_threshold</code></td>
<td>
<p>log2 fold change (l2fc) values must be significantly above this
threshold in order to reject the hypothesis of equal counts.
See <code>DESeq2</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj_method</code></td>
<td>
<p>Method for global p-value adjustment (See <code>p.adjust()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padj_cutoff</code></td>
<td>
<p>Adjusted p-value cutoff for rejecting the null hypothesis
that l2fc values were not greater than the l2fc_threshold.
Set to <code>NULL</code> to skip filtering of results to the sparsity cutoff with most
rejected hypotheses and filtering each OTU to the buoyant density window with the
greatest log2 fold change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Process each parameter combination in parallel.
See <code>plyr::mdply()</code> for more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The (MW-)HR-SIP workflow is as follows:
</p>

<ol>
<li>
<p> For each sparsity threshold &amp; BD window: calculate log2 fold change values (with DESeq2) for each OTU
</p>
</li>
<li>
<p> Globally adjust p-values with a user-defined method (see p.adjust())
</p>
</li>
<li>
<p> Select the sparsity cutoff with the most rejected hypotheses
</p>
</li>
<li>
<p> For each OTU, select the BD window with the greatest log2 fold change value
</p>
</li>
</ol>
<h3>Value</h3>

<p>dataframe of HRSIP results
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(phylo.qSIP)


## HR-SIP
### Note: treatment-control samples differentiated with 'design=~Isotope'
df_l2fc = HRSIP(phylo.qSIP, design=~Isotope)
## Same, but multiple BD windows (MW-HR-SIP). For parallel processing change to parallel = TRUE
### Windows = 1.7-1.74, 1.72-1.75, and 1.73 - 1.76
windows = data.frame(density_min=c(1.71,1.72, 1.73), density_max=c(1.74,1.75,1.76))
df_l2fc = HRSIP(phylo.qSIP,
                design=~Isotope,
                density_windows = windows,
                padj_cutoff = 0.05,
                parallel=FALSE)



</code></pre>


</div>