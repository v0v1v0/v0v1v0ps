<div class="container">

<table style="width: 100%;"><tr>
<td>outlierSTA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identifying outliers in objects of class STA</h2>

<h3>Description</h3>

<p>Function to identify observations with standardized residuals exceeding
<code>rLimit</code>. If not provided <code>rLimit</code> is computed as
<code>qnorm(1 - 0.5 / rDf)</code> where <code>rDf</code> is the residual degrees
of freedom for the model. This value is then restricted to the interval
2..4. Alternatively a custom limit may be provided.<br>
If <code>verbose = TRUE</code> a summary is printed of outliers and observations
that have the same value for <code>commonFactors</code>. The column outlier in the
output can be used to distinguish real outliers from observations included
because of their commonFactors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">outlierSTA(
  STA,
  trials = NULL,
  traits = NULL,
  what = NULL,
  rLimit = NULL,
  commonFactors = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>STA</code></td>
<td>
<p>An object of class <code>STA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>A character vector specifying the trials for which outliers
should be identified. If <code>trials = NULL</code>, all trials are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>A character vector specifying the traits for which outliers
should be identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A character string indicating whether the outliers should be
identified for the fitted model with genotype as fixed
(<code>what = "fixed"</code>) or genotype as random (<code>what = "random"</code>) factor.
If <code>STA</code> contains only one model this model is chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rLimit</code></td>
<td>
<p>A numerical value used for determining when a value is
considered an outlier. All observations with standardized residuals
exceeding <code>rLimit</code> will be marked as outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commonFactors</code></td>
<td>
<p>A character vector specifying the names of columns
in <code>TD</code> used for selecting observations that are similar to the
outliers. If <code>commonFactors = NULL</code>, only outliers are reported and
no similar observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should the outliers be printed to the console?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li>
<p>indicator - a list of numeric vectors indicating the location of the
outliers in the data
</p>
</li>
<li>
<p>outliers - a data.frame containing the outliers and observations
similar to the outliers as defined by <code>commonFactors</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Fit a model using lme4.
modLme &lt;- fitTD(TD = TDHeat05,
                traits = "yield",
                design = "res.rowcol",
                engine = "lme4")

## Detect outliers in the standardized residuals of the fitted model.
outliers &lt;- outlierSTA(STA = modLme,
                       traits = "yield")

</code></pre>


</div>