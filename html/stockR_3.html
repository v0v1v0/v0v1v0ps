<div class="container">

<table style="width: 100%;"><tr>
<td>sim.stock.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates SNP data according to stockSTRUCTURE model</h2>

<h3>Description</h3>

<p>For given sample characteristics (number of sampling groups, number of animals, number of SNPs and number/size of stocks) simulates some SNP data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.stock.data(nAnimals, nSNPs, nSampleGrps, K, ninform = nSNPs, 
  means=c(alpha=-1.9,beta=0), sds=c(alpha=1.6,beta.inform=0.85,
  beta.noise=0.0005), minStockSize=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code> nAnimals</code></td>
<td>
<p>integer giving the number of animals to simulate. No default, must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> nSNPs</code></td>
<td>
<p>integer giving the number of SNPs to generate. No default, must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> nSampleGrps</code></td>
<td>
<p>integer giving the number of sampling groups. Must be less than nAnimals. No default, must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> K</code></td>
<td>
<p>integer giving the number of stocks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> ninform</code></td>
<td>
<p>integer giving the number of informative SNPs. That is the first ninform SNPs will discriminate the stocks and the remainder will not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> means</code></td>
<td>
<p>a named two-element numeric vector consisting of the mean of the intercepts (named "alpha") and the mean of the deviations (named "beta"). The latter should always be zero (the betas will get standardised in any case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> sds</code></td>
<td>
<p>a names three-element numeric vector consisting of the standard deviations of the intercepts (named "alpha"), the sds of the betas that are differentiating between stocks (named "beta.inform"), and the sds of the SNP effects that are not differentiating between stocks (named "beta.noise").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> minStockSize</code></td>
<td>
<p>the size of the smallest stock group allowed. That is the size within the sample, not the actual population size.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The proportions of each stock in the sample is taken as a single draw from a flat Dirichlet distribution (which is flat over the simplex). The expected frequencies, in each stock, are generated on the logit scale. The mean frequency, for each SNP, is drawn from a random normal with mean means["alpha"] and sd sds["alpha"]. Deviations from the mean, for the first ninform SNPs, are generated from a normal with mean means["beta"] and sd=sds["beta.inform"]. For other SNPs these deviations are drawn from a normal with mean means["alpha"] and sd sds["beta.noise"] (typically really small). These expectations are then inverse logit trasnsformed and SNP data generated using binomial sampling with 2 trials. There was a good reason for choosing these means and standard deviations for generating SNP expectations, but I can't remember what it was...
</p>


<h3>Value</h3>

<p>A numeric matrix containing SNP allele frequencies (in rows) for each animal (in columns). The matrix has attributes, "grps" for the stock groups and "sampleGrps" for the sampling groups.
</p>


<h3>Author(s)</h3>

<p>Scott D. Foster</p>


<h3>See Also</h3>

<p><code>stockSTRUCTURE</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#a data set with 100 individuals, from 100 different sampling groups (so no individual
#can be assumed a priori to belong to the same stock as any other individual), with 
#5000 SNP markers. There are 3 stocks and only 200 of the 500 SNP markers are 
#differentiated between stocks.
myData &lt;- sim.stock.data( nAnimal=100, nSNP=5000, nSampleGrps=100, K=3, ninform=200)
print( dim( myData))  #should be 5000 x 100
</code></pre>


</div>