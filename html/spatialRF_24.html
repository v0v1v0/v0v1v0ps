<div class="container">

<table style="width: 100%;"><tr>
<td>moran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran's I test</h2>

<h3>Description</h3>

<p>Computes the spatial correlation coefficient (Moran's I) of a vector given a distance matrix, and a distance threshold used to define "neighborhood".
</p>


<h3>Usage</h3>

<pre><code class="language-R">moran(
  x = NULL,
  distance.matrix = NULL,
  distance.threshold = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector, generally model residuals, Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.matrix</code></td>
<td>
<p>Distance matrix among cases in <code>x</code>. The number of rows of this matrix must be equal to the length of <code>x</code>. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.threshold</code></td>
<td>
<p>numeric value in the range of values available in <code>distance.matrix</code>. Distances below such threshold are set to 0. Default: <code>NULL</code> (which defaults to 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, if <code>TRUE</code>, prints a Moran's I plot. Default: <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Inspired in the <code>Moran.I()</code> function of the <a href="https://cran.r-project.org/package=ape">ape</a> package.
</p>


<h3>Value</h3>

<p>A list with three named slots:
</p>

<ul>
<li> <p><code>test</code>: Data frame with observed and expected Moran's I values, p-value, and interpretation.
</p>
</li>
<li> <p><code>plot</code>: Moran's plot of the vector x against the spatial lags of x.
</p>
</li>
<li> <p><code>plot.df</code>: Data used in the Moran's plot.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>moran_multithreshold()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(interactive()){

 #loading example data
 data(distance_matrix)
 data(plant_richness)

 #Moran's I of the response variable
 out &lt;- moran(
   x = plant_richness$richness_species_vascular,
   distance.matrix = distance_matrix
   )
 out

}
</code></pre>


</div>