<div class="container">

<table style="width: 100%;"><tr>
<td>spfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Semi-parametric Factor Analysis Model</h2>

<h3>Description</h3>

<p><code>spfa</code> fits a unidimensional or two-dimension factor analysis spfa model 
using penalized maximum likelihood estimation. A unidimensional spfa model can
handle discrete response data (i.e., item responses including binary responses
and polytomous responses) or continuous response data (e.g., response time). 
A two-dimensional <code>spfa</code> model can only handle simple structure model 
with two latent factors load to continuous and discrete response data, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spfa(
  data,
  dimension = rep(0, ncol(data)),
  discrete = rep(FALSE, ncol(data)),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix that consists of item responses with missing data coded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>a vector of integers containing indicators of the latent factor. The default is <code>rep(0, ncol(data))</code> indicating all item load on the same latent factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>
<p>a vector of <code>TRUE</code> or <code>FALSE</code> indicating whether the item is discrete. <code>TRUE</code>: discrete variable. The length of the vector should be the same as the number of columns of the input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list containing technical parameters for estimation. May be: 
</p>

<ul>
<li> <p><code>shortpar</code> a list containing the starting values of spfa model parameters for each item.
</p>
</li>
<li>  <p><code>pos</code> a list containing positivity constraints
</p>
</li>
<li>  <p><code>lmbd</code> a vector of the penalty parameter (lambda). Default value is a vector of 1s. 
</p>
</li>
<li> <p><code>n_basis</code> number of basis. Default is 11. 
</p>
</li>
<li>  <p><code>n_quad</code> number of quadrature points. Default is 21
</p>
</li>
<li>  <p><code>maxit_em</code> the maximum number of iterations for the EM cycles. Default is 500.
</p>
</li>
<li> <p><code>maxit_mstep</code> the maximum number of iterations for the mstep optimizer.
</p>
</li>
<li> <p><code>maxit_start</code> 
</p>
</li>
<li> <p><code>tol_em</code> tolerance for the EM convergence. Default is 1e-4.
</p>
</li>
<li> <p><code>tol_mstep</code> tolerance for the m-step optimizer. Default is 1e-6.
</p>
</li>
<li> <p><code>n_thrd</code> number of cores used for the penalized EM algorithm to run. Default is 1. 
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list including spfa model parameter estimates and marginal log-likelihood.
</p>


<h3>References</h3>

<p>Liu, Y., &amp; Wang, W. (2022). Semiparametric Factor Analysis for Item-Level Response Time Data. <em>Psychometrika, 87</em>(2), 666â€“692. <a href="https://doi.org/10.1007/s11336-021-09832-8">doi:10.1007/s11336-021-09832-8</a>
</p>
<p>Liu, Y., &amp; Wang, W. (2023). What Can We Learn from a Semiparametric Factor Analysis of Item Responses and Response Time? An Illustration with the PISA 2015 Data. Retrieved from <a href="https://arxiv.org/abs/2303.10079">https://arxiv.org/abs/2303.10079</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # load item response time data 
 RT &lt;- spfa::simdata[,1:8]
 
 # Fit a unidimensional spfa model with continuous data (Response time)


 
spfa_example &lt;- spfa(data = RT, 
       dimension = rep(0, ncol(RT)), 
       discrete = rep(FALSE, ncol(RT)))
       
 
 # In the spfa pacakge, the output of spfa_example can be directly extracted. 
 # See example code below:
 
 spfa::spfa_example$shortpar
 
 # Visualize the result for item 1 as an example 
 
 plotitem.cont(spfa::spfa_example$par[[1]])
</code></pre>


</div>