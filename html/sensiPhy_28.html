<div class="container">

<table style="width: 100%;"><tr>
<td>samp_continuous</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Species Sampling uncertainty - Trait Evolution Continuous Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of continuous characters, 
evaluating sampling uncertainty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">samp_continuous(
  data,
  phy,
  n.sim = 30,
  breaks = seq(0.1, 0.5, 0.1),
  model,
  n.cores = NULL,
  bounds = list(),
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data vector for a single binary trait, with names matching tips in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>The number of times species are randomly deleted for each <code>break</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A vector containing the percentages of species to remove.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The evolutionary model (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitContinuous</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitContinuous</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function randomly removes a given percentage of species (controlled by <code>breaks</code>),  
fits different models of continuous character evolution using <code>fitContinuous</code>, 
repeats this this many times (controlled by <code>n.sim</code>), stores the results and calculates 
the effects on model parameters.
</p>
<p>Different evolutionary models from <code>fitContinuous</code> can be used, i.e. <code>BM</code>,<code>OU</code>,
<code>EB</code>, <code>trend</code>, <code>lambda</code>, <code>kappa</code>, <code>delta</code> and <code>drift</code>.
</p>
<p>See <code>fitContinuous</code> for more details on character models and tree transformations. 
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_continuous</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>data</code>: The original full data vector
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>
<p><code>full.model.estimates</code>: Parameter estimates (rate of evolution <code>sigsq</code>
and where applicable <code>optpar</code>), root state <code>z0</code>, 
AICc for the full model without deleted species.
</p>
<p><code>break.summary.tab</code>: Summary per <code>break</code> of the mean and median effects 
of species removal on percentage and absolute change parameter estimates.
</p>
<p><code>sensi.estimates</code>: Parameter estimates (sigsq and optpar),(percentual) difference 
in parameter estimate compared to the full model (DIFsigsq, sigsq.perc,sDIFsigsq, 
DIFoptpar, optpar.perc,sDIFoptpar), 
AICc and z0 for each repeat with random species removed.
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Gustavo Paterno
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>
<p>Werner, G.D.A., Cornwell, W.K., Sprent, J.I., Kattge, J. &amp; Kiers, E.T. (2014). 
A single evolutionary innovation drives the deep evolution of symbiotic N2-fixation in angiosperms. Nature Communications, 5, 4087.
</p>


<h3>See Also</h3>

<p><code>fitContinuous</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
#Load data:
data("primates")
#Model trait evolution accounting for sampling size 
adultMass&lt;-primates$data$adultMass
names(adultMass)&lt;-rownames(primates$data)
samp_cont&lt;-samp_continuous(data = adultMass,phy = primates$phy[[1]],
model = "OU",n.sim=25,breaks=seq(.05,.2,.05),n.cores = 2, track = TRUE)
#Print summary statistics
summary(samp_cont)
sensi_plot(samp_cont)
sensi_plot(samp_cont, graphs = 1)
#Use a different evolutionary model 
samp_cont2&lt;-samp_continuous(data = adultMass,phy = primates$phy[[1]],
model = "kappa",n.sim=25,breaks=seq(.05,.2,.05),n.cores = 2,track = TRUE)
summary(samp_cont2)
sensi_plot(samp_cont2)
sensi_plot(samp_cont2, graphs = 2)
samp_cont3&lt;-samp_continuous(data = adultMass,phy = primates$phy[[1]],
model = "BM",n.sim=25,breaks=seq(.05,.2,.05),n.cores = 2,track = TRUE)
summary(samp_cont3)

## End(Not run)
</code></pre>


</div>