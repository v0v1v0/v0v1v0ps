<div class="container">

<table style="width: 100%;"><tr>
<td>secrlinear-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatially Explicit Capture–Recapture for Linear Habitats </h2>

<h3>Description</h3>

<p>An <span class="pkg">secr</span> add-on package for linear habitat models. 
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> secrlinear</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2023-10-17</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GNU General Public License Version 2 or later</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The important functions in <span class="pkg">secrlinear</span> are:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>read.linearmask</code> </td>
<td style="text-align: left;"> import and discretize a linear
  habitat map (route) </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>networkdistance</code> </td>
<td style="text-align: left;"> compute network distances between detectors
    and points using a linear habitat mask </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>sim.linearpopn</code> </td>
<td style="text-align: left;"> simulate population along linear mask </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>make.line</code> </td>
<td style="text-align: left;"> place detectors along
  (part of) a linear route </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Other useful functions are:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>checkmoves</code> </td>
<td style="text-align: left;"> check capthist object for extreme movements </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>showpath</code> </td>
<td style="text-align: left;"> interactive examination of network distances </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>clipmask</code> </td>
<td style="text-align: left;"> drop mask points outside buffer distance </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>rbind.linearmask</code> </td>
<td style="text-align: left;"> combine two linear masks </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>subset.linearmask</code> </td>
<td style="text-align: left;"> select part of a linear mask </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>asgraph</code> </td>
<td style="text-align: left;"> convert linear mask to igraph </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>snapPointsToLinearMask</code> </td>
<td style="text-align: left;"> closest point on graph </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>make.sldf</code> </td>
<td style="text-align: left;"> convert coordinates to SpatialLinesDataFrame </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Documentation is provided in a vignette
<a href="../doc/secrlinear-vignette.pdf">../doc/secrlinear-vignette.pdf</a> and in the pdf version of the help
pages <a href="../doc/secrlinear-manual.pdf">../doc/secrlinear-manual.pdf</a>
</p>
<p>The package draws on the packages <span class="pkg">sp</span> (Pebesma and Bivand 2005) and
<span class="pkg">igraph</span> (Csardi and Nepusz 2006).
</p>
<p>In order to fit a linear-habitat model with the <span class="pkg">secr</span> function <code>secr.fit</code>:
</p>

<ol>
<li>
<p> specify a linear mask for the ‘mask’ argument
</p>
</li>
<li>
<p> specify <code>details = list(userdist = networkdistance)</code> so
that <code>secr.fit</code> uses network distances rather than Euclidean distances.
</p>
</li>
</ol>
<p>An example dataset arvicola is drawn from trapping of water voles <em>Arvicola
amphibius</em> in June 1984 along the River Glyme in the U.K. – the relevant linear
mask is glymemask.
</p>
<p>A more complex linear network (Silverstream) is provided as an ESRI shapefile.
</p>


<h3>Author(s)</h3>

<p> Murray Efford <a href="mailto:murray.efford@otago.ac.nz">murray.efford@otago.ac.nz</a> </p>


<h3>References</h3>

<p>Csardi, G. and Nepusz, T. (2006) The igraph software package for complex network
research. <em>InterJournal, Complex Systems</em> <b>1695</b>. <a href="https://igraph.org/">https://igraph.org/</a>.
</p>
<p>Pebesma, E.J. and Bivand, R. S. (2005) Classes and methods for spatial
data in R. <em>R News</em> <b>5</b>(<b>2</b>), <a href="https://cran.r-project.org/doc/Rnews/">https://cran.r-project.org/doc/Rnews/</a>.
</p>


<h3>See Also</h3>

<p><code>addedges</code>,
<code>asgraph</code>,
<code>checkmoves</code>,
<code>clipmask</code>,
<code>deleteedges</code>,
<code>linearmask</code>,
<code>linearpopn</code>,
<code>make.line</code>,
<code>make.sldf</code>,
<code>networkdistance</code>,
<code>plot.linearmask</code>,
<code>rbind.linearmask</code> ,
<code>read.linearmask</code>,
<code>showpath</code>,
<code>showedges</code>,
<code>sim.linearpopn</code>,
<code>snapPointsToLinearMask</code>,
<code>subset.linearmask</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Water voles in June 1984 on the R. Glyme in Oxfordshire, UK
## capture and trap location files are exactly as for a 2-D analysis

inputdir &lt;- system.file("extdata", package = "secrlinear")
arvicola &lt;- read.capthist(captfile = paste0(inputdir, "/Jun84capt.txt"), 
    trapfile = paste0(inputdir, "/glymetrap.txt"), detector = "multi", 
    covname = "sex")

## Import map of linear habitat
## -- from text file of x-y coordinates
glymemask &lt;- read.linearmask(file = paste0(inputdir, "/glymemap.txt"), spacing = 4)
## -- from a previously constructed SpatialLinesDataFrame
SLDF &lt;- as(sf::st_read(paste0(inputdir,"/glymemap.shp")), 'Spatial')
glymemask &lt;- read.linearmask(data = SLDF, spacing = 4)

## display the mask and capture data
plot (glymemask)
plot(arvicola, add = TRUE, tracks = TRUE)
plot(traps(arvicola), add = TRUE)

## fit model, estimate density
linearfit &lt;- secr.fit(arvicola, mask = glymemask, trace = FALSE,
    details = list(userdist = networkdistance))
predict(linearfit)

## NOTE : the unit of density (D) is animals / km
</code></pre>


</div>