<div class="container">

<table style="width: 100%;"><tr>
<td>spectral_sews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectrum-based spatial early-warning signals.</h2>

<h3>Description</h3>

<p>Computation of spatial early warning signals based on spectral
properties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectral_sews(mat, sdr_low_range = NULL, sdr_high_range = NULL, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>The input matrix or a list of matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdr_low_range</code></td>
<td>
<p>The range of values (in proportion) to 
use for the computation of the spectral density ratio.
For example, for the lowest 20% (default value), set <code>sdr_low_range</code> to 
<code>c(0, .2)</code>. See also the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdr_high_range</code></td>
<td>
<p>The range of values (in proportion) to 
use for the computation of the spectral density ratio. For example, for 
the higher 20% (default value), set <code>sdr_high_range</code> to 
<code>c(.8, 1)</code>. See also the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Do not display some warnings</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Spectral early warning signals are based on the fact that some 
dynamical systems can exhibit an change in specific characteristics of their 
spatial structure when approaching a transition. In particular, long-range 
correlations are expected to have an increased importance. This is expected 
to be reflected in the spectrum of the spatial structure as an increase of the
relative importance of lower frequencies over higher frequencies ("reddening" 
of the spatial spectrum).
</p>
<p>This task allows computing the radial-spectrum which gives the relative 
importance of each space scale as a function of distance, from 1 to 
<code>N/2</code> (<code>N</code> being the minimum between the number of rows and columns). 
If the matrix is not square, then it is cropped to biggest square that 
fits within the left side of the matrix. 
</p>
<p>Additionally, it summarizes this spectrum into a Spectral 
Density Ratio (SDR), which is the ratio of low frequencies over 
high frequencies of the r-spectrum. The SDR value is expected to increase
before a transition point.
</p>
<p>The significance of spectral early-warning signals can be estimated by 
reshuffling the original matrix (function <code>indictest</code>). Indicators 
are then recomputed on the shuffled matrices and the values obtained are 
used as a null distribution. P-values are obtained based on the rank of 
the observed value in the null distribution. 
</p>
<p>The trend of SDR values can be plotted using the <code>plot()</code> method. 
Alternatively, the spectrum itself can be plotted (with facets 
if multiple input matrices were used) using the <code>plot_spectrum</code> 
method.
</p>


<h3>Value</h3>

<p>Function <code>spectral_sews</code> object of class <code>spectral_sews_list</code> or 
<code>spectral_sews_single</code> depending on whether the input was a list of 
matrices or a single matrix. 
</p>
<p>Function <code>indictest</code> 
</p>
<p>The <code>plot</code> methods returns a ggplot object (usually displayed 
immediately when called interactively).
</p>


<h3>References</h3>

<p>Kefi, S., Guttal, V., Brock, W.A., Carpenter, S.R., Ellison, A.M., 
Livina, V.N., et al. (2014). Early Warning Signals of Ecological 
Transitions: Methods for Spatial Patterns. PLoS ONE, 9, e92097.
</p>


<h3>See Also</h3>

<p><code>rspectrum</code>, <code>plot_spectrum</code>, 
<code>raw_sdr</code>, <code>extract_spectrum</code>
</p>
<p><code>indictest</code>, to test the significance of indicator values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(serengeti) 
data(serengeti.rain) 


spec_indic &lt;- spectral_sews(serengeti, 
                            sdr_low_range  = c(0, .2), 
                            sdr_high_range = c(.8, 1))

summary(spec_indic)

# Display trends along the varying model parameter
plot(spec_indic, along = serengeti.rain)

# Computing spectra many times is expensive, consider setting parallel 
# computing using: options(mc.cores = n)

# Assess significance
spec_test &lt;- indictest(spec_indic, nulln = 199)
summary(spec_test)

# Display the SDR trend, now with a grey ribbon representing 5%-95% 
# quantiles of the null distribution
plot(spec_test, along = serengeti.rain)

# Add a line highlighting the shift 
if (require(ggplot2)) {
  plot(spec_test, along = serengeti.rain) + 
    geom_vline(xintercept = 590, color = "red", linetype = "dashed")
}


# Display radial-spectra
plot_spectrum(spec_indic, along = serengeti.rain)

# Graphics can be modified using ggplot2 functions
if (require(ggplot2)) { 
  plot_spectrum(spec_indic, along = serengeti.rain) + 
    scale_y_log10()
}


</code></pre>


</div>