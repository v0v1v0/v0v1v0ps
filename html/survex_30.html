<div class="container">

<table style="width: 100%;"><tr>
<td>plot.aggregated_surv_shap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Aggregated SurvSHAP(t) Explanations for Survival Models</h2>

<h3>Description</h3>

<p>This functions plots objects of class <code>aggregated_surv_shap</code> - aggregated time-dependent
explanations of survival models created using the <code>model_survshap()</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'aggregated_surv_shap'
plot(
  x,
  geom = "importance",
  ...,
  title = "default",
  subtitle = "default",
  max_vars = 7,
  colors = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>aggregated_surv_shap</code> to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>
<p>character, one of <code>"importance"</code>, <code>"beeswarm"</code>, <code>"profile"</code> or <code>"curves"</code>. Type of chart to be plotted; <code>"importance"</code> shows the importance of variables over time and aggregated, <code>"beeswarm"</code> shows the distribution of SurvSHAP(t) values for variables and observations, <code>"profile"</code> shows the dependence of SurvSHAP(t) values on variable values, <code>"curves"</code> shows all SurvSHAP(t) curves for selected variable colored by its value or with functional boxplot if <code>boxplot = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to internal functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>character, title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>character, subtitle of the plot, <code>'default'</code> automatically generates "created for the XXX model (n = YYY)", where XXX is the explainer label and YYY is the number of observations used for calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_vars</code></td>
<td>
<p>maximum number of variables to be plotted (least important variables are ignored), by default 7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>character vector containing the colors to be used for plotting variables (containing either hex codes "#FF69B4", or names "blue")</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of the class <code>ggplot</code>.
</p>


<h3>Plot options</h3>



<h4><code>plot.aggregated_surv_shap(geom = "importance")</code></h4>


<ul>
<li> <p><code>rug</code> - character, one of <code>"all"</code>, <code>"events"</code>, <code>"censors"</code>, <code>"none"</code> or <code>NULL</code>. Which times to mark on the x axis in <code>geom_rug()</code>.
</p>
</li>
<li> <p><code>rug_colors</code> - character vector containing two colors (containing either hex codes "#FF69B4", or names "blue"). The first color (red by default) will be used to mark event times, whereas the second (grey by default) will be used to mark censor times.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠xlab_left, ylab_right⁠</code> - axis labels for left and right plots (due to different aggregation possibilities)
</p>
</li>
</ul>
<h4><code>plot.aggregated_surv_shap(geom = "beeswarm")</code></h4>


<ul><li>
<p> no additional parameters
</p>
</li></ul>
<h4><code>plot.aggregated_surv_shap(geom = "profile")</code></h4>


<ul>
<li> <p><code>variable</code> - variable for which the profile is to be plotted, by default first from result data
</p>
</li>
<li> <p><code>color_variable</code> - variable used to denote the color, by default equal to <code>variable</code>
</p>
</li>
</ul>
<h4><code>plot.aggregated_surv_shap(geom = "curves")</code></h4>


<ul>
<li> <p><code>variable</code> - variable for which SurvSHAP(t) curves are to be plotted, by default first from result data
</p>
</li>
<li> <p><code>boxplot</code> - whether to plot functional boxplot with marked outliers or all curves colored by variable value
</p>
</li>
<li> <p><code>coef</code> - length of the functional boxplot's whiskers as multiple of IQR, by default 1.5
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
veteran &lt;- survival::veteran
rsf_ranger &lt;- ranger::ranger(
    survival::Surv(time, status) ~ .,
    data = veteran,
    respect.unordered.factors = TRUE,
    num.trees = 100,
    mtry = 3,
    max.depth = 5
)
rsf_ranger_exp &lt;- explain(
    rsf_ranger,
    data = veteran[, -c(3, 4)],
    y = survival::Surv(veteran$time, veteran$status),
    verbose = FALSE
)

ranger_global_survshap &lt;- model_survshap(
    explainer = rsf_ranger_exp,
    new_observation = veteran[
        c(1:4, 17:20, 110:113, 126:129),
        !colnames(veteran) %in% c("time", "status")
    ],
    y_true = survival::Surv(
        veteran$time[c(1:4, 17:20, 110:113, 126:129)],
        veteran$status[c(1:4, 17:20, 110:113, 126:129)]
    ),
    aggregation_method = "integral",
    calculation_method = "kernelshap",
)
plot(ranger_global_survshap)
plot(ranger_global_survshap, geom = "beeswarm")
plot(ranger_global_survshap, geom = "profile",
     variable = "age", color_variable = "karno")
plot(ranger_global_survshap, geom = "curves",
     variable = "age")
plot(ranger_global_survshap, geom = "curves",
     variable = "age", boxplot = TRUE)


</code></pre>


</div>