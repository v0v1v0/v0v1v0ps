<div class="container">

<table style="width: 100%;"><tr>
<td>expectedMutations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate expected mutation frequencies</h2>

<h3>Description</h3>

<p><code>expectedMutations</code> calculates the expected mutation frequencies for each 
sequence in the input <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expectedMutations(
  db,
  sequenceColumn = "sequence_alignment",
  germlineColumn = "germline_alignment",
  targetingModel = HH_S5F,
  regionDefinition = NULL,
  mutationDefinition = NULL,
  nproc = 1,
  cloneColumn = "clone_id",
  juncLengthColumn = "junction_length"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p><code>data.frame</code> containing sequence data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequenceColumn</code></td>
<td>
<p><code>character</code> name of the column containing input 
sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>germlineColumn</code></td>
<td>
<p><code>character</code> name of the column containing 
the germline or reference sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetingModel</code></td>
<td>
<p>TargetingModel object. Default is HH_S5F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regionDefinition</code></td>
<td>
<p>RegionDefinition object defining the regions
and boundaries of the Ig sequences. To use regions definitions,
sequences in <code>sequenceColum</code> and <code>germlineColumn</code>
must be aligned, following the IMGT schema.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutationDefinition</code></td>
<td>
<p>MutationDefinition object defining replacement
and silent mutation criteria. If <code>NULL</code> then 
replacement and silent are determined by exact 
amino acid identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p><code>numeric</code> number of cores to distribute the operation
over. If the cluster has already been set the call function with 
<code>nproc</code> = 0 to not reset or reinitialize. Default is 
<code>nproc</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloneColumn</code></td>
<td>
<p>clone id column name in <code>db</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>juncLengthColumn</code></td>
<td>
<p>junction length column name in <code>db</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only the part of the sequences defined in <code>regionDefinition</code> are analyzed. 
For example, when using the IMGT_V definition, mutations in
positions beyond 312 will be ignored.
</p>


<h3>Value</h3>

<p>A modified <code>db</code> <code>data.frame</code> with expected mutation frequencies 
for each region defined in <code>regionDefinition</code>.
</p>
<p>The columns names are dynamically created based on the regions in  
<code>regionDefinition</code>. For example, when using the IMGT_V
definition, which defines positions for CDR and FWR, the following columns are
added:  
</p>

<ul>
<li>  <p><code>mu_expected_cdr_r</code>:  number of replacement mutations in CDR1 and 
CDR2 of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_cdr_s</code>:  number of silent mutations in CDR1 and CDR2 
of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_fwr_r</code>:  number of replacement mutations in FWR1, 
FWR2 and FWR3 of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_fwr_s</code>:  number of silent mutations in FWR1, FWR2 and
FWR3 of the V-segment.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>calcExpectedMutations is called by this function to calculate the expected 
mutation frequencies. See observedMutations for getting observed 
mutation counts. See IMGT_SCHEMES for a set of predefined 
RegionDefinition objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Subset example data
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call %in% c("IGHA", "IGHG") &amp; sample_id == "+7d")
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=100)
# Calculate expected mutations over V region
db_exp &lt;- expectedMutations(db,
                            sequenceColumn="sequence_alignment",
                            germlineColumn="germline_alignment_d_mask",
                            regionDefinition=IMGT_V,
                            nproc=1)

# Calculate hydropathy expected mutations over V region
db_exp &lt;- expectedMutations(db,
                           sequenceColumn="sequence_alignment",
                           germlineColumn="germline_alignment_d_mask",
                           regionDefinition=IMGT_V,
                           mutationDefinition=HYDROPATHY_MUTATIONS,
                           nproc=1)

</code></pre>


</div>