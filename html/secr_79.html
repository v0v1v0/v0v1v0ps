<div class="container">

<table style="width: 100%;"><tr>
<td>derived</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Derived Parameters of Fitted SECR Model </h2>

<h3>Description</h3>

<p>Compute derived parameters of spatially explicit capture-recapture model. 
Density is a derived parameter when a model is fitted by maximizing the conditional likelihood. So also is the effective sampling area (in the sense of Borchers and Efford 2008).
</p>


<h3>Usage</h3>

<pre><code class="language-R">
derived(object, ...)

## S3 method for class 'secr'
derived(object, sessnum = NULL, groups = NULL, alpha = 0.05, 
    se.esa = FALSE, se.D = TRUE, loginterval = TRUE, distribution = NULL, 
    ncores = NULL, bycluster = FALSE, ...)

## S3 method for class 'secrlist'
derived(object, sessnum = NULL, groups = NULL, alpha = 0.05, 
    se.esa = FALSE, se.D = TRUE, loginterval = TRUE, distribution = NULL, 
    ncores = NULL, bycluster = FALSE, ...)

## S3 method for class 'secr'
esa(object, sessnum = 1, beta = NULL, real = NULL, noccasions = NULL, 
    ncores = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
 <p><code>secr</code> object output from <code>secr.fit</code>, or an
object of class <code>c("secrlist", "list")</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sessnum</code></td>
<td>
<p> index of session in object$capthist for which output required </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p> vector of covariate names to define group(s) (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> alpha level for confidence intervals </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.esa</code></td>
<td>
<p> logical for whether to calculate SE(mean(esa)) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.D</code></td>
<td>
<p> logical for whether to calculate SE(D-hat) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loginterval</code></td>
<td>
<p> logical for whether to base interval on log(D)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p> character string for distribution of the number of individuals detected </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>integer number of threads used for parallel processing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bycluster</code></td>
<td>
<p>logical; if TRUE results are reported separately for each cluster of detectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> vector of fitted parameters on transformed (link) scale </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>real</code></td>
<td>
<p> vector of ‘real’ parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noccasions</code></td>
<td>
<p> integer number of sampling occasions (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>fdHess</code> or ignored (esa)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The derived estimate of density is a Horvitz-Thompson-like estimate:
</p>
<p style="text-align: center;"><code class="reqn">\hat{D} = \sum\limits _{i=1}^{n} {a_i (\hat{\theta})^{-1}}</code>
</p>
<p> where <code class="reqn">a_i (\hat{\theta})</code> is the estimate of effective sampling area for animal
<code class="reqn">i</code> with detection parameter vector <code class="reqn">\theta</code>.
</p>
<p>A non-null value of the argument <code>distribution</code> overrides the value
in <code>object$details</code>. The sampling variance of <code class="reqn">\hat{D}</code>
from <code>secr.fit</code> by default is spatially unconditional
(<code>distribution = "Poisson"</code>). For sampling variance conditional on the population of the
habitat mask (and therefore dependent on the mask area), specify
<code>distribution = "binomial"</code>. The equation for the conditional
variance includes a factor <code class="reqn">(1 - a/A)</code> that disappears in the
unconditional (Poisson) variance (Borchers and Efford 2007). Thus the
conditional variance is always less than the unconditional variance. The
unconditional variance may in turn be an overestimate or (more likely)
an underestimate if the true spatial variance is non-Poisson.
</p>
<p>Derived parameters may be estimated for population subclasses (groups)
defined by the user with the <code>groups</code> argument. Each named factor
in <code>groups</code> should appear in the covariates dataframe of
object$capthist (or each of its components, in the case of a
multi-session dataset).
</p>
<p><code>esa</code> is used by <code>derived</code> to compute individual-specific
effective sampling areas: </p>
<p style="text-align: center;"><code class="reqn">a_i (\hat{\theta}) = \int _A \:
p.(\mathbf{X};\mathbf{z}_i, \mathbf{\hat{\theta}}) \; \mathrm{d}
\mathbf{X}</code>
</p>
<p> where
<code class="reqn">p.(\mathbf{X})</code> is the probability an individual at X is
detected at least once and the <code class="reqn">\mathbf{z}_i</code> are optional
individual covariates. Integration is over the area <code class="reqn">A</code> of the
habitat mask.
</p>
<p>The argument <code>noccasions</code> may be used to vary the number of
sampling occasions; it works only when detection parameters are constant
across individuals and across time.
</p>
<p>Setting <code>ncores = NULL</code> uses the existing value from the environment variable 
RCPP_PARALLEL_NUM_THREADS (see <code>setNumThreads</code>).
</p>
<p>The effective sampling area ‘esa’ (<code class="reqn">a(\hat{\theta})</code>)
reported by <code>derived</code> is equal to the harmonic mean of the
<code class="reqn">a_i (\hat{\theta})</code> (arithmetic
mean prior to version 1.5). The sampling variance of
<code class="reqn">a(\hat{\theta})</code> is estimated by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\mbox{var}}(a(\hat{\theta})) = \hat{G}_\theta^T
\hat{V}_\theta \hat{G}_\theta, </code>
</p>

<p>where <code class="reqn">\hat{V}</code> is the asymptotic estimate of the
variance-covariance matrix of the beta detection parameters
(<code class="reqn">\theta</code>) and <code class="reqn">\hat{G}</code> is a numerical estimate
of the gradient of <code class="reqn">a(\theta)</code> with respect to
<code class="reqn">\theta</code>, evaluated at <code class="reqn">\hat{\theta}</code>.
</p>
<p>A 100(1–alpha)% asymptotic confidence interval is reported for
density. By default, this is asymmetric about the estimate because the
variance is computed by backtransforming from the log scale. You may 
also choose a symmetric interval (variance obtained on natural scale). 
</p>
<p>The vector of detection parameters for <code>esa</code> may be specified via
<code>beta</code> or <code>real</code>, with the former taking precedence. If
neither is provided then the fitted values in <code>object$fit$par</code> are
used. Specifying <code>real</code> parameter values bypasses the various
linear predictors. Strictly, the ‘real’ parameters are for a naive
capture (animal not detected previously).
</p>
<p>The computation of sampling variances is relatively slow and may be
suppressed with <code>se.esa</code> and <code>se.D</code> as desired.
</p>
<p>For computing <code>derived</code> across multiple models in parallel see
<code>par.derived</code>.
</p>
<p>From <span class="pkg">secr</span> 5.0.0 the ... argument may be used to control the step size 
(.relStep) used by <code>fdHess</code> when estimating gradients for SE(D) and SE(esa).
</p>


<h3>Value</h3>

<p>Dataframe with one row for each derived parameter (‘esa’, ‘D’) and
columns as below
</p>

<table>
<tr>
<td style="text-align: left;">
estimate    </td>
<td style="text-align: left;"> estimate of derived parameter </td>
</tr>
<tr>
<td style="text-align: left;">
SE.estimate </td>
<td style="text-align: left;"> standard error of the estimate </td>
</tr>
<tr>
<td style="text-align: left;">
lcl         </td>
<td style="text-align: left;"> lower 100(1--alpha)% confidence limit </td>
</tr>
<tr>
<td style="text-align: left;">
ucl         </td>
<td style="text-align: left;"> upper 100(1--alpha)% confidence limit </td>
</tr>
<tr>
<td style="text-align: left;">
CVn         </td>
<td style="text-align: left;"> relative SE of number observed (Poisson or binomial assumption) </td>
</tr>
<tr>
<td style="text-align: left;">
CVa         </td>
<td style="text-align: left;"> relative SE of effective sampling area </td>
</tr>
<tr>
<td style="text-align: left;">
CVD         </td>
<td style="text-align: left;"> relative SE of density estimate </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>For a multi-session or multi-group analysis the value is a list
with one component for each session and group.
</p>
<p>The result will also be a list if <code>object</code> is an ‘secrlist’.
</p>


<h3>Warning</h3>


<p><code>derived()</code> may be applied to detection models fitted by maximizing the full likelihood (<code>CL = FALSE</code>). However, models using g (groups) will not be handled correctly.
</p>


<h3>Note</h3>

<p>Before version 2.1, the output table had columns for ‘varcomp1’ (the variance in <code class="reqn">\hat{D}</code> due to variation in <code class="reqn">n</code>, i.e.,
Huggins' <code class="reqn">s^2</code>), and ‘varcomp2’ (the variance in <code class="reqn">\hat{D}</code> due to uncertainty in estimates of detection parameters).
</p>
<p>These quantities are related to CVn and CVa as follows:
</p>
<p><code class="reqn">\mbox{CVn} = \sqrt{ \mbox{varcomp1} } / \hat{D} </code>
</p>
<p><code class="reqn">\mbox{CVa} = \sqrt{ \mbox{varcomp2} } / \hat{D} </code>
</p>


<h3>References</h3>

<p>Borchers, D. L. and Efford, M. G. (2007) Supplements to Biometrics paper. Available online at <a href="https://www.otago.ac.nz/density/">https://www.otago.ac.nz/density/</a>.
</p>
<p>Borchers, D. L. and Efford, M. G. (2008) Spatially explicit maximum likelihood methods for capture–recapture studies. <em>Biometrics</em>, <b>64</b>, 377–385.
</p>
<p>Huggins, R. M. (1989) On the statistical analysis of capture experiments. <em>Biometrika</em> <b>76</b>, 133–140.
</p>


<h3>See Also</h3>

<p><code>predict.secr</code>,
<code>print.secr</code>,
<code>secr.fit</code>,
<code>empirical.varD</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## extract derived parameters from a model fitted previously
## by maximizing the conditional likelihood 
derived (secrdemo.CL)

## what happens when sampling variance is conditional on mask N?
derived(secrdemo.CL, distribution = "binomial")
## fitted g0, sigma
esa(secrdemo.CL)
## force different g0, sigma
esa(secrdemo.CL, real = c(0.2, 25))

## End(Not run)

</code></pre>


</div>