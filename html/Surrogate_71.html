<div class="container">

<table style="width: 100%;"><tr>
<td>MixedContContIT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits (univariate) mixed-effect models to assess surrogacy in the continuous-continuous case based on the Information-Theoretic framework</h2>

<h3>Description</h3>

<p>The function <code>MixedContContIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on mixed-effect models when both S and T are continuous endpoints. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">MixedContContIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID,
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to the function <code>lmer</code> (of the R package <code>lme4</code>) that is used to fit the geralized linear mixed-effect models in the function <code>BimixedContCont</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following generalised linear mixed-effect models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{T}+m_{Ti}+\beta Z_{ij}+b_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\theta_{0}+c_{Ti}+\theta_{1}Z_{ij}+a_{i}Z_{ij}+\theta_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., an identity link when a continuous true endpoint is considered), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{T}</code> and <code class="reqn">\beta</code> are a fixed intercept and a fixed treatment-effect on the true endpoint, while <code class="reqn">m_{Ti}</code> and <code class="reqn">b_{i}</code> are the corresponding random effects. <code class="reqn">\theta_{0}</code> and <code class="reqn">\theta_{1}</code> are the fixed intercept and the fixed treatment effect on the true endpoint after accounting for the effect of the surrogate endpoint, and <code class="reqn">c_{Ti}</code> and <code class="reqn">a_i</code> are the corresponding random effects. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models (i.e., <code class="reqn">L_{1}</code> and <code class="reqn">L_{2}</code>, respectively) are subsequently used to compute individual-level surrogacy (based on the so-called Variance Reduction Factor, VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{hind}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials.
</p>
<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following mixed models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts,  <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects on S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random effects. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested that a full model approach is used (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha_i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) models (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (2). The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>MixedContContIT</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate and its confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>) that are obtained when models (1) or models (2) are fitted (see the <b>Details</b> section above).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><code>FixedContContIT</code>, <code>plot Information-Theoretic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  # Time consuming (&gt;5sec) code part
# Example 1
# Based on the ARMD data:
data(ARMD)
# Assess surrogacy based on a full mixed-effect model
# in the information-theoretic framework:
Sur &lt;- MixedContContIT(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center,
Pat.ID=Id, Model="Full")
# Obtain a summary of the results:
summary(Sur)

# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients, 200 trials,
# and Rindiv=Rtrial=.8
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=200, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Full")
# Assess surrogacy based on a full mixed-effect model
# in the information-theoretic framework:
Sur2 &lt;- MixedContContIT(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat,
Trial.ID=Trial.ID, Pat.ID=Pat.ID, Model="Full")

# Show a summary of the results:
summary(Sur2)
## End(Not run)
</code></pre>


</div>