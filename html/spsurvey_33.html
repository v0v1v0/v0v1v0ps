<div class="container">

<table style="width: 100%;"><tr>
<td>power_dsgn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculation for multiple panel designs</h2>

<h3>Description</h3>

<p>Calculates the power for trend detection for one or more variables, for one
or more panel designs, for one or more linear trends, and for one or more
significance levels.  The panel designs create a covariance model where the
model includes variance components for units, periods, the interaction of
units and periods, and the residual (or index) variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power_dsgn(
  ind_names,
  ind_values,
  unit_var,
  period_var,
  unitperiod_var,
  index_var,
  unit_rho = 1,
  period_rho = 0,
  paneldsgn,
  nrepeats = NULL,
  trend_type = "mean",
  ind_pct = NULL,
  ind_tail = NULL,
  trend = 2,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ind_names</code></td>
<td>
<p>Vector of indicator names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_values</code></td>
<td>
<p>Vector of indicator mean values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit_var</code></td>
<td>
<p>Vector of variance component estimates for unit variability
for the indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period_var</code></td>
<td>
<p>Vector of variance component estimates for period
variability for the indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitperiod_var</code></td>
<td>
<p>Vector of variance component estimates for unit by
period interaction variability for the indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_var</code></td>
<td>
<p>Vector of variance component estimates for index (residual)
error for the indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit_rho</code></td>
<td>
<p>Correlation across units. Default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period_rho</code></td>
<td>
<p>Correlation across periods. Default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paneldsgn</code></td>
<td>
<p>A list of panel designs each as a matrix.  Each element of
the list is a matrix with <code>dimnames</code> (dimensions: number of panels (rows) by
number of periods (columns)) containing the number of units visited for
each combination of panel and period.  Dimnames for columns must be
able to be coerced into an integer (e.g., 2016).  All designs must span the same
number of periods.  Typically, the panel designs are the output of the
function <code>revisit_dsgn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepeats</code></td>
<td>
<p>Either <code>NULL</code> or a list of matrices the same length as
<code>paneldsgn</code> specifying the number of revisits made to units in a panel in the
same period for each design.  Specifying <code>NULL</code> indicates that number of
revisits to units is the same for all panels and for all periods and for
all panel designs. The default is <code>NULL</code>, a single visit. Names must match
list names in <code>paneldsgn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend_type</code></td>
<td>
<p>Trend type is either <code>"mean"</code> where trend is applied as
percent trend in the indicator mean or <code>"percent"</code> where the trend is applied
as percent trend in the proportion (percent) of the distribution that is
below or above a fixed value. Default is <code>trend_type="mean"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_pct</code></td>
<td>
<p>When <code>trend_type</code> is equal to <code>"percent"</code>, a vector of the
values of the indicator fixed value that defines the percent.  Default is
NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_tail</code></td>
<td>
<p>When trend_type is equal to <code>"percent"</code>, a character vector
with values of either <code>"lower"</code> or <code>"upper"</code> for each indicator.  <code>"lower"</code>
states that the percent is associated with the lower tail of the
distribution and <code>"upper"</code> states that the percent is associated with the
upper tail of the distribution. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>Single value or vector of assumed percent change from
initial value in the indicator for each period. Assumes the trend is
expressed as percent per period. Note that the trend may be either positive
or negative. The default is <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Single value or vector of significance level for linear
trend test, alpha, Type I error, level.  The default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates the power for detecting a change in the mean for
different panel design structures. The model incorporates unit, period,
unit by period, and index variance components as well as correlation across
units and across periods.  See references for methods.
</p>


<h3>Value</h3>

<p>A list with components <code>trend_type</code>, <code>ind_pct</code>, <code>ind_tail</code>, trend values
across periods, periods (all periods included in one or more panel
designs), significance levels, a five-dimensional array of power
calculations (dimensions: panel, design names, periods, indicator names,
trend names, <code>alpha_names</code>), an array of indicator mean values for each trend
and the function call.
</p>


<h3>Author(s)</h3>

<p>Tony Olsen <a href="mailto:Olsen.Tony@epa.gov">Olsen.Tony@epa.gov</a>
</p>


<h3>References</h3>

<p>Urquhart, N. S., W. S. Overton, et al. (1993) Comparing sampling designs
for monitoring ecological status and trends: impact of temporal patterns.
In: <em>Statistics for the Environment.</em> V. Barnett and K. F. Turkman.
John Wiley &amp; Sons, New York, pp. 71-86.
</p>
<p>Urquhart, N. S. and T. M. Kincaid (1999). Designs for detecting trends
from repeated surveys of ecological resources. <em>Journal of
Agricultural, Biological, and Environmental Statistics</em>, <b>4(4)</b>,
404-414.
</p>
<p>Urquhart, N. S. (2012). The role of monitoring design in detecting trend in
long-term ecological monitoring studies. In: <em>Design and Analysis of
Long-term Ecological Monitoring Studies.</em> R. A. Gitzen, J. J. Millspaugh,
A. B. Cooper, and D. S. Licht (eds.). Cambridge University Press, New York,
pp. 151-173.
</p>


<h3>See Also</h3>


<dl>
<dt><code>ppd_plot</code></dt>
<dd>
<p> to plot power curves for
panel designs</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R"># Power for rotating panel with sample size 60
power_dsgn("Variable_Name",
  ind_values = 43, unit_var = 280, period_var = 4,
  unitperiod_var = 40, index_var = 90, unit_rho = 1, period_rho = 0,
  paneldsgn = list(NoR60 = revisit_dsgn(20,
    panels = list(NoR60 = list(
      n = 60, pnl_dsgn = c(1, NA),
      pnl_n = NA, start_option = "None"
    )), begin = 1
  )),
  nrepeats = NULL, trend_type = "mean", trend = 1.0, alpha = 0.05
)
</code></pre>


</div>