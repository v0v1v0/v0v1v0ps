<div class="container">

<table style="width: 100%;"><tr>
<td>generate_blockdiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates data from <code>K</code> multivariate normal data populations, where each
population (class) has a covariance matrix consisting of block-diagonal
autocorrelation matrices.</h2>

<h3>Description</h3>

<p>This function generates <code>K</code> multivariate normal data sets, where each
class is generated with a constant mean vector and a covariance matrix
consisting of block-diagonal autocorrelation matrices. The data are returned
as a single matrix <code>x</code> along with a vector of class labels <code>y</code> that
indicates class membership.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_blockdiag(n, mu, num_blocks, block_size, rho, sigma2 = rep(1, K))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of the sample sizes of each class. The length of <code>n</code>
determines the number of classes <code>K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>matrix containing the mean vectors for each class. Expected to have
<code>p</code> rows and <code>K</code> columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_blocks</code></td>
<td>
<p>the number of block matrices. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_size</code></td>
<td>
<p>the dimensions of the square block matrix. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>vector of the values of the autocorrelation parameter for each
class covariance matrix. Must equal the length of <code>n</code> (i.e., equal to
<code>K</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>vector of the variance coefficients for each class covariance
matrix. Must equal the length of <code>n</code> (i.e., equal to <code>K</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For simplicity, we assume that a class mean vector is constant for each
feature. That is, we assume that the mean vector of the <code class="reqn">k</code>th class is
<code class="reqn">c_k * j_p</code>, where <code class="reqn">j_p</code> is a <code class="reqn">p \times 1</code> vector of ones and
<code class="reqn">c_k</code> is a real scalar.
</p>
<p>The <code class="reqn">k</code>th class covariance matrix is defined as
</p>
<p style="text-align: center;"><code class="reqn">\Sigma_k = \Sigma^{(\rho)} \oplus \Sigma^{(-\rho)} \oplus \ldots
\oplus \Sigma^{(\rho)},</code>
</p>
<p> where <code class="reqn">\oplus</code> denotes the direct sum and the
<code class="reqn">(i,j)</code>th entry of <code class="reqn">\Sigma^{(\rho)}</code> is
</p>
<p style="text-align: center;"><code class="reqn">\Sigma_{ij}^{(\rho)} = \{ \rho^{|i - j|} \}.</code>
</p>

<p>The matrix <code class="reqn">\Sigma^{(\rho)}</code> is referred to as a block. Its dimensions
are provided in the <code>block_size</code> argument, and the number of blocks are
specified in the <code>num_blocks</code> argument.
</p>
<p>Each matrix <code class="reqn">\Sigma_k</code> is generated by the
<code>cov_block_autocorrelation()</code> function.
</p>
<p>The number of classes <code>K</code> is determined with lazy evaluation as the
length of <code>n</code>.
</p>
<p>The number of features <code>p</code> is computed as <code>block_size * num_blocks</code>.
</p>


<h3>Value</h3>

<p>named list with elements:
</p>

<ul>
<li> <p><code>x</code>: matrix of observations with <code>n</code> rows and <code>p</code>
columns
</p>
</li>
<li> <p><code>y</code>: vector of class labels that indicates class membership for
each observation (row) in <code>x</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Generates data from K = 3 classes.
means &lt;- matrix(rep(1:3, each=9), ncol=3)
data &lt;- generate_blockdiag(n = c(15, 15, 15), block_size = 3, num_blocks = 3,
rho = seq(.1, .9, length = 3), mu = means)
data$x
data$y

# Generates data from K = 4 classes. Notice that we use specify a variance.
means &lt;- matrix(rep(1:4, each=9), ncol=4)
data &lt;- generate_blockdiag(n = c(15, 15, 15, 20), block_size = 3, num_blocks = 3,
rho = seq(.1, .9, length = 4), mu = means)
data$x
data$y
</code></pre>


</div>