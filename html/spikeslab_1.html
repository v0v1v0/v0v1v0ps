<div class="container">

<table style="width: 100%;"><tr>
<td>cv.spikeslab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-fold Cross-Validation for Spike and Slab Regression</h2>

<h3>Description</h3>

<p>Computes the K-fold cross-validated mean squared prediction error for
the generalized elastic net from spike and slab regression.  Returns a
stability index for each variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.spikeslab(x = NULL, y = NULL, K = 10,
    plot.it = TRUE, n.iter1 = 500, n.iter2 = 500, mse = TRUE,
    bigp.smalln = FALSE, bigp.smalln.factor = 1, screen = (bigp.smalln),
    r.effects = NULL, max.var = 500, center = TRUE, intercept = TRUE,
    fast = TRUE, beta.blocks = 5, verbose = TRUE, save.all = TRUE,
    ntree = 300, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x-predictor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y-response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>If TRUE, plots the mean prediction error and its standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter1</code></td>
<td>
<p>Number of burn-in Gibbs sampled values (i.e., discarded values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter2</code></td>
<td>
<p>Number of Gibbs sampled values, following burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>If TRUE, an external estimate for the overall variance is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bigp.smalln</code></td>
<td>
<p>Use if <code>p</code> &gt;&gt; <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bigp.smalln.factor</code></td>
<td>
<p>Top <code>n</code> times this value of variables
to be kept in the filtering step (used when <code>p</code> &gt;&gt; <code>n</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>screen</code></td>
<td>
<p>If TRUE, variables are first pre-filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.effects</code></td>
<td>
<p>List used for grouping variables (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.var</code></td>
<td>
<p>Maximum number of variables allowed in the final model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>If TRUE, variables are centered by their
means. Default is TRUE and should only be adjusted in extreme examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>If TRUE, an intercept is included in the model,
otherwise no intercept is included.  Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>If TRUE, use blocked Gibbs sampling to accelerate the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.blocks</code></td>
<td>
<p>Update beta using this number of blocks (<code>fast</code>
must be TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE, verbose output is sent to the terminal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.all</code></td>
<td>
<p>If TRUE, spikeslab object for each fold is saved and returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>Number of trees used by random forests (applies only when <code>mse</code> is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for random number generator.  Must be a negative
integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Invisibly returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>spikeslab.obj</code></td>
<td>
<p>Spike and slab object from the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.spikeslab.obj</code></td>
<td>
<p>List containing spike and slab objects from each fold.
Can be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.fold</code></td>
<td>
<p>List containing the cv splits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Mean-squared error for each fold for the gnet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.path</code></td>
<td>
<p>A matrix of mean-squared errors for the gnet
solution path. Rows correspond to model sizes, columns are the folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stability</code></td>
<td>
<p>Matrix containing stability for each variable defined as the
percentage of times a variable is identified over the K-folds.
Also includes bma and gnet coefficient values and their cv-fold-averaged
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bma</code></td>
<td>
<p>bma coefficients from the full data in terms of the standardized x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bma.scale</code></td>
<td>
<p>bma coefficients from the full data, scaled in terms of the original x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet</code></td>
<td>
<p>cv-optimized gnet in terms of the standardized x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet.scale</code></td>
<td>
<p>cv-optimized gnet in terms of the original x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet.model</code></td>
<td>
<p>List of models selected by gnet over the K-folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet.path</code></td>
<td>
<p>gnet path from the full data, scaled in terms of the original x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet.obj</code></td>
<td>
<p>gnet object from fitting the full data (a lars-type object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gnet.obj.vars</code></td>
<td>
<p>Variables (in order) used to calculate the gnet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose details (used for printing).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hemant Ishwaran (<a href="mailto:hemant.ishwaran@gmail.com">hemant.ishwaran@gmail.com</a>)
</p>
<p>J. Sunil Rao (<a href="mailto:rao.jsunil@gmail.com">rao.jsunil@gmail.com</a>)
</p>
<p>Udaya B. Kogalur (<a href="mailto:ubk@kogalur.com">ubk@kogalur.com</a>)
</p>


<h3>References</h3>

<p>Ishwaran H. and Rao J.S. (2005a).  Spike and slab variable selection:
frequentist and Bayesian strategies.  <em>Ann. Statist.</em>,
33:730-773.
</p>
<p>Ishwaran H. and Rao J.S. (2010).  Generalized ridge regression:
geometry and computational solutions when p is larger than n.
</p>
<p>Ishwaran H. and Rao J.S. (2011).  Mixing generalized ridge
regressions.
</p>


<h3>See Also</h3>

<p><code>sparsePC.spikeslab</code>,
<code>plot.spikeslab</code>,
<code>predict.spikeslab</code>,
<code>print.spikeslab</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#------------------------------------------------------------
# Example 1: 10-fold validation using parallel processing
#------------------------------------------------------------

data(ozoneI, package = "spikeslab")
y &lt;- ozoneI[,  1]
x &lt;- ozoneI[, -1]
cv.obj &lt;- cv.spikeslab(x = x, y = y, parallel = 4)
plot(cv.obj, plot.type = "cv")
plot(cv.obj, plot.type = "path")

#------------------------------------------------------------
# Example 2: 10-fold validation using parallel processing
# (high dimensional diabetes data)
#------------------------------------------------------------

# add 2000 noise variables
data(diabetesI, package = "spikeslab")
diabetes.noise &lt;- cbind(diabetesI,
      noise = matrix(rnorm(nrow(diabetesI) * 2000), nrow(diabetesI)))
x &lt;- diabetes.noise[, -1]
y &lt;- diabetes.noise[, 1]

cv.obj &lt;- cv.spikeslab(x = x, y = y, bigp.smalln=TRUE, parallel = 4)
plot(cv.obj)

## End(Not run)
</code></pre>


</div>