<div class="container">

<table style="width: 100%;"><tr>
<td>plotCostDensitySP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot alignment cost density and warping path</h2>

<h3>Description</h3>

<p>Plot alignment cost density and warping path, optionally with the two snow profiles plotted in the margins
along the axes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotCostDensitySP(
  alignment,
  localCost = TRUE,
  labelHeight = FALSE,
  marginalPros = TRUE,
  pathCol = "black",
  target = FALSE,
  movingTarget = FALSE,
  tlty = "dotted",
  tlwd = 1.5,
  tcol = "black",
  tcex = 1.5,
  cex.lab = 1,
  xlab = NULL,
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alignment</code></td>
<td>
<p>object from dtwSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>localCost</code></td>
<td>
<p>plot <em>local</em> cost matrix, otherwise plot accumulated global cost.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelHeight</code></td>
<td>
<p>plot axes in units of height (cm) or in unitless (i.e., layer index).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginalPros</code></td>
<td>
<p>plot profiles in margins along the axes. default TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathCol</code></td>
<td>
<p>color of warping path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>draw horizontal &amp; vertical lines from matrix cells to corresponding layers in the (marginal) profiles.
Provide either a vector of length 1 (i.e., index of warping path) or length 2 (i.e., x, y coordinates in terms of
layer indices), or a matrix with 2 columns, specifying (x, y) if you desire multiple 'targets'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>movingTarget</code></td>
<td>
<p>Do you want to draw the warping path only partially, from the origin to the target cross?
Only possible if target cross is given as a scalar! default = FALSE (Useful to create GIF animations of a moving path)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlty</code></td>
<td>
<p>target lty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlwd</code></td>
<td>
<p>target lwd</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcol</code></td>
<td>
<p>target col</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcex</code></td>
<td>
<p>target cex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>cex of axis labels (cf. par)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label to change default labeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label to change default labeling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>forwarded to par</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If you can't see the axis labels, try e.g., <code>par(oma = c(3, 3, 0, 0))</code> before calling the function. Note, there
seems to be a problem (only sometimes) with the left-hand labels that are for some reason not plotted parallel
to the axis. Also, the routine is not bulletproof with respect to drawing 'targets'. Apologies for any inconveniences!
</p>


<h3>Author(s)</h3>

<p>fherla
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## first align profiles:
dtwAlignment &lt;- dtwSP(SPpairs$A_modeled, SPpairs$A_manual, open.end = FALSE)

## then plot cost density:
plotCostDensitySP(dtwAlignment)

## label height instead of layer index, and don't show warping path:
plotCostDensitySP(dtwAlignment, labelHeight = TRUE, pathCol = "transparent")

## draw lines to the cell that corresponds to the DH and SH layers
plotCostDensitySP(dtwAlignment, target = c(191, 208))

## "moving target", i.e., draw warping path only from origin to target:
plotCostDensitySP(dtwAlignment, target = 200, movingTarget = TRUE)
plotCostDensitySP(dtwAlignment, target = 266, movingTarget = TRUE)


## A cool GIF can be created from frames like those
create_GIF &lt;- FALSE
if (create_GIF){
  nPath &lt;- length(dtwAlignment$index1)
  resolution &lt;- 100  # i.e. super low, make value smaller for smoother GIF
  for (k in seq(1, nPath, by = resolution)) {
    plotCostDensitySP(dtwAlignment, target = k, movingTarget = TRUE)
  }
}

</code></pre>


</div>