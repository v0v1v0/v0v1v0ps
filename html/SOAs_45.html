<div class="container">

<table style="width: 100%;"><tr>
<td>OSOAs_regular</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to create an OSOA in s^2 or s^3 levels and s^k runs
from a basic number of levels s and a power k</h2>

<h3>Description</h3>

<p>The OSOA in s^k runs accommodates at most m=(s^(k-1)-1)/(s-1) columns in
s^2 levels or m'=2*floor(m/2) columns in s^3 levels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OSOAs_regular(
  s,
  k,
  el = 3,
  m = NULL,
  noptim.rounds = 1,
  noptim.repeats = 1,
  optimize = TRUE,
  dmethod = "manhattan",
  p = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>the prime or prime power to use (do not use for s=2, because other
method is better); the resulting array will have pairwise orthogonal columns in s^t levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer &gt;=3; determines the run size: the resulting array will have s^k runs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>el</code></td>
<td>
<p>2 or 3; the exponent of the number of levels, <code>el=3</code> yields a
strength 2* or 3 OSOA in s^3 levels, <code>el=2</code> a strength 2+ or 3- OSOA in s^2 levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the desired number of columns of the resulting array; for
<code>el=3</code>, odd values of <code>m</code> will be reduced by one, so specify the
next largest even <code>m</code>, if you need an odd number of columns (the function
will do so, if possible); if <code>m=NULL</code>, the maximum possible value is used.
This is at most (s^(k-1)-1)/(s-1), or one less if this is odd and <code>el=3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noptim.rounds</code></td>
<td>
<p>the number of optimization rounds for each independent restart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noptim.repeats</code></td>
<td>
<p>the number of independent restarts of optimizations with <code>noptim.rounds</code> rounds each</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>
<p>logical: should space filling be optimized by level permutations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmethod</code></td>
<td>
<p>distance method for <code>phi_p</code>, "manhattan" (default) or "euclidean"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>p for <code>phi_p</code> (the larger, the closer to maximin distance)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function implements the algorithms proposed by Zhou and Tang 2018
(s^2 levels) or Li, Liu and Yang 2021 (s^3 levels), enhanced with the
modification for matrix A by Groemping (2023a). Level permutations are optimized
using an adaptation of the algorithm by Weng (2014).
</p>
<p>If <code>m</code> is specified, the function uses the last <code>m</code> columns of
a saturated OA produced by function <code>createSaturated(s, k-1)</code>. <br>
If <code>m</code> is small enough that a resolution IV / strength 3 OA for <code>s</code> levels in <code>s^(k-1)</code> runs exists,
function <code>OSOAs</code> should be used with such an OA (which can be obtained from package <span class="pkg">FrF2</span>
for <code>s=2</code> or from package <span class="pkg">DoE.base</span> for <code>s&gt;2</code>). For <code>s=2</code>,
function <code>OSOAs_hadamard</code> may also be a better choice than <code>OSOAs_regular for
up to 192 runs</code>.
</p>


<h3>Value</h3>

<p>matrix of class <code>SOA</code> with the attributes that are listed below. All attributes can be accessed using function <code>attributes</code>, or individual attributes can be accessed using function <code>attr</code>. These are the attributes:
</p>

<dl>
<dt>type</dt>
<dd>
<p>the type of array (<code>SOA</code> or <code>OSOA</code>)</p>
</dd>
<dt>strength</dt>
<dd>
<p>character string that gives the strength</p>
</dd>
<dt>phi_p</dt>
<dd>
<p>the phi_p value (smaller=better)</p>
</dd>
<dt>optimized</dt>
<dd>
<p>logical indicating whether optimization was applied</p>
</dd>
<dt>permpick</dt>
<dd>
<p>matrix that lists the id numbers of the permutations used</p>
</dd>
<dt>perms2pickfrom</dt>
<dd>
<p>optional element, when optimization was conducted: the
overall permutation list to which the numbers in permlist refer</p>
</dd>
<dt>call</dt>
<dd>
<p>the call that created the object</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ulrike Groemping
</p>


<h3>References</h3>

<p>For full detail, see <code>SOAs-package</code>.
Groemping (2023a)<br>
Li, Liu and Yang (2021)<br>
Weng (2014)<br>
Zhou and Tang (2019)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 13 columns in 9 levels each
OSOAs_regular(3, 4, el=2, optimize=FALSE) ## 13 columns, phi_p about 0.117
# optimizing level permutations typically improves phi_p a lot
# OSOAs_regular(3, 4, el=2) ## 13 columns, phi_p typically below 0.055
</code></pre>


</div>