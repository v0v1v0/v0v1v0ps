<div class="container">

<table style="width: 100%;"><tr>
<td>tsicEmp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical tail superset importance coefficients.</h2>

<h3>Description</h3>

<p>Computes on a sample the tail superset importance coefficients (tsic) associated with threshold <code>k</code>. The value may be renormalized by the empirical global variance (Sobol version) and/or by its theoretical upper bound.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tsicEmp(sample, ind = 2, k, sobol = FALSE, norm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>A character string among "with.singletons" and "all" (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the empirical global variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE': the index is normalized by its theoretical upper bound.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The theoretical functional decomposition of the variance of the stdf <code class="reqn">\ell</code> consists in writing <code class="reqn">D(\ell) = \sum_{I \subseteq \{1,...,d\}} D_I(\ell) </code> where <code class="reqn">D_I(\ell)</code> measures the variance of <code class="reqn">\ell_I(U_I)</code> the term associated with subset <code class="reqn">I</code> in the Hoeffding-Sobol decomposition of <code class="reqn">\ell</code>
; note that <code class="reqn">U_I</code> represents a random vector with independent standard uniform entries.
</p>
<p>Fixing a subset of components <code class="reqn">I</code>, the theoretical tail superset importance coefficient is defined by <code class="reqn">\Upsilon_I(\ell)=\sum_{J \supseteq I} D_J(\ell)</code>.
A theoretical upper bound for tsic <code class="reqn">\Upsilon_I(\ell)</code> is given by Theorem 2 in Mercadier and Ressel (2021)
which states that <code class="reqn">\Upsilon_I(\ell)\leq 2(|I|!)^2/((2|I|+2)!)</code>.
</p>
<p>Here, the function <code>tsicEmp</code> evaluates, on a <code class="reqn">n</code>-sample and threshold <code class="reqn">k</code>,  the empirical tail superset  importance coefficient <code class="reqn">\hat{\Upsilon}_{I,k,n}</code> the empirical counterpart of <code class="reqn">\Upsilon_I(\ell)</code>.
</p>
<p>Under the option <code>sobol = TRUE</code>, the function <code>tsicEmp</code> returns  <code class="reqn">\dfrac{\hat{\Upsilon}_{I,k,n}}{\hat{D}_{k,n}}</code> the empirical counterpart of <code class="reqn">\dfrac{\Upsilon_I(\ell)}{D_I(\ell)}</code>.
</p>
<p>Under the option <code>norm = TRUE</code>, the quantities are multiplied by <code class="reqn">\dfrac{(2|I|+2)!}{2(|I|!)^2}</code>.
</p>
<p>Proposition 1 and Theorem 2 of Mercadier and Roustant (2019) provide several rank-based expressions
</p>
<p><code class="reqn">\hat{\Upsilon}_{I,k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}(\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})-\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}) \prod_{t\notin I} \min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})</code>
</p>
<p><code class="reqn">\hat{D}_{k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})- \prod_{t\in I}\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p>where
</p>

<ul>
<li> <p><code class="reqn">k</code> is the threshold parameter,
</p>
</li>
<li> <p><code class="reqn">n</code> is the sample size,
</p>
</li>
<li> <p><code class="reqn">X_1,...,X_n</code> describes the <code>sample</code>, each <code class="reqn">X_s</code> is a d-dimensional vector <code class="reqn">X_s^{(t)}</code> for <code class="reqn">t=1,...,d</code>,
</p>
</li>
<li> <p><code class="reqn">R^{(t)}_s</code> denotes the rank of <code class="reqn">X^{(t)}_s</code> among <code class="reqn">X^{(t)}_1, ..., X^{(t)}_n</code>,
</p>
</li>
<li>
<p> and  <code class="reqn">\overline{R}^{(t)}_s = \min((n- R^{(t)}_s+1)/k,1)</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li>
<p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li>
<p><code>tsic</code> A vector of empirical tail superset importance coefficients associated with the list <code>subsets</code>. When <code>norm = TRUE</code>, then tsic  are normalized in the sense that the original values are divided by corresponding upper bounds.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Ressel, P. (2021)
Hoeffding–Sobol decomposition of homogeneous co-survival functions: from Choquet representation to extreme value theory application.
Dependence Modeling, <b>9(1)</b>, 179–198.
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343–372.
</p>


<h3>See Also</h3>

<p><code>graphsEmp</code>, <code>ellEmp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Fix a 6-dimensional asymmetric tail dependence structure
ds &lt;- gen.ds(d = 6, sub = list(1:4,5:6))

## Plot the  tail dependograph
graphs(ds)

## Generate a 1000-sample of Archimax Mevlog random vectors
## associated with ds and underlying distribution exp
sample &lt;- rArchimaxMevlog(n = 1000, ds = ds, dist = "exp", dist.param = 1.3)

## Compute tsic values associated with subsets
## of cardinality 2 or more \code{ind = "all"}
res &lt;- tsicEmp(sample = sample, ind = "all", k = 100, sobol = TRUE, norm = TRUE)

## Select the significative tsic
indices_nonzero &lt;- which(res$tsic %in% boxplot.stats(res$tsic)$out == TRUE)

## Subsets associated with significative tsic reflecting the tail support
as.character(res$subsets[indices_nonzero])

## Pairwise tsic are obtained by
res_pairs &lt;- tsicEmp(sample = sample, ind = 2, k = 100, sobol = TRUE, norm = TRUE)

## and plotted in the tail dependograph
graphsEmp(sample, k = 100)
</code></pre>


</div>