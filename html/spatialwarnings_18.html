<div class="container">

<table style="width: 100%;"><tr>
<td>generic_sews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Spatial Early-Warning signals</h2>

<h3>Description</h3>

<p>Computation, significance assessment and display of spatial 
generic early warning signals (Moran's I, variance and skewness)
</p>


<h3>Usage</h3>

<pre><code class="language-R">generic_sews(
  mat,
  subsize = 4,
  abs_skewness = FALSE,
  moranI_coarse_grain = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A matrix (quantitative data), a binary matrix (which contains 
<code>TRUE</code> or <code>FALSE</code> values) 
or a list of those</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsize</code></td>
<td>
<p>The subsize used for the coarse-graining phase (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs_skewness</code></td>
<td>
<p>Should the absolute skewness be used instead of its 
raw values ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moranI_coarse_grain</code></td>
<td>
<p>Should the input matrix be coarse-grained before
computing the Moran's I indicator value ?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Generic Early warning signal are based on the property of a 
dynamical system to "slow down" when approaching a critical point, 
that is, take more time to return to equilibrium after a perturbation. This 
is expected to be reflected in several spatial characteristics: the 
variance, the spatial autocorrelation (at lag-1) and the skewness. This 
function provides a convenient workflow to compute these indicators, 
assess their significance and display the results. 
</p>
<p>Before computing the actual indicators, the matrix can be "coarse-grained". 
This process reduces the matrix by averaging the nearby cells using 
a square window defined by the <code>subsize</code> parameter. This makes spatial  
variance and skewness reflect actual spatial patterns when working with 
binary (<code>TRUE</code>/<code>FALSE</code> data), but is optional when using 
continuous data. Keep in mind that it effectively reduces the size of 
the matrix by approximately <code>subsize</code> on each dimension. 
</p>
<p>The significance of generic early-warning signals can be estimated by 
reshuffling the original matrix (function <code>indictest</code>). Indicators 
are then recomputed on the shuffled matrices and the values obtained are 
used as a null distribution. P-values are obtained based on the rank of 
the observed value in the null distribution. A small P-value means 
that the indicator is significantly above the null values, as expected 
before a critical point. 
</p>
<p>The <code>plot</code> method can displays the results graphically. A text summary 
can be obtained using the <code>summary</code> method.
</p>


<h3>Value</h3>

<p><code>generic_sews</code> returns an object of class <code>simple_sews_single</code>
(a list) if <code>mat</code> is a single matrix or an object of class 
<code>simple_sews_list</code> if <code>mat</code> is a list. You probably want to use some  
of the methods written for these complicated objects instead of extracting 
values directly (they are displayed using <code>print(&lt;object&gt;)</code>).
</p>
<p><code>indictest</code> returns an object of class <code>generic_test</code> (a <code>data.frame</code>). 
</p>
<p><code>plot</code> methods return <code>ggplot</code> objects, usually immediately displayed 
when <code>plot</code> is being called at the R prompt.
</p>


<h3>References</h3>

<p>Kefi, S., Guttal, V., Brock, W.A., Carpenter, S.R., Ellison, A.M., 
Livina, V.N., et al. (2014). Early Warning Signals of Ecological 
Transitions: Methods for Spatial Patterns. PLoS ONE, 9, e92097.
</p>
<p>Dakos, V., van Nes, E. H., Donangelo, R., Fort, H., &amp; 
Scheffer, M. (2010). Spatial correlation as leading indicator of 
catastrophic shifts. Theoretical Ecology, 3(3), 163-174.
</p>
<p>Guttal, V., &amp; Jayaprakash, C. (2008). Spatial variance and spatial 
skewness: leading indicators of regime shifts in spatial ecological 
systems. Theoretical Ecology, 2(1), 3-12.
</p>


<h3>See Also</h3>

<p><code>indictest</code>, to test the significance of indicator values. 
Individual indicators: <code>raw_cg_moran</code>
<code>raw_cg_variance</code>, <code>raw_cg_skewness</code>, 
<code>simple_sews</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(serengeti)
gen_indic &lt;- generic_sews(serengeti, subsize = 5, 
                           moranI_coarse_grain = TRUE)

# Display results
summary(gen_indic)

# Display trends along the varying model parameter
plot(gen_indic, along = serengeti.rain)

# Compute significance (long)

gen_test &lt;- indictest(gen_indic, nulln = 199)

print(gen_test)

# Display the trend, now with a grey ribbon indicating the 5%-95% quantile
# range of the null distribution
plot(gen_test, along = serengeti.rain)

# Display the effect size compared to null distribution 
plot(gen_test, along = serengeti.rain, what = "z_score")

# Note that plot() method returns a ggplot object that can be modified
# for convenience
if ( require(ggplot2) ) { 
  plot(gen_test, along = serengeti.rain) + 
    geom_vline(xintercept = 733, color = "red", linetype = "dashed") +
    xlab('Annual rainfall') + 
    theme_minimal()
}



</code></pre>


</div>