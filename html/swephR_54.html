<div class="container">

<table style="width: 100%;"><tr>
<td>Section6</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Section 6: Eclipses, Risings, Settings, Meridian Transits, Planetary Phenomena</h2>

<h3>Description</h3>

<p>Functions for: determining eclipse and occultation calculations, computing the times of rising, setting and
meridian transits for all planets, asteroids, the moon and the fixed stars; computing phase, phase angle, elongation,
apparent diameter, apparent magnitude for the Sun, the Moon, all planets and asteroids; and determining
heliacal phenomenon after a given start date
</p>


<h3>Usage</h3>

<pre><code class="language-R">swe_sol_eclipse_when_loc(jd_start, ephe_flag, geopos, backward)

swe_sol_eclipse_when_glob(jd_start, ephe_flag, ifltype, backward)

swe_sol_eclipse_how(jd_ut, ephe_flag, geopos)

swe_sol_eclipse_where(jd_ut, ephe_flag)

swe_lun_occult_when_loc(jd_start, ipl, starname, ephe_flag, geopos, backward)

swe_lun_occult_when_glob(jd_start, ipl, starname, ephe_flag, ifltype, backward)

swe_lun_occult_where(jd_ut, ipl, starname, ephe_flag)

swe_lun_eclipse_when_loc(jd_start, ephe_flag, geopos, backward)

swe_lun_eclipse_how(jd_ut, ephe_flag, geopos)

swe_lun_eclipse_when(jd_start, ephe_flag, ifltype, backward)

swe_rise_trans_true_hor(
  jd_ut,
  ipl,
  starname,
  ephe_flag,
  rsmi,
  geopos,
  atpress,
  attemp,
  horhgt
)

swe_pheno_ut(jd_ut, ipl, ephe_flag)

swe_pheno(jd_et, ipl, ephe_flag)

swe_azalt(jd_ut, coord_flag, geopos, atpress, attemp, xin)

swe_azalt_rev(jd_ut, coord_flag, geopos, xin)

swe_refrac(InAlt, atpress, attemp, calc_flag)

swe_refrac_extended(InAlt, height, atpress, attemp, lapse_rate, calc_flag)

swe_heliacal_ut(jd_utstart, dgeo, datm, dobs, objectname, event_type, helflag)

swe_vis_limit_mag(jd_ut, dgeo, datm, dobs, objectname, helflag)

swe_heliacal_pheno_ut(jd_ut, dgeo, datm, dobs, objectname, event_type, helflag)

swe_topo_arcus_visionis(
  jd_ut,
  dgeo,
  datm,
  dobs,
  helflag,
  mag,
  AziO,
  AltO,
  AziS,
  AziM,
  AltM
)

swe_heliacal_angle(
  jd_ut,
  dgeo,
  datm,
  dobs,
  helflag,
  mag,
  AziO,
  AziS,
  AziM,
  AltM
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>jd_start</code></td>
<td>
<p>Julian day number as double (UT)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ephe_flag</code></td>
<td>
<p>Ephemeris flag as integer (<code>SE$FLG_JPLEPH=1</code>, <code>SE$FLG_SWIEPH=2</code> or <code>SE$FLG_MOSEPH=4</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geopos</code></td>
<td>
<p>position as numeric vector (longitude, latitude, height)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backward</code></td>
<td>
<p>backwards search as boolean (TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifltype</code></td>
<td>
<p>eclipse type as integer (<code>SE$ECL_CENTRAL=1</code>, <code>SE$ECL_NONCENTRAL=2</code>,
<code>SE$ECL_TOTAL=4</code>, <code>SE$ECL_ANNULAR=8</code>, <code>SE$ECL_PARTIAL=16</code>, <code>SE$ECL_ANNULAR_TOTAL=32</code> or 0 for any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jd_ut</code></td>
<td>
<p>UT Julian day number as double (day)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipl</code></td>
<td>
<p>Body/planet as integer (<code>SE$SUN=0</code>, <code>SE$MOON=1</code>, ... <code>SE$PLUTO=9</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starname</code></td>
<td>
<p>Star name as string (<code>""</code> for no star)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsmi</code></td>
<td>
<p>Event flag as integer (e.g.: <code>SE$CALC_RISE=1</code>, <code>SE$CALC_SET=2</code>, <code>SE$CALC_MTRANSIT=4</code>, <code>SE$CALC_ITRANSIT=8</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atpress</code></td>
<td>
<p>Atmospheric pressure as double (hPa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attemp</code></td>
<td>
<p>Atmospheric temperature as double (Celsius)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horhgt</code></td>
<td>
<p>Horizon apparent altitude as double (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jd_et</code></td>
<td>
<p>ET Julian day number as double (day)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord_flag</code></td>
<td>
<p>Coordinate flag as integer (reference system (<code>SE$ECL2HOR=0</code> or <code>SE$EQU2HOR=1</code>))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xin</code></td>
<td>
<p>Position of body as numeric vector (either ecliptical or equatorial coordinates, depending on coord_flag)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InAlt</code></td>
<td>
<p>object's apparent/topocentric altitude as double (depending on calc_flag) (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_flag</code></td>
<td>
<p>Calculation flag as integer (refraction direction (<code>SE$TRUE_TO_APP=0</code> or <code>SE$APP_TO_TRUE=1</code>))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>observer's height as double (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapse_rate</code></td>
<td>
<p>lapse rate as double (K/m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jd_utstart</code></td>
<td>
<p>UT Julian day number as double (day)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgeo</code></td>
<td>
<p>Geographic position as numeric vector (longitude, latitude, height)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datm</code></td>
<td>
<p>Atmospheric conditions as numeric vector (pressure, temperature, relative humidity, visibility)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dobs</code></td>
<td>
<p>Observer description as numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objectname</code></td>
<td>
<p>Name of fixed star or planet as string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_type</code></td>
<td>
<p>Event type as integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>helflag</code></td>
<td>
<p>Calculation flag (incl. ephe_flag values) as integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mag</code></td>
<td>
<p>Object's visible magnitude (Vmag) as double (-)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AziO</code></td>
<td>
<p>Object's azimuth as double (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AltO</code></td>
<td>
<p>Object's altitude as double (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AziS</code></td>
<td>
<p>Sun's azimuth as double (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AziM</code></td>
<td>
<p>Moon's azimuth as double (deg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AltM</code></td>
<td>
<p>Moon's altitude as double (deg)</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>swe_sol_eclipse_when_loc()</dt>
<dd>
<p>Find the next solar eclipse for a given geographic position.</p>
</dd>
</dl>
<dl>
<dt>swe_sol_eclipse_when_glob()</dt>
<dd>
<p>Find the next solar eclipse on earth.</p>
</dd>
</dl>
<dl>
<dt>swe_sol_eclipse_how()</dt>
<dd>
<p>Compute the attributes of a solar eclipse for a given time.</p>
</dd>
</dl>
<dl>
<dt>swe_sol_eclipse_where()</dt>
<dd>
<p>Compute the geographic position of a solar eclipse path.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_occult_when_loc()</dt>
<dd>
<p>Find the next lunar occultation with planet or star at a certain position.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_occult_when_glob()</dt>
<dd>
<p>Find the next lunar occultation with planet or star somewhere on the earth.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_occult_where()</dt>
<dd>
<p>Compute the geographic position of an occultation path.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_eclipse_when_loc()</dt>
<dd>
<p>Find the next lunar eclipse for a given geographic position.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_eclipse_how()</dt>
<dd>
<p>Compute the attributes of a lunar eclipse for a given time.</p>
</dd>
</dl>
<dl>
<dt>swe_lun_eclipse_when()</dt>
<dd>
<p>Find the next lunar eclipse on earth.</p>
</dd>
</dl>
<dl>
<dt>swe_rise_trans_true_hor()</dt>
<dd>
<p>Compute the times of rising, setting and meridian transits for planets, asteroids, the moon, and the fixed stars for a local horizon that has an altitude. </p>
</dd>
</dl>
<dl>
<dt>swe_pheno_ut()</dt>
<dd>
<p>Compute phase, phase angle, elongation, apparent diameter, apparent magnitude for the Sun, the Moon, all planets and asteroids (UT)</p>
</dd>
</dl>
<dl>
<dt>swe_pheno()</dt>
<dd>
<p>Compute phase, phase angle, elongation, apparent diameter, apparent magnitude for the Sun, the Moon, all planets and asteroids (ET).</p>
</dd>
</dl>
<dl>
<dt>swe_azalt()</dt>
<dd>
<p>Compute the horizontal coordinates (azimuth and altitude) of a planet or a star from either ecliptical or equatorial coordinates.</p>
</dd>
</dl>
<dl>
<dt>swe_azalt_rev()</dt>
<dd>
<p>Compute either ecliptical or equatorial coordinates from azimuth and true altitude.
If only an apparent altitude is given, the true altitude has to be computed first with
e.g. the function swe_refrac_extended().</p>
</dd>
</dl>
<dl>
<dt>swe_refrac()</dt>
<dd>
<p>Calculate either the topocentric altitude from the apparent altitude
or the apparent altitude from the topocentric altitude.</p>
</dd>
</dl>
<dl>
<dt>swe_refrac_extended()</dt>
<dd>
<p>Calculate either the topocentric altitude from the apparent altitude
or the apparent altitude from the topocentric altitude.
It allows correct calculation of refraction for heights above sea &gt; 0,
where the ideal horizon and planets that are visible may have a negative altitude. </p>
</dd>
</dl>
<dl>
<dt>swe_heliacal_ut()</dt>
<dd>
<p>Compute the Julian day of the next heliacal phenomenon after a given UT start date.
It works between geographic latitudes 60 South and 60 North.</p>
</dd>
</dl>
<dl>
<dt>swe_vis_limit_mag()</dt>
<dd>
<p>Determine the limiting visual magnitude in dark skies. If the visual magnitude mag of an object is known
for a given date (e. g. from a call of function swe_pheno_ut(), and if magnitude is smaller than the value returned
by swe_vis_limit_mag(), then it is visible.</p>
</dd>
</dl>
<dl>
<dt>swe_heliacal_pheno_ut()</dt>
<dd>
<p>Provide data that are relevant for the calculation of heliacal risings and settings.
This function does not provide data of heliacal risings and settings itself, just some
additional data mostly used for test purposes. To calculate heliacal risings and settings,
use the function swe_heliacal_ut().</p>
</dd>
</dl>
<dl>
<dt>swe_topo_arcus_visionis()</dt>
<dd>
<p>Compute topocentric arcus visionis.</p>
</dd>
</dl>
<dl>
<dt>swe_heliacal_angle()</dt>
<dd>
<p>Compute heliacal angle.</p>
</dd>
</dl>
<h3>Value</h3>

<p><code>swe_sol_eclipse_when_loc</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments as numeric vector,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_sol_eclipse_when_glob</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments as numeric vector
and <code>serr</code> error warning as string
</p>
<p><code>swe_sol_eclipse_how</code> returns a list with named entries:
<code>return</code> status flag as integer,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_sol_eclipse_where</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>pathpos</code> geographic path positions as numeric vector,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_lun_occult_when_loc</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments as numeric vector,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_lun_occult_when_glob</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments as numeric vector,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_lun_occult_where</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>pathpos</code> geographic path positions as numeric vector,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_lun_eclipse_when_loc</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments,
<code>attr</code> phenomena during eclipse and <code>serr</code> error warning as string
</p>
<p><code>swe_lun_eclipse_how</code> returns a list with named entries:
<code>return</code> status flag as integer,
<code>attr</code> phenomena during eclipse as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_lun_eclipse_when</code> returns a list with named entries:
<code>return</code> status flag as integer, <code>tret</code> for eclipse timing moments as numeric vector
and <code>serr</code> error warning as string
</p>
<p><code>swe_rise_trans_true_hor</code> returns a list with named entries: <code>return</code> status flag as integer,
<code>tret</code> for azimuth/altitude info as double and <code>serr</code> error message as string
</p>
<p><code>swe_pheno_ut</code> returns a list with named entries:
<code>return</code> status fag as integer, <code>attr</code> for phenomenon information as numeric vector
and <code>serr</code> error warning as string
</p>
<p><code>swe_pheno</code> returns a list with named entries:
<code>return</code> status fag as integer, <code>attr</code> for phenomenon information as numeric vector
and <code>serr</code> error message as string
</p>
<p><code>swe_azalt</code> returns a list with named entries:
<code>xaz</code> for azi/alt info as numeric vector.
</p>
<p><code>swe_azalt_rev</code> returns a list with named entries:
<code>xaz</code> for celestial info as numeric vector.
</p>
<p><code>swe_refrac</code> returns the (apparent/topocentric) altitude as double (deg)
</p>
<p><code>swe_refrac_extended</code> returns a list with named entries: <code>return</code> status flag as integer,
<code>dret</code> refraction results as numeric vector (TopoAlt, AppAlt, refraction)
</p>
<p><code>swe_heliacal_ut</code> returns a list with named entries <code>return</code> status flag as integer,
<code>dret</code> heliacal results as numeric vector, and <code>serr</code> error message as string.
</p>
<p><code>swe_vis_limit_mag</code> returns a list with named entries: <code>return</code> status flag as integer,
<code>dret</code> limiting magnitude as double and <code>serr</code> error message as string
</p>
<p><code>swe_heliacal_pheno_ut</code> returns a list with named entries: <code>return</code> status flag as integer
<code>darr</code> for heliacal details as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_topo_arcus_visionis</code> returns a list with named entries: <code>return</code> status flag as integer,
<code>darr</code> heliacal details as numeric vector and <code>serr</code> error message as string
</p>
<p><code>swe_heliacal_angle</code> returns a list with named entries: <code>return</code> status flag as integer,
<code>dret</code> heliacal angle as numeric vector and <code>serr</code> error message as string
</p>


<h3>See Also</h3>

<p>Section 6 in <a href="http://www.astro.com/swisseph/swephprg.htm">http://www.astro.com/swisseph/swephprg.htm</a>. Remember that array indices start in R at 1, while in C they start at 0!
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(SE)
swe_sol_eclipse_when_loc(1234567,SE$FLG_MOSEPH,c(0,50,10),FALSE)
swe_sol_eclipse_when_glob(1234567,SE$FLG_MOSEPH,SE$ECL_TOTAL+SE$ECL_CENTRAL+SE$ECL_NONCENTRAL,FALSE)
swe_sol_eclipse_how(1234580.19960447,SE$FLG_MOSEPH,c(0,50,10))
swe_sol_eclipse_where(1234771.68584597,SE$FLG_MOSEPH)
swe_lun_occult_when_loc(1234567,SE$VENUS,"",SE$FLG_MOSEPH+SE$ECL_ONE_TRY,c(0,50,10),FALSE)
swe_lun_occult_when_glob(1234567,SE$VENUS,"",SE$FLG_MOSEPH+SE$ECL_ONE_TRY,SE$ECL_TOTAL,FALSE)
swe_lun_occult_where(1234590.44756319,SE$VENUS,"",SE$FLG_MOSEPH+SE$ECL_ONE_TRY)
swe_lun_eclipse_when_loc(1234567,SE$FLG_MOSEPH,c(0,50,10),FALSE)
swe_lun_eclipse_when(1234567,SE$FLG_MOSEPH,SE$ECL_CENTRAL,FALSE)
swe_lun_eclipse_how(1234580.19960447,SE$FLG_MOSEPH,c(0,50,10))
swe_rise_trans_true_hor(1234567.5,SE$SUN,"",SE$FLG_MOSEPH,0,c(0,50,10),1013.25,15,0)
swe_pheno_ut(1234567,1,SE$FLG_MOSEPH)
swe_pheno(1234567,1,SE$FLG_MOSEPH)
swe_azalt(1234567,SE$EQU2HOR,c(0,50,10),15,1013.25,c(186,22))
swe_azalt_rev(1234567,SE$ECL2HOR,c(0, 50,10),c(123,2))
swe_refrac_extended(2,0,1013.25,15,-0.065,SE$TRUE_TO_APP)
swe_heliacal_ut(1234567,c(0,50,10),c(1013.25,15,50,0.25),c(25,1,1,1,5,0.8),"sirius",
  SE$HELIACAL_RISING,SE$HELFLAG_HIGH_PRECISION+SE$FLG_MOSEPH)
swe_vis_limit_mag(1234567.5,c(0,50,10),c(1013.25,15,20,0.25),c(25,1,1,1,5,0.8),'sirius',
  SE$HELFLAG_HIGH_PRECISION+SE$FLG_MOSEPH)
swe_heliacal_pheno_ut(1234567.5,c(0,50,10),c(1013.25,15,20,0.25),c(25,1,1,1,5,0.8),'sirius',
  SE$HELIACAL_RISING,SE$HELFLAG_HIGH_PRECISION+SE$FLG_MOSEPH)
swe_topo_arcus_visionis(1234567.5,c(0,50,10),c(1013.25,15,20,0.25),c(25,1,1,1,5,0.8),
  SE$HELFLAG_HIGH_PRECISION+SE$HELFLAG_OPTICAL_PARAMS,-1,124,2,120,0,-45)
swe_heliacal_angle(1234567.5,c(0,50,10),c(1013.25,15,20,0.25),c(25,1,1,1,5,0.8),
  SE$HELFLAG_HIGH_PRECISION+SE$HELFLAG_OPTICAL_PARAMS,-1,124,120,0,-45)
</code></pre>


</div>