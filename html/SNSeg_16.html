<div class="container">

<table style="width: 100%;"><tr>
<td>SNSeg_HD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Self-normalization (SN) based change points estimation for high dimensional
time series for changes in high-dimensional means (SNHD).</h2>

<h3>Description</h3>

<p>The function <code>SNSeg_HD</code> is a SNHD change point
estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SNSeg_HD(
  ts,
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = FALSE,
  est_cp_loc = TRUE,
  ts_index = c(1:5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>A high-dimensional time series represented as a matrix with p
columns, where each column is a univariate time series. The dimension p for
ts should be at least 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size_scale</code></td>
<td>
<p>numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by diving n from
grid_size when it is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts_index</code></td>
<td>
<p>The index number(s) of the univariate time series to be plotted.
Users should enter a positive integer or a vector of positive integers that are
no greater than the dimension of the input time series. The default is the
first 5 time series, i.e., <code>ts_index = c(1:5)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>SNSeg_HD returns an S3 object of class "SNSeg_HD" including the time
series, the local window size to cover a change point, the estimated change-point
locations, the confidence level and the critical value of the SN test. It also
generates time series segmentation plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt>
<dd>
<p>A numeric matrix of the input time series.</p>
</dd>
<dt><code>grid_size</code></dt>
<dd>
<p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt>
<dd>
<p>A list of n matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the window h and
(4) Upper bound of the window h.</p>
</dd>
<dt><code>est_cp</code></dt>
<dd>
<p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt>
<dd>
<p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt>
<dd>
<p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>
<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_HD</code>.
</p>
<p>For more examples of <code>SNSeg_HD</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 500
p &lt;- 50
nocp &lt;- 5
cp_sets &lt;- round(seq(0,nocp+1,1)/(nocp+1)*n)
num_entry &lt;- 5
kappa &lt;- sqrt(4/5)
mean_shift &lt;- rep(c(0,kappa),100)[1:(length(cp_sets)-1)]
set.seed(1)
ts &lt;- matrix(rnorm(n*p,0,1),n,p)
no_seg &lt;- length(cp_sets)-1
for(index in 1:no_seg){
  tau1 &lt;- cp_sets[index]+1
  tau2 &lt;- cp_sets[index+1]
  ts[tau1:tau2,1:num_entry] &lt;- ts[tau1:tau2,1:num_entry] +
    mean_shift[index]
}

# grid_size defined
result &lt;- SNSeg_HD(ts, confidence = 0.9, grid_size_scale  = 0.05,
                   grid_size = 40)
# Estimated change-point locations
result$est_cp

# For more examples, please run the following command:
# vignette("SNSeg", package = "SNSeg")


</code></pre>


</div>