<div class="container">

<table style="width: 100%;"><tr>
<td>spscan.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial Scan Test</h2>

<h3>Description</h3>

<p><code>spscan.test</code> performs the spatial scan test of Kulldorf (1997) for
case/control point data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spscan.test(
  x,
  case = 2,
  nsim = 499,
  alpha = 0.1,
  maxd = NULL,
  cl = NULL,
  longlat = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ppp</code> object with marks for the case
and control groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>The name of the desired "case" group in
<code>levels(x$marks)</code>. Alternatively, the position of
the name of the "case" group in <code>levels(x$marks)</code>.
Since we don't know the group names, the default is 2,
the second position of <code>levels(x$marks)</code>.
<code>x$marks</code> is assumed to be a factor.  Automatic
conversion is attempted if it is not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations from which to compute the p-value.  A
non-negative integer.  Default is 499.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level to determine whether a cluster is
signficant.  Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxd</code></td>
<td>
<p>The radius of the largest possible cluster to consider.  Default
is <code>NULL</code>, i.e., half the maximum intercentroid distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>A logical value indicating whether
Euclidean distance (<code>FALSE</code>) or Great Circle
(WGS84 ellipsoid, <code>FALSE</code>) should be used. Default
is <code>FALSE</code>, i.e., Euclidean distance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is performed using the random labeling hypothesis.  The windows are
circular and extend from the observed data locations.  The clusters returned
are non-overlapping, ordered from most significant to least significant.  The
first cluster is the most likely to be a cluster.  If no significant clusters
are found, then the most likely cluster is returned (along with a warning).
</p>
<p>Setting <code>cl</code> to a positive integer MAY speed up computations on
non-Windows computers.  However, parallelization does have overhead cost, and
there are cases where parallelization results in slower computations.
</p>


<h3>Value</h3>

<p>Returns a list of length two of class 
<code>scan</code>. The first element (clusters) is a list 
containing the significant, non-overlapping clusters, 
and has the the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>The
centroid of the significant clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The 
radius of the window of the clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The 
total population in the cluser window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The observed number of cases in the 
cluster window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>The expected number of
cases in the cluster window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smr</code></td>
<td>
<p>Standarized 
mortaility ratio (observed/expected) in the cluster 
window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr</code></td>
<td>
<p>Relative risk in the cluster 
window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propcases</code></td>
<td>
<p>Proportion of cases in the 
cluster window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikrat</code></td>
<td>
<p>The loglikelihood 
ratio for the cluster window (i.e., the log of the test
statistic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>The pvalue of the test 
statistic associated with the cluster window.</p>
</td>
</tr>
</table>
<p>Various additional pieces of information are included for plotting,
printing
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Kulldorff M., Nagarwalla N. (1995) Spatial
disease clusters: Detection and Inference. Statistics
in Medicine 14, 799-810.
</p>
<p>Kulldorff, M. (1997) A spatial scan statistic.
Communications in Statistics â€“ Theory and Methods 26,
1481-1496.
</p>
<p>Waller, L.A. and Gotway, C.A. (2005). Applied Spatial
Statistics for Public Health Data. Hoboken, NJ: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(grave)
# apply scan method
out = spscan.test(grave, case = "affected", nsim = 99)
# print scan object
out
print(out, extra = TRUE)
# summarize results
summary(out)
# plot results
plot(out, chars = c(1, 20), main = "most likely cluster")
# extract clusters from out 
# each element of the list gives the location index of the events in each cluster
clusters(out)
# get warning if no significant cluster
out2 = spscan.test(grave, case = 2, alpha = 0.001, nsim = 99)
</code></pre>


</div>