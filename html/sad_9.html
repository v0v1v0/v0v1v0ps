<div class="container">

<table style="width: 100%;"><tr>
<td>sadcorrect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>correct structure errors</h2>

<h3>Description</h3>

<p>use the inverse 'dtcwt' to correct errors in scale, anisotropy and direction
</p>


<h3>Usage</h3>

<pre><code class="language-R">sadcorrect(x, xmin = 0.1, log = TRUE, rsm = 0, Nx = NULL,
  Ny = NULL, J = NULL, boundaries = "pad", direction = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of equally sized matrices, the first element is assumed to be the observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>values smaller than <code>xmin</code> are set to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, do you want to log-transfrom the data? (recommended for precipitation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsm</code></td>
<td>
<p>number of pixels which are linearly smoothed at the edge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nx</code></td>
<td>
<p>size to which the data is extended in x-direction, has to be a whole power of 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ny</code></td>
<td>
<p>size to which the data is extended in y-direction, has to be a whole power of 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>largest scale considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundaries</code></td>
<td>
<p>how to handle the boundary conditions, either "pad", "mirror" or "periodic"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>if <code>TRUE</code>, scale and direction are corrected, otherwise only scale</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm performs the following steps:
</p>

<ol>
<li>
<p> remove values below <code>xmin</code>
</p>
</li>
<li>
<p> if <code>log=TRUE</code> log-transform all fields
</p>
</li>
<li>
<p>  set all fields to zero mean, unit variance
</p>
</li>
<li>
<p> apply <code>dtcwt</code> to all fields
</p>
</li>
<li>
<p> loop over forecasts and scales. If <code>direction=TRUE</code> loop over the six directions. Multiply forecast energy at each location by the ratio of total observed energy to total forecast energy at that scale (and possibly direction)
</p>
</li>
<li>
<p> apply <code>idtcwt</code> to all forecasts
</p>
</li>
<li>
<p> reset means and variance of the forecasts to their original values
</p>
</li>
<li>
<p> if <code>log=TRUE</code> invert the log-transform 
</p>
</li>
<li>
<p> return the list of corrected fields
</p>
</li>
</ol>
<h3>Value</h3>

<p>an object of class <code>sadforecast</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rrain)
ra   &lt;- as.sadforecast( list( rrain[2,1,,], rrain[3,1,,], rrain[3,2,,], rrain[3,3,,] ) )
ra_c &lt;- sadcorrect( ra, rsm=10 )
plot(ra_c)
</code></pre>


</div>