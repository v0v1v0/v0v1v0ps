<div class="container">

<table style="width: 100%;"><tr>
<td>rmult.crm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating Correlated Ordinal Responses Conditional on a Marginal
Continuation-Ratio Model Specification</h2>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming a continuation-ratio model
for the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmult.crm(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(), link = "logit",
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal continuation-ratio model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector associated with the covariates (i.e., excluding
<code>intercepts</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character string indicating the link function of the marginal
continuation-ratio model. Options include <code>'probit'</code>, <code>'logit'</code>,
<code>'cloglog'</code> or <code>'cauchit'</code>. Required when <code>rlatent = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>matrix with <code>clsize</code> rows and <code>ncategories</code> columns
containing realizations of the latent random vectors when the NORTA method
is not employed. See details for more info.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal continuation-ratio model is </p>
<p style="text-align: center;"><code class="reqn">Pr(Y_{it}=j |Y_{it}
\ge j,x_{it})=F(\beta_{tj0} +\beta^{'}_{t} x_{it})</code>
</p>
<p> where <code class="reqn">F</code> is the
cumulative distribution function determined by <code>link</code>. For subject
<code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th multinomial response and
<code class="reqn">x_{it}</code> is the associated covariates vector. Finally, <code class="reqn">\beta_{tj0}</code>
is the <code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is determined by extending the latent
variable threshold approach of <cite>Tutz (1991)</cite> as suggested in
<cite>Touloumis (2016)</cite>.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in “long” format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O2}_{itj}</code> in <cite>Touloumis (2016)</cite>. In this
case, the algorithm forces <code>cor.matrix</code> to respect the local
independence assumption. To import simulated values for the latent random
vectors without utilizing the NORTA method, the user can employ the
<code>rlatent</code> argument. In this case, row <code class="reqn">i</code> corresponds to subject
<code class="reqn">i</code> and columns
<code class="reqn">(t-1)*\code{ncategories}+1,...,t*\code{ncategories}</code> should contain the
realization of <code class="reqn">e^{O2}_{it1},...,e^{O2}_{itJ}</code>, respectively, for
<code class="reqn">t=1,\ldots,\code{clsize}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Ysim</code></td>
<td>
<p>the simulated
ordinal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O2}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557–561.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal (forthcoming)</em>.
</p>
<p>Tutz, G. (1991) Sequential models in categorical regression.
<em>Computational Statistics &amp; Data Analysis</em> <b>11</b>, 275–295.
</p>


<h3>See Also</h3>

<p><code>rmult.bcl</code> for simulating correlated nominal
responses, <code>rmult.clm</code> and <code>rmult.acl</code> for simulating
correlated ordinal responses and <code>rbin</code> for simulating
correlated binary responses.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See Example 3.3 in the Vignette.
set.seed(1)
sample_size &lt;- 500
cluster_size &lt;- 4
beta_intercepts &lt;- c(-1.5, -0.5, 0.5, 1.5)
beta_coefficients &lt;- 1
x &lt;- rnorm(sample_size * cluster_size)
categories_no &lt;- 5
identity_matrix &lt;- diag(1, (categories_no - 1) * cluster_size)
equicorrelation_matrix &lt;- toeplitz(c(0, rep(0.24, categories_no - 2)))
ones_matrix &lt;- matrix(1, cluster_size, cluster_size)
latent_correlation_matrix &lt;- identity_matrix +
  kronecker(equicorrelation_matrix, ones_matrix)
simulated_ordinal_dataset &lt;- rmult.crm(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients, xformula = ~x,
  cor.matrix = latent_correlation_matrix, link = "probit")
head(simulated_ordinal_dataset$Ysim)
</code></pre>


</div>