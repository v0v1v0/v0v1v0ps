<div class="container">

<table style="width: 100%;"><tr>
<td>generate.HHID</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate new houshold ID for survey data with rotating panel design taking
into account split households</h2>

<h3>Description</h3>

<p>Generating a new houshold ID for survey data using a houshold ID and a
personal ID.
For surveys with rotating panel design containing housholds, houshold members
can move from an existing household to a new one, that was not originally in
the sample. This leads to the creation of so called split households. Using a
peronal ID (that stays fixed over the whole survey), an indicator for
different time steps and a houshold ID, a new houshold ID is assigned to the
original and the split household.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate.HHID(dat, period = "RB010", pid = "RB030", hid = "DB030")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data table of data frame containing the survey data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>column name of <code>dat</code> containing an indicator for the
rotations, e.g years, quarters, months, ect...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>
<p>column name of <code>dat</code> containing the personal identifier. This
needs to be fixed for an indiviual throught the whole survey</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hid</code></td>
<td>
<p>column name of <code>dat</code> containing the household id. This needs
to for a household throught the whole survey</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the survey data <code>dat</code> as data.table object containing a new and
an old household ID. The new household ID which considers the split
households is now named <code>hid</code> and the original household ID has a
trailing "_orig".
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(surveysd)
library(laeken)
library(data.table)

eusilc &lt;- surveysd:::demo.eusilc(n=4)

# create spit households
eusilc[,rb030split:=rb030]
year &lt;- eusilc[,unique(year)]
year &lt;- year[-1]
leaf_out &lt;- c()
for(y in year) {
  split.person &lt;- eusilc[year==(y-1)&amp;!duplicated(db030)&amp;!db030%in%leaf_out,
                         sample(rb030,20)]
  overwrite.person &lt;- eusilc[year==(y)&amp;!duplicated(db030)&amp;!db030%in%leaf_out,
                             .(rb030=sample(rb030,20))]
  overwrite.person[,c("rb030split","year_curr"):=.(split.person,y)]

  eusilc[overwrite.person,
         rb030split:=i.rb030split,on=.(rb030,year&gt;=year_curr)]
  leaf_out &lt;- c(
    leaf_out,
    eusilc[rb030%in%c(overwrite.person$rb030,overwrite.person$rb030split),
    unique(db030)])
}

# pid which are in split households
eusilc[,.(uniqueN(db030)),by=list(rb030split)][V1&gt;1]

eusilc.new &lt;- generate.HHID(eusilc, period = "year", pid = "rb030split",
                            hid = "db030")

# no longer any split households in the data
eusilc.new[,.(uniqueN(db030)),by=list(rb030split)][V1&gt;1]

## End(Not run)

</code></pre>


</div>