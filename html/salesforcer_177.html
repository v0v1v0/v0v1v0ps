<div class="container">

<table style="width: 100%;"><tr>
<td>sf_execute_report</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Execute a report</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Get summary data with or without details by running a report synchronously or
asynchronously through the API. When you run a report, the API returns data
for the same number of records that are available when the report is run in
the Salesforce user interface. Include the <code>filters</code> argument in your
request to get specific results on the fly by passing dynamic filters,
groupings, and aggregates in the report metadata. Finally, you may want to
use <code>sf_run_report</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sf_execute_report(
  report_id,
  async = FALSE,
  include_details = TRUE,
  labels = TRUE,
  guess_types = TRUE,
  bind_using_character_cols = deprecated(),
  as_tbl = TRUE,
  report_metadata = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>report_id</code></td>
<td>
<p><code>character</code>; the Salesforce Id assigned to a created
analytics report. It will start with <code>"00O"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>async</code></td>
<td>
<p><code>logical</code>; an indicator, by default set to <code>TRUE</code>, which
executes the report asynchronously. If executed asynchronously, this function
will return a list of attributes of the created report instance. The results
can be pulled down by providing the report id and instance id to
the function <code>sf_get_report_instance_results</code>. Refer to the details
of the documentation on why executing a report asynchronously is preferred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_details</code></td>
<td>
<p><code>logical</code>; an indicator applying to a synchronous
indicating whether the run should return summary data with details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p><code>logical</code>; an indicator of whether the returned data should
be the label (i.e. formatted value) or the actual value. By default, the labels
are returned because these are what appear in the Salesforce dashboard and
more closely align with the column names. For example, "Account.Name" label
may be <code>"Account B"</code> and the value <code>0016A0000035mJEQAY</code>. The former
(label) more accurately reflects the "Account.Name".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess_types</code></td>
<td>
<p><code>logical</code>; indicating whether or not to use <code>col_guess()</code>
to try and cast the data returned in the recordset. If <code>TRUE</code> then
<code>col_guess()</code> is used, if <code>FALSE</code> then all fields will be returned
as character. This is helpful when <code>col_guess()</code> will mangle field values
in Salesforce that you'd like to preserve during translation into a <code>tbl_df</code>,
like numeric looking values that must be preserved as strings ("48.0").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bind_using_character_cols</code></td>
<td>
<p><code>logical</code>; an indicator of whether to
cast the data to all character columns to ensure that <code>bind_rows</code>
does not fail because two paginated recordsets have differing datatypes for the
same column. Set this to <code>TRUE</code> rarely, typically only when having this
set to <code>FALSE</code> returns an error or you want all columns in the data to be
character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_tbl</code></td>
<td>
<p><code>logical</code>; an indicator of whether to convert the parsed
JSON into a <code>tbl_df</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report_metadata</code></td>
<td>
<p><code>list</code>; a <code>list</code> with one element named
<code>"reportMetadata"</code> having additional list elements underneath. All possible
elements of <code>reportMetadata</code> are documented
<a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_getbasic_reportmetadata.htm#analyticsapi_basicmetadata">HERE</a>,
but you will most commonly only need to specify the following 3 elements to
filter or query the results of an existing report:
</p>

<dl>
<dt>reportFormat</dt>
<dd>
<p>A <code>character</code> specifying the format of the report
with possible values: <code>"TABULAR"</code>, <code>"SUMMARY"</code>, <code>"MATRIX"</code>,
or <code>"MULTI_BLOCK"</code>.</p>
</dd>
<dt>reportBooleanFilter</dt>
<dd>
<p>A <code>character</code> denoting how the individuals
filters specified in <code>reportFilters</code> should be combined. For example,
<code>"(1OR4)AND2AND3"</code></p>
</dd>
</dl>
<p>.
</p>
<dl>
<dt>reportFilters</dt>
<dd>
<p>A <code>list</code> of reportFilter specifications. Each must
be a list with 3 elements: 1) <code>column</code>, 2) <code>operator</code>, and 3) <code>value</code>.
You can find out how certain field types can be filtered by reviewing the results
of <code>sf_list_report_filter_operators</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>logical</code>; an indicator of whether to print additional
detail for each API call, which is useful for debugging. More specifically, when
set to <code>TRUE</code> the URL, header, and body will be printed for each request,
along with additional diagnostic information where available.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Run a report synchronously if you expect it to finish running quickly.
Otherwise, we recommend that you run reports through the API asynchronously
for these reasons:
</p>

<ul>
<li>
<p> Long running reports have a lower risk of reaching the timeout limit
when run asynchronously.
</p>
</li>
<li>
<p> The 2-minute overall Salesforce API timeout limit doesn’t apply to
asynchronous runs.
</p>
</li>
<li>
<p> The Salesforce Reports and Dashboards REST API can handle a higher
number of asynchronous run requests at a time.
</p>
</li>
<li>
<p> Since the results of an asynchronously run report are stored for a
24-hr rolling period, they’re available for recurring access.
</p>
</li>
</ul>
<p>Before you filter a report, it helpful to check the following properties in the metadata
that tell you if a field can be filtered, the values and criteria you can filter
by, and filters that already exist in the report:
</p>

<ul>
<li>
<p> filterable
</p>
</li>
<li>
<p> filterValues
</p>
</li>
<li>
<p> dataTypeFilterOperatorMap
</p>
</li>
<li>
<p> reportFilters
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>tbl_df</code> by default, but a <code>list</code> when <code>as_tbl=FALSE</code>,
which means that the content from the API is converted from JSON to a list
with no other post-processing.
</p>


<h3>Salesforce Documentation</h3>


<ul>
<li> <p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_getreportrundata.htm">Sync Documentation</a>
</p>
</li>
<li> <p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_get_reportdata.htm#example_sync_reportexecute">Sync Example</a>
</p>
</li>
<li> <p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_instances_summaryasync.htm">Async Documentation</a>
</p>
</li>
<li> <p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_get_reportdata.htm#example_report_async_instances">Async Example</a>
</p>
</li>
<li> <p><a href="https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_filter_reportdata.htm#example_requestbody_execute_resource">Filtering Results</a>
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other Report functions: 
<code>sf_copy_report()</code>,
<code>sf_create_report()</code>,
<code>sf_delete_report()</code>,
<code>sf_describe_report_type()</code>,
<code>sf_describe_report()</code>,
<code>sf_list_report_fields()</code>,
<code>sf_list_report_filter_operators()</code>,
<code>sf_list_report_types()</code>,
<code>sf_list_reports()</code>,
<code>sf_query_report()</code>,
<code>sf_run_report()</code>,
<code>sf_update_report()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# first, get the Id of a report in your Org
all_reports &lt;- sf_query("SELECT Id, Name FROM Report")
this_report_id &lt;- all_reports$Id[1]

# then execute a synchronous report that will wait for the results
results &lt;- sf_execute_report(this_report_id)

# alternatively, you can execute an async report and then grab its results when done
#   - The benefit of an async report is that the results will be stored for up to
#     24 hours for faster recall, if needed
results &lt;- sf_execute_report(this_report_id, async=TRUE)

# check if completed and proceed if the status is "Success"
instance_list &lt;- sf_list_report_instances(report_id)
instance_status &lt;- instance_list[[which(instance_list$id == results$id), "status"]]
if(instance_status == "Success"){
  results &lt;- sf_get_report_instance_results(report_id, results$id)
}

# Note: For more complex execution use the report_metadata argument.
# This can be done by building the list from scratch based on Salesforce 
# documentation (not recommended) or pulling down the existing reportMetadata 
# property of the report and modifying the list slightly (recommended). 
# In addition, for relatively simple changes, you can leverage the convenience 
# function sf_report_wrapper() which makes it easier to retrieve report results
report_details &lt;- sf_describe_report(this_report_id)
report_metadata &lt;- list(reportMetadata = report_details$reportMetadata)
report_metadata$reportMetadata$showGrandTotal &lt;- FALSE
report_metadata$reportMetadata$showSubtotals &lt;- FALSE
fields &lt;- sf_execute_report(this_report_id,
                            report_metadata = report_metadata)

## End(Not run)
</code></pre>


</div>