<div class="container">

<table style="width: 100%;"><tr>
<td>fitspatgev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLE for a spatial GEV model</h2>

<h3>Description</h3>

<p>This function derives the MLE of a spatial GEV model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitspatgev(data, covariables, loc.form, scale.form, shape.form,
temp.cov = NULL, temp.form.loc = NULL, temp.form.scale = NULL,
temp.form.shape = NULL, ..., start, control = list(maxit = 10000),
method = "Nelder", warn = TRUE, corr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing the data. Each column corresponds to
one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariables</code></td>
<td>
<p>Matrix with named columns giving required
covariates for the GEV parameter models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.form, scale.form, shape.form</code></td>
<td>
<p>R formulas defining the
spatial  models for the GEV parameters. See section Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.cov</code></td>
<td>
<p>Matrix with names columns giving additional *temporal*
covariates for the GEV parameters. If <code>NULL</code>, no temporal trend
are assume for the GEV parameters â€” see section Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.form.loc, temp.form.scale, temp.form.shape</code></td>
<td>
<p>R formulas
defining the temporal trends for the GEV parameters. May be
missing. See section Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values for the
parameters over which the pairwise likelihood is to be minimized. If
<code>start</code> is omitted the routine attempts to find good starting
values - but might fail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Several arguments to be passed to the
<code>optim</code> functions. See section details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The control argument to be passed to the
<code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for the numerical optimisation
procedure. Must be one of <code>BFGS</code>, <code>Nelder-Mead</code>,
<code>CG</code>, <code>L-BFGS-B</code> or <code>SANN</code>. See <code>optim</code>
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), users will be warned if
the starting values lie in a zero density region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the asymptotic correlation matrix
is computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A kind of "spatial" GEV model can be defined by using response
surfaces for the GEV parameters. For instance, the GEV location
parameters are defined through the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\mu = X_\mu \beta_\mu</code>
</p>

<p>where <code class="reqn">X_\mu</code> is the design matrix and
<code class="reqn">\beta_\mu</code> is the vector parameter to be
estimated. The GEV scale and shape parameters are defined accordingly
to the above equation.
</p>
<p>The log-likelihood for the GEV spatial model is consequently defined
as follows:
</p>
<p style="text-align: center;"><code class="reqn">\ell(\beta) = \sum_{i=1}^{n.site} \sum_{j=1}^{n.obs} \log
    f(y_{i,j}; \theta_i)</code>
</p>

<p>where <code class="reqn">\theta_i</code> is the vector of the GEV parameters for
the <code class="reqn">i</code>-th site.
</p>
<p>Most often, there will be some dependence between stations. However,
it can be seen from the log-likelihood definition that we supposed
that the stations are mutually independent. Consequently, to get
reliable standard error estimates, these standard errors are estimated
with their sandwich estimates.
</p>
<p>There are two different kind of covariates : "spatial" and
"temporal".
</p>
<p>A "spatial" covariate may have different values accross station but
does not depend on time. For example the coordinates of the stations
are obviously "spatial". These "spatial" covariates should be used
with the <code>marg.cov</code> and <code>loc.form, scale.form, shape.form</code>.
</p>
<p>A "temporal" covariates may have different values accross time but
does not depend on space. For example the years where the annual
maxima were recorded is "temporal". These "temporal" covariates should
be used with the <code>temp.cov</code> and <code>temp.form.loc,
    temp.form.scale, temp.form.shape</code>.
</p>
<p>As a consequence note that <code>marg.cov</code> must have K rows (K being
the number of sites) while <code>temp.cov</code> must have n rows (n being
the number of observations).
</p>


<h3>Value</h3>

<p>An object of class <code>spatgev</code>. Namely, this is a list with the
following arguments:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>All the parameters e.g. parameter estimates and fixed
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>The standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cov</code></td>
<td>
<p>The asymptotic MLE variance covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts,message,convergence</code></td>
<td>
<p>Some information about the
optimization procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik,deviance</code></td>
<td>
<p>The log-likelihood and deviance values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.form, scale.form, shape.form</code></td>
<td>
<p>The formulas defining the
spatial models for the GEV parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariables</code></td>
<td>
<p>The covariables used for the spatial models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ihessian</code></td>
<td>
<p>The inverse of the Hessian matrix of the negative
log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jacobian</code></td>
<td>
<p>The variance covariance matrix of the score.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1- Simulate a max-stable random field
n.site &lt;- 35
locations &lt;- matrix(runif(2*n.site, 0, 10), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")
data &lt;- rmaxstab(50, locations, cov.mod = "whitmat", nugget = 0, range =
  3, smooth = 0.5)

## 2- Transformation to non unit Frechet margins
param.loc &lt;- -10 + 2 * locations[,2]
param.scale &lt;- 5 + 2 * locations[,1]
param.shape &lt;- rep(0.2, n.site)
for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], param.loc[i], param.scale[i],
param.shape[i])

## 3- Fit a ''spatial GEV'' mdoel to data with the following models for
##    the GEV parameters
form.loc &lt;- loc ~ lat
form.scale &lt;- scale ~ lon
form.shape &lt;- shape ~ 1

fitspatgev(data, locations, form.loc, form.scale, form.shape)
</code></pre>


</div>