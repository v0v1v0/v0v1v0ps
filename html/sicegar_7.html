<div class="container">

<table style="width: 100%;"><tr>
<td>multipleFitFunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>multiple fit function.</h2>

<h3>Description</h3>

<p>Calls the fitting algorithms to fit the data multiple times with starting from different randomly generated initial parameters in each run. Multiple attempts at fitting the data are necessary to avoid local minima.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multipleFitFunction(
  dataInput,
  dataInputName = NA,
  model,
  n_runs_min = 20,
  n_runs_max = 500,
  showDetails = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity. The data should be normalized with the normalize data function sicegar::normalizeData() before imported into this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataInputName</code></td>
<td>
<p>Name of data set (Default is 'NA').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Type of fit model that will be used. Can be "sigmoidal", or "double_sigmoidal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_runs_min</code></td>
<td>
<p>This number indicates the lower limit of the successful fitting attempts. It should be smaller than the upper limit of the fitting attempts (n_runs_max). Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_runs_max</code></td>
<td>
<p>This number indicates the upper limit of the fitting attempts. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showDetails</code></td>
<td>
<p>Logical if TRUE prints details of intermediate steps of individual fits (Default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>All other arguments that model functions ("sigmoidalFitFunction" and, "doublesigmoidalFitFunction") may need.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the parameters related with the model fitted for the input data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 (sigmoidal function with normalization)
time &lt;- seq(3, 24, 0.5)

#simulate intensity data and add noise
noise_parameter &lt;- 2.5
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sigmoidalFitFormula(time, maximum = 4, slopeParam = 1, midPoint = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput, dataInputName = "sample001")
parameterVector &lt;- multipleFitFunction(dataInput = normalizedInput,
                                      model = "sigmoidal",
                                      n_runs_min = 20,
                                      n_runs_max = 500)

#Check the results
if(parameterVector$isThisaFit){
  intensityTheoretical &lt;- sigmoidalFitFormula(time,
                            maximum = parameterVector$maximum_Estimate,
                            slopeParam = parameterVector$slopeParam_Estimate,
                            midPoint = parameterVector$midPoint_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 print(parameterVector$residual_Sum_of_Squares)

 require(ggplot2)
 ggplot(comparisonData)+
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical), color = "orange") +
   expand_limits(x = 0, y = 0)
}



if(!parameterVector$isThisaFit){
  print(parameterVector)
}

# Example 2 (doublesigmoidal function with normalization)
time &lt;- seq(3, 24, 0.1)

#simulate intensity data with noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- doublesigmoidalFitFormula(time,
                                      finalAsymptoteIntensityRatio = .3,
                                      maximum = 4,
                                      slope1Param = 1,
                                      midPoint1Param = 7,
                                      slope2Param = 1,
                                      midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- multipleFitFunction(dataInput = normalizedInput,
                           dataInputName="sample001",
                           model = "doublesigmoidal",
                           n_runs_min = 20,
                           n_runs_max = 500,
                           showDetails = FALSE)


#Check the results
if(parameterVector$isThisaFit){
 intensityTheoretical &lt;-
       doublesigmoidalFitFormula(
               time,
               finalAsymptoteIntensityRatio = parameterVector$finalAsymptoteIntensityRatio_Estimate,
               maximum = parameterVector$maximum_Estimate,
               slope1Param = parameterVector$slope1Param_Estimate,
               midPoint1Param = parameterVector$midPoint1Param_Estimate,
               slope2Param = parameterVector$slope2Param_Estimate,
               midPointDistanceParam = parameterVector$midPointDistanceParam_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical), color = "orange") +
   expand_limits(x = 0, y = 0)
 }

if(!parameterVector$isThisaFit){
  print(parameterVector)
  }


</code></pre>


</div>