<div class="container">

<table style="width: 100%;"><tr>
<td>plot_raster_smos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a raster image of BEC-SMOS soil moisture data</h2>

<h3>Description</h3>

<p>This function draws a raster image of BEC-SMOS soil moisture data
corresponding to a single data file and specific geographical extent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_raster_smos(data, lat = NULL, lon = NULL, QA = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a character string containing a link to a single BEC-SMOS data
file stored on the local computer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>a numeric vector of length 2 containing latitudinal bounds of
the plotting region (in ‘latlon’ projection). Default value is <code>NULL</code>
meaning that all data between min and max latitudes are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>a numeric vector of length 2 containing longitudinal bounds of
the plotting region (in ‘latlon’ projection). Default value is <code>NULL</code>
meaning that all data between min and max longitudes are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QA</code></td>
<td>
<p>a numeric vector specifying the desired data quality to be plotted.
Possible values range from 0 (good quality data) to 15. To know the meanings
of QA flags, see Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reads an original BEC-SMOS soil moisture data file in NetCDF
format, converts data from EASE-2 grid cells to geographic coordinates, and
draws a raster image of soil moisture estimates in ‘latlon’ projection. The
image can be drawn for a specific geographical extent if requested by the
user. Otherwise, the entire dataset across Europe (between 28 and 72 degrees
north and -11 and 40 degrees east) will be plotted. Note that due to high
resolution of the data (~1 km), the execution of this function may take a
long time to be completed depending on the amount of data to be drawn.
</p>
<p>**** Quality assurance (QA) ****
</p>
<p>QA flags are coded by four significant bits as described below:
</p>

<table>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> -------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> Bit position </td>
<td style="text-align: left;"> Bit value </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> -------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> [0] </td>
<td style="text-align: left;"> 0 - Brightness temperature not affected by sea-land contamination </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;">     </td>
<td style="text-align: left;"> 1 - Brightness temperature corrected by sea-land contamination </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> ------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> [1] </td>
<td style="text-align: left;"> 0 - Radio Frequency Interference (RFI) not flagged in ESA L1C </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;">     </td>
<td style="text-align: left;"> brightness temperature </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;">     </td>
<td style="text-align: left;"> 1 - RFI flagged in ESA L1C brightness temperature </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> ------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> [2] </td>
<td style="text-align: left;"> 0 - L3 soil moisture with data obtained from L2 retrievals </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;">     </td>
<td style="text-align: left;"> 1 - L3 soil moisture with data obtained from a linear model </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> ------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> [3] </td>
<td style="text-align: left;"> 0 - L4 soil moisture values within the interval [0,1] m^3/m^3 </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;">     </td>
<td style="text-align: left;"> 1 - L4 soil moisture values outside the interval [0,1] m^3/m^3 </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: center;"> ------------- </td>
<td style="text-align: left;"> -------------------------------------------------------------------------------- </td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>In case of the 3-day averaged data, each bit of the quality flag is activated
if at least one soil moisture estimate during the corresponding time interval
is affected.
</p>


<h3>Value</h3>

<p>a raster image
</p>


<h3>References</h3>

<p>Pablos M, Gonzalez-Haro C, Portal G, Piles M, Vall-llossera M,
Portabella M (2022). SMOS L4 Surface Soil Moisture downscaled maps at 1 km
EASE-2 (reprocessed mode) (V.6.0) [Dataset].
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# to draw a raster image of soil moisture data corresponding to the first BEC-SMOS file
# from a list produced by list_smos() and within the specified geographical bounds#'
smos_files &lt;- list_smos()
lat &lt;- c(35.00, 45.00)
lon &lt;- c(-10.50, 4.50)
plot_raster_smos(data = smos_files[1], lat = lat, lon = lon)

## End(Not run)

</code></pre>


</div>