<div class="container">

<table style="width: 100%;"><tr>
<td>nodeProbabilities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiplies conditional probabilities along all branches of the tree</h2>

<h3>Description</h3>

<p>This function generates the symbolic formulas representing
the marginal node probabilities.</p>


<h3>Usage</h3>

<pre><code class="language-R">nodeProbabilities(F,generation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>A recurrent selfing tree, as generated by function
<code>buildSelfingTree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generation</code></td>
<td>
<p>Integer giving the highest selfing generation contained
in <code>F</code>. Values can range from 2 to 7, e.g., the F2 generation
build by default and the highest possible generation is currently the
F7.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each formula represents the marginal probability of a
particular node. Summing over all nodes for a particular genotype
gives the probability of observing this genotype in this
generation. The sum over all marginal node probabilities within a
generation is 1.</p>


<h3>Value</h3>

<p>A <code>list</code> with as many elements as there were generations in
<code>F</code>. The list elements are named "F2", "F3", etc. Each element is a
vector with the symbolic formulas for the marginal probabilities of all
possible nodes. The vector elements are named
and the names indicate the allelic configuration of the two gametes
comprising the genotype as <code>gamete1-gamete2</code> (e.g.,
<code>"AAB-AAA"</code>).  </p>


<h3>Author(s)</h3>

<p>Frank Technow
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## F2 and F3 genotypes
node.probs &lt;- nodeProbabilities(buildSelfingTree(genSubtree.2M,3,"AA","BB"),3)

## must sum to 1
stopifnot(all.equal(evalProb(node.probs[["F2"]],z = 0.045),1))
stopifnot(all.equal(evalProb(node.probs[["F3"]],z = 0.045),1))

</code></pre>


</div>