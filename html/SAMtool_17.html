<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic of assessments in MSE: did Assess models converge during MSE?</h2>

<h3>Description</h3>

<p>Diagnostic check for convergence of Assess models during closed-loop simulation. Use when the MP was
created with make_MP with argument <code>diagnostic = "min"</code> or <code>"full"</code>.
This function summarizes and plots the diagnostic information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic(MSE, MP, gradient_threshold = 0.1, figure = TRUE)

diagnostic_AM(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>An object of class MSE created by <code>MSEtool::runMSE()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MP</code></td>
<td>
<p>Optional, a character vector of MPs that use assessment models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_threshold</code></td>
<td>
<p>The maximum magnitude (absolute value) desired for the gradient of the likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figure</code></td>
<td>
<p>Logical, whether a figure will be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to pass to <code>diagnostic</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with diagnostic performance of assessment models in the MSE. If <code>figure = TRUE</code>,
a set of figures: traffic light (red/green) plots indicating whether the model converged (defined if a positive-definite
Hessian matrix was obtained), the optimizer reached pre-specified iteration limits (as passed to <code>stats::nlminb()</code>),
and the maximum gradient of the likelihood in each assessment run. Also includes the number of optimization iterations
function evaluations reported by <code>stats::nlminb()</code> for each application of the assessment model.
</p>


<h3>Author(s)</h3>

<p>Q. Huynh
</p>


<h3>See Also</h3>

<p>retrospective_AM
</p>


<h3>Examples</h3>

<pre><code class="language-R">
OM &lt;- MSEtool::testOM; OM@proyears &lt;- 20
myMSE &lt;- runMSE(OM, MPs = "SCA_4010")
diagnostic(myMSE)

# How to get all the reporting
library(dplyr)
conv_statistics &lt;- lapply(1:myMSE@nMPs, function(m) {
  lapply(1:myMSE@nsim, function(x) {
    myMSE@PPD[[m]]@Misc[[x]]$diagnostic %&gt;%
      mutate(MP = myMSE@MPs[m], Simulation = x)
 }) %&gt;% bind_rows()
}) %&gt;% bind_rows()

</code></pre>


</div>