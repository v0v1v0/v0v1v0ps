<div class="container">

<table style="width: 100%;"><tr>
<td>individual_variable_effect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Individual Variable Effect</h2>

<h3>Description</h3>

<p>Individual Variable Effect
</p>


<h3>Usage</h3>

<pre><code class="language-R">individual_variable_effect(x, ...)

## S3 method for class 'explainer'
individual_variable_effect(
  x,
  new_observation,
  method = "KernelSHAP",
  nsamples = "auto",
  ...
)

## Default S3 method:
individual_variable_effect(
  x,
  data,
  predict_function = predict,
  new_observation,
  label = tail(class(x), 1),
  method = "KernelSHAP",
  nsamples = "auto",
  ...
)

shap(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a model to be explained, or an explainer created with function <code>explain</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_observation</code></td>
<td>
<p>an observation/observations to be explained. Required for local/instance level
explainers. Columns in should correspond to columns in the data argument. Data set should not contain any additional columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an estimation method of SHAP values. Currently the only availible is 'KernelSHAP'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>number of samples or "auto". Note that number must be as integer. Use 'as.integer()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>validation dataset. Used to determine univariate distributions, calculation of quantiles,
correlations and so on. It will be extracted from 'x' if it’s an explainer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict_function</code></td>
<td>
<p>predict function that operates on the model 'x'. Since the model is a black box,
the 'predict_function' is the only interface to access values from the model. It should be a function that
takes at least a model 'x' and data and returns vector of predictions. If model response has more than
a single number (like multiclass models) then this function should return a marix/data.frame of the size
'm' x 'd', where 'm' is the number of observations while 'd' is the dimensionality of model response.
It will be extracted from 'x' if it’s an explainer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>name of the model. By default it’s extracted from the class attribute of the model</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class individual_variable_effect with shap values of each variable for each new observation.
Columns:
</p>

<ul>
<li>
<p> first d columns contains variable values.
</p>
</li>
<li>
<p> _id_ - id of observation, number of row in 'new_observation' data.
</p>
</li>
<li>
<p> _ylevel_ - level of y
</p>
</li>
<li>
<p> _yhat_ -predicted value for level of y
</p>
</li>
<li>
<p> _yhat_mean_ - expected value of prediction, mean of all predictions
</p>
</li>
<li>
<p> _vname_ - variable name
</p>
</li>
<li>
<p> _attribution_ - attribution of variable
</p>
</li>
<li>
<p> _sign_ a sign of attribution
</p>
</li>
<li>
<p> _label_ a label
</p>
</li>
</ul>
<p>In order to use shapper with other python virtual environment following R command are required to execute
reticulate::use_virtualenv("path_to_your_env")
or for conda
reticulate::use_conda("name_of_conda_env")
before attaching shapper.
</p>


<h3>Examples</h3>

<pre><code class="language-R">have_shap &lt;- reticulate::py_module_available("shap")

if(have_shap){
  library("shapper")
  library("DALEX")
  library("randomForest")
  Y_train &lt;- HR$status
  x_train &lt;- HR[ , -6]
  set.seed(123)
  model_rf &lt;- randomForest(x = x_train, y = Y_train, ntree= 50)
  p_function &lt;- function(model, data) predict(model, newdata = data, type = "prob")

  ive_rf &lt;- individual_variable_effect(model_rf, data = x_train, predict_function = p_function,
                                     new_observation = x_train[1:2,], nsamples = 50)
  ive_rf
} else{
    print('Python testing environment is required.')
}


</code></pre>


</div>