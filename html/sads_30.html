<div class="container">

<table style="width: 100%;"><tr>
<td>dpowbend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Puyeo's Power-bend discrete distribution
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for discrete
version of Pueyo's power-bend distribution with parameters <code>s</code> and <code>omega</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpowbend( x, s, omega = 0.01, oM = -log(omega), log=FALSE)
ppowbend ( q, s, omega = 0.01, oM = -log(omega), lower.tail=TRUE, log.p=FALSE)
qpowbend( p, s, omega = 0.01, oM = -log(omega), lower.tail= TRUE, log.p=FALSE)
rpowbend( n, s, omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, this is a vector of abundances of
species in a sample. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, a vector of
abundances of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>positive real s &gt; 1; exponent of the power-bend distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>

<p>positive real greater than 0; bending parameter of the distribution. 
The current implementation only accepts omega smaller than 5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oM</code></td>
<td>

<p>real number; alternative parametrization which is used for faster fitting on the 
<code>fitpowbend</code> function. The current implementation only accepts oM
greater than approximately -1.5. You can specify either 'omega' or 'oM', but not both.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power-bend density is a discrete probability distribution based on the
power probability density with an added term for “bending”, defined for
integer x &gt; 0:
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{x^{-s} e^{- \omega x}}{Li_s (e^\omega)}</code>
</p>

<p>The bending term can be seen as a finite-size correction of the power law
(Pueyo 2006). Therefore, the power-bend can describe better samples taken from power-law distributions.
</p>
<p>The function <code class="reqn">Li_s(e^\omega)</code> is the Polylogarithm of the 
exponential of <code>omega</code> on base <code>s</code>, and represents the integration constant.
A naive implementation of the Polylogarithm function is included in the package, and
accepts values for non-integer <code>s</code> and <code>omega</code> smaller than 5, which cover the
cases of biological relevance.
</p>
<p>This distribution was proposed by S. Pueyo to describe species
abundance distributions (sads) as a generalization of the
logseries distribution. Fisher's logseries correspond to the
power-bend with parameters s=1 and
<code class="reqn">\omega = - \log(\frac{N}{N + \alpha})</code>
where N is sample size or total number of individuals and <code class="reqn">alpha</code> is the
Fisher's alpha parameter of the logseries.
</p>
<p>When fitted to sads, power-law distributions usually overestimates the abundance of common
species, and in practice power-bend corrects this problem and usually
provides a better fit to abundance distributions.
</p>


<h3>Value</h3>

<p><code>dpowbend</code> gives the (log) density of the function, <code>ppowbend</code> gives the (log)
distribution function, <code>qpowbend</code> gives the quantile function.
</p>
<p>Invalid values for parameter <code>s</code> or <code>omega</code> will result in return
values <code>NaN</code>, with a warning. Note that integer values of <code>s</code> and 
<code>omega</code> values larger than 5 are currently not supported, and will also
return <code>NaN</code>.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom.</p>


<h3>References</h3>

<p>Pueyo, S. (2006) <em>Diversity: Between neutrality and structure</em>,
Oikos 112: 392-405. 
</p>


<h3>See Also</h3>

<p><code>dpower</code> for the power distribution; <code>dls</code> for the
logseries distribution, which is a particular case of the power-bend,
<code>fitpowbend</code> for maximum likelihood estimation in
the context of species abundance distributions. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- 1:20
PDF &lt;- dpowbend(x=x, s=2.1, omega=0.5)
CDF &lt;- ppowbend(q=x, s=2.1, omega=0.5)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Powerbend distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Powerbend distribution, PDF")
par(mfrow=c(1,1))

## The powbend distribution is a discrete PDF, hence:
all.equal( ppowbend(10, s=2.1, omega=0.5), sum(dpowbend(1:10, s=2.1, omega=0.5)) ) # should be TRUE

## quantile is the inverse of CDF
all.equal(qpowbend(CDF, s=2.1, omega=0.5), x)

## Equivalence between power-bend and logseries
x &lt;- 1:100
N &lt;- 1000
alpha &lt;- 5
X &lt;- N/(N+alpha)
omega &lt;- -log(X)
PDF1 &lt;- dls(x, N, alpha)
PDF2 &lt;- dpowbend(x, s=1, omega)
plot(PDF1,PDF2, log="xy")
abline(0,1, col="blue")
</code></pre>


</div>