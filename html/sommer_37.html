<div class="container">

<table style="width: 100%;"><tr>
<td>DT_cpdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Genotypic and Phenotypic data for a CP population
</h2>

<h3>Description</h3>

<p>A CP population or F1 cross is the designation for a cross between 2 highly heterozygote individuals; i.e. humans, fruit crops, bredding populations in recurrent selection.
</p>
<p>This dataset contains phenotpic data for 363 siblings for an F1 cross. These are averages over 2 environments evaluated for 4 traits; color, yield, fruit average weight, and firmness. The columns in the CPgeno file are the markers whereas the rows are the individuals. The CPpheno data frame contains the measurements for the 363 siblings, and as mentioned before are averages over 2 environments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("DT_cpdata")</code></pre>


<h3>Format</h3>

<p>The format is:
chr "DT_cpdata"
</p>


<h3>Source</h3>

<p>This data was simulated for fruit breeding applications.
</p>


<h3>References</h3>

<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744
</p>


<h3>See Also</h3>

<p>The core functions of the package <code>mmer</code> and <code>mmec</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# ####=========================================####
# #### For CRAN time limitations most lines in the
# #### examples are silenced with one '#' mark,
# #### remove them and run the examples using
# #### command + shift + C |OR| control + shift + C
# ####=========================================####
#
# data(DT_cpdata)
# DT &lt;- DT_cpdata
# GT &lt;- GT_cpdata
# MP &lt;- MP_cpdata
# #### create the variance-covariance matrix
# A &lt;- A.mat(GT) # additive relationship matrix
# #### look at the data and fit the model
# head(DT)
# mix1 &lt;- mmer(Yield~1,
#               random=~vsr(id,Gu=A)
#                       + Rowf + Colf,
#               rcov=~units,
#               data=DT)
# summary(mix1)$varcomp
#
# ## mmec uses the inverse of the relationship matrix
# Ai &lt;- as(solve(A + diag(1e-4,ncol(A),ncol(A))), Class="dgCMatrix")
# mix2 &lt;- mmec(Yield~1,
#              random=~vsc(isc(id),Gu=Ai)
#              + Rowf + Colf,
#              rcov=~units,
#              data=DT)
# summary(mix2)$varcomp
#
# vg &lt;- summary(mix2)$varcomp[1,1] # genetic variance
# G &lt;- A*vg # genetic variance-covariance
# Ci &lt;- mix2$Ci # coefficient matrix
# ind &lt;- as.vector(mix2$partitions$`vsc(isc(id), Gu = Ai)`)
# ind &lt;- seq(ind[1],ind[2])
# Ctt &lt;- Ci[ind,ind] # portion of Ci for genotypes
# R2 &lt;- (G - Ctt)/G # reliability matrix
# mean(diag(R2)) # average reliability of the trial
#
# ####====================####
# #### multivariate model ####
# ####     2 traits       ####
# ####====================####
# #### be patient take some time
# ans.m &lt;- mmer(cbind(Yield,color)~1,
#                random=~ vsr(id, Gu=A)
#                + vsr(Rowf,Gtc=diag(2))
#                + vsr(Colf,Gtc=diag(2)),
#                rcov=~ vsr(units),
#                data=DT)
# cov2cor(ans.m$sigma$`u:id`)

</code></pre>


</div>