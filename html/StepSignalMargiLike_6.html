<div class="container">

<table style="width: 100%;"><tr>
<td>est.changepoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>est.changepoints</h2>

<h3>Description</h3>

<p>This function estimates multiple change points using
marginal likelihood method proposed by Du, Kao and Kou
(2015), which we would denoted as DKK2015 afterward.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.changepoints(data.x, model, prior, max.segs, logH, logMD)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.x</code></td>
<td>
<p>Observed data in vector or matrix form. When the data is in matrix form, each column should represent a single observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The specified distributional assumption. Currently we have implemented two arguments: "normal" (data follows one dimensional Normal distribution with unknown mean and variance) and "poisson" (data follows Poisson distribution with unknown intensity). A third argument "user" is also accepted, given that the prior and the log marginal likelihood function are specified in the parameter prior and logMD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>The prespecified prior parameters in
consistent with the form used in <code>logMD</code>.<br> For the
proposed priors in DKK2015, use the corresponding
<code>prior</code> function provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.segs</code></td>
<td>
<p>(Opt.) The maximum number of segments allowed,
which is the value M in DKK2015. Must be a positive
integer greater then 1. If missing, the function would process using the
algorihtm by Jackson et al.(2005).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logH</code></td>
<td>
<p>(Opt.) A Boolean algebra determine whether to
report the log H matrix in DKK2015. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logMD</code></td>
<td>
<p>(Opt.) The log marginal likelihood function (which
is the log of D function in DKK2015). The function must
be in the form of <code>logMD(data.x, prior)</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Manual.pdf in "data" folder.
</p>


<h3>Value</h3>

<p>If <code>logH</code> is FALSE, the function returns the set of
estimated change-points by the index of the data, where
each index is the end point of a segment. If the result
is no change-points, the function returns <code>NULL</code>. <br>
If <code>logH</code> is TRUE, then the function
returns a list with three components:
<code>changePTs</code> is the set of estimated change-points,
<code>log.H</code> is the log value for the H matrix used in the algorithm,
where <code class="reqn">log.H(m,i) = log H(x1, x2, ..., xi | m)</code>, and <code>max.j</code>
records the <code class="reqn">j</code> that maximizes the marginal likelihood in each step.
See the manual in data folder for more details.
</p>


<h3>References</h3>

<p>Chao Du, Chu-Lan Michael Kao and S. C. Kou (2015),
"Stepwise Signal Extraction via Marginal Likelihood".
Forthcoming in Journal of American Statistical Association.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(StepSignalMargiLike)

n &lt;- 5
data.x &lt;- rnorm(n, 1, 1)
data.x &lt;- c(data.x, rnorm(n, 10,1))
data.x &lt;- c(data.x, rnorm(n, 2,1))
data.x &lt;- c(data.x, rnorm(n, 10,1))
data.x &lt;- c(data.x, rnorm(n, 1,1))

prior &lt;- prior.norm.A(data.x)
max.segs &lt;- 10

est.changepoints(data.x=data.x, model="normal", prior=prior)
est.changepoints(data.x=data.x, model="normal", prior=prior, max.segs=max.segs)
est.changepoints(data.x=data.x, model="normal", prior=prior, max.segs=max.segs,logH=TRUE)
</code></pre>


</div>