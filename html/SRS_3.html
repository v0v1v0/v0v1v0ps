<div class="container">

<table style="width: 100%;"><tr>
<td>Scaling with ranked subsampling curve (SRScurve)</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scaling with ranked subsampling curve (SRScurve)
</h2>

<h3>Description</h3>

<p>For each column of the input data, draws a line plot of alpha diversity indices (see metric) at different sample sizes (specified by step) normalized by scaling with ranked subsampling (using SRS). Minimum sample size (cutoff-level) can be evaluated by specifying sample. The function further allows to visualize trade-offs between cutoff-level and alpha diversity and enables direct comparison of SRS and repeated rarefying.
</p>
<p>See Beule &amp; Karlovsky (2020) &lt;doi:10.7717/peerj.9593&gt; for details regarding SRS.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SRScurve(data, metric = "richness", step = 50, sample = 0, max.sample.size = 0,
        rarefy.comparison = FALSE, rarefy.repeats = 10, 
        rarefy.comparison.legend = FALSE, xlab = "sample size", 
        ylab = "richness", label = FALSE, col, lty, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame (species count or OTU table) in which columns are samples and rows are the counts of species or OTUs. Only integers are accepted as data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>

<p>Character, "richness" (using specnumber) for species richness or "shannon", "simpson" or "invsimpson" (using diversity) for common diversity indices. Default is "richness".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>

<p>Numeric, specifying the step used to vary the sample size. Default is 50.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>

<p>Numeric, specifying the cutoff-level to visualize trade-offs between cutoff-level and alpha diversity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.sample.size</code></td>
<td>

<p>Numeric, specifying the maximum sample size to which SRS curves are drawn. Default is 0 which does not limit the maximum sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy.comparison</code></td>
<td>

<p>Logical, if TRUE, median values of rarefy with n repeats (specified by rarefy.repeats) will be drawn for comparison. Default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy.repeats</code></td>
<td>

<p>Numeric, specifying the number of repeats used to obtain median values for rarefying. Default is 10.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rarefy.comparison.legend</code></td>
<td>

<p>Logical, if TRUE, a legend for the comparison between SRS and rarefy is plotted. Default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, label, col, lty, ...</code></td>
<td>

<p>Graphical parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Beule &amp; Karlovsky (2020) &lt;doi:10.7717/peerj.9593&gt; for details regarding scaling with ranked subsampling.
</p>


<h3>Value</h3>

<p>Returns a line plot visualizing the change in alpha diversity indices with changing sample size.
</p>


<h3>Author(s)</h3>

<p>Vitor Heidrich, Petr Karlovsky, Lukas Beule
</p>


<h3>References</h3>

<p>Beule L, Karlovsky P. 2020. Improved normalization of species count data in ecology by scaling with ranked subsampling (SRS): application to microbial communities. PeerJ 8:e9593
</p>
<p>&lt;https://doi.org/10.7717/peerj.9593&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Samples should be arranged columnwise.
##Input data should not contain any categorial
##data such as taxonomic assignment or barcode sequences.
##An example of the input data can be found below:

example_input_data &lt;- matrix(c(sample(1:20, 100, replace = TRUE),
sample(1:30, 100, replace = TRUE),sample(1:40, 100, replace = TRUE)), nrow = 100)
colnames(example_input_data) &lt;- c("sample_1","sample_2","sample_3")
example_input_data &lt;- as.data.frame(example_input_data)
example_input_data

##Default settings of SRScurve.
SRScurve(example_input_data, metric = "richness", step = 50,
         ylab = "richness", 
         col = c("#000000", "#E69F00", "#56B4E9"))

##Limit the compution of SRS curves to a sample size of 200.
SRScurve(example_input_data, metric = "richness", step = 50,
         max.sample.size = 200, ylab = "richness", 
         col = c("#000000", "#E69F00", "#56B4E9"))

##SRScurve with comparison of SRS (solid lines) and repeated rarefying (dashed lines).
##Different colors correspond to indiviual samples. Cuttoff-level set to 200.
SRScurve(example_input_data, metric = "richness", step = 50,
         sample = 200, max.sample.size = 200,
         rarefy.comparison = TRUE, rarefy.repeats = 10, rarefy.comparison.legend = TRUE,
         ylab = "richness", 
         col = c(rep(c("#000000", "#E69F00", "#56B4E9"),2)),
         lty = c(1,2))
</code></pre>


</div>