<div class="container">

<table style="width: 100%;"><tr>
<td>circular</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Circular Probability
</h2>

<h3>Description</h3>

<p>Functions to answer the question "what radius is expected to include
proportion p of points from a circular bivariate distribution
corresponding to a given detection function", and the reverse. These
functions may be used to relate the scale parameter(s) of a detection
function (e.g., <code class="reqn">\sigma</code>) to home-range area (specifically, the area
within an activity contour for the corresponding simple home-range
model) (see Note).
</p>
<p>WARNING: the default behaviour of these functions changed in version
2.6.0. Integration is now performed on the cumulative hazard (exposure)
scale for all functions unless <code>hazard = FALSE</code>. Results will
differ.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
circular.r (p = 0.95, detectfn = 0, sigma = 1, detectpar = NULL, hazard
= TRUE, upper = Inf, ...) 

circular.p (r = 1, detectfn = 0, sigma = 1, detectpar = NULL, hazard
= TRUE, upper = Inf, ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probability levels for which radius is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>vector of radii for which probability level is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectfn</code></td>
<td>
<p>integer code or character string for shape of
detection function 0 = halfnormal, 2 = exponential etc. – see
detectfn for other codes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>spatial scale parameter of detection function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectpar</code></td>
<td>
<p>named list of detection function parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard</code></td>
<td>
<p>logical; if TRUE the transformation <code class="reqn">-log(1-g(d))</code>
is applied before integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>numeric upper limit of integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>integrate</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>circular.r</code> is the quantile function of the specified circular
bivariate distribution (analogous to <code>qnorm</code>, for example). The
quantity calculated by <code>circular.r</code> is sometimes called 'circular
error probable' (see Note).
</p>
<p>For detection functions with two parameters (intercept and scale) it is
enough to provide <code>sigma</code>. Otherwise, <code>detectpar</code> should be a
named list including parameter values for the requested detection
function (g0 may be omitted, and order does not matter).
</p>
<p>Detection functions in <span class="pkg">secr</span> are expressed in terms of the decline
in probability of detection with distance <code class="reqn">g(d)</code>, and both
<code>circular.r</code> and <code>circular.p</code> integrate this function by
default. Rather than integrating <code class="reqn">g(d)</code> itself, it may be more
appropriate to integrate <code class="reqn">g(d)</code> transformed to a hazard i.e. <code class="reqn">1
- log(-g(d))</code>. This is selected with <code>hazard = TRUE</code>.
</p>
<p>Integration may also fail with the message “roundoff error is detected in the extrapolation table”. 
Setting <code>upper</code> to a large number less than infinity sometimes corrects this.
</p>


<h3>Value</h3>

<p>Vector of values for the required radii or probabilities.
</p>


<h3>Note</h3>

<p>The term ‘circular error probable’ has a military origin. It is
commonly used for GPS accuracy with the default probability level set to
0.5 (i.e. half of locations are further than CEP from the true
location). A circular bivariate normal distriubution is commonly assumed
for the circular error probable; this is equivalent to setting
<code>detectfn = "halfnormal"</code>.
</p>
<p>Closed-form expressions are used for the normal and uniform cases; in
the circular bivariate normal case, the relationship is <code class="reqn">r =
\sigma \sqrt{-2\mbox{ln}(1-p)} </code>. Otherwise,
the probability is computed numerically by integrating the radial
distribution. Numerical integration is not foolproof, so check
suspicious or extreme values.
</p>
<p>When <code>circular.r</code> is used with the default <code>sigma = 1</code>, the result
may be interpreted as the factor by which sigma needs to be inflated to
include the desired proportion of activity (e.g., 2.45 sigma for 95%
of points from a circular bivariate normal distribution fitted on the hazard
scale (detectfn = 14) OR 2.24 sigma on the probability scale (detectfn = 0)).
</p>


<h3>References</h3>

 
<p>Calhoun, J. B. and Casby, J. U. (1958) Calculation of home range and
density of small mammals. Public Health Monograph No. 55. United States
Government Printing Office.
</p>
<p>Johnson, R. A. and Wichern, D. W. (1982) Applied multivariate
statistical analysis. Prentice-Hall, Englewood Cliffs, New Jersey, USA.
</p>


<h3>See Also</h3>

<p><code>detectfn</code>,  <code>detectfnplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Calhoun and Casby (1958) p 3.
## give p = 0.3940, 0.8645, 0.9888
circular.p(1:3, hazard = FALSE)

## halfnormal, hazard-rate and exponential
circular.r ()
circular.r (detectfn = "HR", detectpar = list(sigma = 1, z = 4))
circular.r (detectfn = "EX")
circular.r (detectfn = "HHN")
circular.r (detectfn = "HHR", detectpar = list(sigma = 1, z = 4))
circular.r (detectfn = "HEX")

plot(seq(0, 5, 0.05), circular.p(r = seq(0, 5, 0.05)),
    type = "l", xlab = "Radius (multiples of sigma)", ylab = "Probability")
lines(seq(0, 5, 0.05), circular.p(r = seq(0, 5, 0.05), detectfn = 2),
    type = "l", col = "red")
lines(seq(0, 5, 0.05), circular.p(r = seq(0, 5, 0.05), detectfn = 1,
    detectpar = list(sigma = 1,z = 4)), type = "l", col = "blue")
abline (h = 0.95, lty = 2)

legend (2.8, 0.3, legend = c("halfnormal","hazard-rate, z = 4", "exponential"),
    col = c("black","blue","red"), lty = rep(1,3))

## in this example, a more interesting comparison would use
## sigma = 0.58 for the exponential curve.

</code></pre>


</div>