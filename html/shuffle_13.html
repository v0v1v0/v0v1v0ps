<div class="container">

<table style="width: 100%;"><tr>
<td>shuffle-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Shuffle Estimator for Explainable Variance </h2>

<h3>Description</h3>

<p>This package implements the algorithms underlying the shuffle estimators, variance 
estimators for one-way analysis of variance designs. The estimators can overcome correlated noise 
by recomputing the mean-square-between statistics on a permuted version of the data. 
The permutations should preserve the noise covariance matrix, but a parametric model for the noise covariance is not necessary. For more details see Benjamini and Yu, and here 
<a href="http://statweb.stanford.edu/~yuvalben">http://statweb.stanford.edu/~yuvalben</a>.
</p>
<p>Two functions implement the important stages of estimation:<br>
prepareShuffle(design_vec, premutation), which preprocess the design and computes the normalization constant for a given permutation.<br>
estimateShuffle(response_vec, prepare), which estimates variances and effect sizes for a specific data vector.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> shuffle</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0.1</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2013-4-24 </td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yuval Benjamini &lt;yuvalbenj@gmail.com&gt;
</p>


<h3>References</h3>

<p>Benjamini and Yu (2013), "The shuffle estimator for explainable variance in fMRI experiments", Annals of Applied Statistics 7 (4) <a href="http://projecteuclid.org/euclid.aoas/1387823308">http://projecteuclid.org/euclid.aoas/1387823308</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(design_vec,fMRI_responses,prediction_res)

# Make example shorter - for paper example use T = ncol(fMRI_responses)
T = 156*4
fMRI_responses_sm = fMRI_responses[,1:T]
design_sm = design_vec[1:T]
permutation = rev(1:T)

prep_shuffle = prepareShuffle(design_sm,permutation)

var_explained = numeric(nrow(fMRI_responses_sm))
for (i in 1:nrow(fMRI_responses_sm)) {
    var_explained[i] = estimateShuffle(fMRI_responses_sm[i,],prep_shuffle)$effect
}

plot(var_explained, pmax(prediction_res,0)^2,
		    xlim = c(0,0.7), ylim = c(0,0.7), 
		    xlab = "Explainable variance", ylab = "Corr^2") 
abline(0,1,col=4)
</code></pre>


</div>