<div class="container">

<table style="width: 100%;"><tr>
<td>fa_parallel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct Parallel Analysis</h2>

<h3>Description</h3>

<p>Computes the eigenvalues of the sample correlation matrix and the eigenvalues
obtained from a random correlation matrix for which no factors/components are
assumed. By default, the function utilizes a modified Horn's (1965) method,
which – instead of mean – uses 95th percentile of each item eigenvalues
sampling distribution as a threshold to find the optimal number of
factors/components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fa_parallel(
  Data,
  cor = "pearson",
  n_obs = NULL,
  method = "pca",
  threshold = "quantile",
  p = 0.95,
  n_iter = 20,
  plot = TRUE,
  show_kaiser = TRUE,
  fm = "minres",
  use = "pairwise",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p><em>data.frame</em> or <em>matrix</em>, dataset (where rows are
observations and columns items) or correlation matrix (recognized
automatically).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p><em>character</em>, how to calculate the correlation matrix of the
real data. Can be either <code>pearson</code> (default), <code>tetrachoric</code> or
<code>polychoric</code>. Unambiguous abbreviations accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_obs</code></td>
<td>
<p><em>integer</em>, in case you provided the correlation matrix
directly as the input, you have to provide the number of observations in
the original dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><em>character</em>, either <code>fa</code>, <code>pca</code>, or <code>both</code>
(the default). Which method to use for the eigenvalues simulation and
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p><em>character</em>, whether to use traditionall Horn's method
or more recent and well-performing quantile one. Either <code>mean</code> or
<code>quantile</code> (default). Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p><em>numeric</em> (0–1), probability for which the sample quantile is
produced. Defaults to <code>.95</code>. Ignored if <code>threshold = "mean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p><em>integer</em>, number of iterations, i.e. the number of
zero-factor multivariate normal distributions to sample. Defaults to
<code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><em>logical</em>, if <code>TRUE</code> (the default), show the plot along
with the function results. To create the plot from the resulting object
afterwards, call <code>plot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_kaiser</code></td>
<td>
<p><em>logical</em>, whether to show Kaiser boundary in the
plot (the default) or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fm</code></td>
<td>
<p><em>character</em>, factoring method. See <code>psych::fa()</code>
from the package <code>psych::psych()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>an optional character string giving a method for computing
covariances in the presence of missing values. This must be (an
abbreviation of) one of the strings "everything", "all.obs",
"complete.obs", "na.or.complete", or "pairwise.complete.obs".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>psych::polychoric</code>
</p>

<dl>
<dt><code>correct</code></dt>
<dd>
<p>Correction value to use to correct for continuity in the case of zero entry cell for tetrachoric, polychoric, polybi, and mixed.cor.  See the examples for the effect of correcting versus not correcting for continuity.</p>
</dd>
<dt><code>smooth</code></dt>
<dd>
<p>if TRUE and if the tetrachoric/polychoric matrix is not positive definite, then apply a simple smoothing algorithm using cor.smooth</p>
</dd>
<dt><code>global</code></dt>
<dd>
<p>When finding pairwise correlations, should we use the global values of the tau parameter (which is somewhat faster), or the local values (global=FALSE)?  The local option is equivalent to the polycor solution, or to doing one correlation at a time. global=TRUE borrows information for one item pair from the other pairs using those item's frequencies.   This will make a difference in the presence of lots of missing data. With very small sample sizes with global=FALSE and correct=TRUE, the function will fail (for as yet underdetermined reasons. </p>
</dd>
<dt><code>weight</code></dt>
<dd>
<p>A vector of length of the number of observations that specifies the weights to apply to each case.  The NULL case is equivalent of weights of 1 for all cases.  </p>
</dd>
<dt><code>progress</code></dt>
<dd>
<p>Show the progress bar (if  not doing multicores)</p>
</dd>
<dt><code>ML</code></dt>
<dd>
<p> ML=FALSE  do a quick two step procedure, ML=TRUE, do longer maximum likelihood — very slow! Deprecated</p>
</dd>
<dt><code>delete</code></dt>
<dd>
<p>Cases with no variance are deleted with a warning before proceeding.</p>
</dd>
<dt><code>max.cat</code></dt>
<dd>
<p>The maximum number of categories to bother with for polychoric.  </p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Horn proposed a solution to the problem of optimal factor number
identification using an approach based on a Monte Carlo simulation.
</p>
<p>First, several (20 by default) zero-factor <code>p</code>-variate normal
distributions (where <code>p</code> is the number of columns) are obtained, and
<code>p</code> × <code>p</code> correlation matrices are computed for them. Eigenvalues
of each matrix is then calculated in order to get an eigenvalues sampling
distribution for each simulated variable.
</p>
<p>Traditionally, Horn obtains an average of each sampling distribution and
these averages are used as a threshold which is compared with eigenvalues of
the original, real data. However, <em>usage of the mean was later disputed</em>
by Buja &amp; Eyuboglu (1992), and 95th percentile of eigenvalues sampling
distribution was suggested as a more accurate threshold. This, more recent
method is used by default in the function.
</p>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> and <code>sia_parallel</code>. Can be
plotted using <code>plot()</code>.
</p>


<h3>Author(s)</h3>

<p>Jan Netik <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:netik@cs.cas.cz">netik@cs.cas.cz</a>
</p>
<p>Patricia Martinkova <br>
Institute of Computer Science of the Czech Academy of Sciences <br><a href="mailto:martinkova@cs.cas.cz">martinkova@cs.cas.cz</a>
</p>


<h3>References</h3>

<p>Horn, J. L. (1965). A rationale and test for the number of factors in factor
analysis. Psychometrika, 30, 179–185. <a href="https://doi.org/10.1007/BF02289447">doi:10.1007/BF02289447</a>
</p>
<p>Buja, A., &amp; Eyuboglu, N. (1992). Remarks on parallel analysis. Multivariate
Behavioral Research, 27, 509–540. <a href="https://doi.org/10.1207/s15327906mbr2704_2">doi:10.1207/s15327906mbr2704_2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fa_parallel(TestAnxietyCor, n_obs = 335, method = "pca")

## Not run: 
data("bfi", package = "psych")
items &lt;- bfi[, 1:25]

fa_parallel(items)
fa_parallel(items, threshold = "mean") # traditional Horn's method

## End(Not run)

</code></pre>


</div>