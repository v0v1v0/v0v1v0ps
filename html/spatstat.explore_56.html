<div class="container">

<table style="width: 100%;"><tr>
<td>bw.smoothppp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross Validated Bandwidth Selection for Spatial Smoothing
</h2>

<h3>Description</h3>

<p>Uses least-squares cross-validation to select a smoothing bandwidth
for spatial smoothing of marks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   bw.smoothppp(X, nh = spatstat.options("n.bandwidth"),
                hmin=NULL, hmax=NULL, warn=TRUE, kernel="gaussian",
                varcov1=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A marked point pattern with numeric marks.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>

<p>Number of trial values of smoothing bandwith <code>sigma</code>
to consider. The default is 32.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmin, hmax</code></td>
<td>

<p>Optional. Numeric values.
Range of trial values of smoothing bandwith <code>sigma</code>
to consider. There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>

<p>Logical. If <code>TRUE</code>, issue a warning if the minimum of
the cross-validation criterion occurs at one of the ends of the
search interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>The smoothing kernel.
A character string specifying the smoothing kernel
(current options are <code>"gaussian"</code>, <code>"epanechnikov"</code>,
<code>"quartic"</code> or <code>"disc"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov1</code></td>
<td>

<p>Optional. Variance-covariance matrix matrix of the kernel with
bandwidth <code class="reqn">h=1</code>. See section on Anisotropic Smoothing.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function selects an appropriate bandwidth for the nonparametric
smoothing of mark values using <code>Smooth.ppp</code>.
</p>
<p>The argument <code>X</code> must be a marked point pattern
with a vector or data frame of marks. All mark values must be numeric.
</p>
<p>The bandwidth is selected by least-squares cross-validation.
Let <code class="reqn">y_i</code> be the mark value at the <code class="reqn">i</code>th data point.
For a particular choice of smoothing bandwidth,
let <code class="reqn">\hat y_i</code> be the smoothed value at the <code class="reqn">i</code>th data point.
Then the bandwidth is chosen to minimise 
the squared error of the smoothed values
<code class="reqn">\sum_i (y_i - \hat y_i)^2</code>.
</p>
<p>The result of <code>bw.smoothppp</code>
is a numerical value giving the selected bandwidth <code>sigma</code>.
The result also belongs to the class <code>"bw.optim"</code>
allowing it to be printed and plotted. The plot shows the cross-validation
criterion as a function of bandwidth.  
</p>
<p>The range of values for the smoothing bandwidth <code>sigma</code>
is set by the arguments <code>hmin, hmax</code>. There is a sensible default,
based on the nearest neighbour distances.
</p>
<p>If the optimal bandwidth is achieved at an endpoint of the
interval <code>[hmin, hmax]</code>, the algorithm will issue a warning
(unless <code>warn=FALSE</code>). If this occurs, then it is probably advisable
to expand the interval by changing the arguments <code>hmin, hmax</code>.
</p>
<p>Computation time depends on the number <code>nh</code> of trial values
considered, and also on the range <code>[hmin, hmax]</code> of values
considered, because larger values of <code>sigma</code> require
calculations involving more pairs of data points.
</p>


<h3>Value</h3>

<p>A single numerical value giving the selected bandwidth.
The result also belongs to the class <code>"bw.optim"</code>
(see <code>bw.optim.object</code>)
which can be plotted to show the bandwidth selection criterion
as a function of <code>sigma</code>.
</p>


<h3>Anisotropic Smoothing</h3>

<p>Anisotropic smoothing is available in <code>Smooth.ppp</code> using
the argument <code>varcov</code> to specify the variance-covariance
matrix of the anisotropic kernel. In order to choose the matrix
<code>varcov</code>, the user can call <code>bw.smoothppp</code> 
using the argument <code>varcov1</code> to specify a ‘template’
matrix. Scalar multiples of <code>varcov1</code> will be
considered and the optimal scale factor will be determined.
That is, <code>bw.smoothppp</code> will try 
smoothing the data using <code>varcov = h^2 * varcov1</code> for different
values of <code>h</code> ranging from <code>hmin</code> to <code>hmax</code>. 
The result of <code>bw.smoothppp</code> will be the optimal value
of the standard deviation scale factor <code>h</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>See Also</h3>

<p><code>Smooth.ppp</code>,
<code>bw.optim.object</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
  b &lt;- bw.smoothppp(longleaf)
  b
  plot(b)
  
</code></pre>


</div>