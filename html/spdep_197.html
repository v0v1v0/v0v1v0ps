<div class="container">

<table style="width: 100%;"><tr>
<td>mstree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the minimal spanning tree</h2>

<h3>Description</h3>

<p>The minimal spanning tree is a connected graph with n nodes and n-1
edges. This is a smaller class of possible partitions of a graph by
pruning edges with high dissimilarity. If one edge is removed, the
graph is partioned in two unconnected subgraphs. This function
implements the algorithm due to Prim (1987).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mstree(nbw, ini = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nbw</code></td>
<td>
<p>An object of <code>listw</code> class returned by
<code>nb2listw</code> function. See this help for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini</code></td>
<td>
<p>The initial node in the minimal spanning tree.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The minimum spanning tree algorithm.
</p>
<p>Input a connected graph.
</p>
<p>Begin a empty set of nodes.
</p>
<p>Add an arbitrary note in this set.
</p>
<p>While are nodes not in the set, find a minimum cost edge connecting a
node in the set and a node out of the set and add this node in the
set.
</p>
<p>The set of edges is a minimum spanning tree.  
</p>


<h3>Value</h3>

<p>A matrix with n-1 rows and tree columns. Each row is two nodes and the
cost, i. e. the edge and it cost.
</p>


<h3>Author(s)</h3>

<p>Renato M. Assuncao and Elias T. Krainski</p>


<h3>References</h3>

<p>R. C. Prim (1957) Shortest connection networks and some
generalisations. In: Bell System Technical Journal, 36, pp. 1389-1401 
</p>


<h3>Examples</h3>

<pre><code class="language-R">### loading data
(GDAL37 &lt;- as.numeric_version(unname(sf_extSoftVersion()["GDAL"])) &gt;= "3.7.0")
file &lt;- "etc/shapes/bhicv.gpkg.zip"
zipfile &lt;- system.file(file, package="spdep")
if (GDAL37) {
    bh &lt;- st_read(zipfile)
} else {
    td &lt;- tempdir()
    bn &lt;- sub(".zip", "", basename(file), fixed=TRUE)
    target &lt;- unzip(zipfile, files=bn, exdir=td)
    bh &lt;- st_read(target)
}
### data padronized
dpad &lt;- data.frame(scale(as.data.frame(bh)[,5:8]))

### neighboorhod list 
bh.nb &lt;- poly2nb(bh)

### calculing costs
lcosts &lt;- nbcosts(bh.nb, dpad)

### making listw
nb.w &lt;- nb2listw(bh.nb, lcosts, style="B")

### find a minimum spanning tree
system.time(mst.bh &lt;- mstree(nb.w,5))
dim(mst.bh)
head(mst.bh)
tail(mst.bh)
### the mstree plot
par(mar=c(0,0,0,0))
plot(st_geometry(bh), border=gray(.5))
plot(mst.bh, st_coordinates(st_centroid(bh)), col=2, 
     cex.lab=.6, cex.circles=0.035, fg="blue", add=TRUE)

</code></pre>


</div>