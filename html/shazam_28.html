<div class="container">

<table style="width: 100%;"><tr>
<td>extendMutabilityMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extends a mutability model to include Ns.</h2>

<h3>Description</h3>

<p><code>extendMutabilityMatrix</code> extends a 5-mer nucleotide mutability model 
with 5-mers that include Ns by averaging over all corresponding 5-mers without Ns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extendMutabilityMatrix(mutabilityModel)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>mutabilityModel</code></td>
<td>
<p>vector of 5-mer mutability rates built by 
createMutabilityMatrix.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A <code>MutabilityModel</code> containing a 3125 vector of normalized 
mutability rates for each 5-mer motif with names defining the 5-mer 
nucleotide sequence. Note that "normalized" means that the mutability 
rates for the 1024 5-mers that contain no "N" at any position sums up 
to 1 (as opposed to the entire vector summing up to 1). 
</p>
<p>If the input <code>mutabilityModel</code> is of class <code>MutabilityModel</code>, 
then the output <code>MutabilityModel</code> will carry over the input 
<code>numMutS</code> and <code>numMutR</code> slots.
</p>


<h3>See Also</h3>

<p>createMutabilityMatrix, extendSubstitutionMatrix, 
MutabilityModel
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Subset example data to one isotype and sample as a demo
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call == "IGHA" &amp; sample_id == "-1h")
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=75)

# Create model using only silent mutations and ignore multiple mutations
sub_model &lt;- createSubstitutionMatrix(db, model="s", sequenceColumn="sequence_alignment",
                                      germlineColumn="germline_alignment_d_mask",
                                      vCallColumn="v_call")
mut_model &lt;- createMutabilityMatrix(db, sub_model, model="s", 
                                    sequenceColumn="sequence_alignment",
                                    germlineColumn="germline_alignment_d_mask",
                                    vCallColumn="v_call")
ext_model &lt;- extendMutabilityMatrix(mut_model)


</code></pre>


</div>