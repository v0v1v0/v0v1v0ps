<div class="container">

<table style="width: 100%;"><tr>
<td>oneway_anova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One-way analysis of variance (ANOVA)</h2>

<h3>Description</h3>

<p>Parametric, non-parametric, robust, and Bayesian one-way ANOVA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">oneway_anova(
  data,
  x,
  y,
  subject.id = NULL,
  type = "parametric",
  paired = FALSE,
  digits = 2L,
  conf.level = 0.95,
  effsize.type = "omega",
  var.equal = FALSE,
  bf.prior = 0.707,
  tr = 0.2,
  nboot = 100L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame (or a tibble) from which variables specified are to
be taken. Other data types (e.g., matrix,table, array, etc.) will <strong>not</strong>
be accepted. Additionally, grouped data frames from <code>{dplyr}</code> should be
ungrouped before they are entered as <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The grouping (or independent) variable from <code>data</code>. In case of a
repeated measures or within-subjects design, if <code>subject.id</code> argument is
not available or not explicitly specified, the function assumes that the
data has already been sorted by such an id by the user and creates an
internal identifier. So if your data is <strong>not</strong> sorted, the results <em>can</em>
be inaccurate when there are more than two levels in <code>x</code> and there are
<code>NA</code>s present. The data is expected to be sorted by user in
subject-1, subject-2, ..., pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response (or outcome or dependent) variable from <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject.id</code></td>
<td>
<p>Relevant in case of a repeated measures or within-subjects
design (<code>paired = TRUE</code>, i.e.), it specifies the subject or repeated
measures identifier. <strong>Important</strong>: Note that if this argument is <code>NULL</code>
(which is the default), the function assumes that the data has already been
sorted by such an id by the user and creates an internal identifier. So if
your data is <strong>not</strong> sorted and you leave this argument unspecified, the
results <em>can</em> be inaccurate when there are more than two levels in <code>x</code> and
there are <code>NA</code>s present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character specifying the type of statistical approach:
</p>

<ul>
<li> <p><code>"parametric"</code>
</p>
</li>
<li> <p><code>"nonparametric"</code>
</p>
</li>
<li> <p><code>"robust"</code>
</p>
</li>
<li> <p><code>"bayes"</code>
</p>
</li>
</ul>
<p>You can specify just the initial letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>Logical that decides whether the experimental design is
repeated measures/within-subjects or between-subjects. The default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits for rounding or significant figures. May also
be <code>"signif"</code> to return significant figures or <code>"scientific"</code>
to return scientific notation. Control the number of digits by adding the
value as suffix, e.g. <code>digits = "scientific4"</code> to have scientific
notation with 4 decimal places, or <code>digits = "signif5"</code> for 5
significant figures (see also <code>signif()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Scalar between <code>0</code> and <code>1</code> (default: <code style="white-space: pre;">⁠95%⁠</code>
confidence/credible intervals, <code>0.95</code>). If <code>NULL</code>, no confidence intervals
will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effsize.type</code></td>
<td>
<p>Type of effect size needed for <em>parametric</em> tests. The
argument can be <code>"eta"</code> (partial eta-squared) or <code>"omega"</code> (partial
omega-squared).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p>a logical variable indicating whether to treat the
two variances as being equal. If <code>TRUE</code> then the pooled
variance is used to estimate the variance otherwise the Welch
(or Satterthwaite) approximation to the degrees of freedom is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bf.prior</code></td>
<td>
<p>A number between <code>0.5</code> and <code>2</code> (default <code>0.707</code>), the prior
width to use in calculating Bayes factors and posterior estimates. In
addition to numeric arguments, several named values are also recognized:
<code>"medium"</code>, <code>"wide"</code>, and <code>"ultrawide"</code>, corresponding to <em>r</em> scale values
of <code>1/2</code>, <code>sqrt(2)/2</code>, and <code>1</code>, respectively. In case of an ANOVA, this
value corresponds to scale for fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>Trim level for the mean when carrying out <code>robust</code> tests. In case
of an error, try reducing the value of <code>tr</code>, which is by default set to
<code>0.2</code>. Lowering the value might help.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples for computing confidence interval
for the effect size (Default: <code>100L</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned tibble data frame can contain some or all of the following columns (the exact columns will depend on the statistical test):
</p>

<ul>
<li> <p><code>statistic</code>: the numeric value of a statistic
</p>
</li>
<li> <p><code>df</code>: the numeric value of a parameter being modeled (often degrees
of freedom for the test)
</p>
</li>
<li> <p><code>df.error</code> and <code>df</code>: relevant only if the statistic in question has
two degrees of freedom (e.g. anova)
</p>
</li>
<li> <p><code>p.value</code>: the two-sided <em>p</em>-value associated with the observed statistic
</p>
</li>
<li> <p><code>method</code>: the name of the inferential statistical test
</p>
</li>
<li> <p><code>estimate</code>: estimated value of the effect size
</p>
</li>
<li> <p><code>conf.low</code>: lower bound for the effect size estimate
</p>
</li>
<li> <p><code>conf.high</code>: upper bound for the effect size estimate
</p>
</li>
<li> <p><code>conf.level</code>: width of the confidence interval
</p>
</li>
<li> <p><code>conf.method</code>: method used to compute confidence interval
</p>
</li>
<li> <p><code>conf.distribution</code>: statistical distribution for the effect
</p>
</li>
<li> <p><code>effectsize</code>: the name of the effect size
</p>
</li>
<li> <p><code>n.obs</code>: number of observations
</p>
</li>
<li> <p><code>expression</code>: pre-formatted expression containing statistical details
</p>
</li>
</ul>
<p>For examples, see <a href="https://indrajeetpatil.github.io/statsExpressions/articles/web_only/dataframe_outputs.html">data frame output vignette</a>.
</p>


<h3>One-way ANOVA</h3>

<p>The table below provides summary about:
</p>

<ul>
<li>
<p> statistical test carried out for inferential statistics
</p>
</li>
<li>
<p> type of effect size estimate and a measure of uncertainty for this estimate
</p>
</li>
<li>
<p> functions used internally to compute these details
</p>
</li>
</ul>
<h4>between-subjects</h4>

<p><strong>Hypothesis testing</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> No. of groups </td>
<td style="text-align: left;"> Test </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Fisher's or Welch's one-way ANOVA </td>
<td style="text-align: left;"> <code>stats::oneway.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Non-parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Kruskal-Wallis one-way ANOVA </td>
<td style="text-align: left;"> <code>stats::kruskal.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Robust </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Heteroscedastic one-way ANOVA for trimmed means </td>
<td style="text-align: left;"> <code>WRS2::t1way()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayes Factor </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Fisher's ANOVA </td>
<td style="text-align: left;"> <code>BayesFactor::anovaBF()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><strong>Effect size estimation</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> No. of groups </td>
<td style="text-align: left;"> Effect size </td>
<td style="text-align: left;"> CI available? </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> partial eta-squared, partial omega-squared </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::omega_squared()</code>, <code>effectsize::eta_squared()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Non-parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> rank epsilon squared </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::rank_epsilon_squared()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Robust </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Explanatory measure of effect size </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>WRS2::t1way()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayes Factor </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Bayesian R-squared </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>performance::r2_bayes()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h4>within-subjects</h4>

<p><strong>Hypothesis testing</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> No. of groups </td>
<td style="text-align: left;"> Test </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> One-way repeated measures ANOVA </td>
<td style="text-align: left;"> <code>afex::aov_ez()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Non-parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Friedman rank sum test </td>
<td style="text-align: left;"> <code>stats::friedman.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Robust </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Heteroscedastic one-way repeated measures ANOVA for trimmed means </td>
<td style="text-align: left;"> <code>WRS2::rmanova()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayes Factor </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> One-way repeated measures ANOVA </td>
<td style="text-align: left;"> <code>BayesFactor::anovaBF()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><strong>Effect size estimation</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> No. of groups </td>
<td style="text-align: left;"> Effect size </td>
<td style="text-align: left;"> CI available? </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> partial eta-squared, partial omega-squared </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::omega_squared()</code>, <code>effectsize::eta_squared()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Non-parametric </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Kendall's coefficient of concordance </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::kendalls_w()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Robust </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Algina-Keselman-Penfield robust standardized difference average </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>WRS2::wmcpAKP()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayes Factor </td>
<td style="text-align: left;"> &gt; 2 </td>
<td style="text-align: left;"> Bayesian R-squared </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>performance::r2_bayes()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Citation</h3>

<p>Patil, I., (2021). statsExpressions: R Package for Tidy Dataframes and Expressions with Statistical Details. Journal of Open Source Software, 6(61), 3236, https://doi.org/10.21105/joss.03236
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# for reproducibility
set.seed(123)
library(statsExpressions)

# ----------------------- parametric -------------------------------------

# between-subjects
oneway_anova(
  data = mtcars,
  x    = cyl,
  y    = wt
)

# within-subjects design
oneway_anova(
  data       = iris_long,
  x          = condition,
  y          = value,
  subject.id = id,
  paired     = TRUE
)

# ----------------------- non-parametric ----------------------------------

# between-subjects
oneway_anova(
  data = mtcars,
  x    = cyl,
  y    = wt,
  type = "np"
)

# within-subjects design
oneway_anova(
  data       = iris_long,
  x          = condition,
  y          = value,
  subject.id = id,
  paired     = TRUE,
  type       = "np"
)

# ----------------------- robust -------------------------------------

# between-subjects
oneway_anova(
  data = mtcars,
  x    = cyl,
  y    = wt,
  type = "r"
)

# within-subjects design
oneway_anova(
  data       = iris_long,
  x          = condition,
  y          = value,
  subject.id = id,
  paired     = TRUE,
  type       = "r"
)



# ----------------------- Bayesian -------------------------------------

# between-subjects
oneway_anova(
  data = mtcars,
  x    = cyl,
  y    = wt,
  type = "bayes"
)

# within-subjects design
oneway_anova(
  data       = iris_long,
  x          = condition,
  y          = value,
  subject.id = id,
  paired     = TRUE,
  type       = "bayes"
)

</code></pre>


</div>