<div class="container">

<table style="width: 100%;"><tr>
<td>SLTCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scalable and Robust Latent Trajectory Class Analysis Using Artificial Likelihood</h2>

<h3>Description</h3>

<p>Conduct latent trajectory class analysis with longitudinal observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SLTCA(
  k = 20,
  dat,
  num_class,
  id,
  time,
  num_obs,
  features,
  Y_dist,
  covx,
  ipw,
  stop,
  tol = 0.005,
  max = 50,
  varest = TRUE,
  balanced = TRUE,
  MSC = "EQIC",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of random initialization to start the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Input data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_class</code></td>
<td>
<p>Number of latent classes in the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Column name in the data matrix 'dat' for the patient id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Column name in the data matrix 'dat' for the time of longitudinal observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_obs</code></td>
<td>
<p>Column name in the data matrix 'dat' for the number of longitudinal observations (number of visits).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A vector of column names in the data matrix 'dat' for the longitudinal observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_dist</code></td>
<td>
<p>A vector indicating the type of longitudinal observations. An element of Y_dist can be 'normal','bin', and 'poi' for continuous, binary and count data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covx</code></td>
<td>
<p>A vector of column names in the data matrix 'dat' for baseline latent class risk factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipw</code></td>
<td>
<p>Column name in the data matrix 'dat' for the inverse probability weights for missingness. ipw=1 if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>Stopping criterion for the algorithm. stop can be either 'tau' based on posterior probabilities or 'par' based on point estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A constant such that the algorithm stops if the stopping criterion is below this constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>Maximum number of iterations if the algorithm does not converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>True or False: whether conduct variance estimation or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balanced</code></td>
<td>
<p>True or False: whether the longitudinal observations are equally spaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSC</code></td>
<td>
<p>Model selection criteria: 'AQIC','BQIC' or 'EQIC'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Output progress of fitting the model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with point estimates (alpha, beta0, beta1, phi, gamma), variance estimates (ASE), posterior membership probabilities (tau), QICs (qic) of the latent trajectory class model, and stopping criteria (diff) at the last iteration. Point estimates and variance estimates are provided in matrix format, where columns represent latent classes and rows represent covariates or longitudinal features.
</p>


<h3>Author(s)</h3>

<p>Teng Fei. Email: &lt;tfei@emory.edu&gt;
</p>


<h3>References</h3>

<p>Hart, K.R., Fei, T. and Hanfelt, J.J. (2020), Scalable and robust latent trajectory class analysis using artificial likelihood. Biometrics. Accepted Author Manuscript &lt;doi:10.1111/biom.13366&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# In this illustrative example the sample size is set as n=50,
# variance estimation is skipped by setting varest=FALSE, and
# the maximum number of iterations is set as max=1 in order to pass CRAN test.
# Please use n=500, varest=TRUE and max=50 for more reliable results.

dat &lt;- simulation(n=50)
res &lt;- SLTCA(k=1,dat,num_class=2,"id","time","num_obs",paste("y.",1:6,sep=''),
             Y_dist=c('poi','poi','bin','bin','normal','normal'),
             "baselinecov",1,stop="tau",tol=0.005,max=1,
             varest=FALSE,balanced=TRUE,MSC='EQIC',verbose=FALSE)

</code></pre>


</div>