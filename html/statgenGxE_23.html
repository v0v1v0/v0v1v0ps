<div class="container">

<table style="width: 100%;"><tr>
<td>gxeVarCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Selects the best variance-covariance model for a set of trials</h2>

<h3>Description</h3>

<p>This function selects the best covariance structure for genetic correlations
between trials. It fits a range of variance-covariance models (identity,
compound symmetry (cs), diagonal, simple correlation with heterogeneous
variance (outside), heterogeneous compound symmetry (hcs),
first order factor analytic (fa), second order factor analytic (fa2) and
unstructured), and selects the best one using a goodness-of-fit criterion.
See details for the exact models fitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gxeVarCov(
  TD,
  trials = names(TD),
  trait,
  models = c("identity", "cs", "diagonal", "hcs", "outside", "fa", "fa2", "unstructured"),
  engine = c("lme4", "asreml"),
  criterion = c("BIC", "AIC"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TD</code></td>
<td>
<p>An object of class <code>TD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>A character string specifying the trials to be analyzed. If
not supplied, all trials are used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>A character string specifying the trait to be analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>A character vector specifying the models to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>A character string specifying the engine used for modeling.
Either "lme4" or "asreml".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A string specifying a goodness-of-fit criterion. Either
"AIC" or "BIC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the modeling engine.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The models fitted are of the form <code class="reqn">y_{ij} = \mu_j + \epsilon_{ij}</code>, where
<code class="reqn">y_{ij}</code> is the phenotypic value of genotype <code class="reqn">i</code> in environment
<code class="reqn">j</code>, <code class="reqn">\mu_j</code>
is the environmental mean, and <code class="reqn">\epsilon_{ij}</code> represents mainly genetic
variation, although some non-genetic variation may be included as well.
The random term <code class="reqn">\epsilon_{ij}</code> is modeled in eight ways as described in
the table below.</p>

<table>
<tr>
<td style="text-align: left;">
   Model </td>
<td style="text-align: left;"> Description </td>
<td style="text-align: left;"> var(<code class="reqn">g_{ij}</code>) </td>
<td style="text-align: left;"> cov(<code class="reqn">g_{ij}</code>;<code class="reqn">g_{ik}</code>) </td>
<td style="text-align: left;"> Number of parameters </td>
</tr>
<tr>
<td style="text-align: left;">
   identity </td>
<td style="text-align: left;"> identity </td>
<td style="text-align: left;"> <code class="reqn">\sigma_G^2</code> </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
   cs </td>
<td style="text-align: left;"> compound symmetry </td>
<td style="text-align: left;"> <code class="reqn">\sigma_G^2+\sigma_{GE}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{GE}^2</code> </td>
<td style="text-align: left;"> 2 </td>
</tr>
<tr>
<td style="text-align: left;">
   diagonal </td>
<td style="text-align: left;"> diagonal matrix (heteroscedastic) </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{GE_j}^2</code> </td>
<td style="text-align: left;"> 0 </td>
<td style="text-align: left;"> <code class="reqn">J</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   hcs </td>
<td style="text-align: left;"> heterogeneous compound symmetry </td>
<td style="text-align: left;"> <code class="reqn">\sigma_G^2+\sigma_{GE_j}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_G^2</code> </td>
<td style="text-align: left;"> <code class="reqn">J+1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   outside </td>
<td style="text-align: left;"> heterogeneity outside </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{G_j}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\theta</code> </td>
<td style="text-align: left;"> <code class="reqn">J+1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   fa </td>
<td style="text-align: left;"> first order factor analytic </td>
<td style="text-align: left;"> <code class="reqn">\lambda_{1j}^2+\sigma_{GE_j}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\lambda_{1j}\lambda_{1k}</code> </td>
<td style="text-align: left;"> <code class="reqn">2J</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   fa2 </td>
<td style="text-align: left;"> second order factor analytic </td>
<td style="text-align: left;"> <code class="reqn">\lambda_{1j}^2+\lambda_{2j}^2+\sigma_{GE_j}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\lambda_{1j}\lambda_{1k}+\lambda_{2j}\lambda_{2k}</code> </td>
<td style="text-align: left;"> <code class="reqn">3J-1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   unstructured </td>
<td style="text-align: left;"> unstructured </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{G_j}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">\sigma_{G_{j,k}}^2</code> </td>
<td style="text-align: left;"> <code class="reqn">J(J+1)/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>In this table <code class="reqn">J</code> is the number of environments, <code class="reqn">\sigma_G^2</code> the
variance component for the genotype main effects, <code class="reqn">\sigma_{GE}^2</code> the
variance component for GxE interactions. <code class="reqn">\sigma_{G_j}^2</code> and
<code class="reqn">\sigma_{GE_j}^2</code> are the environment specific variance components for
the genotype main effects and GxE interaction in environment <code class="reqn">j</code>.
<code class="reqn">\sigma_{G_{j,k}}^2</code> is the genetic covariance between environments
<code class="reqn">j</code> and <code class="reqn">k</code>. <code class="reqn">\theta</code> is the common correlation between
environments and <code class="reqn">\lambda_{1j}</code> and <code class="reqn">\lambda_{2j}</code> are
environment specific multiplicative parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>varCov</code>, a list object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>STA</code></td>
<td>
<p>An object of class STA containing the best fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>A character string indicating the best fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>A data.frame with a summary of the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>The covariance matrix of the best fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A character string indicating the goodness-of-fit criterion
used for determining the best model, either "AIC" or "BIC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>A character string containing the engine used for
the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>A character string containing the trait analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data.frame with the full data set used for the analysis.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If <code>engine = "lme4"</code>, only the compound symmetry model can be
fitted.
</p>


<h3>See Also</h3>

<p>Other varCov: 
<code>fitted.varCov()</code>,
<code>plot.varCov()</code>,
<code>report.varCov()</code>,
<code>residuals.varCov()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Select the best variance-covariance model using lme4 for modeling.
geVarCov &lt;- gxeVarCov(TD = TDMaize, trait = "yld")

## Summarize results.
summary(geVarCov)


## Create a pdf report summarizing the results.
report(geVarCov, outfile = tempfile(fileext = ".pdf"))



if (requireNamespace("asreml", quietly = TRUE)) {
  ## Select the best variance-covariance model using asreml for modeling.
  ## Use BIC as a goodness-of-fit criterion.
  geVarCov2 &lt;- gxeVarCov(TD = TDMaize, trait = "yld", engine = "asreml",
                         criterion = "BIC")

  summary(geVarCov2)

  ## Plot a heatmap of the correlation matrix for the best model.
  plot(geVarCov2)
  }


</code></pre>


</div>