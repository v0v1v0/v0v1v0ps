<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_kde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation with Kernel Density Estimation</h2>

<h3>Description</h3>

<p>Generates random values from a univariate and multivariate continuous distribution by using kernel density estimation based on a sample. The function uses the Accept-Reject method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_kde(
  x,
  n = 100,
  distr = "norm",
  const.only = FALSE,
  seed = NULL,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix or data frame; data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer; the number of random values will be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>character; instrumental or candidate distribution name. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const.only</code></td>
<td>
<p>logical; if <code>TRUE</code>, the constant of the Accept-Reject method will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a single value, interpreted as an integer, or <code>NULL</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical; if <code>TRUE</code> parallel generator will be worked. <code>FALSE</code> is default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters for functions <code>kde</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Such function uses the function <code>kde</code> as kernel density estimator.
</p>
<p>The Accept-Reject method is used to simulate random variables.
Following code named distributions can be used as a value of the argument <code>distr</code> and an instrumental or candidate distribution of the simulation method.
For univariate distributions:
</p>

<dl>
<dt>norm</dt>
<dd>
<p>normal distribution (default), <code class="reqn">(-\infty,+\infty)</code></p>
</dd>
<dt>cauchy</dt>
<dd>
<p>Cauchy distribution, <code class="reqn">(-\infty,+\infty)</code></p>
</dd>
<dt>lnorm</dt>
<dd>
<p>log-normal distribution, <code class="reqn">(0,+\infty)</code></p>
</dd>
<dt>exp</dt>
<dd>
<p>exponential distribution, <code class="reqn">(0,+\infty)</code></p>
</dd>
<dt>gamma</dt>
<dd>
<p>gamma distribution, <code class="reqn">(0,+\infty)</code></p>
</dd>
<dt>weibull</dt>
<dd>
<p>Weibull distribution, <code class="reqn">(0,+\infty)</code></p>
</dd>
<dt>unif</dt>
<dd>
<p>uniform distribution, <code class="reqn">(a,b)</code></p>
</dd>
</dl>
<p>And you can choose the best fitting instrumental distribution to simulate random variables more effectively by using <code>find_best_fit</code>. See examples.
</p>
<p>For multivariate distributions, "norm" (multivariate normal distribution) is used.
</p>


<h3>Value</h3>

<p>list of given data, simulated values, kernel density estimation and the constant of the Accept-Reject method when <code>const.only</code> is <code>FALSE</code> (default).
</p>


<h3>References</h3>


<ul>
<li>
<p> Tarn Duong (2018). ks: Kernel Smoothing. R package version 1.11.2. <a href="https://CRAN.R-project.org/package=ks">https://CRAN.R-project.org/package=ks</a>
</p>
</li>
<li>
<p> Christian P. Robert and George Casella (2010) Introducing Monte Carlo Methods with R. Springer. Pages 51-57.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>find_best_fit</code>, <code>kde</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1-dimensional data
data(faithful)
hist(faithful$eruptions)
res &lt;- simukde::simulate_kde(x = faithful$eruptions, n = 100, parallel = FALSE)
hist(res$random.values)

## Simulation with the best fitting instrumental distribution
data(faithful)
par(mfrow = c(1, 3))
hist(faithful$eruptions)
fit &lt;- simukde::find_best_fit(x = faithful$eruptions, positive = TRUE)
res &lt;- simukde::simulate_kde(
  x = faithful$eruptions, n = 100,
  distr = fit$distribution, parallel = FALSE
)
hist(res$random.values)
par(mfrow = c(1, 1))

## 2-dimensional data
data(faithful)
res &lt;- simukde::simulate_kde(x = faithful, n = 100)
plot(res$kde, display = "filled.contour")
points(x = res$random.values, cex = 0.25, pch = 16, col = "green")
points(x = faithful, cex = 0.25, pch = 16, col = "black")

</code></pre>


</div>