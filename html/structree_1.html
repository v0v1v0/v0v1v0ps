<div class="container">

<table style="width: 100%;"><tr>
<td>structree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tree-Structured Clustering</h2>

<h3>Description</h3>

<p>Fusion of categories of ordinal or nominal predictors or fusion of measurement units by tree-structured clustering.
</p>


<h3>Usage</h3>

<pre><code class="language-R">structree(formula, data, family = gaussian, stop_criterion = c("AIC",
  "BIC", "CV", "pvalue"), splits_max = NULL, fold = 5, alpha = 0.05,
  grid_value = NULL, min_border = NULL, ridge = FALSE,
  constant_covs = FALSE, trace = TRUE, plot = TRUE, k = 10,
  weights = NULL, offset = NULL, ...)

## S3 method for class 'structree'
print(x, ...)

## S3 method for class 'structree'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Object of class <code>formula</code>: a symbolic description of the model to be fitted. See detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame of class <code>data.frame</code> containing the variables of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
This can be a character string naming a family function, a family function or the result of a call to a family function. 
See <code>family</code> for details of family functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_criterion</code></td>
<td>
<p>Criterion to determine the optimal number of splits in the tree component of the model; 
one out of <code>"AIC"</code>, <code>"BIC"</code>, <code>"CV"</code> and <code>"pvalue"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splits_max</code></td>
<td>
<p>Maximal number of splits in the tree component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>Number of folds; only for stop criterion <code>"CV"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level; only for stop criterion <code>"pvalue"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_value</code></td>
<td>
<p>An optional parameter; <code>grid_value</code> is a scalar giving the minimal distance between 
two adjacent observation units that are used as candidates for splitting; only for repeated measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_border</code></td>
<td>
<p>An optional parameter; <code>min_border</code> is a integer giving the minimal size of the outer 
nodes of the tree; only for repeated measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ridge</code></td>
<td>
<p>If true, a small ridge penalty is added to obtain the order of measurement units; only for repeated measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant_covs</code></td>
<td>
<p>Must be set to true, if constant covariates are available; only for repeated measurments 
(currently only available for Gaussian response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If true, information about the estimation progress is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If true, the smooth components of the model are plottet; only for categorical predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Dimension of the B-spline basis that is used to fit smooth components. For details see <code>s</code>;
only for categorical predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of prior weights to be used in the fitting process; see also <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>An a priori known component to be included in the linear predictor during fitting; see also <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>Object of class <code>"structree"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A typical formula has the form <code>response ~ predictors</code>, where <code>response</code> is the name of the response variable 
and <code>predictors</code> is a series of terms that specify the predictor of the model. 
</p>
<p>For an ordinal or nominal predictors z one has to enter <code>tr(x)</code> into the formula. 
</p>
<p>For smooth components x one has to enter <code>s(x)</code> into the formula; currently not implemented for repeated measurements. 
</p>
<p>For fixed effects z of observation units u one has to enter <code>tr(z|u)</code> into the formula. 
An unit-specific intercept is specified by <code>tr(1|u)</code>.
</p>
<p>The framework only allows for categorical predictors or observations units in the tree component, but not both. 
All other predictors with a linear term are entered as usual by <code>x1+...+xp</code>.
</p>


<h3>Value</h3>

<p>Object of class <code>"structree"</code>. 
An object of class <code>"structree"</code> is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefs_end</code></td>
<td>
<p>all coefficients of the estimated model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partitions</code></td>
<td>
<p>list of matrices containing the partitions of the predictors in the tree component including all iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_hat</code></td>
<td>
<p>list of matrices with the fitted coefficients in the tree component including all iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_opt</code></td>
<td>
<p>number of the optimal model (total number of splits-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>number of splits per predictor in the tree component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>list of ordered split-points of the predictors in the tree component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune_values</code></td>
<td>
<p>value of the stopping criterion that determine the optimal model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_ID</code></td>
<td>
<p>list of the group IDs for each observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs_group</code></td>
<td>
<p>list of coefficients of the estimated model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DM_kov</code></td>
<td>
<p>Design matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moritz Berger &lt;Moritz.Berger@imbie.uni-bonn.de&gt; <br><a href="http://www.imbie.uni-bonn.de/personen/dr-moritz-berger/">http://www.imbie.uni-bonn.de/personen/dr-moritz-berger/</a>
</p>


<h3>References</h3>

<p>Tutz, Gerhard and Berger, Moritz (2018): Tree-structured modelling of categorical predictors in regression, 
Advances in Data Analysis and Classification 12(3), 737-758.
</p>
<p>Berger, Moritz and Tutz, Gerhard (2018): Tree-structured clustering in fixed effects models, 
Journal of Computational and Graphical Statistics 27(2), 380-392.
</p>


<h3>See Also</h3>

<p><code>plot.structree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rent)

## Not run: 
mod &lt;- structree(nmqm~tr(bez)+tr(bj)+tr(rooms)+badkach0,data=rent,
                 family=gaussian,stop_criterion="CV")

print(mod)
coef(mod)

## End(Not run)

</code></pre>


</div>