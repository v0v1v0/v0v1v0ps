<div class="container">

<table style="width: 100%;"><tr>
<td>corspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-correlation between two frequency spectra</h2>

<h3>Description</h3>

<p>This function tests the similarity between two frequency spectra by returning
their maximal correlation and the frequency shift related to it. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">corspec(spec1, spec2, f = NULL, mel = FALSE, plot = TRUE, plotval = TRUE,
method = "spearman", col = "black", colval = "red",
cexval = 1, fontval = 1, xlab = NULL,
ylab = "Coefficient of correlation (r)", type="l",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec1</code></td>
<td>
<p>a first data set resulting of a spectral analysis obtained
with <code>spec</code> or <code>meanspec</code> (not in dB). This
can be either a two-column matrix (col1 = frequency, col2 = amplitude)
or a vector (amplitude).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec2</code></td>
<td>
<p>a first data set resulting of a spectral analysis obtained
with <code>spec</code> or <code>meanspec</code> (not in dB). This
can be either a two-column matrix (col1 = frequency, col2 = amplitude)
or a vector (amplitude).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of waves used to obtain <code>spec1</code>
and <code>spec2</code> (in Hz). Not necessary if <code>spec1</code> and/or <code>spec2</code>
is a two columns matrix obtained with <code>spec</code> or <code>meanspec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mel</code></td>
<td>
<p>a logical, if <code>TRUE</code> the (htk-)mel scale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots r values against frequency shift (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotval</code></td>
<td>
<p>logical, if <code>TRUE</code> adds to the plot maximum r value
and frequency offset (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which correlation coefficient is
to be computed ("pearson", "spearman", or "kendall")
(see <code>cor</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of r values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colval</code></td>
<td>
<p>colour of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexval</code></td>
<td>
<p>character size of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontval</code></td>
<td>
<p>font of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the r axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is important not to have data in dB.<br>
Successive correlations between <code>spec1</code> and <code>spec2</code> are computed when regularly
shifting <code>spec2</code> towards lower or higher frequencies.<br>
The maximal correlation is obtained at a particular shift (frequency offset). 
This shift may be positive or negative.<br>
The corresponding p value, obtained with <code>cor.test</code>, is plotted.<br>
Inverting <code>spec1</code> and <code>spec2</code> may give slight different results, see examples.
</p>


<h3>Value</h3>

<p>If <code>plot</code> is <code>FALSE</code>, <code>corspec</code> returns a list containing four
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a two-column matrix, the first colum corresponding to the frequency
shift (frequency x-axis) and the second column corresponding to the successive
r correlation values between <code>spec1</code> and <code>spec2</code> (correlation y-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>
<p>the maximum correlation value between <code>spec1</code> and <code>spec2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p value corresponding to <code>rmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>the frequency offset corresponding to <code>rmax</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jerome Sueur, improved by Laurent Lellouch</p>


<h3>References</h3>

<p>Hopp, S. L., Owren, M. J. and Evans, C. S. (Eds) 1998. <em>Animal acoustic 
communication</em>. Springer, Berlin, Heidelberg.</p>


<h3>See Also</h3>

<p><code>spec</code>, <code>meanspec</code>, <code>corspec</code>,
<code>covspectro</code>, <code>cor</code>, <code>cor.test</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: data(tico)
## compare the two first notes spectra
a&lt;-spec(tico,f=22050,wl=512,at=0.2,plot=FALSE)
c&lt;-spec(tico,f=22050,wl=512,at=1.1,plot=FALSE)
op&lt;-par(mfrow=c(2,1), mar=c(4.5,4,3,1))
spec(tico,f=22050,at=0.2,col="blue")
par(new=TRUE)
spec(tico,f=22050,at=1.1,col="green")
legend(x=8,y=0.5,c("Note A", "Note C"),lty=1,col=c("blue","green"),bty="o")
par(mar=c(5,4,2,1))
corspec(a,c, ylim=c(-0.25,0.8),xaxs="i",yaxs="i",las=1)
par(op)
## different correlation methods give different results...
op&lt;-par(mfrow=c(3,1))
corspec(a,c,xaxs="i",las=1, ylim=c(-0.25,0.8))
title("spearmann correlation (by default)")
corspec(a,c,xaxs="i",las=1,ylim=c(0,1),method="pearson")
title("pearson correlation")
corspec(a,c,xaxs="i",las=1,ylim=c(-0.23,0.5),method="kendall")
title("kendall correlation")
par(op)
## inverting x and y does not give exactly similar results
op&lt;-par(mfrow=c(2,1),mar=c(2,4,3,1))
corspec(a,c)
corspec(c,a)
par(op)
## mel scale
require(tuneR)
data(orni)
orni.mel &lt;- melfcc(orni, nbands = 256, dcttype = "t3", fbtype = "htkmel", spec_out=TRUE)
orni.mel.mean &lt;- apply(orni.mel$aspectrum, MARGIN=2, FUN=mean)
tico.mel &lt;- melfcc(tico, nbands = 256, dcttype = "t3", fbtype = "htkmel", spec_out=TRUE)
tico.mel.mean &lt;- apply(tico.mel$aspectrum, MARGIN=2, FUN=mean)
corspec(orni.mel.mean, tico.mel.mean, f=22050, mel=TRUE, plot=TRUE)

## End(Not run)</code></pre>


</div>