<div class="container">

<table style="width: 100%;"><tr>
<td>tree_phyglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic uncertainty - Phylogenetic Logistic Regression</h2>

<h3>Description</h3>

<p>Performs Phylogenetic logistic regression evaluating
uncertainty in trees topology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree_phyglm(formula, data, phy, n.tree = 2, btol = 50, track = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The model formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with species as row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'multiPhylo', see ?<code>ape</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tree</code></td>
<td>
<p>Number of times to repeat the analysis with n different trees picked 
randomly in the multiPhylo file.
If NULL, <code>n.tree</code> = 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btol</code></td>
<td>
<p>Bound on searching space. For details see <code>phyloglm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>phyloglm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a phylogenetic logistic regression model using <code>phyloglm</code>
to n trees, randomly picked in a multiPhylo file.
</p>
<p>Currently, this function can only implement simple logistic models (i.e. <code class="reqn">trait~
predictor</code>). In the future we will implement more complex models.
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_phyglm</code> returns a list with the following
components:
</p>
<p><code>formula</code>: The formula
</p>
<p><code>data</code>: Original full dataset
</p>
<p><code>sensi.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (e.g. <code>lambda</code>) for each regression with a 
different phylogenetic tree.
</p>
<p><code>N.obs</code>: Size of the dataset after matching it with tree tips and removing NA's.
</p>
<p><code>stats</code>: Main statistics for model parameters.<code>CI_low</code> and <code>CI_high</code> are the lower 
and upper limits of the 95
</p>
<p><code>all.stats</code>: Complete statistics for model parameters. <code>sd_intra</code> is the standard deviation 
due to intraspecific variation. <code>CI_low</code> and <code>CI_high</code> are the lower and upper limits 
of the 95
</p>


<h3>Author(s)</h3>

<p>Caterina Penone &amp; Pablo Ariel Martinez
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Donoghue, M.J. &amp; Ackerly, D.D. (1996). Phylogenetic Uncertainties and 
Sensitivity Analyses in Comparative Biology. Philosophical Transactions:
Biological Sciences, pp. 1241-1249.
</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.
</p>


<h3>See Also</h3>

<p><code>phyloglm</code>, <code>sensi_plot</code>,<code>tree_phylm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simulating Data:
set.seed(6987)
mphy = rmtree(150, N = 30)
x = rTrait(n=1,phy=mphy[[1]])
X = cbind(rep(1,150),x)
y = rbinTrait(n=1,phy=mphy[[1]], beta=c(-1,0.5), alpha=.7 ,X=X)
dat = data.frame(y, x)
# Run sensitivity analysis:
tree &lt;- tree_phyglm(y ~ x, data = dat, phy = mphy, n.tree = 30)
# summary results:
summary(tree)
# Visual diagnostics for phylogenetic uncertainty:
sensi_plot(tree)
</code></pre>


</div>