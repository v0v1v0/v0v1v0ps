<div class="container">

<table style="width: 100%;"><tr>
<td>sm.monotonicity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A test of monotonicity in a regression curve.
</h2>

<h3>Description</h3>

<p>This function uses the idea of a ‘critical bandwidth’ to assess the 
evidence that a regression curve is non-monotonic.  A hypothesis
test is carried out by bootstrap methods and the empirical p-value
is reported.  Response variables on a continuous scale or with binomial
variation can be handled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sm.monotonicity(x, y, N = rep(1, length(y)), h, type = "continuous", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector of covariate values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of responses observed at the covariate locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>a vector of sample sizes at the covariate locations, when the
responses have a binomial error structure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>a smoothing parameter to be used in the construction of the nonparametric
regression estimates.  A normal kernel
function is used and <code>h</code> is its standard deviation(s).  However, if
this argument is omitted <code>h</code> will be selected automatically, using
the <code>method</code> which is currently active.  See <code>sm.options</code> and 
<code>h.select</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>an indicator of whether the response variable is on a <code>"continuous"</code>
or <code>"binomial"</code> scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code>
function, through a mechanism which limits their effect only to this
call of the function; some of those relevant for this function are 
<code>add</code>,
<code>ngrid</code>, 
<code>xlab</code>, 
<code>ylab</code>, 
<code>xlim</code>, 
<code>ylim</code>, 
<code>lty</code>,
<code>col</code>;
see the documentation of  <code>sm.options</code> for their
description.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first reference below describes the statistical methods used in the function.
The test is an extension of one by Silverman (1986) for density estimation.
</p>


<h3>Value</h3>

<p>a list containing the following items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p-value for the test of the null hypothesis that the
true curve is monotonic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hcrit</code></td>
<td>
<p>the ‘critical’ smoothing parameter.  This is the smallest
value which, when applied to the observed data, makes the 
curve monotonic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the smoothing parameter used for double-smoothing (see the
reference below).</p>
</td>
</tr>
</table>
<h3>Side Effects</h3>

<p>a plot of the curves generated by the bootstrap procedure is produced, 
unless the option <code>display="none"</code> is set.  Those curves which
are non-monotonic, and therefore contribute to the empirical p-value,
are drawn in red.
</p>


<h3>References</h3>

<p>Bowman, A.W., Jones, M.C. and Gijbels, I. (1998).
Testing monotonicity of regression.
<em>J.Comp.Graph.Stat.</em> 7, 489-500.
</p>


<h3>See Also</h3>

<p><code>sm.regression</code>, <code>sm.options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	## Not run: 
#     Radiocarbon dating data

with(radioc, {
   ind     &lt;- (Cal.age&gt;5000 &amp; Cal.age&lt;6000)
   cal.age &lt;- Cal.age[ind]
   rc.age  &lt;- Rc.age[ind]
   sm.monotonicity(cal.age, rc.age, method = "aicc", nboot = 200)
})

#     Hosmer &amp; Lemeshow birth data

with(birth, {
   sm.monotonicity(Lwt[Smoke == "N"], Low[Smoke == "N"],
          type = "binomial")
})

## End(Not run)</code></pre>


</div>