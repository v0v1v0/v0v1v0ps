<div class="container">

<table style="width: 100%;"><tr>
<td>plotChangeMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot maps comparing corrected/raw expression</h2>

<h3>Description</h3>

<p>Given some reduced dimensional representation of the data (such as UMAP or tSNE) that has been calculated however you would like, this provides a way to visualise how the expression of a geneSet changes after soup correction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotChangeMap(
  sc,
  cleanedMatrix,
  geneSet,
  DR,
  dataType = c("soupFrac", "binary", "counts"),
  logData = FALSE,
  pointSize = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>SoupChannel object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cleanedMatrix</code></td>
<td>
<p>A cleaned matrix to compare against the raw one.  Usually the output of <code>adjustCounts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneSet</code></td>
<td>
<p>A vector with the names of the genes to aggregate and plot evidence for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DR</code></td>
<td>
<p>A data.frame, with rows named by unique cell IDs (i.e., &lt;ChannelName&gt;_&lt;Barcode&gt;) the first two columns of which give the coordinates of each cell in some reduced dimension representation of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataType</code></td>
<td>
<p>How should data be represented.  Binary sets each cell to expressed or not, counts converts everything to counts, soupFrac plots the fraction of the observed counts that are identified as contamination (i.e., (old-new)/old) for each cell and is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logData</code></td>
<td>
<p>Should we log the thing we plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointSize</code></td>
<td>
<p>Size of points</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 containing the plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">out = adjustCounts(scToy)
gg = plotChangeMap(scToy,out,'S100A9')
</code></pre>


</div>