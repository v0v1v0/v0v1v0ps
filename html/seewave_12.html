<div class="container">

<table style="width: 100%;"><tr>
<td>autoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Short-term autocorrelation of a time wave</h2>

<h3>Description</h3>

<p>This function returns the fundamental frequency of a harmonic time wave. This is
achieved by computing a correlation of the signal with itself
after a time delay. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">autoc(wave, f, channel = 1, wl = 512, fmin, fmax, threshold = NULL, plot = TRUE,
xlab = "Time (s)", ylab = "Frequency (kHz)", ylim = c(0, f/2000), pb =
FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis (even number of points,
by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmin</code></td>
<td>
<p>the minimum frequency to detect (in Hz). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>the maximum frequency to detect (in Hz). See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>amplitude threshold for signal detection (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the fundamental frequency 
against time (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the range of y values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>if <code>TRUE</code> returns a text progress bar in the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'fmin' and 'fmax' can help by reducing computing time but can
also produce less accurate results.</p>


<h3>Value</h3>

<p>When <code>plot</code> is <code>FALSE</code>, <code>autoc</code> returns a two-column matrix, the first column corresponding to time in seconds (<em>x</em>-axis) and the second column corresponding to 
to fundamental frequency in kHz (<em>y</em>-axis).<br>
NA corresponds to pause sections in <code>wave</code> (see <code>threshold</code>). 
</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a> and 
Thierry Aubin <a href="mailto:thierry.aubin@u-psud.fr">thierry.aubin@u-psud.fr</a></p>


<h3>References</h3>

<p>Hopp, S. L., Owren, M. J. and Evans, C. S. (Eds) 1998. <em>Animal acoustic 
communication</em>. Springer, Berlin, Heidelberg.</p>


<h3>See Also</h3>

<p><code>ceps</code>, <code>acf</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(sheep)
# fundamental frequency of a sheep
res &lt;- autoc(sheep, f=8000, threshold=5, fmin=100, fmax=700, plot=FALSE)
spectro(sheep, f=8000, ovlp=75, scale=FALSE)
points(res, pch=20)
legend(0.5, 3.6, "Fundamental frequency", pch=20, bty=0, cex=0.7)
</code></pre>


</div>