<div class="container">

<table style="width: 100%;"><tr>
<td>estima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of parameters of autologistic regression model for data on a grid</h2>

<h3>Description</h3>

<p>Estimation of parameters of autologistic regression model for data on a grid
</p>


<h3>Usage</h3>

<pre><code class="language-R">estima(data = 0, covariate1 = NULL, covariate2 = NULL,
  covariate3 = NULL, norm = "euclidean", vxpresent = 3,
  vypresent = 3, vxpast = 3, vypast = 3, dx = 1, dy = 1,
  swpresent = TRUE, swpast = TRUE, graph = FALSE, pastcov = FALSE,
  buildpres = NULL, buildpast = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset with the coordinates in the two first columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate1</code></td>
<td>
<p>spatio-temporal covariate. The covariate dataframe must have <code>dim(data)[1] = dim(covariate)[1]</code> (same numbers of individuals) and <code>dim(data)[1] = dim(covariate)[1] + 3</code> as the covaiate dataset must not contain coordinates, but must match the coodinates of the dataset; and <code>T-1</code> years (<code>T</code> is the number of years in the dataset <code>"data"</code>) as the model needs the first year to initialize. See <code>"User guides, package vignettes and other documentation"</code> the <code>"estima"</code> vignette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate2</code></td>
<td>
<p>spatio-temporal covariate. The covariate dataframe must have <code>dim(data)[1] = dim(covariate)[1]</code> (same numbers of individuals) and <code>dim(data)[1] = dim(covariate)[1] + 3</code> as the covaiate dataset must not contain coordinates, but must match the coodinates of the dataset; and <code>T-1</code> years (<code>T</code> is the number of years in the dataset <code>"data"</code>) as the model needs the first year to initialize. See <code>"User guides, package vignettes and other documentation"</code> the <code>"estima"</code> vignette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate3</code></td>
<td>
<p>spatio-temporal covariate. The covariate dataframe must have <code>dim(data)[1] = dim(covariate)[1]</code> (same numbers of individuals) and <code>dim(data)[1] = dim(covariate)[1] + 3</code> as the covaiate dataset must not contain coordinates, but must match the coodinates of the dataset; and <code>T-1</code> years (<code>T</code> is the number of years in the dataset <code>"data"</code>) as the model needs the first year to initialize. See <code>"User guides, package vignettes and other documentation"</code> the <code>"estima"</code> vignette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p><code>"euclidean"</code>, <code>"inf"</code>, <code>"abs"</code>, <code>"lin"</code>. <code>norm = "euclidean"</code> by default. See vignette <code>Build</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vxpresent</code></td>
<td>
<p>positive real. Parameter of the ellipse for the tested neighborhood on x-axes in norm <code>"norm"</code> if <code>swpresent = FALSE</code>. If <code>swpresent = TRUE</code>, <code>vxpresent</code> will be the upper bound of the tested neighborhoods on x-axes in norm <code>norm</code>. See <code>swpresent</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vypresent</code></td>
<td>
<p>positive real. Parameter of the ellipse for the tested neighborhood on y-axes in norm <code>"norm"</code> if <code>swpresent = FALSE</code>. If <code>swpresent = TRUE</code>, <code>vypresent</code> will be the upper bound of the tested neighborhoods on y-axes in norm <code>norm</code>. See <code>swpresent</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vxpast</code></td>
<td>
<p>positive real. Parameter of the ellipse for the tested neighborhood on x-axes in norm <code>"norm"</code> if <code>swpast = FALSE</code>. If <code>swpast = TRUE</code>, <code>vxpast</code> will be the upper bound of the tested neighborhoods on x-axes in norm <code>norm</code>. See <code>swpast</code>. Only use if <code>pastcov = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vypast</code></td>
<td>
<p>positive real. Parameter of the ellipse for the tested neighborhood on y-axes in norm <code>"norm"</code> if <code>swpast = FALSE</code>. If <code>swpast = TRUE</code>, <code>vypast</code> will be the upper bound of the tested neighborhoods on y-axes in norm <code>norm</code>. See <code>swpast</code>. Only use if <code>pastcov = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>
<p>positive real : distance between sites on x-axis. <code>dx = 1</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p>positive real : distance between sites on y-axis. <code>dy = 1</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>swpresent</code></td>
<td>
<p>if <code>TRUE</code> the programm will test all possible neighborhood for the spatial autocorrelation (coefficient <code>rho1</code>) with parameters <code>vxmaxpresent</code>, <code>vymaxpresent</code>, <code>dx</code> and <code>dy</code>, otherwise the programm will test the neighborhood with the parameters <code>vxpresent</code> and <code>vypresent</code>. <code>swpresent = TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>swpast</code></td>
<td>
<p>if <code>TRUE</code> the programm will test all possible neighborhood for the autoregression on on the sum of the <code>Zi,t-1</code> (coefficient Betapast) with parameters <code>vxmaxpast</code>, <code>vymaxpast</code>, <code>dx</code> and <code>dy</code>, otherwise the programm will test the neighborhood with the parameters <code>vxpast</code> and <code>vypast</code>. <code>swpast = TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>if <code>graph = TRUE</code>, the program will also return the plot of the dataset for the last time (and the year before if <code>estima = 3</code>). <code>graph = FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pastcov</code></td>
<td>
<p>boolen. If <code>pastcov = TRUE</code>, the function will use the past neighborhood as a covariate. See <code>"User guides, package vignettes and other documentation"</code> the <code>"estima"</code> vignette. <code>pastcov = FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buildpres</code></td>
<td>
<p>boolean which allow the use of a custom neighborhood matrix. <code>buildpres = NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buildpast</code></td>
<td>
<p>boolean which allow the use of a custom neighborhood matrix. <code>buildpast = NULL</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>"User guides, package vignettes and other documentation"</code> the <code>"estima"</code> vignette.
</p>


<h3>Value</h3>

<p>list : estimate parameters using the pseudo-likelihood.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data &lt;- plantillness
v &lt;- which(data$NRang &lt;= 10)
data &lt;- data[v,]
v &lt;- which(data$NCep &lt;= 10)
data&lt;-data[v,]
result &lt;- estima(data = data)




#Example in "lin" norm, with a fixed neighborhood :

result &lt;- estima(data = plantillness, norm = "lin",swpresent = FALSE,vxpresent = 3, vypresent = 4)



#Example with a spatial covariate (adapted to the dimension of the dataset) :

cov &lt;- covplant[,1]
for (i in (1:(dim(plantillness)[2] - 4))){
 cov &lt;- cbind(cov,covplant[,1])
}
result &lt;- estima(data = plantillness,covariate1 = cov)



#Example with the past neighborhood as covariate:

result &lt;- estima(data = plantillness,pastcov = TRUE)



#Exemple with a custom neighborhood matrix

custompres &lt;- build(data = plantillness)
custompast &lt;- build(data = plantillness, vx = 5,vy = 6)
result &lt;- estima(data = plantillness,pastcov = TRUE,buildpres = custompres,buildpast = custompast)



</code></pre>


</div>