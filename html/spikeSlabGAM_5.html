<div class="container">

<table style="width: 100%;"><tr>
<td>mrf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate design for a 2-D Gaussian Markov Random Field</h2>

<h3>Description</h3>

<p>The returned design is (a low-rank approximation to) the matrix square root
of the implied covariance of the centered MRF. The function stops if
'islands', i.e. regions without any neighbors are found. Regions without
observations have to be removed from the neighborhood matrix and there is
currently no <code>predict</code>-functionality for regions without observations in
the original data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrf(x, N, decomposition = c("ortho", "MM"), tol = 1e-10, rankZ = 0.995)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a factor: which observation belongs to which region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the neighborhood (adjacency) matrix: a symmetric matrix with one
column/row for every level of <code>x</code>, defining the neighborhood structure
(either 0-1 or with positive weights, e.g. based on shared boundary length
or centroid distances). Has to have rownames and column names that
correspond to the levels of <code>x</code>, the function checks whether the
rows/columns are in the same order as the levels of <code>x</code>. Entries on
the diagonal are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomposition</code></td>
<td>
<p>use a (truncated) spectral decomposition of the implied
prior covariance of <code class="reqn">f(x)</code> for a low rank representation with
orthogonal  basis functions and i.i.d. coefficients (<code>"ortho"</code>), or
use the mixed model reparameterization for non-orthogonal basis functions
and i.i.d. coefficients (<code>"MM"</code>). Defaults to <code>"MM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>count singular/eigenvalues smaller than this as zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a transformed design matrix for the Markov Random Field
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Fahrmeir, L., Lang, S. (2001) Bayesian inference for generalized
additive mixed models based on Markov random field priors. <em>Applied
Statistics</em>, <b>50</b>(2):201â€“220.
</p>


</div>