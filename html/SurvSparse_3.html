<div class="container">

<table style="width: 100%;"><tr>
<td>tv.co.Cox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiplicative hazards model with sparse longitudinal covariates</h2>

<h3>Description</h3>

<p>Regression analysis of multiplicative hazards model with sparse longitudinal covariates. The kernel weighting approach is employed to impute the missing value and localize the estimating equation. A wild bootstrap-based simultaneous confidence band for the nonparametric function is also provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tv.co.Cox(data, n, l, times, bd, scb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of class tibble. The structure of the tibble must be: tibble(id = id, X = failure time, covariates = observation for covariates, obs_times = observation times, delta = censoring indicator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An object of class integer. The sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>An object of class vector. The selection vector. For example, for the p dimensional regression coefficient function, if we want to construct simultaneous confidence band for the first regression coefficient function, we can take l=c(1,0,...,0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>An object of class vector. The interest time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bd</code></td>
<td>
<p>An object of class vector. If use auto bandwidth selection, the structure of the vector must be: bd=c(the maximum bandwidth, the minimum bandwidth, the number of bandwidth divided). If use fixed bandwidth, bd is the chosen bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scb</code></td>
<td>
<p>An object of class vector. If need to construct the simultaneous confidence band, the structure of the vector must be: c(desirable confidence level, repeat times). Otherwise, scb=0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The estimation for the corresponding parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>The estimation for the standard error of the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scb</code></td>
<td>
<p>The quantile used to construct simultaneous confidence band.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Sun, Z. and Cao, H. (2023)  &lt;arXiv:2310.15877&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(gaussquad)
library(MASS)
library(nleqslv)
n=500
beta&lt;-function(t){
  0.5*(t+0.5)^2
}
lqrule64 &lt;- legendre.quadrature.rules(64)[[64]]
simdata &lt;- function(  beta ) {
cen=1
nstep=20
Sigmat_z &lt;- exp(-abs(outer(1:nstep, 1:nstep, "-")) / nstep)
z  &lt;-c(mvrnorm(  1, rep(0,20), Sigmat_z  ))
left_time_points &lt;- (0:(nstep - 1)) / nstep
z_fun &lt;- stepfun(left_time_points, c(0,z  ))
h_fun &lt;- function(x) { beta(x) * z_fun(x)  }
lam_fun &lt;- function(tt) 2 * exp(h_fun(tt))
u &lt;- runif(1)
fail_time &lt;- nleqslv(0, function(ttt)
legendre.quadrature(lam_fun, lower = 0,upper = ttt, lqrule64) + log(u))$x
X &lt;- min(fail_time, cen)
obs=rpois(1,  5)+1
tt= sort(runif(obs, min = 0, max = 1))
obs_times &lt;- tt[which(tt&lt;=cen)]
if (length(obs_times) == 0)
 obs_times &lt;- cen
 covariates_obscov &lt;-z_fun(obs_times)
 return( tibble(X = X,delta = fail_time &lt; cen,
  covariates = covariates_obscov,obs_times = obs_times   )  ) }


data &lt;- replicate(  n, simdata( beta ), simplify = FALSE ) %&gt;% bind_rows(.id = "id")
tv.co.Cox(data,n,l,0.2,bd=c(n^(-0.4),n^(-0.4)),scb=0)
</code></pre>


</div>