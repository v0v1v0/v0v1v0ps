<div class="container">

<table style="width: 100%;"><tr>
<td>spdep_distance_swm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>constructs spatial weight matrices based on distance</h2>

<h3>Description</h3>

<p>Constructs spatial weight matrices based on distance via <code>spdep</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spdep_distance_swm(
  sfj,
  kernel = NULL,
  k = NULL,
  bandwidth = NULL,
  power = 1,
  style = "W",
  zero.policy = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sfj</code></td>
<td>
<p>An <code>sf</code> object or can be converted to <code>sf</code> by <code>sf::st_as_sf()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>(optional) The kernel function, can be one of <code>uniform</code>,
<code>triangular</code>,<code>quadratic</code>(<code>epanechnikov</code>),<code>quartic</code> and <code>gaussian</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(optional) The number of nearest neighbours. Default is <code>NULL</code>. Only useful
when <code>kernel</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>(optional) The bandwidth, default is <code>NULL</code>. When the spatial reference
of sf object is the geographical coordinate system, the unit of <code>bandwidth</code> is <code>km</code>. The
unit used in the projection coordinate system are consistent with those used in the sf
object coordinate system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>(optional) Default is <code>1</code>. Useful when <code>kernel</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>(optional) <code>style</code> can take values <code>W</code>, <code>B</code>, <code>C</code>, and <code>S</code>. More to see
<code>spdep::nb2mat()</code>. Default is <code>W</code>. For spatial weights based on distance functions,
a style of <code>B</code> means using the original value of the calculated distance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>(optional)  if <code>FALSE</code> stop with error for any empty neighbour sets,
if <code>TRUE</code> permit the weights list to be formed with zero-length weights vectors. Default
is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>five different kernel weight functions:
</p>

<ul>
<li>
<p> uniform:
<code class="reqn">K_{(z)} = 1/2</code>,for <code class="reqn">\lvert z \rvert &lt; 1</code>
</p>
</li>
<li>
<p> triangular
<code class="reqn">K_{(z)} = 1 - \lvert z \rvert</code>,for <code class="reqn">\lvert z \rvert &lt; 1</code>
</p>
</li>
<li>
<p> quadratic (epanechnikov)
<code class="reqn">K_{(z)} = \frac{3}{4} \left( 1 - z^2 \right)</code>,for <code class="reqn">\lvert z \rvert &lt; 1</code>
</p>
</li>
<li>
<p> quartic
<code class="reqn">K_{(z)} = \frac{15}{16} {\left( 1 - z^2 \right)}^2</code>,for <code class="reqn">\lvert z \rvert &lt; 1</code>
</p>
</li>
<li>
<p> gaussian
<code class="reqn">K_{(z)} = \frac{1}{\sqrt{2 \pi}} e^{- \frac{z^2}{2}}</code>
</p>
</li>
</ul>
<p>For the equation above, <code class="reqn">z = d_{ij} / h_i</code>
where <code class="reqn">h_i</code> is the bandwidth
</p>


<h3>Value</h3>

<p>A matrix
</p>


<h3>Note</h3>

<p>When <code>kernel</code> is setting, using distance weight based on kernel function, Otherwise
the inverse distance weight will be used.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sf)
pts = read_sf(system.file('extdata/pts.gpkg',package = 'sdsfun'))

wt1 = spdep_distance_swm(pts, style = 'B')
wt2 = spdep_distance_swm(pts, kernel = 'gaussian')
wt3 = spdep_distance_swm(pts, k = 3, kernel = 'gaussian')
wt4 = spdep_distance_swm(pts, k = 3, kernel = 'gaussian', bandwidth = 10000)

</code></pre>


</div>