<div class="container">

<table style="width: 100%;"><tr>
<td>sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Field Simulation</h2>

<h3>Description</h3>

<p>The function simulates a random field. The simulation methods available are based on Indicator Kriging techniques (IK and CK), Fixed and Random Path (PATH) and Multinomial Categorical Simulation (MCS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim(x, data, coords, grid, method = "ik", ..., entropy = FALSE)</code></pre>


<h3>Arguments</h3>























<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>multi_tpfit</code>, typically with the output of the function <code>multi_tpfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an <code class="reqn">m \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates in the simulation grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character object specifying the method to simulate the random field. Possible choises are <code>"ik"</code> (by default) for the indicator Kriging, <code>"ck"</code> for the indicator coKriging, <code>"path"</code> for the fixed and random path and <code>"mcs"</code> for the multinomial categorical simulation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to pass to the functions <code>sim_ik</code>, <code>sim_ck</code>, <code>sim_path</code> or <code>sim_mcs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entropy</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, the prediction uncertainties are computed through the entropy (and standardized entropy). The default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods implemented compute the approximation of posterior probabilities
</p>
<p style="text-align: center;"><code class="reqn">\Pr\left(Z(\mathbf{s}_0) = z_k \left\vert \bigcap_{i = 1}^n Z(\mathbf{s}_i) = z(\mathbf{s}_i)\right.\right).</code>
</p>

<p><code class="reqn">\hspace{0cm}</code>
</p>
<p>Once the probabilities are calculated for all the points in the simulation grid, the predictions (based on most probable category) and simulations are returned.
</p>


<h3>Value</h3>

<p>A data frame containing the simulation grid, the simulated random field, predicted values and the approximated probabilities is returned. Two extra columns respectively denoting the entropy and standardized entorpy are bindend to the data frame when argument <code>entropy = TRUE</code>.</p>


<h3>References</h3>

<p>Allard, D., D'Or, D., Froidevaux, R. (2011) An efficient maximum entropy approach for categorical variable prediction. <em>European Journal of Soil Science</em>, <b>62</b>(3), 381-393.
</p>
<p>Carle, S. F., Fogg, G. E. (1996) Transition Probability-Based Indicator Geostatistics. <em>Mathematical Geosciences</em>, <b>28</b>(4), 453-476.
</p>
<p>Carle, S. F. (1999) T-PROGS: Transition Probability Geostatistical Software. University of California, Davis.
</p>
<p>Li, W. (2007) A Fixed-Path Markov Chain Algorithm for Conditional Simulation of Discrete Spatial Variables. <em>Mathematical Geology</em>, <b>39</b>(2), 159-176.
</p>
<p>Li, W. (2007) Markov Chain Random Fields for Estimation of Categorical Variables. <em>Mathematical Geology</em>, <b>39</b>(June), 321-335.
</p>
<p>Pickard, D. K. (1980) Unilateral Markov Fields. <em>Advances in Applied Probability</em>, <b>12</b>(3), 655-671.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.
</p>

<p>Weise, T. (2009) <em>Global Optimization Algorithms - Theory and Application</em>. <a href="https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application">https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application</a>.</p>


<h3>See Also</h3>

<p><code>sim_ik</code>, <code>sim_ck</code>, <code>sim_path</code>, <code>sim_mcs</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Model parameters estimation for the
# multinomial categorical simulation
x &lt;- multi_tpfit(ACM$MAT5, ACM[, 1:3])

# Generate the simulation grid
mygrid &lt;- list()
mygrid$X &lt;- seq(min(ACM$X), max(ACM$X), length = 20)
mygrid$Y &lt;- seq(min(ACM$Y), max(ACM$Y), length = 20)
mygrid$Z &lt;- -40 * 0:9 - 1
mygrid &lt;- as.matrix(expand.grid(mygrid$X, mygrid$Y, mygrid$Z))

# Simulate the random field through
# Simple Indicator Kriging algorithm and
mySim &lt;- sim(x, ACM$MAT5, ACM[, 1:3], mygrid)
</code></pre>


</div>