<div class="container">

<table style="width: 100%;"><tr>
<td>centroids</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group Centroids and (Pooled) Variances</h2>

<h3>Description</h3>

<p><code>centroids</code> computes group centroids, the pooled mean 
and pooled variance, and optionally the group specific variances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">centroids(x, L, lambda.var, lambda.freqs, var.groups=FALSE, 
  centered.data=FALSE, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix  containing the  data set. Note that 
the rows are sample observations and the columns
are variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>A factor with the group labels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.var</code></td>
<td>
<p>Shrinkage intensity for the variances. If not specified it is 
estimated from the data, see details below. <code>lambda.var=0</code> implies no shrinkage
and <code>lambda.var=1</code> complete shrinkage. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.freqs</code></td>
<td>
<p>Shrinkage intensity for the frequencies. If not specified it is 
estimated from the data. <code>lambda.freqs=0</code> implies no shrinkage (i.e. empirical frequencies)
and <code>lambda.freqs=1</code> complete shrinkage (i.e. uniform frequencies). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.groups</code></td>
<td>
<p>Estimate group-specific variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered.data</code></td>
<td>
<p>Return column-centered data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Provide some messages while computing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As estimator of the variance we employ 
<code>var.shrink</code> as described in Opgen-Rhein and Strimmer (2007).
For the estimates of frequencies we rely on 
<code>freqs.shrink</code> as described in Hausser and Strimmer (2009).
Note that the pooled mean is computed using the estimated frequencies.
</p>


<h3>Value</h3>

<p><code>centroids</code> returns a list
with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>a vector containing the samples sizes in each group,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>a vector containing the estimated frequency in each group,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>the group means and the pooled mean,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variances</code></td>
<td>
<p>the group-specific and the pooled variances, and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered.data</code></td>
<td>
<p>a matrix containing the centered data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>See Also</h3>

<p><code>var.shrink</code>, 
<code>powcor.shrink</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load sda library
library("sda")

## prepare data set
data(iris) # good old iris data
X = as.matrix(iris[,1:4])
Y = iris[,5]

## estimate centroids and empirical pooled variances
centroids(X, Y, lambda.var=0)
          
## also compute group-specific variances
centroids(X, Y, var.groups=TRUE, lambda.var=0)
   
## use shrinkage estimator for the variances
centroids(X, Y, var.groups=TRUE)

## return centered data
xc = centroids(X, Y, centered.data=TRUE)$centered.data
apply(xc, 2, mean)

## useful, e.g., to compute the inverse pooled correlation matrix
powcor.shrink(xc, alpha=-1)
</code></pre>


</div>