<div class="container">

<table style="width: 100%;"><tr>
<td>dls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fisher's Log-series distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Fisher's
log-series probability distribution with parameter <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dls( x, N , alpha, log=FALSE)
pls(q, N, alpha, lower.tail=TRUE, log.p=FALSE)
qls(p, N, alpha, lower.tail = TRUE, log.p = FALSE)
rls(n, N, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of (integer, x&gt;0) quantiles. Usually a vector of abundances of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of (integer, x&gt;0) quantiles. Usually a vector of
abundances of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>sample size. Usually the total number of individuals in the sample (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>real positive; Fisher's alpha parameter (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Fisher log-series is a limiting case of the Negative Binomial where
the dispersion parameter of the negative binomial tends to zero. It
was originally proposed by Fisher (1943) to relate the expected number
of species in a sample from a biological community to the sample size as:
</p>

<p>Where alpha is the single parameter of the log-series distribution,
often used as a diversity index. From this relation follows that the
expected number of species with x individuals in the sample is
</p>
<p style="text-align: center;"><code class="reqn">S(x) = \alpha \, \frac{X^x}{x}</code>
</p>

<p>Where X is a function of alpha and N, that tends to one as the sample
size N increases:
</p>
<p style="text-align: center;"><code class="reqn">X = \frac{N}{\alpha + N}</code>
</p>

<p>The density function used here is derived by Alonso et al. (2008,
supplementary material). In ecology, this density distribution gives
the probability that a species has
an abundance of x individuals in a random sample of size N of the
community. In the community, the species abundances are independent
random variables that follow a log-series distribution. Thus, a random
sample of a log-series is also a log-series distribution.
</p>
<p>Therefore, a log-series distribution is a model for species
abundances distributions (SAD) under the assumptions that (a) species
abundances in the community are independent identically distributed
log-series variables, (b) sampling is a Poisson process, (c)
sampling is done with replacement, or the fraction
sampled is small enough to approximate a sample with replacement.
</p>


<h3>Value</h3>

<p><code>dls</code> gives the (log) of the density, <code>pls</code> gives the (log)
distribution function, <code>qls</code> gives the (log) the quantile function.
</p>
<p>Invalid values for parameter <code>alpha</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Alonso, D. and Ostling, A., and Etienne, R. S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. Ecology Letters, 11: 93-105.
</p>
<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. (1943) The Relation
between the number of species and the number of individuals in a
random sample of an animal population. The Journal of Animal Ecology,
12(1): 42–58.
</p>
<p>Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. Ecology Letters 10:1037–1045
</p>
<p>Pielou, E.C. 1977. Mathematical Ecology. New York: John Wiley
and Sons.
</p>


<h3>See Also</h3>

<p><code>dpois</code>, <code>dnbinom</code>, <code>dpoig</code>.
For maximum likelihood estimation in the context of species
abundance distributions see <code>fitls</code>, <code>fisherfit</code> in <span class="pkg">vegan</span> package
and <code>fisher</code> in <span class="pkg">untb</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- 1:100
PDF &lt;- dls(x=x, N=100, alpha=5)
CDF &lt;- pls(q=x, N=100, alpha=5)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Log-Series distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Log-Series distribution, PDF")
par(mfrow=c(1,1))

## Fisher log-series is a discrete PDF, hence:
all.equal(pls(10,N=1000,alpha=50), sum(dls(1:10,N=1000,alpha=50))) # should be TRUE

## qls is the inverse of pls
all.equal(qls(CDF,N=100,alpha=5), x) # should be TRUE
</code></pre>


</div>