<div class="container">

<table style="width: 100%;"><tr>
<td>normCast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forecasting Function for ARMA Models under Normally Distributed Innovations</h2>

<h3>Description</h3>

<p>Point forecasts and the respective forecasting intervals for autoregressive-
moving-average (ARMA) models can be calculated, the latter under the
assumption of normally distributed innovations, by means of this function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normCast(
  X,
  p = NULL,
  q = NULL,
  include.mean = FALSE,
  h = 1,
  alpha = 0.95,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric vector that contains the time series that is assumed to
follow an ARMA model ordered from past to present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>an integer value <code class="reqn">&gt;= 0</code> that defines the AR order <code class="reqn">p</code> of the
underlying ARMA(<code class="reqn">p,q</code>) model within <code>X</code>; is set to <code>NULL</code> by
default; if no value is passed to <code>p</code> but one is passed to <code>q</code>,
<code>p</code> is set to <code>0</code>; if both <code>p</code> and <code>q</code> are <code>NULL</code>,
optimal orders following the BIC for <code class="reqn">0 \leq p,q \leq 5</code>
are chosen; is set to <code>NULL</code> by default; decimal numbers will be rounded
off to integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an integer value <code class="reqn">&gt;= 0</code> that defines the MA order <code class="reqn">q</code> of the
underlying ARMA(<code class="reqn">p,q</code>) model within <code>X</code>; is set to <code>NULL</code> by
default; if no value is passed to <code>q</code> but one is passed to <code>p</code>,
<code>q</code> is set to <code>0</code>; if both <code>p</code> and <code>q</code> are <code>NULL</code>,
optimal orders following the BIC for <code class="reqn">0 \leq p,q \leq 5</code>
are chosen; is set to <code>NULL</code> by default; decimal numbers will be rounded
off to integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.mean</code></td>
<td>
<p>a logical value; if set to <code>TRUE</code>, the mean of the
series is also estimated; if set to <code>FALSE</code>,
<code class="reqn">E(X_t) = 0</code> is assumed; is set to <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>an integer that represents the forecasting horizon; if <code class="reqn">n</code> is
the number of observations, point forecasts and forecasting intervals will be
obtained for the time points <code class="reqn">n + 1</code> to <code class="reqn">n + h</code>; is set to <code>1</code>
by default; decimal numbers will be rounded off to integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector of length 1 with <code class="reqn">0 &lt;</code> <code>alpha</code>
<code class="reqn">&lt; 1</code>; the forecasting intervals will be obtained based on the confidence
level (<code class="reqn">100</code><code>alpha</code>)-percent; is set to <em>alpha = 0.95</em> by
default, i.e., a <code class="reqn">95</code>-percent confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value that controls the graphical output; for
<code>plot = TRUE</code>, the original series with the obtained point forecasts
as well as the forecasting intervals will be plotted; for the default
<code>plot = FALSE</code>, no plot will be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the standard plot function, e.g.,
<code>xlim</code>, <code>type</code>, ... ; arguments with respect to plotted graphs,
e.g., the argument <code>col</code>, only affect the original series <code>X</code>;
please note that in accordance with the argument <code>x</code> (lower case) of the
standard plot function, an additional numeric vector with time points can be
implemented via the argument <code>x</code> (lower case). <code>x</code> should be
valid for the sample observations only, i.e.
<code>length(x) == length(X)</code> should be <code>TRUE</code>, as future time
points will be calculated automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is part of the <code>smoots</code> package and was implemented under
version 1.1.0. For a given time series <code class="reqn">X_[t]</code>, <code class="reqn">t = 1, 2, ..., n</code>,
the point forecasts and the respective forecasting intervals will be
calculated.
It is assumed that the series follows an ARMA(<code class="reqn">p,q</code>) model
</p>
<p style="text-align: center;"><code class="reqn">X_t - \mu = \epsilon_t + \beta_1 (X_{t-1} - \mu) + ... + \beta_p
(X_{t-p} - \mu) + \alpha_1 \epsilon_{t-1} + ... + \alpha_{q}
\epsilon_{t-q},</code>
</p>

<p>where <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_i</code> are real
numbers (for <code class="reqn">i = 1, 2, .., p</code> and <code class="reqn">j = 1, 2, ..., q</code>) and
<code class="reqn">\epsilon_t</code> are i.i.d. (identically and independently
distributed) random variables with zero mean and constant variance.
<code class="reqn">\mu</code> is equal to <code class="reqn">E(X_t)</code>.
</p>
<p>The point forecasts and forecasting intervals for the future periods
<code class="reqn">n + 1, n + 2, ..., n + h</code> will be obtained. With respect to the point
forecasts <code class="reqn">\hat{X}_{n + k}</code>, where <code class="reqn">k = 1, 2, ..., h</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{X}_{n + k} = \hat{\mu} + \sum_{i = 1}^{p} \hat{\beta}_{i}
(X_{n + k - i} - \hat{\mu}) + \sum_{j = 1}^{q} \hat{\alpha}_{j}
\hat{\epsilon}_{n + k - j}</code>
</p>

<p>with <code class="reqn">X_{n+k-i} = \hat{X}_{n+k-i}</code> for
<code class="reqn">n+k-i &gt; n</code> and
<code class="reqn">\hat{\epsilon}_{n+k-j} = E(\epsilon_t) = 0</code> for <code class="reqn">n+k-j &gt; n</code> will be applied.
</p>
<p>The forecasting intervals on the other hand are obtained under the assumption
of normally distributed innovations. Let <code class="reqn">q(c)</code> be the <code class="reqn">100c</code>-percent
quantile of the standard normal distribution. The <code class="reqn">100a</code>-percent
forecasting interval at a point <code class="reqn">n + k</code>, where <code class="reqn">k = 1, 2, ..., h</code>,
is given by
</p>
<p style="text-align: center;"><code class="reqn">[\hat{X}_{n+k} - q(a_r)s_k, \hat{X}_{n+k} + q(a_r)s_k]</code>
</p>

<p>with <code class="reqn">s_k</code> being the standard deviation of the forecasting error
at the time point <code class="reqn">n + k</code> and with
<code class="reqn">a_r = 1 - (1 - a)/2</code>. For ARMA models with normal
innovations, the variance of the forecasting error can be derived from the
MA(<code class="reqn">\infty</code>) representation of  the model. It is
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\epsilon}^{2} \sum_{i=0}^{k - 1} d_{i}^{2},</code>
</p>

<p>where <code class="reqn">d_i</code> are the coefficients of the MA(<code class="reqn">\infty</code>)
representation and <code class="reqn">\sigma_{\epsilon}^{2}</code> is the
innovation variance.
</p>
<p>The function <code>normCast</code> allows for different adjustments to
the forecasting progress. At first, a vector with the values of the observed
time series ordered from past to present has to be passed to the argument
<code>X</code>. Orders <code class="reqn">p</code> and <code class="reqn">q</code> of the underlying ARMA process can be
defined via the arguments <code>p</code> and <code>q</code>. If only one of these orders
is inserted by the user, the other order is automatically set to <code>0</code>. If
none of these arguments are defined, the function will choose orders based on
the Bayesian Information Criterion (BIC) for <code class="reqn">0 \leq p,q \leq 5</code>. Via the logical argument <code>include.mean</code> the user can decide,
whether to consider the mean of the series within the estimation process.
Furthermore, the argument <code>h</code> allows for the definition of the maximum
future time point <code class="reqn">n + h</code>. Point forecasts and forecasting intervals will
be returned for the time points <code class="reqn">n + 1</code> to <code class="reqn">n + h</code>. Another argument
is <code>alpha</code>, which is the equivalent of the confidence level considered
within the calculation of the forecasting intervals, i.e., the quantiles
<code class="reqn">(1 -</code> <code>alpha</code><code class="reqn">)/2</code> and
<code class="reqn">1 - (1 -</code> <code>alpha</code><code class="reqn">)/2</code> of the
forecasting intervals will be obtained.
</p>
<p>For simplicity, the function also incorporates the possibility to directly
create a plot of the output, if the argument <code>plot</code> is set to
<code>TRUE</code>. By the additional and optional arguments <code>...</code>, further
arguments of the standard plot function can be implemented to shape the
returned plot.
</p>
<p>NOTE:
Within this function, the <code>arima</code> function of the
<code>stats</code> package with its method <code>"CSS-ML"</code> is used throughout
for the estimation of ARMA models.
</p>


<h3>Value</h3>

<p>The function returns a <code class="reqn">3</code> by <code class="reqn">h</code> matrix with its columns
representing the future time points and the point forecasts, the lower
bounds of the forecasting intervals and the upper bounds of the
forecasting intervals as the rows. If the argument <code>plot</code> is set to
<code>TRUE</code>, a plot of the forecasting results is created.
</p>


<h3>Author(s)</h3>


<ul><li>
<p> Dominik Schulz (Research Assistant) (Department of Economics, Paderborn
University), <br>
Package Creator and Maintainer
</p>
</li></ul>
<h3>References</h3>

<p>Feng, Y., Gries, T. and Fritz, M. (2020). Data-driven
local polynomial for the trend and its derivatives in economic time
series. Journal of Nonparametric Statistics, 32:2, 510-533.
</p>
<p>Feng, Y., Gries, T., Letmathe, S. and Schulz, D. (2019). The smoots package
in R for semiparametric modeling of trend stationary time series. Discussion
Paper. Paderborn University. Unpublished.
</p>
<p>Feng, Y., Gries, T., Fritz, M., Letmathe, S. and Schulz, D. (2020).
Diagnosing the trend and bootstrapping the forecasting intervals using a
semiparametric ARMA. Discussion Paper. Paderborn University. Unpublished.
</p>
<p>Fritz, M., Forstinger, S., Feng, Y., and Gries, T. (2020). Forecasting
economic growth processes for developing economies. Unpublished.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example 1: Simulated ARMA process ###

# Simulation of the underlying process
n &lt;- 2000
n.start = 1000
set.seed(21)
X &lt;- arima.sim(model = list(ar = c(1.2, -0.7), ma = 0.63), n = n,
 rand.gen = rnorm, n.start = n.start) + 7.7

# Application of normCast()
result &lt;- normCast(X = X, p = 2, q = 1, include.mean = TRUE, h = 5,
 plot = TRUE, xlim = c(1971, 2005), col = "deepskyblue4",
 type = "b", lty = 3, pch = 16, main = "Exemplary title")
result
</code></pre>


</div>