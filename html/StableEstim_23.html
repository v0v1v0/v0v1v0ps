<div class="container">

<table style="width: 100%;"><tr>
<td>IntegrateRandomVectorsProduct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Integral outer product of random vectors
</h2>

<h3>Description</h3>

<p>Computes the integral outer product of two possibly complex random
vectors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IntegrateRandomVectorsProduct(f_fct, X, g_fct, Y, s_min, s_max,
                              subdivisions = 50,
                              method = c("Uniform", "Simpson"),
                              randomIntegrationLaw = c("norm","unif"),
                              ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f_fct</code></td>
<td>

<p>function object with signature <code>f_fct=function(s,X)</code> and
returns a matrix <code class="reqn">ns \times nx</code> where nx=<code>length(X)</code>
and ns=<code>length(s)</code>; <code>s</code> is the points where the integrand
is evaluated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>random vector where the function <code>f_fct</code> is evaluated. See
Details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_fct</code></td>
<td>

<p>function object with signature <code>g_fct=function(s,Y)</code> and
returns a matrix <code class="reqn">ns \times ny</code> where ny=<code>length(Y)</code>
and ns=<code>length(s)</code>; <code>s</code> is the points where the integrand
is evaluated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>random vector where the function <code>g_fct</code> is evaluated. See
Details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_min,s_max</code></td>
<td>

<p>limits of integration. Should be finite.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>

<p>maximum number of subintervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>numerical integration rule, one of <code>"uniform"</code> (fast) or
<code>"Simpson"</code> (more accurate quadratic rule).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomIntegrationLaw</code></td>
<td>

<p>Random law pi(s) to be applied to the Random product vector, see
Details. Choices are <code>"unif"</code> (uniform) and <code>"norm"</code>
(normal distribution).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments to pass to random integration law. Mainly, the mean
(<code>mu</code>) and standard deviation (<code>sd</code>) of the normal law.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes the <code class="reqn">nx \times ny</code> matrix <code class="reqn">C =
  \int_{s_{min}}^{s_{max}} f_s(X) g_s(Y) \pi(s) ds</code>, such as the one
used in the objective function of the Cgmm method. This is essentially
an outer product with with multiplication replaced by integration.
</p>
<p>There is no function in R to compute vectorial integration and
computing <code class="reqn">C</code> element by element using <code>integrate</code> may
be very slow when <code>length(X)</code> (or <code>length(y)</code>) is large.
</p>
<p>The function allows complex vectors as its integrands.
</p>


<h3>Value</h3>

<p>an <code class="reqn">nx \times ny</code> matrix <code class="reqn">C</code> with elements:
</p>
<p style="text-align: center;"><code class="reqn">c_{ij} =
    \int_{s_{min}}^{s_{max}} f_s(X_i) g_s(Y_j) \pi(s) ds
    .
  </code>
</p>



<h3>Examples</h3>

<pre><code class="language-R">## Define the integrand
f_fct &lt;- function(s, x) {
    sapply(X = x, FUN = sampleComplexCFMoment, t = s, theta = theta)
}
f_bar_fct &lt;- function(s, x) Conj(f_fct(s, x))

## Function specific arguments
theta &lt;- c(1.5, 0.5, 1, 0)
set.seed(345)
X &lt;- rstable(3, 1.5, 0.5, 1, 0)
s_min &lt;- 0;
s_max &lt;- 2
numberIntegrationPoints &lt;- 10
randomIntegrationLaw &lt;- "norm"

Estim_Simpson &lt;-
    IntegrateRandomVectorsProduct(f_fct, X, f_bar_fct, X, s_min, s_max, 
                                  numberIntegrationPoints, 
                                  "Simpson", randomIntegrationLaw)
Estim_Simpson
</code></pre>


</div>