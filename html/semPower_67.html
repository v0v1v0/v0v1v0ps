<div class="container">

<table style="width: 100%;"><tr>
<td>semPower.powerLav</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>semPower.powerLav</h2>

<h3>Description</h3>

<p>Perform a power analysis given <code>lavaan</code> model strings defining the H0 and the H1 model based on either
a <code>lavaan</code> model string defining the population model or the population covariance matrix Sigma and the population means mu.
This requires the <code>lavaan</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semPower.powerLav(
  type,
  modelPop = NULL,
  modelH0 = NULL,
  modelH1 = NULL,
  fitH1model = TRUE,
  Sigma = NULL,
  mu = NULL,
  fittingFunction = "ML",
  simulatedPower = FALSE,
  lavOptions = NULL,
  lavOptionsH1 = lavOptions,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of power analysis, one of <code>'a-priori'</code>, <code>'post-hoc'</code>, <code>'compromise'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelPop</code></td>
<td>
<p><code>lavaan</code> model string defining the true model. Can be omitted when <code>Sigma</code> is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelH0</code></td>
<td>
<p><code>lavaan</code> model string defining the (incorrect) analysis model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelH1</code></td>
<td>
<p><code>lavaan</code> model string defining the comparison model. If omitted, the saturated model is the comparison model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitH1model</code></td>
<td>
<p>whether to fit the H1 model. If <code>FALSE</code>, the H1 model is assumed to show the same fit as the saturated model, and only the delta df are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>can be used instead of <code>modelPop</code>: population covariance matrix. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>can be used instead of <code>modelPop</code>: vector of population means. Can be omitted for no meanstructure. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittingFunction</code></td>
<td>
<p>one of <code>'ML'</code> (default), <code>'WLS'</code>, <code>'DWLS'</code>, <code>'ULS'</code>. Defines the fitting function used to obtain SigmaHat in analytical power analyses. This also implies a certain discrepancy function used to obtain Fmin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulatedPower</code></td>
<td>
<p>whether to perform a simulated (<code>TRUE</code>, rather than analytical, <code>FALSE</code>) power analysis. See <code>simulate()</code> for additional options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lavOptions</code></td>
<td>
<p>a list of additional options passed to <code>lavaan</code>, e. g., <code>list(estimator = 'mlm')</code> to request robust ML estimation. Mostly useful in conjunction with <code>simulatedPower</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lavOptionsH1</code></td>
<td>
<p>alternative options passed to <code>lavaan</code> that are only used for the H1 model. If <code>NULL</code>, identical to <code>lavOptions</code>. Probably only useful for multigroup models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>mandatory further parameters related to the specific type of power analysis requested, see <code>semPower.aPriori()</code>, <code>semPower.postHoc()</code>, and <code>semPower.compromise()</code>. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generic function to perform a power analysis based  on a true population covariance matrix Sigma
and a model implied covariance matrix SigmaHat (and optionally the associated mean vectors),
where SigmaHat (and muHat) is determined by fitting a respective H0 model using <code>lavaan</code>,
and Sigma (and mu) can also be provided through a corresponding <code>lavaan</code> model string.
</p>
<p>All <code>semPower</code> convenience functions internally call this function.
</p>
<p>Beyond the arguments explicitly contained in the function call, additional arguments
are required specifying the requested type of <strong>power analysis</strong>:
</p>

<ul>
<li> <p><code>alpha</code>: The alpha error probability. Required for <code>type = 'a-priori'</code> and <code>type = 'post-hoc'</code>.
</p>
</li>
<li>
<p> Either <code>beta</code> or <code>power</code>: The beta error probability and the statistical power (1 - beta), respectively. Only for <code>type = 'a-priori'</code>.
</p>
</li>
<li> <p><code>N</code>: The sample size. Always required for <code>type = 'post-hoc'</code> and <code>type = 'compromise'</code>. For <code>type = 'a-priori'</code> and multiple group analysis, <code>N</code> is a list of group weights.
</p>
</li>
<li> <p><code>abratio</code>: The ratio of alpha to beta. Only for <code>type = 'compromise'</code>.
</p>
</li>
</ul>
<p>If a <strong>simulated power analysis</strong> (<code>simulatedPower = TRUE</code>) is requested, optional arguments can be provided as a list to <code>simOptions</code>:
</p>

<ul>
<li> <p><code>nReplications</code>: The targeted number of simulation runs. Defaults to 250, but larger numbers greatly improve accuracy at the expense of increased computation time.
</p>
</li>
<li> <p><code>minConvergenceRate</code>:  The minimum convergence rate required, defaults to .5. The maximum actual simulation runs are increased by a factor of 1/minConvergenceRate.
</p>
</li>
<li> <p><code>type</code>: specifies whether the data should be generated from a population assuming multivariate normality (<code>'normal'</code>; the default), or based on an approach generating non-normal data (<code>'IG'</code>, <code>'mnonr'</code>, <code>'RC'</code>, or <code>'VM'</code>).
The approaches generating non-normal data require additional arguments detailed below.
</p>
</li>
<li> <p><code>missingVars</code>: vector specifying the variables containing missing data (defaults to NULL).
</p>
</li>
<li> <p><code>missingVarProp</code>: can be used instead of <code>missingVars</code>: The proportion of variables containing missing data (defaults to zero).
</p>
</li>
<li> <p><code>missingProp</code>: The proportion of missingness for variables containing missing data (defaults to zero), either a single value or a vector giving the probabilities for each variable.
</p>
</li>
<li> <p><code>missingMechanism</code>: The missing data mechanism, one of <code>MCAR</code> (the default), <code>MAR</code>, or <code>NMAR</code>.
</p>
</li>
<li> <p><code>nCores</code>: The number of cores to use for parallel processing. Defaults to 1 (= no parallel processing). This requires the <code>doSNOW</code> package.
</p>
</li>
</ul>
<p><code>type = 'IG'</code> implements the independent generator approach (IG, Foldnes &amp; Olsson, 2016) approach
specifying third and fourth moments of the marginals, and thus requires that skewness (<code>skewness</code>) and excess kurtosis (<code>kurtosis</code>) for each variable are provided as vectors. This requires the <code>covsim</code> package.
</p>
<p><code>type = 'mnonr'</code> implements the approach suggested by Qu, Liu, &amp; Zhang (2020) and requires provision of  Mardia's multivariate skewness (<code>skewness</code>)  and kurtosis  (<code>kurtosis</code>), where
skewness must be non-negative and kurtosis must be at least 1.641 skewness + p (p + 0.774), where p is the number of variables. This requires the <code>mnonr</code> package.
</p>
<p><code>type = 'RK'</code> implements the approach suggested by Ruscio &amp; Kaczetow (2008) and requires provision of the population distributions
of each variable (<code>distributions</code>). <code>distributions</code> must be a list (if all variables shall be based on the same population distribution) or a list of lists.
Each component must specify the population distribution (e.g. <code>rchisq</code>) and additional arguments (<code>list(df = 2)</code>).
</p>
<p><code>type = 'VM'</code> implements the third-order polynomial method (Vale &amp; Maurelli, 1983)
specifying third and fourth moments of the marginals, and thus requires that skewness (<code>skewness</code>) and excess kurtosis (<code>kurtosis</code>) for each variable are provided as vectors.  This requires the <code>semTools</code> package.
</p>


<h3>Value</h3>

<p>a list. Use the <code>summary</code> method to obtain formatted results. Beyond the results of the power analysis and a number of effect size measures, the list contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>the population covariance matrix. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the population mean vector or <code>NULL</code> when no meanstructure is involved. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaHat</code></td>
<td>
<p>the H0 model implied covariance matrix. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muHat</code></td>
<td>
<p>the H0 model implied mean vector or <code>NULL</code> when no meanstructure is involved. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelH0</code></td>
<td>
<p><code>lavaan</code> H0 model string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelH1</code></td>
<td>
<p><code>lavaan</code> H1 model string or <code>NULL</code> when the comparison refers to the saturated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simRes</code></td>
<td>
<p>detailed simulation results when a simulated power analysis (<code>simulatedPower = TRUE</code>) was performed.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>semPower.aPriori()</code> <code>semPower.postHoc()</code> <code>semPower.compromise()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# set up two CFA factors with a true correlation of .2
mPop &lt;- '
  f1 =~ .5*x1 + .6*x2 + .4*x3
  f2 =~ .7*x4 + .8*x5 + .3*x6
  x1 ~~ .75*x1
  x2 ~~ .64*x2
  x3 ~~ .84*x3
  x4 ~~ .51*x4
  x5 ~~ .36*x5
  x6 ~~ .91*x6
  f1 ~~ 1*f1
  f2 ~~ 1*f2
  f1 ~~ .2*f2
'
# define the H0 analysis model (restricting the factor correlation to zero) 
mH0 &lt;- '
  f1 =~ x1 + x2 + x3
  f2 =~ x4 + x5 + x6
  f1 ~~ 0*f2
'
# determine N to reject the H0 that the correlation is zero 
# with a power of 95% on alpha = .05
powerLav &lt;- semPower.powerLav(type = 'a-priori', 
                              modelPop = mPop, modelH0 = mH0,
                              alpha = .05, beta = .05)
summary(powerLav)

# same as above, but also define an H1 comparison model 
mH1 &lt;- '
  f1 =~ x1 + x2 + x3
  f2 =~ x4 + x5 + x6
  f1 ~~ f2
'
powerLav &lt;- semPower.powerLav(type = 'a-priori', 
                              modelPop = mPop, modelH0 = mH0, modelH1 = mH1,
                              alpha = .05, beta = .05)

# same as above, but use covariance matrix input instead of modelPop
gen &lt;- semPower.genSigma(Phi = .2, 
                         loadings = list(c(.5, .6, .4), c(.7, .8, .3)))
Sigma &lt;- gen$Sigma
powerLav &lt;- semPower.powerLav(type = 'a-priori', 
                              Sigma = Sigma, modelH0 = mH0,
                              alpha = .05, beta = .05)

# note all of the above is identical to the output provided by the semPower.powerCFA function
powerCFA &lt;- semPower.powerCFA(type = 'a-priori',
                              comparison = 'saturated',
                              Phi = .2, 
                              loadings = list(c(.5, .6, .4), c(.7, .8, .3)), 
                              alpha = .05, beta = .05)

# same as above, but perform simulated power analysis
# with 250 replications using a robust ML test-statistic
set.seed(300121)
powerLav &lt;- semPower.powerLav(type = 'a-priori', 
                              Sigma = Sigma, modelH0 = mH0,
                              alpha = .05, beta = .05, 
                              simulatedPower = TRUE,
                              simOptions = list(nReplications = 250)
                              lavOptions = list(estimator = 'MLM'))

## End(Not run)
</code></pre>


</div>