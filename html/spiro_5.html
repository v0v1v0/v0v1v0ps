<div class="container">

<table style="width: 100%;"><tr>
<td>bw_filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth data with a (zero-phase) Butterworth filter</h2>

<h3>Description</h3>

<p>Internal function for <code>spiro_smooth</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bw_filter(x, n = 3, W = 0.04, zero_lag = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector on which the digital filter should be applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Order of the Butterworth filter, defaults to 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Low-pass cut-off frequency of the filter, defaults to 0.04</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_lag</code></td>
<td>
<p>Whether a zero phase (forwards-backwards) filter should be
applied.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Digital filtering might be a preferable processing strategy for smoothing
data from gas exchange measures when compared to moving averages. Robergs et
al. (2010) proposes a third order Butterworth filter with a low-pass cut-off
frequency of 0.04 for filtering VO2 data.
</p>
<p>It should be noted that Butterworth filter comprise a time lag. A method to
create a time series with zero lag is to subsequently apply two Butterworth
filters in forward and reverse direction (forwards-backwards filtering).
While this procedure removes any time lag it changes the magnitude of the
filtering response, i.e. the resulting filter has not the same properties
(order and cut-off frequency) as a single filter.
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as x.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Get VO2 data from example file
vo2_vector &lt;- spiro(spiro_example("zan_gxt"))$VO2

out &lt;- bw_filter(vo2_vector)
head(out, n = 20)
</code></pre>


</div>