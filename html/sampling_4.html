<div class="container">

<table style="width: 100%;"><tr>
<td>balancedtwostage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Balanced two-stage sampling</h2>

<h3>Description</h3>

<p>Selects a balanced two-stage sample.</p>


<h3>Usage</h3>

<pre><code class="language-R">balancedtwostage(X,selection,m,n,PU,comment=TRUE,method=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of auxiliary variables on which the sample must be balanced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>
<p>1, for simple random sampling without replacement at each stage,<br>
2, for self-weighting two-stage selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of primary sampling units to be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of second-stage sampling units to be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PU</code></td>
<td>
<p>vector of integers that defines the primary sampling units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comment</code></td>
<td>
<p>a comment is written during the execution if <code>comment</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the used method in the function <code>samplecube</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a matrix whose columns are the following five vectors:
the selected second-stage sampling units (0 - unselected, 1 - selected), 
the final inclusion probabilities,
the selected primary sampling units,
the inclusion probabilities of the first stage,
the inclusion probabilities of the second stage.</p>


<h3>See Also</h3>

<p><code>samplecube</code>, <code>fastflightcube</code>, <code>landingcube</code>,
<code>balancedstratification</code>, <code>balancedcluster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# definition of the primary units (3 primary units)
PU=c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
# matrix of balancing variables
X=cbind(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))
# selection of 2 primary sampling units and 4 second-stage sampling units
# sample and inclusion probabilities
s=balancedtwostage(X,1,2,4,PU,comment=TRUE)
s
############
## Example 2
############
data(MU284)
X=cbind(MU284$P75,MU284$CS82,MU284$SS82,MU284$ME84)
N=dim(X)[1]
PU=MU284$CL
m=20
n=60
# sample and inclusion probabilities
s=balancedtwostage(X,1,m,n,PU,TRUE)
s
</code></pre>


</div>