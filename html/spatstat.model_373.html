<div class="container">

<table style="width: 100%;"><tr>
<td>model.images</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Images of Constructed Covariates</h2>

<h3>Description</h3>

<p>For a point process model fitted to spatial point pattern data,
this function computes pixel images of the covariates
in the design matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  model.images(object, ...)

  ## S3 method for class 'ppm'
model.images(object, W = as.owin(object), ...)

  ## S3 method for class 'kppm'
model.images(object, W = as.owin(object), ...)

  ## S3 method for class 'dppm'
model.images(object, W = as.owin(object), ...)


  ## S3 method for class 'slrm'
model.images(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>The fitted point process model. An object of class <code>"ppm"</code>
or <code>"kppm"</code>
or <code>"slrm"</code> or <code>"dppm"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>A window (object of class <code>"owin"</code>) in which the
images should be computed. Defaults to the window
in which the model was fitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments (such as <code>na.action</code>) passed to
<code>model.matrix.lm</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This command is similar to <code>model.matrix.ppm</code> except
that it computes pixel images of the covariates,
instead of computing the covariate values at certain points only.
</p>
<p>The <code>object</code> must be a fitted spatial point process model
object of class <code>"ppm"</code> (produced by the model-fitting
function <code>ppm</code>) or class <code>"kppm"</code> (produced by the
fitting function <code>kppm</code>)
or class <code>"dppm"</code> (produced by the
fitting function <code>dppm</code>)
or class <code>"slrm"</code> (produced by <code>slrm</code>). 
</p>
<p>The spatial covariates required by the model-fitting procedure
are computed at every pixel location in the window <code>W</code>.
For <code>slrm</code> objects, the
covariates are computed on the pixels that were used to fit the
model.
</p>
<p>Note that the spatial covariates computed here
are not necessarily the original covariates
that were supplied when fitting the
model. Rather, they are the canonical covariates,
the covariates that appear in the
loglinear representation of the (conditional) intensity
and in the columns of the design matrix. For example, they might include
dummy or indicator variables for different levels of a factor,
depending on the contrasts that are in force.
</p>
<p>The pixel resolution is determined by <code>W</code> 
if <code>W</code> is a mask (that is <code>W$type = "mask"</code>).
Otherwise, the pixel resolution is determined by
<code>spatstat.options</code>.
</p>
<p>The format of the result depends on whether the original point pattern
data were marked or unmarked.
</p>

<ul>
<li>
<p>If the original dataset was unmarked,
the result is a named list of pixel images (objects of class
<code>"im"</code>) containing the values of the spatial covariates.
The names of the list elements are the names of the covariates
determined by <code>model.matrix.lm</code>.
The result is also of class <code>"solist"</code> so that it can
be plotted immediately.
</p>
</li>
<li> 
<p>If the original dataset was a multitype point pattern,
the result is a <code>hyperframe</code>
with one column for each possible type of points.
Each column is a named list of pixel images (objects of class
<code>"im"</code>) containing the values of the spatial covariates.
The row names of the hyperframe are the names of the covariates
determined by <code>model.matrix.lm</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list (of class <code>"solist"</code>) or
array (of class <code>"hyperframe"</code>) containing
pixel images (objects of class <code>"im"</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code>model.matrix.ppm</code>,
<code>model.matrix</code>,
<code>ppm</code>,
<code>ppm.object</code>,
<code>dppm</code>,
<code>kppm</code>,
<code>slrm</code>,
<code>im</code>,
<code>im.object</code>,
<code>plot.solist</code>,
<code>spatstat.options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   fit &lt;- ppm(cells ~ x)
   model.images(fit)
   B &lt;- owin(c(0.2, 0.4), c(0.3, 0.8))
   model.images(fit, B)
   fit2 &lt;- ppm(cells ~ cut(x,3))
   model.images(fit2)
   fit3 &lt;- slrm(japanesepines ~ x)
   model.images(fit3)
   fit4 &lt;- ppm(amacrine ~ marks + x)
   model.images(fit4)
</code></pre>


</div>