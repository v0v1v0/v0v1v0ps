<div class="container">

<table style="width: 100%;"><tr>
<td>change_em_binning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Change population and observed length composition bins in an SS estimation
model</h2>

<h3>Description</h3>

<p><code>change_em_binning</code> alters the bin structure for the population and
length composition data in an SS estimation model. It is done by taking the
original length composition info from the EM <code>ss3.dat</code> then changing
according to the user's specification. If the data file also contains
conditional age-at-length data then these data will be re-binned as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">change_em_binning(dat_list, outfile = NULL, bin_vector,
  lbin_method = NULL, pop_binwidth = NULL, pop_minimum_size = NULL,
  pop_maximum_size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code>SS_readdat</code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_vector</code></td>
<td>
<p>A numeric vector of new length bins to substitute into the
<code>ss3.dat</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbin_method</code></td>
<td>
<p>A numeric value of either <code>NULL, 1, 2, 3</code> to change
the lbin_method for the population bin. Only supports either <code>NULL, 1,
2</code> at the moment. <code>NULL</code> means to keep it unchanged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_binwidth</code></td>
<td>
<p>*Population length bin width. Only necessary for
<code>lbin_method=2</code>. Note that this value must be smaller than the bin
width specified in length composition data <code>len_bins</code> or SS3 will
fail (see notes in the SS3 manual).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_minimum_size</code></td>
<td>
<p>*Population minimum length bin value. 'Only
necessary for <code>lbin_method=2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_maximum_size</code></td>
<td>
<p>*Population maximum length bin value. Only
necessary for <code>lbin_method=2</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kotaro Ono (length-composition rebinning), Sean Anderson
(conditional age-at-length rebinning)
</p>


<h3>See Also</h3>

<p>Other change functions: <code>change_data</code>,
<code>change_e</code>, <code>change_f_par</code>,
<code>change_f</code>, <code>change_o</code>,
<code>change_retro</code>, <code>change_tv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Note that typically this function is used with estimation models in ss3sim,
# but it is used with an operating model data file in the following examples.
f &lt;- system.file("extdata", "models", "cod-om", "codOM.dat", package = "ss3sim")
d &lt;- r4ss::SS_readdat(f, version = NULL, verbose = FALSE)

# An example with lbin_method = 1
l1 &lt;- change_em_binning(d, outfile = NULL, lbin_method = 1,
  bin_vector = seq(20, 152, by = 4))
l1$lbin_vector
head(l1$lencomp)

#An example with lbin_method = 2
new_bin_vec &lt;- seq(min(d$lbin_vector), max(d$lbin_vector), by = 4)
# add the max value if necessary.
if(new_bin_vec[length(new_bin_vec)] != d$lbin_vector[length(d$lbin_vector)]){
  new_bin_vec &lt;- c(new_bin_vec,
                   d$lbin_vector[length(d$lbin_vector)])
}
pop_bin_input &lt;- 5
pop_min_size_input &lt;- min(d$lbin_vector_pop) - 1
pop_max_size_input &lt;- max(d$lbin_vector_pop) + 5
lbin_vec_pop &lt;-seq(pop_min_size_input,
                   pop_max_size_input,
                   length.out = (pop_max_size_input - pop_min_size_input)/
                     pop_bin_input + 1
)
l2 &lt;- change_em_binning(dat_list = d,
                            bin_vector = new_bin_vec,
                            lbin_method = 2,
                            #Note: need more inputs with lbin_method = 2
                            pop_binwidth = pop_bin_input,
                            pop_minimum_size = pop_min_size_input,
                            pop_maximum_size = pop_max_size_input)
l2$lbin_method
# note bin width is now the same as the input
pop_bin_input
l2$binwidth
# note the minimum size has changed based on the input:
pop_min_size_input
l2$minimum_size
# so has max
l2$maximum_size
l2$lbin_vector
#other modified components:
l2$lbin_vector_pop
head(l2$lencomp)
</code></pre>


</div>