<div class="container">

<table style="width: 100%;"><tr>
<td>contingency_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contingency table analyses</h2>

<h3>Description</h3>

<p>Parametric and Bayesian one-way and two-way contingency table analyses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contingency_table(
  data,
  x,
  y = NULL,
  paired = FALSE,
  type = "parametric",
  counts = NULL,
  ratio = NULL,
  alternative = "two.sided",
  digits = 2L,
  conf.level = 0.95,
  sampling.plan = "indepMulti",
  fixed.margin = "rows",
  prior.concentration = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame (or a tibble) from which variables specified are to
be taken. Other data types (e.g., matrix,table, array, etc.) will <strong>not</strong>
be accepted. Additionally, grouped data frames from <code>{dplyr}</code> should be
ungrouped before they are entered as <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The variable to use as the <strong>rows</strong> in the contingency table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The variable to use as the <strong>columns</strong> in the contingency table.
Default is <code>NULL</code>. If <code>NULL</code>, one-sample proportion test (a goodness of fit
test) will be run for the <code>x</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>Logical indicating whether data came from a within-subjects or
repeated measures design study (Default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character specifying the type of statistical approach:
</p>

<ul>
<li> <p><code>"parametric"</code>
</p>
</li>
<li> <p><code>"nonparametric"</code>
</p>
</li>
<li> <p><code>"robust"</code>
</p>
</li>
<li> <p><code>"bayes"</code>
</p>
</li>
</ul>
<p>You can specify just the initial letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>The variable in data containing counts, or <code>NULL</code> if each row
represents a single observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>A vector of proportions: the expected proportions for the
proportion test (should sum to <code>1</code>). Default is <code>NULL</code>, which means the null
is equal theoretical proportions across the levels of the nominal variable.
E.g., <code>ratio = c(0.5, 0.5)</code> for two levels,
<code>ratio = c(0.25, 0.25, 0.25, 0.25)</code> for four levels, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis;
Controls the type of CI returned: <code>"two.sided"</code> (default, two-sided CI),
<code>"greater"</code> or <code>"less"</code> (one-sided CI). Partial matching is allowed
(e.g., <code>"g"</code>, <code>"l"</code>, <code>"two"</code>...). See section <em>One-Sided CIs</em> in
the <a href="https://easystats.github.io/effectsize/">effectsize_CIs vignette</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits for rounding or significant figures. May also
be <code>"signif"</code> to return significant figures or <code>"scientific"</code>
to return scientific notation. Control the number of digits by adding the
value as suffix, e.g. <code>digits = "scientific4"</code> to have scientific
notation with 4 decimal places, or <code>digits = "signif5"</code> for 5
significant figures (see also <code>signif()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Scalar between <code>0</code> and <code>1</code> (default: <code style="white-space: pre;">⁠95%⁠</code>
confidence/credible intervals, <code>0.95</code>). If <code>NULL</code>, no confidence intervals
will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.plan</code></td>
<td>
<p>Character describing the sampling plan. Possible options:
</p>

<ul>
<li> <p><code>"indepMulti"</code> (independent multinomial; default)
</p>
</li>
<li> <p><code>"poisson"</code>
</p>
</li>
<li> <p><code>"jointMulti"</code> (joint multinomial)
</p>
</li>
<li> <p><code>"hypergeom"</code> (hypergeometric).
For more, see <code>BayesFactor::contingencyTableBF()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.margin</code></td>
<td>
<p>For the independent multinomial sampling plan, which
margin is fixed (<code>"rows"</code> or <code>"cols"</code>). Defaults to <code>"rows"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.concentration</code></td>
<td>
<p>Specifies the prior concentration parameter, set
to <code>1</code> by default. It indexes the expected deviation from the null
hypothesis under the alternative, and corresponds to Gunel and Dickey's
(1974) <code>"a"</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned tibble data frame can contain some or all of the following columns (the exact columns will depend on the statistical test):
</p>

<ul>
<li> <p><code>statistic</code>: the numeric value of a statistic
</p>
</li>
<li> <p><code>df</code>: the numeric value of a parameter being modeled (often degrees
of freedom for the test)
</p>
</li>
<li> <p><code>df.error</code> and <code>df</code>: relevant only if the statistic in question has
two degrees of freedom (e.g. anova)
</p>
</li>
<li> <p><code>p.value</code>: the two-sided <em>p</em>-value associated with the observed statistic
</p>
</li>
<li> <p><code>method</code>: the name of the inferential statistical test
</p>
</li>
<li> <p><code>estimate</code>: estimated value of the effect size
</p>
</li>
<li> <p><code>conf.low</code>: lower bound for the effect size estimate
</p>
</li>
<li> <p><code>conf.high</code>: upper bound for the effect size estimate
</p>
</li>
<li> <p><code>conf.level</code>: width of the confidence interval
</p>
</li>
<li> <p><code>conf.method</code>: method used to compute confidence interval
</p>
</li>
<li> <p><code>conf.distribution</code>: statistical distribution for the effect
</p>
</li>
<li> <p><code>effectsize</code>: the name of the effect size
</p>
</li>
<li> <p><code>n.obs</code>: number of observations
</p>
</li>
<li> <p><code>expression</code>: pre-formatted expression containing statistical details
</p>
</li>
</ul>
<p>For examples, see <a href="https://indrajeetpatil.github.io/statsExpressions/articles/web_only/dataframe_outputs.html">data frame output vignette</a>.
</p>


<h3>Contingency table analyses</h3>

<p>The table below provides summary about:
</p>

<ul>
<li>
<p> statistical test carried out for inferential statistics
</p>
</li>
<li>
<p> type of effect size estimate and a measure of uncertainty for this estimate
</p>
</li>
<li>
<p> functions used internally to compute these details
</p>
</li>
</ul>
<h4>two-way table</h4>

<p><strong>Hypothesis testing</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> Design </td>
<td style="text-align: left;"> Test </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Unpaired </td>
<td style="text-align: left;"> Pearson's chi-squared test </td>
<td style="text-align: left;"> <code>stats::chisq.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> Unpaired </td>
<td style="text-align: left;"> Bayesian Pearson's chi-squared test </td>
<td style="text-align: left;"> <code>BayesFactor::contingencyTableBF()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Paired </td>
<td style="text-align: left;"> McNemar's chi-squared test </td>
<td style="text-align: left;"> <code>stats::mcnemar.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> Paired </td>
<td style="text-align: left;"> No </td>
<td style="text-align: left;"> No </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><strong>Effect size estimation</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> Design </td>
<td style="text-align: left;"> Effect size </td>
<td style="text-align: left;"> CI available? </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Unpaired </td>
<td style="text-align: left;"> Cramer's <em>V</em> </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::cramers_v()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> Unpaired </td>
<td style="text-align: left;"> Cramer's <em>V</em> </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::cramers_v()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Paired </td>
<td style="text-align: left;"> Cohen's <em>g</em> </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::cohens_g()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> Paired </td>
<td style="text-align: left;"> No </td>
<td style="text-align: left;"> No </td>
<td style="text-align: left;"> No </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h4>one-way table</h4>

<p><strong>Hypothesis testing</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> Test </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Goodness of fit chi-squared test </td>
<td style="text-align: left;"> <code>stats::chisq.test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> Bayesian Goodness of fit chi-squared test </td>
<td style="text-align: left;"> (custom) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><strong>Effect size estimation</strong></p>

<table>
<tr>
<td style="text-align: left;">
   Type </td>
<td style="text-align: left;"> Effect size </td>
<td style="text-align: left;"> CI available? </td>
<td style="text-align: left;"> Function used </td>
</tr>
<tr>
<td style="text-align: left;">
   Parametric/Non-parametric </td>
<td style="text-align: left;"> Pearson's <em>C</em> </td>
<td style="text-align: left;"> Yes </td>
<td style="text-align: left;"> <code>effectsize::pearsons_c()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   Bayesian </td>
<td style="text-align: left;"> No </td>
<td style="text-align: left;"> No </td>
<td style="text-align: left;"> No </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">if (identical(Sys.getenv("NOT_CRAN"), "true")) {
  #### -------------------- association test ------------------------ ####

  # ------------------------ frequentist ---------------------------------

  # unpaired

  set.seed(123)
  contingency_table(
    data   = mtcars,
    x      = am,
    y      = vs,
    paired = FALSE
  )

  # paired

  paired_data &lt;- tibble(
    response_before = structure(c(1L, 2L, 1L, 2L), levels = c("no", "yes"), class = "factor"),
    response_after = structure(c(1L, 1L, 2L, 2L), levels = c("no", "yes"), class = "factor"),
    Freq = c(65L, 25L, 5L, 5L)
  )

  set.seed(123)
  contingency_table(
    data   = paired_data,
    x      = response_before,
    y      = response_after,
    paired = TRUE,
    counts = Freq
  )

  # ------------------------ Bayesian -------------------------------------

  # unpaired

  set.seed(123)
  contingency_table(
    data = mtcars,
    x = am,
    y = vs,
    paired = FALSE,
    type = "bayes"
  )

  # paired

  set.seed(123)
  contingency_table(
    data = paired_data,
    x = response_before,
    y = response_after,
    paired = TRUE,
    counts = Freq,
    type = "bayes"
  )

  #### -------------------- goodness-of-fit test -------------------- ####

  # ------------------------ frequentist ---------------------------------

  set.seed(123)
  contingency_table(
    data   = as.data.frame(HairEyeColor),
    x      = Eye,
    counts = Freq
  )

  # ------------------------ Bayesian -------------------------------------

  set.seed(123)
  contingency_table(
    data   = as.data.frame(HairEyeColor),
    x      = Eye,
    counts = Freq,
    ratio  = c(0.2, 0.2, 0.3, 0.3),
    type   = "bayes"
  )
}
</code></pre>


</div>