<div class="container">

<table style="width: 100%;"><tr>
<td>predict.survPen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hazard and Survival prediction from fitted <code>survPen</code> model</h2>

<h3>Description</h3>

<p>Takes a fitted <code>survPen</code> object and produces hazard and survival predictions given a new set of values for the model covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'survPen'
predict(
  object,
  newdata,
  newdata.ref = NULL,
  n.legendre = 50,
  conf.int = 0.95,
  do.surv = TRUE,
  type = "standard",
  exclude.random = FALSE,
  get.deriv.H = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted <code>survPen</code> object as produced by <code>survPen.fit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>data frame giving the new covariates value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata.ref</code></td>
<td>
<p>data frame giving the new covariates value for the reference population (used only when type="HR")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.legendre</code></td>
<td>
<p>number of nodes to approximate the cumulative hazard by Gauss-Legendre quadrature; default is 50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>numeric value giving the precision of the confidence intervals; default is 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.surv</code></td>
<td>
<p>If TRUE, the survival and its lower and upper confidence values are computed. Survival computation requires numerical integration and can be time-consuming so if you only want the hazard use do.surv=FALSE; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type, </code></td>
<td>
<p>if type="lpmatrix" returns the design matrix (or linear predictor matrix) corresponding to the new values of the covariates; if equals "HR", returns the predicted HR and CIs between newdata and newdata.ref; default is "standard" for classical hazard and survival estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.random</code></td>
<td>
<p>if TRUE all random effects are set to zero; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get.deriv.H</code></td>
<td>
<p>if TRUE, the derivatives wrt to the regression parameters of the cumulative hazard are returned; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The confidence intervals noted CI.U are built on the log cumulative hazard scale U=log(H) (efficient scale in terms of respect towards the normality assumption)
using Delta method. The confidence intervals on the survival scale are then <code>CI.surv = exp(-exp(CI.U))</code>
</p>


<h3>Value</h3>

<p>List of objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>haz</code></td>
<td>
<p>hazard predicted by the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haz.inf</code></td>
<td>
<p>lower value for the confidence interval on the hazard based on the Bayesian covariance matrix Vp (Wood et al. 2016)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haz.sup</code></td>
<td>
<p>Upper value for the confidence interval on the hazard based on the Bayesian covariance matrix Vp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>survival predicted by the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv.inf</code></td>
<td>
<p>lower value for the confidence interval on the survival based on the Bayesian covariance matrix Vp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv.sup</code></td>
<td>
<p>Upper value for the confidence interval on the survival based on the Bayesian covariance matrix Vp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv.H</code></td>
<td>
<p>derivatives wrt to the regression parameters of the cumulative hazard. Useful to calculate standardized survival</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HR</code></td>
<td>
<p>predicted hazard ratio ; only when type = "HR"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HR.inf</code></td>
<td>
<p>lower value for the confidence interval on the hazard ratio based on the Bayesian covariance matrix Vp  ; only when type = "HR"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HR.sup</code></td>
<td>
<p>Upper value for the confidence interval on the hazard ratio based on the Bayesian covariance matrix Vp  ; only when type = "HR"</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wood, S.N., Pya, N. and Saefken, B. (2016), Smoothing parameter and model selection for general smooth models (with discussion). Journal of the American Statistical Association 111, 1548-1575
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(survPen)
data(datCancer) # simulated dataset with 2000 individuals diagnosed with cervical cancer

f1 &lt;- ~tensor(fu,age,df=c(5,5))

# hazard model
mod1 &lt;- survPen(f1,data=datCancer,t1=fu,event=dead,expected=NULL,method="LAML")

# predicting hazard and survival curves for age 60
nt &lt;- seq(0,5,le=50)
pred &lt;- predict(mod1,data.frame(fu=nt,age=60))
pred$haz
pred$surv

# predicting hazard ratio at 1 year according to age (with reference age of 50)
newdata1 &lt;- data.frame(fu=1,age=seq(30,90,by=1))
newdata.ref1 &lt;- data.frame(fu=1,age=rep(50,times=61))
predHR_1 &lt;- predict(mod1,newdata=newdata1,newdata.ref=newdata.ref1,type="HR")
predHR_1$HR
predHR_1$HR.inf
predHR_1$HR.sup

# predicting hazard ratio at 3 years according to age (with reference age of 50)
newdata3 &lt;- data.frame(fu=3,age=seq(30,90,by=1))
newdata.ref3 &lt;- data.frame(fu=3,age=rep(50,times=61))
predHR_3 &lt;- predict(mod1,newdata=newdata3,newdata.ref=newdata.ref3,type="HR")
predHR_3$HR
predHR_3$HR.inf
predHR_3$HR.sup
</code></pre>


</div>