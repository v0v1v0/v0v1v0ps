<div class="container">

<table style="width: 100%;"><tr>
<td>prince.var.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ScreePlot of the data variation covered by the principal components
</h2>

<h3>Description</h3>

<p>To identify the number of top principal components with relevant variation,
this function plots the variation contained in the pc for both observed data
and reshuffled data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prince.var.plot(g, show.top = dim(g)[2], imputeknn = F, 
                center = T, npermute = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>the input data in form of a matrix with features as rows and samples as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.top</code></td>
<td>

<p>the number of top principal components to be shown in the
plot (cannot exceed ncol(g) or nrow(g)).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imputeknn</code></td>
<td>

<p>default=FALSE. missing values in the data matrix can be imputed by imputeknn=TRUE.
The function knn.impute from the package impute is used with default settings. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>default=TRUE. the features are mean-centered before singular value decompositon.
this is a pre-requisite for principal component analysis, change only if you are
really convinced that centering is not necessary. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npermute</code></td>
<td>

<p>the number of reshuffled datasets. default=10. A permuted data matrix is generated
with the values for each feature shuffled. From the permutation sets the median
percentage of variation for each principal component is taken.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function prcomp() is used to calculate the variation of the data
contained in the principal components.  As prcomp cannot handle missing values
they have to be imputed beforehands, using imputeknn=TRUE.</p>


<h3>Value</h3>

<p>a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>real.variation</code></td>
<td>
<p>a vector containing the percentage of variation for
each principal component in the observed data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permuted.variation</code></td>
<td>
<p>a matrix containing the percentages of variation
for each principal component in the reshuffled data sets.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>requires the package impute</p>


<h3>Author(s)</h3>

<p>Martin Lauss</p>


<h3>Examples</h3>

<pre><code class="language-R">## data as a matrix
set.seed(100)
g&lt;-matrix(nrow=1000,ncol=50,rnorm(1000*50),dimnames=list(paste("Feature",1:1000),
          paste("Sample",1:50)))
g[1:100,26:50]&lt;-g[1:100,26:50]+1 
     # the first 100 features show higher values in the samples 26:50

## to plot the variations
res2&lt;-prince.var.plot(g,show.top=50,npermute=10)
str(res2)
</code></pre>


</div>