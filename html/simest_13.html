<div class="container">

<table style="width: 100%;"><tr>
<td>cvx.lip.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Convex Least Squares Regression with Lipschitz Constraint
</h2>

<h3>Description</h3>

<p>This function provides an estimate of the non-parametric regression function with a shape constraint of convexity and a smoothness constraint via a Lipschitz bound.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvx.lip.reg(t, z, w = NULL, L,...)
## Default S3 method:
cvx.lip.reg(t, z, w = NULL, L, ...)
## S3 method for class 'cvx.lip.reg'
plot(x,...)
## S3 method for class 'cvx.lip.reg'
print(x,...)
## S3 method for class 'cvx.lip.reg'
predict(object, newdata = NULL, deriv = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a numeric vector giving the values of the predictor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a numeric vector giving the values of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an optional numeric vector of the same length as x; Defaults to all elements <code class="reqn">1/n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>a numeric value providing the Lipschitz bound on the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class ‘cvx.lip.reg’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class ‘cvx.lip.reg’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a matrix of new data points in the predict function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>a numeric either 0 or 1 representing which derivative to evaluate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function minimizes 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^n w_i(z_i - \theta_i)^2</code>
</p>
 
<p>subject to
</p>
<p style="text-align: center;"><code class="reqn">-L\le\frac{\theta_2 - \theta_1}{t_2 - t_1}\le\cdots\le\frac{\theta_n - \theta_{n-1}}{t_n - t_{n-1}}\le L</code>
</p>

<p>for sorted <code class="reqn">t</code> values and <code class="reqn">z</code> reorganized such that <code class="reqn">z_i</code> corresponds to the new sorted <code class="reqn">t_i</code>. This function uses the <code>nnls</code> function from the <code>nnls</code> package to perform the constrained minimization of least squares. <code>plot</code> function provides the scatterplot along with fitted curve; it also includes some diagnostic plots for residuals. Predict function now allows calculating the first derivative also.
</p>


<h3>Value</h3>

<p>An object of class ‘cvx.lip.reg’, basically a list including the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x.values</code></td>
<td>
<p>sorted ‘t’ values provided as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.values</code></td>
<td>
<p>corresponding ‘z’ values in input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.values</code></td>
<td>
<p>corresponding fit values of same length as that of ‘x.values’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>corresponding values of the derivative of same length as that of ‘x.values’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals obtained from the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvalue</code></td>
<td>
<p>minimum value of the objective function attained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Always set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a numeric indicating the convergence of the code.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arun Kumar Kuchibhotla, arunku@wharton.upenn.edu.</p>


<h3>Source</h3>

<p>Lawson, C. L and Hanson, R. J. (1995). Solving Least Squares Problems. SIAM.
</p>


<h3>References</h3>

<p>Chen, D. and Plemmons, R. J. (2009). Non-negativity Constraints in Numerical Analysis. Symposium on the Birth of Numerical Analysis. 
</p>


<h3>See Also</h3>

<p>See also the function <code>nnls</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">args(cvx.lip.reg)
x &lt;- runif(50,-1,1)
y &lt;- x^2 + rnorm(50,0,0.3)
tmp &lt;- cvx.lip.reg(x, y, L = 10)
print(tmp)
plot(tmp)
predict(tmp, newdata = rnorm(10,0,0.1))
</code></pre>


</div>