<div class="container">

<table style="width: 100%;"><tr>
<td>rHeadrick</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate non-normal data with Headrick's (2002) method</h2>

<h3>Description</h3>

<p>Generate multivariate non-normal distributions using the fifth-order polynomial
method described by Headrick (2002).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rHeadrick(
  n,
  mean = rep(0, nrow(sigma)),
  sigma = diag(length(mean)),
  skew = rep(0, nrow(sigma)),
  kurt = rep(0, nrow(sigma)),
  gam3 = NaN,
  gam4 = NaN,
  return_coefs = FALSE,
  coefs = NULL,
  control = list(trace = FALSE, max.ntry = 15, obj.tol = 1e-10, n.valid.sol = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of samples to draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a vector of k elements for the mean of the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>desired k x k covariance matrix between bivariate non-normal variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>
<p>a vector of k elements for the skewness of the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kurt</code></td>
<td>
<p>a vector of k elements for the kurtosis of the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam3</code></td>
<td>
<p>(optional) explicitly supply the gamma 3 value? Default computes this internally</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam4</code></td>
<td>
<p>(optional) explicitly supply the gamma 4 value? Default computes this internally</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_coefs</code></td>
<td>
<p>logical; return the estimated coefficients only? See below regarding why this is useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>(optional) supply previously estimated coefficients? This is useful when there must be multiple
data sets drawn and will avoid repetitive computations. Must be the object returned after passing
<code>return_coefs = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters when locating the polynomial coefficients</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is primarily a wrapper for the code written by Oscar L. Olvera Astivia
(last edited Feb 26, 2015) with some modifications (e.g., better starting values
for the Newton optimizer, passing previously saved coefs, etc).
</p>


<h3>Author(s)</h3>

<p>Oscar L. Olvera Astivia and Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P., &amp; Adkins, M. C.  (2020). Writing Effective and Reliable Monte Carlo Simulations
with the SimDesign Package. <code>The Quantitative Methods for Psychology, 16</code>(4), 248-280.
<a href="https://doi.org/10.20982/tqmp.16.4.p248">doi:10.20982/tqmp.16.4.p248</a>
</p>
<p>Sigal, M. J., &amp; Chalmers, R. P. (2016). Play it again: Teaching statistics with Monte
Carlo simulation. <code>Journal of Statistics Education, 24</code>(3), 136-156.
<a href="https://doi.org/10.1080/10691898.2016.1246953">doi:10.1080/10691898.2016.1246953</a>
</p>
<p>Headrick, T. C. (2002). Fast fifth-order polynomial transforms for generating univariate and
multivariate nonnormal distributions. <em>Computational Statistics &amp; Data Analysis, 40</em>, 685-711.
</p>
<p>Olvera Astivia, O. L., &amp; Zumbo, B. D. (2015). A Cautionary Note on the Use of the Vale and Maurelli
Method to Generate Multivariate, Nonnormal Data for Simulation Purposes.
<em>Educational and Psychological Measurement, 75</em>, 541-567.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
set.seed(1)

N &lt;- 200
mean &lt;- c(rep(0,4))
Sigma &lt;- matrix(.49, 4, 4)
diag(Sigma) &lt;- 1
skewness &lt;- c(rep(1,4))
kurtosis &lt;- c(rep(2,4))

nonnormal &lt;- rHeadrick(N, mean, Sigma, skewness, kurtosis)
# cor(nonnormal)
# psych::describe(nonnormal)

#-----------
# compute the coefficients, then supply them back to the function to avoid
# extra computations

cfs &lt;- rHeadrick(N, mean, Sigma, skewness, kurtosis, return_coefs = TRUE)
cfs

# compare
system.time(nonnormal &lt;- rHeadrick(N, mean, Sigma, skewness, kurtosis))
system.time(nonnormal &lt;- rHeadrick(N, mean, Sigma, skewness, kurtosis,
                                   coefs=cfs))

## End(Not run)

</code></pre>


</div>