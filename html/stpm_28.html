<div class="container">

<table style="width: 100%;"><tr>
<td>spm_continuous</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Continuous multi-dimensional optimization</h2>

<h3>Description</h3>

<p>Continuous multi-dimensional optimization
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm_continuous(
  dat,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 2e-05,
  theta = 0.08,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  pinv.tol = 0.01,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08),
  logmu0 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A starting value of the rate of adaptive response to any deviation of Y from f1(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>A starting value of the average age trajectories of the variables which process is forced to follow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Starting values of the quadratic hazard term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A starting value of the "optimal" value of variable which corresponds to the minimum of hazard rate at a respective time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A starting value of a diffusion coefficient representing a strength of the random disturbance from Wiener Process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>A starting value of the baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A starting value of the parameter theta (axe displacement of Gompertz function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter achieves lower or upper boundaries.
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Upper bound of parameters under estimation.
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>An indicator of verbosing output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logmu0</code></td>
<td>
<p>Natural logarith of baseline mortality.
Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>spm_continuous</code> runs much slower that discrete but more precise and can handle time 
intervals with different lengths.
</p>


<h3>Value</h3>

<p>A set of estimated parameters a, f1, Q, f, b, mu0, theta and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by nloptr optimization function (see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(stpm)
set.seed(123)
#Reading the data:
data &lt;- simdata_cont(N=2)
head(data)
#Parameters estimation:
pars &lt;- spm_continuous(dat=data,a=-0.05, f1=80, 
					           Q=2e-8, f=80, b=5, mu0=2e-5)
pars

</code></pre>


</div>