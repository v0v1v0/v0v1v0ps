<div class="container">

<table style="width: 100%;"><tr>
<td>calcExpectedMutations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate expected mutation frequencies of a sequence</h2>

<h3>Description</h3>

<p><code>calcExpectedMutations</code> calculates the expected mutation
frequencies of a given sequence. This is primarily a helper function for
expectedMutations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcExpectedMutations(
  germlineSeq,
  inputSeq = NULL,
  targetingModel = HH_S5F,
  regionDefinition = NULL,
  mutationDefinition = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>germlineSeq</code></td>
<td>
<p>germline (reference) sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputSeq</code></td>
<td>
<p>input (observed) sequence. If this is not <code>NULL</code>, 
then <code>germlineSeq</code> will be processed to be the same
same length as <code>inputSeq</code> and positions in 
<code>germlineSeq</code> corresponding to positions with Ns in 
<code>inputSeq</code> will also be assigned an N.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetingModel</code></td>
<td>
<p>TargetingModel object. Default is HH_S5F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regionDefinition</code></td>
<td>
<p>RegionDefinition object defining the regions
and boundaries of the Ig sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutationDefinition</code></td>
<td>
<p>MutationDefinition object defining replacement
and silent mutation criteria. If <code>NULL</code> then 
replacement and silent are determined by exact 
amino acid identity.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>calcExpectedMutations</code> calculates the expected mutation frequencies of a 
given sequence and its germline. 
</p>
<p>Note, only the part of the sequences defined in <code>regionDefinition</code> are analyzed. 
For example, when using the default IMGT_V definition, mutations in
positions beyond 312 will be ignored.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the expected frequencies of mutations in the 
regions in the <code>regionDefinition</code>. For example, when using the default 
IMGT_V definition, which defines positions for CDR and 
FWR, the following columns are calculated:
</p>

<ul>
<li>  <p><code>mu_expected_cdr_r</code>:  number of replacement mutations in CDR1 and 
CDR2 of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_cdr_s</code>:  number of silent mutations in CDR1 and CDR2 
of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_fwr_r</code>:  number of replacement mutations in FWR1, 
FWR2 and FWR3 of the V-segment.
</p>
</li>
<li>  <p><code>mu_expected_fwr_s</code>:  number of silent mutations in FWR1, FWR2 and
FWR3 of the V-segment.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>expectedMutations calls this function.
To create a custom <code>targetingModel</code> see createTargetingModel.
See calcObservedMutations for getting observed mutation counts.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example data
data(ExampleDb, package="alakazam")

# Use first entry in the exampled data for input and germline sequence
in_seq &lt;- ExampleDb[["sequence_alignment"]][1]
germ_seq &lt;-  ExampleDb[["germline_alignment_d_mask"]][1]

# Identify all mutations in the sequence
calcExpectedMutations(germ_seq,in_seq)

# Identify only mutations the V segment minus CDR3
calcExpectedMutations(germ_seq, in_seq, regionDefinition=IMGT_V)

# Define mutations based on hydropathy
calcExpectedMutations(germ_seq, in_seq, regionDefinition=IMGT_V,
                      mutationDefinition=HYDROPATHY_MUTATIONS)

</code></pre>


</div>