<div class="container">

<table style="width: 100%;"><tr>
<td>matchICA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
match independent components using the Hungarian method
</h2>

<h3>Description</h3>

<p>The ICA model is only identifiable up to signed permutations of the ICs. This function finds the signed permutation of a matrix S such that ||S%*%P - template|| is minimized. Optionally also matches the mixing matrix M.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matchICA(S, template, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>the n x d matrix of ICs to be matched
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>

<p>the n x d matrix that S is matched to.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>an optional d x p mixing matrix corresponding to S that will also be matched to the template
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the signed permutation of S that is matched to the template. If the optional argument M is provided, returns a list with the permuted S and M matrices. 
</p>


<h3>Author(s)</h3>

<p>Benjamin Risk
</p>


<h3>References</h3>

<p>Kuhn, H. The Hungarian Method for the assignment problem Naval Research Logistics Quarterly, 1955, 2, 83 - 97
</p>
<p>Risk, B.B., D.S. Matteson, D. Ruppert, A. Eloyan, B.S. Caffo. In review, 2013. Evaluating ICA methods with an application to resting state fMRI. 
</p>


<h3>See Also</h3>

<p><code>frobICA</code>
<code>clue::solve_LSAP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(999)
nObs &lt;- 1024
nComp &lt;- 3
# simulate from some gamma distributions:
simS&lt;-cbind(rgamma(nObs, shape = 1, scale = 2),
            rgamma(nObs, shape = 3, scale = 2),
            rgamma(nObs, shape = 9, scale = 0.5))

simM &lt;- matrix(rnorm(9),3)
pMat &lt;- matrix(c(0,-1,0,1,0,0,0,0,-1),3)
permS &lt;- simS%*%pMat
permM &lt;- t(pMat)%*%simM

matchedS &lt;- matchICA(S = permS, template = simS, M = permM)
sum(abs(matchedS$S - simS))
sum(abs(simM - matchedS$M))
</code></pre>


</div>