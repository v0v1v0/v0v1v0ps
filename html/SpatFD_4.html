<div class="container">

<table style="width: 100%;"><tr>
<td>COKS_scores_lambdas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional cokriging
</h2>

<h3>Description</h3>

<p>Linear Spatial functional prediction. Two predictors are possible: scores or lambda.
</p>


<h3>Usage</h3>

<pre><code class="language-R">COKS_scores_lambdas(SFD, newcoords, model, method = "scores", fill.all=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SFD</code></td>
<td>

<p>object of class 'SpatFD'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newcoords</code></td>
<td>

<p>The N × 2 matrix or data.frame with the spatial coordinates corresponding to the N prediction locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>The linear model of coregionalization of all functional variable scores. A variogram model. A variogramModel object. See gstat package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Prediction method: "scores"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.all</code></td>
<td>

<p>gstat function parameter. If there are more than 1 score vector and not all models or a valid and complete linear model of coregionalization is given, fill all of the direct and cross variogram model with the only model given.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each functional variable is represented in terms of its functional principal components 
<code class="reqn">\chi_{\bm s_i}(t)=\bm \xi^T(t)\bm f_{\bm s_i},\;i=1,...,n</code>
where <code class="reqn">\bm f_{\bm s_i}=\left(f_{\bm s_i}^1,...,f_{\bm s_i}^K\right)^T</code>
</p>
<p>The goal is the prediction of a spatial functional variable of <code class="reqn">\chi^r_{\bm s_0}(t)\;1\leq r\leq P</code> at the unsampled site <code class="reqn">\bm s_0</code> based on P spatial functional variables. The method performs cokriging directly on the scores chosen for all functional variables involved.
</p>
<p><code class="reqn">\left(\bm f_{\bm s}^{11},...,f_{\bm s}^{1K_1},...,f_{\bm s}^{P1},...,f_{\bm s}^{PK_P}\right)</code> 
</p>
<p>Scores predictions are used to build the cokriging functional predictor.
</p>


<h3>Value</h3>

<p>Returns a 'COKS_pred' object with functional cokriging
</p>


<h3>Author(s)</h3>

<p>Valeria Bejarano &lt;vbejaranos@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>Bohorquez, M., Giraldo, R., &amp; Mateu, J. (2016). Multivariate functional random fields: prediction and optimal sampling. Stochastic Environmental Research and Risk Assessment, 31, pages53–70 (2017).
</p>
<p>Bohorquez M.; Giraldo R. and Mateu J. Spatial prediction and optimal sampling of functional data in Geostatistical Functional Data Analysis: Theory and Methods (2021).  John Wiley  Sons, Chichester, UK. ISBN: 978-1-119-38784-8. https://www.wiley.com/en-us/Geostatistical+Functional+Data+Analysis-p-9781119387848.
</p>


<h3>See Also</h3>

<p><code>SpatFD</code>,<code>summary.COKS_pred</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(COKMexico)
SFD_PM10_NO2 &lt;- SpatFD(Mex_PM10, coords = coord_PM10, basis = "Fourier", 
nbasis = 21, lambda = 0.000001, nharm = 2)
SFD_PM10_NO2 &lt;- SpatFD(NO2, coords = coord_NO2, basis = "Fourier", 
nbasis = 27, lambda = 0.000001, nharm = 2,
                      add = SFD_PM10_NO2)
model1 &lt;- gstat::vgm(647677.1,"Gau",23317.05)
model1 &lt;- gstat::vgm(127633,"Wav",9408.63, add.to = model1)
newcoords &lt;- data.frame(x = 509926,y = 2179149)
COKS_scores_lambdas(SFD_PM10_NO2,newcoords,model1)

</code></pre>


</div>