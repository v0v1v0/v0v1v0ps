<div class="container">

<table style="width: 100%;"><tr>
<td>simreccomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>simreccomp</h2>

<h3>Description</h3>

<p>This function allows simulation of time-to-event-data that follow a multistate-model
with recurrent events of one type and a competing event. The baseline hazard for the
cause-specific hazards are here functions of the total/calendar time.
To induce between-subject-heterogeneity a random
effect covariate (frailty term) can be incorporated for the recurrent and the competing event.
Data for the recurrent events of the individual <code class="reqn">i</code> are generated
according to the cause-specific hazards </p>
<p style="text-align: center;"><code class="reqn">\lambda_{0r}(t)* Z_{ri} *exp(\beta_r^t X_i),</code>
</p>

<p>where <code class="reqn">X_i</code> defines the covariate vector and <code class="reqn">\beta_r</code> the regression coefficient vector.
<code class="reqn">\lambda_{0r}(t)</code> denotes the baseline hazard, being a function of the total/calendar
time <code class="reqn">t</code> and
<code class="reqn">Z_{ri}</code> denotes the frailty variables with <code class="reqn">(Z_{ri})_i</code> iid with <code class="reqn">E(Z_{ri})=1</code> and
<code class="reqn">Var(Z_{ri})=\theta_r</code>. The parameter <code class="reqn">\theta_r</code> describes the degree of
between-subject-heterogeneity for the recurrent event.
Analougously the competing event is generated according to the cause-specific hazard conditionally
on the frailty variable and covariates: </p>
<p style="text-align: center;"><code class="reqn">\lambda_{0c}(t)* Z_{ci} *exp(\beta_c^t X_i)</code>
</p>

<p>Data output is in the counting process format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simreccomp(
  N,
  fu.min,
  fu.max,
  cens.prob = 0,
  dist.x = "binomial",
  par.x = 0,
  beta.xr = 0,
  beta.xc = 0,
  dist.zr = "gamma",
  par.zr = 0,
  a = NULL,
  dist.zc = NULL,
  par.zc = NULL,
  dist.rec,
  par.rec,
  dist.comp,
  par.comp,
  pfree = 0,
  dfree = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu.min</code></td>
<td>
<p>Minimum length of follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu.max</code></td>
<td>
<p>Maximum length of follow-up. Individuals length of follow-up is
generated from a uniform distribution on
<code>[fu.min, fu.max]</code>. If <code>fu.min=fu.max</code>, then all individuals have a common
follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.prob</code></td>
<td>
<p>Gives the probability of being censored due to loss to follow-up before
<code>fu.max</code>. For a random set of individuals defined by a B(N,<code>cens.prob</code>)-distribution,
the time to censoring is generated from a uniform
distribution on <code>[0, fu.max]</code>. Default is <code>cens.prob=0</code>, i.e. no censoring
due to loss to follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.x</code></td>
<td>
<p>Distribution of the covariate(s) <code class="reqn">X</code>. If there is more than one covariate,
<code>dist.x</code> must be a vector of distributions with one entry for each covariate. Possible
values are <code>"binomial"</code> and <code>"normal"</code>, default is <code>dist.x="binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.x</code></td>
<td>
<p>Parameters of the covariate distribution(s). For <code>"binomial", par.x</code> is
the probability for <code class="reqn">x=1</code>. For <code>"normal"</code>, <code>par.x=c(</code><code class="reqn">\mu, \sigma</code><code>)</code>
where <code class="reqn">\mu</code> is the mean and <code class="reqn">\sigma</code> is the standard deviation of a normal distribution.
If one of the covariates is defined to be normally distributed, <code>par.x</code> must be a list,
e.g. <code> dist.x &lt;- c("binomial", "normal")</code> and <code>par.x  &lt;- list(0.5, c(1,2))</code>.
Default is <code>par.x=0</code>, i.e. <code class="reqn">x=0</code> for all individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.xr</code></td>
<td>
<p>Regression coefficient(s) for the covariate(s) <code class="reqn">x</code> corresponding to the
recurrent events. If there is more than one covariate,
<code>beta.xr</code> must be a vector of coefficients with one entry for each covariate.
<code>simreccomp</code> generates as many covariates as there are entries in <code>beta.xr</code>. Default is
<code>beta.xr=0</code>, corresponding to no effect of the covariate <code class="reqn">x</code> on the recurrent events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.xc</code></td>
<td>
<p>Regression coefficient(s) for the covariate(s) <code class="reqn">x</code> corresponding to the
competing event. If there is more than one covariate, <code>beta.xc</code>
must be a vector of coefficients with one entry for each covariate. Default is
<code>beta.xc=0</code>, corresponding to no effect of the covariate <code class="reqn">x</code> on the competing event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.zr</code></td>
<td>
<p>Distribution of the frailty variable <code class="reqn">Z_r</code> for the recurent events with <code class="reqn">E(Z_r)=1</code> and
<code class="reqn">Var(Z_r)=\theta_r</code>. Possible values are <code>"gamma"</code> for a Gamma distributed frailty
and <code>"lognormal"</code> for a lognormal distributed frailty.
Default is <code>dist.zr="gamma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.zr</code></td>
<td>
<p>Parameter <code class="reqn">\theta_r</code> for the frailty distribution: this parameter gives
the variance of the frailty variable <code class="reqn">Z_r</code>.
Default is <code>par.zr=0</code>, which causes <code class="reqn">Z_r=1</code>, i.e. no frailty effect for the recurrent events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Alternatively, the frailty distribution for the competing event can be computed through the distribution
of the frailty variable <code class="reqn">Z_r</code> by <code class="reqn">Z_c=Z_r**a</code>.
Default is <code>a=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.zc</code></td>
<td>
<p>Distribution of the frailty variable <code class="reqn">Z_c</code> for the competing event with <code class="reqn">E(Z_c)=1</code> and
<code class="reqn">Var(Z_c)=\theta_c</code>. Possible values are <code>"gamma"</code> for a Gamma distributed frailty
and <code>"lognormal"</code> for a lognormal distributed frailty.
Default is <code>dist.zc=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.zc</code></td>
<td>
<p>Parameter <code class="reqn">\theta_c</code> for the frailty distribution: this parameter gives
the variance of the frailty variable <code class="reqn">Z_c</code>.
Default is <code>par.zc=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.rec</code></td>
<td>
<p>Form of the baseline hazard function for the recurrent events.
Possible values are <code>"weibull"</code> or
<code>"gompertz"</code> or <code>"lognormal"</code> or <code>"step"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.rec</code></td>
<td>
<p>Parameters for the distribution of the recurrent event data.
If <code>dist.rec="weibull"</code> the  hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=\lambda*\nu* t^{\nu - 1},</code>
</p>

<p>where <code class="reqn">\lambda&gt;0</code> is the scale and <code class="reqn">\nu&gt;0</code> is the shape parameter. Then
<code>par.rec=c(</code><code class="reqn">\lambda, \nu</code><code>)</code>. A special case
of this is the exponential distribution for <code class="reqn">\nu=1</code>.
If <code>dist.rec="gompertz"</code>, the hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=\lambda*exp(\alpha t),</code>
</p>

<p>where <code class="reqn">\lambda&gt;0</code> is the scale and <code class="reqn">\alpha\in(-\infty,+\infty)</code> is the shape parameter.
Then <code>par.rec=c(</code><code class="reqn">\lambda, \alpha</code><code>)</code>.
If <code>dist.rec="lognormal"</code>, the hazard function is
</p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=[(1/(\sigma t))*\phi((ln(t)-\mu)/\sigma)]/[\Phi((-ln(t)-\mu)/\sigma)],</code>
</p>

<p>where <code class="reqn">\phi</code> is the probability density function and <code class="reqn">\Phi</code> is the cumulative
distribution function of the standard normal distribution, <code class="reqn">\mu\in(-\infty,+\infty)</code> is a
location parameter and <code class="reqn">\sigma&gt;0</code> is a shape parameter. Then <code>par.rec=c(</code><code class="reqn">\mu,\sigma</code><code>)</code>.
Please note, that specifying <code>dist.rec="lognormal"</code> together with some covariates does not
specify the usual lognormal model (with covariates specified as effects on the parameters of the
lognormal distribution resulting in non-proportional hazards), but only defines the baseline
hazard and incorporates covariate effects using the proportional hazard assumption.
If <code>dist.rec="step"</code> the hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=a, t&lt;=t_1, and \lambda_0(t)=b, t&gt;t_1</code>
</p>
<p>.
Then <code>par.rec=c(</code><code class="reqn">a,b,t_1</code><code>)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.comp</code></td>
<td>
<p>Form of the baseline hazard function for the competing event.
Possible values are <code>"weibull"</code> or
<code>"gompertz"</code> or <code>"lognormal"</code> or <code>"step"</code>       .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.comp</code></td>
<td>
<p>Parameters for the distribution of the competing event data.
For more details see <code>par.rec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfree</code></td>
<td>
<p>Probability that after experiencing an event the individual is not at risk
for experiencing further events for a length of <code>dfree</code> time units.
Default is <code>pfree=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfree</code></td>
<td>
<p>Length of the risk-free interval. Must be in the same time unit as <code>fu.max</code>.
Default is <code>dfree=0</code>, i.e. the individual is continously at risk for experiencing
events until end of follow-up.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output is a data.frame consisting of the columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>An integer number for identification of each individual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>or <code>x.V1, x.V2, ...</code> - depending on the covariate matrix. Contains the
randomly generated value of the covariate(s) <code class="reqn">X</code> for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>Contains the randomly generated value of the frailty variable <code class="reqn">Z_r</code> for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zc</code></td>
<td>
<p>Contains the randomly generated value of the frailty variable <code class="reqn">Z_c</code> for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The start of interval <code>[start, stop]</code>, when the individual
starts to be at risk for a next event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>The time of an event or censoring, i.e. the end of interval <code>[start, stop]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>An indicator of whether an event occured at time <code>stop</code> (<code>status=1</code>),
the individual is censored at time <code>stop</code> (<code>status=0</code>) or the competing event occured at time
<code>stop</code> (<code>status=2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu</code></td>
<td>
<p>Length of follow-up period <code>[0,fu]</code> for each individual.</p>
</td>
</tr>
</table>
<p>For each individual there are as many lines as it experiences events,
plus one line if being censored.
The data format corresponds to the counting process format.
</p>


<h3>Author(s)</h3>

<p>Katharina Ingel, Stella Preussler, Antje Jahn-Eimermacher.
Institute of Medical Biostatistics, Epidemiology and Informatics (IMBEI),
University Medical Center of the Johannes Gutenberg-University Mainz, Germany
</p>


<h3>See Also</h3>

<p>simrec
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example:
### A sample of 10 individuals

N &lt;- 10

### with a binomially distributed covariate and a standard normally distributed covariate
### with regression coefficients of beta.xr=0.3 and beta.xr=0.2, respectively,
### for the recurrent events,
### as well as regression coefficients of beta.xc=0.5 and beta.xc=0.25, respectively,
### for the competing event.

dist.x &lt;- c("binomial", "normal")
par.x &lt;- list(0.5, c(0, 1))
beta.xr &lt;- c(0.3, 0.2)
beta.xc &lt;- c(0.5, 0.25)

### a gamma distributed frailty variable for the recurrent event with variance 0.25
### and for the competing event with variance 0.3,

dist.zr &lt;- "gamma"
par.zr &lt;- 0.25

dist.zc &lt;- "gamma"
par.zc &lt;- 0.3

### alternatively the frailty variable for the competing event can be computed via a:
a &lt;- 0.5

### Furthermore a Weibull-shaped baseline hazard for the recurrent event with shape parameter
### lambda=1 and scale parameter nu=2,

dist.rec &lt;- "weibull"
par.rec &lt;- c(1, 2)

### and a Weibull-shaped baseline hazard for the competing event with shape parameter lambda=1
### and scale parameter nu=2

dist.comp &lt;- "weibull"
par.comp &lt;- c(1, 2)

### Subjects are to be followed for two years with 20% of the subjects
### being censored according to a uniformly distributed censoring time
### within [0,2] (in years).

fu.min &lt;- 2
fu.max &lt;- 2
cens.prob &lt;- 0.2

### After each event a subject is not at risk for experiencing further events
### for a period of 30 days with a probability of 50%.

dfree &lt;- 30 / 365
pfree &lt;- 0.5

simdata1 &lt;- simreccomp(
  N = N, fu.min = fu.min, fu.max = fu.max, cens.prob = cens.prob,
  dist.x = dist.x, par.x = par.x, beta.xr = beta.xr, beta.xc = beta.xc,
  dist.zr = dist.zr, par.zr = par.zr, a = a,
  dist.rec = dist.rec, par.rec = par.rec, dist.comp = dist.comp, par.comp = par.comp,
  pfree = pfree, dfree = dfree
)

simdata2 &lt;- simreccomp(
  N = N, fu.min = fu.min, fu.max = fu.max, cens.prob = cens.prob,
  dist.x = dist.x, par.x = par.x, beta.xr = beta.xr, beta.xc = beta.xc,
  dist.zr = dist.zr, par.zr = par.zr, dist.zc = dist.zc, par.zc = par.zc,
  dist.rec = dist.rec, par.rec = par.rec, dist.comp = dist.comp, par.comp = par.comp,
  pfree = pfree, dfree = dfree
)

simdata1
simdata2
</code></pre>


</div>