<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residual diagnostic plot for a STVAR model</h2>

<h3>Description</h3>

<p><code>diagnostic_plot</code> plots a multivariate residual diagnostic plot
for either autocorrelation, conditional heteroskedasticity, or distribution,
or simply draws the residual time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic_plot(
  stvar,
  type = c("all", "series", "ac", "ch", "dist"),
  resid_type = c("standardized", "raw"),
  maxlag = 12
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stvar</code></td>
<td>
<p>object of class <code>"stvar"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>which type of diagnostic plot should be plotted?
</p>

<ul>
<li>
<p><code>"all"</code> all below sequentially.
</p>
</li>
<li>
<p><code>"series"</code> the residual time series.
</p>
</li>
<li>
<p><code>"ac"</code> the residual autocorrelation and cross-correlation functions.
</p>
</li>
<li>
<p><code>"ch"</code> the squared residual autocorrelation and cross-correlation functions.
</p>
</li>
<li>
<p><code>"dist"</code> the residual histogram with theoretical density (dashed line) and QQ-plots.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid_type</code></td>
<td>
<p>should standardized or raw residuals be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlag</code></td>
<td>
<p>the maximum lag considered in types <code>"ac"</code> and <code>"ch"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Auto- and cross-correlations (types <code>"ac"</code> and <code>"ch"</code>) are calculated with the function
<code>acf</code> from the package <code>stats</code> and the plot method for class <code>'acf'</code> objects is employed.
If <code>cond_dist == "Student"</code>, the estimate of the degrees of freedom parameter is used in theoretical
densities and quantiles.
</p>


<h3>Value</h3>

<p>No return value, called for its side effect of plotting the diagnostic plot.
</p>


<h3>References</h3>


<ul>
<li>
<p> Anderson H., Vahid F. 1998. Testing multiple equation systems for common nonlinear components.
<em>Journal of Econometrics</em>, <strong>84</strong>:1, 1-36.
</p>
</li>
<li>
<p> Kheifets I.L., Saikkonen P.J. 2020. Stationarity and ergodicity of Vector STAR models.
<em>Econometric Reviews</em>, <strong>39</strong>:4, 407-414.
</p>
</li>
<li>
<p> Lanne M., Virolainen S. 2024. A Gaussian smooth transition vector autoregressive model:
An application to the macroeconomic effects of severe weather shocks. Unpublished working
paper, available as arXiv:2403.14216.
</p>
</li>
<li>
<p> Lütkepohl H. 2005. New Introduction to Multiple Time Series Analysis,
<em>Springer</em>.
</p>
</li>
<li>
<p> McElroy T. 2017. Computation of vector ARMA autocovariances.
<em>Statistics and Probability Letters</em>, <strong>124</strong>, 92-96.
</p>
</li>
<li>
<p> Kilian L., Lütkepohl H. 20017. Structural Vector Autoregressive Analysis. 1st edition.
<em>Cambridge University Press</em>, Cambridge.
</p>
</li>
<li>
<p> Tsay R. 1998. Testing and Modeling Multivariate Threshold Models.
<em>Journal of the American Statistical Association</em>, <strong>93</strong>:443, 1188-1202.
</p>
</li>
<li>
<p> Virolainen S. 2024. Identification by non-Gaussianity in structural threshold and
smooth transition vector autoregressive models. Unpublished working
paper, available as arXiv:2404.19707.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>Portmanteau_test</code>, <code>profile_logliks</code>, <code>fitSTVAR</code>, <code>STVAR</code>,
<code>LR_test</code>, <code>Wald_test</code>, <code>Rao_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Gaussian STVAR p=1, M=2 model, with weighted relative stationary densities
# of the regimes as the transition weight function:
theta_122relg &lt;- c(0.734054, 0.225598, 0.705744, 0.187897, 0.259626, -0.000863,
  -0.3124, 0.505251, 0.298483, 0.030096, -0.176925, 0.838898, 0.310863, 0.007512,
  0.018244, 0.949533, -0.016941, 0.121403, 0.573269)
mod122 &lt;- STVAR(data=gdpdef, p=1, M=2, params=theta_122relg)

# Autocorelation function of raw residuals for checking remaining autocorrelation:
diagnostic_plot(mod122, type="ac", resid_type="raw")

# Autocorelation function of squared standardized residuals for checking remaining
# conditional heteroskedasticity:
diagnostic_plot(mod122, type="ch", resid_type="standardized")

# Below, ACF of squared raw residuals, which is not very informative for evaluating
# adequacy to capture conditional heteroskedasticity, since it doesn't take into account
# the time-varying conditional covariance matrix of the model:
diagnostic_plot(mod122, type="ch", resid_type="raw")

# Similarly, below the time series of raw residuals first, and then the
# time series of standardized residuals. The latter is more informative
# for evaluating adequacy:
diagnostic_plot(mod122, type="series", resid_type="raw")
diagnostic_plot(mod122, type="series", resid_type="standardized")

# Also similarly, histogram and Q-Q plots are more informative for standardized
# residuals when evaluating model adequacy:
diagnostic_plot(mod122, type="dist", resid_type="raw") # Bad fit for GDPDEF
diagnostic_plot(mod122, type="dist", resid_type="standardized") # Good fit for GDPDEF

## Linear Gaussian VAR p=1 model:
theta_112 &lt;- c(0.649526, 0.066507, 0.288526, 0.021767, -0.144024, 0.897103,
  0.601786, -0.002945, 0.067224)
mod112 &lt;- STVAR(data=gdpdef, p=1, M=1, params=theta_112)
diagnostic_plot(mod112, resid_type="standardized") # All plots for std. resids
diagnostic_plot(mod112, resid_type="raw") # All plots for raw residuals
</code></pre>


</div>