<div class="container">

<table style="width: 100%;"><tr>
<td>ReadVizgen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read and Load MERFISH Input from Vizgen</h2>

<h3>Description</h3>

<p>Read and load in MERFISH data from Vizgen-formatted files
</p>


<h3>Usage</h3>

<pre><code class="language-R">ReadVizgen(
  data.dir,
  transcripts = NULL,
  spatial = NULL,
  molecules = NULL,
  type = "segmentations",
  mol.type = "microns",
  metadata = NULL,
  filter = NA_character_,
  z = 3L
)

LoadVizgen(data.dir, fov, assay = "Vizgen", z = 3L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.dir</code></td>
<td>
<p>Path to the directory with Vizgen MERFISH files; requires at
least one of the following files present:
</p>

<ul>
<li> <p>“<code>cell_by_gene.csv</code>”: used for reading count matrix
</p>
</li>
<li> <p>“<code>cell_metadata.csv</code>”: used for reading cell spatial
coordinate matrices
</p>
</li>
<li> <p>“<code>detected_transcripts.csv</code>”: used for reading molecule
spatial coordinate matrices
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transcripts</code></td>
<td>
<p>Optional file path for counts matrix; pass <code>NA</code> to
suppress reading counts matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>Optional file path for spatial metadata; pass <code>NA</code> to
suppress reading spatial coordinates. If <code>spatial</code> is provided and
<code>type</code> is “segmentations”, uses <code>dirname(spatial)</code> instead of
<code>data.dir</code> to find HDF5 files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>molecules</code></td>
<td>
<p>Optional file path for molecule coordinates file; pass
<code>NA</code> to suppress reading spatial molecule information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of cell spatial coordinate matrices to read; choose one
or more of:
</p>

<ul>
<li> <p>“segmentations”: cell segmentation vertices; requires
<a href="https://cran.r-project.org/package=hdf5r"><span class="pkg">hdf5r</span></a> to be
installed and requires a directory “<code>cell_boundaries</code>” within
<code>data.dir</code>. Within “<code>cell_boundaries</code>”, there must be
one or more HDF5 file named “<code>feature_data_##.hdf5</code>”
</p>
</li>
<li> <p>“centroids”: cell centroids in micron coordinate space
</p>
</li>
<li> <p>“boxes”: cell box outlines in micron coordinate space
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mol.type</code></td>
<td>
<p>Type of molecule spatial coordinate matrices to read;
choose one or more of:
</p>

<ul>
<li> <p>“pixels”: molecule coordinates in pixel space
</p>
</li>
<li> <p>“microns”: molecule coordinates in micron space
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>Type of available metadata to read;
choose zero or more of:
</p>

<ul>
<li> <p>“volume”: estimated cell volume
</p>
</li>
<li> <p>“fov”: cell's fov
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>A character to filter molecules by, pass <code>NA</code> to skip
molecule filtering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Z-index to load; must be between 0 and 6, inclusive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fov</code></td>
<td>
<p>Name to store FOV as</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name to store expression matrix as</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>ReadVizgen</code>: A list with some combination of the
following values:
</p>

<ul>
<li> <p>“<code>transcripts</code>”: a
sparse matrix with expression data; cells
are columns and features are rows
</p>
</li>
<li> <p>“<code>segmentations</code>”: a data frame with cell polygon outlines in
three columns: “x”, “y”, and “cell”
</p>
</li>
<li> <p>“<code>centroids</code>”: a data frame with cell centroid
coordinates in three columns: “x”, “y”, and “cell”
</p>
</li>
<li> <p>“<code>boxes</code>”: a data frame with cell box outlines in three
columns: “x”, “y”, and “cell”
</p>
</li>
<li> <p>“<code>microns</code>”: a data frame with molecule micron
coordinates in three columns: “x”, “y”, and “gene”
</p>
</li>
<li> <p>“<code>pixels</code>”: a data frame with molecule pixel coordinates
in three columns: “x”, “y”, and “gene”
</p>
</li>
<li> <p>“<code>metadata</code>”: a data frame with the cell-level metadata
requested by <code>metadata</code>
</p>
</li>
</ul>
<p><code>LoadVizgen</code>: A <code>Seurat</code> object
</p>


<h3>Progress Updates with <span class="pkg">progressr</span>
</h3>

<p>This function uses
<a href="https://cran.r-project.org/package=progressr"><span class="pkg">progressr</span></a> to
render status updates and progress bars. To enable progress updates, wrap
the function call in <code>with_progress</code> or run
<code>handlers(global = TRUE)</code> before running
this function. For more details about <span class="pkg">progressr</span>, please read
<a href="https://progressr.futureverse.org/articles/progressr-intro.html"><code>vignette("progressr-intro")</code></a>
</p>


<h3>Parallelization with <span class="pkg">future</span>
</h3>

<p>This function uses
<a href="https://cran.r-project.org/package=future"><span class="pkg">future</span></a> to enable
parallelization. Parallelization strategies can be set using
<code>plan</code>. Common plans include “<code>sequential</code>”
for non-parallelized processing or “<code>multisession</code>” for parallel
evaluation using multiple <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> sessions; for other plans, see the
“Implemented evaluation strategies” section of
<code>?future::plan</code>. For a more thorough introduction
to <span class="pkg">future</span>, see
<a href="https://future.futureverse.org/articles/future-1-overview.html"><code>vignette("future-1-overview")</code></a>
</p>


<h3>Note</h3>

<p>This function requires the
<a href="https://cran.r-project.org/package=data.table"><span class="pkg">data.table</span></a> package
to be installed
</p>


</div>