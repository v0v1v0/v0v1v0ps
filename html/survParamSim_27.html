<div class="container">

<table style="width: 100%;"><tr>
<td>survparamsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of parametric survival model</h2>

<h3>Description</h3>

<p>The main function(s) to generate predicted survival using a model object
generated with <code>survival::survreg()</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">surv_param_sim(
  object,
  newdata,
  n.rep = 1000,
  censor.dur = NULL,
  coef.var = TRUE,
  na.warning = TRUE
)

surv_param_sim_resample(
  object,
  newdata,
  n.rep = 1000,
  censor.dur = NULL,
  n.resample,
  strat.resample = NULL,
  coef.var = TRUE,
  na.warning = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>survreg</code> class object. Currently accept exponential,
lognormal, weibull, loglogistic, and gaussian distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A required data frame for simulation that contain covariates in
the survival model. It is required even if this is the same as the one used
for survival::survreg function.
</p>
<p>It also has to contain columns for survival information. These can be used
in <code>plot_km_pi()</code> and <code>plot_hr_pi()</code> function as
observed data. Survival information can be dummy data, but time need to be
long enough so that simulated KM plot will be long enough for
<code>plot_km_pi()</code> to draw simulated survival curves.
</p>
<p>Subjects with NA for covariates in <code>survreg</code> model will be removed from
the simulation and subsequent plotting of observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep</code></td>
<td>
<p>An integer defining numbers of parametric bootstrap runs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor.dur</code></td>
<td>
<p>A two elements vector specifying duration of events
censoring. Censoring time will be calculated with uniform distribution
between two numbers. No censoring will be applied if NULL is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.var</code></td>
<td>
<p>Boolean specifying whether parametric bootstrap are
performed on survival model coefficients, based on variance-covariance
matrix. If FALSE, prediction interval only reflects inherent variability
from survival events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.warning</code></td>
<td>
<p>Boolean specifying whether warning will be shown if
<code>newdata</code> contain subjects with missing model variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.resample</code></td>
<td>
<p>Number of subjects for resampled simulations.
If <code>strat.resample</code> is provided, this needs to be a vector of the length
equal to the number of categories in the stratification variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strat.resample</code></td>
<td>
<p>String specifying stratification variable for
resampling. Currently only one variable is allowed. If you need more than one,
create a new variable e.g. by <code>base::interaction()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>surv_param_sim()</code> returns simulation using the provided subject
in <code>newdata</code> as it is, while <code>surv_param_sim_resample</code> perform
simulation based on resampled subjects from the dataset. The latter allows
more flexibility in terms of simulating future trials with different number
of subjects.
Note that with <code>surv_param_sim_resample()</code>, there is no
automatic safeguard to ensure certain number of subjects in each subgroup
or treatment groups, which may result in inconsistent number of subjects per
simulation or leads to Cox regression instability due to small N. Consider
using stratified resampling in this case.
</p>
<p>Currently we have not tested whether this function work for a <code>survreg</code> model
with stratification variables.
</p>


<h3>Value</h3>

<p>A <code>survparamsim</code> object that contains the original <code>survreg</code> class
object, newdata, and a data frame for predicted survival profiles with the
following columns:
</p>
<ul>
<li> <p><strong>time</strong>: predicted event or censor time
</p>
</li>
<li> <p><strong>event</strong>: event status, 0=censored, 1=event
</p>
</li>
<li> <p><strong>rep</strong>: ID for parametric bootstrap runs
</p>
</li>
<li> <p><strong>subj</strong>: ID for subjects in newdata (currently
original ID is not retained and subj is sequentially assigned
as 1:nrow(newdata))
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(survival)

fit.lung &lt;- survreg(Surv(time, status) ~ sex + ph.ecog, data = lung)

object &lt;- fit.lung
n.rep  &lt;-  30
newdata &lt;-
  tibble::as_tibble(dplyr::select(lung, time, status, sex, ph.ecog)) %&gt;%
  tidyr::drop_na()
censor.dur &lt;- c(200, 1100)

sim &lt;- surv_param_sim(object, newdata, n.rep, censor.dur)



</code></pre>


</div>