<div class="container">

<table style="width: 100%;"><tr>
<td>spdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel smoothed spatial density of point pattern</h2>

<h3>Description</h3>

<p><code>spdensity</code> computes a kernel smoothed spatial
density function from a point pattern.  This function is
basically a wrapper for <code>density.ppp</code>.
The <code>density.ppp</code> function computes
the spatial intensity of a point pattern; the <code>spdensity</code>
function scales the intensity to produce a true spatial density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spdensity(
  x,
  sigma = NULL,
  ...,
  weights = NULL,
  edge = TRUE,
  varcov = NULL,
  at = "pixels",
  leaveoneout = TRUE,
  adjust = 1,
  diggle = FALSE,
  kernel = "gaussian",
  scalekernel = is.character(kernel),
  positive = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Point pattern (object of class <code>"ppp"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>The smoothing bandwidth (the amount of smoothing).
The standard deviation of the isotropic smoothing kernel.
Either a numerical value, 
or a function that computes an appropriate value of <code>sigma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to <code>pixellate.ppp</code>
and <code>as.mask</code> to determine
the pixel resolution, or passed to <code>sigma</code> if it is a function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional weights to be attached to the points.
A numeric vector, numeric matrix, an <code>expression</code>,
or a pixel image.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>

<p>Logical value indicating whether to apply edge correction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>

<p>Variance-covariance matrix of anisotropic smoothing kernel.
Incompatible with <code>sigma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>

<p>String specifying whether to compute the intensity values
at a grid of pixel locations (<code>at="pixels"</code>) or
only at the points of <code>x</code> (<code>at="points"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaveoneout</code></td>
<td>

<p>Logical value indicating whether to compute a leave-one-out
estimator. Applicable only when <code>at="points"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>

<p>Optional. Adjustment factor for the smoothing parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diggle</code></td>
<td>

<p>Logical. If <code>TRUE</code>, use the Jones-Diggle improved edge correction,
which is more accurate but slower to compute than the default
correction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>The smoothing kernel.
A character string specifying the smoothing kernel
(current options are <code>"gaussian"</code>, <code>"epanechnikov"</code>,
<code>"quartic"</code> or <code>"disc"</code>),
or a pixel image (object of class <code>"im"</code>)
containing values of the kernel, or a <code>function(x,y)</code> which
yields values of the kernel.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalekernel</code></td>
<td>

<p>Logical value.
If <code>scalekernel=TRUE</code>, then the kernel will be rescaled
to the bandwidth determined by <code>sigma</code> and <code>varcov</code>:
this is the default behaviour when <code>kernel</code> is a character string.
If <code>scalekernel=FALSE</code>, then <code>sigma</code> and <code>varcov</code>
will be ignored: this is the default behaviour when <code>kernel</code> is a
function or a pixel image.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>

<p>Logical value indicating whether to force all density values to
be positive numbers. Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to issue warnings
about numerical problems and conditions.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function produces the spatial density of <code>x</code>
as an object of class <code>im</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Waller, L.A. and Gotway, C.A. (2005).  Applied Spatial Statistics for Public Health Data.  Hoboken, NJ: Wiley.
</p>


<h3>See Also</h3>

<p><code>density.ppp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(grave)
contour(spdensity(grave))
</code></pre>


</div>