<div class="container">

<table style="width: 100%;"><tr>
<td>jumpint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals for jumps and confidence bands for step functions</h2>

<h3>Description</h3>

<p>Extract and plot confidence intervals and bands from fits given by a <code>stepfit</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">jumpint(sb, ...)
## S3 method for class 'stepfit'
jumpint(sb, ...)
## S3 method for class 'jumpint'
points(x, pch.left = NA, pch.right = NA, y.left = NA, y.right = NA, xpd = NA, ...)
confband(sb, ...)
## S3 method for class 'stepfit'
confband(sb, ...)
## S3 method for class 'confband'
lines(x, dataspace = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sb</code></td>
<td>
<p>the result of a fit by <code>stepbound</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.left, pch.right</code></td>
<td>
<p>the plotting character to use for the left/right end of the interval with defaults <code>"("</code> and <code>"]"</code> (see parameter <code>pch</code> of <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.left, y.right</code></td>
<td>
<p>at which height to plot the interval boundaries with default <code>par()$usr[3]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpd</code></td>
<td>
<p>see <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataspace</code></td>
<td>
<p><code>logical</code> determining whether the expected value should be plotted instead of the fitted parameter value, useful e.g. for <code>family = "binomial"</code>, where it will plot the fitted success probability times the number of trials per observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to generic methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>jumpint</code> an object of class <code>jumpint</code>, i.e. a <code>data.frame</code> whose columns <code>rightEndLeftBound</code> and <code>rightEndRightBound</code> specify the left and right end of the confidence interval for the block's right end, resp., given the number of blocks was estimated correctly, and similarly columns <code>rightIndexLeftBound</code> and <code>rightIndexRightBound</code> specify the left and right indices of the confidence interval, resp. Function <code>points</code> plots these intervals on the lower horizontal axis (by default).
</p>
<p>For <code>confband</code> an object of class <code>confband</code>, i.e. a <code>data.frame</code> with columns <code>lower</code> and <code>upper</code> specifying a confidence band computed at every point <code>x</code>; this is a simultaneous confidence band assuming the true number of jumps has been determined. Function <code>lines</code> plots the confidence band.
</p>


<h3>Note</h3>

<p>Observe that jumps may occur immediately before or after an observed <code>x</code>; this lack of knowledge is reflected in the visual impressions by the lower and upper envelopes jumping vertically early, so that possible jumps between <code>x</code>s remain within the band, and by the confidence intervals starting immediately after the last <code>x</code> for which there cannot be a jump, cf. the note in the help for <code>stepblock</code>.
</p>


<h3>See Also</h3>

<p><code>stepbound</code>, <code>points</code>, <code>lines</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate Bernoulli data with four blocks
y &lt;- rbinom(200, 1, rep(c(0.1, 0.7, 0.3, 0.9), each=50))
# fit step function
sb &lt;- stepbound(y, family="binomial", param=1, confband=TRUE)
plot(y, pch="|")
lines(sb)
# confidence intervals for jumps
jumpint(sb)
points(jumpint(sb), col="blue")
# confidence band
confband(sb)
lines(confband(sb), lty=2, col="blue")
</code></pre>


</div>