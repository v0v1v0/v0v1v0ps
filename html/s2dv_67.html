<div class="container">

<table style="width: 100%;"><tr>
<td>Regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the regression of an array on another along one dimension.</h2>

<h3>Description</h3>

<p>Compute the regression of the array 'datay' on the array 'datax' along the
'reg_dim' dimension by least square fitting (default) or self-defined model. 
The function provides the slope of the regression, the intercept, and the
associated p-value and confidence interval. The filtered datay from the 
regression onto datax is also provided.<br>
The p-value relies on the F distribution, and the confidence interval relies 
on the student-T distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Regression(
  datay,
  datax,
  reg_dim = "sdate",
  formula = y ~ x,
  pval = TRUE,
  conf = TRUE,
  sign = FALSE,
  alpha = 0.05,
  na.action = na.omit,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datay</code></td>
<td>
<p>An numeric array as predictand including the dimension along
which the regression is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datax</code></td>
<td>
<p>An numeric array as predictor. The dimension should be identical
as parameter 'datay'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_dim</code></td>
<td>
<p>A character string indicating the dimension along which to 
compute the regression. The default value is 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class "formula" (see function <code>link[stats]{lm}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>A logical value indicating whether to retrieve the p-value 
or not. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>A logical value indicating whether to retrieve the confidence 
intervals or not. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>A logical value indicating whether to compute or not the 
statistical significance of the test The default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric of the significance level to be used in the 
statistical significance test. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function or an integer. A function (e.g., na.omit, 
na.exclude, na.fail, na.pass) indicates what should happen when the data 
contain NAs. A numeric indicates the maximum number of NA position (it
counts as long as one of datay and datax is NA) allowed for compute 
regression. The default value is na.omit-</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. Default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$regression</code></td>
<td>

<p>A numeric array with same dimensions as parameter 'datay' and 'datax' except 
the 'reg_dim' dimension, which is replaced by a 'stats' dimension containing 
the regression coefficients from the lowest order (i.e., intercept) to 
the highest degree. The length of the 'stats' dimension should be 
<code>polydeg + 1</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$conf.lower</code></td>
<td>

<p>A numeric array with same dimensions as parameter 'daty' and 'datax' except
the 'reg_dim' dimension, which is replaced by a 'stats' dimension containing 
the lower value of the <code>siglev</code>% confidence interval for all
the regression coefficients with the same order as $regression. The length 
of 'stats' dimension should be <code>polydeg + 1</code>. Only present if 
<code>conf = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$conf.upper</code></td>
<td>

<p>A numeric array with same dimensions as parameter 'daty' and 'datax' except
the 'reg_dim' dimension, which is replaced by a 'stats' dimension containing 
the upper value of the <code>siglev</code>% confidence interval for all
the regression coefficients with the same order as $regression. The length 
of 'stats' dimension should be <code>polydeg + 1</code>. Only present if 
<code>conf = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$p.val</code></td>
<td>

<p>A numeric array with same dimensions as parameter 'daty' and 'datax' except
the 'reg_dim' dimension, The array contains the p-value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>

<p>A logical array of the statistical significance of the regression with the
same dimensions as $regression. Only present if <code>sign = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$filtered</code></td>
<td>

<p>A numeric array with the same dimension as paramter 'datay' and 'datax', 
the filtered datay from the regression onto datax along the 'reg_dim' 
dimension.
</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Load sample data as in Load() example:
example(Load)
datay &lt;- sampleData$mod[, 1, , ]
names(dim(datay)) &lt;- c('sdate', 'ftime')
datax &lt;- sampleData$obs[, 1, , ]
names(dim(datax)) &lt;- c('sdate', 'ftime')
res1 &lt;- Regression(datay, datax, formula = y~poly(x, 2, raw = TRUE))
res2 &lt;- Regression(datay, datax, alpha = 0.1)

</code></pre>


</div>