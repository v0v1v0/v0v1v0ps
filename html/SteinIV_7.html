<div class="container">

<table style="width: 100%;"><tr>
<td>tsls.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Two-Stage Least Squares (TSLS) estimator.</h2>

<h3>Description</h3>

<p>Computes the TSLS estimator for a two-stage structural model, as well
as the set of standard errors for each individual estimator, and
the sample estimate of the asymptotic variance/covariance matrix.</p>


<h3>Usage</h3>

<pre><code class="language-R">  tsls.est(y,X,Z,SE=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric: A vector of observations, representing the outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric: A matrix of observations, whose number of columns
corresponds to the number of predictors in the model, and the number
of rows should be conformal with the number of entries in <code class="reqn">y</code>. This
matrix may contain both endogenous and exogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Numeric: A matrix of observations representing the
intrumental variables (IVs) in the first-stage structural equation. The
number of IVs should be at least as large as the number of
endogenous variables in <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Logical: If TRUE, then the function also returns the
standard errors of the individual TSLS estimator, and a sample
estimate of its asymptotic variance/covariance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The TSLS estimator is applied to a two-stage structural
model. We here adopt the terminology commonly used in
econometrics. See, for example, the references below for Cameron 
and Trivedi (2005), Davidson and MacKinnon (1993), as well as
Wooldridge (2002). The second-stage equation is thus modelled as follows,
</p>
<p style="text-align: center;"><code class="reqn">y = X\beta + \epsilon,</code>
</p>

<p>in which <code class="reqn">y</code> is a vector of <code class="reqn">n</code> observations representing the
outcome variable, <code class="reqn">X</code> is a matrix of order <code class="reqn">n\times k</code>
denoting the predictors of the model, and comprised of both exogenous
and endogenous variables, <code class="reqn">\beta</code> is the <code class="reqn">k</code>-dimensional
vector of parameters of interest; whereas <code class="reqn">\epsilon</code> is an unknown
vector of error terms.
</p>
<p>The first-stage level of the model is given by a multivariate
multiple regression. That is, this is a linear modle with a
<em>multivariate</em> outcome variable, as well as <em>multiple</em>
predictors. This first-stage model is represented in this manner, 
</p>
<p style="text-align: center;"><code class="reqn">X = Z\Gamma + \Delta</code>
</p>
<p>,
where <code class="reqn">X</code> is the matrix of predictors from the second-stage
equation, <code class="reqn">Z</code> is a matrix of instrumental variables (IVs) of order
<code class="reqn">n \times l</code>, <code class="reqn">\Gamma</code> is a matrix of unknown parameters of
order <code class="reqn">l\times k</code>; whereas <code class="reqn">\Delta</code> denotes an unknown matrix of order
<code class="reqn">n\times k</code> of error terms. 
</p>
<p>Whenever certain variables in <code class="reqn">X</code> are assumed to be exogenous,
these variables should be incorporated into 
<code class="reqn">Z</code>. That is, all the exogneous variables are their own
instruments. Moreover, it is also assumed that the model contains at
least as many instruments as predictors, in the sense that <code class="reqn">l\geq
    k</code>, as commonly donein practice (Wooldridge, 2002). Also, the matrices,
<code class="reqn">X^TX</code>, <code class="reqn">Z^TX</code>, and <code class="reqn">Z^TZ</code> are all assumed to be full
rank. Finally, both <code class="reqn">X</code> and <code class="reqn">Z</code> should comprise a column of
one's, representing the intercept in each structural equation. 
</p>
<p>The formula for the TSLS estimator is then obtained in the standard
fashion by the following equation,
</p>
<p style="text-align: center;"><code class="reqn">\hat\beta_{TSLS} := (\hat{X}^T\hat{X})^{-1}(\hat{X}^{T}y),</code>
</p>

<p>where <code class="reqn">\hat{X}:=H_zX</code>, is the orthogonal projection of the matrix
<code class="reqn">X</code>, onto the vector space spanned by the columns of <code class="reqn">Z</code>; and
<code class="reqn">H_{z}:=Z(Z^{T}Z)^{-1}Z^{T}</code> is the hat matrix of the first-stage
multivariate regression.
</p>
<p>When requested by the user, the standard errors of each entry in
<code class="reqn">\hat\beta_{TSLS}</code> are also provided, as a vector. These are
computed by taking the squareroot of the diagonal entries of the sample asymptotic
variance/covariance matrix, which is given by the following equation,
</p>
<p style="text-align: center;"><code class="reqn">\hat\Sigma_{TSLS} := \hat\sigma^{2}(\hat{X}^{T}\hat{X})^{-1},</code>
</p>

<p>in which the sample residual sum of squares is
<code class="reqn">\hat\sigma^{2}:=(y - X\hat\beta_{TSLS})^{T}(y - X\hat\beta_{TSLS})/(n-k)</code>.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>A list with one or three arguments, depending on whether
the user has activated the SE flag. The first element (est) in the list
is the TSLS estimate of the model in vector format. The second
element (se) is the vector of standard errors; and the third
element (var) is the sample estimate of the asymptotic
variance/covariance matrix.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Cedric E. Ginestet &lt;cedric.ginestet@kcl.ac.uk&gt;
</p>


<h3>References</h3>

<p>Cameron, A. and Trivedi, P. (2005). Microeconometrics: Methods and Applications. Cam-
bridge University press, Cambridge.
</p>
<p>Davidson, R. and MacKinnon, J.G. (1993). Estimation and inference in econometrics. OUP
Catalogue.
</p>
<p>Wooldridge, J. (2002). Econometric analysis of cross-section and panel data. MIT press,
London.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Generate a simple example with synthetic data, and no intercept. 
n &lt;- 100; k &lt;- 3; l &lt;- 3;
Ga&lt;- diag(rep(1,l)); be &lt;- rep(1,k);
Z &lt;- matrix(0,n,l); for(j in 1:l) Z[,j] &lt;- rnorm(n); 
X &lt;- matrix(0,n,k); for(j in 1:k) X[,j] &lt;- Z[,j]*Ga[j,j] + rnorm(n); 
y &lt;- X%*%be + rnorm(n);

### Compute TSLS estimator with SEs and variance/covariance matrix.
print(tsls.est(y,X,Z));
print(tsls.est(y,X,Z,SE=TRUE));

</code></pre>


</div>