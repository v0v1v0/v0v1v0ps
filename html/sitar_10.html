<div class="container">

<table style="width: 100%;"><tr>
<td>cLMS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LMS conversion to and from z-scores</h2>

<h3>Description</h3>

<p>Routines to handle references constructed with the LMS method. Given a set
of LMS values, the functions convert z-scores to measurement centiles and
vice versa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cLMS(z, L = 1, M, S)

zLMS(x, L = 1, M, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>vector or one-column matrix of z-scores to be converted to measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>vector of Box-Cox transformation (lambda) values, L in the LMS
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>vector of medians (mu), M in the LMS method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>vector of coefficients of variation (sigma), S in the LMS method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or one-column matrix of measurements to be converted to z-scores.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>L, M and S – and if vectors then <code>x</code> and <code>z</code> –
should all be the same length, recycled if necessary.
The formulae converting <code>x</code> to <code>z</code> and vice versa are:
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(x/M)^L - 1}{L S}</code>
</p>

<p style="text-align: center;"><code class="reqn">x = M (1 + L S z)^{1/L})</code>
</p>
<p> where L is reset
to 10^-7 if it is zero. The LMS method is the same as the BCCG
family in the <code>gamlss</code> package, except that lambda in LMS is referred
to as nu in BCCG.
</p>


<h3>Value</h3>

<p>If <code>x</code> and <code>z</code> are vectors <code>zLMS</code> and <code>cLMS</code>
each return a vector, respectively of z-scores and measurement centiles, with length
matching the length of (the longest of) <code>x</code> or <code>z</code>, L, M and S.
If <code>x</code> or <code>z</code> are matrices <code>zLMS</code> and <code>cLMS</code> each return a matrix,
the number of rows matching the length of (the longest of) L, M and S,
and the number of columns matching the length of <code>x</code> or <code>z</code>.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>z2cent</code>, <code>LMS2z</code>, <code>pdLMS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
cLMS(z = as.matrix(-2:2), L = 1:-1, M = 5:7, S = rep(0.1, 3))
cLMS(z = 0:2, L = 1:-1, M = 7, S = 0.1)
cLMS(z = as.matrix(0:2), L = 1:-1, M = 7, S = 0.1)
zLMS(x = 6.5, L = 1:-1, M = 5:7, S = rep(0.1, 3))

</code></pre>


</div>