<div class="container">

<table style="width: 100%;"><tr>
<td>scapeForSeurat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cytokine activity scores for a Seurat matrix.</h2>

<h3>Description</h3>

<p>Computes cell-level estimates of cytokine activity for a scRNA-seq Seurat
count matrix using the scapeForSeurat method. SCAPE activity estimates are computed by scoring weighted gene
sets from the CytoSig or Reactome databases using the Variance-adjusted Mahalanobis (VAM) method
as implemented in the <code>VAM::vamForSeurat()</code> function. Individual gene sets for subsequent scoring can be reconstructed using
the <code>genesetCytoSig</code> and the <code>genesetReactome</code> functions
for the CytoSig and the Reactome database, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scapeForSeurat(
  seurat.object,
  database = "cytosig",
  cytokine = "all",
  normalize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seurat.object</code></td>
<td>
<p>Seurat counts matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database</code></td>
<td>
<p>Database used for gene set construction and set scoring.
</p>

<ul>
<li>
<p> "cytosig" (default) performs scoring for up to 41 cytokines using the CytoSig database.
</p>
</li>
<li>
<p> "reactome" performs scoring for up to 30 cytokines using the Reactome database.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cytokine</code></td>
<td>
<p>Vector of cytokine names to score for activity. The default value of "all"
will score all 41 cytokines supported by CytoSig or 31 supported by Reactome. Please see
function <code>supportedCytokines</code> to view all the CytoSig or the Reactome
specific scored cytokines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Boolean indicator for whether normalization should be performed before performing gene set scoring.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Seurat object consisting of cell-level cytokine activity scores returned as a separate assay (scape for scoring via the CytoSig database and VAMcdf for scoring via the Reactome database).
</p>


<h3>See Also</h3>

<p><code>genesetCytoSig</code>, <code>genesetReactome</code>, <code>scape</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SeuratObject)
CytoSig.score.output.all &lt;- scapeForSeurat(seurat.object = pbmc_small, 
database = "cytosig", cytokine = "all", normalize=TRUE)
(as.data.frame(CytoSig.score.output.all@assays$scape@data))[1:6,1:3]
CytoSig.score.output.specific &lt;- scapeForSeurat(seurat.object = pbmc_small, 
database = "cytosig", cytokine = c("IL4", "IL13"), normalize=TRUE)
(as.data.frame(CytoSig.score.output.specific@assays$scape@data))[,1:3]

</code></pre>


</div>