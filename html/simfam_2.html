<div class="container">

<table style="width: 100%;"><tr>
<td>admix_fam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate admixture matrix of a pedigree with known admixture of founders</h2>

<h3>Description</h3>

<p>Calculates a full admixture proportions matrix (for all individuals in the provided pedigree FAM table) starting from the admixture proportions of the founders as provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">admix_fam(admix, fam, missing_vals = c("", 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>admix</code></td>
<td>
<p>The admixture proportions matrix of the founders (individuals along rows and ancestries along columns).
This matrix must have row names that identify each founder (matching codes in <code>fam$id</code>).
Individuals may be in a different order than <code>fam$id</code>.
Extra individuals in <code>admix</code> but absent in <code>fam$id</code> will be silently ignored.
All values should be non-negative and each row of <code>admix</code> should sum to one; for speed, this code does not check that <code>admix</code> is valid, just averages data as-is.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>The pedigree data.frame, in plink FAM format.
Only columns <code>id</code>, <code>pat</code>, and <code>mat</code> are required.
<code>id</code> must be unique and non-missing.
Founders must be present, and their <code>pat</code> and <code>mat</code> values must be missing (see below).
Non-founders must have both their parents be non-missing.
Parents must appear earlier than their children in the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_vals</code></td>
<td>
<p>The list of ID values treated as missing.
<code>NA</code> is always treated as missing.
By default, the empty string (‚Äù) and zero (0) are also treated as missing (remove values from here if this is a problem).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The admixture proportions matrix of the entire <code>fam</code> table, based on the admixture of the founders.
These are expectations, calculated for each individual as the average ancestry proportion of the parents.
The rows of this admixture matrix correspond to <code>fam$id</code> in that order.
The columns (ancestries) are the same as in the input <code>admix</code>.
</p>


<h3>See Also</h3>

<p>Plink FAM format reference:
<a href="https://www.cog-genomics.org/plink/1.9/formats#fam">https://www.cog-genomics.org/plink/1.9/formats#fam</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The smallest pedigree, two parents and a child.
# A minimal fam table with the three required columns.
# Note "mother" and "father" have missing parent IDs, while "child" does not
library(tibble)
fam &lt;- tibble(
  id = c('father', 'mother', 'child'),
  pat = c(NA, NA, 'father'),
  mat = c(NA, NA, 'mother')
)

# admixture proportions of the parents
admix &lt;- rbind( c(0.3, 0.3, 0.4), c(0.5, 0.25, 0.25) )
# Name the parents with same codes as in `fam`
# (order can be different)
rownames( admix ) &lt;- c('mother', 'father')
# name ancestries too
colnames( admix ) &lt;- c('African', 'European', 'Asian')

# Calculate the full admixture proportions matrix
admix_all &lt;- admix_fam( admix, fam )

# This is a 3x3 matrix with row names matching fam$id.
# The parent submatrix equals the input (reordered),
# but now there's admixture to the child too (averages of parents)
admix_all

</code></pre>


</div>