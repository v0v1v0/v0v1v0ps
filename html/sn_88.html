<div class="container">

<table style="width: 100%;"><tr>
<td>dmsn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate skew-normal distribution</h2>

<h3>Description</h3>

<p>Probability density function, distribution function and random number 
generation for the multivariate skew-normal (<abbr><span class="acronym">SN</span></abbr>) distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmsn(x, xi=rep(0,length(alpha)), Omega, alpha, tau=0, dp=NULL, log=FALSE)
pmsn(x, xi=rep(0,length(alpha)), Omega, alpha,  tau=0, dp=NULL, ...)
rmsn(n=1, xi=rep(0,length(alpha)), Omega, alpha,  tau=0, dp=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a vector of length <code>d</code>, 
where <code>d=length(alpha)</code>, or a matrix with <code>d</code> columns, 
giving the coordinates of the point(s) where the density or the
distribution function must be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>a numeric vector of length <code>d</code> representing the 
location parameter of the distribution; see ‘Background’.
In a call to <code>dmsn</code> and <code>pmsn</code>, <code>xi</code> can be a matrix,
whose rows represent a set of location parameters;
in this case, its dimensions must match those of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>a symmetric positive-definite matrix of dimension <code>(d,d)</code>;
see ‘Background’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector which regulates the slant of the density; 
see ‘Background’. <code>Inf</code> values in <code>alpha</code> are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a single value representing the ‘hidden mean’ parameter 
of the <abbr><span class="acronym">ESN</span></abbr> distribution; <code>tau=0</code> (default) corresponds to 
a <abbr><span class="acronym">SN</span></abbr> distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>

<p>a list with three elements, corresponding to <code>xi</code>, <code>Omega</code> and 
<code>alpha</code> described above; default value <code>FALSE</code>. 
If <code>dp</code> is assigned, individual parameters must not be specified. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a numeric value which represents the number of random vectors
to be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical (default value: <code>FALSE</code>); 
if <code>TRUE</code>, log-densities are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to <code>pmnorm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Typical usages are
</p>
<pre>
dmsn(x, xi=rep(0,length(alpha)), Omega, alpha, log=FALSE)
dmsn(x, dp=, log=FALSE)
pmsn(x, xi=rep(0,length(alpha)), Omega, alpha, ...)
pmsn(x, dp=)
rmsn(n=1, xi=rep(0,length(alpha)), Omega, alpha)
rmsn(n=1, dp=)
</pre>
<p>For efficiency reasons, <code>rmsn</code> makes very limited checks on the 
validity of the arguments. For instance, failure to positive definiteness 
of <code>Omega</code> would not be detected, and an uncontrolled crash occurs. 
Function <code>pmsn</code> makes use of <code>pmnorm</code> from package <span class="pkg">mnormt</span>;
the accuracy of its computation can be controlled via <code>...</code>
</p>


<h3>Value</h3>

<p>A vector of density values (<code>dmsn</code>) or of probabilities
(<code>pmsn</code>) or a matrix of random  points (<code>rmsn</code>).
</p>


<h3>Background</h3>

<p>The multivariate skew-normal distribution is discussed by Azzalini and 
Dalla Valle (1996). The <code>(Omega,alpha)</code>
parametrization adopted here is the one of Azzalini and Capitanio (1999).
Chapter 5 of Azzalini and Capitanio (2014) provides an extensive account,
including subsequent developments.
</p>
<p>Notice that the location vector <code>xi</code> does not represent the mean vector 
of the distribution. Similarly, <code>Omega</code> is not <em>the</em> covariance 
matrix of the distribution, although it is <em>a</em> covariance matrix. 
Finally, the components of <code>alpha</code> are not equal to the slant parameters 
of the marginal  distributions; to fix the marginal parameters at prescribed 
values, it is convenient to start from the OP parameterization, as illustrated 
in the ‘Examples’ below. Another option is to start from the <abbr><span class="acronym">CP</span></abbr>
parameterization, but notice that, at variance from the <abbr><span class="acronym">OP</span></abbr>, not all
<abbr><span class="acronym">CP</span></abbr> sets are invertible to lend a <abbr><span class="acronym">DP</span></abbr> set.</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (1999).
Statistical applications of the multivariate skew normal distribution.
<em>J.Roy.Statist.Soc. B</em> <b>61</b>, 579–602. Full-length version 
available at <a href="https://arXiv.org/abs/0911.2093">https://arXiv.org/abs/0911.2093</a>
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>
<p>Azzalini, A. and Dalla Valle, A. (1996).
The multivariate skew-normal distribution.
<em>Biometrika</em> <b>83</b>, 715–726.
</p>


<h3>See Also</h3>

<p><code>dsn</code>,  <code>dmst</code>,  <code>pmnorm</code>,
<code>op2dp</code>,  <code>cp2dp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- seq(-3,3,length=15)
xi &lt;- c(0.5, -1)
Omega &lt;- diag(2)
Omega[2,1] &lt;- Omega[1,2] &lt;- 0.5
alpha &lt;- c(2,-6)
pdf &lt;- dmsn(cbind(x, 2*x-1), xi, Omega, alpha)
cdf &lt;- pmsn(cbind(x, 2*x-1), xi, Omega, alpha)
p1 &lt;- pmsn(c(2,1), xi, Omega, alpha)
p2 &lt;- pmsn(c(2,1), xi, Omega, alpha, abseps=1e-12, maxpts=10000)
#
rnd &lt;- rmsn(10, xi, Omega, alpha)
#
# use OP parameters to fix marginal shapes at given lambda values:
op &lt;- list(xi=c(0,1), Psi=matrix(c(2,2,2,3), 2, 2), lambda=c(5, -2))
rnd &lt;- rmsn(10, dp=op2dp(op,"SN"))
# 
# use CP parameters to fix mean vector, variance matrix and marginal skewness:
cp &lt;- list(mean=c(0,0), var.cov=matrix(c(3,2,2,3)/3, 2, 2), gamma1=c(0.8, 0.4))
dp &lt;- cp2dp(cp, "SN")
rnd &lt;- rmsn(5, dp=dp)
</code></pre>


</div>