<div class="container">

<table style="width: 100%;"><tr>
<td>SC.MEB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SC.MEB.</h2>

<h3>Description</h3>

<p>SC.MEB implements the model SC-MEB, spatial clustering with hidden Markov random field using empirical Bayes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SC.MEB(
  y,
  Adj_sp,
  beta_grid = seq(0, 4, 0.2),
  K_set = 2:10,
  parallel = TRUE,
  num_core = 5,
  PX = TRUE,
  maxIter_ICM = 10,
  maxIter = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is n-by-d PCs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adj_sp</code></td>
<td>
<p>is a sparse matrix of neighborhood. It is often generated from function find_neighbors2 or getneighborhood_fast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_grid</code></td>
<td>
<p>is a numeric vector specifying the smoothness parameter of Random Markov Field. The default is seq(0,4,0.2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_set</code></td>
<td>
<p>is an integer vector specifying the numbers of mixture components (clusters) for which the BIC is to be calculated. The default is K = 2:10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>is a logical value to decide whether the function SC.MEB run in parallel. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_core</code></td>
<td>
<p>is an integer value to decide how many cores are used to run SC.MEB in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PX</code></td>
<td>
<p>is a logical value to decide whether to use parameter expansion in EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter_ICM</code></td>
<td>
<p>is the maximum iteration of ICM algorithm. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>is the maximum iteration of EM algorithm. The default is 50.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SC.MEB can implements the model SC-MEB in parallel which can improve the speed of the computation.
</p>


<h3>Value</h3>

<p>a list, We briefly explain the output of the SC.MEB. 
</p>
<p>The item 'x' contains clustering results.
</p>
<p>The item 'gam' is the posterior probability matrix.
</p>
<p>The item 'ell' is the opposite log-likelihood. 
</p>
<p>The item 'mu' is the mean of each component.
</p>
<p>The item 'sigma' is the variance of each component.
</p>


<h3>References</h3>

<p>Yang Y, Shi X, Zhou Q, et al. SC-MEB: spatial clustering with hidden Markov random field using empirical Bayes[J]. bioRxiv, 2021.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y = matrix(rnorm(50, 0, 1), 25,2)
pos = cbind(rep(1:5, each=5), rep(1:5, 5))
Adj_sp = getneighborhood_fast(pos, 1.2)
beta_grid = c(0.5,1)
K_set = 2:3
out = SC.MEB(y, Adj_sp, beta_grid, K_set, TRUE, 2)
</code></pre>


</div>