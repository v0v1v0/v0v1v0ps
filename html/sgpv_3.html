<div class="container">

<table style="width: 100%;"><tr>
<td>plotman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Second-Generation p-Value Plotting</h2>

<h3>Description</h3>

<p>This function displays a modified Manhattan-style plot colored according to second-generation p-value status. There are several variations of this plot that can be made depending upon user input for <code>type</code> as well as the <code>set.order</code> and <code>x.show</code> options. These plots allow the user to visualize the overall result of a large-scale analysis succintly and to visually assess the differences in the results using second-generation p-value techniques as opposed to classical p-value techniques.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotman(
  est.lo,
  est.hi,
  null.lo,
  null.hi,
  set.order = NA,
  x.show = NA,
  type = "delta-gap",
  p.values = NA,
  ref.lines = NA,
  null.pt = NA,
  int.col = c("cornflowerblue", "firebrick3", "darkslateblue"),
  int.pch = 16,
  int.cex = 0.4,
  title.lab = NA,
  x.lab = "Position (by set.order)",
  y.lab = "Outcome label",
  legend.on = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est.lo</code></td>
<td>
<p>A numeric vector of lower bounds of interval estimates. Must be of same length as <code>est.hi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.hi</code></td>
<td>
<p>A numeric vector of upper bounds of interval estimates.  Must be of same length as <code>est.lo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.lo</code></td>
<td>
<p>A scalar representing the lower bound of the null interval hypothesis (indifference zone). Value must be finite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.hi</code></td>
<td>
<p>A scalar representing the upper bound of the null interval hypothesis (indifference zone). Value must be finite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.order</code></td>
<td>
<p>A numeric vector giving the desired order along the x-axis. Alternatively, if <code>set.order</code> is set to <code>"sgpv"</code>, the second-generation <em>p</em>-value ranking is used. The default option is <code>NA</code>, which uses the original input ordering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.show</code></td>
<td>
<p>A numeric scalar representing the maximum ranking on the x-axis that is displayed. Default is to display all rankings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string specifying the desired Manhattan-style plot to be graphed. This argument specifies the variable on the y-axis. If <code>type = "delta-gap"</code>, the delta-gaps are ranked. If <code>type = "p-value"</code>, the classic p-values are ranked. If <code>type = "comparison"</code>, the classic p-values are ranked by SGPV. Default is <code>type = "delta-gap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p>A numeric vector giving the classic <em>p</em>-values. This is required when <code>type = "p-value"</code> or <code>type = "comparison"</code>, and is not required when <code>type = "delta-gap"</code>. The <code>p.values</code> input may be any desired transformation of the p-values. For example, if the desired transformation is <code class="reqn">-log10(p-value)</code> as in a traditional Manhattan plot, the <code class="reqn">-log10(p-values)</code> should be provided for <code>p.values</code>. The corresponding x or y axis label(s) should be updated to reflect any transformations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.lines</code></td>
<td>
<p>A numeric scalar or vector giving the points on the y-axis at which to add a horizontal reference line. For example, if <code>p.values</code> is set to <code class="reqn">-log10(p-values)</code> and the type of plot selected shows the (transformed) p-values on the y-axis, possible locations for the reference lines could be at the <code class="reqn">-log10(0.05)</code>, <code class="reqn">-log10(Bonferroni)</code> and <code class="reqn">-log10(FDR)</code> significance levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.pt</code></td>
<td>
<p>An optional numeric scalar representing a point null hypothesis. Default is <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.col</code></td>
<td>
<p>Vector of length three specifing the colors of the points according to SGPV result. The first color option corresponds to the <code class="reqn">SGPV = 0</code> results, the second color option corresponds to the <code class="reqn">0 &lt; SGPV &lt; 1</code> results, and the third color option corresponds to the <code class="reqn">SGPV = 1</code> results. Default is <code>int.col = c("cornflowerblue","firebrick3","darkslateblue")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.pch</code></td>
<td>
<p>Plotting symbol for points. Default is <code>16</code> for small points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.cex</code></td>
<td>
<p>Size of plotting symbol for points. Default is <code>0.4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.lab</code></td>
<td>
<p>Title text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lab</code></td>
<td>
<p>A title for the x-axis. Default is the generic <code>"Position (by set.order)"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.lab</code></td>
<td>
<p>A title for the y-axis. Default is the generic <code>"Outcome label"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.on</code></td>
<td>
<p>Toggle for plotting the legend. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use <code>set.order</code> to provide the classical p-value ranking. For example, if <code>pvalue.vector</code> is a vector of classical p-values, then set <code>set.order=order(pvalue.vector)</code> to sort the x-axis according to p-value rank.
</p>
<p>Use <code>type</code> and <code>p.values</code> to provide the <code class="reqn">-log10(p-values)</code> for the y-axis. For example, if <code>pvalue.vector</code> is a vector of classical p-values, then set <code>type="p-value"</code> (or <code>type="comparison"</code>) and <code>p.values=-log10(pvalue.vector)</code> to set the y-axis. Then, set the y-axis title to something like <code>y.lab="-log10(p)"</code>.
</p>


<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code>sgpvalue, plotsgpv, sgpower, plotsgpower</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

#  Use leukstats data
data(leukstats)

# ID number on the x-axis, delta-gap on the y-axis, using an interval null hypothesis of
# (-0.3, 0.3) for the log mean difference in expression levels (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order=NA,
       type="delta-gap",
       ref.lines=NA,
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab="Delta-gap",
       x.lab="Position (ID)",
       legend.on=TRUE)

# ID number on the x-axis, -log10(classical p-value) on the y-axis, using an interval
# null hypothesis of (-0.3, 0.3) for the log mean difference in expression levels
# (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order=NA,
       type="p-value",
       p.values=-log10(leukstats$p.value),
       ref.lines=-log10(0.05),
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab=expression("-log"[10]*"(p-value)"),
       x.lab="Position (ID)",
       legend.on=TRUE)

# Second-generation p-value (SGPV) on the x-axis, -log10(classical p-value) on the
# y-axis, using an interval null hypothesis of (-0.3, 0.3) for the log mean difference
# in expression levels (fold change).
plotman(est.lo=leukstats$ci.lo, est.hi=leukstats$ci.hi,
       null.lo=-0.3, null.hi=0.3,
       set.order="sgpv",
       type="comparison",
       p.values=-log10(leukstats$p.value),
       ref.lines=c(-log10(0.05), -log10(0.001)),
       int.pch=16, int.cex=0.4,
       title.lab="Leukemia Example",
       y.lab=expression("-log"[10]*"(p-value)"),
       x.lab="Second-generation p-value ranking",
       legend.on=TRUE)

</code></pre>


</div>