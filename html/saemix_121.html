<div class="container">

<table style="width: 100%;"><tr>
<td>plot,SaemixObject,ANY-method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General plot function from SAEM</h2>

<h3>Description</h3>

<p>Several plots (selectable by the type argument) are currently available:
convergence plot, individual plots, predictions versus observations,
distribution plots, VPC, residual plots, mirror.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'SaemixObject,ANY'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object returned by the <code>saemix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>empty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the plots</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the generic plot function for an SaemixObject object, which
implements different graphs related to the algorithm (convergence plots,
likelihood estimation) as well as diagnostic graphs. A description is
provided in the PDF documentation. Arguments such as main, xlab, etc... that
can be given to the generic plot function may be used, and will be
interpreted according to the type of plot that is to be drawn.
</p>
<p>A special argument plot.type can be set to determine the type of plot; it
can be one of:
</p>

<dl>
<dt>data:</dt>
<dd>
<p>A spaghetti plot of the data,displaying the observed data y
as a function of the regression variable (time for a PK application)</p>
</dd>
<dt>convergence:</dt>
<dd>
<p>For each parameter in the model, this plot shows the
evolution of the parameter estimate versus the iteration number</p>
</dd>
<dt>likelihood:</dt>
<dd>
<p>Graph showing the evolution of the
log-likelihood during the estimation by importance sampling</p>
</dd>
<dt>observations.vs.predictions:</dt>
<dd>
<p>Plot of the predictions computed with
the population parameters versus the observations (left), and plot of the
predictions computed with the individual parameters versus the observations (right)</p>
</dd>
<dt>residuals.scatter:</dt>
<dd>
<p>Scatterplot of the residuals versus the
predictor (top) and versus predictions (bottom), for weighted residuals
(population residuals, left), individual weighted residuals (middle) and npde (right).</p>
</dd>
<dt>residuals.distribution:</dt>
<dd>
<p>Distribution of the residuals,
plotted as histogram (top) and as a QQ-plot (bottom), for weighted residuals
(population residuals, left), individual weighted residuals (middle) and npde (right).</p>
</dd>
<dt>individual.fit:</dt>
<dd>
<p>Individual fits are obtained using the
individual parameters with the individual covariates</p>
</dd>
<dt>population.fit:</dt>
<dd>
<p>Population fits are obtained using the population
parameters with the individual covariates</p>
</dd>
<dt>both.fit:</dt>
<dd>
<p>Individual fits, superposing fits obtained using the population
parameters with the individual covariates (red) and using the individual parameters
with the individual covariates (green)</p>
</dd>
<dt>mirror:</dt>
<dd>
<p>Mirror plots assessing the compatibility of simulated data compared to the original</p>
</dd>
<dt>marginal.distribution:</dt>
<dd>
<p>Distribution of
the parameters (conditional on covariates when some are included in the
model). A histogram of individual parameter estimates can be overlayed on
the plot, but it should be noted that the histogram does not make sense when
there are covariates influencing the parameters and a warning will be
displayed</p>
</dd>
<dt>random.effects:</dt>
<dd>
<p>Boxplot of the random effects</p>
</dd>
<dt>correlations:</dt>
<dd>
<p>Correlation between the random effects</p>
</dd>
<dt>parameters.vs.covariates:</dt>
<dd>
<p>Plots of the estimates of the individual
parameters versus the covariates, using scatterplot for continuous
covariates, boxplot for categorical covariates</p>
</dd>
<dt>randeff.vs.covariates:</dt>
<dd>
<p>Plots of the estimates of the random effects
versus the covariates, using scatterplot for continuous covariates, boxplot
for categorical covariates</p>
</dd>
<dt>npde:</dt>
<dd>
<p>Plots 4 graphs to evaluate the shape of the distribution of the
normalised prediction distribution errors (npde)</p>
</dd>
<dt>vpc:</dt>
<dd>
<p>Visual Predictive Check, with options to include the
prediction intervals around the boundaries of the selected interval as well
as around the median (50th percentile of the simulated data).</p>
</dd>
</dl>
<p>In addition, the following values for plot.type produce a series of plots:
</p>

<dl>
<dt>reduced:</dt>
<dd>
<p> produces the following plots: plot of the data,
convergence plots, plot of the likelihood by importance sampling (if
computed), plots of observations versus predictions. This is the default
behaviour of the plot function applied to an SaemixObject object</p>
</dd>
<dt>full:</dt>
<dd>
<p> produces the following plots: plot of the data, convergence
plots, plot of the likelihood by importance sampling (if computed), plots of
observations versus predictions, scatterplots and distribution of residuals,
VPC, npde, boxplot of the random effects, distribution of the parameters,
correlations between random effects, plots of the relationships between
individually estimated parameters and covariates, plots of the relationships
between individually estimated random effects and covariates</p>
</dd>
</dl>
<p>Each plot can be customised by modifying options, either through a list of
options set by the <code>saemix.plot.setoptions</code> function, or on the
fly by passing an option in the call to the plot (see examples).

</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixObject</code>,<code>saemix</code>,
<code>saemix.plot.setoptions</code>, <code>saemix.plot.select</code>,
<code>saemix.plot.data</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA, 
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

saemix.options&lt;-list(seed=632545,save=FALSE,save.graphs=FALSE)

# Not run (strict time constraints for CRAN)
# saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)

# Set of default plots
# plot(saemix.fit)

# Data
# plot(saemix.fit,plot.type="data")

# Convergence
# plot(saemix.fit,plot.type="convergence")

# Individual plot for subject 1, smoothed
# plot(saemix.fit,plot.type="individual.fit",ilist=1,smooth=TRUE)

# Individual plot for subject 1 to 12, with ask set to TRUE 
# (the system will pause before a new graph is produced)
# plot(saemix.fit,plot.type="individual.fit",ilist=c(1:12),ask=TRUE)

# Diagnostic plot: observations versus population predictions
# par(mfrow=c(1,1))
# plot(saemix.fit,plot.type="observations.vs.predictions",level=0,new=FALSE)

# LL by Importance Sampling
# plot(saemix.fit,plot.type="likelihood")

# Scatter plot of residuals
# Data will be simulated to compute weighted residuals and npde
# the results shall be silently added to the object saemix.fit
# plot(saemix.fit,plot.type="residuals.scatter")

# Boxplot of random effects
# plot(saemix.fit,plot.type="random.effects")

# Relationships between parameters and covariates
# plot(saemix.fit,plot.type="parameters.vs.covariates")

# Relationships between parameters and covariates, on the same page
# par(mfrow=c(3,2))
# plot(saemix.fit,plot.type="parameters.vs.covariates",new=FALSE)

# VPC
# Not run (time constraints for CRAN)
# plot(saemix.fit,plot.type="vpc")

</code></pre>


</div>