<div class="container">

<table style="width: 100%;"><tr>
<td>sel.edit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Influential Error Detection
</h2>

<h3>Description</h3>

<p>Computes the score function and identifies influential errors
</p>


<h3>Usage</h3>

<pre><code class="language-R">       sel.edit (y, ypred, wgt=rep(1,nrow(as.matrix(y ))), 
                 tot=colSums(ypred * wgt), t.sel=0.01) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix or data frame containing the response variables 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypred</code></td>
<td>

<p>matrix of predicted values for y variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgt</code></td>
<td>

<p>optional vector of sampling weights (default=1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tot</code></td>
<td>

<p>optional vector containing reference estimates of totals for the y variables. 
If omitted, it is computed as the (possibly weighted) sum of predicted values 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.sel</code></td>
<td>

<p>optional vector of threshold values, one for each variable, for selective editing (default=0.01)   
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function ranks observations (<code>rank</code>) according to the importance of their potential errors. 
The order is made with respect to the global score function values (<code>global.score</code>).  
The function also selects the units to be edited (<code>sel</code>) so that the expected residual error of
all variables is below a prefixed level of accuracy (<code>t.sel</code>). 
The global score (<code>global.score</code>)  is the maximum of the local scores computed for each variable 
(<code>y1.score, y2.score,...</code>). 
The local scores are defined as a weighted (<code>weights</code>) absolute difference between the observed 
(<code>y1, y2,...</code>) and the predicted values (<code>y1.p, y2.p,...</code>) standardised with respect to 
the reference total estimates (<code>tot</code>).<br></p>
<p>The selection of the units to be edited because affected by an influential error (<code>sel=1</code>) is 
made according to a two-step algorithm:<br>
1) order the observations with respect to the <code>global.score</code> (decreasing order);<br>
2) select the first k units such that, from the (k+1)th to the last observation, all the 
residual errors (<code>y1.reserr, y2.reserr,...</code>) for each variable are below <code>t.sel</code>.<br><br>
The function provides also an indicator function (<code>y1.sel, y2.sel,...</code>) reporting 
which variables contain an influential errors in a unit selected for the revision. 
</p>


<h3>Value</h3>

<p><code>sel.edit</code> returns a data matrix containing the following columns:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>y1, y2,...</code></td>
<td>
<p>observed variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.p, y2.p,...</code></td>
<td>
<p>predictions of y variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>sampling weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.score, y2.score,...</code></td>
<td>
<p>local scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global.score</code></td>
<td>
<p>global score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.reserr, y2.reserr,...</code></td>
<td>
<p>residual errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.sel, y2.sel,...</code></td>
<td>
<p>influential error flags</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>rank according to global score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel</code></td>
<td>
<p>1 if the observation contains an influential error, 0 otherwise</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Di Zio, M., Guarnera, U. (2013) <em>"A Contamination Model for Selective Editing"</em>, 
Journal of Official Statistics. Volume 29, Issue 4, Pages 539-555 (<a href="http://dx.doi.org/10.2478/jos-2013-0039">http://dx.doi.org/10.2478/jos-2013-0039</a>). <br></p>
<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>"Use of Contamination Models for Selective Editing"</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1
# Parameter estimation with one contaminated variable and one covariate
    data(ex1.data)
    ml.par &lt;- ml.est(y=ex1.data[,"Y1"], x=ex1.data[,"X1"])
# Detection of influential errors    
    sel &lt;- sel.edit(y=ex1.data[,"Y1"], ypred=ml.par$ypred)
    head(sel)
    sum(sel[,"sel"])
# orders results for decreasing importance of score     
    sel.ord &lt;- sel[order(sel[,"rank"]),  ] 
# adds columns to data
    ex1.data &lt;- cbind(ex1.data, tau=ml.par$tau, outlier=ml.par$outlier,
                      sel[,c("rank", "sel")])
# plot of data with outliers and influential errors 
    sel.pairs(ex1.data[,c("X1","Y1")],outl=ml.par$outlier, sel=sel[,"sel"])
# Example 2
    data(ex2.data)
    par.joint &lt;- ml.est(y=ex2.data)
    sel &lt;- sel.edit(y=ex2.data, ypred=par.joint$ypred)	
    sel.pairs(ex2.data,outl=par.joint$outlier, sel=sel[,"sel"])
</code></pre>


</div>