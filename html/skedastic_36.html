<div class="container">

<table style="width: 100%;"><tr>
<td>simonoff_tsai</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simonoff-Tsai Tests for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the modified profile likelihood ratio test and
score test of Simonoff and Tsai (1994) for testing
for heteroskedasticity in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simonoff_tsai(
  mainlm,
  auxdesign = NA,
  method = c("mlr", "score"),
  hetfun = c("mult", "add", "logmult"),
  basetest = c("koenker", "cook_weisberg"),
  bartlett = TRUE,
  optmethod = "Nelder-Mead",
  statonly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auxdesign</code></td>
<td>
<p>A <code>data.frame</code> or
<code>matrix</code> representing an auxiliary design matrix of
containing exogenous variables that (under alternative hypothesis) are
related to error variance, or a character "fitted.values" indicating
that the fitted <code class="reqn">\hat{y}_i</code> values from OLS should be used.
If set to <code>NA</code> (the default), the
design matrix of the original regression model is used. An intercept
is included in the auxiliary regression even if the first column of
<code>auxdesign</code> is not a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character specifying which of the tests proposed in
Simonoff and Tsai (1994) to implement. <code>"mlr"</code>
corresponds to the modified profile likelihood ratio test, and
<code>"score"</code> corresponds to the score test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetfun</code></td>
<td>
<p>A character describing the form of <code class="reqn">w(\cdot)</code>, the error
variance function under the heteroskedastic alternative. Possible values
are <code>"mult"</code> (the default), corresponding to
<code class="reqn">w(Z_i,\lambda)=\exp\left\{\sum_{j=1}^{q}\lambda_j Z_{ij}\right\}</code>,
<code>"add"</code>, corresponding to
<code class="reqn">w(Z_i,\lambda)=\left(1+\sum_{j=1}^{q} \lambda_j Z_{ij}\right)^2</code>, and
<code>"logmult"</code>, corresponding to
<code class="reqn">w(Z_i,\lambda)=\exp\left\{\sum_{j=1}^{q}\lambda_j \log Z_{ij}\right\}</code>.
The multiplicative and log-multiplicative cases are considered in
Cook and Weisberg (1983); the additive case is discussed,
<em>inter alia</em>, by Griffiths and Surekha (1986).
Results for the additive and multiplicative models are identical for this
test. Partial matching is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basetest</code></td>
<td>
<p>A character specifying the base test statistic which is
robustified using the added term described in Details. <code>"koenker"</code>
corresponds to the test statistic produced by <code>breusch_pagan</code>
with argument <code>koenker</code> set to <code>TRUE</code>, while
<code>"cook_weisberg"</code> corresponds to the test statistic produced by
<code>cook_weisberg</code>. Partial matching is used. This argument is
only used if <code>method</code> is <code>"score"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bartlett</code></td>
<td>
<p>A logical specifying whether a Bartlett correction should be
made, as per Ferrari et al. (2004), to improve the
fit of the test statistic to the asymptotic null distribution. This
argument is only applicable where <code>method</code> is <code>"mlr"</code>, and is
implemented only where <code>hetfun</code> is <code>"mult"</code> or
<code>"logmult"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optmethod</code></td>
<td>
<p>A character specifying the optimisation method to use with
<code>optim</code>, if <code>method</code> is <code>"mlr"</code>. The
default, <code>"Nelder-Mead"</code>, corresponds to the default <code>method</code>
value in <code>optim</code>. Warnings about Nelder-Mead algorithm
being unreliable for one-dimensional optimization have been suppressed,
since the algorithm does appear to work for the three implemented choices
of <code>hetfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to pass to <code>optim</code>, such as
<code>par</code> (initial value of <code class="reqn">\lambda</code>) and <code>maxit</code> (maximum
number of iterations to use in optimisation algorithm), and <code>trace</code>
(to provide detailed output on optimisation algorithm). Default initial
value of <code class="reqn">\lambda</code> is <code>rep(1e-3, q)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Simonoff-Tsai Likelihood Ratio Test involves a modification of
the profile likelihood function so that the nuisance parameter will be
orthogonal to the parameter of interest. The maximum likelihood estimate
of <code class="reqn">\lambda</code> (called <code class="reqn">\delta</code> in
Simonoff and Tsai (1994)) is computed from the modified
profile log-likelihood function using the Nelder-Mead algorithm in
<code>optim</code>. Under the null hypothesis of
homoskedasticity, the distribution of the test statistic is
asymptotically chi-squared with <code class="reqn">q</code> degrees of freedom. The test is
right-tailed.
</p>
<p>The Simonoff-Tsai Score Test entails adding a term to either the score
statistic of Cook and Weisberg (1983) (a test implemented
in <code>cook_weisberg</code>) or to that of
Koenker (1981) (a test implemented in
<code>breusch_pagan</code> with argument <code>koenker</code> set to
<code>TRUE</code>), in order to improve the robustness of these respective
tests in the presence of non-normality. This test likewise has a test
statistic that is asymptotically <code class="reqn">\chi^2(q)</code>-distributed and the test
is likewise right-tailed.
</p>
<p>The assumption of underlying both tests is that
<code class="reqn">\mathrm{Cov}(\epsilon)=\omega W</code>, where <code class="reqn">W</code> is
an <code class="reqn">n\times n</code> diagonal matrix with <code class="reqn">i</code>th diagonal element
<code class="reqn">w_i=w(Z_i, \lambda)</code>. Here, <code class="reqn">Z_i</code> is the <code class="reqn">i</code>th row of an
<code class="reqn">n \times q</code> nonstochastic auxiliary design matrix <code class="reqn">Z</code>. Note:
<code class="reqn">Z</code> as defined here does not have a column of ones, but is
concatenated to a column of ones when used in an auxiliary regression.
<code class="reqn">\lambda</code> is a <code class="reqn">q</code>-vector of unknown parameters, and
<code class="reqn">w(\cdot)</code> is a real-valued, twice-differentiable function having the
property that there exists some <code class="reqn">\lambda_0</code> for which
<code class="reqn">w(Z_i,\lambda_0)=0</code> for all <code class="reqn">i=1,2,\ldots,n</code>. Thus, the null
hypothesis of homoskedasticity may be expressed as
<code class="reqn">\lambda=\lambda_0</code>.
</p>
<p>In the score test, the added term in the test statistic is of the form
</p>
<p style="text-align: center;"><code class="reqn">\sum_{j=1}^{q} \left(\sum_{i=1}^{n} h_{ii} t_{ij}\right) \tau_j</code>
</p>
<p>,
where <code class="reqn">t_{ij}</code> is the <code class="reqn">(i,j)</code>th element of the Jacobian matrix
<code class="reqn">J</code> evaluated at <code class="reqn">\lambda=\lambda_0</code>:
</p>
<p style="text-align: center;"><code class="reqn">t_{ij}=\left.\frac{\partial w(Z_i, \lambda)}{\partial \lambda_j}\right|_{\lambda=\lambda_0}</code>
</p>
<p>,
and <code class="reqn">\tau=(\bar{J}'\bar{J})^{-1}\bar{J}'d</code>, where <code class="reqn">d</code> is the
<code class="reqn">n</code>-vector whose <code class="reqn">i</code>th element is <code class="reqn">e_i^2\bar{\omega}^{-1}</code>,
<code class="reqn">\bar{\omega}=n^{-1}e'e</code>, and <code class="reqn">\bar{J}=(I_n-1_n 1_n'/n)J</code>.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Cook RD, Weisberg S (1983).
“Diagnostics for Heteroscedasticity in Regression.”
<em>Biometrika</em>, <b>70</b>(1), 1–10.<br><br> Ferrari SL, Cysneiros AH, Cribari-Neto F (2004).
“An Improved Test for Heteroskedasticity Using Adjusted Modified Profile Likelihood Inference.”
<em>Journal of Statistical Planning and Inference</em>, <b>124</b>, 423–437.<br><br> Griffiths WE, Surekha K (1986).
“A Monte Carlo Evaluation of the Power of Some Tests for Heteroscedasticity.”
<em>Journal of Econometrics</em>, <b>31</b>(1), 219–231.<br><br> Koenker R (1981).
“A Note on Studentizing a Test for Heteroscedasticity.”
<em>Journal of Econometrics</em>, <b>17</b>, 107–112.<br><br> Simonoff JS, Tsai C (1994).
“Use of Modified Profile Likelihood for Improved Tests of Constancy of Variance in Regression.”
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, <b>43</b>(2), 357–370.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
simonoff_tsai(mtcars_lm, method = "score")
simonoff_tsai(mtcars_lm, method = "score", basetest = "cook_weisberg")
simonoff_tsai(mtcars_lm, method = "mlr")
simonoff_tsai(mtcars_lm, method = "mlr", bartlett = FALSE)
## Not run: simonoff_tsai(mtcars_lm, auxdesign = data.frame(mtcars$wt, mtcars$qsec),
 method = "mlr", hetfun = "logmult")
## End(Not run)

</code></pre>


</div>