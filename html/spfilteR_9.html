<div class="container">

<table style="width: 100%;"><tr>
<td>MI.resid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran Test for Residual Spatial Autocorrelation</h2>

<h3>Description</h3>

<p>This function assesses the degree of spatial
autocorrelation present in regression residuals by means of the Moran
coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MI.resid(resid, x = NULL, W, alternative = "greater", boot = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>residual vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector/ matrix of regressors (default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial connectivity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>specification of alternative hypothesis as 'greater' (default),
'lower', or 'two.sided'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>optional integer specifying the number of simulation iterations to
compute the variance. If NULL (default), variance calculated under assumed normality</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function assumes an intercept-only model if <code>x = NULL</code>.
Furthermore, <code>MI.resid</code> automatically symmetrizes the matrix
<em><strong>W</strong></em> by: 1/2 * (<em><strong>W</strong></em> + <em><strong>W</strong></em>').
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> object with the following elements:
</p>

<dl>
<dt><code>I</code></dt>
<dd>
<p>observed value of the Moran coefficient</p>
</dd>
<dt><code>EI</code></dt>
<dd>
<p>expected value of Moran's I</p>
</dd>
<dt><code>VarI</code></dt>
<dd>
<p>variance of Moran's I</p>
</dd>
<dt><code>zI</code></dt>
<dd>
<p>standardized Moran coefficient</p>
</dd>
<dt><code>pI</code></dt>
<dd>
<p><em>p</em>-value of the test statistic</p>
</dd>
</dl>
<h3>Note</h3>

<p>Calculations are based on the procedure proposed by Cliff and Ord
(1981). See also Cliff and Ord (1972).
</p>


<h3>Author(s)</h3>

<p>Sebastian Juhl
</p>


<h3>References</h3>

<p>Cliff, Andrew D. and John K. Ord (1981): Spatial Processes:
Models &amp; Applications. Pion, London.
</p>
<p>Cliff, Andrew D. and John K. Ord (1972): Testing for Spatial Autocorrelation
Among Regression Residuals. Geographical Analysis, 4 (3): pp. 267 - 284
</p>


<h3>See Also</h3>

<p><code>lmFilter</code>, <code>glmFilter</code>, <code>MI.vec</code>,
<code>MI.local</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fakedata)
y &lt;- fakedataset$x1
x &lt;- fakedataset$x2

resid &lt;- y - x %*% solve(crossprod(x)) %*% crossprod(x,y)
(Moran &lt;- MI.resid(resid = resid, x = x, W = W, alternative = "greater"))

# intercept-only model
x &lt;- rep(1, length(y))
resid2 &lt;- y - x %*% solve(crossprod(x)) %*% crossprod(x,y)
intercept &lt;- MI.resid(resid = resid2, W = W, alternative = "greater")
# same result with MI.vec for the intercept-only model
vec &lt;- MI.vec(x = resid2, W = W, alternative = "greater")
rbind(intercept, vec)

</code></pre>


</div>