<div class="container">

<table style="width: 100%;"><tr>
<td>CalcPerturbSig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a perturbation Signature</h2>

<h3>Description</h3>

<p>Function to calculate perturbation signature for pooled CRISPR screen datasets.
For each target cell (expressing one target gRNA), we identified 20 cells
from the control pool (non-targeting cells) with the most similar mRNA
expression profiles. The perturbation signature is calculated by subtracting the
averaged mRNA expression profile of the non-targeting neighbors from the mRNA
expression profile of the target cell.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalcPerturbSig(
  object,
  assay = NULL,
  features = NULL,
  slot = "data",
  gd.class = "guide_ID",
  nt.cell.class = "NT",
  split.by = NULL,
  num.neighbors = NULL,
  reduction = "pca",
  ndims = 15,
  new.assay.name = "PRTB",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class Seurat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of Assay PRTB  signature is being calculated on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Features to compute PRTB signature for. Defaults to the
variable features set in the assay specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>Data slot to use for PRTB signature calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gd.class</code></td>
<td>
<p>Metadata column containing target gene classification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt.cell.class</code></td>
<td>
<p>Non-targeting gRNA cell classification identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.by</code></td>
<td>
<p>Provide metadata column if multiple biological replicates
exist to calculate PRTB signature for every replicate separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.neighbors</code></td>
<td>
<p>Number of nearest neighbors to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>Reduction method used to calculate nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndims</code></td>
<td>
<p>Number of dimensions to use from dimensionality reduction method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.assay.name</code></td>
<td>
<p>Name for the new assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display progress + messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a Seurat object with a new assay added containing the
perturbation signature for all cells in the data slot.
</p>


</div>