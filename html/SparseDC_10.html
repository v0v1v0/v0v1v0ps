<div class="container">

<table style="width: 100%;"><tr>
<td>sparsedc_gap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gap Statistic Calculator</h2>

<h3>Description</h3>

<p>This function calculates the gap statistic for SparseDC. For use
when the number of clusters in the data is unknown. We recommend
using alternate methods to infer the number of clusters in the
data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparsedc_gap(pdat1, pdat2, min_clus, max_clus, nboots = 200, nitter = 20,
  nstarts = 10, l1_boot = 50, l2_boot = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdat1</code></td>
<td>
<p>The centered data from condition 1, columns should be
samples (cells) and rows should be features (genes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdat2</code></td>
<td>
<p>The centered data from condition 2, columns should be
samples (cells) and rows should be features (genes). The number of genes
should be the same as <code>pdat1</code>.
as in pdat1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_clus</code></td>
<td>
<p>The minimum number of clusters to try, minimum value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_clus</code></td>
<td>
<p>The maximum number of clusters to try.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboots</code></td>
<td>
<p>The number of bootstrap repetitions to use, default = 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitter</code></td>
<td>
<p>The max number of iterations for each of the start values, the
default value is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstarts</code></td>
<td>
<p>The number of start values to use for SparseDC. The default
value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_boot</code></td>
<td>
<p>The number of bootstrap repetitions used for estimating
lambda 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2_boot</code></td>
<td>
<p>The number of bootstrap repetitions used for estimating
lambda 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the optimal number of clusters, as well as gap
statistics and the calculated standard error for each number of clusters.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load a small dataset
data_test &lt;- data_biase[1:50,]
# Split data into conditions 1 and 2
data_1 &lt;- data_test[ , which(condition_biase == "A")]
data_2 &lt;- data_test[ , which(condition_biase == "B")]
# Preprocess data (log transform and center)
pre_data &lt;- pre_proc_data(data_1, data_2, norm = FALSE, log = TRUE,
center = TRUE)
# Run with one bootstrap sample for example
gap_stat &lt;- sparsedc_gap(pre_data[[1]], pre_data[[2]],
 min_clus &lt;- 2, max_clus &lt;- 3, nboots &lt;- 2)


</code></pre>


</div>