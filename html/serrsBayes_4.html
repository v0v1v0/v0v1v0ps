<div class="container">

<table style="width: 100%;"><tr>
<td>fitSpectraMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the model using Markov chain Monte Carlo.</h2>

<h3>Description</h3>

<p>Fit the model using Markov chain Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitSpectraMCMC(wl, spc, peakWL, lPriors, sd_mh, niter = 10000, nchains = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>Vector of <code>nwl</code> wavenumbers at which the spetra are observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spc</code></td>
<td>
<p><code>n_y * nwl</code> Matrix of observed Raman spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peakWL</code></td>
<td>
<p>Vector of locations for each peak (cm^-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lPriors</code></td>
<td>
<p>List of hyperparameters for the prior distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_mh</code></td>
<td>
<p>Vector of <code>2 * npeaks</code> bandwidths for the random walk proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>number of MCMC iterations per chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nchains</code></td>
<td>
<p>number of concurrent MCMC chains.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a List containing MCMC samples for the model parameters:
</p>

<dl>
<dt><code>amplitude</code></dt>
<dd>
<p><code>niter * nchains * npeaks</code> Array of amplitudes.</p>
</dd>
<dt><code>scale</code></dt>
<dd>
<p><code>niter * nchains * npeaks</code> Array of scale parameters.</p>
</dd>
<dt><code>sigma</code></dt>
<dd>
<p><code>niter * nchains</code> Matrix of standard deviations.</p>
</dd>
<dt><code>n_acc</code></dt>
<dd>
<p>The number of RWMH proposals that were accepted.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>marginalMetropolisUpdate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">wavenumbers &lt;- seq(200,600,by=10)
spectra &lt;- matrix(nrow=1, ncol=length(wavenumbers))
peakLocations &lt;- c(300,500)
peakAmplitude &lt;- c(10000,4000)
peakScale &lt;- c(10, 15)
signature &lt;- weightedLorentzian(peakLocations, peakScale, peakAmplitude, wavenumbers)
baseline &lt;- 1000*cos(wavenumbers/200) + 2*wavenumbers
spectra[1,] &lt;- signature + baseline + rnorm(length(wavenumbers),0,200)
lPriors &lt;- list(scale.mu=log(11.6) - (0.4^2)/2, scale.sd=0.4, bl.smooth=10^11, bl.knots=20,
                amp.mu=5000, amp.sd=5000, noise.sd=200, noise.nu=4)
rw_bw &lt;- c(100, 100, 2, 2)
result &lt;- fitSpectraMCMC(wavenumbers, spectra, peakLocations, lPriors, rw_bw, 500)
result$n_acc
</code></pre>


</div>