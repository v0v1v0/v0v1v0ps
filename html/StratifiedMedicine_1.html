<div class="container">

<table style="width: 100%;"><tr>
<td>filter_train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>filter_train: Identify variables of interest</h2>

<h3>Description</h3>

<p>Wrapper function to train a filter model to determine variables associated with 
the outcome and/or treatment.. Options include elastic net (glmnet) and random 
forest based variable importance (ranger). Used directly in PRISM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_train(
  Y,
  A,
  X,
  family = "gaussian",
  filter = "glmnet",
  hyper = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The outcome variable. Must be numeric or survival (ex; Surv(time,cens) )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Treatment variable. (Default supports binary treatment, either numeric or 
factor). "ple_train" accomodates &gt;2 along with binary treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariate space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Outcome type. Options include "gaussion" (default), "binomial", and "survival".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>Filter model to determine variables that are likely associated with the 
outcome and/or treatment. Outputs a potential reduce list of varia where X.star 
has potentially less variables than X. Default is "glmnet" (elastic net). Other 
options include "ranger" (random forest based variable importance with p-values).
See <code>filter_train</code> for more details. "None" uses no filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>Hyper-parameters for the filter model (must be list). Default is NULL.
See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any additional parameters, not currently passed through.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>filter_train currently fits elastic net or random forest to
find a reduced set of variables which are likely associated with the outcome (Y) 
and/or treatment (A). Current options include:
</p>
<p>1. <strong>glmnet</strong>: Wrapper function for the function "glmnet" from the glmnet package. Here, 
variables with estimated elastic net coefficients of 0 are filtered. Uses LM/GLM/cox 
elastic net for family="gaussian","binomial", "survival" respectively. Default is to 
regress Y~ENET(X) with hyper-parameters:
</p>
<p>hyper = list(lambda="lambda.min", family="gaussian",interaction=FALSE))
</p>
<p>If interaction=TRUE, then Y~ENET(X,X*A), and variables with estimated coefficients of 
zero in both the main effects (X) and treatment-interactions (X*A) are filtered. This 
aims to find variables that are prognostic and/or predictive. 
</p>
<p>2. <strong>ranger</strong>: Wrapper function for the function "ranger" (ranger R package) to calculate
random forest based variable importance (VI) p-values. Here, for the test of VI&gt;0,
variables are filtered if their one-sided p-value&gt;=0.10. P-values are obtained
through subsampling based T-statistics (T=VI_j/SE(VE_j)) for feature j through the 
delete-d jackknife), as described in Ishwaran and Lu 2017. Used for continuous, binary, 
or survival outcomes. Default hyper-parameters are:
</p>
<p>hyper=list(b=0.66, K=200, DF2=FALSE, FDR=FALSE, pval.thres=0.10)
</p>
<p>where b=(% of total data to sample; default=66%), K=# of subsamples, FDR (FDR based
multiplicity correction for p-values), pval.thres=0.10 (adjust to change 
filtering threshold). DF2 fits Y~ranger(X, XA) and calculates the 
VI_2DF = VI_X+VI_XA, which is the variable importance of the main effect + the 
interaction effect (joint test). Var(VI_2DF) = Var(VI_X)+Var(VI_AX)+2cov(VI_X, VI_AX) 
where each component is calculated using the subsampling approach described above.
</p>


<h3>Value</h3>

<p>Trained filter model and vector of variable names that pass the filter. 
</p>

<ul>
<li>
<p> mod - trained model
</p>
</li>
<li>
<p> filter.vars - Variables that remain after filtering (could be all)
</p>
</li>
</ul>
<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for
Generalized Linear Models via Coordinate Descent,
<a href="https://web.stanford.edu/~hastie/Papers/glmnet.pdf">https://web.stanford.edu/~hastie/Papers/glmnet.pdf</a> Journal of Statistical 
Software, Vol. 33(1), 1-22 Feb 2010 Vol. 33(1), 1-22 Feb 2010.
</p>
<p>Wright, M. N. &amp; Ziegler, A. (2017). ranger: A fast implementation of 
random forests for high dimensional data in C++ and R. J Stat Softw 77:1-17. 
doi: <a href="https://doi.org/10.18637/jss.v077.i01">10.18637/jss.v077.i01</a>.
</p>
<p>Ishwaran, H. Lu, M. (2017). Standard errors and confidence intervals 
for variable importance in random forest regression, classification, and survival.
Statistics in Medicine 2017.
</p>


<h3>See Also</h3>

<p><code>PRISM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(StratifiedMedicine)
## Continuous ##
dat_ctns = generate_subgrp_data(family="gaussian")
Y = dat_ctns$Y
X = dat_ctns$X
A = dat_ctns$A

# Fit ple_ranger directly (treatment-specific ranger models) #
mod1 = filter_train(Y, A, X, filter="filter_glmnet")
mod1$filter.vars

mod2 = filter_train(Y, A, X, filter="filter_glmnet", hyper=list(interaction=TRUE))
mod2$filter.vars

mod3 = filter_train(Y, A, X, filter="filter_ranger")
mod3$filter.vars




</code></pre>


</div>