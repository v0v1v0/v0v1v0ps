<div class="container">

<table style="width: 100%;"><tr>
<td>sobolrep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sobol' indices estimation based on replicated orthogonal arrays</h2>

<h3>Description</h3>

<p><code>sobolrep</code> generalizes the estimation of the Sobol' sensitivity indices introduced by Tissot &amp; Prieur (2015) using two replicated orthogonal arrays. This function estimates either 
</p>

<ul>
<li>
<p> all first-order and second-order indices at a total cost of <code class="reqn">2 \times N</code> model evaluations,
</p>
</li>
<li>
<p> or all first-order, second-order and total-effect indices at a total cost of <code class="reqn">N \times (d+2)</code> model evaluations,</p>
</li>
</ul>
<p>where <code class="reqn">N=q^{2}</code> and <code class="reqn">q \geq d-1</code> is a prime number corresponding to the number of levels of each orthogonal array.</p>


<h3>Usage</h3>

<pre><code class="language-R">sobolrep(model = NULL, factors, N, tail=TRUE, 
			conf=0.95, nboot=0, nbrep=1, total=FALSE, ...)
## S3 method for class 'sobolrep'
tell(x, y = NULL, ...)
## S3 method for class 'sobolrep'
print(x, ...)
## S3 method for class 'sobolrep'
plot(x, ylim = c(0,1), choice, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>an integer giving the number of factors, or a vector of character strings giving their names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an integer giving the size of each replicated design (for a total of <code class="reqn">2 \times N</code> model evaluations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>a boolean specifying the method used to choose the number of levels of the orthogonal array (see "Warning messages").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbrep</code></td>
<td>
<p>the number of times the estimation procedure is repeated (see "Details").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>a boolean specifying whether or not total effect indices are estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"sobolrep"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the model response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>an integer specifying which indices to plot: <code>1</code> for first-order indices, <code>2</code> for second-order indices, <code>3</code> for total-effect indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sobolrep</code> automatically assigns a uniform distribution on [0,1] to each input. Transformations of distributions (between U[0,1] and the wanted distribution) have to be performed before the call to tell() (see "Examples").
</p>
<p><code>nbrep</code> specifies the number of times the estimation procedure is repeated. Each repetition makes use of the orthogonal array structure to obtain a new set of Sobol' indices. It is important to note that no additional model evaluations are performed (the cost of the procedure remains the same).
</p>


<h3>Value</h3>

<p><code>sobolrep</code> returns a list of class <code>"sobolrep"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments (row concatenation of the two replicated designs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RP</code></td>
<td>
<p>the matrix of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the model variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a data.frame containing estimations of the first-order Sobol' indices plus confidence intervals if specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>a data.frame containing estimations of the second-order Sobol' indices plus confidence intervals if specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>a data.frame containing estimations of the total-effect indices plus confidence intervals if specified.</p>
</td>
</tr>
</table>
<h3>Warning messages</h3>


<dl>
<dt>"The value entered for <code>N</code> is not the square of a prime number. It has been replaced by: "</dt>
<dd>
<p>the number of levels <code>q</code> of each orthogonal array must be a prime number. If <code>N</code> is not a square of a prime number, then this warning message indicates that it was replaced depending on the value of <code>tail</code>. If <code>tail=TRUE</code> (resp. <code>tail=FALSE</code>) the new value of <code>N</code> is equal to the square of the prime number preceding (resp. following) the square root of <code>N</code>.</p>
</dd>
<dt>"The value entered for <code>N</code> is not satisfying the constraint <code class="reqn">N \geq (d-1)^2</code>. It has been replaced by: "</dt>
<dd>
<p>the following constraint must be satisfied <code class="reqn">N \geq (d-1)^{2}</code> where <code class="reqn">d</code> is the number of factors. This warning message indicates that <code>N</code> was replaced by the square of the prime number following (or equals to) <code class="reqn">d-1</code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>A.S. Hedayat, N.J.A. Sloane and J. Stufken, 1999, <em>Orthogonal Arrays: Theory and Applications</em>, Springer Series in Statistics.
</p>
<p>J-Y. Tissot and C. Prieur, 2015, <em>A randomized orthogonal orray-based procedure for the estimation of first- and second-order Sobol' indices</em>, J. Statist. Comput. Simulation, 85:1358-1381.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case: the non-monotonic Sobol g-function

# The method of sobol requires 2 samples
# (there are 8 factors, all following the uniform distribution on [0,1])

x &lt;- sobolrep(model = sobol.fun, factors = 8, N = 1000, nboot=100, nbrep=1, total=FALSE)
print(x)
plot(x,choice=1)
plot(x,choice=2)

# Test case: dealing with non-uniform distributions

x &lt;- sobolrep(model = NULL, factors = 3, N = 1000, nboot=0, nbrep=1, total=FALSE)

# X1 follows a log-normal distribution:
x$X[,1] &lt;- qlnorm(x$X[,1])

# X2 follows a standard normal distribution:
x$X[,2] &lt;- qnorm(x$X[,2])

# X3 follows a gamma distribution:
x$X[,3] &lt;- qgamma(x$X[,3],shape=0.5)

# toy example
toy &lt;- function(x){rowSums(x)}
y &lt;- toy(x$X)
tell(x, y)
print(x)
plot(x,choice=1)
plot(x,choice=2)
</code></pre>


</div>