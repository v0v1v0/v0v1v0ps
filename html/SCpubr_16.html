<div class="container">

<table style="width: 100%;"><tr>
<td>do_FunctionalAnnotationPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute functional annotation plots using GO or KEGG ontologies</h2>

<h3>Description</h3>

<p>Compute functional annotation plots using GO or KEGG ontologies
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_FunctionalAnnotationPlot(
  genes,
  org.db,
  organism = "hsa",
  database = "GO",
  GO_ontology = "BP",
  min.overlap = NULL,
  p.adjust.cutoff = 0.05,
  pAdjustMethod = "BH",
  minGSSize = 10,
  maxGSSize = 500,
  font.size = 10,
  font.type = "sans",
  axis.text.x.angle = 45,
  xlab = NULL,
  ylab = NULL,
  plot.title = NULL,
  plot.subtitle = NULL,
  plot.caption = NULL,
  legend.type = "colorbar",
  legend.position = "bottom",
  legend.framewidth = 0.5,
  legend.tickwidth = 0.5,
  legend.length = 10,
  legend.width = 1,
  legend.framecolor = "grey50",
  legend.tickcolor = "white",
  number.breaks = 5,
  return_matrix = FALSE,
  grid.color = "white",
  border.color = "black",
  plot.title.face = "bold",
  plot.subtitle.face = "plain",
  plot.caption.face = "italic",
  axis.title.face = "bold",
  axis.text.face = "plain",
  legend.title.face = "bold",
  legend.text.face = "plain"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p><strong><code>character</code></strong> | Vector of gene symbols to query for functional annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>org.db</code></td>
<td>
<p><strong><code>OrgDB</code></strong> | Database object to use for the query.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>organism</code></td>
<td>
<p><strong><code>character</code></strong> | Supported KEGG organism.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database</code></td>
<td>
<p><strong><code>character</code></strong> | Database to run the analysis on. One of:
</p>

<ul>
<li> <p><em><code>GO</code></em>.
</p>
</li>
<li> <p><em><code>KEGG</code></em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GO_ontology</code></td>
<td>
<p><strong><code>character</code></strong> | GO ontology to use. One of:
</p>

<ul>
<li> <p><em><code>BP</code></em>: For <strong>B</strong>iological <strong>P</strong>rocess.
</p>
</li>
<li> <p><em><code>MF</code></em>: For <strong>M</strong>olecular <strong>F</strong>unction.
</p>
</li>
<li> <p><em><code>CC</code></em>: For <strong>C</strong>ellular <strong>C</strong>omponent.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.overlap</code></td>
<td>
<p><strong><code>numeric</code></strong> | Filter the output result to the terms which are supported by this many genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.cutoff</code></td>
<td>
<p><strong><code>numeric</code></strong> | Significance cutoff used to filter non-significant terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAdjustMethod</code></td>
<td>
<p><strong><code>character</code></strong> | Method to adjust for multiple testing.  One of:
</p>

<ul>
<li> <p><em><code>holm</code></em>.
</p>
</li>
<li> <p><em><code>hochberg</code></em>.
</p>
</li>
<li> <p><em><code>hommel</code></em>.
</p>
</li>
<li> <p><em><code>bonferroni</code></em>.
</p>
</li>
<li> <p><em><code>BH</code></em>.
</p>
</li>
<li> <p><em><code>BY</code></em>.
</p>
</li>
<li> <p><em><code>fdr</code></em>.
</p>
</li>
<li> <p><em><code>none</code></em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minGSSize</code></td>
<td>
<p><strong><code>numeric</code></strong> | Minimal size of genes annotated by Ontology term for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxGSSize</code></td>
<td>
<p><strong><code>numeric</code></strong> | Maximal size of genes annotated for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.size</code></td>
<td>
<p><strong><code>numeric</code></strong> | Overall font size of the plot. All plot elements will have a size relationship with this font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.type</code></td>
<td>
<p><strong><code>character</code></strong> | Base font family for the plot. One of:
</p>

<ul>
<li> <p><em><code>mono</code></em>: Mono spaced font.
</p>
</li>
<li> <p><em><code>serif</code></em>: Serif font family.
</p>
</li>
<li> <p><em><code>sans</code></em>: Default font family.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.x.angle</code></td>
<td>
<p><strong><code>numeric</code></strong> | Degree to rotate the X labels. One of: 0, 45, 90.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p><strong><code>character</code></strong> | Titles for the X and Y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title, plot.subtitle, plot.caption</code></td>
<td>
<p><strong><code>character</code></strong> | Title, subtitle or caption to use in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.type</code></td>
<td>
<p><strong><code>character</code></strong> | Type of legend to display. One of:
</p>

<ul>
<li> <p><em><code>normal</code></em>: Default legend displayed by <span class="pkg">ggplot2</span>.
</p>
</li>
<li> <p><em><code>colorbar</code></em>: Redefined colorbar legend, using guide_colorbar.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p><strong><code>character</code></strong> | Position of the legend in the plot. One of:
</p>

<ul>
<li> <p><em><code>top</code></em>: Top of the figure.
</p>
</li>
<li> <p><em><code>bottom</code></em>: Bottom of the figure.
</p>
</li>
<li> <p><em><code>left</code></em>: Left of the figure.
</p>
</li>
<li> <p><em><code>right</code></em>: Right of the figure.
</p>
</li>
<li> <p><em><code>none</code></em>: No legend is displayed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.framewidth, legend.tickwidth</code></td>
<td>
<p><strong><code>numeric</code></strong> | Width of the lines of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.length, legend.width</code></td>
<td>
<p><strong><code>numeric</code></strong> | Length and width of the legend. Will adjust automatically depending on legend side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.framecolor</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the lines of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.tickcolor</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the ticks of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number.breaks</code></td>
<td>
<p><strong><code>numeric</code></strong> | Controls the number of breaks in continuous color scales of ggplot2-based plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_matrix</code></td>
<td>
<p><strong><code>logical</code></strong> | Returns the matrices with the enriched Terms for further use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the grid in the plot. In heatmaps, color of the border of the cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color for the border of the heatmap body.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.face, plot.subtitle.face, plot.caption.face, axis.title.face, axis.text.face, legend.title.face, legend.text.face</code></td>
<td>
<p><strong><code>character</code></strong> | Controls the style of the font for the corresponding theme element.  One of:
</p>

<ul>
<li> <p><em><code>plain</code></em>: For normal text.
</p>
</li>
<li> <p><em><code>italic</code></em>: For text in itallic.
</p>
</li>
<li> <p><em><code>bold</code></em>: For text in bold.
</p>
</li>
<li> <p><em><code>bold.italic</code></em>: For text both in itallic and bold.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing a heatmap of the presence/absence of the genes in the enriched term, as well as a bar plot, dot plot and tree plot of the enriched terms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Check Suggests.
  value &lt;- SCpubr:::check_suggests(function_name = "do_FunctionalAnnotationPlot", passive = TRUE)

  if (isTRUE(value)){
    # Consult the full documentation in https://enblacar.github.io/SCpubr-book/

    # Need to load this library or equivalent.
    suppressMessages(library("org.Hs.eg.db"))

    # Define list of genes to query.
    genes.use &lt;- c("CCR7", "CD14", "LYZ",
                   "S100A4", "MS4A1",
                   "MS4A7", "GNLY", "NKG7", "FCER1A",
                   "CST3", "PPBP")

    # Compute the grouped GO terms.
    out &lt;- SCpubr::do_FunctionalAnnotationPlot(genes = genes.use,
                                               org.db = org.Hs.eg.db)

  } else if (base::isFALSE(value)){
    message("This function can not be used without its suggested packages.")
    message("Check out which ones are needed using `SCpubr::state_dependencies()`.")
  }

</code></pre>


</div>