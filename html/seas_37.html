<div class="container">

<table style="width: 100%;"><tr>
<td>seas.sum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Seasonal sum data object</h2>

<h3>Description</h3>

<p>Create a seasonal sum object used for analysis of precipitation data
(among other things, such as recharge rates); this object has sums in
each ‘bin’ of a season, as well as for each annum (or year).
</p>


<h3>Usage</h3>

<pre><code class="language-R">seas.sum(x, var, width = 11, start.day = 1, prime,
         a.cut = 0.3, na.cut = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>data.frame</code> with daily variables to be summed,
such as precipitation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the names of one or more variables in <code>x</code>, such as
<code>c("rain","snow","precip")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a number specifying the width of the bin (factor) in
days, or <code>"mon"</code> for months (see <code>mkseas</code> for
others)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.day</code></td>
<td>
<p>the first day of the season, specified as either a
<code>Date</code> or as an integer day of the year; annual sums
start on this day, and end a day before <code>start.day</code> in the
following year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prime</code></td>
<td>
<p>a single variable from <code>var</code> which is the prime
variable of interest, such as <code>"precip"</code>; this is the variable
used for comparison with <code>a.cut</code> and <code>na.cut</code> in the
resulting <code>active</code> and <code>na</code> dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.cut</code></td>
<td>
<p>cut-off value for the day to be considered an
<em>active</em> or ‘wet day’ (based on the <code>prime</code>
variable); a trace amount of 0.3 mm is suggested; if <code>a.cut</code>
is <code>NA</code> or zero, the active variable and analysis will be ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.cut</code></td>
<td>
<p>cut-off fraction of missing values; can be single value
or a vector for <code>c(annual,seasonal)</code>; details given below</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used to discretize and sum time-varying data in a
<code>data.frame</code> for analysis in <em>seasonal</em> and
<em>annual</em> parts. This is particularly useful for calculating
normals of rates, such as precipitation and recharge. This function
simply sums up each variable in each bin for each annum (or year), and
provides the results in several arrays.
</p>
<p>Sums are <em>not</em> normalized, and represent a sum for the number of
days in the bin (seasonal data) or annum (for annual data). Seasonal
data can be normalized by the number of days (for a rate per day) or
by the number of active days where <code>prime &gt; a.cut</code>.
</p>
<p>For annual sums, annums with <em>many</em> missing values are ignored
(receiving a value of <code>NA</code>) since it has insufficient data for a
complete sum. The amount of allowable <code>NA</code> values per annum is
controlled by <code>na.cut[1]</code>, which is a fraction of <code>NA</code>
values for the whole annum (default is 0.2).
</p>
<p>The seasonal sums are calculated independently from the annual
sums. Individual bins from each year with <em>many</em> missing values
are ignored, where the amount of allowable <code>NA</code> values is
controlled by <code>na.cut[2]</code> (or <code>na.cut[1]</code>, if the
<code>length</code> of <code>na.cut</code> is 1). The default fraction of
<code>NA</code>s in each bin of each annum is 0.2.
</p>


<h3>Value</h3>

 
<p>Returns a <code>seas.sum</code> object, which is a <code>list</code> with
the following elements:
</p>

<dl>
<dt>
<code>ann</code>:</dt>
<dd>
<p>A <code>data.frame</code> of annual data; the columns are:
</p>

<dl>
<dt>
<code>year</code>:</dt>
<dd>
<p>year, or annum</p>
</dd>
<dt>
<code>active</code>:</dt>
<dd>
<p>the number of ‘active’ days in the year
where the prime variable is above <code>a.cut</code> (if used)</p>
</dd>
<dt>
<code>days</code>:</dt>
<dd>
<p>number of days in each year</p>
</dd>
<dt>
<code>na</code>:</dt>
<dd>
<p>number of missing days in the year</p>
</dd>
<dt>
<em>var(s)</em>:</dt>
<dd>
<p>annual sum of one or more variable; if the
original units were mm/day, they are now mm/year</p>
</dd>
</dl>
</dd>
<dt>
<code>seas</code>:</dt>
<dd>
<p>An <code>array:</code> of seasonal data; the dimensions are:
</p>

<dl>
<dt>
<code>[[1]]</code>:</dt>
<dd>
<p>year, or annum</p>
</dd>
<dt>
<code>[[2]]</code>:</dt>
<dd>
<p>bins, or seasonal factors generated by
<code>mkseas</code></p>
</dd>
<dt>
<code>[[3]]</code>:</dt>
<dd>
<p>sums of variables for each bin of each year; if
the original unit was mm/day, it is now mm per number of
days, which is held in the <code>days</code> item</p>
</dd>
</dl>
</dd>
<dt>
<code>active</code>:</dt>
<dd>
<p>the number of ‘active’ days in the bin
where the prime variable is above <code>a.cut</code> (if used)</p>
</dd>
<dt>
<code>days</code>:</dt>
<dd>
<p>an array of the number of days in each bin; this
array is useful for normalizing the numbers in <code>seas</code> to
comparable units of mm/day</p>
</dd>
<dt>
<code>na</code>:</dt>
<dd>
<p>number of missing days in each bin</p>
</dd>
<dt>
<code>start.day</code>:</dt>
<dd>
<p>same as input</p>
</dd>
<dt>
<code>years</code>:</dt>
<dd>
<p>years (same as <code>ann[[1]]</code> and
<code>seas[[1]]</code>); if <code>start.day</code> is not 1, this represents the
starting and ending years (i.e., <code>1991_1992</code>) of each annum;
see <code>mkann</code></p>
</dd>
<dt>
<code>var</code>:</dt>
<dd>
<p>variable(s) which the sums represent (part of
<code>ann[[2]]</code> and <code>seas[[3]]</code>)</p>
</dd>
<dt>
<code>units</code>:</dt>
<dd>
<p>a <code>list</code> of  units for each
<code>var</code>, such as “mm/day”; these are obtained from the
<code>units</code> attribute (using <code>attr</code>) found in
<code>x$var</code></p>
</dd>
<dt>
<code>long.name</code>:</dt>
<dd>
<p>a <code>list</code> of long names for each <code>var</code>;
these are obtained from <code>long.name</code> in <code>x$var</code>; set to
be <code>var</code> if <code>NULL</code></p>
</dd>
<dt>
<code>prime</code>:</dt>
<dd>
<p>a <code>prime</code> variable, such as <code>"precip"</code></p>
</dd>
<dt>
<code>width</code>:</dt>
<dd>
<p><code>width</code> argument passed to <code>mkseas</code></p>
</dd>
<dt>
<code>bins</code>:</dt>
<dd>
<p>names of bins returned by <code>mkseas</code> (same as
<code>seas[[2]]</code>)</p>
</dd>
<dt>
<code>bin.lengths</code>:</dt>
<dd>
<p>the maximum length in days for each <code>bin</code></p>
</dd>
<dt>
<code>year.range</code>:</dt>
<dd>
<p>range of years from <code>x</code></p>
</dd>
<dt>
<code>precip.only</code>:</dt>
<dd>
<p>value used in argument (modified if
insufficient data found in <code>x</code>)</p>
</dd>
<dt>
<code>na.cut</code>:</dt>
<dd>
<p>value used in argument</p>
</dd>
<dt>
<code>a.cut</code>:</dt>
<dd>
<p>value used in argument; if it is zero or
<code>NA</code>, this will be <code>FALSE</code></p>
</dd>
<dt>
<code>id</code>:</dt>
<dd>
<p>from <code>attr(x,"id")</code> (<code>NULL</code> if not set)</p>
</dd>
<dt>
<code>name</code>:</dt>
<dd>
<p>from <code>attr(x,"name")</code> (<code>NULL</code> if not set)</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>See Also</h3>

<p>To view the result try <code>image.seas.sum</code>, or
alternatively, <code>plot.seas.sum</code>
</p>
<p>To calculate and view a “normal”, use  <code>seas.norm</code>
and  <code>plot.seas.norm</code>, or for precipitation use
<code>precip.norm</code> and <code>plot.precip.norm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mscdata)
dat &lt;- mksub(mscdata, id=1108447)
dat.ss &lt;- seas.sum(dat, width="mon")

# Structure in R
str(dat.ss)

# Annual data
dat.ss$ann

# Demonstrate how to slice through a cubic array
dat.ss$seas["1990",,]
dat.ss$seas[,2,] # or "Feb", if using English locale
dat.ss$seas[,,"precip"]

# Simple calculation on an array
(monthly.mean &lt;- apply(dat.ss$seas[,,"precip"], 2, mean,na.rm=TRUE))
barplot(monthly.mean, ylab="Mean monthly total (mm/month)",
	main="Un-normalized mean precipitation in Vancouver, BC")
text(6.5, 150, paste("Un-normalized rates given 'per month' should be",
	"avoided since ~3-9% error is introduced",
	"to the analysis between months", sep="\n"))

# Normalized precip
norm.monthly &lt;- dat.ss$seas[,,"precip"] / dat.ss$days
norm.monthly.mean &lt;- apply(norm.monthly, 2, mean,na.rm=TRUE)
print(round(norm.monthly, 2))
print(round(norm.monthly.mean, 2))
barplot(norm.monthly.mean,
    ylab="Normalized mean monthly total (mm/day)",
	main="Normalized mean precipitation in Vancouver, BC")

# Better graphics of data
dat.ss &lt;- seas.sum(dat, width=11)
image(dat.ss)
</code></pre>


</div>