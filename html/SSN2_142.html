<div class="container">

<table style="width: 100%;"><tr>
<td>ssn_initial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a covariance parameter initial object</h2>

<h3>Description</h3>

<p>Create a covariance parameter initial object that specifies
initial and/or known values to use while estimating specific covariance parameters
with <code>ssn_lm()</code> or <code>ssn_glm()</code>.  See <code>spmodel::randcov_initial()</code> for documentation regarding
random effect covariance parameter initial objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tailup_initial(tailup_type, de, range, known)

taildown_initial(taildown_type, de, range, known)

euclid_initial(euclid_type, de, range, rotate, scale, known)

nugget_initial(nugget_type, nugget, known)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tailup_type</code></td>
<td>
<p>The tailup covariance function type. Available options
include <code>"linear"</code>, <code>"spherical"</code>, <code>"exponential"</code>,
<code>"mariah"</code>, <code>"epa"</code>, and <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>de</code></td>
<td>
<p>The spatially dependent (correlated) random error variance. Commonly referred to as
a partial sill.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>The correlation parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known</code></td>
<td>
<p>A character vector indicating which covariance parameters are to be
assumed known. The value <code>"given"</code> is shorthand for assuming all
covariance parameters given to <code>*_initial()</code> are assumed known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taildown_type</code></td>
<td>
<p>The taildown covariance function type. Available options
include <code>"linear"</code>, <code>"spherical"</code>, <code>"exponential"</code>,
<code>"mariah"</code>, <code>"epa"</code>, and <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>euclid_type</code></td>
<td>
<p>The euclidean covariance function type. Available options
include <code>"spherical"</code>, <code>"exponential"</code>, <code>"gaussian"</code>,
<code>"cosine"</code>, <code>"cubic"</code>, <code>"pentaspherical"</code>, <code>"wave"</code>,
<code>"jbessel"</code>, <code>"gravity"</code>, <code>"rquad"</code>, <code>"magnetic"</code>, and
<code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>Anisotropy rotation parameter (from 0 to <code class="reqn">\pi</code> radians) for
the euclidean portion of the covariance. A value of 0 (the default) implies no rotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Anisotropy scale parameter (from 0 to 1) for
the euclidean portion of the covariance. A value of 1 (the default) implies no scaling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget_type</code></td>
<td>
<p>The nugget covariance function type. Available options
include <code>"nugget"</code> or <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>The spatially independent (not correlated) random error variance. Commonly referred to as
a nugget.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Create an initial object for use with <code>ssn_lm()</code> or <code>ssn_glm()</code>.
<code>NA</code> values can be given for <code>ie</code>, <code>rotate</code>, and <code>scale</code>, which lets
these functions find initial values for parameters that are sometimes
otherwise assumed known (e.g., <code>rotate</code> and <code>scale</code> with <code>ssn_lm()</code> and <code>ssn_glm()</code>.
Parametric forms for each spatial covariance type are presented below.
</p>
<p><code>tailup_type</code> Details: Let <code class="reqn">D</code> be a matrix of hydrologic distances,
<code class="reqn">W</code> be a diagonal matrix of weights from <code>additive</code>, <code class="reqn">r = D / range</code>,
and <code class="reqn">I</code> be
an identity matrix. Then parametric forms for flow-connected
elements of <code class="reqn">R(zu)</code> are given below:
</p>

<ul>
<li>
<p> linear: <code class="reqn">(1 - r) * (r &lt;= 1) * W</code>
</p>
</li>
<li>
<p> spherical: <code class="reqn">(1 - 1.5r + 0.5r^3) * (r &lt;= 1) * W</code>
</p>
</li>
<li>
<p> exponential: <code class="reqn">exp(-r) * W</code>
</p>
</li>
<li>
<p> mariah: <code class="reqn">log(90r + 1) / 90r * (D &gt; 0) + 1 * (D = 0) * W</code>
</p>
</li>
<li>
<p> epa: <code class="reqn">(D - range)^2 * F * (r &lt;= 1) * W / 16range^5</code>
</p>
</li>
<li>
<p> none: <code class="reqn">I</code> * W
</p>
</li>
</ul>
<p>Details describing the <code>F</code> matrix in the <code>epa</code> covariance are given in Garreta et al. (2010).
Flow-unconnected elements of <code class="reqn">R(zu)</code> are assumed uncorrelated.
Observations on different networks are also assumed uncorrelated.
</p>
<p><code>taildown_type</code> Details: Let <code class="reqn">D</code> be a matrix of hydrologic distances,
<code class="reqn">r = D / range</code>,
and <code class="reqn">I</code> be an identity matrix. Then parametric forms for flow-connected
elements of <code class="reqn">R(zd)</code> are given below:
</p>

<ul>
<li>
<p> linear: <code class="reqn">(1 - r) * (r &lt;= 1)</code>
</p>
</li>
<li>
<p> spherical: <code class="reqn">(1 - 1.5r + 0.5r^3) * (r &lt;= 1)</code>
</p>
</li>
<li>
<p> exponential: <code class="reqn">exp(-r)</code>
</p>
</li>
<li>
<p> mariah: <code class="reqn">log(90r + 1) / 90r * (D &gt; 0) + 1 * (D = 0)</code>
</p>
</li>
<li>
<p> epa: <code class="reqn">(D - range)^2 * F1 * (r &lt;= 1) / 16range^5</code>
</p>
</li>
<li>
<p> none: <code class="reqn">I</code>
</p>
</li>
</ul>
<p>Now let <code class="reqn">A</code> be a matrix that contains the shorter of the two distances
between two sites and the common downstream junction, <code class="reqn">r1 = A / range</code>,
<code class="reqn">B</code> be a matrix that contains the longer of the two distances between two sites and the
common downstream junction, <code class="reqn">r2 = B / range</code>,  and <code class="reqn">I</code> be an identity matrix.
Then parametric forms for flow-unconnected elements of <code class="reqn">R(zd)</code> are given below:
</p>

<ul>
<li>
<p> linear: <code class="reqn">(1 - r2) * (r2 &lt;= 1)</code>
</p>
</li>
<li>
<p> spherical: <code class="reqn">(1 - 1.5r1 + 0.5r2) * (1 - r2)^2 * (r2 &lt;= 1)</code>
</p>
</li>
<li>
<p> exponential: <code class="reqn">exp(-(r1 + r2))</code>
</p>
</li>
<li>
<p> mariah: <code class="reqn">(log(90r1 + 1) - log(90r2 + 1)) / (90r1 - 90r2) * (A =/ B) + (1 / (90r1 + 1)) * (A = B)</code>
</p>
</li>
<li>
<p> epa: <code class="reqn">(B - range)^2 * F2 * (r2 &lt;= 1) / 16range^5</code>
</p>
</li>
<li>
<p> none: <code class="reqn">I</code>
</p>
</li>
</ul>
<p>Details describing the <code>F1</code> and <code>F2</code> matrices in the <code>epa</code>
covariance are given in Garreta et al. (2010).
Observations on different networks are assumed uncorrelated.
</p>
<p><code>euclid_type</code> Details: Let <code class="reqn">D</code> be a matrix of Euclidean distances,
<code class="reqn">r = D / range</code>, and <code class="reqn">I</code> be an identity matrix. Then parametric
forms for elements of <code class="reqn">R(ze)</code> are given below:
</p>

<ul>
<li>
<p> exponential: <code class="reqn">exp(- r )</code>
</p>
</li>
<li>
<p> spherical: <code class="reqn">(1 - 1.5r + 0.5r^3) * (r &lt;= 1)</code>
</p>
</li>
<li>
<p> gaussian: <code class="reqn">exp(- r^2 )</code>
</p>
</li>
<li>
<p> cubic: <code class="reqn">(1 - 7r^2 + 8.75r^3 - 3.5r^5 + 0.75r^7) * (r &lt;= 1)</code>
</p>
</li>
<li>
<p> pentaspherical: <code class="reqn">(1 - 1.875r + 1.25r^3 - 0.375r^5) * (r &lt;= 1)</code>
</p>
</li>
<li>
<p> cosine: <code class="reqn">cos(r)</code>
</p>
</li>
<li>
<p> wave: <code class="reqn">sin(r) * (h &gt; 0) / r + (h = 0)</code>
</p>
</li>
<li>
<p> jbessel: <code class="reqn">Bj(h * range)</code>, Bj is Bessel-J function
</p>
</li>
<li>
<p> gravity: <code class="reqn">(1 + r^2)^{-0.5}</code>
</p>
</li>
<li>
<p> rquad: <code class="reqn">(1 + r^2)^{-1}</code>
</p>
</li>
<li>
<p> magnetic: <code class="reqn">(1 + r^2)^{-1.5}</code>
</p>
</li>
<li>
<p> none: <code class="reqn">I</code>
</p>
</li>
</ul>
<p><code>nugget_type</code> Details: Let <code class="reqn">I</code> be an identity matrix and <code class="reqn">0</code>
be the zero matrix. Then parametric
forms for elements the nugget variance are given below:
</p>

<ul>
<li>
<p> nugget: <code class="reqn">I</code>
</p>
</li>
<li>
<p> none: <code class="reqn">0</code>
</p>
</li>
</ul>
<p>In short, the nugget effect is modeled when <code>nugget_type</code> is <code>"nugget"</code>
and omitted when <code>nugget_type</code> is <code>"none"</code>.
</p>
<p>Dispersion and random effect initial objects are specified via
<code>spmodel::dispersion_initial()</code> and <code>spmodel::randcov_initial()</code>, respectively.
</p>


<h3>Value</h3>

<p>A list with two elements: <code>initial</code> and <code>is_known</code>.
<code>initial</code> is a named numeric vector indicating the spatial covariance parameters
with specified initial and/or known values. <code>is_known</code> is a named
numeric vector indicating whether the spatial covariance parameters in
<code>initial</code> are known or not. The class of the list
matches the the relevant spatial covariance type.
</p>


<h3>References</h3>

<p>Peterson, E.E. and Ver Hoef, J.M. (2010) A mixed-model moving-average approach
to geostatistical modeling in stream networks. <em>Ecology</em> <b>91(3)</b>,
644–651.
</p>
<p>Ver Hoef, J.M. and Peterson, E.E. (2010) A moving average approach for spatial
statistical models of stream networks (with discussion).
<em>Journal of the American Statistical Association</em> <b>105</b>, 6–18.
DOI: 10.1198/jasa.2009.ap08248.  Rejoinder pgs. 22–24.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tailup_initial("exponential", de = 1, range = 20, known = "range")
tailup_initial("exponential", de = 1, range = 20, known = "given")
euclid_initial("spherical", de = 2, range = 4, scale = 0.8, known = c("range", "scale"))
dispersion_initial("nbinomial", dispersion = 5)

</code></pre>


</div>