<div class="container">

<table style="width: 100%;"><tr>
<td>LMS2z</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert to/from measurement from/to z-score with growth reference</h2>

<h3>Description</h3>

<p>A function to convert between measurements and z-scores using a growth
reference previously fitted by the LMS method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LMS2z(x, y, sex, measure, ref, toz = TRUE, LMStable = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of ages in units of years.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector or one-column matrix of either measurements or z-scores,
depending on the value of <code>toz</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sex</code></td>
<td>
<p>vector where 1/2 = males/females = boys/girls = TRUE/FALSE, based
on the uppercased first character of the string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>unique measurement name, as character string, the choice depending on
the choice of <code>ref</code> (see e.g. references <code>uk90</code>, <code>who06</code> and
<code>ukwhopt</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>unique growth reference, either as name or character string, available as
a <code>data</code> object or data frame (e.g. <code>uk90</code>, <code>who06</code> or
<code>ukwhopt</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toz</code></td>
<td>
<p>logical set to TRUE for conversion from measurement to z-score, or
FALSE for the reverse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LMStable</code></td>
<td>
<p>logical set to TRUE to return the associated LMS table as a
data frame in attribute <code>LMStable</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Growth references fitted by the LMS method consist of a table of L, M and S
values by age and sex. Vectors of L, M and S corresponding to <code>x</code> and
<code>sex</code> are extracted using cubic interpolation and passed to either
<code>cLMS</code> or <code>zLMS</code>, depending on <code>toz</code>.
</p>
<p>Disjunct references are supported, where there is a disjunction in the
centiles at a particular age. This may be because the measurement changes,
e.g. from length to height, or because two different references have been
joined together. The disjunction is flagged by including two rows at the
common age, but with different L, M and S values, and measurements at this
age are ascribed to the older reference. For example the <code>who06</code>
reference has a disjunction at 2 years reflecting the switch from length to
height. As a result height at just below and just above 2 years returns a
different z-score.
</p>


<h3>Value</h3>

<p>A vector or matrix containing the transformed values. If <code>y</code> is
a vector then a vector of <code>length(x)</code> is returned, else if <code>y</code> is
a one-column matrix then a matrix is returned, with <code>length(x)</code> rows
and <code>length(y)</code> columns. The matrix row names are set to <code>x</code>, and
the column names to either <code>y</code> or if <code>toz</code> is FALSE,
<code>z2cent(y)</code>. If LMStable is TRUE the associated LMS table is returned
as a data frame in attribute <code>LMStable</code>.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>z2cent</code>. The LMS method can be fitted to data using the
package <code>gamlss</code> with the <code>BCCG</code> or <code>BCCGo</code> family, where nu
(originally lambda), mu and sigma correspond to L, M and S respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## convert girls' heights data to UK 90 z-scores
data(heights)
data(uk90)
with(heights, LMS2z(age, height, sex = 2, measure = 'ht', ref = 'uk90'))

## construct table of boys' weight centiles by age for WHO standard
data(who06)
zs &lt;- -4:4*2/3 # z-scores for 9 centiles
ages &lt;- 0:20/4 # 3-month ages to 5 years
LMS2z(ages, as.matrix(zs), sex = 'm', measure = 'wt', ref = who06,
  toz = FALSE, LMStable = TRUE)

</code></pre>


</div>