<div class="container">

<table style="width: 100%;"><tr>
<td>similar.listw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create symmetric similar weights lists</h2>

<h3>Description</h3>

<p>From Ord's 1975 paper, it is known that the Jacobian for SAR models may be found by "symmetrizing" by similarity (the eigenvalues of similar matrices are identical, so the Jacobian is too). This applies only to styles "W" and "S" with underlying symmetric binary neighbour relations or symmetric general neighbour relations (so no k-nearest neighbour relations). The function is invoked automatically within the SAR fitting functions, to call <code>eigen</code> on a symmetric matrix for the default eigen method, or to make it possible to use the Matrix method on weights that can be "symmetrized" in this way.
</p>


<h3>Usage</h3>

<pre><code class="language-R">similar.listw(listw)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>spdep::nb2listw</code></p>
</td>
</tr></table>
<h3>Value</h3>

<p>a <code>listw</code> object
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Ord, J. K. 1975 Estimation methods for models of spatial interaction, <em>Journal of the American Statistical Association</em>, 70, 120-126</p>


<h3>See Also</h3>

<p><code>lagsarlm</code>, <code>errorsarlm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#require("spdep", quietly=TRUE)
data(oldcol, package="spdep")
COL.W &lt;- spdep::nb2listw(COL.nb, style="W")
COL.S &lt;- spdep::nb2listw(COL.nb, style="S")
sum(log(1 - 0.5 * eigenw(COL.W)))
sum(log(1 - 0.5 * eigenw(similar.listw(COL.W))))
W_J &lt;- as(as_dsTMatrix_listw(similar.listw(COL.W)), "CsparseMatrix")
I &lt;- as_dsCMatrix_I(dim(W_J)[1])
c(determinant(I - 0.5 * W_J, logarithm=TRUE)$modulus)
sum(log(1 - 0.5 * eigenw(COL.S)))
sum(log(1 - 0.5 * eigenw(similar.listw(COL.S))))
W_J &lt;- as(as_dsTMatrix_listw(similar.listw(COL.S)), "CsparseMatrix")
c(determinant(I - 0.5 * W_J, logarithm=TRUE)$modulus)
</code></pre>


</div>