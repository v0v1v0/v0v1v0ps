<div class="container">

<table style="width: 100%;"><tr>
<td>fitrad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML fitting of species rank-abundance distributions</h2>

<h3>Description</h3>

<p>Fits probability distributions for abundance ranks
of species in a sample or assemblage by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitrad(x, rad =c("gs", "mand", "rbs", "zipf"), ...)
fitgs(x, trunc, start.value, ...)
fitmand(x, trunc, start.value, ...)
fitrbs(x, trunc, ...)
fitzipf(x, N, trunc, start.value, upper = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of (positive integer) quantiles or an object of
<code>rad-class</code>. 
In the context of
rads, the numerical vector contains abundances of species in a sample or ecological
assemblage according to their abundance. The <code>rad-class</code> object
contains ranked abundances of species in a sample or ecological
assemblage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rad</code></td>
<td>

<p>character; root name of community rad distribution to be fitted.
<kbd>"gs"</kbd> for geometric series (not geometric distribution,
<code>dgeom</code>),
<kbd>"mand"</kbd> for Zipf-Mandelbrodt distribution,
<kbd>"rbs"</kbd> for MacArthur's Broken-stick distribution,
<kbd>"zipf"</kbd> for Zipf distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>positive integer, total number of individuals in the sample/assemblage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.value</code></td>
<td>

<p>numeric named vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function, and in the same order.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>real positive; upper bound for the Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>in fitrad further arguments to be passed to the specific fitting
function (most used are <code>trunc</code> and
<code>start.value</code>
). In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All these functions fit rank-abundance distributions (RAD) to a vector of
abundances or a rank-abundance table of the <code>rad-class</code>.
RADs assign probabilities p(i) to each rank i, which can be interpreted as
the expected proportion of total individuals in the sample that are of
the i-th species.
</p>
<p><code>fitrad</code> is simply a wrapper that calls the specific functions to fit
the distribution chosen with the argument <code>rad</code>. Users
can interchangeably use <code>fitrad</code> or the individual functions
detailed below 
(e.g. <code>fitrad(x, sad="rbs", ...)</code> is the same as
<code>fitrbs(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the
maximum likelihood method using numerical optimization,
with <code>mle2</code>.
The resulting object is of <code>fitrad-class</code>
which can be handled with <code>mle2</code> methods
for fitted models and has also some additional
methods for RADs models (see
<code>fitrad-class</code> and examples).
By default, fitting to one-parameter distributions (<code>fitgs</code>,
<code>fitzipf</code>) uses Brent's one-dimensional method of optimization (see
<code>optim</code>).
</p>
<p><code>fitgs</code> fits Motomura's  Geometric Series (Whittaker
1965, May 1975) to abundance ranks. 
This was the first model fitted to species
abundance data (Motomura 1932, <em>apud</em> Doi and Mori 2012),
which was subsequently described as the result
of niche pre-emption at a constant rate (Numata et. al. 1953 <em>apud</em> Doi
and Mori 2012). The initial guess for parameter <kbd>k</kbd> is given by
the expression 1 - (nmin/nmax)^(1/(S-1)) (He &amp; Tang, 2008).
</p>
<p><code>fitrbs</code> fits the Broken-stick distribution
(MacArthur 1960) to abundance ranks. It is defined only by the observed number of
elements <code>S</code> in the collection and collection size <code>N</code>.
Therefore, once a sample is taken,
the Broken-stick has no free parameters.
Therefore, there is no actual fitting, but still
the <code>fitrbs</code> calls
<code>mle2</code> with
fixed parameters N and S and <code>eval.only=TRUE</code>
to return an object of <code>fitrad-class</code>
to keep compatibility with other
RAD models fitted to the same data.
Therefore the resulting objects allows most of the
operations with RAD models, such as
comparison with other models through model selection,
diagnostic plots and so on
(see fitrad-class).
</p>
<p><code>fitzipf</code> and <code>fitmand</code> fit the Zipf distribution and its
two-parameter generalization, the Zipf-Mandelbrodt distribution. Both
are discrete power-law distributions commonly proposed as RAD models,
though they in general provide poor fit to species abundances (Newman 2005).
</p>


<h3>Value</h3>

<p>An object of <code>fitrad-class</code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle rank-abundance models.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from 'bbmle' package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods.
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Doi, H. and Mori, T. 2012. The discovery of species-abundance
distribution in an ecological community. <em>Oikos 122:</em> 179–182.
</p>
<p>He, F. and Tang, D. 2008. Estimating the niche preemption parameter
of the geometric series. <em>Acta Oecologica 33:</em> 105–107.
</p>
<p>MacArthur, R.H. 1960. On the relative abundance of species.
<em>Am Nat 94</em>:25–36.
</p>
<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
Cody, M.L. and Diamond, J.M. (Eds) <em>Ecology and Evolution of
Communities</em>. Harvard University Press. pp 81–120.
</p>
<p>Newman, M.E.J. 2005. Power laws, Pareto distributions and Zipf's law.
<em>Contemporary Physics, 46:</em> 323–351.
</p>
<p>Whittaker, R.H. 1965. Dominance and diversity in land plant
communities. <em>Science 147</em>: 250–260.
</p>


<h3>See Also</h3>

<p><code>dgs</code>, <code>dmand</code>, <code>drbs</code>,
<code>dzipf</code>,
for corresponding density functions created for fitting RADs;
<code>fitrad-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Figure 2 of Motomura (1932)
data(okland)
plot(rad(okland))
ok.gs &lt;- fitrad(okland, "gs")
lines(radpred(ok.gs))

## Comparison with Zipf-Mandelbrodt
ok.zm &lt;- fitrad(okland, "mand")
AICctab(ok.gs, ok.zm, nobs=length(okland))
lines(radpred(ok.zm), col="red")
</code></pre>


</div>