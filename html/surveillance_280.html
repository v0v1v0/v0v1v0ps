<div class="container">

<table style="width: 100%;"><tr>
<td>hhh4_predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictions from a <code>hhh4</code> Model</h2>

<h3>Description</h3>

<p>Get fitted (component) means from a <code>hhh4</code> model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'hhh4'
predict(object, newSubset=object$control$subset,
        type="response", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>fitted <code>hhh4</code> model (class <code>"hhh4"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newSubset</code></td>
<td>
<p>subset of time points for which to return the
predictions. Defaults to the subset used for fitting the model, and
must be a subset of <code>1:nrow(object$stsObj)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of prediction required. The default
(<code>"response"</code> or, equivalently, <code>"mean"</code>) is on the 
scale of the response variable (mean = endemic plus epidemic components).
The alternatives are: <code>"endemic"</code>, <code>"epidemic"</code>,
<code>"epi.own"</code> (i.e. the autoregressive part), and
<code>"epi.neighbours"</code> (i.e. the spatio-temporal part).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>unused (argument of the generic).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>matrix of fitted means for each time point (of <code>newSubset</code>) and region.
</p>


<h3>Note</h3>

<p>Predictions for “newdata”, i.e., with modified covariates or
fixed weights, can be computed manually by adjusting the control list
(in a copy of the original fit), dropping the old <code>terms</code>, and using
the internal function <code>meanHHH</code> directly, see the Example.
</p>


<h3>Author(s)</h3>

<p>Michaela Paul and Sebastian Meyer</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate simple seasonal noise with reduced baseline for t &gt;= 60
t &lt;- 0:100
y &lt;- rpois(length(t), exp(3 + sin(2*pi*t/52) - 2*(t &gt;= 60)))
obj &lt;- sts(y)
plot(obj)

## fit true model
fit &lt;- hhh4(obj, list(end = list(f = addSeason2formula(~lock)),
                      data = list(lock = as.integer(t &gt;= 60)),
                      family = "Poisson"))
coef(fit, amplitudeShift = TRUE, se = TRUE)

## compute predictions for a subset of the time points
stopifnot(identical(predict(fit), fitted(fit)))
plot(obj)
lines(40:80, predict(fit, newSubset = 40:80), lwd = 2)


## advanced: compute predictions for "newdata" (here, a modified covariate)
mod &lt;- fit
mod$terms &lt;- NULL  # to be sure
mod$control$data$lock[t &gt;= 60] &lt;- 0.5
pred &lt;- meanHHH(mod$coefficients, terms(mod))$mean
plot(fit, xaxis = NA)
lines(mod$control$subset, pred, lty = 2)
</code></pre>


</div>