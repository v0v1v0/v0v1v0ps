<div class="container">

<table style="width: 100%;"><tr>
<td>get_session</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get or set the local selenider session</h2>

<h3>Description</h3>

<p>Change the locally defined <code>selenider_session()</code> object, allowing it to be
used in functions like <code>s()</code> without explicitly providing it.
</p>
<p><code>get_session()</code> retrieves the current local session. If none have been
created, a session is created automatically.
</p>
<p><code>local_session()</code> sets the local session. The function uses <code>withr::defer()</code>
to make sure the session is closed and the local session is set to its
previous value when it is no longer needed.
</p>
<p><code>with_session()</code> runs some code with a temporary local session. The session
is closed and the local session is set to its previous value when the code
finishes executing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_session(create = TRUE, .env = rlang::caller_env())

local_session(session, .local_envir = rlang::caller_env(), close = TRUE)

with_session(session, code, close = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>create</code></td>
<td>
<p>If a session is not found, should we create a new one? If this
is <code>FALSE</code> and a session is not found, <code>NULL</code> is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.env</code></td>
<td>
<p>If <code>get_session()</code> creates a session, the environment where this
session is being used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>session</code></td>
<td>
<p>The <code>selenider_session()</code> object to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.local_envir</code></td>
<td>
<p>The environment where the session is being used. When
the function associated with this environment finishes execution, the
session will be reset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>close</code></td>
<td>
<p>Should we close <code>session</code> when the local session is reset? Set
this to <code>FALSE</code> if you want to use the session even if it is no longer the
local session. If you want to close the session manually, use
<code>close_session()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>The code to run with the local session set.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use <code>withr::deferred_run()</code> to reset any local sessions set using
<code>local_session()</code>.
</p>


<h3>Value</h3>

<p><code>get_session()</code> returns the local <code>selenider_session()</code> object (or a newly
created session).
</p>
<p><code>local_session()</code> returns the <em>previous</em> local session object (or <code>NULL</code>).
This is the same as running <code>get_session()</code> before this function.
</p>
<p><code>with_session()</code> returns the result of <code>code</code>.
</p>


<h3>See Also</h3>

<p><code>selenider_session()</code>, which calls <code>local_session()</code> unless otherwise
specified.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Don't set the local session, since we want to do it manually.
session &lt;- selenider_session(local = FALSE)

get_session(create = FALSE) # NULL

local_session(session, close = FALSE)

get_session(create = FALSE)

withr::deferred_run()

get_session(create = FALSE) # NULL

# By default, the local session is only set inside the function that it is
# called.
# If we want to set the local session outside the scope of a function, we
# need to use the `.local_envir` argument.
set_my_session &lt;- function(env = rlang::caller_env()) {
  # caller_env() is the environment where the function is called.
  local_session(session, .local_envir = env, close = FALSE)
}

set_my_session()

with_session(
  session,
  {
    get_session(create = FALSE)
  },
  close = FALSE
)

get_session(create = FALSE)

</code></pre>


</div>