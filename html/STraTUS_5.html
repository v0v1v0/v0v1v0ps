<div class="container">

<table style="width: 100%;"><tr>
<td>sample.partial.tt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Resample the subtree rooted at any tree node, keeping the annotations for the rest of the tree fixed</h2>

<h3>Description</h3>

<p>Resample the subtree rooted at any tree node, keeping the annotations for the rest of the tree fixed
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample.partial.tt(
  generator,
  count = 1,
  unsampled = 0,
  starting.node = phangorn::getRoot(generator$tree),
  existing = NULL,
  check.integrity = TRUE,
  draw = count == 1,
  igraph = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>generator</code></td>
<td>
<p>A list of class <code>tt.generator</code> produced by <code>tt.generator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>How many transmission trees to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unsampled</code></td>
<td>
<p>The number of unsampled hosts in the transmission chain. (The whole transmission chain, even if only part of the transmission tree is being resampled). A value &gt;0 requires a <code>generator</code> list whose <code>type</code> is <code>unsampled</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.node</code></td>
<td>
<p>The root of the subtree to resample. If this is the root of the whole tree, then <code>existing</code> is irrelevent (but generally <code>sample.tt</code> should be used for this purpose).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>existing</code></td>
<td>
<p>An existing list of class <code>tt</code>, representing a transmission tree to be modified. Usually these are produced by a <code>sample.tt</code> or <code>sample.partial.tt</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.integrity</code></td>
<td>
<p>Whether to check if <code>existing</code> is indeed a valid transmission tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>Use <code>ggtree</code> to draw a coloured phylogeny showing each transmission tree overload onto the phylogeny</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>igraph</code></td>
<td>
<p>Produce the transmission trees in <code>igraph</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list, each of whose elements is a list of class <code>tt</code> with one or more of the following elements:
</p>

<ul>
<li>
<p><code>annotations</code> Always present. A vector indicating which host (given by numbers corresponding to the ordering in <code>generator$hosts</code>) is assigned to each phylogeny node.
</p>
</li>
<li>
<p><code>edgelist</code> Always present. A <code>data.frame</code> giving the edge list; the first column are parents and the second children.
</p>
</li>
<li>
<p><code>hidden</code> Present if <code>unsampled</code> is greater than 0. The number of "hidden" unsampled hosts (with no associated nodes) along each branch.
</p>
</li>
<li>
<p><code>picture</code> Present if <code>draw</code> was TRUE; a <code>ggtree</code> object.
</p>
</li>
<li>
<p><code>igraph</code> Present if <code>igraph</code> was TRUE; an <code>igraph</code> object.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># draw one sample from the uniform distribution
generator &lt;- tt.generator(stratus.example.tree)
samples &lt;- sample.tt(generator, 1, draw = TRUE)
original.tt &lt;- samples[[1]]
# sample anew, from node 31 downwards
revised.tt &lt;- sample.partial.tt(generator, 1, starting.node = 31, 
    existing = original.tt, draw = TRUE)
</code></pre>


</div>