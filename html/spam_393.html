<div class="container">

<table style="width: 100%;"><tr>
<td>rgrf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw From a Gaussian Random Field</h2>

<h3>Description</h3>

<p>Fast and intuitive ways to draw from a Gaussian random field.</p>


<h3>Usage</h3>

<pre><code class="language-R">rgrf( n,
   locs, nx, ny=nx, xlim=c(0,1), ylim=c(0,1), tau=0,
   Covariance, theta, beta=0, X, 
   method=c('chol'),  method.args=list(sparse=FALSE), 
   eps = getOption("spam.eps"), drop=TRUE, attributes=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs</code></td>
<td>
<p>locations, the result of <code>as.matrix(locs)</code> will be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx,ny</code></td>
<td>
<p>if no locations are specified, at least one of these to
specify the grid dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim,ylim</code></td>
<td>
<p>Domain, see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>perturbation degree, see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariance</code></td>
<td>
<p>covariance function name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>covariance parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>mean or vector for regression-type mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix for regression-type mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>based on Choleski factorization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.args</code></td>
<td>
<p>list of arguments that can be passed to the corresponding approach.
For <code>"chol"</code> it can be, e.g., <code>RStruct</code>, <code>chol.args</code>, <code>cov.args</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>small value, anything smaller is considered a collocation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical, if a single realization should be returned as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attributes</code></td>
<td>
<p>logical, if should attributes be passed back.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no locations are given, the function constructs these
according a regular or a regular perturbed grid. The perturbation is
determined by <code>tau</code>, which has to be greater than zero (no
perturbation) and strictly smaller than 1/2 (max perturbation).
</p>
<p>The regular grid has spacing (here for x) <code>dx=diff(xlim)/nx</code> and runs
from <code>xlim[1]+dx/2</code> to <code>xlim[2]-dx/2</code>.
The locations are at least  <code>(1/nx-2*tau*dx)</code> separated.
<br></p>
<p>Currently, the only method implemented is a Cholesky factorization
routine,  (much as in <code>rmvnorm</code>).
</p>
<p>The <code>rdist()</code> from the <code>fields</code> package is awefully
fast. Unless one has very sparse covariance matrices, a sparse
approach is not bringing a lot of improvements. 
</p>
<p>The methods may use different covariance construction approaches and
thus the nesting of <code>cov.args</code> in <code>method.args</code>.
</p>


<h3>Author(s)</h3>

<p>Reinhard Furrer</p>


<h3>See Also</h3>

<p><code>rgrf</code>, <code>chol</code> and <code>ordering</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(fields)
# Regular grid with constant mean:
nx &lt;- 10
field &lt;- rgrf(1, nx=nx,  Covariance="cov.wend2", theta=c(.5, 1), beta=5)
quilt.plot(cbind(attr(field,"locs"),z=field), nx=nx, ny=nx)
points(attr(field,"locs"))

# Irregluar grid:
field &lt;- rgrf(1, nx=10, tau=0.3, Covariance="cov.mat", theta=c(.2, 1, 1.5))
fields::quilt.plot(attr(field,"locs"), field)

</code></pre>


</div>