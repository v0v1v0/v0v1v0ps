<div class="container">

<table style="width: 100%;"><tr>
<td>usual_illness_death_weight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit MSM Illness-death Usual Markov Model For Semi-competing Risks Data
</h2>

<h3>Description</h3>

<p>Fit the marginal structural three-state illness-death model with Cox representation and IP weights for semi-competing risks data. Inference under this model can be carried out using estimating equations with IP weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">usual_illness_death_weight(data,X1,X2,event1,event2,w,Trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>The dataset, includes non-terminal events, terminal events as well as event indicator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>

<p>Time to non-terminal event, could be censored by terminal event or lost to follow up.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>

<p>Time to terminal event, could be censored by lost to follow up.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event1</code></td>
<td>

<p>Event indicator for non-terminal event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event2</code></td>
<td>

<p>Event indicator for terminal event.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>IP weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trt</code></td>
<td>

<p>Treatment variable.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">T_1</code>, <code class="reqn">T_2</code> be the time to non-terminal event and terminal event, A be the treatment assignment. We postulate the semi-parametric Cox models for three transition rates in marginal structural illness-death model:
</p>
<p style="text-align: center;"><code class="reqn">
    \lambda_{1}(t_1 ; a) = \lambda_{01}(t)e^{\beta_1 a}, t_1 &gt; 0 ;
</code>
</p>

<p style="text-align: center;"><code class="reqn">
    \lambda_{2}(t_2 ; a) = \lambda_{02}(t)e^{\beta_2 a}, t_2 &gt; 0 ;
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
    \lambda_{12}(t_2 \mid t_1 ; a) = \lambda_{03}(t_2)e^{\beta_3 a}, 0 &lt; t_1 &lt;  t_2 .
</code>
</p>

<p>The coefficients as well as Breslow type baseline hazards can be estimated by fitting the IP weights Cox proportional hazards models. Meanwhile, if we assume the estimated weights as known, then the robust sandwich variance estimator can be used to obtain the estimated variance.
</p>
<p>The usual Markov model is also the same as the initial value for the general Markov model.
</p>


<h3>Value</h3>

<p>A list of values and dataframes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>

<p>Estimated <code class="reqn">\beta_1</code>, the coefficient for the non-terminal event model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta2</code></td>
<td>

<p>Estimated <code class="reqn">\beta_2</code>, the coefficient for the terminal event without non-terminal event model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta3</code></td>
<td>

<p>Estimated <code class="reqn">\beta_3</code>, the coefficient for the terminal event following non-terminal event model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_beta1</code></td>
<td>

<p>Model based standard error for <code class="reqn">\beta_1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_beta2</code></td>
<td>

<p>Model based standard error for  <code class="reqn">\beta_2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_beta3</code></td>
<td>

<p>Model based standard error for  <code class="reqn">\beta_3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda01</code></td>
<td>

<p>See also <code>get_hazard</code>. List of two dataframes for estimated <code class="reqn"> \Lambda_{01} </code> and <code class="reqn"> \lambda_{01} </code>, the estimated (cumulative) baseline hazard for the non-terminal event model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda02</code></td>
<td>

<p>List of two dataframes for estimated <code class="reqn"> \Lambda_{02} </code> and <code class="reqn"> \lambda_{02} </code>, the estimated (cumulative) baseline hazard for the terminal event without non-terminal event model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda03</code></td>
<td>

<p>List of two dataframes for estimated <code class="reqn"> \Lambda_{03} </code> and <code class="reqn"> \lambda_{03} </code>, the estimated (cumulative) baseline hazard for the terminal event following non-terminal event model.
</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
set.seed(1234)
Cens = runif(n,0.7,0.9)
set.seed(1234)
OUT1 &lt;- sim_cox_msm_semicmrsk(beta1 = 1,beta2 = 1,beta3 = 0.5,
                              sigma_2 = 1,
                              alpha0 = 0.5, alpha1 = 0.1, alpha2 = -0.1, alpha3 = -0.2,
                              n=n, Cens = Cens)
data_test &lt;- OUT1$data0

## Get the PS weights
vars &lt;- c("Z1","Z2","Z3")
ps1 &lt;- doPS(data = data_test,
            Trt = "A",
            Trt.name = 1,
            VARS. = vars,
            logistic = TRUE,w=NULL)
w &lt;- ps1$Data$ipw_ate_stab

### Fit the Usual Markov model
res1 &lt;- usual_illness_death_weight(data = data_test,
                                   X1 = "X1",
                                   X2 = "X2",
                                   event1 = "delta1",
                                   event2 = "delta2",
                                   w = w,
                                   Trt = "A")
print(paste("The estimated value for beta1 is:", round(res1$beta1,5) ) )

</code></pre>


</div>