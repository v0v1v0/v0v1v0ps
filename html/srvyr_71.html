<div class="container">

<table style="width: 100%;"><tr>
<td>group_map_dfr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a function to each group</h2>

<h3>Description</h3>

<p><code>group_map()</code>, <code>group_walk</code> and <code>group_map_dfr</code> are purrr-style
functions that can be used to iterate on grouped survey objects (note that
<code>group_map_dfr</code> replaces <code>dplyr::group_modify</code> because we are changing
the data from a <code>tbl_svy</code> to a regular tibble).
</p>


<h3>Usage</h3>

<pre><code class="language-R">group_map_dfr(.data, .f, ..., .keep = FALSE)

## S3 method for class 'tbl_svy'
group_map(.data, .f, ..., .keep = FALSE)

group_map_dfr(.data, .f, ..., .keep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A <code>tbl_svy object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.f</code></td>
<td>
<p>A function or purrr-style formula to apply to each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>.f</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.keep</code></td>
<td>
<p>Whether the grouping variables are kept when passed into <code>.f</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>group_map</code> a list, for <code>group_map_dfr</code> a 'tbl_df', and for
<code>group_walk</code> invisibly the original <code>tbl_svy</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(api, package = "survey")
dstrata &lt;- apistrat %&gt;%
  as_survey_design(strata = stype, weights = pw)

results &lt;- dstrata %&gt;%
  group_by(both) %&gt;%
  group_map(~survey::svyglm(api00~api99 + stype, .))

# group_map_dfr calls `bind_rows` on the list returned and includes
# grouping variables. This is most useful with a package like `broom`
# but could also be used with survey package functions.
result_coef &lt;- dstrata %&gt;%
  group_by(both) %&gt;%
  group_map_dfr(
    ~data.frame(
      api99_coef = coef(survey::svyglm(api00~api99 + stype, .))[["api99"]]
    )
  )

</code></pre>


</div>