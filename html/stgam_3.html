<div class="container">

<table style="width: 100%;"><tr>
<td>do_bma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Undertake undertake coefficient averaging using Bayesian Model Avergaing (BMA), weighting different models by their probabilities</h2>

<h3>Description</h3>

<p>Undertake undertake coefficient averaging using Bayesian Model Avergaing (BMA), weighting different models by their probabilities
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_bma(model_table, terms, thresh = 0.1, relative = FALSE, input_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model_table</code></td>
<td>
<p>a table of competing models generated by the <code>gam_model_probs()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>a vector of names starting with "Intercept" plus the names of the covariates used in the GAM model (these are the names of the variables in  <code>data</code> )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>a probability threshold value above which to combine competing models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>logical to indicate whether the probabilities in <code>data</code> are relative (<code>Pr(M)</code>) or absolute (<code>Pr(M|D)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_data</code></td>
<td>
<p>the input data with a named Intercept term, in <code>data.frame</code>, <code>tibble</code> or <code>sf</code> format</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>matrix</code> of the probability weighted averaged coefficient estimates from multiple models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(cols4all)
library(dplyr)
library(sf)
library(glue)
library(purrr)
library(mgcv)
library(sf)
library(ggplot2)
# data
data(productivity)
input_data = productivity |&gt; filter(year == "1970") |&gt; mutate(Intercept = 1)
# create and evaluate multiple models
svc_res_gam = evaluate_models(input_data, STVC = FALSE)
# determine their probabilities
mod_comp_svc &lt;- gam_model_probs(svc_res_gam)
# combine the model coefficients
svc_bma &lt;- do_bma(mod_comp_svc,
                  terms = c("Intercept", "unemp", "pubC"),
                  thresh = 0.1,
                  relative = FALSE,
                  input_data = input_data)
head(svc_bma)
# join back to spatial layer
data(us_data)
svc_bma_sf &lt;-
us_data |&gt;
select(GEOID) |&gt;
left_join(productivity |&gt;
  filter(year == "1970") |&gt;
  select(GEOID, year) |&gt;
  cbind(svc_bma)) |&gt;
  relocate(geometry, .after = last_col())
# and map
tit =expression(paste(""*beta[`Public Capital`]*" "))
ggplot(data = svc_bma_sf, aes(fill=pubC)) +
  geom_sf() +
  scale_fill_continuous_c4a_div(palette="brewer.yl_or_rd",name=tit) +
  coord_sf() +
  theme_linedraw()
</code></pre>


</div>