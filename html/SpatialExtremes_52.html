<div class="container">

<table style="width: 100%;"><tr>
<td>map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produces a 2D map from a fitted max-stable process</h2>

<h3>Description</h3>

<p>Produces a 2D map from a fitted max-stable process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">map(fitted, x, y, covariates = NULL, param = "quant", ret.per = 100, col
= terrain.colors(64), plot.contour = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class <code>maxstab</code>. Most often, it will
be the output of the function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>Numeric vector that gives the coordinates of the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>An array specifying the covariates at each grid
point defined by <code>x</code> and <code>y</code>. If <code>NULL</code>, no covariate
is needed. See the example to see how to build it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A character string. Must be one of "loc", "scale",
"shape" or "quant" for a map of the location, scale, shape
parameters or for a map of a specified quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.per</code></td>
<td>
<p>A numeric giving the return period for which the
quantile map is plotted. It is only required if <code>param =
      "quant"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A list of colors such as that generated by 'rainbow',
'heat.colors', 'topo.colors', 'terrain.colors' or similar
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.contour</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), contour lines
are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Several arguments to be passed to the <code>image</code>
function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot. Additionally, a list with the details for plotting the map is
returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>See Also</h3>

<p><code>condmap</code>, <code>filled.contour</code>,
<code>heatmap</code>, <code>heat.colors</code>,
<code>topo.colors</code>, <code>terrain.colors</code>,
<code>rainbow</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##We run an artifical example using the volcano data set as a study
##region
dim &lt;- dim(volcano)
n.x &lt;- dim[1]
n.y &lt;- dim[2]

x &lt;- 10 * 1:n.x
y &lt;- 10 * 1:n.y

n.site &lt;- 15
idx.x &lt;- sample(n.x, n.site)
idx.y &lt;- sample(n.y, n.site)
locations &lt;- cbind(lon = x[idx.x], lat = y[idx.y])
alt &lt;- diag(volcano[idx.x, idx.y])

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(40, locations, cov.mod = "whitmat", nugget = 0, range = 750,
smooth = 1)

##Now define the spatial model for the GEV parameters
param.loc &lt;- -10 - 0.04 * locations[,1] + alt / 5
param.scale &lt;- 5 - locations[,2] / 30 + alt / 4
param.shape &lt;- rep(.2, n.site)

##Transform the unit Frechet margins to GEV
for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], param.loc[i], param.scale[i],
param.shape[i])

##Define a model for the GEV margins to be fitted
##shape ~ 1 stands for the GEV shape parameter is constant
##over the region
loc.form &lt;- loc ~ lon + alt
scale.form &lt;- scale ~ lat + alt
shape.form &lt;- shape ~ 1

##  1- Fit a max-stable process
schlather &lt;- fitmaxstab(data, locations, "whitmat", loc.form, scale.form,
                        shape.form, marg.cov = cbind(alt = alt), nugget
= 0)

##  2- Produce a map of the pointwise 50-year return level

##Here we have only one covariate i.e. alt
n.cov &lt;- 1
covariates &lt;- array(volcano, dim = c(n.x, n.y, n.cov), dimnames =
list(NULL, NULL, "alt"))

par(mfrow = c(1,2))
image(x, y, volcano, col = terrain.colors(64), main = "Elevation map")
map(schlather, x, y, covariates, ret.per = 50, plot.contour = FALSE,
main = "50-year return level")
</code></pre>


</div>