<div class="container">

<table style="width: 100%;"><tr>
<td>SE.EQ.dissolution.profiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The SE-test for equivalence for dissolution profile similarity analyses
</h2>

<h3>Description</h3>

<p>The function <code>SE.EQ.dissolution.profiles()</code> implements a variant of the 
SE-test for equivalence with a concrete equivalence margin for analyses of 
dissolution profiles. It is a multivariate two-sample equivalence procedure. 
Distance measure of the test is the sum of standardized differences between the
expected values or in other words: the sum of effect sizes of all components 
of the two multivariate samples. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">SE.EQ.dissolution.profiles(X, Y, alpha = 0.05, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>numeric data matrix of the first sample (REF). The rows of <code>X</code> contain the 
individual observations of the REF sample, the columns contain the 
variables/components of the multivariate sample. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>numeric data matrix of the second sample (TEST). The rows of <code>Y</code> contain 
the individual observations of the TEST sample, the columns contain the 
variables/components of the multivariate sample. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric (0&lt;<code>alpha</code>&lt;1). The significance level of the SE-test for 
equivalence. Usually set to 0.05 which is the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.results</code></td>
<td>

<p>logical; if TRUE (default) summary statistics and test results are printed 
in the output. If FALSE no output is created 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>SE.EQ.dissolution.profiles()</code> implements a variant 
of the SE-test for equivalence for similarity analyses of dissolution 
profiles as mentioned in Suarez-Sharp et al.(2020) 
&lt;DOI:10.1208/s12248-020-00458-9&gt;). The equivalence margin  
is analogically defined as for the T2EQ
approach according to Hoffelder (2019) &lt;DOI:10.1002/bimj.201700257&gt;) 
by means of a systematic shift in location
of 10 [% of label claim] of both dissolution profile populations. 
<code>SE.EQ.dissolution.profiles()</code> checks whether the weighted mean of the 
differences between the expected values of both dissolution profile populations 
is statistically significantly smaller than 10 [% of label claim]. The 
weights are built up by the inverse variances.
</p>
<p>The current regulatory standard approach for comparing dissolution profiles 
is the similarity factor f2 (see FDA, 1997, EMA, 2010, among others)
with which the type I error cannot be controlled. According to EMA (2010)
"similarity acceptance limits should be pre-defined and justified and not be 
greater than a 10% difference". The functions
</p>

<ul>
<li> <p><code>SE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code>EDNE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code>T2EQ.dissolution.profiles.hoffelder</code>
</p>
</li>
</ul>
<p>and f2 have in common that they all check wether a kind of average difference 
between the expected values is smaller than 10 [% of label claim]
(see Suarez-Sharp et al., 2020). Thus, all three methods 
</p>

<ul>
<li> <p><code>SE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code>EDNE.EQ.dissolution.profiles</code>
</p>
</li>
<li> <p><code>T2EQ.dissolution.profiles.hoffelder</code>
</p>
</li>
</ul>
<p>are compliant with current regulatory requirements. In contrast to the 
standard approach f2 they all
allow (at least approximate) type I error control.
</p>


<h3>Value</h3>

<p>a data frame; three columns containing the results of the test
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>numeric; the p-value of the SE test for equivalence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testresult.num</code></td>
<td>
<p>numeric; 0 (null hypothesis of nonequivalence not rejected) or 1 (null hypothesis of nonequivalence rejected, decision in favor of equivalence)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testresult.text</code></td>
<td>
<p>character; test result of the test in text mode</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas Hoffelder &lt;thomas.hoffelder at boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>EMA (2010). Guidance on the Investigation of Bioequivalence.
European Medicines Agency, CHMP, London. Doc. 
Ref.: CPMP/EWP/QWP/1401/98 Rev. 1/ Corr **. 
URL: <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>FDA (1997). Guidance for Industry: Dissolution Testing of Immediate Release 
Solid Oral Dosage Forms. 
Food and Drug Administration FDA, CDER, Rockville.
URL: <a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>Hoffelder, T., Goessl, R., Wellek, S. (2015). Multivariate Equivalence Tests 
for Use in Pharmaceutical Development. 
<em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>
<p>Hoffelder, T. (2019) Equivalence analyses of dissolution profiles with the 
Mahalanobis distance. 
<em>Biometrical Journal</em>, 61:5, 1120-1137. 
URL: <a href="https://doi.org/10.1002/bimj.201700257">https://doi.org/10.1002/bimj.201700257</a>
</p>
<p>Suarez-Sharp, S., Abend, A., Hoffelder, T., Leblond, D., Delvadia, P., Kovacs, 
E., Diaz, D.A. (2020). In Vitro Dissolution Profiles Similarity Assessment in 
Support of Drug Product Quality: What, How, When - Workshop Summary Report. 
<em>The AAPS Journal</em>, 22:74.
URL: <a href="http://dx.doi.org/10.1208/s12248-020-00458-9">http://dx.doi.org/10.1208/s12248-020-00458-9</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Apart from simulation errors, a recalculation of the SE results 
# of some parts (normal distribution only) of the simulation study in 
# Hoffelder et al. (2015) can be done with the following code. Please note that 
# the simulation takes approximately 20 minutes for 50.000 simulation 
# runs (number_of_simu_runs &lt;- 50000). To shorten calculation time for 
# test users, number_of_simu_runs is set to 100 here and can/should be adapted.
# In the result of the simulation the variable empirical.size.se presents the
# simulated size obtained by function \code{SE.EQ()} whereas variable 
# empirical.size.se.disso shows the
# simulated size obtained by function \code{SE.EQ.dissolution.profiles()}. 
# A detailed analysis of the operating characteristics of the SE variant 
# implemented in \code{SE.EQ.dissolution.profiles()} is the content of 
# a future paper.


library(MASS)
number_of_simu_runs &lt;- 100
set.seed(2020)

mu1 &lt;- c(41,76,97)
mu2 &lt;- mu1 - c(10,10,10)
SIGMA_1 &lt;- matrix(data = c(537.4 , 323.8 , 91.8 ,
                           323.8 , 207.5 , 61.7 ,
                           91.8  , 61.7  , 26.1) ,ncol = 3)
SIGMA_2 &lt;- matrix(data = c(324.1 , 233.6 , 24.5 ,
                           233.6 , 263.5 , 61.4 ,
                           24.5  , 61.4  , 32.5) ,ncol = 3)
SIGMA   &lt;- matrix(data = c(430.7 , 278.7 , 58.1 ,
                           278.7 , 235.5 , 61.6 ,
                           58.1  , 61.6  , 29.3) ,ncol = 3)


SIMULATION_SIZE_SE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                               ,  n_per_group , n_simus ) {
  
  n_success_SE        &lt;- 0
  n_success_SE_disso  &lt;- 0
  if 	( Hom == "Yes" ) 	{
    COVMAT_1 &lt;- SIGMA
    COVMAT_2 &lt;- SIGMA
  }
  else 	   {
    COVMAT_1 &lt;- SIGMA_1
    COVMAT_2 &lt;- SIGMA_2
  } 
  if 	( Var == "Low" ) 	{
    COVMAT_1 &lt;- COVMAT_1 / 4
    COVMAT_2 &lt;- COVMAT_2 / 4
  }
  
  d &lt;- ncol(COVMAT_1)
  Mean_diff &lt;- mu_1 - mu_2                    # Difference of both exp. values
  vars_X      &lt;- diag(COVMAT_1)               #  variances of first sample
  vars_Y      &lt;- diag(COVMAT_2)               #  variances of second sample
  dist_SE     &lt;- sum( (Mean_diff * Mean_diff) / (0.5 * (vars_X + vars_Y) ) )   
     # true SE distance and equivalence margin for SE.EQ
  
  
  if 	( n_per_group == 10 ) 	{
    cat("Expected value sample 1:",mu_1,"\n",
        "Expected value sample 2:",mu_2,"\n",
        "Covariance matrix sample 1:",COVMAT_1,"\n",
        "Covariance matrix sample 2:",COVMAT_2,"\n",
        "EM_SE:",dist_SE,"\n")
  }  
  
  for (i in 1:n_simus)  {
    if 	( disttype == "Normal" ) 	{
      REF &lt;- mvrnorm(n = n_per_group, mu=mu_1, Sigma=COVMAT_1)
      TEST&lt;- mvrnorm(n = n_per_group, mu=mu_2, Sigma=COVMAT_2)
    }
    n_success_SE_disso  &lt;- n_success_SE_disso + 
                            SE.EQ.dissolution.profiles( X = REF ,
                                                        Y = TEST , 
                                                        print.results = FALSE
                                                      )$testresult.num
    n_success_SE        &lt;- n_success_SE   + 
                            SE.EQ( X=REF , 
                                   Y=TEST , 
                                   eq_margin = dist_SE , 
                                   print.results = FALSE
                                  )$testresult.num
  }
  empirical_succ_prob_SE        &lt;- n_success_SE / n_simus  
  empirical_succ_prob_SE_disso  &lt;- n_success_SE_disso / n_simus  
  simuresults  &lt;- data.frame(dist = disttype , Hom = Hom , Var = Var 
                     , dimension = d , em_se = dist_SE 
                     , sample.size = n_per_group 
                     , empirical.size.se = empirical_succ_prob_SE
                     , empirical.size.se.disso = empirical_succ_prob_SE_disso)
}

SIMULATION_LOOP_SAMPLE_SIZE &lt;- function(disttype , Hom , Var 
                                        , mu_1 , mu_2 ,  n_simus ) {
  
  run_10  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 10 , n_simus = n_simus) 
  run_30  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 30 , n_simus = n_simus) 
  run_50  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 50 , n_simus = n_simus) 
  run_100 &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 100 , n_simus = n_simus) 
  RESULT_MATRIX &lt;- rbind(run_10 , run_30 , run_50 , run_100)
  RESULT_MATRIX                               
}

simu_1 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "High" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_2 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "Low" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_3 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "High" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_4 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "Low" , mu_1 = mu1  , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)

FINAL_RESULT &lt;- rbind(simu_1 , simu_2 , simu_3 , simu_4)

cat("******  Simu results n_simu_runs: ",number_of_simu_runs,"   ***** \n")
FINAL_RESULT
</code></pre>


</div>