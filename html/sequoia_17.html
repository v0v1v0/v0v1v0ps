<div class="container">

<table style="width: 100%;"><tr>
<td>ErrToM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Genotyping Error Matrix</h2>

<h3>Description</h3>

<p>Make a vector or matrix specifying the genotyping error
pattern, or a function to generate such a vector/matrix from a single
value Err.
</p>
<p>with the probabilities of observed genotypes
(columns) conditional on actual genotypes (rows), or return a function to
generate such matrices (using a single value Err as input to that
function).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ErrToM(Err = NA, flavour = "version2.9", Return = "matrix")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Err</code></td>
<td>
<p>estimated genotyping error rate, as a single number, or 3x3 or 4x4
matrix, or length 3 vector. If a single number, an error model is used that
aims to deal with scoring errors typical for SNP arrays. If a matrix, this
should be the probability of observed genotype (columns) conditional on
actual genotype (rows). Each row must therefore sum to 1. If
<code>Return='function'</code>, this may be <code>NA</code>. If a vector, these are the
probabilities (observed given actual) hom|other hom, het|hom, and hom|het.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flavour</code></td>
<td>
<p>vector-generating or matrix-generating function, or one of
'version2.9', 'version2.0', 'version1.3' (='SNPchip'), 'version1.1'
(='version111'), referring to the sequoia version in which it was used as
default. Only used if <code>Err</code> is a single number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Return</code></td>
<td>
<p>output, 'matrix' (default), 'vector', 'function'
(matrix-generating), or 'v_function' (vector-generating)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default (<code>flavour</code> = "version2.9"), <code>Err</code> is
interpreted as a locus-level error rate (rather than allele-level), and
equals the probability that an actual heterozygote is observed as either
homozygote (i.e., the probability that it is observed as AA = probability
that observed as aa = <code>Err</code>/2). The probability that one homozygote is
observed as the other is (<code>Err</code>/2<code class="reqn">)^2</code>.
</p>
<p>The inbuilt 'flavours' correspond to the presumed and simulated error
structures, which have changed with sequoia versions. The most appropriate
error structure will depend on the genotyping platform; 'version0.9' and
'version1.1' were inspired by SNP array genotyping while 'version1.3' and
'version2.0' are intended to be more general.
</p>
<p>This function, and throughout the package, it is assumed that the two alleles
<code class="reqn">A</code> and <code class="reqn">a</code> are equivalent. Thus, using notation <code class="reqn">P</code>(observed
genotype |actual genotype), that <code class="reqn">P(AA|aa) = P(aa|AA)</code>,
<code class="reqn">P(aa|Aa)=P(AA|Aa)</code>, and <code class="reqn">P(aA|aa)=P(aA|AA)</code>.
</p>

<table>
<tr>
<td style="text-align: left;">
 <strong>version</strong> </td>
<td style="text-align: center;"> <strong>hom|hom</strong> </td>
<td style="text-align: center;"> <strong>het|hom</strong> </td>
<td style="text-align: center;">
<strong>hom|het</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2.9</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E-(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2.0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E(1-E/2)</code>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1.3</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E</code>   </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1.1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>     </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0.9</strong>  </td>
<td style="text-align: center;"> <code class="reqn">0</code>       </td>
<td style="text-align: center;"> <code class="reqn">E</code>   </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>or in matrix form, Pr(observed genotype (columns) | actual genotype (rows)):
</p>
<p><em>version2.9:</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: center;"> <strong>0</strong> </td>
<td style="text-align: center;"> <strong>1</strong> </td>
<td style="text-align: center;"> <strong>2</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
<td style="text-align: center;"> <code class="reqn">E -(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>       </td>
<td style="text-align: center;"> <code class="reqn">1-E</code>      </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>    </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code>   </td>
<td style="text-align: center;"> <code class="reqn">E -(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><em>version2.0:</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: center;"> <strong>0</strong> </td>
<td style="text-align: center;"> <strong>1</strong> </td>
<td style="text-align: center;"> <strong>2</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(1-E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E(1-E/2)</code> </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>       </td>
<td style="text-align: center;"> <code class="reqn">1-E</code>      </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>    </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code>   </td>
<td style="text-align: center;"> <code class="reqn">E(1-E/2)</code> </td>
<td style="text-align: center;"> <code class="reqn">(1-E/2)^2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><em>version1.3</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: center;"> <strong>0</strong> </td>
<td style="text-align: center;"> <strong>1</strong> </td>
<td style="text-align: center;"> <strong>2</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">1-E-(E/2)^2</code> </td>
<td style="text-align: center;"> <code class="reqn">E</code> </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>       </td>
<td style="text-align: center;"> <code class="reqn">1-E</code>      </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>    </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong>  </td>
<td style="text-align: center;"> <code class="reqn">(E/2)^2</code>   </td>
<td style="text-align: center;"> <code class="reqn">E</code> </td>
<td style="text-align: center;"> <code class="reqn">1-E-(E/2)^2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><em>version1.1</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: center;"> <strong>0</strong> </td>
<td style="text-align: center;"> <strong>1</strong> </td>
<td style="text-align: center;"> <strong>2</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>       </td>
<td style="text-align: center;"> <code class="reqn">1-E</code>      </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>    </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>   </td>
<td style="text-align: center;"> <code class="reqn">E/2</code> </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><em>version0.9</em> (not recommended)
</p>

<table>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: center;"> <strong>0</strong> </td>
<td style="text-align: center;"> <strong>1</strong> </td>
<td style="text-align: center;"> <strong>2</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong>  </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
<td style="text-align: center;"> <code class="reqn">E</code> </td>
<td style="text-align: center;"> <code class="reqn">0</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong>  </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>       </td>
<td style="text-align: center;"> <code class="reqn">1-E</code>      </td>
<td style="text-align: center;"> <code class="reqn">E/2</code>    </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong>  </td>
<td style="text-align: center;"> <code class="reqn">0</code>   </td>
<td style="text-align: center;"> <code class="reqn">E</code> </td>
<td style="text-align: center;"> <code class="reqn">1-E</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>When <code>Err</code> is a length 3 vector, or if <code>Return = 'vector'</code> these
are the following probabilities:
</p>

<ul>
<li>
<p> hom|hom: an actual homozygote is observed as the other homozygote
(<code class="reqn">E_1</code>)
</p>
</li>
<li>
<p> het|hom: an actual homozygote is observed as heterozygote (<code class="reqn">E_2</code>)
</p>
</li>
<li>
<p> hom|het: an actual heterozygote is observed as homozygote (<code class="reqn">E_3</code>)
</p>
</li>
</ul>
<p>and Pr(observed genotype (columns) | actual genotype (rows)) is then:
</p>

<table>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: center;"> <strong>0</strong>       </td>
<td style="text-align: center;"> <strong>1</strong>   </td>
<td style="text-align: center;"> <strong>2</strong>  </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>0</strong> </td>
<td style="text-align: center;"> <code class="reqn">1-E_1-E_2</code> </td>
<td style="text-align: center;"> <code class="reqn">E_2</code>    </td>
<td style="text-align: center;"> <code class="reqn">E_1</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>1</strong> </td>
<td style="text-align: center;"> <code class="reqn">E_3</code>        </td>
<td style="text-align: center;"> <code class="reqn">1-2E_3</code> </td>
<td style="text-align: center;"> <code class="reqn">E_3</code>   </td>
</tr>
<tr>
<td style="text-align: left;">
 <strong>2</strong> </td>
<td style="text-align: center;"> <code class="reqn">E_1</code>       </td>
<td style="text-align: center;"> <code class="reqn">E_2</code>    </td>
<td style="text-align: center;"> <code class="reqn">1-E_1-E_2</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>When the SNPs are scored via sequencing (e.g. RADseq or DArTseq), the 3rd
error rate (hom|het) is typically considerably higher than the other two,
while for SNP arrays it tends to be similar to P(het|hom).
</p>


<h3>Value</h3>

<p>Depending on <code>Return</code>, either:
</p>

<ul>
<li> <p><code>'matrix'</code>: a 3x3 matrix, with probabilities of observed genotypes
(columns) conditional on actual (rows)
</p>
</li>
<li> <p><code>'function'</code>: a function taking a single value <code>Err</code> as input, and
generating a 3x3 matrix
</p>
</li>
<li> <p><code>'vector'</code>: a length 3 vector, with the probabilities (observed given
actual) hom|other hom, het|hom, and hom|het.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">ErM &lt;- ErrToM(Err = 0.05)
ErM
ErrToM(ErM, Return = 'vector')


# use error matrix from Whalen, Gorjanc &amp; Hickey 2018
funE &lt;- function(E) {
 matrix(c(1-E*3/4, E/2, E/4,
          E/4, 1-2*E/4, E/4,
          E/4, E/2, 1-E*3/4),
          3,3, byrow=TRUE)  }
ErrToM(Err = 0.05, flavour = funE)
# equivalent to:
ErrToM(Err = c(0.05/4, 0.05/2, 0.05/4))

</code></pre>


</div>