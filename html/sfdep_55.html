<div class="container">

<table style="width: 100%;"><tr>
<td>local_jc_uni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute local univariate join count</h2>

<h3>Description</h3>

<p>The univariate local join count statistic is used to identify clusters of rarely occurring binary variables. The binary variable of interest should occur less
than half of the time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">local_jc_uni(
  fx,
  chosen,
  nb,
  wt = st_weights(nb, style = "B"),
  nsim = 499,
  alternative = "two.sided",
  iseed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>a binary variable either numeric or logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chosen</code></td>
<td>
<p>a scalar character containing the level of <code>fx</code> that should be considered the observed value (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>a neighbors list object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>default <code>st_weights(nb, style = "B")</code>. A binary weights list as created by <code>st_weights(nb, style = "B")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of conditional permutation simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>default <code>"greater"</code>. One of <code>"less"</code> or <code>"greater"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iseed</code></td>
<td>
<p>default NULL, used to set the seed for possible parallel RNGs</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The local join count statistic requires a binary weights list which can be generated with <code>st_weights(nb, style = "B")</code>. Additionally, ensure that the binary variable of interest is rarely occurring in no more than half of observations.
</p>
<p>P-values are estimated using a conditional permutation approach. This creates a reference distribution from which the observed statistic is compared. For more see <a href="https://geodacenter.github.io/glossary.html#ppvalue">Geoda Glossary</a>.
Calls <code>spdep::local_joincount_uni()</code>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with two columns <code>join_count</code> and <code>p_sim</code> and number of rows equal to the length of arguments <code>x</code>, <code>nb</code>, and <code>wt</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("dplyr", quietly = TRUE)) {

res &lt;- dplyr::transmute(
  guerry,
  top_crime = as.factor(crime_prop &gt; 9000),
  nb = st_contiguity(geometry),
  wt = st_weights(nb, style = "B"),
  jc = local_jc_uni(top_crime, "TRUE", nb, wt))
tidyr::unnest(res, jc)

}
</code></pre>


</div>