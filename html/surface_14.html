<div class="container">

<table style="width: 100%;"><tr>
<td>startingModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create an Initial Model for a SURFACE Analysis
</h2>

<h3>Description</h3>

<p>Generate a model to start a SURFACE analysis, or fit specific Hansen or Brownian motion models that can be compared to the models returned by SURFACE
</p>


<h3>Usage</h3>

<pre><code class="language-R">startingModel(otree, odata, shifts = NULL, brownian = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>otree</code></td>
<td>

<p>Phylogenetic tree in <code>ouchtree</code> format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odata</code></td>
<td>

<p>Data frame with rownames corresponding to <code>otree@labels</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shifts</code></td>
<td>

<p>A named character vector of regime shifts. Names should correspond to <code>otree@nodes</code>, and regime assignments can be any character other than <code>"a"</code> (see details). Defaults to <code>NULL</code>, in which case a single-regime OU model is returned. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brownian</code></td>
<td>

<p>A logical indicating whether to return the fitted Brownian motion model for the data set by calling the <code>ouch</code> function <code>brown</code> and obtaining AICs by adding log-likelihoods across traits. If TRUE, overrides any specified <code>shifts</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For most analysis, this function is not accessed by the user, but is called from within <code>surfaceForward</code> to initialize the run with a single-regime OU model. However, the user can optionally supply a starting model that imposes some regime shifts  (e.g. if there is strong a priori reason to include them, or to evaluate how their inclusion changes the result of SURFACE analysis). If <code>shifts</code> are supplied, they are always modified so that the first element codes a basal regime 'shift' <code>c("1"="a")</code>. Thus, if any other element in <code>shifts</code> is specified as regime <code>"a"</code>, or has name <code>"1"</code>, an error will be returned. <code>startingModel</code> can also be used to obtain a fit (with AICc calculated after adding log-likelihoods across traits) for any hypothesized Hansen model or for Brownian motion (if <code>brownian=TRUE</code>) for comparison with models returned by SURFACE
</p>


<h3>Value</h3>

<p>A list of length 1 containing an object with the same structure as the lists returned by each iteration of <code>surfaceForward</code> and <code>surfaceBackward</code> (containing elements <code>fit</code>, <code>all_aic</code>, <code>aic</code>, <code>savedshifts</code>, and <code>n_regimes</code>). This allows it to be supplied as argument <code>starting_list</code> in a call to <code>surfaceForward</code>. 
</p>


<h3>Author(s)</h3>

<p>Travis Ingram
</p>


<h3>References</h3>

<p>Ingram, T. &amp; Mahler, D.L. (2013) SURFACE: detecting convergent evolution from comparative data by fitting Ornstein-Uhlenbeck models with stepwise AIC. Methods in Ecology and Evolution 4: 416-425. 
</p>


<h3>See Also</h3>

<p><code>surfaceForward</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(surfaceDemo)
tree&lt;-surfaceDemo$tree
dat&lt;-surfaceDemo$sim$dat
olist&lt;-convertTreeData(tree,dat)
otree&lt;-olist[[1]]; odata&lt;-olist[[2]]
startmod&lt;-startingModel(otree, odata, shifts = c("6"="b")) 
</code></pre>


</div>