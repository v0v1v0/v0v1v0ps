<div class="container">

<table style="width: 100%;"><tr>
<td>javascript-tunnel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The 'JavaScript' tunnel</h2>

<h3>Description</h3>

<p>The 'JavaScript' tunnel
</p>


<h3>Usage</h3>

<pre><code class="language-R">register_session_id(
  session = shiny::getDefaultReactiveDomain(),
  shared_id = NULL,
  shared_inputs = NA
)

register_session_events(session = shiny::getDefaultReactiveDomain())

get_theme(event_data, session = shiny::getDefaultReactiveDomain())

get_jsevent(
  event_data,
  type,
  default = NULL,
  session = shiny::getDefaultReactiveDomain()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>session</code></td>
<td>
<p>shiny reactive domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared_id</code></td>
<td>
<p>the shared id of the session, usually automatically set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared_inputs</code></td>
<td>
<p>the input names to share to/from other sessions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_data</code></td>
<td>
<p>a reactive value list returned by
<code>register_session_events</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>event type; see 'Details'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default</code></td>
<td>
<p>default value if <code>type</code> is missing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>register_session_id</code> should be used in the module
server function. It registers a <code>shared_id</code> and a <code>private_id</code>
to the session. The sessions with the same <code>shared_id</code> can synchronize
their inputs, specified by <code>shared_inputs</code> even on different browser
tabs.
</p>
<p><code>register_session_events</code> will read the session events from 'JavaScript'
and passively update these information. Any the event fired by
<code>shidashi.broadcastEvent</code> in 'JavaScript' will be available as
reactive value. <code>get_jsevent</code> provides a convenient way to read
these events provided the right
event types. <code>get_theme</code> is a special <code>get_jsevent</code> that with
event type <code>"theme.changed"</code>.
</p>
<p>Function <code>register_session_id</code> and <code>register_session_events</code>
should be called at the beginning of server functions. They can be
called multiple times safely. Function
<code>get_jsevent</code> and <code>get_theme</code> should be called in reactive
contexts (such as <code>observe</code>,
<code>observeEvent</code>).
</p>


<h3>Value</h3>

<p><code>register_session_id</code> returns a list of function to control
"sharing" inputs with other shiny sessions with the same <code>shared_id</code>.
<code>register_session_events</code> returns a reactive value list that reflects
the session state.
<code>get_jsevent</code> returns events fired by
<code>shidashi.broadcastEvent</code> in 'JavaScript'.
<code>get_theme</code> returns a list of theme, foreground, and background color.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# shiny server function

library(shiny)
server &lt;- function(input, output, session){
  sync_tools &lt;- register_session_id(session = session)
  event_data &lt;- register_session_events(session = session)

  # if you want to enable syncing. They are suspended by default
  sync_tools$enable_broadcast()
  sync_tools$enable_sync()

  # get_theme should be called within reactive context
  output$plot &lt;- renderPlot({
    theme &lt;- get_theme(event_data)
    mar(bg = theme$background, fg = theme$foreground)
    plot(1:10)
  })

}

</code></pre>


</div>