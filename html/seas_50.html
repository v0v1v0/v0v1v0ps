<div class="container">

<table style="width: 100%;"><tr>
<td>lars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read and write data from LARS-WG file formats</h2>

<h3>Description</h3>

<p>Read and write data from the LARS-WG stochastic weather generator
file formats; also convert to a format for HELP
</p>


<h3>Usage</h3>

<pre><code class="language-R"># read synthetic or observed *.st file
read.lars(stfile, year.offset = 0)

# write observed climate data (*.st and/or *.sr)
write.lars(x, stfile, datfile, site, lat, lon, alt)

# experimental functions (may not work great; or at all!)
lars2help(infile, outfile, year.offset, site)
write.lars.scenario(file, x1, x2, name = "anomaly")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stfile</code></td>
<td>
<p>file name with ‘<span class="file">*.st</span>’ extension; this is a
‘site file’ for LARS-WG which contains meta-data for the
climate data, and has the location of the the climate data file; for
<code>write.lars</code>, if this variable is <code>NA</code> or
<code>FALSE</code>, this file will not be written (however,
<code>datfile</code> must be defined)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datfile</code></td>
<td>
<p>file name with either ‘<span class="file">*.sr</span>’ or ‘<span class="file">*.dat</span>’
extension; contains climate data, as described by <code>stfile</code>;
this does not need to be set if <code>stfile</code> is defined, as this
datum is found in the ‘<span class="file">st</span>’ file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>file name with a ‘<span class="file">*.sce</span>’ extension; this is a
‘scenario’ file with absolute and relative changes of climate
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infile</code></td>
<td>
<p>input file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>output file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code> of climate data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>same as <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>same as <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year.offset</code></td>
<td>
<p>offset of years between what is contained in the
data files and what is needed in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> to produce a reasonable
‘<code>Date</code>’; this is required, for example, if
synthetic data are produced that start from an arbitrary year
‘1’ but represent climate from the year ‘2000’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site</code></td>
<td>
<p>same as ‘[SITE]’ in ‘<span class="file">st</span>’ file; if missing,
this will try to read from <code>attr(x$name)</code>; this is the same as
a ‘region’ for HELP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>scenario name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>same as ‘LAT’ in ‘<span class="file">st</span>’ file; if missing, this
will try to be read from <code>attr(x$latitude)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>same as ‘LON’ in ‘<span class="file">st</span>’ file; if missing, this
will try to be read from <code>attr(x$longitude)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>
<p>same as ‘ALT’ in ‘<span class="file">st</span>’ file; if missing, this
will try to be read from <code>attr(x$elevation)</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions interface with the LARS-WG files (Version 4.0), which
is a stochastic weather generator by Mikhail Semenov.
</p>
<p>The climate data files used with LARS-WG have two parts: (1)~a
‘site file’ with a ‘<span class="file">st</span>’ extension, containing the
meta-data; and (2)~a data file with a ‘<span class="file">*.sr</span>’ or ‘<span class="file">*.dat</span>’
extension, containing all the data. The variable names are translated
according to the following table:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>seas</em>  </td>
<td style="text-align: left;"> <em>LARS-WG</em> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>year</code>  </td>
<td style="text-align: left;"> ‘YEAR’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>yday</code>  </td>
<td style="text-align: left;"> ‘JDAY’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>t_min</code> </td>
<td style="text-align: left;"> ‘MIN’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>t_max</code> </td>
<td style="text-align: left;"> ‘MAX’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>preicp</code>
</td>
<td style="text-align: left;"> ‘RAIN’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>solar</code> </td>
<td style="text-align: left;"> ‘RAD’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sun</code>   </td>
<td style="text-align: left;"> ‘SUN’ </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>pet</code>   </td>
<td style="text-align: left;"> ‘PET’ </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>To write climate data from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> to a LARS-WG file, the <code>data.frame</code>
names need to match those in the <span class="pkg">seas</span>-side of the table.
</p>
<p>Data exported from <code>write.lars</code> always has legal (according to
the Gregorian calendar) and increasing sequence of days (even if there
are gaps in <code>x$date</code>). Missing data values are written as
<code>-99</code>.
</p>
<p>Synthetically generated data from LARS-WG use a 365-day calendar, and
may need to be converted to a Gregorian calendar, which can be done
using <code>conv365toGregorian</code>.
</p>
<p><code>lars2help</code> and <code>write.lars.scenario</code> are experimental
functions to translate data between LARS and HELP (see
<code>write.help</code> for more info).
</p>


<h3>Author(s)</h3>

<p>Mike Toews</p>


<h3>References</h3>

<p>LARS-WG was can be downloaded for academic and research uses from <br><a href="http://resources.rothamsted.ac.uk/mas-models/larswg">http://resources.rothamsted.ac.uk/mas-models/larswg</a>
</p>
<p>Semenov, M.A. and Barrow, E.M. 1997. Use of a stochastic
weather generator in the development of climate change
scenarios. <em>Climate Change</em>, <b>35</b> (4), 397–414,
<a href="https://doi.org/10.1023/A%3A1005342632279">doi:10.1023/A:1005342632279</a>
</p>


<h3>See Also</h3>

<p><code>write.help</code>, <code>read.sdsm</code>,
<code>summerland</code> example synthetic data,
<code>conv365toGregorian</code></p>


<h3>Examples</h3>

<pre><code class="language-R">stfile &lt;- system.file("extdata", "summerland.st", package="seas")
print(stfile)
summ &lt;- read.lars(stfile, year.offset=1960)
head(summ)
str(summ)

# plot temperature
summ$t_mean &lt;- rowMeans(summ[, c("t_min", "t_max")])
seas.temp.plot(summ)

# plot solar radiation
seas.var.plot(summ, "solar")

# plot precipitation
summ.ss &lt;- seas.sum(summ)
image(summ.ss)
plot(seas.norm(summ.ss))
</code></pre>


</div>