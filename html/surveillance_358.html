<div class="container">

<table style="width: 100%;"><tr>
<td>epidata_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting the Evolution of an Epidemic
</h2>

<h3>Description</h3>

<p>Functions for plotting the evolution of epidemics. The <code>plot</code>
methods for <code>class</code>es <code>"epidata"</code> and
<code>"summary.epidata"</code> plots the numbers of susceptible, infectious and
recovered (= removed) individuals by step functions along the time axis.  The
function <code>stateplot</code> shows individual state changes along the time axis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'summary.epidata'
plot(x,
     lty = c(2, 1, 3), lwd = 2,
     col = c("#1B9E77", "#D95F02", "#7570B3"), col.hor = col, col.vert = col,
     xlab = "Time", ylab = "Number of individuals",
     xlim = NULL, ylim = NULL, legend.opts = list(), do.axis4 = NULL,
     panel.first = grid(), rug.opts = list(),
     which.rug = c("infections", "removals", "susceptibility", "all"), ...)
## S3 method for class 'epidata'
plot(x, ...)

stateplot(x, id, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object inheriting from class <code>"epidata"</code> or
<code>"summary.epidata"</code>.  In the former case, its summary is calculated
and the function continues as in the latter case.  The <code>plot</code> method
for class <code>"epidata"</code> is a simple wrapper for
<code>plot.summary.epidata</code> implemented as <code>plot(summary(x, ...))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>

<p>vectors of length 3 containing the line types and widths, respectively, for
the numbers of susceptible, infectious and removed individuals (in this 
order).  By default, all lines have width 1 and the line types are dashed
(susceptible), solid (infectious) and dotted (removed), respectively.  To 
omit the drawing of a specific line, just set the corresponding entry in 
<code>lty</code> to 0.  The vectors are recycled if necessary.  For information 
about the different <code>lty</code> and <code>lwd</code> codes, see the help pages 
of <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, col.hor, col.vert</code></td>
<td>

<p>vectors of length 3 containing the line colors for the numbers of
susceptible, infectious and removed individuals (in this order). 
<code>col.hor</code> defines the color for the horizontal parts of the step
function, whilst <code>col.vert</code> defines the color for its vertical parts.
The argument <code>col</code> is just short for <code>col.hor = col</code> and
<code>col.vert = col</code>.  The default <code>col</code> vector corresponds to
<code>brewer.pal("Dark2",n=3)</code> from the <a href="https://CRAN.R-project.org/package=RColorBrewer"><span class="pkg">RColorBrewer</span></a> package.
The vectors are recycled if necessary.  For information about the possible
values of <code>col</code>, see the help pages of <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>

<p>axis labels, default to "Time" and "Number of individuals", respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>

<p>the x and y limits of the plot in the form <code>c(xmin, xmax)</code> and
<code>c(ymin, ymax)</code>, respectively.  By default, these are chosen adequately
to fit the time range of the epidemic and the number of individuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.opts</code></td>
<td>

<p>if this is a list (of arguments for the <code>legend</code> function),
a legend will be plotted.  The defaults are as follows:
</p>

<dl>
<dt>
<code>x</code>:</dt>
<dd>
<p><code>"topright"</code></p>
</dd>
<dt>
<code>inset</code>:</dt>
<dd>
<p><code>c(0,0.02)</code></p>
</dd>
<dt>
<code>legend</code>:</dt>
<dd>
<p><code>c("susceptible", "infectious", "removed")</code></p>
</dd>
<dt>
<code>lty</code>,<code>lwd</code>,<code>col</code>:</dt>
<dd>
<p>same as the arguments
<code>lty</code>, <code>lwd</code>, and <code>col.hor</code> of the main function</p>
</dd>
<dt>
<code>bty</code>:</dt>
<dd>
<p><code>"n"</code></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.axis4</code></td>
<td>

<p>logical indicating if the final numbers of susceptible and removed
individuals should be indicated on the right axis.  The default <code>NULL</code>
means <code>TRUE</code>, if <code>x</code> represents a SIR epidemic and <code>FALSE</code>
otherwise, i.e. if the epidemic is SI, SIS or SIRS.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.first</code></td>
<td>

<p>an expression to be evaluated after the plot axes are set up but before
any plotting takes place.  By default, a standard grid is drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug.opts</code></td>
<td>

<p>either a list of arguments passed to the function <code>rug</code> or
<code>NULL</code> (or <code>NA</code>), in which case no <code>rug</code> will be plotted.
By default, the argument <code>ticksize</code> is set to 0.02, <code>col</code>
is set to the color according to <code>which.rug</code> (black if this is
<code>"all"</code>), and <code>quiet</code> is set to <code>TRUE</code>.
Note that the argument <code>x</code>, which contains the
locations for the <code>rug</code> is fixed internally and can not be modified.
The argument <code>which.rug</code> (see below) determines the locations to mark.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.rug</code></td>
<td>

<p>By default, tick marks are drawn at the time points of infections.  
Alternatively, one can choose to mark only <code>"removals"</code>,
<code>"susceptibilities"</code> (i.e. state change from R to S) or
<code>"all"</code> events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>single character string or factor of length 1 specifying the individual for
which the <code>stateplot</code> should be established.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For <code>plot.summary.epidata</code>: further graphical parameters passed to 
<code>plot</code>, <code>lines</code> and <code>axis</code>, e.g. <code>main</code>, <code>las</code>, 
<code>cex.axis</code> (etc.) and <code>mgp</code>.<br>
For <code>plot.epidata</code>: arguments passed to <code>plot.summary.epidata</code>.<br>
For <code>stateplot</code>: arguments passed to <code>plot.stepfun</code> or
<code>plot.function</code> (if <code>id</code> had no events during the
observation period).  By default, <code>xlab="time"</code>, <code>ylab="state"</code>,
<code>xlim=attr(x,"timeRange")</code>, <code>xaxs="i"</code> and <code>do.points=FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>plot.summary.epidata</code> (and <code>plot.epidata</code>) invisibly returns the
matrix used for plotting, which contains the evolution of the three
counters.<br><code>stateplot</code> invisibly returns the function, which was plotted,
typically of class <code>"stepfun"</code>, but maybe of class <code>"function"</code>,
if no events have been observed for the individual in question (then the
function always returns the initial state).  The vertical axis of
<code>stateplot</code> can range from 1 to 3, where 1 corresponds to
<em>S</em>usceptible, 2 to <em>I</em>nfectious and 3 to <em>R</em>emoved.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>See Also</h3>

<p><code>summary.epidata</code> for the data, on which the plots are based.
<code>animate.epidata</code> for the animation of epidemics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hagelloch")
(s &lt;- summary(hagelloch))

# rudimentary stateplot
stateplot(s, id = "187")

# evolution of the epidemic
plot(s)
</code></pre>


</div>