<div class="container">

<table style="width: 100%;"><tr>
<td>extractors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions to extract various components of a fit.
</h2>

<h3>Description</h3>

<p>Most extractors are methods of generic functions defined in base R (see Usage), for which the base documentation may be useful.
</p>
<p><code>formula</code> extracts the model formula.<br><code>family</code> extracts the response family.<br><code>terms</code> extracts the formula, with attributes describing the <b>fixed-effect</b> terms.<br><code>nobs</code> returns the length of the response vector.<br><code>logLik</code> extracts the log-likelihood (exact or approximated).<br><code>dev_resids</code> returns a vector of squared (unscaled) deviance residuals (the summands defined for GLMs in McCullagh and Nelder 1989, p. 34; see Details of <code>LL-family</code> for other response families. <br><code>deviance</code> returns the sum of squares of these deviance residuals, possibly weighted by prior weights (consistently with <code>stats::deviance</code>. See <code>residuals.HLfit</code> for details and comparison with related extractors.<br><code>fitted</code> extracts fitted values.<br><code>response</code> extracts the response (as a vector).<br><code>fixef</code> extracts the fixed effects coefficients, <code class="reqn">\beta</code>.<br><code>ranef</code> extracts the predicted random effects, <b>Lv</b> (default since version 1.12.0), or optionally <b>u</b> (see <code>random-effects</code> for definitions). <code>print.ranef</code> controls their printing. <br><code>getDistMat</code> returns a distance matrix for a geostatistical (Mat√©rn etc.) random effect.<br><code>df.residual</code> extracts residual degrees-of-freedom for fitted models (here number of observations minus number of parameters of the model except residual dispersion parameters).
<code>wweights</code> extracts prior weights (as defined by the fitting functions's <code>prior.weights</code> argument).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'HLfit'
formula(x, which="hyper", ...)
## S3 method for class 'HLfit'
family(object, ...)
## S3 method for class 'HLfit'
terms(x, ...)
## S3 method for class 'HLfit'
nobs(object, ...)
## S3 method for class 'HLfit'
logLik(object, which, ...)
## S3 method for class 'HLfit'
fitted(object, ...)
## S3 method for class 'HLfit'
fixef(object, na.rm=NULL, ...)
## S3 method for class 'HLfit'
ranef(object, type = "correlated", ...)
## S3 method for class 'ranef'
print(x, max.print = 40L, ...)
## S3 method for class 'HLfit'
deviance(object, ...)
## S3 method for class 'HLfit'
df.residual(object, ...)
## S3 method for class 'HLfit'
weights(object, type, ...)
##
getDistMat(object, scaled=FALSE, which = 1L)
response(object,...)
dev_resids(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>HLfit</code>, as returned by the fitting functions in <code>spaMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>For <code>ranef</code>, use <code>type="correlated"</code> (default) to display the correlated random effects (<b>Lv</b>), whether in a spatial model, or a random- coefficient model. Use <code>type="uncorrelated"</code> to pretty-print the elements of the <code>&lt;object&gt;$ranef</code> vector (<b>u</b>).<br>
For <code>weights</code>, either <code>"prior"</code> or <code>"working"</code>, with the same meaning as for <code>weights.glm</code>: respectively the prior weights, or the weights used in the final iteration of the IRLS algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>* For <code>logLik</code>, the name of the element of the <code>APHLs</code> list to return (see Details for any further possibility). The default depends on the fitting method. In particular, if it was REML or one of its variants, the default is to return the log restricted likelihood (exact or approximated).<br>
* For <code>getDistMat</code>, an integer, to select a random effect from several for which a distance matrix may be constructed.<br>
* For <code>formula</code>, by default the model formula with non-expanded <code>multIMRF</code> random-effect terms is returned, while for <code>which=""</code> a formula with <code>multIMRF</code> terms expanded as <code>IMRF</code> terms is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Whether to include NA values for missing coefficients of rank-deficient model matrices. Default is to exclude them for mixed models and to include them for other ones. See Details for the underlying reason.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>If <code>FALSE</code>, the function ignores the scale parameter <code class="reqn">\rho</code> and returns unscaled distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For <code>print.ranef</code>: the return value of <code>ranef.HLfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.print</code></td>
<td>
<p>Controls <code>options("max.print")</code> locally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that may be needed by some method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For rank-deficient model matrices, base R procedures <code>lm</code> and <code>glm</code> estimate coefficients for a rank-trimmed matrix and <code>coefficient()</code> returns a full-length vector completed with NA values for coefficients not estimated, while the <span class="pkg">lme4</span> <code>fixef</code> method returns a trimmed vector. <span class="pkg">spaMM</span> has long followed the base R convention for all models but this may impede use of some post-fit procedures initially conceived for <span class="pkg">lme4</span> objects (such as <span class="pkg">lmerTest</span> procedures for LMMs). So now <code>fixef.HLfit</code> trims the vector by default for mixed-effect models only. The default is thus to maximize consistency/compatibility with preexisting procedures despite their inconsistencies with each other.</p>


<h3>Value</h3>

<p><code>formula</code> returns a <code>formula</code>, except a list of them from <code>fitmv()</code> output.
</p>
<p><code>terms</code> returns an object of class <code>c("terms", "formula")</code> which contains the <em>terms</em> representation of a symbolic model.  See <code>terms.object</code> for its structure. <code>terms(&lt;fitmv() result&gt;)</code> returns a list of such terms.
</p>
<p>Other return values are numeric (for <code>logLik</code>), vectors (most cases), matrices or dist objects (for <code>getDistMat</code>), or a family object (for <code>family</code>). <code>ranef</code> returns a list of vectors or matrices (the latter for random-coefficient terms). 
</p>


<h3>References</h3>

<p>McCullagh, P. and Nelder J. A. (1989) Generalized linear models. Second ed. Chapman &amp; Hall: London.
</p>


<h3>See Also</h3>

<p>See <code>summary.HLfit</code> whose return value include the tables of fixed-effects coefficients and random-effect variances displayed by the summary, <code>residuals.HLfit</code> to extract various residuals, <code>residVar</code> to extract residual variances or information about residual variance models, <code>hatvalues</code> to extract leverages, <code>get_matrix</code> to extract the model matrix and derived matrices, and <code>vcov.HLfit</code> to extract covariances matrices from a fit, <code>get_RLRsim_args</code> to extract arguments for (notably) tests of random effects in LMMs.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("wafers")
m1 &lt;- fitme(y ~ X1+X2+(1|batch), data=wafers)
fixef(m1)
ranef(m1)

data("blackcap")
fitobject &lt;- fitme(migStatus ~ 1 + Matern(1|longitude+latitude),data=blackcap,
                       fixed=list(nu=4,rho=0.4,phi=0.05))
getDistMat(fitobject)

</code></pre>


</div>