<div class="container">

<table style="width: 100%;"><tr>
<td>fitMR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Moving-Resting Model with Embedded Brownian Motion</h2>

<h3>Description</h3>

<p>Fit a Moving-Resting Model with Embedded Brownian Motion with animal
movement data at discretely observation times by maximizing a composite
likelihood constructed from the marginal density of increment.
Using <code>segment</code> to fit part of observations to the model. A practical
application of this feature is seasonal analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitMR(
  data,
  start,
  segment = NULL,
  likelihood = c("full", "composite"),
  logtr = FALSE,
  method = "Nelder-Mead",
  optim.control = list(),
  integrControl = integr.control()
)

fitMovRes(
  data,
  start,
  likelihood = c("full", "composite"),
  logtr = FALSE,
  method = "Nelder-Mead",
  optim.control = list(),
  integrControl = integr.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame whose first column is the observation time, and other
columns are location coordinates. If <code>segment</code> is not <code>NULL</code>,
additional column with the same name given by <code>segment</code> should be
included. This additional column is used to indicate which part of
observations shoule be used to fit model. The value of this column can
be any integer with 0 means discarding this observation and non-0 means
using this obversvation. Using different non-zero numbers indicate different
segments. (See vignette for more details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value of the model, a vector of three components
in the order of rate for moving, rate for resting, and volatility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment</code></td>
<td>
<p>character variable, name of the column which indicates segments,
in the given <code>data.frame</code>. The default value, <code>NULL</code>, means using
whole dataset to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>a character string specifying the likelihood type to
maximize in estimation. This can be "full" for full likelihood or
"composite' for composite likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logtr</code></td>
<td>
<p>logical, if TRUE parameters are estimated on the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method argument to feed <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>a list of control to be passed to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>a list of control parameters for the <code>integrate</code>
function: rel.tol, abs.tol, subdivision.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the esimated parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>maximized loglikelihood or composite loglikelihood
evaluated at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>convergence code from <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>likelihood type (full or composite) from the input</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yan, J., Chen, Y., Lawrence-Apfel, K., Ortega, I. M., Pozdnyakov, V.,
Williams, S., and Meyer, T. (2014) A moving-resting process with an
embedded Brownian motion for animal movements.
Population Ecology. 56(2): 401â€“415.
</p>
<p>Pozdnyakov, V., Elbroch, L., Labarga, A., Meyer, T., and Yan, J.
(2017) Discretely observed Brownian motion governed by telegraph
process: estimation. Methodology and Computing in Applied Probability.
doi:10.1007/s11009-017-9547-6.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## time consuming example
tgrid &lt;- seq(0, 10, length=500)
set.seed(123)
## make it irregularly spaced
tgrid &lt;- sort(sample(tgrid, 30)) # change to 400 for a larger sample
dat &lt;- rMR(tgrid, 1, 2, 25, "m")

## fit whole dataset to the MR model
fit.fl &lt;- fitMR(dat, start=c(2, 2, 20), likelihood = "full")
fit.fl

fit.cl &lt;- fitMR(dat, start=c(2, 2, 20), likelihood = "composite")
fit.cl

## fit part of dataset to the MR model
batch &lt;- c(rep(0, 5), rep(1, 7), rep(0, 4), rep(2, 10), rep(0, 4))
dat.segment &lt;- cbind(dat, batch)
fit.segment &lt;- fitMR(dat.segment, start = c(2, 2, 20), segment = "batch",
                     likelihood = "full")
head(dat.segment)
fit.segment

## End(Not run)
</code></pre>


</div>