<div class="container">

<table style="width: 100%;"><tr>
<td>StepPTS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a function for advancing the state of an SPN by using a simple approximate Poisson time stepping method</h2>

<h3>Description</h3>

<p>This function creates a function for advancing the state of an SPN model using a simple approximate Poisson time stepping method. The resulting function (closure) can be used in conjunction with other functions (such as <code>simTs</code>) for simulating realisations of SPN models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StepPTS(N,dt=0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>An R list with named components representing a stochastic
Petri net. Should contain <code>N$Pre</code>, a matrix representing the
LHS stoichiometries, <code>N$Post</code>, a matrix representing the RHS
stoichiometries, and <code>N$h</code>, a function representing the rates
of the reaction processes. <code>N$h</code> should have first argument
<code>x</code>, a vector representing the current state of the system, second argument
<code>t</code>, a scalar representing the current simulation time (in the
typical time-homogeneous case, <code>N$h</code> will ignore this argument).
<code>N$h</code> may posses additional arguments, representing reaction rates, for example. <code>N</code> does not need to contain an initial marking, <code>N$M</code>. <code>N$M</code> will be ignored by most functions which use the resulting function closure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Time step to be used by the Poisson time stepping integration method. Defaults to 0.01.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An R function which can be used to advance the state of the SPN model <code>N</code> by using a Poisson time stepping method with step size <code>dt</code>. The function closure has interface <code>function(x0,t0,deltat,...)</code>, where <code>x0</code> and <code>t0</code> represent the initial state and time, and <code>deltat</code> represents the amount of time by which the process should be advanced. The function closure returns a vector representing the simulated state of the system at the new time.</p>


<h3>See Also</h3>

<p><code>StepGillespie</code>, <code>StepCLE</code>, <code>simTs</code>, <code>simSample</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># load up the LV model
data(spnModels)
# create a stepping function
stepLV=StepPTS(LV)
# step the function
print(stepLV(c(x1=50,x2=100),0,1))
# integrate the process and plot it
out = simTs(c(x1=50,x2=100),0,20,0.1,stepLV)
plot(out)
plot(out,plot.type="single",lty=1:2)
</code></pre>


</div>