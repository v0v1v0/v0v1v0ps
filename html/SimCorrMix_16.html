<div class="container">

<table style="width: 100%;"><tr>
<td>intercorr_nb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Negative Binomial Variables: Correlation Method 1</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_nb x k_nb</code> intermediate matrix of correlations for the Negative Binomial variables by
extending the method of Yahav &amp; Shmueli (2012, doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>). The intermediate correlation between Z1 and Z2 (the
standard normal variables used to generate the Negative Binomial variables Y1 and Y2 via the inverse CDF method) is
calculated using a logarithmic transformation of the target correlation.  First, the upper and lower Frechet-Hoeffding bounds
(mincor, maxcor) on <code class="reqn">\rho_{Y1, Y2}</code> are simulated.  Then the intermediate correlation is found as follows:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{Z1, Z2} = \frac{1}{b} * log(\frac{\rho_{Y1, Y2} - c}{a}),</code>
</p>

<p>where <code class="reqn">a = -(maxcor * mincor)/(maxcor + mincor)</code>, <code class="reqn">b = log((maxcor + a)/a)</code>, and <code class="reqn">c = -a</code>.
The function adapts code from Amatya &amp; Demirtas' (2016) package <code>PoisNor-package</code> by:
</p>
<p>1) allowing specifications for the number of random variates and the seed for reproducibility
</p>
<p>2) providing the following checks: if <code>Sigma_(Z1, Z2)</code> &gt; 1, <code>Sigma_(Z1, Z2)</code> is set to 1; if <code>Sigma_(Z1, Z2)</code> &lt; -1,
<code>Sigma_(Z1, Z2)</code> is set to -1
</p>
<p>3) simulating regular and zero-inflated Negative Binomial variables.
</p>
<p>The function is used in <code>intercorr</code> and <code>corrvar</code> and would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intercorr_nb(rho_nb = NULL, size = NULL, mu = NULL, p_zinb = 0,
  nrand = 100000, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho_nb</code></td>
<td>
<p>a <code>k_nb x k_nb</code> matrix of target correlations ordered 1st regular and 2nd zero-inflated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector of size parameters for the Negative Binomial variables (see <code>stats::dnbinom</code>); the order should be
1st regular NB variables, 2nd zero-inflated NB variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of mean parameters for the NB variables (*Note: either <code>prob</code> or <code>mu</code> should be supplied for all Negative Binomial variables,
not a mixture; default = NULL); order the same as in <code>size</code>; for zero-inflated NB this refers to
the mean of the NB distribution (see <code>VGAM::dzinegbin</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_zinb</code></td>
<td>
<p>a vector of probabilities of structural zeros (not including zeros from the NB distribution) for the zero-inflated NB variables
(see <code>VGAM::dzinegbin</code>); if <code>p_zinb</code> = 0, <code class="reqn">Y_{nb}</code> has a regular NB distribution;
if <code>p_zinb</code> is in <code>(-prob^size/(1 - prob^size),</code> <code>0)</code>, <code class="reqn">Y_{nb}</code> has a zero-deflated NB distribution and <code>p_zinb</code>
is not a probability; if <code>p_zinb = -prob^size/(1 - prob^size)</code>, <code class="reqn">Y_{nb}</code> has a positive-NB distribution (see
<code>VGAM::dposnegbin</code>); if <code>length(p_zinb) &lt; length(size)</code>, the missing values are set to 0 (and ordered 1st)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>the number of random numbers to generate in calculating the bound (default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used in random number generation (default = 1234)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the <code>k_nb x k_nb</code> intermediate correlation matrix for the Negative Binomial variables
</p>


<h3>References</h3>

<p>Please see references for <code>intercorr_pois</code>.
</p>


<h3>See Also</h3>

<p><code>intercorr_pois</code>, <code>intercorr_pois_nb</code>,
<code>intercorr</code>, <code>corrvar</code>
</p>


</div>