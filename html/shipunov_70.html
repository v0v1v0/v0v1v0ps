<div class="container">

<table style="width: 100%;"><tr>
<td>Hulls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convex hulls for multiple groups</h2>

<h3>Description</h3>

<p>Calculates and plots groups hulls and related information</p>


<h3>Usage</h3>

<pre><code class="language-R">Hulls(pts, groups, match.colors=TRUE, usecolors=NULL,
 plot=TRUE, centers=FALSE, c.pch=0, c.cex=3,
 outliers=TRUE, coef=1.5, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>Data points to plot, 2-dimensional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Grouping variable, any type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.colors</code></td>
<td>
<p>Match colors with groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usecolors</code></td>
<td>
<p>Which group colors to use (does not rotate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>Show centers?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.pch</code></td>
<td>
<p>Type of center points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.cex</code></td>
<td>
<p>Scale of center points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>Include outliers?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Determines how to detect outliers, see 'coef' from 'boxplot.stats()' </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to 'lines()'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If 'centers=TRUE', Hulls() calculates centroids of polygons corresponding
with convex hulls.
</p>
<p>If 'outliers=FALSE', Hulls() uses boxplot.stats() to detect outliers
(points which are most distant from centers). This option could be used
for cluster sharpening. It also automatically switches to 'centers=TRUE'
so if you want to plot smoothed hulls but do not want to plot their
centers, use something like 'c.pch=NA' or 'c.cex=0' (see examples).
</p>
<p>Please also check Ellipses() function which uses confidence ellipses
based on F-distribution.
</p>
<p>Note that (at least at the moment), polygons are plotted with line()
function, therefore shading is not straightforward (but possible, see
examples).
</p>


<h3>Value</h3>

<p>Invisibly outputs list of hulls (polygons) with coordinates, and possibly
also with 'centers' and 'outliers' attributes. Indices of margin points
returned as row names of each polygon.
</p>
<p>See also package 'cluster' for ellipsoidhulls() function that allows to
draw ellipse-like hulls.
</p>


<h3>Author(s)</h3>

<p>Alexey Shipunov</p>


<h3>See Also</h3>

<p><code>Ellipses</code>, <code>Overlap</code>, <code>boxplot.stats</code></p>


<h3>Examples</h3>

<pre><code class="language-R">iris.p &lt;- prcomp(iris[, -5])$x[, 1:2]
plot(iris.p, type="n", xlab="PC1", ylab="PC2")
pal &lt;- rainbow(3)
text(iris.p, labels=abbreviate(iris[, 5], 1, method="both.sides"),
 col=pal[as.numeric(iris[, 5])])
Hulls(iris.p, iris[, 5], centers=TRUE, usecolors=pal)

## smoothed hulls
plot(iris.p, col=iris$Species, xlab="PC1", ylab="PC2")
ppts &lt;- Hulls(iris.p, iris[, 5], centers=TRUE, outliers=FALSE, c.pch=NA)
## reveal outliers:
(out &lt;- attr(ppts, "outliers"))
points(iris.p[out, ], pch=4, cex=1.4)

## this might complement Overlap()
cnts &lt;- attr(ppts, "centers")
dist(cnts)
## how to use centers for clustering groups
plot(hclust(dist(cnts)))

## this is how to plot shaded hulls
plot(iris.p, pch=as.numeric(iris$Species))
for (i in seq_along(ppts))
 polygon(ppts[[i]], border=NA, col=adjustcolor(i, alpha.f=0.2))
</code></pre>


</div>