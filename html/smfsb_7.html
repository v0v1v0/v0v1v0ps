<div class="container">

<table style="width: 100%;"><tr>
<td>gillespie</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a sample path from a stochastic kinetic model described by a stochastic Petri net</h2>

<h3>Description</h3>

<p>This function simulates a single realisation from a discrete stochastic
kinetic model described by a stochastic Petri net (SPN).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gillespie(N, n, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>An R list with named components representing a stochastic
Petri net (SPN). Should contain <code>N$M</code>, a vector representing
the initial marking of the net, <code>N$Pre</code>, a matrix representing
the LHS stoichiometries, <code>N$Post</code>, a matrix representing the
RHS stoichiometries, and <code>N$h</code>, a function representing the
rates of the reaction processes. <code>N$h</code> should have
first argument <code>x</code>, a vector representing the current state of
the system, and
second argument <code>t</code>, a scalar representing the current
simulation time (in the typical time-homogeneous case, <code>N$h</code>
will ignore this argument).
<code>N$h</code> may posses additional arguments, representing reaction rates, for example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer representing the number of events to simulate, excluding the initial state, <code>N$M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (such as reactions rates) will be passed into the function <code>N$h</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with first component <code>t</code>, a vector of length <code>n</code> containing event times and second component <code>x</code>, a matrix with <code>n+1</code> rows containing the state of the system. The <code>i</code>th row of <code>x</code> contains the state of the system prior to the <code>i</code>th event.
</p>


<h3>See Also</h3>

<p><code>simpleEuler</code>, <code>rdiff</code>,
<code>discretise</code>, <code>gillespied</code>, <code>StepGillespie</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># load the LV model
data(spnModels)
# simulate a realisation of the process and plot it
out = gillespie(LV,10000)
op = par(mfrow=c(2,2))
plot(stepfun(out$t,out$x[,1]),pch="")
plot(stepfun(out$t,out$x[,2]),pch="")
plot(out$x,type="l")

# use the "discretise" function to map it to an R "ts" object
plot(discretise(out,dt=0.01),plot.type="single",lty=c(1,2))
par(op)
</code></pre>


</div>