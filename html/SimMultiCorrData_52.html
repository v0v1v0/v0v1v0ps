<div class="container">

<table style="width: 100%;"><tr>
<td>SimMultiCorrData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of Correlated Data with Multiple Variable Types</h2>

<h3>Description</h3>

<p><span class="pkg">SimMultiCorrData</span> generates continuous (normal or non-normal), binary, ordinal, and count (Poisson or Negative Binomial) variables
with a specified correlation matrix.  It can also produce a single continuous variable.  This package can be used to simulate data sets that mimic
real-world situations (i.e. clinical data sets, plasmodes, as in Vaughan et al., 2009, doi: <a href="http://doi.org/10.1016/j.csda.2008.02.032">10.1016/j.csda.2008.02.032</a>).  All variables are generated from standard normal variables
with an imposed intermediate correlation matrix.  Continuous variables are simulated by specifying mean, variance, skewness, standardized kurtosis,
and fifth and sixth standardized cumulants using either Fleishman's Third-Order (doi: <a href="http://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>) or Headrick's Fifth-Order
(doi: <a href="http://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>) Polynomial Transformation.  Binary and
ordinal variables are simulated using a modification of <code>GenOrd-package</code>'s <code>ordsample</code> function.
Count variables are simulated using the inverse cdf method.  There are two simulation pathways which differ primarily according to the calculation
of the intermediate correlation matrix.  In <b>Correlation Method 1</b>, the intercorrelations involving count variables are determined using a simulation based,
logarithmic correlation correction (adapting Yahav and Shmueli's 2012 method, doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>).  In <b>Correlation Method 2</b>, the count variables are treated as ordinal
(adapting Barbiero and Ferrari's 2015 modification of <code>GenOrd-package</code>, doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>).  There is an optional error loop that corrects the
final correlation matrix to be within a user-specified precision value. The package also
includes functions to calculate standardized cumulants for theoretical distributions or from real data sets, check if a target correlation
matrix is within the possible correlation bounds (given the distributions of the simulated variables), summarize results,
numerically or graphically, to verify valid power method pdfs, and to calculate lower standardized kurtosis bounds.
</p>


<h3>Vignettes</h3>

<p>There are several vignettes which accompany this package that may help the user understand the simulation and analysis methods.
</p>
<p>1) <b>Benefits of SimMultiCorrData and Comparison to Other Packages</b> describes some of the ways <span class="pkg">SimMultiCorrData</span> improves
upon other simulation packages.
</p>
<p>2) <b>Variable Types</b> describes the different types of variables that can be simulated in <span class="pkg">SimMultiCorrData</span>.
</p>
<p>3) <b>Function by Topic</b> describes each function, separated by topic.
</p>
<p>4) <b>Comparison of Correlation Method 1 and Correlation Method 2</b> describes the two simulation pathways that can be followed.
</p>
<p>5) <b>Overview of Error Loop</b> details the algorithm involved in the optional error loop that improves the accuracy of the
simulated variables' correlation matrix.
</p>
<p>6) <b>Overall Workflow for Data Simulation</b> gives a step-by-step guideline to follow with an example containing continuous
(normal and non-normal), binary, ordinal, Poisson, and Negative Binomial variables.  It also demonstrates the use of the
standardized cumulant calculation function, correlation check functions, the lower kurtosis boundary function, and the plotting functions.
</p>
<p>7) <b>Comparison of Simulation Distribution to Theoretical Distribution or Empirical Data</b> gives a step-by-step guideline for
comparing a simulated univariate continuous distribution to the target distribution with an example.
</p>
<p>8) <b>Using the Sixth Cumulant Correction to Find Valid Power Method Pdfs</b> demonstrates how to use the sixth cumulant correction
to generate a valid power method pdf and the effects this has on the resulting distribution.
</p>


<h3>Functions</h3>

<p>This package contains 3 <em>simulation</em> functions:
</p>
<p><code>nonnormvar1</code>, <code>rcorrvar</code>, and <code>rcorrvar2</code>
</p>
<p>8 data description (<em>summary</em>) functions:
</p>
<p><code>calc_fisherk</code>, <code>calc_moments</code>, <code>calc_theory</code>,
<code>cdf_prob</code>, <code>power_norm_corr</code>, <br><code>pdf_check</code>, <code>sim_cdf_prob</code>, <code>stats_pdf</code>
</p>
<p>8 <em>graphing</em> functions:
</p>
<p><code>plot_cdf</code>, <code>plot_pdf_ext</code>, <code>plot_pdf_theory</code>,
<code>plot_sim_cdf</code>, <code>plot_sim_ext</code>, <br><code>plot_sim_pdf_ext</code>,
<code>plot_sim_pdf_theory</code>, <code>plot_sim_theory</code>
</p>
<p>5 <em>support</em> functions:
</p>
<p><code>calc_lower_skurt</code>, <code>find_constants</code>,
<code>pdf_check</code>, <code>valid_corr</code>, <code>valid_corr2</code>
</p>
<p>and 30 <em>auxiliary</em> functions (should not normally be called by the user, but are called by other functions):
</p>
<p><code>calc_final_corr</code>, <code>chat_nb</code>, <code>chat_pois</code>,
<code>denom_corr_cat</code>, <code>error_loop</code>, <code>error_vars</code>, <br><code>findintercorr</code>, <code>findintercorr2</code>,
<code>findintercorr_cat_nb</code>, <code>findintercorr_cat_pois</code>, <br><code>findintercorr_cont</code>,
<code>findintercorr_cont_cat</code>,
<code>findintercorr_cont_nb</code>, <br><code>findintercorr_cont_nb2</code>, <code>findintercorr_cont_pois</code>,
<code>findintercorr_cont_pois2</code>, <br><code>findintercorr_nb</code>, <code>findintercorr_pois</code>,
<code>findintercorr_pois_nb</code>, <code>fleish</code>, <br><code>fleish_Hessian</code>,
<code>fleish_skurt_check</code>, <code>intercorr_fleish</code>,
<code>intercorr_poly</code>, <br><code>max_count_support</code>, <code>ordnorm</code>,
<code>poly</code>, <code>poly_skurt_check</code>, <code>separate_rho</code>, <br><code>var_cat</code>
</p>


<h3>References</h3>

<p>Amatya A &amp; Demirtas H (2015). Simultaneous generation of multivariate mixed data with Poisson and normal marginals.
Journal of Statistical Computation and Simulation, 85(15): 3129-39. doi: <a href="http://doi.org/10.1080/00949655.2014.953534">10.1080/00949655.2014.953534</a>.
</p>
<p>Amatya A &amp; Demirtas H (2016). MultiOrd: Generation of Multivariate Ordinal Variates. R package version 2.2.
<a href="https://CRAN.R-project.org/package=MultiOrd">https://CRAN.R-project.org/package=MultiOrd</a>
</p>
<p>Barbiero A &amp; Ferrari PA (2015). Simulation of correlated Poisson variables. Applied Stochastic Models in
Business and Industry, 31: 669-80. doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.
</p>
<p>Barbiero A, Ferrari PA (2015). GenOrd: Simulation of Discrete Random Variables with Given
Correlation Matrix and Marginal Distributions. R package version 1.4.0. <a href="https://CRAN.R-project.org/package=GenOrd">https://CRAN.R-project.org/package=GenOrd</a>
</p>
<p>Demirtas H (2006). A method for multivariate ordinal data generation given marginal distributions and correlations. Journal of Statistical
Computation and Simulation, 76(11): 1017-1025. doi: <a href="http://doi.org/10.1080/10629360600569246">10.1080/10629360600569246</a>.
</p>
<p>Demirtas H (2014). Joint Generation of Binary and Nonnormal Continuous Data. Biometrics &amp; Biostatistics, S12.
</p>
<p>Demirtas H &amp; Hedeker D (2011). A practical way for computing approximate lower and upper correlation bounds.
American Statistician, 65(2): 104-109. doi: <a href="http://doi.org/10.1198/tast.2011.10090">10.1198/tast.2011.10090</a>.
</p>
<p>Demirtas H, Hedeker D, &amp; Mermelstein RJ (2012). Simulation of massive public health data by power polynomials.
Statistics in Medicine, 31(27): 3337-3346. doi: <a href="http://doi.org/10.1002/sim.5362">10.1002/sim.5362</a>.
</p>
<p>Demirtas H, Nordgren R, &amp; Allozi R (2017). PoisBinOrdNonNor: Generation of Up to Four Different Types of Variables. R package version 1.3.
<a href="https://CRAN.R-project.org/package=PoisBinOrdNonNor">https://CRAN.R-project.org/package=PoisBinOrdNonNor</a>
</p>
<p>Ferrari PA, Barbiero A (2012). Simulating ordinal data. Multivariate Behavioral Research, 47(4): 566-589.
doi: <a href="http://doi.org/10.1080/00273171.2012.692630">10.1080/00273171.2012.692630</a>.
</p>
<p>Fleishman AI (1978). A Method for Simulating Non-normal Distributions. Psychometrika, 43, 521-532. doi: <a href="http://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>.
</p>
<p>Frechet M.  Sur les tableaux de correlation dont les marges sont donnees.  Ann. l'Univ. Lyon SectA.  1951;14:53-77.
</p>
<p>Hasselman B (2018). nleqslv: Solve Systems of Nonlinear Equations. R package version 3.3.2.
<a href="https://CRAN.R-project.org/package=nleqslv">https://CRAN.R-project.org/package=nleqslv</a>
</p>
<p>Headrick TC (2002). Fast Fifth-order Polynomial Transforms for Generating Univariate and Multivariate
Non-normal Distributions. Computational Statistics &amp; Data Analysis, 40(4):685-711. doi: <a href="http://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>.
(<a href="http://www.sciencedirect.com/science/article/pii/S0167947302000725">ScienceDirect</a>)
</p>
<p>Headrick TC (2004). On Polynomial Transformations for Simulating Multivariate Nonnormal Distributions.
Journal of Modern Applied Statistical Methods, 3(1), 65-71. doi: <a href="http://doi.org/10.22237/jmasm/1083370080">10.22237/jmasm/1083370080</a>.
</p>
<p>Headrick TC, Kowalchuk RK (2007). The Power Method Transformation: Its Probability Density Function, Distribution
Function, and Its Further Use for Fitting Data. Journal of Statistical Computation and Simulation, 77, 229-249. doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>.
</p>
<p>Headrick TC, Sawilowsky SS (1999). Simulating Correlated Non-normal Distributions: Extending the Fleishman Power
Method. Psychometrika, 64, 25-35. doi: <a href="http://doi.org/10.1007/BF02294317">10.1007/BF02294317</a>.
</p>
<p>Headrick TC, Sawilowsky SS (2002). Weighted Simplex Procedures for Determining Boundary Points and Constants for the
Univariate and Multivariate Power Methods. Journal of Educational and Behavioral Statistics, 25, 417-436. doi: <a href="http://doi.org/10.3102/10769986025004417">10.3102/10769986025004417</a>.
</p>
<p>Headrick TC, Sheng Y, &amp; Hodis FA (2007). Numerical Computing and Graphics for the Power Method Transformation Using
Mathematica. Journal of Statistical Software, 19(3), 1 - 17. doi: <a href="http://doi.org/10.18637/jss.v019.i03">10.18637/jss.v019.i03</a>.
</p>
<p>Higham N (2002). Computing the nearest correlation matrix - a problem from finance; IMA Journal of Numerical Analysis 22: 329-343.
</p>
<p>Hoeffding W. Scale-invariant correlation theory. In: Fisher NI, Sen PK, editors. The collected works of Wassily Hoeffding.
New York: Springer-Verlag; 1994. p. 57-107.
</p>
<p>Kaiser S, Traeger D, &amp; Leisch F (2011). Generating Correlated Ordinal Random Values.  Technical Report Number 94, Department of Statistics,
University of Munich. <a href="https://epub.ub.uni-muenchen.de/12157/1/kaiser-tr-94-ordinal.pdf">https://epub.ub.uni-muenchen.de/12157/1/kaiser-tr-94-ordinal.pdf</a>
</p>
<p>Leisch F, Kaiser AWS, &amp; Hornik K (2010). orddata: Generation of Artificial Ordinal and Binary Data. R package version 0.1/r4.
</p>
<p>Olsson U, Drasgow F, &amp; Dorans NJ (1982). The Polyserial Correlation Coefficient. Psychometrika, 47(3): 337-47.
doi: <a href="http://doi.org/10.1007/BF02294164">10.1007/BF02294164</a>.
</p>
<p>Vale CD &amp; Maurelli VA (1983). Simulating Multivariate Nonnormal Distributions. Psychometrika, 48, 465-471. doi: <a href="http://doi.org/10.1007/BF02293687">10.1007/BF02293687</a>.
</p>
<p>Varadhan R, Gilbert P (2009). BB: An R Package for Solving a Large System of Nonlinear Equations and for
Optimizing a High-Dimensional Nonlinear Objective Function, J. Statistical Software, 32(4). doi: <a href="http://doi.org/10.18637/jss.v032.i04">10.18637/jss.v032.i04</a>.
<a href="http://www.jstatsoft.org/v32/i04/">http://www.jstatsoft.org/v32/i04/</a>
</p>
<p>Vaughan LK, Divers J, Padilla M, Redden DT, Tiwari HK, Pomp D, Allison DB (2009). The use of plasmodes as a supplement to simulations:
A simple example evaluating individual admixture estimation methodologies. Comput Stat Data Anal, 53(5):1755-66.
doi: <a href="http://doi.org/10.1016/j.csda.2008.02.032">10.1016/j.csda.2008.02.032</a>.
</p>
<p>Yahav I &amp; Shmueli G (2012). On Generating Multivariate Poisson Data in Management Science Applications. Applied Stochastic
Models in Business and Industry, 28(1): 91-102. doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>.
</p>


<h3>See Also</h3>

<p>Useful link: <a href="https://github.com/AFialkowski/SimMultiCorrData">https://github.com/AFialkowski/SimMultiCorrData</a>
</p>


</div>