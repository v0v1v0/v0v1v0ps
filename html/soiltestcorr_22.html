<div class="container">

<table style="width: 100%;"><tr>
<td>quadratic_plateau</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quadratic-plateau response function</h2>

<h3>Description</h3>

<p>This function helps to fit a quadratic-plateau response model and to
estimate a critical soil test values (CSTV) above which yield response becomes flat.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SS_QP(x, a, b, xs)

quadratic_plateau(
  data = NULL,
  stv,
  ry,
  target = NULL,
  tidy = TRUE,
  plot = FALSE,
  resid = FALSE
)

boot_quadratic_plateau(data, stv, ry, n = 1000, target = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>selfstart arg. for explanatory variable in SSquadp3xs Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>selfstart arg. for intercept Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>selfstart arg. for slope Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xs</code></td>
<td>
<p>selfstart arg. for break/join point in SSquadp3xs Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional argument to call and object of type data.frame or data.table
containing the stv and ry data, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stv</code></td>
<td>
<p>name of the vector containing soil test values (-) of type <code>numeric</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p>name of the vector containing relative yield values (%) of type <code>numeric</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p><code>numeric</code> value of relative yield target (e.g. 90 for 90%) to estimate the CSTV.
The target needs to be &lt; plateau, otherwise, target = plateau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tidy</code></td>
<td>
<p>logical operator (TRUE/FALSE) to decide the type of return. TRUE returns a tidy data frame or tibble (default), FALSE returns a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical operator (TRUE/FALSE) to plot the quadratic-plateau model, Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>logical operator (TRUE/FALSE) to plot residuals analysis, Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size for the bootstrapping Default: 500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>when running bootstrapped samples, the <code>...</code> (open arguments) allows to add grouping variable/s (factor or character) Default: NULL</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <a href="https://adriancorrendo.github.io/soiltestcorr/articles/quadratic_plateau_tutorial.html">online-documentation</a> for additional details.
</p>


<h3>Value</h3>

<p>returns an object of type <code>ggplot</code> if plot = TRUE.
</p>
<p>returns a residuals plot if resid = TRUE.
</p>
<p>returns an object of class <code>data.frame</code> if tidy = TRUE,
</p>
<p>returns an object of class <code>list</code> if tidy = FALSE.
</p>
<p>SS_QP: selfStart function to pass into the quadratic_plateau fit
</p>
<p>quadratic_plateau: function
</p>
<p>boot_quadratic_plateau: bootstrapping function
</p>


<h3>Note</h3>

<p>For extended reference, we recommend to visit
<a href="https://gradcylinder.org/post/quad-plateau/">https://gradcylinder.org/post/quad-plateau/</a> by Austin Pearce.
Self-start function code adapted from nlraa package by F. Miguez <a href="https://github.com/femiguez/nlraa">https://github.com/femiguez/nlraa</a>
</p>


<h3>References</h3>

<p>Bullock, D.G. and Bullock, D.S. (1994)
Quadratic and Quadratic-Plus-Plateau Models for Predicting Optimal Nitrogen Rate of Corn: A Comparison.
<em>Agron. J., 86: 191-195.</em> <a href="https://doi.org/10.2134/agronj1994.00021962008600010033x">doi:10.2134/agronj1994.00021962008600010033x</a>
</p>


<h3>See Also</h3>

<p><code>eval_tidy</code>,<code>defusing-advanced</code>
<code>nlsLM</code>
<code>SSlinp</code>
<code>AIC</code>,<code>lm</code>,<code>optim</code>,<code>coef</code>,<code>predict</code>
<code>AICc</code>
<code>model-quality</code>
<code>nlsResiduals</code>
<code>bind</code>
<code>ggplot</code>,<code>aes</code>,<code>geom_rug</code>,<code>geom_point</code>,<code>geom_abline</code>,<code>geom_path</code>,<code>annotate</code>,<code>labs</code>,<code>theme</code>
<code>annotate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example dataset
 df &lt;- data.frame("ry" = c(65,80,85,88,90,94,93,96,97,95,98,100,99,99,100),
                  "stv" = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))
 # Run
 fit_example_qp &lt;- quadratic_plateau(data = df, 
 stv = stv, ry = ry, resid = TRUE, plot = FALSE)
 fit_example_qp

</code></pre>


</div>