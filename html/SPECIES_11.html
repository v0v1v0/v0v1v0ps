<div class="container">

<table style="width: 100%;"><tr>
<td>pcg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson-compound Gamma estimator for the species richness </h2>

<h3>Description</h3>

<p>Function to calculate the Poisson-compound Gamma estimators of the species number by Wang 2010. This method
is essentially a conditional NPMLE method. The species abundance here is assumed to follow a compound 
Gamma model. The confidence interval is obtained based on a bootstrap procedure.
A Fortran function is called to for the computing. This function requires Fortran compiler installed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcg(n,t=35,C=0,alpha=c(1:10),b=200,seed=NULL,conf=0.95,dis=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the “frequency of frequencies” data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a positive integer. <code>t</code> is the cutoff value defining the relatively less abundant species to be used in estimation. The default value for <code>t</code>=35.
The  estimator is more sensitive to t compared with pnpmle or unpmle estimators. We recommend to use <code class="reqn">t \ge 20</code> if the maximum frequency (<code class="reqn">j</code>) is greater than 20. Otherwise use the maximum frequency of <code class="reqn">j</code> for <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>integer either 0 or 1. It specifies whether bootstrap confidence interval should be calculated. “<code>C</code>=1” for YES and “<code>C</code>=0” for NO.The default of <code>C</code> is set as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>integer. <code>b</code> specifies the number of bootstrap samples to be generated for confidence interval. It is ignored if “<code>C</code>=0”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a positive grid for Gamma shape parameter. <code>alpha</code> must be a numerical vector for positive numbers. A cross-validation will be used to select a unified shape parameter value for the compound Gamma from the specified “<code>alpha</code>” grid. The default “<code>alpha</code>” grid is <code class="reqn">1,2,\ldots,10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a single value, interpreted as an integer. Seed for random number generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>0 or 1. 1 for on-screen display of the mixture output, and 0 for none.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>pcg</code> estimator is computing intensive. The computing of bootstrap confidence interval may take up to a few hours.
</p>


<h3>Value</h3>

<p>The function <code>pcg</code> returns a list of:  <code>Nhat</code>, <code>CI</code> (if “<code>C</code>=1”) and <code>AlphaModel</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Nhat</code></td>
<td>
<p>point estimate of <code>N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>bootstrap confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AlphaModel</code></td>
<td>
<p>unified shape parameter of compound Gamma selected from cross-validation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University</p>


<h3>References</h3>

<p>Wang, J.-P. (2010), Estimating the species richness by a Poisson-Compound Gamma model, 97(3): 727-740</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SPECIES)
##load data from the package, 
## \dQuote{butterfly} is the famous butterfly data by Fisher 1943.

data(butterfly)

##output estimate without confidence interval using cutoff t=15
##pcg(butterfly,t=20,C=0,alpha=c(1:10))

##output estimate with confidence interval using cutoff t=15
#pcg(butterfly,t=20,C=1,alpha=c(1:10),b=200)
</code></pre>


</div>