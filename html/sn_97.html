<div class="container">

<table style="width: 100%;"><tr>
<td>profile.selm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile log-likelihood function of selm-class objects</h2>

<h3>Description</h3>

<p>One- or two-dimensional profile (penalized) log-likelihood function of a 
<code>selm</code> fit and corresponding confidence interval or regions
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'selm'
profile(fitted, param.type, param.name, param.values, npt, 
   opt.control = list(), plot.it = TRUE, log = TRUE, levels, 
   trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>an object of class <code>selm</code> as produced by a call to
function <code>selm</code> with univariate response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.type</code></td>
<td>

<p>a character string with the required parameterization; it must be either
<code>"CP"</code> or <code>"DP"</code>, or possibly their equivalent lowercase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.name</code></td>
<td>

<p>either a single character string  or a vector of two such terms with the 
name(s) of the parameter(s) for which the profile log-likelihood is 
required; these names must match those appearing in 
<code>summary.selm(object, param.type)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.values</code></td>
<td>
<p>in the one-parameter case, a numeric vector with 
the values where the log-likelihood must be evaluated; in the two-parameter
case, a list of two such vectors used to build a  grid of coordinates 
of points. Their range must identify an interval or a rectangle which
includes the <abbr><span class="acronym">MLE</span></abbr> or <abbr><span class="acronym">MPLE</span></abbr> obtained by <code>selm</code>.
See ‘Details’ for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npt</code></td>
<td>

<p>in case the vector or any of the vectors of argument <code>param.values</code> 
has length 2, an equally spaced grid of values is build with length equal
to the corresponding component of <code>npt</code>.
If the above condition is met but this argument is missing,  
a default choice is made, namely 51 or (26,26) in the one- or two-parameter
case, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.control</code></td>
<td>

<p>an optional list passed as argument <code>control</code> to <code>optim</code> to
optimize the log-likelihood; see ‘Details’ for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>a logical value; if <code>TRUE</code> (default value), a plot 
is produced representing the deviance, which is described in 
‘Details’ below.
In the one-parameter case, a confidence interval of prescribed <code>level</code>
is marked on the plot; in the two-parameter case, the contour curves are
labelled with approximate confidence levels. See however 
for more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a logical value (default: <code>TRUE</code>)  indicating whether the
scale and tail-weight parameter (the latter only for the <abbr><span class="acronym">ST</span></abbr> 
family) must be log-transformed, if case any of them occurs in   
<code>param.name</code>. This applies to <code>omega</code> and 
<code>nu</code> in the <code>DP</code> parameter set and to <code>s.d.</code> and 
<code>gamma2</code> in the <code>CP</code> parameter set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a single probability value (in the one-parameter case) or a 
vector of such values (in the two-parameter case) for which the confidence
interval or region is requited; see ‘Details’ for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>a logical value (default: <code>FALSE</code>) to activate printing
of intermediate outcome of the log-likelihood optimization process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional graphical parameters passed to the plotting functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each chosen point of the parameter(s) to be profiled, the 
log-likelihood is maximized with respect to the remaining parameters.
The optimization process is accomplished using the <code>optim</code>
optimization function, with <code>method="BFGS"</code>. This step can be regulated by
the user via <code>opt.control</code> which is  passed to <code>optim</code> 
as <code>control</code> argument, apart from element <code>fnscale</code> whose use is
reserved.
</p>
<p>If the original <code>fitted</code> object included a fixed parameter value, 
this is kept fixed here. If the estimation method was <code>"MPLE"</code>,
that choice carries on here; in case the penalty function was user-defined,
it must still be accessible.
</p>
<p>For plotting purposes and also in the numerical output, the deviance
function <code class="reqn">D</code> is used, namely
</p>
<p style="text-align: center;"><code class="reqn">D = 2\left[\max(\log L) - \log L\right]</code>
</p>

<p>where <code class="reqn">L</code> denotes the likelihood.  
</p>
<p>The range of <code>param.values</code> must enclose the maximum (penalized)
likelihood estimates (<abbr><span class="acronym">MLE</span></abbr> or <abbr><span class="acronym">MPLE</span></abbr>) by an adequate extent 
such that suitable confidence intervals or regions can be established from
standard asymptotic theory. If this condition does not hold, the function
still proceeds, but no confidence interval or region is delivered.
For the <abbr><span class="acronym">SN</span></abbr> family and <abbr><span class="acronym">DP</span></abbr> parameterization, the asymptotic
theory is actually non-standard near the important point <code class="reqn">\alpha=0</code>, 
but the correspondence with the regular case of the <abbr><span class="acronym">CP</span></abbr> 
parameterization, still allows to derive confidence regions using standard
procedures; for additional information, see Section 3.1.6 of
Azzalini and Capitanio (2014).
When the <abbr><span class="acronym">MLE</span></abbr> occurs on the frontier of the parameter space, 
a message is issued and no confidence interval is produced, while in the
two-parameter case the plot is not labelled with probability values, but only
with deviance levels.
</p>


<h3>Value</h3>

<p>An invisible list whose components, described below, are partly 
different in the one- and the two-parameter cases.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the calling statement</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>&lt;param1&gt;</code></td>
<td>
<p>values of the first parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>&lt;param2&gt;</code></td>
<td>
<p>values of the second parameter (in the two-parameter case)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>numeric vector or matrix of the profile log-likelihood values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>in the one-parameter case, the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>in the one-parameter case, the confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance.contour</code></td>
<td>
<p>in the two-parameter case, a list of lists whose
elements identify each curve of the contour plot</p>
</td>
</tr>
</table>
<h3>Warnings</h3>


<ul>
<li>
<p> This function is experimental and changes in future versions
of the package may occur. Users should not rely on the persistence of the 
same user interface or the same name(s).
</p>
</li>
<li>
<p> It is a known fact that, in some critical situations, peculiar outcomes
are produced.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series. 
</p>


<h3>See Also</h3>

<p><code>selm</code>, <code>summary.selm</code>,
</p>
<p><code>makeSECdistr</code> for the <abbr><span class="acronym">CP</span></abbr>/<abbr><span class="acronym">DP</span></abbr> parameterizations,
</p>
<p><code>optim</code> for its <code>control</code> argument
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ais, package="sn")
m1 &lt;-  selm(log(Fe) ~ BMI + LBM, family = "sn", data = ais)

pll &lt;- profile(m1, "dp", param.name="alpha", param.val=c(-3,2))

profile(m1, "cp", param.name="gamma1", param.val=seq(-0.7, 0.4, by=0.1))

# in the next example, we reduce the grid points to save execution time
pll &lt;- profile(m1, "cp", param.name=c("(Intercept.CP)", "gamma1"),
           param.val = list(c(1.5, 4), c(-0.8, 0.5)), npt=c(11,11) )
</code></pre>


</div>