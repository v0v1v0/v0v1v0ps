<div class="container">

<table style="width: 100%;"><tr>
<td>makeGraphDf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a data.frame from a ChangeoClone and an igraph object containing a clonal lineage</h2>

<h3>Description</h3>

<p><code>makeGraphDf</code> creates a data.frame from a ChangeoClone and an 
igraph <code>graph</code> object containing a B cell lineage tree and associated sequence data. 
The data.frame contains the original fields and additions such as each sequence's parent in the 
lineage tree, the lineage germline, and additional rows for inferred sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">makeGraphDf(
  curCloneGraph,
  curCloneObj,
  objSeqId = "sequence_id",
  objSeq = "sequence"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curCloneGraph</code></td>
<td>
<p>an igraph <code>graph</code> object for the lineage tree generated by 
buildPhylipLineage. Note that the field containing the 
nucleotide sequence in the object must be named <code>sequence</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curCloneObj</code></td>
<td>
<p>ChangeoClone object used to generate the lineage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objSeqId</code></td>
<td>
<p>name of the sequence identifier field in <code>curCloneObj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objSeq</code></td>
<td>
<p>name of the nucleotide sequence field in <code>curCloneObj</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> with sequence and lineage information, including the
the parent nucleotide sequence in the lineage tree(<code>parent_sequence</code>), 
an internal parent identifier (<code>parent</code>), and additional rows for germline 
sequence and inferred intermediate sequences.
</p>
<p>Values in the <code>sequence_id</code> field are renamed to numeric values,
prefixed with the clonal grouping identifier and labeled as either <code>"Inferred"</code> 
or <code>"Germline"</code> if they are not an observed sequence. For example, for a lineage 
with <code>clone_id = 34</code> the new identifiers would be of the form: 
<code>"34_Germline"</code>, <code>"34_Inferred1"</code>, <code>"34_1"</code>, <code>"34_2"</code>, etc.
</p>
<p>Note that the original sequence identifier is preserved in the <code>orig_sequence_id</code> field 
and the original parent sequence identifier is retained in <code>orig_parent</code>.
</p>


<h3>See Also</h3>

<p>See observedMutations to calculate mutation frequencies using
<code>parent_sequence</code> as the reference germline. See ChangeoClone,
buildPhylipLineage, and graph for details on the 
input objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load and subset example data
data(ExampleDb, package = "alakazam")
data(ExampleTrees, package = "alakazam")
graph &lt;- ExampleTrees[[17]]
db &lt;- subset(ExampleDb, clone_id == graph$clone)
clone &lt;- alakazam::makeChangeoClone(db)

# Extend data with lineage information
df &lt;- makeGraphDf(graph, clone)

</code></pre>


</div>