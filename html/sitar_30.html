<div class="container">

<table style="width: 100%;"><tr>
<td>LMSfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate LMS curves from tabulated growth reference centiles</h2>

<h3>Description</h3>

<p>A function to summarise an existing set of growth reference centiles as the
L, M and S curves of the LMS method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LMSfit(
  x,
  y,
  sex,
  data = parent.frame(),
  centiles = c(3, 10, 25, 50, 75, 90, 97),
  df = c(6, 10, 8),
  L1 = FALSE,
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of tabulated ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix of corresponding measurement centiles, e.g. of height or
weight, with <code>nrows = length(x)</code> and <code>ncols = length(centiles)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sex</code></td>
<td>
<p>two-level factor where level 1 corresponds to male and level 2 to
female.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing <code>x</code>, <code>y</code> and
<code>sex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centiles</code></td>
<td>
<p>vector of centiles corresponding to the columns of <code>y</code>,
default c(3, 10, 25, 50, 75, 90, 97).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>length-3 vector with the cubic smoothing spline equivalent degrees
of freedom (edf) for the L, M and S curves, default c(6, 10, 8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L1</code></td>
<td>
<p>logical constraining the L curve to 1, i.e. a Normal distribution,
default FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical to plot the estimated L, M and S curves, default TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional graphical parameters for the plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At each age the optimal Box-Cox power Lopt is estimated to render the
centiles closest to Normal, and the corresponding median Mopt and
coefficient of variation Sopt are derived. The three sets of values are then
smoothed across age to give L, M and S.
</p>


<h3>Value</h3>

<p>A list with the results: </p>
 <dl>
<dt>list("LMS")</dt>
<dd>
<p>data frame of
sex, x, L, M, S, Lopt, Mopt, Sopt.</p>
</dd> <dt>list("ey")</dt>
<dd>
<p>matrix of predicted
values of <code>y</code>.</p>
</dd> <dt>list("ez")</dt>
<dd>
<p>matrix of predicted
values of <code>z</code>.</p>
</dd> <dt>list("fit")</dt>
<dd>
<p>matrix of summary statistics for
<code>ey</code>, giving for each column <code>cmean</code> the mean centile, <code>zmean</code>
the mean z-score, <code>zSD</code> the SD of the z-score, and <code>zmin</code> and
<code>zmax</code> the minimum and maximum z-scores.</p>
</dd> </dl>
<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>LMS2z</code>, <code>z2cent</code>. The LMS method can be
fitted to data using the package <code>gamlss</code> with the <code>BCCG</code> family,
where nu (originally lambda), mu and sigma correspond to L, M and S
respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## first construct table of boys weight centiles by age for WHO standard
data(who06)
zs &lt;- -4:4*2/3 # z-scores for centiles
ages &lt;- 0:12/4 # ages 0-3 years by 3 months
v &lt;- vapply(as.list(zs), function(z)
 LMS2z(ages, z, sex = 1, measure = 'wt', ref = 'who06', toz = FALSE),
  rep(0, length(ages)))
round(v, 2)

## then back-calculate the original LMS curves and display summary statistics
LMSfit(x=ages, y=v, sex=1, centiles=pnorm(zs)*100, plot=FALSE)

</code></pre>


</div>