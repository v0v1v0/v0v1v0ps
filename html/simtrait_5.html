<div class="container">

<table style="width: 100%;"><tr>
<td>pval_aucpr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Area under the precision-recall curve</h2>

<h3>Description</h3>

<p>Calculates the Precision-Recall (PR) Area Under the Curve (AUC) given a vector of p-values and the true classes (causal (alternative) vs non-causal (null)).
This is a wrapper around <code>PRROC::pr.curve()</code>, which actually calculates the AUC (see that for details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pval_aucpr(pvals, causal_indexes, curve = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>The vector of association p-values to analyze.
<code>NA</code> values are allowed in input, are internally set to 1 (worst score) prior to AUC calculation (to prevent methods to get good AUCs by setting more cases to <code>NA</code>).
Non-<code>NA</code> values outside of [0,1] will trigger an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causal_indexes</code></td>
<td>
<p>The vector of causal indexes, defining the true classes used for AUC calculation.
Values of <code>causal_indexes</code> as returned by <code>sim_trait</code> work.
There must be at least one causal index and at least one non-causal case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve</code></td>
<td>
<p>If <code>FALSE</code> (default), only scalar AUC is returned.
If <code>TRUE</code>, then <code>curve = TRUE</code> is passed to <code>PRROC::pr.curve()</code> and the full object (class <code>PRROC</code>) is returned (see below).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>curve = FALSE</code>, returns the PR AUC scalar value.
If <code>curve = TRUE</code>, returns the <code>PRROC</code> object as returned by <code>PRROC::pr.curve()</code>, which can be plotted directly, and which contains the AUC under the named value <code>auc.integral</code>.
</p>
<p>However, if the input <code>pvals</code> is <code>NULL</code> (taken for case of singular association test, which is rare but may happen), then the returned value is <code>NA</code>.
</p>


<h3>See Also</h3>

<p><code>PRROC::pr.curve()</code>, which is used internally by this function.
</p>
<p><code>pval_power_calib()</code> for calibrated power estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate truly null p-values, which should be uniform
pvals &lt;- runif(10)
# for toy example, take the first two p-values to be truly causal
causal_indexes &lt;- 1:2
# calculate desired measure
pval_aucpr( pvals, causal_indexes )

</code></pre>


</div>