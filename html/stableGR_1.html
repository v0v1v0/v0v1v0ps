<div class="container">

<table style="width: 100%;"><tr>
<td>stableGR-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A Stable Gelman-Rubin Diagnostic for Markov Chain Monte Carlo
</h2>

<h3>Description</h3>


<p>Practitioners of Bayesian statistics often use Markov chain Monte Carlo (MCMC) samplers to sample from a posterior distribution. This package determines whether the MCMC sample is large enough   to yield reliable estimates of the target distribution. In particular, this calculates a Gelman-Rubin convergence diagnostic using stable and consistent estimators of Monte Carlo variance. Additionally, this uses the connection between an MCMC sample's effective sample size and the Gelman-Rubin diagnostic to produce a threshold for terminating MCMC simulation. Finally, this informs the user whether enough samples have been collected  and (if necessary) estimates the number of samples needed for a desired level of accuracy. The theory underlying these methods can be found in "Revisiting the Gelman-Rubin Diagnostic" by Vats and  Knudson (2018) &lt;arXiv:1812:09384&gt;. 
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> stableGR</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> A Stable Gelman-Rubin Diagnostic for Markov Chain Monte Carlo</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2022-10-7</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(person("Christina", "Knudson", role = c("aut", "cre"),
    email = "drchristinaknudson@gmail.com"), person("Dootika", "Vats", role = c("aut"), email = "dootika.vats@gmail.com"))</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Christina Knudson &lt;drchristinaknudson@gmail.com&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Practitioners of Bayesian statistics often use Markov chain Monte Carlo (MCMC) samplers to sample from a posterior distribution. This package determines whether the MCMC sample is large enough   to yield reliable estimates of the target distribution. In particular, this calculates a Gelman-Rubin convergence diagnostic using stable and consistent estimators of Monte Carlo variance. Additionally, this uses the connection between an MCMC sample's effective sample size and the Gelman-Rubin diagnostic to produce a threshold for terminating MCMC simulation. Finally, this informs the user whether enough samples have been collected  and (if necessary) estimates the number of samples needed for a desired level of accuracy. The theory underlying these methods can be found in "Revisiting the Gelman-Rubin Diagnostic" by Vats and  Knudson (2018) &lt;arXiv:1812:09384&gt;. </td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.5), mcmcse(&gt;= 1.4-1)</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> mvtnorm</td>
</tr>
<tr>
<td style="text-align: left;">
ByteCompile: </td>
<td style="text-align: left;"> TRUE</td>
</tr>
<tr>
<td style="text-align: left;">
Repository: </td>
<td style="text-align: left;"> CRAN</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.1.1</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Christina Knudson [aut, cre],
  Dootika Vats [aut]</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Practitioners of Bayesian statistics often use Markov chain Monte Carlo (MCMC) samplers to sample from a posterior distribution. This package determines whether the MCMC sample is large enough   to yield reliable estimates of the target distribution. In particular, this calculates a Gelman-Rubin convergence diagnostic using stable and consistent estimators of Monte Carlo variance. Additionally, this uses the connection between an MCMC sample's effective sample size and the Gelman-Rubin diagnostic to produce a threshold for terminating MCMC simulation. Finally, this informs the user whether enough samples have been collected  and (if necessary) estimates the number of samples needed for a desired level of accuracy. The theory underlying these methods can be found in "Revisiting the Gelman-Rubin Diagnostic" by Vats and  Knudson (2018) &lt;arXiv:1812:09384&gt;. 
</p>
<p>This package is unique in a few ways. First, it uses stable variance estimators to calculate a stabilized Gelman-Rubin statistic. Second, it leverages the connection between effective sample size and the potential scale reduction factor (PSRF). Third, this diagnostic can be used whether MCMC samples were created from a single chain or multiple chains. 
</p>
<p>The main functions in the package are <code>stable.GR</code>, <code>n.eff</code>, and <code>target.psrf</code>. <code>stable.GR</code>  returns the univariate PSRF, the multivariate PSRF, and the estimated effective sample size. <code>n.eff</code>  returns informs the user whether sufficient MCMC samples have been collected; if not, <code>n.eff</code> also returns the estimated target sample size <code>target.psrf</code> creates a termination threshold for <code>stable.GR</code>; MCMC sampling can terminate when the MCMC samples' psrf is smaller than the value returned by <code>target.psrf</code>.
</p>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: Christina Knudson &lt;drchristinaknudson@gmail.com&gt;
</p>


<h3>References</h3>

 
<p>Vats, D. and Knudson, C. Revisiting the Gelman-Rubin Diagnostic.	arXiv:1812.09384. 
</p>
<p>Vats, D. and Flegal, J. Lugsail lag windows and their application to MCMC. arXiv: 1809.04541.
</p>
<p>Flegal, J. M. and Jones, G. L. (2010) Batch means and spectral variance estimators in Markov chain Monte Carlo. <em>The Annals of Statistics</em>, <b>38</b>, 1034â€“1070. 
</p>
<p>Gelman, A and Rubin, DB (1992) Inference from iterative simulation using multiple sequences, <em>Statistical Science</em>, <b>7</b>, 457-511. 
</p>
<p>Brooks, SP. and Gelman, A. (1998) General methods for monitoring convergence of iterative simulations. <em>Journal of Computational and Graphical Statistics</em>, <b>7</b>, 434-455.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(stableGR)
set.seed(100)
p &lt;- 2
n &lt;- 100 # For real problems, use a MUCH larger n.

sig.mat = matrix(c(1, .8, .8, 1), ncol = 2, nrow = 2)

# Making 3 chains
chain1 &lt;- mvn.gibbs(N = n, p = p, mu = rep(1,p), sigma = sig.mat)
chain2 &lt;- mvn.gibbs(N = n, p = p, mu = rep(1,p), sigma = sig.mat)
chain3 &lt;- mvn.gibbs(N = n, p = p, mu = rep(1,p), sigma = sig.mat)

# find GR diagnostic using all three chains
x &lt;- list(chain1, chain2, chain3)
stable.GR(x) 


</code></pre>


</div>