<div class="container">

<table style="width: 100%;"><tr>
<td>bandwidth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic selection of the bandwidth parameter <code>h</code>
</h2>

<h3>Description</h3>

<p>This functions implements the minimization of the combined penalty function
described by Holland and Thayer (1989); Von Davier et al, (2004). It returns 
the optimal value of <code>h</code> for kernel continuization, according to the above 
mentioned criteria. Different types of kernels (others than the gaussian) are accepted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bandwidth(scores, kert, degree, design, Kp = 1, scores2, degreeXA, degreeYA, 
J, K, L, wx, wy, w, r=NULL) 
</code></pre>


<h3>Arguments</h3>

<p>      	Note that depending on the specified equating design, not all arguments are necessary
as detailed below.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>	If the "EG" design is specified, a vector containing the raw sample frequencies 
coming from one group taking the test.
</p>
<p>If the "SG" design is specified, a matrix containing the (joint) bivariate sample 
frequencies for <code class="reqn">X</code> (raws) and <code class="reqn">Y</code> (columns).
</p>
<p>If the "CB" design is specified, a two column matrix containing the observed scores 
of the sample taking test <code class="reqn">X</code> first, followed by test <code class="reqn">Y</code>. The <code>scores2</code> 
argument is then used for the scores of the sample taking test Y first followed by test 
<code class="reqn">X</code>.
</p>
<p>If either the "NEAT_CB" or "NEAT_PSE" design is selected, a two column matrix containing 
the observed scores on	test <code class="reqn">X</code> (first column) and the observed scores on the anchor 
test <code class="reqn">A</code> (second column). The <code>scores2</code> argument is then used for the observed 
scores on test <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kert</code></td>
<td>
<p>		A character string giving the type of kernel to be used for continuization. 
Current options include "<code>gauss</code>", "<code>logis</code>", and "<code>uniform</code>" 
for the gaussian, logistic and uniform kernels, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>	Either a number or vector indicating the number of power moments to be fitted to the 
marginal distributions, or the number or cross moments to be fitted to the joint 
distributions, respectively. For the "EG" design it will be a number (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>	A character string indicating the equating design (one of "EG", "SG", "CB", "NEAT_CE", 
"NEAT_PSE")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kp</code></td>
<td>
<p>		A number which acts as a weight for the second term in the combined penalization function used 
to obtain <code>h</code> (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores2</code></td>
<td>
<p>	Only used for the "CB", "NEAT_CE" and "NEAT_PSE" designs. See the description of
<code>scores</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degreeXA</code></td>
<td>
<p>	A vector indicating the	number of power moments to be fitted to the marginal distributions 
<code class="reqn">X</code> and <code class="reqn">A</code>, and the number or cross moments to be fitted to the joint 
distribution <code class="reqn">(X,A)</code>	(see details). Only used for the "NEAT_CE" and "NEAT_PSE" designs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degreeYA</code></td>
<td>
<p>	Only used for the "NEAT_CE" and "NEAT_PSE" designs (see the description for
<code>degreeXA</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>		The number of possible <code class="reqn">X</code> scores. Only needed for "CB", "NEAT_CB" and "NEAT_PSE" designs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>		The number of possible <code class="reqn">Y</code> scores. Only needed for "CB", "NEAT_CB" and "NEAT_PSE" designs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>		The number of possible <code class="reqn">A</code> scores. Needed for "NEAT_CB" and "NEAT_PSE" designs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wx</code></td>
<td>
<p>		A number that satisfies <code class="reqn">0\leq w_X\leq 1</code> indicating the weight put on the data 
that is not subject to order effects. Only used for the "CB" design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>		A number that satisfies <code class="reqn">0\leq w_Y\leq 1</code> indicating the weight put on the data 
that is not subject to order effects. Only used for the "CB" design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>		A number that satisfies <code class="reqn">0\leq w\leq 1</code> indicating the weight given to 
population <code class="reqn">P</code>. Only used for the "NEAT" design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>		Score probabilities.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>	To automatically select <code>h</code>, the function minimizes 
</p>
<p style="text-align: center;"><code class="reqn">PEN_1(h)+K\times PEN_2(h)</code>
</p>

<p>where <code class="reqn">PEN_1(h)=\sum_j(\hat{r}_j-\hat{f}_h(x_j))^2</code>, and 
<code class="reqn">PEN_2(h)=\sum_jA_j(1-B_j)</code>. The terms <code class="reqn">A</code> and <code class="reqn">B</code> 
are such that <code class="reqn">PEN_2</code> acts as a smoothness penalty term that avoids rapid 
fluctuations in the approximated density (see Chapter 10 in Von Davier, 2011 for more details). The 
<code class="reqn">K</code> term corresponds to the <code>Kp</code> argument of the <code>bandwidth</code> function. The 
<code class="reqn">\hat{r}</code> values are assumed to be estimated by polynomial loglinear models of specific
<code>degree</code>, which come from a call to <code>loglin.smooth</code>.
</p>


<h3>Value</h3>

<p>		A number which is the optimal value of <code>h</code>.</p>


<h3>Author(s)</h3>

<p>Jorge Gonzalez <a href="mailto:jorge.gonzalez@mat.uc.cl">jorge.gonzalez@mat.uc.cl</a>
</p>


<h3>References</h3>

<p>Gonzalez, J. (2014). SNSequate: Standard and Nonstandard Statistical Models and Methods for Test 
Equating. <em>Journal of Statistical Software, 59(7),</em> 1-30.
</p>
<p>Von Davier, A., Holland, P., and Thayer, D. (2004). <em>The Kernel Method of Test Equating</em>. 
New York, NY: Springer-Verlag.
</p>
<p>A. von Davier (Ed.) (2011). <em>Statistical Models for Equating, Scaling, and Linking. New York: Springer</em>
</p>


<h3>See Also</h3>

<p><code>loglin.smooth</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Example: The "Standard" column and firsts two rows of Table 10.1 in 
#Chapter 10 of Von Davier 2011

data(Math20EG)

hx.logis&lt;-bandwidth(scores=Math20EG[,1],kert="logis",degree=2,design="EG")$h
hx.unif&lt;-bandwidth(scores=Math20EG[,1],kert="unif",degree=2,design="EG")$h 
hx.gauss&lt;-bandwidth(scores=Math20EG[,1],kert="gauss",degree=2,design="EG")$h

hy.logis&lt;-bandwidth(scores=Math20EG[,2],kert="logis",degree=3,design="EG")$h
hy.unif&lt;-bandwidth(scores=Math20EG[,2],kert="unif",degree=3,design="EG")$h 
hy.gauss&lt;-bandwidth(scores=Math20EG[,2],kert="gauss",degree=3,design="EG")$h

partialTable10.1&lt;-rbind(c(hx.logis,hx.unif,hx.gauss),
				c(hy.logis,hy.unif,hy.gauss))

dimnames(partialTable10.1)&lt;-list(c("h.x","h.y"),c("Logistic","Uniform","Gaussian"))
partialTable10.1

</code></pre>


</div>