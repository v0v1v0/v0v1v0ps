<div class="container">

<table style="width: 100%;"><tr>
<td>SESraster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standardized effect sizes for SpatRaster objects</h2>

<h3>Description</h3>

<p>Calculates the standardized effect sizes using a custom function
and a null model algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SESraster(
  x,
  FUN = NULL,
  FUN_args = list(),
  spat_alg = NULL,
  spat_alg_args = list(),
  Fa_sample = NULL,
  Fa_alg = NULL,
  Fa_alg_args = list(),
  aleats = 10,
  cores = 1,
  filename = "",
  overwrite = FALSE,
  force_wr_aleat_file = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>The function to be applied. It must work with SpatRaster objects.
See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN_args</code></td>
<td>
<p>Named list of arguments passed to the FUN</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code>bootspat_naive</code>,
<code>bootspat_str</code>, <code>bootspat_ff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code>bootspat_naive</code>, <code>bootspat_str</code>,
<code>bootspat_ff</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fa_sample</code></td>
<td>
<p>Named list of length 1 with a FUN argument (e.g. a vector)
to be randomized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fa_alg</code></td>
<td>
<p>function to randomize any non spatial argument to be passed
to 'FUN'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fa_alg_args</code></td>
<td>
<p>Named list of arguments passed to the function in 'Fa_alg'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>positive integer. If <code>cores &gt; 1</code>, a 'parallel' package cluster with that many cores is created and used. You can also supply a cluster object. Ignored for functions that are implemented by terra in C++ (see under fun)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. Output filename</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_wr_aleat_file</code></td>
<td>
<p>logical. Force writing bootstrapped rasters, even if
files fit in memory. Mostly used for internal test units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to 'terra::app()' function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Perform n=aleats spatial randomizations based on the randomization
method defined in 'spat_alg' argument and calculates the metric
defined in 'FUN' argument. The function (FUN) to calculate the desired metric
must work with any of app, focal,
focal3D family of functions.
</p>


<h3>Value</h3>

<p>SpatRaster. The function returns the observed metric, the mean of the
simulations calculated over n=aleats times, the standard deviation of the
simulations, and the standardized effect size (SES) for the metric defined in FUN.
</p>


<h3>Author(s)</h3>

<p>Neander M. Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Gotelli 2000
</p>


<h3>See Also</h3>

<p><code>bootspat_str</code>, <code>bootspat_naive</code>,
<code>bootspat_ff</code>, <code>algorithm_metrics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SESraster)
library(terra)
r &lt;- load_ext_data()
appmean &lt;- function(x, ...){
                      terra::app(x, "mean", ...)
                    }
ses &lt;- SESraster(r, FUN=appmean, spat_alg = "bootspat_naive", spat_alg_args=list(random="species"),
                 aleats = 4)
plot(ses)
ses &lt;- SESraster(r, FUN=appmean, spat_alg = "bootspat_naive", spat_alg_args=list(random="site"),
                 aleats = 4)
plot(ses)

## example of how to use 'FUN_args'
r[7][1] &lt;- NA
plot(r)
set.seed(10)
sesNA &lt;- SESraster(r, FUN=appmean, FUN_args = list(na.rm = FALSE),
                 spat_alg = "bootspat_naive", spat_alg_args=list(random = "species"),
                 aleats = 4)
plot(sesNA)

set.seed(10)
ses &lt;- SESraster(r, FUN=appmean, FUN_args = list(na.rm = TRUE),
                spat_alg = "bootspat_naive", spat_alg_args=list(random = "species"),
                 aleats = 4)
plot(ses)

## example with 'Fa_alg'
appsv &lt;- function(x, lyrv, na.rm = FALSE, ...){
                      sumw &lt;- function(x, lyrv, na.rm, ...){
                            ifelse(all(is.na(x)), NA,
                                    sum(x*lyrv, na.rm=na.rm, ...))
                      }
                      stats::setNames(terra::app(x, sumw, lyrv = lyrv, na.rm=na.rm, ...), "sumw")
                    }
set.seed(10)
ses &lt;- SESraster(r, FUN=appsv,
                 FUN_args = list(lyrv = seq_len(nlyr(r)), na.rm = TRUE),
                    Fa_sample = "lyrv",
                    Fa_alg = "sample", Fa_alg_args = list(replace=FALSE),
                    aleats = 4)
plot(ses)

set.seed(10)
ses &lt;- SESraster(r, FUN=appsv,
                 FUN_args = list(lyrv = seq_len(nlyr(r)), na.rm = TRUE),
                    Fa_sample = "lyrv",
                    Fa_alg = "sample", Fa_alg_args = list(replace=TRUE),
                    aleats = 4)
plot(ses)

</code></pre>


</div>