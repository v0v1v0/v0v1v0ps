<div class="container">

<table style="width: 100%;"><tr>
<td>log_normal_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defines a log normal model for peak height variability</h2>

<h3>Description</h3>

<p>Defines a log normal model for peak height variability
</p>


<h3>Usage</h3>

<pre><code class="language-R">log_normal_model(
  template,
  degradation = rep(0, length(template)),
  LSAE = stats::setNames(rep(1, length(model_settings$locus_names)),
    model_settings$locus_names),
  c2,
  k2,
  model_settings
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>Numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degradation</code></td>
<td>
<p>Numeric vector of same length as template. Degradation parameters for each contributor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LSAE</code></td>
<td>
<p>Numeric vector (named) with Locus Specific Amplification Efficiencies. See sample_LSAE. Defaults to 1 for each locus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>
<p>Numeric. Allele variance parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>
<p>Optionally a numeric vector with stutter variance parameters. See sample_log_normal_stutter_variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_settings</code></td>
<td>
<p>List. Possible parameters: </p>

<ul>
<li>
<p> locus_names. Character vector.
</p>
</li>
<li>
<p> degradation_parameter_cap. Numeric.
</p>
</li>
<li>
<p> c2_prior. Numeric of length two with shape and scale.
</p>
</li>
<li>
<p> LSAE_variance_prior. Numeric of length one.
</p>
</li>
<li>
<p> detection_threshold. Numeric vector (named) with Detection Thresholds. Defaults to 50 for each locus.
</p>
</li>
<li>
<p> size_regression. Function, see read_size_regression.
</p>
</li>
<li>
<p> stutter_model. Optionally a stutter_model object that gives expected stutter heights. See global_stutter_model.
</p>
</li>
<li>
<p> stutter_variability. Optionally peak height variability parameters for stutters. Required when stutter_model is supplied.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Define a log normal model for peak height variability with the parametrisation as described by Bright et al. The model may then be used to sample DNA profiles using the sample_mixture_from_genotypes function. Alternatively, to sample many models and profiles in one go with parameters according to a specified distribution, the sample_mixtures function can be used.
</p>


<h3>Value</h3>

<p>Object of class <code>pg_model</code>.
</p>


<h3>References</h3>

<p>Bright, J.A. et al. (2016). Developmental validation of STRmixâ„¢, expert software for the interpretation of forensic DNA profiles. Forensic Science International: Genetics, 23, 226-239. doi: <a href="https://doi.org/10.1016/j.fsigen.2016.05.007">10.1016/j.fsigen.2016.05.007</a>
</p>


<h3>See Also</h3>

<p>gamma_model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gf)
freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                           package = "simDNAmixtures"))

k2 &lt;- sample_log_normal_stutter_variance(gf$log_normal_settings$stutter_variability)

model &lt;- log_normal_model(template = 1e3, c2 = 15, k2 = k2,
                          model_settings = gf$log_normal_settings)
model
</code></pre>


</div>