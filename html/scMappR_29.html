<div class="container">

<table style="width: 100%;"><tr>
<td>tissue_scMappR_custom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gene List Visualization and Enrichment with Custom Signature Matrix</h2>

<h3>Description</h3>

<p>This function visualizes signature matrix, clusters subsetted genes, completes enrichment of individual cell-types and co-enrichment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tissue_scMappR_custom(
  gene_list,
  signature_matrix,
  output_directory = "custom_test",
  toSave = FALSE,
  path = NULL,
  gene_cutoff = 1,
  is_pvalue = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gene_list</code></td>
<td>
<p>A list of gene symbols matching that of the signature_matrix. Any gene symbol is acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signature_matrix</code></td>
<td>
<p>Pre-computed signature matrix with matching gene names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_directory</code></td>
<td>
<p>Directory made containing output of functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_cutoff</code></td>
<td>
<p>Value cut-off (generally rank := log10(Padj)) for a gene to be considered a marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_pvalue</code></td>
<td>
<p>If signature matrix is p-value before rank is applied (not recommended) (T/F).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is roughly the same as tissue_scMappR_internal, however now there is a custom signature matrix.
It generates a heatmap of the signature matrix and your inputted gene list, as well as single cell-type and 
co-celltype enrichment.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>background_heatmap</code></td>
<td>
<p>Data frame of the entire gene by cell-type signature matrix inputted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_list_heatmap</code></td>
<td>
<p>Data frame of inputted signature matrix subsetted by input genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single_celltype_preferences</code></td>
<td>
<p>Data frame of enriched cell-types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_celtype_preference</code></td>
<td>
<p>Data frame of groups of cell-types enriched by the same genes.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">


# load in signature matrices
data(POA_example)
POA_generes &lt;- POA_example$POA_generes
POA_OR_signature &lt;- POA_example$POA_OR_signature
POA_Rank_signature &lt;- POA_example$POA_Rank_signature
sig &lt;- get_gene_symbol(POA_Rank_signature)
Signature &lt;- POA_Rank_signature
rownames(Signature) &lt;- sig$rowname
genes &lt;- rownames(Signature)[1:60]
heatmap_test &lt;- tissue_scMappR_custom(gene_list =  genes, signature_matrix = Signature,
                                      output_directory =  "scMappR_test", toSave = FALSE)



</code></pre>


</div>