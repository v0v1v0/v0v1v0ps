<div class="container">

<table style="width: 100%;"><tr>
<td>SUNdistr-op</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Operations on SUNdistr-class objects</h2>

<h3>Description</h3>

<p>Given an object of <code>SUNdistr-class</code>, or possibly two such things
in some cases, the functions   perform various operations,
and produce a new object of the same class.</p>


<h3>Usage</h3>

<pre><code class="language-R">affineTransSUNdistr(object, a, A, name, compNames, HcompNames, drop = TRUE)
conditionalSUNdistr(object, comp, values, eventType = "=", name, drop = TRUE) 
convolutionSUNdistr(object1, object2, name, compNames, HcompNames) 
joinSUNdistr(object1, object2, name, compNames, HcompNames) 
marginalSUNdistr(object, comp, name, drop=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, object1, object2</code></td>
<td>
<p>objects of class <code>SUNdistr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a numeric vector; see ‘Details’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a numeric matrix; see ‘Details’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>an optional character string with the name of the returned
distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compNames</code></td>
<td>
<p>an optional vector of character strings with the names 
of the component variables of the returned distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HcompNames</code></td>
<td>
<p>an optional vector of character strings with the names 
of the hidden variables of the returned distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>a logical value (default: <code>TRUE</code>)  relevant only in the
case <code>m=1</code>. When both <code>m=1</code> and <code>drop=TRUE</code>, the 
returned object is of class either <code>SECdistrUv</code> or <code>SECdistrMv</code>,
depending on the dimension of the returned object, and family 
<code>"SN"</code> or <code>"ESN"</code>, as appropriate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>a vector of integers representing the selected components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>a numeric vector which identifies the conditioning event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eventType</code></td>
<td>
<p>a single character value which indicates the type of the
conditioning event, as described in the ‘Details’ section;
possible values are <code>"="</code> (default) and <code>"&gt;"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For  an <code>object</code> which represents the distribution of a multivariate 
<abbr><span class="acronym">SUN</span></abbr> random variable <code class="reqn">Y</code> of dimension <code>d</code>, say, a number of
operations are possible, producing a new object of the same class.
This <code>object</code> could have been created by <code>makeSUNdistr</code> 
or it could be the outcome from some previous call to one of the functions
described here.
</p>
<p>The function <code>affineTransSUNdistr</code> computes  the distribution of
<code class="reqn">a+A'Y</code>,  provided <code>A</code> is a full-rank matrix with
<code>nrow(A)=d</code> and <code>length(a)=ncol(A)</code>.
See equation (7.6) of Azzalini &amp; Capitanio (2014).
</p>
<p>The function <code>marginalSUNdistr</code>  builds a <abbr><span class="acronym">SUN</span></abbr> distribution 
from the components selected by the <code>comp</code> vector.
</p>
<p>A conditional distribution can be computed using <code>conditionalSUNdistr</code> 
for two type of events, selected by <code>eventType</code>. 
The <code>"="</code> case corresponds to the event <code class="reqn">Y_1=y_1</code> where 
<code class="reqn">Y_1</code> is the subset of components identified
by  the <code>comp</code> argument, <code class="reqn">y_1</code> is vector specified by the 
<code>values</code> argument and the equality sign must hold for each component.
See equation (7.6) of Azzalini &amp; Capitanio (2014).
</p>
<p>If <code>conditionalSUNdistr</code> is used with <code>eventType="&gt;"</code>,
the conditiong refers to the event <code class="reqn">Y_1&gt;y_1</code>, 
where the inequality must be interpreted components-wise;
see Arellano-Valle &amp; Azzalini (2021) for the underlying mathematical result.
If the conditional distribution is required for the reverse inequality 
condition, <code>"&lt;"</code> say, 
this is equivalent to consideration of the event <code class="reqn">-Y_1&gt;-y_1</code>. 
The corresponding distribution can be obtained in two steps: 
first a new variable is constructed reversing the sign of the required
components using <code>affineTransSUNdistr</code>;
then <code>conditionalSUNdistr</code> is applied to this new variable with
the <code>"&gt;"</code> condition and values <code class="reqn">-y_1</code>. 
More complex conditions, where the <code>"&lt;"</code> and <code>"&gt;"</code> signs 
are mixed for different component varables, can be handled similarly, 
by introducing a square matrix <code>A</code> for <code>affineTransSUNdistr</code> 
having an appropriate combination of <code>1</code>s' and <code>-1</code>'s on its main
diagonal, and 0's elsewhere, and  matching changes of sign to the components  
of <code class="reqn">y_1</code>.
</p>
<p>Functions <code>convolutionSUNdistr</code> and <code>joinSUNdistr</code> operate under 
the assumptions that <code>object1</code> and <code>object2</code> refer to independent 
variables. 
Specifically, <code>convolutionSUNdistr</code> computes the convolution of the
two objects (i.e. the distribution of the sum of two independent variables),
which must have the same dimension <code>d</code>. 
Function <code>joinSUNdistr</code> combines two objects into a joint distribution.
</p>
<p>If the arguments <code>name</code>, <code>compNames</code> and <code>HcompNames</code>
are missing, they are composed from the supplied arguments.
</p>


<h3>Value</h3>

<p>an object of <code>SUNdistr-class</code></p>


<h3>Note</h3>

<p>The present structure and user interface of this function, and of other ones 
related to the <abbr><span class="acronym">SUN</span></abbr> distribution, must be considered experimental, 
and they might possibly change in the future.</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Arellano-Valle, R. B. and Azzalini, A. (2021).
Some properties of the unified skew-normal distribution.
<em>Statistical Papers</em>, 
<a href="https://doi.org/10.1007/s00362-021-01235-2">doi:10.1007/s00362-021-01235-2</a>
and <a href="https://arxiv.org/abs/2011.06316">arXiv:2011.06316</a>  
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>


<h3>See Also</h3>

<p><code>SUNdistr-base</code>, <code>makeSUNdistr</code>,
<code>SUNdistr-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">xi &lt;- c(1, 0, -1)
Omega &lt;- matrix(c(2,1,1, 1,3,1, 1,1,4), 3, 3)
Delta &lt;- matrix(c(0.72,0.20, 0.51,0.42, 0.88, 0.94), 3, 2, byrow=TRUE)
Gamma &lt;- matrix(c(1, 0.8, 0.8, 1), 2, 2)
dp3 &lt;- list(xi=xi, Omega=Omega, Delta=Delta, tau=c(-0.5, 0), Gamma=Gamma)
sun3 &lt;- makeSUNdistr(dp=dp3, name="SUN3", compNames=c("x", "w", "z"))
#
a &lt;- c(1,-2)
A &lt;- matrix(1:6, 3, 2)
sun2at &lt;- affineTransSUNdistr(sun3, a, A, "SUN2at", compNames=c("at1", "at2"))
sun2m &lt;- marginalSUNdistr(sun3, comp=c(1,3), name="SUN2m")
sun1c &lt;- conditionalSUNdistr(sun3, comp=c(1,3), values=c(1.1, 0.8),
            eventType="&gt;", name="SUN1c", drop=FALSE)
#
Omega &lt;- matrix(c(5, 1, 1, 6), 2, 2)
Delta &lt;- matrix(c(0.30, 0.50, 0.50, 0.85), 2, 2, byrow=TRUE)
Gamma &lt;- matrix(c(1, 0.18, 0.18, 1), 2, 2)
tau &lt;- c(0.4, -0.8)
dp2 &lt;- list(x=c(1, 0), Omega=Omega, Delta=Delta, tau=tau, Gamma=Gamma)
sun2 &lt;-  makeSUNdistr(dp=dp2, name="SUN2", compNames=c("u", "v"))
#
sun2conv &lt;- convolutionSUNdistr(sun2, sun2m, name="SUN2sum")
sun5 &lt;- joinSUNdistr(sun3, sun2)
</code></pre>


</div>