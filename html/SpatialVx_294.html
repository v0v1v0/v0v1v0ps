<div class="container">

<table style="width: 100%;"><tr>
<td>warper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Image Warp
</h2>

<h3>Description</h3>

<p>Estimate an image warp
</p>


<h3>Usage</h3>

<pre><code class="language-R">warper(Im0, Im1, p0, init, s, imethod = "bicubic", lossfun = "Q", 
    lossfun.args = list(beta = 0, Cmat = NULL), grlossfun = "defaultQ", 
    lower, upper, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Im0, Im1</code></td>
<td>

<p>Numeric matrices giving the zero- and one-energy images.  The <code>Im1</code> image is ultimately warped into the <code>Im0</code> image.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>

<p>nc by 2 matrix giving the zero-energy control points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>nc by 2 matrix giving an initial estimate of the one-energy control points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>Two-column matrix giving the full set of locations.  Works best if these are integer-valued coordinate indices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imethod</code></td>
<td>

<p>character giving he interpolation method to use.  May be one of "round", "bilinear" or "bicubic".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lossfun</code></td>
<td>

<p>Function giving the loss function over which to optimize the warp.  Default is <code>Q</code>, see <code>args{Q}</code> to see the required arguments for this function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lossfun.args</code></td>
<td>

<p>A list giving optional arguments to <code>lossfun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grlossfun</code></td>
<td>

<p>(optional) function giving the gradient of the loss function given by <code>lossfun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>

<p>(optional) arguments to the <code>nlminb</code> function which is used to optimize the loss function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical, should progress information be printed to the screen?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Optional arguments to <code>nlminb</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A pair-of-thin-plate-splines image warp is estimated by optimizing a loss function using nlminb.  It can be very difficult to get a good estimate.  It is suggested, therefore, to obtain good initial estimates for the one-energy control points.  The function <code>iwarper</code> can be useful in this context.
</p>


<h3>Value</h3>

<p> A list object of class “warped” is returned with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Im0, Im1, Im1.def</code></td>
<td>
<p>Matrices giving the zero- and one-energy images and the deformed one-energy image, resp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0, p1</code></td>
<td>
<p>zero- and one-energy control points, resp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Estimated standard error of the mean difference between the zero-energy and deformed one-energy images.</p>
</td>
</tr>
</table>
<p>            "warped.locations" "init"            
</p>
<table>
<tr style="vertical-align: top;">
<td><code>s, imethod, lossfun, lossfun.args</code></td>
<td>
<p>Same as input arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The matrices defining the image warp, L, iL and B, where the last is the bending energy, and the first two are nc + 3 by nc + 3 matrices describing the control points and inverse control-point matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arguments</code></td>
<td>
<p>Any arguments passed via ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The output from nlminb.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc.time</code></td>
<td>
<p>The process time.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Dryden, I. L. and K. V. Mardia (1998) <em>Statistical Shape Analysis</em>.  Wiley, New York, NY, 347pp.
</p>


<h3>See Also</h3>

<p><code>iwarper</code>
</p>


</div>