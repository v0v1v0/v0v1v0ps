<div class="container">

<table style="width: 100%;"><tr>
<td>findintercorr_cat_nb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Ordinal - Negative Binomial Variables: Correlation Method 1</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_cat x k_nb</code> intermediate matrix of correlations for the k_cat ordinal (r &gt;=
2 categories) and k_nb Negative Binomial variables. It extends the method of Amatya &amp; Demirtas (2015, doi: <a href="http://doi.org/10.1080/00949655.2014.953534">10.1080/00949655.2014.953534</a>)
to ordinal - Negative Binomial pairs.  Here, the intermediate correlation between Z1 and Z2 (where Z1 is the standard normal variable
discretized to produce an ordinal variable Y1, and Z2 is the standard normal variable used to generate a Negative Binomial
variable via the inverse cdf method) is calculated by dividing the target correlation by a correction factor.  The
correction factor is the product of the upper Frechet-Hoeffding bound on the correlation between a Negative Binomial variable
and the normal variable used to generate it (see <code>chat_nb</code>) and a simulated GSC upper bound on
the correlation between an ordinal variable and the normal variable used to generate it (see Demirtas &amp; Hedeker, 2011,
doi: <a href="http://doi.org/10.1198/tast.2011.10090">10.1198/tast.2011.10090</a>).
The function is used in <code>findintercorr</code> and <code>rcorrvar</code>.
This function would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findintercorr_cat_nb(rho_cat_nb, marginal, size, prob, mu = NULL,
  nrand = 100000, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho_cat_nb</code></td>
<td>
<p>a <code>k_cat x k_nb</code> matrix of target correlations among ordinal and Negative Binomial variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>a list of length equal to <code>k_cat</code>; the i-th element is a vector of the cumulative
probabilities defining the marginal distribution of the i-th variable;
if the variable can take r values, the vector will contain r - 1 probabilities (the r-th is assumed to be 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector of size parameters for the Negative Binomial variables (see <code>NegBinomial</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of success probability parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of mean parameters (*Note: either <code>prob</code> or <code>mu</code> should be supplied for all Negative Binomial variables,
not a mixture; default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>the number of random numbers to generate in calculating the bound (default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used in random number generation (default = 1234)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>k_cat x k_nb</code> matrix whose rows represent the <code>k_cat</code> ordinal variables and columns represent the
<code>k_nb</code> Negative Binomial variables
</p>


<h3>References</h3>

<p>Please see references for <code>findintercorr_cat_pois</code>
</p>


<h3>See Also</h3>

<p><code>chat_nb</code>,
<code>findintercorr</code>, <code>rcorrvar</code>
</p>


</div>