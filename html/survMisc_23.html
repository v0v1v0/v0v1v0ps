<div class="container">

<table style="width: 100%;"><tr>
<td>cutp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<b>cut p</b>oint for a continuous variable in a
model fit with <code>coxph</code> or <code>survfit</code>.</h2>

<h3>Description</h3>

<p><b>cut p</b>oint for a continuous variable in a
model fit with <code>coxph</code> or <code>survfit</code>.
</p>
<p>Determine the optimal cut point for a continuous variable
in a <code>coxph</code> or <code>survfit</code> model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cutp(x, ...)

## S3 method for class 'coxph'
cutp(x, ..., defCont = 3)

## S3 method for class 'survfit'
cutp(x, ..., defCont = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>survfit</code> or <code>coxph</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (not implemented).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defCont</code></td>
<td>
<p><b>def</b>inition of a <b>cont</b>inuous variable.
<br>
If the variable has <code class="reqn">&gt;</code> <code>defCont</code> unique values, it
is treated as continuous and a cut point is determined.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a cut point <code class="reqn">\mu</code>, of a predictor <code class="reqn">K</code>,
the variable is split
into two groups, those <code class="reqn">\geq \mu</code> and
those <code class="reqn">&lt; \mu</code>.
<br>
The score (or log-rank) statistic, <code class="reqn">sc</code>,
is calculated for each unique element
<code class="reqn">k</code> in <code class="reqn">K</code> and uses
</p>

<ul>
<li> <p><code class="reqn">e_i^+</code> the number of events
</p>
</li>
<li> <p><code class="reqn">n_i^+</code> the number at risk
</p>
</li>
</ul>
<p>in those above the cut point, respectively.
<br>
The basic statistic is 
</p>
<p style="text-align: center;"><code class="reqn">sc_k = \sum_{i=1}^D ( e_i^+ - n_i^+ \frac{e_i}{n_i} )</code>
</p>

<p><br>
The sum is taken across times with observed events, to <code class="reqn">D</code>,
the largest of these.
<br>
It is normalized (standardized), in the case of censoring,
by finding <code class="reqn">\sigma^2</code> which is:
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2 = \frac{1}{D - 1}
                 \sum_i^D (1 - \sum_{j=1}^i \frac{1}{D+ 1 - j})^2</code>
</p>

<p>The test statistic is then
</p>
<p style="text-align: center;"><code class="reqn">Q = \frac{\max |sc_k|}{\sigma \sqrt{D-1}}</code>
</p>

<p>Under the null hypothesis that the chosen cut point
does <em>not</em> predict survival,
the distribution of <code class="reqn">Q</code> has a limiting distibution which
is the supremum of the
absolute value of a Brownian bridge:
</p>
<p style="text-align: center;"><code class="reqn">p = Pr(\sup Q \geq q) = 2 \sum_{i=1}^{\infty}
                             (-1)^{i + 1} \exp (-2 i^2 q^2)</code>
</p>



<h3>Value</h3>

<p>A <code>list</code> of <code>data.table</code>s.
<br>
There is one list element per continuous variable.
<br>
Each has a column with possible values of the cut point
(i.e. unique values of the variable), and the
additional columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The score (log-rank) test for a model with the variable 'cut'
into into those <code class="reqn">\geq</code> the cutpoint and those below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>The test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The <code class="reqn">p</code>-value.</p>
</td>
</tr>
</table>
<p>The tables are ordered by <code class="reqn">p</code>-value, lowest first.
</p>


<h3>References</h3>

<p>Contal C, O'Quigley J, 1999.
An application of changepoint methods in studying the
effect of age on survival in breast cancer.
<em>Computational Statistics &amp; Data Analysis</em> <b>30</b>(3):253â€“70.
<a href="https://doi.org/10.1016/S0167-9473%2898%2900096-6">doi:10.1016/S0167-9473(98)00096-6</a>
</p>
<p>Mandrekar JN, Mandrekar, SJ, Cha SS, 2003.
Cutpoint Determination Methods in Survival Analysis using SAS.
<em>Proceedings of the 28th SAS Users Group International Conference (SUGI)</em>. Paper 261-28.
<a href="https://support.sas.com/resources/papers/proceedings/proceedings/sugi28/261-28.pdf">SAS (free)</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Mandrekar et al. above
data("bmt", package="KMsurv")
b1 &lt;- bmt[bmt$group==1, ] # ALL patients
c1 &lt;- coxph(Surv(t2, d3) ~ z1, data=b1) # z1=age
c1 &lt;- cutp(c1)$z1
data.table::setorder(c1, "z1")
## [] below is used to print data.table to console
c1[]

## Not run: 
## compare to output from survival::coxph
matrix(
    unlist(
        lapply(26:30,
               function(i) c(i, summary(coxph(Surv(t2, d3) ~ z1 &gt;= i, data=b1))$sctest))),
    ncol=5,
    dimnames=list(c("age", "score_test", "df", "p")))
cutp(coxph(Surv(t2, d3) ~ z1, data=bmt[bmt$group==2, ]))$z1[]
cutp(coxph(Surv(t2, d3) ~ z1, data=bmt[bmt$group==3, ]))[[1]][]
## K&amp;M. Example 8.3, pg 273-274.
data("kidtran", package="KMsurv")
k1 &lt;- kidtran
## patients who are male and black
k2 &lt;- k1[k1$gender==1 &amp; k1$race==2, ]
c2 &lt;- coxph(Surv(time, delta) ~ age, data=k2)
print(cutp(c2))
## check significance of computed value
summary(coxph(Surv(time, delta) ~ age &gt;= 58, data=k2))
k3 &lt;- k1[k1$gender==2 &amp; k1$race==2, ]
c3 &lt;- coxph(Surv(time, delta) ~ age, data=k3)
print(cutp(c3))
## doesn't apply to binary variables e.g. gender
print(cutp(coxph(Surv(time, delta) ~ age + gender, data=k1)))

## End(Not run)

</code></pre>


</div>