<div class="container">

<table style="width: 100%;"><tr>
<td>superClass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create super-clusters from SOM results</h2>

<h3>Description</h3>

<p>Aggregate the resulting clustering of the SOM algorithm into 
super-clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">superClass(sommap, method, members, k, h, ...)

## S3 method for class 'somSC'
print(x, ...)

## S3 method for class 'somSC'
summary(object, ...)

## S3 method for class 'somSC'
plot(
  x,
  what = c("obs", "prototypes", "add"),
  type = c("dendrogram", "grid", "hitmap", "lines", "meanline", "barplot", "boxplot",
    "mds", "color", "poly.dist", "pie", "graph", "dendro3d", "projgraph"),
  plot.var = TRUE,
  show.names = TRUE,
  names = 1:prod(x$som$parameters$the.grid$dim),
  ...
)

## S3 method for class 'somSC'
projectIGraph(object, init.graph, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sommap</code></td>
<td>
<p>A <code>somRes</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Argument passed to the <code>hclust</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>members</code></td>
<td>
<p>Argument passed to the <code>hclust</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Argument passed to the <code>cutree</code> function (number of 
super-clusters to cut the dendrogram).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Argument passed to the <code>cutree</code> function (height where 
to cut the dendrogram).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Used for <code>plot.somSC</code>: further arguments passed either to
the function <code>plot</code> (case <code>type="dendro"</code>) or to 
<code>plot.myGrid</code> (case <code>type="grid"</code>) or to 
<code>plot.somRes</code> (all other cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>somSC</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>somSC</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>What you want to plot for superClass object. Either the 
observations (<code>obs</code>), the prototypes (<code>prototypes</code>) or an 
additional variable (<code>add</code>), or <code>NULL</code> if not appropriate. 
Automatically set for types "hitmap" (to <code>"obs"</code>), 'grid' 
(to <code>"prototypes"</code>), default to "obs" otherwise.
If <code>what='add'</code>, the function <code>plot.somRes</code> will be called with
the argument <code>what</code> set to <code>"add"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of plot to draw. Default value is <code>"dendrogram"</code>, 
to plot the dendrogram of the clustering. Case <code>"grid"</code> plots the grid 
in color according to the super clustering. Case <code>"projgraph"</code> uses an
igraph object passed to the argument <code>variable</code> and plots
the projected graph as defined by the function <code>projectIGraph.somSC</code>.
All other cases are those available in the function <code>plot.somRes</code> 
and surimpose the super-clusters over these plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.var</code></td>
<td>
<p>A boolean indicating whether a graph showing the evolution of
the explained variance should be plotted. This argument is only used when 
<code>type="dendrogram"</code>, its default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.names</code></td>
<td>
<p>Whether the cluster titles must be printed in center of
the grid or not for <code>type="grid"</code>. Default to <code>FALSE</code> (titles not 
displayed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>If <code>show.names = TRUE</code>, values of the title to 
display for <code>type="grid"</code>. Default to "Cluster " followed by the cluster
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.graph</code></td>
<td>
<p>An igraph object which is projected 
according to the super-clusters. The number of vertices of <code>init.graph</code> 
must be equal to the number of rows in the original dataset processed by the 
SOM (case <code>"korresp"</code> is not handled by this function). In the projected
graph, the vertices are positionned at the center of gravity of the 
super-clusters (more details in the section <strong>Details</strong> below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>superClass</code> function can be used in 2 ways: </p>

<ul>
<li>
<p> to choose the number of super clusters via an <code>hclust</code> 
object: then, both arguments <code>k</code> and <code>h</code> are not filled.
</p>
</li>
<li>
<p> to cut the clustering into super clusters: then, either argument 
<code>k</code> or argument <code>h</code> must be filled. See <code>cutree</code> for
details on these arguments.
</p>
</li>
</ul>
<p>The squared distance between prototypes is passed to the algorithm.
</p>
<p><code>summary</code> on a <code>superClass</code> object produces a complete summary of 
the results that displays the number of clusters and super-clusters, the 
clustering itself and performs ANOVA analyses. For <code>type="numeric"</code> the 
ANOVA is performed for each input variable and test the difference of this
variable across the super-clusters of the map. For <code>type="relational"</code> 
a dissimilarity ANOVA is performed (see (Anderson, 2001), except that in the 
present version, a crude estimate of the p-value is used which is based on 
the Fisher distribution and not on a permutation test.
</p>
<p>On plots, the different super classes are identified in the following ways:
</p>
 
<ul>
<li>
<p> either with different color, when <code>type</code> is set among: 
<code>"grid"</code> (N, K, R), <code>"hitmap"</code> (N, K, R), <code>"lines"</code> (N, K, R), 
<code>"barplot"</code> (N, K, R), <code>"boxplot"</code>, <code>"poly.dist"</code> (N, K, R), 
<code>"mds"</code> (N, K, R), <code>"dendro3d"</code> (N, K, R), <code>"graph"</code> (R),
<code>"projgraph"</code> (R)
</p>
</li>
<li>
<p> or with title, when <code>type</code> is set among: <code>"color"</code> (N, K),
<code>"pie"</code> (N, R)
</p>
</li>
</ul>
<p>In the list above, the charts available for a <code>numerical</code> SOM are marked
with a N, with a K for a <code>korresp</code> SOM and with a R for 
<code>relational</code> SOM.
</p>
<p><code>projectIGraph.somSC</code> produces a projected graph from the 
igraph object passed to the argument <code>variable</code> as 
described in (Olteanu and Villa-Vialaneix, 2015). The attributes of this 
graph are the same than the ones obtained from the SOM map itself in the 
function <code>projectIGraph.somRes</code>. <code>plot.somSC</code> used with 
<code>type="projgraph"</code> calculates this graph and represents it by 
positionning the super-vertexes at the center of gravity of the 
super-clusters. This feature can be combined with <code>pie.graph=TRUE</code> to 
super-impose the information from an external factor related to the 
individuals in the original dataset (or, equivalently, to the vertexes of the
graph).
</p>


<h3>Value</h3>

<p>The <code>superClass</code> function returns an object of class 
<code>somSC</code> which is a list of the following elements: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>The super clustering of the prototypes (only if either 
<code>k</code> or <code>h</code> are given by user).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An <code>hclust</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>som</code></td>
<td>
<p>The <code>somRes</code> object given as argument (see 
<code>trainSOM</code> for details).</p>
</td>
</tr>
</table>
<p>The <code>projectIGraph.somSC</code> function returns an object of class 
<code>igraph</code> with the following attributes: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p> provides the layout of the projected graph 
according to the center of gravity of the super-clusters positioned on 
the SOM grid (graph attribute);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>name</code> and <code>size</code>
</td>
<td>
<p> respectively are the vertex number on 
the grid and the number of vertexes included in the corresponding cluster 
(vertex attribute);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p> gives the number of edges (or the sum of the weights)
between the vertexes of the two corresponding clusters (edge attribute).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Élise Maigné <a href="mailto:elise.maigne@inrae.fr">elise.maigne@inrae.fr</a><br>
Madalina Olteanu <a href="mailto:olteanu@ceremade.dauphine.fr">olteanu@ceremade.dauphine.fr</a><br>
Nathalie Vialaneix <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Anderson M.J. (2001). A new method for non-parametric multivariate analysis 
of variance. <em>Austral Ecology</em>, <strong>26</strong>, 32-46.
</p>
<p>Olteanu M., Villa-Vialaneix N. (2015) Using SOMbrero for clustering and 
visualizing graphs. <em>Journal de la Societe Francaise de Statistique</em>, 
<strong>156</strong>, 95-119.
</p>


<h3>See Also</h3>

<p><code>hclust</code>, <code>cutree</code>, <code>trainSOM</code>, 
<code>plot.somRes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(11051729)
my.som &lt;- trainSOM(x.data = iris[,1:4])
# choose the number of super-clusters
sc &lt;- superClass(my.som)
plot(sc)
# cut the clustering
sc &lt;- superClass(my.som, k = 4)
summary(sc)
plot(sc)
plot(sc, type = "grid")
plot(sc, what = "obs", type = "hitmap")
</code></pre>


</div>