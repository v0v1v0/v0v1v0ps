<div class="container">

<table style="width: 100%;"><tr>
<td>BSDT_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Standardised Difference Test with Covariates</h2>

<h3>Description</h3>

<p>Takes two single observations from a case on two variables (A and B) and
compares their standardised discrepancy to the discrepancies of the variables
in a control sample, while controlling for the effects of covariates, using
Bayesian methodology. This test is used when assessing a case conditioned on
some other variable, for example, assessing abnormality of discrepancy when
controlling for years of education or sex. Under the null hypothesis the case
is an observation from the distribution of discrepancies between the tasks of
interest coming from observations having the same score as the case on the
covariate(s). Returns a significance test, point and interval estimates of
difference between the case and the mean of the controls as well as point and
interval estimates of abnormality, i.e. an estimation of the proportion of
controls that would exhibit a more extreme conditioned score. This test is
based on random number generation which means that results may vary between
runs. This is by design and the reason for not using <code>set.seed()</code> to
reproduce results inside the function is to emphasise the randomness of the
test. To get more accurate and stable results please increase the number of
iterations by increasing <code>iter</code> whenever feasible. Developed by
Crawford, Garthwaite and Ryan (2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BSDT_cov(
  case_tasks,
  case_covar,
  control_tasks,
  control_covar,
  alternative = c("two.sided", "greater", "less"),
  int_level = 0.95,
  calibrated = TRUE,
  iter = 10000,
  use_sumstats = FALSE,
  cor_mat = NULL,
  sample_size = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>case_tasks</code></td>
<td>
<p>A vector of length 2. The case scores from the two tasks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case_covar</code></td>
<td>
<p>A vector containing the case scores on all covariates
included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_tasks</code></td>
<td>
<p>A matrix or dataframe with 2 columns and n rows
containing the control scores for the two tasks. Or if <code>use_sumstats</code>
is set to <code>TRUE</code> a 2x2 matrix or dataframe
containing summary statistics where the first column represents the means
for each task and the second column represents the standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_covar</code></td>
<td>
<p>A matrix or dataframe containing the control scores on
the covariates included. Or if <code>use_sumstats</code>
is set to <code>TRUE</code> a matrix or dataframe containing summary
statistics where the first column represents the means for each covariate
and the second column represents the standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or
<code>"less"</code>. You can specify just the initial letter. Since the direction
of the expected effect depends on which task is set as A and which is set
as B, be very careful if changing this parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_level</code></td>
<td>
<p>The probability level on the Bayesian credible intervals, defaults to 95%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibrated</code></td>
<td>
<p>Whether or not to use the standard theory (Jeffreys) prior
distribution (if set to <code>FALSE</code>) or a calibrated prior examined by
Berger and Sun (2008). The sample estimation of the covariance matrix is based on
the sample size being n - 1 when the calibrated prior is used. See Crawford
et al. (2011) for further information. Calibrated prior is recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations to be performed. Greater number gives better
estimation but takes longer to calculate. Defaults to 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_sumstats</code></td>
<td>
<p>If set to <code>TRUE</code>, <code>control_tasks</code> and
<code>control_covar</code> are treated as matrices with summary statistics. Where
the first column represents the means for each variable and the second
column represents the standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_mat</code></td>
<td>
<p>A correlation matrix of all variables included. NOTE: the two
first variables should be the tasks of interest. Only needed if <code>use_sumstats</code>
is set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>An integer specifying the sample size of the controls.
Only needed if <code>use_sumstats</code>
is set to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses random generation of inverse wishart distributions from the
CholWishart package (Geoffrey Thompson, 2019).
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>

<table>
<tr>
<td style="text-align: left;"> <code>statistic</code>   </td>
<td style="text-align: left;"> the average z-value over
  <code>iter</code> number of iterations. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>parameter</code> </td>
<td style="text-align: left;"> the degrees
  of freedom used to specify the posterior distribution. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">
  <code>p.value</code>    </td>
<td style="text-align: left;"> the average p-value over <code>iter</code> number of
  iterations. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>estimate</code> </td>
<td style="text-align: left;"> case scores expressed as z-scores
  on task A and B. Standardised effect size (Z-DCCC) of task difference
  between case and controls and point estimate of the proportion of the
  control population estimated to show a more extreme task difference. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">
  <code>null.value</code>   </td>
<td style="text-align: left;"> the value of the difference between tasks under
  the null hypothesis.</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>interval</code> </td>
<td style="text-align: left;"> named numerical vector
  containing level of confidence and confidence intervals for both effect
  size and p-value.</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>desc</code>     </td>
<td style="text-align: left;"> data frame containing means
  and standard deviations for controls as well as case scores. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">
  <code>cor.mat</code> </td>
<td style="text-align: left;"> matrix giving the correlations between the tasks of
  interest and the covariates included. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>sample.size</code>     </td>
<td style="text-align: left;">
  number of controls. </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>alternative</code> </td>
<td style="text-align: left;"> a character string
  describing the alternative hypothesis.</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>method</code> </td>
<td style="text-align: left;"> a character
  string indicating what type of test was performed.</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"> <code>data.name</code>
  </td>
<td style="text-align: left;"> a character string giving the name(s) of the data</td>
</tr>
</table>
<h3>References</h3>

<p>Berger, J. O., &amp; Sun, D. (2008). Objective Priors for the Bivariate Normal
Model. <em>The Annals of Statistics, 36</em>(2), 963-982. JSTOR.
</p>
<p>Crawford, J. R., Garthwaite, P. H., &amp; Ryan, K. (2011). Comparing a single
case to a control sample: Testing for neuropsychological deficits and
dissociations in the presence of covariates. <em>Cortex, 47</em>(10),
1166-1178. <a href="https://doi.org/10.1016/j.cortex.2011.02.017">doi:10.1016/j.cortex.2011.02.017</a>
</p>
<p>#' Geoffrey Thompson (2019). CholWishart: Cholesky Decomposition of the Wishart
Distribution. R package version 1.1.0.
<a href="https://CRAN.R-project.org/package=CholWishart">https://CRAN.R-project.org/package=CholWishart</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">BSDT_cov(case_tasks = c(size_weight_illusion[1, "V_SWI"],
                        size_weight_illusion[1, "K_SWI"]),
         case_covar = size_weight_illusion[1, "YRS"],
         control_tasks = cbind(size_weight_illusion[-1, "V_SWI"],
                               size_weight_illusion[-1, "K_SWI"]),
         control_covar = size_weight_illusion[-1, "YRS"], iter = 100)

</code></pre>


</div>