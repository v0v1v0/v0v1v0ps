<div class="container">

<table style="width: 100%;"><tr>
<td>DBI_tables_create</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create RegLog-valid database tables with DBI</h2>

<h3>Description</h3>

<p>Create RegLog-valid database tables with DBI
</p>


<h3>Usage</h3>

<pre><code class="language-R">DBI_tables_create(
  conn,
  account_name = "account",
  reset_code_name = "reset_code",
  use_log = FALSE,
  log_name = "logs",
  user_data = NULL,
  hash_passwords = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conn</code></td>
<td>
<p>DBI connection object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>account_name</code></td>
<td>
<p>Name of the table for storing user accounts credentials.
Defaults to 'account'. Mandatory table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset_code_name</code></td>
<td>
<p>Name of the table for storing generated password reset
codes. Defaults to 'reset_code'. Mandatory table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_log</code></td>
<td>
<p>Should the table for keeping RegLogServer logs be
also created? Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_name</code></td>
<td>
<p>Name of the table for storing logs from RegLogServer object.
Used only if <code>use_log = TRUE</code>. Defaults to <code>logs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_data</code></td>
<td>
<p>If you wish to import existing user database, you can input
data.frame with that table in this argument. It should contain columns:
username, password, email. Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hash_passwords</code></td>
<td>
<p>If you are importing table of users upon tables creation,
you can also specify if the password should be hashed using <code>scrypt::hashPassword</code>.
Defaults to <code>FALSE</code>. If you have unhashed passwords in imported table, set
this option to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean specific if the actions made by function should be
printed back to the console. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently, the function is tested and working correctly for
SQLite, MySQL, MariaDB and PostrgreSQL databases. If you want to use another
DBI-supported database, you need to create tables in other ways.
</p>
<p>Created tables should have following structure:
</p>

<ul>
<li>
<p> account (default name)
</p>

<ul>
<li>
<p> id: integer, primary key, auto-increment
</p>
</li>
<li>
<p> username: varchar(255), NOT NULL, unique key
</p>
</li>
<li>
<p> password: varchar(255), NOT NULL
</p>
</li>
<li>
<p> email: varchar(255), NOT NULL, unique key
</p>
</li>
<li>
<p> create_time: datetime, NOT NULL
</p>
</li>
<li>
<p> update_time: datetime, NOT NULL
</p>
</li>
</ul>
</li>
<li>
<p> reset_code (default name)
</p>

<ul>
<li>
<p> id: integer, primary key, auto-increment
</p>
</li>
<li>
<p> user_id: integer, NOT NULL, key
</p>
</li>
<li>
<p> reset_code: varchar(10), NOT NULL
</p>
</li>
<li>
<p> used: tinyint, NOT NULL
</p>
</li>
<li>
<p> create_time: datetime, NOT NULL
</p>
</li>
<li>
<p> update_time: datetime, NOT NULL
</p>
</li>
</ul>
</li>
<li>
<p> logs (default name, optional)
</p>

<ul>
<li>
<p> id: integer, primary key, auto-increment
</p>
</li>
<li>
<p> time: datetime, NOT NULL
</p>
</li>
<li>
<p> session: varchar(255), NOT NULL
</p>
</li>
<li>
<p> direction: varchar(255), NOT NULL
</p>
</li>
<li>
<p> type: varchar(255), NOT NULL
</p>
</li>
<li>
<p> note: varchar(255)
</p>
</li>
</ul>
</li>
</ul>
<h3>Value</h3>

<p>List with results of the creation
</p>


<h3>See Also</h3>

<p>Other RegLog databases: 
<code>gsheet_tables_create()</code>,
<code>mongo_tables_create()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(shiny.reglog)

# create a tenporary SQLite database
conn &lt;- DBI::dbConnect(
  RSQLite::SQLite(),
  dbname = ":memory:"
)

# mockup user data
user_data &lt;- 
  data.frame(username = c("Whatever", "Hanuka", "Helsinki", "How_come"), 
             password = c("&amp;f5*MSYj^niDt=V'3.[dyEX.C/", "%}&amp;B[fs\\}5PKE@,*+V\\tx9\"at]", 
                    "35z*ofW\\'G_8,@vCC`]~?e$Jm%", "s:;r_eLn?-D6;oA-=\"^R(-Ew&lt;x"), 
             email = c("what@mil.com", "hehe@soso.so", "nider@what.no", "crazzz@simpsy.com"))

# create the tables and input the data (hashing the passwords in the process)
DBI_tables_create(conn = conn,
                  user_data = user_data,
                  hash_passwords = TRUE,
                  verbose = FALSE)

# check generater tables
DBI::dbListTables(conn = conn)

# check the "user" table for user data
DBI::dbReadTable(conn = conn,
                 "account")

# disconnect
DBI::dbDisconnect(conn = conn)
</code></pre>


</div>