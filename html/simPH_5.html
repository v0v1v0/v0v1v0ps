<div class="container">

<table style="width: 100%;"><tr>
<td>coxsimPoly</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate quantities of interest for a range of values for a polynomial
nonlinear effect from Cox Proportional Hazards models</h2>

<h3>Description</h3>

<p><code>coxsimPoly</code> simulates quantities of interest for polynomial covariate
effects estimated from Cox Proportional Hazards models. These can be plotted
with <code>simGG</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxsimPoly(
  obj,
  b = NULL,
  qi = "Relative Hazard",
  pow = 2,
  Xj = NULL,
  Xl = NULL,
  nsim = 1000,
  ci = 0.95,
  spin = FALSE,
  extremesDrop = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a <code>coxph</code> class fitted model object with a polynomial
coefficient. These can be plotted with <code>simGG</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>character string name of the coefficient you would like to simulate.
To find the quantity of interest using only the polynomial and not the
polynomial + the linear terms enter the polynomial created using
<code>I</code>, e.g. <code>I(natreg^2)</code> as a string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qi</code></td>
<td>
<p>quantity of interest to simulate. Values can be
<code>"Relative Hazard"</code>, <code>"First Difference"</code>, <code>"Hazard Ratio"</code>,
and <code>"Hazard Rate"</code>. The default is <code>qi = "Relative Hazard"</code>. If
<code>qi = "Hazard Rate"</code> and the <code>coxph</code> model has strata, then hazard
rates for each strata will also be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>numeric polynomial used in <code>coxph</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xj</code></td>
<td>
<p>numeric vector of fitted values for <code>b</code> to simulate for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xl</code></td>
<td>
<p>numeric vector of values to compare <code>Xj</code> to. If <code>NULL</code>,
then it is automatically set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulations to run per value of <code>Xj</code>. Default
is <code>nsim = 1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>the proportion of simulations to keep. The default is
<code>ci = 0.95</code>, i.e. keep the middle 95 percent. If <code>spin = TRUE</code>
then <code>ci</code> is the confidence level of the shortest probability interval.
Any value from 0 through 1 may be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spin</code></td>
<td>
<p>logical, whether or not to keep only the shortest probability
interval rather than the middle simulations. Currently not supported for
hazard rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extremesDrop</code></td>
<td>
<p>logical whether or not to drop simulated quantity of
interest values that are <code>Inf</code>, <code>NA</code>, <code>NaN</code> and
<code class="reqn">&gt; 1000000</code> for <code>spin = FALSE</code> or <code class="reqn">&gt; 800</code> for <code>spin = TRUE</code>.
These values are difficult to plot <code>simGG</code> and may prevent
<code>spin</code> from finding the central interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulates quantities of interest for polynomial covariate effects.
For example if a nonlinear effect is modeled with a second order
polynomial–i.e. <code class="reqn">\beta_{1}x_{i} + \beta_{2}x_{i}^{2}</code>–we can draw <code class="reqn">n</code> simulations from the
multivariate normal distribution for both <code class="reqn">\beta_{1}</code> and
<code class="reqn">\beta_{2}</code>. Then we simply calculate quantities of interest
for a range of values and plot the results as before. For example, we find
the first difference for a second order polynomial with:
</p>
<p style="text-align: center;"><code class="reqn">\%\triangle h_{i}(t) = (\mathrm{e}^{\beta_{1}x_{j-1} +
\beta_{2}x_{j-l}^{2}} - 1) * 100</code>
</p>

<p>where <code class="reqn">x_{j-l} = x_{j} - x_{l}</code>.
</p>
<p>Note, you must use <code>I</code> to create the polynomials.
</p>


<h3>Value</h3>

<p>a <code>simpoly</code>, <code>coxsim</code> object
</p>


<h3>References</h3>

<p>Gandrud, Christopher. 2015. simPH: An R Package for Illustrating
Estimates from Cox Proportional Hazard Models Including for Interactive and
Nonlinear Effects. Journal of Statistical Software. 65(3)1-20.
</p>
<p>Keele, Luke. 2010. ”Proportionally Difficult: Testing for
Nonproportional Hazards in Cox Models.” Political Analysis 18(2): 189-205.
</p>
<p>Carpenter, Daniel P. 2002. ”Groups, the Media, Agency Waiting Costs, and
FDA Drug Approval.” American Journal of Political Science 46(3): 490-505.
</p>
<p>King, Gary, Michael Tomz, and Jason Wittenberg. 2000. ”Making the Most of
Statistical Analyses: Improving Interpretation and Presentation.” American
Journal of Political Science 44(2): 347-61.
</p>
<p>Liu, Ying, Andrew Gelman, and Tian Zheng. 2013. ”Simulation-Efficient
Shortest Probability Intervals.” Arvix.
<a href="https://arxiv.org/pdf/1302.2142v1.pdf">https://arxiv.org/pdf/1302.2142v1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code>simGG.simpoly</code>, <code>survival</code>,
<code>strata</code>, and <code>coxph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Carpenter (2002) data
data("CarpenterFdaData")

# Load survival package
library(survival)

# Run basic model
M1 &lt;- coxph(Surv(acttime, censor) ~ prevgenx + lethal + deathrt1 +
            acutediz + hosp01  + hhosleng + mandiz01 + femdiz01 +
            peddiz01 + orphdum + natreg + I(natreg^2) +
            I(natreg^3) + vandavg3 + wpnoavg3 +
            condavg3 + orderent + stafcder, data = CarpenterFdaData)

# Simulate simpoly First Difference
Sim1 &lt;- coxsimPoly(M1, b = "natreg", qi = "First Difference",
                pow = 3, Xj = seq(1, 150, by = 5), nsim = 100)

## Not run: 
# Simulate simpoly Hazard Ratio with spin probibility interval
Sim2 &lt;- coxsimPoly(M1, b = "natreg", qi = "Hazard Ratio",
              pow = 3, Xj = seq(1, 150, by = 5), spin = TRUE)

## End(Not run)

</code></pre>


</div>