<div class="container">

<table style="width: 100%;"><tr>
<td>spatial.occupancy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a spatial occupancy model using Gibbs sampling</h2>

<h3>Description</h3>

<p>This function fits a spatial occupancy model where the true occupancy is a
function of a spatial process.  An efficient Gibbs sampling algorithm is
used by formulating the detection and occupancy process models with a probit
model instead of the traditional logit based model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spatial.occupancy(
  detection.model,
  occupancy.model,
  spatial.model,
  so.data,
  prior,
  control,
  initial.values = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>detection.model</code></td>
<td>
<p>A formula object describing the detection portion of
the occupancy model. The variables described by the detection model are
located in the <code>visit</code> data frame of the <code>so.data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occupancy.model</code></td>
<td>
<p>A formula object describing the fixed effects portion
of the spatial occupancy process. The variables described by the occupancy
model are located in the <code>site</code> data frame of an <code>so.data</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial.model</code></td>
<td>
<p>A named list object describing the spatial component of
the occupancy process. Currently the only possible models are ICAR, restricted spatial regression,
process convolution models, and no spatial model (i.e., eta = 0). Thus, <code>spatial.model=list(model="icar",
threshold= )</code>, <code>spatial.model=list(model="rsr", threshold=, moran.cut=)</code>, 
<code>spatial.model=list(model="proc.conv", knots=)</code>, and <code>spatial.model=list(model="none")</code>
are the only forms that are accepted at present.  The <code>threshold</code>
component is used the create neighborhoods in the ICAR and RSR models.  All sites
within distance <code>threshold</code> of site i are considered neighbors of site
i.  The <code>moran.cut</code> component is the cut-off for selecting 
the spatial harmonics used in the restricted spatial regression model. The value must be between 1 and N and implies that
the eigen vectors associated with the largest <code>moan.cut</code> eigen values are used for the basis functions.
The item <code>knots</code> are xy locations of the discrete process
convolution knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so.data</code></td>
<td>
<p>An <code>so.data</code> object containing the observed occupancies,
detection covariates, site covariates, and site coordinates. This is created
via the <code>make.so.data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A named list that provides the parameter values for the prior
distributions. At the current time the elements of the list must contain
<code>a.tau</code> and <code>b.tau</code> which are the parameters for the gamma prior on the spatial
process parameter in the occupancy model. Other elements may include
<code>Q.b</code> and <code>mu.b</code> which are the tolerance and mean for the beta
vector (detection parameters). Also <code>Q.g</code> and <code>mu.g</code> which are the
prior parameters for the occupancy model. If the Q.b and Q.g are left out,
the default is Q.b = 0 and Q.g = 0 (i.e., flat priors). If mu.b and mu.g are left out,
the default is zero vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A named list with the control parameters for the MCMC. The
elements of the list must include: (1) <code>burnin</code> is the number of
iterations of burnin, (2) <code>iter</code> is the total number of iterations
retained for the MCMC sample, and (3) <code>thin</code> is the thining rate of the
chain. The real number of MCMC iterations is equal to <code>iter*thin</code> of
which <code>iter - burnin</code> are retained for posterior summary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.values</code></td>
<td>
<p>A named list that can include any or all of the following vectors or scalers 
(1) <code>beta</code>, a vector of initial values for the detection parameters, (2) <code>gamma</code>, a vector or
initial values for the occupancy model, and (3) <code>tau</code>, an initial value for the spatial precision 
parameter.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A Gibbs sampler is run to draw an MCMC sample of the spatial occupancy
parameters <code>beta</code> (detection parameters), <code>gamma</code> (the occupancy
parameters), <code>psi</code> (the model occupancy generating process), and the
realized occupancy.
</p>


<h3>Value</h3>

<p>A list with the following elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>An object of class
<code>mcmc</code>. The detection model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The occupancy model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The occupancy generating process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>real.occ</code></td>
<td>
<p>An
object of class <code>mcmc</code>. The realized occupancy at the time of the
survey</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>An object of
class <code>mcmc</code>. The variance parameter for the spatial model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occupancy.df</code></td>
<td>
<p>A data frame with the spatial
coordinates, site id, and posterior mean and variance of psi, eta, and real.occ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.m</code></td>
<td>
<p>The posterior predictive loss criterion of Gelfand and Ghosh
(1998; Biometrika 85:1-11) for model selection. The criterion is a combination of a goodness-of-fit measure, G.m, and 
a complexity measure, P.m, similar information criteria such as AIC and BIC. D.m = G.m + P.m. Lower values of D.m imply lower 
expected loss in predicting new data with the posterior model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G.m</code></td>
<td>
<p>The
goodness-of-fit portion of D.m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.m</code></td>
<td>
<p>The model complexity component of
D.m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detection.model</code></td>
<td>
<p>The detection model call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occupancy.model</code></td>
<td>
<p>The occupancy model call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character
version of the joint occupancy and detection model call. This is useful for
saving results.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Devin S. Johnson &lt;devin.johnson@noaa.gov&gt;
</p>


</div>