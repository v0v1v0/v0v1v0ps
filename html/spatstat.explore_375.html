<div class="container">

<table style="width: 100%;"><tr>
<td>methods.rhohat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Methods for Intensity Functions of Spatial Covariate
</h2>

<h3>Description</h3>

<p>These are methods for the class <code>"rhohat"</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rhohat'
print(x, ...)

## S3 method for class 'rhohat'
plot(x, ..., do.rug=TRUE)

## S3 method for class 'rhohat'
predict(object, ..., relative=FALSE,
             what=c("rho", "lo", "hi", "se"))

## S3 method for class 'rhohat'
simulate(object, nsim=1, ..., drop=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,object</code></td>
<td>

<p>An object of class <code>"rhohat"</code> representing 
a smoothed estimate of the intensity function of a point process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to other methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.rug</code></td>
<td>

<p>Logical value indicating whether to plot the observed values of
the covariate as a rug plot along the horizontal axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>

<p>Logical value indicating whether to compute the
estimated point process intensity (<code>relative=FALSE</code>)
or the relative risk (<code>relative=TRUE</code>) in the case
of a relative risk estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations to be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>

<p>Logical value indicating what to do when <code>nsim=1</code>.
If <code>drop=TRUE</code> (the default), a point pattern is returned.
If <code>drop=FALSE</code>, a list of length 1 containing a point pattern
is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>

<p>Optional character string (partially matched) specifying which
value should be calculated: either the function estimate (<code>what="rho"</code>,
the default), the lower or upper end of the confidence interval
(<code>what="lo"</code> or <code>what="hi"</code>) or the standard error
(<code>what="se"</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are methods for the generic commands
<code>print</code>,
<code>plot</code>,
<code>predict</code> and
<code>simulate</code>
for the class <code>"rhohat"</code>.
</p>
<p>An object of class <code>"rhohat"</code> is an estimate
of the intensity of a point process, as a function of a
given spatial covariate. See <code>rhohat</code>.
</p>
<p>The method <code>plot.rhohat</code> displays the estimated function
<code class="reqn">\rho</code> using <code>plot.fv</code>, and optionally
adds a <code>rug</code> plot of the observed values of the covariate.
</p>
<p>The method <code>predict.rhohat</code> computes a pixel image of the
intensity <code class="reqn">\rho(Z(u))</code> at each spatial location
<code class="reqn">u</code>, where <code class="reqn">Z</code> is the spatial covariate.
</p>
<p>The method <code>simulate.rhohat</code> invokes <code>predict.rhohat</code>
to determine the predicted intensity, and then simulates a
Poisson point process with this intensity.
</p>


<h3>Value</h3>

<p>For <code>predict.rhohat</code> the value is a pixel image
(object of class <code>"im"</code> or <code>"linim"</code>).
For <code>simulate.rhohat</code> the value is a point pattern
(object of class <code>"ppp"</code> or <code>"lpp"</code>).
For other functions, the value is <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>See Also</h3>

<p><code>rhohat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  X &lt;-  rpoispp(function(x,y){exp(3+3*x)})
  rho &lt;- rhohat(X, function(x,y){x})
  rho
  plot(rho)
  Y &lt;- predict(rho)
  plot(Y)
  plot(simulate(rho), add=TRUE)
  #
  if(require("spatstat.model")) {
    fit &lt;- ppm(X, ~x)
    rho &lt;- rhohat(fit, "y")
    opa &lt;- par(mfrow=c(1,2))
    plot(predict(rho))
    plot(predict(rho, relative=TRUE))
    par(opa)
    plot(predict(rho, what="se"))
  }
</code></pre>


</div>