<div class="container">

<table style="width: 100%;"><tr>
<td>twinSIR_intensityplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting Paths of Infection Intensities for <code>twinSIR</code> Models
</h2>

<h3>Description</h3>

<p><code>intensityplot</code> methods to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time.
The default <code>plot</code> method for objects of class <code>"twinSIR"</code>
is just a wrapper for the <code>intensityplot</code> method.
The implementation is illustrated in Meyer et al. (2017, Section 4),
see <code>vignette("twinSIR")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'twinSIR'
plot(x, which = c("epidemic proportion", "endemic proportion",
     "total intensity"), ...)

## S3 method for class 'twinSIR'
intensityplot(x, which = c("epidemic proportion", "endemic proportion",
              "total intensity"), aggregate = TRUE, theta = NULL,
              plot = TRUE, add = FALSE, rug.opts = list(), ...)

## S3 method for class 'simEpidata'
intensityplot(x, which = c("epidemic proportion", "endemic proportion",
              "total intensity"), aggregate = TRUE, theta = NULL,
              plot = TRUE, add = FALSE, rug.opts = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>"twinSIR"</code> (fitted model) or
<code>"simEpidata"</code> (simulated <code>twinSIR</code> epidemic),
respectively. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p><code>"epidemic proportion"</code>, <code>"endemic proportion"</code>,
or <code>"total intensity"</code>.  Partial matching is applied.  Determines
whether to plot the path of the total intensity <code class="reqn">\lambda(t)</code> or its 
epidemic or endemic proportions
<code class="reqn">\frac{e(t)}{\lambda(t)}</code> or
<code class="reqn">\frac{h(t)}{\lambda(t)}</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate</code></td>
<td>

<p>logical. Determines whether lines for all individual infection
intensities should be drawn (<code>FALSE</code>) or their sum only
(<code>TRUE</code>, the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>numeric vector of model coefficients.  If <code>x</code> is of class
<code>"twinSIR"</code>, then <code>theta = c(alpha, beta)</code>, where <code>beta</code>
consists of the coefficients of the piecewise constant log-baseline function
and the coefficients of the endemic (<code>cox</code>) predictor.  If <code>x</code> is
of class <code>"simEpidata"</code>, then <code>theta = c(alpha, 1, betarest)</code>, 
where 1 refers to the (true) log-baseline used in the simulation and 
<code>betarest</code> is the vector of the remaining coefficients of the endemic 
(<code>cox</code>) predictor.
The default (<code>NULL</code>) means that the fitted or true parameters,
respectively, will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>logical indicating if a plot is desired, defaults to <code>TRUE</code>.
Otherwise, only the data of the plot will be returned.  Especially with
<code>aggregate = FALSE</code> and many individuals one might e.g. consider to 
plot a subset of the individual intensity paths only or do some further
calculations/analysis of the infection intensities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical.  If <code>TRUE</code>, paths are added to the current plot, using
<code>lines</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug.opts</code></td>
<td>

<p>either a list of arguments passed to the function <code>rug</code>, or
<code>NULL</code> (or <code>NA</code>), in which case no <code>rug</code> will be plotted.
By default, the argument <code>ticksize</code> is set to 0.02 and <code>quiet</code>
is set to <code>TRUE</code>.  Note that the argument <code>x</code> of the
<code>rug()</code> function, which contains the
locations for the <code>rug</code> is fixed internally and can not be modified.
The locations of the rug are the time points of infections.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For the <code>plot.twinSIR</code> method, arguments passed to
<code>intensityplot.twinSIR</code>.
For the <code>intensityplot</code> methods, further graphical parameters
passed to the function <code>matplot</code>, 
e.g. <code>lty</code>, <code>lwd</code>, <code>col</code>, <code>xlab</code>, <code>ylab</code> and
<code>main</code>.  Note that the <code>matplot</code> arguments <code>x</code>, <code>y</code>,
<code>type</code> and <code>add</code> are implicit and can not be specified here.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric matrix with the first column <code>"stop"</code> and as many rows as there
are <code>"stop"</code> time points in the event history <code>x</code>.  The other 
columns depend on the argument <code>aggregate</code>: if <code>TRUE</code>, there 
is only one other column named <code>which</code>, which contains the values of 
<code>which</code> at the respective <code>"stop"</code> time points.  Otherwise, if
<code>aggregate = FALSE</code>, there is one column for each individual, each of
them containing the individual <code>which</code> at the respective <code>"stop"</code>
time points.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>References</h3>

<p>Meyer, S., Held, L. and HÃ¶hle, M. (2017):
Spatio-temporal analysis of epidemic phenomena using the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package
<span class="pkg">surveillance</span>.
<em>Journal of Statistical Software</em>, <b>77</b> (11), 1-55.
<a href="https://doi.org/10.18637/jss.v077.i11">doi:10.18637/jss.v077.i11</a>
</p>


<h3>See Also</h3>

<p><code>twinSIR</code> for a description of the intensity model, and
<code>simulate.twinSIR</code> for the simulation of epidemic data
according to a <code>twinSIR</code> specification.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hagelloch")
plot(hagelloch)

# a simplistic twinSIR model
fit &lt;- twinSIR(~ household, data = hagelloch)

# overall total intensity
plot(fit, which = "total")

# overall epidemic proportion
epi &lt;- plot(fit, which = "epidemic", ylim = c(0, 1))
head(epi)
# add overall endemic proportion = 1 - epidemic proportion
ende &lt;- plot(fit, which = "endemic", add = TRUE, col = 2)
legend("topleft", legend = "endemic proportion", lty = 1, col = 2, bty = "n")

# individual intensities
tmp &lt;- plot(fit, which = "total", aggregate = FALSE,
    col = rgb(0, 0, 0, alpha = 0.1),
    main = expression("Individual infection intensities " *
        lambda[i](t) == Y[i](t) %.% (e[i](t) + h[i](t))))
# return value: matrix of individual intensity paths
str(tmp)

# plot intensity path only for individuals 3 and 99
matplot(x = tmp[,1], y = tmp[,1+c(3,99)], type = "S",
        ylab = "Force of infection", xlab = "time",
        main = expression("Paths of the infection intensities " *
                          lambda[3](t) * " and " * lambda[99](t)))
legend("topright", legend = paste("Individual", c(3,99)),
       col = 1:2, lty = 1:2)
</code></pre>


</div>