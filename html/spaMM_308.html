<div class="container">

<table style="width: 100%;"><tr>
<td>fixed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fixing some parameters</h2>

<h3>Description</h3>

<p>The fitting functions allow all parameters to be fixed rather than estimated:<br> 
* Fixed-effect coefficients can be set by way of the <code>etaFix</code> argument (linear predictor coefficients) for all fitting functions.<br> 
* Random-effect parameters and the <code>phi</code> parameter of the gaussian and Gamma response families can be set for all fitting function by the <code>fixed</code> argument, or for some fitting functions by an alternative argument with the same effect (see Details for this confusing feature, but using <code>fixed</code> uniformly is simpler).<br>
* The ad-hoc dispersion parameter of some response families (<code>COMPoisson</code>, <code>negbin1</code>, <code>negbin2</code>, <code>beta_resp</code>, <code>betabin</code> and possibly future ones) can be fixed using the ad-hoc argument of such families rather than by <code>fixed</code>.
</p>


<h3>Details</h3>

<p><b>etaFix</b> is a list with single documented element <code>beta</code>, which should be a vector of (a subset of) the coefficients (<code class="reqn">\beta</code>) of the fixed effects, with names as shown in a fit without such given values. If REML is used to fit random effect parameters, then <code>etaFix</code> affects by default the REML correction for estimation of dispersion parameters, which depends only on which <code class="reqn">\beta</code> coefficients are estimated rather than given. This default behaviour will be overridden whenever a non-null <code>REMLformula</code> is provided to the fitting functions (see Example). Alternatively, with a non-NULL <code>etaFix$beta</code>, REML can also be performed as if all <code class="reqn">\beta</code> coefficients were estimated, by adding attribute <code>keepInREML=TRUE</code> to <code>etaFix$beta</code>; in that case the REML computation is by default that implied by the fixed effects in the full model formula, unless a non-default <code>REMLformula</code> is also used.  
</p>
<p>The older equivalent for the <code>fixed</code> argument is <code>ranFix</code> for <code>HLfit</code> and <code>corrHLfit</code>, and <code>ranPars</code> for <code>HLCor</code>. Do not use both one such argument and <code>fixed</code> in a call. This older diversity of names was confusing, but its logic was that <code>ranFix</code> allows one to fix parameters that <code>HLfit</code> and <code>corrHLfit</code> would otherwise estimate, while <code>ranPars</code> can be used to set correlation parameters that <code>HLCor</code> does not estimate but nevertheless requires (e.g., Matérn parameters).
</p>
<p>Theses arguments for fixing random-effect parameters all have a common syntax. They is a list, with the following possible elements, whose nature is further detailed below:<br> 
* <b>phi</b> (variance of residual error, for gaussian and Gamma HGLMs),<br>
* <b>lambda</b> (random-effect variances, except for random-coefficient terms), <br>
* <b>ranCoefs</b> (random-coefficient parameters),<br> 
* <b>corrPars</b> (correlation parameters, when handled by the fitting function).<br> 
* Individual correlation parameters such as <b>rho, nu, Nugget, ARphi</b>... are also possible top-level elements of the list when there is no ambiguity as to which random effect these correlation parameters apply. This syntax was conceived when <code>spaMM</code> handled a single spatial random effect, and it is still convenient when applicable, but it should not be mixed with <code>corrPars</code> element usage. 
</p>
<p><b>phi</b> may be a single value or a vector of the same length as the response vector (the number of rows in the <code>data</code>, once non-informative rows are removed).
</p>
<p><b>lambda</b> may be a single value (if there is a single random effect, or a vector allowing to specify unambiguously variance  values for some random effect(s). It can thus take the form <code>lambda=c(NA,1)</code> or <code>lambda=c("2"=1)</code> (note the name) to assign a value only to the variance of the second of two random effects.
</p>
<p><b>ranCoefs</b> is a <code>list</code> of numeric vectors, each numeric vector specifying the variance and correlation parameters for a random-coefficient term. As for <code>lambda</code>, it may be incomplete, using names to specify the random effect to which the parameters apply. For example, to assign variances values 3 and 7, and correlation value -0.05, to the second random effect in a model formula, one can use <code>ranCoefs=list("2"=c(3,-0.05,7))</code> (note the name). The elements of each vector are variances and correlations, matching those of the printed summary of a fit. The order of these elements must be the order of the <code>lower.tri</code> of a covariance matrix, as shown e.g. by<br><code>m2 &lt;- matrix(NA, ncol=2,nrow=2); m2[lower.tri(m2,diag=TRUE)] &lt;- seq(3); m2</code>.<br><code>fitme</code> accepts partially fixed parameters for a random coefficient term, e.g.,<br><code>ranCoefs=list("2"=c(NA,-0.05,NA))</code>, although this may not mix well with some obscure options, such as<br><code>control=list(refit=list(ranCoefs=TRUE))</code> which will ignore the fixed values. 
<code>GxE</code> shows how to use partially-fixed <code>ranCoefs</code> to fit different variances for different levels of a factor.   
</p>
<p><b>corrPars</b> is a list, and it may also be incomplete, using names to specify the affected random effect as shown for <code>lambda</code> and <code>ranCoefs</code>. For example, <code>ranFix=list(corrPars=list("1"=list(nu=0.5)))</code> makes explicit that <code>nu=0.5</code> applies to the first (<code>"1"</code>) random effect in the model formula. Its elements may be the correlation parameters of the given random effect. For the Matérn model, these are the correlation parameters <code>rho</code> (scale parameter(s)), <code>nu</code> (smoothness parameter), and (optionally) <code>Nugget</code> (see <code>Matern</code>). The <code>rho</code> parameter can itself be a vector with different values for different geographic coordinates. 
For the <code>adjacency</code> model, the only correlation parameter is a scalar <code>rho</code> (see <code>adjacency</code>).
For the <code>AR1</code> model, the only correlation parameter is a scalar <code>ARphi</code> (see <code>AR1</code>).
Consult the documentation for other types of random effects, such as <code>Cauchy</code> or <code>IMRF</code>, for any information missing here. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("wafers")
# Fixing random-coefficient parameters:
fitme(y~X1+(X2|batch), data=wafers, fixed=list(ranCoefs=list("1"=c(2760, -0.1, 1844))))
##  HLfit syntax for the same effect (except that REML is used here)
# HLfit(y~X1+(X2|batch), data=wafers, ranFix=list(ranCoefs=list("1"=c(2760, -0.1, 1844))))


### Fixing coefficients of the linear predictor:
#
## ML fit
#
fitme(y ~X1+X2+X1*X3+X2*X3+I(X2^2)+(1|batch), data=wafers, family=Gamma(log), 
      etaFix=list(beta=c("(Intercept)"=5.61208)))
#      
## REML fit
# Evaluation of restricted likelihood depends on which fixed effects are estimated,
# so simply fixing the coefficients to their REML estimates will not yield 
# the same REML fits, as see by comparing the next two fits:
#
unconstr &lt;- fitme(y ~X1+X2+X1*X3+X2*X3+I(X2^2)+(1|batch), data=wafers, 
                  family=Gamma(log), method="REML")
#  
# Second fit is different from 'unconstr' despite the same fixed-effects:     
naive &lt;- fitme(y ~X1+X2+X1*X3+X2*X3+I(X2^2)+(1|batch), data=wafers, family=Gamma(log), 
               method="REML", etaFix=list(beta=fixef(unconstr)))    
#
# Using REMLformula to obtain the same REML fit as the unconstrained one:
fitme(y ~X1+X2+X1*X3+X2*X3+I(X2^2)+(1|batch), data=wafers, family=Gamma(log), 
      method="REML", etaFix=list(beta=fixef(unconstr)),
      REMLformula=y ~X1+X2+X1*X3+X2*X3+I(X2^2)+(1|batch))

data("Loaloa")
# Fixing some Matern correlation parameters, in fitme():
fitme(cbind(npos,ntot-npos) ~ elev1 +Matern(1|longitude+latitude),
             data=Loaloa,family=binomial(),fixed=list(nu=0.5,Nugget=2/7))
# Fixing all mandatory Matern correlation parameters, in HLCor():
HLCor(cbind(npos,ntot-npos) ~ elev1 + Matern(1|longitude+latitude),
             data=Loaloa,family=binomial(),ranPars=list(nu=0.5,rho=0.7))

## End(Not run)
</code></pre>


</div>