<div class="container">

<table style="width: 100%;"><tr>
<td>select.model2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit and Select Point Pattern Models Based on Minimum Contrast and AIC
</h2>

<h3>Description</h3>

<p>Fits Poisson, Poisson cluster, several inhomogeneous Poisson and several inhomogeneous Poisson cluster  processes to a spatial point pattern and select the best fitting based on AIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">select.model2(pp, sigmas, r, nlarge = 10000, q = 1/4, p = 2, correction = "trans")
ipc.estK2(mippp, lambda = NULL, correction = "iso", r = NULL, sigma2 = NULL, 
             rho = NULL, q = 1/4, p = 2, nlarge = NULL, ...)
aic.function(r, dtheta, npar)
  ## S3 method for class 'selectedmod'
envelope(Y,fun=NULL,nrank=1,nsim=99,dimyx=c(128,128),...)
  ## S3 method for class 'selectedmod'
simulate(object,nsim=99, seed=1,dimyx=c(128,128),...)
  ## S3 method for class 'selectedmod'
plot(x,...)
  ## S3 method for class 'selectedmod'
print(x,...)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>

<p>Unmarked point pattern with the ppp format of spatstat
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmas</code></td>
<td>

<p>Vector with the sigma values (standard deviations of the Gaussian kernel) for estimating different intensity surfaces with  density.ppp. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>Vector of values for the argument r at which the (in)homogeneous K function should be evaluated. First element should be 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlarge</code></td>
<td>

<p>A number of points. In spatstat, if the number of points exceeds nlarge, then only the border correction will be computed (by default) for K(r). If you have a large number of points (n) and you want your border correction to be applied, set nlarge &gt; n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>q parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>p parameter of the dtheta (i.e., minimum contrast) function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>Any selection of the options "border", "bord.modif", "isotropic", "Ripley", "translate", "translation", "none" or "best". It specifies the edge correction(s) to be applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mippp</code></td>
<td>

<p>Unmarked point pattern with the ppp format of spatstat
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Optional. Values of the estimated intensity function. Either a vector giving the intensity values at the points of the pattern mippp, a pixel image (object of class "im") giving the intensity values at all locations, a fitted point process model (object of class "ppm" or "kppm") or a function(x,y) which can be evaluated to give the intensity value at any location.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>

<p>Starting  value in the optimization for the squared standard deviation of the Gaussian dispersion around parent points in the in(homogeneous) Poisson cluster process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>Starting  value in the optimization for the intensity of parent points in the in(homogeneous) Poisson cluster process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to the optim function (or to the plot, print, envelope and simulate methods).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtheta</code></td>
<td>

<p>Minimum contrast discrepancy, i.e., sum of squared diferences between the normalized empirical and theoretical K functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>

<p>Number of parameters fitted in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class "selectedmod", i.e., the result of using function select.model2().
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>An object of class "selectedmod", i.e., the result of using function select.model2().
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object of class "selectedmod", i.e., the result of using function select.model2().
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>

<p>Function to compute the desired summary statistic for the point pattern.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulated point patterns to be generated with simulate.selectedmod or when computing the envelopes with envelope.selectedmod.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>A single value to set the random generator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrank</code></td>
<td>

<p>Integer. Rank of the envelope value amongst the nsim simulated values. A rank of 1 means that the minimum and maximum simulated values will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimyx</code></td>
<td>

<p>Pixel array dimensions to estimate the intensity of the point pattern when simulating from inhomogeneous models.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>select.model2 is a wrap to fit and select different point processes using standard tools in of <span class="pkg">spatstat</span> and of <span class="pkg">ecespa</span>.
ipc.estK2 fits (in)homogeneous models as the function  ipc.estK of <span class="pkg">ecespa</span> but, in addition, it allows seting the argument nlarge and passing options to optim.  AIC calculation (actually AICc) is made by aic.function. See more details in Jara et al. (2015).
</p>


<h3>Value</h3>

<p>select.model2 returns an object of class "<code>selectedmod</code>",i.e., a list with components:
</p>

<dl>
<dt>dtheta </dt>
<dd>
<p>vector with the minimized discrepancy values for each fitted model.</p>
</dd>
<dt>best.dtheta </dt>
<dd>
<p>the minimum of the minimized discrepancy values.</p>
</dd>
<dt>best.model </dt>
<dd>
<p> The best of the fitted models. </p>
</dd>
<dt>models </dt>
<dd>
<p>vector with the names of the fitted models</p>
</dd>
<dt>HPPs </dt>
<dd>
<p>A list with the intensity objects employed to fit each inhomogeneous model</p>
</dd>
<dt>sigmas </dt>
<dd>
<p>vector with the sigma values (standard deviations of the Gaussian kernel) employed to estimate the  different intensity surfaces. </p>
</dd>
<dt>aics </dt>
<dd>
<p>vector with the AIC values of each model.</p>
</dd>
<dt>Kas </dt>
<dd>
<p>data.frame with the empirical K functios employed to fit each model.</p>
</dd>
<dt>pp </dt>
<dd>
<p> analyzed point pattern, with the ppp format of spatstat.</p>
</dd>
</dl>
<p><code>ipc.estK</code> gives an object of class '<code>ecespa.minconfit</code>', basically a list with the following components:
</p>
 
<dl>
<dt>sigma2</dt>
<dd>
<p>Parameter <code class="reqn">sigma^2</code>.</p>
</dd>
<dt>rho </dt>
<dd>
<p>Parameter <code class="reqn">rho</code>. </p>
</dd>
<dt>d.theta </dt>
<dd>
<p>Minimized value of the contrast criterion <code class="reqn">D(theta)</code>. </p>
</dd>
<dt>Kobs </dt>
<dd>
<p>Values of the observed K-function. </p>
</dd>
<dt>Kfit </dt>
<dd>
<p>Values of the fitted K-function. </p>
</dd>
<dt>r </dt>
<dd>
<p> Sequence of distances at which <code>Kobs</code> and <code>Kfit</code> have been estimated. </p>
</dd>
<dt>data </dt>
<dd>
<p>Original point pattern. </p>
</dd>
<dt>lambda </dt>
<dd>
<p>Original intensity object. </p>
</dd>
<dt>dataname </dt>
<dd>
<p>Name of the original point pattern. </p>
</dd>
<dt>lambdaname </dt>
<dd>
<p>Name of the original intensity object. </p>
</dd>
<dt>q</dt>
<dd> <p><code class="reqn">q</code> exponent of the contrast criterion. </p>
</dd>
<dt>p</dt>
<dd> <p><code class="reqn">p</code> exponent of the contrast criterion.  </p>
</dd>
</dl>
<p><code>aic.function</code> returns a one-row data.frame, with the following items:
</p>

<dl>
<dt>n</dt>
<dd>
<p>number of observations employed to compute AIC; i.e., number of r values where K(r) was estimated.</p>
</dd>
<dt>K</dt>
<dd>
<p>number of parameters of the model.</p>
</dd>
<dt>RSS</dt>
<dd>
<p>"Resiidual Sum of Squares". It is the value of the discrepacy function Dtheta.</p>
</dd>
<dt>LL</dt>
<dd>
<p>Loglikelihood.</p>
</dd>
<dt>AIC</dt>
<dd>
<p>AIC value.</p>
</dd>
<dt>AICc</dt>
<dd>
<p>Small sample AIC value.</p>
</dd>
</dl>
<p><code>envelope.selectedmod</code> returns a an object of class "fv", see fv.object, which can be printed and plotted directly. Essentially a data frame containing columns 
</p>

<dl>
<dt>r</dt>
<dd>
<p>the vector of values of the argument r at which the summary function fun has been estimated.</p>
</dd>
<dt>obs</dt>
<dd>
<p>values of the summary function for the data point pattern.</p>
</dd>
<dt>lo</dt>
<dd>
<p>lower envelope of simulations.</p>
</dd>
<dt>hi</dt>
<dd>
<p>upper envelope of simulations.</p>
</dd>
<dt>mmean</dt>
<dd>
<p>estimated theoretical value of the summary function, computed by averaging simulated values.</p>
</dd>
</dl>
<p><code>simulate.selectedmod</code> returns a list of <em>nsim</em> point patterns (with the ppp format of spatstat, simulated according to the best fitted model.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Jara, A., De la Cruz, M., Espinosa, C.I., Mendez, M. &amp; Escudero, A. (2015). Does spatial heterogeneity blur the signature of dispersal syndromes on spatial patterns of woody species? A test in a tropical dry forest. <em>Oikos</em>. http://dx.doi.org/10.1111/oik.02098.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Get the data
data(lansing)

# Split the multivariate pp in their individual components
lansing.sp&lt;-split(lansing)

# Define the sequence of r's at which estimate K(r)
r&lt;-  seq(0,0.25,le=101)

# Define different standard deviations for the Gaussian kernel 
# to estimate different intensity surfaces
sigmas&lt;- seq(0.1,1,by=0.05)

# Note that lansing is defined in a (0,1) x (0,1) window and this affects
# the election of r and sigma values

# Fit 40 models (1 Poisson, 1 Poisson cluster, 19 inhomogeneous Poisson
#  and 19 inhomogeneous Poisson cluster)  to maple and select the better ones
maple.model &lt;- select.model2(lansing.sp$maple, sigmas=sigmas, r=r)
# show the AICc value and the fitted parameters for the best model in each class
maple.model

# Draw the empirical and theoretical models to visually asses the fitting.
# P = Poisson; HPP= heterogeneous (i.e. inhomogeneous) Poisson;
# PC = Poisson cluster; HPC=heterogeneous (i.e. inhomogeneous) Poisson cluster
plot(maple.model)

# Compute and plot envelopes for the K function according to the best fitted model.
maple.env &lt;- envelope(maple.model, nsim=19)
plot(maple.env, sqrt(./pi)-r~r, legend=F)

# simulate 10 point patterns according to the best fitted model

maple.simu &lt;- simulate(maple.model, nsim=10)

maple.simu

# FIt and select models to all species
lansing.models&lt;-lapply(lansing.sp, function(x) select.model2(x, sigmas=sigmas, r=r))
lapply(lansing.models, function(x) x)

## End(Not run)
</code></pre>


</div>