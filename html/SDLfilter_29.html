<div class="container">

<table style="width: 100%;"><tr>
<td>vmaxlp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum one-way linear speed of a loop trip</h2>

<h3>Description</h3>

<p>Function to estimate the maximum one-way linear speed of a loop trip.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vmaxlp(sdata, qi = 4, nloc = 5, method = "ML", prob = 0.99, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: "id", "DateTime", "lat", "lon", "qi". 
See the data <code>turtle</code> for an example.
The function filters the input data by a unique "id" (e.g. transmitter number, identifier for each animal). 
"DateTime" is the GMT date &amp; time of each location in class <code>POSIXct</code> or 
<code>character</code> with the following format "2012-06-03 01:33:46".
"lat" and "lon" are the recorded latitude and longitude in decimal degrees. 
"qi" is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where "A", "B", "Z" will be replaced with "-1", "-2", "-3" respectively.
The greater number indicates a higher accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qi</code></td>
<td>
<p>An integer specifying the minimum quality index associated with a location used for the estimation. 
Default is 4 (e.g. 4 GPS satellite or more).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nloc</code></td>
<td>
<p>An integer specifying the minimum number of successive locations to be considered a loop trip.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Available options are "sample" (i.e. sample quantile - see <code>quantile</code>)
and "ML" (maximum likelihood estimation - see details). Default is "ML".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>A value (0 to 1) specifying the sample quantile or cumulative probability for one-way linear speed of a loop trip.
Values beyond this threshold are considered 'outliers' and excluded from estimation of maximum one-way linear speed of a loop trip. 
Default is 0.99. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments passed to <code>dupfilter</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first detects a "loop trip". 
Loop trip behaviour is represented by spatial departure and return involving more than 3 consecutive locations 
<a href="https://www.int-res.com/abstracts/meps/v457/p171-180/">(Shimada et al. 2012)</a>. 
The function calculates the net (i.e. straight-line) distance between the departure and turning point as well as 
the turning point and return location of a loop trip. 
It then calculates the one-way travelling speed to or from each turning point for each loop trip. 
To exclude implausible outliers, the function discards extreme values based on the specified quantile or 
an estimated probability distribution for the loop trip speed, depending on the selected <em>method</em>. 
If the "ML" method is selected, a Gamma distribution is assumed and the shape and scale parameters are estimated via maximum likelihood estimation 
using the <code>optim</code> function.
The maximum value within a given quantile or probability range (e.g. 0.99) represents the maximum one-way linear speed at which 
an animal would travel during a loop trip.
</p>


<h3>Value</h3>

<p>Maximum one-way linear speed of a loop trip (vmaxlp) estimated from the input data. The unit km/h.
</p>


<h3>Note</h3>

<p>The input data must not contain temporal or spatial duplicates. A minimum of 8 locations are required.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) 
Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code>ddfilter</code>, <code>ddfilter_loop</code>, <code>track_param</code>, <code>dupfilter</code>
</p>


</div>