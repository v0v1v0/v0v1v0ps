<div class="container">

<table style="width: 100%;"><tr>
<td>shapr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an explainer object with Shapley weights for test data.</h2>

<h3>Description</h3>

<p>Create an explainer object with Shapley weights for test data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shapr(x, model, n_combinations = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric matrix or data.frame/data.table. Contains the data used to estimate the (conditional)
distributions for the features needed to properly estimate the conditional expectations in the Shapley formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model whose predictions we want to explain. Run
<code>shapr:::get_supported_models()</code>
for a table of which models <code>shapr</code> supports natively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_combinations</code></td>
<td>
<p>Integer. The number of feature combinations to sample. If <code>NULL</code>,
the exact method is used and all combinations are considered. The maximum number of
combinations equals <code>2^ncol(x)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Named list that contains the following items:
</p>

<dl>
<dt>exact</dt>
<dd>
<p>Boolean. Equals <code>TRUE</code> if <code>n_combinations = NULL</code> or
<code>n_combinations &lt; 2^ncol(x)</code>, otherwise <code>FALSE</code>.</p>
</dd>
<dt>n_features</dt>
<dd>
<p>Positive integer. The number of columns in <code>x</code></p>
</dd>
<dt>S</dt>
<dd>
<p>Binary matrix. The number of rows equals the number of unique combinations, and
the number of columns equals the total number of features. I.e. let's say we have a case with
three features. In that case we have <code>2^3 = 8</code> unique combinations. If the j-th
observation for the i-th row equals <code>1</code> it indicates that the j-th feature is present in
the i-th combination. Otherwise it equals <code>0</code>.</p>
</dd>
<dt>W</dt>
<dd>
<p>Second item</p>
</dd>
<dt>X</dt>
<dd>
<p>data.table. Returned object from <code>feature_combinations</code></p>
</dd>
<dt>x_train</dt>
<dd>
<p>data.table. Transformed <code>x</code> into a data.table.</p>
</dd>
<dt>feature_list</dt>
<dd>
<p>List. The <code>updated_feature_list</code> output from
<code>preprocess_data</code></p>
</dd>
</dl>
<p>In addition to the items above, <code>model</code> and <code>n_combinations</code> are also present in the returned object.
</p>


<h3>Author(s)</h3>

<p>Nikolai Sellereite
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("MASS", quietly = TRUE)) {
  # Load example data
  data("Boston", package = "MASS")
  df &lt;- Boston

  # Example using the exact method
  x_var &lt;- c("lstat", "rm", "dis", "indus")
  y_var &lt;- "medv"
  df1 &lt;- df[, x_var]
  model &lt;- lm(medv ~ lstat + rm + dis + indus, data = df)
  explainer &lt;- shapr(df1, model)

  print(nrow(explainer$X))
  # 16 (which equals 2^4)

  # Example using approximation
  y_var &lt;- "medv"
  x_var &lt;- setdiff(colnames(df), y_var)
  model &lt;- lm(medv ~ ., data = df)
  df2 &lt;- df[, x_var]
  explainer &lt;- shapr(df2, model, n_combinations = 1e3)

  print(nrow(explainer$X))

  # Example using approximation where n_combinations &gt; 2^m
  x_var &lt;- c("lstat", "rm", "dis", "indus")
  y_var &lt;- "medv"
  df3 &lt;- df[, x_var]
  model &lt;- lm(medv ~ lstat + rm + dis + indus, data = df)
  explainer &lt;- shapr(df1, model, n_combinations = 1e3)

  print(nrow(explainer$X))
  # 16 (which equals 2^4)
}
</code></pre>


</div>