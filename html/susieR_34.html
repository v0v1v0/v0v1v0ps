<div class="container">

<table style="width: 100%;"><tr>
<td>susie_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SuSiE Plots.</h2>

<h3>Description</h3>

<p><code>susie_plot</code> produces a per-variable summary of
the SuSiE credible sets. <code>susie_plot_iteration</code> produces a
diagnostic plot for the susie model fitting. For
<code>susie_plot_iteration</code>, several plots will be created if
<code>track_fit = TRUE</code> when calling <code>susie</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">susie_plot(
  model,
  y,
  add_bar = FALSE,
  pos = NULL,
  b = NULL,
  max_cs = 400,
  add_legend = NULL,
  ...
)

susie_plot_iteration(model, L, file_prefix, pos = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A SuSiE fit, typically an output from
<code>susie</code> or one of its variants. For <code>suse_plot</code>,
the susie fit must have <code>model$z</code>, <code>model$PIP</code>, and may
include <code>model$sets</code>. <code>model</code> may also be a vector of
z-scores or PIPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A string indicating what to plot: either <code>"z_original"</code> for
z-scores, <code>"z"</code> for z-score derived p-values on (base-10) log-scale, 
<code>"PIP"</code> for posterior inclusion probabilities,
<code>"log10PIP"</code> for posterior inclusion probabiliities on the
(base-10) log-scale. For any other setting, the data are plotted as
is.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_bar</code></td>
<td>
<p>If <code>add_bar = TRUE</code>, add horizontal bar to
signals in credible interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>Indices of variables to plot. If <code>pos = NULL</code> all
variables are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>For simulated data, set <code>b = TRUE</code> to highlight
"true" effects (highlights in red).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_cs</code></td>
<td>
<p>The largest credible set to display, either based on
purity (set <code>max_cs</code> between 0 and 1), or based on size (set
<code>max_cs &gt; 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_legend</code></td>
<td>
<p>If <code>add_legend = TRUE</code>, add a legend to
annotate the size and purity of each CS discovered. It can also be
specified as location where legends should be added, e.g.,
<code>add_legend = "bottomright"</code> (default location is
<code>"topright"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to
<code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>An integer specifying the number of credible sets to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_prefix</code></td>
<td>
<p>Prefix to path of output plot file. If not
specified, the plot, or plots, will be saved to a temporary
directory generated using <code>tempdir</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Invisibly returns <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code>susie_plot_changepoint</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n = 1000
p = 1000
beta = rep(0,p)
beta[sample(1:1000,4)] = 1
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
res = susie(X,y,L = 10)
susie_plot(res,"PIP")
susie_plot(res,"PIP",add_bar = TRUE)
susie_plot(res,"PIP",add_legend = TRUE)
susie_plot(res,"PIP", pos=1:500, add_legend = TRUE)
# Plot selected regions with adjusted x-axis position label
res$genomic_position = 1000 + (1:length(res$pip))
susie_plot(res,"PIP",add_legend = TRUE,
           pos = list(attr = "genomic_position",start = 1000,end = 1500))
# True effects are shown in red.
susie_plot(res,"PIP",b = beta,add_legend = TRUE)

set.seed(1)
n = 1000
p = 1000
beta = rep(0,p)
beta[sample(1:1000,4)] = 1
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
res = susie(X,y,L = 10)
susie_plot_iteration(res, L=10)

</code></pre>


</div>