<div class="container">

<table style="width: 100%;"><tr>
<td>stepsel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic selection of number of jumps</h2>

<h3>Description</h3>

<p>Select the number of jumps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepsel(path, y, type = c("MRC", "AIC", "BIC"), ...)
stepsel.MRC(path, y, q, alpha = 0.05, r = ceiling(50 / min(alpha, 1 - alpha)),
  lengths = if(attr(path$cand, "family") == "gaussKern")
    2^(floor(log2(length(y))):ceiling(log2(length(attr(path$cand, "param")$kern)))) else
    2^(floor(log2(length(y))):0),
  penalty = c("none", "log", "sqrt"), name = if(attr(path$cand, "family") == "gaussKern")
    ".MRC.ktable" else ".MRC.table",
  pos = .MCstepR)
stepsel.AIC(path, ...)
stepsel.BIC(path, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>an object of class <code>steppath</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>for <code>type=MRC</code> only: a numeric vector containing the serial data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>how to select, dispatches specific method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further argument passed to specific method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q, alpha, r, lengths, penalty, name, pos</code></td>
<td>
<p>see <code>bounds</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A single integer giving the number of blocks selected, with <code>attr</code>ibute <code>crit</code> containing the values of the criterion (MRC / AIC / BIC) for each fit in the path.
</p>


<h3>Note</h3>

<p>To obtain the threshold described in Boysen et al.~(2009, Theorem~5), set <code>q=(1+delta) * sdrobnorm(y) * sqrt(2*length(y))</code> for some positive <code>delta</code> and <code>penalty="none"</code>.
</p>


<h3>References</h3>

<p>Boysen, L., Kempe, A., Liebscher, V., Munk, A., Wittich, O. (2009) Consistencies and rates of convergence of jump-penalized least squares estimators. <em>The Annals of Statistics</em> <b>37</b>(1), 157–183.
</p>
<p>Yao, Y.-C. (1988) Estimating the number of change-points via Schwarz' criterion. <em>Statistics &amp; Probability Letters</em> <b>6</b>, 181–189.
</p>


<h3>See Also</h3>

<p><code>steppath</code>, <code>stepfit</code>, family, <code>stepbound</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 5 blocks (4 jumps) within a total of 100 data points
b &lt;- c(sort(sample(1:99, 4)), 100)
f &lt;- rep(rnorm(5, 0, 4), c(b[1], diff(b)))
rbind(b = b, f = unique(f))
# add gaussian noise
y &lt;- f + rnorm(100)
# find 10 candidate jumps
path &lt;- steppath(y, max.cand = 10)
# select number of jumps by simulated MRC with sqrt-penalty
# thresholded with positive delta, and by BIC
sel.MRC &lt;- stepsel(path, y, "MRC", alpha = 0.05, r = 1e2, penalty = "sqrt")
sel.MRC
delta &lt;- .1
sel.delta &lt;- stepsel(path, y, "MRC",
  q = (1 + delta) * sdrobnorm(y) * sqrt(2 * length(y)), penalty = "none")
sel.delta
sel.BIC &lt;- stepsel(path, type="BIC")
sel.BIC
# compare results with truth
fit.MRC &lt;- path[[sel.MRC]]
as.data.frame(fit.MRC)
as.data.frame(path[[sel.delta]])
as.data.frame(path[[sel.BIC]])
</code></pre>


</div>