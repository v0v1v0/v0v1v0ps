<div class="container">

<table style="width: 100%;"><tr>
<td>sandwich</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the robust covariance estimator for GEE given an</h2>

<h3>Description</h3>

<p><code>sandwich</code> calculates the covariance structure between timepoints given matrices <code>yCov</code>, <code>D</code>,<code>V</code> and <code>correctionmatrix</code>. This is done to be able to account for missingness in the Data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sandwich(
  yCov,
  D,
  V,
  correctionmatrix,
  missing = rep(0, dim(yCov)[[2]]),
  missingtype = c("none", "monotone", "intermittened")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yCov</code></td>
<td>
<p><code class="reqn">yCov</code> matrix containing either an estimation for the covariance between timepoints or an empirical covariance matrix itsel. see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p><code class="reqn">D</code> denotes the mean matrix of all entries of <code class="reqn">\Delta\mu_i/\delta\beta</code>, where this is the average over all <code>i</code> patiens. see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p><code class="reqn">V</code> denotes the working covariance matrix.  see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correctionmatrix</code></td>
<td>
<p>As of this version this matrix is needed to correct some calculations. see 'Details' to see for more details and how to correctly select matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>vector which denotes the probability to experience a dropout at each timepoint. If <code>missingtype</code> is <code>"none"</code> then all entries are 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingtype</code></td>
<td>
<p>String which describes the type of missingness occuring in the data. <code>none</code> if no missingnes occured, <code>"monotone"</code> if missing was monotone and <code>"intermittened"</code> if the missingness was independent across all timepoints.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>yCov</code> is either empirical or the estimated covariance-matrix between timepoints which is needed to calculate the sandwich estimator. This matrix can either be generated by estimating the empirical covariance matrix using existing data or by using function <code>gen_cov_cor</code> to calculate a estimation for the covariance.
</p>
<p><code>D</code> denotes the estimation of <code class="reqn">n^-1* \sum_i^N \Delta\mu_i/\delta\beta</code>, which means that <code class="reqn">D=E(D_i)</code>. As of yet this has the unfortunate side effect that E(D_i
</p>


<h3>Value</h3>

<p><code>sandwich</code> returns the robust covariance estimator of regression coefficients which are implicitly defined by <code>D</code>.
</p>


<h3>Source</h3>

<p><code>sandwich</code> computes the asymptotic sandwich covariance estimator and uses code contributed by Roland Gerard Gera.
</p>


<h3>References</h3>

<p>Liang Kung-Yee, Zeger Scott L. (1986); Jung Sin-Ho, Ahn Chul (2003); Wachtlin Daniel Kieser Meinhard (2013)
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Let's assume we wish to calculate the robust variance estimator for  equation
#\eqn{y_{it}=\beta_0+\beta_1*I_{treat}+\beta_2*t+\beta_3*I _{treat}*t+\epsilon_{it}}.
#Furthermore we use the identitiy matrix as the working covariance matrix.
#The chance to get treatment is 60 percent and the observed timerange ranges from 0:5.

  ycov = gen_cov_cor(var = 3,rho = 0.25,theta = 1,Time = 0:5,cov = TRUE)
  D = matrix(c(1,0.6,0,0,
               1,0.6,1,0.6,
               1,0.6,2,1.2,
               1,0.6,3,1.8,
               1,0.6,4,2.4,
               1,0.6,5,3.0),nrow=4)

 D=t(D)
 V=diag(1,length(0:5))
 #We correct entries where E(D_i %*% D_i) is unequal to E(D_i)%*%E(D_i) (D %*% D).
 correctionmatrix=matrix(c(1,1,1,1,1,1/0.6,1,1/0.6,1,1,1,1,1,1/0.6,1,1/0.6),nrow=4)
 missingtype = "none"

 robust=sandwich(yCov=ycov,D=D,V=V,missingtype=missingtype,correctionmatrix=correctionmatrix)
 robust

</code></pre>


</div>