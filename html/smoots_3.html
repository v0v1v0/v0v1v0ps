<div class="container">

<table style="width: 100%;"><tr>
<td>confBounds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotically Unbiased Confidence Bounds</h2>

<h3>Description</h3>

<p>Asymptotically Unbiased Confidence Bounds
</p>


<h3>Usage</h3>

<pre><code class="language-R">confBounds(
  obj,
  alpha = 0.95,
  p = c(0, 1, 2, 3),
  plot = TRUE,
  showPar = TRUE,
  rescale = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>an object returned by either <code>msmooth</code>,
<code>tsmooth</code> or <code>dsmooth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the confidence level; a single numeric value between <code>0</code>
and <code>1</code>; <code>0.95</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the order of polynomial used for the parametric polynomial
regression that is conducted as a benchmark for the trend function;
must satisfy <code class="reqn">0 \leq</code> <code>p</code> <code class="reqn">\leq 3</code>; set to
<code>1</code> by default; is irrelevant, if a derivative of the trend of order
greater than zero is being analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value; for <code>plot = TRUE</code>, the default, a plot is
created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPar</code></td>
<td>
<p>set to <code>TRUE</code>, if the parametric fitted values are to be
shown against the unbiased estimates and the confidence bounds for
<code>plot = TRUE</code>; the default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>a single logical value; is set to <code>TRUE</code> by default;
if the output of a derivative estimation process is passed to <code>obj</code> and
if <code>rescale = TRUE</code>, the estimates and confidence bounds will be
rescaled according to <code>x</code> for the plot (see also the details on the
parameter <em>...</em>); the numerical output stays unchanged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments that can be passed to the <code>plot</code> function;
if an argument <code>x</code> with time points is not given by the user,
<code>x = 1:length(obj$ye)</code> is used per default for the observation time
points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is part of the <code>smoots</code> package and was implemented under
version 1.1.0. The underlying theory is based on the additive nonparametric
regression function
</p>
<p style="text-align: center;"><code class="reqn">y_t = m(x_t) + \epsilon_t,</code>
</p>

<p>where <code class="reqn">y_t</code> is the observed time series, <code class="reqn">x_t</code> is the rescaled time
on the interval <code class="reqn">[0, 1]</code>, <code class="reqn">m(x_t)</code> is a smooth trend function and
<code class="reqn">\epsilon_t</code> are stationary errors with <code class="reqn">E(\epsilon_t) = 0</code> and
short-range dependence.
</p>
<p>The purpose of this function is the estimation of reasonable confidence
intervals for the nonparametric trend function and its derivatives. The
optimal bandwidth minimizes the Asymptotic Mean Integrated Squared Error
(AMISE) criterion, however, local polynomial estimates are (usually) biased.
The bias is then (approximately)
</p>
<p style="text-align: center;"><code class="reqn">\frac{h^{k - v} m^{(k)}(x) \beta_{(\nu, k)}}{k!},</code>
</p>

<p>where <code class="reqn">p</code> is the order of the local polynomials, <code class="reqn">k = p + 1</code> is the
order of the asymptotically equivalent kernel, <code class="reqn">\nu</code> is the order of the
of the trend function's derivative, <code class="reqn">m^(v)</code> is the <code class="reqn">\nu</code>-th order
derivative of the trend function and <code class="reqn">\beta_{(\nu, k)} = \int_{-1}^{1}
u^k K_{(\nu, k)}(u) du</code>.
<code class="reqn">K_{(\nu, k)}(u)</code> is the <code class="reqn">k</code>-th order asymptotically
equivalent kernel function for estimating <code class="reqn">m^{(\nu)}</code>.
A renewed estimation with an adjusted bandwidth
<code class="reqn">h_{ub} = o(n^{-1 / (2k + 1)})</code>, i.e., a
bandwidth with a smaller order than the optimal bandwidth, is conducted.
<code class="reqn">h = h_{A}^{(2k + 1) / (2k)}</code>, where
<code class="reqn">h_{A}</code> is the optimal bandwidth, is implemented.
</p>
<p>Following this idea, we have that
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{nh}[m^{(\nu)}(x) - \hat{m}^{(\nu)}(x)]</code>
</p>

<p>converges to
</p>
<p style="text-align: center;"><code class="reqn">N(0,2\pi c_f R(x))</code>
</p>

<p>in distribution, where <code class="reqn">2\pi c_f</code> is the sum of autocovariances.
Consequently, the trend (or derivative) estimates are asymptotically unbiased
and normally distributed.
</p>
<p>To make use of this function, an object of class <code>smoots</code> can be given
as input that was created by either <code>msmooth</code>,
<code>tsmooth</code> or <code>dsmooth</code>. Based on the optimal
bandwidth saved within <code>obj</code>, an adjustment to the bandwidth is made so
that the estimates following the adjusted bandwidth are (relatively)
unbiased.
</p>
<p>Based on the input argument <code>alpha</code>, the level of confidence between
<code>0</code> and <code>1</code>, the respective confidence bounds are calculated for
each observation point.
</p>
<p>From the input argument <code>obj</code>, the order of derivative is automatically
obtained. By means of the argument <code>p</code>, an order of polynomial is
selected for a parametric regression of the trend function. This is only
meaningful, if the trend (and not its derivatives) is analyzed. Otherwise,
the argument is automatically dropped by the function. Furthermore, if
<code>plot = TRUE</code>, a plot of the unbiased trend (or derivative) estimates
alongside the confidence bounds is created. If also <code>showPar = TRUE</code>,
the estimated parametric trend (or parametric constant value for the
derivatives) is added to the confidence bound plot for comparison.
</p>
<p>NOTE:
</p>
<p>The values that are returned by the function are obtained with respect to
the rescaled time points on the interval <code class="reqn">[0, 1]</code>. While the plot can be
adjusted and rescaled by means of a given vector with the actual time points,
the numeric output is not rescaled. For this purpose we refer the user to
the <code>rescale</code> function of the <code>smoots</code> package.
</p>
<p>This function implements C++ code by means of the
<code>Rcpp</code> and
<code>RcppArmadillo</code> packages for
better performance.
</p>


<h3>Value</h3>

<p>A plot is created in the plot window and a list with different components
is returned.
</p>

<dl>
<dt>alpha</dt>
<dd>
<p>a numeric vector of length 1; the level of confidence; input
argument.</p>
</dd>
<dt>b.ub</dt>
<dd>
<p>a numeric vector with one element that represents the adjusted
bandwidth for the unbiased trend estimation.</p>
</dd>
<dt>p.estim</dt>
<dd>
<p>a numeric vector with the estimates following the parametric
regression defined by <code>p</code> that is conducted as a benchmark for the trend
function; for the trend's derivatives or for <code>p = 0</code>, a constant value
is the benchmark; the values are obtained with respect to the rescaled time
points on the interval <code class="reqn">[0, 1]</code>.</p>
</dd>
<dt>n</dt>
<dd>
<p>the number of observations.</p>
</dd>
<dt>np.estim</dt>
<dd>
<p>a data frame with the three (numeric) columns <strong>ye.ub</strong>,
<strong>lower</strong> and <strong>upper</strong>; in <strong>ye.ub</strong> the unbiased trend
estimates, in <strong>lower</strong> the lower confidence bound and in <strong>upper</strong>
the upper confidence bound can be found; the values are obtained with respect
to the rescaled time points on the interval <code class="reqn">[0, 1]</code>.</p>
</dd>
<dt>v</dt>
<dd>
<p>the order of the trend's derivative considered for the test.</p>
</dd>
</dl>
<h3>Author(s)</h3>


<ul>
<li>
<p> Yuanhua Feng (Department of Economics, Paderborn University), <br>
Author of the Algorithms <br>
Website: <a href="https://wiwi.uni-paderborn.de/en/dep4/feng/">https://wiwi.uni-paderborn.de/en/dep4/feng/</a>
</p>
</li>
<li>
<p> Dominik Schulz (Research Assistant) (Department of Economics, Paderborn
University), <br>
Package Creator and Maintainer
</p>
</li>
</ul>
<h3>References</h3>

<p>Beran, J. and Feng, Y. (2002). Local polynomial fitting with long-memory,
short-memory and antipersistent errors. Annals of the Institute of
Statistical Mathematics, 54(2), 291-311.
</p>
<p>Feng, Y., Gries, T. and Fritz, M. (2020). Data-driven
local polynomial for the trend and its derivatives in economic time
series. Journal of Nonparametric Statistics, 32:2, 510-533.
</p>
<p>Feng, Y., Gries, T., Letmathe, S. and Schulz, D. (2019). The smoots package
in R for semiparametric modeling of trend stationary time series. Discussion
Paper. Paderborn University. Unpublished.
</p>
<p>Feng, Y., Gries, T., Fritz, M., Letmathe, S. and Schulz, D. (2020).
Diagnosing the trend and bootstrapping the forecasting intervals using a
semiparametric ARMA. Discussion Paper. Paderborn University. Unpublished.
</p>


<h3>Examples</h3>

<pre><code class="language-R">log_gdp &lt;- log(smoots::gdpUS$GDP)
est &lt;- msmooth(log_gdp)
confBounds(est)

</code></pre>


</div>