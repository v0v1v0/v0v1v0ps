<div class="container">

<table style="width: 100%;"><tr>
<td>rsde2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate transitional densities and random generation for 2-D SDE's</h2>

<h3>Description</h3>

<p>Transition density and random generation for the joint and marginal of <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code> of the SDE's 2-d.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsde2d(object, ...)
dsde2d(object, ...)

## Default S3 method:
rsde2d(object, at, ...)

## Default S3 method:
dsde2d(object, pdf=c("Joint","Marginal"), at, ...)
## S3 method for class 'dsde2d'
plot(x,display=c("persp","rgl","image","contour"),hist=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>snssde2d</code> and <code>bridgesde2d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>time between <code>s=t0</code> and <code>t=T</code>. The default <code>at = T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>probability density function <code>Joint</code> or <code>Marginal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>dsde2d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>display plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code>truehist</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially potentially arguments to be passed to methods, such as <code>density</code> for marginal density and <code>kde2d</code> fro joint density.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>rsde2d</code> returns a <code>M</code> random variable <code class="reqn">x_{t=at},y_{t=at}</code> realize at time <code class="reqn">t=at</code>.
</p>
<p><img src="../help/figures/r2d.png" alt="fig03"></p>
<p>And <code>dsde2d</code> returns a bivariate density approximation for <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>. with <code class="reqn"> t=at </code> is a fixed time between <code>t0</code> and <code>T</code>.
</p>
<p><img src="../help/figures/tranden2d.png" alt="fig04"></p>
<p>An overview of this package, see <code>browseVignettes('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dsde2d()</code></td>
<td>
<p>gives the bivariate density approximation for <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsde2d()</code></td>
<td>
<p>generates random of the couple <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>See Also</h3>

<p><code>kde2d</code> Two-dimensional kernel density estimation in "MASS" package.
</p>
<p><code>kde</code> Kernel density estimate for 1- to 6-dimensional data in "ks" package.
</p>
<p><code>sm.density</code> Nonparametric density estimation in one, two or three dimensions in "sm" package.
</p>
<p><code>rng</code> random number generators in "yuima" package. 
</p>
<p><code>BiGQD.density</code> Generate the transition density of a bivariate generalized quadratic diffusion model (2D GQD) in "DiffusionRgqd" package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example:1
set.seed(1234)

# SDE's 2d
fx &lt;- expression(3*(2-y),2*x)
gx &lt;- expression(1,y)
mod2d &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(1,2),M=1000)

# random 
r2d &lt;- rsde2d(mod2d,at=0.5)
summary(r2d)

# Marginal density 

denM &lt;- dsde2d(mod2d,pdf="M", at=0.5)
denM
plot(denM)

# Joint density
denJ &lt;- dsde2d(mod2d,pdf="J",n=200, at= 0.5,lims=c(-3,4,0,6))
denJ
plot(denJ)
plot(denJ,display="contour")

## Example 2: Bivariate Transition Density of 2 Brownian motion (W1(t),W2(t)) in [0,1]

## Not run: 
B2d &lt;- snssde2d(drift=rep(expression(0),2),diffusion=rep(expression(1),2),
       M=10000)
for (i in seq(B2d$Dt,B2d$T,by=B2d$Dt)){
plot(dsde2d(B2d, at = i,lims=c(-3,3,-3,3),n=100),
   display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 3: 

## Not run: 
fx &lt;- expression(4*(-1-x)*y , 4*(1-y)*x )
gx &lt;- expression(0.25*y,0.2*x)
mod2d1 &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(x0=1,y0=-1),
      M=5000,type="str")

# Marginal transition density
for (i in seq(mod2d1$Dt,mod2d1$T,by=mod2d1$Dt)){
plot(dsde2d(mod2d1,pdf="M", at = i),main=
      paste0('Marginal Transition Density \n t = ',i))
}

# Bivariate transition density
for (i in seq(mod2d1$Dt,mod2d1$T,by=mod2d1$Dt)){
plot(dsde2d(mod2d1, at = i,lims=c(-1,2,-1,1),n=100),
    display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 4: Bivariate Transition Density of 2 bridge Brownian motion (W1(t),W2(t)) in [0,1]

## Not run: 
B2d &lt;- bridgesde2d(drift=rep(expression(0),2),
  diffusion=rep(expression(1),2),M=5000)
for (i in seq(0.01,0.99,by=B2d$Dt)){ 
plot(dsde2d(B2d, at = i,lims=c(-3,3,-3,3),
 n=100),display="contour",main=
 paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 5: Bivariate Transition Density of bridge 
## Ornstein-Uhlenbeck process and its integral in [0,5]
## dX(t) = 4*(-1-X(t)) dt + 0.2 dW1(t)
## dY(t) = X(t) dt + 0 dW2(t)
## x01 = 0 , y01 = 0
## x02 = 0, y02 = 0 
## Not run: 
fx &lt;- expression(4*(-1-x) , x)
gx &lt;- expression(0.2 , 0)
OUI &lt;- bridgesde2d(drift=fx,diffusion=gx,Dt=0.005,M=1000)
for (i in seq(0.01,4.99,by=OUI$Dt)){
plot(dsde2d(OUI, at = i,lims=c(-1.2,0.2,-2.5,0.2),n=100),
 display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)
</code></pre>


</div>