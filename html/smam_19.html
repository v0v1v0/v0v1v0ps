<div class="container">

<table style="width: 100%;"><tr>
<td>fitBMME</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Brownian Motion with Measurement Error</h2>

<h3>Description</h3>

<p>Given discretely observed animal movement locations, fit a Brownian
motion model with measurement errors. Using <code>segment</code> to fit
part of observations to the model. A practical application of this
feature is seasonal analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitBMME(
  data,
  start = NULL,
  segment = NULL,
  method = "Nelder-Mead",
  optim.control = list()
)

fitBmme(data, start = NULL, method = "Nelder-Mead", optim.control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame whose first column is the observation time, and other
columns are location coordinates. If <code>segment</code> is not <code>NULL</code>,
additional column with the same name given by <code>segment</code> should be
included. This additional column is used to indicate which part of
observations shoule be used to fit model. The value of this column can
be any integer with 0 means discarding this observation and non-0 means
using this obversvation. Using different non-zero numbers indicate different
segments. (See vignette for more details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value of the model, a vector of two component, one for
sigma (sd of BM) and the other for delta (sd for measurement error).
If unspecified (NULL), a moment estimator will be used assuming equal
sigma and delta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment</code></td>
<td>
<p>character variable, name of the column which indicates segments,
in the given <code>data.frame</code>. The default value, <code>NULL</code>, means using
whole dataset to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method argument to feed <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>a list of control that is passed down to <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The joint density of the increment data is multivariate normal with a
sparse (tri-diagonal) covariance matrix. Sparse matrix operation from
package Matrix is used for computing efficiency in handling large data.
</p>


<h3>Value</h3>

<p>A list of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>the estimated parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.est </code></td>
<td>
<p>variance matrix of the estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik </code></td>
<td>
<p>loglikelihood evaluated at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>convergence code from optim</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Pozdnyakov V., Meyer, TH., Wang, Y., and Yan, J. (2013)
On modeling animal movements using Brownian motion with measurement
error. Ecology 95(2): p247â€“253. doi:doi:10.1890/13-0532.1.
</p>


<h3>See Also</h3>

<p><code>fitMR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
tgrid &lt;- seq(0, 500, by = 1)
dat &lt;- rBMME(tgrid, sigma = 1, delta = 0.5)

## using whole dataset to fit BMME
fit &lt;- fitBMME(dat)
fit

## using part of dataset to fit BMME
batch &lt;- c(rep(0, 100), rep(1, 200), rep(0, 50), rep(2, 100), rep(0, 51))
dat.segment &lt;- cbind(dat, batch)
fit.segment &lt;- fitBMME(dat.segment, segment = "batch")
head(dat.segment)
fit.segment

</code></pre>


</div>