<div class="container">

<table style="width: 100%;"><tr>
<td>impactspsur</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Direct, indirect and total effects estimated for a spatial SUR model</h2>

<h3>Description</h3>

<p>This function is a wrapper for <code>impacts</code> method
used in <span class="pkg">spatialreg</span> package. Nevertheless, in this case the same 
method is used for both <code>lagsarlm</code> and 
<code>lmSLX</code> objects. For details of implementation, 
see the documentation of <code>impacts</code> function in 
<span class="pkg">spatialreg</span> package. <br>
The function obtains the multiplier effects, on the explained variable, 
of a change in a regressor for the model that has been estimated. 
For reasons given below, this function only applies to models with an 
autoregressive structure ("slm", "sdm", "sarar" and "gnm") or with spatial lags 
of the regressors ("slx", "sdem"). <br>
The measurement of the multiplier effects is a bit more complicated than 
in a pure time series context because, due to the spatial structure of 
the model, part of the impacts spills over non uniformly over the space. 
Using the notation introduced by LeSage and Pace (2009) we distinguish 
between:
</p>

<ul>
<li> <p><strong>Average Direct effects</strong>: The average over the <em>N</em> 
spatial units and <em>Tm</em> time periods of the effect of a unitary 
change in the value of a explanatory variable on the contemporaneous 
value of the corresponding explained variable, located in the same 
point of the intervened regressor. This calculus is solved for all the 
regressors that appear in the <em>G</em> equations of the model.
</p>
</li>
<li> <p><strong>Average Indirect effects</strong>: The average over the <em>N</em> 
spatial units and <em>Tm</em> time periods of the effects of a unitary 
change in the value of a explanatory variable on the contemporaneous 
value of the corresponding explained variable, located in a different 
spatial unit that that of the intervened regressor. This calculus is 
solved for all the regressors that appear in the <em>G</em> equations of 
the model.
</p>
</li>
<li> <p><strong>Average total effects</strong>: The sum of Direct and 
Indirect effects.
</p>
</li>
</ul>
<p>The information on the three estimated effects is supplement with an 
indirect measure of statistical significance obtained from the 
randomization approach introduced in LeSage and Pace (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">impactspsur (obj, ..., tr = NULL, R = NULL, listw = NULL, 
                      evalues = NULL,tol = 1e-06, 
                      empirical = FALSE, Q = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>An <code>spsur</code> object created by <code>spsurml</code>,
<code>spsur3sls</code> or <code>spsurtime</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed through to methods in the <span class="pkg">coda</span> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>A vector of traces of powers of the spatial weights matrix created using <code>trW</code>, for approximate impact measures; if not given, <code>listw</code> must be given for exact measures (for small to moderate spatial weights matrices); the traces must be for the same spatial weights as were used in fitting the spatial regression, and must be row-standardised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>If given, simulations are used to compute distributions for the impact measures, returned as <code>mcmc</code> objects; the objects are used for convenience but are not output by an MCMC process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>If <code>tr</code> is not given, a spatial weights object as created by <code>nb2listw</code>; they must be the same spatial weights as were used in fitting the spatial regression, but do not have to be row-standardised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalues</code></td>
<td>
<p>vector of eigenvalues of spatial weights matrix for impacts calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Argument passed to <code>mvrnorm</code>: tolerance (relative to largest variance) for numerical lack of positive-definiteness in the coefficient covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>Argument passed to <code>mvrnorm</code> (default FALSE): if true, the coefficients and their covariance matrix specify the empirical not population mean and covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>default NULL, else an integer number of cumulative power series impacts to calculate if <code>tr</code> is given</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>LeSage and Pace (2009) adapt the classical notion of 
<em>'economic multiplier'</em> to the problem of measuring the impact that 
a unitary change in the value of a regressor, produced in a certain point 
in space, has on the explained variable. The question is interesting 
because, due to the spatial structure of the model, the impacts of such 
change spill non uniformly over the space. In fact, the reaction of the 
explained variable depends on its relative location in relation to the 
point of intervention. <br>
To simplify matters, LeSage and Pace (2009) propose to obtain aggregated 
multipliers for each regressor, just averaging the <code class="reqn">N^{2}</code> impacts 
that results from intervening the value of each regressor on each of the
N points in Space, on the explained variable, measured also in each of 
the <code class="reqn">N</code> points in space. This aggregated average is the so-called 
<em>Total effect</em>. <br>
Part of this impact will be absorved by the explained variable located in 
the same point of the regressor whose value has been changed (for example, 
the k-th regresor in the g-th equation, in the n-th spatial unit) or,
in other words, we expect that <code class="reqn">[d y_{tgn}]/[d x_{ktgn}] ne 0</code>. The 
aggregated average for the <em>N</em> points in space (n=1,2,...,N) and 
<em>Tm</em> time periods is the so-called <em>Direct effect</em>.
The difference between the <em>Total effect</em> and the <em>Direct effect</em> 
measures the portion of the impact on the explained variable that leakes 
to other points in space, <code class="reqn">[d y_{tgn}]/[d x_{ktgm}] for n ne m</code>;
this is the <em>Indirect effect</em>.
</p>
<p><code>impacts</code> obtains the three multipliers together with an 
indirect measure of statistical significance, according to the 
randomization approach described in Lesage and Pace (2009). Briefly, they 
suggest to obtain a sequence of <em>nsim</em> random matrices of order 
<em>(NTmxG)</em> from a multivariate normal distribution 
N(0; <em>Sigma</em>), being <em>Sigma</em> the estimated covariance matrix 
of the <em>G</em> equations in the SUR model. These random matrices, 
combined with the observed values of the regressors and the estimated 
values of the parameters of the corresponding spatial SUR model, are used 
to obtain simulated values of the explained variables. Then, for each one 
of the <em>nsim</em> experiments, the SUR model is estimated, and the effects
are evaluated. The function <code>impacts</code> obtains the standard 
deviations of the <em>nsim</em> estimated effects in the randomization 
procedure, which are used to test the significance of the estimated 
effects for the original data.
</p>
<p>Finally, let us note that this is a SUR model where the <em>G</em> equations 
are connected only through the error terms. This means that if we 
intervene a regressor in equation <em>g</em>, in any point is space, only 
the explained variable of the same equation <em>g</em> should react. The 
impacts do not spill over equations. Moreover, the impact of a regressor, 
intervened in the spatial unit <em>n</em>, will cross the borders of this 
spatial unit only if in the right hand side of the equation there are 
spatial lags of the explained variables or of the regressors. In other 
words, the <em>Indirect effect</em> is zero for the "sim" and "sem" models. 
<code>impacts</code> produces no output for these two models.
Lastly, it is clear that all the impacts are contemporaneous because the 
equations in the SUR model have no time dynamics.
</p>


<h3>Value</h3>

<p>A list of <em>G</em> objects either of class <code>lagImpact</code> 
or <code>WXImpact</code>.
</p>
<p>For each of the G objects of the list, if no simulation is carried out 
the object returned is a list with:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>direct</code> </td>
<td style="text-align: left;"> numeric vector </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>indirect</code> </td>
<td style="text-align: left;"> numeric vector </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>total</code> </td>
<td style="text-align: left;"> numeric vector </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>and a matching <code>Qres</code> list attribute if Q was given.
</p>
<p>On the other hand, for each of the G objects of the list, if 
simulation is carried out the object returned is a list with:
</p>

<table>
<tr>
<td style="text-align: left;">  
  <code>res</code> </td>
<td style="text-align: left;">	a list with three components as for the non-simulation 
  case, with a matching <code>Qres</code> list attribute if <code>Q</code> was given. </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>sres</code> </td>
<td style="text-align: left;"> a list with three <code>mcmc</code> matrices, for the direct, 
  indirect and total impacts with a matching <code>Qmcmc</code>list attribute 
  if <code>Q</code> was given. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;">
  Fernando Lopez  </td>
<td style="text-align: left;"> <a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Roman Minguez  </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Jesus Mur  </td>
<td style="text-align: left;"> <a href="mailto:jmur@unizar.es">jmur@unizar.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Bivand, R.S. and  Piras G. (2015). Comparing Implementations of 
Estimation Methods for Spatial Econometrics. <em>Journal of 
Statistical Software</em>, 63(18), 1-36. 
&lt;doi:	10.18637/jss.v063.i18&gt;
</p>
</li>
<li>
<p> LeSage, J., and Pace, R. K. (2009). <em>Introduction to spatial
econometrics</em>. Chapman and Hall/CRC.
</p>
</li>
<li>
<p> Lopez, F.A., Mur, J., and Angulo, A. (2014). Spatial model
selection strategies in a SUR framework. The case of regional
productivity in EU. <em>Annals of Regional Science</em>, 53(1), 197-220.
&lt;doi:10.1007/s00168-014-0624-2&gt;
</p>
</li>
<li>
<p> Minguez, R., Lopez, F.A. and Mur, J.  (2022).
spsur: An R Package for Dealing with Spatial 
Seemingly Unrelated Regression Models. 
<em>Journal of Statistical Software</em>, 
104(11), 1–43. &lt;doi:10.18637/jss.v104.i11&gt;
</p>
</li>
<li>
<p> Mur, J., Lopez, F., and Herrera, M. (2010). Testing for spatial
effects in seemingly unrelated regressions.
<em>Spatial Economic Analysis</em>, 5(4), 399-440.
&lt;doi:10.1080/17421772.2010.516443&gt;
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>impacts</code>, <code>spsurml</code>, 
<code>spsur3sls</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## VIP: The output of the whole set of the examples can be examined 
## by executing demo(demo_impactspsur, package="spsur")


###############################################
### PURE CROSS SECTIONAL DATA(G&gt;1; Tm=1) ######
###############################################

#### Example 1: Spatial Phillips-Curve. Anselin (1988, p. 203)
 rm(list = ls()) # Clean memory
 data(spc)
 lwspc &lt;- spdep::mat2listw(Wspc, style = "W")
 Tformula &lt;- WAGE83 | WAGE81 ~ UN83 + NMR83 + SMSA | UN80 + NMR80 + SMSA
## For SLM, SDM and SARAR models the output is a list of "lagImpact" objects
## See spatialreg::impacts for details.
 spcsur_slm &lt;-spsurml(formula = Tformula, data = spc, 
                      type = "slm", listw = lwspc)
 summary(spcsur_slm)
 impacts_slm &lt;- impactspsur(spcsur_slm, listw = lwspc, R = 1000)
## Impacts equation 1
 summary(impacts_slm[[1]], zstats = TRUE, short = TRUE)
## Impacts equation 2
 summary(impacts_slm[[2]], zstats = TRUE, short = TRUE)
## For SLX and SDEM models the output is a list of "WXImpact" objects
## See spatialreg::impacts for details.
## A SUR-SLX model
 spcsur_slx &lt;-spsurml(formula = Tformula, data = spc, 
                      type = "slx", listw = lwspc)
 summary(spcsur_slx)
 impacts_slx &lt;- impactspsur(spcsur_slx, listw = lwspc)
 summary(impacts_slx[[1]], zstats = TRUE, short = TRUE)
 summary(impacts_slx[[2]], zstats = TRUE, short = TRUE)

## A SUR-SDM model
 spcsur_sdm &lt;-spsurml(formula = Tformula, data = spc, 
                      type = "sdm", listw = lwspc)
 impacts_sdm &lt;- impactspsur(spcsur_sdm, listw = lwspc, R = 1000)
 summary(impacts_sdm[[1]], zstats = TRUE, short = TRUE)
 summary(impacts_sdm[[2]], zstats = TRUE, short = TRUE)
## A SUR-SDM model with different spatial lags in each equation
 TformulaD &lt;- ~ UN83 + NMR83 + SMSA | UN80
 spcsur_sdm2 &lt;-spsurml(formula = Tformula, data = spc, type = "sdm", 
                       listw = lwspc, Durbin = TformulaD)
 summary(spcsur_sdm2)                       
 impacts_sdm2 &lt;- impactspsur(spcsur_sdm2, listw = lwspc, R = 1000)
 summary(impacts_sdm2[[1]], zstats = TRUE, short = TRUE)
 summary(impacts_sdm2[[2]], zstats = TRUE, short = TRUE)
 ## A SUR-SLX model with different spatial lags in each equation
 spcsur_slx2 &lt;-spsurml(formula = Tformula, data = spc, 
                      type = "slx", listw = lwspc, Durbin = TformulaD)
 summary(spcsur_slx2)
 impacts_slx2 &lt;- impactspsur(spcsur_slx2, listw = lwspc)
 summary(impacts_slx2[[1]], zstats = TRUE, short = TRUE)
 summary(impacts_slx2[[2]], zstats = TRUE, short = TRUE)
 
# ####################################
# ######## G=1; Tm&gt;1               ###
# ####################################
#
 rm(list = ls()) # Clean memory
 data(NCOVR, package="spsur")
 nbncovr &lt;- spdep::poly2nb(NCOVR.sf, queen = TRUE)
### Some regions with no links...
 lwncovr &lt;- spdep::nb2listw(nbncovr, style = "W", zero.policy = TRUE)
 Tformula &lt;- HR80  | HR90 ~ PS80 + UE80 | PS90 + UE90
### A SUR-SLM model
 NCOVRSUR_slm &lt;-spsurml(formula = Tformula, data = NCOVR.sf, 
                        type = "slm", listw = lwncovr, 
                        method = "Matrix", zero.policy = TRUE, 
                        control = list(fdHess = TRUE))
 summary(NCOVRSUR_slm)
### Use of trW to compute.
 Wncovr &lt;- Matrix::Matrix(spdep::listw2mat(lwncovr))
 trwncovr &lt;- spatialreg::trW(Wncovr, type = "MC")
 impacts_NCOVRSUR_slm &lt;- impactspsur(NCOVRSUR_slm, tr = trwncovr,
                                 R = 1000)
 summary(impacts_NCOVRSUR_slm[[1]], zstats = TRUE, short = TRUE)
 summary(impacts_NCOVRSUR_slm[[2]], zstats = TRUE, short = TRUE)


</code></pre>


</div>