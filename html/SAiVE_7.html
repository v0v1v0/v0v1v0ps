<div class="container">

<table style="width: 100%;"><tr>
<td>hydroProcess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hydro-process a DEM</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Takes a digital elevation model and prepares it for hydrological analyses, such as basin delineation. Modifies the input DEM by breaching single cell pits/depressions and then breaching remaining depressions using a least cost algorithm (where cost is a function of distance plus elevation change to the DEM).
</p>
<p>If a streams layer is specified, a depression will be "burned-in" to the DEM along the stream path (after converting the vector file to a raster). This is very useful when trying to delineate basins with a poor resolution DEM. You can control the depth of this depression with parameter 'burn_dist'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hydroProcess(
  DEM,
  breach_dist,
  streams = NULL,
  burn_dist = 10,
  save_path = NULL,
  n.cores = NULL,
  force_update_wbt = FALSE,
  silent_wbt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DEM</code></td>
<td>
<p>The path to a digital elevation raster file with .tif extension, or a terra spatRaster object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breach_dist</code></td>
<td>
<p>The max radius (in raster cells) in which to search for a path to breach depressions, passed to <code>whitebox::wbt_breach_depressions_least_cost()</code>. This value should be high to ensure all depressions are breached, keeping in mind that greater distance = greater computing time. Note that the DEM is <em>not</em> breached in order of lowest elevation to greatest, nor is it breached sequentially (order is unknown, but the raster is presumably searched in some grid pattern for depressions). This means that flow paths may need to cross multiple depressions, especially in low relief areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>streams</code></td>
<td>
<p>Optionally, the path to the polylines shapefile or geopackage file containing streams, which can be used to improve hydrological accuracy when using poor quality DEMs but decent accuracy stream networks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_dist</code></td>
<td>
<p>The number of units (in DEM units) to use for burning-in the stream network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_path</code></td>
<td>
<p>An optional path in which to save the processed DEM. If left NULL will save it in the same directory as the provided DEM or, if the DEM is a terra object, return only terra objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>The maximum number of cores to use. Leave NULL to use all cores minus 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_update_wbt</code></td>
<td>
<p>Whitebox Tools is by default only downloaded if it cannot be found on the computer, and no check are performed to ensure the local version is current. Set to TRUE if you know that there is a new version and you would like to use it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent_wbt</code></td>
<td>
<p>Should Whitebox tools messages be suppressed? This function prints messages to the console already but these messages can be useful if you need to do some debugging.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Relies on two WhiteboxTools functions: <code>whitebox::wbt_fill_single_cell_pits()</code> and <code>whitebox::wbt_breach_depressions_least_cost()</code>. If the parameter <code>streams</code> is specified, a depression is burned into the DEM after running fill_single_cell_pits and before breaching depressions.
</p>


<h3>Value</h3>

<p>A hydro-processed DEM returned as a terra object and saved to disk if <code>save_path</code> is not null.
</p>


<h3>Author(s)</h3>

<p>Ghislain de Laplante (gdela069@uottawa.ca or ghislain.delaplante@yukon.ca)
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Running with terra objects:
res &lt;- hydroProcess(DEM = elev,
  breach_dist = 500,
  streams = streams,
  n.cores = 2)

terra::plot(res)

# Running with file paths:
res &lt;- hydroProcess(DEM = system.file("extdata/dem.tif", package = "SAiVE"),
  breach_dist = 500,
  streams = system.file("extdata/streams.gpkg", package = "SAiVE"),
  n.cores = 2)

terra::plot(res)


</code></pre>


</div>