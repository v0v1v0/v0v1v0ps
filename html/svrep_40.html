<div class="container">

<table style="width: 100%;"><tr>
<td>subsample_replicates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retain only a random subset of the replicates in a design</h2>

<h3>Description</h3>

<p>Randomly subsamples the replicates of a survey design object,
to keep only a subset. The scale factor used in estimation is increased
to account for the subsampling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">subsample_replicates(design, n_reps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>A survey design object, created with either the <code>survey</code> or <code>srvyr</code> packages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_reps</code></td>
<td>
<p>The number of replicates to keep after subsampling</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An updated survey design object, where only a random selection
of the replicates has been retained. The overall 'scale' factor for the design
(accessed with <code>design$scale</code>) is increased to account for the sampling of replicates.
</p>


<h3>Statistical Details</h3>

<p>Suppose the initial replicate design has <code class="reqn">L</code> replicates, with
respective constants <code class="reqn">c_k</code> for <code class="reqn">k=1,\dots,L</code> used to estimate variance
with the formula
</p>
<p style="text-align: center;"><code class="reqn">v_{R} = \sum_{k=1}^L c_k\left(\hat{T}_y^{(k)}-\hat{T}_y\right)^2</code>
</p>

<p>With subsampling of replicates, <code class="reqn">L_0</code> of the original <code class="reqn">L</code> replicates
are randomly selected, and then variances are estimated using the formula:
</p>
<p style="text-align: center;"><code class="reqn">v_{R} = \frac{L}{L_0} \sum_{k=1}^{L_0} c_k\left(\hat{T}_y^{(k)}-\hat{T}_y\right)^2</code>
</p>

<p>This subsampling is suggested for certain replicate designs in Fay (1989).
Kim and Wu (2013) provide a detailed theoretical justification and
also propose alternative methods of subsampling replicates.
</p>


<h3>References</h3>

<p>Fay, Robert. 1989.
"Theory And Application Of Replicate Weighting For Variance Calculations."
In, 495â€“500. Alexandria, VA: American Statistical Association.
http://www.asasrms.org/Proceedings/papers/1989_033.pdf
</p>
<p>Kim, J.K. and Wu, C. 2013.
"Sparse and Efficient Replication Variance Estimation for Complex Surveys."
<strong>Survey Methodology</strong>, Statistics Canada, 39(1), 91-120.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survey)
set.seed(2023)

# Create an example survey design object

  sample_data &lt;- data.frame(
    STRATUM = c(1,1,1,1,2,2,2,2),
    PSU     = c(1,2,3,4,5,6,7,8)
  )

  survey_design &lt;- svydesign(
    data = sample_data,
    strata = ~ STRATUM,
    ids = ~ PSU,
    weights = ~ 1
  )

  rep_design &lt;- survey_design |&gt;
    as_fays_gen_rep_design(variance_estimator = "Ultimate Cluster")

# Inspect replicates before subsampling

  rep_design |&gt; getElement("repweights")

# Inspect replicates after subsampling

  rep_design |&gt;
    subsample_replicates(n_reps = 4) |&gt;
    getElement("repweights")
</code></pre>


</div>