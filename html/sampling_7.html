<div class="container">

<table style="width: 100%;"><tr>
<td>calibev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibration estimator and its variance estimation</h2>

<h3>Description</h3>

<p>Computes the calibration estimator of the population total and its variance estimation using the residuals' method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calibev(Ys,Xs,total,pikl,d,g,q=rep(1,length(d)),with=FALSE,EPS=1e-6)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>vector of interest variable; its size is n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p>matrix of sample calibration variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>vector of population totals for calibration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikl</code></td>
<td>
<p>matrix of joint inclusion probabilities of the sample units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>vector of initial weights of the sample units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>vector of g-weights; its size is n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of positive values accounting for heteroscedasticity; its size is n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with</code></td>
<td>
<p>if TRUE, the variance estimation takes into account the initial weights d; otherwise, the final weights w=g*d are taken
into account; by default, its value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EPS</code></td>
<td>
<p>tolerance in checking the calibration; by default, its value is 1e-6.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If with is TRUE, the following formula is used
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Var}(\widehat{Ys})=\sum_{k\in s}\sum_{\ell\in s}((\pi_{k\ell}-\pi_k\pi_{\ell})/\pi_{k\ell})(d_ke_k)(d_\ell e_\ell)</code>
</p>

<p>else 
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Var}(\widehat{Ys})=\sum_{k\in s}\sum_{\ell\in s}((\pi_{k\ell}-\pi_k\pi_{\ell})/\pi_{k\ell})(w_ke_k)(w_\ell e_\ell)</code>
</p>

<p>where <code class="reqn">e_k</code> denotes the residual of unit k.
</p>


<h3>Value</h3>

<p>The function returns two values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cest</code></td>
<td>
<p>the calibration estimator,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evar</code></td>
<td>
<p>its estimated variance.</p>
</td>
</tr>
</table>
<h3>References</h3>

 
<p>Deville, J.-C. and Särndal, C.-E. (1992). Calibration estimators in survey sampling. <em>Journal of the American Statistical Association</em>, 87:376–382.<br>
Deville, J.-C., Särndal, C.-E., and Sautory, O. (1993). Generalized raking procedure in survey sampling. <em>Journal of the American Statistical Association</em>, 88:1013–1020.<br></p>


<h3>See Also</h3>

<p><code>calib</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example
############
# Example of g-weights (linear, raking, truncated, logit),
# with the data of Belgian municipalities as population.
# Firstly, a sample is selected by means of systematic sampling.
# Secondly, the g-weights are calculated.
data(belgianmunicipalities)
attach(belgianmunicipalities)
# matrix of calibration variables for the population
X=cbind(
Men03/mean(Men03),
Women03/mean(Women03),
Diffmen,
Diffwom,
TaxableIncome/mean(TaxableIncome),
Totaltaxation/mean(Totaltaxation),
averageincome/mean(averageincome),
medianincome/mean(medianincome))
# selection of a sample of size 200
# using systematic sampling
# the inclusion probabilities are proportional to the average income 
pik=inclusionprobabilities(averageincome,200)
N=length(pik)               # population size
s=UPsystematic(pik)         # draws a sample s using systematic sampling    
Xs=X[s==1,]                 # matrix of sample calibration variables
piks=pik[s==1]              # sample inclusion probabilities
n=length(piks)              # sample size
# vector of population totals of the calibration variables
total=c(t(rep(1,times=N))%*%X)  
g1=calib(Xs,d=1/piks,total,method="linear") # computes the g-weights
pikl=UPsystematicpi2(pik)   # computes the matrix of joint inclusion probabilities 
pikls=pikl[s==1,s==1]       # the same matrix for the units in the sample
Ys=Tot04[s==1]          # the variable of interest is Tot04 (sample level)
calibev(Ys,Xs,total,pikls,d=1/piks,g1,with=FALSE,EPS=1e-6)
detach(belgianmunicipalities)
</code></pre>


</div>