<div class="container">

<table style="width: 100%;"><tr>
<td>multi_tpfit_ils</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Iterated Least Squares Method for Multidimensional Model Parameters Estimation</h2>

<h3>Description</h3>

<p>The function estimates the model parameters of a <code class="reqn">d</code>-D continuous lag spatial Markov chain by the use of the iterated least squares and the bound-constrained Lagrangian methods. Transition rates matrices along axial directions and proportions of categories are computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multi_tpfit_ils(data, coords, max.dist = Inf, mpoints = 20,
                tolerance = pi/8, rotation = NULL, q = 10,
                echo = FALSE, ..., mtpfit)</code></pre>


<h3>Arguments</h3>










<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>a numerical value which defines the maximum lag value. It is <code>Inf</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpoints</code></td>
<td>
<p>a numerical value which defines the number of lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value for the tolerance angle (in radians). It is <code>pi/8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>a numerical vector of length <code class="reqn">d - 1</code> with rotation angles (in radians), in order to perform the main axes rotation. No rotation is performed by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a numerical value greater than one for a constant which controls the growth of the penalization term in the loss function. It is equal to <code>10</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echo</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, the function prints some information about the optimization. It is <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to pass to the function <code>nlminb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtpfit</code></td>
<td>
<p>an object <code>multi_tpfit</code> to optimize. If missing, the algorithm starts with null transition rates matrices.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code class="reqn">d</code>-D continuous-lag spatial Markov chain is probabilistic model which is developed by interpolation of the transition rate matrices computed for the main directions. It defines transition probabilities <code class="reqn">\Pr(Z(s + h) = z_k | Z(s) = z_j)</code> through
</p>
<p style="text-align: center;"><code class="reqn">\mbox{expm} (\Vert h \Vert R),</code>
</p>

<p>where <code class="reqn">h</code> is the lag vector and the entries of <code class="reqn">R</code> are ellipsoidally interpolated.
</p>
<p>The ellipsoidal interpolation is given by
</p>
<p style="text-align: center;"><code class="reqn">\vert r_{jk} \vert = \sqrt{\sum_{i = 1}^d \left( \frac{h_i}{\Vert h \Vert} r_{jk, \mathbf{e}_i} \right)^2},</code>
</p>

<p>where <code class="reqn">\mathbf{e}_i</code> is a standard basis for a <code class="reqn">d</code>-D space.
</p>
<p>If <code class="reqn">h_i &lt; 0</code> the respective entries <code class="reqn">r_{jk, \mathbf{e}_i}</code> are replaced by <code class="reqn">r_{jk, -\mathbf{e}_i}</code>, which is computed as
</p>
<p style="text-align: center;"><code class="reqn">r_{jk, -\mathbf{e}_i} = \frac{p_k}{p_j} \, r_{kj, \mathbf{e}_i},</code>
</p>

<p>where <code class="reqn">p_k</code> and <code class="reqn">p_j</code> respectively denote the proportions for the <code class="reqn">k</code>-th and <code class="reqn">j</code>-th categories. In so doing, the model may describe the anisotropy of the process.
</p>
<p>In particular, to estimate entries of transition rate matrices computed for the main axial directions, we need to minimize the discrepancies between the empirical transiograms (see <code>transiogram</code>) and the predicted transition probabilities.
</p>
<p>By the use of the iterated least squares, the diagonal entries of <code class="reqn">R</code> are constrained to be negative, while the off-diagonal transition rates are constrained to be positive. Further constraints are considered in order to obtain a proper transition rates matrix.
</p>


<h3>Value</h3>

<p>An object of the class <code>multi_tpfit</code> is returned. The function <code>print.multi_tpfit</code> is used to print the fitted model. The object is a list with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coordsnames</code></td>
<td>
<p>a character vector containing the name of each axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a list containing the transition rates matrices computed for each axial direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>a vector containing the proportions of each observed category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value which denotes the tolerance angle (in radians).</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>If the process is not stationary, the optimization algorithm does not converge.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>predict.multi_tpfit</code>, <code>print.multi_tpfit</code>, <code>image.multi_tpfit</code>, <code>tpfit_ils</code>, <code>transiogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Estimate the parameters of a 
# multidimensional MC model
multi_tpfit_ils(ACM$MAT3, ACM[, 1:3], 100)
</code></pre>


</div>