<div class="container">

<table style="width: 100%;"><tr>
<td>F3est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Empty Space Function of a Three-Dimensional Point Pattern
</h2>

<h3>Description</h3>

<p>Estimates the empty space function <code class="reqn">F_3(r)</code> from 
a three-dimensional point pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">F3est(X, ..., rmax = NULL, nrval = 128, vside = NULL,
              correction = c("rs", "km", "cs"),
              sphere = c("fudge", "ideal", "digital"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Three-dimensional point pattern (object of class <code>"pp3"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>

<p>Optional. Maximum value of argument <code class="reqn">r</code> for which
<code class="reqn">F_3(r)</code> will be estimated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrval</code></td>
<td>

<p>Optional. Number of values of <code class="reqn">r</code> for which
<code class="reqn">F_3(r)</code> will be estimated. A large value of <code>nrval</code>
is required to avoid discretisation effects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vside</code></td>
<td>

<p>Optional. 
Side length of the voxels in the discrete approximation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>Optional. Character vector specifying the edge correction(s)
to be applied. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sphere</code></td>
<td>

<p>Optional. Character string specifying how to calculate the
theoretical value of <code class="reqn">F_3(r)</code> for a Poisson
process. See Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a stationary point process <code class="reqn">\Phi</code> in three-dimensional
space, the empty space function is
</p>
<p style="text-align: center;"><code class="reqn">
    F_3(r) = P(d(0,\Phi) \le r)
  </code>
</p>

<p>where <code class="reqn">d(0,\Phi)</code> denotes the distance from a fixed
origin <code class="reqn">0</code> to the nearest point of <code class="reqn">\Phi</code>.
</p>
<p>The three-dimensional point pattern <code>X</code> is assumed to be a
partial realisation of a stationary point process <code class="reqn">\Phi</code>.
The empty space function of <code class="reqn">\Phi</code> can then be estimated using
techniques described in the References.
</p>
<p>The box containing the point
pattern is discretised into cubic voxels of side length <code>vside</code>.
The distance function <code class="reqn">d(u,\Phi)</code> is computed for
every voxel centre point
<code class="reqn">u</code> using a three-dimensional version of the distance transform
algorithm (Borgefors, 1986). The empirical cumulative distribution
function of these values, with appropriate edge corrections, is the
estimate of <code class="reqn">F_3(r)</code>.
</p>
<p>The available edge corrections are:
</p>

<dl>
<dt>
<code>"rs"</code>:</dt>
<dd>
<p>the reduced sample (aka minus sampling, border correction)
estimator (Baddeley et al, 1993)
</p>
</dd>
<dt>
<code>"km"</code>:</dt>
<dd>
<p>the three-dimensional version of the
Kaplan-Meier estimator (Baddeley and Gill, 1997)
</p>
</dd>
<dt>
<code>"cs"</code>:</dt>
<dd>
<p>the three-dimensional generalisation of
the Chiu-Stoyan or Hanisch estimator (Chiu and Stoyan, 1998).
</p>
</dd>
</dl>
<p>Alternatively <code>correction="all"</code> selects all options.
</p>
<p>The result includes a column <code>theo</code> giving the 
theoretical value of <code class="reqn">F_3(r)</code> for
a uniform Poisson process (Complete Spatial Randomness).
This value depends on the volume of the sphere of radius <code>r</code>
measured in the discretised distance metric.
The argument <code>sphere</code> determines how this will be calculated.
</p>

<ul>
<li>
<p>If <code>sphere="ideal"</code> the calculation will use the
volume of an ideal sphere of radius <code class="reqn">r</code> namely
<code class="reqn">(4/3) \pi r^3</code>. This is not recommended
because the theoretical values of <code class="reqn">F_3(r)</code>
are inaccurate.
</p>
</li>
<li>
<p>If <code>sphere="fudge"</code> then the volume of the ideal sphere will
be multiplied by 0.78, which gives the approximate volume
of the sphere in the discretised distance metric.
</p>
</li>
<li>
<p>If <code>sphere="digital"</code> then the volume of the sphere in the
discretised distance metric is computed exactly using another
distance transform. This takes longer to compute, but is exact.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A function value table (object of class <code>"fv"</code>) that can be
plotted, printed or coerced to a data frame containing the function values.
</p>


<h3>Warnings</h3>

<p>A small value of <code>vside</code> and a large value of <code>nrval</code>
are required for reasonable accuracy. 
</p>
<p>The default value of <code>vside</code> ensures that the total number of
voxels is <code>2^22</code> or about 4 million.
To change the default number of voxels, see
<code>spatstat.options("nvoxel")</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>
<p>and Rana Moyeed.
</p>


<h3>References</h3>

<p>Baddeley, A.J, Moyeed, R.A., Howard, C.V. and Boyde, A.
Analysis of a three-dimensional point pattern with replication.
<em>Applied Statistics</em> <b>42</b> (1993) 641–668.
</p>
<p>Baddeley, A.J. and Gill, R.D. (1997)
Kaplan-Meier estimators of interpoint distance
distributions for spatial point processes.
<em>Annals of Statistics</em> <b>25</b>, 263–292.
</p>
<p>Borgefors, G. (1986)
Distance transformations in digital images.
<em>Computer Vision, Graphics and Image Processing</em>
<b>34</b>, 344–371.
</p>
<p>Chiu, S.N. and Stoyan, D. (1998)
Estimators of distance distributions for spatial patterns.
<em>Statistica Neerlandica</em> <b>52</b>, 239–246.
</p>


<h3>See Also</h3>

<p><code>pp3</code> to create a three-dimensional point
pattern (object of class <code>"pp3"</code>).
</p>
<p><code>G3est</code>,
<code>K3est</code>,
<code>pcf3est</code> for other summary functions of
a three-dimensional point pattern.
</p>
<p><code>Fest</code> to estimate the empty space function of
point patterns in two dimensions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
  X &lt;- rpoispp3(42)
  Z &lt;- F3est(X)
  if(interactive()) plot(Z)
  
</code></pre>


</div>