<div class="container">

<table style="width: 100%;"><tr>
<td>fptsde1d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate densities and random generation for first passage time in 1-D SDE</h2>

<h3>Description</h3>

<p>Kernel density and random generation for first-passage-time (f.p.t) in 1-dim stochastic differential equations.</p>


<h3>Usage</h3>

<pre><code class="language-R">fptsde1d(object, ...)
dfptsde1d(object, ...)

## Default S3 method:
fptsde1d(object, boundary, ...)
## S3 method for class 'fptsde1d'
summary(object, digits=NULL, ...)
## S3 method for class 'fptsde1d'
mean(x, ...)
## S3 method for class 'fptsde1d'
Median(x, ...)
## S3 method for class 'fptsde1d'
Mode(x, ...)
## S3 method for class 'fptsde1d'
quantile(x, ...)
## S3 method for class 'fptsde1d'
kurtosis(x, ...)
## S3 method for class 'fptsde1d'
skewness(x, ...)
## S3 method for class 'fptsde1d'
min(x, ...)
## S3 method for class 'fptsde1d'
max(x, ...)
## S3 method for class 'fptsde1d'
moment(x, ...)
## S3 method for class 'fptsde1d'
cv(x, ...)

## Default S3 method:
dfptsde1d(object, ...)
## S3 method for class 'dfptsde1d'
plot(x, hist=FALSE, ...)						  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>snssde1d</code> for <code>fptsde1d</code>, and <code>fptsde1d</code> for <code>dfptsde1d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>an <code>expression</code> of a constant or time-dependent boundary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object inheriting from class <code>dfptsde1d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code>truehist</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially further arguments for (non-default) methods, such as <code>density</code> for <code>dfptsde1d</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fptsde1d</code> returns a random variable <code class="reqn">\tau_{(X(t),S(t))}</code> "first passage time", is defined as : 
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \geq S(t) \},\quad if \quad X(t_{0}) &lt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \leq S(t) \},\quad if \quad X(t_{0}) &gt; S(t_{0})</code>
</p>

<p><img src="../help/figures/fpt1d.png" alt="fig07"></p>
<p>And <code>dfptsde1d</code> returns a kernel density approximation for <code class="reqn">\tau_{(X(t),S(t))}</code> "first passage time".
with <code class="reqn">S(t)</code> is through a continuous boundary (barrier).
</p>
<p><img src="../help/figures/dfpt1d.png" alt="fig08"></p>
<p>An overview of this package, see <code>browseVignettes('Sim.DiffProc')</code> for more informations. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfptsde1d()</code></td>
<td>
<p>gives the density estimate of fpt.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fptsde1d()</code></td>
<td>
<p>generates random of fpt.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Argyrakisa, P. and G.H. Weiss (2006).
A first-passage time problem for many random walkers.
<em>Physica A</em>. <b>363</b>, 343–347.
</p>
<p>Aytug H., G. J. Koehler (2000). 
New stopping criterion for genetic algorithms. 
<em>European Journal of Operational Research</em>, <b>126</b>, 662–674.
</p>
<p>Boukhetala, K. (1996)
Modelling and simulation of a dispersion pollutant with attractive centre.
ed by Computational Mechanics Publications, Southampton ,U.K and Computational Mechanics Inc, Boston, USA, 245–252.
</p>
<p>Boukhetala, K. (1998a). 
Estimation of the first passage time distribution for a simulated diffusion process.
<em>Maghreb Math.Rev</em>, <b>7</b>(1), 1–25.
</p>
<p>Boukhetala, K. (1998b). 
Kernel density of the exit time in a simulated diffusion. 
<em>les Annales Maghrebines De L ingenieur</em>, <b>12</b>, 587–589.
</p>
<p>Ding, M. and G. Rangarajan. (2004). 
First Passage Time Problem: A Fokker-Planck Approach. 
<em>New Directions in Statistical Physics</em>. ed by L. T. Wille. Springer. 31–46.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2008).
First-passage-time location function: Application to determine first-passage-time densities in diffusion processes.
<em>Computational Statistics and Data Analysis</em>. <b>52</b>, 4132–4146.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2012). 
An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. 
<em>Applied Mathematics and Computation</em>, <b>218</b>, 8408–8428.
</p>
<p>Gardiner, C. W. (1997). 
<em>Handbook of Stochastic Methods</em>.
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code>fptsde2d</code> and <code>fptsde3d</code> simulation fpt for 2 and 3-dim SDE.
</p>
<p><code>FPTL</code> for computes values of the first passage time location (FPTL) function, and <code>Approx.fpt.density</code> 
for approximate first-passage-time (f.p.t.) density in package "fptdApprox". 
</p>
<p><code>GQD.TIpassage</code> for compute the First Passage Time Density of a GQD With Time Inhomogeneous Coefficients in package "DiffusionRgqd".
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Example 1: Ito SDE
## dX(t) = -4*X(t) *dt + 0.5*dW(t)
## S(t) = 0 (constant boundary)
set.seed(1234)

# SDE 1d
f &lt;- expression( -4*x )
g &lt;- expression( 0.5 )
mod &lt;- snssde1d(drift=f,diffusion=g,x0=2,M=1000)

# boundary
St &lt;- expression(0) 

# random
out &lt;- fptsde1d(mod, boundary=St)
out
summary(out)
# density approximate
den &lt;- dfptsde1d(out)
den
plot(den)

## Example 2: Stratonovich SDE
## dX(t) = 0.5*X(t)*t *dt + sqrt(1+X(t)^2) o dW(t)
## S(t) = -0.5*sqrt(t) + exp(t^2) (time-dependent boundary)
set.seed(1234)

# SDE 1d
f &lt;- expression( 0.5*x*t )
g &lt;- expression( sqrt(1+x^2) )
mod2 &lt;- snssde1d(drift=f,diffusion=g,x0=2,M=1000,type="srt")

# boundary
St &lt;- expression(-0.5*sqrt(t)+exp(t^2))

# random
out2 &lt;- fptsde1d(mod2,boundary=St)
out2
summary(out2)
# density approximate
plot(dfptsde1d(out2,bw='ucv'))


## Example 3: fptsde1d vs fptdApproximate
## Not run: 
f &lt;- expression( -0.5*x+0.5*5 )
g &lt;- expression( 1 )
St &lt;- expression(5+0.25*sin(2*pi*t)) 
mod &lt;- snssde1d(drift=f,diffusion=g,boundary=St,x0=3,T=10,N=10^4,M =10000)
mod

# random
out3 &lt;- fptsde1d(mod,boundary=St)
out3
summary(out3)
# density approximate: 
library("fptdApprox")
# Under `fptdApprox':
# Define the diffusion process and give its transitional density:
OU &lt;- diffproc(c("alpha*x + beta","sigma^2",
"dnorm((x-(y*exp(alpha*(t-s)) - beta*(1 - exp(alpha*(t-s)))/alpha))/
(sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha))),0,1)/
(sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha)))",
"pnorm(x, y*exp(alpha*(t-s)) - beta*(1 - exp(alpha*(t-s)))/alpha,
sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha)))"))
# Approximate the first passgage time density for OU, starting in X_0 = 3
# passing through 5+0.25*sin(2*pi*t) on the time interval [0,10]:
res &lt;- Approx.fpt.density(OU, 0, 10, 3,"5+0.25*sin(2*pi*t)", list(alpha=-0.5,beta=0.5*5,sigma=1))

##
plot(dfptsde1d(out3,bw='ucv'),main = 'fptsde1d vs fptdApproximate')
lines(res$y~res$x, type = 'l',lwd=2)
legend('topright', lty = c('solid', 'dashed'), col = c(1, 2),
       legend = c('fptdApproximate', 'fptsde1d'), lwd = 2, bty = 'n')


## End(Not run)

</code></pre>


</div>