<div class="container">

<table style="width: 100%;"><tr>
<td>PenalisedOpenMx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalised Structural Equation Model</h2>

<h3>Description</h3>

<p>Runs penalised Structural Equation Modelling using implementations from
<code>OpenMx</code> functions (for <code>PenalisedOpenMx</code>),
or using series of penalised regressions with <code>glmnet</code>
(for <code>PenalisedLinearSystem</code>). The function
<code>PenalisedLinearSystem</code> does not accommodate latent variables.
These functions are not using stability.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PenalisedOpenMx(
  xdata,
  adjacency,
  penalised = NULL,
  residual_covariance = NULL,
  Lambda,
  ...
)

PenalisedLinearSystem(xdata, adjacency, penalised = NULL, Lambda = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>matrix with observations as rows and variables as columns.
Column names must be defined and in line with the row and column names of
<code>adjacency</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjacency</code></td>
<td>
<p>binary adjacency matrix of the Directed Acyclic Graph
(transpose of the asymmetric matrix A in Reticular Action Model notation).
The row and column names of this matrix must be defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalised</code></td>
<td>
<p>optional binary matrix indicating which coefficients are
regularised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual_covariance</code></td>
<td>
<p>binary and symmetric matrix encoding the nonzero
entries in the residual covariance matrix (symmetric matrix S in Reticular
Action Model notation). By default, this is the identity matrix (no
residual covariance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>matrix of parameters controlling the level of sparsity. Only
the minimum, maximum and length are used in <code>PenalisedOpenMx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to <code>OpenMx</code> functions (for
<code>PenalisedOpenMx</code>), or <code>glmnet</code> (for
<code>PenalisedLinearSystem</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with: </p>
<table>
<tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>
<p>matrix of binary selection status. Rows
correspond to different regularisation parameters. Columns correspond to
different parameters to estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_full</code></td>
<td>
<p>matrix of model
coefficients. Rows correspond to different regularisation parameters.
Columns correspond to different parameters to estimated.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Jacobucci R, Grimm KJ, McArdle JJ (2016).
“Regularized structural equation modeling.”
<em>Structural equation modeling: a multidisciplinary journal</em>, <b>23</b>(4), 555–566.
<a href="https://doi.org/10.1080/10705511.2016.1154793">doi:10.1080/10705511.2016.1154793</a>.
</p>


<h3>See Also</h3>

<p><code>SelectionAlgo</code>, <code>VariableSelection</code>,
<code>OpenMxMatrix</code>,
<code>LinearSystemMatrix</code>
</p>
<p>Other underlying algorithm functions: 
<code>CART()</code>,
<code>ClusteringAlgo()</code>,
<code>PenalisedGraphical()</code>,
<code>PenalisedRegression()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Data simulation
pk &lt;- c(3, 2, 3)
dag &lt;- LayeredDAG(layers = pk)
theta &lt;- dag
theta[2, 4] &lt;- 0
set.seed(1)
simul &lt;- SimulateStructural(theta = theta, pk = pk, output_matrices = TRUE)

# Running regularised SEM (OpenMx)
if (requireNamespace("OpenMx", quietly = TRUE)) {
  mysem &lt;- PenalisedOpenMx(
    xdata = simul$data, adjacency = dag,
    Lambda = seq(1, 10, 1)
  )
  OpenMxMatrix(vect = mysem$selected[3, ], adjacency = dag)
}

# Running regularised SEM (glmnet)
mysem &lt;- PenalisedLinearSystem(
  xdata = simul$data, adjacency = dag
)
LinearSystemMatrix(vect = mysem$selected[20, ], adjacency = dag)

</code></pre>


</div>