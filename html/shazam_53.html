<div class="container">

<table style="width: 100%;"><tr>
<td>minNumSeqMutationsTune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter tuning for minNumSeqMutations</h2>

<h3>Description</h3>

<p><code>minNumSeqMutationsTune</code> helps with picking a threshold value for <code>minNumSeqMutations</code>
in createMutabilityMatrix by tabulating the number of 5-mers for which 
mutability would be computed directly or inferred at various threshold values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">minNumSeqMutationsTune(mutCount, minNumSeqMutationsRange)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mutCount</code></td>
<td>
<p>a <code>vector</code> of length 1024 returned by 
createMutabilityMatrix with <code>numSeqMutationsOnly=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumSeqMutationsRange</code></td>
<td>
<p>a number or a vector indicating the value or the range of values 
of <code>minNumSeqMutations</code> to try.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At a given threshold value of <code>minNumSeqMutations</code>, for a given 5-mer,
if the total number of mutations is greater than the threshold, mutability 
is computed directly. Otherwise, mutability is inferred.
</p>


<h3>Value</h3>

<p>A 2xn <code>matrix</code>, where n is the number of trial values of <code>minNumSeqMutations</code>
supplied in <code>minNumSeqMutationsRange</code>. Each column corresponds to a value
in <code>minNumSeqMutationsRange</code>. The rows correspond to the number of 5-mers
for which mutability would be computed directly (<code>"measured"</code>) and inferred
(<code>"inferred"</code>), respectively.
</p>


<h3>References</h3>


<ol><li>
<p>  Yaari G, et al. Models of somatic hypermutation targeting and substitution based 
on synonymous mutations from high-throughput immunoglobulin sequencing data. 
Front Immunol. 2013 4(November):358.
</p>
</li></ol>
<h3>See Also</h3>

<p>See argument <code>numSeqMutationsOnly</code> in createMutabilityMatrix 
for generating the required input <code>vector</code> <code>mutCount</code>. 
See argument <code>minNumSeqMutations</code> in createMutabilityMatrix
for what it does.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Subset example data to one isotype and sample as a demo
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call == "IGHA" &amp; sample_id == "-1h")
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=75)
# Create model using only silent mutations
sub &lt;- createSubstitutionMatrix(db, sequenceColumn="sequence_alignment",
                                germlineColumn="germline_alignment_d_mask",
                                vCallColumn="v_call", 
                                model="s", multipleMutation="independent",
                                returnModel="5mer", numMutationsOnly=FALSE,
                                minNumMutations=20)

# Count the number of mutations in sequences containing each 5-mer
mutCount &lt;- createMutabilityMatrix(db, substitutionModel = sub,
                                   sequenceColumn="sequence_alignment",
                                   germlineColumn="germline_alignment_d_mask",
                                   vCallColumn="v_call",
                                   model="s", multipleMutation="independent",
                                   numSeqMutationsOnly=TRUE)

# Tune minNumSeqMutations
minNumSeqMutationsTune(mutCount, seq(from=100, to=300, by=50))
                                      
</code></pre>


</div>