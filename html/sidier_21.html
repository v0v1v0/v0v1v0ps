<div class="container">

<table style="width: 100%;"><tr>
<td>get.majority.taxo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get majority taxonomy for a sequence</h2>

<h3>Description</h3>

<p>Given filtered taxonomy of multiple BLAST hits, provides the consensus taxonomy for every query sequence</p>


<h3>Usage</h3>

<pre><code class="language-R">get.majority.taxo(filtered.taxo,verbose=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filtered.taxo</code></td>
<td>
<p>a data.frame containing (at least) the output of a BLAST analysis and the filtered taxonomy for every subject sequence. This format is produced by <code>filter.whole.taxo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical, if TRUE details on the calculation are shown.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The expected input data.frame must contain information about filtered taxonomy for every subject sequence and a unique code for every query sequence. 
</p>
<p>Nonmeaningful names (including "unidentified", "sp", "low_pident") are coerced to "Uninformative".
</p>
<p>The output dataframe includes a column with a summary of the alternative classifications found for taxonomy at every level. For example: "10|10|10|10|10|10|9+1" means that all 10 matches have identical taxonomy up to genus, but two species has been identified, being the taxonomy of 9 of the subject sequences identical and different from the remaining subject.
</p>


<h3>Value</h3>

<p>a data.frame with the followin columns: "qseqid", the unique identifier of every original query sequence; seven columns containing the filtered taxonomy ("kingdom.final", "phylum.final", "class.final", "order.final", "family.final", "genus.final", and "species.final"); "values": The frequency of the different taxonomical names provides for every level, separated by "|" (see details).  
</p>


<h3>Author(s)</h3>

<p>A. J. Mu√±oz-Pajares</p>


<h3>See Also</h3>

<p><code>filter.whole.taxo,assign.whole.taxo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data(ex_BLAST)
# TAXO &lt;- assign.whole.taxo(ex_BLAST)
# FILT_TAXO &lt;- filter.whole.taxo(TAXO)
# MAJ_TAXO &lt;- get.majority.taxo(TAXO)
</code></pre>


</div>