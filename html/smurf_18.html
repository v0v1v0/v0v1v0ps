<div class="container">

<table style="width: 100%;"><tr>
<td>p</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define Individual Subpenalties for a Multi-Type Regularized GLM</h2>

<h3>Description</h3>

<p>Function used to define regularization terms in a <code>glmsmurf</code> model formula.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p(pred1, pred2 = NULL, pen = "lasso", refcat = NULL, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred1</code></td>
<td>
<p>Name of the predictor used in the regularization term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred2</code></td>
<td>
<p>Either <code>NULL</code> (default) meaning that only one predictor is used in the regularization term, or the name of the second predictor that is used in a 2D Fused Lasso regularization term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>Type of penalty for this predictor, one of 
</p>

<ul>
<li> <p><code>"none"</code> (no penalty),
</p>
</li>
<li> <p><code>"lasso"</code> (Lasso),
</p>
</li>
<li> <p><code>"grouplasso"</code> (Group Lasso),
</p>
</li>
<li> <p><code>"flasso"</code> (Fused Lasso), 
</p>
</li>
<li> <p><code>"gflasso"</code> (Generalized Fused Lasso),
</p>
</li>
<li> <p><code>"2dflasso"</code> (2D Fused Lasso),
</p>
</li>
<li> <p><code>"ggflasso"</code> (Graph-Guided Fused Lasso).
</p>
</li>
</ul>
<p>Default is <code>"lasso"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refcat</code></td>
<td>
<p>Reference level when <code>pred1</code> is a factor and <code>pen</code> is <code>"none"</code>, <code>"flasso"</code>, <code>"gflasso"</code>, or <code>"ggflasso"</code>;
otherwise <code>refcat</code> is ignored. Default is <code>NULL</code> which means that the first level of <code>pred1</code> is used as the reference level (if <code>refcat</code> is not ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Group to which the predictor belongs, only used for a Group Lasso penalty. 
Default is <code>NULL</code> which means that predictor does not belong to a group.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Predictors with no penalty, a Lasso penalty or a Group Lasso penalty should be numeric or a factor which can be non-numeric.  
Predictors with a Fused Lasso, Generalized Fused Lasso, Graph-Guided Fused Lasso or 2D Fused Lasso penalty should be given as a factor 
which can also be non-numeric. When a predictor is given as a factor, there cannot be any unused levels.
</p>
<p>For a predictor with a Fused Lasso penalty, the levels should be ordered from smallest to largest. 
The first level will be the reference level, but this can be changed using the <code>refcat</code> argument.
</p>
<p>When <code>lambda * lambda1 &gt; 0</code> or <code>lambda * lambda2 &gt; 0</code> in <code>glmsmurf</code>, no reference level is used
for the Fused Lasso, Generalized Fused Lasso and Graph-Guided Fused Lasso penalties, and <code>refcat</code> will hence be ignored.
</p>
<p>If <code>pred2</code> is different from <code>NULL</code>, <code>pen</code> should be set to <code>"2dflasso"</code>, and vice versa.
Note that there cannot be any unused levels in the interaction between <code>pred1</code> and <code>pred2</code>.
</p>
<p>When adding an interaction between <code>pred1</code> and <code>pred2</code> with a 2D Fused Lasso penalty, the 1D effects
should also be present in the model and the reference categories for the 1D predictors need to be the respective first levels. 
The reference level for the 2D predictor will then be the 2D level where it least one of the 1D components is equal to the 1D reference levels. 
It is also allowed to add binned factors, of predictors
that are included in the model, in the interaction. They should have the original predictor name + '.binned' as predictor names.
For example: the original predictors 'age' and 'power' are included in the model and
the interaction of 'age.binned' and 'power.binned' can also be present in the model formula.
</p>
<p>An overview of the different penalty types and their usage can be found in the package vignette.
</p>


<h3>See Also</h3>

<p><code>glmsmurf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Munich rent data from catdata package
data("rent", package = "catdata")

# The considered predictors are the same as in 
# Gertheiss and Tutz (Ann. Appl. Stat., 2010).
# Response is monthly rent per square meter in Euro

# Urban district in Munich
rent$area &lt;- as.factor(rent$area)

# Decade of construction
rent$year &lt;- as.factor(floor(rent$year / 10) * 10)

# Number of rooms
rent$rooms &lt;- as.factor(rent$rooms)

# Quality of the house with levels "fair", "good" and "excellent"
rent$quality &lt;- as.factor(rent$good + 2 * rent$best)
levels(rent$quality) &lt;- c("fair", "good", "excellent")

# Floor space divided in categories (0, 30), [30, 40), ...,  [130, 140)
sizeClasses &lt;- c(0, seq(30, 140, 10))
rent$size &lt;- as.factor(sizeClasses[findInterval(rent$size, sizeClasses)])

# Is warm water present?
rent$warm &lt;- factor(rent$warm, labels = c("yes", "no"))

# Is central heating present?
rent$central &lt;- factor(rent$central, labels = c("yes", "no"))

# Does the bathroom have tiles?
rent$tiles &lt;- factor(rent$tiles, labels = c("yes", "no"))

# Is there special furniture in the bathroom?
rent$bathextra &lt;- factor(rent$bathextra, labels = c("no", "yes"))

# Is the kitchen well-equipped?
rent$kitchen &lt;- factor(rent$kitchen, labels = c("no", "yes"))



# Create formula with 'rentm' as response variable,
# 'area' with a Generalized Fused Lasso penalty,
# 'year', 'rooms', 'quality' and 'size' with Fused Lasso penalties 
# where the reference category for 'year' is changed to 2000,
# 'warm' and 'central' are in one group for the Group Lasso penalty,
# 'tiles' and 'bathextra' are not regularized and 
# 'kitchen' has a Lasso penalty
formu &lt;- rentm ~ p(area, pen = "gflasso") + 
  p(year, pen = "flasso", refcat = 2000) + p(rooms, pen = "flasso") + 
  p(quality, pen = "flasso") + p(size, pen = "flasso") +
  p(warm, pen = "grouplasso", group = 1) + p(central, pen = "grouplasso", group = 1) + 
  p(tiles, pen = "none") + bathextra + 
  p(kitchen, pen = "lasso")


# Fit a multi-type regularized GLM using the SMuRF algorithm.
# We use standardization adaptive penalty weights based on an initial GLM fit.
munich.fit &lt;- glmsmurf(formula = formu, family = gaussian(), data = rent, 
                       pen.weights = "glm.stand", lambda = 0.1)

# Model summary
summary(munich.fit) 
</code></pre>


</div>