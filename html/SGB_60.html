<div class="container">

<table style="width: 100%;"><tr>
<td>SGButil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computation of scales and z-vectors
</h2>

<h3>Description</h3>

<p>bval computes the scale for each observed composition from the parameters and auxiliary variables for that observation. <br>
zval computes the z-vector for each observed composition, i.e. the transform that is Dirichlet distributed under the  SGB model for the observed composition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bval(D, x, d, V)
zval(u, x, d, V)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
 
<p>number of parts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of parameters (<code>shape1</code>,<code>coefi</code>,<code>shape2</code>) where
<code>shape1</code> is the overall shape, <code>coefi</code> is the vector of regression coefficients (see <code>initpar.SGB</code>) and <code>shape2</code> the vector of <code class="reqn">D</code> Dirichlet shape parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
 
<p><code class="reqn">(n \times m)</code> - data matrix of explanatory variables (variables corresponding to <code>coefi</code>); <code class="reqn">n</code>: sample size, <code class="reqn">m</code>: number of auxiliary variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p><code class="reqn">(n \times D)</code> - data matrix of compositions (independent variables); <code class="reqn">D</code>: number of parts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
 
<p><code class="reqn">D \times (D-1)</code> - matrix specifying the full rank transformation of log(parts) into log-ratios
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Graf (2017), Equation (8), or the vignette "SGB regression", Equation (1).
</p>


<h3>Value</h3>

<p> transformed composition of length <code class="reqn">D</code>.
</p>


<h3>References</h3>

<p>Graf, M. (2017). A distribution on the simplex of the Generalized Beta type. <em>In J. A. Martin-Fernandez (Ed.), Proceedings CoDaWork 2017</em>, University of Girona (Spain), 71-90.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Example with 2 compositions
u &lt;- matrix(c(0.2,0.4,0.5,0.5,0.3,0.2),nrow=2,byrow=TRUE)
u
D &lt;- NCOL(u)  # number of parts

## auxiliary variable
d &lt;- matrix(c(3.2,4.6),ncol=1)

## log-ratio transformation
V &lt;- matrix(c(c(1,-1,0)/sqrt(2),c(1,1,-2)/sqrt(6)),ncol=2)

## vector of parameters:
shape1 &lt;- 2.00
coefi &lt;- c(-0.78,  0.06,  0.96, -0.11)
shape2 &lt;- c(1.80,  3.10,  4.00) 
x &lt;-c(shape1, coefi, shape2)
bval(D,x,d,V)
zval(u,x,d,V)
</code></pre>


</div>