<div class="container">

<table style="width: 100%;"><tr>
<td>calculate.D2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the "D2" statistic</h2>

<h3>Description</h3>

<p>This is a utility function used to calculate the "D2" statistic for pooling
test statistics across multiple imputations. This function is called by
several functions used for <code>lavaan.mi</code> objects, such as
<code>lavTestLRT.mi</code>, <code>lavTestWald.mi</code>, and
<code>lavTestScore.mi</code>. But this function can be used for any general
scenario because it only requires a vector of <code class="reqn">\chi^2</code> statistics (one
from each imputation) and the degrees of freedom for the test statistic.
See Li, Meng, Raghunathan, &amp; Rubin (1991) and Enders (2010, chapter 8) for
details about how it is calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate.D2(w, DF = 0L, asymptotic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p><code>numeric</code> vector of Wald <code class="reqn">\chi^2</code> statistics. Can also
be Wald <em>z</em> statistics, which will be internally squared to make
<code class="reqn">\chi^2</code> statistics with one <em>df</em> (must set <code>DF = 0L</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DF</code></td>
<td>
<p>degrees of freedom (<em>df</em>) of the <code class="reqn">\chi^2</code> statistics.
If <code>DF = 0L</code> (default), <code>w</code> is assumed to contain <em>z</em>
statistics, which will be internally squared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymptotic</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code> (default), the pooled test
will be returned as an <em>F</em>-distributed statistic with numerator
(<code>df1</code>) and denominator (<code>df2</code>) degrees of freedom.
If <code>TRUE</code>, the pooled <em>F</em> statistic will be multiplied by its
<code>df1</code> on the assumption that its <code>df2</code> is sufficiently large
enough that the statistic will be asymptotically <code class="reqn">\chi^2</code> distributed
with <code>df1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>numeric</code> vector containing the test statistic, <em>df</em>,
its <em>p</em> value, and 2 missing-data diagnostics: the relative invrease
in variance (RIV, or average for multiparameter tests: ARIV) and the
fraction missing information (FMI = ARIV / (1 + ARIV)).
</p>


<h3>Author(s)</h3>

<p>Terrence D. Jorgensen (University of Amsterdam;
<a href="mailto:TJorgensen314@gmail.com">TJorgensen314@gmail.com</a>)
</p>


<h3>References</h3>

<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. New
York, NY: Guilford.
</p>
<p>Li, K.-H., Meng, X.-L., Raghunathan, T. E., &amp; Rubin, D. B. (1991).
Significance levels from repeated <em>p</em>-values with multiply-imputed
data. <em>Statistica Sinica, 1</em>(1), 65â€“92. Retrieved from
<a href="https://www.jstor.org/stable/24303994">https://www.jstor.org/stable/24303994</a>
</p>


<h3>See Also</h3>

<p><code>lavTestLRT.mi</code>, <code>lavTestWald.mi</code>,
<code>lavTestScore.mi</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate a vector of chi-squared values, just for example
DF &lt;- 3 # degrees of freedom
M &lt;- 20 # number of imputations
CHI &lt;- rchisq(M, DF)

## pool the "results"
calculate.D2(CHI, DF) # by default, an F statistic is returned
calculate.D2(CHI, DF, asymptotic = TRUE) # asymptotically chi-squared

## generate standard-normal values, for an example of Wald z tests
Z &lt;- rnorm(M)
calculate.D2(Z) # default DF = 0 will square Z to make chisq(DF = 1)
## F test is equivalent to a t test with the denominator DF


</code></pre>


</div>