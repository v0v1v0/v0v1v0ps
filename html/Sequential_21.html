<div class="container">

<table style="width: 100%;"><tr>
<td>Performance.Threshold.Binomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical Performance and Alpha Spending For User-defined Signaling Threshold With Binomial Data.</h2>

<h3>Description</h3>

<p>The function <code>Performance.Threshold.Binomial</code> calculates power, expected time to signal, expected sample size and alpha spending associated to any user-specified signaling threshold, flat or non-flat, for continuous or group sequential analysis with binomial data.
The user can select the scale for the signaling threshold among MaxSPRT, Pocock, OBrien-Fleming, or Wang-Tsiatis test statistics. Alternatively, the threshold can be informed also in the scale of the binomial data.</p>


<h3>Usage</h3>

<pre><code class="language-R">Performance.Threshold.Binomial(N,CV.lower="n",CV.upper="n",z="n",p="n",
GroupSizes="n",Tailed="upper",Statistic=c("MaxSPRT", "Pocock",
"OBrien-Fleming", "Wang-Tsiatis","Cases"),Delta="n",RR)
      </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The upper limit on the sample size (length of surveillance) expressed in terms of the total number of events (cases plus controls). There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV.lower</code></td>
<td>
<p>Signaling threshold for evidence of "RR&lt;1". It is given in the scale of the selected test statistic infomed in "Statistic". There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV.upper</code></td>
<td>
<p>Signaling threshold for evidence of "RR&gt;1". It is given in the scale of the selected test statistic infomed in "Statistic". There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>For a matched case-control analysis, z is the number of controls matched to each case under the null hypothesis. There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability of having a case under the null hypothesis. If just a single number is given, then it will be used as a constant probability for all groups. Otherwise, the dimension of p must coincide with the dimension of GroupSizes. There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GroupSizes</code></td>
<td>
<p>Vector with the total number of events (cases+controls) between two looks at the data with regular and irregular group sizes. Important: Must sums up N. For continuos sequential analysis, specify GroupSizes=1. There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tailed</code></td>
<td>
<p>Tailed="upper" (default) for H0:RR&lt;=1, and Tailed="lower" for H0:RR&gt;=1 or Tailed="two" for H0:RR=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Statistic</code></td>
<td>
<p>The test statistic scale used for "CV.lower" and "CV.upper". There is no default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>Parameter needed when "Statistic=Wang-Tsiatis" is selected. Must be a number in the (0, 0.5] interval. There is no default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>Vector of relative risks for performance calculation. There is no default value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For continuous and group sequential analysis with binomial data, alpha spending for
user-specified thresholds are calculated with <code>Performance.Threshold.Binomial</code>.
</p>
<p><code>N</code> must be a positive integer defining the maximum length of surveillance. To avoid very large computation times,
we suggest not using values greater than 1000.
</p>
<p>For two-tailed testing (<code>Tailed="two"</code>), both lower and upper signaling thresholds must be informed through
<code>CV.lower</code> and <code>CV.upper</code>. If the user
desires a constant threshold (critical value) in the scale of a test statistic, then a single number can be informed.
For time-variable (non-constant) thresholds, the length of <code>CV.upper</code> and <code>CV.lower</code> must coincide with the length of <code>GroupSizes</code>.
</p>
<p><code>z</code> is a vector of positive numbers representing the matching ratios for each test (group). If a single number is given, then it will be used as a constant
matching ratio for all tests (groups). Otherwise, the dimension of <code>z</code> must coincide with the dimension of <code>GroupSizes</code>.
<code>z</code> represents the number of controls matched to each case. For example, if there are 3 controls matched to each case, <code>z</code>=3. 
In a self-control analysis, z is the ratio of the control interval to the risk interval.
For example, if the risk interval is 2 days long and the control interval is 7 days long, <code>z</code>=7/2.
In terms of <code>p</code>, the binomial probability under the null hypothesis, <code>p=1/(1+z)</code>, or equivalently, <code>z=1/p-1</code>.
</p>
<p>Alternatively, instead of <code>z</code> the user can specify <code>p</code> directly.
Note that only one of these inputs, <code>z</code> or <code>p</code>, has to be specified, but if both are entered the code will only work if <code>z</code>
and <code>p</code> are such that <code>p=1/(1+z)</code>. Otherwise, an error message will appear to remind that such condition must be complied.
</p>
<p>With <code>GroupSizes</code> the user informs the sample size of each subsequent test. Therefore, only positive integers are accepted in <code>GroupSizes</code>. 
</p>
<p>The input <code>Statistic</code> specifies the scale selected by the user to inform <code>CV.lower</code> and <code>cvs.upper</code>among the classic methods:
MaxSPRT (Kulldorf et al., 2011), Pocock (Pocock, 1977), OBrien-Fleming (O'Brien and Fleming, 1979), or Wang-Tsiatis (Jennison and Turnbull, 2000). 
For <code>Statistic="Wang-Tsiatis"</code>, the user has to choose a number in the (0, 0.5] interval for <code>Delta</code>.
</p>
<p>Important: for time-variable matching ratios (i.e. when <code>z</code> or <code>p</code> changes from a test to another), only the "Statistic=Cases" option works.
This is because the test statistic options are non-monotone with the number of cumulative cases under a variable <code>p</code> or <code>z</code> situation.
</p>
<p>For <code>RR</code> the user must specify the target relative risks for calculation of the statistical performance measures to be delivered in the output.
It can be a vector of positive number or a single number. 
</p>
<p>For details about the algorithm used to calculate the critical value, see the paper by Silva (2018).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>AlphaSpend</code></td>
<td>
<p>The alpha spending associated to the user-specified threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Performance</code></td>
<td>
<p>A matrix with the following three performance measures for each target RR: statistical power, expected time to signal and expected sample size.</p>
</td>
</tr>
</table>
<h3>Acknowledgements</h3>

<p>Development of the Performance.Threshold.Binomial function was funded by:<br>
-	National Institute of General Medical Sciences, NIH, USA, through grant number R01GM108999 (v2.0,2.0 to 3.1).<br>
-	Federal University of Ouro Preto (UFOP), through contract under internal UFOP's resolution CEPE 4600 (v2.0 to 3.1).<br><br></p>


<h3>See also</h3>

<p><code>Performance.AlphaSpend.Binomial</code>: for calculating signaling threshold for user-specified alpha spending with binomial data.<br><code>CV.Binomial</code>: for calculating Wald-type signaling thresholds for continuous sequential analysis with binomial data.<br><code>Analyze.Binomial</code>: for performing sequential analysis with group, continuous or unpredictable sequential fashion with binomial data.
</p>


<h3>Author(s)</h3>

<p>Ivair Ramos Silva, Martin Kulldorff.
</p>


<h3>References</h3>

<p>Jennison C, Turnbull B. (2000). Group Sequential Methods with Applications to Clinical Trials, London: Chapman and Hall/CRC.
</p>
<p>Kulldorff M, Davis RL, Kolczak M, Lewis E, Lieu T, Platt R. (2011). A Maximized Sequential Probability Ratio Test for Drug and Safety Surveillance. <em>Sequential Analysis</em>, <b>30</b>: 58–78.
</p>
<p>O'Brien PC, Fleming TR. (1979). A multiple testing procedure for clinical trials. Biometrics. 35:549–556.
</p>
<p>Pocock SJ. (1977).Group sequential methods in the design and analysis of clinical trials. Biometrika. 64:191–199.
</p>
<p>Silva IR. (2018). Type I Error Probability Spending for Post-Market Drug and Vaccine Safety Surveillance with Binomial Data. Statistics in Medicine, 15;37(1), 107-118.
</p>
<p>Silva IR, Kulldorff M. (2015). Continuous versus Group Sequential Analysis for Vaccine and Drug Safety Surveillance. Biometrics, 71 (3), 851–858.
</p>
<p>Silva IR, Maro J, Kulldorff M. (2021), Exact sequential test for clinical trials and post-market drug and vaccine safety surveillance with Poisson and binary data. Statistics in Medicine, DOI: 10.1002/sim.9094.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Performance and Alpha spending of a four-group sequential
#  analysis with threshold informed in the scale of the
#  binomial data, i.e. Statistic="Cases". 
#  The analysis is for a maximum sample size of 50 events under 
#  upper-tailed testing, that is, H0:RR&lt;=1, with irregular group
#  sizes of 12, 25, 35, and 45. 
#  The matching ratio also changes in time with z= 1, 1.5, 2, 1.3.
#  The statistical performance is evaluated for RR= 1.2, 1.5, 2:

# res&lt;- Performance.Threshold.Binomial(N=50,CV.upper=c(12,25,35,45),
# z=c(1,1.5,2,1.3),GroupSizes=c(15,15,10,10),Tailed="upper",
# Statistic="Cases", RR=c(1.2,1.5,2))

</code></pre>


</div>