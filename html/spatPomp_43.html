<div class="container">

<table style="width: 100%;"><tr>
<td>enkf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Ensemble Kalman filter (EnKF)</h2>

<h3>Description</h3>

<p>A function to perform filtering using the ensemble Kalman filter of Evensen, G. (1994).
This function is generalized to allow for an measurement covariance matrix that varies over time.
This is useful if the measurement model varies with the state.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'spatPomp'
enkf(data, Np, ..., verbose = getOption("verbose", FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>spatPomp</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Np</code></td>
<td>
<p>The number of Monte Carlo particles used to approximate the filter distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments can be used to replace model components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if <code>TRUE</code>, messages updating the user on progress will be printed to the console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class ‘enkfd_spatPomp’ that contains the estimate of the log likelihood
(via the <code>loglik</code> attribute), algorithmic parameters used to run <code>enkf()</code>. Also included
are estimated filter means, prediction means and forecasts that are generated during an <code>enkf()</code> run.
</p>


<h3>References</h3>

<p>G. Evensen. Sequential data assimilation with a nonlinear quasi-geostrophic model using Monte Carlo methods to forecast error statistics. <em>Journal of Geophysical Research: Oceans</em> <b>99</b>, 10143–10162, 1994.
</p>
<p>G. Evensen. <em>Data assimilation: the ensemble Kalman filter</em>. Springer-Verlag, 2009.
</p>
<p>J.L. Anderson. An Ensemble Adjustment Kalman Filter for Data Assimilation. <em>Monthly Weather Review</em> <b>129</b>, 2884–2903, 2001.
</p>


<h3>See Also</h3>

<p><code>ienkf()</code>, <code>igirf</code>, <code>iubf</code>, <code>ibpf</code>
</p>
<p>Other likelihood evaluation algorithms: 
<code>abf()</code>,
<code>abfir()</code>,
<code>bpfilter()</code>,
<code>girf()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Complete examples are provided in the package tests
## Not run: 
# Create a simulation of a Brownian motion
b &lt;- bm(U=2, N=5)

# Run EnKF
enkfd_bm &lt;- enkf(b, Np = 20)

# Get a likelihood estimate
logLik(enkfd_bm)

## End(Not run)
</code></pre>


</div>