<div class="container">

<table style="width: 100%;"><tr>
<td>anova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Anova Tables</h2>

<h3>Description</h3>

<p>Computes analysis of deviance for objects of class 'maxstab' or 'spatgev'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'maxstab'
anova(object, object2, method = "RJ", square = "chol", ...)
## S3 method for class 'spatgev'
anova(object, object2, method = "RJ", square = "chol", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, object2</code></td>
<td>
<p>Two objects of class 'maxstab' or 'spatgev'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string. Must be one of "CB" or "RJ" for the
Chandler and Bate or the Rotnitzky and Jewell approaches
respectively. See function
<code>profile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>square</code></td>
<td>
<p>The choice for the matrix square root. This is only
useful for the 'CB' method. Must be one of 'chol' (Cholesky) or
'svd' (Singular Value Decomposition).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other options to be passed to the <code>anova</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As ”maxstab” objects are fitted using pairwise likelihood, the model
is misspecified. As a consequence, the likelihood ratio statistic is
no longer <code class="reqn">\chi^2</code> distributed. To compute the anova
table, we use the methodology proposed by Rotnitzky and Jewell to
adjust the distribution of the likelihood ratio statistic.
</p>


<h3>Value</h3>

<p>This function returns an object of class anova. These objects
represent analysis-of-deviance tables. 
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Chandler, R. E. and Bate, S. (2007) Inference for clustered data using
the independence loglikelihood <em>Biometrika</em>, <b>94</b>,
167–183.
</p>
<p>Rotnitzky, A. and Jewell, N. (1990) Hypothesis testing of regression
parameters in semiparametric generalized linear models for cluster
correlated data. <em>Biometrika</em> <b>77</b>, 485–497.
</p>


<h3>See Also</h3>

<p><code>fitmaxstab</code>, <code>fitspatgev</code>,
<code>profile</code>, <code>TIC</code></p>


<h3>Examples</h3>

<pre><code class="language-R">##Define the coordinates of each location
n.site &lt;- 30
locations &lt;- matrix(rnorm(2*n.site, sd = sqrt(.2)), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(50, locations, cov.mod = "gauss", cov11 = 100, cov12 =
25, cov22 = 220)

##Now define the spatial model for the GEV parameters
param.loc &lt;- -10 + 2 * locations[,2]
param.scale &lt;- 5 + 2 * locations[,1] + locations[,2]^2
param.shape &lt;- rep(0.2, n.site)

##Transform the unit Frechet margins to GEV 
for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], param.loc[i], param.scale[i],
param.shape[i])

##Define three models for the GEV margins to be fitted
loc.form &lt;- loc ~ lat
scale.form &lt;- scale ~ lon + I(lat^2)
shape.form &lt;- shape ~ lon

M0 &lt;- fitspatgev(data, locations, loc.form, scale.form, shape.form)
M1 &lt;- fitspatgev(data, locations, loc.form, scale.form, shape.form,
shapeCoeff2 = 0)

##Model selection
anova(M0, M1)
anova(M0, M1, method = "CB", square = "svd")
</code></pre>


</div>