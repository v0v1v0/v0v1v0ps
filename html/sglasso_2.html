<div class="container">

<table style="width: 100%;"><tr>
<td>fglasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>L1-penalized Factorial Graphical Lasso Model</h2>

<h3>Description</h3>

<p>Fit the weight l1-penlized factorial dynamic Gaussian Graphical Model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fglasso(S, model, tp, p, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the empirical variance/covariance matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a list or a matrix used to specify the factorial dynamic Gaussian Graphical Model (see Details);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp</code></td>
<td>
<p>number of time points;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of random variables observed for each time point;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>sglasso</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The factorial dynamic Gaussian Graphical Model (Abbruzzo et al., 2015) is a special kind of <em>RCON(V, E)</em> model (Hojsgaard, et al.,2008) proposed to study dynamic networks. Let <code class="reqn">X_t = (X_{it},\ldots,X_{it})'</code> be a <code class="reqn">p</code>-dimensional random variable at time <code class="reqn">t</code>. Assuming that <code class="reqn">X = (X'_1,\ldots,X'_T)</code> follows a multivariate normal distribution, the concentration matrix <code class="reqn">K</code> has the following block structure
</p>
<p style="text-align: center;"><code class="reqn">
K = \left(
\begin{array}{cccc}
K_{1,1} &amp; K_{1,2} &amp; \ldots &amp; K_{1,T}\\
K_{2,1} &amp; K_{2,2} &amp; \ldots &amp; K_{2,T}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
K_{T,1} &amp; K_{T,2} &amp; \ldots &amp; K_{T,T}
\end{array}\right),
</code>
</p>

<p>where <code class="reqn">K_{t,t}</code> give information about the conditinal independence structure among the <code class="reqn">p</code> random variables at time <code class="reqn">t</code>, and <code class="reqn">K_{t,t + h}</code> give information about the conditional independence structure between <code class="reqn">X_t</code> and <code class="reqn">X_{t + h}</code>. An interpretation of the elements of the submatrices <code class="reqn">K_{t,t + h}</code> brings to the notion of natural structure, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
K_{t,t + h} = \left(
\begin{array}{cccc}
k_{1,1}^{t,t+h} &amp; 0 &amp; \ldots &amp; 0\\
0 &amp; k_{2,2}^{t,t+h} &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; \ldots &amp; k_{p,p}^{t,t+h}
\end{array}\right) + \left(
\begin{array}{cccc}
0 &amp; k_{1,2}^{t,t+h} &amp; \ldots &amp; k_{1,p}^{t,t+h}\\
k_{2,1}^{t,t+h} &amp; 0 &amp; \ldots &amp; 0\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
k_{p,1}^{t,t+h} &amp; k_{p,2}^{t,t+h} &amp; \ldots &amp; 0
\end{array}\right).
</code>
</p>

<p>The entries of the first matrix are called <b>self-self conditinal dependences</b> at temporal lag <code class="reqn">h</code> and represents the (negative) self-similarity of a given random variable across different time points. The entries of the second matrix are the <b>conditional dependence</b> among the <code class="reqn">p</code> random variables. To make the interpretation of the results more relevant and, at the same time, reduce the number of parameters, the authors propose the following equality constraints:
</p>

<table>
<tr>
<td style="text-align: center;">
</td>
<td style="text-align: left;"> <code class="reqn">k_{i,i}^{t,t+h}</code> </td>
<td style="text-align: center;"> effect </td>
<td style="text-align: center;"> <code>R</code> code </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> <code class="reqn">k_{i,j}^{t,t+h}</code> </td>
<td style="text-align: center;"> effect </td>
<td style="text-align: center;"> <code>R</code> code </td>
</tr>
<tr>
<td style="text-align: center;">
i.	</td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: center;"> zero </td>
<td style="text-align: center;"> <code>"."</code> </td>
<td style="text-align: center;"> iv. </td>
<td style="text-align: left;"> <code class="reqn">0</code> </td>
<td style="text-align: center;"> zero </td>
<td style="text-align: center;"> <code>"."</code> </td>
</tr>
<tr>
<td style="text-align: center;">
ii.	</td>
<td style="text-align: left;"> <code class="reqn">s^h</code> </td>
<td style="text-align: center;"> costant </td>
<td style="text-align: center;"> <code>"c"</code> </td>
<td style="text-align: center;"> ii. </td>
<td style="text-align: left;"> <code class="reqn">n^h</code> </td>
<td style="text-align: center;"> costant </td>
<td style="text-align: center;"> <code>"c"</code> </td>
</tr>
<tr>
<td style="text-align: center;">
iii.</td>
<td style="text-align: left;"> <code class="reqn">s^h_i</code> </td>
<td style="text-align: center;"> unit </td>
<td style="text-align: center;"> <code>"u"</code> </td>
<td style="text-align: center;"> iii. </td>
<td style="text-align: left;"> <code class="reqn">n^h_i</code> </td>
<td style="text-align: center;"> unit </td>
<td style="text-align: center;"> <code>"u"</code> </td>
</tr>
<tr>
<td style="text-align: center;">
iv.	</td>
<td style="text-align: left;"> <code class="reqn">s^{t,h}</code> </td>
<td style="text-align: center;"> time </td>
<td style="text-align: center;"> <code>"t"</code> </td>
<td style="text-align: center;"> iv. </td>
<td style="text-align: left;"> <code class="reqn">n^{t,h}</code> </td>
<td style="text-align: center;"> time </td>
<td style="text-align: center;"> <code>"t"</code> </td>
</tr>
<tr>
<td style="text-align: center;">
v.	</td>
<td style="text-align: left;"> <code class="reqn">s^{t,h}_i</code> </td>
<td style="text-align: center;"> interaction </td>
<td style="text-align: center;"> <code>"ut"</code> </td>
<td style="text-align: center;"> v. </td>
<td style="text-align: left;"> <code class="reqn">n^{t,h}_{i,j}</code> </td>
<td style="text-align: center;"> interaction </td>
<td style="text-align: center;"> <code>"ut"</code>
</td>
</tr>
</table>
<p>Argument <code>model</code> is used to specify the restrinctions previously describted. This argument can be a named list or a matrix with dimension <code class="reqn">nlag\times 2</code>, where <code class="reqn">nlag\le\code{tp}</code>. To gain more insight, suppose that we want to model only the sub-matrices <code class="reqn">K_{t,t}</code> and <code class="reqn">K_{t,t+1}</code>, i.e., the sub-matrices corresponding to the temporal lag zero and one. A possible <code>R code</code> is<br></p>
<p><code>model.mat &lt;- matrix("", nrow = 2, ncol = 2)</code><br><code>rownames(model.mat) &lt;- c("lag0", "lag1")</code><br><code>colnames(model.mat) &lt;- c("s", "n")</code><br><code>model.mat[1, ] &lt;- c("c", "ut")</code><br><code>model.mat[2, ] &lt;- c("t", ".")</code><br></p>
<p>In this example we are modelling the diagonal elements of the sub-matrices <code class="reqn">K_{t,t}</code> with the constant effect while the off-diagonal elements are modelled by the interaction effect. In the same way, the diagonal elements of the sub-matrices <code class="reqn">K_{t,t+1}</code> are modelled by the time effect while the remaning elements are equal to zero. The <code>fglasso</code> function passes the matrix <code>model.mat</code> to the internal function <code>fglasso_model2mask</code>, i.e.,<br></p>
<p><code>mask &lt;- fglasso_model2mask(model.mat, tp = 3, p = 3)</code><br></p>
<p>which returns the mask used in <code>sglasso</code> to fit the specified factorial dynamic Gaussian Graphical model. The same model can be specified by the following named list<br></p>
<p><code>model.list &lt;- list(lag0 = c(s = "c", n = "ut"), lag1 = c(s = "t", n = "."))</code><br></p>
<p>See the example below for more details.
</p>


<h3>Value</h3>

<p><code>fglasso</code> returns an obejct with S3 class <code>"sglasso"</code>. See the corresponding manual for more details.
</p>


<h3>Author(s)</h3>

<p>Luigi Augugliaro<br> 
Maintainer: Luigi Augugliaro <a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>
</p>


<h3>References</h3>

<p>Wit, E. C. and Abbruzzo, A.(2015) Dynamic factorial graphical models for dynamic networks. <em>Network Science</em>, Vol. <b>3(1)</b>, 37– 57
<br></p>
<p>Abbruzzo, A., Augugliaro, L., Mineo, A.M. and Wit, E.C. (2014) Cyclic coordinate for penalized Gaussian Graphical Models with symmetry restrictions. In <em>Proceeding of COMPSTAT 2014 - 21th International Conference on Computational Statistics</em>. Geneva, August 19-24, 2014.
<br></p>
<p>Hojsgaard, S. and Lauritzen, S.L. (2008) Graphical gaussian models with edge and vertex symmetries. <em>J. Roy. Statist. Soc. Ser. B.</em>, Vol. <b>70(5)</b>, 1005–1027.
</p>


<h3>See Also</h3>

<p><code>sglasso</code> function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######################
# fglasso solution path
#######################
N &lt;- 50
tp &lt;- 3
p &lt;- 3
X &lt;- matrix(rnorm(N * p * tp), N, tp * p)
S &lt;- crossprod(X) / N
model &lt;- list(lag0 = c(s = "c", n = "ut"), lag1 = c(s = "t", n = "."))
out.fglasso &lt;- fglasso(S = S, model = model, tp = tp, p = p)
out.fglasso
</code></pre>


</div>