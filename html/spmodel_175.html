<div class="container">

<table style="width: 100%;"><tr>
<td>spcov_initial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a spatial covariance parameter initial object</h2>

<h3>Description</h3>

<p>Create a spatial covariance parameter initial object that specifies
initial and/or known values to use while estimating spatial covariance parameters
with <code>splm()</code>, <code>spglm()</code>, <code>spautor()</code>, or <code>spgautor()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spcov_initial(spcov_type, de, ie, range, extra, rotate, scale, known)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spcov_type</code></td>
<td>
<p>The spatial covariance function type. Available options include
<code>"exponential"</code>, <code>"spherical"</code>, <code>"gaussian"</code>,
<code>"triangular"</code>, <code>"circular"</code>, <code>"cubic"</code>,
<code>"pentaspherical"</code>, <code>"cosine"</code>, <code>"wave"</code>,
<code>"jbessel"</code>, <code>"gravity"</code>, <code>"rquad"</code>,
<code>"magnetic"</code>, <code>"matern"</code>, <code>"cauchy"</code>, <code>"pexponential"</code>,
<code>"car"</code>, <code>"sar"</code>, and <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>de</code></td>
<td>
<p>The spatially dependent (correlated) random error variance. Commonly referred to as
a partial sill.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ie</code></td>
<td>
<p>The spatially independent (uncorrelated) random error variance. Commonly referred to as
a nugget.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>The correlation parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>
<p>An extra covariance parameter used when <code>spcov_type</code> is
<code>"matern"</code>, <code>"cauchy"</code>, <code>"pexponential"</code>, <code>"car"</code>, or
<code>"sar"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>Anisotropy rotation parameter (from 0 to <code class="reqn">\pi</code> radians).
Not used if <code>spcov_type</code> is <code>"car"</code> or <code>"sar"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Anisotropy scale parameter (from 0 to 1).
Not used if <code>spcov_type</code> is <code>"car"</code> or <code>"sar"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known</code></td>
<td>
<p>A character vector indicating which spatial covariance parameters are to be
assumed known. The value <code>"given"</code> is shorthand for assuming all
spatial covariance parameters given to <code>spcov_initial()</code> are assumed known.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>spcov_initial</code> list is later passed to <code>splm()</code>, <code>spglm()</code>, <code>spautor()</code>, or <code>spgautor()</code>.
<code>NA</code> values can be given for <code>ie</code>, <code>rotate</code>, and <code>scale</code>, which lets
these functions find initial values for parameters that are sometimes
otherwise assumed known (e.g., <code>rotate</code> and <code>scale</code> with <code>splm()</code> and <code>spglm()</code>
and <code>ie</code> with <code>spautor()</code> and <code>spgautor()</code>).
The spatial covariance functions can be generally expressed as
<code class="reqn">de * R + ie * I</code>, where <code class="reqn">de</code> is <code>de</code> above, <code class="reqn">R</code>
is a matrix that controls the spatial dependence structure among observations,
<code class="reqn">h</code>, <code class="reqn">ie</code> is <code>ie</code> above, and <code class="reqn">I</code> is and identity matrix.
Note that <code class="reqn">de</code> and <code class="reqn">ie</code> must be non-negative while <code class="reqn">range</code>
must be positive, except when <code>spcov_type</code> is <code>car</code> or <code>sar</code>,
in which case <code class="reqn">range</code> must be between the reciprocal of the maximum
eigenvalue of <code>W</code> and the reciprocal of the minimum eigenvalue of
<code>W</code>. Parametric forms for <code class="reqn">R</code> are given below, where <code class="reqn">\eta = h / range</code>:
</p>

<ul>
<li>
<p> exponential: <code class="reqn">exp(- \eta )</code>
</p>
</li>
<li>
<p> spherical: <code class="reqn">(1 - 1.5\eta + 0.5\eta^3) * I(h &lt;= range)</code>
</p>
</li>
<li>
<p> gaussian: <code class="reqn">exp(- \eta^2 )</code>
</p>
</li>
<li>
<p> triangular: <code class="reqn">(1 - \eta) * I(h &lt;= range)</code>
</p>
</li>
<li>
<p> circular: <code class="reqn">(1 - (2 / \pi) * (m * sqrt(1 - m^2) + sin^{-1}(m))) * I(h &lt;= range), m = min(\eta, 1)</code>
</p>
</li>
<li>
<p> cubic: <code class="reqn">(1 - 7\eta^2 + 8.75\eta^3 - 3.5\eta^5 + 0.75\eta^7) * I(h &lt;= range)</code>
</p>
</li>
<li>
<p> pentaspherical: <code class="reqn">(1 - 1.875\eta + 1.25\eta^3 - 0.375\eta^5) * I(h &lt;= range)</code>
</p>
</li>
<li>
<p> cosine: <code class="reqn">cos(\eta)</code>
</p>
</li>
<li>
<p> wave: <code class="reqn">sin(\eta) / \eta * I(h &gt; 0) + I(h = 0)</code>
</p>
</li>
<li>
<p> jbessel: <code class="reqn">Bj(h * range)</code>, Bj is Bessel-J function
</p>
</li>
<li>
<p> gravity: <code class="reqn">(1 + \eta^2)^{-0.5}</code>
</p>
</li>
<li>
<p> rquad: <code class="reqn">(1 + \eta^2)^{-1}</code>
</p>
</li>
<li>
<p> magnetic: <code class="reqn">(1 + \eta^2)^{-1.5}</code>
</p>
</li>
<li>
<p> matern: <code class="reqn">2^{1 - extra}/ \Gamma(extra) * \alpha^{extra} * Bk(\alpha, extra)</code>, <code class="reqn">\alpha = (2extra * \eta)^{0.5}</code>, Bk is Bessel-K function wit  order <code class="reqn">1/5 \le extra \le 5</code>
</p>
</li>
<li>
<p> cauchy: <code class="reqn">(1 + \eta^2)^{-extra}</code>, <code class="reqn">extra &gt; 0</code>
</p>
</li>
<li>
<p> pexponential: <code class="reqn">exp(h^{extra}/range)</code>, <code class="reqn">0 &lt; extra \le 2</code>
</p>
</li>
<li>
<p> car: <code class="reqn">(I - range * W)^{-1} * M</code>, weights matrix <code class="reqn">W</code>,
symmetry condition matrix <code class="reqn">M</code>, observations with no neighbors
are given a unique variance
parameter called <code class="reqn">extra</code>, <code class="reqn">extra \ge 0</code>.
</p>
</li>
<li>
<p> sar: <code class="reqn">[(I - range * W)(I - range * W)^T]^{-1}</code>,
weights matrix <code class="reqn">W</code>, <code class="reqn">^T</code> indicates matrix transpose,
observations with no neighbors are given a unique variance
parameter called <code class="reqn">extra</code>, <code class="reqn">extra \ge 0</code>.
</p>
</li>
<li>
<p> none: <code class="reqn">0</code>
</p>
</li>
</ul>
<p>All spatial covariance functions are valid in one spatial dimension. All
spatial covariance functions except <code>triangular</code> and <code>cosine</code> are
valid in two dimensions.
</p>
<p>When the spatial covariance function is <code>car</code> or <code>sar</code>, <code>extra</code>
represents the variance parameter for the observations in <code>W</code> without
at least one neighbor (other than itself) â€“ these are called unconnected
observations. <code>extra</code> is only used if there is at least one unconnected
observation.
</p>


<h3>Value</h3>

<p>A list with two elements: <code>initial</code> and <code>is_known</code>.
<code>initial</code> is a named numeric vector indicating the spatial covariance parameters
with specified initial and/or known values. <code>is_known</code> is a named
numeric vector indicating whether the spatial covariance parameters in
<code>initial</code> are known or not. The class of the list
matches the value given to the <code>spcov_type</code> argument.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># known de value 1 and initial range value 0.4
spcov_initial("exponential", de = 1, range = 0.4, known = c("de"))
# known ie value 0 and known range value 1
spcov_initial("gaussian", ie = 0, range = 1, known = c("given"))
# ie given NA
spcov_initial("car", ie = NA)
</code></pre>


</div>