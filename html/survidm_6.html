<div class="container">

<table style="width: 100%;"><tr>
<td>CIF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric estimation of the Cumulative Incident Functions
in the illness-death model</h2>

<h3>Description</h3>

<p>This function is used to obtain nonparametric estimates of
the cumulative incidence probabilities in the illness-death model. They
represent the probability of one individual's being or having been in
state j at time t.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CIF(
  formula,
  s,
  data,
  conf = FALSE,
  n.boot = 199,
  conf.level = 0.95,
  z.value,
  bw = "dpik",
  window = "gaussian",
  method.weights = "NW",
  cluster = FALSE,
  ncores = NULL,
  presmooth = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>
object as the response on the left of the <code>~</code> operator and, if desired,
a term on the right. The term may be a qualitative or quantitative variable.
Without covariates, the right hand side should be <code>~ 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The first time for obtaining estimates for the cumulative
incidence functions. If missing, 0 will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>The number of bootstrap replicates to compute the variance
of the estimator. Default is 199.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.value</code></td>
<td>
<p>The value of the covariate on the right hand side of formula
at which the cumulative incidence probabilities are computed. For quantitative
covariates, i.e. of class integer and numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.
Use <code>"dpik"</code> for the <span class="pkg">KernSmooth</span> package based selector or <code>"np"</code>
for the <code>'npudensbw'</code> function of the <span class="pkg">np</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options. Defaults to <code>"gaussian"</code>
where the gaussian density kernel will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are <code>"NW"</code> for the Nadaraya-Watson weights and <code>"LL"</code>
for local linear weights. Defaults to <code>"NW"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A logical value. If <code>TRUE</code> (default), the bootstrap procedure
for the confidence intervals is parallelized. Note that there are
cases (e.g., a low number of bootstrap repetitions) that <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> will gain in
performance through serial computation. <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing,
it does not worth parallelize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used in
the parallelized procedure. If <code>NULL</code> (default), the number of cores
to be used is equal to the number of cores of the machine - 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>presmooth</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the presmoothed landmark
estimator of the cumulative incidence function is computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Possible options for argument window are <code>"gaussian"</code>,
<code>"epanechnikov"</code>, <code>"tricube"</code>, <code>"boxcar"</code>,
<code>"triangular"</code>, <code>"quartic"</code> or <code>"cosine"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"survIDM"</code> and one of the following
two classes: <code>"CIF"</code> (Cumulative Incidence Function), and
<code>"cifIPCW"</code> (Inverse Probability of Censoring Weighting for the Cumulative Incidence Function). Objects are implemented as a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>data.frame with estimates of the cumulative incidence probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>data.frame with the confidence intervals of the cumulative
incidence probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Level of confidence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The first time for obtaining estimates for the cumulative
incidence probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The time for obtaining the estimates of cumulative incidence probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>logical; if <code>FALSE</code> (default) the pointwise confidence
bands are not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callp</code></td>
<td>
<p>The expression of the estimated probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nlevels</code></td>
<td>
<p>The number of levels of the covariate. Provides important
information when the covariate at the right hand side of formula
is of class factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>The levels of the qualitative covariate
(if it is of class factor) on the right hand side of formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>A call object.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>Geskus, R.B. (2011). Cause-specific cumulative incidence estimation
and the fine and gray model under both left truncation and right censoring.
Biometrics, 67, 39â€“49.
</p>
<p>Kalbeisch, J. D. and Prentice R. L. (1980) The statistical analysis of
failure time data. John Wiley &amp; Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Cumulative Incidence Function (CIF)
res &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
conf = FALSE)
res
summary(res, time=365*1:7)
plot(res, ylim=c(0, 0.6))

res01 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
conf = FALSE, presmooth = TRUE)
res01
summary(res01, time=365*1:7)
plot(res01, ylim=c(0, 0.6))


# CIF for those in State 1 at time s=365, Y(s)=0
res1 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
s = 365, conf = FALSE)
summary(res1, time=365*1:7)
plot(res1, ylim=c(0, 0.6))


# Conditional CIF (with a factor)
res2 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ factor(sex),
data = colonIDM, s = 365, conf = FALSE)
summary(res2, time=365*1:5)
plot(res2)

res2.1 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ factor(sex),  #new
data = colonIDM, s = 365, conf = FALSE, presmooth = TRUE)
summary(res2.1, time=365*1:5)
plot(res2.1)


# Conditional CIF (with continuous covariate)
res3 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM,
z.value = 56, conf = FALSE)
summary(res3, time=365*1:6)
plot(res3)

</code></pre>


</div>