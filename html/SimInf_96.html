<div class="container">

<table style="width: 100%;"><tr>
<td>SISe3_sp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an <code>SISe3_sp</code> model</h2>

<h3>Description</h3>

<p>Create an <code>SISe3_sp</code> model to be used by the simulation
framework.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SISe3_sp(
  u0,
  tspan,
  events = NULL,
  phi = NULL,
  upsilon_1 = NULL,
  upsilon_2 = NULL,
  upsilon_3 = NULL,
  gamma_1 = NULL,
  gamma_2 = NULL,
  gamma_3 = NULL,
  alpha = NULL,
  beta_t1 = NULL,
  beta_t2 = NULL,
  beta_t3 = NULL,
  beta_t4 = NULL,
  end_t1 = NULL,
  end_t2 = NULL,
  end_t3 = NULL,
  end_t4 = NULL,
  distance = NULL,
  coupling = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u0</code></td>
<td>
<p>A <code>data.frame</code> with the initial state in each node,
i.e., the number of individuals in each compartment in each
node when the simulation starts (see ‘Details’). The
parameter <code>u0</code> can also be an object that can be coerced
to a <code>data.frame</code>, e.g., a named numeric vector will be
coerced to a one row <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tspan</code></td>
<td>
<p>A vector (length &gt;= 1) of increasing time points
where the state of each node is to be returned. Can be either
an <code>integer</code> or a <code>Date</code> vector. A <code>Date</code>
vector is coerced to a numeric vector as days, where
<code>tspan[1]</code> becomes the day of the year of the first year
of <code>tspan</code>. The dates are added as names to the numeric
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>a <code>data.frame</code> with the scheduled events, see
<code>SimInf_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A numeric vector with the initial environmental
infectious pressure in each node. Will be repeated to the
length of nrow(u0). Default is NULL which gives 0 in each
node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upsilon_1</code></td>
<td>
<p>Indirect transmission rate of the environmental
infectious pressure in age category 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upsilon_2</code></td>
<td>
<p>Indirect transmission rate of the environmental
infectious pressure in age category 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upsilon_3</code></td>
<td>
<p>Indirect transmission rate of the environmental
infectious pressure in age category 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_1</code></td>
<td>
<p>The recovery rate from infected to susceptible for
age category 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_2</code></td>
<td>
<p>The recovery rate from infected to susceptible for
age category 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_3</code></td>
<td>
<p>The recovery rate from infected to susceptible for
age category 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Shed rate from infected individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_t1</code></td>
<td>
<p>The decay of the environmental infectious pressure
in interval 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_t2</code></td>
<td>
<p>The decay of the environmental infectious pressure
in interval 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_t3</code></td>
<td>
<p>The decay of the environmental infectious pressure
in interval 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_t4</code></td>
<td>
<p>The decay of the environmental infectious pressure
in interval 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_t1</code></td>
<td>
<p>vector with the non-inclusive day of the year that
ends interval 1 in each node. Will be repeated to the length
of nrow(u0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_t2</code></td>
<td>
<p>vector with the non-inclusive day of the year that
ends interval 2 in each node. Will be repeated to the length
of nrow(u0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_t3</code></td>
<td>
<p>vector with the non-inclusive day of the year that
ends interval 3 in each node. Will be repeated to the length
of nrow(u0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_t4</code></td>
<td>
<p>vector with the non-inclusive day of the year that
ends interval 4 in each node. Will be repeated to the length
of nrow(u0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The distance matrix between neighboring nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coupling</code></td>
<td>
<p>The coupling between neighboring nodes</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>SISe3_sp</code> model contains two compartments in three age
categories; number of susceptible (S_1, S_2, S_3) and number of
infectious (I_1, I_2, I_3). Additionally, it contains an
environmental compartment to model shedding of a pathogen to the
environment. Moreover, it also includes a spatial coupling of the
environmental contamination among proximal nodes to capture
between-node spread unrelated to moving infected
individuals. Consequently, the model has six state transitions,
</p>
<p style="text-align: center;"><code class="reqn">S_1 \stackrel{\upsilon_1 \varphi S_1}{\longrightarrow} I_1</code>
</p>

<p style="text-align: center;"><code class="reqn">I_1 \stackrel{\gamma_1 I_1}{\longrightarrow} S_1</code>
</p>

<p style="text-align: center;"><code class="reqn">S_2 \stackrel{\upsilon_2 \varphi S_2}{\longrightarrow} I_2</code>
</p>

<p style="text-align: center;"><code class="reqn">I_2 \stackrel{\gamma_2 I_2}{\longrightarrow} S_2</code>
</p>

<p style="text-align: center;"><code class="reqn">S_3 \stackrel{\upsilon_3 \varphi S_3}{\longrightarrow} I_3</code>
</p>

<p style="text-align: center;"><code class="reqn">I_3 \stackrel{\gamma_3 I_3}{\longrightarrow} S_3</code>
</p>

<p>where the transition rate per unit of time from susceptible to
infected is proportional to the concentration of the environmental
contamination <code class="reqn">\varphi</code> in each node. Moreover, the
transition rate from infected to susceptible is the recovery rate
<code class="reqn">\gamma_1, \gamma_2, \gamma_3</code>, measured per individual and
per unit of time. Finally, the environmental infectious pressure
in each node is evolved by,
</p>
<p style="text-align: center;"><code class="reqn">\frac{d \varphi_i(t)}{dt} = \frac{\alpha \left(I_{i,1}(t) +
I_{i,2}(t) + I_{i,3}(t)\right)}{N_i(t)} +
\sum_k{\frac{\varphi_k(t) N_k(t) - \varphi_i(t) N_i(t)}{N_i(t)}
\cdot \frac{D}{d_{ik}}} - \beta(t) \varphi_i(t)</code>
</p>

<p>where <code class="reqn">\alpha</code> is the average shedding rate of the pathogen to
the environment per infected individual and <code class="reqn">N = S_1 + S_2 +
S_3 + I_1 + I_2 + I_3</code> the size of the node. Next comes the
spatial coupling among proximal nodes, where <code class="reqn">D</code> is the rate
of the local spread and <code class="reqn">d_{ik}</code> the distance between holdings
<code class="reqn">i</code> and <code class="reqn">k</code>. The seasonal decay and removal of the
pathogen is captured by <code class="reqn">\beta(t)</code>. The environmental
infectious pressure <code class="reqn">\varphi(t)</code> in each node is
evolved each time unit by the Euler forward method. The value of
<code class="reqn">\varphi(t)</code> is saved at the time-points specified in
<code>tspan</code>.
</p>
<p>The argument <code>u0</code> must be a <code>data.frame</code> with one row for
each node with the following columns:
</p>

<dl>
<dt>S_1</dt>
<dd>
<p>The number of sucsceptible in age category 1</p>
</dd>
<dt>I_1</dt>
<dd>
<p>The number of infected in age category 1</p>
</dd>
<dt>S_2</dt>
<dd>
<p>The number of sucsceptible in age category 2</p>
</dd>
<dt>I_2</dt>
<dd>
<p>The number of infected in age category 2</p>
</dd>
<dt>S_3</dt>
<dd>
<p>The number of sucsceptible in age category 3</p>
</dd>
<dt>I_3</dt>
<dd>
<p>The number of infected in age category 3</p>
</dd>
</dl>
<h3>Value</h3>

<p><code>SISe3_sp</code>
</p>


<h3>Beta</h3>

<p>The time dependent beta is divided into four intervals of the year
</p>
<pre>
where 0 &lt;= day &lt; 365

Case 1: END_1 &lt; END_2 &lt; END_3 &lt; END_4
INTERVAL_1 INTERVAL_2     INTERVAL_3     INTERVAL_4     INTERVAL_1
[0, END_1) [END_1, END_2) [END_2, END_3) [END_3, END_4) [END_4, 365)

Case 2: END_3 &lt; END_4 &lt; END_1 &lt; END_2
INTERVAL_3 INTERVAL_4     INTERVAL_1     INTERVAL_2     INTERVAL_3
[0, END_3) [END_3, END_4) [END_4, END_1) [END_1, END_2) [END_2, 365)

Case 3: END_4 &lt; END_1 &lt; END_2 &lt; END_3
INTERVAL_4 INTERVAL_1     INTERVAL_2     INTERVAL_3     INTERVAL_4
[0, END_4) [END_4, END_1) [END_1, END_2) [END_2, END_3) [END_3, 365)
</pre>


</div>