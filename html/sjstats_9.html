<div class="container">

<table style="width: 100%;"><tr>
<td>chi_squared_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chi-Squared test</h2>

<h3>Description</h3>

<p>This function performs a <code class="reqn">\chi^2</code> test for contingency
tables or tests for given probabilities. The returned effects sizes are
Cramer's V for tables with more than two rows or columns, Phi (<code class="reqn">\phi</code>)
for 2x2 tables, and Fei (פ) for tests against
given probabilities (see <em>Ben-Shachar et al. 2023</em>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">chi_squared_test(
  data,
  select = NULL,
  by = NULL,
  probabilities = NULL,
  weights = NULL,
  paired = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>Name(s) of the continuous variable(s) (as character vector)
to be used as samples for the test. <code>select</code> can be one of the following:
</p>

<ul>
<li> <p><code>select</code> can be used in combination with <code>by</code>, in which case <code>select</code> is
the name of the continous variable (and <code>by</code> indicates a grouping factor).
</p>
</li>
<li> <p><code>select</code> can also be a character vector of length two or more (more than
two names only apply to <code>kruskal_wallis_test()</code>), in which case the two
continuous variables are treated as samples to be compared. <code>by</code> must be
<code>NULL</code> in this case.
</p>
</li>
<li>
<p> If <code>select</code> select is of length <strong>two</strong> and <code>paired = TRUE</code>, the two samples
are considered as <em>dependent</em> and a paired test is carried out.
</p>
</li>
<li>
<p> If <code>select</code> specifies <strong>one</strong> variable and <code>by = NULL</code>, a one-sample test
is carried out (only applicable for <code>t_test()</code> and <code>wilcoxon_test()</code>)
</p>
</li>
<li>
<p> For <code>chi_squared_test()</code>, if <code>select</code> specifies <strong>one</strong> variable and
both <code>by</code> and <code>probabilities</code> are <code>NULL</code>, a one-sample test against given
probabilities is automatically conducted, with equal probabilities for
each level of <code>select</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Name of the variable indicating the groups. Required if <code>select</code>
specifies only one variable that contains all samples to be compared in the
test. If <code>by</code> is not a factor, it will be coerced to a factor. For
<code>chi_squared_test()</code>, if <code>probabilities</code> is provided, <code>by</code> must be <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probabilities</code></td>
<td>
<p>A numeric vector of probabilities for each cell in the
contingency table. The length of the vector must match the number of cells
in the table, i.e. the number of unique levels of the variable specified
in <code>select</code>. If <code>probabilities</code> is provided, a chi-squared test for given
probabilities is conducted. Furthermore, if <code>probabilities</code> is given, <code>by</code>
must be <code>NULL</code>. The probabilities must sum to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Name of an (optional) weighting variable to be used for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>Logical, if <code>TRUE</code>, a McNemar test is conducted for 2x2 tables.
Note that <code>paired</code> only works for 2x2 tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed down to <code>chisq.test()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is a wrapper around <code>chisq.test()</code> and
<code>fisher.test()</code> (for small expected values) for contingency tables, and
<code>chisq.test()</code> for given probabilities. When <code>probabilities</code> are provided,
these are rescaled to sum to 1 (i.e. <code>rescale.p = TRUE</code>). When <code>fisher.test()</code>
is called, simulated p-values are returned (i.e. <code>simulate.p.value = TRUE</code>,
see <code>?fisher.test</code>). If <code>paired = TRUE</code> and a 2x2 table is provided,
a McNemar test (see <code>mcnemar.test()</code>) is conducted.
</p>
<p>The weighted version of the chi-squared test is based on the a weighted
table, using <code>xtabs()</code> as input for <code>chisq.test()</code>.
</p>
<p>Interpretation of effect sizes are based on rules described in
<code>effectsize::interpret_phi()</code>, <code>effectsize::interpret_cramers_v()</code>,
and <code>effectsize::interpret_fei()</code>. Use these function directly to get other
interpretations, by providing the returned effect size as argument, e.g.
<code>interpret_phi(0.35, rules = "gignac2016")</code>.
</p>


<h3>Value</h3>

<p>A data frame with test results. The returned effects sizes are
Cramer's V for tables with more than two rows or columns, Phi (<code class="reqn">\phi</code>)
for 2x2 tables, and Fei (פ) for tests against
given probabilities.
</p>


<h3>Which test to use</h3>

<p>The following table provides an overview of which test to use for different
types of data. The choice of test depends on the scale of the outcome
variable and the number of samples to compare.</p>

<table>
<tr>
<td style="text-align: left;">
   <strong>Samples</strong> </td>
<td style="text-align: left;"> <strong>Scale of Outcome</strong> </td>
<td style="text-align: left;"> <strong>Significance Test</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> binary / nominal </td>
<td style="text-align: left;"> <code>chi_squared_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> continuous, not normal </td>
<td style="text-align: left;"> <code>wilcoxon_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   1 </td>
<td style="text-align: left;"> continuous, normal </td>
<td style="text-align: left;"> <code>t_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, independent </td>
<td style="text-align: left;"> binary / nominal </td>
<td style="text-align: left;"> <code>chi_squared_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, independent </td>
<td style="text-align: left;"> continuous, not normal </td>
<td style="text-align: left;"> <code>mann_whitney_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, independent </td>
<td style="text-align: left;"> continuous, normal </td>
<td style="text-align: left;"> <code>t_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, dependent </td>
<td style="text-align: left;"> binary (only 2x2) </td>
<td style="text-align: left;"> <code>chi_squared_test(paired=TRUE)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, dependent </td>
<td style="text-align: left;"> continuous, not normal </td>
<td style="text-align: left;"> <code>wilcoxon_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   2, dependent </td>
<td style="text-align: left;"> continuous, normal </td>
<td style="text-align: left;"> <code>t_test(paired=TRUE)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   &gt;2, independent </td>
<td style="text-align: left;"> continuous, not normal </td>
<td style="text-align: left;"> <code>kruskal_wallis_test()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   &gt;2, independent </td>
<td style="text-align: left;"> continuous,     normal </td>
<td style="text-align: left;"> <code>datawizard::means_by_group()</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   &gt;2, dependent </td>
<td style="text-align: left;"> continuous, not normal </td>
<td style="text-align: left;"> <em>not yet implemented</em> (1) </td>
</tr>
<tr>
<td style="text-align: left;">
   &gt;2, dependent </td>
<td style="text-align: left;"> continuous,     normal </td>
<td style="text-align: left;"> <em>not yet implemented</em> (2) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>(1) More than two dependent samples are considered as <em>repeated measurements</em>.
For ordinal or not-normally distributed outcomes, these samples are
usually tested using a <code>friedman.test()</code>, which requires the samples
in one variable, the groups to compare in another variable, and a third
variable indicating the repeated measurements (subject IDs).
</p>
<p>(2) More than two dependent samples are considered as <em>repeated measurements</em>.
For normally distributed outcomes, these samples are usually tested using
a ANOVA for repeated measurements. A more sophisticated approach would
be using a linear mixed model.
</p>


<h3>References</h3>


<ul>
<li>
<p> Ben-Shachar, M.S., Patil, I., Thériault, R., Wiernik, B.M.,
Lüdecke, D. (2023). Phi, Fei, Fo, Fum: Effect Sizes for Categorical Data
That Use the Chi‑Squared Statistic. Mathematics, 11, 1982.
<a href="https://doi.org/10.3390/math11091982">doi:10.3390/math11091982</a>
</p>
</li>
<li>
<p> Bender, R., Lange, S., Ziegler, A. Wichtige Signifikanztests.
Dtsch Med Wochenschr 2007; 132: e24–e25
</p>
</li>
<li>
<p> du Prel, J.B., Röhrig, B., Hommel, G., Blettner, M. Auswahl statistischer
Testverfahren. Dtsch Arztebl Int 2010; 107(19): 343–8
</p>
</li>
</ul>
<h3>See Also</h3>


<ul>
<li> <p><code>t_test()</code> for parametric t-tests of dependent and independent samples.
</p>
</li>
<li> <p><code>mann_whitney_test()</code> for non-parametric tests of unpaired (independent)
samples.
</p>
</li>
<li> <p><code>wilcoxon_test()</code> for Wilcoxon rank sum tests for non-parametric tests
of paired (dependent) samples.
</p>
</li>
<li> <p><code>kruskal_wallis_test()</code> for non-parametric tests with more than two
independent samples.
</p>
</li>
<li> <p><code>chi_squared_test()</code> for chi-squared tests (two categorical variables,
dependent and independent).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data(efc)
efc$weight &lt;- abs(rnorm(nrow(efc), 1, 0.3))

# Chi-squared test
chi_squared_test(efc, "c161sex", by = "e16sex")

# weighted Chi-squared test
chi_squared_test(efc, "c161sex", by = "e16sex", weights = "weight")

# Chi-squared test for given probabilities
chi_squared_test(efc, "c161sex", probabilities = c(0.3, 0.7))

</code></pre>


</div>