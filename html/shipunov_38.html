<div class="container">

<table style="width: 100%;"><tr>
<td>Ellipses</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence ellipses</h2>

<h3>Description</h3>

<p>Calculates and plots group confidence ellipses</p>


<h3>Usage</h3>

<pre><code class="language-R">Ellipses(pts, groups, match.color=TRUE, usecolors=NULL,
 centers=FALSE, c.pch=0, c.cex=3,
 level=0.95, df=1000, prec=51,
 coords=NULL, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>Data points to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Grouping variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.color</code></td>
<td>
<p>Match colors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usecolors</code></td>
<td>
<p>Use colors (palette)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>Show centers?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.pch</code></td>
<td>
<p>Color of center points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.cex</code></td>
<td>
<p>Scale of center points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence level for F-distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Used in calculation of P-content according to F(2, df) distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>Precision of ellipse plotting (default is 51 points)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Pre-calculated ellipses coordinates: list of two-column matrices named as groups (by default, not required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to lines()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that (at least at the moment), ellipses are plotted with line(),
therefore shading is not straightforward (but possible, see examples).
</p>
<p>Also, with a help from Pinhull() (see its help), it is possible to reveal
"outliers", points outside of each ellipse borders.
</p>
<p>See also package 'cluster' for ellipsoidhulls() function that allows to
draw ellipse-like hulls.
</p>


<h3>Value</h3>

<p>Invisibly returns the list in the form similar to Hulls(), to use as a
list of polygons or with Overlap().
</p>


<h3>Author(s)</h3>

<p>Alexey Shipunov</p>


<h3>See Also</h3>

<p><code>Hulls</code>, <code>Overlap</code>, <code>Pinhull</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
iris.p &lt;- prcomp(iris[, -5])$x[, 1:2]
plot(iris.p, type="n", xlab="PC1", ylab="PC2")
text(iris.p, labels=abbreviate(iris[, 5], 1, method="both.sides"))
iris.e &lt;- Ellipses(iris.p[, 1:2], iris[, 5], centers=TRUE)

## calculate overlap between ellipses
Overlap(iris.e)

## how to plot filled ellipses
plot(iris.p, type="n", xlab="PC1", ylab="PC2")
text(iris.p, labels=abbreviate(iris[, 5], 1, method="both.sides"))
for (i in seq_along(iris.e))
 polygon(iris.e[[i]], border=NA, col=adjustcolor(i, alpha.f=0.2))

## how to reveal (and label) "outliers", points outside of _all_ ellipses
iris.pie &lt;- Pinhull(iris.p, iris.e)
outs &lt;- which(apply(iris.pie, 1, sum) == 0)
points(iris.p[outs, ], cex=2, pch=4)

## embedded convex hulls
plot(iris.p, col=iris$Species)
for (i in seq_along(iris.e)) lines(iris.e[[i]], col=i, lty=2)
mi &lt;- cbind(seq_len(nrow(iris)), as.numeric(iris$Species)) # indexing matrix
## remove "outliers" in broad sense, points which are outside of its "own" ellipse:
emb &lt;- rowSums(iris.pie) == 1 &amp; iris.pie[mi]
Hulls(iris.p[emb, ], iris$Species[emb])

## LDA ellipes
library(MASS)
ch.lda &lt;- lda(Species ~ ., data=chaetocnema[, -2])
ch.lda.pred &lt;- predict(ch.lda, chaetocnema[, -(1:2)])
## ellipses here are by default bigger then plot so use workaround:
ee &lt;- Ellipses(ch.lda.pred$x, chaetocnema$Species, plot=FALSE)
xx &lt;- range(c(do.call(rbind, ee)[, 1], ch.lda.pred$x[, 1]))
yy &lt;- range(c(do.call(rbind, ee)[, 2], ch.lda.pred$x[, 2]))
plot(ch.lda.pred$x, col=chaetocnema$Species, xlim=xx, ylim=yy)
Ellipses(ch.lda.pred$x, chaetocnema$Species, coords=ee)

## search for the maximal level which gives zero overlap
plot(x5 ~ x17, data=haltica, pch=as.numeric(haltica$Species))
for (i in (99:59)/100) {
cat(i, "\n")
ee &lt;- Ellipses(haltica[, c("x17", "x5")], haltica$Species, level=i, plot=FALSE)
print(mean(Overlap(ee), na.rm=TRUE))
cat("\n")
}
Ellipses(haltica[, c("x17", "x5")], haltica$Species, level=.62)
</code></pre>


</div>