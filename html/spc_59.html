<div class="container">

<table style="width: 100%;"><tr>
<td>xDgrsr.arl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ARLs of Shiryaev-Roberts schemes under drift</h2>

<h3>Description</h3>

<p>Computation of the (zero-state and other)
Average Run Length (ARL) under drift
for Shiryaev-Roberts schemes monitoring normal mean.</p>


<h3>Usage</h3>

<pre><code class="language-R">xDgrsr.arl(k, g, delta, zr = 0, hs = NULL, sided = "one", m = NULL,
mode = "Gan", q = 1, r = 30, with0 = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>reference value of the Shiryaev-Roberts scheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>control limit (alarm threshold) of Shiryaev-Roberts scheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>true drift parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>reflection border for the one-sided chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (enables fast initial response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between one- and two-sided 
Shiryaev-Roberts schemes
by choosing <code>"one"</code> and <code>"two"</code>, respectively. Currentlly,
the two-sided scheme is not implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>parameter used if <code>mode="Gan"</code>. <code>m</code> is design
parameter of Gan's approach. If <code>m=NULL</code>, then <code>m</code>
will increased until the resulting ARL does not change anymore.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>change point position. For <code class="reqn">q=1</code> and
<code class="reqn">\mu=\mu_0</code> and <code class="reqn">\mu=\mu_1</code>, the usual
zero-state ARLs for the in-control and out-of-control case, respectively,
are calculated. For <code class="reqn">q&gt;1</code> and <code class="reqn">\mu!=0</code> conditional delays, that is,
<code class="reqn">E_q(L-q+1|L\geq)</code>, will be determined.
Note that mu0=0 is implicitely fixed. Deploy large <code>q</code> to mimic
steady-state. It works only for <code>mode="Knoth"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>decide whether Gan's or Knoth's approach is used. Use
<code>"Gan"</code> and <code>"Knoth"</code>, respectively.
<code>"Knoth"</code> is not implemented yet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of quadrature nodes, dimension of the resulting linear
equation system is equal to <code>r+1</code> (one-sided) or <code>r</code> (two-sided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with0</code></td>
<td>
<p>defines whether the first observation used for the RL calculation
follows already 1*delta or still 0*delta.
With <code>q</code> additional flexibility is given.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on Gan (1991) or Knoth (2003), the ARL is calculated for Shiryaev-Roberts schemes under drift.
In case of Gan's framework, the usual
ARL function with mu=m*delta is determined and recursively via
m-1, m-2, ... 1 (or 0) the drift ARL determined. The framework
of Knoth allows to calculate ARLs for varying parameters, such as
control limits and distributional parameters.
For details see the cited papers.
</p>


<h3>Value</h3>

<p>Returns a single value which resembles the ARL.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>F. F. Gan (1991),
EWMA control chart under linear drift,
<em>J. Stat. Comput. Simulation 38</em>, 181-200.
</p>
<p>S. Knoth (2003),
EWMA schemes with non-homogeneous transition kernels,
<em>Sequential Analysis 22</em>, 241-255.
</p>
<p>S. Knoth (2012),
More on Control Charting under Drift,
in: <em>Frontiers in Statistical Quality Control 10</em>,
H.-J. Lenz, W. Schmid and P.-T. Wilrich (Eds.),
Physica Verlag, Heidelberg, Germany, 53-68.
</p>
<p>C. Zou, Y. Liu and Z. Wang (2009),
Comparisons of control schemes for monitoring
the means of processes subject to drifts,
<em>Metrika 70</em>, 141-163.
</p>


<h3>See Also</h3>

<p><code>xewma.arl</code> and <code>xewma.ad</code> for zero-state and
steady-state ARL computation of EWMA control charts
for the classical step change model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Monte Carlo example with 10^8 replicates
#   delta      arl    s.e.
#   0.0001 381.8240   0.0304
#   0.0005 238.4630   0.0148
#   0.001  177.4061   0.0097
#   0.002  125.9055   0.0061
#   0.005   75.7574   0.0031
#   0.01    50.2203   0.0018
#   0.02    32.9458   0.0011
#   0.05    18.9213   0.0005
#   0.1     12.6054   0.0003
#   0.5      5.2157   0.0001
#   1        3.6537   0.0001
#   3        2.0289   0.0000
k &lt;- .5
L0 &lt;- 500
zr &lt;- -7
r &lt;- 50
g &lt;- xgrsr.crit(k, L0, zr=zr, r=r)
DxDgrsr.arl &lt;- Vectorize(xDgrsr.arl, "delta")
deltas &lt;- c(0.0001, 0.0005, 0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 3)
arls &lt;- round(DxDgrsr.arl(k, g, deltas, zr=zr, r=r), digits=4)
data.frame(deltas, arls)

## End(Not run)
</code></pre>


</div>