<div class="container">

<table style="width: 100%;"><tr>
<td>pasta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pasta for multi-phenotype analysis</h2>

<h3>Description</h3>

<p>Search for the subset that yields the strongest evidence of
association and calculate the meta-analytic p-value, possibly in the
presence of gene-environmental interaction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pasta(p.values, study.sizes, cor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p>The p.value of each study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study.sizes</code></td>
<td>
<p>The sample size of each study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>The correlation matrix of the studies. For example, if each study
is independent, <code>cor</code> would be the identity matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the joint p value and the test statistic, which
contains the optimal subset.
</p>


<h3>References</h3>

<p>Yu Y, Xia L, Lee S, Zhou X, Stringham H, M, Boehnke M, Mukherjee
B: Subset-Based Analysis Using Gene-Environment Interactions for Discovery
of Genetic Associations across Multiple Studies or Phenotypes. Hum Hered
2019. doi: 10.1159/000496867
</p>


<h3>Examples</h3>

<pre><code class="language-R"># grab synthetic study for example
data("studies")
n.studies &lt;- 5
study.sizes &lt;- c(nrow(studies[[1]]), nrow(studies[[2]]), nrow(studies[[3]]),
                   nrow(studies[[4]]), nrow(studies[[5]]))
study.pvals &lt;- rep(0, n.studies)
# Correlations of p-values among the studies.
# In this case the studies were generated independently so its just I
cor.matrix &lt;- diag(1, n.studies)
# load the lrtest() function to conduct the likelihood ratio test
# Used just to generate the input p-values, not required in pasta itself.

library(lmtest)

for(i in 1:n.studies) {
 # model with gene(G) by environment(E) interaction
 model &lt;- glm(D ~ G + E + GbyE, data = studies[[i]], family = binomial)
 # model without G and GE interaction
 null.model &lt;- glm(D ~ E, data = studies[[i]], family = binomial)
 # likelihood ratio test from the package lmtest
 study.pvals[i] = lmtest::lrtest(null.model, model)[2, 5]
}

pasta &lt;- pasta(study.pvals, study.sizes, cor.matrix)

pasta$p.pasta
pasta$test.statistic$selected.subset
</code></pre>


</div>