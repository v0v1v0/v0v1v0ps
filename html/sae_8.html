<div class="container">

<table style="width: 100%;"><tr>
<td>eblupBHF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EBLUPs of domain means based on a nested error linear regression model.</h2>

<h3>Description</h3>

<p> This function calculates, for selected domains, EBLUPs of domain means based on the 
nested error linear regression model of Battese, Harter and Fuller (1988).</p>


<h3>Usage</h3>

<pre><code class="language-R">eblupBHF(formula, dom, selectdom, meanxpop, popnsize, method = "REML", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): 
a symbolic description of the model to be fitted. The details of model 
specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dom</code></td>
<td>
<p><code>n*1</code> vector or factor (same size as <code>y</code> in <code>formula</code>) with domain codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectdom</code></td>
<td>
<p><code>I*1</code> optional vector or factor with the domain codes for which we 
want to estimate the means. It must be a subset of the domain codes in <code>dom</code>. 
If this parameter is not included all the domain codes included in <code>dom</code> 
are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanxpop</code></td>
<td>
<p><code>D*(p+1)</code> data frame with domain codes in the first column. Each remaining column contains the  
population means of each of the <code>p</code> auxiliary variables for the D domains. 
The domains considered in <code>meanxpop</code> must contain those specified in <code>selectdom</code> (D&gt;=I).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popnsize</code></td>
<td>
<p><code>D*2</code> data frame with domain codes in the first column
and the corresponding domain population sizes in the second column. 
The domains considered in <code>popnsize</code> must contain those specified in <code>selectdom</code> (D&gt;=I).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string. If <code>"REML"</code>, the model is fitted by maximizing the restricted 
log-likelihood. If <code>"ML"</code> the log-likelihood is maximized. Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>dom</code>. By default the variables are taken from the environment from which <code>eblupBHF</code> is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A typical model has the form response ~ terms where response is the (numeric) response vector and terms is a series of terms which specifies a linear predictor for response. A terms specification of the form first + second indicates all the terms in first together with all the terms in second with duplicates removed. 
</p>
<p>A formula has an implied intercept term. To remove this use either y ~ x - 1 or y ~ 0 + x. See <code>formula</code> 
for more details of allowed formulae.
</p>


<h3>Value</h3>

<p> The function returns a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>eblup </code></td>
<td>
<p>data frame with number of rows equal to number of selected domains (<code>selectdom</code>),
containing in its columns the domain codes (<code>domain</code>) and the EBLUPs 
of the means of selected domains based on the nested error linear regression 
model (<code>eblup</code>). For domains with zero sample size, the EBLUPs are the synthetic regression estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a list containing the following objects: 
</p>

<ul>
<li>
<p><code>summary</code>: summary of the unit level model fitting.
</p>
</li>
<li>
<p><code>fixed</code>: vector with the estimated values of the fixed regression coefficient.
</p>
</li>
<li>
<p><code>random</code>: vector with the predicted random effects.
</p>
</li>
<li>
<p><code>errorvar</code>: estimated model error variance.
</p>
</li>
<li>
<p><code>refvar</code>: estimated random effects variance.
</p>
</li>
<li>
<p><code>loglike</code>: log-likelihood.
</p>
</li>
<li>
<p><code>residuals</code>: vector with raw residuals.
</p>
</li>
</ul>
</td>
</tr>
</table>
<p>Cases with NA values in <code>formula</code> or <code>dom</code> are ignored. 
</p>


<h3>References</h3>

 
<p>- Battese, G.E., Harter, R.M. and Fuller, W.A. (1988). An Error-Components Model for Prediction of County Crop Areas Using Survey and Satellite Data, Journal of the American Statistical Association 83, 28-36. 
</p>
<p>- Rao, J.N.K. (2003). Small Area Estimation. New York: John Wiley and Sons.
</p>


<h3>See Also</h3>

 <p><code>pbmseBHF</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data set for segments (units within domains)
data(cornsoybean)

# Load data set for counties
data(cornsoybeanmeans)
attach(cornsoybeanmeans)

# Construct data frame with county means of auxiliary variables for 
# domains. First column must include the county code
Xmean &lt;- data.frame(CountyIndex, MeanCornPixPerSeg, MeanSoyBeansPixPerSeg)
Popn  &lt;- data.frame(CountyIndex, PopnSegments)

# Compute EBLUPs of county means of corn crop areas for all counties
resultCorn &lt;- eblupBHF(CornHec ~ CornPix + SoyBeansPix, dom=County, 
                       meanxpop=Xmean, popnsize=Popn, data=cornsoybean)
resultCorn$eblup

# Compute EBLUPs of county means of soy beans crop areas for
# a subset of counties using ML method
domains &lt;- c(10,1,5)
resultBean &lt;- eblupBHF(SoyBeansHec ~ CornPix + SoyBeansPix, dom=County, 
                       selectdom=domains, meanxpop=Xmean, popnsize=Popn,
                       method="ML", data=cornsoybean)
resultBean$eblup
resultBean$fit

detach(cornsoybeanmeans)
</code></pre>


</div>