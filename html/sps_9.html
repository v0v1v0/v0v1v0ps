<div class="container">

<table style="width: 100%;"><tr>
<td>sps_repweights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap replicate weights for sequential Poisson sampling</h2>

<h3>Description</h3>

<p>Produce bootstrap replicate weights that are appropriate for Poisson
sampling, and therefore approximately correct for sequential Poisson
sampling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sps_repweights(w, replicates = 1000L, tau = 1, dist = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A numeric vector of design (inverse probability) weights for a
(sequential) Poisson sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>A positive integer that gives the number of bootstrap
replicates (1,000 by default). Non-integers are truncated towards 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A number greater than or equal to 1 that gives the rescale factor
for the bootstrap weights. Setting to 1 (the default) does not rescale the
weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A function that produces random deviates with mean 0 and
standard deviation 1, such as <code>rnorm()</code>. The default uses the
pseudo-population method from section 4.1 of Beaumont and Patak (2012); see
details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Replicate weights are constructed using the generalized bootstrap method by
Beaumont and Patak (2012). Their method takes a vector of design weights
<code class="reqn">w</code>, finds a vector of adjustments <code class="reqn">a</code> for each bootstrap replicate,
and calculates the replicate weights as <code class="reqn">a w</code>.
</p>
<p>There are two ways to calculate the adjustments <code class="reqn">a</code>. The default
pseudo-population method randomly rounds <code class="reqn">w</code> for each replicate to
produce a collection of integer weights <code class="reqn">w'</code> that are used to generate a
random vector <code class="reqn">b</code> from the binomial distribution. The vector of
adjustments is then <code class="reqn">a = 1 + b - w' / w</code>. Specifying a
deviates-generating function for <code>dist</code> uses this function to produce a
random vector <code class="reqn">d</code> that is then used to make an adjustment <code class="reqn">a = 1 + d
\sqrt{1 - 1 / w}</code>.
</p>
<p>The adjustments can be rescaled by a value <code class="reqn">\tau \geq 1</code> to
prevent negative replicate weights. With this rescaling, the adjustment
becomes <code class="reqn">(a + \tau - 1) / \tau</code>. If <code class="reqn">\tau &gt; 1</code> then the resulting
bootstrap variance estimator should be multiplied by <code class="reqn">\tau^2</code>.
</p>


<h3>Value</h3>

<p>A matrix of bootstrap replicate weights with <code>replicates</code> columns (one for
each replicate) and <code>length(w)</code> rows (one for each unit in the sample), with
the value of <code>tau</code> as an attribute.
</p>


<h3>Note</h3>

<p>As an alternative to the bootstrap, Ohlsson (1998, equations 2.13)
proposes an analytic estimator for the variance of the total <code class="reqn">\hat Y =
\sum wy</code> (for the take-some units) under sequential Poisson
sampling: </p>
<p style="text-align: center;"><code class="reqn">V(\hat Y) = \frac{n}{n - 1} \sum \left(1 -
\frac{1}{w}\right) \left(wy - \frac{\hat Y}{n}\right)^2.</code>
</p>
<p> See Rosén (1997, equation 3.11) for a
more general version of this estimator that can be applied to other order
sampling schemes. Replacing the left-most correction by <code class="reqn">n / (m - 1)</code>,
where <code class="reqn">m</code> is the number of units in the sample, gives a similar
estimator for the total under ordinary Poisson sampling, <code class="reqn">\hat Y = n / m
\sum wy</code>.
</p>


<h3>References</h3>

<p>Beaumont, J.-F. and Patak, Z. (2012). On the Generalized
Bootstrap for Sample Surveys with Special Attention to Poisson Sampling.
<em>International Statistical Review</em>, 80(1): 127-148.
</p>
<p>Ohlsson, E. (1998). Sequential Poisson Sampling.
<em>Journal of Official Statistics</em>, 14(2): 149-162.
</p>
<p>Rosén, B. (1997). On sampling with probability proportional to size.
<em>Journal of Statistical Planning and Inference</em>, 62(2): 159-191.
</p>


<h3>See Also</h3>

<p><code>sps()</code> for drawing a sequential Poisson sample.
</p>
<p><code>bootstrapFP()</code> (with <code>method = "wGeneralised"</code>) in the <span class="pkg">bootstrapFP</span>
package for calculating the variance of Horvitz-Thompson estimators using
the generalized bootstrap.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make a population with units of different size
x &lt;- c(1:10, 100)

# Draw a sequential Poisson sample
(samp &lt;- sps(x, 5))

# Make some bootstrap replicates
dist &lt;- list(
  pseudo_population = NULL,
  standard_normal = rnorm,
  exponential = \(x) rexp(x) - 1,
  uniform = \(x) runif(x, -sqrt(3), sqrt(3))
)

lapply(dist, sps_repweights, w = weights(samp), replicates = 5, tau = 2)

</code></pre>


</div>