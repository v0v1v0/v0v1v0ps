<div class="container">

<table style="width: 100%;"><tr>
<td>susie_trendfilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply susie to trend filtering (especially changepoint
problems), a type of non-parametric regression.</h2>

<h3>Description</h3>

<p>Fits the non-parametric Gaussian regression model
<code class="reqn">y = mu + e</code>, where the mean <code class="reqn">mu</code> is modelled as <code class="reqn">mu =
  Xb</code>, X is a matrix with columns containing an appropriate basis,
and b is vector with a (sparse) SuSiE prior. In particular, when
<code>order = 0</code>, the jth column of X is a vector with the first j
elements equal to zero, and the remaining elements equal to 1, so
that <code class="reqn">b_j</code> corresponds to the change in the mean of y between
indices j and j+1. For background on trend filtering, see
Tibshirani (2014). See also the "Trend filtering" vignette,
<code>vignette("trend_filtering")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">susie_trendfilter(y, order = 0, standardize = FALSE, use_mad = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An n-vector of observations ordered in time or space
(assumed to be equally spaced).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>An integer specifying the order of trend filtering.
The default, <code>order = 0</code>, corresponds to "changepoint"
problems (<em>i.e.</em>, piecewise constant <code class="reqn">mu</code>). Although
<code>order &gt; 0</code> is implemented, we do not recommend its use; in
practice, we have found problems with convergence of the algorithm
to poor local optima, producing unreliable inferences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Logical indicating whether to standardize the X
variables ("basis functions"); <code>standardize = FALSE</code> is
recommended as these basis functions already have a natural scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_mad</code></td>
<td>
<p>Logical indicating whether to use the "median
absolute deviation" (MAD) method to the estimate residual
variance. If <code>use_mad = TRUE</code>, susie is run twice, first by
fixing the residual variance to the MAD value, then a second time,
initialized to the first fit, but with residual variance estimated
the usual way (by maximizing the ELBO). We have found this strategy
typically improves reliability of the results by reducing a
tendency to converge to poor local optima of the ELBO.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>susie</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implementation exploits the special structure of X,
which means that the matrix-vector product <code class="reqn">X^Ty</code> is fast to
compute; in particular, the computation time is <code class="reqn">O(n)</code> rather
than <code class="reqn">O(n^2)</code> if <code>X</code> were formed explicitly. For
implementation details, see the "Implementation of SuSiE trend
filtering" vignette by running
<code>vignette("trendfiltering_derivations")</code>.
</p>


<h3>Value</h3>

<p>A "susie" fit; see <code>susie</code> for details.
</p>


<h3>References</h3>

<p>R. J. Tibshirani (2014). Adaptive piecewise polynomial
estimation via trend filtering. <em>Annals of Statistics</em>
<b>42</b>, 285-323.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
mu = c(rep(0,50),rep(1,50),rep(3,50),rep(-2,50),rep(0,200))
y = mu + rnorm(400)
s = susie_trendfilter(y)
plot(y)
lines(mu,col = 1,lwd = 3)
lines(predict(s),col = 2,lwd = 2)

# Calculate credible sets (indices of y that occur just before
# changepoints).
susie_get_cs(s)

# Plot with credible sets for changepoints.
susie_plot_changepoint(s,y) 

</code></pre>


</div>