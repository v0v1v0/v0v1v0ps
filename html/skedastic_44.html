<div class="container">

<table style="width: 100%;"><tr>
<td>zhou_etal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Zhou, Song, and Thompson's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the methods of
Zhou et al. (2015) for testing for
heteroskedasticity in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">zhou_etal(
  mainlm,
  auxdesign = NA,
  method = c("pooled", "covariate-specific", "hybrid"),
  Bperturbed = 500L,
  seed = 1234,
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auxdesign</code></td>
<td>
<p>A <code>data.frame</code> or
<code>matrix</code> representing an auxiliary design matrix of
containing exogenous variables that (under alternative hypothesis) are
related to error variance, or a character "fitted.values" indicating
that the fitted <code class="reqn">\hat{y}_i</code> values from OLS should be used.
If set to <code>NA</code> (the default), the
design matrix of the original regression model is used. An intercept
is included in the auxiliary regression even if the first column of
<code>auxdesign</code> is not a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character specifying which of the three test methods to
implement; one of <code>"pooled"</code>, <code>"covariate-specific"</code>, or
<code>"hybrid"</code> (which combines the other two). Partial matching is
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bperturbed</code></td>
<td>
<p>An integer specifying the number of perturbation samples
to generate when estimating the <code class="reqn">p</code>-value. Defaults to <code>500L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer specifying a seed to pass to
<code>set.seed</code> for random number generation. This allows
for reproducibility of perturbation sampling. A value of <code>NA</code>
results in not setting a seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Zhou et al. (2015) The authors propose
three variations based on comparisons between sandwich and model-based
estimators for the variances of individual regression coefficient
esimators. The covariate-specific method computes a test statistic and
<code class="reqn">p</code>-value for each column of the auxiliary design matrix (which is,
by default, the original design matrix with intercept omitted). The
<code class="reqn">p</code>-values undergo a Bonferroni correction to control overall test
size. When the null hypothesis is rejected in this case, it also provides
information about which auxiliary design variable is associated with the
error variance. The pooled method computes a single test statistic and
<code class="reqn">p</code>-value and is thus an omnibus test. The hybrid method returns the
minimum <code class="reqn">p</code>-value between the Bonferroni-corrected covariate-specific
<code class="reqn">p</code>-values and the pooled <code class="reqn">p</code>-value, multiplying it by 2 for a
further Bonferroni correction. The test statistic returned is that
which corresponds to the minimum <code class="reqn">p</code>-value. The covariate-specific
and pooled test statistics have null distributions that are
asymptotically normal with mean 0. However, the variance is intractable
and thus perturbation sampling is used to compute <code class="reqn">p</code>-values
empirically.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> "htest". If object is not
assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Zhou QM, Song PX, Thompson ME (2015).
“Profiling Heteroscedasticity in Linear Regression Models.”
<em>The Canadian Journal of Statistics</em>, <b>43</b>(3), 358–377.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
zhou_etal(mtcars_lm, method = "pooled")
zhou_etal(mtcars_lm, method = "covariate-specific")
zhou_etal(mtcars_lm, method = "hybrid")

</code></pre>


</div>