<div class="container">

<table style="width: 100%;"><tr>
<td>sits_tuning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tuning machine learning models hyper-parameters</h2>

<h3>Description</h3>

<p>Machine learning models use stochastic gradient descent (SGD) techniques to
find optimal solutions. To perform SGD, models use optimization
algorithms which have hyperparameters that have to be adjusted
to achieve best performance for each application.
</p>
<p>This function performs a random search on values of selected hyperparameters.
Instead of performing an exhaustive test of all parameter combinations,
it selecting them randomly. Validation is done using an independent set
of samples or by a validation split.  The function returns the
best hyper-parameters in a list. Hyper-parameters passed to <code>params</code>
parameter should be passed by calling <code>sits_tuning_hparams()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sits_tuning(
  samples,
  samples_validation = NULL,
  validation_split = 0.2,
  ml_method = sits_tempcnn(),
  params = sits_tuning_hparams(optimizer = torch::optim_adamw, opt_hparams = list(lr =
    loguniform(10^-2, 10^-4))),
  trials = 30,
  multicores = 2,
  progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Time series set to be validated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples_validation</code></td>
<td>
<p>Time series set used for validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation_split</code></td>
<td>
<p>Percent of original time series set to be used
for validation (if samples_validation is NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml_method</code></td>
<td>
<p>Machine learning method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>List with hyper parameters to be passed to
<code>ml_method</code>. User can use <code>uniform</code>, <code>choice</code>,
<code>randint</code>, <code>normal</code>, <code>lognormal</code>, <code>loguniform</code>,
and <code>beta</code> distribution functions to randomize parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>Number of random trials to perform the random search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicores</code></td>
<td>
<p>Number of cores to process in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Show progress bar?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble containing all parameters used to train on each trial
ordered by accuracy
</p>


<h3>Author(s)</h3>

<p>Rolf Simoes, <a href="mailto:rolf.simoes@inpe.br">rolf.simoes@inpe.br</a>
</p>


<h3>References</h3>

<p>James Bergstra, Yoshua Bengio,
"Random Search for Hyper-Parameter Optimization".
Journal of Machine Learning Research. 13: 281â€“305, 2012.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (sits_run_examples()) {
    # find best learning rate parameters for TempCNN
    tuned &lt;- sits_tuning(
        samples_modis_ndvi,
        ml_method = sits_tempcnn(),
        params = sits_tuning_hparams(
            optimizer = choice(
                torch::optim_adamw
            ),
            opt_hparams = list(
                lr = loguniform(10^-2, 10^-4)
            )
        ),
        trials = 4,
        multicores = 2,
        progress = FALSE
    )
    # obtain best accuracy, kappa and best_lr
    accuracy &lt;- tuned$accuracy[[1]]
    kappa &lt;- tuned$kappa[[1]]
    best_lr &lt;- tuned$opt_hparams[[1]]$lr
}

</code></pre>


</div>