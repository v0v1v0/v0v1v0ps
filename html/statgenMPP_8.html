<div class="container">

<table style="width: 100%;"><tr>
<td>kinshipIBD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute kinship matrix for IBD probabilities</h2>

<h3>Description</h3>

<p>Compute a kinship matrix or a list of chromosome specific kinship matrices
for a 3D array of IBD probabilities. The kinship matrix is computed by
averaging <code class="reqn">Z Z^t</code> over all markers, where <code class="reqn">Z</code> is the genotype x
parents matrix for the marker. If <code>chrSpecific = TRUE</code> chromosome
specific kinship matrices are computed for each chromosome based only on the
markers on all other chromosomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kinshipIBD(markers, map = NULL, chrSpecific = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>An n x m x p array with IBD probabilities with genotypes in
the rows (n), markers in the columns (m), and parents in the 3rd dimension
(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A data.frame with columns <code>chr</code> for chromosome and
<code>pos</code> for position. Positions should be in centimorgan (cM). They
should not be cumulative over the chromosomes. Other columns are ignored.
Marker names should be in the row names. These should match the marker names
in the input file. Only required if <code>chrSpecific = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chrSpecific</code></td>
<td>
<p>Should chromosome specific kinship matrices be
computed?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A kinship matrix or a list of chromosome specific kinship matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Read phenotypic data.
pheno &lt;- read.delim(system.file("extdata/multipop", "AxBxCpheno.txt",
                               package = "statgenMPP"))
## Rename first column to genotype.
colnames(pheno)[1] &lt;- "genotype"


## Compute IBD probabilities for simulated population - AxB, AxC.
ABC &lt;- calcIBDMPP(crossNames = c("AxB", "AxC"),
                  markerFiles = c(system.file("extdata/multipop", "AxB.txt",
                                              package = "statgenMPP"),
                                  system.file("extdata/multipop", "AxC.txt",
                                              package = "statgenMPP")),
                  pheno = pheno,
                  popType = "F4DH",
                  mapFile = system.file("extdata/multipop", "mapfile.txt",
                                        package = "statgenMPP"),
                  evalDist = 5)

## Compute chromosome specific kinship matrices.
KChrSpec &lt;- kinshipIBD(markers = ABC$markers, map = ABC$map)

</code></pre>


</div>