<div class="container">

<table style="width: 100%;"><tr>
<td>PCA_score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scatter Plot of 2 Specified Principal Components
</h2>

<h3>Description</h3>

<p>Scatter plot of 2 specified principal components. The size of the data points on the PCA plot indicates the Mahalanobis distance (distance between each point and mean value).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PCA_score(
    prcomp_obj, 
    data, 
    dims = c(1, 2),
    color = NULL, 
    MD = TRUE, 
    loadings = FALSE, 
    loadings.color = "black", 
    loadings.label = FALSE,
    title = "pca plot",
    addThemeFlag = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prcomp_obj</code></td>
<td>

<p>the object returned by the function <code>prcomp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame. Rows are subjects; Columns are variables describing the subjects. The object <code>prcomp_obj</code> is based on <code>data</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>

<p>a numeric vector with 2 elements indicating which two principal components
will be used to draw scatter plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>

<p>character. The column name of <code>data</code> that indicates the subject groups. The data points on the PCA plot will be colored by the group info.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MD</code></td>
<td>

<p>logical. Indicate if the Mahalanobis distance (distance between each point and mean value) would be used to indicate the size of data points on the PCA plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>

<p>logical. Indicate if loading plot would be superimposed on the PCA plot. (default: FALSE)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.color</code></td>
<td>

<p>character. Indicate the color of the loading axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings.label</code></td>
<td>

<p>logical. Indicating if loading labels should be added to the plot. (default: FALSE)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>character. Figure title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addThemeFlag</code></td>
<td>

<p>logical. Indicates if light blue background and white grid should be added to the figure.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 9 elements.
<code>data</code>, <code>layers</code>, <code>scales</code>, <code>mapping</code>,
<code>theme</code>, <code>coordinates</code>,
<code>facet</code>, <code>plot_env</code>, and <code>labels</code>.
</p>


<h3>Author(s)</h3>

<p>Wenfei Zhang &lt;Wenfei.Zhang@sanofi.com&gt;,
Weiliang Qiu &lt;Weiliang.Qiu@sanofi.com&gt;,
Xuan Lin &lt;Xuan.Lin@sanofi.com&gt;,
Donghui Zhang &lt;Donghui.Zhang@sanofi.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(factoextra)

data(esSim)
print(esSim)

# expression data
dat = exprs(esSim)
print(dim(dat))
print(dat[1:2,])

# phenotype data
pDat = pData(esSim)
print(dim(pDat))
print(pDat[1:2,])

# feature data
fDat = fData(esSim)
print(dim(fDat))
print(fDat[1:2,])

# choose the first 6 probes (3 OE probes, 2 UE probes, and 1 NE probe)
pDat$probe1 = dat[1,]
pDat$probe2 = dat[2,]
pDat$probe3 = dat[3,]
pDat$probe4 = dat[4,]
pDat$probe5 = dat[5,]
pDat$probe6 = dat[6,]

print(pDat[1:2, ])

# check histograms of probe 1 expression in cases and controls
print(table(pDat$grp, useNA = "ifany"))

pDat$grp = factor(pDat$grp)

###

pca.obj = iprcomp(pDat[, c(3:8)], scale. = TRUE)

# scree plot
factoextra::fviz_eig(pca.obj, addlabels = TRUE)

# scatter plot of PC1 vs PC2
statVisual(type = 'PCA_score',
           prcomp_obj = pca.obj, 
           dims = c(1, 2),
           data = pDat, 
           color = 'grp',
           loadings = FALSE)

PCA_score(prcomp_obj = pca.obj, 
          dims = c(1, 3),
          data = pDat, 
          color = 'grp',
          loadings = FALSE)

</code></pre>


</div>