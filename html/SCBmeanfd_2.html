<div class="container">

<table style="width: 100%;"><tr>
<td>cv.score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Leave-One-Curve-out Cross-Validation Score
</h2>

<h3>Description</h3>

<p>Compute the cross-validation score of Rice and Silverman (1991) for  the local polynomial estimation of a mean function.</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.score(bandwidth, x, y, degree = 1, gridsize = length(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>kernel bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>observation points. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix or data frame with functional observations (= curves) stored in rows. The number of columns of <code>y</code> must match the length of <code>x</code>. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of the local polynomial fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>size of evaluation grid for the smoothed data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cross-validation score is obtained by leaving in turn each curve out and computing the prediction error of the local polynomial smoother based on all other curves. For a bandwith value <code class="reqn">h</code>, this score is 
</p>
<p style="text-align: center;"><code class="reqn"> CV(h) = \frac{1}{np} \sum_{i=1}^n \sum_{j=1}^p \left( Y_{ij} - \hat{\mu}^{-(i)}(x_j;h) \right)^2, </code>
</p>

<p>where <code class="reqn">Y_{ij}</code> is the measurement of the <code class="reqn">i</code>-th curve at location <code class="reqn">x_j</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,p</code>, and <code class="reqn">\hat{\mu}^{-(i)}(x_j;h)</code> is the local polynomial estimator with bandwidth <code class="reqn">h</code> based on all curves except the <code class="reqn">i</code>-th.
</p>
<p>If the <code>x</code> values are not equally spaced, the data are first smoothed and evaluated on a grid of length <code>gridsize</code> spanning the range of <code>x</code>. The smoothed data are then interpolated back to <code>x</code>. 
</p>


<h3>Value</h3>

<p>the cross-validation score.</p>


<h3>References</h3>

<p>Rice, J. A. and Silverman, B. W. (1991). Estimating the mean and covariance structure nonparametrically when the data are curves. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <b>53</b>, 233â€“243.
</p>


<h3>See Also</h3>

<p><code>cv.select</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Artificial example 
x &lt;- seq(0, 1, len = 100)
mu &lt;- x + .2 * sin(2 * pi * x)
y &lt;- matrix(mu + rnorm(2000, sd = .25), 20, 100, byrow = TRUE)
h &lt;- c(.005, .01, .02, .05, .1, .15)
cv &lt;- numeric()
for (i in 1:length(h)) cv[i] &lt;- cv.score(h[i], x, y, 1)
plot(h, cv, type = "l")

## Plasma citrate data
## Compare cross-validation scores and bandwidths  
## for local linear and local quadratic smoothing
## Not run: 
data(plasma)
time &lt;- 8:21
h1 &lt;- seq(.5, 1.3, .05)
h2 &lt;- seq(.75, 2, .05)
cv1 &lt;- sapply(h1, cv.score, x = time, y = plasma, degree = 1)
cv2 &lt;- sapply(h2, cv.score, x = time, y = plasma, degree = 2)
plot(h1, cv1, type = "l", xlim = range(c(h1,h2)), ylim = range(c(cv1, cv2)), 
  xlab = "Bandwidth (hour)", ylab = "CV score", 
  main = "Cross validation for local polynomial estimation")
lines(h2, cv2, col = 2)
legend("topleft", legend = c("Linear", "Quadratic"), lty = 1, 
  col = 1:2, cex = .9)

## Note: using local linear (resp. quadratic) smoothing 
## with a bandwidth smaller than .5 (resp. .75) can result 
## in non-definiteness or numerical instability of the estimator. 

## End(Not run)
</code></pre>


</div>