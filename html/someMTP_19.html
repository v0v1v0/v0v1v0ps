<div class="container">

<table style="width: 100%;"><tr>
<td>p.adjust.w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adjust P-values for Multiple Comparisons
</h2>

<h3>Description</h3>

<p>Given a set of p-values, returns p-values adjusted using one of several (weighted) methods.
It extends the method of <code>p.adjust{stats}</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.adjust.w(p, method = c("bonferroni","holm","BHfwe","BH","BY"), n = length(p),w=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of p-values (possibly with NAs)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>correction method
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of comparisons, must be at least length(p); only set this (to non-default) when you know what you are doing!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>weigths to be used. <code>p.adjust.w(..., rep(1,length(p)))</code> produces the same results as in <code>p.adjust(...)</code> (i.e. the unweighted counterpart).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of corrected p-values (same length as p) having two attributes: <code>attributes(...)$w</code> is the vecotr of used weights and <code>attributes(...)$method</code> is the method used.
</p>


<h3>Author(s)</h3>

<p>Livio Finos
</p>


<h3>References</h3>

<p>Benjamini, Hochberg (1997). Multiple hypotheses testing with weights. Scand. J. Statist. 24, 407-418.
</p>
<p>Finos,  Salmaso (2007). FDR- and FWE-controlling methods using data-driven weights. Journal of Statistical Planning and Inference, 137,12, 3859-3870.
</p>


<h3>See Also</h3>

<p><code>p.adjust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(13)
y &lt;- matrix(rnorm(5000),5,1000) #create toy data
y[,1:100] &lt;- y[,1:100]+3 #create toy data

p &lt;- apply(y,2,function(y) t.test(y)$p.value) #compute p-values
M2 &lt;- apply(y^2,2,mean) #compute ordering criterion

fdr   &lt;- p.adjust(p,method="BH") #(unweighted) procedure, fdr control
 sum(fdr&lt;.05)
fdr.w &lt;- p.adjust.w(p,method="BH",w=M2) #weighted procedure, weighted fdr control
 sum(fdr.w&lt;.05)
 
fwer   &lt;- p.adjust(p,method="holm") #(unweighted) procedure, fwer control
 sum(fwer&lt;.05)
fwer.w &lt;- p.adjust.w(p,method="BHfwe",w=M2) #weighted procedure, weighted fwer (=fwer) control
 sum(fwer.w&lt;.05)

plot(M2,-log10(p))
</code></pre>


</div>