<div class="container">

<table style="width: 100%;"><tr>
<td>rmvnorm.conditional</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw Conditional Multivariate Normals</h2>

<h3>Description</h3>

<p>Fast way to draw conditional multivariate normals when the covariance
matrix is sparse.</p>


<h3>Usage</h3>

<pre><code class="language-R">rmvnorm.conditional(n, y, mu = rep.int(0, dim(SigmaXX)[1]+dim(SigmaYY)[1]),
                    SigmaXX, SigmaYY, SigmaXY, noise, RstructYY = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>mean vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaXX</code></td>
<td>
<p>covariance of X, required (of class <code>spam</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaXY</code></td>
<td>
<p>cross-covariance of X-Y, optional (of class <code>spam</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaYY</code></td>
<td>
<p>covariance of Y, required (of class <code>spam</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>observational noice of Y, optional. See ‘Details’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RstructYY</code></td>
<td>
<p>the Cholesky structure of <code>SigmaYY</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>chol</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quite often, we want to draw condional observations <code class="reqn">X|y</code>
from the model <code class="reqn">Y=X+e</code>, where <code class="reqn">X</code> has covariance matrix
<code>SigmaXX</code> and <code class="reqn">e</code> has white noise.<br></p>
<p>Covariance of <code class="reqn">Y</code> can be specified by <code>SigmaYY</code> or
<code>SigmaXX+diag(noise,)</code>. If <code class="reqn">Y</code> and <code class="reqn">X</code> do not have the
same dimensions, <code>SigmaXY</code> needs to be specified. <br></p>
<p>The function also implmements a general multivariate model, where the
we only observe part of the vector.  The components are first
<code class="reqn">X</code> then <code class="reqn">Y</code>.
</p>
<p>The function <code>rmvnorm.cond()</code> is a wrapper to
<code>rmvnorm.conditional()</code> and included to increase similarities
with other packages.
</p>


<h3>Author(s)</h3>

<p>Reinhard Furrer</p>


<h3>See Also</h3>

<p><code>rmvnorm.spam</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12)
N &lt;- 300
y &lt;- c(5, -5, -5, 5)
SigmaXX &lt;- as.spam(.95^abs(outer(1:N, 1:N, "-")), eps=1e-4)
sel &lt;- c(10, 100, 120, 300)        # where we observe y
SigmaXY &lt;- SigmaXX[, sel]
SigmaYY &lt;- SigmaXX[sel,sel] + diag.spam(.01, length(y)) # some noise
x &lt;- rmvnorm.conditional(3, y, SigmaXX=SigmaXX, SigmaXY=SigmaXY,
                         SigmaYY=SigmaYY)
# unconditional sample:
ux &lt;- rmvnorm(1, Sigma=SigmaXX)
matplot(t(rbind(x, ux)), type='l', lty=1)
points(sel, y, pch=19)
</code></pre>


</div>