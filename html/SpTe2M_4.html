<div class="container">

<table style="width: 100%;"><tr>
<td>mod_cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modifed cross-validation for bandwidth selection</h2>

<h3>Description</h3>

<p>The spatio-temporal mean function can be estimated by the local linear kernel 
smoothing procedure (cf., Yang and Qiu 2018). The function <code>mod_cv</code> 
provides a reliable tool for selecting bandwidths <code>(ht, hs)</code> used in 
the local linear kernel smoothing procedure in cases when data are 
spatio-temporally correlated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mod_cv(y, st, ht = NULL, hs = NULL, eps = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of the spatio-temporal response <code class="reqn">y(t,s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ht</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>ht</code> provided by users; default 
is <code>NULL</code>, and <code>mod_cv</code> chooses its own sequence if <code>ht=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>hs</code> provided by users; default 
is <code>NULL</code>, and <code>mod_cv</code> chooses its own sequence if <code>hs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The value of this parametric is between 0 and 1. Default is 0.1. The 
following bimodal kernel function (cf., Yang and Qiu 2018) is used when 
calculting the modified cross-validation score:
</p>
<p style="text-align: center;"><code class="reqn">K_{\epsilon}(x) = \frac{4}{4-3\epsilon-\epsilon^3}
\left\{ \begin{array}{ll}
\frac{3}{4}(1-x^2)\mbox{I}(|x|\leq 1), &amp; \mbox{ if } |x| \geq \epsilon, \\
\frac{3(1-\epsilon^2)}{4\epsilon}|x|, &amp; \mbox{ otherwise}.
\end{array}
\right.</code>
</p>

<p>The argument <code>eps</code> represents the parameter <code class="reqn">\epsilon</code> in the above 
bimodal kernel, which controls the closeness of the bimodal kernel to the 
Epanechnikov kernel <code class="reqn">K_e(x)=0.75(1-x^2)\mbox{I}(|x|\leq 1)</code>. The smaller 
the value, the closer the two kernels.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>A matrix containing all the bandwidths (<code>ht</code>, <code>hs</code>) 
provided by users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcv</code></td>
<td>
<p>The modified cross-validation scores for all the bandwidths 
provided by users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth.opt</code></td>
<td>
<p>The selected bandwidths <code>(ht, hs)</code> by the modified 
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcv.opt</code></td>
<td>
<p>The modified cross-validation score of the selected 
bandwidths.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2018). Spatio-Temporal Incidence Rate Data Analysis by 
Nonparametric Regression. <em>Statistics in Medicine</em>, <strong>37</strong>, 2094-2107.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ht &lt;- seq(0.10,0.15,0.05); hs &lt;- seq(0.20,0.30,0.10)
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
mcv &lt;- mod_cv(y.sub,st.sub,ht,hs,eps=0.1)
</code></pre>


</div>