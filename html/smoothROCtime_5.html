<div class="container">

<table style="width: 100%;"><tr>
<td>stRoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth Time-dependent ROC curve estimations</h2>

<h3>Description</h3>

<p>Provides smooth estimations of <b>Cumulative/Dynamic (C/D)</b> and <b>Incident/Dynamic (I/D)</b> ROC curves in presence of rigth censorship and the corresponding Areas Under the Curves (AUCs), at a single point of time or a vector of points.
</p>

<ul>
<li> <p>The function computes two different procedures to obtain smooth estimations of the <b>C/D ROC curve</b>. Both are based on the kernel density estimation of the joint distribution function of the marker and time-to-event variables, provided by <code>funcen</code> function. The first method, to which we will refere as <b>smooth method</b>, is carried out according to the methodology proposed in <a href="https://doi.org/10.1177/0962280217740786">https://doi.org/10.1177/0962280217740786</a>. The second one uses this estimation of the joint density function of the variables marker and time-to-event for computing the weights or probabilities allocated to censored observations (undefined individuals) in <a href="https://doi.org/10.1080/00949655.2016.1175442">https://doi.org/10.1080/00949655.2016.1175442</a> and <a href="https://doi.org/10.1177/0962280216680239">https://doi.org/10.1177/0962280216680239</a>. It will be referred as <b>p-kernel</b> method.
</p>
</li>
<li> <p>In case of the <b>I/D ROC curve</b>, a smooth approximation procedure (<b>smooth method</b>) is computed based as well on the kernel density estimation of the joint distribution function of the marker and time-to-event variables proposed in <a href="https://doi.org/10.1177/0962280217740786">https://doi.org/10.1177/0962280217740786</a> </p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">stRoc(data, t, H, bw, adj, tcr, meth, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix of data values with three columns: time-to-event, censoring status (0=censored/1=uncensored) and marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>point of time or vector of points where the time-dependent ROC curve is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>2x2 bandwidth matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>procedure for computing the bandwidth matrix. Most of the methods included at the <code>kde</code> function can be used: Hpi, Hpi.diag, Hlscv, Hlscv.diag, Hbcv, Hbcv.diag, Hscv, Hscv.diag, Hucv and Hucv.diag. Other considered methods are naive.pdf (diag(N^-1/5, N^-1/5)^2) and naive.cdf (diag(N^-1/3, N^-1/3)^2), where N is the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>adjusment parameter for calculating the bandwidth matrix. Default value 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcr</code></td>
<td>
<p>type of time-dependent ROC curve estimation that will be estimated:
</p>

<ul>
<li> <p>“C” for <b>C</b>umulative/Dynamic,
</p>
</li>
<li> <p>“I” for <b>I</b>ncident/Dynamic,
</p>
</li>
<li> <p>“B” for <b>B</b>oth time-dependent ROC curve estimations.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p>method for computing the estimation of the C/D ROC curve.The suitable values are:
</p>

<ul>
<li> <p>“1” for the smooth method,
</p>
</li>
<li> <p>“2” for the p-kernel method.</p>
</li>
</ul>
<p>As default value the smooth method is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>kde</code> function arguments can be used for estimating the bivariate kernel density function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>funcen</code> is called from each execution of function <code>stRoc</code>, in order to compute the kernel
density estimation of the joint distribution of the (Marker, Time-to-event) variable, therefore, the input
parameters in <code>funcen</code> are input parameters as well in <code>stRoc</code> and the same considerations apply.
</p>
<p>The matrix of bandwidths can be defined by using H=matrix() or automatically selected by the method indicated in <code>bw</code>.
</p>
<p>Given the matrix of bandwidths, H, the argument <code>adj</code> modifies it and the final matrix is adj^2 H.
</p>
<p>If <code>H</code> is missing, the naive.pdf method is used.
</p>
<p>If <code>tcr</code> is missing the C/D ROC curve estimation will be computed with the method indicated in <code>meth</code>.
</p>
<p>If no value has been placed in <code>meth</code> the smooth method will be used. The I/D ROC curve estimation will be always computed with the smooth method.
</p>


<h3>Value</h3>

<p>An object of class <code>sROCt</code> is returned. It is a list with the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>considered thresholds for the marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP</code></td>
<td>
<p>false-positive rate calculated at each point in <code>th</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>true-positive rate estimated at each point in <code>th</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>points where the time-dependent ROC curve is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>time-dependent ROC curve values computed at <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>time/s at which each time-dependent ROC curve estimation is computed. Each point ot time will appear as many times as the length of the vector of points <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>area under the corresponding time-dependent ROC curve estimation. As in the previous case, each value appears as many times as the length of the vector of points <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tcr</code></td>
<td>
<p>type of time-dependent ROC curve estimation computed,
</p>

<ul>
<li> <p>“C” - <b>C</b>umulative/Dynamic.
</p>
</li>
<li> <p>“I” - <b>I</b>ncident/Dynamic.
</p>
</li>
</ul>
<p>For each computed time-dependent ROC curve estimation this value is repeated as many times as the length of <code>p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>probabilities calculated for the individuals in the sample if the p-kernel method has been used for the estimation of the C/D ROC curve. This element is a matrix with the following columns:
</p>

<ul>
<li> <p><code>time</code> - single point of time at which the estimation each the C/D ROC curve has been computed.
</p>
</li>
<li> <p><code>obvt</code> - observed times for the individuals in the sample.
</p>
</li>
<li> <p><code>p</code> - estimations of the probabilities computed and allocated to each subject.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>References</h3>

<p>P. Martinez-Camblor and J. C. Pardo-Fernandez. Smooth time-dependent receiver operating characteristic
curve estimators. Statistical Methods in Medical Research, 27(3):651-674, 2018.<a href="https://doi.org/10.1177/0962280217740786">https://doi.org/10.1177/0962280217740786</a>.

</p>
<p>P. Martinez-Camblor, G. F-Bay?n, and S. P?rez-Fern?ndez. Cumulative/dynamic ROC curve estimation.
JOURNAL of Statistical Computation and Simulation, 86(17):3582-3594, 2016. <a href="https://doi.org/10.1080/00949655.2016.1175442">https://doi.org/10.1080/00949655.2016.1175442</a>.

</p>
<p>L. Li, T. Green, and B. Hu. A simple method to estimate the time-dependent receiver operating
characteristic curve and the area under the curve with right censored data. Statistical Methods in
Medical Research, 27(8), 2016. <a href="https://doi.org/10.1177/0962280216680239">https://doi.org/10.1177/0962280216680239</a>.

</p>
<p>T. Duong. Bandwidth matrices for multivariate kernel density estimation. Ph.D. Thesis, University of
Western, Australia, 2004. <a href="http://www.mvstat.net/tduong">http://www.mvstat.net/tduong</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(smoothROCtime)
require(KMsurv)

data(kidtran)

# Preparing data: a logarithmic transformation of the time-to-event variable is made
  DT &lt;- cbind(log(kidtran$time),kidtran$delta,kidtran$age)

# Point of Time
  t5 &lt;- log(5*365.25) # five years in logarithm scale

# Cumulative/dynamic ROC curve estimation
  rcd &lt;- stRoc(data=DT, t=t5, bw="Hpi", tcr="C", meth=2)

# Plot graphic
  plot(rcd$p, rcd$ROC, type="l", lwd=5, main="C/D ROC",xlab="FPR",ylab="TPR")
  lines(c(0,1),c(0,1),lty=2,col="gray")

</code></pre>


</div>