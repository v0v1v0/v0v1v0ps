<div class="container">

<table style="width: 100%;"><tr>
<td>ts_simplify</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simplify the tree sequence down to a given set of individuals</h2>

<h3>Description</h3>

<p>This function is a convenience wrapper around the <code>simplify</code> method
implemented in tskit, designed to work on tree sequence data simulated by
SLiM using the <span class="pkg">slendr</span> R package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ts_simplify(
  ts,
  simplify_to = NULL,
  keep_input_roots = FALSE,
  keep_unary = FALSE,
  keep_unary_in_individuals = FALSE,
  filter_nodes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>Tree sequence object of the class <code>slendr_ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify_to</code></td>
<td>
<p>A character vector of individual names. If NULL, all
explicitly remembered individuals (i.e. those specified via the
<code>schedule_sampling</code> function will be left in the tree sequence
after the simplification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_input_roots</code></td>
<td>
<p>Should the history ancestral to the MRCA of all
samples be retained in the tree sequence? Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_unary</code></td>
<td>
<p>Should unary nodes be preserved through simplification?
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_unary_in_individuals</code></td>
<td>
<p>Should unary nodes be preserved through
simplification if they are associated with an individual recorded in
the table of individuals? Default is <code>FALSE</code>. Cannot be set to
<code>TRUE</code> if <code>keep_unary</code> is also TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_nodes</code></td>
<td>
<p>Should nodes be reindexed after simplification? Default is
<code>TRUE</code>. See tskit's documentation for the Python method <code>simplify()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simplification process is used to remove redundant information from the
tree sequence and retains only information necessary to describe the
genealogical history of a set of samples.
</p>
<p>For more information on how simplification works in pyslim and tskit, see the
official documentation at
<a href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.simplify">https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.simplify</a>
and <a href="https://tskit.dev/pyslim/docs/latest/tutorial.html#simplification">https://tskit.dev/pyslim/docs/latest/tutorial.html#simplification</a>.
</p>
<p>A very clear description of the difference between remembering and retaining
and how to use these techniques to implement historical individuals (i.e.
ancient DNA samples) is in the pyslim documentation at
<a href="https://tskit.dev/pyslim/docs/latest/tutorial.html#historical-individuals">https://tskit.dev/pyslim/docs/latest/tutorial.html#historical-individuals</a>.
</p>


<h3>Value</h3>

<p>Tree-sequence object of the class <code>slendr_ts</code>, which serves as
an interface point for the Python module tskit using slendr functions with
the <code>ts_</code> prefix.
</p>


<h3>See Also</h3>

<p><code>ts_nodes</code> for extracting useful information about
individuals, nodes, coalescent times and geospatial locations of nodes on a
map
</p>


<h3>Examples</h3>

<pre><code class="language-R">
init_env()

# load an example model with an already simulated tree sequence
slendr_ts &lt;- system.file("extdata/models/introgression_slim.trees", package = "slendr")
model &lt;- read_model(path = system.file("extdata/models/introgression", package = "slendr"))

ts &lt;- ts_load(slendr_ts, model)
ts

# simplify tree sequence to sampled individuals
ts_simplified &lt;- ts_simplify(ts)

# simplify to a subset of sampled individuals
ts_small &lt;- ts_simplify(ts, simplify_to = c("CH_1", "NEA_1", "NEA_2", "AFR_1",
                                            "AFR_2", "EUR_1", "EUR_2"))

ts_small
</code></pre>


</div>