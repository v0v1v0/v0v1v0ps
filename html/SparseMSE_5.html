<div class="container">

<table style="width: 100%;"><tr>
<td>buildmodelmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build the model matrix based on particular data, as required to check for identifiability and existence of the maximum likelihood estimate</h2>

<h3>Description</h3>

<p>This routine builds a model matrix as required by the linear program check <code>checkident</code> and checks if the matrix is of full rank.
In addition, for each individual list, and for each pair of lists included in the model,
it returns the total count of individuals appearing on the specific list or lists whether or not in combination with other lists.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildmodelmatrix(zdat, mX = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list parameters to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list parameters are included. If <code>mX = NULL</code>, no such parameters are included and
the main effects model is fitted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>modmat</code> The matrix that maps the parameters in the model (excluding any corresponding to non-overlapping lists) to the log expected value
of the counts of capture histories that do not contain non-overlapping pairs in the data.
</p>
<p><code>tvec</code> A vector indexed by the parameters in the model, excluding those corresponding to non-overlapping pairs of lists.  For each parameter
the vector contains the total count of individuals in all the capture histories that include both the lists indexed by that parameter.
</p>
<p><code>rankdef</code> The column rank deficiency of the matrix <code>modmat</code>. If <code>rankdef = 0</code>, the matrix has full column rank.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NewOrl)
buildmodelmatrix(NewOrl, mX=NULL)

</code></pre>


</div>