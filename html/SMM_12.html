<div class="container">

<table style="width: 100%;"><tr>
<td>simulMk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of a k-th order Markov chain
</h2>

<h3>Description</h3>

<p>Simulation of a k-th order Markov chain starting from a transition matrix and an initial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulMk(E, nbSeq, lengthSeq, Ptrans, init, k, File.out = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>

<p>Vector of state space
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbSeq</code></td>
<td>

<p>Number of simulated sequences 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengthSeq</code></td>
<td>

<p>Vector of size nbSeq containing the lengths of each simulated sequence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ptrans</code></td>
<td>

<p>Matrix of transition probabilities of size (S^(k))xS, with S = length(E) 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>Vector of initial distribution of length S
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>Order of the Markov chain
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>File.out</code></td>
<td>

<p>Name of the fasta file for saving the sequences.  
If File.out = NULL, no file is created
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sizes of init and Ptrans depend on S, the length of E.
The rows of the transition matrix sums to 1.
</p>
<p>For k=1, the transition matrix is defined by <code class="reqn">Ptrans(i,j) = P(X_{m+1} = j | X_m = i)</code> and 
the initial distribution is <code class="reqn">init = P(X_1 = i)</code>. For k &gt; 1 we have similar expressions.
</p>
<p>The first element of lengthSeq corresponds to the length of the first sequence and so on.
</p>


<h3>Value</h3>

<p>simulMk returns a list of sequences of size lengthSeq simulated with a k-th order Markov chain of parameters init and Ptrans with state space E.
</p>
<p>If the parameter File.out is not equal to NULL, a file in fasta format containing the sequence(s) will be created.
</p>


<h3>Author(s)</h3>

<p>Vlad Stefan Barbu, barbu@univ-rouen.fr <br> Caroline Berard, caroline.berard@univ-rouen.fr <br> Dominique Cellier, dominique.cellier@laposte.net <br> Mathilde Sautreuil, mathilde.sautreuil@etu.univ-rouen.fr <br> Nicolas Vergne, nicolas.vergne@univ-rouen.fr 
</p>


<h3>See Also</h3>

<p>estimMk,
simulSM,
estimSM
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example 1 ###
# Second order model with state space {a,c,g,t}
E &lt;- c("a","c","g","t")
S = length(E)
init.distribution &lt;- c(1/6,1/6,5/12,3/12)
k&lt;-2
p &lt;- matrix(0.25, nrow = S^k, ncol = S)

# We simulate 3 sequences of size 1000, 10000 and 2000 respectively.
simulMk(E = E, nbSeq = 3, lengthSeq = c(1000, 10000, 2000), Ptrans = p, 
init = init.distribution, k = k)

### Example 2 ###
# first order model with state space {1,2,3}
E &lt;- c(1,2,3)
S &lt;- length(E)
init.distr &lt;- rep(1/S, 3)
p &lt;- matrix(c(0.3,0.2,0.5,0.1,0.6,0.3,0.2,0.4,0.4), nrow = 3, byrow = TRUE)

# We simulate one sequence of size 100
simulMk(E = E, nbSeq = 1, lengthSeq = 100, Ptrans = p, init = init.distr, k = 1)
</code></pre>


</div>