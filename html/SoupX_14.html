<div class="container">

<table style="width: 100%;"><tr>
<td>plotMarkerMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ratio of observed to expected counts on reduced dimension map</h2>

<h3>Description</h3>

<p>Given some reduced dimensional representation of the data (such as UMAP or tSNE) that has been calculated however you would like, this provides a way to visualise how likely a set of genes are to be soup derived on that map.  That is, given a set of genes, this function calculates how many counts would be expected if that droplet were nothing but soup and compares that to the observed count.  This is done via a log2 ratio of the two values.  A Poisson test is performed and points that have a statistically significant enrichment over the background (at 5
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMarkerMap(
  sc,
  geneSet,
  DR,
  ratLims = c(-2, 2),
  FDR = 0.05,
  useToEst = NULL,
  pointSize = 2,
  pointShape = 21,
  pointStroke = 0.5,
  naPointSize = 0.25
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>SoupChannel object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneSet</code></td>
<td>
<p>A vector with the names of the genes to aggregate and plot evidence for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DR</code></td>
<td>
<p>A data.frame, with rows named by unique cell IDs (i.e., &lt;ChannelName&gt;_&lt;Barcode&gt;) the first two columns of which give the coordinates of each cell in some reduced dimension representation of the data.  Try and fetch automatically if missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratLims</code></td>
<td>
<p>Truncate log ratios at these values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR</code></td>
<td>
<p>False Discovery Rate for statistical test of enrichment over background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useToEst</code></td>
<td>
<p>A vector (usually obtained from <code>estimateNonExpressingCells</code>), that will be used to mark cells instead of the usual Poisson test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointSize</code></td>
<td>
<p>Size of points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointShape</code></td>
<td>
<p>Shape of points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointStroke</code></td>
<td>
<p>Stroke size for points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naPointSize</code></td>
<td>
<p>Point size for NAs.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 containing the plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">gg = plotMarkerMap(scToy,'CD7')
</code></pre>


</div>