<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate single-case design</h2>

<h3>Description</h3>

<p>This functions takes an scdf and extracts design parameters. The resulting
object can be used to randomly create new scdf files with the same underlying
parameters. This is useful for Monte-Carlo studies and bootstrapping
procedures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_design(
  data,
  dvar,
  pvar,
  mvar,
  s = NULL,
  rtt = NULL,
  overall_effects = FALSE,
  overall_rtt = TRUE,
  model = "JW",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A single-case data frame. See <code>scdf()</code> to learn about this
format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dvar</code></td>
<td>
<p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvar</code></td>
<td>
<p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mvar</code></td>
<td>
<p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The standard deviation depicting the between case variance of the
overall performance. If more than two single-cases are included in the
scdf, the variance is estimated if s is set to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtt</code></td>
<td>
<p>The reliability of the measurements. The reliability is estimated
when rtt = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overall_effects</code></td>
<td>
<p>If TRUE, trend, level, and slope effect estimations
will be identical for each case. If FALSE, effects are estimated for each
case separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overall_rtt</code></td>
<td>
<p>Ignored when <code>rtt</code> is set. If TRUE, rtt estimations will
be based on all cases and identical for each case. If FALSE rtt is
estimated for each case separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model used for calculating the dummy parameters (see Huitema &amp;
McKean, 2000). Default is <code>model = "W"</code>. Possible values are: <code>"B&amp;L-B"</code>,
<code>"H-M"</code>, <code>"W"</code>, and deprecated <code>"JW"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the plm function used for parameter
estimation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of parameters for each single-case. Parameters include name,
length, and starting measurement time of each phase, trend, level, and
slope effects for each phase, start value, standard deviation, and
reliability for each case.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create a random scdf with predefined parameters
set.seed(1234)
design &lt;- design(
  n = 10, trend = -0.02,
  level = list(0, 1), rtt = 0.8,
  s = 1
)
scdf&lt;- random_scdf(design)

# Estimate the parameters based on the scdf and create a new random scdf
# based on these estimations
design_est &lt;- estimate_design(scdf, rtt = 0.8)
scdf_est &lt;- random_scdf(design_est)

# Analyze both datasets with an hplm model. See how similar the estimations
# are:
hplm(scdf, slope = FALSE)
hplm(scdf_est, slope = FALSE)

# Also similar results for pand and randomization tests:
pand(scdf)
pand(scdf_est)
rand_test(scdf)
rand_test(scdf_est)
</code></pre>


</div>