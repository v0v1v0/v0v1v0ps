<div class="container">

<table style="width: 100%;"><tr>
<td>mkSpCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for calculating univariate and multivariate covariance matrices</h2>

<h3>Description</h3>

<p>The function <code>mkSpCov</code> calculates a spatial covariance matrix
given spatial locations and spatial covariance parameters. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mkSpCov(coords, K, Psi, theta, cov.model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times 2</code> matrix of the observation coordinates
in <code class="reqn">R^2</code> (e.g., easting and northing). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the <code class="reqn">q \times q</code> spatial cross-covariance
matrix. For a univariate model this corresponds to the partial sill,
<code class="reqn">\sigma^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>the <code class="reqn">q \times q</code> non-spatial covariance
matrix. For a univariate model this corresponds to the nugget,
<code class="reqn">\tau^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a vector of <code class="reqn">q</code> spatial decay parameters. If
<code>cov.model</code> is <code>"matern"</code> then <code>theta</code> is a vector of
length <code class="reqn">2\times q</code> with the spatial decay parameters in the first
<code class="reqn">q</code> elements and the spatial smoothness parameters in the last
<code class="reqn">q</code> elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.model</code></td>
<td>
<p>a quoted keyword that specifies the covariance
function used to model the spatial dependence structure among the
observations.  Supported covariance model key words are:
<code>"exponential"</code>, <code>"matern"</code>, <code>"spherical"</code>, and
<code>"gaussian"</code>.  See below for details.  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Covariance functions return the covariance
<code class="reqn">C(h)</code> between a pair locations separated by distance <code class="reqn">h</code>. The covariance function can be written as a product of a variance parameter <code class="reqn">\sigma^2</code> and a positive definite <em>correlation function</em> <code class="reqn">\rho(h)</code>: <code class="reqn">C(h) = \sigma^2 \rho(h)</code>, see, e.g.,
Banerjee et al. (2004) p. 27 for more details. The expressions of the correlations functions available in <span class="pkg">spBayes</span> are given below. More will be added upon request.
</p>
<p>For all correlations functions, <code class="reqn">\phi</code> is the spatial <em>decay</em> parameter.
Some of the correlation functions will have an extra parameter
<code class="reqn">\nu</code>, the <em>smoothness</em> parameter.
<code class="reqn">K_\nu(x)</code> denotes the modified Bessel
function of the third kind of order <code class="reqn">\nu</code>. See
documentation of the function <code>besselK</code> for further details.
The following functions are valid for <code class="reqn">\phi&gt;0</code> and <code class="reqn">\nu&gt;0</code>, unless stated otherwise.
</p>
<p><b>gaussian</b><br></p>
<p style="text-align: center;"><code class="reqn">\rho(h) = \exp[-(\phi h)^2]</code>
</p>
 
<p><b>exponential</b><br></p>
<p style="text-align: center;"><code class="reqn">\rho(h) = \exp(-\phi h)</code>
</p>

<p><b>matern</b><br></p>
<p style="text-align: center;"><code class="reqn">\rho(h) =
    \frac{1}{2^{\nu-1}\Gamma(\nu)}(\phi h)^\nu
    K_{\nu}(\phi h)</code>
</p>
 
<p><b>spherical</b><br></p>
<p style="text-align: center;"><code class="reqn">\rho(h) = \left\{ \begin{array}{ll}
    1 - 1.5\phi h + 0.5(\phi h)^3
    \mbox{ , if $h$ &lt; $\frac{1}{\phi}$} \cr
    0    \mbox{ ,  otherwise}
    \end{array} \right.</code>
</p>



<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>the <code class="reqn">nq\times nq</code> spatial covariance matrix. </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Andrew O. Finley <a href="mailto:finleya@msu.edu">finleya@msu.edu</a>, <br>
Sudipto Banerjee <a href="mailto:baner009@umn.edu">baner009@umn.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##A bivariate spatial covariance matrix

n &lt;- 2 ##number of locations
q &lt;- 2 ##number of responses at each location
nltr &lt;- q*(q+1)/2 ##number of triangular elements in the cross-covariance matrix

coords &lt;- cbind(runif(n,0,1), runif(n,0,1))

##spatial decay parameters
theta &lt;- rep(6,q)

A &lt;- matrix(0,q,q)
A[lower.tri(A,TRUE)] &lt;- rnorm(nltr, 5, 1)
K &lt;- A%*%t(A)

Psi &lt;- diag(1,q)

C &lt;- mkSpCov(coords, K, Psi, theta, cov.model="exponential")

## End(Not run)
</code></pre>


</div>