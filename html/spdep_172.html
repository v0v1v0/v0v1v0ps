<div class="container">

<table style="width: 100%;"><tr>
<td>LOSH.cs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chi-square based test for local spatial heteroscedasticity</h2>

<h3>Description</h3>

<p>The function implements the chi-square based test statistic for local spatial heteroscedasticity (LOSH) as proposed by Ord &amp; Getis (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LOSH.cs(x, listw, zero.policy = attr(listw, "zero.policy"), na.action = na.fail, 
                 p.adjust.method = "none", spChk = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted. If <code>na.pass</code> is used, zero is substituted for NA values in calculating the spatial lag. (Note that na.exclude will only work properly starting from R 1.9.0, na.omit and na.exclude assign the wrong classes in 1.8.*)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>a character string specifying the probability value adjustment for multiple tests, default "none"; see <code>p.adjustSP</code>. Note that the number of multiple tests for each region is only taken as the number of neighbours + 1 for each region, rather than the total number of regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test uses <em>a = 2</em> (see <code>LOSH</code>) because chi-square based inference is not applicable with other exponents. The function makes use of <code>LOSH</code> in its calculations.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Hi</code></td>
<td>
<p>LOSH statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E.Hi</code></td>
<td>
<p>expectation of LOSH</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.Hi</code></td>
<td>
<p>variance of LOSH</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z.Hi</code></td>
<td>
<p>the approximately chi-square distributed test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_bar_i</code></td>
<td>
<p>local spatially weighted mean values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ei</code></td>
<td>
<p>residuals about local spatially weighted mean values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pr()</code></td>
<td>
<p>p-values for <code>Hi</code> obtained from a non-central Chi-square distribution with <code class="reqn">2/Var.Hi</code> degrees of freedom</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>René Westerholt <a href="mailto:rene.westerholt@tu-dortmund.de">rene.westerholt@tu-dortmund.de</a></p>


<h3>References</h3>

<p>Ord, J. K., &amp; Getis, A. 2012. Local spatial heteroscedasticity (LOSH), The Annals of Regional Science, 48 (2), 529–539.
</p>


<h3>See Also</h3>

<p><code>LOSH</code>, <code>LOSH.mc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">    data(boston, package="spData")
    resLOSH &lt;- LOSH.cs(boston.c$NOX, nb2listw(boston.soi))
    hist(resLOSH[,"Hi"])
    mean(resLOSH[,"Hi"])
</code></pre>


</div>