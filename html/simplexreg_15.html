<div class="container">

<table style="width: 100%;"><tr>
<td>residuals.simplexreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract residuals for simplexreg Objects</h2>

<h3>Description</h3>

<p>Methods for extracting various types of residuals from simplex regression, from 
approximate Pearson residuals, standard Pearson residuals and standardise score residuals to 
adjusted dependent variable suggested by McCullagh and Nelder (1989). The first three can be 
used to examine mean-variance relation while the last aims to test the link function.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'simplexreg'
residuals(object, type = c("appstdPerr", "stdPerr", "stdscor", "adjvar"), 
   	...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>fitted model object of class "simplexreg"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character specifying types of residuals:approximate Pearson residual (<code>appstdPerr</code>),
standard Pearson residual (<code>stdPerr</code>), adjusted dependent variable <code class="reqn">s_i</code> (<code>adjvar</code>).
Details are given in 'Details'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Pearson residual takes the form
</p>
<p style="text-align: center;"><code class="reqn">r_i^P=\frac{y_i-\hat{\mu}_i}{\hat{\tau}_i}</code>
</p>

<p>where <code class="reqn">\hat{\mu}_i</code> is the fitted mean parameter and details about calculation of
<code class="reqn">\tau</code> is given in Jorgensen (1997). When the dispersion parameter <code class="reqn">\sigma^2</code>
(see <code>simplex</code>) is large the variance of response approaches to <code class="reqn">\mu(1-\mu)</code>
and this leads to the approximate Pearson residual
</p>
<p style="text-align: center;"><code class="reqn">r_i^a=\frac{y_i-\hat{\mu}_i}{\sqrt{\hat{\mu}_i(1-\hat{\mu}_i)}}</code>
</p>

<p>Plot of the standardised score residuals,
</p>
<p style="text-align: center;"><code class="reqn">r_i^S=\frac{u_i}{\sqrt{var(u_i)}}</code>
</p>

<p>where <code class="reqn">u_i</code> is the score function, can also detect model assumption violation. 
Details can be found in Song <em>et al.</em> (2004). 	
The adjusted dependent variable suggested by McCullagh and Nelder (1989) could be employed
as an informal check for the link function,
</p>
<p style="text-align: center;"><code class="reqn">s_i = g(\mu_i) + (\frac{3\sigma^4}{\mu_i(1-\mu_i)}+\frac{\sigma^2}{V(\mu_i)})^{-1/2} u(y_i;\mu_i)</code>
</p>

<p>where <code class="reqn">u(y_i;\mu_i)</code> and <code class="reqn">V(\mu_i)</code> are the score function and variance function. 
</p>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106–116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>. London: Chapman and Hall
</p>
<p>McCullagh, P and Nelder J. (1989)
<em> Generalized Linear Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540–553
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1–21

</p>


<h3>See Also</h3>

<p><code>summary.simplexreg</code>, <code>simplex</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## fit the model
data("sdac", package="simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age,
  link = "logit", data = sdac)
	
data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time,
  link = "logit", corr = "AR1", id = ID, data = retinal)  

## extract the residuals
res &lt;- residuals(sim.glm2, type = "stdPerr")
res &lt;- residuals(sim.gee2, type = "adjvar")
</code></pre>


</div>