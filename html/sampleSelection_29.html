<div class="container">

<table style="width: 100%;"><tr>
<td>predict.selection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for fitted sample selection models</h2>

<h3>Description</h3>

<p>Calculate predicted values for sample selection models
fitted with function <code>selection</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   ## S3 method for class 'selection'
predict( object, newdata = NULL,
   part = ifelse( type %in% c( "unconditional", "conditional" ),
      "outcome", "selection" ),
   type = "unconditional", ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted object of class <code>selection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables
with which to predict.
If omitted, the fitted linear predictors or the fitted response values
are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>character string indicating for which equation
the predicted variables should be calculated:
<code>"selection"</code> for the predicted values of the selection equation and
<code>"outcome"</code> for the predicted values of the outcome equation;
this argument is automatically chosen depending on the value
of argument <code>type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if argument <code>type</code> is <code>"link"</code>
and argument <code>part</code> is <code>"selection"</code>,
the linear predictors of the selection equation are returned;
if argument <code>type</code> is <code>"response"</code>
and argument <code>part</code> is <code>"selection"</code>,
the predicted probabilities of the selection equation are returned;
if argument <code>type</code> is <code>"unconditional"</code>
and argument <code>part</code> is <code>"outcome"</code>,
the unconditional expectations are returned,
i.e. <code>E[y|X] = X %*% beta</code>;
if argument <code>type</code> is <code>"conditional"</code>
and argument <code>part</code> is <code>"outcome"</code>,
the conditional expectations are returned,
i.e. <code>E[y|X,Z,w=1] = X %*% beta
      + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In most cases, a numeric vector of the predicted values is returned.
However, there are three exceptions:
(i) when predicting the unconditional expectations of a Tobit-5 model,
a matrix with two columns is returned,
where the two columns correspond to the two outcome equations
(E[yo1] and E[yo2]);
(ii) when predicting the conditional expectations of a Tobit-2 model,
a matrix with two columns is returned,
where the first column returns the expectations
conditional on the observation being not selected (E[yo|ys=0]),
while the second column returns the expectations
conditional on the observation being selected (E[yo|ys=1]);
(iii) when predicting the conditional expectations of a Tobit-5 model,
a matrix with four columns is returned,
where the first two columns return the conditional expectations
of the first outcome equation (E[yo1|ys=0] and E[yo1|ys=1])
and the last two columns return the conditional expectations
of the second outcome equation (E[yo2|ys=0] and E[yo2|ys=1]).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen and ‘fg nu’
(the code is partly based on the code posted by ‘fg nu’ at
<a href="https://stackoverflow.com/questions/14005788/predict-function-for-heckman-model">https://stackoverflow.com/questions/14005788/predict-function-for-heckman-model</a>)
</p>


<h3>See Also</h3>

<p><code>selection</code>, <code>predict</code>,
<code>predict.probit</code>, <code>residuals.selection</code>,
and <code>selection-methods</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Greene( 2003 ): example 22.8, page 786
data( Mroz87 )
Mroz87$kids  &lt;- ( Mroz87$kids5 + Mroz87$kids618 &gt; 0 )

# ML estimation
m &lt;- selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
   wage ~ exper + I( exper^2 ) + educ + city, Mroz87 )
   
predict( m )
predict( m, type = "conditional" ) 
predict( m, type = "link" ) 
predict( m, type = "response" ) 
predict( m, newdata = Mroz87[ 3:9, ] ) 
</code></pre>


</div>