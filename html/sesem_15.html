<div class="container">

<table style="width: 100%;"><tr>
<td>runModels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Run a spatial SEM analysis
</h2>

<h3>Description</h3>

<p>Given a path model (spatial_model) specified using lavaan syntax, and a list object containing covariance matrices generated by make.covar, runs an sem model using function sem from the lavaan package for each lag distance bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runModels(spatial_model,covdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spatial_model</code></td>
<td>

<p>a path model specified using lavaan syntax. See the <code>lavaan</code> help pages for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covdata</code></td>
<td>

<p>a list object containing covariance matrices and other descriptors as produced by make.covar
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a path model (spatial_model) specified using lavaan syntax, and a list object containing covariance matrices generated by make.covar, runs an sem model using function sem from the lavaan package for each lag distance bin. Produces a list object containing the model results.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>1</code></td>
<td>
<p>a table of model fit estimates for each model. See the lavaan documentation for an explanation of each value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2</code></td>
<td>
<p>table containing a vector of parameter numbers and a character vector containing the names of the paths included in each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>3</code></td>
<td>
<p>a table of unstandardized path coefficient estimates for each path in each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>4</code></td>
<td>
<p>standard error of unstandardized path coefficient estimates for each path in each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>5</code></td>
<td>
<p>p-values for each unstandardized path coefficient estimate for each path in each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>6</code></td>
<td>
<p>standardized parameter estimates for each path in each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>7</code></td>
<td>
<p>character vector containing list of names of dependent variables within the models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>8</code></td>
<td>
<p>r-square values for each dependent variable in each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>9</code></td>
<td>
<p>names of each path for which there is a modification index value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>10</code></td>
<td>
<p>modification index values for each potential path addition for each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>11</code></td>
<td>
<p>a copy of the bin.summary table in the input covdata object</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Should model convergence fail for certain lag bins, those bins will be skipped and no results written.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code>sem</code>, <code>make.covar</code>, <code>modelsummary</code>, <code>plotmodelfit</code>, <code>plotpath</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data=truelove
truelove_red&lt;-truelove[c(1:60),c(1:7)]
distancematrix&lt;-calc.dist(truelove_red)
Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=10)
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

plotbin(distancematrix,binsize)

covariances&lt;-make.covar(truelove_red,distancematrix,binsize,binname)
covariances

# reduced path model for the truelove dataset

spatial_model&lt;-'
	N_Fix ~ Bryoph + Lich + SoilCrust
	SoilCrust ~ Bryoph + Lich	
	Lich ~ Bryoph + Moisture
	Bryoph ~ Moisture
	'

results&lt;-runModels(spatial_model,covariances)
plotmodelfit(results,rmsea_err=FALSE)
</code></pre>


</div>