<div class="container">

<table style="width: 100%;"><tr>
<td>propagate.spectral</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function that propagates a state (spectral coefficients). 
</h2>

<h3>Description</h3>

<p>Function that propagates the vector 'alphat'. This is
equivalent to multiplying 'alphat' with the propagator matrix G. It is a
lot faster though, due to the block-diagonal structure of G. This is a
wrapper function of a C function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">propagate.spectral(alphat,spateFT=NULL,n=NULL,Gvec=NULL,par=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alphat</code></td>
<td>

<p>A vector of spectral coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spateFT</code></td>
<td>

<p>A 'spateFT' obtained from 'spate.init'. Either this or 'n' needs to
be given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of points on each axis. n x n is the total number of spatial
points. Either this or 'spateFT' needs to be given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gvec</code></td>
<td>

<p>The propagator matrix G in vector format obtained from
'get.propagator.vec'. If 'Gvec' is not given, it is constructed based on 'par'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>Parameters for the SPDE in the following order: rho_0, sigma^2, zeta,
rho_1, gamma, alpha, mu_x, mu_y, tau^2. If 'Gvec' is not given, 'par'
needs to be given.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of propagated coefficients G*alphat.
</p>


<h3>Author(s)</h3>

<p>Fabio Sigrist
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 50
spec &lt;- matern.spec(wave=spate.init(n=n,T=1)$wave,n=n,rho0=0.05,sigma2=1,norm=TRUE)
alphat &lt;- sqrt(spec)*rnorm(n*n)
##Propagate initial state
wave &lt;- wave.numbers(n)
Gvec &lt;- get.propagator.vec(wave=wave$wave,indCos=wave$indCos,zeta=0.1,rho1=0.02,gamma=2,
                  alpha=pi/4,muX=0.2,muY=0.2,dt=1,ns=4)
alphat1 &lt;- propagate.spectral(alphat,n=n,Gvec=Gvec)

opar &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,2))
image(1:n,1:n,matrix(real.fft(alphat,n=n,inv=FALSE),nrow=n),main="Whittle
field",xlab="",ylab="",col=cols())
image(1:n,1:n,matrix(real.fft(alphat1,n=n,inv=FALSE),nrow=n),main="Propagated
field",xlab="",ylab="",col=cols())
par(opar) # Reset par() settings
</code></pre>


</div>