<div class="container">

<table style="width: 100%;"><tr>
<td>cpGModule</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify cell phenotype activated gene module</h2>

<h3>Description</h3>

<p>Mining activated gene modules in specific cell phenotype.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpGModule(
  network.data,
  cellset,
  nperm = 100,
  cut.pvalue = 0.01,
  cut.fdr = 0.05,
  parallel.cores = 2,
  rwr.gamma = 0.7,
  normal_dist = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>network.data</code></td>
<td>
<p>Network data constructed by the <code>ConNetGNN</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellset</code></td>
<td>
<p>A vector of cell id. The specified cell set, which will be used as the restart set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of random permutations. Default: <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.pvalue</code></td>
<td>
<p>The threshold of P-value, and genes below this threshold are regarded as gene modules activated by the cell set. Default: <code>0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.fdr</code></td>
<td>
<p>The threshold of false discovery rate (FDR), and genes below this threshold are regarded as gene modules activated by the cell set. Default: <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.cores</code></td>
<td>
<p>Number of processors to use when doing the calculations in parallel (default: <code>2</code>). If <code>parallel.cores=0</code>, then it will use all available core processors unless we set this argument with a smaller number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rwr.gamma</code></td>
<td>
<p>Restart parameter. Default: <code>0.7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal_dist</code></td>
<td>
<p>Whether to use pnorm to calculate P values. Default: <code>TRUE</code>.Note that if normal_dist is FALSE, we need to increase nperm (we recommend 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Gives information about each step. Default: <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>cpGModule
</p>
<p>The <code>cpGModule</code> function takes a user-defined cell set as a restart set to automatically
identify activated gene modules. A perturbation analysis was used to calculate a significant P-value for each gene.
The <code>Benjamini &amp; Hochberg (BH)</code> method was used to adjust the P-value to obtain the FDR.
Genes with a significance level less than the set threshold are considered as cell phenotype activated gene modules.
</p>


<h3>Value</h3>

<p>A data frame contains four columns:
</p>

<dl>
<dt>Genes</dt>
<dd>
<p>Gene ID.</p>
</dd>
<dt>AS</dt>
<dd>
<p>Activity score.</p>
</dd>
<dt>Pvalue</dt>
<dd>
<p>Significant P-value.</p>
</dd>
<dt>FDR</dt>
<dd>
<p>False discovery rate.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">require(parallel)
require(stats)

# Load the result of the ConNetGNN function.
data(ConNetGNN_data)
data(Hv_exp)

# Construct the cell set corresponding to 0h.
index&lt;-grep("0h",colnames(Hv_exp))
cellset&lt;-colnames(Hv_exp)[index]
cpGModule_data&lt;-cpGModule(ConNetGNN_data,cellset,nperm=10,parallel.cores=1)
</code></pre>


</div>