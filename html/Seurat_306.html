<div class="container">

<table style="width: 100%;"><tr>
<td>PseudobulkExpression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudobulk Expression</h2>

<h3>Description</h3>

<p>Normalize the count data present in a given assay.
</p>
<p>Returns a representative expression value for each identity class
</p>


<h3>Usage</h3>

<pre><code class="language-R">PseudobulkExpression(object, ...)

## S3 method for class 'Assay'
PseudobulkExpression(
  object,
  assay,
  category.matrix,
  features = NULL,
  layer = "data",
  slot = deprecated(),
  verbose = TRUE,
  ...
)

## S3 method for class 'StdAssay'
PseudobulkExpression(
  object,
  assay,
  category.matrix,
  features = NULL,
  layer = "data",
  slot = deprecated(),
  verbose = TRUE,
  ...
)

## S3 method for class 'Seurat'
PseudobulkExpression(
  object,
  assays = NULL,
  features = NULL,
  return.seurat = FALSE,
  group.by = "ident",
  add.ident = NULL,
  layer = "data",
  slot = deprecated(),
  method = "average",
  normalization.method = "LogNormalize",
  scale.factor = 10000,
  margin = 1,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods such as <code>CreateSeuratObject</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>The name of the passed assay - used primarily for warning/error messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category.matrix</code></td>
<td>
<p>A matrix defining groupings for pseudobulk expression 
calculations; each column represents an identity class, and each row a sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Features to analyze. Default is all features in the assay</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>Layer(s) to user; if multiple are given, assumed to follow
the order of 'assays' (if specified) or object's assays</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>(Deprecated) See <code>layer</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print messages and show progress bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assays</code></td>
<td>
<p>Which assays to use. Default is all assays</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.seurat</code></td>
<td>
<p>Whether to return the data as a Seurat object. Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>Categories for grouping (e.g, "ident", "replicate", 
"celltype"); "ident" by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.ident</code></td>
<td>
<p>(Deprecated) See group.by</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for calculating pseudobulk expression; one of: 
"average" or "aggregate"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization.method</code></td>
<td>
<p>Method for normalization, see <code>NormalizeData</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.factor</code></td>
<td>
<p>Scale factor for normalization, see <code>NormalizeData</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>Margin to perform CLR normalization, see <code>NormalizeData</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns object after normalization
</p>
<p>Returns a matrix with genes as rows, identity classes as columns.
If return.seurat is TRUE, returns an object of class <code>Seurat</code>.
</p>


</div>