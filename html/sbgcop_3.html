<div class="container">

<table style="width: 100%;"><tr>
<td>sbgcop.mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Bayesian Gaussian copula estimation and imputation</h2>

<h3>Description</h3>

<p><code>sbgcop.mcmc</code> is used to semiparametrically estimate the parameters of
a Gaussian copula. It can be used for posterior inference on the copula
parameters, and for imputation of missing values in a matrix of ordinal
and/or continuous values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sbgcop.mcmc(Y, S0 = diag(dim(Y)[2]), n0 = dim(Y)[2] + 2, nsamp = 100,
  odens = max(1, round(nsamp/1000)), impute = any(is.na(Y)),
  plugin.threshold = 100, plugin.marginal = (apply(Y, 2, function(x) {    
  length(unique(x)) }) &gt; plugin.threshold), seed = 1, verb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an n x p matrix. Missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>a p x p positive definite matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>a positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>number of iterations of the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odens</code></td>
<td>
<p>output density: number of iterations between saved samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute</code></td>
<td>
<p>save posterior predictive values of missing data(TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plugin.threshold</code></td>
<td>
<p>if the number of unique values of a variable exceeds
this integer, then plug-in the empirical distribution as the marginal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plugin.marginal</code></td>
<td>
<p>a logical of length p. Gives finer control over which
margins to use the empirical distribution for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer for the random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>print progress of MCMC(TRUE/FALSE)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces MCMC samples from the posterior distribution of a
correlation matrix, using a scaled inverse-Wishart prior distribution and an
extended rank likelihood. It also provides imputation for missing values in
a multivariate dataset.
</p>


<h3>Value</h3>

<p>An object of class <code>psgc</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>C.psamp </code></td>
<td>
<p>an array of size p x p x <code>nsamp/odens</code>, consisting of
posterior samples of the correlation matrix.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.pmean </code></td>
<td>
<p>the original
datamatrix with imputed values replacing missing data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.impute </code></td>
<td>
<p> an
array of size n x p x <code>nsamp/odens</code>, consisting of copies of the
original data matrix, with posterior samples of missing values included. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LPC </code></td>
<td>
<p>the log-probability of the latent variables at each saved
sample. Used for diagnostic purposes.  </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>References</h3>

<p>http://www.stat.washington.edu/hoff/
</p>


<h3>Examples</h3>

<pre><code class="language-R">
fit&lt;-sbgcop.mcmc(swiss)
summary(fit)
plot(fit)

</code></pre>


</div>