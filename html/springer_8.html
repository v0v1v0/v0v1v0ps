<div class="container">

<table style="width: 100%;"><tr>
<td>springer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit the model with given tuning parameters</h2>

<h3>Description</h3>

<p>This function performs penalized variable selection for longitudinal data based on generalized estimating equation (GEE) or quadratic inference functions (QIF) with a given value of lambda.
Typical usage is to first obtain the optimal lambda using cross validation, then provide it to the springer function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">springer(
  clin = NULL,
  e,
  g,
  y,
  beta0,
  func,
  corr,
  structure,
  lam1,
  lam2,
  maxits = 30,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clin</code></td>
<td>
<p>a matrix of clinical covariates. The default value is NULL. Whether to include the clinical covariates is decided by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>a matrix of environment factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a matrix of genetic factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the longitudinal response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>the initial coefficient vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>the framework to obtain the score equation.  Two choices are available: "GEE" and "QIF".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>the working correlation structure adopted in the estimation algorithm. The springer provides three choices for the
working correlation structure: exchangeable, AR-1,and independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure</code></td>
<td>
<p>Three choices are available for structured variable selection. "bilevel" for sparse-group selection on both group-level and individual-level. "group" for selection on group-level only. "individual" for selection on individual-level only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam1</code></td>
<td>
<p>the tuning parameter <code class="reqn">\lambda_1</code> for individual-level penalty applied to genetic factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam2</code></td>
<td>
<p>the tuning parameter <code class="reqn">\lambda_2</code> for group-level penalty applied to gene-environment interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxits</code></td>
<td>
<p>the maximum number of iterations that is used in the estimation algorithm. The default value is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance level. Coefficients with absolute values that are smaller than the tolerance level will be set to zero. The adhoc value can be chosen as 0.001.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Look back to the data model described in "<code>dat</code>":
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij}= \alpha_0 + \sum_{m=1}^{t}\theta_m Clin_{ijm} + \sum_{u=1}^{q}\alpha_u E_{iju} + \sum_{v=1}^{p}\eta_v^\top Z_{ijv}+\epsilon_{ij},</code>
</p>

<p>where <code class="reqn">Z_{ijv}</code> contains the <code class="reqn">v</code>th genetic main factor and its interactions with the <code class="reqn">q</code> environment factors for the <code class="reqn">j</code>th measurement on the <code class="reqn">i</code>th subject
and <code class="reqn">\eta_{v}</code> is the corresponding coefficient vector of length <code class="reqn">1+q</code>.
</p>
<p>When structure="bilevel", variable selection for genetic main effects and gene-environment interactions under the longitudinal response will be conducted on both individual and group levels (bi-level selection):
</p>

<ul>
<li> <p><strong>Group-level selection:</strong> by determining whether <code class="reqn">||\eta_{v}||_{2}=0</code>, we can know if the <code class="reqn">v</code>th genetic variant has any effect at all.
</p>
</li>
<li> <p><strong>Individual-level selection:</strong> investigate whether the <code class="reqn">v</code>th genetic variant has main effect, G<code class="reqn">\times</code>E interaction or both, by determining which components in <code class="reqn">\eta_{v}</code> has non-zero values.
</p>
</li>
</ul>
<p>If structure="group", only group-level selection will be conducted on <code class="reqn">||\eta_{v}||_{2}</code>; if structure="individual", only individual-level selection will be conducted on each <code class="reqn">\eta_{vu}</code>, (<code class="reqn">u=1,\ldots,q</code>).
</p>
<p>This function also provides choices for the framework that is used.  If func="QIF", variable selection will be conducted within the quadratic inference functions framework; if func="GEE", variable selection will be
conducted within the generalized estimating equation framework.
</p>
<p>There are three options for the choice of the working correlation.  If corr="exchangeable", the exchangeable working correlation will be applied; if corr="AR-1", the AR-1 working correlation will be adopted; if corr="independence",
the independence working correlation will be used.
Please check the references for more details.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the coefficient vector.</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre><code class="language-R">data("dat")
##load the clinical covariates, environment factors, genetic factors and response from the
##"dat" file
clin=dat$clin
if(is.null(clin)){t=0} else{t=dim(clin)[2]}
e=dat$e
u=dim(e)[2]
g=dat$g
y=dat$y
##initial coefficient
beta0=dat$coef
##true nonzero coefficients
index=dat$index
beta = springer(clin=clin, e, g, y,beta0,func="GEE",corr="independence",structure="bilevel",
lam1=dat$lam1, lam2=dat$lam2,maxits=30,tol=0.01)
##only focus on the genetic main effects and gene-environment interactions
beta[1:(1+t+u)]=0
##effects that have nonzero coefficients
pos = which(beta != 0)
##true positive and false positive
tp = length(intersect(index, pos))
fp = length(pos) - tp
list(tp=tp, fp=fp)

</code></pre>


</div>