<div class="container">

<table style="width: 100%;"><tr>
<td>backtrackLayers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Backtrack layers from average or summary profile</h2>

<h3>Description</h3>

<p>An average profile as computed by dbaSP summarizes the prevalent layer properties of the entire profile set. To better
understand the distribution of layer properties within the set, use this function to retrieve layers of interest from the individual profiles of the original profile set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">backtrackLayers(
  avgProfile,
  layer = NA,
  profileSet = NULL,
  layer_units = "row#",
  condition = NULL,
  computationByHeight = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>avgProfile</code></td>
<td>
<p>an average profile as per dbaSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>the height or row number of the layer to retrieve the distribution for (given as height or row number of the average profile). If layer
is <code>NA</code>, all layers from the avgProfile are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profileSet</code></td>
<td>
<p>the profile set that is averaged by <code>avgProfile</code>. Optimally, it is the resampled profile set as returned by dbaSP or averageSP, see parameter <code>computationByHeight</code>
if that resampled profile set is not available anymore.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer_units</code></td>
<td>
<p>either <code>"row#"</code> or <code>"cm"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>a condition that subsets which layers are returned. E.g., only layers with a specific grain type, etc.. Note that the condition needs to be substituted in the
function call, e.g. <code>condition = substitute(gtype == "SH")</code>. In most cases, it's best to subset the data.frame manually after this function has been called. A <em>secret</em> and <em>dangerous</em> trick is
to use <code>condition = substitute(gtype %in% return_conceptually_similar_gtypes(as.character(avgProfile$layers$gtype[lidx])))</code> to get the very same layers that have been used to compute the median
layer properties which are included in the avgProfile$layers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computationByHeight</code></td>
<td>
<p>There are two ways of how to backtrack layers that were aligned to <code>avgProfile$layers</code>. The first and safest approach is by index, which requires the
resampled <code>profileSet</code> as returned by dbaSP or averageSP. The second approach is by layer height, which should yield the same results (beta phase: still bugs possible, check yourself!)
and allows to backtrack the layers even if the resampled profileSet is not available anymore, but only the original unmodified set which was used to create the average profile.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list of data.frames with the backtracked layers. Each (named) list item corresponds to a specific layer height (cm).
</p>


<h3>Author(s)</h3>

<p>fherla
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See Vignette for examples.

</code></pre>


</div>