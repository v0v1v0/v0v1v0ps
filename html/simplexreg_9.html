<div class="container">

<table style="width: 100%;"><tr>
<td>simplexreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simplex Generalized Linear Model Regression Function

</h2>

<h3>Description</h3>

<p>Regression Analysis of Proportional Data Using Various Types of 
Simplex Models  

</p>


<h3>Usage</h3>

<pre><code class="language-R">simplexreg(formula, data, subset, na.action, 
   	link = c("logit", "probit", "cloglog", "neglog"), corr = "Ind", id = NULL, 
   	control = simplexreg.control(...), model = TRUE, y = TRUE, x = TRUE, ...)
	
simplexreg.fit(y, x, z = NULL, t = NULL, link = "logit", corr = "Ind",
   	id = NULL, control = simplexreg.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted(of type y ~ x or y ~ x | z | t. 
The Details are given under 'Details'). 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing variables in <code>formula</code> 
and <code>id</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset, na.action</code></td>
<td>
<p>arguments controlling formula processing via <code>model.frame</code></p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>type of link function to the mean. Currently, <code>"logit"</code>(logit function), 
<code>"probit"</code>(probit function), <code>"cloglog"</code>(complementary log-log function), 
<code>"neglog"</code>(negative log function) are supported. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>the covariance structure, chosen from <code>"Ind"</code>(independent structure), 
<code>"Exc"</code>(exchangeability) and <code>"AR1"</code>(AR(1)), see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a factor identifies the clusters when <code>gee = TRUE</code>. The length of <code>id</code>
should be the same as the number of observations. <code>y</code>, <code>x</code>, <code>z</code>, <code>t</code> are 
assumed to be sorted in accordance with clusters specified by <code>id</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control argument via <code>simplexreg.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a logical value indicating whether <em>model frame</em> should be included
as a component of the return value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y, x</code></td>
<td>
<p>For <code>simplexreg</code>:logical values indicating whether response vector 
and covariates modelling the mean parameter should be returned as components of the 
returned value
For <code>simplexreg.fit</code>:<code>x</code> is the design matrix and <code>y</code> is the response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>regressor matrix modelling the dispersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>time covariate in the correlation structure, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>argument passed to <code>simplexreg.control</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Outcomes of continuous proportions arise in many applied areas. Such data could 
be properly modelled using simplex regression. See also <code>simplex</code>. The mean and 
dispersion parameters are linked to set of regressors. Regression analysis of the simplex model 
is implemented in <code>simplexreg</code>. If <code>corr = "Ind"</code>, simplex generalized regression model
is employed. Estimations is performed by maximum likelihood via Fisher scoring technique. 
</p>
<p>Apart from including generalized simplex regression models, this function also provides users with 
generalized estimating equations (GEE) techniques to model longitudinal proportional response. 
Exchangeability and AR(1) structures are available. Parameter estimation and residual analysis 
are involved. 
</p>
<p>We employ the specification approach designed in the fitting model function <code>betareg</code> of
beta regression in the package <span class="pkg">betareg</span>. As for simplex regression models, assuming the dispersion
is homogeneous, the response is linked to a linear predictor described by <code>y ~ x1 + x2</code> using a <code>link</code> 
function. Four types of function are available linking the regressors to the mean. However, for dispersion, 
the <code>link</code> function is restricted to logarithm function. When modeling dispersion, the regressor 
modelling the dispersion parameter should be specified in a formula form of type <code>y ~ x1 + x2 | z1 + z2</code> 
where <code>z1</code> and <code>z2</code> are linked to the dispersion parameter <code class="reqn">\sigma^2</code>.
</p>
<p>Model specification is a bit complicated when it comes to modelling longitudinal proportional response. 
Song <em>et. al</em> (2004) proposed a marginal simplex model consists of three components, the 
population-average effects, the pattern of dispersion and the correlation structure. Let the percentage 
responses for the <code class="reqn">i</code>th subject be <code class="reqn">y_{ij}</code>, observed at time <code class="reqn">t_{ij}</code>. If <code>corr = "AR1"</code>, 
the working covariance matrix of <code class="reqn">y_{ij}</code>, 
<code class="reqn">j = 1, 2, ..., n_i</code>, is 
</p>
<p style="text-align: center;"><code class="reqn">{\exp(\alpha * |t_{ik} - t_{ij}|)}_{kj}</code>
</p>

<p>where <code class="reqn">\alpha &lt; 0</code> and <code class="reqn">\exp(\alpha)</code> is the lag-1 autocorrelation. If 
<code>corr = "Exc"</code>, the covariance matrix will be <code class="reqn">(1 - exp(\alpha)) I + exp(\alpha) 1</code>
where I is the identity matrix while 1 the matrix with all elements being equal to one.  
</p>
<p>For homogeneous dispersion, the formula is supposed to be of the form <code>y ~ x1 + x2 | 1 | t</code> where <code class="reqn">t</code> is the
time covariate. Otherwise, the formula will be of the form <code>y ~ x1 + x2 | z1 + z2 | t</code>.
</p>



<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>fixef</code></td>
<td>
<p>estimates of coefficients modelling the mean as well 
as the standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispar</code></td>
<td>
<p>estimates of coefficients modelling dispersion as 
well as the standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dispersion</code></td>
<td>
<p>estimate of the dispersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>appstdPerr</code></td>
<td>
<p>approximated standard deviations of the regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdPerr</code></td>
<td>
<p>exact standard deviations of the regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanmu</code></td>
<td>
<p>estimate of mean parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjvar</code></td>
<td>
<p>adjusted dependent variable <code class="reqn">s_i</code>. Details could be found in 
McCullagh and Nelder (1989)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdscor</code></td>
<td>
<p>standardised score residuals. Details can be found in Song <em>et al.</em> (2004)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>predicted values of <code class="reqn">g(\mu_i)</code> where g is the link function and 
<code class="reqn">\mu_i</code> the mean parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglike</code></td>
<td>
<p>value of maximum log-likelihood function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>value of deviance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the original function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the original formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>a list with elements <code>"mean"</code> and <code>"dispersion"</code> containing term object for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a list with elements <code>"mean"</code> and <code>"dispersion"</code> containing levels of categorical regressors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>type of function linking to the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type = <code>"homo"</code> for homogeneous dispersion while type = <code>"hetero"</code> for 
heterogeneous dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the full model frame (if <code>model = TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response vector (if <code>y = TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with elements <code>mean</code>, <code>dispersion</code>, <code>time</code> and <code>id</code> containing 
corresponding variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of proportional observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of Fisher iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>argument passed to <code>simplexreg.control</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhenguo Qiu, Peng Zhang and Chengchun Shi

</p>


<h3>References</h3>

<p>Barndorff-Nielsen,  O.E. and  Jorgensen, B. (1991)
Some parametric models on the simplex.
<em> Journal of  Multivariate Analysis,</em> <b> 39:</b> 106–116
</p>
<p>Jorgensen, B. (1997)
<em> The Theory of Dispersion Models</em>.  London: Chapman and Hall
</p>
<p>McCullagh, P and Nelder J. (1989)
<em> Generalized Linear Models</em>. London: Chapman and Hall
</p>
<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540–553
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1–21

</p>


<h3>See Also</h3>

<p><code>simplex</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R"># GLM models
data("sdac", package = "simplexreg")
sim.glm1 &lt;- simplexreg(rcd~ageadj+chemo, link = "logit", 
  data = sdac)
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, link = "logit", 
  data = sdac)

# GEE models
data("retinal", package = "simplexreg")
sim.gee1 &lt;- simplexreg(Gas~LogT+LogT2+Level|1|Time, link = "logit", 
  corr = "Exc", id = ID, data = retinal)
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time, 
  link = "logit", corr = "AR1", id = ID, data = retinal)	
</code></pre>


</div>