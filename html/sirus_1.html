<div class="container">

<table style="width: 100%;"><tr>
<td>sirus.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate p0.</h2>

<h3>Description</h3>

<p>Estimate the optimal hyperparameter <code>p0</code> used to select rules in <code>sirus.fit</code> using cross-validation (Benard et al. 2021a, 2021b).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sirus.cv(
  data,
  y,
  type = "auto",
  nfold = 10,
  ncv = 10,
  num.rule.max = 25,
  q = 10,
  discrete.limit = 10,
  num.trees.step = 1000,
  alpha = 0.05,
  mtry = NULL,
  max.depth = 2,
  num.trees = NULL,
  num.threads = NULL,
  replace = TRUE,
  sample.fraction = NULL,
  verbose = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Input dataframe, each row is an observation vector. Each column is an input variable and is numeric or factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric response variable. For classification, <code>y</code> takes only 0 and 1 values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>'reg' for regression, 'classif' for classification and 'auto' for automatic detection (classification if <code>y</code> takes only 0 and 1 values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>Number of folds in the cross-validation. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncv</code></td>
<td>
<p>Number of repetitions of the cross-validation. Default is 10 for a robust estimation of <code>p0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.rule.max</code></td>
<td>
<p>Maximum number of rules of SIRUS model in the cross-validation grid. Default is 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Number of quantiles used for node splitting in the forest construction. Default and recommended value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete.limit</code></td>
<td>
<p>Maximum number of distinct values for a variable to be considered discrete. If higher, variable is continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.trees.step</code></td>
<td>
<p>Number of trees grown between two evaluations of the stopping criterion. Ignored if <code>num.trees</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Parameter of the stopping criterion for the number of trees: stability has to reach 1-<code>alpha</code> to stop the growing of the forest. Ignored if <code>num.trees</code> is provided. Default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p>Number of variables to possibly split at each node. Default is the number of variables divided by 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.depth</code></td>
<td>
<p>Maximal tree depth. Default and recommended value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.trees</code></td>
<td>
<p>Number of trees grown in the forest. If NULL (recommended), the number of trees is automatically set using a stability stopping criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>Number of threads used to grow the forest. Default is number of CPUs available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>Boolean. If true (default), sample with replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.fraction</code></td>
<td>
<p>Fraction of observations to sample. Default is 1 for sampling with replacement and 0.632 for sampling without replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean. If true, information messages are printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed. Default is NULL, which generates the seed from R. Set to 0 to ignore the R seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a robust estimation of <code>p0</code>, it is recommended to run multiple cross-validations (typically <code>ncv</code> = 10).
Two optimal values of <code>p0</code> are provided: <code>p0.pred</code> (Benard et al. 2021a) and <code>p0.stab</code> (Benard et al. 2021b), defined such that <code>p0.pred</code> minimizes the error, and <code>p0.stab</code> finds a tradeoff between error and stability.
Error is 1-AUC for classification and the unexplained variance for regression.
Stability is the average proportion of rules shared by two SIRUS models fit on two distinct folds of the cross-validation.
</p>


<h3>Value</h3>

<p>Optimal value of <code>p0</code> with the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p0.pred</code></td>
<td>
<p>Optimal <code>p0</code> value to minimize model error (recommended for classification).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0.stab</code></td>
<td>
<p>Optimal <code>p0</code> value for a tradeoff between error and stability (recommended for regression).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.grid.p0</code></td>
<td>
<p>Table with the full cross-validation results for a fine grid of <code>p0</code>: number of rules, stability, and error. 
The last three columns of the table are the standard deviations of the metrics across the <code>ncv</code> repetitions of the cross-validation.
See details for the definitions of the error and stability metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>'reg' for regression, 'classif' for classification.</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Benard, C., Biau, G., Da Veiga, S. &amp; Scornet, E. (2021a). SIRUS: Stable and Interpretable RUle Set for Classification. Electronic Journal of Statistics, 15:427-505. <a href="https://doi.org/10.1214/20-EJS1792">doi:10.1214/20-EJS1792</a>.
</p>
</li>
<li>
<p> Benard, C., Biau, G., Da Veiga, S. &amp; Scornet, E. (2021b). Interpretable Random Forests via Rule Extraction. Proceedings of The 24th International Conference on Artificial Intelligence and Statistics, PMLR 130:937-945. <a href="http://proceedings.mlr.press/v130/benard21a">http://proceedings.mlr.press/v130/benard21a</a>. 
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## load SIRUS
require(sirus)

## prepare data
data &lt;- iris
y &lt;- rep(0, nrow(data))
y[data$Species == 'setosa'] = 1
data$Species &lt;- NULL

## run cv
cv.grid &lt;- sirus.cv(data, y, nfold = 3, ncv = 2, num.trees = 100)

</code></pre>


</div>