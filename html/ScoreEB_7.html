<div class="container">

<table style="width: 100%;"><tr>
<td>ScoreEB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Score Test Integrated with Empirical Bayes for Association Study
</h2>

<h3>Description</h3>

<p>Perform association test within linear mixed model framework using score test integrated with Empirical Bayes for genome-wide association study. Firstly, score test was conducted for each marker under linear mixed model framework, taking into account the genetic relatedness and population structure. And then all the potentially associated markers were selected with a less stringent criterion. Finally, all the selected markers were placed into a multi-locus model to identify the true quantitative trait nucleotide.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ScoreEB(genofile, phenofile, popfile = NULL, trait.num = 1, EMB.tau = 0,
EMB.omega = 0, B.Moment = 20, tol.pcg = 1e-4, iter.pcg = 100, bin = 100,
lod.cutoff = 3.0, seed.num = 10000, dir_out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genofile</code></td>
<td>
<p>Genotype file name, change the file path where it is located,
i.e.,"D:/Genotype_Example.csv".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenofile</code></td>
<td>
<p>Phenotype file name, change the file path where it is located,
i.e.,"D:/Phenotype_Example.csv".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popfile</code></td>
<td>
<p>Population structure file name, change the file path
where it is located,i.e.,"D:/Population.csv".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.num</code></td>
<td>
<p>trait.num stands for computing trait from the 1st to the "trait.num"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMB.tau</code></td>
<td>
<p>EMB.tau and EMB.omega are two values of hyperparameters in
empirical Bayes step, which are set to 0 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMB.omega</code></td>
<td>
<p>As describe in EMB.tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.Moment</code></td>
<td>
<p>B.Moment is a parameter to obtain trace of NxN matrix approximately
using method of moment. B.Moment is set to 20 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.pcg</code></td>
<td>
<p>tol.pcg and iter.pcg are tolerance and maximum iteration number in
preconditioned conjugate gradient algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.pcg</code></td>
<td>
<p>As describe in tol.pcg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>bin is to choose the maximum score within a certain range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lod.cutoff</code></td>
<td>
<p>lod.cutoff is the threshold to determine identified QTNs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.num</code></td>
<td>
<p>Set a random number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir_out</code></td>
<td>
<p>Give the path where it will be saved,i.e.,"D:/Result"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>result.total</code></td>
<td>
<p>A data frame of identified markers, including "Trait", "Id", "Chr",
"Pos", "Score", "Beta", "Lod" and "Pvalue" of markers.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>1. genofile and phenofile are the required input file, while popfile is the optional input file.<br>
2. In the "tempdir()" folder, there are two results files "ScoreEB.Result.csv" and "ScoreEB.time.csv" generated and saved after the run.<br>
3. The results file "ScoreEB.Result.csv" has 8 columns, including "Trait", "Id", "Chr", "Pos", "Score", "Beta", "Lod" and "Pvalue".<br>
4. The time file "ScoreEB.time.csv" includes 3 rows, which are "User", "System", "Elapse" time, respectively.<br></p>


<h3>Author(s)</h3>

<p>Wenlong Ren<br>
Wenlong Ren &lt;wenlongren@ntu.edu.cn&gt;<br></p>


<h3>Examples</h3>

<pre><code class="language-R">genofile &lt;- system.file("extdata", "Genotype_Example.csv", package="ScoreEB")
phenofile &lt;-system.file("extdata", "Phenotype_Example.csv", package="ScoreEB")
dir_out &lt;- tempdir()
ScoreEB(genofile, phenofile, popfile = NULL, trait.num = 1, EMB.tau = 0,
EMB.omega = 0, B.Moment = 20, tol.pcg = 1e-4, iter.pcg = 100, bin = 100,
lod.cutoff = 3.0, seed.num = 10000, dir_out)
</code></pre>


</div>