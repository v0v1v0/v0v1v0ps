<div class="container">

<table style="width: 100%;"><tr>
<td>Binomial.SGoF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial SGoF multiple testing procedure</h2>

<h3>Description</h3>

<p>Performs the Binomial SGoF method (<cite>Carvajal Rodríguez et al., 2009</cite>) for multiple hypothesis testing.</p>


<h3>Usage</h3>

<pre><code class="language-R">Binomial.SGoF(u, alpha = 0.05, gamma = 0.05)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A (non-empty) numeric vector of p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value. The significance level of the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric value. The p-value threshold, so Binomial SGoF looks for significance in the amount of p-values below gamma.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Binomial SGoF starts by counting the amount of p-values below <code>gamma</code>. This amount is compared to the expected one under the intersection or complete null hypothesis (all the nulls are true) in a metatest, performed at level <code>alpha</code>. Note that, under the intersection null, the p-values will be uniformly distributed on the (0,1) interval, so one expects <code>gamma</code> times the length of <code>u</code> p-values falling below <code>gamma</code>. If the intersection null is accepted, Binomial  SGoF reports no effects. If the intersection null is rejected, the excess of observed significant cases are reported as number of existing effects N (by effects it is meant null hypotheses to be rejected). Finally, the effects are identified by considering the smallest N p-values. The only input you need is the set of p-values.
Binomial SGoF procedure weakly controls the family-wise error rate (FWER) and the false discovery rate (FDR) at level <code>alpha</code>. That is, the probability of committing one or more than one type I errors along the multiple tests is bounded by <code>alpha</code> when all the null hypotheses are true. SGoF does not control for FWER nor FDR in the presence of effects. It has been quoted that Binomial SGoF provides a good balance between FDR and power, particularly when the number of tests is large, and the effect level is weak to moderate. It is also known that the number of effects declared by Binomial SGoF is a 100(1-<code>alpha</code>)% lower bound for the true number of existing effects with p-value below the initial threshold <code>gamma</code> so, interestingly, at probability 1-<code>alpha</code>, the number of false discoveries of SGoF does not exceed the number of false non-discoveries (<cite>de Uña Álvarez, 2012</cite>).
Typically, the choice <code>alpha</code>=<code>gamma</code> will be used; this common value will be set as one of the usual significance levels (0.001, 0.01, 0.05, 0.1). Note however that <code>alpha</code> and <code>gamma</code> have different roles.
The FDR is estimated by the simple method proposed by: <cite>Dalmasso, Broet, Moreau (2005)</cite>, by taking n=1 in their formula.
The adjusted p-value of a given p-value pi is defined as the smallest alpha0 for which the null hypothesis attached to pi is rejected by SGoF with <code>alpha</code>=<code>gamma</code>=alpha0. Actually, Binomial.SGoF function provides  these adjusted p-values by restricting alpha0 to the set of original p-values. <cite>Castro-Conde and de Uña-Álvarez  (2015)</cite>   proved that this restriction does not change the adjusted p-values, while reducing the computational time.
</p>


<h3>Value</h3>

<p>A list containing the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Rejections </code></td>
<td>
<p>The number of effects declared by Binomial SGoF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR </code></td>
<td>
<p>The estimated false discovery rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adjusted.pvalues</code></td>
<td>
<p>The adjusted p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>The original p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>The specified significance level for the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p>The specified p-value threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Irene Castro Conde and Jacobo de Uña Álvarez</p>


<h3>References</h3>

<p>Carvajal Rodríguez A, de Uña Álvarez J and Rolán Álvarez E (2009). A new
multitest correction (SGoF) that increases its statistical power when increasing the number of tests. <em>BMC Bioinformatics</em> 10:209.
</p>
<p>Castro Conde I and de Uña Álvarez J (2015). Adjusted p-values for SGoF multiple test procedure.  <em>Biometrical Journal</em>,  57(1): 108-122. DOI: 10.1002/bimj.201300238
</p>
<p>Dalmasso C, Broet P and Moreau T (2005) A simple procedure for estimating the false discovery rate. <em>Bioinformatics</em> 21:660–668
</p>
<p>de Uña Álvarez J (2011). On the statistical properties of SGoF multitesting method. <em>Statistical Applications in Genetics and Molecular Biology</em>, Vol. 10, Iss. 1, Article 18.
</p>


<h3>See Also</h3>

<p><code>plot.Binomial.SGoF</code>,<code>summary.Binomial.SGoF</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
p&lt;-runif(387)^2  #387 independent p-values, non-uniform intersection null violated

res&lt;-Binomial.SGoF(p)
summary(res)   #number of rejected nulls, estimated FDR
plot(res)   #adjusted p-values
</code></pre>


</div>