<div class="container">

<table style="width: 100%;"><tr>
<td>testIndepTimeMark</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kolmogorov-Smirnov-Type Test of Conditional Independence between the Time-to-Event
and a Multivariate Mark Given Treatment</h2>

<h3>Description</h3>

<p>A nonparametric Komogorov-Smirnov-type test of the null hypothesis that the time-to-event <code class="reqn">T</code> and a possibly multivariate mark <code class="reqn">V</code> are conditionally independent given treatment <code class="reqn">Z</code>
as described in Juraska and Gilbert (2013). The conditional independence is a necessary assumption for parameter identifiability in the time-independent density ratio model. A bootstrap
algorithm is used to compute the p-value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testIndepTimeMark(data, iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame restricted to subjects in a given treatment group with the following columns (in this order): the observed right-censored time to the event of interest,
the event indicator (1 if event, 0 if right-censored), and the mark variable (one column for each component, if multivariate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of bootstrap iterations (1000 by default) used for computing the p-value</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test statistic is the supremum of the difference between the estimated conditional joint cumulative distribution function (cdf) of <code class="reqn">(T,V)</code> given <code class="reqn">Z</code> and the product of
the estimated conditional cdfs of <code class="reqn">T</code> and <code class="reqn">V</code> given <code class="reqn">Z</code>. The joint cdf is estimated by the nonparametric maximum likelihood estimator developed by
Huang and Louis (1998). The marginal cdf of <code class="reqn">T</code> is estimated as one minus the Kaplan-Meier estimator for the conditional survival function of <code class="reqn">T</code>, and the
cdf of <code class="reqn">V</code> is estimated as the empirical cdf of the observed values of <code class="reqn">V</code>. A bootstrap algorithm is used to compute the p-value.
</p>


<h3>Value</h3>

<p>Returns the bootstrap p-value from the test of conditional independence between <code class="reqn">T</code> and <code class="reqn">V</code> given <code class="reqn">Z</code>.
</p>


<h3>References</h3>

<p>Juraska, M. and Gilbert, P. B. (2013), Mark-specific hazard ratio model with multivariate continuous marks: an application to vaccine efficacy. <em>Biometrics</em> 69(2):328–337.
</p>
<p>Huang, Y. and Louis, T. (1998), Nonparametric estimation of the joint distribution of survival time and mark variables. <em>Biometrika</em> 85, 785–798.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
tx &lt;- rep(0:1, each=n/2)
tm &lt;- c(rexp(n/2, 0.2), rexp(n/2, 0.2 * exp(-0.4)))
cens &lt;- runif(n, 0, 15)
eventTime &lt;- pmin(tm, cens, 3)
eventInd &lt;- as.numeric(tm &lt;= pmin(cens, 3))
mark1 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 2, 5), rbeta(n/2, 2, 2)), NA)
mark2 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 1, 3), rbeta(n/2, 5, 1)), NA)

# perform the test for a univariate mark in the placebo group
testIndepTimeMark(data.frame(eventTime, eventInd, mark1)[tx==0, ], iter=20)

# perform the test for a bivariate mark in the placebo group
testIndepTimeMark(data.frame(eventTime, eventInd, mark1, mark2)[tx==0, ], iter=20)

</code></pre>


</div>