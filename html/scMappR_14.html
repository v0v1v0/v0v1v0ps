<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap_generation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Heatmap</h2>

<h3>Description</h3>

<p>This function takes an inputted signature matrix as well as a list of genes and overlaps them.
Then, if there is overlap, it prints a heatmap or barplot (depending on the number of overlapping genes).
Then, for every cell-type, genes considered over-represented are saved in a list.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap_generation(
  genesIn,
  comp,
  reference,
  cex = 0.8,
  rd_path = "",
  cellTypes = "ALL",
  pVal = 0.01,
  isPval = TRUE,
  isMax = FALSE,
  isBackground = FALSE,
  which_species = "human",
  toSave = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genesIn</code></td>
<td>
<p>A list of gene symbols (all caps) to have their cell type enrichment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>The name of the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>Path to signature matrix or the signature matrix itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>The size of the genes in the column label for the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rd_path</code></td>
<td>
<p>The directory to RData files – if they are not in this directory, then the files will be downloaded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellTypes</code></td>
<td>
<p>Colnames of the cell-types you will extract (passed to extract_genes_cell).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pVal</code></td>
<td>
<p>The level of association a gene has within a cell type (passed to extract_genes_cell).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isPval</code></td>
<td>
<p>If the signature matrix is raw p-value (T/F) – TRUE not recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isMax</code></td>
<td>
<p>If you are taking the single best CT marker (T/F) – TRUE not recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isBackground</code></td>
<td>
<p>If the heatmap is from the entire signature matrix or just the inputted gene list (T/F). isBackground == TRUE is used for internal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_species</code></td>
<td>
<p>Species of gene symbols – "human" or "mouse" .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the path directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>genesIn</code></td>
<td>
<p>Vector of genes intersecting gene list and signature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genesNoIn</code></td>
<td>
<p>Vector of inputted genes not in signature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneHeat</code></td>
<td>
<p>Signature matrix subsetted by inputted gene list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preferences</code></td>
<td>
<p>Cell-markers mapping to cell-types.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

# load in signature matrices
data(POA_example)
POA_generes &lt;- POA_example$POA_generes
POA_OR_signature &lt;- POA_example$POA_OR_signature
POA_Rank_signature &lt;- POA_example$POA_Rank_signature
Signature &lt;- POA_Rank_signature
rowname &lt;- get_gene_symbol(Signature)
rownames(Signature) &lt;- rowname$rowname
genes &lt;- rownames(Signature)[1:100]
heatmap_test &lt;- heatmap_generation(genesIn = genes, "scMappR_test",
                                   reference = Signature, which_species = "mouse")

 

</code></pre>


</div>