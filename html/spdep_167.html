<div class="container">

<table style="width: 100%;"><tr>
<td>local_joincount_uni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the local univariate join count</h2>

<h3>Description</h3>

<p>The univariate local join count statistic is used to identify clusters of rarely occurring binary variables. The binary variable of interest should occur less
than half of the time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">local_joincount_uni(
  fx,
  chosen,
  listw,
  alternative = "two.sided",
  nsim = 199,
  iseed = NULL,
  no_repeat_in_row=FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>a binary variable either numeric or logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chosen</code></td>
<td>
<p>a scalar character containing the level of <code>fx</code> that should be considered the observed value (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a listw object containing binary weights created, for example, with <code>nbwlistw(nb, style = "B")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>default <code>"greater"</code>. One of <code>"less"</code> or <code>"greater"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of conditional permutation simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iseed</code></td>
<td>
<p>default NULL, used to set the seed; the output will only be reproducible if the count of CPU cores across which computation is distributed is the same</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_repeat_in_row</code></td>
<td>
<p>default <code>FALSE</code>, if <code>TRUE</code>, sample conditionally in each row without replacements to avoid duplicate values, <a href="https://github.com/r-spatial/spdep/issues/124">https://github.com/r-spatial/spdep/issues/124</a></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The local join count statistic requires a binary weights list which can be generated with <code>nb2listw(nb, style = "B")</code>. Additionally, ensure that the binary variable of interest is rarely occurring in no more than half of observations.
</p>
<p>P-values are estimated using a conditional permutation approach. This creates a reference distribution from which the observed statistic is compared. For more see <a href="https://geodacenter.github.io/glossary.html#ppvalue">Geoda Glossary</a>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with two columns <code>BB</code> and <code>Pr()</code> and number of rows equal to the length of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Josiah Parry <a href="mailto:josiah.parry@gmail.com">josiah.parry@gmail.com</a></p>


<h3>References</h3>

<p>Anselin, L., &amp; Li, X. (2019). Operational Local Join Count Statistics for Cluster Detection. Journal of geographical systems, 21(2), 189â€“210. <a href="https://doi.org/10.1007/s10109-019-00299-x">doi:10.1007/s10109-019-00299-x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(oldcol)
fx &lt;- as.factor(ifelse(COL.OLD$CRIME &lt; 35, "low-crime", "high-crime"))
listw &lt;- nb2listw(COL.nb, style = "B")
set.seed(1)
(res &lt;- local_joincount_uni(fx, chosen = "high-crime", listw))
</code></pre>


</div>