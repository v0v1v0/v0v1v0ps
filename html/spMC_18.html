<div class="container">

<table style="width: 100%;"><tr>
<td>mlen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean Length Estimation for Embedded Markov Chain</h2>

<h3>Description</h3>

<p>The function estimates the mean length for a <code class="reqn">d</code>-D spatial embedded Markov chain for a specified direction <code class="reqn">\phi</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">mlen(data, coords, loc.id, direction, mle = "avg")</code></pre>


<h3>Arguments</h3>








<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.id</code></td>
<td>
<p>a vector of <code class="reqn">n</code> values which indicates the directional line of each location. It is usually the output of the function <code>which_lines</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a <code class="reqn">d</code>-D numerical vector (or versor) which represents the chosen direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>a character value. If <code>"trm"</code>, the trimmed arithmetic average will be used to calculate the mean lengths. If <code>"mdn"</code>, the trimmed median will be considered. If <code>"mlk"</code>, the maximum likelihood mean lengths will be computed. If <code>"avg"</code>, the arithmetic mean will be performed. For backward compatibility reasons, it can accept logical values, so that <code>TRUE</code> is equivalent to <code>"mlk"</code> and <code>FALSE</code> to <code>"avg"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mean length is the total length occupied by the <code class="reqn">k</code>-th category divided by the number of its embedded occurrences along lines in the direction <code class="reqn">\phi</code>. More robust methods are implemented, such as the trimmed mean and the trimmed median.
</p>
<p>If the stratum lengths are censored, the maximum likelihood approach is more appropriate than the arithmetic mean. In this case, the stratum lengths are assumed to be independent realizations from a log-normal random variable. The quantity to maximize is
</p>
<p style="text-align: center;"><code class="reqn">L(\mu_1, \ldots, \mu_K, \sigma_1, \ldots, \sigma_K) = \prod_{i = 1}^m \prod_{k = 1}^K \left[ \int_{l_i}^{l_i+u_i} \frac{1}{x \sigma_k \sqrt{2}} \exp \left\lbrace - \frac{(\log x - \mu_k)^2}{2 \sigma_k^2} \right\rbrace \right]^{z_{k, i}} \mbox{d}x,</code>
</p>

<p>where <code class="reqn">\boldsymbol{\mu} = (\mu_1, \ldots, \mu_K)^\top</code> and <code class="reqn">\boldsymbol{\sigma} = (\sigma_1, \ldots, \sigma_K)^\top</code> are vectors of parameters, <code class="reqn">l_i</code> is the observed stratum length, <code class="reqn">u_i</code> denotes the upper bound of the censor and <code class="reqn">z_{k, i}</code> denotes a dummy variable which assumes value 1 if and only if the <code class="reqn">i</code>-th stratum is referred to the <code class="reqn">k</code>-th category.
</p>


<h3>Value</h3>

<p>A numeric vector containing the mean length for each observed category.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>which_lines</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)
direction &lt;- c(0,0,1)

# Compute the appartaining directional line for each location
loc.id &lt;- which_lines(ACM[, 1:3], direction)

# Estimate the mean lengths for each observed category
ml &lt;- mlen(ACM$MAT5, ACM[, 1:3], loc.id, direction, mle = "avg")

# Equivalently
gl &lt;- getlen(ACM$MAT5, ACM[, 1:3], loc.id, direction, zero.allowed = TRUE)
ml1 &lt;- tapply(gl$length, gl$categories, mean)
</code></pre>


</div>