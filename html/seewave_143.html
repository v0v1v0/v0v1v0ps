<div class="container">

<table style="width: 100%;"><tr>
<td>spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Frequency spectrum of a time wave</h2>

<h3>Description</h3>

<p>This function returns the frequency spectrum (<em>i.e.</em> the relative amplitude of the
frequency content) of a time wave. Results can be obtained either as absolute 
or dB data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spec(wave, f, channel = 1, wl = 512, wn = "hanning", fftw = FALSE, norm = TRUE,
scaled = FALSE, PSD = FALSE, PMF = FALSE, correction="none", dB = NULL, dBref = NULL,
at = NULL, from = NULL, to = NULL,
identify = FALSE, col = "black", cex = 1,
plot = 1, flab = "Frequency (kHz)",
alab = "Amplitude", flim = NULL,
alim = NULL, type="l",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>if <code>at</code> is not null, length of the window for the analysis
(by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default
<code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code> for faster computation. See Notes of the function <code>spectro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>if <code>TRUE</code> the spectrum is normalised by
its maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>if <code>TRUE</code> the spectrum is scaled by the length of
the FFT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSD</code></td>
<td>
<p>if <code>TRUE</code> return Power Spectrum Density,
<em>i. e.</em> the square of the spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PMF</code></td>
<td>
<p>if <code>TRUE</code> return Probability Mass Function,
<em>i. e.</em> the probability distribution of frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>a character vector of length 1 to apply an
amplitude ("amplitude") or an energy ("energy") correction
to the FT window. This argument is useful only when one wish to obtain
absolute values that is when <code>norm=FALSE</code>, <code>scaled=FALSE</code>,
and <code>PMF=FALSE</code>. By default no correction is applied ("none").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>a character string specifying the type dB to return: "max0" for a
maximum dB value at 0, "A", "B", "C", "D", and "ITU" for common dB weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBref</code></td>
<td>
<p>a dB reference value when <code>dB</code> is not <code>NULL</code>. <code>NULL</code> by default
but should be set to 2*10e-5 for a 20 microPa reference (SPL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>position where to compute the spectrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>start mark where  to compute the spectrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>end mark where to compute the spectrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>to identify frequency and amplitude values on the plot
with the help of a cursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of the spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>pitch size of the spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>1</code> returns frequency on x-axis, if <code>2</code> returns 
frequency on y-axis, (by default <code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alab</code></td>
<td>
<p>title of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>range of frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alim</code></td>
<td>
<p>range of amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>at</code>, <code>from</code> or <code>to</code> are <code>FALSE</code> then <code>spec</code> 
computes the spectrum of the whole signal.</p>


<h3>Value</h3>

<p>This function returns  a two-column matrix,
the first column corresponding to the frequency axis, the second column
corresponding to the amplitude axis.<br> 
If <code>identify</code> is <code>TRUE</code>, <code>spec</code> returns a list with
two elements:<br></p>
<table><tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>the frequency of the points chosen on the spectrum</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>amp</code></td>
<td>
<p>the relative amplitude of the points chosen on the spectrum</p>
</td>
</tr></table>
<p><br></p>


<h3>Warning</h3>

<p>The argument <code>peaks</code> is no more available
(version &gt; 1.5.6). See the function <code>fpeaks</code>
for peak(s) detection.</p>


<h3>Note</h3>

<p>This function is based on <code>fft</code>.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>See Also</h3>

<p><code>meanspec</code>, <code>fpeaks</code>,
<code>localpeaks</code>, <code>dynspec</code>, 
<code>corspec</code>, <code>fft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico)
# spectrum of the whole signal, in absolute or dB amplitude,
# horizontaly or vertically
op&lt;-par(mfrow=c(2,2))
spec(tico,f=22050)
spec(tico,f=22050,col="red",plot=2)
spec(tico,f=22050,dB="max0",col="blue")
spec(tico,f=22050,dB="max0",col="green",plot=2)
par(op)
# an indirect way to compare spectra 
a&lt;-spec(tico,f=22050,wl=512,at=0.2,plot=FALSE)
b&lt;-spec(tico,f=22050,wl=512,at=0.7,plot=FALSE)
c&lt;-spec(tico,f=22050,wl=512,at=1.1,plot=FALSE)
d&lt;-spec(tico,f=22050,wl=512,at=1.6,plot=FALSE)
all&lt;-cbind(a[,2],b[,2],c[,2],d[,2])
matplot(x=a[,1],y=all,yaxt="n",
    xlab="Frequency (kHz)",ylab="Amplitude",xaxs="i",type="l")
legend(8,0.8,c("Note A","Note B", "Note C", "Note D"),bty="o",
    lty=c(1:4),col=c(1:4))
# spectrum from a particular position to another one
op&lt;-par(mfrow=c(2,1))
oscillo(tico,f=22050)
abline(v=c(0.5,0.9),col="red",lty=2)
spec(tico,f=22050,wl=512,from=0.5,to=0.9,col="red")
title("Spectrum of the note B")
par(op)
# spectrum and spectrogram
data(orni)
orni1&lt;-cutw(orni,f=22050,from=0.32,to=0.39)
layout(matrix(c(1,2),nc=2),widths=c(3,1))
par(mar=c(5,4,3,0.5))
spectro(orni1,f=22050,wl=128,zp=8,ovlp=85,scale=FALSE)
par(mar=c(5,1,3,0.5))
spec(orni1,f=22050,col="red",plot=2,flab="",yaxt="n")
</code></pre>


</div>