<div class="container">

<table style="width: 100%;"><tr>
<td>hb_unit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basic Unit Level Model (Battese-Harter-Fuller model) using Hierarchical Bayesian Approach</h2>

<h3>Description</h3>

<p>This function gives the Hierarchical Bayesian (HB) based on a basic unit level model (Battese-Harter-Fuller model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hb_unit(
  formula,
  data_unit,
  data_area,
  domain,
  iter.update = 3,
  iter.mcmc = 10000,
  coef,
  var.coef,
  thin = 3,
  burn.in = 2000,
  tau.u = 1,
  seed = 1,
  quiet = TRUE,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class formula that contains a description of the model to be fitted. The variables included in the formula must be contained in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_unit</code></td>
<td>
<p>data frame containing the variables named in <code>formula</code> and <code>domain</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_area</code></td>
<td>
<p>data frame containing the variables named in <code>formula</code> and <code>domain</code>. Each remaining column contains the population means of each of the p auxiliary variables for the D domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>Character or formula for domain column names in unit data <code>data_unit</code> and area data <code>data_area</code>. (example : "County" or ~County)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.update</code></td>
<td>
<p>Number of updates with default 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.mcmc</code></td>
<td>
<p>Number of total iterations per chain with default 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a vector contains prior initial value of Coefficient of Regression Model for fixed effect with default vector of 0 with the length of the number of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.coef</code></td>
<td>
<p>a vector contains prior initial value of variance of Coefficient of Regression Model with default vector of 1 with the length of the number of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning rate, must be a positive integer with default 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>Number of iterations to discard at the beginning with default 2000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.u</code></td>
<td>
<p>Prior initial value of inverse of Variance of area random effect with default 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>number used to initialize a pseudorandom number generator (default seed = 1). The random number generator method used is "base::Wichmann-Hill".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if TRUE, then messages generated during compilation will be suppressed (default TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if TRUE, the autocorrelation, trace, and density plots will be generated (default TRUE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following objects : Estimation <code>Est</code>, random effect variance <code>refVar</code>, beta coefficient <code>Coefficient</code> and MCMC result <code>result_mcmc</code>
</p>


<h3>References</h3>


<ol>
<li>
<p> Battese, G. E., Harter, R. M., &amp; Fuller, W. A. (1988). An error-components model for prediction of county crop areas using survey and satellite data. Journal of the American Statistical Association, 83(401), 28-36.
</p>
</li>
<li>
<p> Rao, J. N., &amp; Molina, I. (2015). Small area estimation. John Wiley &amp; Sons.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)

Xarea &lt;- cornsoybeanmeans %&gt;%
   dplyr::select(
      County = CountyIndex,
      CornPix = MeanCornPixPerSeg,
      SoyBeansPix = MeanSoyBeansPixPerSeg
   )

corn_model &lt;- hb_unit(
   CornHec ~ SoyBeansPix + CornPix,
   data_unit = cornsoybean,
   data_area = Xarea,
   domain = "County",
   iter.update = 20
)

</code></pre>


</div>