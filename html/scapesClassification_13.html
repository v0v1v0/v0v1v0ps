<div class="container">

<table style="width: 100%;"><tr>
<td>ngbList</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>List of neighborhoods</h2>

<h3>Description</h3>

<p>Computes the neighborhoods of the cells of a raster. Neighborhoods are not
computed for cells with missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ngbList(r, rNumb = FALSE, attTbl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>single or multi-layer raster of the class <code>SpatRaster</code> (see
<code>help("rast", terra)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rNumb</code></td>
<td>
<p>logic, the neighbors of a raster cell are identified by <strong>cell
numbers (<code>rNumb=FALSE</code>)</strong> or by <strong>row numbers (<code>rNumb=TRUE</code>)</strong>.
If true, the argument <code>attTbl</code> cannot be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attTbl</code></td>
<td>
<p>data.frame, the attribute table returned by the function
<code>attTbl</code> (see <code>attTbl</code>). It is required only if the
argument <code>rNumb=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Definition of neighborhood</strong>
</p>

<ul><li>
<p> A cell with coordinates <code>(x, y)</code> has 8 neighbors with coordinates:
<code>(x±1, y)</code>,  <code>(x, y±1)</code> and <code>(x±1, y±1)</code>. Cells on the edge
of a raster have less than 8 neighbors.
</p>
</li></ul>
<p><strong>Neighborhoods (<code>rNumb=FALSE</code>)</strong>
</p>

<ul><li>
<p> Neighbors are identified by their cell numbers if the argument
<code>rNumb=FALSE</code>.
</p>
</li></ul>
<p><strong>Neighborhoods (<code>rNumb=TRUE</code>)</strong>
</p>

<ul>
<li>
<p> Neighbors are identified by their positions in the attribute table (i.e.
row numbers) if the argument <code>rNumb=TRUE</code>;
</p>
</li>
<li>
<p> When the argument <code>rNumb = TRUE</code>, neighbors with missing values are
omitted;
</p>
</li>
<li> <p><code>(scapes)Classifications</code> are faster when the list of neighborhoods
uses row numbers.
</p>
</li>
</ul>
<p><strong>Neighborhood names</strong>
</p>
<p>The list of neighborhoods is named.
</p>

<ul>
<li>
<p> When <code>rNumb = FALSE</code>, the element name identifies the raster cell to
which the neighborhood refers. For instance, the element with name
<code>"n"</code> stores the neighborhood of the raster cell <code>n</code>.
</p>
</li>
<li>
<p> When <code>rNumb = TRUE</code>, the element name identifies the row number to
which the neighborhood refers. For instance, the element with name
<code>"n"</code> stores the neighborhood of the raster cell located in the
<code>nth</code> row of the attribute table (<code>attTbl$Cell[n]</code>).
</p>
</li>
</ul>
<h3>Value</h3>

<p>Named list of integer vectors.
</p>


<h3>Note</h3>


<ul>
<li>
<p> There is always a correspondence between the indices of the attribute
table (<code>attTbl</code>) and the indices of the list of neighborhoods:
the 1st element of the list corresponds to the neighbors of the cell stored
in the 1st row of the attribute table; the 2nd element corresponds to the
2nd row; etc.
</p>
</li>
<li>
<p> There is a correspondence between the raster cell number and the indices
of the list of neighborhoods only when no missing value is present in the
raster.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>ngb8()</code>, <code>attTbl()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(scapesClassification)
library(terra)

## CREATE A DUMMY RASTER AND COMPUTE ATTRIBUTE TABLE ##
r &lt;- terra::rast(matrix(c(NA,100,100,NA,100,100,0,0,0),
                        nrow = 3,
                        ncol = 3,
                        byrow = TRUE))

at &lt;- attTbl(r, var_names = c("dummy_var"))

## RASTER CELL NUMBERS ##
rcn &lt;- r; rcn[] &lt;- 1:9

## PLOT DATA AND CELL NUMBERS ##
oldpar &lt;- par(mfrow = c(1,2))
m &lt;- c(4, 1, 4, 1)

plot(r, col="grey90", colNA="red3", mar=m, asp=NA, axes=FALSE, legend=FALSE)
text(r)
lines(r)
mtext(side=3, line=0.2, adj=0, cex=1.5, font=2, "Dummy_var")
legend("bottomright", ncol = 1, bg = "white", fill = c("red3"),
       legend = c("NA cells (1 and 4)"))

plot(rcn, col="grey90", mar=m, asp = NA, axes=FALSE, legend=FALSE)
text(rcn)
lines(rcn)
mtext(side=3, line=0.2, adj=0, cex=1.5, font=2, "Cell numbers")
par(oldpar)

## NEIGHBORHOODS - CELL NUMBERS ##

# Cells 1 and 4 are omitted because they are NAs
nbs_CELL &lt;- ngbList(r, rNumb = FALSE)
nbs_CELL


## NEIGHBORHOODS - ROW NUMBERS ##

# Cells 1 and 4 are omitted because they are NAs
nbs_ROW &lt;- ngbList(r, rNumb = TRUE, attTbl = at)
nbs_ROW

# Numbers in 'nbs_ROW' refer to row numbers
# (e.g. number 1 refers to the cell #2)
at$Cell[1]

# (e.g. number 2 refers to the cell #3)
at$Cell[2]

# (e.g. number 5 refers to the cell #7)
at$Cell[5]


## CONSIDER THE NEIGHBORHOOD OF CELL #2 ##

# Cell #2 corresponds to the 1st element of both 'nbs_CELL' and 'nbs_ROW'
# because raster cell 1 is an NA-cell
r[1]

# Neighborhood cell #2 corresponds to cells:
nbs_CELL[1]

# Neighborhood cell #2 corresponds to rows:
nbs_ROW[1]

# Rows can be converted to cell numbers
at$Cell[ nbs_ROW[[1]] ]

# Note that 'at$Cell[ nbs_ROW[[1]] ]' is not equal to 'nbs_CELL'
identical( at$Cell[ nbs_ROW[[1]] ] , nbs_CELL[[1]] )

# This is because raster cells 1 and 4 (NA-cells) are omitted in 'nbs_ROW'
setdiff(nbs_CELL[[1]], at$Cell[ nbs_ROW[[1]] ])
r[c(1,4)]
</code></pre>


</div>