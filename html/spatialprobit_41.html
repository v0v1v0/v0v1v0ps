<div class="container">

<table style="width: 100%;"><tr>
<td>semprobit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian estimation of the SEM probit model</h2>

<h3>Description</h3>

<p>Bayesian estimation of the probit model with spatial errors (SEM probit model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">semprobit(formula, W, data, subset, ...)

sem_probit_mcmc(y, X, W, ndraw = 1000, burn.in = 100, thinning = 1, 
  prior=list(a1=1, a2=1, c=rep(0, ncol(X)), T=diag(ncol(X))*1e12,
  nu = 0, d0 = 0, lflag = 0), 
  start = list(rho = 0.75, beta = rep(0, ncol(X)), sige = 1),
  m=10, showProgress=FALSE, univariateConditionals = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>dependent variables. vector of zeros and ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraw</code></td>
<td>
<p>number of MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>number of MCMC burn-in to be discarded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>MCMC thinning factor, defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A list of prior settings for 
<code class="reqn">\rho \sim Beta(a1,a2)</code> 
and <code class="reqn">\beta \sim N(c,T)</code>. Defaults to diffuse prior for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>list of start values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of burn-in samples in innermost Gibbs sampler. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showProgress</code></td>
<td>
<p>Flag if progress bar should be shown. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>univariateConditionals</code></td>
<td>
<p>Switch whether to draw from univariate or multivariate truncated normals. See notes. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which semprobit is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bayesian estimates of the probit model with spatial errors (SEM probit model)
</p>
<p style="text-align: center;"><code class="reqn">
  z = X \beta + u, \\
  u = \rho W u + \epsilon, \epsilon \sim N(0, \sigma^2_{\epsilon} I_n)
</code>
</p>

<p>which leads to the data-generating process
</p>
<p style="text-align: center;"><code class="reqn">
  z = X \beta + (I_n - \rho W)^{-1} \epsilon
</code>
</p>
    
<p>where y is a binary 0,1 <code class="reqn">(n \times 1)</code> vector of observations for <code class="reqn">z &lt; 0</code> and <code class="reqn">z \ge 0</code>. 
<code class="reqn">\beta</code> is a <code class="reqn">(k \times 1)</code> 
vector of parameters associated with the <code class="reqn">(n \times k)</code> data matrix X.
</p>
<p>The prior distributions are 
<code class="reqn">\beta \sim N(c,T)</code>,
<code class="reqn">\sigma^2_{\epsilon} \sim IG(a1, a2)</code>, 
and  
<code class="reqn">\rho \sim Uni(rmin,rmax)</code> 
or 
<code class="reqn">\rho \sim Beta(a1,a2)</code>.
</p>


<h3>Value</h3>

<p>Returns a structure of class <code>semprobit</code>:

</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p> posterior mean of bhat based on draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p> posterior mean of rho based on draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdraw </code></td>
<td>
<p> beta draws (ndraw-nomit x nvar) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdraw </code></td>
<td>
<p> rho  draws (ndraw-nomit x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdraw </code></td>
<td>
<p> sige draws (ndraw-nomit x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total </code></td>
<td>
<p> a matrix (ndraw,nvars-1) total x-impacts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direct </code></td>
<td>
<p> a matrix (ndraw,nvars-1) direct x-impacts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indirect </code></td>
<td>
<p> a matrix (ndraw,nvars-1) indirect x-impacts </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>rdraw </code></td>
<td>
<p> r draws (ndraw-nomit x 1) (if m,k input) </p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>nobs </code></td>
<td>
<p> # of observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar </code></td>
<td>
<p> # of variables in x-matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraw </code></td>
<td>
<p> # of draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nomit </code></td>
<td>
<p> # of initial draws omitted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps </code></td>
<td>
<p> # of samples used by Gibbs sampler for TMVN </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p> y-vector from input (nobs x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zip </code></td>
<td>
<p> # of zero y-values </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>a1 </code></td>
<td>
<p> a1 parameter for beta prior on rho from input, or default value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2 </code></td>
<td>
<p> a2 parameter for beta prior on rho from input, or default value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time </code></td>
<td>
<p> total time taken </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax </code></td>
<td>
<p> 1/max eigenvalue of W (or rmax if input) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmin </code></td>
<td>
<p> 1/min eigenvalue of W (or rmin if input) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tflag </code></td>
<td>
<p> 'plevel' (default) for printing p-levels; 
'tstat' for printing bogus t-statistics </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lflag </code></td>
<td>
<p> lflag from input </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cflag </code></td>
<td>
<p> 1 for intercept term, 0 for no intercept term </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>lndet </code></td>
<td>
<p> a matrix containing log-determinant information
(for use in later function calls to save time) </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>adapted to and optimized for R by Stefan Wilhelm &lt;wilhelm@financial.com&gt; 
based on code from James P. LeSage</p>


<h3>References</h3>

<p>LeSage, J. and Pace, R. K. (2009), <em>Introduction to Spatial Econometrics</em>, CRC Press, chapter 10 
</p>


<h3>See Also</h3>

<p><code>sar_lndet</code> for computing log-determinants
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(Matrix)
# number of observations
n &lt;- 200

# true parameters
beta &lt;- c(0, 1, -1)
sige &lt;- 2
rho &lt;- 0.75

# design matrix with two standard normal variates as "covariates"
X &lt;- cbind(intercept=1, x=rnorm(n), y=rnorm(n))

# sparse identity matrix
I_n &lt;- sparseMatrix(i=1:n, j=1:n, x=1)

# number of nearest neighbors in spatial weight matrix W
m &lt;- 6

# spatial weight matrix with m=6 nearest neighbors
# W must not have non-zeros in the main diagonal!
i &lt;- rep(1:n, each=m)
j &lt;- rep(NA, n * m)
for (k in 1:n) {
  j[(((k-1)*m)+1):(k*m)] &lt;- sample(x=(1:n)[-k], size=m, replace=FALSE)
}
W &lt;- sparseMatrix(i, j, x=1/m, dims=c(n, n))

# innovations
eps &lt;- sqrt(sige)*rnorm(n=n, mean=0, sd=1)

# generate data from model 
S &lt;- I_n - rho * W
z &lt;- X %*% beta + solve(qr(S), eps)
y &lt;- as.double(z &gt;= 0)  # 0 or 1, FALSE or TRUE

# estimate SEM probit model
semprobit.fit1 &lt;- semprobit(y ~ X - 1, W, ndraw=500, burn.in=100, 
  thinning=1, prior=NULL)
summary(semprobit.fit1)

</code></pre>


</div>