<div class="container">

<table style="width: 100%;"><tr>
<td>StepwiseTest-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple Testing Method to Control Generalized Family-Wise Error Rate and False Discovery Proportion
</h2>

<h3>Description</h3>

<p>Collection of stepwise procedures to conduct multiple hypotheses testing. The details of the stepwise algorithm can be found in Romano and Wolf (2007) &lt;DOI:10.1214/009053606000001622&gt; and Hsu, Kuan, and Yen (2014) &lt;DOI:10.1093/jjfinec/nbu014&gt;.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FWERkControl(test_stat, boot_stat, k, alpha)
FDPControl(test_stat, boot_stat, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>test_stat</code></td>
<td>
<p>m x 1 column vector of test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot_stat</code></td>
<td>
<p>m x B matrix of bootstrap statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of false rejections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>False discovery proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The desired FWER(k) or FDP level</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>Reject</code>: A 0/1 numeric vector where the element <code>j</code> equals 1 indicates the model <code>j</code> is significant.
</p>
<p><code>CV</code>: The critical value.
</p>


<h3>Author(s)</h3>

<p>Yu-Chin Hsu and Kendro Vincent
</p>
<p>Maintainer: Kendro Vincent &lt;vincent.kendro@gmail.com&gt;
</p>


<h3>References</h3>

<p>Romano, J. P. and Wolf, M. (2005). “Stepwise multiple testing as formalized data snooping.” Econometrica, 73, 1237-1282.
</p>
<p>Romano, J. P. and Wolf, M. (2007). “Control of generalized error rates in multiple testing.” Annals of Statistics, 35, 1378-1408.
</p>
<p>Hsu, P.-H., Hsu, Y.-C., and Kuan, C.-M. (2010). “Testing the predictive ability of technical analysis using a new stepwise test without data-snooping bias.” Journal of Empirical Finance, 17, 471-484.
</p>
<p>Hsu, Y.-C., Kuan, C.-M., and Yen, M.-F. (2014). “A generalized stepwise procedure with improved power for multiple inequalities testing.” Journal of Financial Econometrics, 12, 730-755.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Specify the model parameters
m_null = 3
m_alt  = 7
m = m_null + m_alt
mu = c( rep(0, m_null), rep(0.5,m_alt) )
rho = 0.25
omega= (1-rho)*diag(1,m) + rho*matrix(1,m,m)
v=t(chol(omega))

# generate the data
n = 100
y = mu%*%matrix(1,1,n)+ v %*% matrix(rnorm(m*n),m,n)

# calculate the test statistics and bootstrap statistics
library(foreach)
library(tseries)
B = 100
y_mean = apply(y,1,mean)
y_sig = apply(y,1,sd)
t_stat = as.matrix(sqrt(n)*y_mean/y_sig)
s = tsbootstrap(1:n,B,b=2,type="stationary")
b_stat = foreach(i=1:B,.combine=cbind) %do% {
  y_boot = y[, s[,i]]
  y_mean_boot = apply(y_boot,1,mean)
  sqrt(n)*(y_mean_boot - y_mean)/y_sig
}

# Multiple test that controls FWER(1) at 5% significance level
FWERkControl(t_stat,b_stat,1,0.05)

# Multiple test that controls FWER(3) at 5% significance level
FWERkControl(t_stat,b_stat,1,0.05)

# Multiple test that controls FDP(0.1) at 5% significance level
FDPControl(t_stat,b_stat,0.1,0.05)

</code></pre>


</div>