<div class="container">

<table style="width: 100%;"><tr>
<td>calibrate_ER</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrate ER model to a given density</h2>

<h3>Description</h3>

<p>The model is an Erdos-Renyi model for the existence of links (a
link exists independently of other links with a fixed probability)
and the weight of each existing link follows an exponential
distribution with a fixed rate parameter. This function chooses the
two parameters such that the density of the network (the average
proportion of existing links) is a certain desired value. Diagonal
elements are being set to 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calibrate_ER(
  l,
  a,
  targetdensity,
  L_fixed = NA,
  nsamples_calib = 100,
  thin_calib = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>row sums of matrix to be reconstructed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>column sum of matrix to be reconstructed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetdensity</code></td>
<td>
<p>desired proportion of reconstructed entries to be positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_fixed</code></td>
<td>
<p>Matrix containing known values of L, where NA signifies that
an element is not known. If <code>L_fixed</code> equates to <code>NA</code> (the
default) then no values are assumed to be known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples_calib</code></td>
<td>
<p>number of matrices to generate during calibration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin_calib</code></td>
<td>
<p>amount of thinning to use during calibration</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Model that can be used to generate the desired samples using <code>sample_HierarchicalModel</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## first generate a true network
n &lt;- 10 # size of network
p &lt;- 0.45
lambda &lt;- 0.1
L &lt;- matrix(nrow=n,rbinom(n*n,prob=p,size=1)*rexp(n*n,rate=lambda))

# then reconstruct with a target density of 0.55
model &lt;- calibrate_ER(l=rowSums(L),a=colSums(L),
                      targetdensity=0.55,nsamples_calib=10)
Lsamp &lt;- sample_HierarchicalModel(l=rowSums(L),a=colSums(L),model=model,
                                    nsamples=10,thin=1e2)
# check row sums
rowSums(L)
rowSums(Lsamp$L[[10]])
# check calibration
mean(Lsamp$L[[10]]&gt;0)

# now an example with some fixed entries
L_fixed &lt;- L
L_fixed[1:(n/2),] &lt;- NA
# then reconstruct with a target density of 0.9
model &lt;- calibrate_ER(l=rowSums(L),a=colSums(L),L_fixed=L_fixed,
                              targetdensity=0.9,nsamples_calib=10)
Lsamp &lt;- sample_HierarchicalModel(l=rowSums(L),a=colSums(L),L_fixed=L_fixed,
                                  model=model,nsamples=10,thin=1e2)
mean(Lsamp$L[[10]][-(1:(n/2)),]&gt;0) # known entries
mean(Lsamp$L[[10]][(1:(n/2)),]&gt;0)  #reconstructed entries
</code></pre>


</div>