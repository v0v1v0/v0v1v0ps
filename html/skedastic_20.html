<div class="container">

<table style="width: 100%;"><tr>
<td>evans_king</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evans-King Tests for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the two methods of
Evans and King (1988) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evans_king(
  mainlm,
  method = c("GLS", "LM"),
  deflator = NA,
  lambda_star = 5,
  qfmethod = "imhof",
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character indicating which of the two tests derived in
Evans and King (1988) should be implemented.
Possible values are <code>"GLS"</code> and <code>"LM"</code>; partial matching is
used (which is not case-sensitive).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_star</code></td>
<td>
<p>A double; coefficient representing the degree of
heteroskedasticity under the alternative hypothesis.
Evans and King (1985) suggests 2.5, 5, 7.5, and 10 as
values to consider, and Evans and King (1988) finds
that 2.5 and 5 perform best empirically. This parameter is used only for
the <code>"GLS"</code> method; the <code>"LM"</code> method represents the limiting
case as <code class="reqn">\lambda^\star \to 0</code>. Defaults to <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qfmethod</code></td>
<td>
<p>A character, either <code>"imhof"</code>, <code>"davies"</code>, or
<code>"integrate"</code>, corresponding to the <code>algorithm</code> argument
of <code>pRQF</code>. The default is <code>"imhof"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test entails putting the data rows in increasing order of
some specified deflator (e.g., one of the explanatory variables) that
is believed to be related to the error variance by some non-decreasing
function. There are two statistics that can be used, corresponding to
the two values of the <code>method</code> argument. In both cases the test
statistic can be expressed as a ratio of quadratic forms in the errors,
and thus the Imhof algorithm is used to compute <code class="reqn">p</code>-values. Both
methods involve a left-tailed test.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Evans M, King ML (1985).
“A Point Optimal Test for Heteroscedastic Disturbances.”
<em>Journal of Econometrics</em>, <b>27</b>(2), 163–178.<br><br> Evans MA, King ML (1988).
“A Further Class of Tests for Heteroscedasticity.”
<em>Journal of Econometrics</em>, <b>37</b>, 265–276.
</p>


<h3>See Also</h3>

<p>Evans and King (1985), which already anticipates
one of the tests.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
evans_king(mtcars_lm, deflator = "qsec", method = "GLS")
evans_king(mtcars_lm, deflator = "qsec", method = "LM")

</code></pre>


</div>