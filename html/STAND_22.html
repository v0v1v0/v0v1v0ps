<div class="container">

<table style="width: 100%;"><tr>
<td>plekm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Product Limit Estimate for Non-detects Using Kaplan-Meier </h2>

<h3>Description</h3>

<p>Compute Product Limit Estimate (PLE) of F(x) and Confidence Limits for data with
non-detects (left censored data).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plekm(dd,gam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dd</code></td>
<td>
<p>An n by 2 matrix or data frame with <br>
x (exposure) variable in column 1, and <br>
det= 0 for non-detect or 1 for detect in column 2 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p> one-sided confidence level <code class="reqn">\gamma</code>. Default is 0.95 </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>R function <code>survreg</code> is used to calculate Kaplan-Meier estimate
of S(z), where z = k - x and k is greater than the largest x value.
This technique of "reversing the data" to convert left censored data
to right censored data was first suggested by Nelson (1972). conf.type
= "plain" is required in survreg for correct CLs.  The value of S(z)
is then used to calculate F(x).  Note that if <code class="reqn">\gamma</code> = 0.95 the 90%
two-sided CLs are calculated.
</p>


<h3>Value</h3>

<p>Data frame with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p> is the  value of j<em>th</em> detect (ordered) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ple</code></td>
<td>
<p> is PLE of F(x) at <code>a</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stder</code></td>
<td>
<p> standard error of F(x) at <code>a</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p> lower CL for PLE at <code>a</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p> upper CL for PLE at <code>a</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> number of detects or non-detects  <code class="reqn">\le</code><code>a</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> number of detects equal to <code>a</code> </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>In survival analysis S(x) = 1 - F(x) is the survival function
i.e., S(x) = P [X &gt; x]. In environmental and occupational situations
S(x) is the "exceedance" function, i.e., S(x) = is the proportion of
X values that exceed x. The PLE is the sample estimate of F(x), i.e.,
the proportion of values in the sample that are less than x.
</p>


<h3>Author(s)</h3>

<p>E. L. Frome </p>


<h3>References</h3>

<p>Nelson, W.(1972), "Theory and Application of Hazard Plotting for
Censored Failure  Data", <em>Technometrics</em>, 14, 945-66
</p>
<p>Frome, E. L. and Wambach, P.F. (2005) "Statistical Methods and Software for
the Analysis of Occupational Exposure Data with Non-Detectable Values",
<em>ORNL/TM-2005/52,Oak Ridge National Laboratory</em>, Oak Ridge, TN 37830.
Available at: <a href="http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf">http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf</a>
</p>
<p>Schmoyer, R. L., J. J. Beauchamp, C. C. Brandt and F. O. Hoffman, Jr.
(1996), "Difficulties with the Lognormal Model in Mean Estimation and
Testing," <em>Environmental and Ecological Statistics</em>, 3, 81-97.
</p>


<h3>See Also</h3>

<p><code>plend</code>, <code>pleicf</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SESdata) ## use SESdata data set Example 1 from ORNLTM-2005/52
pkm&lt;- plekm(SESdata)
qq.lnorm(pkm) #  lognormal q-q plot based on PLE
round(pkm,3)

</code></pre>


</div>