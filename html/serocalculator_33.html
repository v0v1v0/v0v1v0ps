<div class="container">

<table style="width: 100%;"><tr>
<td>sim.cs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a cross-sectional serosurvey with noise</h2>

<h3>Description</h3>

<p>Makes a cross-sectional data set (age, y(t) set)
and adds noise, if desired.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.cs(
  lambda = 0.1,
  n.smpl = 100,
  age.rng = c(0, 20),
  age.fx = NA,
  antigen_isos,
  n.mc = 0,
  renew.params = FALSE,
  add.noise = FALSE,
  curve_params,
  noise_limits,
  format = "wide",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a <code>numeric()</code> scalar indicating the incidence rate (in events per person-years)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.smpl</code></td>
<td>
<p>number of samples to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.rng</code></td>
<td>
<p>age range of sampled individuals, in years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.fx</code></td>
<td>
<p>specify the curve parameters to use by age (does nothing at present?)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antigen_isos</code></td>
<td>
<p>Character vector with one or more antibody names. Values must match <code>curve_params</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc</code></td>
<td>
<p>how many MCMC samples to use:
</p>

<ul>
<li>
<p> when <code>n.mc</code> is in <code>1:4000</code> a fixed posterior sample is used
</p>
</li>
<li>
<p> when <code>n.mc</code> = <code>0</code>, a random sample is chosen
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>renew.params</code></td>
<td>
<p>whether to generate a new parameter set for each infection
</p>

<ul>
<li> <p><code>renew.params = TRUE</code> generates a new parameter set for each infection
</p>
</li>
<li> <p><code>renew.params = FALSE</code> keeps the one selected at birth, but updates baseline y0
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.noise</code></td>
<td>
<p>a <code>logical()</code> indicating whether to add biological and measurement noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_params</code></td>
<td>
<p>a <code>data.frame()</code> containing MCMC samples of parameters from the Bayesian posterior distribution of a longitudinal decay curve model. The parameter columns must be named:
</p>

<ul>
<li> <p><code>antigen_iso</code>: a <code>character()</code> vector indicating antigen-isotype combinations
</p>
</li>
<li> <p><code>iter</code>: an <code>integer()</code> vector indicating MCMC sampling iterations
</p>
</li>
<li> <p><code>y0</code>: baseline antibody level at <code class="reqn">t=0</code> (<code class="reqn">y(t=0)</code>)
</p>
</li>
<li> <p><code>y1</code>: antibody peak level (ELISA units)
</p>
</li>
<li> <p><code>t1</code>: duration of infection
</p>
</li>
<li> <p><code>alpha</code>: antibody decay rate (1/days for the current longitudinal parameter sets)
</p>
</li>
<li> <p><code>r</code>: shape factor of antibody decay
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_limits</code></td>
<td>
<p>biologic noise distribution parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>a <code>character()</code> variable, containing either:
</p>

<ul>
<li> <p><code>"long"</code> (one measurement per row) or
</p>
</li>
<li> <p><code>"wide"</code> (one serum sample per row)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical: if TRUE, print verbose log information to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>simcs.tinf()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a tibble::tbl_df containing simulated cross-sectional serosurvey data, with columns:
</p>

<ul>
<li> <p><code>age</code>: age (in days)
</p>
</li>
<li>
<p> one column for each element in the <code>antigen_iso</code> input argument
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Load curve parameters
dmcmc &lt;- load_curve_params("https://osf.io/download/rtw5k")

# Specify the antibody-isotype responses to include in analyses
antibodies &lt;- c("HlyE_IgA", "HlyE_IgG")

# Set seed to reproduce results
set.seed(54321)

# Simulated incidence rate per person-year
lambda &lt;- 0.2;

# Range covered in simulations
lifespan &lt;- c(0, 10);

# Cross-sectional sample size
nrep &lt;- 100

# Biologic noise distribution
dlims &lt;- rbind(
  "HlyE_IgA" = c(min = 0, max = 0.5),
  "HlyE_IgG" = c(min = 0, max = 0.5))

# Generate cross-sectional data
csdata &lt;- sim.cs(
  curve_params = dmcmc,
  lambda = lambda,
  n.smpl = nrep,
  age.rng = lifespan,
  antigen_isos = antibodies,
  n.mc = 0,
  renew.params = TRUE,
  add.noise = TRUE,
  noise_limits = dlims,
  format = "long"
)

</code></pre>


</div>