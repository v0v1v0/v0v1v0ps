<div class="container">

<table style="width: 100%;"><tr>
<td>calculateContaminationFraction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the contamination fraction</h2>

<h3>Description</h3>

<p>This function computes the contamination fraction using two user-provided bits of information.  Firstly, a list of sets of genes that can be biologically assumed to be absent in at least some cells in your data set.  For example, these might be haemoglobin genes or immunoglobulin genes, which should not be expressed outside of erythroyctes and antibody producing cells respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculateContaminationFraction(
  sc,
  nonExpressedGeneList,
  useToEst,
  verbose = TRUE,
  forceAccept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>A SoupChannel object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonExpressedGeneList</code></td>
<td>
<p>A list containing sets of genes which can be assumed to be non-expressed in a subset of cells (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useToEst</code></td>
<td>
<p>A boolean matrix of dimensions ncol(toc) x length(nonExpressedGeneList) indicating which gene-sets should not be assumed to be non-expressed in each cell.  Row names must correspond to the names of <code>nonExpressedGeneList</code>.  Usually produced by <code>estimateNonExpressingCells</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print best estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceAccept</code></td>
<td>
<p>Passed to <code>setContaminationFraction</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Secondly, this function needs to know which cells definitely do not express the gene sets described above.  Continuing with the haemoglobin example, which are the erythrocytes that are producing haemoglobin mRNAs and which are non-erythrocytes that we can safely assume produce no such genes.  The assumption made is any expression from a gene set in cell marked as a "non-expressor" for that gene set, must be derived from the soup.  Therefore, the level of contamination present can be estimated from the amount of expression of these genes seen in these cells.
</p>
<p>Most often, the genesets are user supplied based on your knowledge of the experiment and the cells in which they are genuinely expressed is estimated using <code>estimateNonExpressingCells</code>.  However, they can also be supplied directly if other information is available.
</p>
<p>Usually, there is very little variation in the contamination fraction within a channel and very little power to detect the contamination accurately at a single cell level.  As such, the default mode of operation simply estimates one value of the contamination fraction that is applied to all cells in a channel.
</p>
<p>The global model fits a simple Poisson glm to the aggregated count data across all cells.
</p>
<p>Finally, note that if you are not able to find a reliable set of genes to use for contamination estimation, or you do not trust the values produced, the contamination fraction can be manually set by the user using <code>setContaminationFraction</code>.
</p>


<h3>Value</h3>

<p>A modified version of <code>sc</code> with estimates of the contamination (rho) added to the metaData table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Common gene list in real world data
geneList = list(HB=c('HBB','HBA2'))
#Gene list appropriate to toy data
geneList = list(CD7 = 'CD7')
ute = estimateNonExpressingCells(scToy,geneList)
sc = calculateContaminationFraction(scToy,geneList,ute)
</code></pre>


</div>