<div class="container">

<table style="width: 100%;"><tr>
<td>process_dgTMatrix_lists</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Count Matrix To Signature Matrix</h2>

<h3>Description</h3>

<p>This function takes a list of count matrices, processes them, calls cell-types, and generates signature matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">process_dgTMatrix_lists(
  dgTMatrix_list,
  name,
  species_name,
  naming_preference = -9,
  rda_path = "",
  panglao_set = FALSE,
  haveUMAP = FALSE,
  saveSCObject = FALSE,
  internal = FALSE,
  toSave = FALSE,
  path = NULL,
  use_sctransform = FALSE,
  test_ctname = "wilcox",
  genes_integrate = 2000,
  genes_include = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dgTMatrix_list</code></td>
<td>
<p>A list of matrices in the class of dgTMatrix object – sparce object – compatible with Seurat rownames should be of the same species for each.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the outputted signature matrices, cell-type preferences, and Seurat objects if you choose to save them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species_name</code></td>
<td>
<p>Mouse or human symbols, -9 if internal as Panglao objects have gene symbol and ensembl combined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naming_preference</code></td>
<td>
<p>For cell-type naming, see if cell-types given the inputted tissues are more likely to be named within one of the categories. These categories are: "brain", "epithelial", "endothelial", "blood", "connective","eye", "epidermis", "Digestive", "Immune", "pancreas", "liver", "reproductive", "kidney", "respiratory".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rda_path</code></td>
<td>
<p>If saved, directory to where data from scMappR_data is downloaded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panglao_set</code></td>
<td>
<p>If the inputted matrices are from Panglao (i.e. if they're internal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haveUMAP</code></td>
<td>
<p>Save the UMAPs - requires additional packages (see Seurat for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveSCObject</code></td>
<td>
<p>Save the Seurat object as an RData object (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>Was this used as part of the internal processing of Panglao datasets (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_sctransform</code></td>
<td>
<p>If you should use sctransform or the Normalize/VariableFeatures/ScaleData pipeline (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_ctname</code></td>
<td>
<p>statistical test for calling CT markers – must be in Seurat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes_integrate</code></td>
<td>
<p>The number of genes to include in the integration anchors feature when combining datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes_include</code></td>
<td>
<p>TRUE or FALSE – include 2000 genes in signature matrix or all matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a one line wrapper to process count matrices into a signature matrix.
It combines process_from_count, two methods of identifying cell-type identities (GSVA and Fisher's test).
Then, it takes the output of cell-type markers and converts it into a signature matrix of p-value ranks and odds ratios.
It saves the Seurat object (if chosen with saveSCObject), cell-type identities from GSVA (its own object), and the signature matrices.
Cell-type marker outputs are also saved in the generes .RData list. This is a list of cell-types containing all of the cell-type markers found with the FindMarkers function. Names of the generes lists and the signature matrices are kept.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>wilcoxon_rank_mat_t</code></td>
<td>
<p>A dataframe containing the signature matrix of ranks (-log10(Padj) * sign(fold-change)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wilcoxon_rank_mat_or</code></td>
<td>
<p>A dataframe containing the signature matrix of odds-ratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generes</code></td>
<td>
<p>All cell-type markers for each cell-type with p-value and fold changes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellLabel</code></td>
<td>
<p>matrix where each row is a cluster and each column provides information on the cell-type. Columns provide info on the cluster from seurat, the cell-type label from CellMarker and Panglao using the fisher's exact test and GSVA, and the top 30 markers per cluser.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
data(sm)
toProcess &lt;- list(example = sm)
tst1 &lt;- process_dgTMatrix_lists(dgTMatrix_list = toProcess, name = "testProcess",
                               species_name = "mouse", naming_preference = "eye", rda_path = "")


</code></pre>


</div>