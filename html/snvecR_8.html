<div class="container">

<table style="width: 100%;"><tr>
<td>snvec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Earth’s Obliquity and Precession in the Past</h2>

<h3>Description</h3>

<p><code>snvec()</code> computes climatic precession and obliquity (or tilt) from an
astronomical solution (AS) input and input values for dynamical ellipticity
(<code class="reqn">E_{d}</code>) and tidal dissipation (<code class="reqn">T_{d}</code>). It solves a set
of ordinary differential equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snvec(
  tend = -1000,
  ed = 1,
  td = 0,
  astronomical_solution = "full-ZB18a",
  os_ref_frame = "HCI",
  os_omt = NULL,
  os_inct = NULL,
  tres = -0.4,
  atol = 1e-05,
  rtol = 0,
  solver = "vode",
  quiet = FALSE,
  output = "nice"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tend</code></td>
<td>
<p>Final timestep in thousands of years (kyr).
Defaults to <code>-1000</code> kyr.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ed</code></td>
<td>
<p>Dynamical ellipticity <code class="reqn">E_{d}</code>, normalized to modern.
Defaults to <code>1.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>td</code></td>
<td>
<p>Tidal dissipation <code class="reqn">T_{d}</code>, normalized to modern. Defaults
to <code>0.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astronomical_solution</code></td>
<td>
<p>Character vector with the name of the desired
solution. Defaults to <code>"full-ZB18a"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>os_ref_frame</code></td>
<td>
<p>Character vector with the reference frame of the astronomical
solution. Either <code>"HCI"</code> for heliocentric inertial reference frame or
<code>"J2000"</code> for ecliptic J2000 reference frame. Defaults to <code>"HCI"</code> for
<code>HNBody</code> output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>os_omt</code></td>
<td>
<p>Longitude of ascending node of the solar equator relative to ECLIPJ2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>os_inct</code></td>
<td>
<p>Inclination of the solar equator relative to ECLIPJ2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tres</code></td>
<td>
<p>Output timestep resolution in thousands of years (kyr). Defaults
to <code>-0.4</code>. To determine the sign, think of from <code>0</code> to <code>tend</code> by timestep
<code>tres</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atol</code></td>
<td>
<p>Numerical absolute tolerance passed to <code>deSolve::ode()</code>'s
<code>atol</code>. Defaults to <code>1e-5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtol</code></td>
<td>
<p>Numerical relative tolerance passed to <code>deSolve::ode()</code>'s
<code>rtol</code>. Defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver</code></td>
<td>
<p>Character vector specifying the method passed to
<code>deSolve::ode()</code>'s <code>method</code>. Defaults to <code>"vode"</code> for stiff problems with
a variable timestep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Be quiet?
</p>

<ul>
<li>
<p> If <code>TRUE</code>, hide info messages.
</p>
</li>
<li>
<p> If <code>FALSE</code> (the default) print info messages and timing.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Character vector with name of desired output. One of:
</p>

<ul>
<li> <p><code>"nice"</code> (the default) A tibble with the
columns <code>time</code>, <code>eei</code>, <code>epl</code>, <code>phi</code>, <code>cp</code>.
</p>
</li>
<li> <p><code>"full"</code> A tibble with all the computed and
interpolated columns.
</p>
</li>
<li> <p><code>"ode"</code> A matrix with the output of the ODE solver.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a re-implementation of the C-code in the supplementary
information of Zeebe &amp; Lourens (2022). The terms are explained in detail
in Zeebe (2022).
</p>


<h3>Value</h3>

<p><code>snvec()</code> returns different output depending on the <code>outputs</code> argument.
</p>
<p>If <code>output = "nice"</code> (the default), returns a
tibble with the following columns:
</p>

<ul>
<li> <p><code>time</code> Time in thousands of years (kyr).
</p>
</li>
<li> <p><code>epl</code> Calculated Obliquity <code class="reqn">\epsilon</code> (radians).
</p>
</li>
<li> <p><code>phi</code> Calculated Precession <code class="reqn">\phi</code> (radians) from ECLIPJ2000.
</p>
</li>
<li> <p><code>cp</code> Calculated Climatic precession (-) as <code class="reqn">e\sin\bar{\omega}</code>.
</p>
</li>
</ul>
<p>where <code class="reqn">\bar{\omega}</code> is the longitude of perihelion relative to the moving equinox.
</p>
<p>If <code>output = "all"</code> (for developers), additional columns are included,
typically interpolated to output timescale.
</p>

<ul><li> <p><code>sx</code>, <code>sy</code>, <code>sz</code> The <code class="reqn">x</code>, <code class="reqn">y</code>, and <code class="reqn">z</code>-components of Earth's
spin axis unit vector <code class="reqn">\vec{s}</code> in the heliocentric inertial
reference frame.
</p>
</li></ul>
<p>See the source code for descriptions of all the intermediate computational
steps.
</p>
<p>If <code>output = "ode"</code>, it will return the raw output of the ODE solver, which
is an object of class <code>deSolve</code> and <code>matrix</code>, with columns <code>time</code>, <code>sx</code>,
<code>sy</code>, and <code>sz</code>. This can be useful for i.e. <code>deSolve::diagnostics()</code>.
</p>


<h3>Reference Frames of Astronomical Solutions</h3>

<p>NASA provides their asteroid and planet positions in the ecliptic J2000
reference frame, while long-term astronomical solution integrations are
often performed in the heliocentric inertial reference frame (HCI) or in the
inertial reference frame. This is to align the reference frame with the spin
vector of the Sun, making J2 corrections intuitive to implement.
</p>
<p>Obliquity is typically given in the ecliptic reference frame, so snvec
converts all outputs to J2000 if the <code>os_ref_frame</code> is equal to <code>"HCI"</code> and
does no transformations if it is already in <code>"J2000"</code>.
</p>
<p>For this, it uses <code class="reqn">\Omega_{\odot} = 75.5940</code> and
<code class="reqn">i_{\odot} = 7.155</code> as in Zeebe (2017). You can overwrite
these defaults with <code>os_omt</code> and <code>os_inct</code> if desired.
</p>


<h3>ODE Solver</h3>

<p>Note that the different ODE solver algorithm we use (Soetaert et al.,
2010) means that the R routine returns an evenly-spaced time grid, whereas
the C-routine has a variable time-step.
This means we need to explicitly set the stepsize <code>tres</code>.
</p>


<h3>References</h3>

<p>Zeebe, R.E. (2017). Numerical Solutions for the Orbital Motion of the Solar
System over the Past 100 Myr: Limits and New Results. <em>The Astronomical
Journal</em>, 154(5), <a href="https://doi.org/10.3847/1538-3881/aa8cce">doi:10.3847/1538-3881/aa8cce</a>.
</p>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.
</p>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2022). A deep-time dating tool for
paleo-applications utilizing obliquity and precession cycles: The role of
dynamical ellipticity and tidal dissipation. <em>Paleoceanography and
Paleoclimatology</em>, e2021PA004349. <a href="https://doi.org/10.1029/2021PA004349">doi:10.1029/2021PA004349</a>.
</p>
<p>Zeebe, R. E. (2022). Reduced Variations in Earth’s and Mars’ Orbital
Inclination and Earth’s Obliquity from 58 to 48 Myr ago due to Solar
System Chaos. <em>The Astronomical Journal</em>, 164(3),
<a href="https://doi.org/10.3847/1538-3881/ac80f8">doi:10.3847/1538-3881/ac80f8</a>.
</p>
<p>Wikipedia page on Orbital Elements:
<a href="https://en.wikipedia.org/wiki/Orbital_elements">https://en.wikipedia.org/wiki/Orbital_elements</a>
</p>
<p>Karline Soetaert, Thomas Petzoldt, R. Woodrow Setzer (2010). Solving
Differential Equations in R: Package deSolve. Journal of Statistical
Software, 33(9), 1–25. <a href="https://doi.org/10.18637/jss.v033.i09">doi:10.18637/jss.v033.i09</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>deSolve::ode()</code> from Soetaert et al., (2010) for the ODE solver that we
use.
</p>
</li>
<li> <p><code>get_solution()</code> Get astronomical solutions.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">

# default call
snvec(tend = -1e3, ed = 1, td = 0, tres = -0.4)

</code></pre>


</div>