<div class="container">

<table style="width: 100%;"><tr>
<td>sampleMultiplexSBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling of Multiplex SBMs</h2>

<h3>Description</h3>

<p>This function samples a Multiplex Stochastic Block Models, with various model
for the distribution of the edges:  Bernoulli, Poisson, or Gaussian models
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleMultiplexSBM(
  nbNodes,
  blockProp,
  nbLayers,
  connectParam,
  model,
  type = c("directed", "undirected", "bipartite"),
  dependent = FALSE,
  dimLabels = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nbNodes</code></td>
<td>
<p>number of nodes in each functional group involved in the Multiplex network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockProp</code></td>
<td>
<p>a vector for block proportion if the networks are simple, a list of parameters for block proportions for both functional groups if the networks are bipartite</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbLayers</code></td>
<td>
<p>a matrix with two columns and nbNetworks lines, each line specifying the index of the functional groups in interaction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connectParam</code></td>
<td>
<p>list of parameters for connectivity (of length nbNetworks). Each element is a list of one or two elements: a matrix of means 'mean' and an optional matrix of variances 'var', the sizes of which must match <code>blockProp</code> length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a vector of characters describing the model for  each network of the Multiplex relation between nodes (<code>'bernoulli'</code>, <code>'poisson'</code>, <code>'gaussian'</code>, ...). Default is <code>'bernoulli'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string of character indicating whether the networks are directed, undirected or bipartite</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependent</code></td>
<td>
<p>connection parameters in each network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimLabels</code></td>
<td>
<p>an optional list of labels for functional group involved in the network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>numeric to set the seed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of two elements : <code>simulatedMemberships</code> are the clustering of each node in each Functional Group,  <code>MultiplexNetwork</code> is the list of the simulated networks (each one being  a simple or bipartite network)
</p>


<h3>Examples</h3>

<pre><code class="language-R">nbLayers &lt;- 2

## MultiplexSBM without dependence between layers
Nnodes &lt;- 40
blockProp &lt;- c(.4,.6)
connectParam &lt;- list(list(mean=matrix(rbeta(4,.5,.5),2,2)),list(mean=matrix(rexp(4,.5),2,2)))
model &lt;- c("bernoulli","poisson")
type &lt;- "directed"
mySampleMultiplexSBM &lt;-
   sampleMultiplexSBM(
   nbNodes = Nnodes,
    blockProp = blockProp,
   nbLayers = nbLayers,
   connectParam = connectParam,
   model=model,
   type=type)
listSBM &lt;- mySampleMultiplexSBM$listSBM

## MultiplexSBM Gaussian with dependence
Q &lt;- 3
nbLayers &lt;- 2
connectParam &lt;- list()
connectParam$mu &lt;- vector("list",nbLayers)
connectParam$mu[[1]] &lt;-  matrix(.1,Q,Q) + diag(1:Q)
connectParam$mu[[2]] &lt;- matrix(-2,Q,Q) + diag(rev(Q:1))
connectParam$Sigma &lt;- matrix(c(2,1,1,4),nbLayers,nbLayers)
model &lt;- rep("gaussian",2)
type &lt;- "directed"
Nnodes &lt;- 80
blockProp &lt;- c(.3,.3,.4)
mySampleMultiplexSBM &lt;-
  sampleMultiplexSBM(
     nbNodes = Nnodes,
     blockProp = blockProp,
     nbLayers = nbLayers,
     connectParam = connectParam,
     model=model,
     type="undirected",
     dependent=TRUE)
listSBM &lt;- mySampleMultiplexSBM$listSBM
## MultiplexSBM Bernoulli with dependence
Q &lt;- 2
P00&lt;-matrix(runif(Q*Q),Q,Q)
P10&lt;-matrix(runif(Q*Q),Q,Q)
P01&lt;-matrix(runif(Q*Q),Q,Q)
P11&lt;-matrix(runif(Q*Q),Q,Q)
SumP&lt;-P00+P10+P01+P11
P00&lt;-P00/SumP
P01&lt;-P01/SumP
P10&lt;-P10/SumP
P11&lt;-P11/SumP
connectParam &lt;- list()
connectParam$prob00 &lt;- P00
connectParam$prob01 &lt;- P01
connectParam$prob10 &lt;- P10
connectParam$prob11 &lt;- P11
model &lt;- rep("bernoulli",2)
type &lt;- "directed"
nbLayers &lt;- 2
Nnodes &lt;- 40
blockProp &lt;- c(.6,.4)
mySampleMultiplexSBM &lt;-
   sampleMultiplexSBM(
     nbNodes = Nnodes,
     blockProp = blockProp,
     nbLayers = nbLayers,
     connectParam = connectParam,
     model=model,
     type=type,
     dependent=TRUE)
listSBM_BB &lt;- mySampleMultiplexSBM$listSBM

</code></pre>


</div>