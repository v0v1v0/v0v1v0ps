<div class="container">

<table style="width: 100%;"><tr>
<td>loadHMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load HMM parameters fitted by fastPHASE</h2>

<h3>Description</h3>

<p>This function loads the parameter estimates obtained by fastPHASE (see runFastPhase)
and assembles the Li and Stephens HMM, in the format required by the knockoff generation functions
knockoffHaplotypes and knockoffGenotypes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loadHMM(r_file, alpha_file, theta_file, char_file, compact = TRUE,
  phased = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r_file</code></td>
<td>
<p>a string with the path of the "_rhat.txt" file produced by fastPHASE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_file</code></td>
<td>
<p>a string with the path of the "_alphahat.txt" file produced by fastPHASE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_file</code></td>
<td>
<p>a string with the path of the "_thetahat.txt" file produced by fastPHASE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>char_file</code></td>
<td>
<p>a string with the path of the "_origchars" file produced by fastPHASE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compact</code></td>
<td>
<p>whether to assemble the explicit transition and emission matrices for the HMM (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phased</code></td>
<td>
<p>whether to assemble a model for phased haplotypes, if compact==FALSE (default: FALSE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function by default returns a structure with three fields:
</p>

<ul>
<li>
<p>"r": a numerical array of length p.
</p>
</li>
<li>
<p>"alpha": a numerical array of size (p,K).
</p>
</li>
<li>
<p>"theta": a numerical array of size (p,K).
</p>
</li>
</ul>
<p>If the parameter compact is FALSE, this function assembles the HMM model for the genotype data
(either unphased or phased), in the format required by the knockoff generation function knockoffHMM.
</p>


<h3>Value</h3>

<p>A structure containing the parameters from the Li and Stephens HMM for phased haplotypes.
</p>


<h3>References</h3>

<p>Scheet P, Stephens M (2006).
“A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase.”
<em>Am. J. Hum. Genet.</em>, <b>78</b>, 629–644.
doi: <a href="http://doi.org/10.1086/502802">10.1086/502802</a>.
</p>


<h3>See Also</h3>

<p>Other fastPHASE: <code>runFastPhase</code>,
<code>writeXtoInp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Specify the location of the fastPHASE output files containing the parameter estimates.
# Example files can be found in the package installation directory.
r_file = system.file("extdata", "genotypes_rhat.txt", package = "SNPknock")
alpha_file = system.file("extdata", "genotypes_alphahat.txt", package = "SNPknock")
theta_file = system.file("extdata", "genotypes_thetahat.txt", package = "SNPknock")
char_file = system.file("extdata", "genotypes_origchars", package = "SNPknock")

# Read the parameter files and load the HMM
hmm = loadHMM(r_file, alpha_file, theta_file, char_file)

# Read the parameter files and load the HMM
hmm.large = loadHMM(r_file, alpha_file, theta_file, char_file, compact=FALSE)

</code></pre>


</div>