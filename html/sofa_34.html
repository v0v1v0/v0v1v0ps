<div class="container">

<table style="width: 100%;"><tr>
<td>attachments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Work with attachments</h2>

<h3>Description</h3>

<p>Work with attachments
</p>


<h3>Usage</h3>

<pre><code class="language-R">doc_attach_create(
  cushion,
  dbname,
  docid,
  attachment,
  attname,
  as = "list",
  ...
)

doc_attach_info(cushion, dbname, docid, attname, ...)

doc_attach_get(cushion, dbname, docid, attname = NULL, type = "raw", ...)

doc_attach_delete(cushion, dbname, docid, attname, as = "list", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cushion</code></td>
<td>
<p>A <code>Cushion</code> object. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbname</code></td>
<td>
<p>(character) Database name. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>docid</code></td>
<td>
<p>(character) Document ID. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attachment</code></td>
<td>
<p>(character) A file name. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attname</code></td>
<td>
<p>(character) Attachment name. Required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as</code></td>
<td>
<p>(character) One of list (default) or json</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Curl args passed on to <code>HttpClient</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>(character) one of raw (default) or text. required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Methods:
</p>

<ul>
<li> <p><code>doc_attach_create</code> - create an attachment
</p>
</li>
<li> <p><code>doc_attach_info</code> - get info (headers) for an attachment
</p>
</li>
<li> <p><code>doc_attach_get</code> - get an attachment. this method does not attempt
to read the object into R, but only gets the raw bytes or plain
text. See examples for how to read some attachment types
</p>
</li>
<li> <p><code>doc_attach_delete</code> - delete and attachment
</p>
</li>
</ul>
<h3>Value</h3>

<p>JSON as a character string or a list (determined by the
<code>as</code> parameter)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
user &lt;- Sys.getenv("COUCHDB_TEST_USER")
pwd &lt;- Sys.getenv("COUCHDB_TEST_PWD")
(x &lt;- Cushion$new(user=user, pwd=pwd))

if ("foodb" %in% db_list(x)) {
  invisible(db_delete(x, dbname="foodb"))
}
db_create(x, dbname='foodb')

# create an attachment on an existing document
## create a document first
doc &lt;- '{"name":"stuff", "drink":"soda"}'
doc_create(x, dbname="foodb", doc=doc, docid="asoda")

## create a csv attachment
row.names(mtcars) &lt;- NULL
file &lt;- tempfile(fileext = ".csv")
write.csv(mtcars, file = file, row.names = FALSE)
doc_attach_create(x, dbname="foodb", docid="asoda",
  attachment=file, attname="mtcarstable.csv")

## create a binary (png) attachment
file &lt;- tempfile(fileext = ".png")
png(file)
plot(1:10)
dev.off()
doc_attach_create(x, dbname="foodb", docid="asoda",
  attachment=file, attname="img.png")

## create a binary (pdf) attachment
file &lt;- tempfile(fileext = ".pdf")
pdf(file)
plot(1:10)
dev.off()
doc_attach_create(x, dbname="foodb", docid="asoda",
  attachment=file, attname="plot.pdf")

# get info for an attachment (HEAD request)
doc_attach_info(x, "foodb", docid="asoda", attname="mtcarstable.csv")
doc_attach_info(x, "foodb", docid="asoda", attname="img.png")
doc_attach_info(x, "foodb", docid="asoda", attname="plot.pdf")

# get an attachment (GET request)
res &lt;- doc_attach_get(x, "foodb", docid="asoda",
  attname="mtcarstable.csv", type = "text")
read.csv(text = res)
doc_attach_get(x, "foodb", docid="asoda", attname="img.png")
doc_attach_get(x, "foodb", docid="asoda", attname="plot.pdf")
## OR, don't specify an attachment and list the attachments
(attchms &lt;- doc_attach_get(x, "foodb", docid="asoda", type="text"))
jsonlite::fromJSON(attchms)

# delete an attachment
doc_attach_delete(x, "foodb", docid="asoda", attname="mtcarstable.csv")
doc_attach_delete(x, "foodb", docid="asoda", attname="img.png")
doc_attach_delete(x, "foodb", docid="asoda", attname="plot.pdf")

## End(Not run)
</code></pre>


</div>