<div class="container">

<table style="width: 100%;"><tr>
<td>rasch.jml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Joint Maximum Likelihood (JML) Estimation of the Rasch Model
</h2>

<h3>Description</h3>

<p>This function estimates the Rasch model using joint maximum likelihood
estimation (Lincare, 1994). The PROX algorithm (Lincare, 1994) is used
for the generation of starting values of item parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rasch.jml(dat, method="MLE", b.init=NULL, constraints=NULL, weights=NULL,
    center="persons", glob.conv=10^(-6), conv1=1e-05, conv2=0.001, progress=TRUE,
    bsteps=4, thetasteps=2, wle.adj=0, jmliter=100, prox=TRUE,
    proxiter=30, proxconv=0.01, dp=NULL, theta.init=NULL, calc.fit=TRUE,
    prior_sd=NULL)

## S3 method for class 'rasch.jml'
summary(object, digits=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>An <code class="reqn">N \times I</code> data frame of dichotomous item responses
where <code class="reqn">N</code> indicates the number of persons
and <code class="reqn">I</code> the number of items
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method for estimating person parameters during JML iterations.
<code>MLE</code> is maximum likelihood estimation (where person with
perfect scores are deleted from analysis). <code>WLE</code> uses weighted
likelihood estimation (Warm, 1989) for person parameter estimation.
Default is <code>MLE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.init</code></td>
<td>

<p>Initial values of item difficulties
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>

<p>Optional matrix or data.frame with two columns. First column is an integer of
item indexes or item names (<code>colnames(dat)</code>) which shall be fixed
during estimation. The second column is the corresponding
item difficulty.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Person sample weights. Default is <code>NULL</code>, i.e. all persons in the sample
are equally weighted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Character indicator whether persons (<code>"persons"</code>),
items (<code>"items"</code>) should be centered or (<code>"none"</code>)
should be conducted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glob.conv</code></td>
<td>

<p>Global convergence criterion with respect to the log-likelihood function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv1</code></td>
<td>

<p>Convergence criterion for estimation of item parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv2</code></td>
<td>

<p>Convergence criterion for estimation of person parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Display progress? Default is <code>TRUE</code>
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>bsteps</code></td>
<td>

<p>Number of steps for b parameter estimation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetasteps</code></td>
<td>

<p>Number of steps for theta parameter estimation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wle.adj</code></td>
<td>

<p>Score adjustment for WLE estimation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jmliter</code></td>
<td>

<p>Number of maximal iterations during JML estimation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prox</code></td>
<td>

<p>Should the PROX algorithm (see <code>rasch.prox</code>) be used as initial estimations?
Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxiter</code></td>
<td>

<p>Number of maximal PROX iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proxconv</code></td>
<td>

<p>Convergence criterion for PROX iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>

<p>Object created from data preparation function (<code>.data.prep</code>)
which could be created in earlier JML runs. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.init</code></td>
<td>

<p>Initial person parameter estimate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc.fit</code></td>
<td>

<p>Should itemfit being calculated?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sd</code></td>
<td>

<p>Optional value for standard deviation of prior distribution for
ability values if penalized JML should be utilized
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object of class <code>rasch.jml</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits used for rounding</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimation is known to have a bias in item parameters for
a fixed (finite) number of items. In literature (Lincare, 1994), a simple
bias correction formula is proposed and included in the value
<code>item$itemdiff.correction</code> in this function. If <code class="reqn">I</code> denotes the number
of items, then the correction factor is <code class="reqn">\frac{I-1}{I}</code>.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>item</code></td>
<td>
<p>Estimated item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Estimated person parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Person parameter estimation method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Original data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.proc</code></td>
<td>
<p>Processed data frames excluding persons with extreme scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>Value of data preparation (it is used in the function
<code>rasch.jml.jackknife1</code>)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Linacre, J. M. (1994). <em>Many-Facet Rasch Measurement</em>. Chicago: MESA Press.
</p>
<p>Warm, T. A. (1989). Weighted likelihood estimation of ability in the item
response theory. <em>Psychometrika, 54</em>, 427-450.
</p>


<h3>See Also</h3>

<p>Get a summary with <code>summary.rasch.jml</code>.
</p>
<p>See <code>rasch.prox</code> for the PROX algorithm as initial iterations.
</p>
<p>For a bias correction of the JML method try <code>rasch.jml.jackknife1</code>.
</p>
<p>JML estimation can also be conducted with the <span class="pkg">TAM</span>
(<code>TAM::tam.jml</code>)
and <span class="pkg">immer</span> (<code>immer::immer_jml</code>)
packages.
</p>
<p>See also marginal maximum likelihood estimation with <code>rasch.mml2</code>
or the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package <span class="pkg">ltm</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Simulated data from the Rasch model
#############################################################################

set.seed(789)
N &lt;- 500    # number of persons
I &lt;- 11     # number of items
b &lt;- seq( -2, 2, length=I )
dat &lt;- sirt::sim.raschtype( stats::rnorm( N, mean=.5 ), b )
colnames(dat) &lt;- paste( "I", 1:I, sep="")

# JML estimation of the Rasch model (centering persons)
mod1 &lt;- sirt::rasch.jml( dat )
summary(mod1)

# JML estimation of the Rasch model (centering items)
mod1b &lt;- sirt::rasch.jml( dat, center="items" )
summary(mod1b)

# MML estimation with rasch.mml2 function
mod2 &lt;- sirt::rasch.mml2( dat )
summary(mod2)

# Pairwise method of Fischer
mod3 &lt;- sirt::rasch.pairwise( dat )
summary(mod3)

# JML estimation in TAM
## Not run: 
library(TAM)
mod4 &lt;- TAM::tam.jml( resp=dat )

#******
# item parameter constraints in JML estimation
# fix item difficulties: b[4]=-.76 and b[6]=.10
constraints &lt;- matrix( cbind( 4, -.76,
                              6, .10 ),
                  ncol=2, byrow=TRUE )
mod6 &lt;- sirt::rasch.jml( dat, constraints=constraints )
summary(mod6)
  # For constrained item parameters, it this not obvious
  # how to calculate a 'right correction' of item parameter bias

## End(Not run)
</code></pre>


</div>