<div class="container">

<table style="width: 100%;"><tr>
<td>diblasi_bowman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diblasi and Bowman's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the nonparametric test of
Diblasi and Bowman (1997) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diblasi_bowman(
  mainlm,
  distmethod = c("moment.match", "bootstrap"),
  H = 0.08,
  ignorecov = TRUE,
  B = 500L,
  seed = 1234,
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distmethod</code></td>
<td>
<p>A character specifying the method by which to estimate
the <code class="reqn">p</code>-values, either <code>"moment.match"</code> or <code>"bootstrap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>A hyperparameter denoting the bandwidth matrix in the kernel
function used for weights in nonparametric smoothing. If a double of
length 1 (the default), <code>H</code> is set to <code class="reqn">h I_{p^\prime}</code> where
<code class="reqn">h</code> is the scalar bandwidth value entered and <code class="reqn">I_{p^\prime}</code>
is the <code class="reqn">p^\prime \times p^\prime</code> identity matrix (where
<code class="reqn">p^\prime</code> is the number of columns in the <code class="reqn">X</code> matrix, excluding
an intercept if present). If a double of length <code class="reqn">p^\prime</code>, <code>H</code>
is set to <code class="reqn">diag(h)</code> where <code class="reqn">h</code> is the bandwidth vector entered.
If <code>H</code> is a <code class="reqn">p^\prime\times p^\prime</code> matrix it is used as is.
Any other dimensionality of <code>H</code> results in an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignorecov</code></td>
<td>
<p>A logical. If <code>TRUE</code> (the default), the
variance-covariance matrix of <code class="reqn">s</code> is assumed to be diagonal. (This
assumption is, strictly speaking, invalid, but usually yields a reasonable
approximation. Computation time is
prohibitive for large sample sizes if set to <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer specifying the number of nonparametric bootstrap
replications to be used, if <code>distmethod="bootstrap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer specifying a seed to pass to
<code>set.seed</code> for random number generation. This allows
reproducibility of bootstrap results. The value <code>NA</code>
results in not setting a seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test entails undertaking a transformation of the OLS residuals
<code class="reqn">s_i=\sqrt{|e_i|}-E_0(\sqrt{|e_i|})</code>, where <code class="reqn">E_0</code> denotes
expectation under the null hypothesis of homoskedasticity. The kernel
method of nonparametric regression is used to fit the relationship
between these <code class="reqn">s_i</code> and the explanatory variables. This leads to a
test statistic <code class="reqn">T</code> that is a ratio of quadratic forms involving the
vector of <code class="reqn">s_i</code> and the matrix of normal kernel weights. Although
nonparametric in its method of fitting the possible heteroskedastic
relationship, the distributional approximation used to compute
<code class="reqn">p</code>-values assumes normality of the errors.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Diblasi A, Bowman A (1997).
“Testing for Constant Variance in a Linear Model.”
<em>Statistics &amp; Probability Letters</em>, <b>33</b>, 95–103.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
diblasi_bowman(mtcars_lm)
diblasi_bowman(mtcars_lm, ignorecov = FALSE)
diblasi_bowman(mtcars_lm, distmethod = "bootstrap")

</code></pre>


</div>