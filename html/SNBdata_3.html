<div class="container">

<table style="width: 100%;"><tr>
<td>SNBdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Download Data from the Swiss National Bank (SNB)
</h2>

<h3>Description</h3>


<p>Download data (‘tables’ and ‘datasets’) from the
Swiss National Bank (<abbr><span class="acronym">SNB</span></abbr>) and convert to data-frames.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
fetch_data(id,
           type = "table", dest.dir = NULL,
           return.class = NULL, verbose = TRUE,
           language = "en",
           name.sep = " :: ",
           method,
           na.drop = TRUE,
           time.series = FALSE, ...)

fetch_last_update(id,
                  type = "table", dest.dir = NULL,
                  verbose = TRUE, language = "en", ...)

fetch_info(id,
           type = "table", dest.dir = NULL,
           verbose = TRUE,
           language = "en",
           name.sep = " :: ",
           method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dest.dir</code></td>
<td>

<p>file path: where to store the downloaded files? See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>string: identifier of the table/dataset
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>string: ‘<code>table</code>’ or ‘<code>dataset</code>’
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>see <code>download.file</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical: print messages, e.g. about download progress?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.class</code></td>
<td>

<p><code>NULL</code> or character: not yet implemented (but in
future versions, <code>zoo</code> will be supported)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>language</code></td>
<td>

<p>string: <code>en</code>, <code>fr</code> or <code>de</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>passed on to <code>read.table</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.sep</code></td>
<td>

<p>string used when pasting description hierarchies
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>

<p>logical. If <code>TRUE</code>, data are transformed into
time-series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.drop</code></td>
<td>

<p>logical. If <code>TRUE</code>, rows with no finite values at all
are dropped.  Only used if <code>time.series</code> is
<code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>The Swiss National Bank (<abbr><span class="acronym">SNB</span></abbr>) provides data as either
so-called tables or datasets.  <code>fetch_table</code> can handle
both, but the <code>type</code> argument must be specified.
</p>
<p><code>fetch_table</code> downloads data, which typically are in
<abbr><span class="acronym">csv</span></abbr> format, from the <abbr><span class="acronym">SNB</span></abbr>'s website and
stores them, with a date prefix, in directory <code>dest.dir</code>.
If the latter is <code>NULL</code>, a temporary directory is used
(through <code>tempdir</code>); but much better is to use a
more-persistent storage location.  If a file with today's date
exists in <code>dest.dir</code>, that file is read, and nothing is
downloaded.
</p>
<p>For downloading, function <code>download.file</code> is used.
See <code>download.file</code> for options; in particular, see
the hints about <code>timeout</code> when downloading large files.
</p>
<p>When argument <code>time.series</code> is <code>TRUE</code>,
<code>fetch_table</code> will rearrange the data into time-series.
This requires columns named “<code>Date</code>” and
“<code>Value</code>” in the particular dataset/table.  If the
“<code>Date</code>” column has a <code>YYYY-MM-DD</code> pattern,
it will will be transformed with <code>as.Date</code>.
</p>


<h3>Value</h3>


<p>typically a <code>data.frame</code>,
potentially with attributes additional attributes:
</p>

<dl>
<dt><code>info</code></dt>
<dd>
<p>information about identifiers used by the <abbr><span class="acronym">SNB</span></abbr>
</p>
</dd>
<dt><code>columns</code></dt>
<dd>
<p>if <code>time.series</code> is <code>TRUE</code>, the names of the
columns used for grouping the rows
</p>
</dd>
</dl>
<p>Should the download fail, the function returns
<code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Enrico Schumann
</p>


<h3>References</h3>

<p><a href="https://data.snb.ch/en">https://data.snb.ch/en</a>
</p>
<p>for <code>help</code> on the <abbr><span class="acronym">API</span></abbr>,
see<a href="https://data.snb.ch/en/help#data_api">https://data.snb.ch/en/help#data_api</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## (Internet connection required)

### set directory for storing the files.  This is
### only an example: Much better is to use a permanent
### storage-location, such as '~/Downloads/SNBdata'
data.dir &lt;- tempdir()

rates &lt;- fetch_data("rendoblim",
                    type = "table",
                    dest.dir = data.dir,
                    language = "en")

### ==&gt; have data transformed into time-series
rates &lt;- fetch_data("rendoblim",
                    type = "table",
                    dest.dir = data.dir,
                    language = "en",
                    time.series = TRUE)

if (!is.null(rates))  ## check: if download failed, results
                      ##        are NULL
    attr(rates, "info")


stock.markets &lt;- fetch_data("capchstocki",
                            type = "table",
                            dest.dir = data.dir,
                            time.series = TRUE)
## e.g.: stock.markets[, "GDR"]  ## total return index
</code></pre>


</div>