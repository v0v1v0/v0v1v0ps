<div class="container">

<table style="width: 100%;"><tr>
<td>sdcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semi-distance covariance and correlation statistics</h2>

<h3>Description</h3>

<p>Compute the statistics (or sample estimates) of semi-distance
covariance and correlation. The semi-distance correlation is a standardized
version of semi-distance covariance, and it can measure the dependence
between a <em>multivariate</em> continuous variable and a categorical variable.
See Details for the definition of semi-distance covariance and
semi-distance correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sdcov(X, y, type = "V", return_mat = FALSE)

sdcor(X, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data of multivariate continuous variables, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix, or, a vector of length <code class="reqn">n</code> (for univariate
variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of statistic: <code>"V"</code> (the default) or <code>"U"</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_mat</code></td>
<td>
<p>A boolean. If <code>FALSE</code> (the default), only the calculated
statistic is returned. If <code>TRUE</code>, also return the matrix of the distances
of X and the divergences of y, which is useful for the permutation test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code class="reqn">\bm{X} \in \mathbb{R}^{p}</code> and <code class="reqn">Y \in \{1, 2, \cdots,
  R\}</code>, the (population-level) semi-distance covariance is defined as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{SDcov}(\bm{X}, Y) =
  \mathrm{E}\left[\|\bm{X}-\widetilde{\bm{X}}\|\left(1-\sum_{r=1}^R
  I(Y=r,\widetilde{Y}=r)/p_r\right)\right],</code>
</p>
<p> where <code class="reqn">p_r = P(Y = r)</code> and
<code class="reqn">(\widetilde{\bm{X}}, \widetilde{Y})</code> is an iid copy of <code class="reqn">(\bm{X},
  Y)</code>.
The (population-level) semi-distance correlation is defined as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{SDcor}(\bm{X}, Y) = \dfrac{\mathrm{SDcov}(\bm{X},
  Y)}{\mathrm{dvar}(\bm{X})\sqrt{R-1}},</code>
</p>
<p> where <code class="reqn">\mathrm{dvar}(\bm{X})</code> is
the distance variance (Szekely, Rizzo, and Bakirov 2007) of <code class="reqn">\bm{X}</code>.
</p>
<p>With <code class="reqn">n</code> observations <code class="reqn">\{(\bm{X}_i, Y_i)\}_{i=1}^{n}</code>, <code>sdcov()</code>
and <code>sdcor()</code> can compute the sample estimates for the semi-distance
covariance and correlation.
</p>
<p>If <code>type = "V"</code>, the semi-distance covariance statistic is computed as a
V-statistic, which takes a very similar form as the energy-based statistic
with double centering, and is always non-negative. Specifically,
</p>
<p style="text-align: center;"><code class="reqn">\text{SDcov}_n(\bm{X}, y) = \frac{1}{n^2} \sum_{k=1}^{n}
  \sum_{l=1}^{n} A_{kl} B_{kl},</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">A_{kl} = a_{kl} - \bar{a}_{k.} - \bar{a}_{.l} + \bar{a}_{..}</code>
</p>

<p>is the double centering (Szekely, Rizzo, and Bakirov 2007) of
<code class="reqn">a_{kl} = \| \bm{X}_k - \bm{X}_l \|,</code> and </p>
<p style="text-align: center;"><code class="reqn">B_{kl} =
  1 - \sum_{r=1}^{R} I(Y_k = r) I(Y_l = r) / \hat{p}_r</code>
</p>
<p> with <code class="reqn">\hat{p}_r =
  n_r / n = n^{-1}\sum_{i=1}^{n} I(Y_i = r)</code>.
The semi-distance correlation statistic is </p>
<p style="text-align: center;"><code class="reqn">\text{SDcor}_n(\bm{X}, y)
  = \dfrac{\text{SDcov}_n(\bm{X}, y)}{\text{dvar}_n(\bm{X})\sqrt{R - 1}},</code>
</p>

<p>where <code class="reqn">\text{dvar}_n(\bm{X})</code> is the V-statistic of distance variance
of <code class="reqn">\bm{X}</code>.
</p>
<p>If <code>type = "U"</code>, then the semi-distance covariance statistic is computed as
an “estimated U-statistic”, which is utilized in the independence test
statistic and is not necessarily non-negative. Specifically,
</p>
<p style="text-align: center;"><code class="reqn">\widetilde{\text{SDcov}}_n(\bm{X}, y) = \frac{1}{n(n-1)}
  \sum_{i \ne j} \| \bm{X}_i - \bm{X}_j \| \left(1 - \sum_{r=1}^{R}
  I(Y_i = r) I(Y_j = r) / \tilde{p}_r\right),</code>
</p>

<p>where <code class="reqn">\tilde{p}_r = (n_r-1) / (n-1) = (n-1)^{-1}(\sum_{i=1}^{n} I(Y_i
  = r) - 1)</code>. Note that the test statistic of the semi-distance independence
test is </p>
<p style="text-align: center;"><code class="reqn">T_n = n \cdot \widetilde{\text{SDcov}}_n(\bm{X}, y).</code>
</p>



<h3>Value</h3>

<p>The value of the corresponding sample statistic.
</p>
<p>If the argument <code>return_mat</code> of <code>sdcov()</code> is set as <code>TRUE</code>, a list with
elements
</p>

<ul>
<li> <p><code>sdcov</code>: the semi-distance covariance statistic;
</p>
</li>
<li> <p><code style="white-space: pre;">⁠mat_x, mat_y⁠</code>: the matrices of the distances of X and the divergences
of y, respectively;
</p>
</li>
</ul>
<p>will be returned.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>sd_test()</code> for implementing independence test via semi-distance
covariance;
</p>
</li>
<li> <p><code>sd_sis()</code> for implementing groupwise feature screening via
semi-distance correlation.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">X &lt;- mtcars[, c("mpg", "disp", "drat", "wt")]
y &lt;- factor(mtcars[, "am"])
print(sdcov(X, y))
print(sdcor(X, y))

# Man-made independent data -------------------------------------------------
n &lt;- 30; R &lt;- 5; p &lt;- 3; prob &lt;- rep(1/R, R)
X &lt;- matrix(rnorm(n*p), n, p)
y &lt;- factor(sample(1:R, size = n, replace = TRUE, prob = prob), levels = 1:R)
print(sdcov(X, y))
print(sdcor(X, y))

# Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3; p &lt;- 3
X &lt;- matrix(0, n, p)
X[1:10, 1] &lt;- 1; X[11:20, 2] &lt;- 1; X[21:30, 3] &lt;- 1
y &lt;- factor(rep(1:3, each = 10))
print(sdcov(X, y))
print(sdcor(X, y))

</code></pre>


</div>