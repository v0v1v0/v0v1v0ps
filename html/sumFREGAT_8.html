<div class="container">

<table style="width: 100%;"><tr>
<td>prep.score.files</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare score files</h2>

<h3>Description</h3>

<p>Calculates Z scores from P values and beta input
</p>


<h3>Usage</h3>

<pre><code class="language-R">prep.score.files(data, reference = "ref1KG.MAC5.EUR_AF.RData",
output.file.prefix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a file name or data.frame with two mandatory columns (case-insensitive header):<br><br>
"ID": unique names of genetic variants (rsIDs if 1000G correlation matrices will be used)<br>
"P": P value<br><br>
Chromosome and positions are desirable:<br><br>
"CHROM": chromosome<br>
"POS": positions for the same build as in <code>gene.file</code> (see <code>gene-based test functions</code>)<br><br>
Map data are required to assign genetic variants to genes. If not present in input file, the function will
attempt to link them from the reference file (see <code>reference</code> below).<br><br>
Additional columns that can be present in input file to be used in gene-based tests:<br><br>
"EA": effect allele<br>
"BETA": effect size (betas and genetic correlations should be calculated for the same genotype coding)<br>
"EAF": effect allele frequency<br><br>
Effect allele and size data can be proccesed with reference file only (see <code>reference</code> below).<br><br>
"REF": reference allele<br>
"ALT": alternative allele<br><br>
"REF" and "ALT" columns can be used to compare alleles with those in reference file and exclude genetic variants if
alleles do not match<br><br>
Annotation columns:<br><br>
"ANNO": functional annotations (like "intron_variant", "synonymous", "missense" etc.)<br>
"PROB", "PROB1", "PROB2", "PROB3" etc.: probabilities of a variant to be causal, can be passed to
<code>sumSTAAR()</code> (PHRED scale) or <code>FFGAS()</code><br><br>
For example:<br><br>
CHROM POS ID EA P BETA EAF<br>
1 196632134 1:196632134 T 0.80675 0.22946 0.00588<br>
1 196632386 1:196632386 A 0.48694 0.65208 0.00588<br>
1 196632470 1:196632470 G 0.25594 -0.19280 0.19412<br><br>
Avoid rounding of betas and P values as this can affect the precision of regional tests.<br><br>
The more data (columns) is present in input file, the more gene-based tests are available to run. ACAT test is available
with minimal input (rsIDs and P values). Together with correlation matrices (reference matrices calculated from 1000G data
are available at http://mga.bionet.nsc.ru/sumFREGAT/) it allows to run <code>minp()</code>, <code>simpleM</code>, and <code>sumchi()</code> tests.
Adding info on effect allele ("EA") and effect size ("BETA") enables essentially all sumFREGAT tests. Adding allele frequencies
enables standard weighting via beta distribution (see <code>gene-based test functions</code> for details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>path to a reference file or data.frame with additional data needed to recode user <code>data</code> according to
correlation matrices that will be used. Reference file for 1000G correlation matrices is available at
http://mga.bionet.nsc.ru/sumFREGAT/. Reference file contains "ID" column with names of genetic variants that are used
in correlation matrices as well as "REF" and "ALT" columns with alleles that were coded during calculation of correlation
coefficients as 0 and 1, respectively. Effect sizes from <code>data</code> will be inverted for variants with effect alleles
different from "ALT" alleles in reference data. If presented, "REF" and "ALT" columns from the input data will be used to
sort out variants with alleles different from those in reference data. The reference file can also be a source of map data
and allele frequencies if they are not present in <code>data</code>. "AF" column in the reference file represents the allele
frequency of "ALT" allele.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.file.prefix</code></td>
<td>
<p>if not set, the input file name will be used as output prefix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>does not return any value, writes output files with Z scores to be used in any type of
gene-based analysis in sumFREGAT (see <code>gene-based test functions</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

data &lt;- system.file("testfiles/CFH.dat", package = "sumFREGAT")
prep.score.files(data, output.file.prefix = "CFH")

# requires reference file "ref1KG.MAC5.EUR_AF.RData" (can be downloaded
# at http://mga.bionet.nsc.ru/sumFREGAT/)

data &lt;- system.file("testfiles/CFH.full.input.dat", package = "sumFREGAT")
prep.score.files(data, reference = "ref1KG.MAC5.EUR_AF.RData",
	output.file.prefix = "CFH.full")

data &lt;- system.file("testfiles/CFH.prob.dat", package = "sumFREGAT")
prep.score.files(data, reference = "ref1KG.MAC5.EUR_AF.RData",
	output.file.prefix = "CFH.prob")

## End(Not run)
</code></pre>


</div>