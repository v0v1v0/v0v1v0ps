<div class="container">

<table style="width: 100%;"><tr>
<td>lavaan.mi-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class for a lavaan Model Fitted to Multiple Imputations</h2>

<h3>Description</h3>

<p>This class extends the <code>lavaanList</code> class, created by
fitting a lavaan model to a list of data sets. In this case, the list of
data sets are multiple imputations of missing data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'lavaan.mi'
show(object)

## S4 method for signature 'lavaan.mi'
summary(object, se = TRUE, ci = FALSE,
  level = 0.95, standardized = FALSE, rsquare = FALSE, fmi = FALSE,
  scale.W = !asymptotic, omit.imps = c("no.conv", "no.se"),
  asymptotic = FALSE, header = TRUE, output = "text",
  fit.measures = FALSE, ...)

## S4 method for signature 'lavaan.mi'
nobs(object, total = TRUE)

## S4 method for signature 'lavaan.mi'
coef(object, type = "free", labels = TRUE, omit.imps = c("no.conv", "no.se"))

## S4 method for signature 'lavaan.mi'
vcov(object, type = c("pooled", "between", "within",
  "ariv"), scale.W = TRUE, omit.imps = c("no.conv", "no.se"))

## S4 method for signature 'lavaan.mi'
anova(object, ...)

## S4 method for signature 'lavaan.mi'
fitMeasures(object, fit.measures = "all",
  baseline.model = NULL, output = "vector", omit.imps = c("no.conv",
  "no.se"), ...)

## S4 method for signature 'lavaan.mi'
fitmeasures(object, fit.measures = "all",
  baseline.model = NULL, output = "vector", omit.imps = c("no.conv",
  "no.se"), ...)

## S4 method for signature 'lavaan.mi'
fitted(object, omit.imps = c("no.conv", "no.se"))

## S4 method for signature 'lavaan.mi'
fitted.values(object, omit.imps = c("no.conv", "no.se"))

## S4 method for signature 'lavaan.mi'
residuals(object, type = c("raw", "cor"), omit.imps = c("no.conv", "no.se"))

## S4 method for signature 'lavaan.mi'
resid(object, type = c("raw", "cor"), omit.imps = c("no.conv", "no.se"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>lavaan.mi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se, ci, level, standardized, rsquare, header, output</code></td>
<td>
<p>See
<code>parameterEstimates</code>. <code>output</code>
can also be passed to <code>fitMeasures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmi</code></td>
<td>
<p><code>logical</code> indicating whether to include the Fraction Missing
Information (FMI) for parameter estimates in the <code>summary</code>
output (see <b>Value</b> section).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.W</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), the <code>vcov</code>
method will calculate the pooled covariance matrix by scaling the
within-imputation component by the ARIV (see Enders, 2010, p. 235,
for definition and formula). Otherwise, the pooled matrix is
calculated as the weighted sum of the within-imputation and
between-imputation components (see Enders, 2010, ch. 8, for details).
This in turn affects how the <code>summary</code> method calcualtes its
pooled standard errors, as well as the Wald test
(<code>lavTestWald.mi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.imps</code></td>
<td>
<p><code>character</code> vector specifying criteria for omitting
imputations from pooled results.  Can include any of
<code>c("no.conv", "no.se", "no.npd")</code>, the first 2 of which are the
default setting, which excludes any imputations that did not
converge or for which standard errors could not be computed.  The
last option (<code>"no.npd"</code>) would exclude any imputations which
yielded a nonpositive definite covariance matrix for observed or
latent variables, which would include any "improper solutions" such
as Heywood cases.  NPD solutions are not excluded by default because
they are likely to occur due to sampling error, especially in small
samples.  However, gross model misspecification could also cause
NPD solutions, users can compare pooled results with and without
this setting as a sensitivity analysis to see whether some
imputations warrant further investigation. Specific imputation
numbers can also be included in this argument, in case users want to
apply their own custom omission criteria (or simulations can use
different numbers of imputations without redundantly refitting the
model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymptotic</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code> (typically a default, but
see <b>Value</b> section for details using various methods), pooled
tests (of fit or pooled estimates) will be <em>F</em> or <em>t</em>
statistics with associated degrees of freedom (<em>df</em>). If
<code>TRUE</code>, the (denominator) <em>df</em> are assumed to be
sufficiently large for a <em>t</em> statistic to follow a normal
distribution, so it is printed as a <em>z</em> statisic; likewise,
<em>F</em> times its numerator <em>df</em> is printed, assumed to follow
a <code class="reqn">\chi^2</code> distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.measures, baseline.model</code></td>
<td>
<p>See <code>fitMeasures</code>.
<code>summary(object, fit.measures = TRUE)</code> will print (but not
return) a table of fit measures to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>lavTestLRT.mi</code>, or
subsequently to <code>lavTestLRT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p><code>logical</code> (default: <code>TRUE</code>) indicating whether the
<code>nobs</code> method should return the total sample size or (if
<code>FALSE</code>) a vector of group sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The meaning of this argument varies depending on which method it
it used for. Find detailed descriptions in the <b>Value</b> section
under <code>coef</code>, <code>vcov</code>, and <code>residuals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p><code>logical</code> indicating whether the <code>coef</code> output
should include parameter labels. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p><code>signature(object = "lavaan.mi", type = "free",
  labels = TRUE, omit.imps = c("no.conv","no.se"))</code>:
See <code>lavaan</code>. Returns the pooled point estimates (i.e.,
averaged across imputed data sets; see Rubin, 1987).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p><code>signature(object = "lavaan.mi", scale.W = TRUE,
  omit.imps = c("no.conv","no.se"),
  type = c("pooled","between","within","ariv"))</code>:  By default, returns the
pooled covariance matrix of parameter estimates (<code>type = "pooled"</code>),
the within-imputations covariance matrix (<code>type = "within"</code>), the
between-imputations covariance matrix (<code>type = "between"</code>), or the
average relative increase in variance (<code>type = "ariv"</code>) due to
missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p><code>signature(object = "lavaan.mi",
  omit.imps = c("no.conv","no.se"))</code>: See <code>lavaan</code>.
Returns model-implied moments, evaluated at the pooled point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>alias for <code>fitted.values</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p><code>signature(object = "lavaan.mi",
  type = c("raw","cor"), omit.imps = c("no.conv","no.se"))</code>:
See <code>lavaan</code>. By default (<code>type = "raw"</code>), returns
the difference between the model-implied moments from <code>fitted.values</code>
and the pooled observed moments (i.e., averaged across imputed data sets).
Standardized residuals are also available, using Bollen's
(<code>type = "cor"</code> or <code>"cor.bollen"</code>) or Bentler's
(<code>type = "cor.bentler"</code>) formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>alias for <code>residuals</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p><code>signature(object = "lavaan.mi", total = TRUE)</code>: either
the total (default) sample size or a vector of group sample sizes
(<code>total = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anova</code></td>
<td>
<p><code>signature(object = "lavaan.mi", ...)</code>:
Returns a test of model fit for a single model (<code>object</code>) or test(s)
of the difference(s) in fit between nested models passed via <code>...</code>.
See <code>lavTestLRT.mi</code> and <code>compareFit</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitMeasures</code></td>
<td>
<p><code>signature(object = "lavaan.mi",
  fit.measures = "all", baseline.model = NULL, output = "vector",
  omit.imps = c("no.conv","no.se"), ...)</code>: See lavaan's
<code>fitMeasures</code> for details. Pass additional arguments
to <code>lavTestLRT.mi</code> via <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitmeasures</code></td>
<td>
<p>alias for <code>fitMeasures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p><code>signature(object = "lavaan.mi")</code>: returns a message about
convergence rates and estimation problems (if applicable) across imputed
data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p><code>signature(object = "lavaan.mi", se = TRUE, ci = FALSE,
 level = .95, standardized = FALSE, rsquare = FALSE, fmi = FALSE,
 scale.W = !asymptotic, omit.imps = c("no.conv","no.se"), asymptotic = FALSE,
  header = TRUE, output = "text", fit.measures = FALSE, ...)</code>:
see <code>parameterEstimates</code> for details.
By default, <code>summary</code> returns pooled point and <em>SE</em>
estimates, along with <em>t</em> test statistics and their associated
<em>df</em> and <em>p</em> values. If <code>ci = TRUE</code>, confidence intervales
are returned with the specified confidence <code>level</code> (default 95% CI).
If <code>asymptotic = TRUE</code>, <em>z</em> instead of <em>t</em> tests are
returned. <code>standardized</code> solution(s) can also be requested by name
(<code>"std.lv"</code> or <code>"std.all"</code>) or both are returned with <code>TRUE</code>.
<em>R</em>-squared for endogenous variables can be requested, as well as the
Fraction Missing Information (FMI) for parameter estimates. By default, the
output will appear like <code>lavaan</code>'s <code>summary</code> output, but if
<code>output == "data.frame"</code>, the returned <code>data.frame</code> will resemble
the <code>parameterEstimates</code> output. The <code>scale.W</code> argument is
passed to <code>vcov</code> (see description above).
Setting <code>fit.measures=TRUE</code> will additionally print fit measures to
the console, but they will not be returned; additional arguments may be
passed via <code>...</code> to <code>fitMeasures</code> and
subsequently to <code>lavTestLRT.mi</code>.</p>
</td>
</tr>
</table>
<h3>Slots</h3>


<dl>
<dt><code>coefList</code></dt>
<dd>
<p><code>list</code> of estimated coefficients in matrix format (one
per imputation) as output by <code>lavInspect(fit, "est")</code></p>
</dd>
<dt><code>phiList</code></dt>
<dd>
<p><code>list</code> of model-implied latent-variable covariance
matrices (one per imputation) as output by
<code>lavInspect(fit, "cov.lv")</code></p>
</dd>
<dt><code>miList</code></dt>
<dd>
<p><code>list</code> of modification indices output by
<code>modindices</code></p>
</dd>
<dt><code>seed</code></dt>
<dd>
<p><code>integer</code> seed set before running imputations</p>
</dd>
<dt><code>lavListCall</code></dt>
<dd>
<p>call to <code>lavaanList</code> used to fit the
model to the list of imputed data sets in <code>@DataList</code>, stored as a
<code>list</code> of arguments</p>
</dd>
<dt><code>imputeCall</code></dt>
<dd>
<p>call to imputation function (if used), stored as a
<code>list</code> of arguments</p>
</dd>
<dt><code>convergence</code></dt>
<dd>
<p><code>list</code> of <code>logical</code> vectors indicating whether,
for each imputed data set, (1) the model converged on a solution, (2)
<em>SE</em>s could be calculated, (3) the (residual) covariance matrix of
latent variables (<code class="reqn">\Psi</code>) is non-positive-definite, and (4) the
residual covariance matrix of observed variables (<code class="reqn">\Theta</code>) is
non-positive-definite.</p>
</dd>
<dt><code>lavaanList_slots</code></dt>
<dd>
<p>All remaining slots are from
<code>lavaanList</code>, but <code>runMI</code> only populates a
subset of the <code>list</code> slots, two of them with custom information:</p>
</dd>
<dt><code>DataList</code></dt>
<dd>
<p>The <code>list</code> of imputed data sets</p>
</dd>
<dt><code>SampleStatsList</code></dt>
<dd>
<p>List of output from
<code>lavInspect(fit, "sampstat")</code> applied to each fitted
model</p>
</dd>
<dt><code>ParTableList</code></dt>
<dd>
<p>See <code>lavaanList</code></p>
</dd>
<dt><code>vcovList</code></dt>
<dd>
<p>See <code>lavaanList</code></p>
</dd>
<dt><code>testList</code></dt>
<dd>
<p>See <code>lavaanList</code></p>
</dd>
<dt><code>h1List</code></dt>
<dd>
<p>See <code>lavaanList</code>. An additional element is
added to the <code>list</code>: <code>$PT</code> is the "saturated" model's parameter
table, returned by <code>lav_partable_unrestricted</code>.</p>
</dd>
<dt><code>baselineList</code></dt>
<dd>
<p>See <code>lavaanList</code></p>
</dd>
</dl>
<h3>Objects from the Class</h3>

<p>See the <code>runMI</code> function for
details. Wrapper functions include <code>lavaan.mi</code>,
<code>cfa.mi</code>, <code>sem.mi</code>, and <code>growth.mi</code>.
</p>


<h3>Author(s)</h3>

<p>Terrence D. Jorgensen (University of Amsterdam;
<a href="mailto:TJorgensen314@gmail.com">TJorgensen314@gmail.com</a>)
</p>


<h3>References</h3>

<p>Asparouhov, T., &amp; Muthen, B. (2010). <em>Chi-square statistics
with multiple imputation</em>. Technical Report. Retrieved from
<a href="http://www.statmodel.com/">http://www.statmodel.com/</a>
</p>
<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. New York, NY:
Guilford.
</p>
<p>Li, K.-H., Meng, X.-L., Raghunathan, T. E., &amp; Rubin, D. B. (1991).
Significance levels from repeated <em>p</em>-values with multiply-imputed
data. <em>Statistica Sinica, 1</em>(1), 65–92. Retrieved from
<a href="https://www.jstor.org/stable/24303994">https://www.jstor.org/stable/24303994</a>
</p>
<p>Meng, X.-L., &amp; Rubin, D. B. (1992). Performing likelihood ratio tests with
multiply-imputed data sets. <em>Biometrika, 79</em>(1), 103–111.
<a href="https://doi.org/10.2307/2337151">doi:10.2307/2337151</a>
</p>
<p>Rubin, D. B. (1987). <em>Multiple imputation for nonresponse in surveys</em>.
New York, NY: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## See ?runMI help page

</code></pre>


</div>