<div class="container">

<table style="width: 100%;"><tr>
<td>discrimR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Replicated Thurstonian Model for discrimination analysis</h2>

<h3>Description</h3>

<p>The model is a synthesis of a mixture and a mixed effect model. The
random effect distribution for the cluster term (often individuals) is
a point mass for delta = 0 and a continuous distribution for delta &gt;
0.
</p>
<p>The function fits the model and computes d-prime for an average
subject, 2) the variance among subjects, 3) the "posterior" probability
of a subject being a discriminator (with delta &gt; 0), 4) the
"posterior" expectation on the random effect (ie. the subject-specific
delta) and 5) the probability that a randomly chosen individual is a
discriminator (ie. the probability mass at delta = 0 in the random
effects distribution)
</p>
<p>Warning: This function is preliminary; see the details for further
information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discrimR(formula, data, weights, cluster, start, subset, na.action,
           contrasts = NULL, hess = FALSE, ranef = FALSE, zi = FALSE,
           method = c("duotrio", "probit", "threeAFC", "triangle",
             "twoAFC"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula where the lhs is the binomial response. An
indicator vector or a matrix with two column; successes and failures
like in a call to <code>glm</code> with a binomial family. The rhs
should be <code>1</code>; no other predictors are currently allowed, but
extending this is ongoing work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The <code>data.frame</code> in which to look for variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Possible weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>The clustering variable; should be a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Optional starting values; recommended in the current
implementation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>Should the hessian of the parameters be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>
<p>Should the random effect estimates be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zi</code></td>
<td>
<p>Should the posterior probabilities of a subject being a
discriminator be computed? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Should correspond to the actual test applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to
<code>optim</code>. <code>control=list(trace=TRUE, REPORT=1)</code> is
recommended, so the reduction in deviance and convergence can be
followed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is preliminary and improving it is ongoing work. The
computational methods are expected to change completely. This will
hopefully facilitate methods for more general rhs-formulae with
additional predictors.
</p>
<p>Currently no methods or extractor functions have been written, so the
user will have to select the relevant elements from the fitted object
(see below). Implementation of methods and extractor functions will
occur in due course. 
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fpar</code></td>
<td>
<p>The fixed effect parameter, ie. delta (for an average
individual)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rpar</code></td>
<td>
<p>A vector with two elements: The first element is the
variance component (standard deviation) on the log-scale, where
optimization is performed. The second element is the variance
component (standard deviation) on the original scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Deviance for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>standard errors for 1) the fixed effect parameter and 2) the
variance component on the log-scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Convergence message from <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lli</code></td>
<td>
<p>Log-likelihood contributions from each of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>
<p>The random effect estimates for the levels of the
clustering factor (often individual)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zi</code></td>
<td>
<p>posterior probabilities of a subject being a
discriminator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability that a randomly chosen individual is a
discriminator (ie. the probability mass for delta &gt; 0 in the random
effects distribution)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>Fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The scaled response vector on which optimization is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rune Haubo B Christensen</p>


<h3>See Also</h3>

 <p><code>triangle</code>, <code>twoAFC</code>,
<code>threeAFC</code>, <code>duotrio</code>,
<code>discrimPwr</code>, <code>discrimSim</code>,
<code>discrimSS</code>, <code>samediff</code>,
<code>AnotA</code>, <code>findcr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
freq &lt;- c(10,8,10,9,8,9,9,1,10,10,8,2,6,7,6,7,6,4,5,5,3,3,9,9,5,5,8,8,9,9)
tmp &lt;- data.frame(id = factor(1:30), n = rep(10, 30), freq = freq)
head(tmp)
str(tmp)

fm &lt;- discrimR(cbind(freq, n - freq) ~ 1, tmp, cluster = id,
                    start = c(.5, .5), method = "twoAFC",
                    ranef = TRUE, zi = TRUE, hess = TRUE, 
                    control=list(trace=TRUE, REPORT=1))

names(fm)
fm[1:4]

</code></pre>


</div>