<div class="container">

<table style="width: 100%;"><tr>
<td>mitscherlich</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mitscherlich response function</h2>

<h3>Description</h3>

<p>This function helps to fit a Mitscherlich-style exponential
response model for relative yield (ry) as a function of soil test values (stv).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mits_formula_1(x, a, b, c)

mits_formula_2(x, b, c)

mits_formula_3(x, c)

mitscherlich(
  data = NULL,
  stv,
  ry,
  type = 1,
  target = 95,
  tidy = TRUE,
  plot = FALSE,
  resid = FALSE
)

boot_mitscherlich(data, stv, ry, type = 1, n = 999, target = 95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>selfstart vector. for model fit Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>selfstart arg. for asymptote parameter, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>selfstart arg. for b parameter (b = -X_intercept) Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>selfstart arg. for curvature parameter Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional argument to call and object of type data.frame or data.table
containing the stv and ry data, Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stv</code></td>
<td>
<p>name of the vector containing soil test values (-) of type <code>numeric</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ry</code></td>
<td>
<p>name of the vector containing relative yield values (%) of type <code>numeric</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string or number that indicates the type of Mitscherlich model to fit. Default: 1.
For model with 'no restrictions' use <code>type = 1</code>, <code>type = "no restriction"</code>, or <code>type = "free"</code>;
For model with 'asymptote = 100' use <code>type = 2</code>, <code>type = "asymptote 100"</code>, or <code>type = "100"</code>;
For model with 'asymptote = 100 and xintercept = 0'" <code>type = 3</code>, <code>type = "asymptote 100 from 0"</code>, or <code>type = "fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p><code>numeric</code> value of relative yield target (e.g. 90 for 90%) to estimate the CSTV.
Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tidy</code></td>
<td>
<p>logical operator (TRUE/FALSE) to decide the type of return. TRUE returns a tidy data frame or tibble (default), FALSE returns a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical operator (TRUE/FALSE) to plot the Mitscherlich model, Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>logical operator (TRUE/FALSE) to plot residuals analysis, Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size for the bootstrapping Default: 500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>when running bootstrapped samples, the <code>...</code> (open arguments) allows to add grouping variable/s (factor or character) Default: NULL</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <a href="https://adriancorrendo.github.io/soiltestcorr/articles/mitscherlich_tutorial.html">online-documentation</a> for additional details.
</p>


<h3>Value</h3>

<p>returns an object of type <code>ggplot</code> if plot = TRUE.
</p>
<p>returns a residuals plot if resid = TRUE.
</p>
<p>returns an object of class <code>data.frame</code> if tidy = TRUE,
</p>
<p>returns an object of class <code>list</code> if tidy = FALSE.
</p>
<p>Mitscherlich type 1 formula
</p>
<p>Mitscherlich type 2 formula
</p>
<p>Mitscherlich type 3 formula
</p>
<p>mitscherlich: function
</p>
<p>boot_mitscherlich: bootstrapping function
</p>


<h3>Note</h3>

<p>For extended reference, we recommend to visit:
<a href="https://github.com/austinwpearce/SoilTestCocaCola">https://github.com/austinwpearce/SoilTestCocaCola</a> by Austin Pearce.
</p>


<h3>References</h3>

<p>Melsted, S.W. and Peck, T.R. (1977).
The Mitscherlich-Bray Growth Function.
<em>In Soil Testing (eds T. Peck, J. Cope and D. Whitney).</em> <a href="https://doi.org/10.2134/asaspecpub29.c1">doi:10.2134/asaspecpub29.c1</a>
</p>


<h3>See Also</h3>

<p><code>eval_tidy</code>,<code>defusing-advanced</code>
<code>nlsLM</code>
<code>AIC</code>,<code>lm</code>,<code>optim</code>,<code>coef</code>,<code>predict</code>
<code>AICc</code>
<code>model-quality</code>
<code>nlsResiduals</code>
<code>bind</code>
<code>ggplot</code>,<code>aes</code>,<code>geom_rug</code>,<code>geom_point</code>,<code>geom_abline</code>,<code>geom_path</code>,<code>annotate</code>,<code>labs</code>,<code>theme</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # Example dataset
 dat &lt;- data.frame("ry" = c(65,80,85,88,90,94,93,96,97,95,98,100,99,99,100),
                   "stv" = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))
 # Run
 fit_example_mits &lt;- mitscherlich(data = dat, type = 1, 
 ry = ry, stv = stv, resid = TRUE, plot = FALSE)
 
 fit_example_mits

</code></pre>


</div>