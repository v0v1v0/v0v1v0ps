<div class="container">

<table style="width: 100%;"><tr>
<td>enrichmentAnalysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fast Enrichment Testing via Circular Permutations on Non-Binary Outcomes
</h2>

<h3>Description</h3>

<p>This function performs enrichment analysis on
two sets of matching test statistics.
The circular permutation scheme accounts for 
possible local correlation of test statistcs.
The testing is performed using the quantile thresholds
provided for each data set.
</p>
<p>For every permutation the enrichment is measure with
Cramer's V coefficient. The maximum/minimum coefficient
across all considered thresholds is recorded.
It is then compared with the maximum/minimum coefficient
observed without permuting the data.
</p>
<p>For matching data sets calculated at different genomic locations
please use <code>matchDatasets</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">enrichmentAnalysis(
    pvstats1,
    pvstats2,
    percentiles1 = NULL,
    percentiles2 = NULL,
    npermute,
    margin = 0.05,
    threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvstats1</code></td>
<td>

<p>The vector of statistics for primary data set. <br>
The statistics must be p-value like, i.e. smaller is better.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvstats2</code></td>
<td>

<p>The vector of statistics for auxiliary data set. <br>
The statistics must be p-value like, i.e. smaller is better.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentiles1</code></td>
<td>

<p>These quantile thresholds are used to cut off top results 
in the primary data set
for matching with the top results in the auxiliary. <br>
Can be omitted if the vector <code>pvstats1</code> is binary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentiles2</code></td>
<td>

<p>Same as <code>percentiles1</code>, but for the other data set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npermute</code></td>
<td>

<p>Number of permutations to perform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>

<p>The minimum offset in the circular permutation to consider. <br>
Can be a fraction of total number of values or
an integer count of values. <br>
Passed in the call of <code>getOffsetsRandom</code> for
generation of offsets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>

<p>The number of CPU cores to use for calculations. <br>
Set to <code>TRUE</code> to use all cores. <br>
Multithreading is turned off by default.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>overallPV</code></td>
<td>

<p>The p-values for the overall test across all thresholds. <br>
The p-values are for enrichment, depletion, and two-sided test for both.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byThresholdPV</code></td>
<td>

<p>The p-values for tests for each individual threshold. <br>
The p-values provided for enrichment, depletion, and two-sided test.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andrey A Shabalin <a href="mailto:andrey.shabalin@gmail.com">andrey.shabalin@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Data size
n = 1e5

### Generate vectors of test statistics with local correlation
window = 1000
pvstats1 = diff(cumsum(runif(n+window)), lag = window)
pvstats2 = diff(cumsum(runif(n+window)), lag = window)

# Add a bit of dependence
pvstats1 = pvstats1 + 0.5 * pvstats2

# test top 0.1, 1, 3, 5, and 10 percent

percentiles1 = c(0.001, 0.01, 0.03, 0.05, 0.1)
percentiles2 = c(0.001, 0.01, 0.03, 0.05, 0.1)

# The offset margin

margin = 0.05

# Set the number of permutations
# to the maximum

npermute = 1e3


enr = enrichmentAnalysis(
        pvstats1,
        pvstats2,
        percentiles1,
        percentiles2,
        npermute,
        margin ,
        threads = 2)

# View the results
enr
</code></pre>


</div>