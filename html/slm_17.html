<div class="container">

<table style="width: 100%;"><tr>
<td>slm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Stationary Linear Models</h2>

<h3>Description</h3>

<p><code>slm</code> is used to fit linear models when the error process is assumed to be strictly stationary.
</p>


<h3>Usage</h3>

<pre><code class="language-R">slm(myformula, data = NULL, model = TRUE, x = FALSE, y = FALSE,
  qr = TRUE, method_cov_st = "fitAR", cov_st = NULL, Cov_ST = NULL,
  model_selec = -1, model_max = 50, kernel_fonc = NULL,
  block_size = NULL, block_n = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>myformula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class):
a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>slm</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model, x, y, qr</code></td>
<td>
<p>logicals. If <code>TRUE</code> the corresponding components of the fit (the model frame, the model matrix, the response, the QR decomposition) are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_cov_st</code></td>
<td>
<p>the method chosen by the user to estimate the autocovariances of the error process. The user
has the choice between the methods "fitAR", "spectralproj", "efromovich", "kernel", "select" or "hac". By default, the
"fitAR" method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_st</code></td>
<td>
<p>numeric vector. The estimated autocovariances of the error process. The user can give his own vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cov_ST</code></td>
<td>
<p>matrix. It is an argument given by the user if he wants to use his own covariance matrix estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_selec</code></td>
<td>
<p>integer or <code>-1</code>. The order of the method. If <code>model_selec = -1</code>, the method works automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_max</code></td>
<td>
<p>integer. Maximal order of the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_fonc</code></td>
<td>
<p>function. Use this argument if <code>method_cov_st = kernel</code>. Define the kernel to use in the method. The user can give his own kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_size</code></td>
<td>
<p>integer. Size of the bootstrap blocks if <code>method_cov_st = kernel</code>. <code>block_size</code> must be greater than <code>model_max</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_n</code></td>
<td>
<p>integer. Blocks number to use for the bootstrap if <code>method_cov_st = kernel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. By default, <code>plot = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>slm</code> function is based on the architecture of the <code>lm</code> function.
Models for <code>slm</code> are specified symbolically.
A typical model has the form <code>response ~ terms</code> where <code>response</code> is the (numeric)
response vector and <code>terms</code> is a series of terms which specifies a linear predictor for <code>response</code>.
See the documentation of <code>lm</code> for more details.
</p>


<h3>Value</h3>

<p><code>slm</code> returns an object of <code>class</code> "<code>slm</code>". The function
<code>summary</code> is used to obtain and print a summary of the results. The generic accessor functions
<code>coefficients</code>, <code>effects</code>, <code>fitted.values</code> and <code>residuals</code> extract various
useful features of the value returned by <code>slm</code>.
An object of class "<code>slm</code>" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method_cov_st </code></td>
<td>
<p> print the method chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_st </code></td>
<td>
<p> the estimated autocovariances of the error process. NA if "hac" is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cov_ST </code></td>
<td>
<p> if given by the user, the estimated covariance matrix of the error process. NA if "hac" is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_selec </code></td>
<td>
<p> the order of the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm_matrix </code></td>
<td>
<p> the normalization matrix of the least squares estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_qr </code></td>
<td>
<p> the matrix <code class="reqn">(X^{t} X)^{-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients </code></td>
<td>
<p> a named vector of the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals </code></td>
<td>
<p> the residuals, that is response minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p> the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank </code></td>
<td>
<p> the numeric rank of the fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p> the number of observations minus the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p> the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms </code></td>
<td>
<p> the <code>terms</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels </code></td>
<td>
<p> (only where relevant) a record of the levels of the factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p> if requested, the response used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p> if requested, the model matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model </code></td>
<td>
<p> if requested (the default), the model frame used.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>E. Caron, J. Dedecker and B. Michel (2019). Linear regression with stationary errors: the R package slm. <em>arXiv preprint arXiv:1906.06583</em>.
<a href="https://arxiv.org/abs/1906.06583">https://arxiv.org/abs/1906.06583</a>.
</p>


<h3>See Also</h3>

<p><code>summary</code> for summaries.
</p>
<p>The generic functions <code>coef</code>, <code>effects</code>,
<code>residuals</code>, <code>fitted</code>, <code>vcov</code>.
</p>
<p><code>predict</code> for prediction, including confidence intervals for <code class="reqn">x' beta</code>, where <code class="reqn">x'</code> is a new observation of the design.
</p>
<p><code>confint</code> for confidence intervals of <em>parameters</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("shan")
slm(shan$PM_Xuhui ~ . , data = shan, method_cov_st = "fitAR", model_selec = -1)

data("co2")
y = as.vector(co2)
x = as.vector(time(co2)) - 1958
reg1 = slm(y ~ x + I(x^2) + I(x^3) + sin(2*pi*x) + cos(2*pi*x) + sin(4*pi*x) +
 cos(4*pi*x) + sin(6*pi*x) + cos(6*pi*x) + sin(8*pi*x) + cos(8*pi*x),
 method_cov_st = "fitAR", model_selec = -1, plot = TRUE)

reg2 = slm(y ~ x + I(x^2) + I(x^3) + sin(2*pi*x) + cos(2*pi*x) + sin(4*pi*x) +
 cos(4*pi*x) + sin(6*pi*x) + cos(6*pi*x) + sin(8*pi*x) + cos(8*pi*x),
 method_cov_st = "kernel", model_selec = -1, model_max = 50, kernel_fonc = triangle,
 block_size = 100, block_n = 100)
</code></pre>


</div>