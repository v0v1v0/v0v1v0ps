<div class="container">

<table style="width: 100%;"><tr>
<td>predict.SpATS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predictions from an <code>SpATS</code> object 
</h2>

<h3>Description</h3>

<p>Takes a fitted <code>SpATS</code> object produced by <code>SpATS()</code> and produces predictions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'SpATS'
predict(object, newdata = NULL, which = NULL, 
	predFixed = c("conditional", "marginal"), return.vcov.matrix = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>SpATS</code> as produced by <code>SpATS()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an optional character string with the variables that define the margins of the multiway table to be predicted (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predFixed</code></td>
<td>
<p>a character string indicating how predictions for fixed factor are computed. Either "conditional" or "marginal" (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.vcov.matrix</code></td>
<td>
<p>logical. If TRUE, the variance-covariance matrix for the predictions is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows to produce predictions, either specifying: (1) the data frame on which to obtain the predictions (argument <code>newdata</code>), or (2) those variables that define the margins of the multiway table to be predicted (argument <code>which</code>). In the first case, all fixed components (including genotype when fixed) and the spatial coordinates must be present in the data frame. As for the random effects is concerned, they are excluded from the predictions when the value is missing in the data frame. In the second case, predictions are obtained for each combination of values of the specified variables that is present in the data set used to fit the model. For those variables not specified in the argument <code>which</code>, the following rules have been considered: (a) random factors and the spatial trend are ignored in the predictions, (b) for fixed numeric variables, the mean value is considered; and (c) for fixed factors, there are two possibilities according to argument 'predFixed': (c1) if predFixed = 'conditional', the reference level is used; and (c2) predFixed = 'marginal', predictions are obtained averaging over all levels of the fixed factor.
</p>


<h3>Value</h3>

<p>The data frame used for obtaining the predictions, jointly with the predicted values and the corresponding standard errors. The label “Excluded” has been used to indicate those cases where a covariate has been excluded or ignored for the prediction (as for instance the random effect). 
</p>


<h3>References</h3>

<p>Welham, S., Cullis, B., Gogel, B., Gilmour, A., and Thompson, R. (2004). Prediction in linear mixed models. Australian and New Zealand Journal of Statistics, 46, 325 - 347.
</p>


<h3>See Also</h3>

<p><code>SpATS</code>, <code>obtain.spatialtrend</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpATS)
data(wheatdata)
wheatdata$R &lt;- as.factor(wheatdata$row)
wheatdata$C &lt;- as.factor(wheatdata$col)

m0 &lt;- SpATS(response = "yield", spatial = ~ SAP(col, row, nseg = c(10,20)), 
 genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, 
 data = wheatdata, control =  list(tolerance = 1e-03))

# Fitted values: prediction on the dataset used for fitting the model
pred1.m0 &lt;- predict(m0, newdata = wheatdata)
pred1.m0[1:5,]

# Genotype prediction
pred2.m0 &lt;- predict(m0, which = "geno")
pred2.m0[1:5,]

</code></pre>


</div>