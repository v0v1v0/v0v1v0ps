<div class="container">

<table style="width: 100%;"><tr>
<td>batty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Batty's entropy.</h2>

<h3>Description</h3>

<p>This function computes Batty's spatial entropy, following Batty (1976), see also Altieri et al (2017 and following)
(references are under the topic <code>SpatEntropy</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">batty(
  data,
  category = 1,
  cell.size = 1,
  partition = 10,
  win = NULL,
  rescale = T,
  plotout = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If data are lattice, a data matrix, which can be numeric, factor, character, ...
If the dataset is a point pattern, <code>data</code> is a <code>ppp</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category</code></td>
<td>
<p>A single value matching the data category of interest for computing Batty's entropy.
Default to 1. If the dataset is an unmarked point pattern, this argument must not be changed from the default.
In the plot, only data belonging to the selected category are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.size</code></td>
<td>
<p>A single number or a vector of length two, only needed if data are lattice. It gives the length of the side of each pixel;
if the pixel is rectangular, the first number gives the horizontal side and the second number gives the vertical side. Default to 1. Ignored if data are points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partition</code></td>
<td>
<p>Input defining the partition into subareas. If an integer, it defines the
number of sub-areas that are randomly generated by areapart; if a two column matrix
with coordinates, they are the centroids of the subareas built by areapart. Alternatively,
it can be the output of areapart, a <code>tess</code> object built by the user, a <code>list</code> object
with arguments <code>tiles</code>, i.e. a list of <code>owin</code> objects defining the partition, and <code>n</code>, the number of subareas.
Lastly, it can be an <code>im</code> object, i.e. a factor- or character-valued pixel image on the
same observation window as the data, so that the partition is defined according to the values
of the image.
The default option is <code>partition=areapart(data, G=10)</code>, which generates 10 random sub-areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>Optional, the observation area given as a <code>owin</code> object. If
data are a point pattern <code>ppp</code> object, this argument is ignored
and the observation area is extracted from the object. If data are
given as a matrix, the area should be specified; the default is a
rectangle with x range from 0 to the number of columns of the data, and
y range from 0 to the number of rows of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>Logical. Default to <code>TRUE</code>, checks whether the size of the observation area or of any of the
sub-areas is smaller than 1. If so, computational issues may arise due to negative logarithms, therefore the
function automatically performs a rescaling of all sub-areas, computes the entropy over the rescaled area and
then transforms it back to the entropy of the original dataset. In such case, a warning is produced to make the user
aware of such operation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotout</code></td>
<td>
<p>Logical. Default to <code>TRUE</code>, produces an informative plot as part of the function output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Batty's spatial entropy measures the heterogeneity in the spatial distribution
of a phenomenon of interest, with regard to an area partition. It is high
when the phenomenon is equally intense over the sub-areas, and low when
it concentrates in one or few sub-areas. This function allows to compute Batty's entropy as
</p>
<p style="text-align: center;"><code class="reqn">H_B=\sum p_g \log(T_g/p_g)</code>
</p>

<p>where <code class="reqn">p_g</code> is the probability of occurrence of the phenomenon over sub-area <code class="reqn">g</code>,
and <code class="reqn">T_g</code> is the sub-area size.
When data are categorical, the phenomenon of interest corresponds to
one category, which must be specified. If data are an unmarked
point pattern, a fake mark vector is be created with the same category for all points.
For comparison purposes, the relative version of Batty's entropy is also returned, i.e.
Batty's entropy divided by its maximum <code class="reqn">\log(\sum T_g)</code>.
Note that when the total observation area is 1, then <code class="reqn">\log(\sum T_g)=0</code>, therefore
in that case during the computation all <code class="reqn">T_g</code>s are multiplied by 100 and a warning is produced.
The function is able to work with grids containing missing data, specified as NA values.
All NAs are ignored in the computation.
</p>


<h3>Value</h3>

<p>A list of five elements:
</p>

<ul>
<li> <p><code>batty</code> Batty's entropy
</p>
</li>
<li> <p><code>range</code> The theoretical range of Batty's entropy
</p>
</li>
<li> <p><code>rel.batty</code> Batty's entropy divided by <code class="reqn">\log(\sum Tg)</code> for comparison across observation areas.
</p>
</li>
<li> <p><code>areas</code> a dataframe giving, for each sub-area of the partition, the absolute and relative frequency of
the points/pixels of interest, the sub-area size and the intensity defined as <code class="reqn">pg/Tg</code>
</p>
</li>
<li> <p><code>area.tess</code> a <code>tess</code> object with the area partition
</p>
</li>
</ul>
<p>Moreover, a plot is produced showing the data and the area partition.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#LATTICE DATA

data=matrix((sample(c("a","b","c"), 100, replace=TRUE)), nrow=10)
batty.entropy=batty(data, category="a")

#POINT DATA

#unmarked pp
data=ppp(x=runif(100, 0, 10), y=runif(100, 0, 10), window=square(10))
batty.entropy=batty(data)

#smaller window so that some areas' size are smaller than 1
data=ppp(x=runif(100, 0, 3), y=runif(100, 0, 3), window=square(3))
batty.entropy=batty(data)

#marked pp
data=ppp(x=runif(100, 0, 10), y=runif(100, 0, 10), window=square(10),
         marks=(sample(1:5, 100, replace=TRUE)))
plot(data) #see ?plot.ppp for options
#if you want to compute the entropy on all points
batty.entropy=batty(unmark(data))
#if you want to compute the entropy on a category, say 3
batty.entropy=batty(data, category=3)

</code></pre>


</div>