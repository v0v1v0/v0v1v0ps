<div class="container">

<table style="width: 100%;"><tr>
<td>SiZer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate SiZer Map</h2>

<h3>Description</h3>

<p>Calculates the SiZer map from a given set of X and Y variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SiZer(
  x,
  y,
  h = NA,
  x.grid = NA,
  degree = NA,
  derv = 1,
  grid.length = 41,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data vector for the independent axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>data vector for the dependent axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>An integer representing how many bandwidths should be considered, or
vector of length 2 representing the upper and lower limits h should take,
or a vector of length greater than two indicating which bandwidths to examine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.grid</code></td>
<td>
<p>An integer representing how many bins to use along the x-axis, or
a vector of length 2 representing the upper and lower limits the x-axis
should take, or a vector of length greater than two indicating which 
x-values the derivative should be evaluated at</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The degree of the local weighted polynomial used to smooth the data.
This must be greater than or equal to <code>derv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derv</code></td>
<td>
<p>The order of derivative for which to make the SiZer map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.length</code></td>
<td>
<p>The default length of the <code>h.grid</code> or <code>x.grid</code> 
if the length of either is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Should diagnostic messages be suppressed? Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SiZer stands for the Significant Zero crossings of the derivative.  There are two 
dominate approaches in smoothing bivariate data: locally weighted regression or penalized splines.
Both approaches require the use of a 'bandwidth' parameter that controls how much smoothing
should be done.  Unfortunately there is no uniformly best bandwidth selection procedure.
SiZer (Chaudhuri and Marron, 1999) is a procedure that looks across a range of bandwidths
and classifies the p-th derivative of the smoother into one of three states: significantly
increasing (blue), possibly zero (purple), or significantly negative (red).
</p>


<h3>Value</h3>

<p>Returns list object of type SiZer which has the following components:
</p>

<dl>
<dt>x.grid</dt>
<dd>
<p>Vector of x-values at which the derivative was evaluated.</p>
</dd>
<dt>h.grid</dt>
<dd>
<p>Vector of bandwidth values for which a smoothing function was calculated.</p>
</dd> 
<dt>slopes</dt>
<dd>
<p>Matrix of what category a particular x-value and bandwidth falls into 
(Increasing=1, Possibly Zero=0, Decreasing=-1, Not Enough Data=2).</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Derek Sonderegger
</p>


<h3>References</h3>

<p>Chaudhuri, P., and J. S. Marron. 1999. SiZer for exploration of structures
in curves. Journal of the American Statistical Association 94:807-823. 
</p>
<p>Hannig, J., and J. S. Marron. 2006. Advanced distribution theory for SiZer. 
Journal of the American Statistical Association 101:484-499.
</p>
<p>Sonderegger, D.L., Wang, H., Clements, W.H., and Noon, B.R. 2009. Using SiZer to detect
thresholds in ecological data. Frontiers in Ecology and the Environment 7:190-195.
</p>


<h3>See Also</h3>

<p><code>plot.SiZer</code>, <code>locally.weighted.polynomial</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data('Arkansas')
x &lt;- Arkansas$year
y &lt;- Arkansas$sqrt.mayflies

plot(x,y)

# Calculate the SiZer map for the first derivative
SiZer.1 &lt;- SiZer(x, y, h=c(.5,10), degree=1, derv=1, grid.length=21)
plot(SiZer.1)
plot(SiZer.1, ggplot2=TRUE)

# Calculate the SiZer map for the second derivative
SiZer.2 &lt;- SiZer(x, y, h=c(.5,10), degree=2, derv=2, grid.length=21);
plot(SiZer.2)

# By setting the grid.length larger, we get a more detailed SiZer
# map but it takes longer to compute. 
#
# SiZer.3 &lt;- SiZer(x, y, h=c(.5,10), grid.length=100, degree=1, derv=1)
# plot(SiZer.3)  
  
</code></pre>


</div>