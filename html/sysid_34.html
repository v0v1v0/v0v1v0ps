<div class="container">

<table style="width: 100%;"><tr>
<td>iv4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ARX model estimation using four-stage instrumental variable method</h2>

<h3>Description</h3>

<p>Estimates an ARX model of the specified order from input-output data using
the instrument variable method. The estimation algorithm is insensitive to 
the color of the noise term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">iv4(z, order = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>an idframe object containing the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Specification of the orders: the three integer components 
(na,nb,nk) are the order of polynolnomial A, (order of polynomial B + 1) 
and the input-output delay</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation is performed in 4 stages. The first stage uses the arx function. The resulting model generates the 
instruments for a second-stage IV estimate. The residuals obtained from this model are modeled using a sufficently
high-order AR model. At the fourth stage, the input-output data is filtered through this AR model and then subjected 
to the IV function with the same instrument filters as in the second stage.
</p>


<h3>Value</h3>

<p>An object of class <code>estpoly</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sys</code></td>
<td>
<p>an <code>idpoly</code> object containing the 
fitted ARX coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the predicted response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>the input data used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>A list containing the following fields: <br><code>vcov</code> - the covariance matrix of the fitted coefficients <br><code>sigma</code> - the standard deviation of the innovations<br><code>df</code> - the residual degrees of freedom</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lennart Ljung (1999), <em>System Identification: Theory for the User</em>, 
2nd Edition, Prentice Hall, New York. Section 15.3
</p>


<h3>See Also</h3>

<p><code>arx</code>, <code>iv4</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mod_dgp &lt;- idpoly(A=c(1,-0.5),B=c(0.6,-.2),C=c(1,0.6),ioDelay = 2,noiseVar = 0.1)
u &lt;- idinput(400,"prbs")
y &lt;- sim(mod_dgp,u,addNoise=TRUE)
z &lt;- idframe(y,u)
mod_iv4 &lt;- iv4(z,c(1,2,2))

</code></pre>


</div>