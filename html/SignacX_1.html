<div class="container">

<table style="width: 100%;"><tr>
<td>CID.entropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normalized Shannon entropy-based "unclassified" assignment</h2>

<h3>Description</h3>

<p><code>CID.entropy</code> calculates the normalized Shannon entropy of labels for each cell
among k-nearest neighbors less than four-degrees apart, and then sets cells with statistically
significant large Shannon entropy to be "Unclassified."
</p>


<h3>Usage</h3>

<pre><code class="language-R">CID.entropy(ac, distM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ac</code></td>
<td>
<p>a character vector of cell type labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distM</code></td>
<td>
<p>the distance matrix, see ?CID.GetDistMat</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A character vector like 'ac' but with cells type labels set to "Unclassified" if there was high normalized Shannon entropy.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load data classified previously (see \code{SignacFast})
P &lt;- readRDS("celltypes.rds")
S &lt;- readRDS("pbmcs.rds")

# get edges from default assay from Seurat object
default.assay &lt;- Seurat::DefaultAssay(S)
edges = S@graphs[[which(grepl(paste0(default.assay, "_nn"), names(S@graphs)))]]

# get distance matrix
D = CID.GetDistMat(edges)

# entropy-based unclassified labels labels
entropy = CID.entropy(ac = P$L2, distM = D)

## End(Not run)
</code></pre>


</div>