<div class="container">

<table style="width: 100%;"><tr>
<td>SimCorrMix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of Correlated Data with Multiple Variable Types Including Continuous and Count Mixture Distributions</h2>

<h3>Description</h3>

<p><span class="pkg">SimCorrMix</span> generates continuous (normal, non-normal, or mixture distributions), binary, ordinal, and count
(Poisson or Negative Binomial, regular or zero-inflated) variables with a specified correlation matrix, or one continuous variable
with a mixture distribution.  This package can be used to simulate data sets that mimic real-world clinical or genetic data sets
(i.e. plasmodes, as in Vaughan et al., 2009, doi: <a href="http://doi.org/10.1016/j.csda.2008.02.032">10.1016/j.csda.2008.02.032</a>).  The methods extend those found in the
<span class="pkg">SimMultiCorrData</span> package.  Standard normal variables with an imposed intermediate correlation matrix are transformed to
generate the desired distributions.  Continuous variables are simulated using either Fleishman's third-order
(doi: <a href="http://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>) or Headrick's fifth-order (doi: <a href="http://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>) power method transformation (PMT).
Non-mixture distributions require the user to specify mean, variance, skewness, standardized kurtosis, and standardized fifth and
sixth cumulants.  Mixture distributions require these inputs for the component distributions plus the mixing probabilities.  Simulation
occurs at the component-level for continuous mixture distributions.  The target correlation matrix is specified in terms of
correlations with components of continuous mixture variables.  These components are transformed into
the desired mixture variables using random multinomial variables based on the mixing probabilities.  However, the package provides functions to approximate expected
correlations with continuous mixture variables given target correlations with the components.  Binary and ordinal variables are simulated using a modification of
<code>GenOrd-package</code>'s <code>ordsample</code> function.  Count variables are simulated using the inverse
CDF method.  There are two simulation pathways which calculate intermediate correlations involving count variables differently.
Correlation Method 1 adapts Yahav and Shmueli's 2012 method (doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>) and performs best with large count variable means and
positive correlations or small means and negative correlations.  Correlation Method 2 adapts Barbiero and
Ferrari's 2015 modification of <code>GenOrd-package</code> (doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>) and performs best under the opposite scenarios.
The optional error loop may be used to improve the accuracy of the final correlation matrix.  The package also provides functions to calculate the standardized
cumulants of continuous mixture distributions, check parameter inputs, calculate feasible correlation boundaries, and summarize and plot simulated variables.
</p>


<h3>Vignettes</h3>

<p>There are several vignettes which accompany this package to help the user understand the simulation and analysis methods.
</p>
<p>1) <b>Comparison of Correlation Methods 1 and 2</b> describes the two simulation pathways that can be followed for generation of
correlated data.
</p>
<p>2) <b>Continuous Mixture Distributions</b> demonstrates how to simulate one continuous mixture variable using
<code>contmixvar1</code> and gives a step-by-step guideline for comparing a simulated distribution to the target
distribution.
</p>
<p>3) <b>Expected Cumulants and Correlations for Continuous Mixture Variables</b> derives the equations used by the function
<code>calc_mixmoments</code> to find the mean, standard deviation, skew, standardized kurtosis, and standardized fifth
and sixth cumulants for a continuous mixture variable.  The vignette also explains how the functions
<code>rho_M1M2</code> and <code>rho_M1Y</code> approximate the expected correlations with continuous mixture
variables based on the target correlations with the components.
</p>
<p>4) <b>Overall Workflow for Generation of Correlated Data</b> gives a step-by-step guideline to follow with an example containing
continuous non-mixture and mixture, ordinal, zero-inflated Poisson, and zero-inflated Negative Binomial variables.  It executes both
correlated data simulation functions with and without the error loop.
</p>
<p>5) <b>Variable Types</b> describes the different types of variables that can be simulated in <span class="pkg">SimCorrMix</span>, details the algorithm
involved in the optional error loop that helps to minimize correlation errors, and explains how the feasible correlation boundaries are
calculated for each of the two simulation pathways.
</p>


<h3>Functions</h3>

<p>This package contains 3 <em>simulation</em> functions:
</p>
<p><code>contmixvar1</code>, <code>corrvar</code>, and <code>corrvar2</code>
</p>
<p>4 data description (<em>summary</em>) function:
</p>
<p><code>calc_mixmoments</code>, <code>summary_var</code>, <code>rho_M1M2</code>, <code>rho_M1Y</code>
</p>
<p>2 <em>graphing</em> functions:
</p>
<p><code>plot_simpdf_theory</code>, <code>plot_simtheory</code>
</p>
<p>3 <em>support</em> functions:
</p>
<p><code>validpar</code>, <code>validcorr</code>, <code>validcorr2</code>
</p>
<p>and 16 <em>auxiliary</em> functions (should not normally be called by the user, but are called by other functions):
</p>
<p><code>corr_error</code>, <code>intercorr</code>, <code>intercorr2</code>,
<code>intercorr_cat_nb</code>, <code>intercorr_cat_pois</code>, <br><code>intercorr_cont_nb</code>, <code>intercorr_cont_nb2</code>,
<code>intercorr_cont_pois</code>, <code>intercorr_cont_pois2</code>, <br><code>intercorr_cont</code>, <code>intercorr_nb</code>, <code>intercorr_pois</code>,
<code>intercorr_pois_nb</code>, <code>maxcount_support</code>,
<code>ord_norm</code>, <code>norm_ord</code>
</p>


<h3>References</h3>

<p>Amatya A &amp; Demirtas H (2015). Simultaneous generation of multivariate mixed data with Poisson and normal marginals.
Journal of Statistical Computation and Simulation, 85(15):3129-39. doi: <a href="http://doi.org/10.1080/00949655.2014.953534">10.1080/00949655.2014.953534</a>.
</p>
<p>Barbiero A &amp; Ferrari PA (2015). Simulation of correlated Poisson variables. Applied Stochastic Models in
Business and Industry, 31:669-80. doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.
</p>
<p>Barbiero A &amp; Ferrari PA (2015). GenOrd: Simulation of Discrete Random Variables with Given
Correlation Matrix and Marginal Distributions. R package version 1.4.0. <br><a href="https://CRAN.R-project.org/package=GenOrd">https://CRAN.R-project.org/package=GenOrd</a>
</p>
<p>Carnell R (2017). triangle: Provides the Standard Distribution Functions for the Triangle Distribution. R package version 0.11.
<a href="https://CRAN.R-project.org/package=triangle">https://CRAN.R-project.org/package=triangle</a>.
</p>
<p>Davenport JW, Bezder JC, &amp; Hathaway RJ (1988). Parameter Estimation for Finite Mixture Distributions.
Computers &amp; Mathematics with Applications, 15(10):819-28.
</p>
<p>Demirtas H (2006). A method for multivariate ordinal data generation given marginal distributions and correlations. Journal of Statistical
Computation and Simulation, 76(11):1017-1025. <br> doi: <a href="http://doi.org/10.1080/10629360600569246">10.1080/10629360600569246</a>.
</p>
<p>Demirtas H (2014). Joint Generation of Binary and Nonnormal Continuous Data. Biometrics &amp; Biostatistics, S12.
</p>
<p>Demirtas H &amp; Hedeker D (2011). A practical way for computing approximate lower and upper correlation bounds.
American Statistician, 65(2):104-109. doi: <a href="http://doi.org/10.1198/tast.2011.10090">10.1198/tast.2011.10090</a>.
</p>
<p>Demirtas H, Hedeker D, &amp; Mermelstein RJ (2012). Simulation of massive public health data by power polynomials.
Statistics in Medicine, 31(27):3337-3346. doi: <a href="http://doi.org/10.1002/sim.5362">10.1002/sim.5362</a>.
</p>
<p>Emrich LJ &amp; Piedmonte MR (1991). A Method for Generating High-Dimensional Multivariate Binary Variables. The American Statistician, 45(4): 302-4.
doi: <a href="http://doi.org/10.1080/00031305.1991.10475828">10.1080/00031305.1991.10475828</a>.
</p>
<p>Everitt BS (1996). An Introduction to Finite Mixture Distributions. Statistical Methods in Medical Research, 5(2):107-127. doi: <a href="http://doi.org/10.1177/096228029600500202">10.1177/096228029600500202</a>.
</p>
<p>Ferrari PA &amp; Barbiero A (2012). Simulating ordinal data. Multivariate Behavioral Research, 47(4): 566-589.
doi: <a href="http://doi.org/10.1080/00273171.2012.692630">10.1080/00273171.2012.692630</a>.
</p>
<p>Fialkowski AC (2018). SimMultiCorrData: Simulation of Correlated Data with Multiple Variable Types. R package version 0.2.2.
<a href="https://CRAN.R-project.org/package=SimMultiCorrData">https://CRAN.R-project.org/package=SimMultiCorrData</a>.
</p>
<p>Fleishman AI (1978). A Method for Simulating Non-normal Distributions. Psychometrika, 43:521-532. doi: <a href="http://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>.
</p>
<p>Frechet M (1951). Sur les tableaux de correlation dont les marges sont donnees.  Ann. l'Univ. Lyon SectA, 14:53-77.
</p>
<p>Hasselman B (2018). nleqslv: Solve Systems of Nonlinear Equations. R package version 3.3.2.
<a href="https://CRAN.R-project.org/package=nleqslv">https://CRAN.R-project.org/package=nleqslv</a>
</p>
<p>Headrick TC (2002). Fast Fifth-order Polynomial Transforms for Generating Univariate and Multivariate
Non-normal Distributions. Computational Statistics &amp; Data Analysis, 40(4):685-711. doi: <a href="http://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>.
(<a href="http://www.sciencedirect.com/science/article/pii/S0167947302000725">ScienceDirect</a>)
</p>
<p>Headrick TC, Kowalchuk RK (2007). The Power Method Transformation: Its Probability Density Function, Distribution
Function, and Its Further Use for Fitting Data. Journal of Statistical Computation and Simulation, 77:229-249. doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>.
</p>
<p>Headrick TC, Sawilowsky SS (1999). Simulating Correlated Non-normal Distributions: Extending the Fleishman Power
Method. Psychometrika, 64:25-35. doi: <a href="http://doi.org/10.1007/BF02294317">10.1007/BF02294317</a>.
</p>
<p>Headrick TC, Sheng Y, &amp; Hodis FA (2007). Numerical Computing and Graphics for the Power Method Transformation Using
Mathematica. Journal of Statistical Software, 19(3):1 - 17. <br> doi: <a href="http://doi.org/10.18637/jss.v019.i03">10.18637/jss.v019.i03</a>.
</p>
<p>Higham N (2002). Computing the nearest correlation matrix - a problem from finance; IMA Journal of Numerical Analysis 22:329-343.
</p>
<p>Hoeffding W. Scale-invariant correlation theory. In: Fisher NI, Sen PK, editors. The collected works of Wassily Hoeffding.
New York: Springer-Verlag; 1994. p. 57-107.
</p>
<p>Ismail N &amp; Zamani H (2013). Estimation of Claim Count Data Using Negative Binomial, Generalized Poisson, Zero-Inflated Negative Binomial and
Zero-Inflated Generalized Poisson Regression Models. Casualty Actuarial Society E-Forum 41(20):1-28.
</p>
<p>Kendall M &amp; Stuart A (1977). The Advanced Theory of Statistics, 4th Edition. Macmillan, New York.
</p>
<p>Lambert D (1992). Zero-Inflated Poisson Regression, with an Application to Defects in Manufacturing. Technometrics 34(1):1-14.
</p>
<p>Olsson U, Drasgow F, &amp; Dorans NJ (1982). The Polyserial Correlation Coefficient. Psychometrika, 47(3):337-47.
doi: <a href="http://doi.org/10.1007/BF02294164">10.1007/BF02294164</a>.
</p>
<p>Pearson RK (2011). Exploring Data in Engineering, the Sciences, and Medicine. In. New York: Oxford University Press.
</p>
<p>Schork NJ, Allison DB, &amp; Thiel B (1996). Mixture Distributions in Human Genetics Research. Statistical Methods in Medical Research,
5:155-178. doi: <a href="http://doi.org/10.1177/096228029600500204">10.1177/096228029600500204</a>.
</p>
<p>Vale CD &amp; Maurelli VA (1983). Simulating Multivariate Nonnormal Distributions. Psychometrika, 48:465-471. doi: <a href="http://doi.org/10.1007/BF02293687">10.1007/BF02293687</a>.
</p>
<p>Vaughan LK, Divers J, Padilla M, Redden DT, Tiwari HK, Pomp D, Allison DB (2009). The use of plasmodes as a supplement to simulations:
A simple example evaluating individual admixture estimation methodologies. Comput Stat Data Anal, 53(5):1755-66.
doi: <a href="http://doi.org/10.1016/j.csda.2008.02.032">10.1016/j.csda.2008.02.032</a>.
</p>
<p>Yahav I &amp; Shmueli G (2012). On Generating Multivariate Poisson Data in Management Science Applications. Applied Stochastic
Models in Business and Industry, 28(1):91-102. doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>.
</p>
<p>Yee TW (2018). VGAM: Vector Generalized Linear and Additive Models. R package version 1.0-5. <a href="https://CRAN.R-project.org/package=VGAM">https://CRAN.R-project.org/package=VGAM</a>.
</p>
<p>Zhang X, Mallick H, &amp; Yi N (2016). Zero-Inflated Negative Binomial Regression for Differential Abundance Testing in Microbiome
Studies. Journal of Bioinformatics and Genomics 2(2):1-9. doi: <a href="http://doi.org/10.18454/jbg.2016.2.2.1">10.18454/jbg.2016.2.2.1</a>.
</p>


<h3>See Also</h3>

<p>Useful link: <a href="https://github.com/AFialkowski/SimMultiCorrData">https://github.com/AFialkowski/SimMultiCorrData</a>, <a href="https://github.com/AFialkowski/SimCorrMix">https://github.com/AFialkowski/SimCorrMix</a>
</p>


</div>