<div class="container">

<table style="width: 100%;"><tr>
<td>buildmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build model for multiple systems estimation</h2>

<h3>Description</h3>

<p>For multiple systems estimation model corresponding to a specified set of two-list effects,
set up the GLM model formula and data matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildmodel(zdat, mX)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list effects to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list effects are included. If <code>mX = NULL</code>, no such effects are included and
the main effects model is fitted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components as below.
</p>
<p><code>datamatrix</code> A matrix with all possible capture histories, other than those equal to or containing non-overlapping pairs
indexed by parameters
that are within the model specified by <code>mX</code>.  A non-overlapping pair is a pair of lists <code class="reqn">(i,j)</code> such that
no case is observed in both lists,
regardless of whether it is present on any other lists.   If <code class="reqn">(i,j)</code> is within the model specified by <code>mX</code>,
all capture histories containing both <code class="reqn">i</code> and <code class="reqn">j</code> are
then excluded.
</p>
<p><code>modelform</code> The model formula suitable to be called by the Generalized Linear Model function <code>glm</code>. Model terms corresponding to
non-overlapping pairs are not included, because they are handled by removing appropriate rows from the data matrix supplied to glm. The list
of non-overlapping pairs are provided in <code>emptyoverlaps</code>. See Chan, Silverman and Vincent (2019) for details.
</p>
<p><code>emptyoverlaps</code> A matrix with two rows, whose columns give the indices of non-overlapping pairs of lists where the parameter indexed by
the pair is within the specified model. The column names give the names of the lists
corresponding to each pair.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists. Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NewOrl)
buildmodel(NewOrl, mX=NULL)
#Build a matrix that contains all two-list effects
m=dim(Artificial_3)[2]-1
mX = t(expand.grid(1:m, 1:m)); mX = mX[ , mX[1,]&lt;mX[2,]]
# With one two-list effect
buildmodel(NewOrl, mX=mX[,1])
#With three two-list effects
buildmodel(NewOrl, mX=mX[,1:3])

</code></pre>


</div>