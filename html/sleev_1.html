<div class="container">

<table style="width: 100%;"><tr>
<td>cv_linear2ph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs cross-validation to calculate the average predicted log likelihood for the <code>linear2ph</code> function. This function can be used to select the B-spline basis that yields the largest average predicted log likelihood.</h2>

<h3>Description</h3>

<p>Performs cross-validation to calculate the average predicted log likelihood for the <code>linear2ph</code> function. This function can be used to select the B-spline basis that yields the largest average predicted log likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_linear2ph(
  Y_unval = NULL,
  Y = NULL,
  X_unval = NULL,
  X = NULL,
  Z = NULL,
  Bspline = NULL,
  data = NULL,
  nfolds = 5,
  MAX_ITER = 2000,
  TOL = 1e-04,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y_unval</code></td>
<td>
<p>Specifies the column of the error-prone outcome that is continuous. Subjects with missing values of <code>Y_unval</code> are omitted from the analysis. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Specifies the column that stores the validated value of <code>Y_unval</code> in the second phase. Subjects with missing values of <code>Y</code> are considered as those not selected in the second phase. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_unval</code></td>
<td>
<p>Specifies the columns of the error-prone covariates. Subjects with missing values of <code>X_unval</code> are omitted from the analysis. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Specifies the columns that store the validated values of <code>X_unval</code> in the second phase. Subjects with missing values of <code>X</code> are considered as those not selected in the second phase. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Specifies the columns of the accurately measured covariates. Subjects with missing values of <code>Z</code> are omitted from the analysis. This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bspline</code></td>
<td>
<p>Specifies the columns of the B-spline basis. Subjects with missing values of <code>Bspline</code> are omitted from the analysis. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Specifies the name of the dataset. This argument is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Specifies the number of cross-validation folds. The default value is <code>5</code>. Although <code>nfolds</code> can be as large as the sample size (leave-one-out cross-validation), it is not recommended for large datasets. The smallest value allowable is <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAX_ITER</code></td>
<td>
<p>Specifies the maximum number of iterations in the EM algorithm. The default number is <code>2000</code>. This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TOL</code></td>
<td>
<p>Specifies the convergence criterion in the EM algorithm. The default value is <code>1E-4</code>. This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, then show details of the analysis. The default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>avg_pred_loglike</code></td>
<td>
<p>Stores the average predicted log likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_loglike</code></td>
<td>
<p>Stores the predicted log likelihood in each fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p>Stores the convergence status of the EM algorithm in each run.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">  rho = 0.3
  p = 0.3
  n = 100
  n2 = 40
  alpha = 0.3
  beta = 0.4
   
  ### generate data
  simX = rnorm(n)
  epsilon = rnorm(n)
  simY = alpha+beta*simX+epsilon
  error = MASS::mvrnorm(n, mu=c(0,0), Sigma=matrix(c(1, rho, rho, 1), nrow=2))
   
  simS = rbinom(n, 1, p)
  simU = simS*error[,2]
  simW = simS*error[,1]
  simY_tilde = simY+simW
  simX_tilde = simX+simU
   
  id_phase2 = sample(n, n2)
   
  simY[-id_phase2] = NA
  simX[-id_phase2] = NA
   
  # cubic basis
  nsieves = c(5, 10)
  pred_loglike = rep(NA, length(nsieves))
  for (i in 1:length(nsieves)) {
      nsieve = nsieves[i]
      Bspline = splines::bs(simX_tilde, df=nsieve, degree=3, 
        Boundary.knots=range(simX_tilde), intercept=TRUE)
      colnames(Bspline) = paste("bs", 1:nsieve, sep="")
      # cubic basis
     
      data = data.frame(Y_tilde=simY_tilde, X_tilde=simX_tilde, Y=simY, X=simX, Bspline)
      ### generate data
     
      res = cv_linear2ph(Y="Y", X="X", Y_unval="Y_tilde", X_unval="X_tilde", 
        Bspline=colnames(Bspline), data=data, nfolds = 5)
      pred_loglike[i] = res$avg_pred_loglik
    }
   
  data.frame(nsieves, pred_loglike)

</code></pre>


</div>