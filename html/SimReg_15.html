<div class="container">

<table style="width: 100%;"><tr>
<td>sim_reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Similarity regression</h2>

<h3>Description</h3>

<p>Performs Bayesian ‘similarity regression’ on given <code>logical</code> response vector <code>y</code> against <code>list</code> of ontological term sets <code>x</code>. It returns an object of class <code>sim_reg_output</code>. Of particular interest are the probability of an association, which can be calculated with <code>prob_association</code>, and the characteristic ontological profile phi, which can be visualised using the functions <code>plot_term_marginals</code>, and <code>term_marginals</code>). The results can be summarised with <code>summary</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_reg(
  ontology,
  x,
  y,
  information_content = get_term_info_content(ontology, x),
  sim_params = list(ontology = ontology, information_content = information_content),
  using_terms = get_terms(sim_params),
  term_weights = rep(0, length(using_terms)),
  prior = discrete_gamma(using_terms),
  min_BF = -Inf,
  max_select = 2000L,
  max_phi_count = 200L,
  two_way = TRUE,
  selection_fn = fg_step_tab(N = length(y)),
  lik_method = NULL,
  lik_method_args = list(),
  gamma0_ml = bg_rate,
  min_ratio = 1e-04,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ontology</code></td>
<td>
<p><code>ontology_index</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>list</code> of <code>character</code> vectors of ontological terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>logical</code> response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information_content</code></td>
<td>
<p>Numeric vector of information contents of terms named by term ID. Defaults to information content based on frequencies of annotation in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_params</code></td>
<td>
<p>List of arguments to pass to <code>get_asym_sim_grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>using_terms</code></td>
<td>
<p>Character vector of term IDs giving the complete set of terms to include in the the <code>phi</code> parameter space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term_weights</code></td>
<td>
<p>Numeric vector of prior weights for individual terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Function for computing the unweighted prior probability of a <code>phi</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_BF</code></td>
<td>
<p>Bayes factor threshold below which to terminate computation, enabling faster execution time at the expense of accuracy and precision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_select</code></td>
<td>
<p>Upper bound for number of <code>phi</code> values to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_phi_count</code></td>
<td>
<p>Upper bound for number of <code>phi</code> values to include in final likelihood sum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two_way</code></td>
<td>
<p>Boolean value determining whether to calculate semantic similarity ‘in both directions’ (i.e. compute <code>s_x</code> and <code>s_phi</code> or just <code>s_phi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection_fn</code></td>
<td>
<p>Function for selecting values of <code>phi</code> with high posterior mass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik_method</code></td>
<td>
<p>Function for calculating marginal likelihood contional on values of <code>phi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik_method_args</code></td>
<td>
<p>List of additional arguments to pass to <code>lik_method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0_ml</code></td>
<td>
<p>Function for computing marginal likelihood of data under baseline model <code>gamma=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_ratio</code></td>
<td>
<p>Lower bound on ratio below which to discard <code>phi</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>selection_fn</code>.</p>
</td>
</tr>
</table>
</div>