<div class="container">

<table style="width: 100%;"><tr>
<td>surv_func_joint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluates the Conditional Survival Function Given the Random Effects</h2>

<h3>Description</h3>

<p>Evaluates the conditional survival function given the random effects,
<code class="reqn">\vec U</code>. The conditional hazard function is
</p>
<p style="text-align: center;"><code class="reqn">h(t \mid \vec u) = \exp(\vec\omega^\top\vec b(t) + \delta +
  \vec\alpha^\top\vec o +
  \vec 1^\top(diag(\vec \alpha) \otimes \vec g(t)^\top)vec(B) +
  \vec 1^\top(diag(\vec \alpha) \otimes \vec m(t)^\top)\vec u).</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">surv_func_joint(
  ti,
  B,
  U,
  omega,
  delta,
  alpha,
  b_func,
  m_func,
  gl_dat = get_gl_rule(30L),
  g_func,
  offset
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ti</code></td>
<td>
<p>numeric vector with time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>coefficient matrix for time-varying fixed effects.
Use <code>NULL</code> if there is no effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>random effects matrix for time-varying random effects.
Use <code>NULL</code> if there is no effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>numeric vector with coefficients for the baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>offset on the log hazard scale. Use <code>NULL</code> if
there is no effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric vector with association parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_func</code></td>
<td>
<p>basis function for the baseline hazard like <code>poly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_func</code></td>
<td>
<p>basis function for <code>U</code> like <code>poly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl_dat</code></td>
<td>
<p>Gaussâ€“Legendre quadrature data.
See <code>get_gl_rule</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_func</code></td>
<td>
<p>basis function for <code>B</code> like <code>poly</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric vector with non-time-varying fixed effects.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>sim_marker</code>, <code>draw_U</code>,
<code>eval_surv_base_fun</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#####
# example with polynomial basis functions
b_func &lt;- function(x){
  x &lt;- x - 1
  cbind(x^3, x^2, x)
}
g_func &lt;- function(x){
  x &lt;- x - 1
  cbind(x^3, x^2, x)
}
m_func &lt;- function(x){
  x &lt;- x - 1
  cbind(x^2, x, 1)
}

# parameters
omega &lt;- c(1.4, -1.2, -2.1)
Psi &lt;- structure(c(0.18, 0.05, -0.05, 0.1, -0.02, 0.06, 0.05, 0.34, -0.25,
                   -0.06, -0.03, 0.29, -0.05, -0.25, 0.24, 0.04, 0.04,
                   -0.12, 0.1, -0.06, 0.04, 0.34, 0, -0.04, -0.02, -0.03,
                   0.04, 0, 0.1, -0.08, 0.06, 0.29, -0.12, -0.04, -0.08,
                   0.51), .Dim = c(6L, 6L))
B &lt;- structure(c(-0.57, 0.17, -0.48, 0.58, 1, 0.86), .Dim = 3:2)
alpha &lt;- c(.5, .9)

# simulate and draw survival curve
gl_dat &lt;- get_gl_rule(30L)
set.seed(1)
U &lt;- draw_U(chol(Psi), NCOL(B))
tis &lt;- seq(0, 2, length.out = 100)
Survs &lt;- surv_func_joint(ti = tis, B = B, U = U, omega = omega,
                         delta = NULL, alpha = alpha, b_func = b_func,
                         m_func = m_func, gl_dat = gl_dat, g_func = g_func,
                         offset = NULL)
par_old &lt;- par(mar = c(5, 5, 1, 1))
plot(tis, Survs, xlab = "Time", ylab = "Survival", type = "l",
     ylim = c(0, 1), bty = "l", xaxs = "i", yaxs = "i")
par(par_old)

</code></pre>


</div>