<div class="container">

<table style="width: 100%;"><tr>
<td>ticEmp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical tail importance coefficients.</h2>

<h3>Description</h3>

<p>Computes on a sample the tail  importance coefficients (tic) associated with threshold <code>k</code>. The value may be renormalized by the empirical global variance (Sobol version).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ticEmp(sample, ind = 2, k, sobol = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>A character string among "with.singletons" and "all" (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the empirical global variance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The theoretical functional decomposition of the variance of the stdf <code class="reqn">\ell</code> consists in writing <code class="reqn">D(\ell) = \sum_{I \subseteq \{1,...,d\}} D_I(\ell) </code> where <code class="reqn">D_I(\ell)</code> measures the variance of <code class="reqn">\ell_I(U_I)</code> the term associated with subset <code class="reqn">I</code> in the Hoeffding-Sobol decomposition of <code class="reqn">\ell</code>
; note that <code class="reqn">U_I</code> represents  a random vector with independent standard uniform entries. The theoretical tail variance contribution is thus <code class="reqn">D_I(\ell)</code> and the theoretical tail sobol index is <code class="reqn">S_I(\ell)=\dfrac{D_I(\ell)}{D(\ell)}</code>.
</p>
<p>Here, the function <code>ticEmp</code> evaluates  <code class="reqn">\hat{D}_{I,k,n}</code> the empirical counterpart of <code class="reqn">D_I(\ell)</code> under the option <code>sobol = FALSE</code>, and <code class="reqn">\hat{S}_{I,k,n}</code> the empirical counterpart of <code class="reqn">S_I(\ell)</code> under the option <code>sobol = TRUE</code>.
</p>
<p>Proposition 1 and Theorem 2 of Mercadier and Roustant (2019) furnish their rank-based expressions. For the subset of components <code class="reqn">I</code>,
</p>
<p><code class="reqn">\hat{D}_{I,k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}(\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})-\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}) \prod_{t\notin I} \overline{R}^{(t)}_s\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p><code class="reqn">\hat{D}_{k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})- \prod_{t\in I}\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p>and <code class="reqn">\hat{S}_{I,k,n}=\dfrac{\hat{D}_{I,k,n}}{\hat{D}_{k,n}}</code>
</p>
<p>where
</p>

<ul>
<li> <p><code class="reqn">k</code> is the threshold parameter,
</p>
</li>
<li> <p><code class="reqn">n</code> is the sample size,
</p>
</li>
<li> <p><code class="reqn">X_1,...,X_n</code> describes the <code>sample</code>, each <code class="reqn">X_s</code> is a d-dimensional vector <code class="reqn">X_s^{(t)}</code> for <code class="reqn">t=1,...,d</code>,
</p>
</li>
<li> <p><code class="reqn">R^{(t)}_s</code> denotes the rank of <code class="reqn">X^{(t)}_s</code> among <code class="reqn">X^{(t)}_1, ..., X^{(t)}_n</code>,
</p>
</li>
<li>
<p> and  <code class="reqn">\overline{R}^{(t)}_s = \min((n- R^{(t)}_s+1)/k,1)</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li>
<p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li>
<p><code>tic</code> A vector of tail importance coefficients, or their sobol versions when <code>sobol = "TRUE"</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343–372.
</p>


<h3>See Also</h3>

<p><code>tic</code> and <code>tsicEmp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Fix a 5-dimensional asymmetric tail dependence structure
(ds5 &lt;- gen.ds(d = 5))

## Generate a 1000-sample of Mevlog random vectors associated with ds5
sample5 &lt;- rMevlog(n = 1000, ds = ds5)

## Compute empirical tic values according cardinality
res2 &lt;- ticEmp(sample5, ind = 2, k = 100, sobol = TRUE)
res3 &lt;- ticEmp(sample5, ind = 3, k = 100, sobol = TRUE)
res4 &lt;- ticEmp(sample5, ind = 4, k = 100, sobol = TRUE)

## Represent the empirical indices associated with pairs
barplot(res2$tic ~ as.character(res2$subsets), las = 2,
     xlab = "", ylab = "", main = "Tail Sobol Indices (cardinality 2)")

## Represent the empirical indices associated with triplets
barplot(res3$tic ~ as.character(res3$subsets), las = 2,
     xlab = "", ylab = "", main = "Tail Sobol Indices (cardinality 3)")

## Represent the empirical indices associated with quadriplets
barplot(res4$tic ~ as.character(res4$subsets), las = 2,
     xlab = "", ylab ="", main = "Tail Sobol Indices (cardinality 4)")

## Check the sum-to-one constraint of empirical tail Sobol indices
sum(ticEmp(sample5, ind = "with.singletons", k = 100,  sobol = TRUE)$tic)

</code></pre>


</div>