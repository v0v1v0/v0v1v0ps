<div class="container">

<table style="width: 100%;"><tr>
<td>SNSeg_Multi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Self-normalization (SN) based change points estimation for multivariate time
series</h2>

<h3>Description</h3>

<p>The function <code>SNSeg_Multi</code> is a SN-based change-points estimation
procedure for a multivariate time series based on changes in the multivariate
means or covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SNSeg_Multi(
  ts,
  paras_to_test = "mean",
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = FALSE,
  est_cp_loc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>A multivariate time series represented as a matrix with p columns,
where each column is a univariate time series. The dimension p for ts should
be at least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paras_to_test</code></td>
<td>
<p>Type of the parameter as a string for which SN
algorithms test. Available choices include <code>mean</code> and <code>covariance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size_scale</code></td>
<td>
<p>numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by diving n from
grid_size when it is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>SNSeg_Multi</code> returns an S3 object of class "SNSeg_Multi" including
the time series, the type of parameter to be tested, the local window size to
cover a change point, the estimated change-point locations, the confidence level
and the critical value of the SN test. It also generates time series segmentation
plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt>
<dd>
<p>A numeric matrix of the input time series.</p>
</dd>
<dt><code>paras_to_test</code></dt>
<dd>
<p>the parameter used for the SN test as character.</p>
</dd>
<dt><code>grid_size</code></dt>
<dd>
<p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt>
<dd>
<p>A list of n matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the window h and
(4) Upper bound of the window h.</p>
</dd>
<dt><code>est_cp</code></dt>
<dd>
<p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt>
<dd>
<p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt>
<dd>
<p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>
<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_Multi</code>.
</p>
<p>For more examples of <code>SNSeg_Multi</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Please run this function before simulation
exchange_cor_matrix &lt;- function(d, rho){
  tmp &lt;- matrix(rho, d, d)
  diag(tmp) &lt;- 1
  return(tmp)
}

# simulation of multivariate time series
library(mvtnorm)
set.seed(10)
d &lt;- 5
n &lt;- 600
nocp &lt;- 5
cp_sets &lt;- round(seq(0, nocp+1 ,1)/(nocp+1)*n)
mean_shift &lt;- rep(c(0,2),100)[1:(length(cp_sets)-1)]/sqrt(d)
rho_sets &lt;- 0.2
sigma_cross &lt;- list(exchange_cor_matrix(d,0))
ts &lt;- MAR_MTS_Covariance(n, 2, rho_sets, cp_sets = c(0,n), sigma_cross)
ts &lt;- ts[1][[1]]

# Test for the change in multivariate means
# grid_size defined
result &lt;- SNSeg_Multi(ts, paras_to_test = "mean", confidence = 0.99,
                      grid_size_scale = 0.05, grid_size = 45)
# Estimated change-point locations
result$est_cp

# For more examples, please run the following command:
# vignette("SNSeg", package = "SNSeg")


</code></pre>


</div>