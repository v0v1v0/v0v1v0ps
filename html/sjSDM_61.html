<div class="container">

<table style="width: 100%;"><tr>
<td>sjSDM_cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross validation of elastic net tuning</h2>

<h3>Description</h3>

<p>Cross validation of elastic net tuning
</p>


<h3>Usage</h3>

<pre><code class="language-R">sjSDM_cv(
  Y,
  env = NULL,
  biotic = bioticStruct(),
  spatial = NULL,
  tune = c("random", "grid"),
  CV = 5L,
  tune_steps = 20L,
  alpha_cov = seq(0, 1, 0.1),
  alpha_coef = seq(0, 1, 0.1),
  alpha_spatial = seq(0, 1, 0.1),
  lambda_cov = 2^seq(-10, -1, length.out = 20),
  lambda_coef = 2^seq(-10, -0.5, length.out = 20),
  lambda_spatial = 2^seq(-10, -0.5, length.out = 20),
  device = "cpu",
  n_cores = NULL,
  n_gpu = NULL,
  sampling = 5000L,
  blocks = 1L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>species occurrence matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>matrix of environmental predictors or object of type <code>linear</code>, or <code>DNN</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biotic</code></td>
<td>
<p>defines biotic (species-species associations) structure, object of type <code>bioticStruct</code>. Alpha and lambda have no influence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>defines spatial structure, object of type <code>linear</code>, or <code>DNN</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>tuning strategy, random or grid search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>n-fold cross validation or list of test indices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune_steps</code></td>
<td>
<p>number of tuning steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_cov</code></td>
<td>
<p>weighting of l1 and l2 on covariances: <code class="reqn">(1 - \alpha) * |cov| + \alpha ||cov||^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_coef</code></td>
<td>
<p>weighting of l1 and l2 on coefficients: <code class="reqn">(1 - \alpha) * |coef| + \alpha ||coef||^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_spatial</code></td>
<td>
<p>weighting of l1 and l2 on spatial coefficients: <code class="reqn">(1 - \alpha) * |coef_sp| + \alpha ||coef_sp||^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_cov</code></td>
<td>
<p>overall regularization strength on covariances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_coef</code></td>
<td>
<p>overall regularization strength on coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_spatial</code></td>
<td>
<p>overall regularization strength on spatial coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>device, default cpu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>number of cores for parallelization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_gpu</code></td>
<td>
<p>number of GPUs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>number of sampling steps for Monte Carlo integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p>blocks of parallel tuning steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to sjSDM, see <code>sjSDM</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S3 class of type 'sjSDM_cv' including the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tune_results</code></td>
<td>
<p>Data frame with tuning results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>short_summary</code></td>
<td>
<p>Data frame with averaged tuning results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Data frame with summarized averaged results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>List of tuning settings, see the arguments in <code>DNN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>List of Y, env (and spatial) objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>config</code></td>
<td>
<p>List of <code>sjSDM</code> settings, see arguments of <code>sjSDM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>Logical, spatial model or not.</p>
</td>
</tr>
</table>
<p>Implemented S3 methods include <code>sjSDM.tune</code>, <code>plot.sjSDM_cv</code>, <code>print.sjSDM_cv</code>, and <code>summary.sjSDM_cv</code>
</p>


<h3>See Also</h3>

<p><code>plot.sjSDM_cv</code>, <code>print.sjSDM_cv</code>, <code>summary.sjSDM_cv</code>, <code>sjSDM.tune</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# simulate sparse community:
com = simulate_SDM(env = 5L, species = 25L, sites = 50L, sparse = 0.5)

# tune regularization:
tune_results = sjSDM_cv(Y = com$response,
                        env = com$env_weights, 
                        tune = "random", # random steps in tune-paramter space
                        CV = 2L, # 3-fold cross validation
                        tune_steps = 2L,
                        alpha_cov = seq(0, 1, 0.1),
                        alpha_coef = seq(0, 1, 0.1),
                        lambda_cov = seq(0, 0.1, 0.001), 
                        lambda_coef = seq(0, 0.1, 0.001),
                        n_cores = 2L,
                        sampling = 100L,
                        # small models can be also run in parallel on the GPU
                        iter = 2L # we can pass arguments to sjSDM via... 
                        )

# print overall results:
tune_results

# summary (mean values over CV for each tuning step)
summary(tune_results)

# visualize tuning and best points:
# best = plot(tune_results, perf = "logLik")

# fit model with best regularization paramter:
model = sjSDM.tune(tune_results)

summary(model)

## End(Not run)
</code></pre>


</div>