<div class="container">

<table style="width: 100%;"><tr>
<td>StabilityMetrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stability selection metrics</h2>

<h3>Description</h3>

<p>Computes the stability score (see <code>StabilityScore</code>) and
upper-bounds of the <code>PFER</code> and <code>FDP</code> from selection
proportions of models with a given parameter controlling the sparsity of the
underlying algorithm and for different thresholds in selection proportions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StabilityMetrics(
  selprop,
  pk = NULL,
  pi_list = seq(0.6, 0.9, by = 0.01),
  K = 100,
  n_cat = NULL,
  PFER_method = "MB",
  PFER_thr_blocks = Inf,
  FDP_thr_blocks = Inf,
  Sequential_template = NULL,
  graph = TRUE,
  group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>selprop</code></td>
<td>
<p>array of selection proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>optional vector encoding the grouping structure. Only used for
multi-block stability selection where <code>pk</code> indicates the number of
variables in each group. If <code>pk=NULL</code>, single-block stability
selection is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_list</code></td>
<td>
<p>vector of thresholds in selection proportions. If
<code>n_cat=NULL</code> or <code>n_cat=2</code>, these values must be <code>&gt;0</code> and
<code>&lt;1</code>. If <code>n_cat=3</code>, these values must be <code>&gt;0.5</code> and
<code>&lt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of resampling iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cat</code></td>
<td>
<p>computation options for the stability score. Default is
<code>NULL</code> to use the score based on a z test. Other possible values are 2
or 3 to use the score based on the negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_method</code></td>
<td>
<p>method used to compute the upper-bound of the expected
number of False Positives (or Per Family Error Rate, PFER). If
<code>PFER_method="MB"</code>, the method proposed by Meinshausen and Bühlmann
(2010) is used. If <code>PFER_method="SS"</code>, the method proposed by Shah and
Samworth (2013) under the assumption of unimodality is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_thr_blocks</code></td>
<td>
<p>vector of block-specific thresholds in PFER for
constrained calibration by error control. If <code>PFER_thr=Inf</code> and
<code>FDP_thr=Inf</code>, unconstrained calibration is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP_thr_blocks</code></td>
<td>
<p>vector of block-specific thresholds in the expected
proportion of falsely selected features (or False Discovery Proportion,
FDP) for constrained calibration by error control. If <code>PFER_thr=Inf</code>
and <code>FDP_thr=Inf</code>, unconstrained calibration is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sequential_template</code></td>
<td>
<p>logical matrix encoding the type of procedure to
use for data with multiple blocks in stability selection graphical
modelling. For multi-block estimation, the stability selection model is
constructed as the union of block-specific stable edges estimated while the
others are weakly penalised (<code>TRUE</code> only for the block currently being
calibrated and <code>FALSE</code> for other blocks). Other approaches with joint
calibration of the blocks are allowed (all entries are set to <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>logical indicating if stability selection is performed in a
regression (if <code>FALSE</code>) or graphical (if <code>TRUE</code>)
framework.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>vector encoding the grouping structure among predictors. This
argument indicates the number of variables in each group and only needs to
be provided for group (but not sparse group) penalisation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with: </p>
<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a matrix of the best (block-specific) stability
scores for different (sets of) penalty parameters. In multi-block stability
selection, rows correspond to different sets of penalty parameters, (values
are stored in the output "Lambda") and columns correspond to different
blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>a matrix of (block-specific) penalty parameters. In
multi-block stability selection, rows correspond to sets of penalty
parameters and columns correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>a matrix
of average numbers of (block-specific) edges selected by the underlying
algorithm for different (sets of) penalty parameters. In multi-block
stability selection, rows correspond to different sets of penalty
parameters, (values are stored in the output "Lambda") and columns
correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_s</code></td>
<td>
<p>a matrix of calibrated numbers
of (block-specific) stable edges for different (sets of) penalty
parameters. In multi-block stability selection, rows correspond to
different sets of penalty parameters, (values are stored in the output
"Lambda") and columns correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a matrix of
calibrated (block-specific) thresholds in selection proportions for
different (sets of) penalty parameters. In multi-block stability selection,
rows correspond to different sets of penalty parameters, (values are stored
in the output "Lambda") and columns correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER</code></td>
<td>
<p>a matrix of computed (block-specific) upper-bounds in PFER of
calibrated graphs for different (sets of) penalty parameters. In
multi-block stability selection, rows correspond to different sets of
penalty parameters, (values are stored in the output "Lambda") and columns
correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP</code></td>
<td>
<p>a matrix of computed
(block-specific) upper-bounds in FDP of calibrated stability selection
models for different (sets of) penalty parameters. In multi-block stability
selection, rows correspond to different sets of penalty parameters, (values
are stored in the output "Lambda") and columns correspond to different
blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_2d</code></td>
<td>
<p>an array of (block-specific) stability scores obtained
with different combinations of parameters. Rows correspond to different
(sets of) penalty parameters and columns correspond to different thresholds
in selection proportions. In multi-block stability selection, indices along
the third dimension correspond to different blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_2d</code></td>
<td>
<p>an
array of computed upper-bounds of PFER obtained with different combinations
of parameters. Rows correspond to different penalty parameters and columns
correspond to different thresholds in selection proportions. Not available
in multi-block stability selection graphical modelling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP_2d</code></td>
<td>
<p>an
array of computed upper-bounds of FDP obtained with different combinations
of parameters. Rows correspond to different penalty parameters and columns
correspond to different thresholds in selection proportions. Not available
in multi-block stability selection graphical modelling.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bodinier B, Filippi S, Nøst TH, Chiquet J, Chadeau-Hyam M (2023).
“Automated calibration for stability selection in penalised regression and graphical models.”
<em>Journal of the Royal Statistical Society Series C: Applied Statistics</em>, qlad058.
ISSN 0035-9254, <a href="https://doi.org/10.1093/jrsssc/qlad058">doi:10.1093/jrsssc/qlad058</a>, https://academic.oup.com/jrsssc/advance-article-pdf/doi/10.1093/jrsssc/qlad058/50878777/qlad058.pdf.
</p>
<p>Meinshausen N, Bühlmann P (2010).
“Stability selection.”
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>72</b>(4), 417-473.
<a href="https://doi.org/10.1111/j.1467-9868.2010.00740.x">doi:10.1111/j.1467-9868.2010.00740.x</a>.
</p>
<p>Shah RD, Samworth RJ (2013).
“Variable selection with error control: another look at stability selection.”
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>75</b>(1), 55-80.
<a href="https://doi.org/10.1111/j.1467-9868.2011.01034.x">doi:10.1111/j.1467-9868.2011.01034.x</a>.
</p>


<h3>See Also</h3>

<p>Other stability metric functions: 
<code>ConsensusScore()</code>,
<code>FDP()</code>,
<code>PFER()</code>,
<code>StabilityScore()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sparse or sparse group penalisation

# Simulating set of selection proportions
set.seed(1)
selprop &lt;- matrix(round(runif(n = 20), digits = 2), nrow = 2)

# Computing stability scores for different thresholds
metrics &lt;- StabilityMetrics(
  selprop = selprop, pi = c(0.6, 0.7, 0.8),
  K = 100, graph = FALSE
)


## Group penalisation

# Simulating set of selection proportions
set.seed(1)
selprop &lt;- matrix(round(runif(n = 6), digits = 2), nrow = 2)
selprop &lt;- cbind(
  selprop[, 1], selprop[, 1],
  selprop[, 2], selprop[, 2],
  matrix(rep(selprop[, 3], each = 6), nrow = 2, byrow = TRUE)
)

# Computing stability scores for different thresholds
metrics &lt;- StabilityMetrics(
  selprop = selprop, pi = c(0.6, 0.7, 0.8),
  K = 100, graph = FALSE, group = c(2, 2, 6)
)
</code></pre>


</div>