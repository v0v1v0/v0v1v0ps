<div class="container">

<table style="width: 100%;"><tr>
<td>sgpvalue</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Second-Generation p-Values</h2>

<h3>Description</h3>

<p>This function computes the second-generation <em>p</em>-value (SGPV) and its associated delta gaps, as introduced in Blume et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sgpvalue(
  est.lo,
  est.hi,
  null.lo,
  null.hi,
  inf.correction = 1e-05,
  warnings = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est.lo</code></td>
<td>
<p>A numeric vector of lower bounds of interval estimates. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>est.hi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.hi</code></td>
<td>
<p>A numeric vector of upper bounds of interval estimates. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>est.lo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.lo</code></td>
<td>
<p>A numeric vector of lower bounds of null intervals. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>null.hi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.hi</code></td>
<td>
<p>A numeric vector of upper bounds of null intervals. Values may be finite or <code>-Inf</code> or <code>Inf</code>. Must be of same length as <code>null.lo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inf.correction</code></td>
<td>
<p>A small scalar to denote a positive but infinitesimally small SGPV. Default is 1e-5. SGPVs that are infinitesimally close to 1 are assigned <code>1-inf.correction</code>. This option can only be invoked when one of the intervals has infinite length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>Warnings toggle. Warnings are on by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Values of <code>NA</code> or <code>NaN</code> for <code>est.lo</code>, <code>est.hi</code>, <code>null.lo</code>, or <code>null.lo</code> will yield a warning and result in a SGPV of <code>NA</code> or <code>NaN</code>.
</p>
<p>When <code>null.hi</code> and <code>null.lo</code> are of length 1, the same null interval is used for every interval estimate of [<code>est.lo</code>, <code>est.hi</code>]. If <code>null.hi</code> is not of length 1, its length must match that of <code>est.hi</code>.
</p>
<p>When possible, one should compute the second-generation <em>p</em>-value on a scale that is symmetric about the null hypothesis. For example, if the parameter of interest is an odds ratio, computations are typically done on the log scale. This keeps the magnitude of positive and negative delta-gaps comparable. Also, recall that the delta-gaps magnitude is not comparable across different null intervals.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt><code>p.delta</code></dt>
<dd>
<p>Vector of second-generation p-values</p>
</dd>
<dt><code>delta.gap</code></dt>
<dd>
<p>Vector of delta-gaps. Reported as <code>NA</code> when the corresponding second-generation p-value is not zero.</p>
</dd>
</dl>
<h3>References</h3>

<p>Blume JD, Greevy RA Jr., Welty VF, Smith JR, Dupont WD (2019). An Introduction to Second-generation <em>p</em>-values. <em>The American Statistician</em>. 73:sup1, 157-167, DOI: https://doi.org/10.1080/00031305.2018.1537893
</p>
<p>Blume JD, Dâ€™Agostino McGowan L, Dupont WD, Greevy RA Jr. (2018). Second-generation <em>p</em>-values: Improved rigor, reproducibility, &amp; transparency in statistical analyses. <em>PLoS ONE</em> 13(3): e0188299. https://doi.org/10.1371/journal.pone.0188299
</p>


<h3>See Also</h3>

<p><code>fdrisk, sgpower, plotsgpv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Simple example for three estimated log odds ratios but the same null interval
lb &lt;- c(log(1.05), log(1.3), log(0.97))
ub &lt;- c(log(1.8), log(1.8), log(1.02))
sgpv &lt;- sgpvalue(est.lo = lb, est.hi = ub, null.lo = log(1/1.1), null.hi = log(1.1))
sgpv$p.delta

sgpv$delta.gap

## Works with infinte interval bounds
sgpvalue(est.lo = log(1.3), est.hi = Inf, null.lo = -Inf, null.hi = log(1.1))


sgpvalue(est.lo = log(1.05), est.hi = Inf, null.lo = -Inf, null.hi = log(1.1))



## Example t-test with simulated data
set.seed(1776)
x1 &lt;- rnorm(15,mean=0,sd=2) ; x2 &lt;- rnorm(15,mean=3,sd=2)
ci &lt;- t.test(x1,x2)$conf.int[1:2]
sgpvalue(est.lo = ci[1], est.hi = ci[2], null.lo = -1, null.hi = 1)

set.seed(2019)
x1 &lt;- rnorm(15,mean=0,sd=2) ; x2 &lt;- rnorm(15,mean=3,sd=2)
ci &lt;- t.test(x1,x2)$conf.int[1:2]
sgpvalue(est.lo = ci[1], est.hi = ci[2], null.lo = -1, null.hi = 1)

## Simulated two-group dichotomous data for different parameters
set.seed(1492)
n1 &lt;- n2 &lt;- 30
x1 &lt;- rbinom(1,size=n1,p=0.15) ; x2 &lt;- rbinom(1,size=n2,p=0.50)

# On the difference in proportions
ci.p  &lt;- prop.test(c(x1,x2),n=c(n1,n2))$conf.int[1:2]
sgpvalue(est.lo = ci.p[1], est.hi = ci.p[2], null.lo = -0.2, null.hi = 0.2)

# On the log odds ratio scale
a &lt;- x1 ; b &lt;- x2 ; c &lt;- n1-x1 ; d &lt;- n2-x2
ci.or &lt;- log(a*d/(b*c)) + c(-1,1)*1.96*sqrt(1/a+1/b+1/c+1/d)	# Delta-method SE for log odds ratio
sgpvalue(est.lo = ci.or[1], est.hi = ci.or[2], null.lo = log(1/1.5), null.hi = log(1.5))


</code></pre>


</div>