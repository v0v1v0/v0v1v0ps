<div class="container">

<table style="width: 100%;"><tr>
<td>Simulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation class</h2>

<h3>Description</h3>

<p>Class for running a simulation and getting results.
</p>


<h3>Details</h3>

<p>The <code>Simulation</code> class is used to set up and run a daily
simulation over a particular period. Portfolio construction parameters and
other simulator settings can be configured in a yaml file that is passed to
the object's constructor. See <code>vignette("strand")</code> for information on
configuration file setup.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>Simulation$new()</code></a>
</p>
</li>
<li> <p><a href="#method-setVerbose"><code>Simulation$setVerbose()</code></a>
</p>
</li>
<li> <p><a href="#method-setShinyCallback"><code>Simulation$setShinyCallback()</code></a>
</p>
</li>
<li> <p><a href="#method-getSecurityReference"><code>Simulation$getSecurityReference()</code></a>
</p>
</li>
<li> <p><a href="#method-run"><code>Simulation$run()</code></a>
</p>
</li>
<li> <p><a href="#method-getSimDates"><code>Simulation$getSimDates()</code></a>
</p>
</li>
<li> <p><a href="#method-getSimSummary"><code>Simulation$getSimSummary()</code></a>
</p>
</li>
<li> <p><a href="#method-getSimDetail"><code>Simulation$getSimDetail()</code></a>
</p>
</li>
<li> <p><a href="#method-getPositionSummary"><code>Simulation$getPositionSummary()</code></a>
</p>
</li>
<li> <p><a href="#method-getInputStats"><code>Simulation$getInputStats()</code></a>
</p>
</li>
<li> <p><a href="#method-getLooseningInfo"><code>Simulation$getLooseningInfo()</code></a>
</p>
</li>
<li> <p><a href="#method-getOptimizationSummary"><code>Simulation$getOptimizationSummary()</code></a>
</p>
</li>
<li> <p><a href="#method-getExposures"><code>Simulation$getExposures()</code></a>
</p>
</li>
<li> <p><a href="#method-getDelistings"><code>Simulation$getDelistings()</code></a>
</p>
</li>
<li> <p><a href="#method-getSingleStrategySummaryDf"><code>Simulation$getSingleStrategySummaryDf()</code></a>
</p>
</li>
<li> <p><a href="#method-plotPerformance"><code>Simulation$plotPerformance()</code></a>
</p>
</li>
<li> <p><a href="#method-plotContribution"><code>Simulation$plotContribution()</code></a>
</p>
</li>
<li> <p><a href="#method-plotMarketValue"><code>Simulation$plotMarketValue()</code></a>
</p>
</li>
<li> <p><a href="#method-plotCategoryExposure"><code>Simulation$plotCategoryExposure()</code></a>
</p>
</li>
<li> <p><a href="#method-plotFactorExposure"><code>Simulation$plotFactorExposure()</code></a>
</p>
</li>
<li> <p><a href="#method-plotNumPositions"><code>Simulation$plotNumPositions()</code></a>
</p>
</li>
<li> <p><a href="#method-plotTurnover"><code>Simulation$plotTurnover()</code></a>
</p>
</li>
<li> <p><a href="#method-plotUniverseSize"><code>Simulation$plotUniverseSize()</code></a>
</p>
</li>
<li> <p><a href="#method-plotNonInvestablePct"><code>Simulation$plotNonInvestablePct()</code></a>
</p>
</li>
<li> <p><a href="#method-overallStatsDf"><code>Simulation$overallStatsDf()</code></a>
</p>
</li>
<li> <p><a href="#method-overallReturnsByMonthDf"><code>Simulation$overallReturnsByMonthDf()</code></a>
</p>
</li>
<li> <p><a href="#method-print"><code>Simulation$print()</code></a>
</p>
</li>
<li> <p><a href="#method-writeFeather"><code>Simulation$writeFeather()</code></a>
</p>
</li>
<li> <p><a href="#method-readFeather"><code>Simulation$readFeather()</code></a>
</p>
</li>
<li> <p><a href="#method-getConfig"><code>Simulation$getConfig()</code></a>
</p>
</li>
<li> <p><a href="#method-writeReport"><code>Simulation$writeReport()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>Simulation$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new <code>Simulation</code> object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$new(
  config = NULL,
  raw_input_data = NULL,
  input_dates = NULL,
  raw_pricing_data = NULL,
  security_reference_data = NULL,
  delisting_data = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>config</code></dt>
<dd>
<p>An object of class <code>list</code> or <code>character</code>, or
<code>NULL</code>. If the value passed is a character vector, it should be of
length 1 and specify the path to a yaml configuration file that
contains the object's configuration info. If the value passed is of
class list(), the list should contain the object's configuration info
in list form (e.g, the return value of calling <code>yaml.load_file</code> on
the configuration file). If the value passed is <code>NULL</code>, then there
will be no configuration information associated with the simulation and
it will not possible to call the <code>run</code> method. Setting
<code>config = NULL</code> is useful when creating simulation objects into
which results will be loaded with <code>readFeather</code>.</p>
</dd>
<dt><code>raw_input_data</code></dt>
<dd>
<p>A data frame that contains all of the input data
(for all periods) for the simulation. The data frame must have a
<code>date</code> column. Data supplied using this parameter will be
used if the configuration option <code>simulator/input_data/type</code> is
set to <code>object</code>. Defaults to <code>NULL</code>.</p>
</dd>
<dt><code>input_dates</code></dt>
<dd>
<p>Vector of class <code>Date</code> that specifies  when input
data should be updated. If data is being supplied using the
<code>raw_input_data</code> parameter, then <code>input_dates</code> defaults to
set of dates present in this data.</p>
</dd>
<dt><code>raw_pricing_data</code></dt>
<dd>
<p>A data frame that contains all of the input data
(for all periods) for the simulation. The data frame must have a
<code>date</code> column. Data supplied using this parameter will only be
used if the configuration option <code>simulator/pricing_data/type</code> is
set to <code>object</code>. Defaults to <code>NULL</code>.</p>
</dd>
<dt><code>security_reference_data</code></dt>
<dd>
<p>A data frame that contains reference data
on the securities in the simulation, including any categories that are
used in portfolio construction constraints. Note that the simulator
will throw an error if there are input data records for which there is
no entry in the security reference. Data supplied using this parameter
will only be used if the configuration option
<code>simulator/secref_data/type</code> is set to <code>object</code>. Defaults to
<code>NULL</code>.</p>
</dd>
<dt><code>delisting_data</code></dt>
<dd>
<p>A data frame that contains delisting dates and
associated returns. It must contain three columns: id (character),
delisting_date (Date), and delisting_return (numeric). The date in the
delisting_date column means the day on which a stock will be removed
from the simulation portfolio. It is typically the day after the last
day of trading. The delisting_return column reflects what, if any, P&amp;L
should be recorded on the delisting date. A delisting_return of -1
means that the shares were deemed worthless. The delisting return is
multiplied by the starting net market value of the position to
determine P&amp;L for the delisted position on the delisting date. Note
that the portfolio optimization does not include stocks that are being
removed due to delisting. Data supplied using this parameter will only
be used if the configuration option
<code>simulator/delisting_data/type</code> is set to <code>object</code>. Defaults
to <code>NULL</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>Simulation</code> object.
</p>


<hr>
<a id="method-setVerbose"></a>



<h4>Method <code>setVerbose()</code>
</h4>

<p>Set the verbose flag to control info output.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$setVerbose(verbose)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verbose</code></dt>
<dd>
<p>Logical flag indicating whether to be verbose or not.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>No return value, called for side effects.
</p>


<hr>
<a id="method-setShinyCallback"></a>



<h4>Method <code>setShinyCallback()</code>
</h4>

<p>Set the callback function for updating progress when running
a simulation in shiny.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$setShinyCallback(callback)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>callback</code></dt>
<dd>
<p>A function suitable for updating a shiny Progress object.
It must have two parameters: <code>value</code>, indicating the progress
amount, and detail, and <code>detail</code>, a text string for display on the
progress bar.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>No return value, called for side effects.
</p>


<hr>
<a id="method-getSecurityReference"></a>



<h4>Method <code>getSecurityReference()</code>
</h4>

<p>Get security reference information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getSecurityReference()</pre></div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains the security
reference data for the simulation.
</p>


<hr>
<a id="method-run"></a>



<h4>Method <code>run()</code>
</h4>

<p>Run the simulation.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$run()</pre></div>



<h5>Returns</h5>

<p>No return value, called for side effects.
</p>


<hr>
<a id="method-getSimDates"></a>



<h4>Method <code>getSimDates()</code>
</h4>

<p>Get a list of all date for the simulation.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getSimDates()</pre></div>



<h5>Returns</h5>

<p>A vector of class <code>Date</code> over which the simulation currently iterates: all
weekdays between the 'from' and 'to' dates in the simulation's config.
</p>


<hr>
<a id="method-getSimSummary"></a>



<h4>Method <code>getSimSummary()</code>
</h4>

<p>Get summary information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getSimSummary(strategy_name = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 that specifies the
strategy for which to get detail data. If <code>NULL</code> data for all
strategies is returned. Defaults to <code>NULL</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains summary data
for the simulation, by period, at the joint and strategy level. The data
frame contains the following columns:
</p>

<dl>
<dt>strategy</dt>
<dd>
<p>Strategy name, or 'joint' for the aggregate strategy.</p>
</dd>
<dt>sim_date</dt>
<dd>
<p>Date of the summary data.</p>
</dd>
<dt>market_fill_nmv</dt>
<dd>
<p>Total net market value of fills that do not
net down across strategies.</p>
</dd>
<dt>transfer_fill_nmv</dt>
<dd>
<p>Total net market value of fills that
represent "internal transfers", i.e., fills in one strategy that net
down with fills in another. Note that at the joint level this column
by definition is 0.</p>
</dd>
<dt>market_order_gmv</dt>
<dd>
<p>Total gross market value of orders that do not
net down across strategies.</p>
</dd>
<dt>market_fill_gmv</dt>
<dd>
<p>Total gross market value of fills that do not
net down across strategies.</p>
</dd>
<dt>transfer_fill_gmv</dt>
<dd>
<p>Total gross market value of fills that
represent "internal transfers", i.e., fills in one strategy that net
down with fills in another.</p>
</dd>
<dt>start_nmv</dt>
<dd>
<p>Total net market value of all positions at the start
of the period.</p>
</dd>
<dt>start_lmv</dt>
<dd>
<p>Total net market value of all long positions at the
start of the period.</p>
</dd>
<dt>start_smv</dt>
<dd>
<p>Total net market value of all short positions at the
start of the period.</p>
</dd>
<dt>end_nmv</dt>
<dd>
<p>Total net market value of all positions at the end of
the period.</p>
</dd>
<dt>end_gmv</dt>
<dd>
<p>Total gross market value of all positions at the end
of the period.</p>
</dd>
<dt>end_lmv</dt>
<dd>
<p>Total net market value of all long positions at the
end of the period.</p>
</dd>
<dt>end_smv</dt>
<dd>
<p>Total net market value of all short positions at the
end of the period.</p>
</dd>
<dt>end_num</dt>
<dd>
<p>Total number of positions at the end of the period.</p>
</dd>
<dt>end_num_long</dt>
<dd>
<p>Total number of long positions at the end of the
period.</p>
</dd>
<dt>end_num_short</dt>
<dd>
<p>Total number of short positions at the end of
the period.</p>
</dd>
<dt>position_pnl</dt>
<dd>
<p>The total difference between the end and start
market value of positions.</p>
</dd>
<dt>trading_pnl</dt>
<dd>
<p>The total difference between the market value of
trades at the benchmark price and at the end price. Note: currently
assuming benchmark price is the closing price, so trading P&amp;L is
zero.</p>
</dd>
<dt>gross_pnl</dt>
<dd>
<p>Total P&amp;L gross of costs, calculated as position_pnl
+ trading_pnl.</p>
</dd>
<dt>trade_costs</dt>
<dd>
<p>Total trade costs (slippage).</p>
</dd>
<dt>financing_costs</dt>
<dd>
<p>Total financing/borrow costs.</p>
</dd>
<dt>net_pnl</dt>
<dd>
<p>Total P&amp;L net of costs, calculated as gross_pnl -
trade_costs - financing_costs.</p>
</dd>
<dt>fill_rate_pct</dt>
<dd>
<p>Total fill rate across all market orders,
calculated as 100 * market_fill_gmv / market_order_gmv.</p>
</dd>
<dt>num_investable</dt>
<dd>
<p>Number of investable securities (size of universe).</p>
</dd>
</dl>
<hr>
<a id="method-getSimDetail"></a>



<h4>Method <code>getSimDetail()</code>
</h4>

<p>Get detail information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getSimDetail(
  sim_date = NULL,
  strategy_name = NULL,
  security_id = NULL,
  columns = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sim_date</code></dt>
<dd>
<p>Vector of length 1 of class Date or character that
specifies the period for which to get detail information. If
<code>NULL</code> then data from all periods is returned. Defaults
to <code>NULL</code>.</p>
</dd>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 that specifies the
strategy for which to get detail data. If <code>NULL</code> data for all
strategies is returned. Defaults to <code>NULL</code>.</p>
</dd>
<dt><code>security_id</code></dt>
<dd>
<p>Character vector of length 1 that specifies the
security for which to get detail data. If <code>NULL</code> data for all
securities is returned. Defaults to <code>NULL</code>.</p>
</dd>
<dt><code>columns</code></dt>
<dd>
<p>Vector of class character specifying the columns to
return. This parameter can be useful when dealing with very large
detail datasets.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains security-level
detail data for the simulation for the desired strategies, securities,
dates, and columns. Available columns include:
</p>

<dl>
<dt>id</dt>
<dd>
<p>Security identifier.</p>
</dd>
<dt>strategy</dt>
<dd>
<p>Strategy name, or 'joint' for the aggregate strategy.</p>
</dd>
<dt>sim_date</dt>
<dd>
<p>Date to which the data pertains.</p>
</dd>
<dt>shares</dt>
<dd>
<p>Shares at the start of the period.</p>
</dd>
<dt>int_shares</dt>
<dd>
<p>Shares at the start of the period that net down
with positions in other strategies.</p>
</dd>
<dt>ext_shares</dt>
<dd>
<p>Shares at the start of the period that do not net
down with positions in other strategies.</p>
</dd>
<dt>order_shares</dt>
<dd>
<p>Order, in shares.</p>
</dd>
<dt>market_order_shares</dt>
<dd>
<p>Order that does not net down with orders
in other strategies, in shares.</p>
</dd>
<dt>transfer_order_shares</dt>
<dd>
<p>Order that nets down with orders in
other strategies, in shares.</p>
</dd>
<dt>fill_shares</dt>
<dd>
<p>Fill, in shares.</p>
</dd>
<dt>market_fill_shares</dt>
<dd>
<p>Fill that does not net down with fills in
other strategies, in shares.</p>
</dd>
<dt>transfer_fill_shares</dt>
<dd>
<p>Fill that nets down with fills in other
strategies, in shares.</p>
</dd>
<dt>end_shares</dt>
<dd>
<p>Shares at the end of the period.</p>
</dd>
<dt>end_int_shares</dt>
<dd>
<p>Shares at the end of the period that net down
with positions in other strategies.</p>
</dd>
<dt>end_ext_shares</dt>
<dd>
<p>Shares at the end of the period that do not net
down with positions in other strategies.</p>
</dd>
<dt>start_price</dt>
<dd>
<p>Price for the security at the beginning of the
period.</p>
</dd>
<dt>end_price</dt>
<dd>
<p>Price for the security at the end of the period.</p>
</dd>
<dt>dividend</dt>
<dd>
<p>Dividend for the security, if any, for the
period.</p>
</dd>
<dt>distribution</dt>
<dd>
<p>Distribution (e.g., spin-off) for the security, if
any, for the period.</p>
</dd>
<dt>investable</dt>
<dd>
<p>Logical indicating whether the security is part of
the investable universe. The value of the flag is set to TRUE if the
security has not been delisted and satisfies the universe criterion
provided (if any) in the <code>simulator/universe</code> configuration
option.</p>
</dd>
<dt>delisting</dt>
<dd>
<p>Logical indicating whether a position in the
security was removed due to delisting. If delisting is set to TRUE,
the gross_pnl and net_pnl columns will contain the P&amp;L
due to delisting, if any. P&amp;L due to delisting is calculated as the
delisting return times the <code>start_nmv</code> of the position.</p>
</dd>
<dt>position_pnl</dt>
<dd>
<p>Position P&amp;L, calculated as shares * (end_price +
dividend + distribution - start_price)</p>
</dd>
<dt>trading_pnl</dt>
<dd>
<p>The difference between the market value of
trades at the benchmark price and at the end price. Note: currently
assuming benchmark price is the closing price, so trading P&amp;L is
zero.</p>
</dd>
<dt>trade_costs</dt>
<dd>
<p>Trade costs, calculated as a fixed percentage (set
in the simulation configuration) of the notional of the market trade
(valued at the close).</p>
</dd>
<dt>financing_costs</dt>
<dd>
<p>Financing cost for the position, calculated as
a fixed percentage (set in the simulation configuration) of the
notional of the starting value of the portfolio's external positions.
External positions are positions held on the street and are recorded
in the ext_shares column.</p>
</dd>
<dt>gross_pnl</dt>
<dd>
<p>Gross P&amp;L, calculated as position_pnl + trading_pnl.</p>
</dd>
<dt>net_pnl</dt>
<dd>
<p>Net P&amp;L, calculated as gross_pnl - trade_costs -
financing_costs.</p>
</dd>
<dt>market_order_nmv</dt>
<dd>
<p>Net market value of the order that does not
net down with orders in other strategies.</p>
</dd>
<dt>market_fill_gmv</dt>
<dd>
<p>Gross market value of the order that does not
net down with orders in other strategies.</p>
</dd>
<dt>market_fill_nmv</dt>
<dd>
<p>Net market value of the fill that does not net
down with orders in other strategies.</p>
</dd>
<dt>market_fill_gmv</dt>
<dd>
<p>Gross market value of the fill that does not
net down with orders in other strategies.</p>
</dd>
<dt>transfer_fill_nmv</dt>
<dd>
<p>Net market value of the fill that nets down
with fills in other strategies.</p>
</dd>
<dt>transfer_fill_gmv</dt>
<dd>
<p>Gross market value of the fill that nets down
with fills in other strategies.</p>
</dd>
<dt>start_nmv</dt>
<dd>
<p>Net market value of the position at the start of the
period.</p>
</dd>
<dt>end_nmv</dt>
<dd>
<p>Net market value of the position at the end of the
period.</p>
</dd>
<dt>end_gmv</dt>
<dd>
<p>Gross market value of the position at the end of the
period.</p>
</dd>
</dl>
<hr>
<a id="method-getPositionSummary"></a>



<h4>Method <code>getPositionSummary()</code>
</h4>

<p>Get summary information by security. This method can be
used, for example, to calculate the biggest winners and losers over the
course of the simulation.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getPositionSummary(strategy_name = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 that specifies the
strategy for which to get detail data. If <code>NULL</code> data for all
strategies is returned. Defaults to <code>NULL</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains summary
information aggregated by security. The data frame contains the
following columns:
</p>

<dl>
<dt>id</dt>
<dd>
<p>Security identifier.</p>
</dd>
<dt>strategy</dt>
<dd>
<p>Strategy name, or 'joint' for the aggregate
strategy.</p>
</dd>
<dt>gross_pnl</dt>
<dd>
<p>Gross P&amp;L for the position over the entire
simulation.</p>
</dd>
<dt>gross_pnl</dt>
<dd>
<p>Net P&amp;L for the position over the entire
simulation.</p>
</dd>
<dt>average_market_value</dt>
<dd>
<p>Average net market value of the
position over days in the simulation where the position was not
flat.</p>
</dd>
<dt>total_trading</dt>
<dd>
<p>Total gross market value of trades for the
security.</p>
</dd>
<dt>trade_costs</dt>
<dd>
<p>Total cost of trades for the security over the
entire simulation.</p>
</dd>
<dt>trade_costs</dt>
<dd>
<p>Total cost of financing for the position over the
entire simulation.</p>
</dd>
<dt>days_in_portfolio</dt>
<dd>
<p>Total number of days there was a position in
the security in the portfolio over the entire simulation.</p>
</dd>
</dl>
<hr>
<a id="method-getInputStats"></a>



<h4>Method <code>getInputStats()</code>
</h4>

<p>Get input statistics.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getInputStats()</pre></div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains statistics on
select columns of input data. Statistics are tracked for the columns
listed in the configuration variable
<code>simulator/input_data/track_metadata</code>. The data frame contains the
following columns:
</p>

<dl>
<dt>period</dt>
<dd>
<p>Period to which statistics pertain.</p>
</dd>
<dt>input_rows</dt>
<dd>
<p>Total number of rows of input data, including
rows carried forward from the previous period.</p>
</dd>
<dt>cf_rows</dt>
<dd>
<p>Total number of rows carried forward from the previous
period.</p>
</dd>
<dt>num_na_<em>column</em>
</dt>
<dd>
<p>Number of NA values in <em>column</em>.  This
measure appears for each element of <code>track_metadata</code>.</p>
</dd>
<dt>cor_<em>column</em>
</dt>
<dd>
<p>Period-over-period correlation for <em>column</em>.
This measure appears for each element of <code>track_metadata</code>.</p>
</dd>
</dl>
<hr>
<a id="method-getLooseningInfo"></a>



<h4>Method <code>getLooseningInfo()</code>
</h4>

<p>Get loosening information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getLooseningInfo()</pre></div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains, for each
period, which constraints were loosened in order to solve the portfolio
optimization problem, if any. The data frame contains the
following columns:
</p>

<dl>
<dt>date</dt>
<dd>
<p>Date for which the constraint was loosened.</p>
</dd>
<dt>constraint_name</dt>
<dd>
<p>Name of the constraint that was loosened.</p>
</dd>
<dt>pct_loosened</dt>
<dd>
<p>Percentage by which the constraint was loosened,
where 100 means loosened fully (i.e., the constraint is effectively
removed).</p>
</dd>
</dl>
<hr>
<a id="method-getOptimizationSummary"></a>



<h4>Method <code>getOptimizationSummary()</code>
</h4>

<p>Get optimization summary information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getOptimizationSummary()</pre></div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains optimization
summary information, such as starting and ending factor constraint
values, at the strategy and joint level. The data frame contains the
following columns:
</p>

<dl>
<dt>strategy</dt>
<dd>
<p>Strategy name, or 'joint' for the aggregate strategy.</p>
</dd>
<dt>sim_date</dt>
<dd>
<p>Date to which the data pertains.</p>
</dd>
<dt>order_gmv</dt>
<dd>
<p>Total gross market value of orders generated by the
optimization.</p>
</dd>
<dt>start_smv</dt>
<dd>
<p>Total net market value of short positions at the
start of the optimization.</p>
</dd>
<dt>start_lmv</dt>
<dd>
<p>Total net market value of long positions at the
start of the optimization.</p>
</dd>
<dt>end_smv</dt>
<dd>
<p>Total net market value of short positions at the end
of the optimization.</p>
</dd>
<dt>end_lmv</dt>
<dd>
<p>Total net market value of long positions at the end of
the optimization.</p>
</dd>
<dt>start_<em>factor</em>
</dt>
<dd>
<p>Total net exposure to <em>factor</em> at the
start of the optimization, for each factor constraint.</p>
</dd>
<dt>end_<em>factor</em>
</dt>
<dd>
<p>Total net exposure to <em>factor</em> at the
start of the optimization, for each factor constraint.</p>
</dd>
</dl>
<hr>
<a id="method-getExposures"></a>



<h4>Method <code>getExposures()</code>
</h4>

<p>Get end-of-period exposure information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getExposures(type = "net")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>type</code></dt>
<dd>
<p>Vector of length 1 that may be one of <code>"net"</code>,
<code>"long"</code>, <code>"short"</code>, and <code>"gross"</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains end-of-period
exposure information for the simulation portfolio. The units of the
exposures are portfolio weight relative to strategy_captial (i.e., net
market value of exposure divided by strategy capital). The data frame
contains the following columns:
</p>

<dl>
<dt>strategy</dt>
<dd>
<p>Strategy name, or 'joint' for the aggregate strategy.</p>
</dd>
<dt>sim_date</dt>
<dd>
<p>Date of the exposure data.</p>
</dd>
<dt>
<em>category</em>_<em>level</em>
</dt>
<dd>
<p>Exposure to <em>level</em>
within <em>category</em>, for all levels of all category constraints, at the end
of the period.</p>
</dd>
<dt><em>factor</em></dt>
<dd>
<p>Exposure to <em>factor</em>, for all factor
constraints, at the end of the period.</p>
</dd>
</dl>
<hr>
<a id="method-getDelistings"></a>



<h4>Method <code>getDelistings()</code>
</h4>

<p>Get information on positions removed due to delisting.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getDelistings()</pre></div>



<h5>Returns</h5>

<p>An object of class <code>data.frame</code> that contains a row for each
position that is removed from the simulation portfolio due to a
delisting. Each row contains the size of the position on the day on
which it was removed from the portfolio.
</p>


<hr>
<a id="method-getSingleStrategySummaryDf"></a>



<h4>Method <code>getSingleStrategySummaryDf()</code>
</h4>

<p>Get summary information for a single strategy suitable for
plotting input.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getSingleStrategySummaryDf(
  strategy_name = "joint",
  include_zero_row = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Strategy for which to return summary data.</p>
</dd>
<dt><code>include_zero_row</code></dt>
<dd>
<p>Logical flag indicatiing whether to prepend a row
to the summary data with starting values at zero. Defaults to <code>TRUE</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A data frame that contains summary information for the desired
strategy, as well as columns for cumulative net and gross total return,
calculated as pnl divided by ending gross market value.
</p>


<hr>
<a id="method-plotPerformance"></a>



<h4>Method <code>plotPerformance()</code>
</h4>

<p>Draw a plot of cumulative gross and net return by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotPerformance(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotContribution"></a>



<h4>Method <code>plotContribution()</code>
</h4>

<p>Draw a plot of contribution to net return on GMV for levels
of a specified category.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotContribution(category_var, strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>category_var</code></dt>
<dd>
<p>Plot performance contribution for the levels of
<code>category_var</code>. <code>category_var</code> must be present in the
simulation's security reference, and detail data must be present in the
object's result data.</p>
</dd>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotMarketValue"></a>



<h4>Method <code>plotMarketValue()</code>
</h4>

<p>Draw a plot of total gross, long, short, and net market
value by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotMarketValue(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotCategoryExposure"></a>



<h4>Method <code>plotCategoryExposure()</code>
</h4>

<p>Draw a plot of exposure to all levels in a category by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotCategoryExposure(in_var, strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>in_var</code></dt>
<dd>
<p>Category for which exposures are plotted. In order to plot
exposures for category <code>in_var</code>, we must have run the simulation
with <code>in_var</code> in the config setting
<code>simulator/calculate_exposures/category_vars</code>.</p>
</dd>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotFactorExposure"></a>



<h4>Method <code>plotFactorExposure()</code>
</h4>

<p>Draw a plot of exposure to factors by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotFactorExposure(in_var, strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>in_var</code></dt>
<dd>
<p>Factors for which exposures are plotted.</p>
</dd>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotNumPositions"></a>



<h4>Method <code>plotNumPositions()</code>
</h4>

<p>Draw a plot of number of long and short positions by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotNumPositions(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotTurnover"></a>



<h4>Method <code>plotTurnover()</code>
</h4>

<p>Draw a plot of number of long and short positions by date.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotTurnover(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotUniverseSize"></a>



<h4>Method <code>plotUniverseSize()</code>
</h4>

<p>Draw a plot of the universe size, or number of investable
stocks, over time.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotUniverseSize(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>joint</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotNonInvestablePct"></a>



<h4>Method <code>plotNonInvestablePct()</code>
</h4>

<p>Draw a plot of the percentage of portfolio GMV held in
non-investable stocks (e.g., stocks that do not satisfy universe criteria)
for a given strategy. Note that this plot requires detail data.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$plotNonInvestablePct(strategy_name = "joint")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>strategy_name</code></dt>
<dd>
<p>Character vector of length 1 specifying the strategy
for the plot. Defaults to <code>"joint"</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-overallStatsDf"></a>



<h4>Method <code>overallStatsDf()</code>
</h4>

<p>Calculate overall simulation summary statistics, such as
total P&amp;L, Sharpe, average market values and counts, etc.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$overallStatsDf()</pre></div>



<h5>Returns</h5>

<p>A data frame that contains summary statistics, suitable for
reporting.
</p>


<hr>
<a id="method-overallReturnsByMonthDf"></a>



<h4>Method <code>overallReturnsByMonthDf()</code>
</h4>

<p>Calculate return for each month and summary statistics for
each year, such as total return and annualized Sharpe. Return in data
frame format suitable for reporting.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$overallReturnsByMonthDf()</pre></div>



<h5>Returns</h5>

<p>The data frame contains one row for each calendar year in the
simulation, and up to seventeen columns: one column for year, one
column for each calendar month, and columns for the year's total
return, annualized return, annualized volatility, and annualized
Sharpe. Total return is the sum of daily net returns. Annualized return
is the mean net return times 252. Annualized volatility is the standard
deviation of net return times the square root of 252. Annualized Sharpe
is the ratio of annualized return to annualized volatility. All returns
are in percent.
</p>


<hr>
<a id="method-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print overall simulation statistics.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$print()</pre></div>


<hr>
<a id="method-writeFeather"></a>



<h4>Method <code>writeFeather()</code>
</h4>

<p>Write the data in the object to feather files.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$writeFeather(out_loc)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>out_loc</code></dt>
<dd>
<p>Directory in which output files should be created.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>No return value, called for side effects.
</p>


<hr>
<a id="method-readFeather"></a>



<h4>Method <code>readFeather()</code>
</h4>

<p>Load files created with <code>writeFeather</code> into the object.
Note that because detail data is not re-split by period, it will not be
possible to use the <code>sim_date</code> parameter when calling
<code>getSimDetail</code> on the populated object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$readFeather(in_loc)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>in_loc</code></dt>
<dd>
<p>Directory that contains files to be loaded.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>No return value, called for side effects.
</p>


<hr>
<a id="method-getConfig"></a>



<h4>Method <code>getConfig()</code>
</h4>

<p>Get the object's configuration information.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$getConfig()</pre></div>



<h5>Returns</h5>

<p>Object of class <code>list</code> that contains the simulation's
configuration information.
</p>


<hr>
<a id="method-writeReport"></a>



<h4>Method <code>writeReport()</code>
</h4>

<p>Write an html document of simulation results.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$writeReport(
  out_dir,
  out_file,
  out_fmt = "html",
  contrib_vars = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>out_dir</code></dt>
<dd>
<p>Directory in which output files should be created</p>
</dd>
<dt><code>out_file</code></dt>
<dd>
<p>File name for output</p>
</dd>
<dt><code>out_fmt</code></dt>
<dd>
<p>Format in which output files should be created. The
default is html and that is currently the only option.</p>
</dd>
<dt><code>contrib_vars</code></dt>
<dd>
<p>Security reference variables for which to plot return
contribution.</p>
</dd>
<dt><code>res</code></dt>
<dd>
<p>The object of class 'Simulation' which we want to write the
report about.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Simulation$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




</div>