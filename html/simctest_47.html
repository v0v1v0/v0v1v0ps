<div class="container">

<table style="width: 100%;"><tr>
<td>mctest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential implementation of Monte Carlo
tests with p-valube buckets</h2>

<h3>Description</h3>

<p>Sequential implementation
of the Monte Carlo test with p-value buckets.
</p>
<p>Implementation of the Robbins-Lai (mctest.RL) and SIMCTEST (mctest.simctest) approaches to compute a decision interval (and decision) with respect to several thresholds/ p-value buckets.
The function "mctest" is a wrapper function for both the Robbins-Lai and the SIMCTEST approach which calls one of the two using an additional parameter "method" (method="simctest" for SIMCTEST and method="RL" for Robbins-Lai).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mctest(gen,J=Jstar,epsilon=0.001,batch=10,batchincrement=1.1,maxbatch=100,
  method=c("simctest","RL"))
mctest.RL(gen,J=Jstar,epsilon=0.001,batch=10,batchincrement=1.1,maxbatch=100)
mctest.simctest(gen,J=Jstar,epsilon=0.001,batch=10,batchincrement=1.1,maxbatch=100)
J
Jstar
## S3 method for class 'mctestres'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>function that performs one sampling step. 
Returns 0 (sampled test statistic does not exceed the observation)
or 1 (sampled test static exceeds the observation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>which method to use for stopping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>p-value buckets to use. A matrix with two rows, each column
describes an interval bucket. Column names give the code for the
interval bucket. Defaults to Jstar.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>error bound</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>
<p>initial number of samples to use before checking for stopping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batchincrement</code></td>
<td>
<p>factor by which the batch size gets multiplied
after each step. 1 would mean no increment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxbatch</code></td>
<td>
<p>maximum batch size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of type "mctestres"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>mctest</code>, <code>mctest.RL</code> and <code>mctest.simctest</code> all
return an object of class type  <code>mctestres</code>, which has a print
function (<code>print.mctestres</code>).
</p>
<p>An object of class <code>mctestres</code> is a list with  the
following components: <code>step</code> (total batched number of samples drawn), <code>decision.interval</code> (interval for the p-value), <code>decision</code> (expressing significance), <code>est.p</code> (an estimate of the p-value) and <code>realn</code> (the actual number of samples taken without batching).
</p>


<h3>References</h3>

<p>Ding, D., Gandy, A. and Hahn, G. (2019) Implementing Monte Carlo Tests
with P-value Buckets. To appear in Scandinavian Journal of
Statistics. arXiv:1703.09305 [stat.ME].
</p>


<h3>Examples</h3>

<pre><code class="language-R">  #Example used in the above paper
  dat &lt;- matrix(nrow=5,ncol=7,byrow=TRUE,
                c(1,2,2,1,1,0,1, 2,0,0,2,3,0,0, 0,1,1,1,2,7,3, 1,1,2,0,0,0,1, 0,1,1,1,1,0,0))
  loglikrat &lt;- function(data){
    cs &lt;- colSums(data)
    rs &lt;- rowSums(data)
    mu &lt;- outer(rs,cs)/sum(rs)
    2*sum(ifelse(data&lt;=0.5, 0,data*log(data/mu)))
  }
  resample &lt;- function(data){
    cs &lt;- colSums(data)
    rs &lt;- rowSums(data)
    n &lt;- sum(rs)
    mu &lt;- outer(rs,cs)/n/n
    matrix(rmultinom(1,n,c(mu)),nrow=dim(data)[1],ncol=dim(data)[2])
  }
  t &lt;- loglikrat(dat);

  # function to generate samples
  gen &lt;- function(){loglikrat(resample(dat))&gt;=t}

  #using simctest
  mctest(gen)
  mctest.simctest(gen)
  mctest.RL(gen)
</code></pre>


</div>