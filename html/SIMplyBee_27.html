<div class="container">

<table style="width: 100%;"><tr>
<td>calcSelectionCriterion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the selection criterion</h2>

<h3>Description</h3>

<p>Level 0 function that calculates the selection criterion as the
sum of workers (direct) and queen (maternal) effects of workers,
as defined by Du et al. (2021). This can be seen as the expected value
of virgin queens from the queen (as well as workers, but we would not be
selecting workers).
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcSelectionCriterion(
  x,
  queenTrait = 1,
  queenTraitFUN = sum,
  workersTrait = 2,
  workersTraitFUN = sum,
  use = "gv",
  simParamBee = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>Colony-class</code> or <code>MultiColony-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queenTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents queen's effect on the colony value; if <code>NULL</code> then this contribution is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queenTraitFUN</code></td>
<td>
<p>function, that will be applied to the queen effect
values of workers, default is sum (see examples), but note that the correct
function will depend on how you will setup simulation!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workersTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents workers' effect on the colony value; if <code>NULL</code> then this contribution is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workersTraitFUN</code></td>
<td>
<p>function, that will be applied to the workers effect
values of workers, default is sum (see examples), but note that the correct
function will depend on how you will setup simulation!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>character, the measure to use for the calculation, being
either "gv" (genetic value), "ebv" (estimated breeding value),
or "pheno" (phenotypic value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParamBee</code></td>
<td>
<p><code>SimParamBee</code>, global simulation parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>integer when <code>x</code> is
<code>Colony-class</code> and a named list when <code>x</code> is
<code>MultiColony-class</code>, where names are colony IDs
</p>


<h3>References</h3>

<p>Du, M., et al. (2021) Short-term effects of controlled mating and selection
on the genetic variance of honeybee populations. Heredity 126, 733â€“747.
<a href="https://doi.org/10.1038/s41437-021-00411-2">doi:10.1038/s41437-021-00411-2</a>
</p>


<h3>See Also</h3>

<p><code>calcInheritanceCriterion</code> and
<code>calcPerformanceCriterion</code> and  as well as
</p>


<h3>Examples</h3>

<pre><code class="language-R">founderGenomes &lt;- quickHaplo(nInd = 8, nChr = 1, segSites = 100)
SP &lt;- SimParamBee$new(founderGenomes)

meanA &lt;- c(10, 10 / SP$nWorkers)
varA &lt;- c(1, 1 / SP$nWorkers)
corA &lt;- matrix(data = c( 1.0, -0.5,
                        -0.5,  1.0), nrow = 2, byrow = TRUE)
SP$addTraitA(nQtlPerChr = 100, mean = meanA, var = varA, corA = corA,
name = c("queenTrait", "workersTrait"))
varE &lt;- c(3, 3 / SP$nWorkers)
corE &lt;- matrix(data = c(1.0, 0.3,
                        0.3, 1.0), nrow = 2, byrow = TRUE)
SP$setVarE(varE = varE, corE = corE)
basePop &lt;- createVirginQueens(founderGenomes)

drones &lt;- createDrones(x = basePop[1], nInd = 1000)
droneGroups &lt;- pullDroneGroupsFromDCA(drones, n = 10, nDrones = nFathersPoisson)

# Create a Colony and a MultiColony class
colony &lt;- createColony(x = basePop[2])
colony &lt;- cross(colony, drones = droneGroups[[1]])
colony &lt;- buildUp(colony)

apiary &lt;- createMultiColony(basePop[3:4], n = 2)
apiary &lt;- cross(apiary, drones = droneGroups[c(2, 3)])
apiary &lt;- buildUp(apiary)

calcSelectionCriterion(colony,
                       queenTrait = 1, queenTraitFUN = sum,
                       workersTrait = 2, workersTraitFUN = sum)
calcSelectionCriterion(apiary,
                       queenTrait = 1, queenTraitFUN = sum,
                       workersTrait = 2, workersTraitFUN = sum)

apiary[[2]] &lt;- removeQueen(apiary[[2]])
calcSelectionCriterion(apiary, queenTrait = 1,
                       workersTrait = 2, workersTraitFUN = sum)

</code></pre>


</div>