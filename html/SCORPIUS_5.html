<div class="container">

<table style="width: 100%;"><tr>
<td>draw_trajectory_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw time-series heatmap</h2>

<h3>Description</h3>

<p><code>draw_trajectory_heatmap</code> draws a heatmap in which the samples
are ranked according their position in an inferred trajectory. In addition, the progression groups and
feature modules can be passed along to further enhance the visualisation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_trajectory_heatmap(
  x,
  time,
  progression_group = NULL,
  modules = NULL,
  show_labels_row = FALSE,
  show_labels_col = FALSE,
  scale_features = TRUE,
  progression_group_palette = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric matrix or a data frame with one row per sample and one column per feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A numeric vector containing the inferred time points of each sample along a trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progression_group</code></td>
<td>
<p><code>NULL</code> or a vector (or factor) containing the groupings of the samples (default <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p><code>NULL</code> or a data frame as returned by <code>extract_modules</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_labels_row</code></td>
<td>
<p><code>TRUE</code> if the labels of the rows are to be plotted (default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_labels_col</code></td>
<td>
<p><code>TRUE</code> if the labels of the cols are to be plotted (default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_features</code></td>
<td>
<p><code>TRUE</code> if the values of each feature is to be scaled (default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progression_group_palette</code></td>
<td>
<p>A named vector palette for the progression group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to <code>pheatmap</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output of the <code>pheatmap</code> function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Generate a dataset
dataset &lt;- generate_dataset(num_genes=500, num_samples=300, num_groups=4)
expression &lt;- dataset$expression
space &lt;- reduce_dimensionality(expression, ndim=2)
groups &lt;- dataset$sample_info$group_name
traj &lt;- infer_trajectory(space)
time &lt;- traj$time

gimp &lt;- gene_importances(expression, traj$time, num_permutations = 0, ntree = 10000)
gene_sel &lt;- gimp[1:50,]
expr_sel &lt;- expression[,gene_sel$gene]

## Draw a time series heatmap
draw_trajectory_heatmap(expr_sel, time)

## Also show the progression groupings
draw_trajectory_heatmap(expr_sel, time, progression_group=groups)

## Use a different palette
draw_trajectory_heatmap(
  expr_sel, time, progression_group=groups,
  progression_group_palette = setNames(RColorBrewer::brewer.pal(4, "Set2"), paste0("Group ", 1:4))
)

## Group the genes into modules and visualise the modules in a heatmap
modules &lt;- extract_modules(scale_quantile(expr_sel))
draw_trajectory_heatmap(expr_sel, time, progression_group=groups, modules=modules)

</code></pre>


</div>