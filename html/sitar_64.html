<div class="container">

<table style="width: 100%;"><tr>
<td>xyadj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust x and y variables for SITAR random effects</h2>

<h3>Description</h3>

<p><code>xyadj</code> Adjusts <code>x</code> and <code>y</code> and optionally <code>v</code> values for subject-specific
random effects from a SITAR model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xyadj(object, x, y = 0, v = 0, id, abc = NULL, tomean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a SITAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of x coordinates. If missing, <code>x</code> and
<code>y</code> and <code>id</code> are obtained from <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of y coordinates (default 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>a vector of velocity coordinates (default 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a factor denoting the subject levels corresponding to <code>x</code> and
<code>y</code> and <code>v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abc</code></td>
<td>
<p>a data frame containing random effects for a, b, c and d (default
<code>ranef(object)[id, ]</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tomean</code></td>
<td>
<p>a logical defining the direction of adjustment. TRUE (default)
indicates that individual curves are translated and rotated to match the
mean curve, while FALSE indicates the reverse, the mean curve being
translated and rotated to match individual curves.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>tomean = TRUE</code> the x and y and v values are adjusted to
</p>
<p style="text-align: center;"><code class="reqn">(x - xoffset - b&lt;fixed&gt; - b&lt;random&gt;) * exp(c&lt;random&gt;) + xoffset + b&lt;fixed&gt;</code>
</p>

<p style="text-align: center;"><code class="reqn">y - a&lt;random&gt; - d&lt;random&gt; * x</code>
</p>

<p style="text-align: center;"><code class="reqn">(v - d&lt;random&gt;) / exp(c&lt;random&gt;)</code>
</p>

<p>When <code>tomean = FALSE</code> they are adjusted to
</p>
<p style="text-align: center;"><code class="reqn">(x - xoffset - b&lt;fixed&gt;) / exp(c&lt;random&gt;) + xoffset + b&lt;fixed&gt; + b&lt;random&gt;</code>
</p>

<p style="text-align: center;"><code class="reqn">y + a&lt;random&gt; + d&lt;random&gt; * x</code>
</p>

<p style="text-align: center;"><code class="reqn">v * exp(c&lt;random&gt;) + d&lt;random&gt;</code>
</p>

<p>In each case missing values of the fixed or random effects are
set to zero.
</p>


<h3>Value</h3>

<p>The list of adjusted values: </p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector the same length as x, or NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>numeric vector the same length as x, or NULL.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(heights)
## fit sitar model for height
m1 &lt;- sitar(x = age, y = height, id = id, data = heights, df = 5)

## plot unadjusted data as growth curves
plot(m1, opt='u')

## overplot with adjusted data as points
with(heights, points(xyadj(m1), col='red', pch = 19))

</code></pre>


</div>