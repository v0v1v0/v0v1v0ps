<div class="container">

<table style="width: 100%;"><tr>
<td>runFastPhase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an HMM to genetic data using fastPHASE</h2>

<h3>Description</h3>

<p>This function provides a wrapper for the fastPHASE executable in order to fit an HMM to either
unphased genotype data or phased haplotype data.
The software fastPHASE will fit the HMM  to the genotype data and write the
corresponding parameter estimates in four separate files.
Since fastPHASE is not an R package, this executable must be downloaded separately by the
user. Visit <a href="http://scheet.org/software.html">http://scheet.org/software.html</a> for more information on how to obtain fastPHASE.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runFastPhase(fp_path, X_file, out_path = NULL, K = 12, numit = 25,
  phased = FALSE, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fp_path</code></td>
<td>
<p>a string with the path to the directory with the fastPHASE executable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_file</code></td>
<td>
<p>a string with the path of the genotype input file containing X in fastPHASE
format (as created by writeXtoInp).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_path</code></td>
<td>
<p>a string with the path of the directory in which the parameter estimates
will be saved (default: NULL). If this is equal to NULL, a temporary file
in the R temporary directory will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of hidden states for each haplotype sequence (default: 12).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numit</code></td>
<td>
<p>the number of EM iterations (default: 25).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phased</code></td>
<td>
<p>whether the data are already phased (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed for the EM algorithm (default: 1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The software fastPHASE saves the parameter estimates in four separate files whose names
begin with the string contained in 'out_path' and end with:
</p>

<ul>
<li>
<p>"_rhat.txt"
</p>
</li>
<li>
<p>"_alphahat.txt"
</p>
</li>
<li>
<p>"_thetahat.txt"
</p>
</li>
<li>
<p>"_origchars"
</p>
</li>
</ul>
<p>The HMM for the genotype data can then be loaded from these files by calling
loadHMM.
</p>


<h3>Value</h3>

<p>A string containing the path of the directory in which the parameter estimates
were saved. This is useful to find the data when the default option for 'out_path'
is used and the output is written in an R temporary directory.
</p>


<h3>References</h3>

<p>Scheet P, Stephens M (2006).
“A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase.”
<em>Am. J. Hum. Genet.</em>, <b>78</b>, 629–644.
doi: <a href="http://doi.org/10.1086/502802">10.1086/502802</a>.
</p>


<h3>See Also</h3>

<p>Other fastPHASE: <code>loadHMM</code>,
<code>writeXtoInp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fp_path  = "~/bin/fastPHASE" # Path to the fastPHASE executable

# Run fastPHASE on unphased genotypes
# Specify the path to the genotype input file in ".inp" format.
# An example file containing unphased genotypes can be found in the package installation folder.
X_file = system.file("extdata", "genotypes.inp", package = "SNPknock")
fp_outPath = runFastPhase(fp_path, X_file)

# Run fastPHASE on phased haplotypes
# An example file containing phased haplotypes can be found in the package installation folder.
H_file = system.file("extdata", "haplotypes.inp", package = "SNPknock")
fp_outPath = runFastPhase(fp_path, H_file, phased=TRUE)

</code></pre>


</div>