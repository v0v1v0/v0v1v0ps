<div class="container">

<table style="width: 100%;"><tr>
<td>DearBegg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the nonparametric weight function from Dear and Begg (1992)</h2>

<h3>Description</h3>

<p>In Dear and Begg (1992) it was proposed to nonparametrically estimate via maximum likelihood the weight function <code class="reqn">w</code> in a selection model via
pooling <code class="reqn">p</code>-values in groups of 2 and assuming a piecewise constant <code class="reqn">w</code>. The function <code>DearBegg</code> implements estimation of <code class="reqn">w</code> via 
a coordinate-wise Newton-Raphson algorithm as described in Dear and Begg (1992). In addition, the function <code>DearBeggMonotone</code> enables computation of the 
weight function in the same model under the constraint that it is non-increasing, see Rufibach (2011). To this end we use the differential evolution algorithm
described in Ardia et al (2010a, b) and implemented in Mullen et al (2009).
The functions <code>Hij</code>, <code>DearBeggLoglik</code>, and <code>DearBeggToMinimize</code> are not intended to be called by the user.</p>


<h3>Usage</h3>

<pre><code class="language-R">DearBegg(y, u, lam = 2, tolerance = 10^-10, maxiter = 1000, 
    trace = TRUE)
DearBeggMonotone(y, u, lam = 2, maxiter = 1000, CR = 0.9, 
    NP = NA, trace = TRUE)
Hij(theta, sigma, y, u, teststat)
DearBeggLoglik(w, theta, sigma, y, u, hij, lam)
DearBeggToMinimize(vec, y, u, lam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Associated standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>Weight of the first entry of <code class="reqn">w</code> in the likelihood function. Dear and Begg (1992) recommend to use <code>lam = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Stopping criterion for Newton-Raphson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximal number of iterations for Newton-Raphson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If <code>TRUE</code>, progress of the algorithm is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR</code></td>
<td>
<p>Parameter that is given to <code>DEoptim</code>. See the help file of the function <code>DEoptim.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NP</code></td>
<td>
<p>Parameter that is given to <code>DEoptim</code>. See the help file of the function <code>DEoptim.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Weight function, parametrized as vector of length <code class="reqn">1 + \lfloor(n / 2)\rfloor</code> where <code class="reqn">n</code> is the number of studies, i.e. the length of <code class="reqn">y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Effect size estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Random effects variance component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hij</code></td>
<td>
<p>Integral of density over a constant piece of <code class="reqn">w</code>. See Rufibach (2011, Appendix) for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>Vector of parameters over which we maximize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>teststat</code></td>
<td>
<p>Vector of test statistics, equals <code class="reqn">|y| / u</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list consisting of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Vector of estimated weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Estimate of the combined effect in the Dear and Begg model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Estimate of the random effects component variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p><code class="reqn">p</code>-values computed from the inputed test statistics, ordered in decreasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Effect sizes, ordered in decreasing order of <code class="reqn">p</code>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Standard errors, ordered in decreasing order of <code class="reqn">p</code>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at the maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DEoptim.res</code></td>
<td>
<p>Only available in <code>DearBeggMonotone</code>. Provides the object that is outputted by <code>DEoptim</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Ardia, D., Boudt, K., Carl, P., Mullen, K.M., Peterson, B.G. (2010).
Differential Evolution ('DEoptim') for Non-Convex Portfolio Optimization. 
</p>
<p>Ardia, D., Mullen, K.M., et.al. (2010). The 'DEoptim' Package:
Differential Evolution Optimization in 'R'. Version 2.0-7.
</p>
<p>Dear, K.B.G. and Begg, C.B. (1992).
An Approach for Assessing Publication Bias Prior to Performing a Meta-Analysis.
<em>Statist. Sci.</em>, <b>7(2)</b>, 237–245.
</p>
<p>Mullen, K.M., Ardia, D., Gil, D.L., Windover, D., Cline, J. (2009).
'DEoptim': An 'R' Package for Global Optimization by Differential Evolution. 
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689–704. 
</p>


<h3>See Also</h3>

<p><code>IyenGreen</code> for a parametric selection model.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##------------------------------------------
## Analysis of Hedges &amp; Olkin dataset
## re-analyzed in Iyengar &amp; Greenhouse, Dear &amp; Begg
##------------------------------------------
data(education)
t  &lt;- education$t
q  &lt;- education$q
N  &lt;- education$N
y  &lt;- education$theta 
u  &lt;- sqrt(2 / N)
n  &lt;- length(y)
k  &lt;- 1 + floor(n / 2)
lam1 &lt;- 2

## compute p-values
p &lt;- 2 * pnorm(-abs(t))


##------------------------------------------
## compute all weight functions available
## in this package
##------------------------------------------

## weight functions from Iyengar &amp; Greenhouse (1988)
res1 &lt;- IyenGreenMLE(t, q, N, type = 1)
res2 &lt;- IyenGreenMLE(t, q, N, type = 2)

## weight function from Dear &amp; Begg (1992)
res3 &lt;- DearBegg(y, u, lam = lam1)

## monotone version of Dear &amp; Begg, as introduced in Rufibach (2011)
set.seed(1977)
res4 &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, CR = 1)

## plot
plot(0, 0, type = "n", xlim = c(0, 1), ylim = c(0, 1), xlab = "p-values", 
    ylab = "estimated weight function")
ps &lt;- seq(0, 1, by = 0.01)
rug(p, lwd = 3)
lines(ps, IyenGreenWeight(-qnorm(ps / 2), b = res1$beta, q = 50, 
    type = 1, alpha = 0.05), lwd = 3, col = 2)
lines(ps, IyenGreenWeight(-qnorm(ps / 2), b = res2$beta, q = 50, 
    type = 2, alpha = 0.05), lwd = 3, col = 4)
weightLine(p, w = res3$w, col0 = 3, lwd0 = 3, lty0 = 2)  
weightLine(p, w = res4$w, col0 = 6, lwd0 = 2, lty0 = 1)  

legend("topright", c(expression("Iyengar &amp; Greenhouse (1988) w"[1]), 
    expression("Iyengar &amp; Greenhouse (1988) w"[2]), "Dear and Begg (1992)", 
    "Rufibach (2011)"), col = c(2, 4, 3, 6), lty = c(1, 1, 2, 1), 
    lwd = c(3, 3, 3, 2), bty = "n")

## compute selection bias
eta &lt;- sqrt(res4$sigma ^ 2 + res4$u ^ 2)
bias &lt;- effectBias(res4$y, res4$u, res4$w, res4$theta, eta)
bias


##------------------------------------------
## Compute p-value to assess null hypothesis of no selection,
## as described in Rufibach (2011, Section 6)
## We use the package 'meta' to compute initial estimates for
## theta and sigma
##------------------------------------------
library(meta)

## compute null parameters
meta.edu &lt;- metagen(TE = y, seTE = u, sm = "MD", level = 0.95, 
    comb.fixed = TRUE, comb.random = TRUE)
theta0 &lt;- meta.edu$TE.random
sigma0 &lt;- meta.edu$tau

M &lt;- 1000
res &lt;- DearBeggMonotonePvalSelection(y, u, theta0, sigma0, lam = lam1, 
    M = M, maxiter = 1000)

## plot all the computed monotone functions
plot(0, 0, xlim = c(0, 1), ylim = c(0, 1), type = "n", xlab = "p-values", 
    ylab = expression(w(p)))
abline(v = 0.05, lty = 3)
for (i in 1:M){weightLine(p, w = res$res.mono[1:k, i], col0 = grey(0.8), 
    lwd0 = 1, lty0 = 1)}
rug(p, lwd = 2)
weightLine(p, w = res$mono0, col0 = 2, lwd0 = 1, lty0 = 1)  


## =======================================================================


##------------------------------------------
## Analysis second-hand tobacco smoke dataset
## Rothstein et al (2005), Publication Bias in Meta-Analysis, Appendix A
##------------------------------------------
data(passive_smoking)
u &lt;- passive_smoking$selnRR
y &lt;- passive_smoking$lnRR
n &lt;- length(y)
k &lt;- 1 + floor(n / 2)
lam1 &lt;- 2

res2 &lt;- DearBegg(y, u, lam = lam1)
set.seed(1)
res3 &lt;- DearBeggMonotone(y = y, u = u, lam = lam1, maxiter = 2000, CR = 1)

plot(0, 0, type = "n", xlim = c(0, 1), ylim = c(0, 1), pch = 19, col = 1, 
    xlab = "p-values", ylab = "estimated weight function")
weightLine(rev(sort(res2$p)), w = res2$w, col0 = 2, lwd0 = 3, lty0 = 2)  
weightLine(rev(sort(res3$p)), w = res3$w, col0 = 4, lwd0 = 2, lty0 = 1)  

legend("bottomright", c("Dear and Begg (1992)", "Rufibach (2011)"), col = 
    c(2, 4), lty = c(2, 1), lwd = c(3, 2), bty = "n")
    
## compute selection bias
eta &lt;- sqrt(res3$sigma ^ 2 + res3$u ^ 2)
bias &lt;- effectBias(res3$y, res3$u, res3$w, res3$theta, eta)
bias  


##------------------------------------------
## Compute p-value to assess null hypothesis of no selection
##------------------------------------------
## compute null parameters
meta.toba &lt;- metagen(TE = y, seTE = u, sm = "MD", level = 0.95, 
    comb.fixed = TRUE, comb.random = TRUE)
theta0 &lt;- meta.toba$TE.random
sigma0 &lt;- meta.toba$tau

M &lt;- 1000
res &lt;- DearBeggMonotonePvalSelection(y, u, theta0, sigma0, lam = lam1, 
    M = M, maxiter = 2000)

## plot all the computed monotone functions
plot(0, 0, xlim = c(0, 1), ylim = c(0, 1), type = "n", xlab = "p-values", 
    ylab = expression(w(p)))
abline(v = 0.05, lty = 3)
for (i in 1:M){weightLine(p, w = res$res.mono[1:k, i], col0 = grey(0.8), 
    lwd0 = 1, lty0 = 1)}
rug(p, lwd = 2)
weightLine(p, w = res$mono0, col0 = 2, lwd0 = 1, lty0 = 1)

## End(Not run)
</code></pre>


</div>