<div class="container">

<table style="width: 100%;"><tr>
<td>Bayesian.SGoF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian SGoF multiple testing procedure</h2>

<h3>Description</h3>

<p>Performs the Bayesian SGoF method (<cite>Castro Conde and de Uña Álvarez , 2013 13/06</cite>) for multiple hypothesis testing.</p>


<h3>Usage</h3>

<pre><code class="language-R">Bayesian.SGoF(u, alpha = 0.05, gamma = 0.05, P0 = 0.5, a0 = 1, b0 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A (non-empty) numeric vector of p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value. The significance level of the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric value. The p-value threshold, so Bayesian SGoF looks for significance in the amount of p-values below gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0</code></td>
<td>
<p>The a priori probability of the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>The first parameter of the a priori beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The second parameter of the a priori beta distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bayesian SGoF (<cite>Castro Conde  and de Uña Álvarez, 2013 13/06</cite>) is an adaptation of SGoF method to the Bayesian paradigm, in which the proportion of p-values falling below <code>gamma</code> is random. This method has two main steps. First, Bayesian SGoF performs a pre-test at level <code>alpha</code> which decides if the complete null hypothesis should be rejected or not. 
This Bayesian pre-test is based on lower bounds of the a posteriori probability of H0 (computed using the  default a priori probability <code>P0</code>=.5, unless otherwise is indicated,  and a family of a priori beta distributions located at the null and indexed by a correlation factor). Second, the number of rejections is computed constructing an interval for the 'excess of significant cases', analogously to the SGoF procedure. For this, the posterior distribution of the proportion of p-values falling below <code>gamma</code> is used; this posterior distribution is calculated on the basis of the default priors  <code>a0</code>=<code>b0</code>=1, unless otherwise is indicated. Besides, the posterior probability that the complete null hypothesis is true is computed using P0, a0 and b0.
One important difference between the frequentist and the Bayesian SGoF is that the Bayesian setting induces (and hence allows for) a dependence structure among the p-values; this is very interesting for real problems where correlation is present. From a less philosophical point of view, in practice Bayesian SGoF may be more conservative than frequentist SGoF, particularly when the number of tests is small; this is due to the fact that Bayesian testing of point nulls is much more conservative than its frequentist counterpart and, therefore, the pre-test part of Bayesian SGoF may play a very important role.
Typically the choice <code>alpha</code>=<code>gamma</code> will be used for Bayesian.SGoF; this common value will be set as one of the usual significance levels (0.001, 0.01, 0.05, 0.1). Note however that <code>alpha</code> and <code>gamma</code> have different roles.
The false discovery rate is estimated by the simple method proposed by: <cite>Dalmasso , Broet , Moreau  (2005)</cite>, by taking n=1 in their formula.
</p>


<h3>Value</h3>

<p>A list containing the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Rejections </code></td>
<td>
<p>The number of effects declared by Bayesian SGoF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR </code></td>
<td>
<p>The estimated false discovery rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Posterior</code></td>
<td>
<p>The posterior probability that the complete null hypothesis is true depending on a0, b0 and P0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The amount of p-values falling below gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.alpha</code></td>
<td>
<p>Critical point at level alpha of the Bayesian pre-test for the complete null depending on P0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>The original p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>The specified significance level for the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p>The specified p-value threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0</code></td>
<td>
<p>The specified a priori probability of the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>The first  specified parameter of the a priori beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The second specified parameter of the a priori beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Irene Castro Conde and Jacobo de Uña Álvarez</p>


<h3>References</h3>

<p>Castro Conde I and de Uña Álvarez J (2013). SGoF multitesting method under the Bayesian paradigm. <em>Discussion Papers in Statistics and Operation Research</em>. Report 13/06. Statistics and OR Department. University of Vigo. 
</p>
<p>Dalmasso C, Broet P and Moreau T (2005) A simple procedure for estimating the false discovery rate. <em>Bioinformatics</em> 21:660–668
</p>


<h3>See Also</h3>

<p><code>summary.Bayesian.SGoF</code></p>


<h3>Examples</h3>

<pre><code class="language-R">

res&lt;-Bayesian.SGoF(Hedenfalk$x)
summary(res)   

</code></pre>


</div>