<div class="container">

<table style="width: 100%;"><tr>
<td>step.saemix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise procedure for joint selection of covariates and random effects</h2>

<h3>Description</h3>

<p>Joint selection of covariates and random effects in a nonlinear mixed effects model by a stepwise-type
algorithm based on two different versions of BIC for covariate selection and random effects selection
respectively. Selection is made among the covariates as such specified in the SaemixData object.
Only uncorrelated random effects structures are considered.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step.saemix(
  saemixObject,
  trace = TRUE,
  direction = "forward",
  covariate.init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>saemixObject</code></td>
<td>
<p>An object returned by the <code>saemix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If TRUE, a table summarizing the steps of the algorithm is printed. Default "TRUE"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>The mode of stepwise search, can be one of "both", "backward", or "forward",
with a default of "forward".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate.init</code></td>
<td>
<p>A matrix specifying the initial covariate structure to be considered in the algorithm.
covariate.init is only used if the direction argument is "both".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of the SaemixObject class storing the covariate model and the covariance structure of
random effects of the final model.
</p>


<h3>Author(s)</h3>

<p>Maud Delattre
</p>


<h3>References</h3>

<p>M Delattre, M Lavielle, MA Poursat (2014) A note on BIC in mixed effects models.
Electronic Journal of Statistics 8(1) p. 456-475
M Delattre, MA Poursat (2017) BIC strategies for model choice in a population approach.
(arXiv:1612.02405)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA,
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

# Definition of models to be compared
model1cpt&lt;-function(psi,id,xidep) { 
   dose&lt;-xidep[,1]
   tim&lt;-xidep[,2]  
   ka&lt;-psi[id,1]
   V&lt;-psi[id,2]
   CL&lt;-psi[id,3]
   k&lt;-CL/V
   ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
   return(ypred)
}

saemix.model1&lt;-saemixModel(model=model1cpt,modeltype="structural", 
     description="One-compartment model with first-order absorption",
     psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3,byrow=TRUE, 
     dimnames=list(NULL, c("ka","V","CL"))), transform.par=c(1,1,1),
     covariate.model=matrix(c(0,0,1,0,0,0),ncol=3,byrow=TRUE))
                          
saemix.options&lt;-list(seed=632545,save=FALSE,save.graphs=FALSE)
saemix.fit1&lt;-saemix(saemix.model1,saemix.data,saemix.options)     

## Not run: 
res.forward &lt;- step.saemix(saemix.fit1, direction = "forward")
res.backward &lt;- step.saemix(saemix.fit1, direction = "backward")
covariate.init &lt;- matrix(c(1,0,0,0,1,0),ncol=3,nrow=2)
res.stepwise &lt;- step.saemix(saemix.fit1, direction="both")

## End(Not run)
</code></pre>


</div>