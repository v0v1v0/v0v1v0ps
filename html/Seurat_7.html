<div class="container">

<table style="width: 100%;"><tr>
<td>AddModuleScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate module scores for feature expression programs in single cells</h2>

<h3>Description</h3>

<p>Calculate the average expression levels of each program (cluster) on single
cell level, subtracted by the aggregated expression of control feature sets.
All analyzed features are binned based on averaged expression, and the
control features are randomly selected from each bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AddModuleScore(
  object,
  features,
  pool = NULL,
  nbin = 24,
  ctrl = 100,
  k = FALSE,
  assay = NULL,
  name = "Cluster",
  seed = 1,
  search = FALSE,
  slot = "data",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A list of vectors of features for expression programs; each
entry should be a vector of feature names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>List of features to check expression levels against, defaults to
<code>rownames(x = object)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbin</code></td>
<td>
<p>Number of bins of aggregate expression levels for all
analyzed features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>
<p>Number of control features selected from the same bin per
analyzed feature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Use feature clusters returned from DoKMeans</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of assay to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name for the expression programs; will append a number to the
end for each entry in <code>features</code> (eg. if <code>features</code> has three
programs, the results will be stored as <code>name1</code>, <code>name2</code>,
<code>name3</code>, respectively)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set a random seed. If NULL, seed is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search</code></td>
<td>
<p>Search for symbol synonyms for features in <code>features</code> that
don't match features in <code>object</code>? Searches the HGNC's gene names
database; see <code>UpdateSymbolList</code> for more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>Slot to calculate score values off of. Defaults to data slot (i.e log-normalized counts)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra parameters passed to <code>UpdateSymbolList</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a Seurat object with module scores added to object meta data;
each module is stored as <code>name#</code> for each module program present in
<code>features</code>
</p>


<h3>References</h3>

<p>Tirosh et al, Science (2016)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("pbmc_small")
cd_features &lt;- list(c(
  'CD79B',
  'CD79A',
  'CD19',
  'CD180',
  'CD200',
  'CD3D',
  'CD2',
  'CD3E',
  'CD7',
  'CD8A',
  'CD14',
  'CD1C',
  'CD68',
  'CD9',
  'CD247'
))
pbmc_small &lt;- AddModuleScore(
  object = pbmc_small,
  features = cd_features,
  ctrl = 5,
  name = 'CD_Features'
)
head(x = pbmc_small[])

## End(Not run)

</code></pre>


</div>