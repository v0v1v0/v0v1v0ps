<div class="container">

<table style="width: 100%;"><tr>
<td>calcTOAIrradModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute top of atmosphere solar irradiance for sensor bands using LUTs</h2>

<h3>Description</h3>

<p>Compute mean extraterrestrial solar irradiance (ESun) using tabulated mean
solar spectral data and the band specific relative spectral response (rsr) 
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Satellite'
calcTOAIrradModel(x, model = "MNewKur", normalize = TRUE, esd)

## S4 method for signature 'data.frame'
calcTOAIrradModel(x, model = "MNewKur", normalize = TRUE, esd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A Satellite object or the relative spectral response function for 
the respective band as <code>data.frame</code> (see details for structure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Tabulated solar radiation model to be used (one of 
MCebKur_MChKur, MNewKur,  MthKur, MoldKur, MODWherli_WMO, NN, see reference
on tabulated solar irradiance below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Logical; if <code>TRUE</code>, ESun is normalized to mean 
earth-sun distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esd</code></td>
<td>
<p>Earth-sun distance (AU, can be estimated using 
<code>calcEarthSunDist</code>). If x is a Satellite object and esd is not 
supplied and necessary for normalization, it is tried to take it from the 
metadata, otherwise it is estimated by the day of the year using 
<code>calcEarthSunDist</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computation of ESun is taken from Updike and Comp (2011).
</p>
<p>Tabulated values for mean earth-sun distance are taken from the 
data sources mentioned in the references. 
</p>
<p>If results should not be normalized to a mean earth-sun distance, the 
actual earth-sun distance is approximated by the day of the year using
<code>calcEarthSunDist</code>.
</p>
<p>Relative spectral response values have to be supplied as a <code>data.frame</code>
which has at least the following three columns: (i) a column "Band" for the 
sensor band number (i.e. 1, 2, etc.), (ii) a column "WAVELENGTH" for the 
WAVELENGTH data in full nm steps, and (iii) a column "RSR" for the response 
information [0...1].
</p>


<h3>Value</h3>

<p>If x is a Satellite object, a Satellite object with ESun information 
added to the metadata; if x is a <code>data.frame</code>, a vector containing ESun
for the respective band(s).
</p>


<h3>References</h3>

<p>Updike T, Comp C (2011) Radiometric use of WorldView-2 imagery. 
Technical Note, available online at <a href="http://www.pancroma.com/downloads/Radiometric_Use_of_WorldView-2_Imagery.pdf">http://www.pancroma.com/downloads/Radiometric_Use_of_WorldView-2_Imagery.pdf</a>.
</p>
<p>Tabulated relative spectral response functions (nm-1) are taken from the
<a href="https://landsat.usgs.gov/spectral-characteristics-viewer">spectral viewer</a>
of the USGS Landsat FAQ.
</p>
<p>Tabulated solar irradiance (W m-2 nm-1) is taken from the 
<a href="http://rredc.nrel.gov/solar/spectra/am0/modtran.html">National Renewable 
Energy Laboratory</a>.
</p>


<h3>See Also</h3>

<p><code>calcTOAIrradTable</code> for tabulated solar irradiance
values from the literature or <code>calcTOAIrradRadRef</code> for the 
computation of the solar irradiance based on maximum radiation and reflection
values of the dataset.
</p>
<p>See <code>calcEarthSunDist</code> for calculating the earth-sun
distance based on the day of the year which is called by this function if
ESun should be corrected for actual earth-sun distance.
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- system.file("extdata", package = "satellite")
files &lt;- list.files(path, pattern = glob2rx("LC08*.TIF"), full.names = TRUE)
sat &lt;- satellite(files)
sat &lt;- calcTOAIrradModel(sat)
getSatESUN(sat)

lut &lt;- lutInfo()
calcTOAIrradModel(lut$L8_RSR, model = "MNewKur", normalize = FALSE, 
  esd = calcEarthSunDist("2015-01-01"))

</code></pre>


</div>