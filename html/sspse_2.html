<div class="container">

<table style="width: 100%;"><tr>
<td>dsizeprior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prior distributions for the size of a hidden population</h2>

<h3>Description</h3>

<p><code>dsizeprior</code> computes the prior distribution of the population
size of a hidden population. The prior is intended to be used in Bayesian
inference for the population size based on data collected by Respondent
Driven Sampling, but can be used with any Bayesian method to estimate
population size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dsizeprior(
  n,
  type = c("beta", "nbinom", "pln", "flat", "continuous", "supplied"),
  mean.prior.size = NULL,
  sd.prior.size = NULL,
  mode.prior.sample.proportion = NULL,
  median.prior.sample.proportion = NULL,
  median.prior.size = NULL,
  mode.prior.size = NULL,
  quartiles.prior.size = NULL,
  effective.prior.df = 1,
  alpha = NULL,
  beta = NULL,
  maxN = NULL,
  log = FALSE,
  maxbeta = 120,
  maxNmax = 2e+05,
  supplied = list(maxN = maxN),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>count; the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; the type of parametric distribution to use for the
prior on population size. The options are <code>"beta"</code> (for a Beta-type
prior on the sample proportion (i.e. <code class="reqn">n/N</code>), <code>"nbinom"</code>
(Negative-Binomial), <code>"pln"</code> (Poisson-log-normal), <code>"flat"</code>
(uniform), <code>continuous</code> (the continuous version of the Beta-type prior
on the sample proportion). The last option is <code>"supplied"</code> which
enables a numeric prior to be specified. See the argument <code>supplied</code>
for the format of the information. The default <code>type</code> is <code>beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mean of the prior
distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the standard deviation
of the prior distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter being the mode
of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter being the
median of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the
prior distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quartiles.prior.size</code></td>
<td>
<p>vector of length 2; A pair of hyperparameters
being the lower and upper quartiles of the prior distribution on the
population size. For example, <br><code>quartiles.prior.size=c(1000,4000)</code>
corresponds to a prior where the lower quartile (25%) is 1000 and the upper
(75%) is 4000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effective.prior.df</code></td>
<td>
<p>scalar; A hyperparameter being the effective
number of samples worth of information represented in the prior distribution
on the population size. By default this is 1, but it can be greater (or
less!) to allow for different levels of uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>scalar; A hyperparameter being the first parameter of the Beta
prior model for the sample proportion. By default this is NULL, meaning that
1 is chosen. it can be any value at least 1 to allow for different levels of
uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>scalar; A hyperparameter being the second parameter of the Beta
prior model for the sample proportion. By default this is NULL, meaning that
1 is chosen. it can be any value at least 1 to allow for different levels of
uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxN</code></td>
<td>
<p>integer; maximum possible population size. By default this is
determined from an upper quantile of the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; return the prior or the the logarithm of the prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxbeta</code></td>
<td>
<p>integer; maximum beta in the prior for population size. By
default this is determined to ensure numerical stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNmax</code></td>
<td>
<p>integer; maximum possible population size. By default this is
determined to ensure numerical stability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supplied</code></td>
<td>
<p>list; If the argument <code>type="supplied"</code> then this
should be a list object, typically of class <code>sspse</code>. It is primarily
used to pass the posterior sample from a separate <code>size</code> call for use
as the prior to this call. Essentially, it must have two components named
<code>maxN</code> and <code>sample</code>. <code>maxN</code> is the maximum population
envisaged and <code>sample</code> is random sample from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if this is <code>TRUE</code>, the program will print out
additional information, including goodness of fit statistics.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>dsizeprior</code> returns a list consisting of the following
elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector; vector of degrees <code>1:N</code> at which the prior
PMF is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpriorm</code></td>
<td>
<p>vector; vector of probabilities
corresponding to the values in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>scalar; a starting value
for the population size computed from the prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxN</code></td>
<td>
<p>integer;
maximum possible population size. By default this is determined from an
upper quantile of the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.prior.size</code></td>
<td>
<p>scalar; A
hyperparameter being the mean of the prior distribution on the population
size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode of the prior
distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effective.prior.df</code></td>
<td>
<p>scalar; A
hyperparameter being the effective number of samples worth of information
represented in the prior distribution on the population size. By default
this is 1, but it can be greater (or less!) to allow for different levels of
uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.prior.sample.proportion</code></td>
<td>
<p>scalar; A hyperparameter
being the mode of the prior distribution on the sample proportion
<code class="reqn">n/N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median.prior.size</code></td>
<td>
<p>scalar; A hyperparameter being the mode
of the prior distribution on the population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>scalar; A
hyperparameter being the second parameter of the Beta distribution that is a
component of the prior distribution on the sample proportion <code class="reqn">n/N</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; the type of parametric distribution to use for the
prior on population size. The possible values are <code>beta</code> (for a Beta
prior on the sample proportion (i.e. <code class="reqn">n/N</code>), <code>nbinom</code>
(Negative-Binomial), <code>pln</code> (Poisson-log-normal), <code>flat</code> (uniform),
and <code>continuous</code> (the continuous version of the Beta prior on the
sample proportion. The default is <code>beta</code>.</p>
</td>
</tr>
</table>
<h3>Details on priors</h3>

<p>The best way to specify the prior is via the
hyperparameter <code>mode.prior.size</code> which specifies the mode of the prior
distribution on the population size. You can alternatively specify the
hyperparameter <code>median.prior.size</code> which specifies the median of the
prior distribution on the population size, or <code>mode.prior.sample
proportion</code> which specifies the mode of the prior distribution on the
proportion of the population size in the sample.
</p>


<h3>References</h3>

<p>Gile, Krista J. (2008) <em>Inference from Partially-Observed Network
Data</em>, Ph.D. Thesis, Department of Statistics, University of Washington.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2010) <em>Respondent-Driven
Sampling: An Assessment of Current Methodology</em>, Sociological Methodology
40, 285-327.
</p>
<p>Gile, Krista J. and Handcock, Mark S. (2014) <span class="pkg">sspse</span>: Estimating Hidden 
Population Size using Respondent Driven Sampling Data
R package, Los Angeles, CA.  Version 0.5, <a href="https://hpmrg.org/sspse/">https://hpmrg.org/sspse/</a>.
</p>
<p>Handcock MS (2003).  <span class="pkg">degreenet</span>: Models for Skewed Count Distributions
Relevant to Networks.  Statnet Project, Seattle, WA.  Version 1.2,
<a href="https://statnet.org/">https://statnet.org/</a>.
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2014)
<em>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</em>, Electronic Journal of Statistics, 8, 1, 1491-1521
</p>
<p>Handcock, Mark S., Gile, Krista J. and Mar, Corinne M. (2015)
<em>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven 
Sampling Data</em>, Biometrics.
</p>


<h3>See Also</h3>

<p>network, statnet, degreenet
</p>


<h3>Examples</h3>

<pre><code class="language-R">
prior &lt;- dsizeprior(n=100,
                    type="beta",
                    mode.prior.size=1000)

</code></pre>


</div>