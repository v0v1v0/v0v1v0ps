<div class="container">

<table style="width: 100%;"><tr>
<td>slim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>slim</h2>

<h3>Description</h3>

<p>Compute ratings and coefficient matrix for the sparse ratings
matrix using SLIM
</p>


<h3>Usage</h3>

<pre><code class="language-R">slim(mat, alpha = 0.5, lambda, nlambda, nonNegCoeff = TRUE, directory,
  coeffMat = FALSE, returnMat = FALSE, computeRMSE = FALSE, nproc = 1L,
  progress = TRUE, check = TRUE, cleanup = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>(sparse matrix of class 'dgCMatrix') Rating matrix with items
along columns and users along rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(0 &lt;= alpha &lt;= 1) Parameter to decide the relative weightage
between the L1 and L2 penalities. See glmnet for more
details. This is set by default at <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>(positive real number) Parameter to control shrinkage of
coefficients. See glmnet for more details. Its advisable not
to provide the lambda value, as the function figures out the optimal value
by itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>(positive integer) Maximum length of the lambda sequence. See
glmnet for more details. If <code>nlambda</code> argument is
missing, it will be set to 100L. This is overridden if <code>lambda</code> is
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonNegCoeff</code></td>
<td>
<p>(flag) Whether the regression coefficients should be
non-negative. There are instances where setting to FALSE decreases the
RMSE, but sometimes this could lead to overfitting. Setting
<code>nonNegCoeff</code> is FALSE, helps interpreting coefficients in the case of
implicit feedback. This is set to TRUE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>
<p>(string) A writable directory where a sub-directory is
created at the run time and <code>bigmatrix</code> objects will be written to.
Predicted ratings data is stored in <code>ratingMat</code> file and the
description is written to <code>ratingMat.desc</code> file. If <code>coeffMat</code> is
TRUE, the coefficents matrix is stored in the file <code>coeffMat</code> and the
description is written to <code>coeffMat.desc</code> file. When directory
argument is missing, directory is set via <code>tempdir()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeffMat</code></td>
<td>
<p>(flag) Whether coeffMat is to be computed. This can be later
used to predict recommendations for users not present in the <code>mat</code>
(although <code>slimrec</code> package does not provide a <code>predict function</code>
). Setting it TRUE increases the computation time. This is set to FALSE by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnMat</code></td>
<td>
<p>(flag) Whether the predicted ratings matrix and coefficient
matrix (only if <code>coeffMat</code> is TRUE) to be read into memory as matrices
and delete on disk <code>bigmatrix</code> objects. When output matrices are
large, setting <code>returnMat</code> to TRUE is not advisable. This is set to
FALSE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeRMSE</code></td>
<td>
<p>(flag) Whether RMSE values have to be computed
corresponding to non-zero values of the <code>mat</code>, both overall and
columnwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproc</code></td>
<td>
<p>(positive integer) Number of parallel processes to be used to
compute coefficients for items. If the machine has <code>k</code> (&gt;1) cores, the
function does not employ more than <code>k - 1</code> cores. This is set to 1L by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>(flag) If TRUE(default), shows a progress bar and expected
time. This is set to TRUE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>(flag) If TRUE(default), ckecks like whether the matrix is
sparse, matrix does not contains NAs, alpha lies between 0 and 1, directory
if specified is writable and so on. This is set to TRUE by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cleanup</code></td>
<td>
<p>(flag) Whether to delete the sub-directory. Note that
<code>returnMat</code>  cannot be set to FALSE when <code>cleanup</code> is TRUE. This
is set to FALSE by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Sparse linear method</strong>
(<a href="http://glaros.dtc.umn.edu/gkhome/node/774">DOI:
10.1109/ICDM.2011.134</a>): The method predicts ratings of a user for a given
item as a linear combination ratings of all other items provided by the
user. The coefficients for an item are determined elastic-net regression
(both L1 and L2 regularization) over ratings matrix.
</p>
<p>The optimization problem solves:
</p>
<p style="text-align: center;"><code class="reqn">\min_{c_{j,.}} \frac{1}{2} \|a_{j,.} - Ac_{j,.}\|^2_{2} +
  \frac{\beta}{2} \|c_{j,.}\|^2_{2} + \gamma \|c_{j,.}\|_{1}</code>
</p>
<p> subject to
<code class="reqn">c_{j,j} = 0</code> and optional non-negative constraint <code class="reqn">c_{j,.} &gt;= 0</code>
where <code class="reqn">a_{j,.}</code> is the j th column of the input ratings matrix and
<code class="reqn">c_{j,.}</code> is the j th column of the coefficient matrix(to be
determined).
</p>
<p>The method assumes that unknown rating values to be zero. Hence, it is
primarily designed for implicit feeback mechanisms, but not restricted
them. The main use of the ratings is to generate top-n lists of users and
items.
</p>
<p><strong>Implementation</strong>: The non-negative ratings data is input as a sparse
matrix of class <code>dgCMatrix</code> without any <code>NA</code>. The items should
constitute columns and users should constitute rows. The elastic-net
regression problem is solved using <code>glmnet</code> package. The coefficients
for each item (a column of the ratings matrix) is computed, in parallel. To
avoid memory overload, the output(s) is written to a disk based bigmatrix
(using <code>bigmemory</code> package). The predicted rating matrix is the
primary output. It is possible to obtain the matrix of coefficients, which
will be helpful later to 'predict' the ratings for users not present in the
ratings matrix. The RMSE may be computed itemwise and for the entire
non-zero values of the ratings matrix. Since, <code>lambda</code> is
auto-adjusted, change in <code>alpha</code> might not have significant impact on
the RMSE. When it is necessary to get the best accuracy, there is a 'tune'
function to arrive at the optimal <code>alpha</code> value by cross-validation.
There are options to read the disk based matrix(s) into memory (as
matrices) and remove the disk based ones.
</p>


<h3>Value</h3>

<p>A list with these elements: </p>

<ul>
<li>
<p> ratingMat: If <code>returnMat</code> is TRUE, the predicted ratings matrix.
Else, <code>NULL</code>
</p>
</li>
<li>
<p> coeffMat: If <code>returnMat</code> is TRUE and <code>coeffMat</code> is TRUE,
the coefficient matrix. Else, <code>NULL</code>
</p>
</li>
<li>
<p> lambdas: When <code>lambda</code> is not specified, a vector(length of
number of columns of <code>mat</code>) of lambda values chosen. When
<code>lambda</code> is specified, it is singleton <code>lambda</code> value.
</p>
</li>
<li>
<p> columnwiseNonZeroRMSE: If <code>computeRMSE</code> is TRUE, vector of RMSE
for each column. The errors are computed over only non-zero values of the
column of <code>mat</code>. If <code>computeRMSE</code> is FALSE, value is set to
<code>NULL</code>.
</p>
</li>
<li>
<p> nonZeroRMSE: If <code>computeRMSE</code> is TRUE, RMSE value. The errors
are computed over only non-zero values of the <code>mat</code>. If
<code>computeRMSE</code> is FALSE, value is set to <code>NULL</code>.
</p>
</li>
<li>
<p> subdir: Path to the sub-directory where output are placed.
</p>
</li>
<li>
<p> call: function call
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">require("slimrec")
data(ft_small)
temp &lt;- slim(ft_small)
str(temp)

## Not run: 
temp &lt;- slim(mat           = ft_implicit # input sparse ratings matrix
             , alpha       = 0.5         # 0 for ridge, 1 for lasso
             #, lambda                   # suggested not to set lambda
             #, nlambda                  # using default nlambda = 100
             , nonNegCoeff = TRUE        # better accuracy, lower interpretability
             , directory   = td          # dir where output matrices are stored
             , coeffMat    = TRUE        # helpful in 'predict'ing later
             , returnMat   = TRUE        # return matrices in memory
             , computeRMSE = TRUE        # RMSE over rated items
             , nproc       = 2L          # number of concurrent processes
             , progress    = TRUE        # show a progressbar
             , check       = TRUE        # do basic checks on input params
             , cleanup     = FALSE       # keep output matrices on disk
             )
str(temp)
# output ratings matrix would be comparatively denser
predMat &lt;- temp[["ratingMat"]] != 0
sum(predMat)/((dim(predMat)[1])*(dim(predMat)[2]))
# recommend top 5 items for a user 10
top_cols(temp[["ratingMat"]]
         , row = 10
         , k   = 5
         )
# if you intend to avoid recommending 10, 215 and 3
top_cols(temp[["ratingMat"]]
         , row = 10
         , k   = 5
         , ignore = c(10, 215, 3)
         )

## End(Not run)

</code></pre>


</div>