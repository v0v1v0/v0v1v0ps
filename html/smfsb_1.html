<div class="container">

<table style="width: 100%;"><tr>
<td>abcRun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a set of simulations initialised with parameters sampled from a given prior distribution, and compute statistics required for an ABC analaysis</h2>

<h3>Description</h3>

<p>Run a set of simulations initialised with parameters sampled from a given prior distribution, and compute statistics required for an ABC analaysis. Typically used to calculate "distances" of simulated synthetic data from observed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">abcRun(n, rprior, rdist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer representing the number of simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rprior</code></td>
<td>
<p>A function without arguments generating a single parameter (vector) from prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdist</code></td>
<td>
<p>A function taking a parameter (vector) as argument and returning the required statistic of interest. This will typically be computed by first using the parameter to run a forward model, then computing required summary statistics, then computing a distance. See the example for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements 'param' and 'dist'. These will be returned as matrices or vectors depending on whether the parameters and distances are scalars or vectors.
</p>


<h3>See Also</h3>

<p><code>pfMLLik</code>, <code>StepGillespie</code>, <code>abcSmc</code>,
<code>simTs</code>, <code>stepLVc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(LVdata)
rprior &lt;- function() { exp(c(runif(1, -3, 3),runif(1,-8,-2),runif(1,-4,2))) }
rmodel &lt;- function(th) { simTs(c(50,100), 0, 30, 2, stepLVc, th) }
sumStats &lt;- identity
ssd = sumStats(LVperfect)
distance &lt;- function(s) {
    diff = s - ssd
    sqrt(sum(diff*diff))
}
rdist &lt;- function(th) { distance(sumStats(rmodel(th))) }
out = abcRun(10000, rprior, rdist)
q=quantile(out$dist, c(0.01, 0.05, 0.1))
print(q)
accepted = out$param[out$dist &lt; q[1],]
print(summary(accepted))
print(summary(log(accepted)))

</code></pre>


</div>