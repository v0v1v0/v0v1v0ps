<div class="container">

<table style="width: 100%;"><tr>
<td>scMANOVAestimation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multivariate ANalysis Of VAriance Maximum Likelihood Estimation with Ridge Regularization for Semicontinuous High-Dimensional Data
</h2>

<h3>Description</h3>

<p><code>scMANOVAestimation</code> computes the regularized Multivariate ANalysis Of
VAriance (MANOVA) maximum likelihood estimates for semicontinuous
high-dimensional data. The estimation can be performed also for
low-dimensional data. The regularization parameters are provided as input
and the user can decide to perform the regularization adding the identity
matrix to the raw estimated covariance matrix (default, <code>ident=TRUE</code>)
or adding the diagonal values of the raw estimated covariance matrix
(<code>ident=FALSE</code>). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  scMANOVAestimation(x, n, lambda = NULL, lambda0 = NULL,
    ident = TRUE, posdef.check = TRUE, rm.vars = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code> or <code>matrix</code> of data with units on the rows and variables on the columns 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p><code>vector</code>. The length corresponds to the number of groups, the elements to the number of observations in each group  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>scalar. Ridge regularization parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>scalar. Ridge regularization parameter under null hypothesis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ident</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, <code>lambda</code> times the identity matrix is added to the raw estimated covariance matrix, if <code>FALSE</code> the diagonal values of the raw estimated covariance matrix are used instead
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posdef.check</code></td>
<td>
<p><code>logical</code>. Check if the estimated covariance matrix is positive definite
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.vars</code></td>
<td>
<p><code>NA</code>, <code>NULL</code> or <code>vector</code>. If <code>NA</code> variables are removed from the analysis when they do not have enough observations to compute covariances. If <code>NULL</code> or a zero length <code>vector</code> all the variables are retained. If it is a <code>vector</code>, it indicates the position of the variables to remove, no further variables are removed  
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>class</code> scMANOVAestimation which is a list with the following components  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p><code>matrix</code>. Estimated proportion of missing values for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p><code>matrix</code>. Estimated mean vector for each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaRidge</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix with ridge regularization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix by maximum likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p><code>vector</code>. Estimated proportion of missing values under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p><code>vector</code>. Estimated mean vector under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0Ridge</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix with ridge regularization under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0</code></td>
<td>
<p><code>matrix</code>. Estimated covariance matrix by maximum likelihood under null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removed.vars</code></td>
<td>
<p><code>vector</code> or <code>NULL</code>. columns removed in the continuous part of the log-likelihood dues to insufficient number of observations in each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikPi</code></td>
<td>
<p>scalar. Log-likelihood for the discrete part of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>scalar. Log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLikPi0</code></td>
<td>
<p>scalar. Log-likelihood for the discrete part of the model under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik0</code></td>
<td>
<p>scalar. Log-likelihood under null hypothesis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni
</p>


<h3>References</h3>

<p>Elena Sabbioni, Claudio Agostinelli and Alessio Farcomeni (2024)
A regularized MANOVA test for semicontinuous high-dimensional data.
arXiv: <a href="http://arxiv.org/abs/2401.04036">http://arxiv.org/abs/2401.04036</a>
</p>


<h3>See Also</h3>

<p><code>scMANOVA</code> and <code>scMANOVApermTest</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(1234)
  n &lt;- c(5,5)
  p &lt;- 20
  pmiss &lt;- 0.1
  x &lt;- scMANOVAsimulation(n=n, p=p, pmiss=pmiss)
  res &lt;- scMANOVAestimation(x=x, n=n, lambda=3.59, lambda0=3.13)
  res
</code></pre>


</div>