<div class="container">

<table style="width: 100%;"><tr>
<td>funcen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bivariate kernel density estimation under random censoring</h2>

<h3>Description</h3>

<p>Computes the kernel density estimation of the bivariate vector <code class="reqn">(marker, time-to-event)</code> with the time-to-event variable subject to right censorship, according to the procedure exposed in <a href="https://doi.org/10.1177/0962280217740786">https://doi.org/10.1177/0962280217740786</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">funcen(data, H, bw, adj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix with three columns: time-to-event, censoring status (0=censored/1=uncensored) and marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>2x2 bandwidth matrix when it is specified in an explicit way.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>method for computing the bandwidth matrix. Most of the methods included in the <code>kde</code> function can be used: Hpi, Hpi.diag, Hlscv, Hlscv.diag, Hbcv, Hbcv.diag, Hscv, Hscv.diag, Hucv and Hucv.diag. Other considered methods are naive.pdf (diag(N^-1/5, N^-1/5)^2) and naive.cdf (diag(N^-1/3, N^-1/3)^2), where N is the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>adjusment parameter for calculating the bandwidth matrix. Default value 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>kde</code> function arguments can also be used for specifying the way in which the kernel density function estimation should be computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix of bandwidths can be defined by using H=matrix() or automatically selected by the method indicated in bw.
</p>
<p>Given the matrix of bandwidths, H, the argument adj modifies it and the final computed matrix is adj^2 H.
</p>
<p>If H is missing, the naive.pdf method is used for obtaining the kernel density estimation.
</p>
<p>Function <code>funcen</code> generates, from the original set of data, a collection of pseudodata through an iterative  weights allocation process, with two main goals: keep the information from the censored observations represented in the sample and prepare data so they can be used as incoming parameters in the <code>kde</code> function included in the <span class="pkg">ks</span> package. A weighted kernel density estimation is therefore finally computed.
</p>
<p>There should be at least two uncensored observations for computing the density estimation.
</p>
<p>Omitted parameters are considered to be the default ones in the <code>kde</code> function.</p>


<h3>Value</h3>

<p>An object  of class <code>kde</code> is returned. It is a list where the most relevant values are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix containing the pseudodata values. It has two columns: marker and time-to-event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval.points</code></td>
<td>
<p>list of points where the bivariate kernel estimation is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>values of the density estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>bandwidth matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>weights calculated by the function and allocated to pseudodata.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>P. Martinez-Camblor and J. C. Pardo-Fernandez. Smooth time-dependent receiver operating characteristic
curve estimators. Statistical Methods in Medical Research, 27(3):651-674, 2018. <a href="https://doi.org/10.1177/0962280217740786">https://doi.org/10.1177/0962280217740786</a>.

</p>
<p>T. Duong. Bandwidth matrices for multivariate kernel density estimation. Ph.D. Thesis, University of
Western, Australia, 2004. <a href="http://www.mvstat.net/tduong">http://www.mvstat.net/tduong</a>.

</p>


<h3>Examples</h3>

<pre><code class="language-R">library(smoothROCtime)
require(KMsurv)
require(lattice)

data(kidtran)

# Preparing data: a logarithmic transformationof the time-to-event variable is made
  DT &lt;- cbind(log(kidtran$time),kidtran$delta,kidtran$age)
  n  &lt;-length(log(kidtran$time))

# Directly definition of the bandwidth matrix
  H  &lt;- diag((c(sd(kidtran$age),sd(log(kidtran$time)))*n^(-0.2))^2)

# Kernel density function estimation
  density &lt;- funcen(data=DT,H=H)

# Plot graphics
  wireframe(density$estimate, row.values=density$eval.points[[1]],
            column.values=density$eval.points[[1]],zlab="density")
  contour(x=density$eval.points[[1]],
          y=density$eval.points[[2]],
          z=density$estimate,
          ylim=c(6,10))
</code></pre>


</div>