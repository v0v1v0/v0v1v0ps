<div class="container">

<table style="width: 100%;"><tr>
<td>smoothagesccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spline-based semiparametric SCCS, smooth age

</h2>

<h3>Description</h3>

<p>Fits a semiparametric SCCS model with smooth age effect, where the age related relative incidence function is represented by spline function; that is, linear combinations of M-splines. The exposure related relative incidence function is represented by step functions. One exposure group can be included.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothagesccs(indiv, astart, aend, aevent, adrug, aedrug, expogrp = 0,
              washout = NULL, kn=12, sp = NULL, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at which observation periods start. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event, an individual can experience multiple events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a vector of ages at which exposure starts, only a single exposure type can be included.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a vector of ages at which the exposure-related risk periods end.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expogrp</code></td>
<td>

<p>a vector of days to the start of exposure-related risk, counted from <code>adrug</code>. E.g if the risk period is [<code>adrug</code>+c,<code>aedrug</code>], use expogrp = c. To define multiple risk windows, <code>expogrp</code> is a vector of days on start of risk periods counted from <code>adrug</code>. The DEFAULT is  zero where the exposure-related risk periods are [<code>adrug</code>, <code>aedrug</code>].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>washout</code></td>
<td>

<p>a vector of days to start of washout periods counted from <code>aedrug</code>. The default is  NULL, no washout periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>

<p>an integer &gt;=5 representing the number of interior knots used to define the M-spline basis functions which are related to the age specific relative incidence function, usually between 8 and 12 knots is sufficient. It defaults to 12 knots. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>

<p>smoothing parameter value. It defaults to "auto" where the smoothing paramter is obtained automatically using a cross-validation method. The value of "sp" must be a number greater or equal to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the input data. The data are assembled one line per event.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standard SCCS represents the age and exposure effects by piecewise constant step functions, however mis-specification of age group cut points might lead to biased estimates of the exposure related relative incidences. The semiparametric SCCS model, <code>semisccs</code>, has numerical challenges when the number of cases is large. This splined-based semiparametric SCCS model with smooth age effect avoids these limitations of the standard and semiparametric SCCS models. The smoothing parameter for the age-related relative incidence function is chosen by an approximate cross-validation method. The method is outlined in Ghebremichael-Weldeselassie et al (2014). 
</p>


<h3>Value</h3>

<p>Relative incidence estimates along with their 95% confidence limits. 


</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>log of the exposure related relative incidence estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>standard errors of the log of exposure related relative incidence estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>age related relative incidences at each day between the minimum age at start of observation and maximum age at end of observation periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ageaxis</code></td>
<td>
<p>sequence of ages between the minimum age at start of observations and maximum age at end of observation periods corresponding to the age related relative incidences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothingpara</code></td>
<td>
<p>smoothing parameter chosen by maximizing an approximate cross-validation score or given as an argument in the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>cross-validation score</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington. 
</p>


<h3>References</h3>


<p>Ghebremichael-Weldeselassie, Y., Whitaker, H. J., Farrington, C. P. (2015). Self-controlled case series method with smooth age effect. Statistics in Medicine, 33(4), 639-649. 
</p>
<p>Farrington, P., Whitaker, H., and Ghebremichael-Weldeselassie, Y. (2018). Self-controlled Case Series Studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press. 
</p>



<h3>See Also</h3>

<p><code>smoothexposccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Fit the SCCS model with smooth age effect to the itp data and plot age effect.  

itp.mod &lt;- smoothagesccs(indiv=case, astart=sta,aend=end, aevent=itp,
                           adrug=mmr, aedrug=mmr+42, expogrp=c(0,15,29), sp=2800,
                           data=itpdat)

itp.mod

plot(itp.mod)

</code></pre>


</div>