<div class="container">

<table style="width: 100%;"><tr>
<td>f1d.irt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functional Unidimensional Item Response Model
</h2>

<h3>Description</h3>

<p>Estimates the functional unidimensional item response model for
dichotomous data (Ip, Molenberghs, Chen, Goegebeur &amp; De Boeck, 2013).
Either the IRT model is estimated using a probit link and employing tetrachoric
correlations or item discriminations and intercepts of a pre-estimated multidimensional IRT
model are provided as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">f1d.irt(dat=NULL, nnormal=1000, nfactors=3, A=NULL, intercept=NULL,
    mu=NULL, Sigma=NULL, maxiter=100, conv=10^(-5), progress=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Data frame with dichotomous item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnormal</code></td>
<td>

<p>Number of <code class="reqn">\theta_p</code> grid points for approximating the
normal distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfactors</code></td>
<td>

<p>Number of dimensions to be estimated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>

<p>Matrix of item discriminations (if the IRT model is already estimated)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>Vector of item intercepts (if the IRT model is already estimated)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Vector of estimated means. In the default it is assumed
that all means are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Estimated covariance matrix. In the default it is
the identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Display progress? The default is <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functional unidimensional item response model (F1D model)
for dichotomous item responses is based on a multidimensional model with a
link function <code class="reqn">g</code> (probit or logit):
</p>
<p style="text-align: center;"><code class="reqn"> P( X_{pi}=1 | \bold{\theta}_p )=
g( \sum_d a_{id} \theta_{pd} - d_i ) </code>
</p>

<p>It is assumed that <code class="reqn">\bold{\theta}_p</code> is multivariate normally
distribution with a zero mean vector and identity covariance matrix.
</p>
<p>The F1D model estimates unidimensional item response functions
such that
</p>
<p style="text-align: center;"><code class="reqn"> P( X_{pi}=1 | \theta_p^\ast ) \approx
g \left( a_{i}^\ast \theta_{p}^\ast - d_i^\ast \right) </code>
</p>

<p>The optimization function <code class="reqn">F</code> minimizes the deviations of
the approximation equations
</p>
<p style="text-align: center;"><code class="reqn"> a_{i}^\ast \theta_{p}^\ast - d_i^\ast
\approx \sum_d a_{id} \theta_{pd} - d_i </code>
</p>

<p>The optimization function <code class="reqn">F</code> is defined by
</p>
<p style="text-align: center;"><code class="reqn"> F( \{ a_i^\ast, d_i^\ast \}_i, \{ \theta_p^\ast \}_p )=
    \sum_p \sum_i w_p ( a_{id} \theta_{pd} - d_i-
a_{i}^\ast \theta_{p}^\ast + d_i^\ast )^2 \rightarrow Min! </code>
</p>

<p>All items <code class="reqn">i</code> are equally weighted whereas the ability
distribution of persons <code class="reqn">p</code> are weighted according to the
multivariate normal distribution (using weights <code class="reqn">w_p</code>).
The estimation is conducted using an alternating least squares algorithm
(see Ip et al. 2013 for a different algorithm). The ability distribution
<code class="reqn">\theta_p^\ast</code> of the functional unidimensional model is assumed
to be standardized, i.e. does have a zero mean and a standard deviation of one.
</p>


<h3>Value</h3>

<p>A list with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>item</code></td>
<td>
<p>Data frame with estimated item parameters: Item intercepts
for the functional unidimensional <code class="reqn">a_{i}^\ast</code> (<code>ai.ast</code>) and
the ('ordinary') unidimensional (<code>ai0</code>) item response
model. The same holds for item intercepts <code class="reqn">d_{i}^\ast</code> (<code>di.ast</code> and
<code>di0</code> respectively).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with estimated <code class="reqn">\theta_p^\ast</code>
distribution. Locations are <code>theta.ast</code> with corresponding
probabilities in <code>wgt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Estimated or provided item discriminations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Estimated or provided intercepts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Used dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tetra</code></td>
<td>
<p>Object generated by <code>tetrachoric2</code> if <code>dat</code>
is specified as input. This list entry is useful for applying
<code>greenyang.reliability</code>.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ip, E. H., Molenberghs, G., Chen, S. H., Goegebeur, Y., &amp;
De Boeck, P. (2013). Functionally unidimensional item
response models for multivariate binary data.
<em>Multivariate Behavioral Research, 48</em>, 534-562.
</p>


<h3>See Also</h3>

<p>For estimation of bifactor models and Green-Yang reliability
based on tetrachoric correlations see <code>greenyang.reliability</code>.
</p>
<p>For estimation of bifactor models based on marginal maximum likelihood
(i.e. full information maximum likelihood) see the
<code>TAM::tam.fa</code> function in the <span class="pkg">TAM</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Dataset Mathematics data.math | Exploratory multidimensional model
#############################################################################
data(data.math)
dat &lt;- ( data.math$data )[, -c(1,2) ] # select Mathematics items

#****
# Model 1: Functional unidimensional model based on original data

#++ (1) estimate model with 3 factors
mod1 &lt;- sirt::f1d.irt( dat=dat, nfactors=3)

#++ (2) plot results
     par(mfrow=c(1,2))
# Intercepts
plot( mod1$item$di0, mod1$item$di.ast, pch=16, main="Item Intercepts",
        xlab=expression( paste( d[i], " (Unidimensional Model)" )),
        ylab=expression( paste( d[i], " (Functional Unidimensional Model)" )))
abline( lm(mod1$item$di.ast ~ mod1$item$di0), col=2, lty=2 )
# Discriminations
plot( mod1$item$ai0, mod1$item$ai.ast, pch=16, main="Item Discriminations",
        xlab=expression( paste( a[i], " (Unidimensional Model)" )),
        ylab=expression( paste( a[i], " (Functional Unidimensional Model)" )))
abline( lm(mod1$item$ai.ast ~ mod1$item$ai0), col=2, lty=2 )
     par(mfrow=c(1,1))

#++ (3) estimate bifactor model and Green-Yang reliability
gy1 &lt;- sirt::greenyang.reliability( mod1$tetra, nfactors=3 )

## Not run: 
#****
# Model 2: Functional unidimensional model based on estimated multidimensional
#          item response model

#++ (1) estimate 2-dimensional exploratory factor analysis with 'smirt'
I &lt;- ncol(dat)
Q &lt;- matrix( 1, I,2 )
Q[1,2] &lt;- 0
variance.fixed &lt;- cbind( 1,2,0 )
mod2a &lt;- sirt::smirt( dat, Qmatrix=Q, irtmodel="comp", est.a="2PL",
                variance.fixed=variance.fixed, maxiter=50)
#++ (2) input estimated discriminations and intercepts for
#       functional unidimensional model
mod2b &lt;- sirt::f1d.irt( A=mod2a$a, intercept=mod2a$b )

#############################################################################
# EXAMPLE 2: Dataset Mathematics data.math | Confirmatory multidimensional model
#############################################################################

data(data.math)
library(TAM)

# dataset
dat &lt;- data.math$data
dat &lt;- dat[, grep("M", colnames(dat) ) ]
# extract item informations
iteminfo &lt;- data.math$item
I &lt;- ncol(dat)
# define Q-matrix
Q &lt;- matrix( 0, nrow=I, ncol=3 )
Q[ grep( "arith", iteminfo$domain ), 1 ] &lt;- 1
Q[ grep( "Meas", iteminfo$domain ), 2 ] &lt;- 1
Q[ grep( "geom", iteminfo$domain ), 3 ] &lt;- 1

# fit three-dimensional model in TAM
mod1 &lt;- TAM::tam.mml.2pl(  dat, Q=Q, control=list(maxiter=40, snodes=1000) )
summary(mod1)

# specify functional unidimensional model
intercept &lt;- mod1$xsi[, c("xsi") ]
names(intercept) &lt;- rownames(mod1$xsi)
fumod1 &lt;- sirt::f1d.irt( A=mod1$B[,2,], intercept=intercept, Sigma=mod1$variance)
fumod1$item

## End(Not run)
</code></pre>


</div>