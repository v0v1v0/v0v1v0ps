<div class="container">

<table style="width: 100%;"><tr>
<td>gcv.ubre_grad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The GCV/UBRE score value and its gradient
</h2>

<h3>Description</h3>

<p>For the estimation of the SCAM smoothing parameters the GCV/UBRE score is optimized outer to the Newton-Raphson 
procedure of the model fitting. 
This function returns the value of the GCV/UBRE score  and calculates its first derivative 
with respect to the log smoothing parameter using the method of Wood (2009).
</p>
<p>The function is not normally called directly, but rather service routines for <code>bfgs_gcv.ubre</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gcv.ubre_grad(rho, G, env, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>log of the initial values of the smoothing parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>a list of items needed to fit a SCAM.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Get the enviroment for the model coefficients, their derivatives and the smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of fit control parameters as returned by <code>scam.control</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dgcv.ubre</code></td>
<td>
<p>The value of GCV/UBRE gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcv.ubre</code></td>
<td>
<p>The GCV/UBRE score value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.est</code></td>
<td>
<p>The value of the scale estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The elements of the fitting procedure <code>monogam.fit</code> for a given value of the smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgcv.ubre.check</code></td>
<td>
<p>If <code>check.analytical=TRUE</code> this returns the finite-difference approximation of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.grad</code></td>
<td>
<p>If <code>check.analytical=TRUE</code> this returns the relative difference (in 
and finite differenced derivatives.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>
<p>Wood S.N. (2006) Generalized Additive Models: An Introduction with R. Chapman and Hall/CRC Press.
</p>
<p>Wood, S.N. (2011) Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized 
linear models. Journal of the Royal Statistical Society: Series B. 73(1): 1â€“34
</p>


<h3>See Also</h3>

<p><code>scam</code>, <code>scam.fit</code>, <code>bfgs_gcv.ubre</code>
</p>


</div>