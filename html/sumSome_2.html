<div class="container">

<table style="width: 100%;"><tr>
<td>brainPvals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation p-Values for Brain Imaging</h2>

<h3>Description</h3>

<p>This function computes p-value combinations for different permutations of brain imaging data.
A voxel's p-value is calculated by performing the one-sample t test
for the null hypothesis that its mean contrast over the different subjects is zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brainPvals(copes, mask = NULL, alternative = "two.sided", alpha = 0.05, B = 200, 
           seed = NULL, truncFrom = NULL, truncTo = 0.5,
           type = "vovk.wang", r = 0, rand = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copes</code></td>
<td>
<p>list of 3D numeric arrays (contrasts maps for each subject).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain, or character for a Nifti file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncFrom</code></td>
<td>
<p>truncation parameter: values greater than <code>truncFrom</code> are truncated.
If <code>NULL</code>, it is set to <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, p-values are not truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>p-value combination among <code>edgington</code>, <code>fisher</code>, <code>pearson</code>, <code>liptak</code>,
<code>cauchy</code>, <code>vovk.wang</code> (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>parameter for Vovk and Wang's p-value combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>logical, <code>TRUE</code> to compute p-values by permutation distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A p-value <code>p</code> is transformed as following.
</p>

<ul>
<li>
<p> Edgington: <code>-p</code>
</p>
</li>
<li>
<p> Fisher: <code>-log(p)</code>
</p>
</li>
<li>
<p> Pearson: <code>log(1-p)</code>
</p>
</li>
<li>
<p> Liptak: <code>-qnorm(p)</code>
</p>
</li>
<li>
<p> Cauchy: <code>tan(0.5 - p)/p</code>
</p>
</li>
<li>
<p> Vovk and Wang: <code>- sign(r)p^r</code>
</p>
</li>
</ul>
<p>An error message is returned if the transformation produces infinite values.
</p>
<p>Truncation parameters should be such that <code>truncTo</code> is not smaller than <code>truncFrom</code>.
As Pearson's and Liptak's transformations produce infinite values in 1, for such methods
<code>truncTo</code> should be strictly smaller than 1.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1).
</p>


<h3>Value</h3>

<p><code>brainPvals</code> returns an object of class <code>sumBrain</code>, containing
</p>

<ul>
<li> <p><code>statistics</code>: numeric matrix of p-values, where columns correspond to voxels inside the brain, and rows to permutations.
The first permutation is the identity
</p>
</li>
<li> <p><code>mask</code>: 3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>truncFrom</code>: transformed first truncation parameter
</p>
</li>
<li> <p><code>truncTo</code>: transformed second truncation parameter
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging using t scores: <code>brainScores</code>
</p>
<p>True discovery guarantee for cluster analysis: <code>clusterAnalysis</code>
</p>
<p>Suprathreshold clusters: <code>findClusters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain (combination: Cauchy)
res &lt;- brainPvals(copes = copes, alpha = 0.2, seed = 42, type = "cauchy")
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>


</div>