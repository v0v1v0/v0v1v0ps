<div class="container">

<table style="width: 100%;"><tr>
<td>getExpectedAbund</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate expected abundance</h2>

<h3>Description</h3>

<p>Calculate expected abundance for multiple features at multiple timepoints in
multiple conditions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getExpectedAbund(
  featureMetadata,
  times = NULL,
  sampleMetadata = NULL,
  byCondGroup = is.null(times)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>featureMetadata</code></td>
<td>
<p><code>data.table</code> with columns <code>feature</code>, <code>base</code>,
<code>rhyFunc</code>, <code>amp</code>, <code>period</code>, and <code>phase</code>, where every row corresponds to a
gene. If <code>byCondGroup</code> is <code>TRUE</code>, then must also have columns <code>cond</code> and
<code>group</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector of the times at which to calculate expected
abundance for each row in <code>featureMetadata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleMetadata</code></td>
<td>
<p><code>data.table</code> with columns <code>sample</code>, <code>cond</code>, and
<code>time</code>. Either <code>times</code> or <code>sampleMetadata</code> must be provided, and the former
takes precedence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byCondGroup</code></td>
<td>
<p>Logical for whether to speed up the calculation by
grouping by the columns <code>cond</code> and <code>group</code>. Primarily for internal use.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>data.table</code> derived from <code>featureMetadata</code> (but with more rows),
with additional columns <code>time</code> and <code>mu</code> and possibly others. If sampling
will use the negative binomial family, <code>mu</code> corresponds to log2 counts.
</p>


<h3>See Also</h3>

<p><code>simphony()</code>, <code>getSampledAbund()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library('data.table')
featureMetadata = data.table(feature = c('feature_1', 'feature_2'),
                             base = function(x) 0,
                             amp = c(function(x) 0, function(x) 1),
                             period = 24,
                             phase = 0, rhyFunc = sin)
abundDt = getExpectedAbund(featureMetadata, times = 6:17)

</code></pre>


</div>