<div class="container">

<table style="width: 100%;"><tr>
<td>gammatone</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gammatone filter</h2>

<h3>Description</h3>

<p>Generate gammatone filter in the time domain (impulse response).</p>


<h3>Usage</h3>

<pre><code class="language-R">gammatone(f, d, cfreq, n = 4, a = 1, p = 0, output = "matrix")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency (in Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>duration (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfreq</code></td>
<td>
<p>center frequency (in Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>filter order (no unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>amplitude (linear scale, no unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>initial phase (in radians).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>character string, the class of the object to return, either
<code>"matrix"</code>, <code>"Wave"</code>, <code>"Sample"</code>, <code>"audioSample"</code> or <code>"ts"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The gammatone function in the time domain (impulse response) is
obtained with:<br></p>
<p style="text-align: center;"><code class="reqn">g(t) = a \times t^{n-1} \times e^{-2\pi \beta t} \times \cos(2 \pi cf t + \phi)</code>
</p>

<p>with <em>a</em> the amplitude, <em>t</em> time, <em>n</em> the filter order, <em>cf</em> the center frequency, <code class="reqn">\phi</code> the initial phase.<br>
The parameter <code class="reqn">\beta</code> is the equivalent rectangular
bandwidth (ERB) bandwidth which varies according to the center
frequency <code class="reqn">cf</code> following:<br></p>
<p style="text-align: center;"><code class="reqn">\beta = 24.7 \times (4.37 \times \frac{cf}{1000} + 1)</code>
</p>
 


<h3>Value</h3>

<p>A wave is returned. The class of the returned object is set with the argument <code>output</code>.</p>


<h3>Note</h3>

<p>Use the FFT based function, as <code>spec</code> or
<code>meanspec</code>, to get the filter in the frequency domain. See examples.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>References</h3>

<p>Holdsworth J, Nimmo-Smith I, Patterson R, Rice P (1988) Implementing a gammatone filter bank. Annex C of the SVOS Final Report: Part A: The Auditory Filterbank, 1, 1-5.
</p>


<h3>See Also</h3>

<p><code>melfilterbank</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## gammatone filter in the time domain (impulse response)
f &lt;- 44100
d &lt;- 0.05
res &lt;- gammatone(f=f, d=d, cfreq=440, n=4)
## time display
oscillo(res, f=f)
## frequency display
spec(res, f=f)
## generate and plot a bank of 32 filters from 500 to 10000 Hz
n &lt;- 32
cfreq &lt;- round(seq(500, 10000, length.out=n))
res &lt;- matrix(NA, nrow=f*d/2, ncol=n)
for(i in 1:n){
    res[,i] &lt;- spec(gammatone(f=f, d=d, cfreq=cfreq[i]), f=f, dB="max0", plot=FALSE)[,2]
}
x &lt;- seq(0,f/2,length.out=nrow(res))/1000
plot(x=x, y=res[,1],
     xlim=c(0,14), ylim=c(-60,0),
     type="l", col=2, las=1, 
     xlab="Frequency (kHz)", ylab="Relative amplitude (dB)")
for(i in 2:n) lines(x, res[,i], col=2)
## use the frequency domain to filter a white noise input
## here around the center frequency 2000 Hz
res &lt;- gammatone(f=f, d=d, cfreq=2000, n=4)
gspec &lt;- spec(res, f=f, plot=FALSE)[,2]
nw &lt;- noisew(f=44100, d=1)
nwfilt &lt;- fir(nw, f=44100, wl=length(gspec)*2, custom=gspec) 
spectro(nwfilt, f=f)
</code></pre>


</div>