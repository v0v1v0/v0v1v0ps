<div class="container">

<table style="width: 100%;"><tr>
<td>fixedLRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood ratio test of fixed effects.
</h2>

<h3>Description</h3>

<p><code>fixedLRT</code> performs a likelihood ratio (LR) test between two models, the “full” and the “null” models, 
currently differing only in their fixed effects. Parametric bootstrap p-values can be computed, either using the raw bootstrap distribution of the likelihood ratio, or a bootstrap estimate of the Bartlett correction of the LR statistic.
This function differs from <code>LRT</code> in its arguments (model fits for <code>LRT</code>, versus all arguments required to fit the models for <code>fixedLRT</code>), and in the format of its return value. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">fixedLRT(null.formula, formula, data, method, HLmethod = method, 
         REMLformula = NULL, boot.repl=0, control="DEPRECATED",
         control.boot="DEPRECATED", fittingFunction, seed=NULL,
         resp_testfn = NULL, weights.form = NULL, ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>null.formula</code></td>
<td>

<p>Either a <code>formula</code> (as in <code>glm</code>) or a <code>predictor</code> (see <code>Predictor</code>) for the null model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>Either a <code>formula</code> or a <code>predictor</code> for the full model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>A method to fit the full and null models. 
See <code>method</code> information about such methods. 
The two most meaningful values of <code>method</code> in <code>fixedLRT</code> calls are: 
<code>'ML'</code> for an LRT based on ML fits (generally recommended); and
<code>'PQL/L'</code> for an LRT based on PQL/L fits (recommended for spatial binary data). 
</p>
<p>Also feasible, but more tricky, and not really recommended (see Rousset and Ferdy, 2014), is <code>'REML'</code>. 
This will perform an LRT based on two REML fits of the data, *both* of which use the  
same conditional (or “restricted”) likelihood of residuals for estimating dispersion parameters <code class="reqn">\lambda</code> and <code class="reqn">\phi</code> (see <code>REMLformula</code> argument). 
Further, REML will not be effective on a given dispersion parameter if a non-trivial init.corrHLfit value is provided for this parameter.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HLmethod</code></td>
<td>

<p>Kept for back-compatibility. Same as <code>method</code>, but may work only for<br><code>fittingFunction=corrHLfit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REMLformula</code></td>
<td>

<p>a formula specifying the fixed effects which design matrix is used in the REML correction 
for the estimation of dispersion parameters, if these are estimated by REML. 
This formula is by default that for the *full* model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.form</code></td>
<td>

<p>Specification of prior weights by a one-sided formula: use <code>weights.form = ~ pw</code> instead of <code>prior.weights = pw</code>. The effect will be the same except that such an argument, known to evaluate to an object of class <code>"formula"</code>, is suitable to enforce safe programming practices (see <code>good-practice</code>).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.repl</code></td>
<td>

<p>the number of bootstrap replicates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.boot</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fittingFunction</code></td>
<td>
<p>Character string giving the function used to fit each model: either <code>"corrHLfit"</code> or <code>"fitme"</code>. Default is <code>"corrHLfit"</code> for small data sets (fewer than 300 observations), and <code>"fitme"</code> otherwise, but this may change in future versions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Passed to <code>simulate.HLfit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp_testfn</code></td>
<td>
<p>See argument <code>resp_testfn</code> of <code>spaMM_boot</code></p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments passed to or from other methods; presently, additional arguments passed to fitting functions.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Comparison of REML fits is a priori not suitable for performing likelihood ratio tests. Nevertheless, it is possible to contrive them for testing purposes (Welham &amp; Thompson 1997). This function generalizes some of Wehlam &amp; Thompson's methods to GLMMs. 
</p>
<p>See Details in <code>LRT</code> for details of the bootstrap procedures.
</p>


<h3>Value</h3>

<p>An object of class <code>fixedLRT</code>, actually a list with as-yet unstable format, but here with  typical elements (depending on the options)
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fullfit</code></td>
<td>
<p>the HLfit object for the full model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullfit</code></td>
<td>
<p>the HLfit object for the null model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRTori</code></td>
<td>
<p>A likelihood ratio chi-square statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRTprof</code></td>
<td>
<p>Another likelihood ratio chi-square statistic, after a profiling step, if any. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the number of degrees of freedom of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.info</code></td>
<td>
<p>Information on various steps of the computation.  </p>
</td>
</tr>
</table>
<p>and, if a bootstrap was performed, the additional elements described in <code>LRT</code>. 
</p>


<h3>References</h3>

<p>Rousset F., Ferdy, J.-B. (2014) Testing environmental and genetic effects in the presence of spatial autocorrelation. Ecography, 37: 781-790.
<a href="https://doi.org/10.1111/ecog.00566">doi:10.1111/ecog.00566</a>
</p>
<p>Welham, S. J., and Thompson, R. (1997) Likelihood ratio tests for fixed model
terms using residual maximum likelihood, J. R. Stat. Soc. B 59, 701-714.
</p>


<h3>See Also</h3>

<p>See <code>LRT</code> for simular tests with a different interface, and perhaps <code>as_LMLT</code> for access to a different testing approach for LMMs, implemented in <code>lmerTest::contest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (spaMM.getOption("example_maxtime")&gt;1.9) {
 data("blackcap")
 ## result comparable to the corrHLfit examples based on blackcap
 fixedLRT(null.formula=migStatus ~ 1 + Matern(1|longitude+latitude),
       formula=migStatus ~ means + Matern(1|longitude+latitude), 
       method='ML',data=blackcap)
}
if (spaMM.getOption("example_maxtime")&gt;156) {
 ## longer version with bootstrap
 fixedLRT(null.formula=migStatus ~ 1 + Matern(1|longitude+latitude),
       formula=migStatus ~ means + Matern(1|longitude+latitude), 
       method='ML',data=blackcap, boot.repl=100, seed=123) 
 }
</code></pre>


</div>