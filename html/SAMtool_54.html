<div class="container">

<table style="width: 100%;"><tr>
<td>posterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample posterior of TMB models in SAMtool</h2>

<h3>Description</h3>

<p>A convenient wrapper function (<code>posterior</code>) to sample the posterior using MCMC in rstan
and returns a <code>stanfit</code> object for diagnostics. Use <code>RCMstan</code> to update the RCM and the enclosed operating model
with MCMC samples..
</p>


<h3>Usage</h3>

<pre><code class="language-R">posterior(x, ...)

## S4 method for signature 'RCModel'
posterior(
  x,
  priors_only = FALSE,
  laplace = FALSE,
  chains = 2,
  iter = 2000,
  warmup = floor(iter/2),
  thin = 5,
  seed = 34,
  init = "last.par.best",
  cores = chains,
  ...
)

## S4 method for signature 'Assessment'
posterior(x, priors_only = FALSE, ...)

RCMstan(RCModel, stanfit, sim, cores = 1, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class Assessment or RCModel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>rstan::sampling</code> via <code>tmbstan::tmbstan</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors_only</code></td>
<td>
<p>Logical, whether to set the likelihood to zero and sample the priors only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>laplace</code></td>
<td>
<p>Logical, whether to do the Laplace approximation for random parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>The numer of MCMC chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations for each chain, including warmup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmup</code></td>
<td>
<p>The number of burnin iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The frequency at which iterations are kept (e.g., <code>5</code> saves every fifth iteration)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for random number generator during the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The initial values of parameters for starting the MCMC chain. See <code>tmbstan::tmbstan</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>The number of cores for running in parallel, e.g., one core per MCMC chain. Used in <code>RCMstan</code>
for reconstructing the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCModel</code></td>
<td>
<p>An object of class <code>RCModel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stanfit</code></td>
<td>
<p>An object of class <code>stanfit</code> returned by <code>posterior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>A matrix of <code>RCModel@OM@nsim</code> rows and 2 columns that specifies the samples used to update the
operating model. The first column specifies the chain and the second columns specifies the MCMC iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical to indicate if progress messages should be printed to console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>posterior</code> returns an object of class <code>stanfit</code>. See <code>class?stanfit</code>.
</p>
<p><code>RCMstan</code> returns an updated <code>RCModel</code>.
</p>


<h3>Online Documentation</h3>

<p>A vignette on the steps to run the MCMC is available on the openMSE
<a href="https://openmse.com/tutorial-rcm/4-case-study-mcmc/">website</a>.
</p>


<h3>Author(s)</h3>

<p>Q. Huynh
</p>


</div>