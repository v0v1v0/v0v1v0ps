<div class="container">

<table style="width: 100%;"><tr>
<td>raven.to.wave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export sample <code>".wav"</code> files using selections from Raven Pro software.</h2>

<h3>Description</h3>

<p>Create one <code>".wav"</code> file for each selection created using <a href="https://www.ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software, which is commonplace in bioacoustical analysis. Each selection (i.e. line in table) should represent an acoustic unit from the sample study.
</p>


<h3>Usage</h3>

<pre><code class="language-R">raven.to.wave(
  orig.wav.folder = NULL,
  raven.at = orig.wav.folder,
  wav.samples = "wav samples"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orig.wav.folder</code></td>
<td>
<p>filepath to the folder where original <code>".wav"</code> files are stored. Should be presented between quotation marks. By default: <code>orig.wav.folder = NULL</code> (i.e. user must specify the filepath to <code>".wav"</code> files)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raven.at</code></td>
<td>
<p>filepath to the folder where selection tables from <a href="https://www.ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software are stored. Should be presented between quotation marks. File name should end with <code>"selections.txt"</code>. By default: <code>raven.at = orig.wav.folder</code> (i.e. raven tables stored in the same folder as original  <code>".wav"</code> files)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wav.samples</code></td>
<td>
<p>folder where new <code>".wav"</code> files will be stored. Can be either a filepath to the intended folder, or the name of the folder i.e.(<code>wav.samples = "wav samples"</code>). In the later case, a new folder will be created within the one specified by <code>orig.wav.folder</code>. Should be presented between quotation marks. By default: <code>wav.samples = "wav samples"</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code>align.wave</code>, <code>raven.list</code>,
</p>
<p>Useful links:
</p>

<ul>
<li>
<p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li>
<p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a>
</p>
</li>
<li>
<p>Raven Pro software <a href="https://www.ravensoundsoftware.com/software/raven-pro/">https://www.ravensoundsoftware.com/software/raven-pro/</a></p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Create folders on your console  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Create temporary folder to store original ".wav" files containing multiple units
orig.wav &lt;- file.path(base::tempdir(), "original wave")
if(!dir.exists(orig.wav)) dir.create(orig.wav)

# Create temporary folder to store sample ".wav" files from original recordings
wav.at &lt;- file.path(base::tempdir(), "wav samples")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "output")
if(!dir.exists(store.at)) dir.create(store.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#   Select acoustic units based on Raven Pro selections   #
#                                                         #
#              Using raven.to.wav function                #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Export original sample ".wav" files from SoundShape examples
tuneR::writeWave(centralis, extensible = TRUE,
                filename = file.path(orig.wav, "centralis.wav"))
tuneR::writeWave(cuvieri, extensible = TRUE,
                filename = file.path(orig.wav, "cuvieri.wav"))
tuneR::writeWave(kroyeri, extensible = TRUE,
                filename = file.path(orig.wav, "kroyeri.wav"))

# Store Raven Pro selection tables at same folder from original ".wav" files
for(i in 1:length(raven.list)){
 write.table(raven.list[i], file=file.path(orig.wav, names(raven.list)[i]),
               quote=FALSE, sep="\t", row.names = FALSE,
               col.names = colnames(raven.list[[i]]))  } # end loop


# Verify if folder has both original ".wav" files and Raven's selections
dir(orig.wav)

###
## Start here when using your own recordings

# Export a ".wav" sample for each selection made in Raven Pro
raven.to.wave(orig.wav.folder = orig.wav, wav.samples = wav.at)

# Verify samples
dir(wav.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Align acoustic units using align.wave  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Place sounds at the beginning of a sound window
align.wave(wav.at=wav.at, wav.to="Aligned",
          time.length = 0.8, time.perc = 0.005, dBlevel = 25)

# Verify alignment using analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", wav.at = file.path(wav.at, "Aligned"),
          dBlevel = 25, store.at=store.at, plot.exp=TRUE,
          flim=c(0, 4), tlim=c(0, 0.8), add.contour = TRUE)
# Go to folder specified by store.at and check jpeg files created
# If alignment/window dimensions are not ideal, repeat process with new settings




</code></pre>


</div>