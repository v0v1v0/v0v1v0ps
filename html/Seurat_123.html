<div class="container">

<table style="width: 100%;"><tr>
<td>FindNeighbors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Shared) Nearest-neighbor graph construction</h2>

<h3>Description</h3>

<p>Computes the <code>k.param</code> nearest neighbors for a given dataset. Can also
optionally (via <code>compute.SNN</code>), construct a shared nearest neighbor
graph by calculating the neighborhood overlap (Jaccard index) between every
cell and its <code>k.param</code> nearest neighbors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindNeighbors(object, ...)

## Default S3 method:
FindNeighbors(
  object,
  query = NULL,
  distance.matrix = FALSE,
  k.param = 20,
  return.neighbor = FALSE,
  compute.SNN = !return.neighbor,
  prune.SNN = 1/15,
  nn.method = "annoy",
  n.trees = 50,
  annoy.metric = "euclidean",
  nn.eps = 0,
  verbose = TRUE,
  l2.norm = FALSE,
  cache.index = FALSE,
  index = NULL,
  ...
)

## S3 method for class 'Assay'
FindNeighbors(
  object,
  features = NULL,
  k.param = 20,
  return.neighbor = FALSE,
  compute.SNN = !return.neighbor,
  prune.SNN = 1/15,
  nn.method = "annoy",
  n.trees = 50,
  annoy.metric = "euclidean",
  nn.eps = 0,
  verbose = TRUE,
  l2.norm = FALSE,
  cache.index = FALSE,
  ...
)

## S3 method for class 'dist'
FindNeighbors(
  object,
  k.param = 20,
  return.neighbor = FALSE,
  compute.SNN = !return.neighbor,
  prune.SNN = 1/15,
  nn.method = "annoy",
  n.trees = 50,
  annoy.metric = "euclidean",
  nn.eps = 0,
  verbose = TRUE,
  l2.norm = FALSE,
  cache.index = FALSE,
  ...
)

## S3 method for class 'Seurat'
FindNeighbors(
  object,
  reduction = "pca",
  dims = 1:10,
  assay = NULL,
  features = NULL,
  k.param = 20,
  return.neighbor = FALSE,
  compute.SNN = !return.neighbor,
  prune.SNN = 1/15,
  nn.method = "annoy",
  n.trees = 50,
  annoy.metric = "euclidean",
  nn.eps = 0,
  verbose = TRUE,
  do.plot = FALSE,
  graph.name = NULL,
  l2.norm = FALSE,
  cache.index = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>Matrix of data to query against object. If missing, defaults to
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.matrix</code></td>
<td>
<p>Boolean value of whether the provided matrix is a
distance matrix; note, for objects of class <code>dist</code>, this parameter will
be set automatically</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.param</code></td>
<td>
<p>Defines k for the k-nearest neighbor algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.neighbor</code></td>
<td>
<p>Return result as <code>Neighbor</code> object. Not
used with distance matrix input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.SNN</code></td>
<td>
<p>also compute the shared nearest neighbor graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune.SNN</code></td>
<td>
<p>Sets the cutoff for acceptable Jaccard index when
computing the neighborhood overlap for the SNN construction. Any edges with
values less than or equal to this will be set to 0 and removed from the SNN
graph. Essentially sets the stringency of pruning (0 — no pruning, 1 —
prune everything).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn.method</code></td>
<td>
<p>Method for nearest neighbor finding. Options include: rann,
annoy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees</code></td>
<td>
<p>More trees gives higher precision when using annoy approximate
nearest neighbor search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annoy.metric</code></td>
<td>
<p>Distance metric for annoy. Options include: euclidean,
cosine, manhattan, and hamming</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn.eps</code></td>
<td>
<p>Error bound when performing nearest neighbor seach using RANN;
default of 0.0 implies exact nearest neighbor search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether or not to print output to the console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2.norm</code></td>
<td>
<p>Take L2Norm of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache.index</code></td>
<td>
<p>Include cached index in returned Neighbor object
(only relevant if return.neighbor = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Precomputed index. Useful if querying new data against existing
index to avoid recomputing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Features to use as input for building the (S)NN; used only when
<code>dims</code> is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>Reduction to use as input for building the (S)NN</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dims</code></td>
<td>
<p>Dimensions of reduction to use as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Assay to use in construction of (S)NN; used only when <code>dims</code>
is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>
<p>Plot SNN graph on tSNE coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.name</code></td>
<td>
<p>Optional naming parameter for stored (S)NN graph
(or Neighbor object, if return.neighbor = TRUE). Default is assay.name_(s)nn.
To store both the neighbor graph and the shared nearest neighbor (SNN) graph,
you must supply a vector containing two names to the <code>graph.name</code>
parameter. The first element in the vector will be used to store the nearest
neighbor (NN) graph, and the second element used to store the SNN graph. If
only one name is supplied, only the NN graph is stored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function can either return a <code>Neighbor</code> object
with the KNN information or a list of <code>Graph</code> objects with
the KNN and SNN depending on the settings of <code>return.neighbor</code> and
<code>compute.SNN</code>. When running on a <code>Seurat</code> object, this
returns the <code>Seurat</code> object with the Graphs or Neighbor objects
stored in their respective slots. Names of the Graph or Neighbor object can
be found with <code>Graphs</code> or <code>Neighbors</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("pbmc_small")
pbmc_small
# Compute an SNN on the gene expression level
pbmc_small &lt;- FindNeighbors(pbmc_small, features = VariableFeatures(object = pbmc_small))

# More commonly, we build the SNN on a dimensionally reduced form of the data
# such as the first 10 principle components.

pbmc_small &lt;- FindNeighbors(pbmc_small, reduction = "pca", dims = 1:10)

</code></pre>


</div>