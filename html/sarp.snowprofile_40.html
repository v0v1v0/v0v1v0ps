<div class="container">

<table style="width: 100%;"><tr>
<td>plot.snowprofileSet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a single layer property in multiple profiles side-by-side</h2>

<h3>Description</h3>

<p>A flexible function to plot multiple snowprofiles either in a timeseries or various types of groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'snowprofileSet'
plot(
  x,
  SortMethod = c("time", "unsorted", "hs", "elev", "presorted"),
  ColParam = c("gtype", "hardness", "density", "temp", "gsize", "ssi", "p_unstable",
    "crit_cut_length", "rta", "percentage"),
  TopDown = FALSE,
  DateStart = NA,
  DateEnd = NA,
  Timeseries_labels = c("weekly", "monthly", NA),
  ylim = NULL,
  OutlineLyrs = FALSE,
  emphasizeLayers = NULL,
  colAlpha = NA,
  colEmphasis = NA,
  OutlineProfile = NULL,
  HorizGrid = TRUE,
  VerticalGrid = TRUE,
  yaxis = TRUE,
  main = NA,
  ylab = NA,
  xlab = NA,
  box = TRUE,
  xticklabels = FALSE,
  xtick.las = 2,
  yPadding = 10,
  xPadding = 0.5,
  hardnessResidual = 1,
  hardnessScale = 1,
  hardnessOffset = -0.5,
  k = NULL,
  offset = as.Date(NA),
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class snowprofileSet</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SortMethod</code></td>
<td>
<p>How to arrange profiles along the x-axis. Options include timeseries (default = 'time'), in existing order of Profiles list ('unsorted'), sorted by HS ('hs'), or elevation ('elev')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ColParam</code></td>
<td>
<p>What parameter to show with colour. So far the following types are available: "gtype", "hardness", "density", "temp", "gsize", "ssi", "p_unstable", "crit_cut_length", "rta", "percentage".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TopDown</code></td>
<td>
<p>Option to plot by depth instead of height with zero depth on top of plot (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DateStart</code></td>
<td>
<p>Start date for timeseries plots (<code>SortMethod = 'time'</code>). If not provided, the function takes the date range from Profiles (default = NA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DateEnd</code></td>
<td>
<p>End date for timeseries plots (<code>SortMethod = 'time'</code>). If not provided, the function takes the date range from Profiles (default = NA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Timeseries_labels</code></td>
<td>
<p>Label Saturdays "weekly", "monthly", or <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Vertical range of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OutlineLyrs</code></td>
<td>
<p>Switch for outlining layers (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emphasizeLayers</code></td>
<td>
<p>emphasize layers with different transparency than others, or a different color altogether? then set this argument to <code>TRUE</code> if you want to emphasize all
labeled layers of interest (aka weak layers), or provide a named list with arguments to a function call to findPWL to define which layers to emphasize.
Set either <code>colAlpha</code> or <code>colEmphasis</code> to make the emphasis apparent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colAlpha</code></td>
<td>
<p>the transparency setting for all layers (except the ones to be emphasized if you want to emphasize any). This can be useful for example
if you want to overplot the grain type sequences with another variable, e.g. a percentage from a distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colEmphasis</code></td>
<td>
<p>the color of the layers to be emphasized (only if you want a different color than defined by <code>ColParam</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OutlineProfile</code></td>
<td>
<p>vector of profile indices that will be outlined to highlight them</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HorizGrid</code></td>
<td>
<p>Draw horizontal grid at layer heights (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VerticalGrid</code></td>
<td>
<p>Draw vertical grid at xticks (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>draw a y-axis? (either <code>FALSE</code>, <code>TRUE</code> draws yaxis left, <code>"right"</code> draws yaxis on the right plot side)
<em>Note</em> that in case of <code>"right"</code> you need to adjust <code>par(mar = ...)</code>, disable <code>ylab</code> and manually draw an xlab with <code>mtext</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label; disable ylab by providing an empty string (i.e., ylab = ”)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label; disable xlab by providing an empty string (i.e., xlab = ”)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>Draw a box around the plot (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xticklabels</code></td>
<td>
<p>Label the profiles with their "names", "originalIndices" (prior to sorting), "dates", or a custom character array</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtick.las</code></td>
<td>
<p>Orientation of labels if xticklabels is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yPadding</code></td>
<td>
<p>Padding between ylim and limits of data, default = 10.
Note that R will still put padding by default. If you want to prohibit that entirely, specify <code>xaxs ='i'</code>, or <code>yaxs = 'i'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xPadding</code></td>
<td>
<p>Padding between xlim and limits of data, default = 0.5.
Note that R will still put padding by default. If you want to prohibit that entirely, specify <code>xaxs = 'i'</code>, or <code>yaxs = 'i'</code>. For xPadding, you can provide either a scalar, or
a length 2 numeric for left and right hand side, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hardnessResidual</code></td>
<td>
<p>Value within <code style="white-space: pre;">⁠[0, 1]⁠</code> to control the minimum horizontal space of each layer that will be colored
irrespective of the layer's hardness. A value of <code>1</code> corresponds to no hardness being shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hardnessScale</code></td>
<td>
<p>A scaling factor that exaggerates the hardness profile to subsequent cells on the x-axis. Useful
for time series of sparse profile observations. Note that this scaling factor is unused when <code>hardnessScale = 1</code> and that
it gets more influential the smaller <code>hardnessScale</code> gets. Also note, that a <code>hardnessScale &gt; 1</code> can lead to profiles overlapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hardnessOffset</code></td>
<td>
<p>offsets the profile location on the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a sorting vector if <code>SortMethod = "presorted"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Provide a Date or POSIXct offset if you want to offset the vertical snow height/depth axis so that the offset date aligns with snow depth/height 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>add the plot to an existing plot, or create new plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to plot()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The routine allows you to plot coloured sequences only, or to include hardness profile information as well. See parameter
<code>hardnessResidual</code> and the examples for more details.
To change the font size of labels etc, use <code>par()</code> with the parameters <code>cex.lab</code>, <code>cex.axis</code>, etc.
</p>


<h3>Author(s)</h3>

<p>shorton, fherla, phaegeli
</p>


<h3>See Also</h3>

<p>plot.snowprofile, SPgroup
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Standard profile timeline (e.g. https://niviz.org)
plot(SPtimeline)

## Group of profiles with same timestamp
plot(SPgroup, SortMethod = 'unsorted')  # sorted in same order as list
plot(SPgroup, SortMethod = 'hs') # sorted by snow height
plot(SPgroup, SortMethod = 'elev') # sorted by elevation

## Colour layers by other properties
plot(SPtimeline, ColParam = 'density')

## Align layers by depth instead of height
plot(SPtimeline, TopDown = TRUE)

## Timelines with specific date ranges
plot(SPtimeline, DateEnd = '2017-12-17')
plot(SPtimeline, DateStart = '2017-12-15', DateEnd = '2017-12-17')

## Show hardness profile, too:
plot(SPtimeline, hardnessResidual = 0.5)

## Additional examples of plot dimensions and labelling
## Label the indices of the profiles in the list:
plot(SPgroup, SortMethod = 'elev', xticklabels = "originalIndices")
##  ... and with minimized axis limits and their station ID names:
plot(SPgroup, SortMethod = 'elev', xticklabels = sapply(SPgroup, function(x) x$station_id),
       yPadding = 0, xPadding = 0, xaxs = 'i', yaxs = 'i')
##  sorted by depth, and without box:
plot(SPgroup, SortMethod = 'hs', TopDown = TRUE, box = FALSE)

## Apply a date offset to investigate which layers formed around that day of interest:
pwl_exists &lt;- sapply(SPgroup, function(sp)
  {length(findPWL(sp, pwl_date = "2019-01-21", pwl_gtype = c("SH", "DH"),
                  date_range_earlier = as.difftime(2, unit = "days"))) &gt; 0})
k &lt;- order(pwl_exists, decreasing = TRUE)
plot(SPgroup, SortMethod = 'presorted', k = k, xticklabels = "originalIndices",
     offset = as.Date("2019-01-21"), xlab = "&lt;-- Jan 21 PWL exists | does not exist --&gt;")
abline(v = max(which(pwl_exists[k]))+0.5, lty = "dashed")

## Emphasize specific layers
## (i) all labeled layers of interest:
SPgroup &lt;- snowprofileSet(lapply(SPgroup, labelPWL))  # label layers with default settings
plot(SPgroup, SortMethod = "hs", emphasizeLayers = TRUE, colAlpha = 0.3)
## (ii) specific individual layers:
plot(SPgroup, SortMethod = "hs",
     emphasizeLayers = list(pwl_gtype = c("SH", "DH"), pwl_date = "2019-01-21"),
     colAlpha = 0.3, colEmphasis = "black")


</code></pre>


</div>