<div class="container">

<table style="width: 100%;"><tr>
<td>BootsChapt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bootstrap (Permutation) Test of Change-Point(s) with One-Change or Epidemic Alternative</h2>

<h3>Description</h3>

<p>By resampling with(out) replacement from the original sample data,
we can obtain bootstrap(permutation) versions of the test statistics.
The <code>p</code>-values of the test(s) from the original data are approximated by the
<code>p</code>-values of the bootstrap(permutation) version statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BootsChapt(x, stat1, stat2 = NULL, B, replace = FALSE, 
    alternative = c("one.change", "epidemic"), adj.Wn = FALSE, 
    tol = 1.0e-7, maxit = 50,trace = FALSE,... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector or matrix containing the data, one row per observation; </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat1</code></td>
<td>
<p>test statistic <code>Sn</code> for <code>"one-change"</code> alternative or <code>Vn</code> for 
<code>"epidemic"</code> alternative,
output of <code>SemiparChangePoint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat2</code></td>
<td>
<p>test statistic <code>Wn</code> for <code>"epidemic"</code> alternative, output of <code>SemiparChangePoint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> number of resamples </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p> a logical indicating whether bootstrap samples for bootstrap test
of the change-point are selected with or without replacement, if <code>replace</code>= FALSE (default),
corresponds to permutation test, otherwise, bootstrap test; </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.Wn</code></td>
<td>
<p> logical indicating if <code>Wn</code> should be adjusted or not
for <code>"epidemic"</code> alternative. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code>glm.control</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code>glm.control</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code>glm.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The procedure will fail when there is separation in the data in the
sense of Albert \&amp; Anderson(1984, <em>Biometrika</em>) and Santner \&amp; Duffy (1986, <em>Biometrika</em>).
In this case, the change-point(s) may be detected easily using nonparametric method
based on cumsum. Now, this program does not check whether the data is separated.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p.boots</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Sn</code> for <code>"one-change"</code> alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.boots.Vn</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Vn</code> for <code>"epidemic"</code> alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.boots.Wn</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Wn</code> for <code>"epidemic"</code> alternative</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Default alternative is <code>"one-change"</code>, even when <code>stat2</code> is not NULL.
If <code>alternative = "epidemic"</code>, both <code>stat1</code> and <code>stat2</code> should be provided.
Statistic <code>Wn</code> need be adjusted only for one dimensional observations
and if no bootstrap test is conducted. However, if <code>Wn</code> is already adjusted, you have to asign
<code>adj.Wn = TRUE</code> to calculate the <code>p</code>-value of <code>Wn</code>.</p>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric changepoint model, <em>Biometrika</em>, 91, 4, 849â€“862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code>SemiparChangePoint</code>, <code>schapt</code>, <code>p.OneChange</code>, <code>p.Epidemic.Vn</code>, <code>p.Epidemic.Wn</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">require(sac) #load the package

# one-change alternative
k&lt;-10
n&lt;-20
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
T&lt;-SemiparChangePoint(x, alternative = "one.change")$Sn
BootsChapt(x, T, B = 5)
    #Choose larger B to get better approximate p-value.
</code></pre>


</div>