<div class="container">

<table style="width: 100%;"><tr>
<td>SpatialKWD-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Kantorovich-Wasserstein Distances for Large Spatial Maps
</h2>

<h3>Description</h3>

<p>The Spatial-KWD package contains efficient implementations of Discrete Optimal Transport algorithms for the computation of Kantorovich-Wasserstein distances [1], customized for large spatial maps.
All the algorithms are based on an ad-hoc implementation of the Network Simplex algorithm [2].
Each implemented algorithm builds a different network, exploiting the particular structure of spatial maps.
</p>


<h3>Details</h3>

<p>This library contains four helper functions and two classes [4].
</p>
<p>The four helper functions are <code>compareOneToOne</code>, <code>compareOneToMany</code>, <code>compareAll</code>, and <code>focusArea</code>. All the functions take in input the data and an options list. Using the options is possible to configure the Kantorivich-Wasserstein solver, so that it uses different algorithms with different parameters.
</p>
<p>The helper functions are built on top of two main classes: <code>Histogram2D</code> and <code>Solver</code>.
</p>
<p>Note that in non-convex maps, the algorithm builds the convex-hull of the input bins and pads the weights with zeros.
</p>
<p>In the case of spatial histograms with weights that do not sum up to 1, all the weights can optionally be rescaled in such a way the overall sum of the weights of every single histogram is equal to 1.0: <code class="reqn">w_i \gets \frac{w_i}{\sum_{i=1,\dots,n} w_i}</code>.
This way, the spatial histograms have a natural interpretation as discrete probability measures.
</p>
<p>For a detailed introduction on Computational Optimal Transport, we refer the reader to [3].
</p>


<h3>Author(s)</h3>

<p>Stefano Gualandi, stefano.gualandi@gmail.com.
</p>
<p>Maintainer: Stefano Gualandi &lt;stefano.gualandi@gmail.com&gt;
</p>


<h3>References</h3>

<p>[1] Bassetti, F., Gualandi, S. and Veneroni, M., 2020. "On the Computation of Kantorovichâ€“Wasserstein Distances Between Two-Dimensional Histograms by Uncapacitated Minimum Cost Flows". SIAM Journal on Optimization, 30(3), pp.2441-2469.
</p>
<p>[2] Cunningham, W.H., 1976. "A Network Simplex method". Mathematical Programming, 11(1), pp.105-116.
</p>
<p>[3] Peyre, G., and Cuturi, M., 2019. "Computational optimal transport: With applications to data science". Foundations and Trends in Machine Learning, 11(5-6), pp.355-607.
</p>
<p>[4] <a href="https://github.com/eurostat/Spatial-KWD">https://github.com/eurostat/Spatial-KWD</a>
</p>


<h3>See Also</h3>

<p>See also <code>compareOneToOne</code>, <code>compareOneToMany</code>, <code>compareAll</code>, <code>focusArea</code>, <code>Histogram2D</code>, and <code>Solver</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpatialKWD)

# Random coordinates
N = 90
Xs &lt;- as.integer(runif(N, 0, 31))
Ys &lt;- as.integer(runif(N, 0, 31))
coordinates &lt;- matrix(c(Xs, Ys), ncol=2)

# Random weights
weights &lt;- matrix(runif(2*N, 0, 1), ncol=2)

# Compute distance
print("Compare one-to-one with exact algorithm:")
d &lt;- compareOneToOne(coordinates, weights, L=3)
cat("runtime:", d$runtime, " distance:", d$distance, "\n")
</code></pre>


</div>