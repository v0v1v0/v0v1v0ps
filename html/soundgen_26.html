<div class="container">

<table style="width: 100%;"><tr>
<td>.spectrogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectrogram per sound</h2>

<h3>Description</h3>

<p>Internal soundgen function called by <code>spectrogram</code> and
<code>analyze</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.spectrogram(
  audio,
  dynamicRange = 80,
  windowLength = 50,
  step = windowLength/2,
  overlap = NULL,
  specType = c("spectrum", "reassigned", "spectralDerivative")[1],
  rasterize = FALSE,
  wn = "gaussian",
  zp = 0,
  normalize = TRUE,
  smoothFreq = 0,
  smoothTime = 0,
  qTime = 0,
  percentNoise = 10,
  noiseReduction = 0,
  output = c("original", "processed", "complex", "all")[1],
  plot = TRUE,
  osc = c("none", "linear", "dB")[2],
  heights = c(3, 1),
  ylim = NULL,
  yScale = "linear",
  contrast = 0.2,
  brightness = 0,
  blur = 0,
  maxPoints = c(1e+05, 5e+05),
  padWithSilence = TRUE,
  colorTheme = c("bw", "seewave", "heat.colors", "...")[1],
  col = NULL,
  extraContour = NULL,
  xlab = NULL,
  ylab = NULL,
  xaxp = NULL,
  mar = c(5.1, 4.1, 4.1, 2),
  main = NULL,
  grid = NULL,
  width = 900,
  height = 500,
  units = "px",
  res = NA,
  internal = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>audio</code></td>
<td>
<p>a list returned by <code>readAudio</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dynamicRange</code></td>
<td>
<p>dynamic range, dB. All values more than one dynamicRange
under maximum are treated as zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowLength</code></td>
<td>
<p>length of FFT window, ms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>you can override <code>overlap</code> by specifying FFT step, ms (NB:
because digital audio is sampled at discrete time intervals of
1/samplingRate, the actual step and thus the time stamps of STFT frames
may be slightly different, eg 24.98866 instead of 25.0 ms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>overlap between successive FFT frames, %</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specType</code></td>
<td>
<p>plot the original FFT ('spectrum'), reassigned spectrogram
('reassigned'), or spectral derivative ('spectralDerivative')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rasterize</code></td>
<td>
<p>(only applies if specType = 'reassigned') if TRUE, the
reassigned spectrogram is plotted after rasterizing it: that is, showing
density per time-frequency bins with the same resolution as an ordinary
spectrogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window type accepted by <code>ftwindow</code>, currently
gaussian, hanning, hamming, bartlett, blackman, flattop, rectangle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zp</code></td>
<td>
<p>window length after zero padding, points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>if TRUE, scales input prior to FFT</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothFreq, smoothTime</code></td>
<td>
<p>length of the window for median smoothing in
frequency and time domains, respectively, points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qTime</code></td>
<td>
<p>the quantile to be subtracted for each frequency bin. For ex.,
if qTime = 0.5, the median of each frequency bin (over the entire sound
duration) will be calculated and subtracted from each frame (see examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentNoise</code></td>
<td>
<p>percentage of frames (0 to 100%) used for calculating
noise spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseReduction</code></td>
<td>
<p>how much noise to remove (non-negative number,
recommended 0 to 2). 0 = no noise reduction, 2 = strong noise reduction:
<code class="reqn">spectrum - (noiseReduction * noiseSpectrum)</code>, where noiseSpectrum is
the average spectrum of frames with entropy exceeding the quantile set by
<code>percentNoise</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>specifies what to return: nothing ('none'), unmodified
spectrogram ('original'), denoised and/or smoothed spectrogram
('processed'), or unmodified spectrogram with the imaginary part giving
phase ('complex')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>should a spectrogram be plotted? TRUE / FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>osc</code></td>
<td>
<p>"none" = no oscillogram; "linear" = on the original scale; "dB" =
in decibels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights</code></td>
<td>
<p>a vector of length two specifying the relative height of the
spectrogram and the oscillogram (including time axes labels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>frequency range to plot, kHz (defaults to 0 to Nyquist
frequency). NB: still in kHz, even if yScale = bark, mel, or ERB</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yScale</code></td>
<td>
<p>scale of the frequency axis: 'linear' = linear, 'log' =
logarithmic (musical), 'bark' = bark with <code>hz2bark</code>,
'mel' = mel with <code>hz2mel</code>, 'ERB' = Equivalent
Rectangular Bandwidths with <code>HzToERB</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>spectrum is exponentiated by contrast (any real number,
recommended -1 to +1). Contrast &gt;0 increases sharpness, &lt;0 decreases
sharpness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brightness</code></td>
<td>
<p>how much to "lighten" the image (&gt;0 = lighter, &lt;0 = darker)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blur</code></td>
<td>
<p>apply a Gaussian filter to blur or sharpen the image, two
numbers: frequency (Hz), time (ms). A single number is interpreted as
frequency, and a square filter is applied. NA / NULL / 0 means no blurring
in that dimension. Negative numbers mean un-blurring (sharpening) the image
by dividing instead of multiplying by the filter during convolution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPoints</code></td>
<td>
<p>the maximum number of "pixels" in the oscillogram (if any)
and spectrogram; good for quickly plotting long audio files; defaults to
c(1e5, 5e5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padWithSilence</code></td>
<td>
<p>if TRUE, pads the sound with just enough silence to
resolve the edges properly (only the original region is plotted, so the
apparent duration doesn't change)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorTheme</code></td>
<td>
<p>black and white ('bw'), as in seewave package ('seewave'),
matlab-type palette ('matlab'), or any palette from
<code>palette</code> such as 'heat.colors', 'cm.colors', etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>actual colors, eg rev(rainbow(100)) - see ?hcl.colors for colors
in base R (overrides colorTheme)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraContour</code></td>
<td>
<p>a vector of arbitrary length scaled in Hz (regardless of
yScale!) that will be plotted over the spectrogram (eg pitch contour); can
also be a list with extra graphical parameters such as lwd, col, etc. (see
examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main, mar, xaxp</code></td>
<td>
<p>graphical parameters for plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>if numeric, adds n = <code>grid</code> dotted lines per kHz</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height, units, res</code></td>
<td>
<p>graphical parameters for saving plots passed to
<code>png</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>a long list of stuff for plotting pitch contours passed by
analyze()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters</p>
</td>
</tr>
</table>
</div>