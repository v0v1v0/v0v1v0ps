<div class="container">

<table style="width: 100%;"><tr>
<td>summary.kernel_sievePH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summarizing Nonparametric Kernel-Smoothed Stratified Mark-Specific
Proportional Hazards Model Fits</h2>

<h3>Description</h3>

<p><code>summary</code> method for an object of class <code>kernel_sievePH</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'kernel_sievePH'
summary(
  object,
  contrast = c("te", "hr", "loghr"),
  sieveAlternative = c("twoSided", "oneSided"),
  confLevel = 0.95,
  ...
)

## S3 method for class 'summary.kernel_sievePH'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>kernel_sievePH</code>, a result of a call to
<code>kernel_sievePH</code> and <code>kernel_sievePHaipw</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>a character string specifying the treatment effect parameter
of interest. The default value is <code>"te"</code> (treatment efficacy); other
options are <code>"hr"</code> (hazard ratio) and <code>"loghr"</code> (log hazard
ratio).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sieveAlternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis for the sieve tests, which can be either <code>"twoSided"</code>
(default) or <code>"oneSided"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confLevel</code></td>
<td>
<p>the confidence level (0.95 by default) of reported
confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>summary.kernel_sievePH</code>, usually a result of a call to <code>summary.kernel_sievePH</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of significant digits to use when printing (4 by default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>print.summary.kernel_sievePH</code> prints a formatted summary of
results. Inference about coefficients in the kernel-smoothed mark-specific
proportional hazards model is tabulated. Additionally, a summary is
generated
from the tests of two relevant null hypotheses: (1) {<code class="reqn">H_0: HR(v)=1</code> for
all <code class="reqn">v</code>}, and (2) {<code class="reqn">H_0: HR(v)=HR</code> for all <code class="reqn">v</code>}. For the tests
of (2), <code>sieveAlternative</code> controls the choice of the alternative
hypothesis.
</p>


<h3>Value</h3>

<p>An object of class <code>summary.kernel_sievePH</code>, which is a list
with the following components:
</p>

<ul>
<li> <p><code>estBeta</code>: a data frame summarizing point estimates and standard
errors of the mark-specific coefficients for treatment.
</p>
</li>
<li> <p><code>HRunity.2sided</code>: a data frame with test statistics (first row) and
corresponding p-values (second row) for testing <code class="reqn">H_{10}: HR(v) = 1</code> vs.
<code class="reqn">H_{1a}: HR(v) \neq 1</code> for any v <code class="reqn">\in [a, b]</code> (general
alternative). <code>TSUP1</code> is based on an extension of the classic Kolmogorov-Smirnov
supremum-based test. <code>Tint1</code> is a generalization
of the integration-based Cramer-von Mises test.
</p>
</li>
<li> <p><code>HRunity.1sided</code>: a data frame with test statistics (first row) and
corresponding p-values (second row) for testing <code class="reqn">H_{10}: HR(v) = 1</code> vs.
<code class="reqn">H_{1m}: HR(v) \leq 1</code> with strict inequality for some v <code class="reqn">\in [a, b]</code>
(monotone alternative). <code>TSUP1m</code> is based on an extension of the classic
Kolmogorov-Smirnov supremum-based test. <code>Tint1m</code> is a generalization
of the integration-based Cramer-von Mises test.
</p>
</li>
<li> <p><code>HRconstant.2sided</code>: a data frame with test statistics (first row) and
corresponding p-values (second row) for testing <code class="reqn">H_{20}</code>: HR(v) does not depend on v
<code class="reqn">\in [a, b]</code> vs. <code class="reqn">H_{2a}</code>: HR depends on v <code class="reqn">\in [a, b]</code>
(general alternative). <code>TSUP2</code> is based on an extension of the classic
Kolmogorov-Smirnov supremum-based test. <code>Tint2</code> is a generalization
of the integration-based Cramer-von Mises test.
This component is available if <code>sieveAlternative="twoSided"</code>.
</p>
</li>
<li> <p><code>HRconstant.1sided</code>: a data frame with test statistics (first row) and
corresponding p-values (second row) for testing <code class="reqn">H_{20}</code>: HR(v) does not depend on v
<code class="reqn">\in [a, b]</code> vs. <code class="reqn">H_{2m}</code>: HR increases as v increases <code class="reqn">\in [a, b]</code>
(monotone alternative). <code>TSUP2m</code> is based on an extension of the classic
Kolmogorov-Smirnov supremum-based test. <code>Tint2m</code> is a generalization
of the integration-based Cramer-von Mises test.
This component is available if <code>sieveAlternative="oneSided"</code>.
</p>
</li>
<li> <p><code>te</code>: a data frame summarizing point and interval estimates of the
mark-specific treatment efficacy on the grid of mark values defined by
<code>nvgrid</code> spanning from the minimum and maximum of the mark (available if <code>contrast="te"</code>).
The confidence level is specified by <code>confLevel</code>.
</p>
</li>
<li> <p><code>hr</code>: a data frame summarizing point and interval estimates of the
mark-specific hazard ratio on the grid of mark values defined by
<code>nvgrid</code> spanning from the minimum and maximum of the mark (available if
<code>contrast="hr"</code>). The confidence level is specified by <code>confLevel</code>.
</p>
</li>
<li> <p><code>loghr</code>: a data frame summarizing point and interval estimates of
the mark-specific log hazard ratio on the grid of mark values defined by
<code>nvgrid</code> spanning from the minimum and maximum of the mark (available if
<code>contrast="loghr"</code>). The confidence level is specified by
<code>confLevel</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Gilbert, P. B. and Sun, Y. (2015). Inferences on relative failure rates in
stratified mark-specific proportional hazards models with missing marks, with
application to human immunodeficiency virus vaccine efficacy trials.
<em>Journal of the Royal Statistical Society Series C: Applied Statistics</em>,
64(1), 49-73.
</p>
<p>Sun, Y. and Gilbert, P. B. (2012). Estimation of stratified mark‚Äêspecific
proportional hazards models with missing marks. <em>Scandinavian Journal of
Statistics</em>, 39(1), 34-52.
</p>


<h3>See Also</h3>

<p><code>kernel_sievePH</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20240410)
beta &lt;- 2.1
gamma &lt;- -1.3
n &lt;- 200
tx &lt;- rep(0:1, each = n / 2)
tm &lt;- c(rexp(n / 2, 0.2), rexp(n / 2, 0.2 * exp(gamma)))
cens &lt;- runif(n, 0, 15)
eventTime &lt;- pmin(tm, cens, 3)
eventInd &lt;- as.numeric(tm &lt;= pmin(cens, 3))
alpha &lt;- function(b){ log((1 - exp(-2)) * (b - 2) / (2 * (exp(b - 2) - 1))) }
mark0 &lt;- log(1 - (1 - exp(-2)) * runif(n / 2)) / (-2)
mark1 &lt;- log(1 + (beta - 2) * (1 - exp(-2)) * runif(n / 2) / (2 * exp(alpha(beta)))) /
  (beta - 2)
mark &lt;- ifelse(eventInd == 1, c(mark0, mark1), NA)
# the true TE(v) curve underlying the data-generating mechanism is:
# TE(v) = 1 - exp{alpha(beta) + beta * v + gamma}

# a binary auxiliary covariate
A &lt;- sapply(exp(-0.5 - 0.2 * mark) / (1 + exp(-0.5 - 0.2 * mark)),
            function(p){ ifelse(is.na(p), NA, rbinom(1, 1, p)) })
linPred &lt;- 1 + 0.4 * tx - 0.2 * A
probs &lt;- exp(linPred) / (1 + exp(linPred))
R &lt;- rep(NA, n)
while (sum(R, na.rm = TRUE) &lt; 10){
  R[eventInd == 1] &lt;- sapply(probs[eventInd == 1],
                             function(p){ rbinom(1, 1, p) })
}
# a missing-at-random mark
mark[eventInd == 1] &lt;- ifelse(R[eventInd == 1] == 1, mark[eventInd == 1], NA)

# AIPW estimation; auxiliary covariate is used (not required)
fit &lt;- kernel_sievePHaipw(eventTime, eventInd, mark, tx, aux = A,
                          auxType = "binary", formulaMiss = ~ eventTime,
                          formulaAux = ~ eventTime + tx + mark,
                          tau = 3, tband = 0.5, hband = 0.3, nvgrid = 20,
                          nboot = 20)
sfit &lt;- summary(fit)
# print the formatted summary
sfit
# treatment efficacy estimates on the grid
sfit$te

</code></pre>


</div>