<div class="container">

<table style="width: 100%;"><tr>
<td>lc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lethal Concentrations</h2>

<h3>Description</h3>

<p>Estimate the concentration to reach a certain mortality relative
to the control.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lc(model, response_name, response_level, reference, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>This can be one of three types of objects: Either the output of
<code>ecxsys</code> or the output of <code>predict_ecxsys</code> or a
data frame with a "concentration" column and a <code>response_name</code> column.
In the case of the data frame the first row is assumed to be the control.
See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_name</code></td>
<td>
<p>The name of the survival or stress for which you want to
calculate the LC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_level</code></td>
<td>
<p>The desired response level as a percentage between 0
and 100. For example with the value 10 the function will return the LC10,
i.e. the concentration where the response falls below 90 % of the control
response. In other words: where a mortality of 10 % relative to the control
is reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>The reference value of the response, usually the control at
concentration 0. This argument is optional. If it is missing, the first
value of the response is used as control. This value determines what number
<code>response_level</code> actually corresponds to. For example if
response_level is 10 and reference is 45, then the function returns the
concentration where the curve is reduced by 10% relative to 45 = 40.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>Logical. Should the function emit a warning if the calculation of
the lethal concentration is not possible?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the response level occurs multiple times because of hormesis, which may
happen for low values of <code>response_level</code>, then the occurrence with the
smallest concentration is returned.
</p>
<p>This function only makes sense for curves which generally go down with
increasing concentration, i.e. all <code>survival_*</code> curves and also
<code>sys_tox</code> and <code>sys_tox_env</code>. Others are untested and may give
unexpected results, if any.
</p>


<h3>Value</h3>

<p>A list containing the lethal concentration and the corresponding
survival. The survival will be <code>NA</code> if its calculation is impossible
using the supplied data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the LC10, the concentration where the survival falls
# below 90% of the survival in the control.

model &lt;- ecxsys(
    concentration = c(0, 0.05, 0.5, 5, 30),
    hormesis_concentration = 0.5,
    survival_tox_observed = c(90, 81, 92, 28, 0)
)

# using the ecxsys() output or the curves therein directly:
lc(model, "survival_tox_sys", 10)
lc(model$curves, "survival_tox_sys", 10)

# using the output of predict_ecxsys() with custom concentrations:
conc &lt;- 10^seq(-9, 1, length.out = 1000)
curves &lt;- predict_ecxsys(model, conc)
lc(curves, "survival_tox_sys", 10)

# using a custom data frame:
df_custom &lt;- data.frame(
    concentration = curves$concentration,
    foo = curves$survival_tox_sys
)
lc(df_custom, "foo", 10)

# Calculate the LC50 relative to an survival of 100
# instead of relative to the control:
lc(model, "survival_tox_sys", 50, reference = 100)

</code></pre>


</div>