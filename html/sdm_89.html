<div class="container">

<table style="width: 100%;"><tr>
<td>pa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converting probability of occurrence to Presence-absence</h2>

<h3>Description</h3>

<p>For many applications, the predicted probability of occurrence (habitat suitability) should be transformed to presence-absence given a threshold which can be selected based on some criteria through model evaluation. <code>pa</code> facilitates this transformation based on either the threshold specified by a user or extracted from the models (or ensemble of the mdoels).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pa(x,y,id,opt,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a SpatRaster object contains predicted probability of occurrence generated by the predict or ensemble functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>eithe a sdmModels (outcome of the sdm function) or a numeric vector with threshold values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>when <code>y</code> is sdmModels, <code>id</code> can be either a numeric vector specifying the modelIDs corresponding to the layers in <code>x</code>, or a single character "ensemble" to tell the function that the single layer in <code>x</code> is generated from the ensemble function, so the threshold should also be obtained based on ensemble</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>when <code>y</code> is sdmModels, <code>opt</code> specifies the optimisation criterion based on which a threshold is identified; default is opt=2 (see <code>evaluates</code> for more details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not implemented.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>if <code>id</code> is numeric, the number of layers in <code>x</code> (SpatRaster) should be the same as the length of <code>id</code>, but if <code>id = "ensemble"</code>, <code>nlyr(x)</code> should be 1.
</p>


<h3>Value</h3>

<p>a SpatRaster with presence-absence values
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# let's first fit a set of models and generate prediction and ensemble maps:

# get the path to the species data
file &lt;- system.file("external/sp1.shp", package="sdm") 

sp &lt;- vect(file) # read the species records

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list of predictor filenames

preds &lt;- rast(lst) # making a SpatRaster object (predictors)

d &lt;- sdmData(formula=Occurrence~., train=sp, predictors=preds)

d

# fit two models:
m &lt;- sdm(Occurrence~.,data=d,methods=c('glmp','brt'),replication='boot',n=1)

m 

# predictions:  
pr &lt;- predict(m, newdata=preds)

plot(pr)


# ensemble::    
en &lt;- ensemble(m, newdata=preds,setting=list(method='weighted',stat='AUC'))

plot(en)

#########################
# let's convert probabilities to Presence/absences:


# threshold is extracted for both models based on opt=2 (max[se+sp])
pr.pa &lt;- pa(pr, m, opt=2) 

plot(pr.pa)

# if only one of them was needed:

pr.pa1 &lt;- pa(pr[[1]],m, id=1,opt=2)

plot(pr.pa1)
#---------------
# if you have threshold values, you can directly use them in y:

th &lt;- getEvaluation(m,stat='threshold',opt=1) # get threshold values 

th

pr.pa &lt;- pa(pr, y=th[,2])

plot(pr.pa)
#--------------
# to convert to PA based on "ensemble":

en.pa &lt;- pa(en, m, id="ensemble", opt=2)

plot(en.pa)



## End(Not run)
</code></pre>


</div>