<div class="container">

<table style="width: 100%;"><tr>
<td>addSeason2formula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add Harmonics to an Existing Formula
</h2>

<h3>Description</h3>

<p>This function helps to construct a <code>formula</code> object that
can be used in a call to <code>hhh4</code> to model 
seasonal variation via a sum of sine and cosine terms. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">addSeason2formula(f = ~1, S = 1, period = 52, timevar = "t")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>formula that the seasonal terms should be added to, 
defaults to an intercept <code>~1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>number of sine and cosine terms. If <code>S</code> is a vector, 
unit-specific seasonal terms are created.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>

<p>period of the season, defaults to 52 for weekly data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timevar</code></td>
<td>

<p>the time variable in the model. Defaults to <code>"t"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function adds the seasonal terms
</p>
<p style="text-align: center;"><code class="reqn">
    \sin( s \cdot 2\pi \cdot \code{timevar}/\code{period} ),\;
    \cos( s \cdot 2\pi \cdot \code{timevar}/\code{period} ),
  </code>
</p>

<p>for <code class="reqn">s = 1,\dots,\code{S}</code> to an existing formula <code>f</code>.
</p>
<p>Note the following equivalence when interpreting the coefficients of
the seasonal terms:
</p>
<p style="text-align: center;"><code class="reqn">
    \gamma \sin(\omega t) + \delta \cos(\omega t) = 
    A \sin(\omega t + \epsilon)
  </code>
</p>

<p>with amplitude <code class="reqn">A = \sqrt{\gamma^2 + \delta^2}</code>
and phase shift <code class="reqn">\epsilon = \arctan(\delta / \gamma)</code>. 
The amplitude and phase shift can be obtained from a fitted
<code>hhh4</code> model via <code>coef(..., amplitudeShift = TRUE)</code>,
see <code>coef.hhh4</code>.
</p>


<h3>Value</h3>

<p>Returns a <code>formula</code> with the seasonal terms added and 
its environment set to <code>.GlobalEnv</code>.
Note that to use the resulting formula in <code>hhh4</code>, 
a time variable named as specified by the argument <code>timevar</code> must
be available.
</p>


<h3>Author(s)</h3>

<p>M. Paul, with contributions by S. Meyer
</p>


<h3>See Also</h3>

<p><code>hhh4</code>, <code>fe</code>, <code>ri</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># add 2 sine/cosine terms to a model with intercept and linear trend
addSeason2formula(f = ~ 1 + t, S = 2)

# the same for monthly data
addSeason2formula(f = ~ 1 + t, S = 2, period = 12)

# different number of seasons for a bivariate time series
addSeason2formula(f = ~ 1, S = c(3, 1), period = 52)
</code></pre>


</div>