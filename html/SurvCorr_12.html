<div class="container">

<table style="width: 100%;"><tr>
<td>survcorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Correlation Analysis of Survival Times by Iterative Multiple Imputation
</h2>

<h3>Description</h3>

<p>This R-package implements the iterative multiple imputation algorithm as proposed by Schemper, Kaider, Wakounig and Heinze (2013) for estimation of a correlation coefficient for bivariate possibly censored time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">survcorr(formula1, formula2, 
    data, methods = "imi", alpha = 0.05, intra = FALSE, 
    M = 10, MCMCSteps = 10, epsilon = 0.001, maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula1</code></td>
<td>

<p>Survival object for first time-to-event variable, e.g. <code>Surv(time1, status1)~1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula2</code></td>
<td>

<p>Survival object for second time-to-event variable, e.g. <code>Surv(time2, status2)~1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data set to look up variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>

<p>Correlation method(s). Currently, only <code>"imi"</code> (iterative multiple imputation) is implemented.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>One minus confidence level (for confidence interval computation)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intra</code></td>
<td>

<p>If TRUE, an intraclass correlation coefficient will be computed, assuming that the two time-to-event variables are interchangeable in each observation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>Number of imputations (for IMI)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCSteps</code></td>
<td>

<p>Number of MCMCSteps (for IMI)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>Accuracy of numerical estimation of correlation coefficients
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations in IMI
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The analysis of correlations within pairs of survival times is of interest to many research topics in medicine, such as the correlation of survival-type endpoints of twins, the correlation of times till failure in paired organs, or the correlation of survival time with a surrogate endpoint. The dependence of such times is assumed monotonic and thus quantification by rank correlation coefficients appropriate. The typical censoring of such times requires more involved methods of estimation and inference as have been developed in recent years.   As an alternative to the maximum likelihood methodology for the normal copula approach (NCE) this package implements an iterative multiple imputation (IMI) method which requires only about 0.05% of the computing time of NCE, without sacrificing statistical performance. For IMI, survival probabilities at death or censoring times are first transformed to normal deviates. Then, those deviates which relate to censored times are iteratively augmented, by conditional multiple imputation, until convergence is obtained for the normal scores rank correlation, which is similar to Spearman's rank correlation. Schemper, Kaider, Wakounig and Heinze (2013) compared statistical properties of NCE and IMI  by means of a Monte Carlo study and by means of three real data sets; two of them are available in this package.
</p>


<h3>Value</h3>








<table>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p>estimated correlation coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.lower </code></td>
<td>
<p>lower limit of confidence interval for rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.upper </code></td>
<td>
<p>upper limit of confidence interval for rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simData </code></td>
<td>
<p>imputed data sets for each iteration, with components M (number of imputations), z1M, z2M (imputed normal deviates), delta1, delta2 (censoring indicators), t1, t2 (imputed non-censored survival times)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M </code></td>
<td>
<p>number of imputations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCSteps </code></td>
<td>
<p>number of MCMC steps in iterative imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rj.trans </code></td>
<td>
<p>the M atanh-transformed correlation coefficients from M imputed data sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rj.t.mean </code></td>
<td>
<p>the posterior mean of the atanh-transofmred correlation coefficients over the M imputations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var </code></td>
<td>
<p>the variance of atanh(rho), with components within, between and total</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df </code></td>
<td>
<p>the number of degrees of freedom (important for confidence interval computation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>1-confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>the function call (useful for making use of update(obj))</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Meinhard Ploner, Alexandra Kaider, Georg Heinze
</p>


<h3>References</h3>

<p>Schemper,M., Kaider,A., Wakounig,S. &amp; Heinze,G. (2013): "Estimating the correlation of bivariate failure times under censoring", Statistics in Medicine, 32, 4781-4790 <a href="https://doi.org/10.1002/sim.5874">doi:10.1002/sim.5874</a>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1
data(kidney)
obj = survcorr(formula1=Surv(TIME1, STATUS1) ~ 1, formula2=Surv(TIME2, STATUS2) ~ 1, 
  data=kidney, M=1000, MCMCSteps=10, alpha=0.05, epsilon=0.001)

## Example 2
data(diabetes)
obj = survcorr(formula1=Surv(TIME1, STATUS1) ~ 1, formula2=Surv(TIME2, STATUS2) ~ 1, 
  data=diabetes, M=100, MCMCSteps=10, alpha=0.05, epsilon=0.001)
plot(obj, "times")


</code></pre>


</div>