<div class="container">

<table style="width: 100%;"><tr>
<td>regest_strata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression estimator for a stratified design</h2>

<h3>Description</h3>

<p>Computes the regression estimator of the population total for a stratified sampling, using the 
design-based approach. The same regression model is used for
all strata. The underling regression model is a model without intercept.</p>


<h3>Usage</h3>

<pre><code class="language-R">regest_strata(formula,weights,Tx_strata,strata,pikl,
sigma=rep(1,length(weights)),description=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula (y~x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of the weights; its length is equal to n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tx_strata</code></td>
<td>
<p>population total of x, the auxiliary variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>vector of stratum identificator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikl</code></td>
<td>
<p>joint inclusion probabilities for the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of positive values accounting for heteroscedasticity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>if TRUE, the following components are printed for each stratum:
the Horvitz-Thompson estimator, the estimated beta coefficients, their estimated standard error, t_values, p_values, 
and the covariance matrix. By default, FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns the value of the regression estimator computed as the sum of the
stratum estimators.
</p>


<h3>See Also</h3>

<p><code>regest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generates artificial data
y=rgamma(10,3)
x=y+rnorm(10)
Stratum=c(1,1,2,2,2,3,3,3,3,3)
# population size
N=200
# sample size
n=10
# assume proportional allocation, nh/Nh=n/N 
# joint inclusion probabilities (for the sample)
pikl=matrix(n*(n-1)/(N*(N-1)),n,n)
diag(pikl)=n/N
regest_strata(formula=y~x-1,weights=rep(N/n,n),Tx_strata=c(50,30,40),
strata=Stratum,pikl,description=TRUE)
</code></pre>


</div>