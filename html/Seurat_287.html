<div class="container">

<table style="width: 100%;"><tr>
<td>PrepSCTIntegration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare an object list normalized with sctransform for integration.</h2>

<h3>Description</h3>

<p>This function takes in a list of objects that have been normalized with the
<code>SCTransform</code> method and performs the following steps:
</p>

<ul>
<li>
<p>If anchor.features is a numeric value, calls <code>SelectIntegrationFeatures</code>
to determine the features to use in the downstream integration procedure.
</p>
</li>
<li>
<p>Ensures that the sctransform residuals for the features specified
to anchor.features are present in each object in the list. This is
necessary because the default behavior of <code>SCTransform</code> is to
only store the residuals for the features determined to be variable.
Residuals are recomputed for missing features using the stored model
parameters via the <code>GetResidual</code> function.
</p>
</li>
<li>
<p>Subsets the <code>scale.data</code> slot to only contain the residuals for
anchor.features for efficiency in downstream processing. 
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">PrepSCTIntegration(
  object.list,
  assay = NULL,
  anchor.features = 2000,
  sct.clip.range = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object.list</code></td>
<td>
<p>A list of <code>Seurat</code> objects to prepare for integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>The name of the <code>Assay</code> to use for integration. This can be a
single name if all the assays to be integrated have the same name, or a character vector
containing the name of each <code>Assay</code> in each object to be integrated. The
specified assays must have been normalized using <code>SCTransform</code>.
If NULL (default), the current default assay for each object is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anchor.features</code></td>
<td>
<p>Can be either:
</p>

<ul>
<li>
<p>A numeric value. This will call <code>SelectIntegrationFeatures</code>
to select the provided number of features to be used in anchor finding
</p>
</li>
<li>
<p>A vector of features to be used as input to the anchor finding
process
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sct.clip.range</code></td>
<td>
<p>Numeric of length two specifying the min and max values
the Pearson residual will be clipped to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display output/messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of <code>Seurat</code> objects with the appropriate <code>scale.data</code> slots
containing only the required <code>anchor.features</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# to install the SeuratData package see https://github.com/satijalab/seurat-data
library(SeuratData)
data("panc8")

# panc8 is a merged Seurat object containing 8 separate pancreas datasets
# split the object by dataset and take the first 2 to integrate
pancreas.list &lt;- SplitObject(panc8, split.by = "tech")[1:2]

# perform SCTransform normalization
pancreas.list &lt;- lapply(X = pancreas.list, FUN = SCTransform)

# select integration features and prep step
features &lt;- SelectIntegrationFeatures(pancreas.list)
pancreas.list &lt;- PrepSCTIntegration(
  pancreas.list,
  anchor.features = features
)

# downstream integration steps
anchors &lt;- FindIntegrationAnchors(
  pancreas.list,
  normalization.method = "SCT",
  anchor.features = features
)
pancreas.integrated &lt;- IntegrateData(anchors, normalization.method = "SCT")

## End(Not run)

</code></pre>


</div>