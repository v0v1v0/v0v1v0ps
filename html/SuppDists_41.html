<div class="container">

<table style="width: 100%;"><tr>
<td>ghyper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized hypergeometric distributions</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, random generator and summary function for generalized hypergeometric distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dghyper(x, a, k, N, log=FALSE)
pghyper(q, a, k, N, lower.tail=TRUE, log.p=FALSE)
qghyper(p, a, k, N, lower.tail=TRUE, log.p=FALSE)
rghyper(n, a, k, N)
sghyper(a, k, N)
tghyper(a, k, N) ## scalar arguments only
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q,n</code></td>
<td>
<p>vector of non-negative <b>integer</b> quantities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>vector of real values giving the first column total</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>vector  of real values giving the first row total</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>vector of real values giving the grand total</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical vector; if TRUE, probabilities p are given as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical vector; if TRUE (default), probabilities are <code class="reqn">P[X &lt;= x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The basic representation is in terms of a two-way table:
</p>

<table>
<tr>
<td style="text-align: center;">
x </td>
<td style="text-align: center;">  k-x </td>
<td style="text-align: center;">  k</td>
</tr>
<tr>
<td style="text-align: center;">
a-x </td>
<td style="text-align: center;">  b-k+x </td>
<td style="text-align: center;">  N-k</td>
</tr>
<tr>
<td style="text-align: center;">
a </td>
<td style="text-align: center;">     b </td>
<td style="text-align: center;">  N</td>
</tr>
</table>
<p>and the associated hypergeometric probability <code class="reqn">P(x)=C_x^a C_{k-x}^b / C_k^N</code>.
</p>
<p>The table is constrained so that rows and columns add to the margins.  In all cases x is an integer or zero, but meaningful probability distributions occur when the other parameters are real. Johnson, Kotz and Kemp (1992) give a general discussion.
</p>
<p>Kemp and Kemp (1956) classify the possible probability distributions that can occur when real values are allowed, into eight types. The <em>classic</em> hypergeometric with integer values forms a ninth type.  Five of the eight types correspond to known distributions used in various contexts.  Three of the eight types, appear to have no practical applications, but for completeness they have been implemented.  
</p>
<p>The Kemp and Kemp types are defined in terms of the ranges of the a, k, and N parameters and are given in <code>ghyper.types</code>. The function <code>tghyper()</code> will give details for specific values of a, k, and N.
</p>
<p>These distributions apply to many important problems, which has lead to a variety of names:
</p>
<p>The Kemp and Kemp types IIA and IIIA are known as:
</p>

<ul>
<li>
<p> Negative hypergeometric
</p>
</li>
<li>
<p>	Inverse hypergeometric
</p>
</li>
<li>
<p>	Hypergeometric waiting time
</p>
</li>
<li>
<p>	Beta-binomial
</p>
</li>
</ul>
<p>The advantages of the conditional argument are considerable. Consider a few examples:
</p>

<ol>
<li>
<p> Future event: Consider two events which have occurred u and v times respectively.  The distribution function of x occurrences of the first event in a sample of k new trials is calculated.  Here a = -u-1, and N = -u-v-2. 
</p>
<p>Example: Suppose Toronto has won 3 games and Atlanta 1 in the World Series. What is the probability that Toronto will win the series by taking 2 or more of the remaining 3 games?
</p>
</li>
<li>
<p> Exceedance: Consider two samples of size m and k, then the distribution function of x, the number of elements out of k which exceed the r th largest element in the size m sample is calculated.  Here a = -r, and N = -m-1. 
</p>
<p>Example: Suppose that only once in the last century has the high-water mark at the St. Joe bridge exceeded 12 feet, what is the probability that it will not do so in the next ten years?
</p>
</li>
<li>
<p> Waiting time: Consider an urn with T balls, m of which are white, and that drawing without replacement is continued until w white balls are obtained, then the distribution function of x, the number of balls in excess of w that must be drawn is desired.  Here a = -w , N = -m-1, and k = T - m. 
</p>
<p>Example: Suppose a lot of 100 contains 5 defectives. What is the mean number of items that must be inspected before a defective item is found?
</p>
</li>
<li>
<p> Mixture: Suppose x has a binomial distribution with parameter p, and number of trials k.  Suppose that p is not fixed, but itself distributed like a beta variable with parameters A and B, then the distribution of x is calculated with a = -A and N = -A -B.
</p>
</li>
</ol>
<p>Names for Kemp and Kemp type IV are:
</p>

<ul>
<li>
<p>	Beta-negative-binomial
</p>
</li>
<li>
<p>	Beta-Pascal
</p>
</li>
<li>
<p>	Generalized Waring 
</p>
</li>
</ul>
<p>One application is accidents:
</p>
<p>Suppose accidents follow a Poisson distribution with mean L, and suppose L varies with individuals according to accident proneness, m.  In particular, suppose L follows a gamma distribution with parameter r and scale factor m , and that the scale factor n itself follows a beta distribution with parameters A and B, then the distribution of accidents, x, is beta-negative-binomial with a = -B, k = -r , and N = A -1.  See Xekalki (1983) for a discussion of this as well as a discussion of accident models for proneness, contagion and spells.
</p>


<h3>Value</h3>

<p>The output values conform to the output from other such functions in R. <code>dghyper()</code> gives the density, <code>pghyper()</code> the distribution function and <code>qghyper()</code> its inverse. <code>rghyper()</code> generates random numbers. <code>sghyper()</code> produces a list containing parameters corresponding to the arguments â€“ mean, median, mode, variance, sd, third central moment, fourth central moment, Pearson's skewness, skewness, and kurtosis.
<br>
The function <code>tghyper()</code> returns the hypergeometric type and the range of values for x.	
</p>


<h3>Note</h3>

<p>The parameters of these functions differ from those of the
hypergeometric functions of R. To translate between the two use the
following as a model: phyper(x,m,n,k) = pghyper(x,k,m,m+n).
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler 
</p>


<h3>References</h3>

<p>Johnson, N.L., Kotz, S. and Kemp, A. (1992) <em>Univariate discrete distributions</em>. Wiley, N.Y.
</p>
<p>Kemp, C.D., and Kemp, A.W. (1956). Generalized hypergeometric distributions. <em>Jour. Roy. Statist. Soc. B.</em> <b>18.</b> 202-211.
</p>
<p>Xekalaki, E. (1983). The univariate generalized Waring distribution in relation to accident theory: proneness, spells or contagion. <em>Biometrics.</em> <b>39.</b>  887-895.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
tghyper(a=4, k=4, N=10) 		## classic
tghyper(a=4.1, k=5, N=10) 		## type IA(i) Real classic
tghyper(a=5, k=4.1, N=10) 		## type IA(ii) Real classic
tghyper(a=4.2, k=4.6, N=12.2) 		## type IB
tghyper(a=-5.1, k=10, N=-7) 		## type IIA
tghyper(a=-0.5, k=5.9, N=-0.7) 		## type IIB
tghyper(a=10, k=-5.1, N=-7) 		## type IIIA Negative hypergeometric
tghyper(a=5.9, k=-0.5, N=-0.7) 		## type IIIB
tghyper(a=-1, k=-1, N=5) 		## type IV Generalized Waring

sghyper(a=-1, k=-1, N=5)
plot(function(x)dghyper(x,a=-1,k=-1,N=5),0,5)

#Fisher's exact test: contingency table with rows (1,3),(3,1) 
pghyper(1,4,4,8)
pghyper(3,4,4,8,lower.tail=FALSE)



#Beta-binomial applications:

#Application examples:
tghyper(-4,3,-6)
pghyper(2,-4,3,-6,lower=FALSE)
pghyper(0,-2,10,-101)
sghyper(-1,95,-6)$Mean+1



</code></pre>


</div>