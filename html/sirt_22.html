<div class="container">

<table style="width: 100%;"><tr>
<td>rasch.evm.pcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of the Partial Credit Model using the Eigenvector Method
</h2>

<h3>Description</h3>

<p>This function performs the eigenvector approach to estimate item
parameters which is based on a pairwise estimation approach
(Garner &amp; Engelhard, 2002). No assumption about person parameters
is required for item parameter estimation. Statistical inference is performed by
Jackknifing. If a group identifier is provided, tests for differential item
functioning are performed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rasch.evm.pcm(dat, jackunits=20, weights=NULL, pid=NULL,
    group=NULL, powB=2, adj_eps=0.3, progress=TRUE )

## S3 method for class 'rasch.evm.pcm'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'rasch.evm.pcm'
coef(object,...)

## S3 method for class 'rasch.evm.pcm'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Data frame with dichotomous or polytomous item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackunits</code></td>
<td>

<p>A number of Jackknife units (if an integer is provided as the argument
value) or a vector in which the Jackknife units are already
defined.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional vector of sample weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>

<p>Optional vector of person identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Optional vector of group identifiers. In this case, item parameters are group wise
estimated and tests for differential item functioning are performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powB</code></td>
<td>

<p>Power created in <code class="reqn">B</code> matrix which is the basis of parameter estimation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj_eps</code></td>
<td>

<p>Adjustment parameter for person parameter estimation
(see <code>mle.pcm.group</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>An optional logical indicating whether progress should be displayed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>rasch.evm.pcm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimals for rounding in <code>summary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name if <code>summary</code> should be sunk into a file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>item</code></td>
<td>
<p>Data frame with item parameters. The item parameter estimate
is denoted by <code>est</code> while a Jackknife bias-corrected estimate
is <code>est_jack</code>. The Jackknife standard error is <code>se</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Item threshold parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with person parameters obtained (MLE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Paired comparison matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Transformed paired comparison matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Vector of estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Covariance matrix of estimated item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JJ</code></td>
<td>
<p>Number of jackknife units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JJadj</code></td>
<td>
<p>Reduced number of jackknife units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powB</code></td>
<td>
<p>Used power of comparison matrix <code class="reqn">B</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>Maximum number of categories per item</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>desc</code></td>
<td>
<p>Some descriptives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difstats</code></td>
<td>
<p>Statistics for differential item functioning if <code>group</code>
is provided as an argument</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Choppin, B. (1985). A fully conditional estimation procedure for Rasch Model
parameters. <em>Evaluation in Education, 9</em>, 29-42.
</p>
<p>Garner, M., &amp; Engelhard, G. J. (2002). An eigenvector method for
estimating item parameters of the dichotomous and polytomous Rasch models.
<em>Journal of Applied Measurement, 3</em>, 107-128.
</p>
<p>Wang, J., &amp; Engelhard, G. (2014). A pairwise algorithm in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> for rater-mediated
assessments. <em>Rasch Measurement Transactions, 28</em>(1), 1457-1459.
</p>


<h3>See Also</h3>

<p>See the <span class="pkg">pairwise</span> package for the alternative row averaging
approach of Choppin (1985) and Wang and Engelhard (2014) for an
alternative <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> implementation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Dataset Liking for Science
#############################################################################

data(data.liking.science)
dat &lt;- data.liking.science

# estimate partial credit model using 10 Jackknife units
mod1 &lt;- sirt::rasch.evm.pcm( dat, jackunits=10 )
summary(mod1)

## Not run: 
# compare results with TAM
library(TAM)
mod2 &lt;- TAM::tam.mml( dat )
r1 &lt;- mod2$xsi$xsi
r1 &lt;- r1 - mean(r1)
# item parameters are similar
dfr &lt;- data.frame( "b_TAM"=r1, mod1$item[,c( "est","est_jack") ] )
round( dfr, 3 )
  ##      b_TAM    est est_jack
  ##  1  -2.496 -2.599   -2.511
  ##  2   0.687  0.824    1.030
  ##  3  -0.871 -0.975   -0.943
  ##  4  -0.360 -0.320   -0.131
  ##  5  -0.833 -0.970   -0.856
  ##  6   1.298  1.617    1.444
  ##  7   0.476  0.465    0.646
  ##  8   2.808  3.194    3.439
  ##  9   1.611  1.460    1.433
  ##  10  2.396  1.230    1.095
  ##  [...]

# partial credit model in eRm package
miceadds::library_install("eRm")
mod3 &lt;- eRm::PCM(X=dat)
summary(mod3)
eRm::plotINFO(mod3)      # plot item and test information
eRm::plotICC(mod3)       # plot ICCs
eRm::plotPImap(mod3)     # plot person-item maps

#############################################################################
# EXAMPLE 2: Garner and Engelhard (2002) toy example dichotomous data
#############################################################################

dat &lt;- scan()
   1 0 1 1   1 1 0 0   1 0 0 0   0 1 1 1   1 1 1 0
   1 1 0 1   1 1 1 1   1 0 1 0   1 1 1 1   1 1 0 0

dat &lt;- matrix( dat, 10, 4, byrow=TRUE)
colnames(dat) &lt;- paste0("I", 1:4 )

# estimate Rasch model with no jackknifing
mod1 &lt;- sirt::rasch.evm.pcm( dat, jackunits=0 )

# paired comparison matrix
mod1$B
  ##          I1_Cat1 I2_Cat1 I3_Cat1 I4_Cat1
  ##  I1_Cat1       0       3       4       5
  ##  I2_Cat1       1       0       3       3
  ##  I3_Cat1       1       2       0       2
  ##  I4_Cat1       1       1       1       0

#############################################################################
# EXAMPLE 3: Garner and Engelhard (2002) toy example polytomous data
#############################################################################

dat &lt;- scan()
   2 2 1 1 1   2 1 2 0 0   1 0 0 0 0   0 1 1 2 0   1 2 2 1 1
   2 2 0 2 1   2 2 1 1 0   1 0 1 0 0   2 1 2 2 2   2 1 0 0 1

dat &lt;- matrix( dat, 10, 5, byrow=TRUE)
colnames(dat) &lt;- paste0("I", 1:5 )

# estimate partial credit model with no jackknifing
mod1 &lt;- sirt::rasch.evm.pcm( dat, jackunits=0, powB=3 )

# paired comparison matrix
mod1$B
  ##          I1_Cat1 I1_Cat2 I2_Cat1 I2_Cat2 I3_Cat1 I3_Cat2 I4_Cat1 I4_Cat2 I5_Cat1 I5_Cat2
  ##  I1_Cat1       0       0       2       0       1       1       2       1       2       1
  ##  I1_Cat2       0       0       0       3       2       2       2       2       2       3
  ##  I2_Cat1       1       0       0       0       1       1       2       0       2       1
  ##  I2_Cat2       0       1       0       0       1       2       0       3       1       3
  ##  I3_Cat1       1       1       1       1       0       0       1       2       3       1
  ##  I3_Cat2       0       1       0       2       0       0       1       1       1       1
  ##  I4_Cat1       0       1       0       0       0       2       0       0       1       2
  ##  I4_Cat2       1       0       0       2       1       1       0       0       1       1
  ##  I5_Cat1       0       1       0       1       2       1       1       2       0       0
  ##  I5_Cat2       0       0       0       1       0       0       0       0       0       0

#############################################################################
# EXAMPLE 4: Partial credit model for dataset data.mg from CDM package
#############################################################################

library(CDM)
data(data.mg,package="CDM")
dat &lt;- data.mg[, paste0("I",1:11) ]

#*** Model 1: estimate partial credit model
mod1 &lt;- sirt::rasch.evm.pcm( dat )
# item parameters
round( mod1$b, 3 )
  ##        Cat1   Cat2  Cat3
  ##  I1  -1.537     NA    NA
  ##  I2  -2.360     NA    NA
  ##  I3  -0.574     NA    NA
  ##  I4  -0.971 -2.086    NA
  ##  I5  -0.104  0.201    NA
  ##  I6   0.470  0.806    NA
  ##  I7  -1.027  0.756 1.969
  ##  I8   0.897     NA    NA
  ##  I9   0.766     NA    NA
  ##  I10  0.069     NA    NA
  ##  I11 -1.122  1.159 2.689

#*** Model 2: estimate PCM with pairwise package
miceadds::library_install("pairwise")
mod2 &lt;- pairwise::pair(daten=dat)
summary(mod2)
plot(mod2)
# compute standard errors
semod2 &lt;- pairwise::pairSE(daten=dat,  nsample=20)
semod2

#############################################################################
# EXAMPLE 5: Differential item functioning for dataset data.mg
#############################################################################

library(CDM)
data(data.mg,package="CDM")
dat &lt;- data.mg[ data.mg$group %in% c(2,3,11), ]
# define items
items &lt;- paste0("I",1:11)
# estimate model
mod1 &lt;- sirt::rasch.evm.pcm( dat[,items], weights=dat$weight, group=dat$group )
summary(mod1)

#############################################################################
# EXAMPLE 6: Differential item functioning for Rasch model
#############################################################################

# simulate some data
set.seed(9776)
N &lt;- 1000    # number of persons
I &lt;- 10        # number of items
# simulate data for first group
b &lt;- seq(-1.5,1.5,len=I)
dat1 &lt;- sirt::sim.raschtype( stats::rnorm(N), b )
# simulate data for second group
b1 &lt;- b
b1[4] &lt;- b1[4] + .5 # introduce DIF for fourth item
dat2 &lt;- sirt::sim.raschtype( stats::rnorm(N,mean=.3), b1 )
dat &lt;- rbind(dat1, dat2 )
group &lt;- rep( 1:2, each=N )
# estimate model
mod1 &lt;- sirt::rasch.evm.pcm( dat, group=group )
summary(mod1)

## End(Not run)
</code></pre>


</div>