<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.miso.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructor for monotone increasing SCOP-splines with an additional 'start at zero' constraint
</h2>

<h3>Description</h3>

<p>This is a special method function
for creating smooths subject to a monotone increasing constraint plus the smooths should pass through zero at the left-end point of the covariate range. This is similar to the <code>pc</code> argument to  <code>s</code> in  <code>mgcv(gam)</code> when <code>pc=min(x)</code>, where <code>x</code> is a covariate.
The smooth is built by the <code>mgcv</code> constructor function for smooth terms, <code>smooth.construct</code>. 'Zero intercept' identifiability constraints used for univariate SCOP-splines are substituted with a 'start at zero' constraint here. This smooth is specified via model terms such as 
<code>s(x,k,bs="miso",m=2)</code>, 
where <code>k</code> denotes the basis dimension and <code>m+1</code> is the order of the B-spline basis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'miso.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A smooth specification object, generated by an <code>s</code> term in a GAM formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or list containing the data required by this term,
with names given by <code>object$term</code>. The <code>by</code> variable is the last element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing the knots supplied for basis setup.  
If it is <code>NULL</code> then the knot locations are generated automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The constructor is not called directly, but as with <code>gam(mgcv)</code> is used internally. 
</p>
<p>A 'start at zero' constraint is achieved by setting the first (m+1) spline coefficients to zero. According to the B-spline basis functions properties, the value of the spline, <code>f(x)</code>, is determined by <code>m+2</code> non-zero basis functions, and only <code>m+1</code> B-splines are non-zero at knots. Only <code>m+2</code> B-splines are non-zero on any <code>[k_i, k_{i+1})</code>, and the sum of these <code>m+2</code> basis functions is 1.
</p>
<p>If the knots of the spline are not supplied, then they are placed evenly throughout the covariate values with an exception of the <code>m</code> inner knots following the first inner knot that are joined with that first knot. This is done in order to avoid an otherwise plateau fit at the left-end region. If the knots are supplied, then the number of supplied knots should be <code>k+m+2</code>, and the range of the middle <code>k-m</code> knots must include all the covariate values.
</p>


<h3>Value</h3>

<p> An object of class <code>"miso.smooth"</code>. 
</p>


<h3>Author(s)</h3>

 
<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>


<h3>See Also</h3>

<p><code>smooth.construct.mpi.smooth.spec</code>,
<code>smooth.construct.mifo.smooth.spec</code>,
</p>
<p><code>smooth.construct.mpd.smooth.spec</code>,
<code>smooth.construct.mdcv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.mdcx.smooth.spec</code>, <code>smooth.construct.micv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.micx.smooth.spec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
  ## Monotone increasing SCOP-spline examples with a start at zero constraint...
  ## passing through 0 at -1...
  require(scam)
  set.seed(7)
  n &lt;- 100;
  x &lt;- c(-1,runif(n-1)*4-1); ## starting at -1 for a function to be zero at a start
  z &lt;- runif(n)
  y &lt;- exp(4*x)/(1+exp(4*x)) -0.01798621+ z*(1-z)*5 + rnorm(100)*.4
  m1 &lt;- scam(y~s(x,bs='miso')+s(z)) 
  plot(m1,pages=1)
  newd&lt;- data.frame(x=-1,z=0)
  predict(m1,newd, type='terms')


## Not run: 
  ## passing through 0 at 0...
  set.seed(53)
  n &lt;- 100;
  x &lt;- c(0,runif(n-1)); ## starting at 0 for a function to be zero at a start
  z &lt;- runif(n)
  y &lt;- exp(3*x)/10-.1 + z*(1-z)*5 + rnorm(100)*.4
  m2 &lt;- scam(y~s(x,bs='miso')+s(z)) 
  plot(m2,pages=1)
  newd&lt;- data.frame(x=0,z=0)
  predict(m2,newd, type='terms')

    
## End(Not run)
</code></pre>


</div>