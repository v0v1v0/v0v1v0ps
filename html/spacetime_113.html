<div class="container">

<table style="width: 100%;"><tr>
<td>stInteraction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> subtract marginal (spatial and temporal) means from observations </h2>

<h3>Description</h3>

<p>subtract marginal (spatial and temporal) means from observations </p>


<h3>Usage</h3>

<pre><code class="language-R"> 
stInteraction(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> object of class <code>STFDF</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments passed to rowMeans, colMeans and mean, such as <code>na.rm=TRUE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>object of class STFDF with each attribute replaced by its
residual, computed by <code class="reqn">y_{ij}=x_{ij}-m_{.j}m{i.}/m</code> with <code class="reqn">m</code> the
grand mean, <code class="reqn">m_{.j}</code> the temporal mean, <code class="reqn">m_{i.}</code> the spatial mean
and <code class="reqn">m</code> the grand mean.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (require(gstat)) {
library(sp)
data(wind)
wind.loc$y = as.numeric(char2dms(as.character(wind.loc[["Latitude"]])))
wind.loc$x = as.numeric(char2dms(as.character(wind.loc[["Longitude"]])))
coordinates(wind.loc) = ~x+y
proj4string(wind.loc) = "+proj=longlat +datum=WGS84"
# match station order to names in wide table:
stations = 4:15
wind.loc = wind.loc[match(names(wind[stations]), wind.loc$Code),]
row.names(wind.loc) = wind.loc$Station
wind$time = ISOdate(wind$year+1900, wind$month, wind$day, 0)
space = list(values = names(wind)[stations])
wind.st = stConstruct(wind[stations], space, wind$time, SpatialObj = wind.loc)

wind.sti = stInteraction(wind.st)
# temporal means for any station should be zero:
c(mean(wind.sti[3,]),
# spatial mean for each time step should be zero:
mean(wind.sti[,5][[1]]))
}

</code></pre>


</div>