<div class="container">

<table style="width: 100%;"><tr>
<td>twosidedpval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of Conditional Two-Sided <code class="reqn">p</code>-Values</h2>

<h3>Description</h3>

<p>Computes the conditional <code class="reqn">p</code>-value <code class="reqn">P_C</code> for a continuous
or discrete test statistic, as defined in
Kulinskaya (2008). This provides a method
for computing a two-sided <code class="reqn">p</code>-value from an asymmetric null
distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">twosidedpval(
  q,
  CDF,
  continuous,
  method = c("doubled", "kulinskaya", "minlikelihood"),
  locpar,
  supportlim = c(-Inf, Inf),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A double representing the quantile, i.e. the observed value of the
test statistic for which a two-sided <code class="reqn">p</code>-value is to be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CDF</code></td>
<td>
<p>A function representing the cumulative distribution function of
the test statistic under the null hypothesis, i.e.
<code class="reqn">\Pr(T\le q|\mathrm{H}_0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>continuous</code></td>
<td>
<p>A logical indicating whether the test statistic is a
continuous (<code>TRUE</code>) or discrete (<code>FALSE</code>) random variable.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character specifying the method to use to calculate
two-sided <code class="reqn">p</code>-value; one of <code>"doubled"</code> (representing
doubling of the one-sided <code class="reqn">p</code>-value),
<code>"kulinskaya"</code> (representing the method of
Kulinskaya (2008)), or <code>"minlikelihood"</code>
(representing the sum of probabilities for values with probability less
than or equal to that of the observed value. Partial matching is used.
Note that the <code>"minlikelihood"</code> method is available only
for discrete distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locpar</code></td>
<td>
<p>a double representing a generic location parameter chosen to
separate the tails of the distribution. Note that if <code>locpar</code>
corresponds to the median of <code>CDF</code>, there is no difference between
the two methods, in the continuous case. If <code>locpar</code> is not specified,
the function attempts to compute the expectation of <code>CDF</code> using
numerical integration and, if successful, uses this as <code>locpar</code>.
However, this may yield unexpected results, especially if <code>CDF</code> is
not one of the cumulative distribution functions of well-known
distributions included in the <code>stats</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supportlim</code></td>
<td>
<p>A numeric vector of <code>length</code> 2, giving the minimum
and maximum values in the support of the distribution whose cumulative
distribution function is <code>CDF</code>. This argument is only used if the
distribution is discrete (i.e. if <code>continuous</code> is <code>FALSE</code>) and
if <code>method</code> is <code>"minlikelihood"</code> or <code>locpar</code> is not
specified. If <code>supportlim</code> is not supplied, the function assumes
that the support is <code>-1e6:1e6</code>. Values of <code>-Inf</code> and <code>Inf</code>
may be supplied, but if so, the support is truncated at <code>-1e6</code> and
<code>1e6</code> respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to pass to <code>CDF</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">T</code> be a statistic that, under the null hypothesis, has
cumulative distribution function <code class="reqn">F</code> and probability density or mass
function <code class="reqn">f</code>. Denote by <code class="reqn">A</code> a generic location parameter chosen
to separate the two tails of the distribution. Particular examples
include the mean <code class="reqn">E(T|\mathrm{H}_0)</code>, the mode
<code class="reqn">\arg \sup_{t} f(t)</code>, or the median
<code class="reqn">F^{-1}\left(\frac{1}{2}\right)</code>. Let <code class="reqn">q</code> be the observed value
of <code class="reqn">T</code>.
</p>
<p>In the continuous case, the conditional two-sided <code class="reqn">p</code>-value centered
at <code class="reqn">A</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P_C^A(q)=\frac{F(q)}{F(A)}1_{q \le A} + \frac{1-F(q)}{1-F(A)}1_{q &gt; A}</code>
</p>

<p>where <code class="reqn">1_{\cdot}</code> is the indicator function. In the discrete case,
<code class="reqn">P_C^A</code> depends on whether <code class="reqn">A</code> is an attainable value within the
support of <code class="reqn">T</code>. If <code class="reqn">A</code> is not attainable, the conditional two-sided
<code class="reqn">p</code>-value centred at <code class="reqn">A</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P_C^{A}(q)=\frac{\Pr(T\le q)}{\Pr(T&lt;A)}1_{q&lt;A} + \frac{\Pr(T\ge q)}{\Pr(T&gt;A)}1_{q&gt;A}</code>
</p>

<p>If <code class="reqn">A</code> is attainable, the conditional two-sided <code class="reqn">p</code>-value centred
at <code class="reqn">A</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P_C^{A}(q)=\frac{\Pr(T\le q)}{\Pr(T\le A)/\left(1+\Pr(T=A)\right)} 1_{q&lt;A} +
   1_{q=A}+\frac{\Pr(T\ge q)}{\Pr(T \ge A)/\left(1+\Pr(T=A)\right)} 1_{q&gt;A}</code>
</p>



<h3>Value</h3>

<p>A double.
</p>


<h3>References</h3>

<p>Kulinskaya E (2008).
“On Two-Sided p-Values for Non-Symmetric Distributions.”
0810.2124, 0810.2124.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Computation of two-sided p-value for F test for equality of variances
n1 &lt;- 10
n2 &lt;- 20
set.seed(1234)
x1 &lt;- stats::rnorm(n1, mean = 0, sd = 1)
x2 &lt;- stats::rnorm(n2, mean = 0, sd = 3)
# 'Conventional' two-sided p-value obtained by doubling one-sided p-value:
stats::var.test(x1, x2, alternative = "two.sided")$p.value
# This is replicated in `twosidedpval` by setting `method` argument to `"doubled"`
twosidedpval(q = var(x1) / var(x2), CDF = stats::pf, continuous = TRUE,
 method = "doubled", locpar = 1, df1 = n1 - 1, df2 = n2 - 1)
# Conditional two-sided p-value centered at df (mean of chi-squared r.v.):
twosidedpval(q = var(x1) / var(x2), CDF = stats::pf, continuous = TRUE,
 method = "kulinskaya", locpar = 1, df1 = n1 - 1, df2 = n2 - 1)
</code></pre>


</div>