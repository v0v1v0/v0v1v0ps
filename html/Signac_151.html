<div class="container">

<table style="width: 100%;"><tr>
<td>GeneActivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create gene activity matrix</h2>

<h3>Description</h3>

<p>Compute counts per cell in gene body and promoter region.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeneActivity(
  object,
  assay = NULL,
  features = NULL,
  extend.upstream = 2000,
  extend.downstream = 0,
  biotypes = "protein_coding",
  max.width = 5e+05,
  process_n = 2000,
  gene.id = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of assay to use. If NULL, use the default assay</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Genes to include. If NULL, use all protein-coding genes in
the annotations stored in the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extend.upstream</code></td>
<td>
<p>Number of bases to extend upstream of the TSS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extend.downstream</code></td>
<td>
<p>Number of bases to extend downstream of the TTS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biotypes</code></td>
<td>
<p>Gene biotypes to include. If NULL, use all biotypes in the
gene annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.width</code></td>
<td>
<p>Maximum allowed gene width for a gene to be quantified.
Setting this parameter can avoid quantifying extremely long transcripts that
can add a relatively long amount of time. If NULL, do not filter genes based
on width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process_n</code></td>
<td>
<p>Number of regions to load into memory at a time, per thread.
Processing more regions at once can be faster but uses more memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.id</code></td>
<td>
<p>Record gene IDs in output matrix rather than gene name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display messages</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a sparse matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">fpath &lt;- system.file("extdata", "fragments.tsv.gz", package="Signac")
fragments &lt;- CreateFragmentObject(
  path = fpath,
  cells = colnames(atac_small),
  validate.fragments = FALSE
)
Fragments(atac_small) &lt;- fragments
GeneActivity(atac_small)
</code></pre>


</div>