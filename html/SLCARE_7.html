<div class="container">

<table style="width: 100%;"><tr>
<td>SLCARE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Latent Class Analysis for Recurrent Event</h2>

<h3>Description</h3>

<p>Fit semiparametric latent class model for recurrent event.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SLCARE(
  formula = "x1 + x2",
  alpha = NULL,
  beta = NULL,
  data = data,
  id_col = "id",
  start_col = "start",
  stop_col = "stop",
  event_col = "event",
  K = NULL,
  gamma = 0,
  max_epochs = 500,
  conv_threshold = 0.01,
  boot = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a string specifying the variables of interest to be involved in the regression, with the format of "x1 + x2".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>initial estimate for alpha in the estimation procedure (multinomial logistic regression model). This should be NULL (default) or a numeric matrix. 'NULL' represents the initial estimate for alpha resulted from the automated initializer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>initial estimate for beta in the estimation procedure (recurrent event model). This should be NULL (default) or a numeric matrix. 'NULL' represents the initial estimate for beta resulted from the automated initializer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a long-format Dataframe, with the format similar to Simdata (a package build-in dataset).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_col</code></td>
<td>
<p>parameter that indicates the column name of the subject identifier in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_col</code></td>
<td>
<p>parameter that indicates the column name of the start time of the recurrent event interval in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_col</code></td>
<td>
<p>parameter that indicates the column name of the ending time of the recurrent event interval in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_col</code></td>
<td>
<p>parameter that indicates the column name of the recurrent event indicator in data. 1 if a recurrent event is observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>pre-determined number of latent classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>parameter that indicates the distribution of frailty W. The default is 0 which indicates the model holds without the subject-specific frailty (i.e., W = 1), gamma = k indicates that W follows the Gamma(k, k) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_epochs</code></td>
<td>
<p>maximum number of iterations for the estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv_threshold</code></td>
<td>
<p>convergence threshold for the estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>number of bootstrap replicates used to obtain the standard error estimation. The default is NULL which indicates bootstrap is not conducted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Model:</b>
</p>
<p>Suppose the recurrent events process is observed with the intensity function proposed in Zhao et al. (2022):
</p>
<p style="text-align: center;"><code class="reqn">\lambda _{i} (t) = \sum _{k = 1} ^{K} I (\xi _{i} = k) \times \lambda _{0} (t) \times W_{i} \times \eta _{0,k} \times \exp(\tilde{Z} _{i} ^{\top} \tilde{\beta} _{0,k}) </code>
</p>

<p>where <code class="reqn">K</code> is the number of latent classes in the whole population,
<code class="reqn">\xi_i</code> denotes the unobserved latent class membership,
<code class="reqn">\lambda _{0} (t)</code> is an unspecified, continuous,
nonnegative baseline intensity function shared by all latent classes,
<code class="reqn">C_i</code> is the subject specific censoring time,
<code class="reqn">\tilde{Z}_i</code> is the time-independent covariates,
<code class="reqn">W_{i}</code> is a positive subject-specific latent variable independent of <code class="reqn">(\xi_i, \tilde{Z}_i, C_i)</code>.
</p>
<p>The distribution of the latent class membership <code class="reqn">\xi _{i}</code> is modeled by a logistic regression model:
</p>
<p style="text-align: center;"><code class="reqn">P(\xi _{i} = k | \tilde{Z} _{i}) = p_{k} (\alpha _{0} , \tilde{Z} _{i}) \doteq \frac{\exp(\tilde{Z} _{i} ^{\top} \alpha _{0,k})}{\sum_{k = 1}^{K}\exp(\tilde{Z} _{i} ^{\top} \alpha _{0,k}) } , \quad k = 1, \cdots, K </code>
</p>

<p><code>SLCARE</code> is build for introducing a robust and flexible algorithm to carry out Zhao et al. (2022)'s latent class analysis method for recurrent event data described above.
The detailed discussion of the proposed estimation algorithms can be found in the paper "SLCARE: An R package for Semiparametric Latent Class Analysis of Recurrent Events" (in preparation).
</p>
<p><b>Initial Values:</b>
</p>
<p>The proposed estimating algorithm needs an input of initial values for <code class="reqn">\hat{\beta}</code> and <code class="reqn">\hat{\alpha}</code>.
<code>SLCARE</code> allows users to specify the initial values for the estimation algorithm by their own choice.
<code>SLCARE</code> also provide an automated initializer which obtains the initial values using
a combination of K-means clustering, multinomial regression and Wang et al. (2001)'s multiplicative intensity model.
The detailed discussion of the proposed estimation algorithms can be found in the paper "SLCARE: An R package for Semiparametric Latent Class Analysis of Recurrent Events" (in preparation).
</p>
<p><b>Specify the number of latent classes and individual frailty:</b>
</p>
<p><code>SLCARE</code> allows the frailty distribution to be W = 1 or W follows a distribution that is parameterized as Gamma(k,k). These choices of frailty distributions cover a variety of density forms.
Suggested by Zhao et al. (2022), users can choose the distribution of individual frailty and the number of latent classes based on the model entropy provided by <code>SLCARE</code>.
An example of model selection can be found in the paper "SLCARE: An R package for Semiparametric Latent Class Analysis of Recurrent Events" (in preparation).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimData)

# fit SLCARE with K = 2, formula = "x1 + x2" and default settings for other arguments
model1 &lt;- SLCARE(formula = "x1 + x2", data = SimData, K = 2)

# summary results
summary(model1, digits = 3)

# generate model checking plot
plot(model1, type = "ModelChecking")

# plot estimated cumulative baseline intensity function
plot(model1, type = "mu0")

# generate estimated mean function plot
plot(model1, type = "EstMeans")

# check class membership probabilities of the 6th - 10th subjects in SimData
print(model1, type = "ClassProb")[6:10,]

# check the predicted number of recurrent events of the 6th - 10th subjects in SimData
print(model1, type = "PostPredict")[6:10,]

# check the change in parameter estimates in the last iteration
print(model1, type = "ConvergeLoss")
</code></pre>


</div>