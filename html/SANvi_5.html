<div class="container">

<table style="width: 100%;"><tr>
<td>variational_multistart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform variational inference using multiple starting points.</h2>

<h3>Description</h3>

<p><code>variational_multistart</code> is the main function of the package. 
It is used to estimate via variational inference the three models we present (CAM, fiSAN, fSAN) while adopting multiple random starting points to better explore the variational parameter space.
The run that provides the highest Expected Lower BOund (ELBO) is usually the one considered for inference. Note that the arguments passed to this functions are a union of the arguments 
of the functions <code>variational_CAM</code>, <code>variational_fiSAN</code>, and <code>variational_fSAN</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">variational_multistart(y, group, runs, cores = 1, 
                       model = c("fiSAN","CAM","fSAN"), 
                       maxL = 30, maxK = 20, 
                       m0 = 0, tau0 = .01, lambda0 = 3, gamma0 = 2, 
                       conc_par = NULL,  conc_hyperpar = c(1,1,1,1), 
                       alpha_bar = 0.05, beta_bar = 0.05, 
                       epsilon = 1e-6, root = 1234, maxSIM = 1e5, 
                       warmstart = TRUE)

## S3 method for class 'multistart'
plot(x, type = c("elbo", "time"), log_scale_iter = TRUE, ...)

## S3 method for class 'multistart'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>vector of the same length of y indicating the group membership (numeric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>the number of multiple runs to launch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the number of cores to dedicate to the multiple runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a string specifying the model to use. It can be <code>"fiSAN"</code>,<code>"CAM"</code>, or <code>"fSAN"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxL, maxK</code></td>
<td>
<p>integers, the upper bounds for the observational and distributional clusters to fit, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0, tau0, lambda0, gamma0</code></td>
<td>
<p>hyperparameters on <code class="reqn">(\mu, \sigma^2) \sim NIG(m_0, \tau_0, \lambda_0,\gamma_0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc_hyperpar, conc_par, alpha_bar, beta_bar</code></td>
<td>
<p>these values crucially depend on the chosen model. See <code>variational_CAM</code>, <code>variational_fiSAN</code>, <code>variational_fSAN</code> for proper explanations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the tolerance that drives the convergence criterion adopted as stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>common part of the random seeds used to control the initialization in order to provide reproducibility even in paralleled settings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxSIM</code></td>
<td>
<p>the maximum number of CAVI iteration to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmstart</code></td>
<td>
<p>logical, if <code>TRUE</code>, the observational means of the cluster atoms are initialized with a k-means algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>multistart</code>, obtained from the <code>variational_multistart</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string specifying the type of plot. It can be either <code>"elbo"</code> or <code>"time"</code>. The former displays 
the elbo trajectories, highlighting the best run. The latter provides a summary of the computational times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_scale_iter</code></td>
<td>
<p>logical. If <code>TRUE</code>, when plotting the elbo trajectories, the x-axes is displayed in log-scale, enhancing the visualization of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the details of the single models, see their specific documentations: <code>variational_CAM</code>, <code>variational_fiSAN</code>, and <code>variational_fSAN</code>.
</p>


<h3>Value</h3>

<p>A list with all the runs performed. Each element of the list is a fitted variational model of class <code>SANvb</code>.
</p>


<h3>See Also</h3>

<p><code>variational_CAM</code>, <code>variational_fiSAN</code>, <code>variational_fSAN</code>, <code>extract_best</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate example data
set.seed(123)
y &lt;- c(rnorm(100),rnorm(100,5))
g &lt;- rep(1:2,rep(100,2))

# Estimate multiple models via variational inference
est &lt;- variational_multistart(y, g, runs=5)

</code></pre>


</div>