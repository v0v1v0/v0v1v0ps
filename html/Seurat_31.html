<div class="container">

<table style="width: 100%;"><tr>
<td>AverageExpression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Averaged feature expression by identity class</h2>

<h3>Description</h3>

<p>Returns averaged expression values for each identity class.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AverageExpression(
  object,
  assays = NULL,
  features = NULL,
  return.seurat = FALSE,
  group.by = "ident",
  add.ident = NULL,
  layer = "data",
  slot = deprecated(),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assays</code></td>
<td>
<p>Which assays to use. Default is all assays</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Features to analyze. Default is all features in the assay</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.seurat</code></td>
<td>
<p>Whether to return the data as a Seurat object. Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>Category (or vector of categories) for grouping (e.g, ident, replicate, celltype); 'ident' by default
To use multiple categories, specify a vector, such as c('ident', 'replicate', 'celltype')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.ident</code></td>
<td>
<p>(Deprecated). Place an additional label on each cell prior to pseudobulking</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>Layer(s) to use; if multiple layers are given, assumed to follow
the order of 'assays' (if specified) or object's assays</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>(Deprecated). Slots(s) to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print messages and show progress bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods such as <code>CreateSeuratObject</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If layer is set to 'data', this function assumes that the data has been log
normalized and therefore feature values are exponentiated prior to averaging
so that averaging is done in non-log space. Otherwise, if layer is set to
either 'counts' or 'scale.data', no exponentiation is performed prior to  averaging.
If <code>return.seurat = TRUE</code> and layer is not 'scale.data', averaged values
are placed in the 'counts' layer of the returned object and 'log1p'
is run on the averaged counts and placed in the 'data' layer <code>ScaleData</code>
is then run on the default assay before returning the object.
If <code>return.seurat = TRUE</code> and layer is 'scale.data', the 'counts' layer contains
average counts and 'scale.data' is set to the averaged values of 'scale.data'.
</p>


<h3>Value</h3>

<p>Returns a matrix with genes as rows, identity classes as columns.
If return.seurat is TRUE, returns an object of class <code>Seurat</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("pbmc_small")
head(AverageExpression(object = pbmc_small)$RNA)
head(AverageExpression(object = pbmc_small, group.by = c('ident', 'groups'))$RNA)

</code></pre>


</div>