<div class="container">

<table style="width: 100%;"><tr>
<td>SerialClustering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Consensus clustering (internal)</h2>

<h3>Description</h3>

<p>Performs consensus (weighted) clustering. The underlying algorithm (e.g.
hierarchical clustering) is run with different number of clusters <code>nc</code>.
In consensus weighed clustering, weighted distances are calculated using the
<code>cosa2</code> algorithm with different penalty parameters
<code>Lambda</code>. The hyper-parameters are calibrated by maximisation of the
consensus score. This function uses a serial implementation and requires the grids of
hyper-parameters as input (for internal use only).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SerialClustering(
  xdata,
  nc,
  eps,
  Lambda,
  K = 100,
  tau = 0.5,
  seed = 1,
  n_cat = 3,
  implementation = HierarchicalClustering,
  scale = TRUE,
  linkage = "complete",
  row = TRUE,
  output_data = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>data matrix with observations as rows and variables as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>matrix of parameters controlling the number of clusters in the
underlying algorithm specified in <code>implementation</code>. If <code>nc</code> is
not provided, it is set to <code>seq(1, tau*nrow(xdata))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>radius in density-based clustering, see
<code>dbscan</code>. Only used if
<code>implementation=DBSCANClustering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>vector of penalty parameters for weighted distance calculation.
Only used for distance-based clustering, including for example
<code>implementation=HierarchicalClustering</code>,
<code>implementation=PAMClustering</code>, or
<code>implementation=DBSCANClustering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of resampling iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>subsample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>value of the seed to initialise the random number generator and
ensure reproducibility of the results (see <code>set.seed</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cat</code></td>
<td>
<p>computation options for the stability score. Default is
<code>NULL</code> to use the score based on a z test. Other possible values are 2
or 3 to use the score based on the negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>implementation</code></td>
<td>
<p>function to use for clustering. Possible functions
include <code>HierarchicalClustering</code> (hierarchical clustering),
<code>PAMClustering</code> (Partitioning Around Medoids),
<code>KMeansClustering</code> (k-means) and <code>GMMClustering</code>
(Gaussian Mixture Models). Alternatively, a user-defined function taking
<code>xdata</code> and <code>Lambda</code> as arguments and returning a binary and
symmetric matrix for which diagonal elements are equal to zero can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical indicating if the data should be scaled to ensure that
all variables contribute equally to the clustering of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkage</code></td>
<td>
<p>character string indicating the type of linkage used in
hierarchical clustering to define the stable clusters. Possible values
include <code>"complete"</code>, <code>"single"</code> and <code>"average"</code> (see
argument <code>"method"</code> in <code>hclust</code> for a full list).
Only used if <code>implementation=HierarchicalClustering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row</code></td>
<td>
<p>logical indicating if rows (if <code>row=TRUE</code>) or columns (if
<code>row=FALSE</code>) contain the items to cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_data</code></td>
<td>
<p>logical indicating if the input datasets <code>xdata</code> and
<code>ydata</code> should be included in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating if a loading bar and messages should be
printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to the functions provided in
<code>implementation</code> or <code>resampling</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Sc</code></td>
<td>
<p>a matrix
of the best stability scores for different (sets of) parameters controlling
the number of clusters and penalisation of attribute weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>a
matrix of numbers of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>a matrix of regularisation
parameters for attribute weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>a matrix of the average number
of selected attributes by the underlying algorithm with different
regularisation parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coprop</code></td>
<td>
<p>an array of consensus matrices.
Rows and columns correspond to items. Indices along the third dimension
correspond to different parameters controlling the number of clusters and
penalisation of attribute weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selprop</code></td>
<td>
<p>an array of selection
proportions. Columns correspond to attributes. Rows correspond to different
parameters controlling the number of clusters and penalisation of attribute
weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a list with <code>type="clustering"</code> and values
used for arguments <code>implementation</code>, <code>linkage</code>, and
<code>resampling</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a list with values used for arguments
<code>K</code>, <code>tau</code>, <code>pk</code>, <code>n</code> (number of observations in
<code>xdata</code>), and <code>seed</code>.</p>
</td>
</tr>
</table>
<p> The rows of <code>Sc</code>, <code>nc</code>,
<code>Lambda</code>, <code>Q</code>, <code>selprop</code> and indices along the third
dimension of <code>coprop</code> are ordered in the same way and correspond to
parameter values stored in <code>nc</code> and <code>Lambda</code>.
</p>


</div>