<div class="container">

<table style="width: 100%;"><tr>
<td>saemixControl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>List of options for running the algorithm SAEM</h2>

<h3>Description</h3>

<p>List containing the variables relative to the optimisation algorithm. All
these elements are optional and will be set to default values when running
the algorithm if they are not specified by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">saemixControl(
  map = TRUE,
  fim = TRUE,
  ll.is = TRUE,
  ll.gq = FALSE,
  nbiter.saemix = c(300, 100),
  nbiter.sa = NA,
  nb.chains = 1,
  fix.seed = TRUE,
  seed = 23456,
  nmc.is = 5000,
  nu.is = 4,
  print.is = FALSE,
  nbdisplay = 100,
  displayProgress = FALSE,
  nbiter.burn = 5,
  nbiter.map = 5,
  nbiter.mcmc = c(2, 2, 2, 0),
  proba.mcmc = 0.4,
  stepsize.rw = 0.4,
  rw.init = 0.5,
  alpha.sa = 0.97,
  nnodes.gq = 12,
  nsd.gq = 4,
  maxim.maxiter = 100,
  nb.sim = 1000,
  nb.simpred = 100,
  ipar.lmcmc = 50,
  ipar.rmcmc = 0.05,
  print = TRUE,
  save = TRUE,
  save.graphs = TRUE,
  directory = "newdir",
  warnings = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>a boolean specifying whether to estimate the individual parameters (MAP estimates). Defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fim</code></td>
<td>
<p>a boolean specifying whether to estimate the Fisher Information Matrix and derive the estimation errors
for the parameters. Defaults to TRUE. The linearised approximation to the log-likelihood is also computed in the process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll.is</code></td>
<td>
<p>a boolean specifying whether to estimate the log-likelihood by importance sampling. Defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll.gq</code></td>
<td>
<p>a boolean specifying whether to estimate the log-likelihood by Gaussian quadrature. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbiter.saemix</code></td>
<td>
<p>nb of iterations in each step (a vector containing 2
elements, nbiter.saemix[1] for the exploration phase of the algorithm (K1) and nbiter.saemix[2]
for the smoothing phase (K2))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbiter.sa</code></td>
<td>
<p>nb of iterations subject to simulated annealing (defaults to nbiter.saemix[1]/2,
will be cut down to K1=nbiter.saemix[1] if greater than that value). We recommend to stop
simulated annealing before the end of the exploration phase (nbiter.saemix[1]).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.chains</code></td>
<td>
<p>nb of chains to be run in parallel in the MCMC algorithm
(defaults to 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.seed</code></td>
<td>
<p>TRUE (default) to use a fixed seed for the random number
generator. When FALSE, the random number generator is initialised using a
new seed, created from the current time.  Hence, different sessions started
at (sufficiently) different times will give different simulation results.
The seed is stored in the element seed of the options list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for the random number generator. Defaults to 123456</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmc.is</code></td>
<td>
<p>nb of samples used when computing the likelihood through
importance sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu.is</code></td>
<td>
<p>number of degrees of freedom of the Student distribution used
for the estimation of the log-likelihood by Importance Sampling. Defaults to
4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.is</code></td>
<td>
<p>when TRUE, a plot of the likelihood as a function of the
number of MCMC samples when computing the likelihood through importance
sampling is produced and updated every 500 samples. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbdisplay</code></td>
<td>
<p>nb of iterations after which to display progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displayProgress</code></td>
<td>
<p>when TRUE, the convergence plots are plotted after
every nbdisplay iteration, and a dot is written in the terminal window to
indicate progress. When FALSE, plots are not shown and the algorithm runs
silently. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbiter.burn</code></td>
<td>
<p>nb of iterations for burning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbiter.map</code></td>
<td>
<p>nb of iterations of the MAP kernel (4th kernel) to run at the beginning
of the estimation process (defaults to nbiter.saemix[1]/10 if nbiter.mcmc[4] is more than 0)
(EXPERIMENTAL, see Karimi et al. 2019 for details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbiter.mcmc</code></td>
<td>
<p>nb of iterations in each kernel during the MCMC step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba.mcmc</code></td>
<td>
<p>probability of acceptance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize.rw</code></td>
<td>
<p>stepsize for kernels q2 and q3 (defaults to 0.4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.init</code></td>
<td>
<p>initial variance parameters for kernels (defaults to 0.5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.sa</code></td>
<td>
<p>parameter controlling cooling in the Simulated Annealing
algorithm (defaults to 0.97)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnodes.gq</code></td>
<td>
<p>number of nodes to use for the Gaussian quadrature when
computing the likelihood with this method (defaults to 12)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsd.gq</code></td>
<td>
<p>span (in SD) over which to integrate when computing the
likelihood by Gaussian quadrature. Defaults to 4 (eg 4 times the SD)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxim.maxiter</code></td>
<td>
<p>Maximum number of iterations to use when maximising the
fixed effects in the algorithm. Defaults to 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.sim</code></td>
<td>
<p>number of simulations to perform to produce the VPC plots or
compute npde. Defaults to 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.simpred</code></td>
<td>
<p>number of simulations used to compute mean predictions
(ypred element), taken as a random sample within the nb.sim simulations used
for npde</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipar.lmcmc</code></td>
<td>
<p>number of iterations required to assume convergence for
the conditional estimates. Defaults to 50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipar.rmcmc</code></td>
<td>
<p>confidence interval for the conditional mean and variance.
Defaults to 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>whether the results of the fit should be printed out. Defaults
to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>whether the results of the fit should be saved to a file.
Defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.graphs</code></td>
<td>
<p>whether diagnostic graphs and individual graphs should be
saved to files. Defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>
<p>the directory in which to save the results. Defaults to
"newdir" in the current directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>whether warnings should be output during the fit. Defaults to FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All the variables are optional and will be set to their default value when
running <code>saemix</code>.
</p>
<p>The function <code>saemix</code> returns an object with an element options
containing the options used for the algorithm, with defaults set for
elements which have not been specified by the user.
</p>
<p>These elements are used in subsequent functions and are not meant to be used
directly.
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>
<p>B Karimi, M Lavielle , E Moulines E  (2019). f-SAEM: A fast Stochastic Approximation of the EM algorithm for nonlinear mixed effects models.
Computational Statistics &amp; Data Analysis, 141:123-38
</p>


<h3>See Also</h3>

<p><code>SaemixData</code>,<code>SaemixModel</code>,
<code>SaemixObject</code>, <code>saemix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# All default options
saemix.options&lt;-saemixControl()

# All default options, changing seed
saemix.options&lt;-saemixControl(seed=632545)

</code></pre>


</div>