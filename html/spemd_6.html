<div class="container">

<table style="width: 100%;"><tr>
<td>spEMD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spEMD</h2>

<h3>Description</h3>

<p>2D EMD for spatial objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">spEMD(data, zcol = "z", method = "splines", n.imf.max = 10,
  n.sp.max = 5, n.extrema.min = 1, stoprule = "mean.imf",
  stoprule.extrema = TRUE, thresh.extrema = 1, tol = 0,
  diff.nb.extrema = 0.05, abs.nb.extrema = 5, nb.nn = 4,
  n.pts.spline = 4, neig = NULL, save_neig = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Input dataset, either a 'data.frame' or a 'Spatial*DataFrame'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zcol</code></td>
<td>
<p>Name of the column containing the attribute of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Interpolation method. Currently only 'splines' is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.imf.max</code></td>
<td>
<p>Maximum depth of decomposition (maximum number of IMF).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sp.max</code></td>
<td>
<p>Number of iterations in the sifting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.extrema.min</code></td>
<td>
<p>Minimum number of extrema.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stoprule</code></td>
<td>
<p>Rule used to stop the EMD process. Currently only 'mean.imf' is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stoprule.extrema</code></td>
<td>
<p>Should 'spEMD' checks for the number of extrema to be similar? Defaults to 'TRUE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.extrema</code></td>
<td>
<p>Significative threshold for the extrema. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Value that the avergae of the IMF candidate need to reach so to be considered as a valid IMF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.nb.extrema</code></td>
<td>
<p>Percentage limit difference maxima/minima. If smaller, more permissive on the mean of the IMF candidate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.nb.extrema</code></td>
<td>
<p>Absolute difference between number of extrema.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.nn</code></td>
<td>
<p>Number of nearest neighbours to take into account (when data is on a regular grid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.pts.spline</code></td>
<td>
<p>Number of points to locally interpolate IMFs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neig</code></td>
<td>
<p>Option the re-use a formerly existing neig object in order to save time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_neig</code></td>
<td>
<p>Option to save the neig object as a .RData file once created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Prints progress information messages. Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>.
</p>


<h3>Author(s)</h3>

<p>Pierre Roudier
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Getting sample data from the gstat package
if (require(gstat)) {
library(sp)

# Example for gridded data
data(ncp.grid, package = 'gstat')
coordinates(ncp.grid) &lt;- ~x+y
gridded(ncp.grid) &lt;- TRUE
res.ncp &lt;- spEMD(ncp.grid, zcol = "depth", thresh.extrema = 0.1, verbose = FALSE)

# Plot results
spplot(res.ncp[, c('imf1', "imf2", "imf3")])
}

#


</code></pre>


</div>