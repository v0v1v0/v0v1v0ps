<div class="container">

<table style="width: 100%;"><tr>
<td>rTpdWn2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation from the approximated transition distribution of a WN diffusion in 2D</h2>

<h3>Description</h3>

<p>Simulates from the approximate transition density of the WN diffusion in 2D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rTpdWn2D(n, x0, t, mu, alpha, sigma, rho = 0, maxK = 2L, expTrc = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a matrix of dimension <code>c(nx0, 2)</code> giving the starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>vector of length <code>nx0</code> containing the times between observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of length <code>2</code> giving the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector of length <code>3</code> parametrizing the <code>A</code> matrix as in <code>alphaToA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of length <code>2</code> containing the <strong>square root</strong> of the diagonal of <code class="reqn">\Sigma</code>, the diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>maximum absolute value of the windings considered in the computation of the WN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expTrc</code></td>
<td>
<p>truncation for exponential: <code>exp(x)</code> with <code>x &lt;= -expTrc</code> is set to zero. Defaults to <code>30</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An array of dimension <code>c(n, 2, nx0)</code> containing the <code>n</code> samples of the transition distribution,
conditioned on that the process was at <code>x0</code> at <code>t</code> instants ago. The samples are all in <code class="reqn">[\pi,\pi)</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- c(3, 2, -1)
sigma &lt;- c(0.5, 1)
mu &lt;- c(pi, pi)
x &lt;- seq(-pi, pi, l = 100)
t &lt;- 0.5
image(x, x, matrix(dTpdWou2D(x = as.matrix(expand.grid(x, x)),
                            x0 = matrix(rep(0, 100 * 2),
                                        nrow = 100 * 100, ncol = 2),
                            t = t, mu = mu, alpha = alpha, sigma = sigma,
                            maxK = 2, expTrc = 30), nrow = 100, ncol = 100),
      zlim = c(0, 0.5))
points(rTpdWn2D(n = 500, x0 = rbind(c(0, 0)), t = t, mu = mu, alpha = alpha,
                sigma = sigma)[, , 1], col = 3)
points(stepAheadWn2D(x0 = rbind(c(0, 0)), delta = t / 500,
                     A = alphaToA(alpha = alpha, sigma = sigma),
                     mu = mu, sigma = sigma, N = 500, M = 500, maxK = 2,
                     expTrc = 30), col = 4)
</code></pre>


</div>