<div class="container">

<table style="width: 100%;"><tr>
<td>measles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Measles in UK spatPomp generator</h2>

<h3>Description</h3>

<p>Generate a spatPomp object for measles in the top-<code>U</code> most populous cities in England and Wales.
The model is adapted from He et al. (2010) with gravity transport following Park and Ionides (2020).
The data are from Dalziel et al (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">measles(
  U = 6,
  dt = 2/365,
  fixed_ivps = TRUE,
  S_0 = 0.032,
  E_0 = 5e-05,
  I_0 = 4e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>A length-one numeric signifying the number of cities to be represented in the spatPomp object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>a numeric (in unit of years) that is used as the Euler time-increment for simulating measles data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_ivps</code></td>
<td>
<p>a logical. If <code>TRUE</code> initial value parameters will be
declared in the <code>globals</code> slot, shared for each unit, and
will not be part of the parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_0</code></td>
<td>
<p>a numeric. If <code>fixed_ivps=TRUE</code> this is the initial proportion of all of the spatial units that are susceptible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_0</code></td>
<td>
<p>a numeric. If <code>fixed_ivps=TRUE</code> this is the initial proportion of all of the spatial units that are exposed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I_0</code></td>
<td>
<p>a numeric. If <code>fixed_ivps=TRUE</code> this is the initial proportion of all of the spatial units that are infected.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class ‘spatPomp’ representing a <code>U</code>-dimensional spatially coupled measles POMP model.
</p>


<h3>Relationship to published analysis</h3>

<p>This model was used to generate the results of Ionides et al (2021).
However, their equation (6) is not exactly correct for the Binomial Gamma infinitesimal model used in the code, as shown by Proposition 5 of Breto and Ionides, 2011.
If Poisson Gamma infinitesimal increments were used (Proposition 4 of Breto and Ionides, 2011) then (6) would be correct, but the resulting unbounded increments could break the non-negativity requirement for compartment membership.
The same issue arises with the description in Park and Ionides (2020), though that analysis was based on a different model implementation since the spatPomp package was not yet available.
</p>
<p>A difference between (6) of Ionides et al (2021) and (2.1) of He et al (2010) is that in (6) the mixing exponent <code class="reqn">\alpha</code> is applied to <code class="reqn">(I_u/P_u)</code> rather than just to <code class="reqn">I_u</code>.
In the context of He et al (2010) this changes the parameterization but has negligible effect on the model itself since <code class="reqn">P_u(t)</code> is approximately constant and so changing its power can be compensated by a corresponding change in the transmission rate, <code class="reqn">\beta</code>.
In practice, models fitted to data have <code class="reqn">alpha</code> close to <code class="reqn">1</code>, so this issue may be moot and  this modeling mechanism may not be an effective empirical way to carry out the goal of making allowance for heterogeneous mixing.
</p>
<p>The code here includes a cohort effect, <code class="reqn">c</code>, following He et al (2010), that was not included by Ionides et al (2021).
This effect leads to a non-differentiability of expected increments which is problematic for the spatPomp implementation of GIRF.
For the results of Ionides et al (2021), this was set to <code class="reqn">c=0</code>.
</p>
<p>The analysis of He et al (2010), and the model generated by <code>he10()</code>, use weekly aggregated cases.
Weekly reports were not available beyond the 20 cites studied by He et al (2010) so <code>measles()</code> relies on the biweekly reports used by Ionides et al (2021) and Ionides &amp; Park (2020).
</p>
<p>It turns out to be an important detail of the model by He et al (2010) that a delay is included between birth and entry into the susceptible compartment. 
He et al (2010) found a 4 year delay fits the data.
This value is fixed to be the variable <code>birth_delay</code> in the code for <code>measles()</code>.
The code for Ionides et al (2021) uses a 3 year delay, and the delay is not explained in the abbreviated model description.
In <code>measles()</code> we have reverted to the 4 year delay identified by He et al (2010).
</p>


<h3>Note</h3>

<p>This function goes through a typical workflow of constructing
a typical spatPomp object (1-4 below). This allows the user to have a
file that replicates the exercise of model building as well as function
that creates a typical nonlinear model in epidemiology in case they want
to test a new inference methodology. We purposely do not modularize this
function because it is not an operational piece of the package and is
instead useful as an example.<br>
1. Getting a measurements data.frame with columns for times,
spatial units and measurements.<br>
2. Getting a covariates data.frame with columns for times,
spatial units and covariate data.<br>
3. Constructing model components (latent state initializer,
latent state transition simulator and measurement model). Depending
on the methods used, the user may have to supply a vectorfield to
be integrated that represents the deterministic skeleton of the latent
process.<br>
4. Bringing all the data and model components together to form a
spatPomp object via a call to spatPomp().
</p>


<h3>Author(s)</h3>

<p>Edward L. Ionides
</p>


<h3>References</h3>

<p>Ionides, E. L., Asfaw, K., Park, J., and King, A. A. (2021). Bagged filters for partially observed interacting systems. <em>Journal of the American Statistical Association</em>, <a href="https://doi.org/10.1080/01621459.2021.1974867">doi:10.1080/01621459.2021.1974867</a>
</p>
<p>Dalziel, Benjamin D. et al. (2016) Persistent chaos of measles epidemics in the prevaccination United States caused by a small change in seasonal transmission patterns. <em>PLoS Computational Biology</em>, <b>12(2)</b>, e1004655. <a href="https://doi.org/10.5061/dryad.r4q34">doi:10.5061/dryad.r4q34</a>
</p>
<p>Park, J. and Ionides, E. L. (2020) Inference on high-dimensional implicit dynamic models using a guided intermediate resampling filter. <em>Statistics and Computing</em>, <a href="https://doi.org/10.1007/s11222-020-09957-3">doi:10.1007/s11222-020-09957-3</a>
</p>
<p>Breto, C. and Ionides, E.L. (2011) Compound Markov counting processes and their applications to modeling infinitesimally over-dispersed systems. Stochastic Processes and their Applications <b>121</b>, 2571-2591. <a href="https://doi.org/10.1016/j.spa.2011.07.005">doi:10.1016/j.spa.2011.07.005</a>
</p>


<h3>See Also</h3>

<p><code>measles_UK</code>, <code>city_data_UK</code>
</p>
<p>Other spatPomp model generators: 
<code>bm()</code>,
<code>bm2()</code>,
<code>gbm()</code>,
<code>he10()</code>,
<code>lorenz()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Complete examples are provided in the package tests
## Not run: 
m &lt;- measles(U = 5)
# See all the model specifications of the object
spy(m)

## End(Not run)
</code></pre>


</div>