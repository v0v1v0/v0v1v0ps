<div class="container">

<table style="width: 100%;"><tr>
<td>plot.sop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Default SOP plotting</h2>

<h3>Description</h3>

<p> Takes a fitted <code>sop</code> object produced by <code>sop()</code> and plots the component smooth functions that make it up, on the scale of the linear predictor. 

</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sop'
plot(x, rug = TRUE, pages = 0, select = NULL, grid, ...) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a fitted <code>sop</code> object as produced by <code>sop()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>when TRUE (default) then the covariate to which the plot applies is displayed as a rug plot at the foot of each plot of a 1-d smooth. Setting to <code>FALSE</code> will speed up plotting for large datasets.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>pages</code></td>
<td>
<p> (default 0) the number of pages over which to spread the output. For example, if <code>pages=1</code> then all terms will be plotted on one page with the layout performed automatically.  Set to 0 to have the routine leave all graphics settings as they are. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>Allows the  plot for a single model smooth term to be selected for printing. e.g. if you just want the plot for the second smooth term set <code>select = 2</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>number of covariate values used for each 1-d plot - for a nice smooth plot this needs to be several times the estimated degrees of freedom for the smooth. Default value 100.
</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other graphics parameters to pass on to plotting commands. See details for smooth plot specific options.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Produces default plot showing the smooth and random components of a fitted SOP.
</p>
<p>For smooth terms <code>plot.sop</code> actually calls plot method functions depending on the dimension of the smooth function.
</p>
<p>For plots of smooths in one dimension, the x axis of each plot is labelled with the covariate name, while the y axis is labelled '<code>f(cov),edf</code>'  where <code>cov</code> is the covariate name, and <code>edf</code> the estimated degrees of freedom of the smooth.
</p>
<p>Several smooth plots methods using <code>image</code> will accept a <code>colors</code> argument, which can be anything documented in <code>topo.colors</code> (in which case something like <code>colors=rainbow(50)</code> is appropriate), or the <code>grey</code> function (in which case something like <code>colors=grey(0:50/50)</code> is needed).
</p>


<h3>Value</h3>

<p>The function main purpose is to generate plots. It also (silently) returns a list of the data used to produce the plots for the smooth terms. This function is inspired by the plot.gam function of the same name described in mgcv package (but is not a clone).
</p>


<h3>See Also</h3>

<p><code>sop</code>, <code>predict.sop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(SOP)
## Simulate the data
set.seed(123)
n &lt;- 1000
sigma &lt;- 0.5
x &lt;- runif(n)
f0 &lt;- function(x) 2*sin(pi*x)
f &lt;- f0(x)
y &lt;- f + rnorm(n, 0, sigma)
dat &lt;- data.frame(x = x, y = y)

# Fit the model
m0 &lt;- sop(formula = y ~ f(x, nseg = 10), data = dat)
summary(m0)

# Plot results
plot(m0)

## An example of use of SOP package with tensor product B-splines in 2D
# Simulate the data
set.seed(123)
n &lt;- 1000
sigma &lt;- 0.1
x1 &lt;- runif(n, -1, 1)
x2 &lt;- runif(n, -1, 1)
f0 &lt;- function(x1, x2) cos(2*pi*sqrt((x1 - 0.5)^2 + (x2 - 0.5)^2))
f &lt;- f0(x1, x2)
y &lt;- f + rnorm(n, 0, sigma)

dat &lt;- data.frame(x1 = x1, x2 = x2, y = y)

m0 &lt;- sop(formula = y ~ f(x1, x2, nseg = 10), data = dat, 
        control = list(trace = FALSE))

summary(m0)
plot(m0, col = topo.colors(100))

plot(m0, col = grey(0:100/100))

aux &lt;- plot(m0)
names(aux)
</code></pre>


</div>