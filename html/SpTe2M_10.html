<div class="container">

<table style="width: 100%;"><tr>
<td>sptemnt_ewsl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatio-temporal process monitoring using exponentially weighted spatial LASSO</h2>

<h3>Description</h3>

<p>Implementation of the online spatio-temporal process monitoring procedure 
described in Qiu and Yang (2023), in which spatial locations with the detected 
shifts are guaranteed to be small clustered spatal regions by the exponentially 
weighted spatial LASSO.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sptemnt_ewsl(
  y,
  st,
  type,
  ARL0 = 200,
  lambda = 0.1,
  B = 1000,
  bs = 5,
  T = 1,
  ht = NULL,
  hs = NULL,
  gt = NULL,
  gs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations and times for 
all the spatio-temporal observations in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A vector of <code class="reqn">N</code> characters specifying the types of the observations. 
Here, <code>type</code> could be <code>IC1</code>, <code>IC2</code> or <code>Mnt</code>, where 
<code>type='IC1'</code> denotes the in-control (IC) observations used to perform 
the block bootstrap procedure to determine the control limit of the CUSUM 
chart, <code>type='IC2'</code> denotes the IC observations used to estimate the 
spatio-temporal mean and covariance functions by <code>spte_meanest</code> and 
<code>spte_covest</code>, and <code>type='Mnt'</code> denotes the observations used 
for online process monitoring (cf., Yang and Qiu 2021). If there are only 
data points with either <code>type='IC1'</code> or <code>type='IC2'</code>, then these 
data points will be used to estimate the model and conduct the bootstrap 
procedure as well. This function will return an error if there are no 
observations with <code>type='IC1'</code> or <code>type='IC2'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARL0</code></td>
<td>
<p>The pre-specified IC average run length. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The pre-specified weighting parameter in the EWMAC chart. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The bootstrap sizes used in the block bootstrap procedure for determining 
the control limit. Default value is 1,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>The block size of the block bootstrap procedure. Default value is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation via <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code> and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ARL0</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat</code></td>
<td>
<p>The charting statistics which can be used to make 
a plot for the control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>The control limit that is determined by the block bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal_time</code></td>
<td>
<p>The signal time (i.e., the first time point when the 
charting statistic <code>cstat</code> exceeds the control limit <code>cl</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2023). Spatio-Temporal Process Monitoring Using 
Exponentially Weighted Spatial LASSO. <em>Journal of Quality Technology</em>, 
<strong>55</strong>, 163-180.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(ili_dat)
n &lt;- 365; m &lt;- 67
y &lt;- ili_dat$Rate; st &lt;- ili_dat[,3:5]
type &lt;- rep(c('IC1','IC2','Mnt'),c(m*(n+1),(m*n),(m*n)))
ids &lt;- c(1:(5*m),((n+1)*m+1):(m*(n+6)),((2*n+1)*m+1):(m*(2*n+6)))
y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]; type.sub &lt;- type[ids]
ili.ewsl &lt;- sptemnt_ewsl(y.sub,st.sub,type.sub,ht=0.05,hs=6.5,gt=0.25,gs=1.5)
</code></pre>


</div>