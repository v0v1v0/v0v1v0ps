<div class="container">

<table style="width: 100%;"><tr>
<td>model_profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dataset Level Variable Profile as Partial Dependence Explanations for Survival Models</h2>

<h3>Description</h3>

<p>This function calculates explanations on a dataset level that help explore model response as a function of selected variables.
The explanations are calculated as an extension of Partial Dependence Profiles with the inclusion of the time dimension.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_profile(
  explainer,
  variables = NULL,
  N = 100,
  ...,
  groups = NULL,
  k = NULL,
  type = "partial",
  center = FALSE,
  output_type = "survival"
)

## S3 method for class 'surv_explainer'
model_profile(
  explainer,
  variables = NULL,
  N = 100,
  ...,
  categorical_variables = NULL,
  grid_points = 51,
  variable_splits_type = "uniform",
  groups = NULL,
  k = NULL,
  center = FALSE,
  type = "partial",
  output_type = "survival"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>explainer</code></td>
<td>
<p>an explainer object - model preprocessed by the <code>explain()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>character, a vector of names of variables to be explained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of observations used for the calculation of aggregated profiles. By default <code>100</code>. If <code>NULL</code> all observations are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to <code>DALEX::model_profile</code> if <code>output_type == "risk"</code>, otherwise ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>if <code>output_type == "risk"</code> a variable name that will be used for grouping. By default <code>NULL</code>, so no groups are calculated. If <code>output_type == "survival"</code> then ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>passed to <code>DALEX::model_profile</code> if <code>output_type == "risk"</code>, otherwise ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of variable profile, <code>"partial"</code> for Partial Dependence, <code>"accumulated"</code> for Accumulated Local Effects, or <code>"conditional"</code> (available only for <code>output_type == "risk"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical, should profiles be centered around the average prediction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_type</code></td>
<td>
<p>either <code>"survival"</code>, <code>"chf"</code> or <code>"risk"</code> the type of survival model output that should be considered for explanations. If <code>"survival"</code> the explanations are based on the survival function. If <code>"chf"</code> the explanations are based on the cumulative hazard function. Otherwise the scalar risk predictions are used by the <code>DALEX::predict_profile</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical_variables</code></td>
<td>
<p>character, a vector of names of additional variables which should be treated as categorical (factors are automatically treated as categorical variables). If it contains variable names not present in the <code>variables</code> argument, they will be added at the end.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_points</code></td>
<td>
<p>maximum number of points for profile calculations. Note that the final number of points may be lower than grid_points. Will be passed to internal function. By default <code>51</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_splits_type</code></td>
<td>
<p>character, decides how variable grids should be calculated. Use <code>"quantiles"</code> for percentiles or <code>"uniform"</code> (default) to get uniform grid of points.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>model_profile_survival</code>. It is a list with the element <code>result</code> containing the results of the calculation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(survival)
library(survex)

cph &lt;- coxph(Surv(time, status) ~ ., data = veteran, model = TRUE, x = TRUE, y = TRUE)
rsf_src &lt;- randomForestSRC::rfsrc(Surv(time, status) ~ ., data = veteran)

cph_exp &lt;- explain(cph)
rsf_src_exp &lt;- explain(rsf_src)

cph_model_profile &lt;- model_profile(cph_exp,
    output_type = "survival",
    variables = c("age")
)

head(cph_model_profile$result)

plot(cph_model_profile)

rsf_model_profile &lt;- model_profile(rsf_src_exp,
    output_type = "survival",
    variables = c("age", "celltype"),
    type = "accumulated"
)

head(rsf_model_profile$result)

plot(rsf_model_profile, variables = c("age", "celltype"), numerical_plot_type = "contours")


</code></pre>


</div>