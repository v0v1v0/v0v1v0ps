<div class="container">

<table style="width: 100%;"><tr>
<td>estAbund</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
estimate Abundances from sonicated samples
</h2>

<h3>Description</h3>

<p>When one or more replicate samples are sonicated and the lengths for each
integration site are recorded, it is of interest to estimate actual
number of sonicants allowing for coincidentally equal lengths. A
likelihood approach is used  here. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">estAbund(locations, lengths, replicates = NULL, jackknife = F, kmax=0,
min.length = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>

<p>a vector of IDs for distinct locations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengths</code></td>
<td>

<p>a vector of the corresponding lengths
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>

<p>an optional vector of the replicate sample ID
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackknife</code></td>
<td>

<p>Whether to do leave-one-out jackknife samples over the replicates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>highest count to bother with when computing mass function
for counts. All higher values are
globbed together in the result. If <code>kmax==0</code> don't compute </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.length</code></td>
<td>
<p>Least length expected for a fragment.  Shorter
lengths will not be permitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments that may be passed along to functions that do the
real work.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function for <code>maxEM</code> so study that
function to see what is going on.
</p>


<h3>Value</h3>

<p>a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p> estimated abundances </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>  estimated bin probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.theta</code></td>
<td>
<p> variances of <code>theta</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p> number of iterations till convergence was achieved </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> the function call </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lframe</code></td>
<td>
<p> the <code>data.frame</code> used to construct the estimate of
<code>phi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p> the observed counts of distinct lengths </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackknife</code></td>
<td>
<p> a list of calls to <code> maxEM </code> with one replicate
omitted in each</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a <code>data.frame</code> with columns
<code>locations</code>,<code>lengths</code>, and <code>replicates</code> (if supplied) </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Charles C Berry <a href="mailto:ccberry@users.r-forge.r-project.org">ccberry@users.r-forge.r-project.org</a>
</p>


<h3>References</h3>

<p>Estimating abundances of retroviral insertion sites 
from DNA fragment length data. Berry CC, Gillet NA, 
Melamed A, Gormley N, Bangham CR, Bushman FD.
Bioinformatics; 2012 Mar 15;28(6):755-62.  
</p>


<h3>See Also</h3>

<p><code>maxEM</code>
<code>phi.update.lframe</code>
The package vignette:Estimating Abundances with sonicLength
</p>


</div>