<div class="container">

<table style="width: 100%;"><tr>
<td>spe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Sorted Partial Effects (SPE) and Inference</h2>

<h3>Description</h3>

<p><code>spe</code> conducts SPE estimation and inference at user-specifed quantile
index. The bootstrap procedures follows algorithm 2.1 as in Chernozhukov,
Fernandez-Val and Luo (2018). All estimates are bias-corrected and all
confidence bands are monotonized. For graphical results, please use
<code>plot.spe</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spe(
  fm,
  data,
  method = c("ols", "logit", "probit", "QR"),
  var_type = c("binary", "continuous", "categorical"),
  var,
  compare,
  subgroup = NULL,
  samp_weight = NULL,
  us = c(1:9)/10,
  alpha = 0.1,
  taus = c(5:95)/100,
  b = 500,
  parallel = FALSE,
  ncores = detectCores(),
  seed = 1,
  bc = TRUE,
  boot_type = c("nonpar", "weighted")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fm</code></td>
<td>
<p>Regression formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data in use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Models to be used for estimating partial effects. Four
options: <code>"logit"</code> (binary response),
<code>"probit"</code> (binary response), <code>"ols"</code>
(interactive linear with additive errors), <code>"QR"</code>
(linear model with non-additive errors). Default is
<code>"ols"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_type</code></td>
<td>
<p>The type of parameter in interest. Three options:
<code>"binary"</code>, <code>"categorical"</code>,
<code>"continuous"</code>. Default is <code>"binary"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Variable T in interset. Should be a character type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compare</code></td>
<td>
<p>If parameter in interest is categorical, then user needs
to specify which two category to compare with. Should be
a 1 by 2 character vector. For example, if the two levels
to compare with is 1 and 3, then <code>c=("1", "3")</code>,
which will calculate partial effect from 1 to 3. To use
this option, users first need to specify <code>var</code> as a
factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup</code></td>
<td>
<p>Subgroup in interest. Default is <code>NULL</code>.
Specifcation should be a logical variable. For example,
suppose data contains indicator variable for women
(female if 1, male if 0). If users are interested in
women SPE, then users should specify <code>subgroup =
data[, "female"] == 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp_weight</code></td>
<td>
<p>Sampling weight of data. Input should be a n by 1 vector,
where n denotes sample size. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>us</code></td>
<td>
<p>Percentile of interest for SPE. Should be a vector of
values between 0 and 1. Default is <code>c(1:9)/10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Size for confidence interval. Shoule be between 0 and 1.
Default is 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>Indexes for quantile regression. Default is
<code>c(5:95)/100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Number of bootstrap draws. Default is set to be 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Whether the user wants to use parallel computation.
The default is <code>FALSE</code> and only 1 CPU will be used.
The other option is <code>TRUE</code>, and user can specify
the number of CPUs in the <code>ncores</code> option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores for computation. Default is set to be
<code>detectCores()</code>, which is a function from package
<code>parallel</code> that detects the number of CPUs on the
current host. For large dataset, parallel computing is
highly recommended since bootstrap is time-consuming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Pseudo-number generation for reproduction. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bc</code></td>
<td>
<p>Whether want the estimate to be bias-corrected. Default
is <code>TRUE</code>. If <code>FALSE</code> uncorrected estimate and
corresponding confidence bands will be reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot_type</code></td>
<td>
<p>Type of bootstrap. Default is <code>"nonpar"</code>, and the
package implements nonparametric bootstrap. The other
alternative is <code>"weighted"</code>, and the package
implements weighted bootstrap.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output is a list with 4 components: (1) <code>spe</code> stores spe
estimates, the upper and lower confidence bounds, and standard errors;
(2) <code>ape</code> stores ape estimates, the upper and lower confidence bounds,
and the standard error; (3) <code>us</code> stores percentile index as in \
codespe command; (4) <code>alpha</code> stores significance level as in
<code>spe</code> command.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("mortgage")
fm &lt;- deny ~ black + p_irat + hse_inc + ccred + mcred + pubrec + ltv_med +
ltv_high + denpmi + selfemp + single + hischl

test &lt;- spe(fm = fm, data = mortgage, var = "black", method = "logit",
us = c(2:98)/100, b = 50)

</code></pre>


</div>