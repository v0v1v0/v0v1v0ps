<div class="container">

<table style="width: 100%;"><tr>
<td>systemfit.control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create list of control parameters for systemfit</h2>

<h3>Description</h3>

<p>Create a list of control pararameters for function <code>systemfit</code>.
All control parameters that are not passed to this function
are set to default values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">systemfit.control(
      maxiter = 1,
      tol = 1e-5,
      methodResidCov = "geomean",
      centerResiduals = FALSE,
      residCovRestricted = TRUE,
      residCovWeighted = FALSE,
      method3sls = "GLS",
      singleEqSigma = NULL,
      useMatrix = TRUE,
      solvetol = .Machine$double.eps,
      model = TRUE,
      x = FALSE,
      y = FALSE,
      z = FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for WLS, SUR, W2SLS and
3SLS estimations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance level indicating when to stop the iteration (only
WLS, SUR, W2SLS and 3SLS estimations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methodResidCov</code></td>
<td>
<p>method for calculating the estimated residual covariance
matrix, one of "noDfCor", "geomean", "max", or "Theil" (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerResiduals</code></td>
<td>
<p>logical. Subtract the means from the residuals
of each equation before calculating the estimated residual covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residCovRestricted</code></td>
<td>
<p>logical. If 'FALSE'
the residual covariance matrix for a WLS, SUR, W2SLS, or 3SLS estimation
is obtained from an unrestricted first-step estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residCovWeighted</code></td>
<td>
<p>logical. If 'TRUE'
the residual covariance matrix for a SUR or 3SLS estimation
is obtained from a WLS or W2SLS estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method3sls</code></td>
<td>
<p>method for calculating the 3SLS estimator,
one of "GLS", "IV", "GMM", "Schmidt", or "EViews" (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singleEqSigma</code></td>
<td>
<p>logical. use different <code class="reqn">\sigma^2</code>s for each
single equation to calculate the covariance matrix and the
standard errors of the coefficients (only OLS and 2SLS)?
If <code>singleEqSigma</code> is <code>NULL</code>, it is automatically determined:
It is set to <code>TRUE</code>, if restrictions on the coefficients are imposed,
and it is set to <code>FALSE</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useMatrix</code></td>
<td>
<p>logical. Use package <code>Matrix</code> for matrix calculations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solvetol</code></td>
<td>
<p>tolerance level for detecting linear dependencies
when inverting a matrix or calculating a determinant (see
<code>solve</code> and <code>det</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model, x, y, z</code></td>
<td>

<p>logical. If 'TRUE' the corresponding components of the fit
(the model frame, the model matrix, the response, and
the matrix of instruments, respectively) are returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the estimation is iterated
(WLS, SUR, W2SLS or 3SLS estimation with <code>maxiter</code>&gt;1),
the convergence criterion is
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{ \frac{ \sum_i (b_{i,g} - b_{i,g-1})^2 }{ \sum_i b_{i,g-1}^2 }}
      &lt; \code{tol}</code>
</p>

<p>(<code class="reqn">b_{i,g}</code> is the ith coefficient of the gth iteration step).
</p>
<p>The method for calculating the estimated covariance matrix of the residuals
(<code class="reqn">\hat{\Sigma}</code>) can be one of the following
(see Judge et al., 1985, p. 469): <br>
if methodResidCov='noDfCor':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}{T}</code>
</p>

<p>if methodResidCov='geomean':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}
         {\sqrt{(T - k_i)*(T - k_j)}}</code>
</p>

<p>if methodResidCov='Theil':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}{T - k_i - k_j
      + tr[X_i(X_i'X_i)^{-1}X_i'X_j(X_j'X_j)^{-1}X_j']}</code>
</p>

<p>if methodResidCov='max':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}
         {T - \max( k_i, k_j)}</code>
</p>

<p>If <code class="reqn"> i = j</code>, the formulas 'geomean', 'Theil', and 'max' are equal.
All these three formulas yield unbiased estimators
for the diagonal elements of the residual covariance matrix.
If <code class="reqn">i \neq j</code>, only formula 'Theil' yields an unbiased estimator for the residual
covariance matrix, but it is not neccessarily positive semidefinit. Thus, it is
doubtful whether formula 'Theil' is really superior to formula 'noDfCor'
(Theil, 1971, p. 322).
</p>
<p>The methods for calculating the 3SLS estimator lead to identical results
if the same instruments are used in all equations. If different instruments
are used in the different equations, only the GMM-3SLS estimator ("GMM")
and the 3SLS estimator proposed by Schmidt (1990) ("Schmidt") are consistent,
whereas "GMM" is efficient relative to "Schmidt" (see Schmidt, 1990).
</p>
<p>If <code>residCovWeighted</code> is <code>TRUE</code>,
<code>systemfit</code> does a OLS or 2SLS estimation in a first step.
It uses the residuals from the first-step estimation
to calculate the residual covariance matrix
that is used in a second-step WLS or W2SLS estimation.
Then, it uses the residuals from the second-step estimation
to calculate the residual covariance matrix
that is used in a final SUR or 3SLS estimation.
This three-step method is the default method of command "TSCS"
in the software LIMDEP that carries out "SUR" estimations
in which all coefficient vectors are constrained to be equal
(personal information from W.H. Greene, 2006/02/16).
If no cross-equation restrictions are imposed,
<code>residCovWeighted</code> has no effect on the estimation results.
</p>


<h3>Value</h3>

<p>A list of the above components.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Judge, George G.; W. E. Griffiths; R. Carter Hill; Helmut Luetkepohl and Tsoung-Chao Lee (1985)
<em>The Theory and Practice of Econometrics, Second Edition</em>, Wiley.
</p>
<p>Schmidt, P. (1990)
<em>Three-Stage Least Squares with different Instruments for different equations</em>,
Journal of Econometrics 43, p. 389-394.
</p>
<p>Theil, H. (1971)
<em>Principles of Econometrics</em>, Wiley, New York.
</p>


<h3>See Also</h3>

<p><code>systemfit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
eqSystem &lt;- list( demand = eqDemand, supply = eqSupply )

## SUR estimation: calculation of residual covariance
## matrix without correction for degrees of freedom
fitsur &lt;- systemfit( eqSystem, "SUR", data = Kmenta,
    control = systemfit.control( methodResidCov = "noDfCor" ) )
print( fitsur )
</code></pre>


</div>