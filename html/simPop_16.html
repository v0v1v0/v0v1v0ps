<div class="container">

<table style="width: 100%;"><tr>
<td>correctSingleHeap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>correctSingleHeap</h2>

<h3>Description</h3>

<p>Correct a specific age heap in a vector containing age in years
</p>


<h3>Usage</h3>

<pre><code class="language-R">correctSingleHeap(
  x,
  heap,
  before = 2,
  after = 2,
  method = "lnorm",
  fixed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector representing age in years (integers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heap</code></td>
<td>
<p>numeric or integer vector of length 1 specifying the year
for which a heap should be corrected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>before</code></td>
<td>
<p>numeric or integer vector of length 1 specifying the number
of years before the heap that may be used to correct the heap. This input will
be rounded!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>after</code></td>
<td>
<p>numeric or integer vector of length 1 specifying the number
of years after the heap that may be used to correct the heap. This input will
be rounded!
</p>

<ul>
<li> <p><code>5year</code>: heaps are assumed to be every 5 years (0,5,10,...)
</p>
</li>
<li> <p><code>10year</code>: heaps are assumed to be every 10 years (0,10,20,...)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character specifying the algorithm used to correct the age
heaps. Allowed values are
</p>

<ul>
<li> <p><code>lnorm</code>: drawing from a truncated log-normal distribution. The
required parameters are estimated using original input data.
</p>
</li>
<li> <p><code>norm</code>: drawing from a truncated normal distribution. The
required parameters are estimated using original input data.
</p>
</li>
<li> <p><code>unif</code>: random sampling from a (truncated) uniform distribution
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>numeric index vector with observation that should not be changed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a numeric vector without age heaps
</p>


<h3>Author(s)</h3>

<p>Matthias Templ, Bernhard Meindl, Alexander Kowarik
</p>


<h3>Examples</h3>

<pre><code class="language-R">## create some artificial data
age &lt;- rlnorm(10000, meanlog=2.466869, sdlog=1.652772)
age &lt;- round(age[age &lt; 93])
barplot(table(age))

## artificially introduce an age heap for a specific year
## and correct it
age23 &lt;- c(age, rep(23, length=sum(age==23)))
cc23 &lt;- rep("darkgrey", length(unique(age)))
cc23[24] &lt;- "yellow"
barplot(table(age23), col=cc23)
barplot(table(correctSingleHeap(age23, heap=23, before=2, after=3, method="lnorm")), col=cc23)
barplot(table(correctSingleHeap(age23, heap=23, before=5, after=5, method="lnorm")), col=cc23)

# the first 5 observations should be unchanged
barplot(table(correctSingleHeap(age23, heap=23, before=5, after=5, method="lnorm",
  fixed=1:5)), col=cc23)
</code></pre>


</div>