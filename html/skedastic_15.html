<div class="container">

<table style="width: 100%;"><tr>
<td>dDtrend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability mass function of nonparametric trend statistic <code class="reqn">D</code>
</h2>

<h3>Description</h3>

<p>This function computes <code class="reqn">\Pr(D = k)</code>, i.e. the probability mass
function for <code class="reqn">D=\sum_{i=1}^{n} (R_i - i)^2</code>, the nonparametric trend
statistic proposed by Lehmann (1975), under the
assumption that the ranks <code class="reqn">R_i</code> are computed on a series of <code class="reqn">n</code>
independent and identically distributed random variables with no ties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dDtrend(k = "all", n, override = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer of <code>length</code> <code class="reqn">\ge 1</code>
or a character <code>"all"</code> (the default) indicating that the probability
mass function should be applied to the entire support of <code class="reqn">D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer representing the number of observations in the
series. Note that computation time increases rapidly with <code class="reqn">n</code> and is
infeasible for <code class="reqn">n&gt;11</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>override</code></td>
<td>
<p>A logical. By default, the function aborts if <code class="reqn">n &gt; 11</code>
due to the prohibitively slow computation (which may cause some systems
to crash). Setting this argument to <code>TRUE</code> overrides the abort.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is used within <code>horn</code> in computing
<code class="reqn">p</code>-values for Horn's nonparametric test for heteroskedasticity in a
linear regression model (Horn 1981). The support of
<code class="reqn">D</code> consists of consecutive even numbers from 0 to
<code class="reqn">\frac{n(n-1)(n+1)}{3}</code>, with the exception of the case <code class="reqn">n=3</code>,
when the value 4 is excluded from the support. Note that computation speed
for <code>k = "all"</code> is about the same as when <code>k</code> is set to an
individual integer value, because the entire distribution is still
computed in the latter case.
</p>


<h3>Value</h3>

<p>A double vector containing the probabilities corresponding to the
integers in its <code>names</code> attribute.
</p>


<h3>References</h3>

<p>Horn P (1981).
“Heteroscedasticity of Residuals: A Non-Parametric Alternative to the Goldfeld-Quandt Peak Test.”
<em>Communications in Statistics - Theory and Methods</em>, <b>10</b>(8), 795–808.<br><br> Lehmann EL (1975).
<em>Nonparametrics: Statistical Methods Based on Ranks</em>.
Holden-Day, San Francisco.
</p>


<h3>See Also</h3>

<p><code>horn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">prob &lt;- dDtrend(k = "all", n = 6)
values &lt;- as.integer(names(prob))
plot(c(values[1], values[1]), c(0, prob[1]), type = "l",
  axes = FALSE, xlab = expression(k), ylab = expression(Pr(D == k)),
  xlim = c(0, 70), yaxs = "i", ylim = c(0, 1.05 * max(prob)))
  axis(side = 1, at = seq(0, 70, 10), las = 2)
for (i in seq_along(values)) {
 lines(c(values[i], values[i]), c(0, prob[i]))
}

</code></pre>


</div>