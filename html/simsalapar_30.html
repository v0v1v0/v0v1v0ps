<div class="container">

<table style="width: 100%;"><tr>
<td>array-stuff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tools For Converting To and From Arrays, Lists, and Array of Lists</h2>

<h3>Description</h3>


<dl>
<dt>ul()</dt>
<dd>
<p>is a simple wrapper for <code>unlist()</code> with
<code>recursive=FALSE</code>.</p>
</dd>
<dt>mkAL()</dt>
<dd>
<p>gets a list <code>x</code> with elements that are named
lists of length five, see <code>x</code> below, and converts it to an
array of <code>list</code>s.</p>
</dd>
<dt>saveSim()</dt>
<dd>
<p>(optionally) converts a result list to an array using
<code>mkAL()</code> and (optionally) saves it to a file via <code>saveRDS()</code>.</p>
</dd>
<dt>maybeRead()</dt>
<dd>
<p>if the provided ‘<span class="file">.rds</span>’ file exists, this function
reads it via <code>readRDS()</code>; otherwise, nothing is done.</p>
</dd>
<dt>getArray()</dt>
<dd>
<p>gets an array of 4-<code>list</code>s as returned
by <code>mkAL()</code>, picks out the specified component <code>comp</code>,
applies the specified function <code>FUN</code> (with useful defaults),
and builds an <code>array</code>.</p>
</dd>
<dt>array2df()</dt>
<dd>
<p>auxiliary function to convert an array to a
<code>data.frame</code> (correctly dealing with <code>n.sim</code>).</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">ul(x)

mkAL   (x, vList, repFirst, check=TRUE)
saveSim(x, vList, repFirst, sfile, check=TRUE, doAL=TRUE)

maybeRead(sfile, msg=TRUE)

getArray(x, comp=c("value", "error", "warning", "time"),
         FUN=NULL, err.value=NA)

array2df(x, responseName = "value")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for
</p>

<dl>
<dt>ul()</dt>
<dd>
<p>a list.</p>
</dd>
<dt>mkAL(), saveSim()</dt>
<dd>
<p>a list (of length
<code>n.sim * nrow(pGrid)</code>)
where each element is a list of length
five, containing the named elements <code>"value"</code>,
<code>"error"</code>, <code>"warning"</code>, <code>"time"</code>, and
<code>".Random.seed"</code>, the first four as returned by
<code>doCallWE()</code>.</p>
</dd>
<dt>getArray()</dt>
<dd>
<p>an array of <code>list</code>s as
returned by <code>mkAL()</code>.</p>
</dd>
<dt>array2df()</dt>
<dd>
<p>a numeric array as returned by
<code>getArray(*, "value")</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vList</code></td>
<td>
<p>a <code>list</code> of variable specifications.  Each
variable specification is itself a named list which must contain a
<code>"value"</code> component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repFirst</code></td>
<td>
<p>logical; <b>must</b> match the value of <code>repFirst</code>
in the <code>x &lt;- do*Apply()</code> call where <code>x</code> has been created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p><code>logical</code> activating consistency checks for
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sfile</code></td>
<td>
<p>a file name, typically with extension ‘<span class="file">.rds</span>’ or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doAL</code></td>
<td>
<p><code>logical</code> indicating if <code>mkAL()</code> should
be called, or rather just <code>x</code> be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p><code>logical</code> indicating whether a message is
printed when an object is read from <code>sfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.value</code></td>
<td>
<p><code>numeric</code> which is used to replace the
value of the array entry in case of an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>character string denoting the component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>function to be applied right before the resulting array
<code>array</code> is constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>responseName</code></td>
<td>
<p>(for <code>arrady2df()</code>:) a string specifying the
name of the “value” column of the resulting data frame.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mkAL()</code> is useful when creating arrays from result
lists returned from large(r) simulation studies which use
<code>doCallWE()</code>. To create a proper argument <code>x</code> for
<code>mkAL()</code>, the function <code>ul()</code> turns out to
be useful to (stepwise) unlist nested lists.
</p>
<p><code>getArray()</code> converts arrays of lists as returned by
<code>mkAL()</code> to an <code>array</code> of <code>numeric</code> (or
<code>logical</code>, see below) after applying the specified <code>FUN</code>.
<br>
In case of an error, the corresponding entry in the resulting array is
replaced by <code>err.value</code>.
</p>
<p>The default <code>FUN</code> converts possible errors and warnings to
<code>logical</code> (indicating whether there was a error or
warning, respectively) and run times to <code>numeric</code>.  For
<code>comp="value"</code>, the situation is trickier.  First of all, the
resulting array contains dimensions for variables of type
“inner” and, if greater than 1, for the variable of type
“N” (typically called <code>"n.sim"</code>); see the vignette for
details.
<br>
Use <code>FUN = identity</code> to get at the full error or warning objects,
for <code>comp = "error"</code> or for <code>comp = "warning"</code>, respectively.
</p>
<p><code>saveSim()</code> and <code>maybeRead()</code> are
useful for creating and (re)storing arrays from large(r) simulation
studies (to avoid recomputation, to ease the data analysis etc.).
<code>saveSim()</code> calls <code>mkAL()</code>, nowadays wrapped in
<code>tryCatch(.)</code>, such that the simulation is not lost, even
when the resulting format cannot correctly be treated by
<code>mkAL()</code>.  Consequently, <code>doAL</code> is not much needed anymore.
Note that both <code>saveSim()</code> and <code>maybeRead()</code> accept
<code>sfile=NULL</code> in which case nothing is saved or read.
</p>


<h3>Value</h3>

<p>For </p>

<dl>
<dt>ul()</dt>
<dd>
<p>the unlisted list; see <code>unlist()</code>.</p>
</dd>
<dt>mkAL()</dt>
<dd>
<p>an <code>array</code> of <code>list</code>s.</p>
</dd>
<dt>saveSim()</dt>
<dd>
<p>the <code>array</code> returned by
<code>mkAL()</code>.</p>
</dd>
<dt>maybeRead()</dt>
<dd>
<p>the object read by <code>readRDS()</code> from
<code>sfile</code> or nothing (if <code>sfile</code> does not exist).</p>
</dd>
<dt>getArray()</dt>
<dd>
<p>an <code>array</code> containing the values
of the specified component <code>comp</code> after applying <code>FUN</code>
to them.  The default <code>FUN</code> produces an <code>array</code>,
depending on <code>comp</code>, of
</p>

<dl>
<dt>"value":</dt>
<dd>
<p>values or <code>err.value</code> (in case of an error)</p>
</dd>
<dt>"error":</dt>
<dd>
<p>logicals indicating whether there was an error</p>
</dd>
<dt>"warning":</dt>
<dd>
<p>logicals indicating whether there was a warning</p>
</dd>
<dt>"time":</dt>
<dd>
<p>timings as returned by <code>doCallWE()</code>,
i.e., typically (from <code>mkTimer</code>'s
<code>proc.time()[1]</code>) the number of milliseconds
of “"CPU user time"”.</p>
</dd>
</dl>
</dd>
<dt>array2df(x)</dt>
<dd>
<p>a <code>data.frame</code> with several columns
built from the <code>dimnames(x)</code> and a column named
<code>responseName</code> with the values of <code>x</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Marius Hofert and Martin Maechler.</p>


<h3>References</h3>

<p>see <code>simsalapar-package</code>.</p>


<h3>See Also</h3>

<p><code>getEl()</code> and <code>mkNms()</code> used by
<code>mkAL()</code>. <code>saveRDS()</code> and
<code>readRDS()</code>, the “workhorses” of
<code>saveSim()</code> and <code>maybeRead()</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Get at the full error objects, notably (message, call):
errObjs &lt;- getArray(res, "error", FUN=identity)

## End(Not run)

if(FALSE) ## A longer, "interesting" example is in
 demo(robust.mean)
</code></pre>


</div>