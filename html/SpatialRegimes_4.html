<div class="container">

<table style="width: 100%;"><tr>
<td>SkaterF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial constrained clusterwise regression by Spatial 'K'luster Analysis by Tree Edge Removal</h2>

<h3>Description</h3>

<p>This function implements a spatial constrained clusterwise regression based on the Skater procedure by Assuncao et al. (2002).</p>


<h3>Usage</h3>

<pre><code class="language-R">SkaterF(edges,data,coly,colx,ncuts,crit,method=1,ind_col,lat,long,tau.ch)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>edges</code></td>
<td>
<p>A matrix with 2 colums with each row is an edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame with the informations over nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coly</code></td>
<td>
<p>The dependent variable in the c("y_ols") form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colx</code></td>
<td>
<p>The covariates in the c("x1","x2") form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncuts</code></td>
<td>
<p>The number of cuts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>A scalar or two dimensional vector with with criteria for groups. Examples: limits of group size or limits of population size. If scalar, is the minimum criteria for groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>1 (default) for OLS, 2 for Quantile regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind_col</code></td>
<td>
<p>Parameter still not used in this version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Parameter still not used in this version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>Parameter still not used in this version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.ch</code></td>
<td>
<p>Chosen quantile (for method = 2).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Author really thanks Renato M. Assuncao and Elias T. Krainski for their original code (skater, library spdep).</p>


<h3>Value</h3>

<p>A object of skaterF class with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>A vector with length equal the number of nodes. Each position identifies the group of node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edges.groups</code></td>
<td>
<p>A list of length equal the number of groups with each element is a set of edges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>not.prune</code></td>
<td>
<p>A vector identifying the groups with are not candidates to partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>candidates</code></td>
<td>
<p>A vector identifying the groups with are candidates to partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssto</code></td>
<td>
<p>The total dissimilarity in each step of edge removal.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>F. Vidoli</p>


<h3>References</h3>

<p>F. Vidoli, G. Pignataro and R. Benedetti "<em>Identification of spatial regimes of the production function of Italian hospitals through spatially constrained cluster-wise regression</em>", Socio-Economic Planning Sciences (in press) https://doi.org/10.1016/j.seps.2022.101223
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SimData)
coords = cbind(SimData$long, SimData$lat)

#######################

neighbours = tri2nb(coords, row.names = NULL)
bh.nb &lt;-  neighbours
lcosts &lt;- nbcosts(bh.nb, SimData)
nb &lt;- nb2listw(bh.nb, lcosts, style="B")
mst.bh &lt;- mstree(nb,5)
edges1 = mst.bh[,1:2]

#######################

ncuts1 = 4
crit1 = 10
coly1 = c("y_ols")
colx1 = c("A","L","K")

# OLS
sk = SkaterF(edges = edges1, 
              data= SimData, 
              coly = coly1,
              colx= colx1, 
              ncuts=ncuts1, 
              crit=crit1,
              method=1)
			  
SimData$regimes = sk$groups
# plot(lat~long,SimData,col=regimes,pch=16)   

## quantile 0.8
# sk2 = SkaterF(edges = edges1, 
#              data= SimData, 
#              coly = coly1,
#              colx= colx1, 
#              ncuts=ncuts1, 
#              crit=crit1,
#              method=2,tau.ch=0.8)
#			  
# SimData$regimes_q = sk2$groups
# plot(lat~long,SimData,col=regimes_q,pch=16)   


</code></pre>


</div>