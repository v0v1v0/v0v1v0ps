<div class="container">

<table style="width: 100%;"><tr>
<td>algo.rogerson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modified CUSUM method as proposed by Rogerson and Yamada (2004)</h2>

<h3>Description</h3>

<p>Modified Poisson CUSUM method that allows for a time-varying in-control parameter
<code class="reqn">\theta_{0,t}</code> as proposed by Rogerson and Yamada (2004). The
same approach can be applied to binomial data if <code>distribution="binomial"</code>
is specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">algo.rogerson(disProgObj, control = list(range = range,
   theta0t = NULL, ARL0 = NULL, s = NULL, hValues = NULL,
   distribution = c("poisson","binomial"), nt = NULL, FIR=FALSE, 
   limit = NULL, digits = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>disProgObj</code></td>
<td>
<p>object of class <code>disProg</code> that includes a matrix with
the observed number of counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> list with elements
</p>

<dl>
<dt>range</dt>
<dd>
<p>vector of indices in the observed matrix of <code>disProgObj</code> to monitor</p>
</dd>
<dt>theta0t</dt>
<dd>
<p>matrix with in-control parameter, must be specified</p>
</dd>
<dt>ARL0 </dt>
<dd>
<p> desired average run length <code class="reqn">\gamma</code> </p>
</dd>
<dt>s</dt>
<dd>
<p>change to detect, see <code>findH</code> for further details</p>
</dd>
<dt>hValues</dt>
<dd>
<p>matrix with decision intervals <code>h</code> for a sequence of
values <code class="reqn">\theta_{0,t}</code>
(in the range of <code>theta0t</code>) </p>
</dd>
<dt>distribution</dt>
<dd>
<p><code>"poisson"</code> or <code>"binomial"</code> </p>
</dd>
<dt>nt</dt>
<dd>
<p>optional matrix with varying sample sizes for the binomial CUSUM</p>
</dd>
<dt>FIR</dt>
<dd>
<p>a FIR CUSUM with head start <code class="reqn">h/2</code>
is applied to the data if <code>TRUE</code>, otherwise no head start is used;
see details </p>
</dd>
<dt>limit</dt>
<dd>
<p>numeric that determines the procedure after an alarm is given, see details</p>
</dd>
<dt>digits</dt>
<dd>
<p>the reference value and decision interval are rounded to
<code>digits</code> decimal places. Defaults to 1 and should correspond
to the number of digits used to compute <code>hValues</code> </p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CUSUM for a sequence of Poisson or binomial
variates <code class="reqn">x_t</code> is computed as
</p>
<p style="text-align: center;"><code class="reqn">S_t = \max \{0, S_{t-1} + c_t (x_t- k_t)\} , \, t=1,2,\ldots ,</code>
</p>

<p>where <code class="reqn">S_0=0</code> and <code class="reqn">c_t=h/h_t</code>; <code class="reqn">k_t</code> and <code class="reqn">h_t</code> are time-varying
reference values and decision intervals.
An alarm is given at time <code class="reqn">t</code> if <code class="reqn">S_t \geq h</code>.
</p>
<p>If <code>FIR=TRUE</code>, the CUSUM starts
with a head start value <code class="reqn">S_0=h/2</code> at time <code class="reqn">t=0</code>.
After an alarm is given, the FIR CUSUM starts again at this head start value.
</p>
<p>The procedure after the CUSUM gives an alarm can be determined by <code>limit</code>.
Suppose that the CUSUM signals at time <code class="reqn">t</code>, i.e. <code class="reqn">S_t \geq h</code>.
For numeric values of <code>limit</code>, the CUSUM is bounded
above after an alarm is given, 
i.e. <code class="reqn">S_t</code> is set to
<code class="reqn"> \min\{\code{limit} \cdot h, S_t\} </code>.

Using <code>limit</code>=0 corresponds to
resetting <code class="reqn">S_t</code> to zero after an alarm as proposed in the original
formulation of the CUSUM. If <code>FIR=TRUE</code>,
<code class="reqn">S_t</code> is reset to <code class="reqn"> h/2 </code>
(i.e. <code>limit</code>=<code class="reqn">h/2</code> ).
If <code>limit=NULL</code>, no resetting occurs after an alarm is given.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>survRes</code> with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alarm</code></td>
<td>
<p>indicates whether the CUSUM signaled at time <code class="reqn">t</code> or not
(1 = alarm, 0 = no alarm) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperbound</code></td>
<td>
<p>CUSUM values <code class="reqn">S_t</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disProgObj</code></td>
<td>
<p><code>disProg</code> object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list with the alarm threshold <code class="reqn">h</code> and the specified
control object</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>algo.rogerson</code> is a univariate CUSUM method. If the data are
available in several regions (i.e. <code>observed</code> is a matrix),
multiple univariate CUSUMs are applied to each region.
</p>


<h3>References</h3>

<p>Rogerson, P. A. and Yamada, I. Approaches to Syndromic Surveillance When Data
Consist of Small Regional Counts. Morbidity and Mortality Weekly Report, 2004,
53/Supplement, 79-85
</p>


<h3>See Also</h3>

<p><code>hValues</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate data (seasonal Poisson)
set.seed(123)
t &lt;- 1:300
lambda &lt;- exp(-0.5 + 0.4 * sin(2*pi*t/52) + 0.6 * cos(2*pi*t/52))
data &lt;- sts(observed = rpois(length(lambda), lambda))

# determine a matrix with h values
hVals &lt;- hValues(theta0 = 10:150/100, ARL0=500, s = 1, distr = "poisson")

# convert to legacy "disProg" class and apply modified Poisson CUSUM
disProgObj &lt;- sts2disProg(data)
res &lt;- algo.rogerson(disProgObj, control=c(hVals, list(theta0t=lambda, range=1:300)))
plot(res, xaxis.years = FALSE)
</code></pre>


</div>