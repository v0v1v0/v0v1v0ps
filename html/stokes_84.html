<div class="container">

<table style="width: 100%;"><tr>
<td>transform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear transforms of <code class="reqn">k</code>-forms</h2>

<h3>Description</h3>

<p>Given a <code class="reqn">k</code>-form, express it in terms of linear
combinations of the <code class="reqn">dx_i</code></p>


<h3>Usage</h3>

<pre><code class="language-R">pullback(K,M)
stretch(K,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Object of class <code>kform</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Matrix of transformation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Numeric vector representing the diagonal elements of a
diagonal matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>pullback()</code> calculates the pullback of a function.  A
vignette is provided at ‘<span class="file">pullback.Rmd</span>’.
</p>
<p>Suppose we are given a two-form
</p>
<p style="text-align: center;"><code class="reqn">
    \omega=\sum_{i &lt; j}a_{ij}\mathrm{d}x_i\wedge\mathrm{d}x_j</code>
</p>

<p>and relationships
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{d}x_i=\sum_rM_{ir}\mathrm{d}y_r</code>
</p>

<p>then we would have
</p>
<p style="text-align: center;"><code class="reqn">\omega =
    \sum_{i &lt; j}
    a_{ij}\left(\sum_rM_{ir}\mathrm{d}y_r\right)\wedge\left(\sum_rM_{jr}\mathrm{d}y_r\right).
  </code>
</p>

<p>The general situation would be  a <code class="reqn">k</code>-form where we would have
</p>
<p style="text-align: center;"><code class="reqn">
    \omega=\sum_{i_1 &lt; \cdots &lt; i_k}a_{i_1\ldots i_k}\mathrm{d}x_{i_1}\wedge\cdots\wedge\mathrm{d}x_{i_k}</code>
</p>

<p>giving
</p>
<p style="text-align: center;"><code class="reqn">\omega =
    \sum_{i_1 &lt; \cdots &lt; i_k}\left[
    a_{i_1,\ldots, i_k}\left(\sum_rM_{i_1r}\mathrm{d}y_r\right)\wedge\cdots\wedge\left(\sum_rM_{i_kr}\mathrm{d}y_r\right)\right].
  </code>
</p>

<p>The <code>transform()</code> function does all this but it is slow.  I am not
100% sure that there isn't a much more efficient way to do such a
transformation.  There are a few tests in <code>tests/testthat</code> and a
discussion in the <code>stokes</code> vignette.
</p>
<p>Function <code>stretch()</code> carries out the same operation but for <code class="reqn">M</code>
a diagonal matrix.  It is much faster than <code>transform()</code>.
</p>


<h3>Value</h3>

<p>The functions documented here return an object of class
<code>kform</code>.
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>

<p>S. H. Weintraub 2019. <em>Differential forms: theory and practice</em>.
Elsevier.  (Chapter 3)
</p>


<h3>See Also</h3>

<p><code>wedge</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example in the text:
K &lt;- as.kform(matrix(c(1,1,2,3),2,2),c(1,5))
M &lt;- matrix(1:9,3,3)
pullback(K,M)

# Demonstrate that the result can be complicated:
M &lt;- matrix(rnorm(25),5,5)
pullback(as.kform(1:2),M)

# Numerical verification:
o &lt;- volume(3)

o2 &lt;- pullback(pullback(o,M),solve(M))
max(abs(coeffs(o-o2))) # zero to numerical precision

# Following should be zero:
pullback(as.kform(1),M)-as.kform(matrix(1:5),c(crossprod(M,c(1,rep(0,4)))))

# Following should be TRUE:
issmall(pullback(o,crossprod(matrix(rnorm(10),2,5))))

# Some stretch() use-cases:

p &lt;- rform()
p
stretch(p,seq_len(7))
stretch(p,c(1,0,0,1,1,1,1))   # kills dimensions 2 and 3

</code></pre>


</div>