<div class="container">

<table style="width: 100%;"><tr>
<td>show_sig_profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Show Signature Profile</h2>

<h3>Description</h3>

<p>Who don't like to show a barplot for signature profile? This is for it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">show_sig_profile(
  Signature,
  mode = c("SBS", "copynumber", "DBS", "ID", "RS"),
  method = "Wang",
  by_context = FALSE,
  normalize = c("row", "column", "raw", "feature"),
  y_tr = NULL,
  filters = NULL,
  feature_setting = sigminer::CN.features,
  style = c("default", "cosmic"),
  palette = use_color_style(style, ifelse(by_context, "SBS", mode), method),
  set_gradient_color = FALSE,
  free_space = "free_x",
  rm_panel_border = style == "cosmic",
  rm_grid_line = style == "cosmic",
  rm_axis_text = FALSE,
  bar_border_color = ifelse(style == "default", "grey50", "white"),
  bar_width = 0.7,
  paint_axis_text = TRUE,
  x_label_angle = ifelse(mode == "copynumber" &amp; !(startsWith(method, "T") | method ==
    "X"), 60, 90),
  x_label_vjust = ifelse(mode == "copynumber" &amp; !(startsWith(method, "T") | method ==
    "X"), 1, 0.5),
  x_label_hjust = 1,
  x_lab = "Components",
  y_lab = "auto",
  y_limits = NULL,
  params = NULL,
  show_cv = FALSE,
  params_label_size = 3,
  params_label_angle = 60,
  y_expand = 1,
  digits = 2,
  base_size = 12,
  font_scale = 1,
  sig_names = NULL,
  sig_orders = NULL,
  check_sig_names = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Signature</code></td>
<td>
<p>a <code>Signature</code> object obtained either from sig_extract or sig_auto_extract,
or just a raw signature matrix with row representing components (motifs) and column
representing signatures (column names must start with 'Sig').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>signature type for plotting, now supports 'copynumber', 'SBS',
'DBS', 'ID' and 'RS' (genome rearrangement signature).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for copy number feature classification in sig_tally,
can be one of "Wang" ("W"), "S".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_context</code></td>
<td>
<p>for specific use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>one of 'row', 'column', 'raw' and "feature", for row normalization (signature),
column normalization (component), raw data, row normalization by feature, respectively.
Of note, 'feature' only works when the mode is 'copynumber'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_tr</code></td>
<td>
<p>a function (e.g. <code>log10</code>) to transform y axis before plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filters</code></td>
<td>
<p>a pattern used to select components to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_setting</code></td>
<td>
<p>a <code>data.frame</code> used for classification.
<strong>Only used when method is "Wang" ("W")</strong>.
Default is CN.features. Users can also set custom input with "feature",
"min" and "max" columns available. Valid features can be printed by
<code>unique(CN.features$feature)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>plot style, one of 'default' and 'cosmic', works when
parameter <code>set_gradient_color</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>palette used to plot when <code>set_gradient_color</code> is <code>FALSE</code>,
default use a built-in palette according to parameter <code>style</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_gradient_color</code></td>
<td>
<p>default is <code>FALSE</code>, if <code>TRUE</code>, use gradient colors
to fill bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>free_space</code></td>
<td>
<p>default is 'free_x'. If "fixed", all panels have the same size.
If "free_y" their height will be proportional to the length of the y scale;
if "free_x" their width will be proportional to the length of the x scale;
or if "free" both height and width will vary.
This setting has no effect unless the appropriate scales also vary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm_panel_border</code></td>
<td>
<p>default is <code>TRUE</code> for style 'cosmic',
remove panel border to keep plot tight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm_grid_line</code></td>
<td>
<p>default is <code>FALSE</code>, if <code>TRUE</code>, remove grid lines of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm_axis_text</code></td>
<td>
<p>default is <code>FALSE</code>, if <code>TRUE</code>, remove component texts.
This is useful when multiple signature profiles are plotted together.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar_border_color</code></td>
<td>
<p>the color of bar border.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar_width</code></td>
<td>
<p>bar width. By default, set to 70% of the resolution of the
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paint_axis_text</code></td>
<td>
<p>if <code>TRUE</code>, color on text of x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label_angle</code></td>
<td>
<p>font angle for x label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label_vjust</code></td>
<td>
<p>font vjust for x label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_label_hjust</code></td>
<td>
<p>font hjust for x label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab</code></td>
<td>
<p>x axis lab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_lab</code></td>
<td>
<p>y axis lab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_limits</code></td>
<td>
<p>limits to expand in y axis. e.g., <code>0.2</code>, <code>c(0, 0.3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>params <code>data.frame</code> of components, obtained from sig_tally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_cv</code></td>
<td>
<p>default is <code>FALSE</code>, if <code>TRUE</code>, show coefficient of variation when
<code>params</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_label_size</code></td>
<td>
<p>font size for params label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_label_angle</code></td>
<td>
<p>font angle for params label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_expand</code></td>
<td>
<p>y expand height for plotting params of copy number signatures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>digits for plotting params of copy number signatures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>overall font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_scale</code></td>
<td>
<p>a number used to set font scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_names</code></td>
<td>
<p>subset signatures or set name of signatures, can be a character vector.
Default is <code>NULL</code>, prefix 'Sig' plus number is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_orders</code></td>
<td>
<p>set order of signatures, can be a character vector.
Default is <code>NULL</code>, the signatures are ordered by alphabetical order.
If an integer vector set, only specified signatures are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_sig_names</code></td>
<td>
<p>if <code>TRUE</code>, check signature names when input is
a matrix, i.e., all signatures (colnames) must start with 'Sig'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>ggplot</code> object
</p>


<h3>Author(s)</h3>

<p>Shixiang Wang
</p>


<h3>See Also</h3>

<p>show_sig_profile_loop, show_sig_profile_heatmap
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load SBS signature
load(system.file("extdata", "toy_mutational_signature.RData",
  package = "sigminer", mustWork = TRUE
))
# Show signature profile
p1 &lt;- show_sig_profile(sig2, mode = "SBS")
p1

# Use 'y_tr' option to transform values in y axis
p11 &lt;- show_sig_profile(sig2, mode = "SBS", y_tr = function(x) x * 100)
p11

# Load copy number signature from method "W"
load(system.file("extdata", "toy_copynumber_signature_by_W.RData",
  package = "sigminer", mustWork = TRUE
))
# Show signature profile
p2 &lt;- show_sig_profile(sig,
  style = "cosmic",
  mode = "copynumber",
  method = "W",
  normalize = "feature"
)
p2

# Visualize rearrangement signatures
s &lt;- get_sig_db("RS_Nik_lab")
ss &lt;- s$db[, 1:3]
colnames(ss) &lt;- c("Sig1", "Sig2", "Sig3")
p3 &lt;- show_sig_profile(ss, mode = "RS", style = "cosmic")
p3

</code></pre>


</div>