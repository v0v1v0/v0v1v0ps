<div class="container">

<table style="width: 100%;"><tr>
<td>spaMM-conventions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spaMM conventions and differences from related fitting procedures</h2>

<h3>Description</h3>

<p><b>input arguments</b> are generally similar to those of <code>glm</code> and <code>(g)lmer</code>, in particular for the <code>spaMM::fitme</code>
function, with the exception of the <code>prior.weights</code> argument, which is simply <code>weights</code> in the other packages.
The name <code>prior.weights</code> seems more consistent, since e.g. <code>glm</code> returns its input <code>weights</code> as output <code>prior.weights</code>, while its output <code>weights</code> are instead the weights in the final iteration of an iteratively weighted least-square fit.
</p>
<p>The <b>default likelihood target</b> for dispersion parameters is restricted likelihood (REML estimation) for <code>corrHLfit</code> and (marginal) likelihood (ML estimation) for <code>fitme</code>. 
Model fits may provide restricted likelihood values(<code>ReL</code>) even if restricted likelihood is is not used as an objective function at any step in the analysis.   
</p>
<p>See <code>good-practice</code> for advice about the proper syntax of <code>formula</code>.
</p>
<p><b>Computation times</b> depend on control parameters given by  <code>spaMM.getOption("spaMM_tol")</code> parameters (for iterative algorithms), and <code>spaMM.getOption("nloptr")</code> parameters for the default optimizer. Do not use <code>spaMM.options()</code> to control them globally, unless you know what you are doing. Rather control them locally by the <code>control.HLfit</code> argument to control <code>spaMM_tol</code>, and by the control arguments of <code>corrHLfit</code> and <code>fitme</code> to control <code>nloptr</code>. If <code>nloptr$Xtol_rel</code> is set above 5e-06, <code>fitme</code> will by default refit the fixed effects and dispersion parameters (but not other correlation parameters estimated by <code>nloptr</code>) by the iterative algorithm after <code>nloptr</code> convergence. Increasing <code>nloptr$Xtol_rel</code> value may therefore switches the bulk of computation time from the optimizer to the iterative algorithm, and may increase or decrease computation time depending on which algorithm is faster for a given input. Use <code>control$refit</code> if you wish to inhibit this, but note that by default it provides a rescue to a poor <code>nloptr</code> result due to a too large <code>Xtol_rel</code>.       
</p>


<h3>References</h3>

<p>Chambers J.M. (2008) Software for data analysis: Programming with R. Springer-Verlag New York
</p>


</div>