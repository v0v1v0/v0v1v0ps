<div class="container">

<table style="width: 100%;"><tr>
<td>updateTVP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One step update version of <code>shrinkTVP</code> with minimal overhead</h2>

<h3>Description</h3>

<p><code>updateTVP</code> draws a single sample from the joint posterior distribution of the parameters of a time-varying
parameter model with shrinkage potentially including stochastic volatility (SV). It performs <b>no input checks</b> and must
therefore be used with caution. It is designed to be used in a modular fashion within other samplers, where speed is important.
As such, no draws are saved and must be stored manually if the user wants to analyze them further.
</p>


<h3>Usage</h3>

<pre><code class="language-R">updateTVP(
  y,
  x,
  curr_draws,
  mod_type = "double",
  learn_a_xi = TRUE,
  learn_a_tau = TRUE,
  a_xi = 0.1,
  a_tau = 0.1,
  learn_c_xi = TRUE,
  learn_c_tau = TRUE,
  c_xi = 0.1,
  c_tau = 0.1,
  a_eq_c_xi = FALSE,
  a_eq_c_tau = FALSE,
  learn_kappa2_B = TRUE,
  learn_lambda2_B = TRUE,
  kappa2_B = 20,
  lambda2_B = 20,
  hyperprior_param,
  sv = FALSE,
  sv_param,
  MH_tuning
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of length N containing the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of dimension Nxd containing the covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curr_draws</code></td>
<td>
<p>named list containing all the current draws from the joint posterior of the parameters.
Not all values are required for all model setups. The following elements can be supplied:
</p>

<ul>
<li> <p><code>beta_mean_st</code>: vector of length <code>d</code> containing single numbers.
</p>
</li>
<li> <p><code>theta_sr_st</code>: vector of length <code>d</code> containing single, positive numbers.
</p>
</li>
<li> <p><code>tau2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Not required if <code>mod_type</code> is <code>"ridge"</code>.
</p>
</li>
<li> <p><code>xi2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Not required if <code>mod_type</code> is <code>"ridge"</code>.
</p>
</li>
<li> <p><code>kappa2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Only required if <code>mod_type</code> is <code>"triple"</code>.
</p>
</li>
<li> <p><code>lambda2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Only required if <code>mod_type</code> is <code>"triple"</code>.
</p>
</li>
<li> <p><code>kappa2_B_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_kappa2_B</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>lambda2_B_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_lambda2_B</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>a_xi_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_a_xi</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>a_tau_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_a_tau</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>c_xi_st</code>: <em>optional</em> positive, real number. Note that the prior for <code>c_xi</code> is restricted to (0, 0.5).
Not required if <code>mod_type</code> is not <code>"triple"</code> or <code>learn_c_xi</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>c_tau_st</code>: <em>optional</em> positive, real number.  Note that the prior for <code>c_tau</code> is restricted to (0, 0.5).
Not required if <code>mod_type</code> is not <code>"triple"</code> or <code>learn_c_tau</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_mu_st</code>: <em>optional</em> real number. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_phi_st</code>: <em>optional</em> positive, real number between -1 and 1. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_sigma2_st </code>: <em>optional</em> positive, real number. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>C0_st</code>: <em>optional</em> positive, real number. Not required if <code>sv</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>sigma2_st</code>: positive, real number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of positive, real numbers of length <code>N</code>. The default value is 1 or a vector thereof.
</p>
</li>
<li> <p><code>h0_st</code>: <em>optional</em> real number. The default value is 0. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_type</code></td>
<td>
<p>character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>.
Determines whether the triple gamma, double gamma or ridge prior are used for <code>theta_sr</code> and <code>beta_mean</code>.
The default is "double".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_a_xi</code></td>
<td>
<p>logical value indicating whether to learn a_xi, the spike parameter of the state variances.
Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_a_tau</code></td>
<td>
<p>logical value indicating whether to learn a_tau, the spike parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_xi. Ignored if
<code>learn_a_xi</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_tau. Ignored if
<code>learn_a_tau</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_c_xi</code></td>
<td>
<p>logical value indicating whether to learn c_xi, the tail parameter of the state variances.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_c_tau</code></td>
<td>
<p>logical value indicating whether to learn c_tau, the tail parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_xi. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code> or <code>mod_type</code> is not set to <code>"triple"</code>. The default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_tau. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code> or <code>mod_type</code> is not set to <code>"triple"</code>. The default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_eq_c_xi</code></td>
<td>
<p>logical value indicating whether to force <code>a_xi</code> and <code>c_xi</code> to be equal.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_eq_c_tau</code></td>
<td>
<p>logical value indicating whether to force <code>a_tau</code> and <code>c_tau</code> to be equal.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_kappa2_B</code></td>
<td>
<p>logical value indicating whether to learn kappa2_B, the global level of shrinkage for
the state variances. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_lambda2_B</code></td>
<td>
<p>logical value indicating whether to learn the lambda2_B parameter,
the global level of shrinkage for the mean of the initial values of the states. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for kappa2_B. Ignored if
<code>learn_kappa2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for lambda2_B. Ignored if
<code>learn_lambda2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperprior_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
All hyperparameter values have to be positive, real numbers. The following hyperparameters can be
supplied:
</p>

<ul>
<li> <p><code>c0</code>: The default value is 2.5.
</p>
</li>
<li> <p><code>g0</code>: The default value is 5.
</p>
</li>
<li> <p><code>G0</code>: The default value is 5 / (2.5 - 1).
</p>
</li>
<li> <p><code>e1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>e2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>beta_a_xi</code>: The default value is 10.
</p>
</li>
<li> <p><code>beta_a_tau</code>: The default value is 10.
</p>
</li>
<li> <p><code>alpha_a_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_a_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_xi</code>: The default value is 2.
</p>
</li>
<li> <p><code>alpha_c_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_tau</code>: The default value is 2.
</p>
</li>
<li> <p><code>alpha_c_tau</code>: The default value is 5.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv</code></td>
<td>
<p>logical value indicating whether to use stochastic volatility for the error of the observation
equation. For details please see <code>stochvol</code>, in particular <code>svsample</code>. The default value is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the stochastic volatility
parameters. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. Ignored if
<code>sv</code> is <code>FALSE</code>. The following elements can be supplied:
</p>

<ul>
<li> <p><code>Bsigma_sv</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a0_sv</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>b0_sv</code>: positive, real number. The default value is 1.5.
</p>
</li>
<li> <p><code>bmu</code>: real number. The default value is 0.
</p>
</li>
<li> <p><code>Bmu</code>: real number. larger than 0. The default value is 1.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MH_tuning</code></td>
<td>
<p><em>optional</em> named list containing values used to tune the MH steps for <code>a_xi</code>, <code>a_tau</code>,
<code>c_xi</code> and <code>c_tau</code>. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
The arguments for <code>a_xi</code>(<code>a_tau</code>) are only used if <code>learn_a_xi</code>(<code>learn_a_tau</code>)
is set to <code>TRUE</code> and <code>mod_type</code> is not equal to <code>"ridge"</code>. The arguments for <code>c_xi</code>(<code>c_tau</code>) are only
used if <code>learn_c_xi</code>(<code>learn_c_tau</code>) is set to <code>TRUE</code> and <code>mod_type</code> is equal to <code>"triple"</code>. Arguments ending in "adaptive" are
logical values indicating whether or not to make the MH step for the respective parameter adaptive. Arguments ending in "tuning_par" serve two different purposes.
If the respective MH step is not set to be adaptive, it acts as the standard deviation of the proposal distribution. If the respective MH step
is set to be adaptive, it acts as the initial standard deviation. Arguments ending in "target_rate" define the acceptance rate the algorithm aims to achieve.
Arguments ending in "max_adapt" set the maximum value by which the logarithm of the standard deviation of the proposal distribution is adjusted. Finally,
arguments ending in "batch_size" set the batch size after which the standard deviation of the proposal distribution is adjusted.
The following elements can be supplied:
</p>

<ul>
<li> <p><code>a_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>a_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value returned is a named list object which can be immediately used as the <code>curr_draws</code> argument
for another draw from the posterior with <code>updateTVP</code>. Note that, depending on the model setup, some elements may be matrices of dimension zero.
It contains the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta_st</code></td>
<td>
<p>dx(N + 1) matrix containing the current draw from the posterior distribution of beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_mean_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of beta_mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_sr_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of the square root of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of tau2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of xi2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of lambda2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of kappa2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_xi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of a_xi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_tau_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of a_tau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_xi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of c_xi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_tau_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of c_tau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2_B_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of lambda2_B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa2_B_st</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2_B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2_st</code></td>
<td>
<p>number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of length <code>N</code> containing the current draws from the posterior distribution of sigma2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of C0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv_mu_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the mu parameter for the stochastic volatility model on the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv_phi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the phi parameter for the stochastic volatility model on the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv_sigma2_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the sigma2 parameter for the stochastic volatility model on the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the h0 parameter for the stochastic volatility model on the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internals</code></td>
<td>
<p><code>list</code> object containing two arrays that are required for calculating the LPDS and bookkeeping objects required for the adaptive MH algorithm to work.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>References</h3>

<p>Bitto, A., &amp; Frühwirth-Schnatter, S. (2019). "Achieving shrinkage in a time-varying parameter model framework."
<em>Journal of Econometrics</em>, 210(1), 75-97. &lt;doi:10.1016/j.jeconom.2018.11.006&gt;
</p>
<p>Cadonna, A., Frühwirth-Schnatter, S., &amp; Knaus, P. (2020). "Triple the Gamma—A Unifying Shrinkage Prior for Variance and Variable Selection in Sparse State Space and TVP Models."
<em>Econometrics</em>, 8(2), 20. &lt;doi:10.3390/econometrics8020020&gt;
</p>
<p>Knaus, P., Bitto-Nemling, A., Cadonna, A., &amp; Frühwirth-Schnatter, S. (2021) "Shrinkage in the Time-Varying Parameter Model Framework Using the <code>R</code> Package <code>shrinkTVP</code>."
<em>Journal of Statistical Software</em> 100(13), 1–32.&lt;doi:10.18637/jss.v100.i13&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate data
sim &lt;- simTVP()
y &lt;- sim$data$y
x &lt;- as.matrix(sim$data[,2:4])

# Create starting values
d &lt;- ncol(x)
curr_draws &lt;- list(beta_mean_st = rep(0, d),
                   theta_sr_st = rep(1, d),
                   tau2_st = rep(1, d),
                   xi2_st = rep(1, d),
                   lambda2_st = rep(1, d),
                   kappa2_B_st = 20,
                   lambda2_B_st = 20,
                   a_xi_st = 0.1,
                   a_tau_st = 0.1,
                   c_tau_st = 0.1,
                   sv_mu_st = -10,
                   sv_phi_st = 0.5,
                   sv_sigma2_st = 1,
                   C0_st = 1,
                   sigma2_st = 1,
                   h0_st = 0)

# Run the algorithm for 1000 iterations
# Note that curr_draws is always re-written and immediately re-used
for (i in 1:1000){
  curr_draws &lt;- updateTVP(y, x, curr_draws)
}


</code></pre>


</div>