<div class="container">

<table style="width: 100%;"><tr>
<td>clusterScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Module scoring</h2>

<h3>Description</h3>

<p>Generate factor scores, principal component scores, or
projection scores of latent, composite, and unmeasured variable modules,
respectively, and fit them with an exogenous group effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterScore(
  graph,
  data,
  group,
  HM = "LV",
  type = "wtc",
  size = 5,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>An igraph object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A binary vector. This vector must be as long as the number
of subjects. Each vector element must be 1 for cases and 0 for control
subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HM</code></td>
<td>
<p>Hidden model type. For each defined hidden module:
(i) if <code>HM = "LV"</code>, a latent variable (LV) will be defined as
common unknown cause acting on cluster nodes; (ii) if <code>HM = "CV"</code>,
cluster nodes will be considered as regressors of a latent composite
variable (CV); (iii) if <code>HM = "UV"</code>, an unmeasured variable (UV)
model will be generated for each module, where source nodes (i.e.,
in-degree = 0) act as common regressors influencing the other nodes
via an unmeasured variable.
By default, HM is set to "LV" (i.e., the latent variable model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Graph clustering method. If <code>type = "tahc"</code>, network
modules are generated using the tree agglomerative hierarchical
clustering method (Yu et al., 2015).
Other non-tree clustering methods from igraph package include: "wtc"
(default value; walktrap community structure with short random walks),
"ebc" (edge betweenness clustering), "fgc" (fast greedy method), "lbc"
(label propagation method), "lec" (leading eigenvector method), "loc"
(multi-level optimization), "opc" (optimal communiy structure), "sgc"
(spinglass statistical mechanics).
By default, the "wtc" method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Minimum number of nodes per hidden module. By default, a
minimum number of 5 nodes is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value. If TRUE, intermediate graphs will be
displayed during the execution. In addition, a reduced graph with
clusters as nodes will be fitted and showed to screen (see also
<code>mergeNodes</code>). By default, <code>verbode = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 3 objects:
</p>

<ol>
<li>
<p> "fit", hidden module fitting as a lavaan object;
</p>
</li>
<li>
<p> "membership", hidden module nodes membership;
<code>clusterGraph</code> function;
</p>
</li>
<li>
<p> "dataHM", data matrix with cluster scores in first columns.
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>References</h3>

<p>Grassi M, Palluzzi F, Tarantino B (2022). SEMgraph: An R Package for Causal Network
Analysis of High-Throughput Data with Structural Equation Models.
Bioinformatics, 38 (20), 4829â€“4830 &lt;https://doi.org/10.1093/bioinformatics/btac567&gt;
</p>


<h3>See Also</h3>

<p>See <code>clusterGraph</code> and <code>cplot</code>
for graph clustering.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Nonparanormal(npn) transformation
als.npn &lt;- transformData(alsData$exprs)$data

C &lt;- clusterScore(graph = alsData$graph, data = als.npn,
                  group = alsData$group,
                  HM = "LV",
                  type = "wtc",
                  verbose = FALSE)
summary(C$fit)
head(C$dataHM)
table(C$membership)

</code></pre>


</div>