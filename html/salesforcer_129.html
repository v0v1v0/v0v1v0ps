<div class="container">

<table style="width: 100%;"><tr>
<td>sf_auth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log in to Salesforce</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Log in using Basic (Username-Password) or OAuth 2.0 authentication. OAuth does
not require sharing passwords, but will require authorizing <code>salesforcer</code>
as a connected app to view and manage your organization. You will be directed to
a web browser, asked to sign in to your Salesforce account, and to grant <code>salesforcer</code>
permission to operate on your behalf. By default, these user credentials are
cached in a file named <code>.httr-oauth-salesforcer</code> in the current working directory.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sf_auth(
  username = NULL,
  password = NULL,
  security_token = NULL,
  login_url = getOption("salesforcer.login_url"),
  token = NULL,
  consumer_key = getOption("salesforcer.consumer_key"),
  consumer_secret = getOption("salesforcer.consumer_secret"),
  callback_url = getOption("salesforcer.callback_url"),
  cache = getOption("salesforcer.httr_oauth_cache"),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>username</code></td>
<td>
<p>Salesforce username, typically an email address</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>password</code></td>
<td>
<p>Salesforce password</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>security_token</code></td>
<td>
<p>Salesforce security token. Note: A new security token is
generated whenever your password is changed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>login_url</code></td>
<td>
<p>a custom login url; defaults to https://login.salesforce.com. If
needing to log into a sandbox or dev environment then provide its login URL (e.g.
https://test.salesforce.com)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>optional; an actual token object or the path to a valid token
stored as an <code>.rds</code> file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consumer_key, consumer_secret, callback_url</code></td>
<td>
<p>the "Consumer Key","Consumer Secret",
and "Callback URL" when using a connected app; defaults to the <code>salesforcer</code>
connected apps' consumer key, secret, and callback url</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cache</code></td>
<td>
<p><code>logical</code> or <code>character</code>; TRUE means to cache using
the default cache file <code>.httr-oauth-salesforcer</code>, FALSE means do not
cache. A string means use the specified path as the cache file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>logical</code>; an indicator of whether to print additional
detail for each API call, which is useful for debugging. More specifically, when
set to <code>TRUE</code> the URL, header, and body will be printed for each request,
along with additional diagnostic information where available.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>list</code> invisibly that contains 4 elements detailing the authentication state
</p>


<h3>Note</h3>

<p>The <code>link{sf_auth}</code> function invisibly returns the following
4 pieces of information which can be reused in other operations:
</p>

<dl>
<dt>auth_method</dt>
<dd>
<p><code>character</code>; One of two options 'Basic' or 'OAuth'. If a username,
password, and security token were supplied, then this would result in
'Basic' authentication.
</p>
</dd>
<dt>token</dt>
<dd>
<p><code>Token2.0</code>; The object returned by <code>oauth2.0_token</code>.
This value is <code>NULL</code> if <code>auth_method='Basic'</code>.
</p>
</dd>
<dt>session_id</dt>
<dd>
<p><code>character</code>; A unique ID associated with this user session. The session
ID is obtained from the X-SFDC-Session header fetched with SOAP API's login()
call. This value is <code>NULL</code> if <code>auth_method='OAuth'</code>.
</p>
</dd>
<dt>instance_url</dt>
<dd>
<p><code>character</code>; The domain address of the server that your Salesforce org
is on and where subsequent API calls will be directed to. For example,
<code>https://na21.salesforce.com</code> refers to an org located on the 'NA21'
server instance located in Chicago, USA / Washington DC, USA per this
Knowledge Article: <a href="https://help.salesforce.com/s/articleView?language=en_US&amp;id=000314281">https://help.salesforce.com/s/articleView?language=en_US&amp;id=000314281</a>.
</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# log in using basic authentication (username-password)
sf_auth(username = "test@gmail.com", 
        password = "test_password", 
        security_token = "test_token")

# log in using OAuth 2.0 (via browser or cached .httr-oauth-salesforcer)
sf_auth()

# log in to a Sandbox environment
# Via brower or refresh of .httr-oauth-salesforcer
sf_auth(login_url = "https://test.salesforce.com")

# Save token to disk and log in using it
saveRDS(salesforcer_state()$token, "token.rds")
sf_auth(token = "token.rds")

## End(Not run)
</code></pre>


</div>