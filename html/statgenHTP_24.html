<div class="container">

<table style="width: 100%;"><tr>
<td>plot.psHDM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot function for class psHDM</h2>

<h3>Description</h3>

<p>This plot function provides five plots for objects of the class <code>psHDM</code>
after fitting (<code>fitSplineHDM</code>) or predicting
(<code>predict.psHDM</code>): (1) Population-specific growth curves (popTra),
(2) Population and genotype-specific growth curves (for all genotypes, popGenoTra),
(3) First-order derivative of the population and genotype-specific growth curves
(for all genotypes, popGenoDeriv), (4) Genotype-specific deviations (for all
genotypes, genoDev), and (5) Genotype- and plot-specific growth curves (for a
selection of genotypes, genoPlotTra). If standard errors are available, 95% point
wise confidence intervals are depicted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'psHDM'
plot(
  x,
  ...,
  plotType = c("popTra", "popGenoTra", "popGenoDeriv", "genoDev", "genoPlotTra"),
  genotypes = NULL,
  genotypeNames = NULL,
  genotypeOrder = NULL,
  xlab = "Time",
  ylab = expression(tilde(y)[pgi](t)),
  title = NULL,
  themeSizeHDM = 15,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class "psHDM" as obtained after fitting
(<code>fitSplineHDM</code>) or predicting (<code>predict.psHDM</code>),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>A character string indicating which plot should be made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>A character vector with the genotypes for which plots at
plot level are desired. Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypeNames</code></td>
<td>
<p>A character vector with alternative names for the
plotted genotypes (genotypes). If <code>NULL</code> the names of the genotypes
are used. Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypeOrder</code></td>
<td>
<p>A vector with the order of the selected genotypes
(genotypes). If <code>NULL</code> then the order in the data is preserved.
Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>The x-axis label of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>The y-axis label of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>themeSizeHDM</code></td>
<td>
<p>Reference size for the theme</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFile</code></td>
<td>
<p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code>pdf</code> for all possible options.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Pérez-Valencia, D.M., Rodríguez-Álvarez, M.X., Boer, M.P. et al.
A two-stage approach for the spatio-temporal analysis of high-throughput
phenotyping data. Sci Rep 12, 3177 (2022). <a href="https://doi.org/10.1038/s41598-022-06935-9">doi:10.1038/s41598-022-06935-9</a>
</p>


<h3>See Also</h3>

<p>Other functions for fitting hierarchical curve data models: 
<code>fitSplineHDM()</code>,
<code>predict.psHDM()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## We need to specify the genotype-by-treatment interaction.
## Treatment: water regime (WW, WD).
spatCorrectedArch[["treat"]] &lt;- substr(spatCorrectedArch[["geno.decomp"]],
                                      start = 1, stop = 2)
spatCorrectedArch[["genoTreat"]] &lt;-
  interaction(spatCorrectedArch[["genotype"]],
             spatCorrectedArch[["treat"]], sep = "_")

## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.
fit.psHDM  &lt;- fitSplineHDM(inDat = spatCorrectedArch,
                          trait = "LeafArea_corr",
                          genotypes = c("GenoA14_WD", "GenoA51_WD",
                                       "GenoB11_WW", "GenoB02_WD",
                                       "GenoB02_WW"),
                          time = "timeNumber",
                          pop = "geno.decomp",
                          genotype = "genoTreat",
                          plotId = "plotId",
                          difVar = list(geno = FALSE, plot = FALSE),
                          smoothPop = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothGeno = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothPlot = list(nseg = 4, bdeg = 3, pord = 2),
                          weights = "wt",
                          trace = FALSE)

## Plot the P-Spline predictions at the three levels of the hierarchy

## Population-specific growth curves.
plot(fit.psHDM,
    plotType = "popTra")

## Population and genotype-specific growth curves.
plot(fit.psHDM,
    plotType = "popGenoTra")

## First-order derivative of the population- and genotype-specific growth curves.
plot(fit.psHDM,
    plotType = "popGenoDeriv")

## Genotype-specific deviations.
plot(fit.psHDM,
    plotType = "genoDev")

## Genotype- and plot-specific growth curves.
plot(fit.psHDM,
    plotType = "genoPlotTra")

</code></pre>


</div>