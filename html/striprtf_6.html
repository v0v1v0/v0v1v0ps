<div class="container">

<table style="width: 100%;"><tr>
<td>read_rtf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Text from RTF (Rich Text Format) File</h2>

<h3>Description</h3>

<p>Parses an RTF file and extracts plain text as character vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_rtf(
  file,
  verbose = FALSE,
  row_start = "*| ",
  row_end = "",
  cell_end = " | ",
  ignore_tables = FALSE,
  check_file = TRUE,
  ...
)

strip_rtf(
  text,
  verbose = FALSE,
  row_start = "*| ",
  row_end = "",
  cell_end = " | ",
  ignore_tables = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Path to an RTF file. Must be character of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. If TRUE, progress report is printed on console.
While it can be informative when parsing a large file,
this option itself makes the process slow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_start, row_end</code></td>
<td>
<p>strings to be added at the beginning and end of table rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_end</code></td>
<td>
<p>string to be put at the end of table cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_tables</code></td>
<td>
<p>if <code>TRUE</code>, no special treatment for tables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_file</code></td>
<td>
<p>if <code>TRUE</code>, conducts a quick check on the file if it is an RTF file.
If the file fails to pass the check, returns NULL without parsing the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Addional arguments passed to <code>readLines</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>Character of length 1.  Expected to be contents of an RTF file.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rich text format (RTF) files are written as a text file
consisting of ASCII characters.  The specification has been developed by
Microsoft.
This function interprets the character strings and extracts plain texts of
the file.
Major part of the algorithm of this function comes from a
stack overflow thread (<a href="https://stackoverflow.com/a/188877">https://stackoverflow.com/a/188877</a>) and
the references therein.
This function is a translation of the above to R language, associated with C++ codes for enhancement.
</p>
<p>An advance from the preceding implementation is that the function
accomodates with various ANSI code pages.  For example, RTF files created
by Japanese version of Microsoft Word marks <code>\ansicpg932</code>, which indicates
the code page 932 is used for letter-code conversion.
The function detects the code page indication and
convert the characters to UTF-8 where possible.  Conversion tables are retrieved from
here: (<a href="https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/">https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/</a>).
</p>


<h3>Value</h3>

<p>Character vector of extracted text
</p>


<h3>References</h3>


<ul>
<li>
<p>Original discussion thread: <a href="https://stackoverflow.com/a/188877">https://stackoverflow.com/a/188877</a>
</p>
</li>
<li>
<p>Code page table: <a href="https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/">https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">read_rtf(system.file("extdata/king.rtf", package = "striprtf"))
</code></pre>


</div>