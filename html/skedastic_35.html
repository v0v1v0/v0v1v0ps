<div class="container">

<table style="width: 100%;"><tr>
<td>rackauskas_zuokas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rackauskas-Zuokas Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the two methods of
Rackauskas and Zuokas (2007) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rackauskas_zuokas(
  mainlm,
  alpha = 0,
  pvalmethod = c("data", "sim"),
  R = 2^14,
  m = 2^17,
  sqZ = FALSE,
  seed = 1234,
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A double such that <code class="reqn">0 \le \alpha &lt; 1/2</code>; a hyperparameter
of the test. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalmethod</code></td>
<td>
<p>A character, either <code>"data"</code> or <code>"sim"</code>,
determining which method to use to compute the empirical
<code class="reqn">p</code>-value. If <code>"data"</code>, the dataset <code>T_alpha</code>
consisting of pre-generated Monte Carlo replicates from the
asymptotic null distribution of the test statistic is loaded and used to
compute empirical <code class="reqn">p</code>-value. This is only available for certain
values of <code>alpha</code>, namely <code class="reqn">i/32</code> where <code class="reqn">i=0,1,\ldots,15</code>.
If <code>"sim"</code>, Monte Carlo replicates are generated from the
asymptotic null distribution. Partial matching is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>An integer representing the number of Monte Carlo replicates to
generate, if <code>pvalmethod == "sim"</code>. Ignored if
<code>pvalmethod == "data"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>An integer representing the number of standard normal variates to
use when generating the Brownian Bridge for each replicate, if
<code>pvalmethod == "sim"</code>. Ignored if <code>pvalmethod == "data"</code>. If
number of observations is small,
Rackauskas and Zuokas (2007) recommends using <code class="reqn">m=n</code>.
The dataset <code>T_alpha</code> used <code class="reqn">m=2^17</code> which is
computationally intensive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqZ</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the standard normal variates used
in the Brownian Bridge when generating from the asymptotic null
distribution are first squared, i.e. transformed to <code class="reqn">\chi^2(1)</code>
variates. This is recommended by
Rackauskas and Zuokas (2007) when the number of
observations is small. Ignored if <code>pvalmethod == "data"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer representing the seed to be used for pseudorandom
number generation when simulating values from the asymptotic null
distribution. This is to provide reproducibility of test results.
Ignored if <code>pvalmethod == "data"</code>. If user does not wish to set
the seed, pass <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rackauskas and Zuokas propose a class of tests that entails
determining the largest weighted difference in variance of estimated
error. The asymptotic behaviour of their test statistic
<code class="reqn">T_{n,\alpha}</code> is studied using the empirical polygonal process
constructed from partial sums of the squared residuals. The test is
right-tailed.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Rackauskas A, Zuokas D (2007).
“New Tests of Heteroskedasticity in Linear Regression Model.”
<em>Lithuanian Mathematical Journal</em>, <b>47</b>(3), 248–265.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
rackauskas_zuokas(mtcars_lm)
rackauskas_zuokas(mtcars_lm, alpha = 7 / 16)

n &lt;- length(mtcars_lm$residuals)
rackauskas_zuokas(mtcars_lm, pvalmethod = "sim", m = n, sqZ = TRUE)


</code></pre>


</div>