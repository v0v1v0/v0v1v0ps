<div class="container">

<table style="width: 100%;"><tr>
<td>cv.SplitReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Split Regularized Regression algorithm with a sparsity and diversity penalty.</h2>

<h3>Description</h3>

<p>Computes a split regularized regression estimator. The sparsity and diversity penalty
parameters are chosen automatically.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.SplitReg(
  x,
  y,
  num_lambdas_sparsity = 100,
  num_lambdas_diversity = 100,
  alpha = 1,
  num_models = 10,
  tolerance = 1e-08,
  max_iter = 1e+05,
  num_folds = 10,
  num_threads = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_lambdas_sparsity</code></td>
<td>
<p>Length of the grid of sparsity penalties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_lambdas_diversity</code></td>
<td>
<p>Length of the grid of diversity penalties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Elastic Net tuning constant: the value must be between 0 and 1. Default is 1 (Lasso).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_models</code></td>
<td>
<p>Number of models to build.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Tolerance parameter to stop the iterations while cycling over the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations before stopping the iterations while cycling over the models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_folds</code></td>
<td>
<p>Number of folds for cross-validating.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_threads</code></td>
<td>
<p>Number of threads used for parallel computation over the folds.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes a split regularized regression estimator with <code>num_models</code> (<code class="reqn">G</code>) models, defined as the linear models
<code class="reqn">\boldsymbol{\beta}^{1},\dots, \boldsymbol{\beta}^{G}</code> that minimize
</p>
<p style="text-align: center;"><code class="reqn">\sum\limits_{g=1}^{G}\left( \frac{1}{2n}\Vert \mathbf{y}-\mathbf{X} \boldsymbol{\beta}^{g}\Vert^{2} 
+\lambda_{S}\left( \frac{(1-\alpha)}{2}\Vert \boldsymbol{\beta}^{g}\Vert_{2}^{2}+\alpha \Vert \boldsymbol{
\beta \Vert_1}\right)+\frac{\lambda_{D}}{2}\sum\limits_{h\neq g}\sum_{j=1}^{p}\vert \beta_{j}^{h}\beta_{j}^{g}\vert \right),</code>
</p>

<p>over grids for the penalty parameters <code class="reqn">\lambda_{S}</code> and <code class="reqn">\lambda_{D}</code> that are built automatically.
Larger values of <code class="reqn">\lambda_{S}</code> encourage more sparsity within the models and larger values of <code class="reqn">\lambda_{D}</code> encourage more diversity
among them. 
If <code class="reqn">\lambda_{D}=0</code>, then all of the models are equal to the Elastic Net regularized
least squares estimator with penalty parameter <code class="reqn">\lambda_{S}</code>. Optimal penalty parameters are found by
<code>num_folds</code> cross-validation, where the prediction of the ensemble is formed by simple averaging.
The predictors and the response are standardized to zero mean and unit variance before any computations are performed.
The final output is in the original scales.
</p>


<h3>Value</h3>

<p>An object of class cv.SplitReg, a list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>Coefficients computed over the path of penalties for sparsity; the penalty for diversity is fixed at the optimal value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercepts</code></td>
<td>
<p>Intercepts for each of the models along the path of penalties for sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_opt</code></td>
<td>
<p>Index of the optimal penalty parameter for sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_sparsity_opt</code></td>
<td>
<p>Optimal penalty parameter for sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_diversity_opt</code></td>
<td>
<p>Optimal penalty parameter for diversity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas_sparsity</code></td>
<td>
<p>Grid of sparsity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas_diversity</code></td>
<td>
<p>Grid of diversity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv_mse_opt</code></td>
<td>
<p>Optimal CV MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>predict.cv.SplitReg</code>, <code>coef.cv.SplitReg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
set.seed(1)
beta &lt;- c(rep(5, 5), rep(0, 45))
Sigma &lt;- matrix(0.5, 50, 50)
diag(Sigma) &lt;- 1
x &lt;- mvrnorm(50, mu = rep(0, 50), Sigma = Sigma)
y &lt;- x %*% beta + rnorm(50)
fit &lt;- cv.SplitReg(x, y, num_models=2)
coefs &lt;- predict(fit, type="coefficients")

</code></pre>


</div>