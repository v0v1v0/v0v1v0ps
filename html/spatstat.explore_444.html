<div class="container">

<table style="width: 100%;"><tr>
<td>segregation.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Test of Spatial Segregation of Types
</h2>

<h3>Description</h3>

<p>Performs a Monte Carlo test of spatial segregation of the types
in a multitype point pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">segregation.test(X, ...)

## S3 method for class 'ppp'
segregation.test(X, ..., nsim = 19,
       permute = TRUE, verbose = TRUE, Xname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Multitype point pattern (object of class <code>"ppp"</code>
with factor-valued marks).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to <code>relrisk.ppp</code>
to control the smoothing parameter or bandwidth selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations for the Monte Carlo test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permute</code></td>
<td>

<p>Argument passed to <code>rlabel</code>. If <code>TRUE</code> (the
default), randomisation is performed by randomly permuting the
labels of <code>X</code>. If <code>FALSE</code>, randomisation is performing
by resampling the labels with replacement.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xname</code></td>
<td>

<p>Optional character string giving the name of the dataset <code>X</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Monte Carlo test of spatial segregation of types,
proposed by Kelsall and Diggle (1995)
and Diggle et al (2005), is applied to the point pattern <code>X</code>.
The test statistic is
</p>
<p style="text-align: center;"><code class="reqn">
    T = \sum_i \sum_m \left( \widehat p(m \mid x_i) - \overline p_m
    \right)^2
  </code>
</p>

<p>where <code class="reqn">\widehat p(m \mid x_i)</code> is the
leave-one-out kernel smoothing estimate of the probability that the
<code class="reqn">i</code>-th data point has type <code class="reqn">m</code>, and
<code class="reqn">\overline p_m</code> is the average fraction of data points
which are of type <code class="reqn">m</code>.
The statistic <code class="reqn">T</code> is evaluated for the data and
for <code>nsim</code> randomised versions of <code>X</code>, generated by
randomly permuting or resampling the marks.
</p>
<p>Note that, by default, automatic bandwidth selection will be
performed separately for each randomised pattern. This computation
can be very time-consuming but is necessary for the test to be
valid in most conditions. A short-cut is to specify the value of
the smoothing bandwidth <code>sigma</code> as shown in the examples.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code> representing the result of the test.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>References</h3>

<p>Bithell, J.F. (1991)
Estimation of relative risk functions.
<em>Statistics in Medicine</em> <b>10</b>, 1745–1751.
</p>
<p>Kelsall, J.E. and Diggle, P.J. (1995)
Kernel estimation of relative risk.
<em>Bernoulli</em> <b>1</b>, 3–16.
</p>
<p>Diggle, P.J., Zheng, P. and Durr, P. (2005)
Non-parametric estimation of spatial segregation in a
multivariate point process: bovine tuberculosis in
Cornwall, UK. 
<em>Applied Statistics</em> <b>54</b>, 645–658.
</p>


<h3>See Also</h3>

<p><code>relrisk</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  segregation.test(hyytiala, 5)

  if(interactive()) segregation.test(hyytiala, hmin=0.05) 
</code></pre>


</div>