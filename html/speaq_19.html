<div class="container">

<table style="width: 100%;"><tr>
<td>hClustAlign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CluPA function for two spectra.</h2>

<h3>Description</h3>

<p>This function implements the idea of the CluPA algorithm to align the target spectrum against the reference spectrum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hClustAlign(
  refSpec,
  tarSpec,
  peakList,
  peakLabel,
  startP,
  endP,
  distanceMethod = "average",
  maxShift = 0,
  acceptLostPeak = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>refSpec</code></td>
<td>
<p>The reference spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tarSpec</code></td>
<td>
<p>The target spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peakList</code></td>
<td>
<p>List of peaks of the both reference and target spectra</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peakLabel</code></td>
<td>
<p>The list of the labels of the peaks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startP</code></td>
<td>
<p>The starting point of the segment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endP</code></td>
<td>
<p>The ending point of the segment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distanceMethod</code></td>
<td>
<p>The distance method for the hierarchical clustering algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxShift</code></td>
<td>
<p>The maximum number of points for a shift step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acceptLostPeak</code></td>
<td>
<p>This is an option for users, TRUE is the default value. If the users believe that all the peaks in the peak list are true positive, change it to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of 2: tarSpec (The target spectrum after alignment) and peakList (The peak list after alignment)
</p>


<h3>Author(s)</h3>

<p>Trung Nghia Vu
</p>


<h3>References</h3>

<p>Vu TN, Valkenborg D, Smets K, Verwaest KA, Dommisse R, Lemi\'ere F, Verschoren A, Goethals B, Laukens K. (2011) An integrated workflow for robust alignment and simplified quantitative analysis of NMR spectrometry data. BMC Bioinformatics. 2011 Oct 20;12:405.
</p>


<h3>See Also</h3>

<p><code>dohCluster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">res=makeSimulatedData();
X=res$data;
groupLabel=res$label;
peakList &lt;- detectSpecPeaks(X,
                            nDivRange = c(128),
                            scales = seq(1, 16, 2),
                            baselineThresh = 50000,
                            SNR.Th = -1,
                            verbose=FALSE
);
resFindRef&lt;- findRef(peakList);
refInd &lt;- resFindRef$refInd;
tarInd=1;
refSpec=X[refInd,];
tarSpec=X[tarInd,];
mergedPeakList=c(peakList[[refInd]],peakList[[tarInd]]);
mergedPeakLabel=double(length(mergedPeakList));
for (i in seq_along(peakList[[refInd]]) ) mergedPeakLabel[i]=1;
startP=1;
endP=length(tarSpec);
res=hClustAlign(refSpec,tarSpec,mergedPeakList,mergedPeakLabel,startP,endP,
                maxShift=50,acceptLostPeak=TRUE)
                       
</code></pre>


</div>