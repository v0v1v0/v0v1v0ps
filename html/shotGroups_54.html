<div class="container">

<table style="width: 100%;"><tr>
<td>getHitProb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hit probability within given region</h2>

<h3>Description</h3>

<p>Calculates the hit probability within a circular or spherical region for a given group of two- or three-dimensional coordinates.</p>


<h3>Usage</h3>

<pre><code class="language-R">getHitProb(xy, r=1, unit = 'unit', dstTarget, conversion,
           center = FALSE, accuracy = FALSE, type = 'CorrNormal', doRob = FALSE)

## S3 method for class 'data.frame'
getHitProb(xy, r=1, unit = 'unit', dstTarget, conversion,
           center = FALSE, accuracy = FALSE, type = 'CorrNormal', doRob = FALSE)

## Default S3 method:
getHitProb(xy, r=1, unit = 'unit', dstTarget, conversion,
           center = FALSE, accuracy = FALSE, type = 'CorrNormal', doRob = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>either a numerical (n x p)-matrix with the coordinates of n points (1 row of p coordinates per point), or a data frame with either the variables <code>x</code>, <code>y</code> or <code>point.x</code>, <code>point.y</code> (optionally <code>z</code> or <code>point.z</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a numerical vector with the radius values for the circle/sphere that defines the region for which the probability should be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>Measurement unit for radius <code>r</code>. Default <code>'unit'</code> indicates that the measurement unit for (x,y)-coordinates given in <code>conversion</code>. Possible values are <code>'unit', 'm', 'cm', 'mm', 'yd', 'ft', 'in', 'deg', 'MOA', 'SMOA', 'rad', 'mrad', 'mil'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dstTarget</code></td>
<td>
<p>a numerical value giving the distance to the target - used in MOA calculation. Acts as override if variable <code>distance</code> is already included in <code>xy</code>. See <code>getMOA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conversion</code></td>
<td>
<p>how to convert the measurement unit for distance to target to that of the (x,y)-coordinates in MOA calculation. Acts as override if variables <code>dist.unit</code> and <code>point.unit</code> are already included in <code>xy</code>. Example <code>'m2cm'</code>. See <code>getMOA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical: center groups to mean (0,0) first? If variable <code>series</code> does not exist, all shots are treated as belonging to the same group. Only available in method <code>getHitProb.data.frame()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>logical: take systematic location bias into account? See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string vector indicating which estimation method to use. Possible values are <code>'CorrNormal', 'GrubbsPearson', 'GrubbsPatnaik', 'GrubbsLiu', 'Rayleigh'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doRob</code></td>
<td>
<p>logical: use robust estimation of center and covariance matrix as basis for estimates? For Rayleigh only available when <code>accuracy=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimated hit probability is the same as the estimated fraction of shots with a distance to their group center of at most <code>r</code>.
</p>
<p>For <code>accuracy=FALSE</code> (default), the estimated hit probability does not take into account accuracy, i.e., any systematic location bias. The data is then first centered on the empirical group mean, assumed to coincide with the point of aim. Set <code>accuracy=TRUE</code> to incorporate systematic accuracy bias such that the point of aim is in the origin 0, possibly offset from the true group center.
</p>

<ul>
<li> <p><code>CorrNormal</code>: For <code>accuracy=FALSE</code> and two-dimensional data, this estimate is based on the quantile function of the correlated bivariate normal distribution re-written in polar coordinates (radius and angle) (see <code>Hoyt</code>). For <code>accuracy=TRUE</code> or three-dimensional data, it is based on the (offset) circle/sphere probabilities for the correlated multivariate normal distribution (DiDonato &amp; Jarnagin, 1961; DiDonato, 1981, see <code>pmvnEll</code>).
</p>
</li>
<li> <p><code>GrubbsPearson</code>: The Grubbs-Pearson estimate (Grubbs, 1964) is based on the Pearson three-moment central chi^2-approximation of the true cumulative distribution function of radial error. The eigenvalues of the covariance matrix of shot-coordinates are used as variance estimates since they are the variances of the principal components (the PCA-rotated = decorrelated data).
</p>
</li>
<li> <p><code>GrubbsPatnaik</code>: The Grubbs-Patnaik estimate (Grubbs, 1964) differs from the Grubbs-Pearson estimate insofar as it is based on the Patnaik two-moment central chi^2-approximation of the true cumulative distribution function of radial error.
</p>
</li>
<li> <p><code>GrubbsLiu</code>: The Grubbs-Liu estimate was not proposed by Grubbs but follows the same principle as his original estimates. It differs from them insofar as it is based on the Liu-Tang-Zhang four-moment non-central chi^2-approximation of the true cumulative distribution function of radial error. For <code>accuracy=FALSE</code>, it is identical to <code>GrubbsPearson</code>.
</p>
</li>
<li> <p><code>Rayleigh</code>: For <code>accuracy=FALSE</code> and two-dimensional data, this estimate uses the Rayleigh distribution (see <code>getRayParam</code>). It is valid for uncorrelated bivariate normal coordinates with equal variances. This estimate is available for all probability levels. For <code>accuracy=FALSE</code> and three-dimensional data, the Maxwell-Boltzmann distribution is used (see <code>getRayParam</code>). For <code>accuracy=TRUE</code> and two-dimensional data, the estimate uses the Rice distribution (see <code>getRiceParam</code>). For <code>accuracy=TRUE</code> and three-dimensional data, it is based on the offset sphere probabilities for the multivariate normal distribution set to have equal variances (see <code>qmvnEll</code>).
</p>
</li>
</ul>
<p>If package <code>shiny</code> is installed, an interactive web app for this functionality can be run with <code>runGUI("hitprob")</code>.
</p>


<h3>Value</h3>

<p>A vector with the (chosen) hit-probability estimates. For more than one <code>r</code> and more than one <code>type</code>, a matrix.
</p>


<h3>References</h3>

<p>DiDonato, A. R. (1988). Integration of the trivariate normal distribution over an offset spehere and an inverse problem (NSWC TR 87-27). Dahlgren, VA: U.S. Naval Surface Weapons Center Dahlgren Division.
</p>
<p>DiDonato, A. R., &amp; Jarnagin, M. P. (1961). Integration of the general bivariate Gaussian distribution over an offset circle. Mathematics of Computation, 15 (76), 375-382.
</p>
<p>Grubbs, F. E. (1964). Approximate circular and noncircular offset probabilities of hitting. Operations Research, 12(1), 51-62.
</p>
<p>Liu, H., Tang, Y., &amp; Zhang, H. H. (2009). A new chi-square approximation to the distribution of non-negative definite quadratic forms in non-central normal variables. Computational Statistics &amp; Data Analysis, 53(4), 853-856.
</p>
<p>Singh, H. P. 1992. Estimation of Circular Probable Error. The Indian Journal of Statistics, Series B 5(3), 289-305.
</p>


<h3>See Also</h3>

<p><code>Rayleigh</code>,
<code>Maxwell</code>,
<code>Hoyt</code>,
<code>mvnEll</code>,
<code>getHoytParam</code>,
<code>getRayParam</code>,
<code>getCEP</code>,
<code>getConfEll</code>,
<code>covMcd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># coordinates given by a suitable data frame
# estimated fraction of shots within a circle with radius
# 1 and 1.5 MOA.
getHitProb(DFscar17, r=c(1, 1.5), unit='MOA', accuracy=FALSE,
           dstTarget=100, conversion='yd2in',
           type=c('CorrNormal', 'GrubbsPatnaik'))

# coordinates given by a matrix
## Not run: 
xy &lt;- matrix(round(rnorm(100, 0, 5), 2), ncol=2)
getHitProb(xy, r=c(2, 2.5), unit='MOA', accuracy=FALSE,
           dstTarget=100, conversion='yd2in',
           type=c('CorrNormal', 'GrubbsPatnaik'))

## End(Not run)
</code></pre>


</div>