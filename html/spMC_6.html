<div class="container">

<table style="width: 100%;"><tr>
<td>embed_MC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transition Probabilities Estimation for Embedded Markov Chain</h2>

<h3>Description</h3>

<p>The function estimates the embedded transition probabilities matrix for a <code class="reqn">1</code>-D spatial embedded Markov chain.</p>


<h3>Usage</h3>

<pre><code class="language-R">embed_MC(data, coords, loc.id, direction)</code></pre>


<h3>Arguments</h3>





<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.id</code></td>
<td>
<p>a vector of <code class="reqn">n</code> values which indicats the directional line of each location. It is usually the output of the function <code>which_lines</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a <code class="reqn">d</code>-D numerical vector (or versor) which represents the chosen direction.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An embedded Markov chain is probabilistic model which defines the transition probabilities between embedded occurrences. 
</p>
<p>The resulting matrix is given by normalizing a transition count matrix, which doesn't depend on the length of embedded occurrences. Self-transitions of embedded occurrences are not observable, so diagonal entries are set to be <code>NA</code>.
</p>
<p>It's also possible to calculate the transition probabilities matrix for several directions in a <code class="reqn">d</code>-D space through arguments <code>direction</code> and <code>loc.id</code>. If the user has no previous knowledge about <code>loc.id</code>, the function <code>which_lines</code> provides a method to compute the right values.
</p>


<h3>Value</h3>

<p>A <code class="reqn">K \times K</code> transition probability matrix, where <code class="reqn">K</code> denotes the number of observed categories. Another <code class="reqn">K \times K</code> matrix with the counts of transitions is attached as an attribute.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Dynkin, E. B. (1961) <em>Theory of Markov Processes. Englewood Cliffs</em>, N.J.: Prentice-Hall, Inc.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>which_lines</code>, <code>predict.tpfit</code>, <code>predict.multi_tpfit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)
direction &lt;- c(0, 0, 1)

# Compute the appertaining directional line for each location
loc.id &lt;- which_lines(ACM[, 1:3], direction, pi/8)

# Estimate the embedded transition probabilities
# matrix for the categorical variable MAT5
embed_MC(ACM$MAT5, ACM[, 1:3], loc.id, direction)

# Estimate the embedded transition probabilities
# matrix for the categorical variable MAT3
embed_MC(ACM$MAT3, ACM[, 1:3], loc.id, direction)

# Estimate the embedded transition probabilities
# matrix for the categorical variable PERM
embed_MC(ACM$PERM, ACM[, 1:3], loc.id, direction)
</code></pre>


</div>