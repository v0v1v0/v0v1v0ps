<div class="container">

<table style="width: 100%;"><tr>
<td>calculateRSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residual sum of squares (RSS) for all time series in a group.</h2>

<h3>Description</h3>

<p>SCEM uses the residual sum of squares for each group to give a sense of the error in estimation. It is defined by:
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[RSS(S_q) = \sum_{k \in S_q} \sum_{i = 1}^{n_k} ||y_{k,i} - \hat{\mu}_{S_q} \left(\frac{i}{n_k}\right) - \hat{c}_{k}||^2\]
<p>(See Chazin et al. 2019, Supplemental Materials 1).
</p>
<p>The trend function for each individual time series is estimated non-parametrically
by the local linear estimate (as discussed in Fan and Gijbels (1996)). Then, the common trend
function for the group is estimated by taking the average over the group. Next, the shift functions
are estimated as the differences from the individual trend functions and finally, the residual sum
of squares are calculated  using the original values, the common trend functions and the shifts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculateRSS(paths, S, bandwidth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>paths</code></td>
<td>
<p>A list of data frames, where each frame contains the data for one individual. Every
data frame should have two columns with names 'distance' and 'oxygen'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A vector of integers showing which individuals are considered in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>Denotes the order of the bandwidth that should be used in the estimation process.
bandwidth = k will mean that the bandwidth is n^k.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of length equal to the group-size, so that each element is the RSS for the
corresponding individual in the group.
</p>


<h3>Examples</h3>

<pre><code class="language-R">armenia_split = split(armenia,f = armenia$ID)
band = -0.33
p = length(armenia_split)
calculateRSS(armenia_split,1:p,band)
</code></pre>


</div>