<div class="container">

<table style="width: 100%;"><tr>
<td>SIR_threshold_bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SIR optimally thresholded on bootstraped replications</h2>

<h3>Description</h3>

<p>Apply a single-index optimally soft/hard thresholded <code class="reqn">SIR</code> with <code class="reqn">H</code> slices on 
'n_replications' bootstraped replications of <code class="reqn">(X,Y)</code>. The optimal number of 
selected variables is the number of selected variables that came back most often 
among the replications performed. From this, we can get the corresponding <code class="reqn">\hat{b}</code> 
and <code class="reqn">\lambda_{opt}</code> that produce the same number of selected variables in the result of 
'SIR_threshold_opt'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SIR_threshold_bootstrap(
  Y,
  X,
  H = 10,
  thresholding = "hard",
  n_replications = 50,
  graph = TRUE,
  output = TRUE,
  n_lambda = 100,
  k = 2,
  choice = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numeric vector representing the dependent variable (a response vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix representing the quantitative explanatory variables (bind by column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The chosen number of slices (default is 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholding</code></td>
<td>
<p>The thresholding method to choose between hard and soft (default is hard).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_replications</code></td>
<td>
<p>The number of bootstraped replications of (X,Y) done to
estimate the model (default is 50).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A boolean, set to TRUE to plot graphs (default is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>A boolean, set to TRUE to print information (default is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lambda</code></td>
<td>
<p>The number of lambda to test. The n_lambda tested lambdas are
uniformally distributed between 0 and the maximum value of the interest matrix (default is 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Multiplication factor of the bootstrapped sample size
(default is 1 = keep the same size as original data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li>
<p> "estim_ind" Plot the estimated index by the SIR model versus Y.
</p>
</li>
<li>
<p> "size" Plot the size of the models across the replications.
</p>
</li>
<li>
<p> "selec_var" Plot the occurrence of the selected variables across the replications.
</p>
</li>
<li>
<p> "coefs_b" Plot the value of b across the replications.
</p>
</li>
<li>
<p> "lambdas_replic" Plot the optimal lambdas across the replications.
</p>
</li>
<li>
<p> "" Plot every graphs (default).
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class SIR_threshold_bootstrap, with attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>This is the optimal estimated EDR direction, which is the principal 
eigenvector of the interest matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_opt</code></td>
<td>
<p>The optimal lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec_nb_var_selec</code></td>
<td>
<p>Vector that contains the number of selected variables 
for each replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occurrences_var</code></td>
<td>
<p>Vector that contains at index i the number of times the 
i_th variable has been selected in a replication.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Unevaluated call to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_var_selec_opt</code></td>
<td>
<p>Optimal number of selected variables which is the number 
of selected variables that came back most often among the replications performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_relevant_variables</code></td>
<td>
<p>A list that contains the variables selected by 
the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of variables in X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The chosen number of slices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_replications</code></td>
<td>
<p>The number of bootstraped replications of (X,Y) done to
estimate the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholding</code></td>
<td>
<p>The thresholding method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_reduced</code></td>
<td>
<p>The X data restricted to the variables selected by the model.
It can be used to estimate a new SIR model on the relevant variables to improve
the estimation of b.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_b</code></td>
<td>
<p>Contains the estimation b at each bootstraped replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas_opt_boot</code></td>
<td>
<p>Contains the optimal lambda found by SIR_threshold_opt at 
each replication.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_pred</code></td>
<td>
<p>The index Xb' estimated by SIR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M1</code></td>
<td>
<p>The interest matrix thresholded with the optimal lambda.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Generate Data
set.seed(8)
n &lt;-  170
beta &lt;- c(1,1,1,1,1,rep(0,15))
X &lt;- mvtnorm::rmvnorm(n,sigma=diag(1,20))
eps &lt;- rnorm(n,sd=8)
Y &lt;- (X%*%beta)**3+eps

# Apply SIR with hard thresholding
SIR_threshold_bootstrap(Y,X,H=10,n_lambda=300,thresholding="hard", n_replications=30,k=2)

</code></pre>


</div>