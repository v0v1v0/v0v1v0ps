<div class="container">

<table style="width: 100%;"><tr>
<td>Sobolev_coefs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transformation between different coefficients in Sobolev statistics</h2>

<h3>Description</h3>

<p>Given a Sobolev statistic
</p>
<p style="text-align: center;"><code class="reqn">S_{n, p} = \sum_{i, j = 1}^n \psi(\cos^{-1}({\bf X}_i'{\bf X}_j)),</code>
</p>

<p>for a sample <code class="reqn">{\bf X}_1, \ldots, {\bf X}_n \in S^{p - 1} := \{{\bf x}
\in R^p : ||{\bf x}|| = 1\}</code>, <code class="reqn">p\ge 2</code>, three important sequences
are related to <code class="reqn">S_{n, p}</code>.
</p>

<ul>
<li> <p>Gegenbauer coefficients <code class="reqn">\{b_{k, p}\}</code> of
<code class="reqn">\psi_p</code> (see, e.g., the projected-ecdf statistics), given
by
</p>
<p style="text-align: center;"><code class="reqn">b_{k, p} := \frac{1}{c_{k, p}}\int_0^\pi \psi_p(\theta)
C_k^{p / 2 - 1}(\cos\theta)\,\mathrm{d}\theta.</code>
</p>

</li>
<li>
<p> Weights <code class="reqn">\{v_{k, p}^2\}</code> of the
asymptotic distribution of the Sobolev statistic,
<code class="reqn">\sum_{k = 1}^\infty v_k^2 \chi^2_{d_{p, k}}</code>, given by
</p>
<p style="text-align: center;"><code class="reqn">v_{k, p}^2 = \left(1 + \frac{2k}{p - 2}\right)^{-1} b_{k, p},
\quad p \ge 3.</code>
</p>

</li>
<li>
<p> Gegenbauer coefficients <code class="reqn">\{u_{k, p}\}</code> of the
local projected alternative associated to <code class="reqn">S_{n, p}</code>,
given by
</p>
<p style="text-align: center;"><code class="reqn">u_{k, p} = \left(1 + \frac{2k}{p - 2}\right) v_{k, p},
\quad p \ge 3.</code>
</p>

</li>
</ul>
<p>For <code class="reqn">p = 2</code>, the factor <code class="reqn">(1 + 2k / (p - 2))</code> is replaced by <code class="reqn">2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bk_to_vk2(bk, p, log = FALSE)

bk_to_uk(bk, p, signs = 1)

vk2_to_bk(vk2, p, log = FALSE)

vk2_to_uk(vk2, p, signs = 1)

uk_to_vk2(uk, p)

uk_to_bk(uk, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bk</code></td>
<td>
<p>coefficients <code class="reqn">b_{k, p}</code> associated to the indexes
<code>1:length(bk)</code>, a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer giving the dimension of the ambient space <code class="reqn">R^p</code> that
contains <code class="reqn">S^{p-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>do operations in log scale (log-in, log-out)? Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signs</code></td>
<td>
<p>signs of the coefficients <code class="reqn">u_{k, p}</code>, a vector of the
same size as <code>vk2</code> or <code>bk</code>, or a scalar. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vk2</code></td>
<td>
<p><b>squared</b> coefficients <code class="reqn">v_{k, p}^2</code> associated to the
indexes <code>1:length(vk2)</code>, a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uk</code></td>
<td>
<p>coefficients <code class="reqn">u_{k, p}</code> associated to the indexes
<code>1:length(uk)</code>, a vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See more details in Prentice (1978) and García-Portugués et al. (2023). The
adequate signs of <code>uk</code> for the <code>"PRt"</code> Rothman test
can be retrieved with <code>akx</code> and <code>sqr = TRUE</code>, see the
examples.
</p>


<h3>Value</h3>

<p>The corresponding vectors of coefficients <code>vk2</code>, <code>bk</code>, or
<code>uk</code>, depending on the call.
</p>


<h3>References</h3>

<p>García-Portugués, E., Navarro-Esteban, P., Cuesta-Albertos, J. A. (2023)
On a projection-based class of uniformity tests on the hypersphere.
<em>Bernoulli</em>, 29(1):181–204. <a href="https://doi.org/10.3150/21-BEJ1454">doi:10.3150/21-BEJ1454</a>.
</p>
<p>Prentice, M. J. (1978). On invariant tests of uniformity for directions and
orientations. <em>The Annals of Statistics</em>, 6(1):169–176.
<a href="https://doi.org/10.1214/aos/1176344075">doi:10.1214/aos/1176344075</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># bk, vk2, and uk for the PCvM test in p = 3
(bk &lt;- Gegen_coefs_Pn(k = 1:5, type = "PCvM", p = 3))
(vk2 &lt;- bk_to_vk2(bk = bk, p = 3))
(uk &lt;- bk_to_uk(bk = bk, p = 3))

# vk2 is the same as
weights_dfs_Sobolev(K_max = 10, thre = 0, p = 3, type = "PCvM")$weights

# bk and uk for the Rothman test in p = 3, with adequate signs
t &lt;- 1 / 3
(bk &lt;- Gegen_coefs_Pn(k = 1:5, type = "PRt", p = 3, Rothman_t = t))
(ak &lt;- akx(x = drop(q_proj_unif(t, p = 3)), p = 3, k = 1:5, sqr = TRUE))
(uk &lt;- bk_to_uk(bk = bk, p = 3, signs = ak))
</code></pre>


</div>