<div class="container">

<table style="width: 100%;"><tr>
<td>nvcovOfAcf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariances of sample autocorrelations</h2>

<h3>Description</h3>

<p>Compute covariances of autocorrelations.</p>


<h3>Usage</h3>

<pre><code class="language-R">nvcovOfAcf(model, maxlag)

nvcovOfAcfBD(acf, ma, maxlag)

acfOfSquaredArmaModel(model, maxlag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlag</code></td>
<td>
<p>a positive integer number, the maximal lag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acf</code></td>
<td>
<p>autocorrelations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma</code></td>
<td>

<p>a positive integer number, the order of the MA(q) model. The default
is the maximal lag available in <code>acf</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>nvcovOfAcf</code> computes the unscaled asymptotic autocovariances of
sample autocorrelations of ARMA models, under the classical
assumptions when the Bartlett's formulas are valid.  It works directly
with the parameters of the model and uses Boshnakov (1996).  Argument
<code>model</code> can be any specification of ARMA models for which
<code>autocorrelations()</code> will work, e.g. a list with components "ar",
"ma", and "sigma2".
</p>
<p><code>nvcovOfAcfBD</code> computes the same quantities but uses the formula
given by Brockwell &amp; Davis (1991) (eq. (7.2.6.), p. 222), which is
based on the autocorrelations of the model. Argument
<code>acf</code> contains the autocorrelations.
</p>
<p>For <code>nvcovOfAcfBD</code>, argument <code>ma</code> asks to treat the provided
acf as that of MA(<code>ma</code>). Only the values for lags up to
<code>ma</code> are used and the rest are set to zero, since the
autocorrelations of MA(<code>ma</code>) models are zero for lags greater
than <code>ma</code>.
To force the use of all autocorrelations provided in <code>acf</code>, set
<code>ma</code> to the maximal lag available in <code>acf</code> or omit
<code>ma</code>, since this is its default.
</p>
<p><code>acfOfSquaredArmaModel(model, maxlag)</code> is a convenience function
which computes the autocovariances of the "squared" model, see
Boshnakov (1996).
</p>


<h3>Value</h3>

<p>an <code>(maxlag,maxlag)</code>-matrix
</p>


<h3>Note</h3>

<p>The name of <code>nvcovOfAcf</code> stands for “<code>n</code> times the
variance-covariance matrix”, so it needs to be divided by <code>n</code> to
get the asymptotic variances and covariances. 
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Boshnakov GN (1996).
“Bartlett's formulae—closed forms and recurrent equations.”
<em>Ann. Inst. Statist. Math.</em>, <b>48</b>(1), 49–59.
ISSN 0020-3157, <a href="https://doi.org/10.1007/BF00049288">doi:10.1007/BF00049288</a>.
</p>
<p>Brockwell PJ, Davis RA (1991).
<em>Time series: theory and methods. 2nd ed.</em>.
Springer Series in Statistics. Berlin etc.: Springer-Verlag..
</p>


<h3>See Also</h3>

<p><code>whiteNoiseTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## MA(2)
ma2 &lt;- list(ma = c(0.8, 0.1), sigma2 = 1)
nv &lt;- nvcovOfAcf(ma2, maxlag = 4)
d &lt;- diag(nvcovOfAcf(ma2, maxlag = 7))
cbind(ma2 = 1.96 * sqrt(d) / sqrt(200), iid = 1.96/sqrt(200))

acr &lt;- autocorrelations(list(ma = c(0.8, 0.1)), maxlag = 7)
nvBD &lt;- nvcovOfAcfBD(acr, 2, maxlag = 4)
all.equal(nv, nvBD) # TRUE
</code></pre>


</div>