<div class="container">

<table style="width: 100%;"><tr>
<td>qnn.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>q Nearest Neighbors Test</h2>

<h3>Description</h3>

<p><code>qnn.test</code> calculates statistics related to the q
nearest neighbors method of comparing case and control
point patterns under the random labeling hypothesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qnn.test(x, q = 5, case = 2, nsim = 499, longlat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ppp</code> object with marks for the case
and control groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A vector of positive integers indicating the
values of <code>q</code> for which to do the q nearest
neighbors test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>The name of the desired "case" group in
<code>levels(x$marks)</code>. Alternatively, the position of
the name of the "case" group in <code>levels(x$marks)</code>.
Since we don't know the group names, the default is 2,
the second position of <code>levels(x$marks)</code>.
<code>x$marks</code> is assumed to be a factor.  Automatic
conversion is attempted if it is not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations from which to
compute p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>A logical value indicating whether
Euclidean distance (<code>FALSE</code>) or Great Circle
(WGS84 ellipsoid, <code>FALSE</code>) should be used. Default
is <code>FALSE</code>, i.e., Euclidean distance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>qsum</code></td>
<td>
<p>A dataframe with the number of neighbors
(q), test statistic (Tq), and p-value for each test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consum</code></td>
<td>
<p>A dataframe with the contrasts
(contrast), test statistic (Tcon), and p-value
(pvalue) for the test of contrasts.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Waller, L.A., and Gotway, C.A. (2005).
Applied Spatial Statistics for Public Health Data.
Hoboken, NJ: Wiley.
</p>
<p>Cuzick, J., and Edwards, R. (1990). Spatial clustering
for inhomogeneous populations. Journal of the Royal
Statistical Society. Series B (Methodological), 73-104.
</p>
<p>Alt, K.W., and Vach, W. (1991). The reconstruction of
"genetic kinship" in prehistoric burial
complexes-problems and statistics. Classification, Data
Analysis, and Knowledge Organization, 299-310.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(grave)
qnn.test(grave, case = "affected", q = c(3, 5, 7, 9, 11, 13, 15))
</code></pre>


</div>