<div class="container">

<table style="width: 100%;"><tr>
<td>human_mouse_ct_marker_enrich</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Consensus cell-type naming (Fisher's Exact)</h2>

<h3>Description</h3>

<p>This function completes the Fisher's exact test cell-type naming for all cell-types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">human_mouse_ct_marker_enrich(
  gene_lists,
  theSpecies = "human",
  cell_marker_path = "",
  naming_preference = -9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gene_lists</code></td>
<td>
<p>A named list of vectors containing cell-type markers (mouse or human gene-symbols) which will be named as a cell-type via the Fisher's exact test method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theSpecies</code></td>
<td>
<p>The species of the gene symbols: "human" or "mouse".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_marker_path</code></td>
<td>
<p>If local, path to cell-type marker rda files, otherwise, we will try to download data files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naming_preference</code></td>
<td>
<p>Either -9 if there is no expected cell-type or one of the categories from get_naming_preference_options(). This is useful if you previously have an idea of which cell-type you were going to enrich.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fisher's exact test method of cell-type identification using the Panglao and CellMarker databases. It extracts significant pathways (pFDR &lt; 0.05).
Then, if naming_preference != -9, it will extract the enriched cell-types within the cell-types identified with the naming preferences option.
Generally, this method seems to be biased to cell-types with a greater number of markers.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cellTypes</code></td>
<td>
<p>most likely marker for each cell-type from each database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_sets</code></td>
<td>
<p>all enriched cell-types for each cluster from each dataset.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

data(POA_example)
POA_generes &lt;- POA_example$POA_generes
POA_OR_signature &lt;- POA_example$POA_OR_signature
POA_Rank_signature &lt;- POA_example$POA_Rank_signature
Signature &lt;- POA_Rank_signature
rowname &lt;- get_gene_symbol(Signature)
rownames(Signature) &lt;- rowname$rowname
genes &lt;- rownames(Signature)[1:100]
enriched &lt;- human_mouse_ct_marker_enrich(gene_lists = genes, theSpecies = "mouse", 
                                         cell_marker_path = "", naming_preference = "brain")
 
</code></pre>


</div>