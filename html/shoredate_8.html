<div class="container">

<table style="width: 100%;"><tr>
<td>shoreline_date</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shoreline date</h2>

<h3>Description</h3>

<p>A function for shoreline dating Stone Age sites based on their present-day
elevation, their likely elevation above sea-level when in use and the
trajectory of past shoreline displacement. Details and caveats pertaining to
the implemented method is given in Roalkvam (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">shoreline_date(
  sites,
  elevation = NA,
  elev_reso = 0.01,
  cal_reso = 10,
  isobase_direction = 327,
  sum_isobase_directions = FALSE,
  model = "gamma",
  model_parameters = c(0.286, 20.833),
  elev_fun = "mean",
  upper_temp_limit = -2500,
  target_curve = NA,
  hdr_prob = 0.95,
  normalise = TRUE,
  sparse = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sites</code></td>
<td>
<p>Vector giving one or more site names, or, if displacement curves
are to be interpolated, objects of class <code>sf</code> representing the sites to be
dated. In the case of a spatial geometry, the first column is taken as the
site name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation</code></td>
<td>
<p>Vector of numeric elevation values for each site or a
an elevation raster of class <code>SpatRaster</code> from the package
<code>terra</code> from where the elevation values are to be derived.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev_reso</code></td>
<td>
<p>Numeric value specifying the resolution with which to step
through the distribution representing the distance between site and
shoreline. Defaults to 0.01m.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cal_reso</code></td>
<td>
<p>Numeric value specifying the resolution to use on the
calendar scale. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isobase_direction</code></td>
<td>
<p>A vector of numeric values defining the direction(s)
of the isobases. Defaults to 327.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_isobase_directions</code></td>
<td>
<p>Logical value indicating that if multiple
isobase directions are specified in <code>isobase_direction</code> the results should
be summed for each site using <code>sum_shoredates</code>. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Character vector specifying the statistical model with which to
model the distance from site to shoreline. Currently accepts either "none"
or "gamma". Defaults to "gamma".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_parameters</code></td>
<td>
<p>Vector of numeric values specifying the parameters
for the statistical model describing the distance between site and
shoreline. Defaults to c(0.286, 20.833), denoting the shape and scale of the
default gamma function, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev_fun</code></td>
<td>
<p>Statistic to define site elevation if this is to be derived
from an elevation raster. Uses <code>terra::extract()</code>. Defaults to mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_temp_limit</code></td>
<td>
<p>Numerical value giving the upper temporal limit.
Dates with a start date after the limit are returned as NA. Defaults to
-2500, i.e. 2500 BCE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_curve</code></td>
<td>
<p>Data frame holding pre-computed shoreline displacement
curve. This has to have the same or higher resolution on the calendar scale
as that specified with <code>cal_reso</code>. <code>interpolate_curve()</code> will be run if
nothing is provided to <code>target_curve</code>. Defaults to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hdr_prob</code></td>
<td>
<p>Numeric value specifying the coverage of the highest density
region. Defaults to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalise</code></td>
<td>
<p>Logical value specifying whether the shoreline date should
be normalised to sum to unity. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Logical value specifying if only site name and shoreline date
should be returned. Defaults to FALSE. Note that of the functions for
further treatment, sparse dates are only compatible with
<code>sum_shoredates()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value indicating whether progress should be printed to
console. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A nested list of class <code>shoreline_date</code> holding the shoreline date
results and associated metadata for each dated site for each isobase
direction. The elements of each date is:
</p>

<ul>
<li> <p><code>site_name</code> name of the site.
</p>
</li>
<li> <p><code>site_elev</code> elevation of the site.
</p>
</li>
<li> <p><code>date</code> data frame with the columns <code>bce</code> where negative values
indicate years BCE and positive CE, as well as <code>probability</code>, which gives
the probability mass for each year.
</p>
</li>
<li> <p><code>weighted_mean</code> the weighted mean date.
</p>
</li>
<li> <p><code>hdr_start</code> start values for the HDR ranges.
</p>
</li>
<li> <p><code>hdr_end</code> end values for the HDR ranges.
</p>
</li>
<li> <p><code>hdr_prob</code> probability level for the HDR.
</p>
</li>
<li> <p><code>dispcurve</code> data frame holding the displacement curve used for dating
the site. This has the columns <code>bce</code>, giving years BCE/CE. <code>lowerelev</code>,
the lower limit for the elevation of the shoreline for each year.
<code>upperelev</code>, the upper limit for elevation of the shoreline for each year.
</p>
</li>
<li> <p><code>dispcurve_direction</code> direction of the isobases in use.
</p>
</li>
<li> <p><code>model_parameters</code> parameters for the statistical model.
</p>
</li>
<li> <p><code>modeldat</code> data frame holding the model distribution. The column
<code>offset</code> denotes the vertical distance (m) from the shoreline, as specified
by the <code>elev_reso</code> argument. <code>px</code> is the cumulative probability at each step
of <code>offset</code>, and <code>probs</code> is the probability of each step found by
subtracting the preceding value from each value of <code>px</code>.
</p>
</li>
<li> <p><code>cal_reso</code> resolution on the calendar scale.
</p>
</li>
</ul>
<h3>References</h3>

<p>Roalkvam, I. 2023. A simulation-based assessment of the relation between
Stone Age sites and relative sea-level change along the Norwegian Skagerrak
coast. <em>Quaternary Science Reviews</em> 299:107880. DOI:
https://doi.org/10.1016/j.quascirev.2022.107880
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create example point using the required CRS WGS84 UTM32N (EPSG: 32632)
target_point &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)), crs = 32632)

# Date target point, manually specifying the elevation instead of providing
# an elevation raster. Reducing elev_reso and cal_reso for speed.
shoreline_date(sites = target_point,
               elevation = 80,
               elev_reso = 1,
               cal_reso = 400)
</code></pre>


</div>