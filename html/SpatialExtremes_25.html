<div class="container">

<table style="width: 100%;"><tr>
<td>fitcopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a copula-based model to spatial extremes
</h2>

<h3>Description</h3>

<p>This function fits various copula-based models to spatial extremes
data sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitcopula(data, coord, copula = "gaussian", cov.mod = "whitmat",
loc.form, scale.form, shape.form, marg.cov = NULL, temp.cov = NULL,
temp.form.loc = NULL, temp.form.scale = NULL, temp.form.shape = NULL,
..., start, control = list(maxit = 10000), method = "Nelder", std.err =
TRUE, warn = TRUE, corr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing the data. Each column corresponds to
one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A matrix that gives the coordinates of each
location. Each row corresponds to one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>A character string. Must be one of "gaussian" and
"student" for a Gaussian and Student copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string corresponding to the correlation
function family used in the copula. Must be one of "whitmat",
"cauchy", "powexp", "bessel" or "caugen" for the Whittle-Matern, the
Cauchy, the Powered Exponential, the Bessel and the Generalized
Cauchy correlation families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.form, scale.form, shape.form</code></td>
<td>
<p>R formulas defining the
spatial linear model for the GEV parameters. May be missing. See
section Details of function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg.cov</code></td>
<td>
<p>Matrix with named columns giving additional covariates
for the GEV parameters. If <code>NULL</code>, no extra covariates are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.cov</code></td>
<td>
<p>Matrix with names columns giving additional *temporal*
covariates for the GEV parameters. If <code>NULL</code>, no temporal trend
are assume for the GEV parameters â€” see section Details of
function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.form.loc, temp.form.scale, temp.form.shape</code></td>
<td>
<p>R formulas
defining the temporal trends for the GEV parameters. May be
missing. See section Details of function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Several arguments to be passed to the
<code>optim</code>, <code>nlm</code> or <code>nlminb</code>
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values for the
parameters over which the pairwise likelihood is to be minimized. If
<code>start</code> is omitted the routine attempts to find good starting
values - but might fail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list giving the control parameters to be passed to
the <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for the numerical optimisation
procedure. Must be one of <code>BFGS</code>, <code>Nelder-Mead</code>,
<code>CG</code>, <code>L-BFGS-B</code>, <code>SANN</code>, <code>nlm</code> or
<code>nlminb</code>. See <code>optim</code> for details. Please note that
passing <code>nlm</code> or <code>nlminb</code> will use the <code>nlm</code>
or <code>nlminb</code> functions instead of <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>Logical. Should the standard errors be computed ? The
default is to return the standard errors, i.e.,  <code>std.err =
      TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), users are warned if
the log-likelihood is infinite at starting values and/or problems
arised while computing the standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Logical. If <code>TRUE</code> (non default), the asymptotic
correlation matrix is computed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a object of class <code>copula</code>.
</p>


<h3>Warning</h3>

<p>This function does not use max-stable copula and the use of non
max-stable copula for modelling spatial extreme is highly
questionable. This function was mainly implemented for educational
purposes and <b>not</b> for concrete modelling purposes. 
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet
</p>


<h3>References</h3>

<p>Davison, A.C., Padoan, S.A., Ribatet, M. (2010) Statistical Modelling
of Spatial Extremes. <em>Submitted to Statistical Science</em>.
</p>


<h3>See Also</h3>

<p><code>fitmaxstab</code>, <code>latent</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
n.site &lt;- 30
n.obs &lt;- 50

coord &lt;- matrix(runif(2 * n.site, -10, 10), ncol = 2)
colnames(coord) &lt;- c("lon", "lat")

## Generate data from a Gaussian copula model
data &lt;- rcopula(n.obs, coord, "gaussian", "powexp", nugget = 0, range = 4, smooth = 1.2)

## Transform the margins to GEV
locs &lt;- -5 + coord[,"lon"] / 10
scales &lt;- 10 + coord[,"lat"] / 2
shapes &lt;- rep(0.2, n.site)

for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], locs[i], scales[i], shapes[i])

## Fit a Gaussian copula model

## 1. Define trend surfaces
loc.form &lt;- y ~ lon
scale.form &lt;- y ~ lat
shape.form &lt;- y ~ 1

## 2. Fit
M0 &lt;- fitcopula(data, coord, "gaussian", "powexp", loc.form, scale.form,
                shape.form, nugget = 0)

## End(Not run)
</code></pre>


</div>