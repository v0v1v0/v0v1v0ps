<div class="container">

<table style="width: 100%;"><tr>
<td>plotResponse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Response Curve</h2>

<h3>Description</h3>

<p>Plot the Response Curve of the given environmental variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotResponse(
  model,
  var,
  type = NULL,
  only_presence = FALSE,
  marginal = FALSE,
  fun = mean,
  rug = FALSE,
  color = "red"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>SDMmodel or SDMmodelCV object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>character. Name of the variable to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character. The output type used for "Maxent" and "Maxnet"
methods, possible values are "cloglog" and "logistic".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_presence</code></td>
<td>
<p>logical. If <code>TRUE</code> it uses only the presence locations
when applying the function for the marginal response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>logical. If <code>TRUE</code> it plots the marginal response curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>function used to compute the level of the other variables for
marginal curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>logical. If <code>TRUE</code> it adds the rug plot for the presence and
absence/background locations, available only for continuous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>The color of the curve, default is "red".</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p> Note that <code>fun</code> is not a character argument, you must use <code>mean</code> and not
<code>"mean"</code>.
</p>
</li>
<li>
<p> If you want to modify the plot, first you have to assign the output of the
function to a variable, and then you have two options:
</p>

<ul>
<li>
<p> Modify the <code>ggplot</code> object by editing the theme or adding additional
elements
</p>
</li>
<li>
<p> Get the data with <code>ggplot2::ggplot_build()</code> and then build your own
plot (see examples)
</p>
</li>
</ul>
</li>
</ul>
<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Train a model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq")

# Plot cloglog response curve for a continuous environmental variable (bio1)
plotResponse(model,
             var = "bio1",
             type = "cloglog")

# Plot marginal cloglog response curve for a continuous environmental
# variable (bio1)
plotResponse(model,
             var = "bio1",
             type = "cloglog",
             marginal = TRUE)

# Plot logistic response curve for a continuous environmental variable
# (bio12) adding the rugs and giving a custom color
plotResponse(model,
             var = "bio12",
             type = "logistic",
             rug = TRUE,
             color = "blue")

# Plot response curve for a categorical environmental variable (biome) giving
# a custom color
plotResponse(model,
             var = "biome",
             type = "logistic",
             color = "green")

# Modify plot
# Change y axes limits
my_plot &lt;- plotResponse(model,
                        var = "bio1",
                        type = "cloglog")
my_plot +
  ggplot2::scale_y_continuous(limits = c(0, 1))

# Get the data and create your own plot:
df &lt;- ggplot2::ggplot_build(my_plot)$data[[1]]
plot(df$x, df$y,
     type = "l",
     lwd = 3,
     col = "blue",
     xlab = "bio1",
     ylab = "cloglog output")

# Train a model with cross validation
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq",
               folds = folds)

# Plot cloglog response curve for a continuous environmental variable (bio17)
plotResponse(model,
             var = "bio1",
             type = "cloglog")

# Plot logistic response curve for a categorical environmental variable
# (biome) giving a custom color
plotResponse(model,
             var = "biome",
             type = "logistic",
             color = "green")
</code></pre>


</div>