<div class="container">

<table style="width: 100%;"><tr>
<td>ibd2kin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute kinship coefficient from IBD segments</h2>

<h3>Description</h3>

<p>This function is used to retrieve a relatedness measure from IBD segments.
The relatedness value returned is the kinship coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ibd2kin(.ibd_data, .map, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.ibd_data</code></td>
<td>
<p>Tibble with IBD segments created using the read_ibd function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.map</code></td>
<td>
<p>Tibble with the genetic map data created using the read_map function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of IBD to use for kinship coefficient calculation; must be <code>'IBD1'</code>, <code>'IBD2'</code>, or <code>NULL</code> (both IBD1 and IBD2 will be treated the same); default is <code>NULL</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data should be pairwise IBD segments prepared via
read_ibd. The function will internally loop over each
chromosome, and use a specified genetic map to convert shared segments to
genetic units. After doing so, the function converts the shared length to a
kinship coefficient by summing <code class="reqn">0.5*IBD2 + 0.25*IBD1</code>.
</p>
<p>Note that the data read in by read_ibd when <code>source="pedsim"</code> returns a
list with separate tibbles for IBD1 and IBD2 segments. The current
implementation of this function requires running this function independently
on IBD1 and IBD2 segments, then summarizing (adding) the corresponding
proportions. See examples.
</p>


<h3>Value</h3>

<p>Tibble with three columns:
</p>

<ol>
<li>
<p> id1 (sample identifier 1)
</p>
</li>
<li>
<p> id2 (sample identifier 2)
</p>
</li>
<li>
<p> kinship (kinship coefficent derived from shared segments)
</p>
</li>
</ol>
<h3>References</h3>

<p>http://faculty.washington.edu/sguy/ibd_relatedness.html
</p>


<h3>Examples</h3>

<pre><code class="language-R">pedsim_fp &lt;- system.file("extdata", "GBR.sim.seg.gz", package="skater", mustWork=TRUE)
pedsim_seg &lt;- read_ibd(pedsim_fp, source = "pedsim")
gmapfile &lt;- system.file("extdata", "sexspec-avg-min.plink.map", package="skater", mustWork=TRUE)
gmap &lt;- read_map(gmapfile)
ibd1_dat &lt;- ibd2kin(.ibd_data=pedsim_seg$IBD1, .map=gmap, type="IBD1")
ibd2_dat &lt;- ibd2kin(.ibd_data=pedsim_seg$IBD2, .map=gmap, type="IBD2")
dplyr::bind_rows(ibd1_dat,ibd2_dat) %&gt;%
  dplyr::group_by(id1,id2) %&gt;%
  dplyr::summarise(kinship = sum(kinship), .groups = "drop")

</code></pre>


</div>