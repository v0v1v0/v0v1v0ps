<div class="container">

<table style="width: 100%;"><tr>
<td>ggwr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalised geographically weighted regression</h2>

<h3>Description</h3>

<p>The function implements generalised geographically weighted regression approach
to exploring spatial non-stationarity for given global bandwidth and chosen
weighting scheme.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggwr(formula, data = list(), coords, bandwidth, gweight = gwr.Gauss,
 adapt = NULL, fit.points, family = gaussian, longlat = NULL, type = 
c("working", "deviance", "pearson", "response"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula as in <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>model data frame as in <code>glm</code>, or may be a SpatialPointsDataFrame or SpatialPolygonsDataFrame object as defined in package <span class="pkg">sp</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>matrix of coordinates of points representing the spatial
positions of the observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth used in the weighting function, possibly
calculated by <code>ggwr.sel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gweight</code></td>
<td>
<p>geographical weighting function, at present 
<code>gwr.Gauss()</code> default, or <code>gwr.gauss()</code>, the previous default or <code>gwr.bisquare()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>either NULL (default) or a proportion between 0 and 1 of observations to include in weighting scheme (k-nearest neighbours)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.points</code></td>
<td>
<p>an object containing the coordinates of fit points; often an object from package <span class="pkg">sp</span>; if missing, the coordinates given through the data argument object, or the coords argument are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model, see <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>TRUE if point coordinates are longitude-latitude decimal degrees, in which case distances are measured in kilometers; if x is a SpatialPoints object, the value is taken from the object itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of residuals which should be returned. The alternatives are: "working" (default), "pearson", "deviance" and "response"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class “gwr”:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SDF</code></td>
<td>
<p>a SpatialPointsDataFrame (may be gridded) or SpatialPolygonsDataFrame object (see package "sp") with fit.points, weights, GWR coefficient estimates, dispersion if a "quasi"-family is used, and the residuals of type "type" in its "data" slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhat</code></td>
<td>
<p>Leung et al. L matrix, here set to NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm</code></td>
<td>
<p>GLM global regression on the same model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>the bandwidth used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>this.call</code></td>
<td>
<p>the function call used.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The use of GWR on GLM is only at the initial proof of concept stage, nothing should be treated as an accepted method at this stage.
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Fotheringham, A.S., Brunsdon, C., and Charlton, M.E., 2002,
Geographically Weighted Regression, Chichester: Wiley;
<a href="http://gwr.nuim.ie/">http://gwr.nuim.ie/</a></p>


<h3>See Also</h3>

<p><code>ggwr.sel</code>, <code>gwr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">if (require(sf)) {
xx &lt;- as(st_read(system.file("shapes/sids.gpkg", package="spData")[1]), "Spatial")
bw &lt;- 144.4813
## Not run: 
bw &lt;- ggwr.sel(SID74 ~ I(NWBIR74/BIR74) + offset(log(BIR74)), data=xx,
  family=poisson(), longlat=TRUE)

## End(Not run)
nc &lt;- ggwr(SID74 ~ I(NWBIR74/BIR74) + offset(log(BIR74)), data=xx,
  family=poisson(), longlat=TRUE, bandwidth=bw)
nc
## Not run: 
nc &lt;- ggwr(SID74 ~ I(NWBIR74/10000) + offset(log(BIR74)), data=xx,
  family=poisson(), longlat=TRUE, bandwidth=bw)
nc
nc &lt;- ggwr(SID74 ~ I(NWBIR74/10000) + offset(log(BIR74)), data=xx,
  family=quasipoisson(), longlat=TRUE, bandwidth=bw)
nc

## End(Not run)
}
</code></pre>


</div>