<div class="container">

<table style="width: 100%;"><tr>
<td>Exam9.2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Example 9.2 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup (p-276)</h2>

<h3>Description</h3>

<p>Exam9.2 Two way random effects nested model
</p>


<h3>Author(s)</h3>


<ol>
<li>
<p>  Muhammad Yaseen (<a href="mailto:myaseen208@gmail.com">myaseen208@gmail.com</a>)
</p>
</li>
<li>
<p> Adeela Munawar (<a href="mailto:adeela.uaf@gmail.com">adeela.uaf@gmail.com</a>)
</p>
</li>
</ol>
<h3>References</h3>


<ol><li>
<p> Stroup, W. W. (2012).
<em>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications</em>.
CRC Press.
</p>
</li></ol>
<h3>See Also</h3>

<p><code>DataSet9.2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(DataSet9.2)
DataSet9.2$a &lt;- factor(x = DataSet9.2$a)
DataSet9.2$b &lt;- factor(x = DataSet9.2$b)

library(lmerTest)
Exam9.2lmer &lt;- lmer(y ~ (1|b/a), data = DataSet9.2)
summary(Exam9.2lmer)

Exam9.2lmer2 &lt;- lm(y ~ a + b %in% a, data = DataSet9.2)
summary(Exam9.2lmer2)

##--- Over all mean
library(phia)
list9.2 &lt;- list(a = c("1" = 1/7,"2" = 1/7
                    , "3" = 1/7,"4" = 1/7
                    , "5" = 1/7,"6" = 1/7
                    , "7" = 1/7
                     ))
phia::testFactors(model = Exam9.2lmer2, levels = list9.2)

#---BLUP Estimates
coef &lt;- unlist(ranef(Exam9.2lmer)$a)
BLUPa &lt;- NULL
for(i in 1:length(coef)){
  BLUPa[i] &lt;- (mean(DataSet9.2$y) + coef[i])
  }
print(BLUPa)

#---BLUP Estimates Narrow
BLUPaNar &lt;- NULL
for( i in 1:length(coef)) {
  BLUPaNar[i] &lt;- (mean(DataSet9.2$y) + coef[i])
}

BLUPaNar

</code></pre>


</div>