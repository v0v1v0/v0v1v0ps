<div class="container">

<table style="width: 100%;"><tr>
<td>rowMsquares</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rowwise Linear Trend Test Based on Tables</h2>

<h3>Description</h3>

<p>Given a set of matrices, each representing one group of subjects (e.g.,
cases and controls in a case-control study), that summarize the numbers 
of subjects showing the different levels of the categorical variables 
represented by the rows of the matrices, the value of the linear trend statistic
based on Pearson's correlation coefficient and described on page 87 of Agresti (2002)
is computed for each variable.
</p>
<p>Using this function instead of <code>rowTrendStats</code> is in particular recommended
when the total number of observations is very large.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rowMsquares(..., listTables = NULL, clScores = NULL, levScores = NULL,
   add.pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>numeric matrices in each of which each row corresponds to a ordinal variable
and each column to one of the ordered levels of these variables. Each of these matrices
represents one of the groups of interest and comprises the numbers of observations showing 
the respective levels at the different variables. These matrices can, e.g., generated by
employing <code>rowTables</code>. The dimensions of all matrices must be the same, and 
the rows and columns must represent the same variables and levels, respectively, in the 
same order in all matrices. The rowwise sums in a matrix are allowed to differ (which might
happen if some of the observations are missing for some of the variables.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listTables</code></td>
<td>
<p>instead of inputting the matrices directly,
a list consisting of these matrices can be generated and then be used in <code>rowMsquares</code> 
by specifying <code>listTables</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clScores</code></td>
<td>
<p>a numeric vector with one entry for each matrix specifying the score that should
be assigned to the corresponding group. If <code>NULL</code>, <code>clScores</code> is set to <code>1:m</code>,
where <code class="reqn">m</code> is the number of groups/matrices, such that the first input matrix (or the first
entry in <code>listTables</code>) gets a score of 1, the second a score of 2, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levScores</code></td>
<td>
<p>a numeric vector with one score for each level of the variables.If not specified, 
i.e.\ <code>NULL</code>, the column names of the matrices are interpreted as scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.pval</code></td>
<td>
<p>should p-values be added to the output? If <code>FALSE</code>, only the
rowwise values of the linear trend test statistic will be returned. If <code>TRUE</code>,
additionally the (raw) p-values based on an approximation to the ChiSquare-distribution
with 1 degree of freedom are returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an extension of the Cochran-Armitage trend test from two to several classes. The
statistic of the Cochran-Armitage trend test can be obtained by multiplying the statistic
of this general linear trend test with <code class="reqn">n / (n - 1)</code>, where <code class="reqn">n</code> is the number
of observations.
</p>


<h3>Value</h3>

<p>Either a vector containing the rowwise values of the linear trend test statistic
(if <code>add.pval = FALSE</code>), or a list containing these values (<code>stats</code>),
and the (raw) p-values (<code>rawp</code>) not adjusted for multiple comparisons (if <code>add.pval = TRUE</code>).
</p>


<h3>Note</h3>

<p>The usual contingency table for a variable can be obtained from the matrices
by forming a variable-specific matrix in which each row consists of the
row of one of these matrices.
</p>


<h3>Author(s)</h3>

<p>Holger Schwender, <a href="mailto:holger.schwender@udo.edu">holger.schwender@udo.edu</a></p>


<h3>References</h3>

 
<p>Agresti, A.\ (2002). <em>Categorical Data Analysis</em>. Wiley, Hoboken, NJ. 2nd Edition.
</p>
<p>Mantel, N.\ (1963). Chi-Square Test with one Degree of Freedom: Extensions of the Mantel-Haenszel
Procedure. <em>Journal of the American Statistical Association</em>, 58, 690-700.
</p>


<h3>See Also</h3>

<p><code>rowTrendStats</code>, <code>rowCATTs</code>, <code>rowChisqMultiClass</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Generate a matrix containing data for 10 categorical 
# variables with levels 1, 2, 3.

mat &lt;- matrix(sample(3, 500, TRUE), 10)

# Now assume that we consider a case-control study,
# i.e. two groups, and that the first 25 columns 
# of mat correspond to cases and the remaining 25 
# columns to cases. Then a vector containing the 
# class labels is given by

cl &lt;- rep(1:2, e=25)

# and the matrices summarizing the numbers of subjects
# showing the respective levels at the different variables
# are computed by

cases &lt;- rowTables(mat[, cl==1])
controls &lt;- rowTables(mat[,cl==2])

# The values of the rowwise liner trend test are
# computed by

rowMsquares(cases, controls)

# which leads to the same results as

listTab &lt;- list(cases, controls)
rowMsquares(listTables = listTab)

# or as

rowTrendStats(mat, cl, use.n = FALSE)

# or as

out &lt;- rowCATTs(cases, controls)
n &lt;- ncol(mat)
out$stats * (n - 1) / n

 
## End(Not run)
</code></pre>


</div>