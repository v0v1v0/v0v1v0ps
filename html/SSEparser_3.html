<div class="container">

<table style="width: 100%;"><tr>
<td>SSEparser</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parse a Server Sent Event</h2>

<h3>Description</h3>

<p>This class can help you parse a single server sent event or a stream of them.
You can inherit the class for a custom application.
The <code>parse_sse()</code> function wraps this class for a more <em>functional</em> approach.
</p>


<h3>Details</h3>

<p>The <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#server-sent-events">HTML specification</a>
tells us that event streams are composed by chunks (also called <em>blocks</em>, or <em>messages</em>) and lines.
A single new line character (<code style="white-space: pre;">⁠\n⁠</code>) states the end of a line, and two consecutive new line characters (<code style="white-space: pre;">⁠\n\n⁠</code>) state the end of a chunk.
</p>
<p>This means that, in practice, an event can be composed of one or more chunks, and a chunk can be composed of one or more lines.
</p>
<div class="sourceCode"><pre>data: This is the first chunk, it has one line

data: This is the second chunk
extra: It has two lines

data: This is the third chunk, it has an id field. This is common.
id: 123

: Lines that start with a colon are comments, they will be ignored
data: This is the forth chunk, it has a comment

data: This is the fifth chunk. Normally you will receive a data field
custom: But the server can send custom field names. SSEparser parses them too.

</pre></div>
<p>Typically, an event stream will send a single chunk for event, but it is important
to understand that event != chunk because <code>SSEparser$events</code> will be a list of
all the chunks received as it makes a more consistent output.
</p>


<h3>Value</h3>

<p>An object with R6 class <code>SSEparser</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>events</code></dt>
<dd>
<p>List  that contains all the events parsed. When the class is initialized, is just an empty list.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-SSEparser-append_parsed_sse"><code>SSEparser$append_parsed_sse()</code></a>
</p>
</li>
<li> <p><a href="#method-SSEparser-parse_sse"><code>SSEparser$parse_sse()</code></a>
</p>
</li>
<li> <p><a href="#method-SSEparser-new"><code>SSEparser$new()</code></a>
</p>
</li>
<li> <p><a href="#method-SSEparser-clone"><code>SSEparser$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-SSEparser-append_parsed_sse"></a>



<h4>Method <code>append_parsed_sse()</code>
</h4>

<p>Takes a parsed event and appends it to the <code>events</code> field. You can overwrite this method if you decide to extend this class.
</p>


<h5>Usage</h5>

<div class="r"><pre>SSEparser$append_parsed_sse(parsed_event)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>parsed_event</code></dt>
<dd>
<p>Event to append to the <code>events</code> field.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-SSEparser-parse_sse"></a>



<h4>Method <code>parse_sse()</code>
</h4>

<p>Takes a string that comes from a server sent event and parses it to an R list. You should never overwrite this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>SSEparser$parse_sse(event)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>event</code></dt>
<dd>
<p>A length 1 string containing a server sent event as specified in the <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#server-sent-events">HTML spec</a>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-SSEparser-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new SSE parser
</p>


<h5>Usage</h5>

<div class="r"><pre>SSEparser$new()</pre></div>


<hr>
<a id="method-SSEparser-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>SSEparser$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">example_event &lt;- 
"data: This is the first chunk, it has one line

data: This is the second chunk
extra: It has two lines

data: This is the third chunk, it has an id field. This is common.
id: 123

: Lines that start with a colon are comments, they will be ignored
data: This is the fourth chunk, it has a comment

data: This is the fifth chunk. Normally you will receive a data field
custom: But the server can send custom field names. SSEparser parses them too."
 
parser &lt;- SSEparser$new()
parser$parse_sse(example_event)
 
str(parser$events)

</code></pre>


</div>