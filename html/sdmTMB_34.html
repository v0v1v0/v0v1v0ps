<div class="container">

<table style="width: 100%;"><tr>
<td>make_mesh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct an SPDE mesh for sdmTMB</h2>

<h3>Description</h3>

<p>Construct an SPDE mesh for use with sdmTMB.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_mesh(
  data,
  xy_cols,
  type = c("kmeans", "cutoff", "cutoff_search"),
  cutoff,
  n_knots,
  seed = 42,
  mesh = NULL,
  fmesher_func = fmesher::fm_rcdt_2d_inla,
  convex = NULL,
  concave = convex,
  ...
)

## S3 method for class 'sdmTMBmesh'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy_cols</code></td>
<td>
<p>A character vector of x and y column names contained in
<code>data</code>. These should likely be in an equal distance projection. For
a helper function to convert to UTMs, see <code>add_utm_columns()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Method to create the mesh. Also see <code>mesh</code> argument to supply
your own mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>An optional cutoff if type is <code>"cutoff"</code>. The minimum allowed
triangle edge length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_knots</code></td>
<td>
<p>The number of desired knots if <code>type</code> is not <code>"cutoff"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed. Affects <code>stats::kmeans()</code> determination of knot
locations if <code>type = "kmeans"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>An optional mesh created via <span class="pkg">fmesher</span> instead of using the above
convenience options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmesher_func</code></td>
<td>
<p>Which <span class="pkg">fmesher</span> function to use. Options include
<code>fmesher::fm_rcdt_2d_inla()</code> and <code>fmesher::fm_mesh_2d_inla()</code> along with
version without the <code style="white-space: pre;">⁠_inla⁠</code> on the end.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convex</code></td>
<td>
<p>If specified, passed to <code>fmesher::fm_nonconvex_hull()</code>.
Distance to extend non-convex hull from data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concave</code></td>
<td>
<p>If specified, passed to <code>fmesher::fm_nonconvex_hull()</code>.
"Minimum allowed reentrant curvature". Defaults to <code>convex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to <code>graphics::plot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output from <code>make_mesh()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>make_mesh()</code>: A list of class <code>sdmTMBmesh</code>. The element <code>mesh</code> is the output
from <code>fmesher_func</code> (default is <code>fmesher::fm_mesh_2d_inla()</code>). See
<code>mesh$mesh$n</code> for the number of vertices.
</p>
<p><code>plot.sdmTMBmesh()</code>: A plot of the mesh and data points. If
<span class="pkg">ggplot2</span> is installed, a <span class="pkg">ggplot2</span> object is
returned, otherwise a base graphics R plot is returned. To make your own,
pass <code>your_mesh$mesh</code> to <code>inlabru::gg()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Extremely simple cutoff:
mesh &lt;- make_mesh(pcod, c("X", "Y"), cutoff = 5, type = "cutoff")
plot(mesh)

# Using a k-means algorithm to assign vertices:
mesh &lt;- make_mesh(pcod, c("X", "Y"), n_knots = 50, type = "kmeans")
plot(mesh)


# But, it's better to develop more tailored meshes:

# Pass arguments via '...' to fmesher::fm_mesh_2d_inla():
mesh &lt;- make_mesh(
  pcod, c("X", "Y"),
  fmesher_func = fmesher::fm_mesh_2d_inla,
  cutoff = 8, # minimum triangle edge length
  max.edge = c(20, 40), # inner and outer max triangle lengths
  offset = c(5, 40) # inner and outer border widths
)
plot(mesh)

# Or define a mesh directly with fmesher (formerly in INLA):
inla_mesh &lt;- fmesher::fm_mesh_2d_inla(
  loc = cbind(pcod$X, pcod$Y), # coordinates
  max.edge = c(25, 50), # max triangle edge length; inner and outer meshes
  offset = c(5, 25),  # inner and outer border widths
  cutoff = 5 # minimum triangle edge length
)
mesh &lt;- make_mesh(pcod, c("X", "Y"), mesh = inla_mesh)
plot(mesh)

</code></pre>


</div>