<div class="container">

<table style="width: 100%;"><tr>
<td>sprnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a spatial normal (Gaussian) random variable</h2>

<h3>Description</h3>

<p>Simulate a spatial normal (Gaussian) random variable with a specific
mean and covariance structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sprnorm(
  spcov_params,
  mean = 0,
  samples = 1,
  data,
  randcov_params,
  partition_factor,
  ...
)

## S3 method for class 'exponential'
sprnorm(
  spcov_params,
  mean = 0,
  samples = 1,
  data,
  randcov_params,
  partition_factor,
  xcoord,
  ycoord,
  ...
)

## S3 method for class 'none'
sprnorm(
  spcov_params,
  mean = 0,
  samples = 1,
  data,
  randcov_params,
  partition_factor,
  ...
)

## S3 method for class 'car'
sprnorm(
  spcov_params,
  mean = 0,
  samples = 1,
  data,
  randcov_params,
  partition_factor,
  W,
  row_st = TRUE,
  M,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spcov_params</code></td>
<td>
<p>An <code>spcov_params()</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>A numeric vector representing the mean. <code>mean</code> must have length 1
(in which case it is recycled) or length equal
to the number of rows in <code>data</code>. The default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>The number of independent samples to generate. The default
is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or <code>sf</code> object containing spatial information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randcov_params</code></td>
<td>
<p>A <code>randcov_params()</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partition_factor</code></td>
<td>
<p>A formula indicating the partition factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments. Not used (needed for generic consistency).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoord</code></td>
<td>
<p>Name of the column in <code>data</code> representing the x-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoord</code></td>
<td>
<p>Name of the column in <code>data</code> representing the y-coordinate.
Can be quoted or unquoted. Not required if <code>data</code> are an <code>sf</code>
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Weight matrix specifying the neighboring structure used for car and
sar models. Not required if <code>data</code> are an <code>sf</code>
polygon object and <code>W</code> should be calculated internally (using queen contiguity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_st</code></td>
<td>
<p>A logical indicating whether row standardization be performed on
<code>W</code>. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>M matrix satisfying the car symmetry condition. The car
symmetry condition states that <code class="reqn">(I - range * W)^{-1}M</code> is symmetric, where
<code class="reqn">I</code> is an identity matrix, <code class="reqn">range</code> is a constant that controls the
spatial dependence, <code>W</code> is the weights matrix,
and <code class="reqn">^{-1}</code> represents the inverse operator.
<code>M</code> is required for car models
when <code>W</code> is provided and <code>row_st</code> is <code>FALSE</code>.  When <code>M</code>,
is required, the default is the identity matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Random variables are simulated via the product of the covariance matrix's
square (Cholesky) root and independent standard normal random variables
with mean 0 and variance 1. Computing the square root is a significant
computational burden and likely unfeasible for sample sizes much past 10,000.
Because this square root only needs to be computed once, however, it is
nearly the sample computational cost to call <code>sprnorm()</code> for any value
of <code>samples</code>.
</p>
<p>Only methods for the <code>exponential</code>, <code>none</code>, and <code>car</code>
covariance functions are documented here,
but methods exist for all other spatial covariance functions defined in
<code>spcov_initial()</code>. Syntax for the <code>exponential</code> method is the same
as syntax for <code>spherical</code>, <code>gaussian</code>, <code>triangular</code>,
<code>circular</code>, <code>cubic</code>, <code>pentaspherical</code>, <code>cosine</code>, <code>wave</code>,
<code>jbessel</code>, <code>gravity</code>, <code>rquad</code>, <code>magnetic</code>, <code>matern</code>,
<code>cauchy</code>, and <code>pexponential</code> methods. Syntax for
the <code>car</code> method is the same as syntax for the <code>sar</code> method. The
<code>extra</code> parameter for car and sar models is ignored when all observations have
neighbors.
</p>


<h3>Value</h3>

<p>If <code>samples</code> is 1, a vector of random variables for each row of <code>data</code>
is returned. If <code>samples</code> is greater than one, a matrix of random variables
is returned, where the rows correspond to each row of <code>data</code> and the columns
correspond to independent samples.
</p>


<h3>Examples</h3>

<pre><code class="language-R">spcov_params_val &lt;- spcov_params("exponential", de = 1, ie = 1, range = 1)
sprnorm(spcov_params_val, data = caribou, xcoord = x, ycoord = y)
sprnorm(spcov_params_val, mean = 1:30, samples = 5, data = caribou, xcoord = x, ycoord = y)
</code></pre>


</div>