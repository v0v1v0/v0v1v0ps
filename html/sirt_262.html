<div class="container">

<table style="width: 100%;"><tr>
<td>polychoric2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Polychoric Correlation
</h2>

<h3>Description</h3>

<p>This function estimates the polychoric correlation coefficient
using maximum likelihood estimation (Olsson, 1979).
</p>


<h3>Usage</h3>

<pre><code class="language-R">polychoric2(dat, maxiter=100, cor.smooth=TRUE, use_pbv=1, conv=1e-10,
      rho_init=NULL, weights=NULL)

## exported Rcpp function
sirt_rcpp_polychoric2( dat, maxK, maxiter, use_pbv, conv, rho_init, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>A dataset with integer values <code class="reqn">0,1,\ldots,K</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.smooth</code></td>
<td>

<p>An optional logical indicating whether the polychoric correlation
matrix should be smooth to ensure positive definiteness.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_pbv</code></td>
<td>
<p>Integer indicating whether the <span class="pkg">pbv</span> package is used
for computation of bivariate normal distribution. <code>0</code> stands for
the simplest approximation in <span class="pkg">sirt</span> (Cox &amp; Wermuth, 1991, as
implemented in <code>polychoric2</code>)
while versions <code>1</code> and
<code>2</code> uses the algorithm of <span class="pkg">pbv</span> (the first one copied into
the <span class="pkg">sirt</span> package, the second one linking Rcpp code to <span class="pkg">pbv</span>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>Convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_init</code></td>
<td>
<p>Optional matrix of initial values for polychoric correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of sampling weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>Maximum number of categories</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Matrix of thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Polychoric correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nobs</code></td>
<td>
<p>Sample size for every item pair</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcat</code></td>
<td>
<p>Maximum number of categories per item</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cox, D. R., &amp; Wermuth, N. (1991). A simple approximation for bivariate and
trivariate normal integrals.
<em>International Statistical Review, 59</em>(2), 263-269.
</p>
<p>Olsson, U. (1979). Maximum likelihood estimation of the polychoric correlation
coefficient. <em>Psychometrika, 44</em>(4), 443-460.
<a href="https://doi.org/10.1007/BF02296207">doi:10.1007/BF02296207</a>
</p>


<h3>See Also</h3>

<p>See the <code>psych::polychoric</code>
function in the <span class="pkg">psych</span> package.
</p>
<p>For estimating tetrachoric correlations see <code>tetrachoric2</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: data.Students | activity scale
#############################################################################

data(data.Students, package="CDM")
dat &lt;- data.Students[, paste0("act", 1:5 ) ]

# tetrachoric correlation from psych package
library(psych)
t0 &lt;- psych::polychoric(dat)$rho
# Olsson method (maximum likelihood estimation)
t1 &lt;- sirt::polychoric2(dat)$rho
# maximum absolute difference
max( abs( t0 - t1 ) )
  ##   [1] 0.004102429
</code></pre>


</div>