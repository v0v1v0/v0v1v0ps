<div class="container">

<table style="width: 100%;"><tr>
<td>plot.sma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw an X-Y plot	</h2>

<h3>Description</h3>

<p>Plot a (standardized) major axis fit, including the data and the fitted lines. There are many options for 
changing the appearance of the plot and generating high-quality publishable graphs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sma'
plot(x, which = c("default", "residual", "qq"), 
	use.null = FALSE, add = FALSE, 	type = "o", xaxis = NULL, 
	yaxis = NULL, xlab = NULL, ylab = NULL, pch = NULL, 
	col = NULL, lty = NULL, from = NULL, to = NULL, 
	log = x$log, frame.plot = TRUE, tck=par("tck"), 
	p.lines.transparent = NA, axes = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class 'sma'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If 'residual', plots a residual plot; if 'qq', plots a qq plot; otherwise an x-y plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.null</code></td>
<td>
<p>Logical. If FALSE, plots the fitted lines (the default), otherwise those corresponding to the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical. If TRUE, adds lines or points to an existing plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>As in 'lm.default' : 'p' plots points only, 'l' only lines, and 'o' or 'b' plot both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis,yaxis</code></td>
<td>
<p>Special axis objects. See Details and examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>Labels for X and Y axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting symbols (see <code>points</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color of points and lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type (see <code>lines</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from,to</code></td>
<td>
<p>Min and max X values for the lines (defaults to values given by <code>sma</code>, which are the  
X values corresponding the maximum and minimum fitted values in the data.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>One of 'x','y' or 'xy', to denote which axes to log-scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn around the plot, by default = TRUE. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tck</code></td>
<td>
<p>The length of tick marks as a fraction of the smaller of the width or height of the plotting region. If tck &gt;= 0.5 it is interpreted as a fraction of the relevant side, so if tck = 1 grid lines are drawn. By default set to current system defaults (tck = par("tck")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.lines.transparent</code></td>
<td>
<p>Adjusts transparency level of fitted lines according to p-value of correlation between X and Y, via formula opacity = 1-p/p.lines.transparent). Setting to a value 0.1 means the line for any group with p = 0.1 would be fully transparent, while line for a group with p =0.05 would be 50 perecent transparent. by default set to NA, which means lines are fully visible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>If FALSE, suppress plotting of the axes (Default TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>plot.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plot.sma</code> function produces one of three different types of plot, depending on the <code>which</code> argument.
</p>
<p>The default plot, <code>which="default"</code>, produced a plot of <code>y</code> vs <code>x</code>, with separate symbols for each <code>group</code> if appropriate, and MA or SMA lines fitted through each group. The formula used in the <code>sma</code> object that is input to the <code>plot</code> function determines whether there is a group structure, whether fitted lines have common slope, etc.
</p>
<p>A residual plot can be obtained via <code>which="residual"</code> - this is a plot of residuals against fitted values. This can be used to check assumptions - if assumptions are satisfied there should be no pattern.
</p>
<p>A normal quantile plot can be obtained via <code>which="qq"</code> - this is a normal quantile plot of residuals. This can be used to check the normality assumption - if data are close to a straight line, normality is plausible. Note that non-normality is only important to the validity of the test in small samples. In larger samples, non-normality will not effect validity, but strong non-normality will reduce the power of tests.
</p>
<p>If <code>use.null=TRUE</code> then the lines added to the plot use the coefficients estimated under the null hypothesis. For example, if the sma object <code>x</code> was produced using a common slopes test (via <code>y~x*groups</code> or similar) then <code>use.null=TRUE</code> will plot lines that apply the common slope to each group.
</p>
<p>The arguments <code>pch</code>,  <code>col</code>,  <code>lty</code>,  <code>from &amp; to</code>, are used to modify characteristics of the plotted points and lines. If a vector of values for anyone of these arguments is passed to <code>plot.sma</code>, then successive values are applied to each group, provided group structure is included in <code>x</code> and the vector length is at least as long as the number of groups. 
</p>
<p>By default, <code>plot.sma</code> uses the default tick spacing given by <code>plot.default</code>. To customise axes, users can pass special axis objects to <code>plot.sma</code>, obtained using the <code>defineAxis</code> command as in the example below. This enables high quality publishable plots to be produced. See <code>plotutils</code> for more information.
</p>


<h3>Author(s)</h3>

<p> D. Falster, R.A. Duursma, D.I. Warton </p>


<h3>See Also</h3>

<p><code>sma</code>, <code>plotutils</code>, <code>defineAxis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load leaf lifetime dataset:
data(leaflife)

# Only consider low-nutrient sites:
leaf.low.soilp &lt;- subset(leaflife, soilp == 'low')

# Fit SMA's separately at each of high and low 
# rainfall sites and test for common slope:
ft &lt;- sma(longev~lma*rain, data=leaf.low.soilp, log="xy")

# Plot leaf longevity (longev) vs leaf mass per area (lma) 
# separately for each of high and low rainfall:
plot(ft)

# As before but add lines which have a common slope:
plot(ft, use.null=TRUE)

#As above, but adding the common slope lines to an existing plot
plot(ft, type='p', col="black")
plot(ft, use.null=TRUE, add=TRUE, type='l')

# Plot with equally spaced tick marks:
plot(ft, xaxis=defineAxis(major.ticks=c(40,80,160,320,640)), 
	yaxis=defineAxis(major.ticks=c(0.5,1,2,4,8)) )

# Produce a residual plot to check assumptions:
plot(ft,which="res")

# Produce a normal quantile plot:
plot(ft,which="qq")

</code></pre>


</div>