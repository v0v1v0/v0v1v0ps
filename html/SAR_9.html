<div class="container">

<table style="width: 100%;"><tr>
<td>rec_endpoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Azure product recommendations endpoint class</h2>

<h3>Description</h3>

<p>Class representing the client endpoint to the product recommendations service.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>rec_endpoint</code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a client endpoint object. See 'Initialization' for more details.
</p>
</li>
<li> <p><code>train_model(...)</code>: Train a new product recommendations model; return an object of class <code>rec_model</code>. See <code>Training</code> for more details.
</p>
</li>
<li> <p><code>get_model(description, id)</code>: Get an existing product recommendations model from either its description or ID; return an object of class <code>rec_model</code>.
</p>
</li>
<li> <p><code>delete_model(description, id)</code>: Delete the specified model.
</p>
</li>
<li> <p><code>upload_data(data, destfile)</code>: Upload a data frame to the endpoint, as a CSV file. By default, the name of the uploaded file will be the name of the data frame with a ".csv" extension.
</p>
</li>
<li> <p><code>upload_csv(srcfile, destfile)</code>: Upload a CSV file to the endpoint. By default, the name of the uploaded file will be the same as the source file.
</p>
</li>
<li> <p><code>sync_model_list()</code>: Update the stored list of models for this service.
</p>
</li>
<li> <p><code>get_swagger_url()</code>: Get the Swagger URL for this service.
</p>
</li>
<li> <p><code>get_service_url()</code>: Get the service URL, which is used to train models and obtain recommendations.
</p>
</li>
</ul>
<h3>Initialization</h3>

<p>The following arguments are used to initialize a new client endpoint:
</p>

<ul>
<li> <p><code>name</code>: The name of the endpoint; see below. Alternatively, this can also be the full URL of the endpoint.
</p>
</li>
<li> <p><code>admin_key</code>: The administration key for the endpoint. Use this to retrieve, train, and delete models.
</p>
</li>
<li> <p><code>rec_key</code>: The recommender key for the endpoint. Use this to get recommendations.
</p>
</li>
<li> <p><code>service_host</code>: The hostname for the endpoint. For the public Azure cloud, this is <code>azurewebsites.net</code>.
</p>
</li>
<li> <p><code>storage_key</code>: The access key for the storage account associated with the service.
</p>
</li>
<li> <p><code>storage_sas</code>: A shared access signature (SAS) for the storage account associated with the service. You must provide either <code>storage_key</code> or <code>storage_sas</code> if you want to upload new datasets to the backend.
</p>
</li>
<li> <p><code>storage_host</code>: The hostname for the storage account. For the public Azure cloud, this is <code>core.windows.net</code>.
</p>
</li>
<li> <p><code>storage_endpoint</code>: The storage account endpoint for the service. By default, uses the account that was created at service creation.
</p>
</li>
<li> <p><code>data_container</code>: The default blob container for input datasets. Defaults to <code>"inputdata"</code>.
</p>
</li>
</ul>
<p>Note that the name of the client endpoint for a product recommendations service is <em>not</em> the name that was supplied when deploying the service. Instead, it is a randomly generated unique string that starts with the service name. For example, if you deployed a service called "myrec", the name of the endpoint is "myrecusacvjwpk4raost".
</p>


<h3>Training</h3>

<p>To train a new model, supply the following arguments to the <code>train_model</code> method:
</p>

<ul>
<li> <p><code>description</code>: A character string describing the model.
</p>
</li>
<li> <p><code>usage_data</code>: The training dataset. This is required.
</p>
</li>
<li> <p><code>catalog_data</code>: An optional dataset giving features for each item. Only used for imputing cold items.
</p>
</li>
<li> <p><code>eval_data</code>: An optional dataset to use for evaluating model performance.
</p>
</li>
<li> <p><code>support_threshold</code>: The minimum support for an item to be considered warm.
</p>
</li>
<li> <p><code>cooccurrence</code>: How to measure cooccurrence: either user ID, or user-by-time.
</p>
</li>
<li> <p><code>similarity</code>: The similarity metric to use; defaults to "Jaccard".
</p>
</li>
<li> <p><code>cold_items</code>: Whether recommendations should include cold items.
</p>
</li>
<li> <p><code>cold_to_cold</code>: Whether similarities between cold items should be computed.
</p>
</li>
<li> <p><code>user_affinity</code>: Whether event type and time should be considered.
</p>
</li>
<li> <p><code>include_seed_items</code>: Whether seed items (those already seen by a user) should be allowed as recommendations.
</p>
</li>
<li> <p><code>half_life</code>: The time decay parameter for computing user-item affinities.
</p>
</li>
<li> <p><code>user_to_items</code>: Whether user ID is used when computing personalised recommendations.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the model has finished training.
</p>
</li>
<li> <p><code>container</code>: The container where the input datasets are stored. Defaults to the input container for the endpoint, usually <code>"inputdata"</code>.
</p>
</li>
</ul>
<p>For detailed information on these arguments see the <a href="https://github.com/Microsoft/Product-Recommendations/blob/master/doc/api-reference.md#train-a-new-model">API reference</a>.
</p>


<h3>See Also</h3>

<p>az_rec_service for the service itself, rec_model for an individual recommmendations model
</p>
<p><a href="https://github.com/Microsoft/Product-Recommendations/blob/master/doc/api-reference.md">API reference</a> and <a href="https://github.com/Microsoft/Product-Recommendations/blob/master/doc/sar.md">SAR model description</a> at the Product Recommendations API repo on GitHub
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# creating a recommendations service endpoint from an Azure resource
svc &lt;- resgroup$get_rec_service("myrec")
rec_endp &lt;- svc$get_rec_endpoint()

# creating the endpoint from scratch -- must supply admin, recommender and storage keys
rec_endp &lt;- rec_endpoint$new("myrecusacvjwpk4raost",
    admin_key="key1", rec_key="key2", storage_key="key3")

# upload the Microsoft store data
data(ms_usage)
rec_endp$upload_data(ms_usage)

# train a recommender
rec_model &lt;- rec_endp$train_model("model1", usage="ms_usage.csv", support_threshold=10,
    similarity="Jaccard", user_affinity=TRUE, user_to_items=TRUE,
    backfill=TRUE, include_seed_items=FALSE)

# list of trained models
rec_endp$sync_model_list()

# delete the trained model (will ask for confirmation)
rec_endp$delete_model("model1")


## End(Not run)
</code></pre>


</div>