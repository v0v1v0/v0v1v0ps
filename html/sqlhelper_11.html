<div class="container">

<table style="width: 100%;"><tr>
<td>read_sql</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read a sql file and return it's contents as a tibble</h2>

<h3>Description</h3>

<p>Read a sql file and return it's contents as a tibble
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_sql(file_name, cascade = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file_name</code></td>
<td>
<p>Full name and path of a file to read</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cascade</code></td>
<td>
<p>Parameters for executing each query may be specified as
comments in the SQL file. If <code>cascade=TRUE</code>, execution parameters specified
in the file will be cascaded to subsequent queries where that parameter is
not specified. This enables you to set a parameter (e.g. the connection
name) once, for the first query in a file, and use it for all the
subsequent queries.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiple SQL queries in files should be terminated by semi-colons
(<code style="white-space: pre;">⁠;⁠</code>), as usual.
</p>
<p>The values of <code>qname</code>, <code>quotesql</code>, <code>interpolate</code>, <code>execmethod</code>, <code>geometry</code>,
and <code>conn_name</code> in the output may be specified with comments immediately
preceding each query (see examples).
</p>
<p>With the exception of <code>qname</code>, the value of each interpreted comment is
cascaded to subsequent queries (assuming <code>cascade=TRUE</code>). This means you
may set values once for the first query in the file and they will apply to
all the queries thereafter.
</p>
<p>See <code>run_queries()</code> for the implications of setting execution parameters.
See <code>prepare_sql()</code> for the treatment of missing values in the output and
their defaults. The article <code>vignette("execution")</code> has further examples of
using these parameters to control execution.
</p>


<h3>Value</h3>

<p>A tibble containing 1 row per query with the following fields:
</p>

<dl>
<dt>qname</dt>
<dd>
<p>character. A name for this query</p>
</dd>
<dt>quotesql</dt>
<dd>
<p>"yes" or "no". Should parameterized character values be quoted for this query?</p>
</dd>
<dt>interpolate</dt>
<dd>
<p>"yes" or "no". Should this query be parameterized with values from R?</p>
</dd>
<dt>execmethod</dt>
<dd>
<p>The method to execute this query.
One of "get" (<code>DBI::dbGetQuery()</code>), "execute" (<code>DBI::dbExecute()</code>), "sendq" (<code>DBI::dbSendQuery()</code>), "sends" (<code>DBI::dbSendStatement()</code>) or "spatial" (<code>sf::st_read()</code>)</p>
</dd>
<dt>geometry</dt>
<dd>
<p>character. If <code>execmethod</code> is "spatial", which is the geometry column?</p>
</dd>
<dt>conn_name</dt>
<dd>
<p>character. The name of the database connection to use for this query.
Must be the name of a configured sqlhelper connection.</p>
</dd>
<dt>sql</dt>
<dd>
<p>The sql query to be executed</p>
</dd>
<dt>filename</dt>
<dd>
<p>The value of <code>file_name</code></p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
library(sqlhelper)

fn &lt;- system.file( "examples/read_sql_execution_params.SQL",
                   package="sqlhelper" )
readLines( fn ) |&gt; writeLines()

sql_tibble &lt;- read_sql(fn)
sql_tibble
sql_tibble$sql

fn &lt;- system.file( "examples/read_sql_comments.SQL", package="sqlhelper" )
readLines( fn ) |&gt; writeLines()

sql_tibble &lt;- read_sql(fn)
sql_tibble
sql_tibble$sql

</code></pre>


</div>