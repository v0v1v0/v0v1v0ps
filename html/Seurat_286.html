<div class="container">

<table style="width: 100%;"><tr>
<td>PrepSCTFindMarkers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare object to run differential expression on SCT assay with multiple models</h2>

<h3>Description</h3>

<p>Given a merged object with multiple SCT models, this function uses minimum
of the median UMI (calculated using the raw UMI counts) of individual objects
to reverse the individual SCT regression model using minimum of median UMI
as the sequencing depth covariate.
The counts slot of the SCT assay is replaced with recorrected counts and
the data slot is replaced with log1p of recorrected counts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PrepSCTFindMarkers(object, assay = "SCT", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object with SCT assays</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Assay name where for SCT objects are stored; Default is 'SCT'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print messages and progress</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a Seurat object with recorrected counts and data in the SCT assay.
</p>


<h3>Progress Updates with <span class="pkg">progressr</span>
</h3>

<p>This function uses
<a href="https://cran.r-project.org/package=progressr"><span class="pkg">progressr</span></a> to
render status updates and progress bars. To enable progress updates, wrap
the function call in <code>with_progress</code> or run
<code>handlers(global = TRUE)</code> before running
this function. For more details about <span class="pkg">progressr</span>, please read
<a href="https://progressr.futureverse.org/articles/progressr-intro.html"><code>vignette("progressr-intro")</code></a>
</p>


<h3>Parallelization with <span class="pkg">future</span>
</h3>

<p>This function uses
<a href="https://cran.r-project.org/package=future"><span class="pkg">future</span></a> to enable
parallelization. Parallelization strategies can be set using
<code>plan</code>. Common plans include “<code>sequential</code>”
for non-parallelized processing or “<code>multisession</code>” for parallel
evaluation using multiple <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> sessions; for other plans, see the
“Implemented evaluation strategies” section of
<code>?future::plan</code>. For a more thorough introduction
to <span class="pkg">future</span>, see
<a href="https://future.futureverse.org/articles/future-1-overview.html"><code>vignette("future-1-overview")</code></a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("pbmc_small")
pbmc_small1 &lt;- SCTransform(object = pbmc_small, variable.features.n = 20, vst.flavor="v1")
pbmc_small2 &lt;- SCTransform(object = pbmc_small, variable.features.n = 20, vst.flavor="v1")
pbmc_merged &lt;- merge(x = pbmc_small1, y = pbmc_small2)
pbmc_merged &lt;- PrepSCTFindMarkers(object = pbmc_merged)
markers &lt;- FindMarkers(
  object = pbmc_merged,
  ident.1 = "0",
  ident.2 = "1",
  assay = "SCT"
)
pbmc_subset &lt;- subset(pbmc_merged, idents = c("0", "1"))
markers_subset &lt;- FindMarkers(
  object = pbmc_subset,
  ident.1 = "0",
  ident.2 = "1",
  assay = "SCT",
  recorrect_umi = FALSE
)

</code></pre>


</div>