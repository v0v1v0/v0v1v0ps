<div class="container">

<table style="width: 100%;"><tr>
<td>structurogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Structure Function for Non-Gridded Spatial Fields.
</h2>

<h3>Description</h3>

<p>Computes pairwise differences (raised to the q-th power) as a function of distance.  Returns either raw values or statistics from binning.
</p>


<h3>Usage</h3>

<pre><code class="language-R">structurogram(loc, y, q = 2, id = NULL, d = NULL, lon.lat = FALSE, dmax = NULL,
    N = NULL, breaks = NULL)

## S3 method for class 'structurogram'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>

<p>numeric matrix where each row is the coordinate of a point in the field.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>list object returned by <code>structurogram</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>numeric vector giving the value of the field at each location.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>numeric giving the value to which the paired differences should be raised.  Default (q=2) gives the usual semivariogram.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>A 2 column matrix that specifies which variogram differnces to find.  If omitted all possible pairings are found.  This can used if the data has an additional covariate that determines proximity, for example a time window.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>numeric matrix giving the distances among pairs (indexed by <code>id</code>).  If not included, these are determined directly from <code>loc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon.lat</code></td>
<td>

<p>logical, are the coordinates longitude/latitude coordinates?  If so, distances are found using great-circle distance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmax</code></td>
<td>

<p>numeric giving the maximum distance for which to compute the structure function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>numeric giving the number of bins to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>numeric vector giving bin boundaries for binning structure function values.  Need not be equally spaced, but must be ordered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to plot function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is basically an exact copy of <code>vgram</code> from package <span class="pkg">fields</span> whereby the differences are raised to a power of q instead of 2.  That is, it calculates the structure function given by Eq (4) in harris et al. (2001).  Namely,
</p>
<p>S_q(l_x,l_y) = &lt;|R(x+l_x,y+l_y) - R(x,y)|^q&gt;
</p>
<p>where R is the field of interest, &lt;&gt; denotes the average over pixels in the image (note, in Harris et al. (2001), this is only over non-zero pixels, so is only equivalent to this equation if zero-valued points are first removed from y and loc), l_x and l_y are lags in the x and y directions, resp.  If q=2, then this is the semivariogram.
</p>
<p>The <code>plot</code> method function plots the structure by separation distance (circles) along with a dark blue line giving the bin centers.
</p>


<h3>Value</h3>

<p>A list object of class “structurogram” is returned with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>d </code></td>
<td>
<p>numeric vector giving the pair-wise distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val </code></td>
<td>
<p>numeric vector giving the structure function values for each distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>numeric giving the value of q passed into the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Calling string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>Matrix of statistics for values in each bin.  Rows are the summaries returned by the stats function or describe (see package fields).  If either breaks or N arguments are not supplied then this component is not computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>numeric vector giving the bin centers.</p>
</td>
</tr>
</table>
<p>The plot method function does not return anything.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Harris, D., Foufoula-Georgiou, E., Droegemeier, K. K. and Levit, J. J. (2001)  Multiscale statistical properties of a high-resolution precipitation forecast.  <em>J. Hydrometeorol.</em>, <b>2</b>, 406–418.
</p>


<h3>See Also</h3>

<p><code>vgram</code>, <code>vgram.matrix</code>, <code>structurogram.matrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( ozone2)
good&lt;- !is.na(ozone2$y[16,])
x&lt;- ozone2$lon.lat[good,] 
y&lt;- ozone2$y[16,good]
     
look &lt;- structurogram( x,y, N=15, lon.lat=TRUE)
plot(look)
# Compare above with results from example for function vgram from package fields.

look &lt;- structurogram( x,y, N=15, lon.lat=TRUE, q=1)
plot(look)

</code></pre>


</div>