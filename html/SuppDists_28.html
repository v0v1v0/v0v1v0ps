<div class="container">

<table style="width: 100%;"><tr>
<td>NormalScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal Scores distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, random generator and summary function for the normal scores test. A function to calculate expected values of normal order statistics is included.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dNormScore(x, c, N, U, log=FALSE)
pNormScore(q, c, N, U, lower.tail=TRUE, log.p=FALSE)
qNormScore(p, c, N, U, lower.tail=TRUE, log.p=FALSE)
rNormScore(n, c, N, U)
sNormScore(c, N, U)
normOrder(N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>vector of non-negative quantities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of values to generate. If n is a vector, length(n) values will be generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>vector number of treatments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>vector total number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>vector sum of reciprocals of the number of the c sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical vector; if TRUE, probabilities p are given as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical vector; if TRUE (default), probabilities are <code class="reqn">P[X &lt;= x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the Kruskal-Wallis statistic with ranks replaced by the expected values of normal order statistics. There are c treatments with sample sizes <code class="reqn">n_j, j=1 \dots c</code>. The total sample size is <code class="reqn">N=\sum_1^c n_j</code>. The distribution depends on c, N, and U, where <code class="reqn">U=\sum_1^c (1/n_j)</code>. 
</p>
<p>Let <code class="reqn">e_N(k)</code> be the expected value of the <code class="reqn">k_{th}</code> smallest observation in a sample of N independent normal variates. Rank all observations together, and let <code class="reqn">R_{ij}</code> denote the rank of observation <code class="reqn">X_{ij}</code>, <code class="reqn">i=1 \dots n_j</code> for treatment <code class="reqn">j=1 \dots c</code>, then the normal scores test statistic is
</p>
<p style="text-align: center;"><code class="reqn">x=(N-1)\frac{1}{\sum_{k=1}^{N} e_N(k)^2} \sum_{j=1}^{c}\frac{S_j^2}{n_j}</code>
</p>

<p>where <code class="reqn">S_j=\sum_{i=1}^{n_j}(e_N(R_{ij}))</code>.
</p>
<p>See Lu and Smith (1979) for a thorough discussion and some exact tables for small r and n.  The calculations made here use an incomplete beta approximation – the same one used for Kruskal-Wallis, only differing in the calculation of the variance of the statistic.
</p>
<p>The expected values of the normal order statistics use a modification of M.Maechler's C version of the Fortran algorithm given by Royston (1982). Spot checking the values against Harter (1969) confirms the accuracy to 4 decimal places as claimed by Royston.
</p>


<h3>Value</h3>

<p>The output values conform to the output from other such functions in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. <code>dNormScore()</code> gives the density, <code>pNormScore()</code> the distribution function and <code>qNormScore()</code> its inverse. <code>rNormScore()</code> generates random numbers. <code>sNormScore()</code> produces a list containing parameters corresponding to the arguments – mean, median, mode, variance, sd, third cental moment, fourth central moment, Pearson's skewness, skewness, and kurtosis. <code>normOrder()</code> gives the expected values of the normal order statistics for a sample of size N.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler 
</p>


<h3>References</h3>

<p>Harter, H.L. (1969). <em>Order statistics and their use in testing and estimation, volume 2.</em> U.S. Supp. of Doc. 
</p>
<p>Lu, H.T. and Smith, P.J. (1979) Distribution of normal scores statistic for nonparametric one-way analysis of variance. <em>Jour. Am Stat. Assoc.</em> <b>74.</b> 715-722.
</p>
<p>Royston, J.P. (1982). Expected normal order statistics (exact and approximate) AS 177. <em>Applied Statistics.</em> <b>31.</b> 161-165. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Assuming three treatments, each with a sample size of 5
pNormScore(2, 3, 15, 0.6)
pNormScore(c(0.11,1.5,5.6), 3, 15, 0.6) ## approximately 5% 50% and 95%
sNormScore(3, 15, 0.6)
plot(function(x)dNormScore(x,c=5, N=15, U=0.6),0,5)

</code></pre>


</div>