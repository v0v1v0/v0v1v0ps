<div class="container">

<table style="width: 100%;"><tr>
<td>modele</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create a compositional model for simulations
</h2>

<h3>Description</h3>

<p> These functions create and plot a model of compositionnal
data for two or more conditions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">modele_compo( medianes, en.log = FALSE,
              noms = colnames( medianes ),
              conditions = rownames( medianes ),
              reference = NULL, total = 1 )

## S3 method for class 'SARPcompo.modele'
plot( x,
     xlab = "Composant",
     ylab.absolu = "Quantit\u00e9", ylab.relatif = "Fraction",
     taille.noeud = 50, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>medianes</code></td>
<td>
<p> A matrix giving the medians of all components
quantities in each condition. Each row of this matrix corresponds to
a different condition; each column, to one of the components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en.log</code></td>
<td>
<p>If <code>TRUE</code>, the values in the matrix are given in
the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noms</code></td>
<td>
<p>Names of the components. If provided, should be a
character vector whose length is equal to the number of columns of
<code>medianes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditions</code></td>
<td>
<p>Names of the different conditions. If provided,
should be a character vector whose length is equal to the number of
rows of <code>medianes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>A character vector giving the names of the components
used as reference (typically, reference genes in qRT-PCR).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>The total amount. The sum of amounts in each condition
will equal this total, when the data are made compositionnal.</p>
</td>
</tr>
</table>
<p>Arguments for the plot method
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The modele to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Legend for the X axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.absolu</code></td>
<td>
<p>Legend for the Y axis, in the amount scale (no
constrain)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.relatif</code></td>
<td>
<p>Legend for the Y axis, in the compositional
scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taille.noeud</code></td>
<td>
<p>The plot size of nodes of the theoretical graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additionnal parameters for <code>plot</code>,
which is used internally.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The <code>modele_compo</code> function creates a compositionnal data
model using the quantites provided: it converts amounts in fractions
of the total amount for each condition, then computes the theoretical
graph showing classes of equivalents components, that is components
that have the same evolution between the two conditions.  If more than two
conditions are given, graphs correspond to comparison of each
condition with the first one.
</p>
<p>The <code>plot</code> methods represents the original quantities, the
quantities after conversion in compositional data ant the theoretical
graph.
</p>


<h3>Value</h3>

<p> An object of class <code>SARPcompo.modele</code>, with a plot
method. It is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Absolue</code></td>
<td>
<p>The matrix of quantities in amount scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Relative</code></td>
<td>
<p>The matrix of quantities in compositional data scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graphes</code></td>
<td>
<p>A list of length <code>nrow(medianes) - 1</code>. Each
element of the list gives, for the corresponding condition, the
matrix of all ratios of pairwise ratios between condition and the
first condition (element <code>M.rapports</code>), the corresponding
connectivity matrix (element <code>M.connexion</code>), the graph of
component changes compared to the first condition (element
<code>Graphe</code>, an igraph object) and the list of components of this
graph (element <code>Connexe</code>, obtained from the
<code>components</code> function.</p>
</td>
</tr>
</table>
<p>It also stores a few informations as attributes.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>estimer.puissance</code> and <code>estimer.alpha</code> to use
these models in simulations to study power and type I error of the
method in a given situation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Create a toy example: four components, two conditions
  ##  components 1 and 2 do not change between conditions
  ##  component  3 is doubled
  ##  component  4 is halfed
  me &lt;- rbind( 'A' = c( 1, 1, 1, 1 ),
               'B' = c( 1, 1, 2, 0.5 ) )
  colnames( me ) &lt;- paste0( "C-", 1:4 )

  md &lt;- modele_compo( me )

  ## Plot it...
  plot( md )

  ## What is approximately the power to detect that something changes
  ## between conditions A and B using a Student test
  ## with a CV of around 50 % ?
  ##  (only a few simulations for speed, should be increased )
  puissance &lt;- estimer.puissance( md, cv = 0.50, B = 50, f.p = student.fpc )
  plot( puissance )
</code></pre>


</div>