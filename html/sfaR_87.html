<div class="container">

<table style="width: 100%;"><tr>
<td>vcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute variance-covariance matrix of stochastic frontier models</h2>

<h3>Description</h3>

<p><code>vcov</code> computes the variance-covariance matrix of the maximum
likelihood (ML) coefficients from stochastic frontier models estimated with
<code>sfacross</code>, <code>sfalcmcross</code>,
or <code>sfaselectioncross</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sfacross'
vcov(object, extraPar = FALSE, ...)

## S3 method for class 'sfalcmcross'
vcov(object, ...)

## S3 method for class 'sfaselectioncross'
vcov(object, extraPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A stochastic frontier model returned
by <code>sfacross</code>, <code>sfalcmcross</code>, or
<code>sfaselectioncross</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraPar</code></td>
<td>
<p>Logical. Only available for non heteroscedastic models
returned by <code>sfacross</code> and <code>sfaselectioncross</code>.
Default = <code>FALSE</code>. If <code>TRUE</code>, variances and covariances of
additional parameters are returned:
</p>
<p><code>sigmaSq</code> = <code>sigmauSq</code> + <code>sigmavSq</code>
</p>
<p><code>lambdaSq</code> = <code>sigmauSq</code>/<code>sigmavSq</code>
</p>
<p><code>sigmauSq</code> = <code class="reqn">\exp{(Wu)}</code> = <code class="reqn">\exp{(\bm{\delta} \mathbf{Z}_u)}</code>
</p>
<p><code>sigmavSq</code> = <code class="reqn">\exp{(Wv)}</code> = <code class="reqn">\exp{(\bm{\phi} \mathbf{Z}_v)}</code>
</p>
<p><code>sigma</code> = <code>sigmaSq</code>^0.5
</p>
<p><code>lambda</code> = <code>lambdaSq</code>^0.5
</p>
<p><code>sigmau</code> = <code>sigmauSq</code>^0.5
</p>
<p><code>sigmav</code> = <code>sigmavSq</code>^0.5
</p>
<p><code>gamma</code> = <code>sigmauSq</code>/(<code>sigmauSq</code> + <code>sigmavSq</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variance-covariance matrix is obtained by the inversion of the
negative Hessian matrix. Depending on the distribution and the
<code>'hessianType'</code> option, the analytical/numeric Hessian or the bhhh
Hessian is evaluated.
</p>
<p>The argument <code>extraPar</code>, is currently available only for objects of class
<code>'sfacross'</code> and <code>'sfaselectioncross'</code>. When
<code>'extraPar = TRUE'</code>, the variance-covariance of the additional
parameters is obtained using the delta method.
</p>


<h3>Value</h3>

<p>The variance-covariance matrix of the maximum likelihood
coefficients is returned.
</p>


<h3>See Also</h3>

<p><code>sfacross</code>, for the stochastic frontier analysis model
fitting function using cross-sectional or pooled data.
</p>
<p><code>sfalcmcross</code>, for the latent class stochastic frontier analysis
model fitting function using cross-sectional or pooled data.
</p>
<p><code>sfaselectioncross</code> for sample selection in stochastic frontier
model fitting function using cross-sectional data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Using data on Spanish dairy farms
# Cobb Douglas (production function) half normal distribution
cb_s_h &lt;- sfacross(formula = YIT ~ X1 + X2 + X3 + X4, udist = 'hnormal',
data = dairyspain, S = 1, method = 'bfgs')
vcov(cb_s_h)
vcov(cb_s_h, extraPar = TRUE)
 
# Other variance-covariance matrices can be obtained using the sandwich package
 
# Robust variance-covariance matrix
 
requireNamespace('sandwich', quietly = TRUE)
 
sandwich::vcovCL(cb_s_h)
 
# Coefficients and standard errors can be obtained using lmtest package
 
requireNamespace('lmtest', quietly = TRUE)
 
lmtest::coeftest(cb_s_h, vcov. = sandwich::vcovCL)
 
# Clustered standard errors
 
lmtest::coeftest(cb_s_h, vcov. = sandwich::vcovCL, cluster = ~ FARM)
 
# Doubly clustered standard errors
 
lmtest::coeftest(cb_s_h, vcov. = sandwich::vcovCL, cluster = ~ FARM + YEAR)
 
# BHHH standard errors
 
lmtest::coeftest(cb_s_h, vcov. = sandwich::vcovOPG)
 
# Adjusted BHHH standard errors
 
lmtest::coeftest(cb_s_h, vcov. = sandwich::vcovOPG, adjust = TRUE)

## Using data on eighty-two countries production (GDP)
# LCM Cobb Douglas (production function) half normal distribution
cb_2c_h &lt;- sfalcmcross(formula = ly ~ lk + ll + yr, udist = 'hnormal',
data = worldprod, uhet = ~ initStat, S = 1)
vcov(cb_2c_h)

</code></pre>


</div>