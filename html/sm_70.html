<div class="container">

<table style="width: 100%;"><tr>
<td>sm.discontinuity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The detection of discontinuities in a regression curve or surface.
</h2>

<h3>Description</h3>

<p>This function uses a comparison of left and right handed nonparametric 
regression curves to assess the evidence for the presence of one or
more discontinuities in a regression curve or surface.  A hypothesis
test is carried out, under the assumption that the errors in the data 
are approximately normally distributed.  A graphical indication of the 
locations where the evidence for a discontinuity is strongest is also
available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sm.discontinuity(x, y, h, hd, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector or two-column matrix of covariate values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of responses observed at the covariate locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>a smoothing parameter to be used in the construction of the nonparametric
regression estimates.  A normal kernel
function is used and <code>h</code> is its standard deviation(s).  However, if
this argument is omitted <code>h</code> will be selected by an approximate
degrees of freedom criterion, controlled by the <code>df</code> parameter.
See <code>sm.options</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>

<p>a smoothing parameter to be used in smoothing the differences of the
left and right sided nonparametric regression estimates.  A normal kernel
function is used and <code>hd</code> is its standard deviation(s).  However, if
this argument is omitted <code>hd</code> will be set to <code>h * sqrt(0.25)</code>, and
<code>h</code> reset to <code>h * sqrt(0.75)</code>, when <code>x</code> is a vector
When <code>x</code> is a matrix, <code>hd</code> will be set to <code>h * sqrt(0.5)</code>
and <code>h</code> will be reset to the same value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code>
function, through a mechanism which limits their effect only to this
call of the function; those relevant for this function are 
<code>add</code>,
<code>eval.points</code>, 
<code>ngrid</code>, 
<code>se</code>, 
<code>band</code>,
<code>xlab</code>, 
<code>ylab</code>, 
<code>xlim</code>, 
<code>ylim</code>, 
<code>lty</code>,
<code>col</code>;
see the documentation of  <code>sm.options</code> for their
description.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The reference below describes the statistical methods used in the function.
There are minor differences in some computational details of the implementation.
</p>
<p>Currently duplicated rows of <code>x</code> cause a difficulty in the two covariate case.  Duplicated rows should be removed.
</p>


<h3>Value</h3>

<p>a list containing the following items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p-value for the test of the null hypothesis that no
discontinuities are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated standard deviation of the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval.points</code></td>
<td>
<p>the evaluation points of the nonparametric
regression estimates.  When <code>x</code> is a matrix, 
<code>eval.points</code> is also a matrix whose columns
define the evaluation grid of each margin of the 
evaluation rectangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st.diff</code></td>
<td>
<p>a vector or matrix of standardised differences
between the left and right sided estimators at the 
evaluation points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffmat</code></td>
<td>
<p>when <code>x</code> is a vector, this contains the
locations and standardised differences where the latter
are greater than 2.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>when <code>x</code> is a matrix, this contains the estimated 
angles at which the standardised differences were constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the principal smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>
<p>the smoothing parameter used for double-smoothing (see the
reference below).</p>
</td>
</tr>
</table>
<h3>Side Effects</h3>

<p>a plot on the current graphical device is produced, unless the option 
<code>display="none"</code> is set.  
</p>


<h3>References</h3>

<p>Bowman, A.W., Pope, A. and Ismail, B. (2006).
Detecting discontinuities in nonparametric regression curves and
surfaces.
<em>Statistics &amp; Computing</em>, 16, 377â€“390.
</p>


<h3>See Also</h3>

<p><code>sm.regression</code>, <code>sm.options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">par(mfrow = c(3, 2))

with(nile, {
   sm.discontinuity(Year, Volume, hd = 0)
   sm.discontinuity(Year, Volume)

   ind &lt;- (Year &gt; 1898)
   plot(Year, Volume)
   h &lt;- h.select(Year, Volume)
   sm.regression(Year[!ind], Volume[!ind], h, add = TRUE)
   sm.regression(Year[ ind], Volume[ ind], h, add = TRUE)

   hvec &lt;- 1:15
   p &lt;- numeric(0)
   for (h in hvec) {
      result &lt;- sm.discontinuity(Year, Volume, h,
                          display = "none", verbose = 0)
      p &lt;- c(p, result$p)
   }
   plot(hvec, p, type = "l", ylim = c(0, max(p)), xlab = "h")
   lines(range(hvec), c(0.05, 0.05), lty = 2)
})

with(trawl, {
   Position  &lt;- cbind(Longitude, Latitude)
   ind &lt;- (Longitude &lt; 143.8)
   # Remove a repeated point which causes difficulty with sm.discontinuity
   ind[54] &lt;- FALSE
   sm.regression(Position[ind,], Score1[ind], theta = 35, phi = 30)
   sm.discontinuity(Position[ind,], Score1[ind], col = "blue")
})
par(mfrow = c(1, 1))
	
#  The following example takes longer to run.
#  Alternative values for nside are 32 and 64.
#  Alternative values of yjump are 1 and 0.5.
# nside  &lt;- 16
# yjump  &lt;- 2
# x1     &lt;- seq(0, 1, length = nside)
# x2     &lt;- seq(0, 1, length = nside)
# x      &lt;- expand.grid(x1, x2)
# x      &lt;- cbind(x1 = x[, 1], x2 = x[, 2])
# y      &lt;- rnorm(nside * nside)
# ind    &lt;- (sqrt((x[, 1] - 0.5)^2 + (x[, 2] - 0.5)^2) &lt;= 0.25)
# y[ind] &lt;- y[ind] + yjump
# image(x1, x2, matrix(y, ncol = nside))
# sm.discontinuity(x, y, df = 20, add = TRUE)
</code></pre>


</div>