<div class="container">

<table style="width: 100%;"><tr>
<td>siaf.simulatePC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation from an Isotropic Spatial Kernel via Polar Coordinates
</h2>

<h3>Description</h3>

<p>To sample points from isotropic spatial kernels
<code class="reqn">f_2(s) = f(||s||)</code> such as <code>siaf.powerlaw</code> on a
bounded domain (i.e., <code class="reqn">||s|| &lt; \code{ub}</code>), it is
convenient to switch to polar coordinates <code class="reqn">(r,\theta)</code>,
which have a density proportional to
<code class="reqn">r f_2((r \cos(\theta), r \sin(\theta))) = r f(r)</code>
(independent of the angle <code class="reqn">\theta</code> due to isotropy).
The angle is thus simply drawn uniformly in <code class="reqn">[0,2\pi)</code>, and
<code class="reqn">r</code> can be sampled by the inversion method, where numeric root
finding is used for the quantiles (since the quantile function is not
available in closed form).
</p>


<h3>Usage</h3>

<pre><code class="language-R">siaf.simulatePC(intrfr)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>intrfr</code></td>
<td>

<p>a function computing the integral of <code class="reqn">r f(r)</code> from 0 to <code>R</code>
(first argument, not necessarily named <code>R</code>). Parameters of the
function are passed as its second argument and a third argument is
the event type.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a function with arguments <code>(n, siafpars, type, ub)</code>, which
samples <code>n</code> points from the spatial kernel <code class="reqn">f_2(s)</code> within the
disc of radius <code>ub</code>, where <code>siafpars</code> and <code>type</code> are
passed as second and third argument to <code>intrfr</code>.
The environment of the returned function will be the caller's environment.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>Examples</h3>

<pre><code class="language-R">simfun &lt;- siaf.powerlaw()$simulate
## is internally generated as siaf.simulatePC(intrfr.powerlaw)

set.seed(1)
simfun(n=10, siafpars=log(c(sigma=1, d=2)), ub=5)
</code></pre>


</div>