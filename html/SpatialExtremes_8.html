<div class="container">

<table style="width: 100%;"><tr>
<td>concurrencemap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maps of concurrence probabilities/expected concurrence cell area</h2>

<h3>Description</h3>

<p>This function produces maps for concurrence probabilities or expected
concurrence cell areas.</p>


<h3>Usage</h3>

<pre><code class="language-R">concurrencemap(data, coord, which = "kendall", type = "cell", n.grid =
100, col = cm.colors(64), plot = TRUE, plot.border = NULL,
compute.std.err = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing the data. Each column corresponds to
one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A matrix that gives the coordinates of each
location. Each row corresponds to one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>A character string specifying which estimator should be
used. Should be one of "emp" (empirical), "boot" (bootstrap version)
and "kendall" (kendall based).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Either "cell" for cell areas or a integer between 1 and
the number of locations specifying which site should be used as
reference locationâ€”see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.grid</code></td>
<td>
<p>Integer specifying the size of the prediction grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The colors used to produce the map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), a map is produced;
otherwise results are invisibly returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.border</code></td>
<td>
<p>The name of an R function that can be used to plot
the border of the study region. If <code>NULL</code>, no border are
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.std.err</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a map of standard
errors is also produced. It is currently only available for
concurrence probability maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options to be passed to the
<code>image</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns invisibly a list with the x and y coordinates
and the corresponding values for the estimated concurrence
probabilities or expected concurrence cell area.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Dombry, C., Ribatet, M. and Stoev, S. (2015) Probabilities of
concurrent extremes. <em>Submitted</em>
</p>


<h3>See Also</h3>

<p><code>concprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##require(maps) ## &lt;&lt;-- to plot US borders
data(USHCNTemp)
coord &lt;- as.matrix(metadata[,2:3])

## Subset the station to have a fast example
n.site &lt;- 30
chosen.site &lt;- sample(nrow(coord), n.site)
coord &lt;- coord[chosen.site,]
maxima.summer &lt;- maxima.summer[,chosen.site]

## Define a function to plot the border
border &lt;- function(add = FALSE) maps::map("usa", add = add)

par(mar = rep(0, 4))
## Produce a pairwise concurrence probability map w.r.t. station number 15
concurrencemap(maxima.summer, coord, type = 15, plot.border = border,
 compute.std.err = TRUE)

## Produce the expected concurrence cell area
concurrencemap(maxima.summer, coord, plot.border = border)
</code></pre>


</div>