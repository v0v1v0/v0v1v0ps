<div class="container">

<table style="width: 100%;"><tr>
<td>mle_stcos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLE for STCOS Model</h2>

<h3>Description</h3>

<p>MLE for STCOS Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mle_stcos(
  z,
  v,
  H,
  S,
  K,
  init = NULL,
  optim_control = list(),
  optim_method = "L-BFGS-B"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Vector which represents the outcome; assumed to be direct
estimates from the survey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Vector which represents direct variance estimates from the survey.
The diagonal of the matrix <code class="reqn">\bm{V}</code> described in the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Matrix of overlaps between source and fine-level supports.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Design matrix for basis decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Variance of the random coefficient <code class="reqn">\bm{\eta}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A list containing the initial values in the MCMC for
<code>sig2xi</code> and <code>sig2K</code>. If not specified, we select an
arbitrary initial value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_control</code></td>
<td>
<p>This is passed as the <code>control</code> argument to
<code>optim</code>. Note that the value <code>fnscale</code> is ignored if
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim_method</code></td>
<td>
<p>Method to be used for likelihood maximization by
<code>optim</code>. Default is <code>L-BFGS-B</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Maximize the likelihood of the STCOS model
</p>
<p style="text-align: center;"><code class="reqn">
  f(\bm{z} \mid \bm{\mu}_B, \sigma_K^2, \sigma_\xi^2)
  = \textrm{N}(\bm{z} \mid \bm{H} \bm{\mu}_B, \bm{\Delta}
  ),
  \quad \bm{\Delta} = \sigma_\xi^2 \bm{I} + \bm{V} + \sigma_K^2 \bm{S} \bm{K} \bm{S}^\top,
</code>
</p>

<p>by numerical maximization of the profile likelihood
</p>
<p style="text-align: center;"><code class="reqn">
  \ell(\sigma_K^2, \sigma_\xi^2) =
  -\frac{N}{2} \log(2 \pi) -\frac{1}{2} \log |\bm{\Delta}| -\frac{1}{2} (\bm{z} -
  \bm{H} \hat{\bm{\mu}}_B)^\top \bm{\Delta}^{-1} (\bm{z} - \bm{H} \hat{\bm{\mu}}_B)
</code>
</p>

<p>using
<code class="reqn">
  \hat{\bm{\mu}}_B = (\bm{H}^\top \bm{\Delta}^{-1} \bm{H})^{-1}
  \bm{H}^\top \bm{\Delta}^{-1} \bm{z}.
</code>
</p>


<h3>Value</h3>

<p>A list containing maximum likelihood estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
demo = prepare_stcos_demo()
mle_out = mle_stcos(demo$z, demo$v, demo$S, demo$H, demo$K)
sig2K_hat = mle_out$sig2K_hat
sig2xi_hat = mle_out$sig2xi_hat
mu_hat = mle_out$mu_hat

## End(Not run)
</code></pre>


</div>