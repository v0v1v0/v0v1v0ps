<div class="container">

<table style="width: 100%;"><tr>
<td>unisimrel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for data simulation</h2>

<h3>Description</h3>

<p>Functions for data simulation from a random regression model with one
response variable where the data properties can be controlled by a few input
parameters.  The data simulation is based on the concept of relevant latent
components and relevant predictors, and was developed for the purpose of
testing methods for variable selection for prediction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unisimrel(
  n,
  p,
  q,
  relpos,
  gamma,
  R2,
  ntest = NULL,
  muY = NULL,
  muX = NULL,
  lambda.min = .Machine$double.eps,
  sim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of (training) samples to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The total number of predictor variables to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of relevant predictor variables (as a subset of <code class="reqn">p</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relpos</code></td>
<td>
<p>A vector indicating the position (between 1 and <code class="reqn">p</code>) of the <code class="reqn">m</code> relevant components, e.g. <code class="reqn">c(1,2)</code> means that the first two latent components should be relevant. The length of relpos must be equal to <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>A number defining the speed of decline in eigenvalues (variances) of the latent components. The eigenvalues are assumed to decline according to an exponential model. The first eigenvalue is set equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>The theoretical R-squared according to the true linear model. A number between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntest</code></td>
<td>
<p>The number of test samples to be generated (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muY</code></td>
<td>
<p>The true mean of the response variable (optional). Default is muY=NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muX</code></td>
<td>
<p>The <code>p</code>-vector of true means of the predictor variables (optional). Default is muX=NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.min</code></td>
<td>
<p>Lower bound of the eigenvalues. Defaults to .Machine$double.eps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>A fitted simrel object. If this is given, the same regression coefficients will be used to simulate a new data set of requested size. Default is NULL, for which new regression coefficients are sampled.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data are simulated according to a multivariate normal model for the
vector <code class="reqn">(y, z_1, z_2, z_3, ..., z_p)^t</code> where <code class="reqn">y</code> is the response
variable and <code class="reqn">z = (z_1,..., z_p)^t</code> is the vector of latent (principal)
components. The ordered principal components are uncorrelated variables with
declining variances (eigenvalues) defined for component <code class="reqn">j</code> as
<code class="reqn">e^{-\gamma * j}/e^{-\gamma}</code>. Hence, the variance (eigenvalue) of the
first principal component is equal to 1, and a large value of <code class="reqn">\gamma</code>
gives a rapid decline in the variances. The variance of the response
variable is by default fixed equal to 1.
</p>
<p>Some of the principal components (ordered by their decreasing variances) are
assumed to be relevant for the prediction of the response. The indices of
the positions of the relevant components are set by the <code>relpos</code>
argument. The joint degree of relevance for the relevant components is
determined by the population R-squared defined by <code>R2</code>.
</p>
<p>In order to obtain predictor variables <code class="reqn">x = (x_1, x_2, ..., x_p)^t</code> for
<code class="reqn">y</code>, a random rotation of the principal components is performed. Hence,
<code class="reqn">x = R^t*z</code> for some random rotation matrix <code class="reqn">R</code>. For values of
<code class="reqn">q</code> satisfying <code class="reqn">m &lt;= q &lt;p</code> only a subspace of dimension <code class="reqn">q</code>
containing the <code class="reqn">m</code> relevant component(s) is rotated. This facilitates
the possibility to generate <code class="reqn">q</code> relevant predictor variables
(<code class="reqn">x</code>'s). The indices of the relevant predictors is randomly selected
with the only restriction that the index set contains the indices in
<code>relpos</code>. The final index set of the relevant predictors is saved in
the output argument <code>relpred</code>. If <code>q=p</code> all <code class="reqn">p</code> predictor
variables are relevant for the prediction of <code class="reqn">y</code>.
</p>
<p>For further details on the simulation approach, please see S&lt;e6&gt;b&lt;f8&gt;,
Alm&lt;f8&gt;y and Helland (2015).
</p>


<h3>Value</h3>

<p>A simrel object with list of following items,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call to simrel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The (n x p) simulated predictor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The n-vector of simulated response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The vector of true regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>The true intercept. This is zero if muY=NULL and muX=NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muY</code></td>
<td>
<p>The true mean of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muX</code></td>
<td>
<p>The <code>p</code>-vector of true means of the predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relpred</code></td>
<td>
<p>The index of the true relevant predictors, that is the x-variables with non-zero true regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TESTX</code></td>
<td>
<p>The (ntest x p) matrix of optional test samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TESTY</code></td>
<td>
<p>The ntest-vector of responses of the optional test samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of simulated samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of relevant components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of relevant predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The decline parameter in the exponential model for the true eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The true eigenvalues of the covariance matrix of the p predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>The true R-squared value of the linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relpos</code></td>
<td>
<p>The positions of the relevant components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minerror</code></td>
<td>
<p>The minimum achievable prediction error. Also the variance of the noise term in the linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The sampled correlations between the principal components and the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The true covariance matrix of <code class="reqn">(y,z_1, z_2, ..., z_p)^t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rotation</code></td>
<td>
<p>The random rotation matrix which is used to achieve the predictor variables as rotations of the latent components. Equals the transposed of the eigenvector-matrix of the covariance matrix of <code class="reqn">(x_1,...,x_p)^t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of response generated, either "univariate" as returned from <code>simrel</code>, or "bivariate" as returned from <code>simrel2</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Solve S&lt;e6&gt;b&lt;f8&gt; and Kristian H. Liland
</p>


<h3>References</h3>

<p>Helland, I. S. and Alm&lt;f8&gt;y, T., 1994, Comparison of prediction methods when only a few components are relevant, <em>J. Amer. Statist. Ass.</em>, <b>89</b>(426), 583 â€“ 591.
</p>
<p>S&lt;e6&gt;b&lt;f8&gt;, S., Alm&lt;f8&gt;y, T. and Helland, I. S., 2015, simrel - A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors, <em>Chemometr. Intell. Lab.</em>(in press),doi:10.1016/j.chemolab.2015.05.012.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Linear model data, large n, small p
mydata &lt;- unisimrel(n = 250, p = 20, q = 5, relpos = c(2, 4), gamma = 0.25, R2 = 0.75)

#Estimating model parameters using ordinary least squares
lmfit &lt;- lm(mydata$Y ~ mydata$X)
summary(lmfit)

#Comparing true with estimated regression coefficients
plot(mydata$beta, lmfit$coef[-1], xlab = "True regression coefficients",
  ylab = "Estimated regression coefficients")
abline(0,1)

#Linear model data, small n, large p
mydata &lt;- unisimrel(n = 50, p = 200, q = 25, relpos = c(2, 4), gamma = 0.25, R2 = 0.8 )

#Simulating more samples with identical distribution as previous simulation
mydata2 &lt;- unisimrel(n = 2500, sim = mydata)

#Estimating model parameters using partial least squares regression with
#cross-validation to determine the number of relevant components.
if (requireNamespace("pls", quietly = TRUE)) {
  require(pls)
  plsfit &lt;- plsr(mydata$Y ~ mydata$X, 15, validation = "CV")
 
  #Validation plot and finding the number of relevant components.
  plot(0:15, c(plsfit$validation$PRESS0, plsfit$validation$PRESS),
    type = "b", xlab = "Components", ylab = "PRESS")
  mincomp &lt;- which(plsfit$validation$PRESS == min(plsfit$validation$PRESS))
 
  #Comparing true with estimated regression coefficients
  plot(mydata$beta, plsfit$coef[, 1, mincomp], xlab = "True regression coefficients",
    ylab = "Estimated regression coefficients")
  abline(0, 1)
}
</code></pre>


</div>