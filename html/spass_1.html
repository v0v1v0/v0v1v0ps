<div class="container">

<table style="width: 100%;"><tr>
<td>bssr.1subgroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Blinded Sample Size Recalculation for a One Subgroup Design</h2>

<h3>Description</h3>

<p>Given data from an Internal Pilot Study (IPS), <code>bssr.1subgroup</code> reestimates the nuisance parameters, i.e. variances and prevalence, and recalculates the required sample size for proving a desired alternative when testing for an effect in the full or subpopulation. See 'Details' for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bssr.1subgroup(
  data,
  alpha,
  beta,
  delta,
  eps = 0.001,
  approx = c("conservative.t", "liberal.t", "normal"),
  df = c("n", "n1"),
  adjust = c("YES", "NO"),
  k = 1,
  nmax = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data matrix with data from ongoing trial: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>type II error (power=1-beta) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>vector of treatment effects to be proven, c(outside subgroup, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>precision parameter concerning the power calculation in the iterative sample size search algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>approximation method: Use a conservative multivariate t distribution ("conservative.t"), a liberal multivariate t distribution ("liberal.t") or a multivariate normal distribution ("normal") to approximate the joint distribution of the standardized test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>in case of a multivariate t distribution approximation, recalculate sample size with degrees of freedom depending on the size of the IPS (df=n1) or depending on the final sample size (df=n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>adjust blinded estimators for assumed treatment effect ("YES","No").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum total sample size.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs blinded nuisance parameter reestimation in a design with a subgroup within a full population where we want to test for treatment effects between a control and a treatment group.
Then the required sample size for the control and treatment group to prove an existing
alternative <code>delta</code> with a specified power 1-<code>beta</code> when testing the global null hypothesis <code class="reqn">H_0: \Delta_F=\Delta_S=0</code> to level <code>alpha</code> is calculated.
</p>
<p>The data matrix <code>data</code> should have three columns: The first column has to be a binary variable (0=treatment group, 1=control group). The second column should also contain a binary variable giving the full population/subgroup differentiation (0=full population, 1=subpopulation). The last column contains the observations.
</p>
<p>For sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the
sample size allocation factor, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>
<p>The parameter <code>df</code> provides a difference to the standard sample size calculation procedure implemented in <code>n.1subgroup</code>.
When applying a multivariate t distribution approximation to approximate the joint distribution of the standardized test statistics it gives the opportunity to use degrees of freedom depending on the number of subjects in the IPS instead of degrees of freedom depending on the projected final sample size.
Note that this leads to better performance when dealing with extremely small subgroup sample sizes but significantly increases the calculated final sample size.
</p>


<h3>Value</h3>

<p><code>bssr.1subgroup</code> returns a list containing the recalculated required sample size within the control group and treatment group along with all relevant parameters. Use <code>summary.bssrest</code> for a structured overview.
</p>


<h3>Source</h3>

<p><code>bssr.1subgroup</code> uses code contributed by Marius Placzek.
</p>


<h3>See Also</h3>

<p><code>n.1subgroup</code> for sample size calculation prior to the trial.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Given data from the Internal Pilot Study, reestimate the nuisance parameters and
#recalculate the required sample size to correctly reject with
#80% probability when testing the global Nullhypothesis H_0: Delta_F=Delta_S = 0
#assuming the true effect Delta_S=1 is in the subgroup (no effect outside of the subgroup).

random&lt;-r.1subgroup(n=50, delta=c(0,1), sigma=c(1,1.2), tau=0.4, fix.tau="YES", k=2)
reestimate&lt;-bssr.1subgroup(data=random,alpha=0.05,beta=0.1,delta=c(0,1),eps=0.001,
approx="conservative.t",df="n1",k=2,adjust="NO")
summary(reestimate)

</code></pre>


</div>