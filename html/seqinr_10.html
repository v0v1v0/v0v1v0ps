<div class="container">

<table style="width: 100%;"><tr>
<td>al2bp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>To Convert a forensic microsatellite allele name into its length in base pairs</h2>

<h3>Description</h3>

<p>Conventions used to name forensic microsatellite alleles (STR) are described
in Bar <em>et al.</em> (1994). The name "9.3" means for instance that there are
9 repetitions of the complete base oligomer and an incomplete repeat with 3 bp.
</p>


<h3>Usage</h3>

<pre><code class="language-R">al2bp(allele.name, repeat.bp = 4, offLadderChars = "&gt;&lt;", split = "\\.")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>allele.name</code></td>
<td>
<p>The name of the allele, coerced to a string type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeat.bp</code></td>
<td>
<p>The length in bp of the microsatellite base repeat, most of them
are tetranucleotides so that it defaults to 4. Do not forget to change this to 5
for loci based on pentanucleotides such as Penta D or Penta E.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offLadderChars</code></td>
<td>
<p><code>NA</code> is returned when at least one of 
these characters are found in the allele name. Off ladder alleles are typically
reported as "&lt;8" or "&gt;19" </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>The convention is to use a dot, as in "9.3", between the number of repeats
and the number of bases in the incomplete repeat. On some locales where the
decimal separator is a comma this could be a source of problem, try to use
"," instead for this argument which is forwarded to <code>strsplit</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Warnings generated by faulty numeric conversions are suppressed here.
</p>


<h3>Value</h3>

<p>A single numeric value corresponding to the size in bp of the allele, or NA
when characters spoting off ladder alleles are encountedred or when numeric
conversion is impossible (<em>e.g.</em> with "X" or "Y" allele names at Amelogenin locus).
</p>


<h3>Author(s)</h3>

<p>J.R. Lobry</p>


<h3>References</h3>

 
<p>Bar, W. and Brinkmann, B. and Lincoln, P. and Mayr, W.R. and Rossi, U. (1994)
DNA recommendations. 1994 report concerning further recommendations 
of the DNA Commission of the ISFH regarding PCR-based polymorphisms 
in STR (short tandem repeat) systems.
<em>Int. J. Leg. Med.</em>, <b>107</b>:159-160.
</p>
<p><code>citation("seqinR")</code>
</p>


<h3>See Also</h3>

<p><code>identifiler</code> for forensic microsatellite allele name examples.</p>


<h3>Examples</h3>

<pre><code class="language-R">#
#   Quality check and examples:
#
stopifnot( al2bp("9") == 36 )   # 9 repeats of a tetranucleotide is 36 bp
stopifnot( al2bp(9) == 36 )      # also OK with numerical argument
stopifnot( al2bp(9, 5) == 45 )  # 9 repeats of a pentanucleotide is 45 bp
stopifnot( al2bp("9.3") == 39 ) # microvariant case
stopifnot( is.na(al2bp("&lt;8")) )   # off ladder case 
stopifnot( is.na(al2bp("&gt;19")) ) # off ladder case
stopifnot( is.na(al2bp("X")) )     # non STR case
#
# Application to the alleles names in the identifiler data set where all loci are 
# tetranucleotide repeats:
#
data(identifiler)
al.names &lt;- unlist(identifiler)
al.length &lt;- sapply(al.names, al2bp)
loc.names &lt;- unlist(lapply(identifiler, names))
loc.nall  &lt;-unlist(lapply(identifiler, function(x) lapply(x,length)))
loc.fac &lt;- factor(rep(loc.names, loc.nall))
par(lend = "butt", mar = c(5,6,4,1)+0.1)
boxplot(al.length~loc.fac, las = 1, col = "lightblue",
  horizontal = TRUE, main = "Range of allele lengths at forensic loci",
  xlab = "Length (bp)", ylim = c(0, max(al.length, na.rm = TRUE)))
</code></pre>


</div>