<div class="container">

<table style="width: 100%;"><tr>
<td>subcopemc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bivariate Empirical Sucopula of Given Approximation Order
</h2>

<h3>Description</h3>

<p>Calculation of bivariate empirical subcopula matrix of given approximation order, induced partitions, standardized bivariate sample, and dependence measures for a given <b>continuous</b> bivariate sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">subcopemc(mat.xy, m = nrow(mat.xy), display = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a continuous random vector <code class="reqn">(X,Y)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>integer value of approximation order, where <code class="reqn">m = 2,...,n</code> with <code class="reqn">n</code> equal to sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>

<p>logical value indicating if graphs and dependence values should be displayed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both random variables <code class="reqn">X</code> and <code class="reqn">Y</code> must be continuous, and therefore repeated values in the sample are not expected. If found, <code>jitter</code> will be applied to break ties. NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>depMon </code></td>
<td>
<p>monotone standardized supremum distance in <code class="reqn">[-1,1].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depMonNonSTD </code></td>
<td>
<p>monotone non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depSup </code></td>
<td>
<p>standardized supremum distance in <code class="reqn">[0,1].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depSupNonSTD </code></td>
<td>
<p>non-standardized supremum distance <code class="reqn">[min,value,max].</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix </code></td>
<td>
<p>matrix with empirical subcopula values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part1 </code></td>
<td>
<p>vector with partition induced by first variable <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part2 </code></td>
<td>
<p>vector with partition induced by second variable <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size </code></td>
<td>
<p>numeric value of sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order </code></td>
<td>
<p>numeric value of approximation order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.sample </code></td>
<td>
<p>2-column matrix with the standardized bivariate sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample </code></td>
<td>
<p>2-column matrix with the original bivariate sample of <code class="reqn">(X,Y)</code>.</p>
</td>
</tr>
</table>
<p>If <code>display = TRUE</code> then the values of <code>depMon</code>, <code>depMonNonSTD</code>, <code>depSup</code>, and <code>depSupNonSTD</code> will be displayed, and the following graphs will be generated: marginal histograms of <code class="reqn">X</code> and <code class="reqn">Y</code>, scatterplots of the original and the standardized bivariate sample, contour and image bivariate graphs of the empirical subcopula.
</p>


<h3>Note</h3>

<p>If approximation order <code class="reqn">m &gt; 2000</code> calculation may take more than 2 minutes. Usually <code class="reqn">m = 50</code> would be enough for an acceptable approximation.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Durante, F. and Sempi, C. (2016) <em>Principles of Copula Theory</em>. Taylor and Francis Group, Boca Raton.
</p>
<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p><code>subcopem</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1: Independent Normal and Gamma

n &lt;- 300  # sample size
X &lt;- rnorm(n)         # Normal(0,1)
Y &lt;- rgamma(n, 2, 3)  # Gamma(2,3)
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopemc(XY,, display = TRUE)
str(SC)
## Approximation of order m = 15
SCm15 &lt;- subcopemc(XY, 15, display = TRUE)
str(SCm15)

## Example 2: Non-monotone dependence

n &lt;- 300  # sample size
Theta &lt;- runif(n, 0, 2*pi)  # Uniform circular distribution
X &lt;- cos(Theta)
Y &lt;- sin(Theta)
XY &lt;- cbind(X, Y)  # 2-column matrix with bivariate sample
cor(XY, method = "pearson")[1, 2]   # Pearson's correlation
cor(XY, method = "spearman")[1, 2]  # Spearman's correlation
cor(XY, method = "kendall")[1, 2]  # Kendall's correlation
SC &lt;- subcopemc(XY,, display = TRUE)
str(SC)
## Approximation of order m = 15
SCm15 &lt;- subcopemc(XY, 15, display = TRUE)
str(SCm15)
</code></pre>


</div>