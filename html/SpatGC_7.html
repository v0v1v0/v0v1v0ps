<div class="container">

<table style="width: 100%;"><tr>
<td>Poislat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Poisson Spatial Model</h2>

<h3>Description</h3>

<p>This function fits a Poisson spatial model (including zero-inflated and gamma Poisson variations)
to a given dataset using the INLA package. It constructs the formula based on the provided covariate data and ID variables,
and fits the model using the specified adjacency matrix ('W') or a shapefile of the study region.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Poislat(
  Y,
  ID,
  W = NULL,
  shapefile = NULL,
  covariate = NULL,
  family = c("gpoisson", "poisson", "zeroinflatedpoisson0", "zeroinflatedpoisson1")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector of response variables (counts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>Vector of indexes of regions (spatial units).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Optional adjacency matrix representing spatial connections between regions.
If not provided, it can be generated from a shapefile using the 'shapefile' argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapefile</code></td>
<td>
<p>Optional shapefile representing the study region. If provided, the adjacency matrix ('W')
will be calculated from the shapefile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>Optional matrix of covariates. If not provided, the function assumes the model
is intercept-only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The family of Poisson models to use. Options are "gpoisson", "poisson",
"zeroinflatedpoisson0", and "zeroinflatedpoisson1".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "inla" representing the fitted Poisson spatial model.
The object contains model estimates, diagnostics, and other results.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Generate data from the GC spatial regression model with lattice spatial dependency
  W &lt;- rAdj(500) # Generate a random adjacency matrix
  DDl &lt;- rGClat(n = 200, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5),
  W = W, spatial = "lattice", V = 1)

  # Prepare the data
  Y &lt;- DDl$y
  covariate &lt;- DDl$covariate
  ID &lt;- DDl$ID

  # Fit the spatial Poisson model
  ResultPoisson &lt;- Poislat(Y = Y, ID = ID, covariate = covariate, W = W, family = "poisson")

  # Summary of the model fit
  summary(ResultPoisson)


</code></pre>


</div>