<div class="container">

<table style="width: 100%;"><tr>
<td>dcovustat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate distance covariance via U-statistics</h2>

<h3>Description</h3>

<p>Calculates the square of the U-statistic formulation of distance covariance. This is  faster than the function 'dcov' in the R package 'energy'  and requires less memory. Note that negative values are possible in this version.</p>


<h3>Usage</h3>

<pre><code class="language-R">dcovustat(x,y,alpha=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector or matrix with the same number of observations as x, though the number of columns of x and y may differ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A scaling parameter in the interval (0,2] used for calculating distances.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the distance covariance U-statistic.
</p>


<h3>Note</h3>

<p>The value returned by dcovustat is equal to the square of the value returned by energy::dcov in the limit. 
</p>
<p>In dcovustat, a vector of length n is stored; in energy::dcov, an n x n matrix is stored. Thus, dcovustat requires far less memory and works for very large datasets.
</p>
<p>Even though dcovustat converges to the square of the distance covariance of the random variables x and y, it can be negative.
</p>


<h3>Author(s)</h3>

<p>David Matteson
</p>


<h3>References</h3>

<p>Matteson, D. S. &amp; Tsay, R. Independent component analysis via U-Statistics. 
&lt;http://www.stat.cornell.edu/~matteson/#ICA&gt;
</p>
<p>Szekely, G., Rizzo, M. &amp; Bakirov, N. Measuring and testing dependence by correlation of distances. (2007) <em>The Annals of Statistics</em>, 35, 2769-2794.
</p>


<h3>See Also</h3>

<p><code>multidcov</code>,
<code>energy::dcov</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">x = rnorm(5000)
y = rbinom(5000,1,0.5)
y = y - 1*(y==0)
z = y*exp(-x) #some non-linear dependence

dcovustat(x[1:1000],y[1:1000]) #close to zero

a = Sys.time()
dcovustat(x[1:1000],z[1:1000]) #greater than zero
a = Sys.time() - a

#measures of linear dependence close to zero:
cov(x,z)
cor(rank(x),rank(z))


## Not run: 
#dcovustat differs from energy::dcov but are equal in the limit
library(energy)
b = Sys.time()
(dcov(x[1:1000],z[1:1000]))^2
b = Sys.time() - b
as.double(b)/as.double(a) #dcovustat is much faster

## energy::dcov and dcovustat become approximately equal as n increases:
c = Sys.time()
dcovustat(x,z)
c = difftime(Sys.time(), c, sec)
d = Sys.time()
(dcov(x,z)^2)
d = difftime(Sys.time(), d, sec)
as.double(d)/as.double(c) 

## End(Not run)
</code></pre>


</div>