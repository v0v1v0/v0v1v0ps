<div class="container">

<table style="width: 100%;"><tr>
<td>ctas_profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a Drill CTAS Statement from a Query</h2>

<h3>Description</h3>

<p>When working with CSV[H] files in Drill 1.15.0+ everything comes back
<code>VARCHAR</code> since that's the way it should be. The old behaviour of
<code>sergeant</code> to auto-type convert was kinda horribad wrong. However,
it's a royal pain to make <a href="https://drill.apache.org/docs/create-table-as-ctas/"><code>CTAS</code></a>
queries from a giant list of <code>VARCHAR</code> field by hand. So, this is a
helper function to do that, inspired by David Severski.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ctas_profile(x, new_table_name = "CHANGE____ME")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>tbl</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_table_name</code></td>
<td>
<p>a new Drill data source spec (e.g. <code>dfs.xyz.`a.parquet`</code>)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>WIP!
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
db &lt;- src_drill("localhost")

# Test with bare data source
flt1 &lt;- tbl(db, "dfs.d.`/flights.csvh`")

cat(ctas_profile(flt1))

# Test with SELECT
flt2 &lt;- tbl(db, sql("SELECT `year`, tailnum, time_hour FROM dfs.d.`/flights.csvh`"))

cat(ctas_profile(flt2, "dfs.d.`flights.parquet`"))


## End(Not run)
</code></pre>


</div>