<div class="container">

<table style="width: 100%;"><tr>
<td>paley</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Paley-type Hadamard matrices</h2>

<h3>Description</h3>

<p>Computes a Hadamard matrix of dimension <code class="reqn">(p+1)\times 2^k</code>, where p is a prime,
and p+1 is a multiple of 4, using the Paley construction. Used by <code>hadamard</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">paley(n, nmax = 2 * n, prime=NULL, check=!is.null(prime))

is.hadamard(H, style=c("0/1","+-"), full.orthogonal.balance=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Minimum size for matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>Maximum size for matrix. Ignored if <code>prime</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prime</code></td>
<td>
<p>Optional. A prime at least as large as
<code>n</code>,  such that <code>prime+1</code> is divisible by 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Check that the resulting matrix is of Hadamard type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p><code>"0/1"</code> for a matrix of 0s and 1s, <code>"+-"</code> for a
matrix of <code class="reqn">\pm 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.orthogonal.balance</code></td>
<td>
<p>Require full orthogonal balance?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Paley construction gives a Hadamard matrix of order p+1 if p is
prime and p+1 is a multiple of 4.  This is then expanded to order
<code class="reqn">(p+1)\times 2^k</code> using the Sylvester construction.
</p>
<p><code>paley</code> knows primes up to 7919.  The user can specify a prime
with the <code>prime</code> argument, in which case a matrix of order
<code class="reqn">p+1</code> is constructed.
</p>
<p>If <code>check=TRUE</code> the code uses <code>is.hadamard</code> to check that
the resulting matrix really is of Hadamard type, in the same way as in
the example below. As this test takes <code class="reqn">n^3</code> time it is
preferable to just be sure that <code>prime</code> really is prime.
</p>
<p>A Hadamard matrix including a row of 1s gives BRR designs where the
average of the replicates for a linear statistic is exactly the full
sample estimate. This property is called full orthogonal balance.
</p>


<h3>Value</h3>

<p>For <code>paley</code>, a matrix of zeros and ones, or <code>NULL</code> if no matrix smaller than
<code>nmax</code> can be found.
</p>
<p>For <code>is.hadamard</code>, <code>TRUE</code> if <code>H</code> is a Hadamard matrix.
</p>


<h3>References</h3>

<p>Cameron PJ (2005) Hadamard Matrices. In: The
Encyclopedia of Design Theory 
</p>


<h3>See Also</h3>

 <p><code>hadamard</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
M&lt;-paley(11)

is.hadamard(M)
## internals of is.hadamard(M)
H&lt;-2*M-1
## HH^T is diagonal for any Hadamard matrix
H%*%t(H)

</code></pre>


</div>