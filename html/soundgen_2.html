<div class="container">

<table style="width: 100%;"><tr>
<td>.addFormants</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add formants per sound</h2>

<h3>Description</h3>

<p>Internal soundgen function called by <code>addFormants</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">.addFormants(
  audio,
  formants,
  spectralEnvelope = NULL,
  action = c("add", "remove")[1],
  dB = NULL,
  specificity = 1,
  zFun = NULL,
  vocalTract = NA,
  formantDep = 1,
  formantDepStoch = 1,
  formantWidth = 1,
  formantCeiling = 2,
  lipRad = 6,
  noseRad = 4,
  mouthOpenThres = 0,
  mouth = NA,
  temperature = 0.025,
  formDrift = 0.3,
  formDisp = 0.2,
  smoothing = list(),
  windowLength_points = 800,
  overlap = 75,
  dynamicRange = 120,
  normalize = c("max", "orig", "none")[1],
  play = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>audio</code></td>
<td>
<p>a list returned by <code>readAudio</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formants</code></td>
<td>
<p>either a character string like "aaui" referring to default
presets for speaker "M1" or a list of formant times, frequencies,
amplitudes, and bandwidths (see ex. below). <code>formants = NA</code> defaults
to schwa. Time stamps for formants and mouthOpening can be specified in ms
or an any other arbitrary scale. See <code>getSpectralEnvelope</code> for
more details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectralEnvelope</code></td>
<td>
<p>(optional): as an alternative to specifying formant
frequencies, we can provide the exact filter - a vector of non-negative
numbers specifying the power in each frequency bin on a linear scale
(interpolated to length equal to windowLength_points/2). A matrix
specifying the filter for each STFT step is also accepted. The easiest way
to create this matrix is to call soundgen:::getSpectralEnvelope or to use
the spectrum of a recorded sound</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>action</code></td>
<td>
<p>'add' = add formants to the sound, 'remove' = remove formants
(inverse filtering)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>if NULL (default), the spectral envelope is applied on the original
scale; otherwise, it is set to range from 1 to 10 ^ (dB / 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specificity</code></td>
<td>
<p>a way to sharpen or blur the spectral envelope (spectrum ^
specificity) : 1 = no change, &gt;1 = sharper, &lt;1 = blurred</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zFun</code></td>
<td>
<p>(optional) an arbitrary function to apply to the spectrogram
prior to iSTFT, where "z" is the spectrogram - a matrix of complex values
(see examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vocalTract</code></td>
<td>
<p>the length of vocal tract, cm. Used for calculating formant
dispersion (for adding extra formants) and formant transitions as the mouth
opens and closes. If <code>NULL</code> or <code>NA</code>, the length is estimated
based on specified formant frequencies, if any (anchor format)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formantDep</code></td>
<td>
<p>scale factor of formant amplitude (1 = no change relative
to amplitudes in <code>formants</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formantDepStoch</code></td>
<td>
<p>the amplitude of additional stochastic formants added
above the highest specified formant, dB (only if temperature &gt; 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formantWidth</code></td>
<td>
<p>scale factor of formant bandwidth (1 = no change)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formantCeiling</code></td>
<td>
<p>frequency to which stochastic formants are calculated,
in multiples of the Nyquist frequency; increase up to ~10 for long vocal
tracts to avoid losing energy in the upper part of the spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lipRad</code></td>
<td>
<p>the effect of lip radiation on source spectrum, dB/oct (the
default of +6 dB/oct produces a high-frequency boost when the mouth is
open)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noseRad</code></td>
<td>
<p>the effect of radiation through the nose on source spectrum,
dB/oct (the alternative to <code>lipRad</code> when the mouth is closed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mouthOpenThres</code></td>
<td>
<p>open the lips (switch from nose radiation to lip
radiation) when the mouth is open <code>&gt;mouthOpenThres</code>, 0 to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mouth</code></td>
<td>
<p>mouth opening (0 to 1, 0.5 = neutral, i.e. no
modification) (anchor format)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperature</code></td>
<td>
<p>hyperparameter for regulating the amount of stochasticity
in sound generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formDrift, formDisp</code></td>
<td>
<p>scaling factors for the effect of temperature on
formant drift and dispersal, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing</code></td>
<td>
<p>a list of parameters passed to
<code>getSmoothContour</code> to control the interpolation and smoothing
of contours: interpol (approx / spline / loess), loessSpan, discontThres,
jumpThres</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowLength_points</code></td>
<td>
<p>length of FFT window, points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>FFT window overlap, %. For allowed values, see
<code>istft</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>"orig" = same as input (default), "max" = maximum possible
peak amplitude, "none" = no normalization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>play</code></td>
<td>
<p>if TRUE, plays the synthesized sound using the default player on
your system. If character, passed to <code>play</code> as the name
of player to use, eg "aplay", "play", "vlc", etc. In case of errors, try
setting another default player for <code>play</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other plotting parameters passed to <code>spectrogram</code></p>
</td>
</tr>
</table>
</div>