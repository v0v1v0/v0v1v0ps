<div class="container">

<table style="width: 100%;"><tr>
<td>tensorDecomposition</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs CANDECOMP/PARAFAC (CP) Tensor Decomposition.</h2>

<h3>Description</h3>

<p>Generate weight-averaged denoised gene regulatory networks using CANDECOMP/PARAFAC (CP) Tensor Decomposition. The <code>tensorDecomposition</code> function takes one or two lists of gene regulatory matrices, if two list are provided, the shared genes are selected and the CP tensor decomposition is performed independently for each list (3d-tensor). The tensor decomposed matrices are then averaged to generate weight-averaged denoised networks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tensorDecomposition(
  xList,
  yList = NULL,
  nDecimal = 1,
  K = 5,
  maxError = 1e-05,
  maxIter = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xList</code></td>
<td>
<p>A list of gene regulatory networks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yList</code></td>
<td>
<p>Optional. A list of gene regulatory networks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nDecimal</code></td>
<td>
<p>An integer value indicating the number of decimal places to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of rank-one tensors used to approximate the data using CANDECOMP/PARAFAC (CP) Tensor Decomposition,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxError</code></td>
<td>
<p>A decimal value between 0 and 1. Defines the relative Frobenius norm error tolerance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>An integer value. Defines the maximum number of iterations if error stay above <code>maxError</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>CANDECOMP/PARAFRAC (CP) tensor decomposition approximate a K-Tensor using a sum of <code>K</code> rank-1 K-Tensors. A rank-1 K-Tensor can be written as an outer product of K vectors. This is an iterative algorithm, with two possible stopping conditions: either relative error in Frobenius norm has gotten below <code>maxError</code>, or the <code>maxIter</code> number of iterations has been reached. For more details on CP decomposition, consult Kolda and Bader (2009) and Morup (2011).
</p>


<h3>Value</h3>

<p>A list of weight-averaged denoised gene regulatory networks.
</p>


<h3>Author(s)</h3>

<p>This is an adaptation of the code provided by Li, J., Bien, J., &amp; Wells, M. T. (2018)
</p>


<h3>References</h3>


<ul>
<li>
<p> Li, J., Bien, J., &amp; Wells, M. T. (2018). rTensor: An R Package for Multidimensional Array (Tensor) Unfolding, Multiplication, and Decomposition. Journal of Statistical Software, 87(10), 1-31.
</p>
</li>
<li>
<p> Kolda, Tamara G., and Brett W. Bader. "Tensor decompositions and applications." SIAM review 51.3 (2009): 455-500.
</p>
</li>
<li>
<p> Morup, Morten. "Applications of tensor (multiway array) factorizations and decompositions in data mining." Wiley Interdisciplinary Reviews: Data Mining and Knowledge Discovery 1.1 (2011): 24-40.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(scTenifoldNet)

# Simulating of a dataset following a negative binomial distribution with high sparcity (~67%)
nCells = 2000
nGenes = 100
set.seed(1)
X &lt;- rnbinom(n = nGenes * nCells, size = 20, prob = 0.98)
X &lt;- round(X)
X &lt;- matrix(X, ncol = nCells)
rownames(X) &lt;- c(paste0('ng', 1:90), paste0('mt-', 1:10))

# Performing Single cell quality control
qcOutput &lt;- scQC(
  X = X,
  minLibSize = 30,
  removeOutlierCells = TRUE,
  minPCT = 0.05,
  maxMTratio = 0.1
)

# Computing 3 single-cell gene regulatory networks each one from a subsample of 500 cells
mnOutput &lt;- makeNetworks(X = X,
                         nNet = 3, 
                         nCells = 500, 
                         nComp = 3, 
                         scaleScores = TRUE, 
                         symmetric = FALSE, 
                         q = 0.95
                         )

# Computing a K = 3 CANDECOMP/PARAFAC (CP) Tensor Decomposition
tdOutput &lt;- tensorDecomposition(mnOutput, K = 3, maxError = 1e5, maxIter = 1e3)

# Verifying the number of networks
length(tdOutput)

# Veryfying the dimention of the networks
lapply(tdOutput,dim)

# Weight-averaged denoised single-cell gene regulatory networks
tdOutput[[1]][1:10,1:10]
</code></pre>


</div>