<div class="container">

<table style="width: 100%;"><tr>
<td>shiftrPermBinary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fast Enrichment Testing on Binary Outcomes via Circular Permutations
</h2>

<h3>Description</h3>

<p>This function performs very fast feature enrichment 
permutation testing between two binary data sets.
Circular permutations are used instead of simple permutations to 
preserve local dependence of test statistics.
The input data sets can be preprocessed with 
<code>shiftrPrepareLeft</code> and <code>shiftrPrepareRight</code> 
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shiftrPermBinary(
    left,
    right,
    offsets,
    alsoDoFisher = TRUE,
    returnPermOverlaps = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>left</code></td>
<td>

<p>The first vector of binary (0/1) outcomes. <br>
For repeated use it can be preprocessed with 
<code>shiftrPrepareLeft</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>

<p>The second vector of binary (0/1) outcomes. <br>
For repeated use it can be preprocessed with 
<code>shiftrPrepareRight</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsets</code></td>
<td>

<p>Vector of offsets, can be generated by <code>getOffsetsRandom</code>,
<code>getOffsetsUniform</code>, or <code>getOffsetsAll</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alsoDoFisher</code></td>
<td>

<p>If <code>TRUE</code>, also perform Fisher exact test 
(via <code>fisher.test</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnPermOverlaps</code></td>
<td>

<p>If <code>TRUE</code> return overlap counts under all tested permutations. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nfeatures</code></td>
<td>

<p>Number of features in input data sets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfeatures</code></td>
<td>

<p>Number of active features in the left data set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfeatures</code></td>
<td>

<p>Number of active features in the right data set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>

<p>Number of features simultaneously active in both data sets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlapUnderNull</code></td>
<td>

<p>Expected value of <code>overlap</code> if input data sets were independent.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enrichment</code></td>
<td>

<p>Enrichment ratio, equal to <code>overlap / overlapUnderNull</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permPVenrich</code></td>
<td>

<p>Permutation p-value for enrichment (one-sided).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permPVdeplete</code></td>
<td>

<p>Permutation p-value for depletion (one-sided).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permPV</code></td>
<td>

<p>Permutation p-value for depletion (two-sided).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permZ</code></td>
<td>

<p>Permutation z-statistic, 
calculated by fitting normal distribution to the <code>overlap</code> 
values under permutations. <br>
Positive values indicate enrichment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisherTest</code></td>
<td>

<p>Fisher exact test, as output by <code>fisher.test</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisherMat</code></td>
<td>

<p>Input 2x2 matrix for Fisher exact test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlapsPerm</code></td>
<td>

<p>Vector of length <code>npermute</code> with <code>overlap</code>
values under permutations.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andrey A Shabalin <a href="mailto:andrey.shabalin@gmail.com">andrey.shabalin@gmail.com</a>
</p>


<h3>See Also</h3>

<p>This function essentially involves <code>npermute</code> calls of
<code>singlePermutation</code> function
and calculation of summary statistics and p-values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Number of features
nf = 1e6
npermute = 10000

### Generate data sets
# The vector of a few common active feature to create dependence
common = sample(c(0L,1L), size = nf, replace = TRUE, prob = c(0.999,0.001))

# Left and right data sets with the common active features
lset = sample(c(0L,1L), size = nf, replace = TRUE, prob = c(0.8,0.2)) | common
rset = sample(c(0L,1L), size = nf, replace = TRUE, prob = c(0.8,0.2)) | common

offsets = getOffsetsUniform(n = nf, npermute = npermute)

show(head(offsets))
show(tail(offsets))

z = shiftrPermBinary(lset, rset, offsets)

show(z)
</code></pre>


</div>