<div class="container">

<table style="width: 100%;"><tr>
<td>qml.SARspARCH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum-likelihood estimation of a spatial autoregressive model with spatial ARCH residuals
</h2>

<h3>Description</h3>

<p>The function fits a spatial autoregressive model with spatial ARCH residuals using the maximum-likelihood approach. All parameters are jointly estimated. In addition, external regressor may be included in the mean equation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qml.SARspARCH(formula, B, W, type = "spARCH", data = NULL,
              b = 2, start = NULL, eigen_v = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class "<code>formula</code>"): a symbolic description of the model to be fitted. The details of model specification are given under "Details."  <code>y</code> must be a numeric vector of length <code>n</code> (dimension of the weighting matrix)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p><code>n</code> times <code>n</code> spatial weight matrix for the spatial autoregressive part
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p><code>n</code> times <code>n</code> spatial weight matrix for the spatial ARCH residuals
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>type of spatial ARCH model to be fitted for the error process (see Details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame, list or environment containing the variables in the model. If not found in data, the variables are taken from the working space.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>parameter <code>b</code> for the E-spARCH model (<code>type = "exp"</code>), must be a (positive) natural number
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>vector of starting values for the numerical optimization of the log-likelihood (optional)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_v</code></td>
<td>

<p>eigen values of B (optional)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>list of control variables for iterative maximization of the log-likelihood
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>type = "spARCH"</code>, the functions fits a simple spatial autoregressive model with spatial ARCH residuals, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{Y} = \lambda \mathbf{B} \boldsymbol{Y} + \mathbf{X} \boldsymbol{\beta} + \boldsymbol{h}^{1/2} \boldsymbol{\varepsilon}
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} = \alpha \boldsymbol{1}_n + \rho \mathbf{W} \boldsymbol{Y}^{(2)} \, .
</code>
</p>

<p>The distribution of the error term is assumed to be Gaussian.
</p>
<p>If <code>type = "log-ARCH"</code>, a spatial log-ARCH process is estimated for the error term, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln(\boldsymbol{h}) = \alpha \boldsymbol{1}_n + \rho \mathbf{W} g_b(\boldsymbol{\varepsilon}) \, .
</code>
</p>

<p>The function <code class="reqn">g_b</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
g_b(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})'
</code>
</p>

<p>and the error term is also assumed to be Gaussian.
</p>
<p>The modelling equation gan be specified as for <code>lm</code>, i.e., as <code>formula</code> object. A typical model has the form <code>response ~ terms</code> where response is the (numeric) response vector and terms is a series of terms which specifies a linear predictor for <code>response</code>. A terms specification of the form <code>first + second</code> indicates all the terms in first together with all the terms in second with duplicates removed. A specification of the form <code>first:second</code> indicates the set of terms obtained by taking the interactions of all terms in first with all terms in second. The specification <code>first*second</code> indicates the cross of first and second. This is the same as <code>first + second + first:second</code>. However, there is no <code>offset</code> permitted for the <code>qml.SARspARCH</code>.
</p>
<p>For an intercept-only model, the <code>formula</code> can be specified as <code>response ~ 1</code>. In addition, it is possible to fit an intercept-free model with <code>response ~ 0</code> or <code>response ~ 0 + terms</code>.
</p>
<p>To summarize the results of the model fit, use the generic function <code>summary</code>. For analysis of the residuals, the generic <code>plot</code> function provides several descriptive plots. For numerical maximization of the log-likelihood, the function uses the algorithm of <code>solnp</code> from the package <code>Rsolnp</code>.
</p>


<h3>Value</h3>

<p>A spARCH object with the following elements is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Parameter estimates <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Vector of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>Standard errors of the estimates (Cramer-Rao estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Hessian matrix of the negative Log-Likelihood at the estimated minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LL</code></td>
<td>
<p>Value of the Log-Likelihood at the estimated maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Fitted vector <code class="reqn">\boldsymbol{h}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of observations (input values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Chosen type (input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Spatial weight matrix (input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Spatial weight matrix (input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressors</code></td>
<td>
<p>Are regressors included? <code>TRUE</code>/<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR</code></td>
<td>
<p>Is an autoregressive term in the mean equation? <code>TRUE</code>/<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of regressors if <code>regressor = TRUE</code></p>
</td>
</tr>
</table>
<h3>Control Arguments</h3>

<p>see also: <code>solnp</code>
</p>

<ul>
<li> <p><code>rho</code> - This is used as a penalty weighting scalar for infeasibility in the augmented objective function. The higher its value the more the weighting to bring the solution into the feasible region (default 1). However, very high values might lead to numerical ill conditioning or significantly slow down convergence.
</p>
</li>
<li> <p><code>outer.iter</code> - Maximum number of major (outer) iterations (default 400).
</p>
</li>
<li> <p><code>inner.iter</code> - Maximum number of minor (inner) iterations (default 800).
</p>
</li>
<li> <p><code>delta</code> - Relative step size in forward difference evaluation (default 1.0e-7).
</p>
</li>
<li> <p><code>tol</code> - Relative tolerance on feasibility and optimality (default 1e-8).
</p>
</li>
<li> <p><code>trace</code> - The value of the objective function and the parameters is printed at every major iteration (default 1).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145. <em>arXiv:1609.00711</em>
</p>


<h3>See Also</h3>

<p><code>solnp</code> (package <code>Rsolnp</code>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("spdep")
rho &lt;- 0.5
alpha &lt;- 1
lambda &lt;- 0.5
d &lt;- 5
n &lt;- d^2
nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)
B &lt;- W

X &lt;- cbind(rep(1, n), rnorm(n))
beta &lt;- c(5, 2)

y &lt;- solve(diag(n) - lambda * B) %*%
    (sim.spARCH(n = n, rho = rho, alpha = alpha, W = W, type = "log-spARCH") + X %*% beta)
y &lt;- as.vector(y)
out &lt;- qml.SARspARCH(y ~ X[,2], B = B, W = W, type = "log-spARCH")

summary(out)
</code></pre>


</div>