<div class="container">

<table style="width: 100%;"><tr>
<td>stslshac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial two stages least square with HAC standard errors</h2>

<h3>Description</h3>

<p>Non-parametric heteroskedasticity and autocorrelation 
consistent (HAC) estimator of the variance-covariance (VC) for a vector of sample moments within a 
spatial context. The disturbance vector is generated as follows:
</p>
<p style="text-align: center;"><code class="reqn"> u = R  \epsilon </code>
</p>

<p>where <code class="reqn">R</code> is a non-stochastic matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stslshac(formula, data = list(), listw,
             na.action = na.fail, zero.policy = NULL, HAC = TRUE,
             distance = NULL, type = "Epanechnikov", 
             bandwidth = "variable", W2X = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a description of the model to be fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class data.frame. An optional data frame containing the variables
in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>an object of class <code>listw</code> created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contains missing values.
See lm for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>See <code>lagsarlm</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HAC</code></td>
<td>
<p>if FALSE traditional standard errors are provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an object of class <code>distance</code> created for example by read.gwt2dist 
The object contains the specification of the distance measure 
to be employed in the estimation of the VC matrix. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of <code>c("Epanechnikov","Triangular","Bisquare","Parzen", "QS","TH")</code>.
The type of Kernel to be used. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>"variable" (default) - or numeric when a fixed bandwidth is specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W2X</code></td>
<td>
<p>default TRUE. if FALSE only WX are used as instruments in the spatial two stage least squares.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default sets the bandwith for each observation to the maximum distance for 
that observation (i.e.
the max of each element of the list of distances). 
</p>
<p>Six different kernel functions are implemented:
</p>

<ul>
<li> <p><code>'Epanechnikov'</code>: <code class="reqn">K(z) = 1-z^2</code>
</p>
</li>
<li> <p><code>'Rectangular'</code>: <code class="reqn">K(z) = 1</code>
</p>
</li>
<li> <p><code>'Triangular'</code>: <code class="reqn">K(z) = 1-z</code> 
</p>
</li>
<li> <p><code>'Bisquare'</code>: <code class="reqn">K(z) = (1-z^2)^2</code>
</p>
</li>
<li> <p><code>'Parzen'</code>: <code class="reqn">K(z) = 1-6z^2+6 |z|^3</code> if  <code class="reqn">z \leq 0.5</code> and  
<code class="reqn"> K(z) = 2(1-|z|)^3</code> if <code class="reqn">0.5 &lt; z \leq 1</code> 
</p>
</li>
<li> <p><code>'TH'</code> (Tukey - Hanning):  <code class="reqn"> K(z) = \frac{1+ \cos(\pi z)}{2}</code>
</p>
</li>
<li> <p><code>'QS'</code> (Quadratic Spectral): <code class="reqn">K(z) = \frac{25}{12\pi^2z^2} 
(\frac{\sin(6\pi z)/5)}{6\pi z/5} - \cos(6\pi z)/5)</code>). 
</p>
</li>
</ul>
<p>If the kernel type is not one of the six implemented, the function will terminate with an error message. 
The spatial two stage least square estimator is based on the matrix of instruments <code class="reqn">H=[X,WX,W^2X^2]</code>.
</p>


<h3>Value</h3>

<p>A list object of class <code>sphet</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Spatial two stage least squares coefficient estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcmat</code></td>
<td>
<p>variance-covariance matrix of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>S2sls residulas variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>S2sls residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>difference between residuals and response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to create this object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model matrix of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the kernel employed in the estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>the type of bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>'s2slshac'</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianfranco Piras <a href="mailto:gpiras@mac.com">gpiras@mac.com</a>
</p>


<h3>References</h3>

<p>Kelejian, H.H. and Prucha, I.R. (2007) 
HAC estimation in a spatial framework,
<em>Journal of Econometrics</em>, <b>140</b>, pages 131–154.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1999) 
A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model,
<em>International Economic Review</em>, <b>40</b>, pages 509–533.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1998) 
A Generalized Spatial Two Stage Least Square Procedure for Estimating a Spatial Autoregressive
Model with Autoregressive Disturbances,
<em>Journal of Real Estate Finance and Economics</em>, <b>17</b>, pages 99–121.
</p>


<h3>See Also</h3>

<p><code>gstslshet</code>, <code>distance</code>, <code>distance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(spdep)
data(columbus)
listw &lt;- nb2listw(col.gal.nb)
data(coldis)
res &lt;- stslshac(CRIME ~ HOVAL + INC, data = columbus, listw = listw,  
distance = coldis, type = 'Triangular')
summary(res)
</code></pre>


</div>