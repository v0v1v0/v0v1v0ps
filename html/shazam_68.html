<div class="container">

<table style="width: 100%;"><tr>
<td>plotBaselineSummary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots BASELINe summary statistics</h2>

<h3>Description</h3>

<p><code>plotBaselineSummary</code> plots a summary of the results of selection analysis 
using the BASELINe method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBaselineSummary(
  baseline,
  idColumn,
  groupColumn = NULL,
  groupColors = NULL,
  subsetRegions = NULL,
  facetBy = c("region", "group"),
  title = NULL,
  style = c("summary"),
  size = 1,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>either a data.frame returned from summarizeBaseline
or a <code>Baseline</code> object returned from groupBaseline
containing selection probability density functions and summary 
statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idColumn</code></td>
<td>
<p>name of the column in <code>baseline</code> containing primary identifiers. 
If the input is a <code>Baseline</code> object, then this will be a column
in the <code>stats</code> slot of <code>baseline</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupColumn</code></td>
<td>
<p>name of the column in <code>baseline</code> containing secondary grouping 
identifiers. If the input is a <code>Baseline</code> object, then this will 
be a column in the <code>stats</code> slot of <code>baseline</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupColors</code></td>
<td>
<p>named vector of colors for entries in <code>groupColumn</code>, with 
names defining unique values in the <code>groupColumn</code> and values
being colors. Also controls the order in which groups appear on the
plot. If <code>NULL</code> alphabetical ordering and a default color palette 
will be used. Has no effect if <code>facetBy="group"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsetRegions</code></td>
<td>
<p>character vector defining a subset of regions to plot, correspoding 
to the regions for which the <code>baseline</code> data was calculated. If
<code>NULL</code> all regions in <code>baseline</code> are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facetBy</code></td>
<td>
<p>one of c("group", "region") specifying which category to facet the
plot by, either values in <code>groupColumn</code> ("group") or regions
defined in <code>baseline</code> ("region"). The data that is not used
for faceting will be color coded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>string defining the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>type of plot to draw. One of:
</p>

<ul><li> <p><code>"summary"</code>:  plots the mean and confidence interval for
the selection scores of each value in 
<code>idColumn</code>. Faceting and coloring
are determine by values in <code>groupColumn</code>
and regions defined in <code>baseline</code>, 
depending upon the <code>facetBy</code> argument.
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>numeric scaling factor for lines, points and text in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>if <code>TRUE</code> do not draw the plot and just return the ggplot2 
object; if <code>FALSE</code> draw the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to ggplot2::theme.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object defining the plot.
</p>


<h3>See Also</h3>

<p>Takes as input either a Baseline object returned by groupBaseline 
or a data.frame returned from summarizeBaseline.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Subset example data as a demo
data(ExampleDb, package="alakazam")
db &lt;- subset(ExampleDb, c_call %in% c("IGHM", "IGHG"))
set.seed(112)
db &lt;- dplyr::slice_sample(db, n=25)

# Collapse clones
db &lt;- collapseClones(db, cloneColumn="clone_id",
                     sequenceColumn="sequence_alignment",
                     germlineColumn="germline_alignment_d_mask",
                     method="thresholdedFreq", minimumFrequency=0.6,
                     includeAmbiguous=FALSE, breakTiesStochastic=FALSE)
                     
# Calculate BASELINe
baseline &lt;- calcBaseline(db, 
                         sequenceColumn="clonal_sequence",
                         germlineColumn="clonal_germline", 
                         testStatistic="focused",
                         regionDefinition=IMGT_V,
                         targetingModel=HH_S5F,
                         nproc=1)
 
# Grouping the PDFs by sample and isotype annotations
grouped &lt;- groupBaseline(baseline, groupBy=c("sample_id", "c_call"))

# Plot mean and confidence interval by region with custom group colors
isotype_colors &lt;- c("IGHM"="darkorchid", "IGHD"="firebrick", 
                    "IGHG"="seagreen", "IGHA"="steelblue")
plotBaselineSummary(grouped, "sample_id", "c_call", 
                    groupColors=isotype_colors, facetBy="region")


</code></pre>


</div>