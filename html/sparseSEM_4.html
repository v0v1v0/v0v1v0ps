<div class="container">

<table style="width: 100%;"><tr>
<td>elasticNetSEMcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Elastic Net penalty for SEM with user supplied (alphas, lambdas) for grid search
</h2>

<h3>Description</h3>

<p>Function elasticNetSEMcv allows users to set their own grid search through combination of a set of user provided
alphas an lambdas.
</p>


<h3>Usage</h3>

<pre><code class="language-R">elasticNetSEMcv(Y, X, Missing, B, alpha_factors,lambda_factors,kFold, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>The observed node response data with dimension of M (nodes) by N (samples). Y is normalized inside the function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The network node attribute matrix with dimension of M by N. Theoretically, X can be L by N matrix, with L being the total
node attributes. In current implementation, each node only allows one and only one attribute. <br>
If you have more than one attributes for some nodes,  please consider selecting the top one by either
correlation or principal component methods.  <br>
If for some nodes there is no attribute available, fill in the rows with all zeros.  See the yeast data 'yeast.rda' for example. <br>
X is normalized inside the function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Missing</code></td>
<td>

<p>Optional M by N matrix corresponding to elements of Y. 0 denotes not missing, and 1 denotes missing.
If a node i in sample j has the label missing (Missing[i,j] = 1), then Y[i,j] is set to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Optional input. For a network with M nodes, B is the M by M adjacency matrix.
If data is simulated/with known true network topology (i.e., known adjacency matrix), the Power
of detection (PD) and False Discovery Rate (FDR) is computed in the output parameter 'statistics'.
</p>
<p>If the true network topology is unknown, B is optional, and the PD/FDR in output parameter
'statistics' should be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_factors</code></td>
<td>

<p>The set of candidate alpha values.  Default is seq(start = 0.95, to = 0.05, step = -0.05)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_factors</code></td>
<td>

<p>The set of candidate lambda values. Default is 10^seq(start =1, to = 0.001, step = -0.2)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kFold</code></td>
<td>

<p>k-fold cross validation, default k=5
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>describe the information output from -1 - 10, larger number means more output
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the function perform CV and parameter inference, calculate power and FDR
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>

<p>dataframe stores the minimum Mean Square Error (MSE) for each alpha and the corresponding lambda from the selection path [lambda_max, ...., lambda_min]. <br>
col1: alpha <br>
col2: lambda (With the given alpha, this is the lambda having minimum MSE) <br>
col3: MSE <br>
col4: STE <br></p>
<p>The final (alpha, lambda) is set at the (alpha, lambda) that is within 1ste of the min(MSE) with higher level of penalty on the likehood function. 
</p>
</td>
</tr></table>
<ul><li>
<p>fitthe model fit with optimal (alpha,lambda) from cv
</p>
 
<ul>
<li>
<p>Bout
the computed weights for the network topology. B[i,j] = 0 means there is no edge between node i and j;
B[i,j]!=0 denotes an (undirected) edge between note i and j with B[i,j] being the weight of the edge.

</p>
</li>
<li>
<p>fout
f is 1 by M array keeping the weight for X (in SEM: Y = BY + FX + e). Theoretically, F can be M by L matrix,
with M being the number of nodes, and L being the total node attributes. However, in current implementation,
each node only allows one and only one attribute.
If you have more than one attributes for some nodes, please consider selecting the top one by either
correlation or principal component methods.
</p>

</li>
<li>
<p>stat
statistics is 1x6 array keeping record of: <br>
1. correct positive <br>
2. total positive   <br>
3. false positive   <br>
4. positive detected  <br>
5. Power of detection (PD) = correct positive/total positive  <br>
6. False Discovery Rate (FDR) = false positive/positive detected
</p>

</li>
<li>
<p>simTimecomputational time
</p>
</li>
<li>
<p>callthe call that produced this object	
</p>
</li>
</ul>
</li></ul>
<h3>Note</h3>

<p>Difference in three functions:<br>
1) elasticNetSML: Default alpha = 0.95: -0.05: 0.05; default 20 lambdas <br>
2) elasticNetSEMcv: user supplied alphas (one or more), lambdas; compute the optimal parameters and network parameters <br>
3) elasticNetSMLpoint: user supplied one alpha and one lambda, compute the network parameters 
</p>
<p>User is responsible to set the random seed to guarantee repeatable results.
</p>


<h3>Author(s)</h3>

<p>Anhui Huang; Dept of Electrical and Computer Engineering, Univ of Miami, Coral Gables, FL</p>


<h3>References</h3>

<p>1. Cai, X., Bazerque, J.A., and Giannakis, G.B. (2013). Inference of Gene Regulatory Networks with Sparse Structural Equation Models Exploiting Genetic Perturbations. PLoS Comput Biol 9, e1003068. <br>
2. Huang, A. (2014). "Sparse model learning for inferring genotype and phenotype associations." Ph.D Dissertation. University of Miami(1186).<br><br><br></p>


<h3>Examples</h3>

<pre><code class="language-R">	library(sparseSEM)
	data(B);
	data(Y);
	data(X);
	data(Missing);
	## Not run: OUT &lt;- elasticNetSEMcv(Y, X, Missing, B, alpha_factors = c(0.75, 0.5, 0.25),
	lambda_factors=c(0.1, 0.01, 0.001), kFold = 5, verbose  = 1);

## End(Not run)
</code></pre>


</div>