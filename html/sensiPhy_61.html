<div class="container">

<table style="width: 100%;"><tr>
<td>tree_discrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic uncertainty - Trait Evolution Discrete Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of discrete (binary) characters, 
evaluating phylogenetic uncertainty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree_discrete(
  data,
  phy,
  n.tree = 10,
  model,
  transform = "none",
  bounds = list(),
  n.cores = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data vector for a single binary trait, with names matching tips in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>Phylogenies (class 'multiPhylo', see ?<code>ape</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tree</code></td>
<td>
<p>Number of times to repeat the analysis with n different trees picked 
randomly in the multiPhylo file. If NULL, <code>n.tree</code> = 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The Mkn model to use (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>The evolutionary model to transform the tree (see Details). Default is <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitDiscrete</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitDiscrete</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits different models of discrete character evolution using <code>fitDiscrete</code>
to n trees, randomly picked in a multiPhylo file. Currently, only binary discrete traits are supported
</p>
<p>Different character model from <code>fitDiscrete</code> can be used, including <code>ER</code> (equal-rates), 
<code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion). 
</p>
<p>All transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used, i.e. <code>none</code>,
<code>EB</code>, <code>lambda</code>, <code>kappa</code> and<code>delta</code>.
</p>
<p>See <code>fitDiscrete</code> for more details on character models and tree transformations. 
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_discrete</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>data</code>: The original full data vector
</p>
<p><code>sensi.estimates</code>: Parameter estimates (transition rates q12 and q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for each analysis with a different phylogenetic tree.
</p>
<p><code>N.tree</code>: Number of trees <code>n.tree</code> analysed
</p>
<p><code>stats</code>: Main statistics for model parameters, i.e. minimum, maximum, mean, median and sd-values
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Caterina Penone
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>


<h3>See Also</h3>

<p><code>fitDiscrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Load data:
data("primates")
#Create a binary trait factor 
adultMass_binary&lt;-ifelse(primates$data$adultMass &gt; 7350, "big", "small")
adultMass_binary&lt;-as.factor(as.factor(adultMass_binary))
names(adultMass_binary)&lt;-rownames(primates$data)
#Model trait evolution accounting for phylogenetic uncertainty
tree_binary&lt;-tree_discrete(data = adultMass_binary,phy = primates$phy,
model = "ARD",transform = "none",n.tree = 30,n.cores = 2,track = TRUE)
#Print summary statistics
summary(tree_binary)
sensi_plot(tree_binary)
sensi_plot(tree_binary,graphs="q12")
sensi_plot(tree_binary,graphs="q21")
#Use a different evolutionary model or transformation.
tree_binary_lambda&lt;-tree_discrete(data = adultMass_binary,phy = primates$phy,
model = "SYM",transform = "lambda",n.tree = 30,n.cores = 2,track = TRUE)
summary(tree_binary_lambda) #Using Pagel's Lambda
sensi_plot(tree_binary_lambda)  
#Symmetrical rates, with an Early Burst (EB) model of trait evolution
tree_binary_SYM_EB&lt;-tree_discrete(data = adultMass_binary,phy = primates$phy,
model = "SYM",transform = "EB",n.tree = 30,n.cores = 2,track = TRUE)
summary(tree_binary_SYM_EB)
sensi_plot(tree_binary_SYM_EB) 
sensi_plot(tree_binary_SYM_EB,graphs="optpar") 

## End(Not run)
</code></pre>


</div>