<div class="container">

<table style="width: 100%;"><tr>
<td>selMtc.by.unc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identifies the best combination if matching variables in reducing uncertainty in estimation the contingency table Y vs. Z.</h2>

<h3>Description</h3>

<p>This function identifies the “best” subset of matching variables in terms of reduction of uncertainty when estimating relative frequencies in the contingency table Y vs. Z. The sequential procedure presented in D'Orazio <em>et al.</em>  (2017 and 2019) is implemented. This procedure avoids exploring all the possible combinations of the available X variables as in <code>Fbwidths.by.x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selMtc.by.unc(tab.x, tab.xy, tab.xz, corr.d=2, 
                    nA=NULL, nB=NULL, align.margins=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tab.x</code></td>
<td>

<p>A <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> table crossing the <b>X</b> variables.  This table must be obtained by using the function <code>xtabs</code> or <code>table</code>, e.g. <br><code>tab.x &lt;- xtabs(~x1+x2+x3, data=data.all)</code>. <strong>A minimum number of 3 variables is needed</strong>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab.xy</code></td>
<td>

<p>A <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> table of <b>X</b> vs. Y variable.  This table must be obtained by using the function <code>xtabs</code> or <code>table</code>, e.g. <br><code>table.xy &lt;- xtabs(~x1+x2+x3+y, data=data.A)</code>.
</p>
<p>A single categorical Y variables is allowed.  At least <strong>three</strong> categorical variables should be considered as <b>X</b> variables (common variables).  The same <b>X</b> variables in <code>tab.x</code> must be available in <code>tab.xy</code>.   Usually, it is assumed that the joint distribution of the <b>X</b> variables computed from <code>tab.xy</code> is equal to <code>tab.x</code> (a warning appears if any absolute difference is greater than <code>tol</code>). Note that when the marginal distribution of  <b>X</b> in <code>tab.xy</code> is not equal to that of <code>tab.x</code> it is possible to align them before computations (see argument <code>align.margins</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab.xz</code></td>
<td>

<p>A <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> table of <b>X</b> vs. Z variable.  This table must be obtained by using the function <code>xtabs</code> or <code>table</code>, e.g. <br><code>tab.xz &lt;- xtabs(~x1+x2+x3+z, data=data.B)</code>.
</p>
<p>A single categorical Z variable is allowed.  At least <strong>three</strong> categorical variables should be considered as <b>X</b> variables (common variables).  The same <b>X</b> variables in <code>tab.x</code> must be available in <code>tab.xz</code>.  Usually, it is assumed that the joint distribution of the <b>X</b> variables computed from <code>tab.xz</code> is equal to <code>tab.x</code> (a warning appears if any absolute difference is greater than <code>tol</code>). Note that when the marginal distribution of  <b>X</b> in <code>tab.xz</code> is not equal to that of <code>tab.x</code> it is possible to align them before computations (see argument <code>align.margins</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr.d</code></td>
<td>

<p>Integer, indicates the penalty that should be introduced in estimating the uncertainty by means of the average width of cell bounds. When <code>corr.d=1</code>  the penalty being considered is the one introduced in D'Orazio <em>et al.</em> (2017) (i.e. penalty1 in <code>Fbwidths.by.x</code>). When <code>corr.d=2</code> (default) it is considered a penalty suggested in D'Orazio <em>et al.</em> (2019) (indicated as “penalty2”  in   <code>Fbwidths.by.x</code>). Finally, no penalties are considered when <code>corr.d=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nA</code></td>
<td>

<p>Integer, sample size of file A used to estimate <code>tab.xy</code>. If  <code>NULL</code> is obtained as sum of frequencies in <code>tab.xy</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nB</code></td>
<td>

<p>Integer, sample size of file B used to estimate <code>tab.xz</code>. If  <code>NULL</code> is obtained as sum of frequencies in <code>tab.xz</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align.margins</code></td>
<td>

<p>Logical (default <code>FALSE</code>). When when <code>TRUE</code> the distribution of <b>X</b> variables in <code>tab.xy</code> is aligned with the distribution resulting from <code>tab.x</code>, without affecting the marginal distribution of Y. Similarly the distribution of <b>X</b> variables in <code>tab.xz</code> is aligned with the distribution resulting from <code>tab.x</code>, without affecting the marginal distribution of Z. The alignment is performed by running IPF algorithm as implemented in the function <code>Estimate</code> in the package <span class="pkg">mipfp</span>. To avoid lack of convergence due to combinations of Xs encountered in one table but not in the other (statistical 0s), before running IPF a small constant (1e-06) is added to empty cells in <code>tab.xy</code> and <code>tab.xz</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function follows the sequential procedure described in D'Orazio <em>et al.</em> (2017, 2019) to identify the combination of common variables most effective in reducing uncertainty when estimating the contingency table Y vs. Z. Initially, the available Xs are ordered according to the reduction of average width of uncertainty bounds when conditioning on each of them. Then in each step one the remaining X variables is added until the table became too sparse; in practice the procedure stops when: 
</p>
<p style="text-align: center;"><code class="reqn">min\left[ \frac{n_A}{H_{D_m} \times J}, \frac{n_B}{H_{D_m} \times K} \right] \leq 1 </code>
</p>
 
<p>For major details see also <code>Fbwidths.by.x</code>.
</p>


<h3>Value</h3>

<p>A list with the main outcomes of the procedure.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ini.ord</code></td>
<td>

<p>Average width of uncertainty bounds when conditioning on each of the available X variables. Variable most effective in reducing uncertainty comes first. The ordering determines the order in which they are entered in the sequential procedure. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list.xs</code></td>
<td>

<p>List with the various combinations of the matching variables being considered in each step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>av.df</code></td>
<td>

<p>Data.frame with all the relevant information for each of combination of X variables. The last row corresponds to the combination of the X variables identified as the best in reducing average width of uncertainty bounds (penalized or not depending on the input argument <code>corr.d</code>). For each combination of X variables the following additional information are reported:  the number of cells (name starts with “<code>nc</code>”);  the number of empty cells (name starts with “<code>nc0</code>”; the average relative frequency (name starts with “<code>av.crf</code>”); sparseness measured as Cohen's effect size with respect to equiprobability (uniform distribution across cells). Finally there are the value of the stopping criterion (“<code>min.av</code>”), the unconditioned average width of uncertainty bounds (“<code>avw</code>”), the penalty term  (“<code>penalty</code>”) and the penalized width  (“<code>avw.pen</code>”; <code>avw.pen=avw+penalty</code>).
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a> 
</p>


<h3>References</h3>

<p>D'Orazio, M., Di Zio, M. and Scanu, M. (2006). <em>Statistical Matching: Theory and Practice.</em> Wiley, Chichester.
</p>
<p>D'Orazio, M., Di Zio, M. and Scanu, M. (2017). “The use of uncertainty to choose matching variables in statistical matching”. <em>International Journal of Approximate Reasoning</em>, 90, pp. 433-440.
</p>
<p>D'Orazio, M., Di Zio, M. and Scanu, M. (2019). “Auxiliary variable selection in a a statistical matching problem”. In Zhang, L.-C. and Chambers, R. L. (eds.) <em>Analysis of Integrated Data</em>, Chapman &amp; Hall/CRC (forthcoming).
</p>


<h3>See Also</h3>

 
<p><code>Fbwidths.by.x</code>, <code>Frechet.bounds.cat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(quine, package="MASS") #loads quine from MASS
str(quine)
quine$c.Days &lt;- cut(quine$Days, c(-1, seq(0,50,10),100))
table(quine$c.Days)


# split quine in two subsets
suppressWarnings(RNGversion("3.5.0"))
set.seed(1111)
lab.A &lt;- sample(nrow(quine), 70, replace=TRUE)
quine.A &lt;- quine[lab.A, 1:4]
quine.B &lt;- quine[-lab.A, c(1:3,6)]

# compute the tables required by Fbwidths.by.x()
freq.xA &lt;- xtabs(~Eth+Sex+Age, data=quine.A)
freq.xB &lt;- xtabs(~Eth+Sex+Age, data=quine.B)

freq.xy &lt;- xtabs(~Eth+Sex+Age+Lrn, data=quine.A)
freq.xz &lt;- xtabs(~Eth+Sex+Age+c.Days, data=quine.B)

# apply Fbwidths.by.x()
bb &lt;- Fbwidths.by.x(tab.x=freq.xA+freq.xB, 
                           tab.xy=freq.xy,  tab.xz=freq.xz,
                           warn=FALSE)
bb$sum.unc
cc &lt;- selMtc.by.unc(tab.x=freq.xA+freq.xB, 
                           tab.xy=freq.xy,  tab.xz=freq.xz, corr.d=0)
cc$ini.ord
cc$av.df


</code></pre>


</div>