<div class="container">

<table style="width: 100%;"><tr>
<td>spearmanCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jackknife Euclidean / Empirical Likelihood Inference for Spearman's Correlation</h2>

<h3>Description</h3>

<p>Computes jackknife Euclidean / empirical likelihood confidence
intervals for Spearman's correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spearmanCI(x, y, level = 0.95, method = "Euclidean", plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector with data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector with data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>this must be one of the strings <code>"Euclidean"</code> or
<code>"empirical"</code>; see references below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if <code>TRUE</code>, it plots log-likelihood ratio function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Miguel de Carvalho</p>


<h3>References</h3>

<p>de Carvalho, M. and Marques, F. J. (2012). Jackknife Euclidean
likelihood-based inference for Spearman's rho. <em>North American
Actuarial Journal</em>, <b>16</b>, 487–492.
</p>
<p>Wang, R., and Peng, L. (2011). Jackknife empirical likelihood
intervals for Spearman’s rho. <em>North American Actuarial Journal</em>,
<b>15</b>, 475–486.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Real data example
data(fire)
attach(fire)
spearmanCI(building, contents)

## The intervals in de Carvalho and Marques (2012, Section 3.2)
## differ slightly as they are based on the estimate 
## spearman &lt;- function(x, y) {
##  n &lt;- length(x)
##  F &lt;- ecdf(x); G &lt;- ecdf(y)
##  return(12 / n * sum((F(x) - 1 / 2) * (G(y) - 1 / 2)))  
## }

## Simulated data example
library(MASS)
pearson &lt;- .7
Sigma &lt;- matrix(c(1, pearson, pearson, 1), 2, 2)
xy &lt;- mvrnorm(n = 1000, rep(0, 2), Sigma)
spearmanCI(xy[, 1], xy[, 2])
abline(v = 6 / pi * asin(pearson / 2), col = "grey", lty = 3)
</code></pre>


</div>