<div class="container">

<table style="width: 100%;"><tr>
<td>growth_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function that models a d18O curve through SST and GR sinusoids</h2>

<h3>Description</h3>

<p>The core function of the ShellChron growth model. Uses growth
rate and SST (Sea Surface Temperature) sinusoids to model d18O
data to be matched with the input. In the ShellChron modeling
routine, this function is optimized using the SCEUA algorithm
and applied on sliding windows through the dataset to estimate
the age of each datapoint
</p>


<h3>Usage</h3>

<pre><code class="language-R">growth_model(
  pars,
  T_per = 365,
  G_per = 365,
  years = 1,
  t_int = 1,
  transfer_function = "KimONeil97",
  d18Ow = "default",
  Dsam,
  Osam,
  t_maxtemp = 182.5,
  plot = FALSE,
  MC = 1000,
  D_err = NULL,
  O_err = NULL,
  return = "SSR"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>List of parameters for temperature and growth rate sinusoids
<code>pars &lt;- c(T_amp, T_pha, T_av, G_amp, G_pha, G_av, G_skw)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_per</code></td>
<td>
<p>Period of SST sinusoid (in days; default = 365)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G_per</code></td>
<td>
<p>Period of growth rate sinusoid (in days; default = 365)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>Number of years to be modeled (default = 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_int</code></td>
<td>
<p>Time interval (in days; default = 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transfer_function</code></td>
<td>
<p>Transfer function used to convert d18Oc to temperature
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d18Ow</code></td>
<td>
<p>Either a single value (constant d18Ow) or a vector of length
equal to the period in SST data (365 days by default) containing information
about seasonality in d18Ow. Defaults to constant d18Ow of 0 permille VSMOW
(the modern mean ocean value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dsam</code></td>
<td>
<p>Vector of <code>D</code> values serving as input (keep unit consistent
throughout model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Osam</code></td>
<td>
<p>Vector of <code>d18Oc</code> values serving as input (in permille VPDB)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_maxtemp</code></td>
<td>
<p>Timing of the warmest day of the year (in julian day;
default = 182.5, or May 26th halfway through the year)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Should results of modeling be plotted? <code>TRUE/FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>Number of Monte Carlo simulations to apply for error propagation
Default = 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_err</code></td>
<td>
<p>OPTIONAL: Vector containing errors on <code>Dsam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>O_err</code></td>
<td>
<p>OPTIONAL: Vector containing errors on <code>Osam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>String indicating whether to return just the Sum of Squared
Residuals ("SSR") or a matrix containing the results of the model and the
propagated uncertainties (if applicable)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Depending on the value of the "return" parameter either a single
value representing the Sum of Squared Residuals ("SSR") as a measure for
the closeness of the match between modeled d18O and input values, or a
matrix containing the full result of the modeling including propagated
uncertainties if applicable.
</p>


<h3>References</h3>

<p>package dependencies: ggplot2 3.2.1
function dependencies: temperature_curve, d18O_model, growth_rate_curve,
mc_err_orth
</p>
<p>doi: <a href="https://doi.org/10.1016/j.palaeo.2017.09.034">10.1016/j.palaeo.2017.09.034</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set parameters
G_amp &lt;- 20
G_per &lt;- 365
G_pha &lt;- 100
G_av &lt;- 15
G_skw &lt;- 70
T_amp &lt;- 20
T_per &lt;- 365
T_pha &lt;- 150
T_av &lt;- 15
pars &lt;- c(T_amp, T_pha, T_av, G_amp, G_pha, G_av, G_skw)
d18Ow &lt;- 0
# Create dummy data
Dsam &lt;- seq(1, 40, 1)
Osam &lt;- sin((2 * pi * (seq(1, 40, 1) - 8 + 30 / 4)) / 30)
# Test returning residual sum of squares for optimization
SSR &lt;- growth_model(pars, T_per, G_per, Dsam = Dsam, Osam = Osam,
    return = "SSR")
# Test returning full model result
resmat &lt;- growth_model(pars, T_per, G_per, Dsam = Dsam, Osam = Osam,
    return = "result")
</code></pre>


</div>