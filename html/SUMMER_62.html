<div class="container">

<table style="width: 100%;"><tr>
<td>rst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate spatial and temporal random effects</h2>

<h3>Description</h3>

<p>This function simulates spatial and temporal random effects with mean zero. The method is described in Algorithm 3.1 of Rue &amp; Held 2015.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rst(
  n = 1,
  type = c("s", "t", "st")[1],
  type.s = "ICAR",
  type.t = c("RW1", "RW2")[2],
  Amat = NULL,
  n.t = NULL,
  scale.model = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of random effects: temporal (t), spatial (s), or spatial-temporal (st)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.s</code></td>
<td>
<p>type of spatial random effect, currently only ICAR is available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.t</code></td>
<td>
<p>type of temporal random effect, currently only RW1 and RW2 are available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amat</code></td>
<td>
<p>adjacency matrix for the spatial regions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.t</code></td>
<td>
<p>number of time points for the temporal random effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.model</code></td>
<td>
<p>logical indicator of whether to scale the random effects to have unit generalized variance. See Sørbye 2013 for more details</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix (for spatial or temporal) or a three-dimensional array (for spatial-temporal) of the random effects.
</p>


<h3>Author(s)</h3>

<p>Zehang Richard Li
</p>


<h3>References</h3>

<p>Rue, H., &amp; Held, L. (2005). <em>Gaussian Markov random fields: theory and applications</em>. CRC press.
</p>
<p>Sørbye, S. H. (2013). <em>Tutorial: Scaling IGMRF-models in R-INLA</em>. Department of Mathematics and Statistics, University of Tromsø.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(DemoMap)
## Spatial random effects 
out &lt;- rst(n=10000, type = "s", Amat = DemoMap$Amat)
# To verify the mean under the conditional specification
mean(out[,1] - apply(out[,c(2,3,4)], 1, mean))  
mean(out[,2] - apply(out[,c(1,3)], 1, mean)) 
mean(out[,3] - apply(out[,c(1,2,4)], 1, mean))  
mean(out[,4] - apply(out[,c(1,3)], 1, mean)) 

## Temporal random effects (RW1)
out &lt;- rst(n=1, type = "t", type.t = "RW1", n.t = 200, scale.model = FALSE)
par(mfrow = c(1,2))
plot(1:dim(out)[2], out, col = 1, type = "l", xlab = "Time", ylab = "Random effects")
# verify the first order difference is normally distributed
first_diff &lt;- diff(as.numeric(out[1,]))
qqnorm(first_diff )	
abline(c(0,1))

## Temporal random effects (RW2)
out &lt;- rst(n=1, type = "t", type.t = "RW2", n.t = 200, scale.model = FALSE)
par(mfrow = c(1,2))
plot(1:dim(out)[2], out, col = 1, type = "l", xlab = "Time", ylab = "Random effects")
# verify the second order difference is normally distributed
first_diff &lt;- diff(as.numeric(out[1,]))
second_diff &lt;- diff(first_diff)
qqnorm(second_diff)	
abline(c(0,1))

## Spatial-temporal random effects
out &lt;- rst(n=1, type = "st", type.t = "RW2", Amat = DemoMap$Amat, n.t = 50)
dimnames(out)
par(mfrow = c(1,1))
plot(1:dim(out)[3], out[1,1,], col = 1,
 type = "l", ylim = range(out), xlab = "Time", ylab = "Random effects")
for(i in 2:4) lines(1:dim(out)[3], out[1,i,], col = i)
legend("bottomright", colnames(DemoMap$Amat), col = c(1:4), lty = rep(1,4))

## End(Not run)

</code></pre>


</div>