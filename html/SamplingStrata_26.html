<div class="container">

<table style="width: 100%;"><tr>
<td>procBethel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Procedure to apply Bethel algorithm and select a sample from given strata
</h2>

<h3>Description</h3>

<p>This function allows to execute a complete procedure from the Bethel optimal allocation to the selection of a sample, without having to optimize the strata, that are supposed to be given and fixed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">procBethel(framesamp,
           framecens,
           errors,
           sampling_method=c("srs","systematic","spatial"),
           minnumstrat=2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>framesamp</code></td>
<td>

<p>Dataframe containing sampling frame units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>framecens</code></td>
<td>

<p>Dataframe containing frame units that must be selected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>

<p>Dataframe containing the precision levels expressed in terms of maximum expected value of the Coefficients of Variation related to target variables of the survey.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling_method</code></td>
<td>

<p>Parameter for choosing the selection method: "srs", "systematic" and "spatial".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minnumstrat</code></td>
<td>

<p>Indicates the minimum number of units that must be allocated in each stratum. Default is 2.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing 
(1) the selected sample, 
(2) the strata with allocated sampling units,
(3) the take-all strata
(4) the sampling frame with the labels linking to (2)
(5) the frame with take-all units, with the labels linking to (3) 
</p>


<h3>Author(s)</h3>

<p>Giulio Barcaroli
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("swissmunicipalities")
swissmun &lt;- swissmunicipalities[swissmunicipalities$REG &lt; 4,
                                c("REG","COM","Nom","HApoly",
                                  "Surfacesbois","Surfacescult",
                                  "Airbat","POPTOT")]
ndom &lt;- length(unique(swissmun$REG))
cv &lt;- as.data.frame(list(DOM=rep("DOM1",ndom),
                         CV1=rep(0.10,ndom),
                         CV2=rep(0.10,ndom),
                         domainvalue=c(1:ndom) ))
cv
swissmun$HApoly.cat &lt;- var.bin(swissmun$HApoly,15)
swissmun$POPTOT.cat &lt;- var.bin(swissmun$POPTOT,15)
frame &lt;- buildFrameDF(df = swissmun,
                         id = "COM",
                         X = c("POPTOT.cat","HApoly.cat"),
                         Y = c("Airbat","Surfacesbois"),
                         domainvalue = "REG")
summary(frame)
#----Selection of units to be censused from the frame
ind_framecens &lt;- which(frame$X1 &gt; 9)
framecens &lt;- frame[ind_framecens,]
#----Selection of units to be sampled from the frame
# (complement to the previous)
framesamp &lt;- frame[-ind_framecens,]

a &lt;- procBethel(framesamp,framecens,errors=cv,sampling_method="srs",minnumstrat=2)
head(a$sample)
expected_CV(a$strata)

## End(Not run)
</code></pre>


</div>