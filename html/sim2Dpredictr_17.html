<div class="container">

<table style="width: 100%;"><tr>
<td>sim_Y_Binary_X</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Scalar Outcomes from Simulated Spatially Dependent Binary Predictors</h2>

<h3>Description</h3>

<p>N spatially dependent binary design vectors are simulated using 
<code>sim2D_binarymap</code>. These design vectors are used to then simulate
scalar outcomes that have one of Gaussian, Binomial, or Poisson 
distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_Y_Binary_X(
  N,
  B,
  rand.err = 1,
  dist,
  incl.subjectID = TRUE,
  binomial.method = "traditional",
  count.method = "traditional",
  Y.thresh = NULL,
  print.out = FALSE,
  xlim = c(0, 1),
  ylim = c(0, 1),
  im.res,
  radius.bounds = c(0.02, 0.1),
  lambda = 50,
  random.lambda = FALSE,
  lambda.sd = 10,
  lambda.bound = NULL,
  prior = "gamma",
  sub.area = FALSE,
  min.sa = c(0.1, 0.1),
  max.sa = c(0.3, 0.3),
  radius.bounds.min.sa = c(0.02, 0.05),
  radius.bounds.max.sa = c(0.08, 0.15),
  print.subj.sa = FALSE,
  print.lambda = FALSE,
  print.iter = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>A scalar value determining the number of images to create.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A vector parameter values; i.e. "betas". Note that 
<code>length(B)</code> must equal <code>p + 1 = n.row * n.col + 1</code>; e.g. for
normal outcomes <code class="reqn">Y = XB + e</code> with <code>Y</code> a scalar outcome and 
<code>e</code> the random error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand.err</code></td>
<td>
<p>A scalar for the random error variance when 
<code>dist = "gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>The distribution of the scalar outcome.
</p>

<ul>
<li> <p><code>dist = "gaussian"</code> has <code class="reqn">Y = XB + e</code>, where
<code class="reqn">e ~ N(0, rand.err)</code>.
</p>
</li>
<li> <p><code>dist = "binomial"</code> is drawn from eqnBin(XB, XB(1-XB))
using <code>rbinom()</code> when <code>binary.method = "Traditional"</code>. If
<code>binary.method = "Gaussian"</code>, then simulation is based on a
cutoff using <code>binary.cutoff</code>.
</p>
</li>
<li> <p><code>dist = "poisson"</code> is drawn from <code class="reqn">Poisson(XB)</code> using
<code>rpois()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incl.subjectID</code></td>
<td>
<p>When <code>incl.subjectID = TRUE</code> a column of subject
indices is generated.
<code>Y.thresh = NULL</code> (default). If <code>binomial.method = "gaussian manual"</code>,
then <code>Y.thresh</code> should be any scalar real number; values equal or 
above this cutoff are assigned 1 and values below are assigned 0.
If <code>binomial.method = "gaussian percentile"</code>, then values equal or 
above this percentile are assigned 1, and other wise 0; in this case values
should be between 0 and 1. For example, if <code>Y.thresh = 0.9</code>, then the
cutoff is the 90th percentile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binomial.method</code></td>
<td>
<p>One of <code>c("traditional", "gaussian manual",
"gaussian percentile")</code>. Only specified when <code>dist = "binomial"</code>, 
and determines whether draws are directly taken from a binomial 
distribution or if draws are taken from a Multivariate Normal 
Distribution (in the manner of <code>dist = "gaussian"</code>) and thresholds 
imposed to binarize the outcomes. <code>binomial.method = "gaussian manual"</code>
allows the user to specify specific values for categorizing outcomes. 
<code>binomial.method = "gaussian percentile"</code> allows the user to specify
percentiles for binarizing the data. Both approaches use <code>Y.thresh</code> 
to specify the cutoff value(s). If <code>binomial.method = "gaussian percentile"</code>
and <code>Y.thresh = NULL</code> then the median is used as the threshold. If
<code>binomial.method = "gaussian manual"</code> and <code>Y.thresh = NULL</code>, then
0 is used as the threshold. Default is <code>binomial.method = "traditional"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count.method</code></td>
<td>
<p>One of <code>c("traditional", "rounding")</code>. When 
<code>count.method = "traditional"</code>, the outcomes are drawn sequentially 
using <code>rpois()</code>. When <code>count.method = "traditional"</code>, the
outcomes are drawn from an MVN, then values less than or equal to 0 are 
set to 0, and all other values are rounded to the nearest whole number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.thresh</code></td>
<td>
<p>When <code>binomial.method = "traditional"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.out</code></td>
<td>
<p>If <code>print.out = TRUE</code> then print the following for
each subject, indexed y: </p>

<ul>
<li> <p><code>X[y] %*% B</code>
</p>
</li>
<li> <p><code>p[y]</code>, <code>lambda[y]</code> for Binomial, Poisson, respectively.
</p>
</li>
</ul>
<p>This is useful to see the effect of image parameter selection and beta
parameter selection on distributional parameters for the outcome of 
interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>These are the 2D image limits. Defaults for both are 
<code>c(0, 1)</code>. It is not recommended to alter these arguments unless 
changing the limits has a specific practical utility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>im.res</code></td>
<td>
<p>A vector specifying the dimension/resolution of the image. 
The first entry is the number of 'rows' in the lattice/image, and the 
second entry is the number of columns' in the lattice/image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius.bounds</code></td>
<td>
<p>A 2-element vector whose first and second entries 
determine the minimum and maximum radius sizes, respectively; these will 
be the bounds of the uniform distribution used to draw the radii. If 
<code>sub.area = TRUE</code>, then use <code>radius.bounds.min.sa</code> and 
<code>radius.bounds.max.sa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A scalar value specifying the mean/intensity value of the 
Poisson process. If <code>random.lambda = FALSE</code> then this is the parameter
used to generate the binary image for each subject. If 
<code>random.lambda = TRUE</code>, then this is the mean parameter in the
distribution used to draw subject-specific lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.lambda</code></td>
<td>
<p><code>random.lambda = TRUE</code> allows the lambda 
(mean/intensity) parameter in the Poisson process to vary randomly by 
subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.sd</code></td>
<td>
<p>Only utilized when <code>random.lambda = TRUE</code>, and 
specifies the standard deviation in the distribution used to draw 
subject-specific lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.bound</code></td>
<td>
<p>Only utilized when <code>random.lambda = TRUE</code>, and 
allows the user to specify a lower and upper bound for the subject-specific
lambda; if the randomly selected value is outside of this range, then 
another draw is taken. This continues until a value is selected within the
specified bounds. If no bounds are desired then specify 
<code>lambda.bound = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Only utilized when <code>random.lambda = TRUE</code>, and specifies
the distribution from which to draw the subject-specific lambda.
Options are <code>c("gaussian", "gamma")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.area</code></td>
<td>
<p>When <code>sub.area = TRUE</code>, a random sub-section of the 
image is chosen, within which the Poisson process is used to generate the
binary image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.sa, max.sa</code></td>
<td>
<p>Only utilized when <code>sub.area = TRUE</code>, and
determines the width and height of the  minimum and maximum sub-areas; 
e.g., if <code>min.sa = c(0.1, 0.1)</code>, then the smallest possible random 
sub-area is a 0.1 x 0.1 square.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius.bounds.min.sa, radius.bounds.max.sa</code></td>
<td>
<p>Only utilized when 
<code>sub.area = TRUE</code>, and specifies <code>radius.bounds</code> for the minimum
and maximum sub-areas, respectively. This information is used to adaptively
alter the bounds in between the minimum and maximum sub-areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.subj.sa, print.lambda, print.iter</code></td>
<td>
<p>These arguments are either
<code>TRUE</code> or <code>FALSE</code>, and define print options for checking that the
function is working as the user intends. <code>print.subj.sa = TRUE</code> prints
the x-and y-limits for each subject's sub-area. <code>print.lambda = TRUE</code> 
prints each subject's mean and realized events; the means will be the same
unless <code>random.lambda = TRUE</code>, but the number of realized events will
always vary. <code>print.iter = TRUE</code> is only used when 
<code>random.lambda = TRUE</code> and <code>is.null(lambda.bound) = FALSE</code>, and
shows iterations for re-drawing when the randomly selected intensity is 
outside the specified bounds.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame where each row consists of a single subject's data.
Col 1 is the outcome, Y, and each successive column contains the subject
predictor values.
</p>


<h3>Note</h3>

<p>Careful parameter selection, i.e. <code>B</code>, is necessary to ensure 
that simulated outcomes are reasonable; in particular, counts arising from
the Poisson distribution can be unnaturally large.
</p>


<h3>References</h3>

<p>Cressie N, Wikle CK (2011).
<em>Statistics for Spatio-Temporal Data</em>,  Wiley Series in Probability and Statistics.
John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Ripley BD (1987).
<em>Stochastic Simulation</em>.
John Wiley &amp; Sons.
<a href="https://doi.org/10.1002/9780470316726">doi:10.1002/9780470316726</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Define non-zero beta values
Bex &lt;- beta_builder(row.index = c(3, 3, 4), 
                    col.index = c(3, 4, 3),
                    im.res = c(5, 5),
                    B0 = 0, B.values = rep(1/3, 3),
                    output.indices = FALSE)
## Simulate Datasets
## parameter values
Nex = 10
set.seed(28743)

Gauss.ex &lt;- sim_Y_Binary_X(N = Nex, 
                           B = Bex,
                           dist = "gaussian", 
                           im.res = c(5, 5))
hist(Gauss.ex$Y)

## direct draws from binomial
Bin.ex &lt;- sim_Y_Binary_X(N = Nex, 
                         B = Bex, 
                         im.res = c(5, 5),
                         dist = "binomial", 
                         print.out = TRUE)
table(Bin.ex$Y)
</code></pre>


</div>