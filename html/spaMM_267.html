<div class="container">

<table style="width: 100%;"><tr>
<td>mv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Virtual factor for multivariate responses
</h2>

<h3>Description</h3>

<p><b>Motivation</b>: In a multivariate-response model fitted by <code>fitmv</code>, one may wish to fit a random-coefficient term appearing in <em>s</em> submodels, that is a random effect with realized values for each of these submodels and each group, with values possibly correlated among submodels within groups. Hence one might wish to specify it as a term of the form <code>(&lt;submodel&gt;|group)</code>, where <code>&lt;submodel&gt;</code> would represent a factor for the <em>s</em> submodels. But the data are not expected to contain a factor for these submodels, so such a syntax would not work without substantial data reshaping. Instead, this effect can be stated as <code>mv(...)</code> where the <code>...</code> are the indices of the submodels here the random effect appears. For example if submodels 2 and 3 include this random-coefficient term, the term can be specified as <code>(mv(2,3)|group)</code>. 
</p>
<p>Composite random effects, as defined in <code>spaMM-package</code> and illustrated by a bivariate-response quantitative-genetic model (Examples in <code>Gryphon</code>), combine correlations among response variables of different submodels as specified by <code>mv()</code>, and correlations within each response variable(as specified by a relatedness matrix in the same example).
</p>
<p>The <code>mv(...)</code> expression is treated as a factor for all purposes, meaning or example that <code>(0+mv(2,3)|group)</code> can also be used, leading (as for any factor) to an alternative parametrization of the same random-coefficient model (see Examples). <b>The parametrization through <code>(0+mv...)</code> is generally recommended as its results are easier to interpret</b>. The random-effect term is treated as a random-coefficient term for all purposes, meaning for example that fixed values can be specified for its parameters using the <code>ranCoefs</code> syntax (see Examples).  
</p>


<h3>Usage</h3>

<pre><code class="language-R"># mv(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Indices of all the submodels (possibly more than two) where the random effect involving this virtual factor appears.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>Not a function, hence no return value. In the summary of the fit, levels for the different submodels <em>s</em> within each group are labelled <code>.mv</code><em>s</em>.
</p>


<h3>See Also</h3>

<p><code>Gryphon</code> for example of composite random effects.
</p>
<p>The <code>X2X</code> argument of <code>fitmv</code> for fixed effects shared across sub-models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (spaMM.getOption("example_maxtime")&gt;1.1) {
## data preparation
data("wafers")
me &lt;- fitme(y ~ 1+(1|batch), family=Gamma(log), data=wafers, fixed=list(lambda=0.2))

set.seed(123)
wafers$y1 &lt;- simulate(me, type="marginal")
wafers$y2 &lt;- simulate(me, type="marginal")

## fits
(fitmv1 &lt;- fitmv(
  submodels=list(mod1=list(formula=y1~X1+(mv(1,2)|batch), family=Gamma(log)),
                 mod2=list(formula=y2~X1+(mv(1,2)|batch), family=Gamma(log))), 
  data=wafers))
# alternative '0+' parametrization of the same model:
(fitmv2 &lt;- fitmv(
  submodels=list(mod1=list(formula=y1~X1+(0+mv(1,2)|batch), family=Gamma(log)),
                 mod2=list(formula=y2~X1+(0+mv(1,2)|batch), family=Gamma(log))), 
  data=wafers)) 
# relationship between the *correlated* effects of the two fits
ranef(fitmv2)[[1]][,2]-rowSums(ranef(fitmv1)[[1]]) # ~ 0

# fit with given correlation parameter: 
update(fitmv2, fixed=list(ranCoefs=list("1"=c(NA,-0.5,NA)))) 
}
</code></pre>


</div>