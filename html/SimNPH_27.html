<div class="container">

<table style="width: 100%;"><tr>
<td>results_pivot_longer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for Plotting and Reporting Results</h2>

<h3>Description</h3>

<p>Functions for Plotting and Reporting Results
</p>


<h3>Usage</h3>

<pre><code class="language-R">results_pivot_longer(data, exclude_from_methods = c("descriptive"))

combined_plot(
  data,
  methods,
  xvars,
  yvar,
  facet_x_vars = c(),
  facet_y_vars = c(),
  split_var = 1,
  heights_plots = c(3, 1),
  scale_stairs = NULL,
  grid_level = 2,
  scales = "fixed",
  hlines = numeric(0),
  use_colours = NULL,
  use_shapes = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>for results_pivot_longer: simulation result as retured by SimDesign, for combined_plot: simulation results in long format, as returned by <code>results_pivot_longer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_from_methods</code></td>
<td>
<p>"methods" that should not be pivoted into long format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>
<p>methods to include in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvars</code></td>
<td>
<p>orderd vector of variable names to display on the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>variable name of the variable to be displayed on the y axis (metric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_x_vars</code></td>
<td>
<p>vector of variable names to create columns of facets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_y_vars</code></td>
<td>
<p>vector of variable names to create rows of facets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_var</code></td>
<td>
<p>where should the lines be split, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heights_plots</code></td>
<td>
<p>relative heights of the main plot and the stairs on the bottom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_stairs</code></td>
<td>
<p>this argument is deprecated and will be ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_level</code></td>
<td>
<p>depth of loops for which the grid-lines are drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>passed on to facet_grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hlines</code></td>
<td>
<p>position of horizontal lines, passed as <code>yintercept</code> to
<code>geom_hline</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_colours</code></td>
<td>
<p>optional named vector of colours used in <code>scale_colour_manual</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_shapes</code></td>
<td>
<p>optional named vector of shapes used in <code>scale_shape_manual</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With <code>exclude_from_methods</code> descriptive statistics or results of
reference methods can be kept as own columns and used like the columns of
the simulation parameters.
</p>
<p><code>use_colours</code> and <code>use_shapes</code> both use the <code>method</code> variable in their respective aesthetics.
</p>
<p><code>split_var</code> break the lines after the 1st, 2nd, ... variable in <code>xvars</code>. Use 0 for one continuous line per method.
</p>


<h3>Value</h3>

<p>dataset in long format with one row per method and scenario and one
column per metric
</p>
<p>a ggplot/patchwork object containing the plots
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>results_pivot_longer()</code>: pivot simulation results into long format
</p>
</li>
<li> <p><code>combined_plot()</code>: Nested Loop Plot with optional Facets
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data("combination_tests_delayed")

combination_tests_delayed |&gt;
  results_pivot_longer() |&gt;
  head()


library("ggplot2")
library("patchwork")
data("combination_tests_delayed")

results_long &lt;- results_pivot_longer(combination_tests_delayed)

# plot the rejection rate of two methods
combined_plot(
  results_long,
  c("logrank", "mwlrt", "maxcombo"),
  c("hr", "n_pat_design", "delay", "hazard_ctrl", "recruitment"),
  "rejection_0.025",
  grid_level=2
)

# use custom colour and shape scales
# this can be used to group methods by shape or colour
# this is also helpful if methods should have the same aesthetics across plots
my_colours &lt;- c(
  logrank="black",
  mwlrt="blue",
  maxcombo="green"
)

my_shapes &lt;- c(
  logrank=1,
  mwlrt=2,
  maxcombo=2
)

combined_plot(
  results_long,
  c("logrank", "mwlrt", "maxcombo"),
  c("hr", "n_pat_design", "delay", "hazard_ctrl", "recruitment"),
  "rejection_0.025",
  grid_level=2,
  use_colours = my_colours,
  use_shapes = my_shapes
)

# if one has a dataset of metadata with categories of methods
# one could uses those two definitions
# colours for methods, same shapes for methods of same category
metadata &lt;- data.frame(
  method = c("logrank", "mwlrt", "maxcombo"),
  method_name = c("logrank test", "modestly weighed logrank test", "maxcombo test"),
  category = c("logrank test", "combination test", "combination test")
)

my_colours &lt;- ggplot2::scale_colour_discrete()$palette(n=nrow(metadata)) |&gt;
  sample() |&gt;
  setNames(metadata$method)

my_shapes &lt;- metadata$category |&gt;
  as.factor() |&gt;
  as.integer() |&gt;
  setNames(metadata$method)

combined_plot(
  results_long,
  c("logrank", "mwlrt", "maxcombo"),
  c("hr", "n_pat_design", "delay", "hazard_ctrl", "recruitment"),
  "rejection_0.025",
  grid_level=2,
  use_colours = my_colours,
  use_shapes = my_shapes
)

</code></pre>


</div>