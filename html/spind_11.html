<div class="container">

<table style="width: 100%;"><tr>
<td>GEE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GEE (Generalized Estimating Equations)</h2>

<h3>Description</h3>

<p><code>GEE</code> provides GEE-based methods from the packages <span class="pkg">gee</span> and <span class="pkg">geepack</span>
to account for spatial autocorrelation in multiple linear regressions
</p>


<h3>Usage</h3>

<pre><code class="language-R">GEE(
  formula,
  family,
  data,
  coord,
  corstr = "fixed",
  cluster = 3,
  moran.params = list(),
  plot = FALSE,
  scale.fix = FALSE,
  customize_plot = NULL
)

## S3 method for class 'GEE'
plot(x, ...)

## S3 method for class 'GEE'
predict(object, newdata, ...)

## S3 method for class 'GEE'
summary(object, ..., printAutoCorPars = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Model formula. Variable names must match variables in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p><code>gaussian</code>, <code>binomial</code>, or <code>poisson</code> are supported.
Called using a quoted character string (i.e. <code>family</code> = "gaussian").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with variable names that match the variables
specified in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A matrix of two columns with corresponding cartesian
coordinates. Currently only supports integer coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>Expected autocorrelation structure: <code>independence</code>, <code>fixed</code>,
<code>exchangeable</code>, and <code>quadratic</code>  are possible.
</p>

<ul>
<li>
<p><code>independence</code> - This is the same as a GLM, i.e. correlation matrix = identity matrix.
</p>
</li>
<li>
<p><code>fixed</code> - Uses an adapted isotropic power function specifying all correlation
coefficients.
</p>
</li>
<li>
<p><code>exchangeable</code> and <code>quadratic</code> for clustering, i.e.
the correlation matrix has a block diagonal form:
</p>

<ul>
<li>
<p><code>exchangeable</code> - All intra-block correlation coefficients are equal.
</p>
</li>
<li>
<p><code>quadratic</code> - Intra-block correlation coefficients for different
distances can be different.
</p>
</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Cluster size for cluster models <code>exchangeable</code>
and <code>quadratic</code>. Values of 2, 3, and 4 are allowed.
</p>

<ul>
<li>
<p> 2 - a 2*2 cluster
</p>
</li>
<li>
<p> 3 - a 3*3 cluster
</p>
</li>
<li>
<p> 4 - a 4*4 cluster
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moran.params</code></td>
<td>
<p>A list of parameters for calculating Moran's I.
</p>

<ul>
<li>
<p><code>lim1</code> Lower limit for first bin. Default is 0.
</p>
</li>
<li>
<p><code>increment</code> Step size for calculating I. Default is 1.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A logical value indicating whether autocorrelation of
residuals should be plotted. NOW DEPRECATED in favor of <code>plot.GEE</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>
<p>A logical indicating whether or not the scale parameter should
be fixed. The default is <code>FALSE</code>. Use <code>TRUE</code> when planning to use
stepwise model selection procedures in <code>step.spind</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customize_plot</code></td>
<td>
<p>Additional plotting parameters passed to <code>ggplot</code>.
NOW DEPRECATED in favor <code>plot.GEE</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>GEE</code> or <code>WRM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>GEE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data frame containing variables to base the predictions on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printAutoCorPars</code></td>
<td>
<p>A logical indicating whether to print the
working autocorrelation parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>GEE can be used to fit linear models for response variables with
different distributions: <code>gaussian</code>, <code>binomial</code>, or <code>poisson</code>.
As a spatial model, it is a generalized linear model in which the residuals
may be autocorrelated. It accounts for spatial (2-dimensional)
autocorrelation of the residuals in cases of regular gridded datasets
and returns corrected parameter estimates. The grid cells are assumed to be square.
Furthermore, this function requires that <strong>all predictor variables
be continuous</strong>.
</p>


<h3>Value</h3>

<p>An object of class <code>GEE</code>. This consists of a list with the
following elements:
</p>

<dl>
<dt><code>call</code></dt>
<dd>
<p>Call</p>
</dd>
<dt><code>formula</code></dt>
<dd>
<p>Model formula</p>
</dd>
<dt><code>family</code></dt>
<dd>
<p>Family</p>
</dd>
<dt><code>coord</code></dt>
<dd>
<p>Coordinates used for the model</p>
</dd>
<dt><code>corstr</code></dt>
<dd>
<p>User-selected correlation structure</p>
</dd>
<dt><code>b</code></dt>
<dd>
<p>Estimate of regression parameters</p>
</dd>
<dt><code>s.e.</code></dt>
<dd>
<p>Standard errors of the estimates</p>
</dd>
<dt><code>z</code></dt>
<dd>
<p>Depending on the <code>family</code>, either a <em>z</em> or <em>t</em> value</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p><em>p</em>-values for each parameter estimate</p>
</dd>
<dt><code>scale</code></dt>
<dd>
<p>Scale parameter (dispersion parameter) of the distribution's variance</p>
</dd>
<dt><code>scale.fix</code></dt>
<dd>
<p>Logical indicating whether <code>scale</code> has fixed value</p>
</dd>
<dt><code>cluster</code></dt>
<dd>
<p>User-specified cluster size for clustered models</p>
</dd>
<dt><code>fitted</code></dt>
<dd>
<p>Fitted values from the model</p>
</dd>
<dt><code>resid</code></dt>
<dd>
<p>Normalized Pearson residuals</p>
</dd>
<dt><code>w.ac</code></dt>
<dd>
<p>Working autocorrelation parameters</p>
</dd>
<dt><code>Mat.ac</code></dt>
<dd>
<p>Working autocorrelation matrix</p>
</dd>
<dt><code>QIC</code></dt>
<dd>
<p>Quasi Information Criterion. See <code>qic.calc</code>
for further details</p>
</dd>
<dt><code>QLik</code></dt>
<dd>
<p>Quasi-likelihood. See <code>qic.calc</code>
for further details</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>Logical value indicating whether autocorrelation should
be plotted</p>
</dd>
<dt><code>moran.params</code></dt>
<dd>
<p>Parameters for calculating Moran's I</p>
</dd>
<dt><code>v2</code></dt>
<dd>
<p>Parameter variance of the <code>GEE</code> model</p>
</dd>
<dt><code>var.naive</code></dt>
<dd>
<p>Parameter variance of the <code>independence</code> model</p>
</dd>
<dt><code>ac.glm</code></dt>
<dd>
<p>Autocorrelation of GLM residuals</p>
</dd>
<dt><code>ac.gee</code></dt>
<dd>
<p>Autocorrelation of GEE residuals</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>An object of class <code>ggplot</code> containing information
on the autocorrelation of residuals from the fitted <code>GEE</code> and a
<code>GLM</code></p>
</dd>
</dl>
<p>Elements can be viewed using the <code>summary.GEE</code> methods included in
the package.
</p>


<h3>Note</h3>

<p>When using <code>corstr = "fixed"</code> on large data sets, the function
may return an error, as the resulting variance-covariance matrix is too
large for R to handle. If this happens, one will have to use one of the
cluster models (i.e <code>quadratic, exchangeable</code>).
</p>


<h3>Author(s)</h3>

<p>Gudrun Carl, Sam Levin
</p>


<h3>References</h3>

<p>Carl G &amp; Kuehn I, 2007. Analyzing Spatial Autocorrelation in Species
Distributions using Gaussian and Logit Models, Ecol. Model. 207, 159 - 170
</p>
<p>Carey, V. J., 2006. Ported to R by Thomas Lumley (versions 3.13,
4.4, version 4.13)., B. R. gee: Generalized Estimation Equation
solver. R package version 4.13-11.
</p>
<p>Yan, J., 2004. geepack: Generalized Estimating Equation Package.
R package version 0.2.10.
</p>


<h3>See Also</h3>

<p><code>qic.calc</code>, <code>summary.GEE</code>, <code>gee</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(musdata)
coords&lt;- musdata[,4:5]

## Not run: 
mgee &lt;- GEE(musculus ~ pollution + exposure,
            family = "poisson",
            data =  musdata,
            coord = coords,
            corstr = "fixed",
            scale.fix = FALSE)

summary(mgee, printAutoCorPars = TRUE)

pred &lt;- predict(mgee, newdata = musdata)

library(ggplot2)

plot(mgee)

my_gee_plot &lt;- mgee$plot

# move the legend to a new position
print(my_gee_plot + ggplot2::theme(legend.position = 'top'))


## End(Not run)
</code></pre>


</div>