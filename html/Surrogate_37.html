<div class="container">

<table style="width: 100%;"><tr>
<td>ICA.BinBin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case</h2>

<h3>Description</h3>

<p>The function <code>ICA.BinBin</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class="language-R">ICA.BinBin(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_, pi_0_1,
Monotonicity=c("General"), Sum_Pi_f = seq(from=0.01, to=0.99, by=.01),
M=10000, Volume.Perc=0, Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi1_1_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>. A vector is specified to account for uncertainty, i.e., rather than keeping <code class="reqn">P(T=1,S=1|Z=0)</code> fixed at one estimated value, a distribution can be specified (see <b>examples</b> below) from which a value is drawn in each run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1_0_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_1_1</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_1_0</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0_1_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_0_1</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. See <b>Details</b> below. Default <code>Monotonicity=c("General")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sum_Pi_f</code></td>
<td>
<p>A scalar or vector that specifies the grid of values <code class="reqn">G={g_{1},\: g_{2},\:...,\: g_{k}}</code> to be considered when the sensitivity analysis is conducted. See <b>Details</b> below. Default <code>Sum_Pi_f = seq(from=0.01, to=0.99, by=.01)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of runs that are conducted for a given value of <code>Sum_Pi_f</code>. This argument is not used when <code>Volume.Perc=0</code>. Default <code>M=10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.Perc</code></td>
<td>
<p>Note that the marginals that are observable in the data set a number of restrictions on the unidentified correlations. For example, under montonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, it holds that <code class="reqn">\pi_{0111}&lt;=min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})</code> and <code class="reqn">\pi_{1100}&lt;=min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})</code>. For example, when <code class="reqn">min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})=0.10</code> and <code class="reqn">min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})=0.08</code>, then all valid  <code class="reqn">\pi_{0111}&lt;=0.10</code> and  all valid <code class="reqn">\pi_{1100}&lt;=0.08</code>. The argument <code>Volume.Perc</code> specifies the fraction  of the 'volume' of the paramater space that is explored. This volume is computed based on the grids G={0, 0.01, ..., maximum possible value for the counterfactual probability at hand}. E.g., in the previous example, the 'volume' of the parameter space would be <code class="reqn">11*9=99</code>, and when e.g., the argument <code>Volume.Perc=1</code> is used a total of <code class="reqn">99</code> runs will be conducted for each given value of <code>Sum_Pi_f</code>. Notice that when monotonicity is not assumed, relatively high values of <code>Volume.Perc</code> will lead to a large number of runs and consequently a long analysis time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>Seed=sample(1:100000, size=1)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code>ICA.ContCont</code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles.
</p>
<p>The function <code>ICA.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> based on plausible values of the potential outcomes. Denote by <code class="reqn">\bold{Y}'=(T_0,T_1,S_0,S_1)</code> the vector of potential outcomes. The vector <code class="reqn">\bold{Y}</code> can take 16 values and the set of parameters <code class="reqn">\pi_{ijpq}=P(T_0=i,T_1=j,S_0=p,S_1=q)</code> (with <code class="reqn">i,j,p,q=0/1</code>) fully characterizes its distribution.
</p>
<p>However, the parameters in <code class="reqn">\pi_{ijpq}</code> are not all functionally independent, e.g., <code class="reqn">1=\pi_{\cdot\cdot\cdot\cdot}</code>. When no assumptions regarding monotonicity are made, the data impose a total of <code class="reqn">7</code> restrictions, and thus only <code class="reqn">9</code> proabilities in <code class="reqn">\pi_{ijpq}</code> are allowed to vary freely (for details, see Alonso et al., 2014). Based on the data and assuming SUTVA, the marginal probabilites <code class="reqn">\pi_{1 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{1 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 0}</code>, <code class="reqn">\pi_{0 \cdot 1 \cdot}</code>, and <code class="reqn">\pi_{\cdot 0 \cdot 1}</code> can be computed (by hand or using the function <code>MarginalProbs</code>). Define the vector
</p>
<p style="text-align: center;"><code class="reqn">\bold{b}'=(1, \pi_{1 \cdot 1 \cdot}, \pi_{1 \cdot 0 \cdot}, \pi_{\cdot 1 \cdot 1}, \pi_{\cdot 1 \cdot 0}, \pi_{0 \cdot 1 \cdot}, \pi_{\cdot 0 \cdot 1})</code>
</p>
<p> and <code class="reqn">\bold{A}</code> is a contrast matrix such that the identified restrictions can be written as a system of linear equation
</p>
<p style="text-align: center;"><code class="reqn">\bold{A \pi} = \bold{b}.</code>
</p>

<p>The matrix <code class="reqn">\bold{A}</code> has rank <code class="reqn">7</code> and can be partitioned as <code class="reqn">\bold{A=(A_r | A_f)}</code>, and similarly the vector <code class="reqn">\bold{\pi}</code> can be partitioned as <code class="reqn">\bold{\pi^{'}=(\pi_r^{'} | \pi_f^{'})}</code> (where <code class="reqn">f</code> refers to the submatrix/vector given by the <code class="reqn">9</code> last columns/components of <code class="reqn">\bold{A/\pi}</code>). Using these partitions the previous system of linear equations can be rewritten as
</p>
<p style="text-align: center;"><code class="reqn">\bold{A_r \pi_r + A_f \pi_f = b}.</code>
</p>

<p>The following algorithm is used to generate plausible distributions for <code class="reqn">\bold{Y}</code>. First, select a value of the specified grid of values (specified using <code>Sum_Pi_f</code> in the function call).  For <code class="reqn">k=1</code> to <code class="reqn">M</code> (specified using <code>M</code> in the function call), generate a vector <code class="reqn">\pi_f</code> that contains <code class="reqn">9</code> components that are uniformly sampled from hyperplane subject to the restriction that the sum of the generated components equals <code>Sum_Pi_f</code> (the function <code>RandVec</code>, which uses the <code>randfixedsum</code> algorithm written by Roger Stafford, is used  to obtain these components). Next, <code class="reqn">\bold{\pi_r=A_r^{-1}(b - A_f \pi_f)}</code> is computed and the <code class="reqn">\pi_r</code> vectors where all components are in the <code class="reqn">[0;\:1]</code> range are retained. This procedure is repeated for each of the <code>Sum_Pi_f</code> values.  Based on these results, <code class="reqn">R_H^2</code> is estimated. The obtained values can be used to conduct a sensitivity analysis during the validation exercise.
</p>
<p>The previous developments hold when no monotonicity is assumed. When monotonicity for <code class="reqn">S</code>, <code class="reqn">T</code>, or for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed, some of the probabilities of <code class="reqn">\pi</code> are zero. For example, when montonicity is assumed for <code class="reqn">T</code>, then <code class="reqn">P(T_0 &lt;= T_1)=1</code>, or equivantly, <code class="reqn">\pi_{1000}=\pi_{1010}=\pi_{1001}=\pi_{1011}=0</code>. When monotonicity is assumed, the procedure described above is modified accordingly (for details, see Alonso et al., 2014). When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>.)
</p>
<p>To account for the uncertainty in the estimation of the marginal probabilities, a vector of values can be specified from which a random draw is made in each run (see <b>Examples</b> below).
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Monotonicity</code></td>
<td>
<p>The assumption regarding monotonicity that was made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.No</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity is not assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used (i.e., when it is not equal to <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.T</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">T</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.S</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.ST</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code>ICA.ContCont</code>, <code>MICA.ContCont</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: # Time consuming code part
# Compute R2_H given the marginals specified as the pi's, making no
# assumptions regarding monotonicity (general case)
ICA &lt;- ICA.BinBin(pi1_1_=0.2619048, pi1_0_=0.2857143, pi_1_1=0.6372549,
pi_1_0=0.07843137, pi0_1_=0.1349206, pi_0_1=0.127451, Seed=1,
Monotonicity=c("General"), Sum_Pi_f = seq(from=0.01, to=.99, by=.01), M=10000)

# obtain plot of the results
plot(ICA, R2_H=TRUE)

# Example 2 where the uncertainty in the estimation
# of the marginals is taken into account
ICA_BINBIN2 &lt;- ICA.BinBin(pi1_1_=runif(10000, 0.2573, 0.4252),
pi1_0_=runif(10000, 0.1769, 0.3310),
pi_1_1=runif(10000, 0.5947, 0.7779),
pi_1_0=runif(10000, 0.0322, 0.1442),
pi0_1_=runif(10000, 0.0617, 0.1764),
pi_0_1=runif(10000, 0.0254, 0.1315),
Monotonicity=c("General"),
Sum_Pi_f = seq(from=0.01, to=0.99, by=.01),
M=50000, Seed=1)

# Plot results
plot(ICA_BINBIN2)

## End(Not run)
</code></pre>


</div>