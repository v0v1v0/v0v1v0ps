<div class="container">

<table style="width: 100%;"><tr>
<td>train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train</h2>

<h3>Description</h3>

<p>Train a model using one of the following methods: Artificial Neural Networks,
Boosted Regression Trees, Maxent, Maxnet or Random Forest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">train(method, data, folds = NULL, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character or character vector. Method used to train the model,
possible values are "ANN", "BRT", "Maxent", "Maxnet" or "RF", see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>SWD object with presence and absence/background
locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>list. Output of the function randomFolds or folds object
created with other packages, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar during cross
validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to the relative method, see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p> For the ANN method possible arguments are (for more details see
nnet):
</p>

<ul>
<li>
<p> size: integer. Number of the units in the hidden layer.
</p>
</li>
<li>
<p> decay numeric. Weight decay, default is 0.
</p>
</li>
<li>
<p> rang numeric. Initial random weights, default is 0.7.
</p>
</li>
<li>
<p> maxit integer. Maximum number of iterations, default is 100.
</p>
</li>
</ul>
</li>
<li>
<p> For the BRT method possible arguments are (for more details see
gbm):
</p>

<ul>
<li>
<p> distribution: character. Name of the distribution to use, default is
"bernoulli".
</p>
</li>
<li>
<p> n.trees: integer. Maximum number of tree to grow, default is 100.
</p>
</li>
<li>
<p> interaction.depth: integer. Maximum depth of each tree, default is 1.
</p>
</li>
<li>
<p> shrinkage: numeric. The shrinkage parameter, default is 0.1.
</p>
</li>
<li>
<p> bag.fraction: numeric. Random fraction of data used in the tree
expansion, default is 0.5.
</p>
</li>
</ul>
</li>
<li>
<p> For the RF method the model is trained as classification. Possible
arguments are (for more details see
randomForest):
</p>

<ul>
<li>
<p> mtry: integer. Number of variable randomly sampled at each split,
default is <code style="white-space: pre;">⁠floor(sqrt(number of variables))⁠</code>.
</p>
</li>
<li>
<p> ntree: integer. Number of tree to grow, default is 500.
</p>
</li>
<li>
<p> nodesize: integer. Minimum size of terminal nodes, default is 1.
</p>
</li>
</ul>
</li>
<li>
<p> Maxent models are trained using the arguments
<code>"removeduplicates=false"</code> and <code>"addsamplestobackground=false"</code>.
Use the function thinData to remove duplicates and the function
addSamplesToBg to add presence locations to background locations. For
the Maxent method, possible arguments are:
</p>

<ul>
<li>
<p> reg: numeric. The value of the regularization multiplier, default is 1.
</p>
</li>
<li>
<p> fc: character. The value of the feature classes, possible values are
combinations of "l", "q", "p", "h" and "t", default is "lqph".
</p>
</li>
<li>
<p> iter: numeric. Number of iterations used by the MaxEnt algorithm,
default is 500.
</p>
</li>
</ul>
</li>
<li>
<p> Maxnet models are trained using the argument
<code>"addsamplestobackground = FALSE"</code>, use the function addSamplesToBg
to add presence locations to background locations. For the Maxnet method,
possible arguments are (for more details see maxnet):
</p>

<ul>
<li>
<p> reg: numeric. The value of the regularization intensity, default is 1.
</p>
</li>
<li>
<p> fc: character. The value of the feature classes, possible values are
combinations of "l", "q", "p", "h" and "t", default is "lqph".
</p>
</li>
</ul>
</li>
</ul>
<p>The folds argument accepts also objects created with other packages:
<span class="pkg">ENMeval</span> or <span class="pkg">blockCV</span>. In this case the function converts
internally the folds into a format valid for <span class="pkg">SDMtune</span>.
</p>
<p>When multiple methods are given as <code>method</code> argument, the function returns a
named list of model object, with the name corresponding to the used method,
see examples.
</p>


<h3>Value</h3>

<p>An SDMmodel or SDMmodelCV or a list of
model objects.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>References</h3>

<p>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics with S.
Fourth Edition. Springer, New York. ISBN 0-387-95457-0.
</p>
<p>Brandon Greenwell, Bradley Boehmke, Jay Cunningham and GBM Developers (2019).
gbm: Generalized Boosted Regression Models.
<a href="https://CRAN.R-project.org/package=gbm">https://CRAN.R-project.org/package=gbm</a>.
</p>
<p>A. Liaw and M. Wiener (2002). Classification and Regression by randomForest.
R News 2(3), 18–22.
</p>
<p>Hijmans, Robert J., Steven Phillips, John Leathwick, and Jane Elith. 2017.
dismo: Species Distribution Modeling.
<a href="https://cran.r-project.org/package=dismo">https://cran.r-project.org/package=dismo</a>.
</p>
<p>Steven Phillips (2017). maxnet: Fitting 'Maxent' Species Distribution Models
with 'glmnet'. <a href="https://CRAN.R-project.org/package=maxnet">https://CRAN.R-project.org/package=maxnet</a>.
</p>
<p>Muscarella, R., Galante, P.J., Soley-Guardia, M., Boria, R.A., Kass, J.,
Uriarte, M. and R.P. Anderson (2014). ENMeval: An R package for conducting
spatially independent evaluations and estimating optimal model complexity
for ecological niche models. Methods in Ecology and Evolution.
</p>
<p>Roozbeh Valavi, Jane Elith, José Lahoz-Monfort and Gurutzeta Guillera-Arroita
(2018). blockCV: Spatial and environmental blocking for k-fold
cross-validation. <a href="https://github.com/rvalavi/blockCV">https://github.com/rvalavi/blockCV</a>.
</p>


<h3>See Also</h3>

<p>randomFolds.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

## Train a Maxent model
model &lt;- train(method = "Maxent",
               data = data,
               fc = "l",
               reg = 1.5,
               iter = 700)

# Add samples to background. This should be done preparing the data before
# training the model without using
data &lt;- addSamplesToBg(data)
model &lt;- train("Maxent",
               data = data)

## Train a Maxnet model
model &lt;- train(method = "Maxnet",
               data = data,
               fc = "lq",
               reg = 1.5)

## Cross Validation
# Create 4 random folds splitting only the presence data
folds &lt;- randomFolds(data,
                     k = 4,
                     only_presence = TRUE)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = folds)

## Not run: 
# Run only if you have the package ENMeval installed
## Block partition using the ENMeval package
require(ENMeval)
block_folds &lt;- get.block(occ = data@coords[data@pa == 1, ],
                         bg.coords = data@coords[data@pa == 0, ])

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = block_folds)

## Checkerboard1 partition using the ENMeval package
cb_folds &lt;- get.checkerboard1(occ = data@coords[data@pa == 1, ],
                              env = predictors,
                              bg.coords = data@coords[data@pa == 0, ],
                              aggregation.factor = 4)

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = cb_folds)

## Environmental block using the blockCV package
# Run only if you have the package blockCV
require(blockCV)
# Create sf object
sf_df &lt;- sf::st_as_sf(cbind(data@coords, pa = data@pa),
                      coords = c("X", "Y"),
                      crs = terra::crs(predictors,
                                       proj = TRUE))

# Spatial blocks
spatial_folds &lt;- cv_spatial(x = sf_df,
                            column = "pa",
                            rows_cols = c(8, 10),
                            k = 5,
                            hexagon = FALSE,
                            selection = "systematic")

model &lt;- train(method = "Maxnet",
               data = data,
               fc = "l",
               reg = 0.8,
               folds = spatial_folds)
## End(Not run)

## Train presence absence models
# Prepare presence and absence locations
p_coords &lt;- virtualSp$presence
a_coords &lt;- virtualSp$absence
# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = a_coords,
                   env = predictors[[1:5]])

## Train an Artificial Neural Network model
model &lt;- train("ANN",
               data = data,
               size = 10)

## Train a Random Forest model
model &lt;- train("RF",
               data = data,
               ntree = 300)

## Train a Boosted Regression Tree model
model &lt;- train("BRT",
               data = data,
               n.trees = 300,
               shrinkage = 0.001)

## Multiple methods trained together with default arguments
output &lt;- train(method = c("ANN", "BRT", "RF"),
                data = data,
                size = 10)
output$ANN
output$BRT
output$RF

## Multiple methods trained together passing extra arguments
output &lt;- train(method = c("ANN", "BRT", "RF"),
                data = data,
                size = 10,
                ntree = 300,
                n.trees = 300,
                shrinkage = 0.001)
output
</code></pre>


</div>