<div class="container">

<table style="width: 100%;"><tr>
<td>step.spind</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise model selection for GEEs and WRMs</h2>

<h3>Description</h3>

<p>Stepwise model selection by AIC or AICc for WRMS
and QIC for GEEs
</p>


<h3>Usage</h3>

<pre><code class="language-R">step.spind(object, data, steps = NULL, trace = TRUE, AICc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A model of class <code>WRM</code> or <code>GEE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data used to fit that model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>Number of iterations the procedure should
go through before concluding. The default is to use the number of
variables as the number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Should R print progress updates and the final, best model found
to the console? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc</code></td>
<td>
<p>Logical. In the case of model selection with <code>WRM</code>s,
should AICc be used to determine which model is best rather than AIC?
This argument is ignored for <code>GEE</code>s. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs stepwise variable elimination
for model comparison. Each iteration will try to find the best
combination of predictors for a given number of variables based
on AIC, AICc, or QIC, and then use that as the base model
for the next iteration until there are no more variables to eliminate.
Alternatively, it will terminate when reducing the number of variables
while respecting the model hierarchy no longer produces lower
information criterion values.
</p>


<h3>Value</h3>

<p>A list with components <code>model</code> and <code>table</code>.
<code>model</code> is always formula for the best model found by the procedure.
<code>table</code> is always a data frame, but the content varies for each type of
model.
For <code>WRM</code>'s, the columns
returned are
</p>

<ul>
<li>
<p><code>Deleted.Vars</code> Variables retained from the previous iteration
which were tested in the current iteration.
</p>
</li>
<li>
<p><code>LogLik</code> Log-likelihood of the model.
</p>
</li>
<li>
<p><code>AIC</code> AIC score for the model.
</p>
</li>
<li>
<p><code>AICc</code> AICc score for the model.
</p>
</li>
</ul>
<p>For <code>GEE</code>s:
</p>

<ul>
<li>
<p><code>Deleted.Vars</code> Variables retained from the previous iteration
which were tested in the current iteration.
</p>
</li>
<li>
<p><code>QIC</code> Quasi-information criterion of the model.
</p>
</li>
<li>
<p><code>Quasi.Lik</code> Quasi-likelihood of the model.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Currently, the function only supports backwards model selection
(i.e. one must start with a full model and subtract variables).
Forward and both directions options may be added later.
</p>


<h3>Author(s)</h3>

<p>Sam Levin
</p>


<h3>References</h3>

<p>Hardin, J.W. &amp; Hilbe, J.M. (2003) Generalized Estimating Equations. Chapman and Hall, New York.
</p>


<h3>See Also</h3>

<p><code>qic.calc</code>, <code>aic.calc</code>, <code>add1</code>,
<code>step</code>, <code>stepAIC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For demonstration only. We are artificially imposing a grid structure
# on data that is not actually spatial data

library(MASS)
data(birthwt)

x &lt;- rep(1:14, 14)
y &lt;- as.integer(gl(14, 14))
coords &lt;- cbind(x[-(190:196)], y[-(190:196)])

## Not run: 
formula &lt;- formula(low ~ age + lwt + race + smoke + ftv + bwt)

mgee &lt;- GEE(formula,
            family = "gaussian",
            data = birthwt,
            coord = coords,
            corstr = "fixed",
            scale.fix = TRUE)

ss &lt;- step.spind(mgee, birthwt)

best.mgee &lt;- GEE(ss$model,
                 family = "gaussian",
                 data = birthwt,
                 coord = coords,
                 corstr = "fixed",
                 scale.fix = TRUE)

summary(best.mgee, printAutoCorPars = FALSE)

## End(Not run)

</code></pre>


</div>