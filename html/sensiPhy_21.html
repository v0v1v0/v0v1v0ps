<div class="container">

<table style="width: 100%;"><tr>
<td>intra_samp_phyglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interaction between intraspecific variability and species sampling - Phylogenetic Logistic Regression</h2>

<h3>Description</h3>

<p>Performs analyses of sensitivity to species sampling by randomly removing
species and detecting the effects on parameter estimates in a phylogenetic
logistic regression, while taking into account potential
interactions with intraspecific variability.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intra_samp_phyglm(
  formula,
  data,
  phy,
  n.sim = 10,
  n.intra = 3,
  breaks = seq(0.1, 0.5, 0.1),
  btol = 50,
  Vx = NULL,
  distrib = "normal",
  x.transf = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The model formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>The number of times species are randomly deleted for each
<code>break</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.intra</code></td>
<td>
<p>Number of datasets resimulated taking into account intraspecific variation (see: <code>"intra_phyglm"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A vector containing the percentages of species to remove.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btol</code></td>
<td>
<p>Bound on searching space. For details see <code>phyloglm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vx</code></td>
<td>
<p>Name of the column containing the standard deviation or the standard error of the predictor 
variable. When information is not available for one taxon, the value can be 0 or <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distrib</code></td>
<td>
<p>A character string indicating which distribution to use to generate a random value for the response 
and/or predictor variables. Default is normal distribution: "normal" (function <code>rnorm</code>).
Uniform distribution: "uniform" (<code>runif</code>)
Warning: we recommend to use normal distribution with Vx = standard deviation of the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.transf</code></td>
<td>
<p>Transformation for the predictor variable (e.g. <code>"log"</code> or <code>"sqrt"</code>). Please use this 
argument instead of transforming data in the formula directly (see also details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>phylolm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function randomly removes a given percentage of species (controlled by
<code>breaks</code>) from the full phylogenetic logistic regression, fits a phylogenetic
logistic regression model without these species using <code>phylolm</code>,
repeats this many times (controlled by <code>n.sim</code>), stores the results and
calculates the effects on model parameters. 
This operation is repeated <code>n.intra</code> times for simulated values of the dataset, 
taking into account intraspecific variation. At each iteration, the function generates a 
random value for each row in the dataset using the standard deviation or errors supplied, and 
evaluates the effects of sampling within that iteration.
</p>
<p>All phylogenetic models from <code>phylolm</code> can be used, i.e. <code>BM</code>,
<code>OUfixedRoot</code>, <code>OUrandomRoot</code>, <code>lambda</code>, <code>kappa</code>,
<code>delta</code>, <code>EB</code> and <code>trend</code>. See ?<code>phylolm</code> for details.
</p>
<p>Currently, this function can only implement simple logistic models (i.e. <code class="reqn">trait~
predictor</code>). In the future we will implement more complex models.
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>samp_phyglm</code> returns a list with the following
components:
</p>
<p><code>formula</code>: The formula
</p>
<p><code>full.model.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (e.g. <code>lambda</code> or <code>kappa</code>) for
the full model without deleted species.
</p>
<p><code>sensi.estimates</code>: A data frame with all simulation
estimates. Each row represents a model rerun with a given number of species
<code>n.remov</code> removed, representing <code>n.percent</code> of the full dataset.
Columns report the calculated regression intercept (<code>intercept</code>),
difference between simulation intercept and full model intercept (<code>DIFintercept</code>),
the percentage of change in intercept compared to the full model (<code>intercept.perc</code>)
and intercept p-value (<code>pval.intercept</code>). All these parameters are also reported
for the regression slope (<code>DIFestimate</code> etc.). Additionally, model aic value
(<code>AIC</code>) and the optimised value (<code>optpar</code>) of the phylogenetic
parameter (e.g. <code>kappa</code> or <code>lambda</code>, depending on the phylogenetic model
used) are reported. Lastly we reported the standardised difference in intercept 
(<code>sDIFintercept</code>) and slope (<code>sDIFestimate</code>).
</p>
<p><code>sign.analysis</code> For each break (i.e. each percentage of species
removed) this reports the percentage of statistically significant (at p&lt;0.05)
intercepts (<code>perc.sign.intercept</code>) over all repetitions as well as the
percentage of statisticaly significant (at p&lt;0.05) slopes (<code>perc.sign.estimate</code>).
</p>
<p><code>data</code>: Original full dataset.
</p>


<h3>Note</h3>

<p>Please be aware that dropping species may reduce power to detect 
significant slopes/intercepts and may partially be responsible for a potential 
effect of species removal on p-values. Please also consult standardised differences
in the (summary) output.
</p>


<h3>Author(s)</h3>

<p>Gustavo Paterno, Gijsbert D.A. Werner &amp; Caterina Penone
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Werner, G.D.A., Cornwell, W.K., Sprent, J.I., Kattge, J. &amp; Kiers, E.T. (2014).
A single evolutionary innovation drives the deep evolution of symbiotic N2-fixation
in angiosperms. Nature Communications, 5, 4087.
</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.
</p>


<h3>See Also</h3>

<p><code>phylolm</code>, <code>samp_phyglm</code>,
<code>intra_phyglm</code>,<code>intra_samp_phylm</code>,
<code>sensi_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(6987)
phy = rtree(100)
x = rTrait(n=1,phy=phy,parameters=list(ancestral.state=2,optimal.value=2,sigma2=1,alpha=1))
X = cbind(rep(1,100),x)
y = rbinTrait(n=1,phy=phy, beta=c(-1,0.5), alpha=.7 ,X=X)
z = rnorm(n = length(x),mean = mean(x),sd = 0.1*mean(x))
dat = data.frame(y, x, z)
#Run sensitivity analysis:
intra_samp &lt;- intra_samp_phyglm(formula = y ~ x, data = dat, phy = phy, 
                               n.sim=10, n.intra = 3,
                               breaks=seq(.1,.5,.1),
                               Vx = "z", distrib="normal", x.transf=NULL)
summary(intra_samp)
sensi_plot(intra_samp)

## End(Not run)
</code></pre>


</div>