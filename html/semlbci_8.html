<div class="container">

<table style="width: 100%;"><tr>
<td>ci_bound_wn_i</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood-based Confidence Bound By Wu-Neale-2012</h2>

<h3>Description</h3>

<p>User the method proposed by Wu and Neale
(2012) to find the lower or upper bound of the likelihood-based
confidence interval (LBCI) for one parameter in a structural
equation model fitted in <code>lavaan::lavaan()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci_bound_wn_i(
  i = NULL,
  npar = NULL,
  sem_out = NULL,
  f_constr = NULL,
  which = NULL,
  history = FALSE,
  perturbation_factor = 0.9,
  lb_var = -Inf,
  standardized = FALSE,
  wald_ci_start = !standardized,
  opts = list(),
  ciperc = 0.95,
  ci_limit_ratio_tol = 1.5,
  verbose = FALSE,
  sf = 1,
  sf2 = 0,
  p_tol = 5e-04,
  std_method = "internal",
  bounds = "none",
  xtol_rel_factor = 1,
  ftol_rel_factor = 1,
  lb_prop = 0.05,
  lb_se_k = 3,
  try_harder = 0,
  fit_lb = -Inf,
  fit_ub = +Inf,
  timeout = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>The position of the target parameter as appeared in the
parameter table of an lavaan object, generated by
<code>lavaan::parameterTable()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>The number of free parameters, including those
constrained to be equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sem_out</code></td>
<td>
<p>The fit object. Currently supports
lavaan::lavaan objects only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_constr</code></td>
<td>
<p>The constraint function generated by
<code>set_constraint()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Whether the lower bound or the upper bound is to be
found. Must be <code>"lbound"</code> or <code>"ubound"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>history</code></td>
<td>
<p>Not used. Kept for backward compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perturbation_factor</code></td>
<td>
<p>A number multiplied to the parameter
estimates in <code>sem_out</code>. Using the parameter estimates as starting
values may lead to errors in the first few iterations. Default is
.90. This argument is ignored if <code>wald_ci_start</code> is 'TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_var</code></td>
<td>
<p>The lower bound for free parameters that are
variances. If equal to <code>-Inf</code>, the default, <code>lb_prop</code> and
<code>lb_se_k</code> will be used to set the lower bounds for free variances.
If it is a number, it will be used to set the lower bounds for all
free variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>If <code>TRUE</code>, the LBCI is for the requested
estimate in the standardized solution. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald_ci_start</code></td>
<td>
<p>If <code>TRUE</code>, there are no equality
constraints in the model, and the target parameter is not a
user-defined parameter, the Wald confidence bounds will be used as
the starting value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>Options to be passed to <code>nloptr::nloptr()</code>, the current
optimizer. Default is <code>list()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciperc</code></td>
<td>
<p>The intended coverage probability for the confidence
interval. Default is .95, and the bound for a 95% confidence
interval will be sought.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_limit_ratio_tol</code></td>
<td>
<p>The tolerance for the ratio of <code>a</code> to
<code>b</code>, where <code>a</code> is the distance between an LBCI limit and the point
estimate, and the <code>b</code> is the distance between the original
confidence limit (by default the Wald CI in <code>lavaan::lavaan()</code>)
and the point estimate. If the ratio is larger than this value or
smaller than the reciprocal of this value, a warning is set in the
status code. Default is 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, the function will store more diagnostic
information in the attribute <code>diag</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>A scaling factor. Used for robust confidence bounds.
Default is 1. Computed by an internal function called by
<code>semlbci()</code> when <code>robust = "satorra.2000"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf2</code></td>
<td>
<p>A shift factor. Used for robust confidence bounds.
Default is 0. Computed by an internal function called by
<code>semlbci()</code> when <code>robust = "satorra.2000"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_tol</code></td>
<td>
<p>Tolerance for checking the achieved level of
confidence. If the absolute difference between the achieved level
and <code>ciperc</code> is greater than this amount, a warning is set in the
status code and the bound is set to <code>NA</code>. Default is 5e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_method</code></td>
<td>
<p>The method used to find the standardized
solution. If equal to <code>"lavaan"</code>,
<code>lavaan::standardizedSolution()</code> will be used. If equal to
<code>"internal"</code>, an internal function will be used. The <code>"lavaan"</code>
method should work in all situations, but the <code>"internal"</code> method
is usually much faster. Default is <code>"internal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>Default is <code>""</code> and this function will set the lower
bounds to <code>lb_var</code> for variances. Other valid values are those
accepted by <code>lavaan::lavaan()</code>. Ignored for now.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol_rel_factor</code></td>
<td>
<p>Multiply the default <code>xtol_rel</code> by a number,
usually a positive number equal to or less than 1, to change the
default termination criterion. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol_rel_factor</code></td>
<td>
<p>Multiply the default <code>ftol_rel</code> by a number,
usually a positive number equal to or less than 1, to change the
default termination criterion. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_prop</code></td>
<td>
<p>Used by an internal function to set the lower bound
for free variances. Default is .05, setting the lower bound to
.05 * estimate. Used only if the lower bound set by <code>lb_se_k</code> is
negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_se_k</code></td>
<td>
<p>Used by an internal function to set the lower bound
for free variances. Default is 3, the estimate minus 3 standard
error. If negative, the lower bound is set using <code>lb_prop</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try_harder</code></td>
<td>
<p>If error occurred
in the optimization, how many more
times to try. In each new attempt,
the starting values will be randomly
jittered. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_lb</code></td>
<td>
<p>The vector of lower
bounds of parameters. Default is
<code>-Inf</code>, setting the lower bounds to
<code>-Inf</code> for all parameters except for
free variances which are controlled
by <code>lb_var</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_ub</code></td>
<td>
<p>The vector of upper
bounds of parameters. Default is
<code>+Inf</code>, setting the lower bounds to
<code>+Inf</code> for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeout</code></td>
<td>
<p>The approximate
maximum time for the search, in
second. Default is 300 seconds
(5 minutes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments. Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Important Notice</h4>

<p>This function is not supposed to be used directly by users in
typical scenarios. Its interface is user-<em>unfriendly</em> because it
should be used through <code>semlbci()</code>. It is exported such that
interested users can examine how a confidence bound is found, or
use it for experiments or simulations.
</p>



<h4>Usage</h4>

<p>This function is the lowest level function used by <code>semlbci()</code>.
<code>semlbci()</code> calls this function once for each bound of each
parameter. To use it, <code>set_constraint()</code> needs to be called first
to create the equality constraint required by the algorithm
proposed by Wu and Neale (2012).
</p>



<h4>Algorithm</h4>

<p>This function implements the algorithm presented in Wu and Neale
(2012; see also Pek &amp; Wu, 2015, Equation 12) that estimates all
free parameters in the optimization.
</p>



<h4>Limitation(s)</h4>

<p>This function does not yet implement the method by Wu and Neale
(2012) for an estimate close to an attainable bound.
</p>



<h3>Value</h3>

<p>A <code>cibound</code>-class object which is a list with three elements:
</p>

<ul>
<li> <p><code>bound</code>: A single number. The value of the bound located. <code>NA</code> is
the search failed for various reasons.
</p>
</li>
<li> <p><code>diag</code>: A list of diagnostic information.
</p>
</li>
<li> <p><code>call</code>: The original call.
</p>
</li>
</ul>
<p>A detailed and organized output can be printed by the default print
method (<code>print.cibound()</code>).
</p>


<h3>References</h3>

<p>Pek, J., &amp; Wu, H. (2015). Profile likelihood-based confidence
intervals and regions for structural equation models.
<em>Psychometrika, 80</em>(4), 1123-1145.
<a href="https://doi.org/10.1007/s11336-015-9461-1">doi:10.1007/s11336-015-9461-1</a>
</p>
<p>Wu, H., &amp; Neale, M. C. (2012). Adjusted confidence intervals for a
bounded parameter. <em>Behavior Genetics, 42</em>(6), 886-898.
<a href="https://doi.org/10.1007/s10519-012-9560-z">doi:10.1007/s10519-012-9560-z</a>
</p>


<h3>See Also</h3>

<p><code>print.cibound()</code>, <code>semlbci()</code>, <code>ci_i_one()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simple_med)
dat &lt;- simple_med

mod &lt;-
"
m ~ x
y ~ m
"

fit_med &lt;- lavaan::sem(mod, simple_med, fixed.x = FALSE)

fn_constr0 &lt;- set_constraint(fit_med)

out1l &lt;- ci_bound_wn_i(i = 1,
                       npar = 5,
                       sem_out = fit_med,
                       f_constr = fn_constr0,
                       which = "lbound")
out1l

</code></pre>


</div>