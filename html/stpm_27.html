<div class="container">

<table style="width: 100%;"><tr>
<td>spm.impute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Data Imputation with SPM</h2>

<h3>Description</h3>

<p>Multiple Data Imputation with SPM
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm.impute(
  x,
  id = 1,
  case = 2,
  t1 = 3,
  t2 = 3,
  covariates = 4,
  minp = 5,
  theta_range = seq(0.01, 0.2, by = 0.001)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A longitudinal dataset with missing observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A name (text) or index (numeric) of ID column. Default: 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>A case status column name (text) or index (numeric). Default: 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>A t1 (or t if short format is used) column name (text) or index (numeric). Default: 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>A t2 column name (if long format is used) (text) or index (numeric). Default: 4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A list of covariate column names or indices. Default: 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minp</code></td>
<td>
<p>Number of imputations. Default: 5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_range</code></td>
<td>
<p>A range of parameter theta used for optimization, default: seq(0.01, 0.15, by=0.001).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list(imputed, imputations)
</p>
<p>imputed An imputed dataset.
</p>
<p>imputations Temporary imputed datasets used in multiple imputaitons.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(stpm) 
##Data preparation ##
data &lt;- simdata_discr(N=1000, dt = 2)
miss.id &lt;- sample(x=dim(data)[1], size=round(dim(data)[1]/4)) # ~25% missing data
incomplete.data &lt;- data
incomplete.data[miss.id,5] &lt;- NA
incomplete.data[miss.id-1,6] &lt;- NA
## End of data preparation ##

# Estimate parameters from the complete dataset #
p &lt;- spm_discrete(data, theta_range = seq(0.075, 0.09, by=0.001))
p

##### Multiple imputation with SPM #####
imp.data &lt;- spm.impute(x=incomplete.data, 
                      minp=5, 
                      theta_range=seq(0.075, 0.09, by=0.001))$imputed
head(imp.data)
## Estimate SPM parameters from imputed data and compare them to the p ##
pp.test &lt;- spm_discrete(imp.data, theta_range = seq(0.075, 0.09, by=0.001))
pp.test

## End(Not run)
</code></pre>


</div>