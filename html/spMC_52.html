<div class="container">

<table style="width: 100%;"><tr>
<td>transiogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Transition Probabilities Estimation for 1-D MC</h2>

<h3>Description</h3>

<p>The function estimates transition probabilities matrices for a <code class="reqn">1</code>-D continuous lag spatial Markov chain.</p>


<h3>Usage</h3>

<pre><code class="language-R">transiogram(data, coords, direction, max.dist = Inf, 
            mpoints = 20, tolerance = pi / 8, reverse = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a <code class="reqn">d</code>-D numerical vector (or versor) which represents the chosen direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>a numerical value which defines the maximum lag value. It's <code>Inf</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpoints</code></td>
<td>
<p>a numerical value which defines the number of lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value for the tolerance angle (in radians). It's <code>pi/8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the transition probabilities of the reversible chain are also computed. It's <code>FALSE</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Empirical probabilities are estimated by counting such pairs of observations which satisfy some properties, and by normalizing the result.
</p>
<p>A generic pair of sample points <code class="reqn">s_i</code> and <code class="reqn">s_j</code>, where <code class="reqn">i \neq j</code>, must satisfy the following properties:
</p>

<ul>
<li> <p><code class="reqn">\Vert s_i - s_j \Vert \in [a, a+\frac{m}{n}],</code> where <code class="reqn">a</code> is a non negative real value, while <code class="reqn">m</code> denotes the maximum lag value (<code>max.dist</code>) and <code class="reqn">n</code> is the number of lag intervals (<code>mpoints</code>).
</p>
</li>
<li>
<p> the lag vector <code class="reqn">h = s_i - s_j</code> must have the same direction of the vector <code class="reqn">\phi</code> (<code>direction</code>) with a certain angular <code>tolerance</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object of the class <code>transiogram</code> is returned. The function <code>print.transiogram</code> is used to print computed probabilities. The object is a list with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Tmat</code></td>
<td>
<p>a 3-D array containing the probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOSE</code></td>
<td>
<p>a 3-D array containing the standard error calculated for the log odds of the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>a vector containing one-dimensional lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string which specifies that computed probabilities are empirical.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>predict.tpfit</code>, <code>predict.tpfit</code>, <code>plot.transiogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Estimate empirical transition 
# probabilities by points
transiogram(ACM$MAT3, ACM[, 1:3], c(0, 0, 1), 200, 5)
</code></pre>


</div>