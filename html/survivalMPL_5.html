<div class="container">

<table style="width: 100%;"><tr>
<td>coxph_mpl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Cox Proportional Hazards Regression Model Via MPL</h2>

<h3>Description</h3>

<p>Simultaneously estimate the regression coefficients and the 
baseline hazard function of proportional hazard Cox models 
using maximum penalised likelihood (MPL).
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxph_mpl(formula, data, subset, na.action, control, ...)

## S3 method for class 'coxph_mpl'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a formula object, with the response on the left of a <code>~</code> operator, and 
the terms on the right.  The response must be a survival object as 
returned by the <code>Surv</code> function (in the <code>Surv</code>, use type = "interval2" with interval censored data). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data.frame in which to interpret the variables named in 
the <code>formula</code>, or in the <code>subset</code> argument. If no dataset is indicated,
variables will be taken from the global environment. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>expression indicating which subset of the rows of data should be used in 
the fit. All observations are included by default. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a missing-data filter function.  This is applied to the model.frame
after any subset argument has been used.  Default is <code>options()\$na.action</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object inheriting from class <code>coxph_mpl</code>, representing
a fitted Cox proportional hazard model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>Object of class <code>coxph_mpl.control</code> specifying control options like 
basis choice, smoothing parameter value and maximum number of itereations, 
for example. Refer to <code>coxph_mpl.control</code> to see the defaults.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments. In <code>coxph_mpl</code>, these elements, 
will be passed to <code>coxph_mpl.control</code>. In <code>print.coxph_mpl</code>, 
these elements will be passed to the <code>print</code> function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>coxph_mpl</code> allows to simultaneously estimate the regression
coefficients and baseline hazard function of Cox proportional hazard models,
with right censored data and independent censoring, by maximising a penalised
likelihood, in which a penalty function is used to smooth the baseline hazard 
estimate. 
</p>
<p>Optimisation is achieved using a new iterative algorithm, which combines 
Newton's method and the multiplicative iterative algorithm proposed by 
Ma (2010), and respects the non-negativity constraints on the baseline 
hazard estimate (refer to Ma, Couturier, Heritier and Marschner (2021)).  
</p>
<p>The centered <b>X</b> matrix is used in the optimisation process to get a 
better shaped (penalised) log-likelihood. Baseline hazard parameter estimates 
and covariance matrix are then respectively corrected using a correction factor
and the delta method.
</p>
<p>When the chosen basis is not uniform, estimates of zero are possible for 
baseline hazard parameters and will correspond to active constraints as 
defined by Moore and Sadler (2008). Inference, as described by Ma, Heritier and 
Lo (2014), is then corrected accordingly (refer to Moore and Sadler (2008)) by
adequately 'cutting' the corresponding covariance matrix.
</p>
<p>There are currently 3 ways to perform inference on model parameters:  
</p>
<p>Let <code class="reqn">H</code> denote the Hessian matrix of the unpenalised likelihood, 



<code class="reqn">Q</code> denote the product of the first order derivative of 
the penalised likelihood by its transpose, and <code class="reqn">M_{2}</code> denote the second 
order derivative of the penalised likelihood. Then, 
</p>

<ul>
<li> <p><code>'H'</code> refers to <code class="reqn">H^{-1}</code>, the inverse of the Hessian matrix, 

</p>
</li>
<li> <p><code>'M2QM2'</code>, refers to the sandwich formula <code class="reqn">M_{2}^{-1} Q M_{2}^{-1}</code>,

</p>
</li>
<li> <p><code>'M2HM2'</code>, refers to the sandwich formula <code class="reqn">M_{2}^{-1} H M_{2}^{-1}</code>.
</p>
</li>
</ul>
<p>Simulations analysing the coverage levels of confidence intervals for the 
regression parameters seem to indicate that <code class="reqn">M_{2}^{-1} H M_{2}^{-1}</code> 
performs better when using the uniform basis, and that 
<code class="reqn">M_{2}^{-1} Q M_{2}^{-1}</code> performs when using other bases.
</p>


<h3>Value</h3>

<p>an object of class <code>coxph_mpl</code> representing the fit.
See <code>coxph_mpl.object</code> for details.
</p>


<h3>Author(s)</h3>

<p>Dominique-Laurent Couturier, Jun Ma, Stephane Heritier, Maurizio Manuguerra. Design inspired by the function 
<code>coxph</code> of the <code>survival</code> package.</p>


<h3>References</h3>

<p>Ma, J. and Couturier, D.-L., and Heritier, S. and Marschner, I.C. (2021), Penalized likelihood estimation of the proportional hazards model for survival data with interval censoring. <em>International Journal of Biostatistics</em>,doi:10.1515/ijb-2020-0104.
</p>
<p>Ma, J. and Heritier, S. and Lo, S. (2014), On the Maximum Penalised
Likelihood Approach for Proportional Hazard Models with Right Censored 
Survival Data. <em>Computational Statistics and Data Analysis</em> <b>74</b>, 142-156.
</p>
<p>Ma, J. (2010), Positively constrained multiplicative iterative algorithm for 
maximum penalised likelihood tomographic reconstruction. 
<em>IEEE Transactions On Signal Processing</em> <b>57</b>, 181-192.
</p>
<p>Moore, T. J. and Sadler, B. M. and Kozick R. J. (2008), Maximum-Likelihood 
Estimation, the Cramer-Rao Bound, and the Method of Scoring With Parameter 
Constraints, <em>IEEE Transactions On Signal Processing</em> <b>56, 3</b>, 895-907. 
</p>
<p>Moore, D. K. (2016), Applied Survival Analysis Using R, <em>Springer</em> . 
</p>


<h3>See Also</h3>

<p><code>coxph_mpl.object</code>,  <code>coxph_mpl.control</code>,
<code>summary.coxph_mpl</code>  and  <code>plot.coxph_mpl</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## right censoring example based on the dataset 'lung' 
## of the survival package (refer to ?lung)
## with hazard approximated by means of a step function (default).
data(lung)

fit_mpl &lt;- coxph_mpl(Surv(time, status == 2) ~ age + sex + ph.karno + wt.loss, data = lung)

summary(fit_mpl)

## interval censoring example 
## (refer to ?bcos2 and to Moore (2016, example 12.2))
## with hazard approximated by means of m-splines

data(bcos2)

fit_mpl &lt;- coxph_mpl(Surv(left, right, type="interval2") ~ treatment, 
                     data = bcos2, basis="m")
summary(fit_mpl)


## End(Not run)
</code></pre>


</div>