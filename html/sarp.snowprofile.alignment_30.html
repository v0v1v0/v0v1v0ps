<div class="container">

<table style="width: 100%;"><tr>
<td>plotSPalignment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Align and plot two snow profiles using DTW</h2>

<h3>Description</h3>

<p>This is a plotting routine for the DTW alignment of two snow profiles. Either provide two snow profiles or
a <code>dtwSP</code> alignment object. Don't resize the figure, otherwise the plotted alignment segments will not be
in correct place anymore! If you need a specific figure size, use <code>grDevices::png</code> with a width/height aspect
ratio of about 5/3.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSPalignment(
  query,
  ref,
  dtwAlignment = NULL,
  keep.alignment = FALSE,
  plot.costDensity = FALSE,
  plot.warpedQuery = TRUE,
  label.ddate = FALSE,
  segCol = "gray70",
  segLty = "dotted",
  segLwd = 1,
  segTidy = FALSE,
  segInd = TRUE,
  segEmph = NA,
  cex = 1,
  mainQu = "query",
  mainRef = "reference",
  mainQwarped = "warped query",
  emphasizeLayers_qu = FALSE,
  emphasizeLayers_ref = FALSE,
  failureLayers_qu = FALSE,
  failureLayers_qu_col = "red",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>The query snowprofile to be warped</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>The reference snowprofile to be warped against</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtwAlignment</code></td>
<td>
<p><code>dtwSP</code> object (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.alignment</code></td>
<td>
<p>Return <code>dtwSP</code> object with resampled query, ref and warped query? boolean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.costDensity</code></td>
<td>
<p>First graph, plotCostDensitySP with warping path? boolean, default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.warpedQuery</code></td>
<td>
<p>plot warped query additionally to query, ref and alignment segments? (i.e. three pane plot) boolean, default = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.ddate</code></td>
<td>
<p>Label deposition date in profiles? (Only possible if <code>ddate</code> is given in 'dims', cf distanceSPlayers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segCol</code></td>
<td>
<p>Color of alignment segments. Passed to gpar, default = "gray70"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segLty</code></td>
<td>
<p>Linestyle of alignment segments. Passed to gpar, default = "dotted"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segLwd</code></td>
<td>
<p>Linewidth of alignment segments, default = 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segTidy</code></td>
<td>
<p>Tidy up alignment segments, if profiles have not been resampled? boolean,
default FALSE i.e. one segment line per (synthetic) layer interface -&gt; supports visual understanding of alignment, but is also often confusing
(segTidy currently only implemented for tidying up to gtype and hardness interfaces)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segInd</code></td>
<td>
<p>Index vector of query layers that will get alignment segments drawn. Note, that the profiles might get resampled, so pre-calculate your correct indices!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segEmph</code></td>
<td>
<p>Index vector of query layers, the alignment segments of which will be emphasized (thick and red). Note, that the profiles might get resampled, so pre-calculate your correct indices!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>font size, cf. <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainQu</code></td>
<td>
<p>subtitle for query subfigure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainRef</code></td>
<td>
<p>subtitle for reference subfigure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainQwarped</code></td>
<td>
<p>subtitle for warped query subfigure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emphasizeLayers_qu</code></td>
<td>
<p>emphasize Layers in query, see sarp.snowprofile::plot.snowprofile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emphasizeLayers_ref</code></td>
<td>
<p>emphasize Layers in reference, see sarp.snowprofile::plot.snowprofile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failureLayers_qu</code></td>
<td>
<p>draw arrow to failure layers (see sarp.snowprofile::plot.snowprofile)? provide height vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failureLayers_qu_col</code></td>
<td>
<p>color of arrow(s) (individual color string or vector, see sarp.snowprofile::plot.snowprofile)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>distanceSPlayers</code> and <code>dtwSP</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>dtw object with the resampled '$query' and '$reference', as well as the warped query '$queryWarped'
(only if keep.alignment is TRUE)
</p>


<h3>Author(s)</h3>

<p>fherla
</p>


<h3>Examples</h3>

<pre><code class="language-R">
plotSPalignment(SPpairs$B_modeled1, SPpairs$B_modeled2)

plotSPalignment(SPpairs$B_modeled1, SPpairs$B_modeled2, dims = c("gtype"), weights = c(1))

## alternatively keep alignment:
alignment &lt;- plotSPalignment(SPpairs$B_modeled1, SPpairs$B_modeled2, keep.alignment = TRUE)
print(paste("Similarity between profiles:", alignment$sim))

## alternatively, with precomputed alignment and emphasized layer matches:
dtwAlignment &lt;- dtwSP(SPpairs$A_modeled, SPpairs$A_manual, open.end = FALSE)
plotSPalignment(dtwAlignment = dtwAlignment, segEmph = c(190, 192))

## directly after plotting, add text to figure:
grid::grid.text("Profiles SPpairs$A (modeled/manual)", x = 0.5, y = 0.8,
                gp = grid::gpar(fontsize=12, col="grey"))


</code></pre>


</div>