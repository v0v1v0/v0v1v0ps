<div class="container">

<table style="width: 100%;"><tr>
<td>mat_sqrt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computation of “square root” of symmetric positive definite matrix
</h2>

<h3>Description</h3>

<p><code>mat_sqrt</code> is not usually directly called by users, but arguments may be passed to it through higher-level calls (see Examples).  
For given matrix <b>C</b>, it computes a factor <b>L</b> such that <b>C</b> = <b>L</b> * t(<b>L</b>), handling issues with nearly-singular matrices.   The default behavior is to try Cholesky factorization, and use <code>eigen</code> if it fails. 
Matrix roots are not unique (for example, they are lower triangular for <code>t(chol(.))</code>, and symmetric for <code>svd(.)</code>. As matrix roots are used to simulate samples under the fitted model (in particular in the parametric bootstrap implemented in <code>fixedLRT</code>), this implies that for given seed of random numbers, these samples will differ with these different methods (although their distribution should be identical). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mat_sqrt(m = NULL, symSVD = NULL, try.chol = TRUE, condnum=1e12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>The matrix whose 'root' is to be computed. This argument is ignored if <code>symSVD</code> is provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symSVD</code></td>
<td>

<p>A list representing the symmetric singular value decomposition of the matrix which 'root' is to be computed. Must have elements <code>$u</code>, a matrix of eigenvectors, and <code>$d</code>, a vector of eigenvalues. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try.chol</code></td>
<td>

<p>If <code>try.chol=TRUE</code>, the Cholesky factorization will be tried. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condnum</code></td>
<td>
<p> (large) numeric value.  In the case <code>chol()</code> was tried and failed, the matrix is regularized so that its (matrix 2-norm) condition number is reduced to <code>condnum</code> (in version 3.10.0 this correction has been implemented more exactly than in previous versions).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For non-NULL <code>m</code>, its matrix root, with rows and columns labelled according to the columns of the original matrix.
If <code>eigen</code> was used, the symmetric singular value decomposition (a list with members <code>u</code> (matrix of eigenvectors) and <code>d</code> (vector of eigenvalues)) is given as attribute. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## try.chol argument passed to mat_sqrt 
## through the '...' argument of higher-level functions
## such as HLCor, corrHLfit, fixedLRT:
data("scotlip")
HLCor(cases~I(prop.ag/10) +adjacency(1|gridcode)+offset(log(expec)),
      ranPars=list(rho=0.174),adjMatrix=Nmatrix,family=poisson(),
      data=scotlip,try.chol=FALSE)

## End(Not run)

</code></pre>


</div>