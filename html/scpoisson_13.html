<div class="container">

<table style="width: 100%;"><tr>
<td>HclustDepart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster cells in a recursive way</h2>

<h3>Description</h3>

<p>This function returns a list with clustering results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HclustDepart(data, maxSplit = 10, minSize = 10, sim = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A UMI count matrix with genes as rows and cells as columns or an S3 object for class 'scppp'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxSplit</code></td>
<td>
<p>A numeric value specifying the maximum allowable number of splitting steps (default 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minSize</code></td>
<td>
<p>A numeric value specifying the minimal allowable cluster size (the number of cells for the smallest cluster, default 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>A numeric value specifying the number of simulations during the Monte Carlo simulation procedure for statistical significance test, i.e. n_sim argument when apply sigclust2 (default = 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a function used to get cell clustering results in a recursive way.
At each step, the two-way approximation is re-calculated again within each subcluster,
and the potential for further splitting is calculated using sigclust2.
A non significant result suggests cells are reasonably homogeneous
and may come from the same cell type. In addition, to avoid over splitting,
the maximum allowable number of splitting steps <code>maxSplit</code>
(default is 10, which leads to at most <code class="reqn">2^{10} = 1024</code> total number of clusters) and
minimal allowable cluster size <code>minSize</code>
(the number of cells in a cluster allowed for further splitting, default is 10)
may be set beforehand.
Thus the process is stopped when any of the conditions
is satisfied: (1) the split is no longer statistically significant;
(2) the maximum allowable number of splitting steps is reached;
(3) any current cluster has less than 10 cells.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li>
<p><code>res2</code>: a data frame contains two columns: names (cell names) and clusters (cluster label)
</p>
</li>
<li>
<p><code>sigclust_p</code>: a matrix with cells to cluster as rows, split index as columns,
the entry in row <code>i</code> and column <code>j</code> denoting the p-value
for the cell <code>i</code> at split step <code>j</code>
</p>
</li>
<li>
<p><code>sigclust_z</code>: a matrix with cells to cluster as rows, split index as columns,
the entry in row <code>i</code> and column <code>j</code> denoting the z-score
for the cell <code>i</code> at split step <code>j</code>
</p>
</li>
</ul>
<p>If the input is an S3 object for class 'scppp', clustering result will be stored in object scppp under "clust_results".
</p>


<h3>Examples</h3>

<pre><code class="language-R">
test_set &lt;- matrix(rpois(500, 0.5), nrow = 10)
HclustDepart(test_set)

</code></pre>


</div>