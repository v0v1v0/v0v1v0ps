<div class="container">

<table style="width: 100%;"><tr>
<td>seqAllocatedMergeSplit_base</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Base Functionality for the seqAllocatedMergeSplit Function</h2>

<h3>Description</h3>

<p>Merge-split proposals for conjugate "Chinese Restaurant Process" (CRP)
mixture models using sequential allocation of items, as originally described
in Dahl (2003), with additional functionality for the two parameter CRP
prior.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seqAllocatedMergeSplit_base(
  partition,
  logPosteriorPredictiveDensity = function(i, subset) 0,
  mass = 1,
  discount = 0,
  nUpdates = 1L,
  selectionWeights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>partition</code></td>
<td>
<p>A numeric vector of cluster labels representing the current
partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logPosteriorPredictiveDensity</code></td>
<td>
<p>A function taking an index <code class="reqn">i</code> (as a
numeric vector of length one) and a subset of integers <code class="reqn">subset</code>, and
returning the natural logarithm of <code class="reqn">p( y_i | y_subset )</code>, i.e., that
item's contribution to the log integrated likelihood given a subset of the
other items. The default value "turns off" the likelihood, resulting in
prior simulation (rather than posterior simulation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass</code></td>
<td>
<p>A specification of the mass (concentration) parameter in the CRP
prior. Must be greater than the <code>-discount</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount</code></td>
<td>
<p>A numeric value on the interval [0,1) corresponding to the
discount parameter in the two-parameter CRP prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nUpdates</code></td>
<td>
<p>An integer giving the number of merge-split proposals before
returning. This has the effect of thinning the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectionWeights</code></td>
<td>
<p>A matrix or data frame whose first two columns are
the unique pairs of data indices, along with a column of weights
representing how likely each pair is to be selected at the beginning of
each merge-split update.</p>
</td>
</tr>
</table>
<h3>Value</h3>

 <dl>
<dt>partition</dt>
<dd>
<p>An integer vector giving the updated
partition encoded using cluster labels.</p>
</dd> <dt>accept</dt>
<dd>
<p>The acceptance rate
of the Metropolis-Hastings proposals, i.e. the number accepted proposals
divided by <code>nUpdates</code>.</p>
</dd> </dl>
<h3>References</h3>

<p>Dahl, D. B. (2003). An improved merge-split sampler for conjugate
Dirichlet process mixture models. Technical Report, 1, 086.
</p>


<h3>See Also</h3>

<p><code>seqAllocatedMergeSplit</code>
</p>


</div>