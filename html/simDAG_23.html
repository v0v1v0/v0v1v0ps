<div class="container">

<table style="width: 100%;"><tr>
<td>node_poisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a Node Using Poisson Regression
</h2>

<h3>Description</h3>

<p>Data from the parents is used to generate the node using poisson regression by predicting the covariate specific lambda and sampling from a poisson distribution accordingly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">node_poisson(data, parents, formula=NULL, betas, intercept)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A <code>data.table</code> (or something that can be coerced to a <code>data.table</code>) containing all columns specified by <code>parents</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>

<p>A character vector specifying the names of the parents that this particular child node has. If non-linear combinations or interaction effects should be included, the user may specify the <code>formula</code> argument instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An optional <code>formula</code> object to describe how the node should be generated or <code>NULL</code> (default). If supplied it should start with <code>~</code>, having nothing else on the left hand side. The right hand side may contain any valid formula syntax, such as <code>A + B</code> or <code>A + B + I(A^2)</code>, allowing non-linear effects. If this argument is defined, there is no need to define the <code>parents</code> argument. For example, using <code>parents=c("A", "B")</code> is equal to using <code>formula= ~ A + B</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>

<p>A numeric vector with length equal to <code>parents</code>, specifying the causal beta coefficients used to generate the node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>A single number specifying the intercept that should be used when generating the node.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Essentially, this function simply calculates the linear predictor defined by the <code>betas</code>-coefficients, the <code>intercept</code> and the values of the <code>parents</code>. The exponential function is then applied to this predictor and the result is passed to the <code>rpois</code> function. The result is a draw from a subject-specific poisson distribution, resembling the user-defined poisson regression model.
</p>
<p><strong><em>Formal Description</em></strong>:
</p>
<p>Formally, the data generation can be described as:
</p>
<p style="text-align: center;"><code class="reqn">Y \sim Poisson(\lambda),</code>
</p>

<p>where <code class="reqn">Poisson()</code> means that the variable is Poisson distributed with:
</p>
<p style="text-align: center;"><code class="reqn">P_\lambda(k) = \frac{\lambda^k e^{-\lambda}}{k!}.</code>
</p>

<p>Here, <code class="reqn">k</code> is the count and <code class="reqn">e</code> is eulers number. The parameter <code class="reqn">\lambda</code> is determined as:
</p>
<p style="text-align: center;"><code class="reqn">\lambda = \exp(\texttt{intercept} + \texttt{parents}_1 \cdot \texttt{betas}_1 + ... + \texttt{parents}_n \cdot \texttt{betas}_n),</code>
</p>

<p>where <code class="reqn">n</code> is the number of parents (<code>length(parents)</code>).
</p>
<p>For example, given <code>intercept=-15</code>, <code>parents=c("A", "B")</code>, <code>betas=c(0.2, 1.3)</code> the data generation process is defined as:
</p>
<p style="text-align: center;"><code class="reqn">Y \sim Poisson(\exp(-15 + A \cdot 0.2 + B \cdot 1.3)).</code>
</p>



<h3>Value</h3>

<p>Returns a numeric vector of length <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Robin Denz
</p>


<h3>See Also</h3>

<p><code>empty_dag</code>, <code>node</code>, <code>node_td</code>, <code>sim_from_dag</code>, <code>sim_discrete_time</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(simDAG)

set.seed(345345)

dag &lt;- empty_dag() +
  node("age", type="rnorm", mean=50, sd=4) +
  node("sex", type="rbernoulli", p=0.5) +
  node("smoking", type="poisson",
       formula= ~ -2 + sexTRUE*1.1 + age*0.4)

sim_dat &lt;- sim_from_dag(dag=dag, n_sim=100)
</code></pre>


</div>