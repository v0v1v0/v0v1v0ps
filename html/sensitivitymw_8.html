<div class="container">

<table style="width: 100%;"><tr>
<td>senmwCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Point estimate and confidence interval for sensitivity analysis in observational studies using weighted Huber-Maritz M-statistics.
</h2>

<h3>Description</h3>

<p>Obtains point estimates and confidence intervals by inverting the hypothesis test in senmw.  For instance, the confidence interval is the set of hypotheses not rejected by the test.  Estimates an additive treatment effect tau.  In a sensitivity analysis with gamma&gt;1, one obtains an interval of point estimates consistent with a bias of at most gamma, and an interval containing all of the confidence intervals that are consistent with a bias of at most gamma.  Because senmwCI calls senmw many times, senmwCI is slower than senmw.
</p>


<h3>Usage</h3>

<pre><code class="language-R">senmwCI(y, gamma = 1, method = NULL, inner = 0, trim = 3,
	 lambda = 1/2, m1=1, m2=1, m=1, alpha=0.05,
	 one.sided=TRUE, tol=NULL, interval=NULL, detail=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>If y is an n by J matrix, then: (i) the rows are n matched sets, (ii) the first column is the treated response in a set, columns 2 to J contain the responses of controls in the same matched set.  Every set must have J-1 controls, and NAs are not allowed in y.  If y is a vector, then y is the vector of treated-minus-control pair differences in outcomes in n=length(y) matched pairs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>gamma is the sensitivity parameter, gamma=1 for a randomization test, gamma&gt;1 for sensitivity bounds.  Use of gamma&lt;1 will generate an error.  This parameter gamma is denoted by the upper case Greek letter gamma in the cited literature, for instance Rosenbaum (2007, 2014).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The method argument is the same as for the senmw function.  See the help file for senmw for more information.  Method="l" is not available for confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>
<p>Inner trimming to increase design sensitivity.  See the help file for senmw for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Outer trimming for resistance to outliers.  See the help file for senmw for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Observations are scaled by the lambda quantile of the absolute pair differences.  See the help file for senmw for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>One of three parameters that determine the weights.  See the discussion of m below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>One of three parameters that determine the weights.  See the discussion of m below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>One of three parameters that determine the weights.  See the help file for senmw for more information.  m2&lt;m is not available for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>1-alpha is the coverage of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one.sided</code></td>
<td>
<p>If TRUE, the confidence interval is one sided.  If FALSE, the confidence interval is two-sided.  The default is one-sided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The senmwCI function calls the R function uniroot, and tol is the tol (or tolerance) parameter in that call.  If tol=NULL, senmwCI picks a reasonable tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The senmwCI function calls the R function uniroot, and interval is the interval parameter in that call.  If interval=NULL, senmwCI picks a reasonable interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detail</code></td>
<td>
<p>If detail=FALSE, the interval of point estimates and the confidence interval are reported after rounding based on tol.  If detail=TRUE, then the results are not rounded, the tol and interval are reported.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PointEstimate</code></td>
<td>
<p>An interval of point estimates allowing for a bias of gamma in treatment assignment.  Rounded if detail=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>An confidence interval allowing for a bias of gamma in treatment assignment.  Rounded if detail=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search.interval</code></td>
<td>
<p>If detail=TRUE, the interval of parameter values searched to find the estimates and confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>If detail=TRUE, the tolerance used in solving for estimates and confidence intervals.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>senmwCI inverts a test to obtain confidence intervals and point estimats; so, it calls senmw many times, solving several equations, and senmwCI is much slower than a single call to senmw.  senmwCI finds point estimates and confidence intervals by searching for a value of the parameter tau in "interval" determining the solution tau.hat to an estimating equation with an error of "tol" in solving the equation.  If interval=NULL and tol=NULL, senmwCI tries to pick a reasonable finite interval and tol&gt;0.  If concerned about these "reasonable values", set detail=TRUE, make the interval longer, the tol smaller, and wait longer for program to run.  As illustrated in the examples, if there is reason for concern, the solutions produced by senmwCI can be checked by running senmw with tau set to the endpoints of the various intervals.
</p>
<p>Unlike senmw, senmwCI does not permit redescending rank scores, m2&lt;m or method="l".
</p>


<h3>Author(s)</h3>

<p>Paul R. Rosenbaum
</p>


<h3>References</h3>

<p>Huber, P. (1981) Robust Statistics.  New York: Wiley, 1981.
</p>
<p>Maritz, J. S. (1979) Exact robust confidence intervals for location.  Biometrika 1979, 66, 163-166. &lt;doi:10.1093/biomet/66.1.163&gt;
</p>
<p>Rosenbaum, P. R. (2007) Sensitivity analysis for m-estimates, tests and confidence intervals in matched observational studies.  Biometrics, 2007, 63, 456-464. &lt;doi:10.1111/j.1541-0420.2006.00717.x&gt;
</p>
<p>Rosenbaum, P. R. (2013) Impact of multiple matched controls on design sensitivity in observational studies.  Biometrics, 2013, 69, 118-127.
&lt;doi:10.1111/j.1541-0420.2012.01821.x&gt;
</p>
<p>Rosenbaum, P. R. (2014) Weighted M-statistics with superior design sensitivity in matched observational studies with multiple controls.  Journal of the American Statistical Association, 109(507), 1145-1158
&lt;doi:10.1080/01621459.2013.879261&gt;  This paper is the main reference for
weighted M-statistics and for the sensitivitymw package.
</p>
<p>Rosenbaum, P. R. (2015). Two R packages for sensitivity analysis in observational studies. Observational Studies, 1(2), 1-17.  The Observational Studies journal is available free on-line.
&lt;10.1353/obs.2015.0000&gt;  This article discusses and illustrates the use of the current package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mercury)
senmwCI(mercury,gamma=2,method="w",one.sided=FALSE,detail=TRUE)

#The following example reproduces part of Table 1 in Rosenbaum (2007).
#In particular, the one-sided .95 confidence interval is tau &gt;= 0.1812,
#and the P-value testing tau=0.1812 is 0.05.
#Similarly, the test statistic equals its null expectation at tau=0.3403,
#and when evaluated at -yrpcp the same thing happens at tau=-0.6666.
data(erpcp)
senmwCI(erpcp,gamma=2,trim=1,m1=1,m2=1,m=1)
senmw(erpcp,gamma=2,trim=1,m1=1,m2=1,m=1,tau=0.1812)
senmw(erpcp,gamma=2,trim=1,m1=1,m2=1,m=1,tau=0.3403)
senmw(-erpcp,gamma=2,trim=1,m1=1,m2=1,m=1,tau=-0.6666)


#This example illustrates the relationship between senmwCI and senmw.
#Note that the endpoints from senmwCI are tested by senmw.
#Also for illustration, the search interval in this case is specified as from 0 to 5.
senmwCI(mercury,gamma=2,method="w",detail=TRUE,interval=c(0,5),one.sided=FALSE)
senmw(mercury,gamma=2,method="w",tau=2.03135)
senmw(-mercury,gamma=2,method="w",tau=-3.166710)
senmw(mercury,gamma=2,method="w",tau=1.775008)
senmw(-mercury,gamma=2,method="w",tau=-3.605779)
</code></pre>


</div>