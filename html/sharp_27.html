<div class="container">

<table style="width: 100%;"><tr>
<td>ConsensusScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Consensus score</h2>

<h3>Description</h3>

<p>Computes the consensus score from the consensus matrix, matrix of co-sampling
counts and consensus clusters. The score is a z statistic for the comparison
of the co-membership proportions observed within and between the consensus
clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ConsensusScore(prop, K, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>consensus matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>matrix of co-sampling counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>consensus co-membership matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To calculate the consensus score, the features are classified as being stably
selected or not (in selection) or as being in the same consensus cluster or
not (in clustering). In selection, the quantities <code class="reqn">X_w</code> and <code class="reqn">X_b</code> are
defined as the sum of the selection counts for features that are stably
selected or not, respectively. In clustering, the quantities <code class="reqn">X_w</code> and
<code class="reqn">X_b</code> are defined as the sum of the co-membership counts for pairs of
items in the same consensus cluster or in different consensus clusters,
respectively.
</p>
<p>Conditionally on this classification, and under the assumption that the
selection (or co-membership) probabilities are the same for all features (or
item pairs) in each of these two categories, the quantities <code class="reqn">X_w</code> and
<code class="reqn">X_b</code> follow binomial distributions with probabilities <code class="reqn">p_w</code> and
<code class="reqn">p_b</code>, respectively.
</p>
<p>In the most unstable situation, we suppose that all features (or item pairs)
would have the same probability of being selected (or co-members). The
consensus score is the z statistic from a z test where the null hypothesis is
<code class="reqn">p_w \leq p_b</code>.
</p>
<p>The consensus score increases with stability.
</p>


<h3>Value</h3>

<p>A consensus score.
</p>


<h3>See Also</h3>

<p>Other stability metric functions: 
<code>FDP()</code>,
<code>PFER()</code>,
<code>StabilityMetrics()</code>,
<code>StabilityScore()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Data simulation
set.seed(2)
simul &lt;- SimulateClustering(
  n = c(30, 30, 30),
  nu_xc = 1
)
plot(simul)

# Consensus clustering
stab &lt;- Clustering(
  xdata = simul$data
)
stab$Sc[3]

# Calculating the consensus score
theta &lt;- CoMembership(Clusters(stab, argmax_id = 3))
ConsensusScore(
  prop = (stab$coprop[, , 3])[upper.tri(stab$coprop[, , 3])],
  K = stab$sampled_pairs[upper.tri(stab$sampled_pairs)],
  theta = theta[upper.tri(theta)]
)

</code></pre>


</div>