<div class="container">

<table style="width: 100%;"><tr>
<td>rwtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomization-based test of spatial dependence for panel models</h2>

<h3>Description</h3>

<p>Randomization-based test of spatial dependence for panel models, robust
to global dependence induced by common factors and to persistence
(serial correlation) in the data
</p>


<h3>Usage</h3>

<pre><code class="language-R">rwtest(x, ...)
## S3 method for class 'formula'
rwtest(x, data, w, index = NULL, model = NULL,
                         replications = 99, seed=NULL, order=1,
                         mc=1, test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
## S3 method for class 'panelmodel'
rwtest(x, w, replications = 99, seed=NULL,
                         order=1, mc=1,
                         test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
## S3 method for class 'pseries'
rwtest(x, w, replications = 99, seed=NULL,
                         order=1, mc=1,
                         test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
                          
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>formula</code>, <code>panelmodel</code>, or <code>pseries</code> 
(depending on the respective interface) describing the model to be tested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a <code>n x n</code> <code>matrix</code> describing proximity between
individuals, with <code class="reqn">w_ij = a</code> where <code class="reqn">a</code> is any number such
that <code>as.logical(a)==TRUE</code>,
if <code class="reqn">i,j</code> are neighbours, <code class="reqn">0</code> or any number <code class="reqn">b</code> such that
<code>as.logical(b)==FALSE</code> elsewhere. Only the lower triangluar part
(without diagonal) of <code>w</code> after coercing by <code>as.logical()</code>
is evaluated for neighbouring information (but <code>w</code> can be
symmetric). See also <b>Details</b> and <b>Examples</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>an optional numerical index, in case <code>data</code> has to be
formatted by <code>plm.data</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an optional character string indicating which type of
model to estimate; 
if left to <code>NULL</code>, the original heterogeneous specification of
Pesaran is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replications</code></td>
<td>
<p>the number of Monte Carlo randomizations of the
neighbourhood matrix (default: 99),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the optional random seed,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>the order of neighbourhood to test for,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>the number of parallel threads to execute; defaults to 1
(serial execution); is limited to the number of execution cores
actually available, and depends on operating system support.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the type of test statistic to be returned. One of 
</p>

<ul>
<li> <p><code>"rho"</code> for the average correlation coefficient,
</p>
</li>
<li> <p><code>"cd"</code> for Pesaran's CD statistic, or
</p>
</li>
<li> <p><code>"sclm"</code> for the scaled version of Breusch and Pagan's LM
statistic,</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis for the test, defaulting
to (asymmetric) twosided,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed on to <code>plm</code>, such as
e.g. <code>effect</code> or <code>random.method</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This test is meant as a generalization of Pesaran's spatial dependence
test "CD(p)" for robustness against global dependence (perhaps of the
factor type) and persistence in the data, both of which the original
test does not tolerate. 
</p>
<p>The procedure can be applied to model residuals as well as to
individual <code>pseries</code>.
See the comments in <code>pcdtest</code> as for the different methods.
</p>
<p>Space is defined supplying a proximity matrix (elements coercible to
<code>logical</code>) with argument <code>w</code> which provides information on
whether any pair of individuals are neighbours or not. If
<code>order=1</code>, only first-order neighbouring pairs will be used in
computing the test; else, <code>w</code> will be transformed in the
neighbourhood matrix of the appropriate order. The matrix need not be
binary, so commonly used “row–standardized” matrices can be employed
as well. <code>nb</code> objects from <span class="pkg">spdep</span> must instead be transformed
into matrices by <span class="pkg">spdep</span>'s function <code>nb2mat</code> before using.
</p>
<p>Notice that the <code>"rho"</code> and <code>"cd"</code> tests are permutationally
equivalent. 
</p>
<p>The test is suitable also for unbalanced panels.
</p>
<p>The test on a <code>pseries</code> is the same as a test on a pooled
regression model of that variable on a constant,
i.e. <code>rwtest(some_pseries)</code> is equivalent to
<code>rwtest(plm(some_var ~ 1, data = some_pdata.frame, model =
  "pooling")</code> and also equivalent to <code>rwtest(some_var ~ 1, data =
  some_data)</code>, where <code>some_var</code> is the variable name in the data
which corresponds to <code>some_pseries</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Millo, G. (2016), A simple randomization test for spatial dependence in
the presence of common factors and serial correlation,
<em>(unpublished)</em>, <b>xx</b>(x), pp. xxx–xxx. 
Pesaran, M.H. (2004), General Diagnostic Tests for Cross Section
Dependence in Panels, <em>CESifo</em> Working Paper 1229. 
Pesaran, M.H. (2015), Testing Weak Cross–Sectional Dependence in Large
Panels, <em>Econometric Reviews</em>, <b>34</b>(6-10), pp. 1089–1117. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## test on heterogeneous model (separate time series regressions)
rwtest(fm, data = Produc, w=usaww, index = c("state", "year"))

## test on two-way fixed effects homogeneous model
rwtest(fm, data = Produc, w=usaww, index = c("state", "year"),
       model = "within", effect = "twoways")

## test on panelmodel object
library(plm)
g &lt;- plm(fm, data = Produc)
rwtest(g, w=usaww)

## test on pseries, higher-order neighbourhood
pprod &lt;- pdata.frame(Produc)
rwtest(pprod$gsp, w=usaww, order=3)
</code></pre>


</div>