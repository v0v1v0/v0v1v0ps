<div class="container">

<table style="width: 100%;"><tr>
<td>quickMarkers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gets top N markers for each cluster</h2>

<h3>Description</h3>

<p>Uses tf-idf ordering to get the top N markers of each cluster.  For each cluster, either the top N or all genes passing the hypergeometric test with the FDR specified, whichever list is smallest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quickMarkers(toc, clusters, N = 10, FDR = 0.01, expressCut = 0.9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>toc</code></td>
<td>
<p>Table of counts.  Must be a sparse matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>Vector of length <code>ncol(toc)</code> giving cluster membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of marker genes to return per cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR</code></td>
<td>
<p>False discover rate to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expressCut</code></td>
<td>
<p>Value above which a gene is considered expressed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Term Frequency - Inverse Document Frequency is used in natural language processing to identify terms specific to documents.  This function uses the same idea to order genes within a group by how predictive of that group they are.  The main advantage of this is that it is extremely fast and gives reasonable results.
</p>
<p>To do this, gene expression is binarised in each cell so each cell is either considered to express or not each gene.  That is, we replace the counts with <code>toc &gt; zeroCut</code>.  The frequency with which a gene is expressed within the target group is compared to the global frequency to calculate the tf-idf score.  We also calculate a multiple hypothesis corrected p-value based on a hypergeometric test, but this is extremely permissive.
</p>


<h3>Value</h3>

<p>data.frame with top N markers (or all that pass the hypergeometric test) and their statistics for each cluster.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Calculate markers of clusters in toy data
mrks = quickMarkers(scToy$toc,scToy$metaData$clusters)
## Not run: 
#Calculate markers from Seurat (v3) object
mrks = quickMarkers(srat@assays$RNA@count,srat@active.ident)

## End(Not run)
</code></pre>


</div>