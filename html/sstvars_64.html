<div class="container">

<table style="width: 100%;"><tr>
<td>pick_allA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pick all coefficient matrices</h2>

<h3>Description</h3>

<p><code>pick_allA</code> picks all coefficient matrices <code class="reqn">A_{m,i} (i=1,..,p, m=1,..,M)</code>
from the given parameter vector so that they are arranged in a 4D array with the fourth dimension
indicating each regime and third dimension indicating each lag.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pick_allA(p, M, d, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the autoregressive order of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the number of regimes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the number of time series in the system, i.e., the dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a real valued vector specifying the parameter values.
Should have the form <code class="reqn">\theta = (\phi_{1,0},...,\phi_{M,0},\varphi_1,...,\varphi_M,\sigma,\alpha,\nu)</code>,
where
</p>

<ul>
<li>
<p><code class="reqn">\phi_{m,0} = </code> the <code class="reqn">(d \times 1)</code> intercept (or mean) vector of the <code class="reqn">m</code>th regime.
</p>
</li>
<li>
<p><code class="reqn">\varphi_m = (vec(A_{m,1}),...,vec(A_{m,p}))</code> <code class="reqn">(pd^2 \times 1)</code>.
</p>
</li>
<li>
<p><code class="reqn">\sigma = (vech(\Omega_1),...,vech(\Omega_M)</code> <code class="reqn">(Md(d + 1)/2 \times 1)</code>.
</p>
</li>
<li>
<p><code class="reqn">\alpha</code> contains the transition weights parameters.
</p>
</li>
<li>
<p><code class="reqn">\nu &gt; 2</code> is the degrees of freedom parameter that is included only if <code>cond_dist="Student"</code>.
</p>
</li>
</ul>
<dl>
<dt>
<code>weight_function="relative_dens"</code>:</dt>
<dd>
<p><code class="reqn">\alpha = (\alpha_1,...,\alpha_{M-1})</code>
<code class="reqn">(M - 1 \times 1)</code>, where <code class="reqn">\alpha_m</code> <code class="reqn">(1\times 1), m=1,...,M-1</code> are the transition weight parameters.</p>
</dd>
<dt>
<code>weight_function="logistic"</code>:</dt>
<dd>
<p><code class="reqn">\alpha = (c,\gamma)</code>
<code class="reqn">(2 \times 1)</code>, where <code class="reqn">c\in\mathbb{R}</code> is the location parameter and <code class="reqn">\gamma &gt;0</code> is the scale parameter.</p>
</dd>
<dt>
<code>weight_function="mlogit"</code>:</dt>
<dd>
<p><code class="reqn">\alpha = (\gamma_1,...,\gamma_M)</code> <code class="reqn">((M-1)k\times 1)</code>,
where <code class="reqn">\gamma_m</code> <code class="reqn">(k\times 1)</code>, <code class="reqn">m=1,...,M-1</code> contains the multinomial logit-regression coefficients
of the <code class="reqn">m</code>th regime. Specifically, for switching variables with indices in <code class="reqn">I\subset\lbrace 1,...,d\rbrace</code>,
and with <code class="reqn">\tilde{p}\in\lbrace 1,...,p\rbrace</code> lags included, <code class="reqn">\gamma_m</code> contains the coefficients for the vector
<code class="reqn">z_{t-1} = (1,\tilde{z}_{\min\lbrace I\rbrace},...,\tilde{z}_{\max\lbrace I\rbrace})</code>, where
<code class="reqn">\tilde{z}_{i} =(y_{it-1},...,y_{it-\tilde{p}})</code>, <code class="reqn">i\in I</code>. So <code class="reqn">k=1+|I|\tilde{p}</code>
where <code class="reqn">|I|</code> denotes the number of elements in <code class="reqn">I</code>.</p>
</dd>
<dt>
<code>weight_function="exponential"</code>:</dt>
<dd>
<p><code class="reqn">\alpha = (c,\gamma)</code>
<code class="reqn">(2 \times 1)</code>, where <code class="reqn">c\in\mathbb{R}</code> is the location parameter and <code class="reqn">\gamma &gt;0</code> is the scale parameter.</p>
</dd>
<dt>
<code>weight_function="threshold"</code>:</dt>
<dd>
<p><code class="reqn">\alpha = (r_1,...,r_{M-1})</code>
<code class="reqn">(M-1 \times 1)</code>, where <code class="reqn">r_1,...,r_{M-1}</code> are the threshold values.</p>
</dd>
</dl>
<p>Above, <code class="reqn">\phi_{m,0}</code> is the intercept parameter, <code class="reqn">A_{m,i}</code> denotes the <code class="reqn">i</code>th coefficient matrix of the <code class="reqn">m</code>th
mixture component, and <code class="reqn">\Omega_{m}</code> denotes the error term covariance matrix of the <code class="reqn">m</code>:th mixture component.
If <code>parametrization=="mean"</code>, just replace each <code class="reqn">\phi_{m,0}</code> with regimewise mean <code class="reqn">\mu_{m}</code>.
<code class="reqn">vec()</code> is vectorization operator that stacks columns of a given matrix into a vector. <code class="reqn">vech()</code> stacks columns
of a given matrix from the principal diagonal downwards (including elements on the diagonal) into a vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Does not support constrained parameter vectors.
</p>


<h3>Value</h3>

<p>Returns a 4D array containing the coefficient matrices of the all components. Coefficient matrix
<code class="reqn">A_{m,i}</code> can be obtained by choosing <code>[, , i, m]</code>.
</p>


<h3>Warning</h3>

<p>No argument checks!
</p>


</div>