<div class="container">

<table style="width: 100%;"><tr>
<td>function_map_total_n</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create new <code style="white-space: pre;">⁠*_map_total_n()⁠</code> functions</h2>

<h3>Description</h3>

<p><code>function_map_total_n()</code> is the engine that powers functions
such as <code>grim_map_total_n()</code>. It creates new, "factory-made" functions
for consistency tests such as GRIM or GRIMMER. The new functions take
reported summary statistics (e.g., means) and apply those tests in cases
where only a total sample size is known, not group sizes.
</p>
<p>This works by making <code>disperse_total()</code> create multiple pairs of
hypothetical group sizes, all of which add up to the reported total. There
need to be exactly two groups.
</p>
<p>For background and more examples, see the
<a href="https://lhdjung.github.io/scrutiny/articles/consistency-tests.html#total-n-mapper">total-n
mapper section</a> of <em>Consistency tests in depth</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">function_map_total_n(
  .fun,
  .reported,
  .name_test,
  .name_key_result = "consistency",
  .name_class = NULL,
  .dispersion = 0:5,
  .n_min = 1L,
  .n_max = NULL,
  .constant = NULL,
  .constant_index = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.fun</code></td>
<td>
<p>Function such as <code>grim_map()</code>, or one made by
<code>function_map()</code>: It will be used to test columns in a data frame for
consistency. Test results are logical and need to be contained in a column
called <code>consistency</code> that is added to the input data frame. This modified
data frame is then returned by <code>.fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.reported</code></td>
<td>
<p>String. Names of the columns containing group-specific
statistics that were reported alongside the total sample size(s). They will
be tested for consistency with the hypothetical group sizes. Examples are
<code>"x"</code> for GRIM and <code>c("x", "sd")</code> for DEBIT. In the data frame with
reported group statistics that the manufactured function takes as an input,
each will need to fan out like <code>"x1"</code>, <code>"x2"</code>, <code>"sd1"</code>, and <code>"sd2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_test</code></td>
<td>
<p>String (length 1). The name of the consistency test, such
as <code>"GRIM"</code>, to be optionally shown in a message when using the
manufactured function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_key_result</code></td>
<td>
<p>(Experimental) Optionally, a single string that will
be the name of the key result column in the output. Default is
<code>"consistency"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_class</code></td>
<td>
<p>String. If specified, the tibbles returned by the
manufactured function will inherit this string as an S3 class. Default is
<code>NULL</code>, i.e., no extra class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.dispersion, .n_min, .n_max, .constant, .constant_index</code></td>
<td>
<p>Arguments passed
down to <code>disperse_total()</code>, using defaults from there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>These dots must be empty.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If functions created by <code>function_map_total_n()</code> are exported from
other packages, they should be written as if they were created with
<a href="https://purrr.tidyverse.org/reference/faq-adverbs-export.html">purrr
adverbs</a>; see explanations there, and examples in the
<a href="https://lhdjung.github.io/scrutiny/articles/consistency-tests.html#context-and-export">export
section</a> of <em>Consistency tests in depth</em>.
</p>
<p>This function is a so-called function factory: It produces other functions,
such as <code>grim_map_total_n()</code>. More specifically, it is a function
operator because it also takes functions as inputs, such as <code>grim_map()</code>.
See Wickham (2019), ch. 10-11.
</p>


<h3>Value</h3>

<p>A function such as these:</p>

<table>
<tr>
<td style="text-align: left;">
   <strong>Manufactured function</strong> </td>
<td style="text-align: left;"> <strong>Reported statistics</strong> </td>
<td style="text-align: left;"> <strong>Test vignette</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>grim_map_total_n()</code> </td>
<td style="text-align: left;"> <code>"x"</code> </td>
<td style="text-align: left;"> <code>vignette("grim")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>grimmer_map_total_n()</code> </td>
<td style="text-align: left;"> <code>"x"</code>, <code>"sd"</code> </td>
<td style="text-align: left;"> <code>vignette("grimmer")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>debit_map_total_n()</code> </td>
<td style="text-align: left;"> <code>"x"</code>, <code>"sd"</code> </td>
<td style="text-align: left;"> <code>vignette("debit")</code> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The factory-made function will also have dots, <code>...</code>, to pass arguments
down to <code>.fun</code>, i.e., the basic mapper function.
</p>


<h3>Conventions</h3>

<p>The name of a function returned by
<code>function_map_total_n()</code> should mechanically follow from that of
the input function. For example, <code>grim_map_total_n()</code> derives
from <code>grim_map()</code>. This pattern fits best if the input function itself
is named after the test it performs on a data frame, followed by <code style="white-space: pre;">⁠_map⁠</code>:
<code>grim_map()</code> applies GRIM, <code>grimmer_map()</code> applies GRIMMER, etc.
</p>
<p>Much the same is true for the classes of data frames returned by the
manufactured function via the <code>.name_class</code> argument of
<code>function_map_total_n()</code>. It should be the function's own name preceded
by the name of the package that contains it, or by an acronym of that
package's name. Therefore, some existing classes are
<code>scr_grim_map_total_n</code> and <code>scr_grimmer_map_total_n</code>.
</p>


<h3>References</h3>

<p>Bauer, P. J., &amp; Francis, G. (2021). Expression of Concern: Is It
Light or Dark? Recalling Moral Behavior Changes Perception of Brightness.
<em>Psychological Science</em>, 32(12), 2042–2043.
https://journals.sagepub.com/doi/10.1177/09567976211058727
</p>
<p>Wickham, H. (2019). <em>Advanced R</em> (Second Edition). CRC Press/Taylor and
Francis Group. https://adv-r.hadley.nz/index.html
</p>


<h3>See Also</h3>

<p><code>function_map_seq()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Function definition of `grim_map_total_n()`:
grim_map_total_n &lt;- function_map_total_n(
  .fun = grim_map,
  .reported = "x",
  .name_test = "GRIM"
)
</code></pre>


</div>