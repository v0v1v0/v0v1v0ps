<div class="container">

<table style="width: 100%;"><tr>
<td>compute_ephemera</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pre-computations for sped</h2>

<h3>Description</h3>

<p><code>compute_ephemera()</code> does data-independent pre-computations for sped and can speed up repeated applications
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_ephemera(gtwid, hn, padding, spline_dim, perknot = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gtwid</code></td>
<td>
<p>Object of class spedecon_gtwid describing the density of <code class="reqn">Z</code> in the model <code class="reqn">Y = X + Z</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hn</code></td>
<td>
<p>Object of class <code>histogram</code> holding any histogram with the desired bins. The bins must be equally-spaced, i.e. <code>hn$equidist</code> must be <code>TRUE</code>, but otherwise only <code>hn$breaks</code> and <code>hn$mids</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padding</code></td>
<td>
<p>Support of spline space is extended by <code>padding/2</code> beyond the data on each side</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline_dim</code></td>
<td>
<p>Numeric integer, dimension of spline space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perknot</code></td>
<td>
<p>Number of positivity constraints per knot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The computations in sped rely on several matrices and vectors that are determined by the error density, spline space, and histogram bins, but do not depend on the data.
Computing these is the most time-intensive element of the process, so if the estimator will be applied several times to different data, but the same error density, spline space, and histogram bins (likely in simulations), gains can be had by pre-computing those matrices and vectors just one time.
</p>
<p>For comparison, the sped function internally uses <code>padding = 0.4</code>, and <code>perknot = 2</code>.
</p>


<h3>Value</h3>

<p>Object of class <code>spedecon_ephemera</code>, a list containing the pre-computed values.
</p>


<h3>References</h3>

<p>Kent D, Ruppert D (2023). “Smoothness-Penalized Deconvolution (SPeD) of a Density Estimate.” <em>Journal of the American Statistical Association</em>, to appear. ISSN 0162-1459, <a href="https://doi.org/10.1080/01621459.2023.2259028">doi:10.1080/01621459.2023.2259028</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- 1e-3; n &lt;- 1e3; s &lt;- 0.3
Y &lt;- rgamma(n,5,2) + rnorm(n,0,s)
gtwid &lt;- gaussian_gtwid(sd=s)
hn &lt;- hist(Y,breaks="FD",plot=FALSE)
ephemera &lt;- compute_ephemera(gtwid=gtwid,hn=hn,padding=0.4,spline_dim=30,perknot=2)
sol1 &lt;- sped(Y,gtwid,1e-3,ephemera=ephemera) # fast
sol2 &lt;- sped(Y,gtwid,1e-3) # slow
attr(sol1,"coef") - attr(sol2,"coef")
</code></pre>


</div>