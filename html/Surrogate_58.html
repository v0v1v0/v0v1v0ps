<div class="container">

<table style="width: 100%;"><tr>
<td>marginal_gof_scr_S_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit plot for the marginal survival functions</h2>

<h3>Description</h3>

<p>The <code>marginal_gof_scr_S_plot()</code> and <code>marginal_gof_scr_T_plot()</code> functions
plot the estimated marginal survival functions for the surrogate and true
endpoints. In these plots, it is assumed that the copula model has been
fitted for <code class="reqn">(T_0, \tilde{S}_0, \tilde{S}_1, T_1)'</code> where </p>
<p style="text-align: center;"><code class="reqn">S_k =
\min(\tilde{S_k}, T_k)</code>
</p>
<p> is the (composite) surrogate of interest. In these
plots, the model-based survival functions for <code class="reqn">(T_0, S_0, S_1, T_1)'</code> are
plotted together with the corresponding Kaplan-Meier etimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginal_gof_scr_S_plot(fitted_model, grid, treated, ...)

marginal_gof_scr_T_plot(fitted_model, grid, treated, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted_model</code></td>
<td>
<p>Returned value from <code>fit_model_SurvSurv()</code>. This object
essentially contains the estimated identifiable part of the joint
distribution for the potential outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Grid of time-points at which the model-based estimated regression
functions, survival functions, or probabilities are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treated</code></td>
<td>
<p>(numeric) Treatment group. Should be <code>0</code> or <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>plot()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>True Endpoint</h3>

<p>The marginal goodness-of-fit plots for the true endpoint, build by
<code>marginal_gof_scr_T_plot()</code>, is simply a comparison of the model-based
estimate of <code class="reqn">P(T_k &gt; t)</code> with the Kaplan-Meier (KM) estimate obtained
with <code>survival::survfit()</code>. A pointwise 95% confidence interval for the KM
estimate is also plotted.
</p>


<h3>Surrogate Endpoint</h3>

<p>The model-based estimate of <code class="reqn">P(S_k &gt; s)</code> follows indirectly from the
fitted copula model because the copula model has been fitted for
<code class="reqn">\tilde{S}_k</code> instead of <code class="reqn">S_k</code>. However, the model-based estimate
still follows easily from the copula model as follows,
</p>
<p style="text-align: center;"><code class="reqn">P(S_k &gt; s) = P(\min(\tilde{S}_k, T_k)) = P(\tilde{S}_k &gt; s, T_k &gt; s).</code>
</p>

<p>The <code>marginal_gof_scr_T_plot()</code> function plots the model-based estimate for
<code class="reqn">P(\tilde{S}_k &gt; s, T_k &gt; s)</code> together with the KM estimate (see above).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Define grid for GoF plots.
grid = seq(from = 1e-3,
           to = 2.5,
           length.out = 30)
# Assess marginal goodness-of-fit in the control group.
marginal_gof_scr_S_plot(fitted_model, grid = grid, treated = 0)
marginal_gof_scr_T_plot(fitted_model, grid = grid, treated = 0)
# Assess goodness-of-fit of the association structure, i.e., the copula.
prob_dying_without_progression_plot(fitted_model, grid = grid, treated = 0)
mean_S_before_T_plot_scr(fitted_model, grid = grid, treated = 0)
</code></pre>


</div>