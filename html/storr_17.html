<div class="container">

<table style="width: 100%;"><tr>
<td>test_driver</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test a storr driver</h2>

<h3>Description</h3>

<p>Test that a driver passes all storr tests.  This page is only of
interest to people developing storr drivers; nothing here is
required for using storr.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_driver(create)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>create</code></td>
<td>
<p>A function with one arguments that when run with
<code>NULL</code> as the argument will create a new driver instance.
It will also be called with a driver (of the same type) as an
argument - in this case, you must create a new driver object
pointing at the same underlying storage (see the examples).
Depending on your storage model, temporary directories,
in-memory locations, or random-but-unique prefixes may help
create isolated locations for the test (the tests assume that a
storr created with <code>create</code> is entirely empty).</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This will run through a suite of functions to test that a driver
is likely to behave itself.  As bugs are found they will be added
to the test suite to guard against regressions.
</p>
<p>The test suite is included in the package as
<code>system.file("spec", package = "storr")</code>.
</p>
<p>The procedure for each test block is:
</p>

<ol>
<li>
<p>Create a new driver by running <code>dr &lt;- create()</code>.
</p>
</li>
<li>
<p>Run a number of tests.
</p>
</li>
<li>
<p>Destroy the driver by running <code>dr$destroy()</code>.
</p>
</li>
</ol>
<p>So before running this test suite, make sure this will not harm
any precious data!
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Testing the environment driver is nice and fast:
if (requireNamespace("testthat")) {
  create_env &lt;- function(dr = NULL, ...) {
    driver_environment(dr$envir, ...)
  }
  test_driver(create_env)
}

# To test things like the rds driver, I would run:
## Not run: 
if (requireNamespace("testthat")) {
  create_rds &lt;- function(dr = NULL) {
    driver_rds(if (is.null(dr)) tempfile() else dr$path)
  }
  test_driver(create_rds)
}

## End(Not run)
</code></pre>


</div>