<div class="container">

<table style="width: 100%;"><tr>
<td>gcd.coef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes Yanai's GCD in the context of the variable-subset selection problem</h2>

<h3>Description</h3>

<p>Computes Yanai's Generalized Coefficient of Determination for the
similarity of the subspaces spanned by a subset of
variables and a subset of the full data set's Principal
Components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gcd.coef(mat, indices, pcindices =  NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>the full data set's covariance (or correlation) matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>a numerical vector, matrix or 3-d array of integers
giving the indices of the variables in the subset. If a matrix is
specified, each row is taken to represent a different
<em>k</em>-variable subset. If a 3-d array is given, it is assumed
that the third dimension corresponds to different cardinalities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcindices</code></td>
<td>
<p>a numerical vector of indices of Principal
Components. By default, the first <em>k</em> PCs are chosen, where
<em>k</em> is the cardinality of the subset of variables whose
criterion value is being computed. <b>If a vector of PCs is
specified by the user, those PCs will be used for all cardinalities
that were requested</b>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes Yanai's Generalized Coefficient of Determination for the
similarity of the subspaces spanned by a subset of
variables (specified by <code>indices</code>) and a subset of the
full-data set's Principal Components (specified by <code>pcindices</code>).
Input data is expected in the form of a (co)variance or
correlation matrix. If a non-square matrix is given, it is assumed to
be a data matrix, and its correlation matrix is used as input. The
number of variables (k) and of PCs (q) does not have to be the same.
</p>
<p>Yanai's GCD is defined as:
</p>
<p style="text-align: center;"><code class="reqn">GCD = \frac{\mathrm{tr}(P_v\cdot P_c)}{\sqrt{k\cdot q}}</code>
</p>

<p>where <code class="reqn">P_v</code> and <code class="reqn">P_c</code> are the matrices of orthogonal
projections on the subspaces spanned by the k-variable subset and by
the q-Principal Component subset, respectively.
</p>
<p>This definition is equivalent to:
</p>
<p style="text-align: center;"><code class="reqn">GCD = \frac{1}{\sqrt{k q}} \sum\limits_{i}(r_m)_i^2</code>
</p>

<p>where <code class="reqn">(r_m)_i</code> stands for the multiple correlation between the
<code>i</code>-th Principal Component and the k-variable subset, and the sum
is carried out over the q PCs (i=1,...,q) selected.
</p>
<p>These definitions are also equivalent to the expression used in the
code, which only requires the covariance (or correlation) matrix of
the data under consideration.
</p>
<p>The fact that <code>indices</code> can be a matrix or 3-d array allows for
the computation of the GCD values of subsets produced by the search
functions <code>anneal</code>, <code>genetic</code> and
<code>improve</code> (whose output option <code>$subsets</code> are
matrices or 3-d arrays), using a different criterion (see the example
below).
</p>


<h3>Value</h3>

<p>The value of the GCD coefficient.
</p>


<h3>References</h3>

<p>Cadima, J. and Jolliffe, I.T. (2001), "Variable Selection and the
Interpretation of Principal Subspaces", <em>Journal of Agricultural,
Biological and Environmental Statistics</em>, Vol. 6, 62-79.
</p>
<p>Ramsay, J.O., ten Berge, J. and Styan, G.P.H. (1984), "Matrix
Correlation", <em>Psychometrika</em>, 49, 403-423. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## An example with a very small data set.

data(iris3) 
x&lt;-iris3[,,1]
gcd.coef(cor(x),c(1,3))
## [1] 0.7666286
gcd.coef(cor(x),c(1,3),pcindices=c(1,3))
## [1] 0.584452
gcd.coef(cor(x),c(1,3),pcindices=1)
## [1] 0.6035127

## An example computing the GCDs of three subsets produced when the
## anneal function attempted to optimize the RV criterion (using an
## absurdly small number of iterations).

data(swiss)
rvresults&lt;-anneal(cor(swiss),2,nsol=4,niter=5,criterion="Rv")
gcd.coef(cor(swiss),rvresults$subsets)

##              Card.2
##Solution 1 0.4962297
##Solution 2 0.7092591
##Solution 3 0.4748525
##Solution 4 0.4649259
</code></pre>


</div>