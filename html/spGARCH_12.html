<div class="container">

<table style="width: 100%;"><tr>
<td>sim.spGARCH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of spatial ARCH models</h2>

<h3>Description</h3>

<p>The function generates <code>n</code> random numbers of a spatial GARCH process for given parameters and weighting schemes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.spGARCH(n = dim(W1)[1], rho, lambda, alpha, W1, W2,
            b = 2, zeta = 0.5, theta = 0.5, type = "spGARCH",
            control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n)</code> <code class="reqn">&gt; 1</code>, the length is taken to be the number required. Default <code>dim(W1)[1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>spatial dependence parameter rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>spatial dependence parameter lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>unconditional variance level alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W1</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix (ARCH component, parameter rho)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W2</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix (GARCH component, parameter lambda)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>parameter <code>b</code> for logarithmic spatial GARCH (only needed if <code>type = "log-spGARCH"</code>). Default 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>parameter <code>zeta</code> for exponential spatial GARCH (only needed if <code>type = "e-spGARCH"</code>). Default 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>parameter <code>theta</code> for exponential spatial GARCH (only needed if <code>type = "e-spGARCH"</code>). Default 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of simulated spGARCH process (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control arguments (see below)</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>The function simulates <code>n</code> observations <code class="reqn">Y = (Y_1, ..., Y_n)'</code> of a spatial GARCH process, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{Y} = diag(\boldsymbol{h})^{1/2} \boldsymbol{\varepsilon} \, ,
</code>
</p>

<p>where <code class="reqn">\boldsymbol{\varepsilon}</code> is a spatial White Noise process. The definition of <code class="reqn">\boldsymbol{h}</code> depends on the chosen <code>type</code>. The following types are available.
</p>

<ul>
<li> <p><code>type = "spGARCH"</code> - simulates <code class="reqn">\boldsymbol{\varepsilon}</code> from a truncated normal distribution on the interval <code class="reqn">[-a, a]</code>, such that <code class="reqn">\boldsymbol{h} &gt; 0</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W}_1 \boldsymbol{Y}^{(2)} + \lambda \mathbf{W}_2 \boldsymbol{h} \; \mbox{and} \; a = 1 / ||\rho^2\mathbf{W}_1^2||_1^{1/4}.
</code>
</p>

<p>Note that the normal distribution is not trunctated (<code class="reqn">a = \infty</code>), if <code class="reqn">\mathbf{W}_1</code> is a strictly triangular matrix, as it is ensured that <code class="reqn">\boldsymbol{h} &gt; \boldsymbol{0}</code>. Generally, it is sufficient that if there exists a permutation such that <code class="reqn">\mathbf{W}_1</code> is strictly triangular. In this case, the process is called oriented spGARCH process.
</p>
</li>
<li> <p><code>type = "e-spGARCH"</code> - simulates an exponential spARCH process (e-spGARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W}_1 g(\boldsymbol{\varepsilon}) + \lambda \mathbf{W}_2 log(\boldsymbol{h}) \, .
</code>
</p>

<p>For the e-spGARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g(\boldsymbol{\varepsilon}) = \Theta {\varepsilon} + \zeta (|\varepsilon| - E(|\varepsilon|))  \, .
</code>
</p>

</li>
<li> <p><code>type = "log-spGARCH"</code> - simulates a logarithmic spARCH process (log-spGARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W}_1 g(\boldsymbol{\varepsilon}) + \lambda \mathbf{W}_2 log(\boldsymbol{h}) \, .
</code>
</p>

<p>For the log-spGARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})' \, .
</code>
</p>

</li>
<li> <p><code>type = "complex-spGARCH"</code> - allows for complex solutions of <code class="reqn">\boldsymbol{h}^{1/2}</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W}_1 \boldsymbol{Y}^{(2)} + \lambda \mathbf{W}_2 \boldsymbol{h}  \, .
</code>
</p>

<p>The errors follow a standard normal distribution.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The functions returns a vector <code class="reqn">\boldsymbol{y}</code>.
</p>


<h3>Control Arguments</h3>


<ul>
<li> <p><code>seed</code> - positive integer to initialize the random number generator (RNG), default value is a random integer in <code class="reqn">[1, 10^6]</code>
</p>
</li>
<li> <p><code>silent</code> - if <code>FALSE</code>, current random seed is reported
</p>
</li>
<li> <p><code>triangular</code> - if <code>TRUE</code>, <code class="reqn">\mathbf{W}</code> is a triangular matrix and there are no checks to verify this assumption (default <code>FALSE</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid (2019). Spatial GARCH Models - A Unified Approach. <em>arXiv:1908.08320</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("spdep")

# 1st example (spatial GARCH)
##############

# parameters

rho    &lt;- 0.5
lambda &lt;- 0.3
alpha  &lt;- 1
d      &lt;- 5

nblist &lt;- cell2nb(d, d, type = "rook") # lattice process with Rook's contiguity matrix
W_1    &lt;- nb2mat(nblist)
W_2    &lt;- W_1

# simulation

Y      &lt;- sim.spGARCH(rho = rho, lambda = lambda, alpha = alpha,
                      W1 = W_1, W2 = W_2, type = "spGARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

# 2nd example (exponential spatial GARCH)
##############

# parameters

rho    &lt;- 0.5
lambda &lt;- 0.3
alpha  &lt;- 1
zeta   &lt;- 0.5
theta  &lt;- 0.5
d      &lt;- 5

nblist &lt;- cell2nb(d, d, type = "rook") # lattice process with Rook's contiguity matrix
W_1    &lt;- nb2mat(nblist)
W_2    &lt;- W_1

# simulation

Y      &lt;- sim.spGARCH(rho = rho, lambda = lambda, alpha = alpha,
                      W1 = W_1, W2 = W_2, zeta = zeta, theta = 0.5, type = "e-spGARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

</code></pre>


</div>