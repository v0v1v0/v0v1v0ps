<div class="container">

<table style="width: 100%;"><tr>
<td>RadixForest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RadixForest</h2>

<h3>Description</h3>

<p>Radix Forest class implementation
</p>


<h3>Details</h3>

<p>The RadixForest class is a specialization of the RadixTree implementation. Instead of putting sequences into
a single tree, the RadixForest class puts sequences into separate trees based on sequence length. This allows for faster
searching of similar sequences based on Hamming or Levenshtein distance metrics.
Unlike the RadixTree class, the RadixForest class does not support anchored searches or a custom cost matrix.
See <em>RadixTree</em> for additional details.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>forest_pointer</code></dt>
<dd>
<p>Map of sequence length to RadixTree</p>
</dd>
<dt><code>char_counter_pointer</code></dt>
<dd>
<p>Character count data for the purpose of validating input</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-RadixForest-new"><code>RadixForest$new()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-show"><code>RadixForest$show()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-to_string"><code>RadixForest$to_string()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-graph"><code>RadixForest$graph()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-to_vector"><code>RadixForest$to_vector()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-size"><code>RadixForest$size()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-insert"><code>RadixForest$insert()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-erase"><code>RadixForest$erase()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-find"><code>RadixForest$find()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-prefix_search"><code>RadixForest$prefix_search()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-search"><code>RadixForest$search()</code></a>
</p>
</li>
<li> <p><a href="#method-RadixForest-validate"><code>RadixForest$validate()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-RadixForest-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new RadixForest object
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$new(sequences = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sequences</code></dt>
<dd>
<p>A character vector of sequences to insert into the forest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-RadixForest-show"></a>



<h4>Method <code>show()</code>
</h4>

<p>Print the forest to screen
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$show()</pre></div>


<hr>
<a id="method-RadixForest-to_string"></a>



<h4>Method <code>to_string()</code>
</h4>

<p>Print the forest to a string
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$to_string()</pre></div>


<hr>
<a id="method-RadixForest-graph"></a>



<h4>Method <code>graph()</code>
</h4>

<p>Plot of the forest using igraph
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$graph(depth = -1, root_label = "root", plot = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>depth</code></dt>
<dd>
<p>The tree depth to plot for each tree in the forest.</p>
</dd>
<dt><code>root_label</code></dt>
<dd>
<p>The label of the root node(s) in the plot.</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>Whether to create a plot or return the data used to generate the plot.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A data frame of parent-child relationships used to generate the igraph plot OR a ggplot2 object
</p>


<hr>
<a id="method-RadixForest-to_vector"></a>



<h4>Method <code>to_vector()</code>
</h4>

<p>Output all sequences held by the forest as a character vector
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$to_vector()</pre></div>



<h5>Returns</h5>

<p>A character vector of all sequences contained in the forest.
</p>


<hr>
<a id="method-RadixForest-size"></a>



<h4>Method <code>size()</code>
</h4>

<p>Output the size of the forest (i.e. how many sequences are contained)
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$size()</pre></div>



<h5>Returns</h5>

<p>The size of the forest
</p>


<hr>
<a id="method-RadixForest-insert"></a>



<h4>Method <code>insert()</code>
</h4>

<p>Insert new sequences into the forest
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$insert(sequences)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sequences</code></dt>
<dd>
<p>A character vector of sequences to insert into the forest</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A logical vector indicating whether the sequence was inserted (TRUE) or already existing in the forest (FALSE)
</p>


<hr>
<a id="method-RadixForest-erase"></a>



<h4>Method <code>erase()</code>
</h4>

<p>Erase sequences from the forest
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$erase(sequences)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sequences</code></dt>
<dd>
<p>A character vector of sequences to erase from the forest</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A logical vector indicating whether the sequence was erased (TRUE) or not found in the forest (FALSE)
</p>


<hr>
<a id="method-RadixForest-find"></a>



<h4>Method <code>find()</code>
</h4>

<p>Find sequences in the forest
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$find(query)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>query</code></dt>
<dd>
<p>A character vector of sequences to find in the forest</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A logical vector indicating whether the sequence was found (TRUE) or not found in the forest (FALSE)
</p>


<hr>
<a id="method-RadixForest-prefix_search"></a>



<h4>Method <code>prefix_search()</code>
</h4>

<p>Search for sequences in the forest that start with a specified prefix.
E.g.: a query of "CAR" will find "CART", "CARBON", "CARROT", etc. but not "CATS".
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$prefix_search(query)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>query</code></dt>
<dd>
<p>A character vector of sequences to search for in the forest</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A data frame of all matches with columns "query" and "target".
</p>


<hr>
<a id="method-RadixForest-search"></a>



<h4>Method <code>search()</code>
</h4>

<p>Search for sequences in the forest that are with a specified distance metric to a specified query.
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$search(
  query,
  max_distance = NULL,
  max_fraction = NULL,
  mode = "levenshtein",
  nthreads = 1,
  show_progress = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>query</code></dt>
<dd>
<p>A character vector of query sequences.</p>
</dd>
<dt><code>max_distance</code></dt>
<dd>
<p>how far to search in units of absolute distance. Can be a single value or a vector. Mutually exclusive with max_fraction.</p>
</dd>
<dt><code>max_fraction</code></dt>
<dd>
<p>how far to search in units of relative distance to each query sequence length. Can be a single value or a vector. Mutually exclusive with max_distance.</p>
</dd>
<dt><code>mode</code></dt>
<dd>
<p>The distance metric to use. One of hamming (hm), global (gb) or anchored (an).</p>
</dd>
<dt><code>nthreads</code></dt>
<dd>
<p>The number of threads to use for parallel computation.</p>
</dd>
<dt><code>show_progress</code></dt>
<dd>
<p>Whether to show a progress bar.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The output is a data.frame of all matches with columns "query" and "target".
</p>


<hr>
<a id="method-RadixForest-validate"></a>



<h4>Method <code>validate()</code>
</h4>

<p>Validate the forest
</p>


<h5>Usage</h5>

<div class="r"><pre>RadixForest$validate()</pre></div>



<h5>Returns</h5>

<p>A logical indicating whether the forest is valid (TRUE) or not (FALSE). This is mostly an internal function for debugging purposes and should always return TRUE.
</p>




<h3>Examples</h3>

<pre><code class="language-R">forest &lt;- RadixForest$new()
forest$insert(c("ACGT", "AAAA"))
forest$erase("AAAA")
forest$search("ACG", max_distance = 1, mode = "levenshtein")
 #   query target distance
 # 1   ACG   ACGT        1
 
forest$search("ACG", max_distance = 1, mode = "hamming")
 # query    target   distance
 # &lt;0 rows&gt; (or 0-length row.names)
</code></pre>


</div>