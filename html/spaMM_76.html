<div class="container">

<table style="width: 100%;"><tr>
<td>COMPoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conway-Maxwell-Poisson (COM-Poisson) GLM family
</h2>

<h3>Description</h3>

<p>The COM-Poisson family is a generalization of the Poisson family which can describe over-dispersed as well as under-dispersed count data. It is indexed by a parameter <code>nu</code> that quantifies such dispersion. For <code>nu</code>&gt;1, the distribution is under-dispersed relative to the Poisson distribution with same mean. It includes the Poisson, geometric and Bernoulli as special (or limit) cases (see Details). The COM-Poisson family is here implemented as a <code>family</code> object, so that it can be fitted by <code>glm</code>, and further used to model conditional responses in mixed models fitted by this package's functions (see Examples). <code>nu</code> is distinct from the dispersion parameter <code class="reqn">\nu=1/\phi</code> considered elsewhere in this package and in the GLM literature, as <code class="reqn">\nu</code> affects in a more specific way the log-likelihood. 
</p>
<p>Several links are now allowed for this family, corresponding to different versions of the COMPoisson described in the literature (e.g., Sellers &amp; Shmueli 2010; Huang 2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">COMPoisson(nu =  stop("COMPoisson's 'nu' must be specified"), 
           link = "loglambda")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>GLM link function. The default is the canonical link <code>"loglambda"</code> (see Details), but other links are allowed (currently log, sqrt or identity links as commonly handled for the Poisson family).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>Under-dispersion parameter. The <code>fitme</code> and <code>corrHLfit</code> functions called with <code>family=COMPoisson()</code> (no given <code>nu</code> value) will estimate this parameter. In other usage of this family, <code>nu</code> must be specified. <code>COMPoisson(nu=1)</code> is the Poisson family. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">i</code>th term of the distribution can be written <code class="reqn">q_i/Z</code> where <code class="reqn">q_i=\lambda^i / (i!)^\nu</code> and <code class="reqn">Z=\sum_{(i=0)}^\infty q_i</code>, for <code class="reqn">\lambda=\lambda(\mu)</code> implied by its inverse relationship, the expectation formula <code class="reqn">\mu=\mu(\lambda)=\sum_{(i=0)}^\infty i q_i(\lambda)/Z</code>. The case <code>nu=0</code> is the geometric distribution with parameter <code class="reqn">\lambda</code>; <code>nu=1</code> is the Poisson distribution with mean <code class="reqn">\lambda</code>; and the limit as <code>nu</code> -&gt; <code class="reqn">\infty</code> is the Bernoulli distribution with expectation <code class="reqn">\lambda/(1+\lambda)</code>. 
</p>
<p>From this definition, this is an exponential family model with canonical parameters <code class="reqn">log(\lambda)</code> and <code class="reqn">\nu</code>. When the linear predictor <code class="reqn">\eta</code> specifies <code class="reqn">log(\lambda(\mu))</code>, the canonical link is used (e.g., Sellers &amp; Shmueli 2010). It is here nicknamed <code>"loglambda"</code> and does not have a known expression in terms of elementary functions. To obtain <code class="reqn">\mu</code> as the link inverse of the linear predictor <code class="reqn">\eta</code>, one then first computes <code class="reqn">\lambda=e^\eta</code> and then <code class="reqn">\mu(\lambda)</code> by the  expectation formula. For other links (Huang 2017), one directly computes <code class="reqn">\mu</code> by the link inverse (e.g., <code class="reqn">\mu=e^\eta</code> for link <code>"log"</code>), and then one may solve for <code class="reqn">\lambda= \lambda(\mu)</code> to obtain other features of the distribution.    
</p>
<p>The relationships between <code class="reqn">\lambda</code> and <code class="reqn">\mu</code> or other moments of the distribution involve infinite summations. These sums can be easily approximated by a finite number of terms for large <code>nu</code> but not when <code>nu</code> approaches zero. For this reason, the code may fail to fit distributions with <code>nu</code> approaching 0 (strong residual over-dispersion). The case <code>nu=0</code> (the geometric distribution) is fitted by an ad hoc algorithm devoid of such problems. Otherwise, <code>spaMM</code> truncates the sum, and uses numerical integrals to approximate missing terms (which slows down the fitting operation). In addition, it applies an ad hoc continuity correction to ensure continuity of the result in <code>nu=1</code> (Poisson case). These corrections affect numerical results for the case of residual overdispersion but are negligible for the case of residual underdispersion. Alternatively, <code>spaMM</code> uses Gaunt et al.'s (2017) approximations when the condition defined by <code>spaMM.getOption("CMP_asympto_cond")</code> is satisfied. All approximations reduces the accuracy of computations, in a way that can impede the extended Levenberg-Marquardt algorithm sometimes needed by spaMM.
</p>
<p>The name <code>COMP_nu</code> should be used to set initial values or bounds on <code>nu</code> in control arguments of the fitting functions (e.g., <code>fitme(.,init=list(COMP_nu=1))</code>). Fixed values should be set by the family argument (<code>COMPoisson(nu=.)</code>). 
</p>


<h3>Value</h3>

<p>A family object.
</p>


<h3>References</h3>

<p>Gaunt, Robert E. and Iyengar, Satish and Olde Daalhuis, Adri B. and Simsek, Burcin. (2017) An asymptotic expansion for the normalizing constant of the Conway–Maxwell–Poisson distribution. Ann Inst Stat Math <a href="https://doi.org/10.1007/s10463-017-0629-6">doi:10.1007/s10463-017-0629-6</a>.
</p>
<p>Huang, Alan (2017) Mean-parametrized Conway-Maxwell-Poisson regression models for dispersed counts. Stat. Modelling <a href="https://doi.org/10.1177/1471082X17697749">doi:10.1177/1471082X17697749</a> 
</p>
<p>G. Shmueli, T. P. Minka, J. B. Kadane, S. Borle and P. Boatwright (2005) A useful distribution for fitting discrete data: revival of the Conway-Maxwell-Poisson distribution. Appl. Statist. 54: 127-142.
</p>
<p>Sellers KF, Shmueli G (2010) A Flexible Regression Model for Count Data. Ann. Appl. Stat. 4: 943–961
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (spaMM.getOption("example_maxtime")&gt;0.9) {
  # Fitting COMPoisson model with estimated nu parameter:
  #
  data("freight") ## example from Sellers &amp; Shmueli, Ann. Appl. Stat. 4: 943–961 (2010)
  fitme(broken ~ transfers, data=freight, family = COMPoisson())
  fitme(broken ~ transfers, data=freight, family = COMPoisson(link="log"))

  # glm(), HLCor() and HLfit() handle spaMM::COMPoisson() with fixed overdispersion:
  #
  glm(broken ~ transfers, data=freight, family = COMPoisson(nu=10))
  HLfit(broken ~ transfers+(1|id), data=freight, family = COMPoisson(nu=10),method="ML")
  
  # Equivalence of poisson() and COMPoisson(nu=1):
  #
  COMPglm &lt;- glm(broken ~ transfers, data=freight, family = poisson())
  coef(COMPglm)
  logLik(COMPglm)
  COMPglm &lt;- glm(broken ~ transfers, data=freight, family = COMPoisson(nu=1))
  coef(COMPglm)
  logLik(COMPglm)
  HLfit(broken ~ transfers, data=freight, family = COMPoisson(nu=1))

}
</code></pre>


</div>