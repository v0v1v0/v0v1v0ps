<div class="container">

<table style="width: 100%;"><tr>
<td>cholUpdate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Different Cholesky factor updates</h2>

<h3>Description</h3>

<p>Provides functions that implements different types of updates of
a Cholesky factor that includes rank-one update, single row/column deletion
update and a block deletion update.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cholUpdateRankOne(A, v, alpha, beta, lower = TRUE)

cholUpdateDel(A, del.index, lower = TRUE)

cholUpdateDelBlock(A, del.start, del.end, lower = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an <code class="reqn">n\times n</code> triangular matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>an <code class="reqn">n\times 1</code> matrix/vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>scalar; if not supplied, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>scalar; if not supplied, default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>logical; if <code>A</code> is lower-triangular or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del.index</code></td>
<td>
<p>an integer from 1 to <code class="reqn">n</code> indicating the row/column to be
deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del.start</code></td>
<td>
<p>an integer from 1 to <code class="reqn">n</code> indicating the first row/column
of a block to be deleted, must be at least 1 less than <code>del.end</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del.end</code></td>
<td>
<p>an integer from 1 to <code class="reqn">n</code> indicating the last row/column
of a block to be deleted, must be at least 1 more than <code>del.start</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose <code class="reqn">B = AA^\top</code> is a <code class="reqn">n \times n</code> matrix with <code class="reqn">A</code>
being its lower-triangular Cholesky factor. Then rank-one update corresponds
to finding the Cholesky factor of the matrix
<code class="reqn">C = \alpha B + \beta vv^\top</code> for some <code class="reqn">\alpha,\beta\in\mathbb{R}</code>
given <code class="reqn">A</code> (see, Krause and Igel 2015). Similarly, single row/column
deletion update corresponds to finding the Cholesky factor of the
<code class="reqn">(n-1)\times(n-1)</code> matrix <code class="reqn">B_i</code> which is obtained by removing the
<code class="reqn">i</code>-th row and column of <code class="reqn">B</code>, given <code class="reqn">A</code> for some
<code class="reqn">i - 1, \ldots, n</code>. Lastly, block deletion corresponds to finding the
Cholesky factor of the <code class="reqn">(n-n_k)\times(n-n_k)</code> matrix <code class="reqn">B_{I}</code> for a
subset <code class="reqn">I</code> of <code class="reqn">\{1, \ldots, n\}</code> containing <code class="reqn">n_k</code> consecutive
indices, given the factor <code class="reqn">A</code>.
</p>


<h3>Value</h3>

<p>An <code class="reqn">m \times m</code> lower-triangular <code>matrix</code> with <code class="reqn">m = n</code> in
case of <code>cholUpdateRankOne()</code>, <code class="reqn">m = n - 1</code> in case of <code>cholUpdateDel()</code>,
and, <code class="reqn">m = n - n_k</code> in case of <code>cholUpdateDelBlock()</code> where <code class="reqn">n_k</code> is
the size of the block removed.
</p>


<h3>Author(s)</h3>

<p>Soumyakanti Pan <a href="mailto:span18@ucla.edu">span18@ucla.edu</a>,<br>
Sudipto Banerjee <a href="mailto:sudipto@ucla.edu">sudipto@ucla.edu</a>
</p>


<h3>References</h3>

<p>Oswin Krause and Christian Igel. 2015. "A More Efficient Rank-one
Covariance Matrix Update for Evolution Strategies". In <em>Proceedings of the
2015 ACM Conference on Foundations of Genetic Algorithms XIII</em> (FOGA '15).
Association for Computing Machinery, New York, NY, USA, 129-136.
<a href="https://doi.org/10.1145/2725494.2725496">doi:10.1145/2725494.2725496</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 10
A &lt;- matrix(rnorm(n^2), n, n)
A &lt;- crossprod(A)
cholA &lt;- chol(A)

## Rank-1 update
v &lt;- 1:n
APlusvvT &lt;- A + tcrossprod(v)
cholA1 &lt;- t(chol(APlusvvT))
cholA2 &lt;- cholUpdateRankOne(cholA, v, lower = FALSE)
print(all(abs(cholA1 - cholA2) &lt; 1E-9))

## Single Row-deletion update
ind &lt;- 2
A1 &lt;- A[-ind, -ind]
cholA1 &lt;- t(chol(A1))
cholA2 &lt;- cholUpdateDel(cholA, del.index = ind, lower = FALSE)
print(all(abs(cholA1 - cholA2) &lt; 1E-9))

## Block-deletion update
start_ind &lt;- 2
end_ind &lt;- 6
del_ind &lt;- c(start_ind:end_ind)
A1 &lt;- A[-del_ind, -del_ind]
cholA1 &lt;- t(chol(A1))
cholA2 &lt;- cholUpdateDelBlock(cholA, start_ind, end_ind, lower = FALSE)
print(all(abs(cholA1 - cholA2) &lt; 1E-9))
</code></pre>


</div>