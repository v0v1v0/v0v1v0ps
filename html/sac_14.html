<div class="container">

<table style="width: 100%;"><tr>
<td>schapt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Semiparametric Analysis of Changepoint</h2>

<h3>Description</h3>

<p>Semiparametric empirical likelihood ratio
based test of changepoint with one-change or epidemic alternatives
with data-based model diagnostic
</p>


<h3>Usage</h3>

<pre><code class="language-R">schapt(x, n.boots = 0, replace = FALSE, alternative = c("one.change",
    "epidemic"), conf.level = 0.95, adj.Wn = FALSE, model.test = FALSE,
    n.model.boots = 0, tol=1.0e-7, maxit=50,trace=FALSE,... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boots</code></td>
<td>
<p> number of bootstrap samples for bootstrap test of the change-point,
if <code>n.boots =0 </code>, do not perform bootstrap test;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p> a logical indicating whether bootstrap samples for bootstrap test
of the change-point are selected with or without replacement, if <code>replace</code>= FALSE (default),
corresponds to permutation test, otherwise, bootstrap test; </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.
Epidemic alternative is also called square wave alternative in the literature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.Wn</code></td>
<td>
<p> logical indicating if <code>Wn</code> should be adjusted or not
for <code>"epidemic"</code> alternative. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.test</code></td>
<td>
<p>a logical indicating whether the test of model validity is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.model.boots</code></td>
<td>
<p> number of bootstrap samples for model test, if either
<code>n.model.boots</code> = 0 or
<code>model.test</code>=FALSE, then model test will not be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code>glm.control</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code>glm.control</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code>glm.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other future arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model: <code class="reqn">\log\{g(x)/f(x)\}=\exp\{\alpha+\beta'T(x)\}</code>,
where <code class="reqn">f(x)</code> and <code class="reqn">g(x)</code> are the
density (frequency) functions of the two hypothesized populations, and <code class="reqn">T(x)</code> can be chosen as
<code class="reqn">T(x)=x</code> or <code class="reqn">T(x)=(x,x^2)</code>.  The procedure will fail when there is separation in the data in the
sense of Albert \&amp; Anderson(1984, <em>Biometrika</em>) and Santner \&amp; Duffy (1986, <em>Biometrika</em>).
In this case, the change-point(s) may be detected easily using nonparametric method
based on cumsum. Currently, this function does not check whether the data are separated.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.name </code></td>
<td>
<p>dataset name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter </code></td>
<td>
<p>sample size <code>n</code> and degree(s) of freedom of the <code>df</code> of <code>Sn</code> for
<code>"one-change"</code> alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative </code></td>
<td>
<p>the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic </code></td>
<td>
<p>a list contains <code>Sn</code> for <code>"one-change"</code> alternative, <code>Sn</code>, <code>Vn</code> and <code>Wn</code>
for <code>"epidemic"</code> alternative;
also contains <code>Delta</code> if model test is performed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>a list contains change-point(s) and <code>alpha</code> and <code>beta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p> a list contains <code>p</code>-value(s), <code>p(Sn)</code>, of <code>Sn</code> for <code>"one-change"</code> alternative,
<code>p(Vn)</code> and <code>p(Wn)</code>, of <code>Vn</code> and <code>Wn</code>, repectively, for <code>"epidemic"</code> alternative;
also <code>p.boots(model)</code> of <code>Delta</code> if model test is performed, if bootstrap test(s) of the change-point(s)
are performed, the it also containts the
corresponding <code>p</code>-values, <code>p.boots(Sn)</code>, <code>p.boots(Vn)</code> and <code>p.boots(Wn)</code> accordingly.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Statistic <code>Wn</code> need be adjusted only for one dimensional observations
and if no bootstrap test is conducted. If returned <code>p</code>-value is 0, this means that the
<code>p</code>-value is less than 1.0e-7.
</p>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan,  Z. (2001).   Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric change-point model, <em>Biometrika</em>, 91, 4, 849â€“862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code>Graf.Diagnostic</code>, <code>Plot.ll</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">require(sac) #load the package
# one-change alternative
## Nile data with one change-point: the annual flows drop in 1898.
## It is believed to be caused by the building of the first Aswan dam.
if(! "package:sac" %in% search()) library(sac)
    #if package sac has not been loaded, load it.
if(! "package:stats" %in% search()) library(stats)
data(Nile)
plot(Nile, type="p")
schapt(Nile, alternative = "one.change")
</code></pre>


</div>