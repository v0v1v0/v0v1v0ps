<div class="container">

<table style="width: 100%;"><tr>
<td>svyscoretest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Score tests in survey regression models
</h2>

<h3>Description</h3>

<p>Performs two versions of the efficient score test. These are the same
for a single parameter. In the <code>working</code> score test, different
parameters are weighted according to the inverse of the estimated population Fisher
information. In the <code>pseudoscore</code> test, parameters are weighted according to the
inverse of their estimated covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">svyscoretest(model, drop.terms=NULL, add.terms=NULL,
method=c("working","pseudoscore","individual"),ddf=NULL,
lrt.approximation = "satterthwaite", ...)
## S3 method for class 'svyglm'
svyscoretest(model, drop.terms=NULL, add.terms=NULL,
method=c("working","pseudoscore","individual"), ddf=NULL,
lrt.approximation = "satterthwaite",fullrank=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>A model of a class having a <code>svyscoretest</code> method (currently
just <code>svyglm</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.terms</code></td>
<td>

<p>Model formula giving terms to remove from <code>model</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.terms</code></td>
<td>
<p>Model formula giving terms to add to <code>model</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The type of score test to use. For a single parameter they are
equivalent. To report tests for each column separately use <code>individual</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddf</code></td>
<td>
<p>denominator degrees of freedom for an F or linear combination
of F distributions. Use <code>Inf</code> to get chi-squared
distributions. <code>NULL</code> asks for the model residual degrees of
freedom, which is conservative. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrt.approximation</code></td>
<td>

<p>For the working score, the method for computing/approximating the null
distribution: see <code>pchisqsum</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullrank</code></td>
<td>
<p>If <code>FALSE</code> and <code>method="individual"</code>, keep
even linearly dependent columns of the
efficient score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>for future expansion
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>working</code> score test will be asymptotically equivalent to the
Rao-Scott likelihood ratio test computed by <code>regTermTest</code>
and <code>anova.svyglm</code>. The paper by Rao, Scott and Skinner calls this
a "naive" score test. The null distribution is a linear combination
of chi-squared (or F) variables. 
</p>
<p>The <code>pseudoscore</code> test will be
asymptotically equivalent to the Wald test computed by
<code>regTermTest</code>; it has a chi-squared (or F) null
distribution.
</p>
<p>If <code>ddf</code> is negative or zero, which can happen with large numbers
of predictors and small numbers of PSUs, it will be changed to 1 with a warning.
</p>


<h3>Value</h3>

<p>For "pseudoscore" and "working" score methods, a named vector with the test
statistic, degrees of freedom, and p-value. For "individual" an object
of class "svystat"
</p>


<h3>References</h3>

<p>JNK Rao, AJ Scott, and C
Rao, J., Scott, A., &amp; Skinner, C. (1998). QUASI-SCORE TESTS WITH SURVEY
DATA. Statistica Sinica, 8(4), 1059-1070.
</p>


<h3>See Also</h3>

<p><code>regTermTest</code>, <code>anova.svyglm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(myco)
dmyco&lt;-svydesign(id=~1, strata=~interaction(Age,leprosy),weights=~wt,data=myco)

m_full&lt;-svyglm(leprosy~I((Age+7.5)^-2)+Scar, family=quasibinomial, design=dmyco)
svyscoretest(m_full, ~Scar)

svyscoretest(m_full,add.terms= ~I((Age+7.5)^-2):Scar)
svyscoretest(m_full,add.terms= ~factor(Age), method="pseudo")
svyscoretest(m_full,add.terms= ~factor(Age),method="individual",fullrank=FALSE)

svyscoretest(m_full,add.terms= ~factor(Age),method="individual")

</code></pre>


</div>