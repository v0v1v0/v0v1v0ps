<div class="container">

<table style="width: 100%;"><tr>
<td>intra_influ_phylm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interaction between intraspecific variability and influential species - Phylogenetic Linear Regression</h2>

<h3>Description</h3>

<p>Performs leave-one-out deletion analysis for phylogenetic linear regression,
and detects influential species, while taking into account potential
interactions with intraspecific variability.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intra_influ_phylm(
  formula,
  data,
  phy,
  Vy = NULL,
  Vx = NULL,
  y.transf = NULL,
  x.transf = NULL,
  n.intra = 10,
  distrib = "normal",
  model = "lambda",
  cutoff = 2,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The model formula:  <code>response~predictor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vy</code></td>
<td>
<p>Name of the column containing the standard deviation or the standard error of the response 
variable. When information is not available for one taxon, the value can be 0 or <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vx</code></td>
<td>
<p>Name of the column containing the standard deviation or the standard error of the predictor 
variable. When information is not available for one taxon, the value can be 0 or <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.transf</code></td>
<td>
<p>Transformation for the response variable (e.g. <code>"log"</code> or <code>"sqrt"</code>). Please use this 
argument instead of transforming data in the formula directly (see also details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.transf</code></td>
<td>
<p>Transformation for the predictor variable (e.g. <code>"log"</code> or <code>"sqrt"</code>). Please use this 
argument instead of transforming data in the formula directly (see also details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.intra</code></td>
<td>
<p>Number of datasets resimulated taking into account intraspecific variation (see: <code>"intra_phylm"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distrib</code></td>
<td>
<p>A character string indicating which distribution to use to generate a random value for the response 
and/or predictor variables. Default is normal distribution: "normal" (function <code>rnorm</code>).
Uniform distribution: "uniform" (<code>runif</code>)
Warning: we recommend to use normal distribution with Vx or Vy = standard deviation of the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The phylogenetic model to use (see Details). Default is <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cutoff value used to identify for influential species
(see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>phylolm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a phylogenetic linear regression model using <code>phylolm</code>, and detects
influential species by sequentially deleting one at a time. The regression is repeated <code>n.intra</code> times for 
simulated values of the dataset, taking into account intraspecific variation. At each iteration, the function 
generates a random value for each row in the dataset using the standard deviation or errors supplied, and 
detect the influential species within that iteration. 
</p>
<p>All phylogenetic models from <code>phylolm</code> can be used, i.e. <code>BM</code>,
<code>OUfixedRoot</code>, <code>OUrandomRoot</code>, <code>lambda</code>, <code>kappa</code>,
<code>delta</code>, <code>EB</code> and <code>trend</code>. See ?<code>phylolm</code> for details.
</p>
<p><code>influ_phylm</code> detects influential species based on the standardised
difference in intercept and/or slope when removing a given species compared
to the full model including all species. Species with a standardised difference
above the value of <code>cutoff</code> are identified as influential. The default
value for the cutoff is 2 standardised differences change.
</p>
<p>Currently, this function can only implement simple linear models (i.e. <code class="reqn">trait~
predictor</code>). In the future we will implement more complex models.
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>intra_influ_phylm</code> returns a list with the following
components:
</p>
<p><code>cutoff</code>: The value selected for <code>cutoff</code>
</p>
<p><code>formula</code>: The formula
</p>
<p><code>full.model.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (e.g. <code>lambda</code>) for the full model
without deleted species.
</p>
<p><code>influential_species</code>: List of influential species, both
based on standardised difference in intercept and in the slope of the
regression. Species are ordered from most influential to less influential and
only include species with a standardised difference &gt; <code>cutoff</code>.
</p>
<p><code>sensi.estimates</code>: A data frame with all simulation
estimates. Each row represents a deleted clade for an iteration of resimulated
data. Columns report the calculated regression intercept (<code>intercept</code>), 
difference between simulation intercept and full model intercept (<code>DIFintercept</code>), 
the standardised difference (<code>sDIFintercept</code>), the percentage of change in intercept compared
to the full model (<code>intercept.perc</code>) and intercept p-value
(<code>pval.intercept</code>). All these parameters are also reported for the regression
slope (<code>DIFestimate</code> etc.). Additionally, model aic value (<code>AIC</code>) and
the optimised value (<code>optpar</code>) of the phylogenetic parameter
(e.g. <code>kappa</code> or <code>lambda</code>, depending on the phylogenetic model used) are
reported.
</p>
<p><code>data</code>: Original full dataset.
</p>
<p><code>errors</code>: Species where deletion resulted in errors.
</p>


<h3>Warning</h3>

<p>When Vy or Vx exceed Y or X, respectively, negative (or null) values can be generated, this might cause problems
for data transformation (e.g. log-transformation). In these cases, the function will skip the simulation. 
</p>
<p>Setting <code>n.intra</code> at high values can take a long time to execute, since the total number of iterations 
equals <code>n.intra * nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Gustavo Paterno, Caterina Penone &amp; Gijsbert D.A. Werner
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467.  
</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.
</p>


<h3>See Also</h3>

<p><code>phylolm</code>, <code>intra_phylm</code>,
<code>influ_phylm</code>,<code>intra_influ_phyglm</code>,<code>sensi_plot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load data:
data(alien)
# run analysis:
intra_influ &lt;- intra_influ_phylm(formula = gestaLen ~ adultMass, phy = alien$phy[[1]],
data=alien$data,model="lambda",y.transf = log,x.transf = NULL,Vy="SD_gesta",Vx=NULL,
n.intra=30,distrib = "normal")
summary(intra_influ)
sensi_plot(intra_influ)

## End(Not run)

</code></pre>


</div>