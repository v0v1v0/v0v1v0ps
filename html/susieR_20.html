<div class="container">

<table style="width: 100%;"><tr>
<td>susie_auto</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Attempt at Automating SuSiE for Hard Problems</h2>

<h3>Description</h3>

<p><code>susie_auto</code> is an attempt to automate reliable
running of susie even on hard problems. It implements a three-stage
strategy for each L: first, fit susie with very small residual
error; next, estimate residual error; finally, estimate the prior
variance. If the last step estimates some prior variances to be
zero, stop. Otherwise, double L, and repeat. Initial runs are
performed with relaxed tolerance; the final run is performed using
the default susie tolerance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">susie_auto(
  X,
  y,
  L_init = 1,
  L_max = 512,
  verbose = FALSE,
  init_tol = 1,
  standardize = TRUE,
  intercept = TRUE,
  max_iter = 100,
  tol = 0.01,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An n by p matrix of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The observed responses, a vector of length n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_init</code></td>
<td>
<p>The initial value of L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_max</code></td>
<td>
<p>The largest value of L to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code>, the algorithm's progress,
and a summary of the optimization settings, are printed to the
console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_tol</code></td>
<td>
<p>The tolerance to passed to <code>susie</code> during
early runs (set large to shorten the initial runs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>If <code>standardize = TRUE</code>, standardize the
columns of X to unit variance prior to fitting. Note that
<code>scaled_prior_variance</code> specifies the prior on the
coefficients of X <em>after</em> standardization (if it is
performed). If you do not standardize, you may need to think more
carefully about specifying <code>scaled_prior_variance</code>. Whatever
your choice, the coefficients returned by <code>coef</code> are given for
<code>X</code> on the original input scale. Any column of <code>X</code> that
has zero variance is not standardized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>If <code>intercept = TRUE</code>, the intercept is
fitted; it <code>intercept = FALSE</code>, the intercept is set to
zero. Setting <code>intercept = FALSE</code> is generally not
recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of IBSS iterations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A small, non-negative number specifying the convergence
tolerance for the IBSS fitting procedure. The fitting procedure
will halt when the difference in the variational lower bound, or
“ELBO” (the objective function to be maximized), is
less than <code>tol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>susie</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>See <code>susie</code> for a description of return values.
</p>


<h3>See Also</h3>

<p><code>susie</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n = 1000
p = 1000
beta = rep(0,p)
beta[1:4] = 1
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
res = susie_auto(X,y)
plot(beta,coef(res)[-1])
abline(a = 0,b = 1,col = "skyblue",lty = "dashed")
plot(y,predict(res))
abline(a = 0,b = 1,col = "skyblue",lty = "dashed")

</code></pre>


</div>