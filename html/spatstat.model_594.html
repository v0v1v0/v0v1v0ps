<div class="container">

<table style="width: 100%;"><tr>
<td>rmhmodel.ppm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interpret Fitted Model for Metropolis-Hastings Simulation.</h2>

<h3>Description</h3>

<p>Converts a fitted point process model
into a format that can be used to simulate the model
by the Metropolis-Hastings algorithm. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'ppm'
rmhmodel(model, w, ..., verbose=TRUE, project=TRUE,
                         control=rmhcontrol(),
                         new.coef=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Fitted point process model (object of class <code>"ppm"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>Optional. Window in which the simulations should be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical flag indicating whether to print progress reports
while the model is being converted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project</code></td>
<td>
<p>Logical flag indicating what to do if the fitted model
does not correspond to a valid point process. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>Parameters determining the iterative behaviour of the simulation
algorithm. Passed to <code>rmhcontrol</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.coef</code></td>
<td>

<p>New values for the canonical parameters of the model.
A numeric vector of the same length as <code>coef(model)</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generic function <code>rmhmodel</code> takes a
description of a point process model in some format, and
converts it into an object of class <code>"rmhmodel"</code>
so that simulations of the model can be generated using
the Metropolis-Hastings algorithm <code>rmh</code>. 
</p>
<p>This function <code>rmhmodel.ppm</code> is the method for
the class <code>"ppm"</code> of fitted point process models.
</p>
<p>The argument <code>model</code> should be a fitted point process model
(object of class <code>"ppm"</code>) typically obtained from the
model-fitting function <code>ppm</code>.
This will be converted into an object of class <code>"rmhmodel"</code>.
</p>
<p>The optional argument <code>w</code> specifies the window
in which the pattern is to be generated.  If specified, it must be in
a form which can be coerced to an object of class <code>owin</code>
by <code>as.owin</code>.
</p>
<p>Not all fitted point process models
obtained from <code>ppm</code> can be simulated.
We have not yet implemented simulation code for
the <code>LennardJones</code> and <code>OrdThresh</code>
models.
</p>
<p>It is also possible that a fitted point process model
obtained from <code>ppm</code>  may not correspond to a valid
point process. For example a fitted model with the <code>Strauss</code>
interpoint interaction may have any value of the interaction parameter
<code class="reqn">\gamma</code>; however the Strauss 
process is not well-defined for 
<code class="reqn">\gamma &gt; 1</code> (Kelly and Ripley, 1976).
</p>
<p>The argument <code>project</code> determines what to do in such cases.
If <code>project=FALSE</code>, a fatal error will occur.
If <code>project=TRUE</code>, the fitted model parameters will be
adjusted to the nearest values which do correspond to a valid
point process. For example a Strauss process with <code class="reqn">\gamma &gt;
    1</code> will be projected to a Strauss process with
<code class="reqn">\gamma = 1</code>, equivalent to a Poisson process.
</p>


<h3>Value</h3>

<p>An object of class <code>"rmhmodel"</code>, which is essentially
a list of parameter values for the model.
</p>
<p>There is a <code>print</code> method for this class, which prints
a sensible description of the model chosen.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and
Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>References</h3>

<p>Diggle, P. J. (2003) <em>Statistical Analysis of Spatial Point
Patterns</em> (2nd ed.) Arnold, London.
</p>
<p>Diggle, P.J. and Gratton, R.J. (1984)
Monte Carlo methods of inference for implicit statistical models.
<em>Journal of the Royal Statistical Society, series B</em>
<b>46</b>, 193 – 212.
</p>
<p>Geyer, C.J. (1999)
Likelihood Inference for Spatial Point
Processes. Chapter 3 in  O.E. Barndorff-Nielsen, W.S. Kendall and
M.N.M. Van Lieshout (eds) <em>Stochastic Geometry: Likelihood and
Computation</em>, Chapman and Hall / CRC,  Monographs on Statistics and
Applied Probability, number 80. Pages 79–140.
</p>
<p>Kelly, F.P. and Ripley, B.D. (1976)
On Strauss's model for clustering.
<em>Biometrika</em> <b>63</b>, 357–360.
</p>


<h3>See Also</h3>

<p><code>rmhmodel</code>,
<code>rmhmodel.list</code>,
<code>rmhmodel.default</code>,
<code>rmh</code>,
<code>rmhcontrol</code>,
<code>rmhstart</code>,
<code>ppm</code>,
<code>AreaInter</code>, <code>BadGey</code>, <code>DiggleGatesStibbard</code>, <code>DiggleGratton</code>, <code>Fiksel</code>, <code>Geyer</code>, <code>Hardcore</code>, <code>Hybrid</code>, <code>LennardJones</code>, <code>MultiStrauss</code>, <code>MultiStraussHard</code>, <code>PairPiece</code>, <code>Penttinen</code>, <code>Poisson</code>, <code>Softcore</code>, <code>Strauss</code>, <code>StraussHard</code> and <code>Triplets</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  fit1 &lt;- ppm(cells ~1, Strauss(0.07))
  mod1 &lt;- rmhmodel(fit1)

  fit2 &lt;- ppm(cells ~x, Geyer(0.07, 2))
  mod2 &lt;- rmhmodel(fit2)

  fit3 &lt;- ppm(cells ~x, Hardcore(0.07))
  mod3 &lt;- rmhmodel(fit3)

  # Then rmh(mod1), etc
</code></pre>


</div>