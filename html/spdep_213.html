<div class="container">

<table style="width: 100%;"><tr>
<td>p.adjustSP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust local association measures' p-values</h2>

<h3>Description</h3>

<p>Make an adjustment to local association measures' p-values based on the number of neighbours (+1) of each region, rather than the total number of regions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.adjustSP(p, nb, method = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>a list of neighbours of class <code>nb</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>correction method as defined in <code>p.adjust</code>: "The adjustment methods include the Bonferroni correction ('"bonferroni"') in which the p-values are multiplied by the number of comparisons.  Four less conservative corrections are also included by Holm (1979) ('holm'), Hochberg (1988) ('hochberg'), Hommel (1988) ('hommel') and Benjamini &amp; Hochberg (1995) ('fdr'), respectively. A pass-through option ('none') is also included."</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of corrected p-values using only the number of neighbours + 1.
</p>


<h3>Author(s)</h3>

<p>Danlin Yu and Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>See Also</h3>

<p><code>p.adjust</code>, <code>localG</code>, <code>localmoran</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(afcon, package="spData")
oid &lt;- order(afcon$id)
resG &lt;- as.vector(localG(afcon$totcon, nb2listw(include.self(paper.nb))))
non &lt;- format.pval(pnorm(2*(abs(resG)), lower.tail=FALSE), 2)
bon &lt;- format.pval(p.adjustSP(pnorm(2*(abs(resG)), lower.tail=FALSE),
 paper.nb, "bonferroni"), 2)
tot &lt;- format.pval(p.adjust(pnorm(2*(abs(resG)), lower.tail=FALSE),
 "bonferroni", n=length(resG)), 2)
data.frame(resG, non, bon, tot, row.names=afcon$name)[oid,]
</code></pre>


</div>