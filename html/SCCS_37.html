<div class="container">

<table style="width: 100%;"><tr>
<td>smoothexposccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spline-based semiparametric SCCS, smooth exposure

</h2>

<h3>Description</h3>

<p>Fits a spline-based SCCS model where the exposure-related relative incidence function is represented by a spline function, that is a linear combination of M-splines, and the age effects are represented by a piecewise constant function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothexposccs(indiv, astart, aend, aevent, adrug, aedrug, agegrp, kn=12, 
               sp = NULL, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at which the observation periods start. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event (outcome of interest), an individual can experience multiple events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a vector of ages at which exposure related risk period starts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a vector of ages at which exposure related risk period ends.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agegrp</code></td>
<td>

<p>a vector of cut points for the age groups where each value represents the start of an age catagory. The first element in the vector is the start of the second age group. The first age group starts at the minimum of <code>astart</code>, the start of the observation period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>

<p>number of interior knots &gt;=5 used to define the M-spline basis functions, usually between 8 and 12 knots is sufficient. The default is 12. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>

<p>smoothing parameter value. It defaults to "auto" where the smoothing paramter is obtained automatically using a cross validation method. The value of "sp" must be a number greater or equal to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the input data.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>standardsccs</code>, <code>semisccs</code> and <code>smoothagesccs</code> use piecewise constant step functions to model the exposure effect. However mis-specification of exposure group cut points might result in biased estimates. This method represents exposure related relative incidence function by a spline function.
</p>


<h3>Value</h3>

<p>Relative incidence estimates along with their 95% confidence limits. Varaince-covariance matrix can also be obtained. 


</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>exposure related relative incidence estimates at each point of time since start of exposure until the maximum duration of exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lci </code></td>
<td>
<p>lower confidence limits of the exposure-related relative incidence estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uci </code></td>
<td>
<p>upper confidence limits of the exposure-related relative incidence estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington. 
</p>


<h3>References</h3>


<p>Ghebremichael-Weldeselassie, Y., Whitaker, H. J., Farrington, C. P. (2015). Flexible modelling of vaccine effects in self-controlled case series models 25, 1768â€“1797.
</p>
<p>Farrington, P., Whitaker, H., and Ghebremichael-Weldeselassie, Y. (2018). Self-controlled Case Series Studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press.
</p>



<h3>See Also</h3>

<p><code>smoothagesccs</code>, <code>nonparasccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(SCCS)

# Fit smooth exposure SCCS to MMR vaccine and itp 

 itp.mod1 &lt;- smoothexposccs(sp=10, indiv=case, astart=sta, aend=end,
                           aevent=itp, adrug=mmr, aedrug=mmr+42,
                           agegrp=c(427, 488, 549, 610, 671), data=itpdat)
 
 itp.mod1
 
 plot(itp.mod1)
 
</code></pre>


</div>