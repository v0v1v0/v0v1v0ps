<div class="container">

<table style="width: 100%;"><tr>
<td>gdm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the General Dynamic Model of Island Biogeography</h2>

<h3>Description</h3>

<p>Fit the general dynamic model (GDM) of island biogeography using
a variety of non-linear and linear SAR models. Functions are provided to
compare the GDM fitted using different SAR models, and also, for a given
SAR model, to compare the GDM with alternative nested candidate models
(e.g. S ~ Area + Time).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gdm(data, model = "linear", mod_sel = FALSE, AST = c(1, 2, 3),
  start_vals = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe or matrix with at least three columns, where one
column should include island area values, one island richness values and
one island age values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Name of the SAR model to be used to fit the GDM. Can be any of
'loga', 'linear', 'power_area', 'power_area_time', 'all', or 'ATT2'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_sel</code></td>
<td>
<p>Logical argument specifying whether, for a given SAR model, a
model comparison of the GDM with other nested candidate models should be
undertaken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AST</code></td>
<td>
<p>The column locations in <code>data</code> for the area, richness and
time values (in that order).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_vals</code></td>
<td>
<p>An optional dataframe with starting parameter values for
the non-linear regression models (same format as in <code>nls</code>).
Default is set to NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The GDM models island species richness as a function of island area
and island age, and takes the general form: S ~ A + T + T^2, where S =
richness, A =area, and T = island age. The T^2 term is included as the GDM
predicts a hump-shaped relationship between island richness and island age.
However, a variety of different SAR models have been used to fit the GDM
and five options are available here: four using non-linear regression and
one using linear regression.
</p>
<p>Non-linear models
</p>
<p>Four SAR models can be used here to fit the GDM: the logarithmic
(<code>model = "loga"</code>), linear (<code>model = "linear"</code>) and power
(<code>model = "power_area"</code>) SAR models. Another variant of the GDM
includes power functions of both area and time (<code>model =
  "power_area_time"</code>). Model fitting follows the procedure in Cardoso et al.
(2015). For example, when the linear SAR model is used, the GDM can be
fitted using the expression: S ~ Int + A*Area + Ti*T + Ti2*T^2, where Int,
A, Ti and Ti2 are free parameters to be estimated. When the power model is
used just for area, the equivalent expression is: S ~ exp(Int + A*log(Area)
+ Ti*T + Ti2*T^2). For all four models, the GDM is fitted using non-linear
regression and the <code>nls</code> function. It should be noted that the
two power models are fitted using S ~ exp(...) to ensure the same response
variable (i.e. S and not log(S)) is used in all GDM models and thus AIC etc
can be used to compare them.
</p>
<p>For each model fit, the residual standard error (RSE), R2 and AIC and AICc
values are reported. However, as the model fit object is returned, it is
possible to calculate or extract various other measures of goodness of fit
(see <code>nls</code>).
</p>
<p>If <code>mod_sel = TRUE</code>, the GDM (using a particular SAR model) is fitted
and compared with three other (nested) candidate models: area and time
(i.e. no time^2 term), just area, and an intercept only model. The
intercept only model is fitted using <code>lm</code> rather than <code>nls</code>. If
<code>model = "all"</code>, the GDM is fitted four times (using the power_area,
power_area_time, loga and linear SAR models), and the fits compared using
<code>AIC</code> and <code>AICc</code>.
</p>
<p>Non-linear regression models are sensitive to the starting parameter values
selected. The defaults used here have been chosen as they provide a
sensible general choice, but they will not work in all circumstances. As
such, alternative starting values can be provided using the
<code>start_vals</code> argument - this is done in the same way as for
<code>nls</code>. The four parameter names are: Int (intercept), A (area),
Ti (Time), Ti2 (Time^2) (see the example below). This only works for the
full GDM non-linear models, and not for the nested models that are fitted
when <code>mod_sel = TRUE</code> or for the linear models (where they are not
needed). If used with <code>model = "all"</code>, the same starting parameter
values will be provided to each of the four GDM models (power_area,
power_area_time, logarithmic and linear).
</p>
<p>Linear ATT2 Model
</p>
<p>As an alternative to fitting the GDM using non-linear regression, the model
can be fitted in various ways using linear regression. This can also be
useful if you are having problems with the non-linear regression algorithms
not converging. If <code>model = "ATT2"</code> is used, the GDM is fitted using
the semi-log logarithmic SAR model using linear regression (with
untransformed richness and time, and log(area)); this is the original GDM
model fitted by Whittaker et al. (2008) and we have used their chosen name
(ATT2) to represent it. Steinbauer et al. (2013) fitted variants of this
model using linear regression by log-transforming richness and / or time.
While we do not provide functionality for fitting these variants, this is
easily done by simply providing the log-transformed variable values to the
function rather than the untransformed values. Using <code>model = "ATT2"</code>
is basically a wrapper for the <code>lm</code> function. If <code>mod_sel ==
  TRUE</code>, the GDM is fitted and compared with three other (nested) candidate
models: log(area) and time (i.e. no time^2 term), just log(area), and an
intercept only model.
</p>


<h3>Value</h3>

<p>Different objects are returned depending on whether the non-linear or
linear regression models are fitted.
</p>
<p>Non-linear models
</p>
<p>An object of class 'gdm'. If <code>model</code> is one of "loga", "linear",
"power_area" or "power_area_time" the returned object is a
<code>nls</code> model fit object. If <code>model == "all"</code>, the returned
object is a list with four elements; each element being a <code>nls</code> fit
object. If <code>mod_sel == TRUE</code> and <code>model != "all"</code>, a list with
four elements is returned; each element being a <code>lm</code> or <code>nls</code> fit
object. When <code>model == "all"</code>, a list with four elements is returned;
each element being a list of the four model fits for a particular SAR
model.
</p>
<p>Linear ATT2 Model
</p>
<p>If <code>model = "ATT2"</code> is used, the returned object is
of class 'gdm' and 'lm' and all of the method functions associated with
standard 'lm' objects (e.g. plot and summary) can be used. If <code>mod_sel
  = TRUE</code> a list with four elements is returned; each element being a
<code>lm</code> object.
</p>


<h3>Note</h3>

<p>The intercept (Int) parameter that is returned in the power models fits
(<code>model = "power_area" | "power_area_time"</code>) is on the log scale.
</p>


<h3>References</h3>

<p>Whittaker, R. J., Triantis, K. A., &amp; Ladle, R. J. (2008). A
general dynamic theory of oceanic island biogeography. Journal of
Biogeography, 35, 977-994.
</p>
<p>Borregaard, M. K. et al. (2017). Oceanic island biogeography through the
lens of the general dynamic model: assessment and prospect. Biological
Reviews, 92, 830-853.
</p>
<p>Cardoso, P., Rigal, F., &amp; Carvalho, J. C. (2015). BATâ€“Biodiversity
Assessment Tools, an R package for the measurement and estimation of alpha
and beta taxon, phylogenetic and functional diversity. Methods in Ecology
and Evolution, 6, 232-236.
</p>
<p>Steinbauer, M.J., Dolos, K., Field, R., Reineking, B. &amp; Beierkuhnlein, C.
(2013) Re-evaluating the general dynamic theory of oceanic island
biogeography. Frontiers of Biogeography, 5.
</p>
<p>Carey, M., Boland, J., Weigelt, P. &amp; Keppel, G. (2020) Towards an extended
framework for the general dynamic theory of biogeography. Journal of
Biogeography, 47, 2554-2566.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#create an example dataset and fit the GDM using the logarithmic SAR model
data(galap)
galap$t &lt;- c(4, 1, 13, 16, 15, 2, 6, 4, 5, 11, 3, 9, 8, 10, 12, 7)
g &lt;- gdm(galap, model = "loga", mod_sel = FALSE)

#Compare the GDM (using the logarithmic model) with other nested candidate
#models
g2 &lt;- gdm(galap, model = "loga", mod_sel = TRUE)

#compare the GDM fitted using the linear, logarithmic and both power models
g3 &lt;- gdm(galap, model = "all", mod_sel = FALSE)

#fit the GDM using the original ATT2 model of Whittaker et al. 2008 using lm,
#and compare it with other nested models
g4 &lt;- gdm(galap, model = "ATT2", mod_sel = TRUE)

#provide different starting parameter values when fitting the non-linear
#power model GDM
g5 &lt;- gdm(galap, model = "power_area",
start_vals = data.frame("Int" = 0, "A" = 1, Ti = 1, Ti2 = 0))
</code></pre>


</div>