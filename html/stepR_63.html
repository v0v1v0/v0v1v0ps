<div class="container">

<table style="width: 100%;"><tr>
<td>stepcand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forward selection of candidate jumps</h2>

<h3>Description</h3>

<p>Find candidates for jumps in serial data by forward selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepcand(y, x = 1:length(y), x0 = 2 * x[1] - x[2], max.cand = NULL,
  family = c("gauss", "gaussvar", "poisson", "binomial", "gaussKern"), param = NULL,
  weights = rep(1, length(y)), cand.radius = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector containing the serial data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of the same length as <code>y</code> containing the corresponding sample points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a single numeric giving the last unobserved sample point directly before sampling started</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cand</code></td>
<td>
<p>single integer giving the maximal number of blocks to find; defaults to using all data (note: there will be one block more than the number of jumps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>distribution of the errors, either <code>"gauss"</code>, <code>"poisson"</code> or <code>"binomial"</code>; <code>"gaussInhibit"</code> is like <code>"gauss"</code> forbids jumps getting close together or to the ends in <code>steppath.stepcand</code>, "gaussInhibitBoth" already forbids this in <code>stepcand</code> (not recommended)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>additional parameters specifying the distribution of the errors; the number of trials for family <code>"binomial"</code>; for <code>gaussInhibit</code> and <code>gaussInhibitBoth</code> a numeric of length 3 with components <code>"start"</code>, <code>"middle"</code> and <code>"end"</code> preventing the first jump from getting closer to <code>x0</code> than the <code>"start"</code> value, any two jumps from getting closer than the <code>"middle"</code> value, and the last jump from geting closer than the <code>"end"</code> value to the end, all distances measured by weights (cf. example below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a numeric vector of the same length as <code>y</code> containing non-negative weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cand.radius</code></td>
<td>
<p>a non-negative integer: adds for each candidate found all indices that are at most <code>cand.radius</code> away</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>stepcand</code> extending class <code>stepfit</code> such that it can be used as an input to <code>steppath.stepcand</code>: additionally contains columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cumSum</code></td>
<td>
<p>The cumulative sum of <code>x</code> up to <code>rightEnd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumSumSq</code></td>
<td>
<p>The cumulative sum of squares of <code>x</code> up to <code>rightEnd</code> (for <code>family = "gauss"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumSumWe</code></td>
<td>
<p>The cumulative sum of weights up to <code>rightEnd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>improve</code></td>
<td>
<p>The improvement this jump brought about when it was selected.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>steppath</code>, <code>stepfit</code>, family</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 5 blocks (4 jumps) within a total of 100 data points
b &lt;- c(sort(sample(1:99, 4)), 100)
f &lt;- rep(rnorm(5, 0, 4), c(b[1], diff(b)))
rbind(b = b, f = unique(f), lambda = exp(unique(f) / 10) * 20)
# add gaussian noise
x &lt;- f + rnorm(100)
# find 10 candidate jumps
stepcand(x, max.cand = 10)
# for poisson observations
y &lt;- rpois(100, exp(f / 10) * 20)
# find 10 candidate jumps
stepcand(y, max.cand = 10, family = "poisson")
# for binomial observations
size &lt;- 10
z &lt;- rbinom(100, size, pnorm(f / 10))
# find 10 candidate jumps
stepcand(z, max.cand = 10, family = "binomial", param = size)
</code></pre>


</div>