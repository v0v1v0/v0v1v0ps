<div class="container">

<table style="width: 100%;"><tr>
<td>prune_fam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove non-ancestors of a set of individuals from pedigree</h2>

<h3>Description</h3>

<p>This function accepts an input pedigree and a list of individuals of interest, and returns the subset of the pedigree including only the individuals of interest and their direct ancestors.
This is useful in simulations, to avoid modeling/drawing genotypes of individuals without descendants in the last generation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prune_fam(fam, ids, missing_vals = c("", 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>The pedigree data.frame, in plink FAM format.
Only columns <code>id</code>, <code>pat</code>, and <code>mat</code> are required.
<code>id</code> must be unique and non-missing.
Founders must be present, and their <code>pat</code> and <code>mat</code> values must be missing (see below).
Non-founders must have both their parents be non-missing.
Parents must appear earlier than their children in the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>The list of individuals of interest, whose ancestors we want to keep.
All must be present in <code>fam$id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_vals</code></td>
<td>
<p>The list of ID values treated as missing.
<code>NA</code> is always treated as missing.
By default, the empty string (‚Äù) and zero (0) are also treated as missing (remove values from here if this is a problem).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The filtered FAM table with non-ancestors of <code>ids</code> excluded.
IDs that are <code>NA</code>-equivalent (see <code>missing_vals</code>) will be mapped to <code>NA</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># construct a family with three founders, but one "bob" has no descendants
library(tibble)
fam &lt;- tibble(
    id  = c('mom', 'dad', 'bob', 'child'),
    pat = c(   NA,    NA,    NA,   'dad'),
    mat = c(   NA,    NA,    NA,   'mom')
)
# only want 'child' and its ancestors
ids &lt;- 'child'
fam2 &lt;- prune_fam( fam, ids )
# the filtered pedigree has "bob" removed:
fam2

</code></pre>


</div>