<div class="container">

<table style="width: 100%;"><tr>
<td>plot.capthist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot Detection Histories </h2>

<h3>Description</h3>

<p>Display a plot of detection (capture) histories or telemetry data over a map of the detectors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'capthist'
plot(x, rad = 5, hidetraps = FALSE, tracks = FALSE,
    title = TRUE, subtitle = TRUE, add = FALSE, varycol = TRUE, 
    icolours = NULL, randcol = FALSE, lab1cap = FALSE, laboffset = 4, ncap = FALSE, 
    splitocc = NULL, col2 = "green", type = c("petal", "n.per.detector", "n.per.cluster",
        "sightings", "centres", "telemetry", "nontarget"),
    cappar = list(cex = 1.3, pch = 16, col = "blue"), 
    trkpar = list(col = "blue", lwd = 1), 
    labpar = list(cex = 0.7, col = "black"), ...)

plotMCP(x, add = FALSE, col = "black", fill = NA, lab1cap = FALSE, laboffset = 4,
    ncap = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>capthist</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rad</code></td>
<td>
<p> radial displacement of dot indicating each capture event from the detector location (used to separate overlapping points) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidetraps</code></td>
<td>
<p> logical indicating whether trap locations should be displayed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracks</code></td>
<td>
<p> logical indicating whether consecutive locations of individual animals should be joined by a line </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p> logical or character string for title </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p> logical or character string for subtitle </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p> logical for whether to add to existing plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varycol</code></td>
<td>
<p> logical for whether to distinguish individuals by colour </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icolours</code></td>
<td>
<p> vector of individual colours (when <code>varycol</code> =
TRUE), or colour scale (non-petal plots) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randcol</code></td>
<td>
<p> logical to use random colours (<code>varycol</code> = TRUE) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab1cap</code></td>
<td>
<p> logical for whether to label the first capture of each animal </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>laboffset</code></td>
<td>
<p> distance by which to offset labels from points </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncap</code></td>
<td>
<p> logical to display the number of detections per trap per occasion </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitocc</code></td>
<td>
<p> optional occasion from which second colour is to be used  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>
<p> second colour (used with <code>splitocc</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> character string ("petal", "n.per.detector" or "n.per.cluster") </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cappar</code></td>
<td>
<p> list of named graphical parameters for detections (passed to <code>par</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trkpar</code></td>
<td>
<p> list of named graphical parameters for tracks (passed to <code>par</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labpar</code></td>
<td>
<p> list of named graphical parameters for labels (passed to <code>par</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments to be passed to <code>plot.traps</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>vector of line colour numbers or names (plotMCP only)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>vector of fill colour numbers or names (plotMCP only)</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>By default, a ‘petal’ plot is generated in the style of Density (Efford 2012)
using <code>eqscplot</code> from the MASS library. 
</p>
<p>If <code>type =
"n.per.detector"</code> or <code>type = "n.per.cluster"</code> the result is a
colour-coded plot of the number of individuals at each unit, pooled over
occasions. 
</p>
<p>If <code>type = "sightings"</code> the sightings of unmarked animals are 
displayed on a petal-like plot (requires mark-resight data) (see also <code>sightingPlot</code>).
</p>
<p>If <code>type = "centres"</code> then a single point is plotted for each animal, jittered on each axis by a random amount (limits +/- <code>rad</code>/2).
</p>
<p>If <code>type = "telemetry"</code> and the ‘telemetryxy’ attribute is not NULL then the telemetry locations are plotted.
</p>
<p>If <code>type = "nontarget"</code> and the ‘nontarget’ attribute is not NULL then the nontarget captures or interference events are plotted.
</p>
<p>If <code>title</code> = FALSE no title is displayed; if <code>title</code> = TRUE,
the session identifer is used for the title.
</p>
<p>If <code>subtitle</code> = FALSE no subtitle is displayed; if <code>subtitle</code>
= TRUE, the subtitle gives the numbers of occasions, detections and
individuals.
</p>
<p>If <code>x</code> is a multi-session capthist object then a separate plot is
produced for each session. Use <code>par(mfrow = c(nr, nc))</code> to allow a
grid of plots to be displayed simultaneously (nr rows x nc columns).
</p>
<p>These arguments are used only for petal plots: <code>rad</code>,
<code>tracks</code>, <code>varycol</code>, <code>randcol</code>, <code>lab1cap</code>,
<code>laboffset</code>, <code>ncap</code>, <code>splitocc</code>, <code>col2</code>,
<code>trkpar</code>, and <code>labpar</code>. Call <code>occasionKey</code> 
to add a key to the petals.
</p>
<p>If <code>icolours = NULL</code> and <code>varycol = TRUE</code> then a vector of
colours is generated automatically as topo.colors((nrow(x)+1) * 1.5).
If there are too few values in <code>icolours</code> for the number of
individuals then colours will be re-used. 
</p>
<p><code>plotMCP</code> plots minimum convex polygons of individual location
data over a base plot of detector locations. Usually the data are
telemetry locations in the xylist attribute of the capthist
object; if this is not present and <code>x</code> is a polygon search
capthist then the individual xy data are plotted.
</p>


<h3>Value</h3>

<p>For <code>type = "petal"</code>, the number of detections in <code>x</code>.
For <code>type = "sightings"</code>, the number of sightings of unmarked animals in <code>x</code>.
For <code>type = "n.per.detector"</code> or <code>type = "n.per.cluster"</code>, a
dataframe with data for a legend (see Examples).
</p>
<p><code>plotMCP</code> invisibly returns a list in which each component is a
2-column (x,y) dataframe of boundary coordinates for one individual.
</p>


<h3>References</h3>

 
<p>Efford, M. G. (2012) <em>DENSITY 5.0: software for spatially explicit
capture–recapture</em>. Department of Mathematics and Statistics,
University of Otago, Dunedin, New Zealand. <a href="https://www.otago.ac.nz/density/">https://www.otago.ac.nz/density/</a>.
</p>


<h3>See Also</h3>

 
<p><code>capthist</code>, 
<code>occasionKey</code>, 
<code>sightingPlot</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">demotrap &lt;- make.grid()
tempcapt &lt;- sim.capthist(demotrap, 
    popn = list(D = 5, buffer = 50), 
    detectpar = list(g0 = 0.15, sigma = 30))
plot(tempcapt, border = 10, rad = 3, tracks = TRUE, 
    lab1cap = TRUE, laboffset = 2.5)

## type = n.per.cluster

## generate some captures
testregion &lt;- data.frame(x = c(0,2000,2000,0),
    y = c(0,0,2000,2000))
popn &lt;- sim.popn (D = 10, core = testregion, buffer = 0,
    model2D = "hills", details = list(hills = c(-2,3)))
t1 &lt;- make.grid(nx = 1, ny = 1)
t1.100 &lt;- make.systematic (cluster = t1, spacing = 100,
    region = testregion)
capt &lt;- sim.capthist(t1.100, popn = popn, noccasions = 1)

## now plot captures ...
temp &lt;- plot(capt, title = "Individuals per cluster",
    type = "n.per.cluster", hidetraps = FALSE,
    gridlines = FALSE, cappar = list(cex = 1.5))

if (interactive()) {
    ## add legend; click on map to place top left corner
    legend (locator(1), pch = 21, pt.bg = temp$colour,
        pt.cex = 1.3, legend = temp$legend, cex = 0.8)
}

## Not run: 

## try varying individual colours - requires RColorBrewer
library(RColorBrewer)
plot(infraCH[[2]], icolours = brewer.pal(12, "Set3"), tracks = TRUE,
    bg = "black", cappar = list(cex = 2), border = 10, rad = 2,
    gridlines = FALSE)

## generate telemetry data
te &lt;- make.telemetry()
tr &lt;- make.grid(detector = "proximity")
totalpop &lt;- sim.popn(tr, D = 20, buffer = 100)
tepop &lt;- subset(totalpop, runif(nrow(totalpop)) &lt; 0.05)
teCH &lt;- sim.capthist(te, popn = tepop, renumber=FALSE, detectfn = "HHN",
    detectpar = list(lambda0 = 3, sigma = 25))
plot(teCH, type = 'telemetry', tracks = TRUE)

## simple "centres" example
## polygon data require 'hazard' detection function 14:19
CH &lt;- sim.capthist(make.poly(), nocc = 20, detectfn = 'HHN', 
    detectpar = list(lambda0 = 1, sigma = 10))
plot(CH, cappar = list(col = 'orange'), varycol = FALSE, border = 10)
plot(CH, type = 'centres', add = TRUE, rad = 0)

## End(Not run)

</code></pre>


</div>