<div class="container">

<table style="width: 100%;"><tr>
<td>scb.mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Build Simultaneous Confidence Bands for Mean Functions
</h2>

<h3>Description</h3>

<p>Fit a local linear estimator and build simultaneous confidence bands (SCB) for the mean of functional data.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">scb.mean(x, y, bandwidth, level = .95, degree = 1, 
	scbtype = c("normal","bootstrap","both","no"), gridsize = length(x), 
	keep.y = TRUE, nrep = 2e4, nboot = 5e3, parallel = c("no", "multicore", "snow"), 
	ncpus = getOption("boot.ncpus",1L), cl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of x data. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a matrix or data frame with functional observations (= curves) stored in rows. The number of columns of <code>y</code> must match the length of <code>x</code>. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>the kernel bandwidth smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of the simultaneous confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of the local polynomial fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scbtype</code></td>
<td>
<p>the type of simultaneous confidence bands to build: "normal", "bootstrap", "both", or "no".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>the size of the grid used to evaluate the mean function estimates and SCB. Defaults to <em>length(x)</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.y</code></td>
<td>
<p>logical; if <code>TRUE</code>, keep <code>y</code> in the result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of replicates for the Gaussian SCB method (20,000 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of replicates for the bootstrap SCB method (5,000 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>the computation method for the SCB. By default, computations are sequential (<code>"no"</code>). The bootstrap method uses function <code>boot</code> and can be run in parallel using the package <code>parallel</code>. In this case both options <code>"multicore"</code> and <code>"snow"</code> are available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>number of cores to use for parallel computing when <code>parallel = "multicore"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>name of the cluster to use for parallel computing when <code>parallel = "snow"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The local polynomial fitting uses a standard normal kernel and is implemented via the <code>locpoly</code> function.
Bootstrap SCB are implemented with the <code>boot</code> function and typically require more computation time than normal SCB.
</p>


<h3>Value</h3>

<p>An object of class <code>"SCBand"</code>. To accommodate the different functions creating objects of this class (<code>scb.mean</code>, <code>scb.model</code>, and <code>scb.equal</code>), some components of the object are set to <code>NULL</code>. The component list is:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the x data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the y data if <code>keep.y</code> is <code>TRUE</code>, else <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p><code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonpar</code></td>
<td>
<p>a nonparametric estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>the argument <code>bandwidth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of local polynomial used. 
Currently, only local linear estimation is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the argument <code>level</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scbtype</code></td>
<td>
<p>the argument <code>type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>teststat</code></td>
<td>
<p><code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnorm</code></td>
<td>
<p><code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pboot</code></td>
<td>
<p><code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnorm</code></td>
<td>
<p>the quantile used to build the normal SCB.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qboot</code></td>
<td>
<p>the quantile used to build the bootstrap SCB.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normscb</code></td>
<td>
<p>a matrix containing the normal SCB stored in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootscb</code></td>
<td>
<p>a matrix containing the bootstrap SCB stored in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>the argument <code>gridsize</code> if nonnull, else  <em>length(x)</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>the argument <code>nrep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the argument <code>nboot</code>.</p>
</td>
</tr>
</table>
<p>Depending on the value of <code>scbtype</code>, some of  
the fields <code>qnorm</code>, <code>normscb</code>, <code>nrep</code>, <code>qboot</code>, <code>normboot</code> and <code>nboot</code> may be <code>NULL</code>.
</p>


<h3>References</h3>

<p>Degras, D. (2011). Simultaneous confidence bands for nonparametric regression with functional data. <em>Statistica Sinica</em>, <b>21</b>, 1735â€“1765.
</p>


<h3>See Also</h3>

<p><code>scb.equal</code>, <code>scb.model</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Plasma citrate data
data(plasma)
time &lt;- 8:21
h &lt;- cv.select(time, plasma, 1, c(.5, 1))
scbplasma &lt;- scb.mean(time, plasma, bandwidth = h, scbtype = "both", gridsize = 100)
scbplasma
plot(scbplasma, cex = .2, legend.cex = .85, xlab = "Time", ylab = "Concentration", 
  main = "Plasma citrate data")

## End(Not run)
</code></pre>


</div>