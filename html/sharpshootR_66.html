<div class="container">

<table style="width: 100%;"><tr>
<td>SoilTaxonomyDendrogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Soil Taxonomy Dendrogram</h2>

<h3>Description</h3>

<p>Plot a dendrogram based on the first 4 levels of Soil Taxonomy, with soil profiles hanging below. A dissimilarity matrix is computed using Gower's distance metric for nominal (<code>KST.order = FALSE</code>) or ordinal (<code>KST.order = TRUE</code>) scale variables, based on soil order, suborder, greatgroup, and subgroup taxa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SoilTaxonomyDendrogram(
  spc,
  KST.order = TRUE,
  rotationOrder = NULL,
  level = c(soilorder = "soilorder", suborder = "suborder", greatgroup = "greatgroup",
    subgroup = "subgroup"),
  cluster.method = c("divisive", "agglomerative"),
  cluster.args = list(),
  name = "hzname",
  name.style = "center-center",
  id.style = "side",
  n.depth.ticks = 6,
  scaling.factor = 0.015,
  cex.names = 0.75,
  cex.id = 0.75,
  width = 0.25,
  y.offset = 0.5,
  shrink = FALSE,
  font.id = 2,
  cex.taxon.labels = 0.66,
  font.taxon.labels = 3,
  dend.color = par("fg"),
  dend.width = 1,
  dend.type = c("phylogram", "cladogram"),
  max.depth = ifelse(is.infinite(max(spc)), 200, max(spc)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spc</code></td>
<td>
<p>a <code>SoilProfileCollection</code> object, typically returned by <code>soilDB::fetchOSD</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KST.order</code></td>
<td>
<p>logical, encode / cluster taxa via ordinal factors, based on ordering within Keys to Soil Taxonomy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotationOrder</code></td>
<td>
<p>character vector of profile IDs with desired ordering of leaves in the dendrogram from left to right; exact ordering is not always possible</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>character. One or more site-level columns in <code>spc</code>. Default: <code>"soilorder"</code>, <code>"suborder"</code>, <code>"greatgroup"</code> and <code>"subgroup"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.method</code></td>
<td>
<p>Either "divisive" (<code>cluster::diana()</code>; default) or "agglomerative" (<code>cluster::agnes()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.args</code></td>
<td>
<p>Optional: additional arguments for <code>cluster::diana()</code> or <code>cluster::agnes()</code> cluster methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>column name containing horizon names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.style</code></td>
<td>
<p>passed to <code>aqp::plotSPC</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.style</code></td>
<td>
<p>passed to <code>aqp::plotSPC</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.depth.ticks</code></td>
<td>
<p>suggested number of ticks on the depth axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling.factor</code></td>
<td>
<p>scaling factor used to convert depth units into plotting units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.names</code></td>
<td>
<p>character scaling for horizon names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>character scaling for profile IDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of profiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.offset</code></td>
<td>
<p>vertical offset between dendrogram and profiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink</code></td>
<td>
<p>logical, should long horizon names be shrunk by 80% ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.id</code></td>
<td>
<p>integer, font style applied to profile id, default is 2 (bold)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.taxon.labels</code></td>
<td>
<p>numeric, character scaling for taxonomic information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.taxon.labels</code></td>
<td>
<p>integer, font style applied to taxa labels, default is 3 (italic)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dend.color</code></td>
<td>
<p>dendrogram line color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dend.width</code></td>
<td>
<p>dendrogram line width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dend.type</code></td>
<td>
<p>dendrogram type, passed to <code>plot.phylo()</code>, either "phylogram" or "cladogram"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.depth</code></td>
<td>
<p>depth at which profiles are truncated for plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>aqp::plotSPC</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function looks for specific site-level attributes named: <code>"soilorder"</code>, <code>"suborder"</code>, <code>"greatgroup"</code>, and <code>"subgroup"</code>, or their NASIS physical column name analogues <code>"taxorder"</code>, <code>"taxsuborder"</code>, <code>"taxgrtgroup"</code>, and <code>"taxsubgrp"</code>. See <a href="https://github.com/ncss-tech/sharpshootR/blob/master/misc/soilTaxonomyDendrogram-examples.R">https://github.com/ncss-tech/sharpshootR/blob/master/misc/soilTaxonomyDendrogram-examples.R</a> for some examples.
</p>
<p>The <code>rotationOrder</code> argument uses <code>ape::rotateConstr()</code> to reorder leaves within the <code>hclust</code> representation of the ST hierarchy. Perfect sorting is not always possible.
</p>


<h3>Value</h3>

<p>An invisibly-returned list containing:
</p>

<ul>
<li> <p><code>dist</code>: pair-wise dissimilarity matrix
</p>
</li>
<li> <p><code>order</code>: final ordering of <code>hclust</code> leaves
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>D.E. Beaudette
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# built-in data, same as results from soilDB::fetchOSD()
data("OSDexamples")

# examples using first 8 profiles

# KST-style ordering
SoilTaxonomyDendrogram(
  OSDexamples$SPC[1:8, ], width = 0.3, name.style = 'center-center',
  KST.order = TRUE, axis.line.offset = -4, scaling.factor = 0.014
)

# classic ordering, based on nominal scale variables (un-ordered factors)
SoilTaxonomyDendrogram(
  OSDexamples$SPC[1:8, ], width = 0.3, name.style = 'center-center',
  KST.order = FALSE, axis.line.offset = -4, scaling.factor = 0.014
)

# adjust taxon label font and font size
SoilTaxonomyDendrogram(
  OSDexamples$SPC[1:15, ], width = 0.3, name.style = 'center-center',
  KST.order = FALSE, axis.line.offset = -4, scaling.factor = 0.014,
  font.taxon.labels = 2, cex.taxon.labels = 0.55
)

# cladogram vs. dendrogram
# truncate profiles at 150cm
SoilTaxonomyDendrogram(
  OSDexamples$SPC[1:16, ], width = 0.3, name.style = 'center-center',
  KST.order = TRUE, axis.line.offset = -4, scaling.factor = 0.02,
  font.taxon.labels = 1, cex.taxon.labels = 0.55,
  dend.type = 'cladogram', max.depth = 150
)

</code></pre>


</div>