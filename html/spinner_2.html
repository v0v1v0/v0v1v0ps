<div class="container">

<table style="width: 100%;"><tr>
<td>spinner</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spinner</h2>

<h3>Description</h3>

<p>Spinner is an implementation of Graph Nets based on torch. Graph Nets are a family of neural network architectures designed for processing graphs and other structured data. They consist of a set of message-passing operations, which propagate information between nodes and edges in the graph, and a set of update functions, which compute new node and edge features based on the received messages.
</p>
<p>Proposes a 'torch' implementation of Graph Net architecture allowing different options for message passing and feature embedding.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spinner(
  graph,
  target,
  node_labels = NA,
  edge_labels = NA,
  context_labels = NA,
  direction = "from_head",
  sampling = NA,
  threshold = 0.01,
  method = "null",
  node_embedding_size = 5,
  edge_embedding_size = 5,
  context_embedding_size = 5,
  update_order = "enc",
  n_layers = 3,
  skip_shortcut = FALSE,
  forward_layer = 32,
  forward_activation = "relu",
  forward_drop = 0.3,
  mode = "sum",
  optimization = "adam",
  epochs = 100,
  lr = 0.01,
  patience = 30,
  weight_decay = 0.001,
  reps = 1,
  folds = 3,
  holdout = 0.2,
  verbose = TRUE,
  seed = 42
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A graph in igraph format (without name index for nodes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>String. Predicted dimension. Options are: "node", "edge".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_labels</code></td>
<td>
<p>String. Character vector with labels of node features. In case of absent features, default to NA (automatic node embedding with selected method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_labels</code></td>
<td>
<p>String. Character vector with labels of edge features. In case of absent features, default to NA (automatic edge embedding with selected method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context_labels</code></td>
<td>
<p>String. Character vector with labels of context features. In case of absent features, default to NA (automatic context embedding with selected method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>String. Direction of message propagation. Options are: "from_head", "from_tail". Default to: "from_head".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>Positive numeric or integer. In case of huge graph, you can opt for a subgraph. Sampling dimension expressed in absolute value or percentage. Default: NA (no sampling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Numeric. Below this threshold (calculated on edge density), sampling is done on edges, otherwise on nodes. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String. Embedding method in case of absent features. Options are: "null" (zeroed tensor), "laplacian", "adjacency". Default: "null".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_embedding_size</code></td>
<td>
<p>Integer. Size for node embedding. Default: 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_embedding_size</code></td>
<td>
<p>Integer. Size for edge embedding. Default: 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context_embedding_size</code></td>
<td>
<p>Integer. Size for node embedding. Default: 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_order</code></td>
<td>
<p>String. The order of message passing through nodes (n), edges (e) and context (c) for updating information. Available options are: "enc", "nec", "cen", "ecn", "nce", "cne". Default: "enc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_layers</code></td>
<td>
<p>Integer. Number of graph net variant layers. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_shortcut</code></td>
<td>
<p>Logical. Flag for applying skip shortcut after the graph net variant layers. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forward_layer</code></td>
<td>
<p>Integer. Single integer vector with size for forward net layer. Default: 32 (layers with 32 nodes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forward_activation</code></td>
<td>
<p>String. Single character vector with activation for forward net layer. Available options are: "linear", "relu", "mish", "leaky_relu", "celu", "elu", "gelu", "selu", "bent", "softmax", "softmin", "softsign", "sigmoid", "tanh". Default: "relu".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forward_drop</code></td>
<td>
<p>Numeric. Single numeric vector with drop out for forward net layer. Default: 0.3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>String. Aggregation method for message passing. Options are: "sum", "mean", "max". Default: "sum".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>
<p>String. Optimization method. Options are: "adadelta", "adagrad", "rmsprop", "rprop", "sgd", "asgd", "adam".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Positive integer. Default: 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr</code></td>
<td>
<p>Positive numeric. Learning rate. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patience</code></td>
<td>
<p>Positive integer. Waiting time (in epochs) before evaluating the overfit performance. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_decay</code></td>
<td>
<p>Positive numeric. L2-Regularization weight. Default: 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Positive integer. Number of repeated measures. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>Positive integer. Number of folds for each repetition. Default: 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>holdout</code></td>
<td>
<p>Positive numeric. Percentage of nodes for testing (edges are computed accordingly). Default: 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed. Default: 42.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li>
<p> graph: analyzed graph is returned (original graph or sampled subgraph).
</p>
</li>
<li>
<p> model_description: general model description.
</p>
</li>
<li>
<p> model_summary: summary for each torch module.
</p>
</li>
<li>
<p> pred_fun: function to predict on new graph data (you need to add new nodes/edges to the original graph respecting the directionality).
</p>
</li>
<li>
<p> cv_error: cross-validation error for each repetition and each fold. The error is a weighted normalized loss based on mse and binary cross-entropy (depending on the nature of each specific feature).
</p>
</li>
<li>
<p> summary_errors: final summary of error during cross-validation and testing.
</p>
</li>
<li>
<p> history: plot with loss for final training and testing.
</p>
</li>
<li>
<p> time_log: computation time.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>
<p><strong>Maintainer</strong>: Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul><li> <p><a href="https://rpubs.com/giancarlo_vercellino/spinner">https://rpubs.com/giancarlo_vercellino/spinner</a>
</p>
</li></ul>
</div>