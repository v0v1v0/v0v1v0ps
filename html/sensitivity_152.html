<div class="container">

<table style="width: 100%;"><tr>
<td>sobolMultOut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimation of Aggregated Sobol' Indices for multiple and functional outputs</h2>

<h3>Description</h3>

<p><code>sobolMultOut</code> implements the aggregated Sobol' indices for 
multiple outputs. It consists in averaging all the Sobol indices weighted
by the variance of their corresponding output. Moreover, this function computes and plots
the functional (unidimensional) Sobol' indices for functional (unidimensional)
model output via <code>plotMultOut</code>. Sobol' indices for both first-order and total indices are estimated 
by Monte Carlo formulas. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  sobolMultOut(model = NULL, q = 1, X1, X2, MCmethod = "sobol", 
               ubiquitous = FALSE, ...)
  ## S3 method for class 'sobolMultOut'
print(x, ...)
  ## S3 method for class 'sobolMultOut'
plot(x, ylim = c(0, 1), ...)
  ## S3 method for class 'sobolMultOut'
plotMultOut(x, ylim = c(0, 1), ...)
  ## S3 method for class 'sobolMultOut'
ggplot(data, mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>dimension of the model output vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>the first random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the second random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCmethod</code></td>
<td>
<p>a character string specifying the Monte-Carlo procedure used 
to estimate the Sobol indices. The avaible methods are : <code>"sobol"</code>, 
<code>"sobol2002"</code>, <code>"sobol2007"</code>, <code>"soboljansen"</code>, <code>"sobolmara"</code>
and <code>"sobolGP"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubiquitous</code></td>
<td>
<p>if TRUE, 1D functional Sobol indices are computed (default=FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>MCmethod</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>MCmethod</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For this function, there are several gaps: the bootstrap estimation of confidence 
intervals is not avalaible and the tell function does not work.
Aggregated Sobol' indices can be plotted with the S3 method <code>plot</code> and ubiquitous Sobol' indices can be visualized with the S3 method <code>plotMultOut</code> (does not work for the <code>"sobolGP"</code> method).
</p>


<h3>Value</h3>

<p><code>sobolMultOut</code> returns a list of class <code>MCmethod</code>, containing all
its input arguments, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of the aggregated Variances of the Conditional Expectations
(VCE) with respect to each factor and also with respect to the
complementary set of each factor ("all but <code class="reqn">X_i</code>").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the aggregated Sobol' first-order indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the estimations of the aggregated Sobol' total sensitivity indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sfct</code></td>
<td>
<p>the estimations of the functional Sobol' first-order indices 
(if ubiquitous=TRUE and plot.fct=TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tfct</code></td>
<td>
<p>the estimations of the functional Sobol' total sensitivity indices
(if ubiquitous=TRUE and plot.fct=TRUE).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bertrand Iooss
</p>


<h3>References</h3>

<p>M. Lamboni, H. Monod and D. Makowski, 2011, <em>Multivariate sensitivity analysis to measure global contribution of input factors in dynamic models</em>, Reliability Engineering and System Safety, 96:450-459.
</p>
<p>F. Gamboa, A. Janon, T. Klein and A. Lagnoux, 2014, <em>Sensitivity indices for multivariate outputs</em>, Electronic Journal of Statistics, 8:575-603.
</p>


<h3>See Also</h3>

<p><code>sobol, sobol2002, sobol2007, soboljansen,
    sobolmara, sobolGP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
    
    # Tests on the functional toy fct 'Arctangent temporal function'
    
    y0 &lt;- atantemp.fun(matrix(c(-7,0,7,-7,0,7),ncol=2))
    #plot(y0[1,],type="l")
    #apply(y0,1,lines)
    
    n &lt;- 100
    X &lt;- matrix(c(runif(2*n,-7,7)),ncol=2)
    y &lt;- atantemp.fun(X)
    plot(y0[2,],ylim=c(-2,2),type="l")
    apply(y,1,lines)
    
    # Sobol indices computations
    
    n &lt;- 1000
    X1 &lt;- data.frame(matrix(runif(2*n,-7,7), nrow = n))
    X2 &lt;- data.frame(matrix(runif(2*n,-7,7), nrow = n))
    
    sa &lt;- sobolMultOut(model=atantemp.fun, q=100, X1, X2, 
                       MCmethod="soboljansen", ubiquitous=TRUE)
    print(sa)
    plot(sa)
    plotMultOut(sa)
    
    library(ggplot2)
    ggplot(sa)
  
</code></pre>


</div>