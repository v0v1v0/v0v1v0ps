<div class="container">

<table style="width: 100%;"><tr>
<td>capture_all</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run an R expression and capture output and messages in a similar way as it
would be done at the command line</h2>

<h3>Description</h3>

<p>This function captures results of evaluating one or several R
expressions the same way as it would be issued at the prompt in a R console.
The result is returned in a character string. Errors, warnings and other
conditions are treated as usual, including the delayed display of the
warnings if <code>options(warn = 0)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">capture_all(expr, split = TRUE, echo = TRUE, file = NULL, markStdErr = FALSE)

captureAll(expr, split = TRUE, echo = TRUE, file = NULL, markStdErr = FALSE)

warnings2(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>A  valid R expression to evaluate (names and calls are also
accepted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>Do we split output, that is, do we also issue it at the R
console too, or do we only capture it silently?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echo</code></td>
<td>
<p>Do we echo each expression in front of the results (like in the
console)? In case the expression spans on more than 7 lines, only first and
last three lines are echoed, separated by <code style="white-space: pre;">⁠[...]⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A file, or a valid opened connection where output is sunk. It
is closed at the end, and the function returns <code>NULL</code> in this case. If
<code>file = NULL</code> (by default), a <code>textConnection()</code> captures the output and it
is returned as a character string by the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markStdErr</code></td>
<td>
<p>If <code>TRUE</code>, stderr is separated from sddout by STX/ETX
characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Items passed directly to <code>warnings2()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a string with the result of the evaluation done in the user
workspace.
</p>


<h3>Note</h3>

<p>If the expression is provided as a character string that should be
evaluated, and you need a similar behavior as at the prompt for incomplete
lines of code (that is, to prompt for more), you should not parse the
expression with <code>parse(text = "&lt;some_code&gt;")</code> because it returns an error
instead of an indication of an incomplete code line. Use
<code>parse_text("&lt;some_code&gt;")</code> instead, like in the examples bellow.
Of course, you have to deal with incomplete line management in your GUI/CLI
application... the function only returns <code>NA</code> instead of a character string.
Starting from version 1.1.3, <code>.Traceback</code> is not set any more in the base
environment, but it is <code>.Traceback_capture_all</code> that is set in <code>temp_env()</code>.
You can get its value with <code>get_temp(".Traceback_capture_all")</code>.
Also, if there are many warnings, those are now assigned in <code>temp_env()</code>
instead of <code>baseenv()</code>. Consequently, they cannot be viewer with <code>warnings()</code>
but use <code>warnings2()</code> in this case.
</p>


<h3>See Also</h3>

<p><code>parse()</code>, <code>expression()</code>, <code>capture.output()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">writeLines(capture_all(expression(1 + 1), split = FALSE))
writeLines(capture_all(expression(1 + 1), split = TRUE))
writeLines(capture_all(parse_text("search()"), split = FALSE))
## Not run: 
writeLines(capture_all(parse_text('1:2 + 1:3'), split = FALSE))
writeLines(capture_all(parse_text("badname"), split = FALSE))

## End(Not run)

# Management of incomplete lines
capt_res &lt;- capture_all(parse_text("1 +")) # Clearly an incomplete command
if (is.na(capt_res)) cat("Incomplete line!\n") else writeLines(capt_res)
rm(capt_res)
</code></pre>


</div>