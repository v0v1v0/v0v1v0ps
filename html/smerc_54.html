<div class="container">

<table style="width: 100%;"><tr>
<td>mlink.zones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine zones for the Maximum Linkage scan test</h2>

<h3>Description</h3>

<p><code>mlink.zones</code> determines the zones for the Maximum
Linkage scan test (<code>mlink.test</code>).  The
function returns the zones, as well as the associated
test statistic, cases in each zone, the expected number
of cases in each zone, and the population in each zone.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlink.zones(
  coords,
  cases,
  pop,
  w,
  ex = sum(cases)/sum(pop) * pop,
  ubpop = 0.5,
  ubd = 1,
  longlat = FALSE,
  cl = NULL,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>An <code class="reqn">n \times 2</code> matrix of centroid
coordinates for the regions in the form (x, y) or
(longitude, latitude) is using great circle distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A binary spatial adjacency matrix for the
regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubpop</code></td>
<td>
<p>The upperbound of the proportion of the
total population to consider for a cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubd</code></td>
<td>
<p>A proportion in (0, 1].  The distance of
potential clusters must be no more than <code>ubd * m</code>,
where <code>m</code> is the maximum intercentroid distance
between all coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>The default is <code>FALSE</code>, which
specifies that Euclidean distance should be used. If
<code>longlat</code> is <code>TRUE</code>, then the great circle
distance is used to calculate the intercentroid
distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>A logical value indicating whether a
progress bar should be displayed.  The default is
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every zone considered must have a total population less
than <code>ubpop * sum(pop)</code>.  Additionally, the maximum
intercentroid distance for the regions within a zone must
be no more than <code>ubd * the maximum intercentroid
distance across all regions</code>.
</p>


<h3>Value</h3>

<p>Returns a list with elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>zones</code></td>
<td>
<p>A list
contained the location ids of each potential cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikrat</code></td>
<td>
<p>The loglikelihood ratio for each zone
(i.e., the log of the test statistic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The observed number of cases in each
zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>The expected number of cases
each zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The total population in each
zone.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Costa, M.A. and Assuncao, R.M. and Kulldorff, M. (2012)
Constrained spanning tree algorithms for
irregularly-shaped spatial clustering, Computational
Statistics &amp; Data Analysis, 56(6), 1771-1783.
&lt;doi:10.1016/j.csda.2011.11.001&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
data(nyw)
coords &lt;- as.matrix(nydf[, c("longitude", "latitude")])
# find zone with max statistic starting from each individual region
all_zones &lt;- mlink.zones(coords,
  cases = floor(nydf$cases),
  nydf$pop, w = nyw, ubpop = 0.25,
  ubd = .25, longlat = TRUE
)
</code></pre>


</div>