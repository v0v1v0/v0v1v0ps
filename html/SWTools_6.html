<div class="container">

<table style="width: 100%;"><tr>
<td>SILOCheckConsistency</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check for homogeneity between SILO rainfall station data</h2>

<h3>Description</h3>

<p>Compute tests on rainfall double mass curves and cumulative deviation in annual rainfall totals to test for consistency between a rainfall station and the average of another group of stations.
Non-homogeneity can occur for a number of reasons, such as interception from vegetation or buildings over time, moving of a station location, or due to interpolation of missing data or station closure
</p>


<h3>Usage</h3>

<pre><code class="language-R">SILOCheckConsistency(X, folder = NA, pvallim = 0.05, changelim = 0.025)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list of SILO station data, in the format created by <code>SILOLoad</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folder</code></td>
<td>
<p>Path to folder to save resulting images to. Will be created if it doesn't exist</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvallim</code></td>
<td>
<p>p value limit of the break point detection to display the double mass break point. Defaults to p=0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changelim</code></td>
<td>
<p>significant slope limit display the double mass break point. Defaults to a slope change of 0.025</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two tests are calculated by <code>SILOCheckConsistency</code>, which are outlined in <a href="https://www.fao.org/4/x0490e/x0490e0l.htm#annex%204.%20statistical%20analysis%20of%20weather%20data%20sets%201">Annex 4</a> of Allen et al. (1998).
</p>
<p>The first considers the residual errors in annual rainfall at a station, compared to the straight line (intercept=0) regression with the average annual rainfall from the other sites in <code>X</code>.
The residuals should follow a normal distribution with mean zero and standard deviation s_y,x. The annual rainfall data is plotted to visually assess the homoscedasticity requirement (constant variance).
Ellipses for 80\
</p>
<p>The second test tests for a break point in the plot of cumulative annual rainfall, commonly referred to as a double-mass analysis.
This analysis is outlined in Allen et al. (1998) and also Chang and Lee (1974). A bootstraped estimate of any breakpoint in the double-mass plot, indicating a change in the relationship between rainfall at the station and the average of all other stations,
is assessed using the method of Muggeo (2003), as provided in segmented.
</p>


<h3>Value</h3>

<p>If folder is not specified (or <code>NA</code>) the plots are shown in the R environment. If folder is specified, a figure for each station in <code>X</code> is saved to <code>folder</code>. There are 4 panels on the figure:
</p>

<ul>
<li>
<p> Annual rainfall for a given station, against the average across all stations in X (except the station presented).
</p>
</li>
<li>
<p> Cumulative residuals of the annual rainfall from the straight line regression shown in the first panel. Assuming the residuals are are independent random variables, this figure include ellipses representing 80th and 95th percentile that the hypothesis that there is no change in slope can be rejected.
</p>
</li>
<li>
<p> double mass curve, plotting the cumulative annual rainfall for the station against the station average. If a breakpoint is identified, this is displayed on the plot.The colours represent the median quality code for each year, with the same colour palette as <code>SILOQualityCodes</code>
</p>
</li>
<li>
<p> Residuals of the cumulative rainfall from the straight line fitted to the double mass curve.
</p>
</li>
</ul>
<h3>References</h3>

<p>Chang, M., and Lee, R. (1974) Objective double-mass analysis, Water Resour. Res., 10( 6), 1123-1126, doi:10.1029/WR010i006p01123.
</p>
<p>Allan, R., Pereira, L. and Smith, M. (1998) Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56.
</p>
<p>Muggeo, V.M.R. (2003) Estimating regression models with unknown break-points. Statistics in Medicine 22, 3055-3071.
</p>


<h3>See Also</h3>

<p>SILOLoad, SILOSiteSummary, SILOQualityCodes,SILOCorrectSite
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
X&lt;-SILOLoad(c("24001","24002","24003"),path="./SWTools/extdata")
SILOCheckConsistency(X,tempdir())

## End(Not run)
</code></pre>


</div>