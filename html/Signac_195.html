<div class="container">

<table style="width: 100%;"><tr>
<td>LinkPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Link peaks to genes</h2>

<h3>Description</h3>

<p>Find peaks that are correlated with the expression of nearby genes.
For each gene, this function computes the correlation coefficient between
the gene expression and accessibility of each peak within a given distance
from the gene TSS, and computes an expected correlation coefficient for each
peak given the GC content, accessibility, and length of the peak. The expected
coefficient values for the peak are then used to compute a z-score and p-value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LinkPeaks(
  object,
  peak.assay,
  expression.assay,
  peak.slot = "counts",
  expression.slot = "data",
  method = "pearson",
  gene.coords = NULL,
  distance = 5e+05,
  min.distance = NULL,
  min.cells = 10,
  genes.use = NULL,
  n_sample = 200,
  pvalue_cutoff = 0.05,
  score_cutoff = 0.05,
  gene.id = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak.assay</code></td>
<td>
<p>Name of assay containing peak information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression.assay</code></td>
<td>
<p>Name of assay containing gene expression information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak.slot</code></td>
<td>
<p>Name of slot to pull chromatin data from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression.slot</code></td>
<td>
<p>Name of slot to pull expression data from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Correlation method to use. One of "pearson" or "spearman"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.coords</code></td>
<td>
<p>GRanges object containing coordinates of genes in the
expression assay. If NULL, extract from gene annotations stored in the assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>Distance threshold for peaks to include in regression model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.distance</code></td>
<td>
<p>Minimum distance between peak and TSS to include in
regression model. If NULL (default), no minimum distance is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cells</code></td>
<td>
<p>Minimum number of cells positive for the peak and gene
needed to include in the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes.use</code></td>
<td>
<p>Genes to test. If NULL, determine from expression assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sample</code></td>
<td>
<p>Number of peaks to sample at random when computing the null
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_cutoff</code></td>
<td>
<p>Minimum p-value required to retain a link. Links with a
p-value equal or greater than this value will be removed from the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score_cutoff</code></td>
<td>
<p>Minimum absolute value correlation coefficient for a link
to be retained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.id</code></td>
<td>
<p>Set to TRUE if genes in the expression assay are named
using gene IDs rather than gene names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display messages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function was inspired by the method originally described by SHARE-seq
(Sai Ma et al. 2020, Cell). Please consider citing the original SHARE-seq
work if using this function: <a href="https://doi.org/10.1016/j.cell.2020.09.056">doi:10.1016/j.cell.2020.09.056</a>
</p>


<h3>Value</h3>

<p>Returns a Seurat object with the <code>Links</code> information set. This is
a <code>granges</code> object accessible via the <code>Links</code>
function, with the following information:
</p>

<ul>
<li>
<p>score: the correlation coefficient between the accessibility of the
peak and expression of the gene
</p>
</li>
<li>
<p>zscore: the z-score of the correlation coefficient, computed based on
the distribution of correlation coefficients from a set of background peaks
</p>
</li>
<li>
<p>pvalue: the p-value associated with the z-score for the link
</p>
</li>
<li>
<p>gene: name of the linked gene
</p>
</li>
<li>
<p>peak: name of the linked peak
</p>
</li>
</ul>
</div>