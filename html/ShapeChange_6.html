<div class="container">

<table style="width: 100%;"><tr>
<td>tp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Specify a Unimodal Category in a CHANGEPT Formula</h2>

<h3>Description</h3>

<p>A symbolic routine to define that the underlying mean curve is unimodal, i.e., it has a turn-around point, in the formula argument to changept.</p>


<h3>Usage</h3>

<pre><code class="language-R">tp(x, sh = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sh</code></td>
<td>
<p>If sh is <code class="reqn">1</code>, then the estimated curve is increasing-decreasing; if sh is <code class="reqn">-1</code>,  it is decreasing-increasing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p> "tp" returns the vector "x" with three attributes, i.e., nm: the name of x; categ: the category of the change-point, "mode"; sh: the shape constraint on the estimated curve: <code class="reqn">1</code> (increasing-decreasing) or <code class="reqn">-1</code> (decreasing-increasing).
</p>
<p>The nm and categ attributes are used in the plot routine; the sh attribute is used to set up a shape-constrained regression. 
</p>


<h3>Author(s)</h3>

<p>Xiyue Liao</p>


<h3>See Also</h3>

<p><code>ip</code>, <code>jp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  # the underlying mean curve is unimodal with a mode at .8 
  n = 100
  x = seq(1/n, 1, length = n)

  # a categorical covariate z with two levels (0 and 1) 
  z = rep(0:1, 50)

  set.seed(123)
  y = 30 * x^4 * (1 - x) + (z == 1) * .5 + rnorm(n, sd = 1)
  ans = changept(y ~ tp(x) + factor(z), family = gaussian())

  plot(ans)
  legend("topleft", "constrained fit for z == 1", bty = "n", col = "skyblue", lty = 2, lwd = 2)
</code></pre>


</div>