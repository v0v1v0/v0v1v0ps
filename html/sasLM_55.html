<div class="container">

<table style="width: 100%;"><tr>
<td>G2SWEEP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized inverse matrix of type 2 for linear regression</h2>

<h3>Description</h3>

<p>Generalized inverse is usually not unique. Some programs use this algorithm to get a unique generalized inverse matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  G2SWEEP(A, Augmented=FALSE, eps=1e-08) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a matrix to be inverted. If <code>A</code> is not a square matrix, G2SWEEP calls g2inv function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Augmented</code></td>
<td>
<p>If this is <code>TRUE</code> and <code>A</code> is a model(design) matrix X, the last column should be X'y, the last row y'X, and the last cell y'y. See the reference and example for the detail. If the input matrix <code>A</code> is not a square matrix, <code>Augmented</code> option cannot be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Less than this value is considered as zero.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generalized inverse of g2-type is used by some softwares to do linear regression. See 'SAS Technical Report R106, The Sweep Operator: Its importance in Statistical Computing' by J. H. Goodnight for the detail.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>when Augmented=FALSE</code></td>
<td>
<p>ordinary g2 inverse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>when Augmented=TRUE</code></td>
<td>
<p>g2 inverse and beta hats in the last column and the last row, and sum of square error (SSE) in the last cell</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attribute "rank"</code></td>
<td>
<p>the rank of input matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kyun-Seop Bae k@acr.kr</p>


<h3>See Also</h3>

<p><code>lfit</code>, <code>ModelMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  f1 = uptake ~ Type + Treatment # formula
  x = ModelMatrix(f1, CO2)  # Model matrix and relevant information
  y = model.frame(f1, CO2)[, 1] # observation vector
  nc = ncol(x$X) # number of columns of model matrix
  XpY = crossprod(x$X, y)
  aXpX = rbind(cbind(crossprod(x$X), XpY), cbind(t(XpY), crossprod(y)))
  ag2 = G2SWEEP(aXpX, Augmented=TRUE)
  b = ag2[1:nc, (nc + 1)] ; b # Beta hat
  iXpX = ag2[1:nc, 1:nc] ; iXpX # g2 inverse of X'X
  SSE = ag2[(nc + 1), (nc + 1)] ; SSE # Sum of Square Error
  DFr = nrow(x$X) - attr(ag2, "rank") ; DFr # Degree of freedom for the residual

# Compare the below with the above
  REG(f1, CO2)
  aov1(f1, CO2)
</code></pre>


</div>