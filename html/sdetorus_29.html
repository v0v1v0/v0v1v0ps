<div class="container">

<table style="width: 100%;"><tr>
<td>dTpdPde2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transition probability density in 2D by PDE solving</h2>

<h3>Description</h3>

<p>Computation of the transition probability density (tpd) of the
Wrapped Normal (WN) or Multivariate von Mises (MvM) diffusion, by solving
its associated Fokker–Planck Partial Differential Equation (PDE) in 2D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dTpdPde2D(Mx = 50, My = 50, x0, t, alpha, mu, sigma, rho = 0,
  type = "WN", Mt = ceiling(100 * t), sdInitial = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mx, My</code></td>
<td>
<p>sizes of the equispaced spatial grids in <code class="reqn">[-\pi,\pi)</code> for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>point giving the mean of the initial circular density, an
isotropic WN with standard deviations equal to <code>sdInitial</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>time separating <code>x0</code> and the evaluation of the tpd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>for <code>"WN"</code>, a vector of length <code>3</code> parametrizing
the <code>A</code> matrix as in <code>alphaToA</code>. For <code>"vM"</code>, a vector
of length <code>3</code> containing <code>c(alpha[1:2], A[1, 2])</code>, from the
arguments <code>alpha</code> and <code>A</code> in <code>driftMvm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of length <code>2</code> giving the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>for <code>"WN"</code>, a vector of length <code>2</code> containing the
<strong>square root</strong> of the diagonal of the diffusion matrix. For
<code>"vM"</code>, the standard deviation giving the isotropic diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>for <code>"WN"</code>, the correlation of the diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>"WN"</code> or <code>"vM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mt</code></td>
<td>
<p>size of the time grid in <code class="reqn">[0, t]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdInitial</code></td>
<td>
<p>standard deviations of the concentrated WN giving the
initial condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to <code>crankNicolson2D</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A combination of small <code>sdInitial</code> and coarse space-time
discretization (small <code>Mx</code> and <code>Mt</code>) is prone to create numerical
instabilities. See Sections 3.4.2, 2.2.1 and 2.2.2 in García-Portugués et al.
(2019) for details.
</p>


<h3>Value</h3>

<p>A matrix of size <code>c(Mx, My)</code> with the tpd evaluated at the
combinations of <code>seq(-pi, pi, l = Mx + 1)[-(Mx + 1)]</code> and
<code>seq(-pi, pi, l = My + 1)[-(My + 1)]</code>.
</p>


<h3>References</h3>

<p>García-Portugués, E., Sørensen, M., Mardia, K. V. and Hamelryck, T. (2019)
Langevin diffusions on the torus: estimation and applications.
<em>Statistics and Computing</em>, 29(2):1–22. <a href="https://doi.org/10.1007/s11222-017-9790-2">doi:10.1007/s11222-017-9790-2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- 100
x &lt;- seq(-pi, pi, l = M + 1)[-c(M + 1)]
image(x, x, dTpdPde2D(Mx = M, My = M, x0 = c(0, pi), t = 1,
                      alpha = c(1, 1, 0.5), mu = c(pi / 2, 0), sigma = 1:2),
      zlim = c(0, 0.25), col = matlab.like.colorRamps(20),
      xlab = "x", ylab = "y")
</code></pre>


</div>