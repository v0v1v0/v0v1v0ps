<div class="container">

<table style="width: 100%;"><tr>
<td>elliptical.ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Autoregressive and Moving Average Symmetric Models</h2>

<h3>Description</h3>

<p>Fit an SYMARMA model to a univariate time series. Fitting method: conditional maximum likelihood estimation.</p>


<h3>Usage</h3>

<pre><code class="language-R">elliptical.ts(Y, family="Normal", order=c(0,0,0), xreg=NULL, 
include.mean=TRUE, epsilon=0.0001, maxit=100, trace="TRUE",
index1=NULL, index2=NULL, fixed=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a univariate time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the conditional distribution of each <em>Y[t]</em>, given the set of past information. Symmetric distributions available for adjustment: Normal (<em>Normal</em>), Student-<em>t</em> (<em>Student</em>), Generalized Student-<em>t</em> (<em>Gstudent</em>), Exponential Power (<em>ExpPower</em>) (by Box &amp; Tiao, 1973, ch 3), Logistic I (<em>LogisticI</em>), Logistic II (<em>LogisticII</em>), Generalized Logistic (<em>Glogistic</em>), Cauchy (<em>Cauchy</em>) and Contamined Normal (<em>Cnormal</em>). The default is to normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>a specification of the SYMARMA model: the three integer components (p, d, q) are the AR order, the degree of differencing, and the MA order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>optionally, a vector or matrix of external regressors, which must have the same number of rows as <em>Y</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.mean</code></td>
<td>
<p>should the SYMARMA model include a mean/intercept term? The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>positive convergence tolerance <em>e</em>; the iterations converge when |fit - fit_old|/|fit| &lt; <em>e</em>. Default is <em>e=1e-04</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>integer giving the maximal number of iterations. Default is 100 iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>a logical indicating if output should be produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index1</code></td>
<td>
<p>The parameter to Student-<em>t</em> and Exponential Power distributions or the first argument to Generalized Student-<em>t</em>, Generalized Logistic and Contamined Normal distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index2</code></td>
<td>
<p>The second argument to Generalized Student-<em>t</em>, Generalized Logistic (<em>index2 = index2(index1)</em>) and Contamined Normal distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a optional numeric vector of the same length as the total number of parameters. If supplied, only NA entries in fixed will be varied.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Different definitions of autoregressive and moving average models have different signs for the AR and/or MA coefficients.
The dynamic component in SYMARMA model used here has
</p>
<p><code class="reqn">Y[t] =  X[t]Beta + phi[1](Y[t-1] - X[t-1]Beta) + ... + phi[np](Y[t-np] - X[t-np]Beta) + theta[1]erro[t-1] + ... + theta[nq]erro[t-nq] + erro[t].</code>
</p>
<p>The estimation of the parameters that index the SYMARMA model is obtained by maximum conditional likelihood method on the first <em>m</em> observations, where <em>m</em> = max(np,nq). 
</p>
<p>The variance matrix of the estimates is found from the Hessian of the log-likelihood, and so may only be a rough guide.
</p>


<h3>Value</h3>

<p>A list of class “Symarma” with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector of estimated AR, MA and regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>the estimated dispersion parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.raw</code></td>
<td>
<p>the ordinary residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.stand</code></td>
<td>
<p>the standardized residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the maximized log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the AIC value corresponding to the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the BIC value corresponding to the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse</code></td>
<td>
<p>the Root Mean Squared Error value corresponding to the ajusted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations used in the fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations in the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.coef</code></td>
<td>
<p>a vector of estimated standard deviation of the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.disp</code></td>
<td>
<p>estimated standard deviation of the dispersion parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>if requested, the vector or matrix of external regressors.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vinicius Quintas Souto Maior and Francisco Jose A. Cysneiros
</p>
<p>Maintainer: Vinicius Quintas Souto Maior &lt;vinicius@de.ufpe.br&gt;
</p>


<h3>References</h3>

<p>Maior, V. Q. S. and Cysneiros, F. J. A. (2018). SYMARMA: a new dynamic model for temporal data on conditional symmetric distribution. <em>Statitical Paper</em>, <strong>59</strong>, 75-97. doi: <a href="https://doi.org/10.1007/s00362-016-0753-z">10.1007/s00362-016-0753-z</a>.
</p>
<p>Wei, W. W. S. (2006). <em>Time Series Analysis: Univariate and Multivariate Methods</em>, 2nd edition. Pearson Addison Wesley. Section 7.2.1.
</p>
<p>Box, M. J. and Tiao, G. C. (1973). <em>Bayesian inference in statistical analysis</em>. Londen: Addison-Wesley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(assets)
attach(assets)

# Return in the prices on Microsoft and SP500 index

N = length(msf)
.sp500 = ((sp500[2:N]-sp500[1:(N-1)])/sp500[1:(N-1)])*100
.msf = ((msf[2:N]-msf[1:(N-1)])/msf[1:(N-1)])*100

# The T-bill rates were divided by 253 to convert to a daily rate

.tbill = tbill/253

# Excess return in the prices on Microsoft and SP500 index

Y = .msf - .tbill[1:(N-1)]
X = .sp500 - .tbill[1:(N-1)]

# Period from April 4, 2002 to October 4, 2002

serie = Y[2122:2240]
aux = cbind(X[2122:2240])

# Returns best ARIMA model according to either AIC value.
# auto.arima(Y,xreg=aux,seasonal=FALSE,ic=c("aic"))

# Fit SYMARMA models

fit.1 = elliptical.ts(serie,order=c(0,0,1),xreg=aux,include.mean=FALSE,
 family="Normal")
fit.2 = elliptical.ts(serie,order=c(0,0,1),xreg=aux,include.mean=FALSE,
 family="Student", index1=4)
fit.3 = elliptical.ts(serie,order=c(3,0,1),xreg=aux,family="ExpPower",
 index1=0, fixed=c(0,0,NA,NA,NA,NA))
</code></pre>


</div>