<div class="container">

<table style="width: 100%;"><tr>
<td>VEpowerPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unconditional Power to Detect Positive Treatment Efficacy in a Per-Protocol Cohort</h2>

<h3>Description</h3>

<p><code>VEpowerPP</code> computes unconditional power to detect positive treatment (vaccine) efficacy in per-protocol cohorts identified in <code>simTrial</code>-generated data-sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VEpowerPP(dataList, lowerVEuncPower, alphaUncPower, VEcutoffWeek, stage1,
  outName = NULL, saveDir = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataList</code></td>
<td>
<p>if <code>saveDir = NULL</code>, a list of objects (lists) returned by <code>censTrial</code>; otherwise a list of <code>.RData</code> file names (character strings) generated by <code>censTrial</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerVEuncPower</code></td>
<td>
<p>a numeric value specifying a one-sided null hypothesis H0: VE(<code>VEcutoffWeek</code>–<code>stage1</code>) <code class="reqn">\le</code> <code>lowerVEuncPower</code> x 100%. Unconditional power (i.e., accounting for sequential monitoring) to reject H0 in the per-protocol cohort is calculated, where the rejection region is defined by the lower bound of the two-sided (1-<code>alphaUncPower</code>) x 100% confidence interval for VE(<code>VEcutoffWeek</code>–<code>stage1</code>) being above <code>lowerVEuncPower</code> (typically a number in the 0–0.5 range).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaUncPower</code></td>
<td>
<p>one minus the nominal confidence level of the two-sided confidence interval used to test the one-sided null hypothesis H0: VE(<code>VEcutoffWeek</code>–<code>stage1</code>) <code class="reqn">\le</code> <code>lowerVEuncPower</code> x 100% against the alternative hypothesis H1: VE(<code>VEcutoffWeek</code>–<code>stage1</code>) <code class="reqn">&gt;</code> <code>lowerVEuncPower</code> x 100%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VEcutoffWeek</code></td>
<td>
<p>a cut-off time (in weeks). Only subjects with the follow-up time exceeding <code>VEcutoffWeek</code> are included in the per-protocol cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>the final week of stage 1 in a two-stage trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outName</code></td>
<td>
<p>a character string specifying the output <code>.RData</code> file name. If <code>outName = NULL</code> but <code>saveDir</code> is specified, the output file is named <code>VEpwPP.RData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveDir</code></td>
<td>
<p>a character string specifying a path for the output directory. If supplied, the output is saved as an <code>.RData</code> file named <code>outName</code> in the directory; otherwise the output is returned as a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value indicating whether information on the output directory and file name should be printed out (default is <code>TRUE</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All time variables use week as the unit of time. Month is defined as 52/12 weeks.
</p>
<p>A per-protocol cohort indicator is assumed to be included in the <code>simTrial</code>-generated data-sets, which is ensured by specifying the <code>missVaccProb</code> argument in <code>simTrial</code>.
</p>
<p>VE(<code>VEcutoffWeek</code>–<code>stage1</code>) is estimated as one minus the ratio of Nelson-Aalen-based cumulative incidence functions. <code>VEpowerPP</code> computes power to reject the null hypothesis H0: VE(<code>VEcutoffWeek</code>–<code>stage1</code>) <code class="reqn">\le</code> <code>lowerVEuncPower</code> x 100%. H0 is rejected if the lower bound of the two-sided (1-<code>alphaUncPower</code>) x 100% confidence interval for VE(<code>VEcutoffWeek</code>–<code>stage1</code>) lies above <code>lowerVEuncPower</code>.
</p>


<h3>Value</h3>

<p>If <code>saveDir</code> is specified, the output list (named <code>pwList</code>) is saved as an <code>.RData</code> file named <code>outName</code> (or <code>VEpwPP.RData</code> if left unspecified); otherwise the output list is returned. The output object is a list (of equal length as <code>dataList</code>) of lists with the following components:
</p>

<ul>
<li> <p><code>VE</code>: a numeric vector of VE(<code>VEcutoffWeek</code>–<code>stage1</code>) estimates for each missing vaccination probability in <code>missVaccProb</code> of <code>simTrial</code>
</p>
</li>
<li> <p><code>VEpwPP</code>: a numeric vector of powers to reject the null hypothesis H0: VE(<code>VEcutoffWeek</code>–<code>stage1</code>) <code class="reqn">\le</code> <code>lowerVEuncPower</code> x 100% for each missing vaccination probability in <code>missVaccProb</code> of <code>simTrial</code>
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>simTrial</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">simData &lt;- simTrial(N=rep(1000, 2), aveVE=c(0, 0.4), VEmodel="half", 
                    vePeriods=c(1, 27, 79), enrollPeriod=78, 
                    enrollPartial=13, enrollPartialRelRate=0.5, dropoutRate=0.05, 
                    infecRate=0.04, fuTime=156, 
                    visitSchedule=c(0, (13/3)*(1:4), seq(13*6/3, 156, by=13*2/3)),
                    missVaccProb=c(0,0.05,0.1,0.15), VEcutoffWeek=26, nTrials=5, 
                    stage1=78, randomSeed=300)

monitorData &lt;- monitorTrial(dataFile=simData, stage1=78, stage2=156, 
                            harmMonitorRange=c(10,100), alphaPerTest=NULL, 
                            nonEffStartMethod="FKG", nonEffInterval=20, 
                            lowerVEnoneff=0, upperVEnoneff=0.4, 
                            highVE=0.7, stage1VE=0, lowerVEuncPower=0, 
                            alphaNoneff=0.05, alphaHigh=0.05, alphaStage1=0.05, 
                            alphaUncPower=0.05, estimand="cuminc", lagTime=26)

censData &lt;- censTrial(dataFile=simData, monitorFile=monitorData, stage1=78, stage2=156)

VEpwPP &lt;- VEpowerPP(dataList=list(censData), lowerVEuncPower=0, alphaUncPower=0.05,
                    VEcutoffWeek=26, stage1=78)

### alternatively, to save the .RData output file (no '&lt;-' needed):
###
### simTrial(N=rep(1000, 2), aveVE=c(0, 0.4), VEmodel="half", 
###          vePeriods=c(1, 27, 79), enrollPeriod=78, enrollPartial=13, 
###          enrollPartialRelRate=0.5, dropoutRate=0.05, infecRate=0.04, fuTime=156, 
###          visitSchedule=c(0, (13/3)*(1:4), seq(13*6/3, 156, by=13*2/3)), 
###          missVaccProb=c(0,0.05,0.1,0.15), VEcutoffWeek=26, nTrials=5, 
###          stage1=78, saveDir="./", randomSeed=300)
###
### monitorTrial(dataFile=
###          "simTrial_nPlac=1000_nVacc=1000_aveVE=0.4_infRate=0.04.RData", 
###          stage1=78, stage2=156, harmMonitorRange=c(10,100), alphaPerTest=NULL, 
###          nonEffStartMethod="FKG", nonEffInterval=20, 
###          lowerVEnoneff=0, upperVEnoneff=0.4, highVE=0.7, stage1VE=0, 
###          lowerVEuncPower=0, alphaNoneff=0.05, alphaHigh=0.05, alphaStage1=0.05, 
###          alphaUncPower=0.05, estimand="cuminc", lagTime=26, saveDir="./")
###
### censTrial(dataFile=
###  "simTrial_nPlac=1000_nVacc=1000_aveVE=0.4_infRate=0.04.RData",
###  monitorFile=
###  "monitorTrial_nPlac=1000_nVacc=1000_aveVE=0.4_infRate=0.04_cuminc.RData",
###  stage1=78, stage2=156, saveDir="./")
###
### VEpowerPP(dataList=
###  list("trialDataCens_nPlac=1000_nVacc=1000_aveVE=0.4_infRate=0.04_cuminc.RData"),
###  lowerVEuncPower=0, alphaUncPower=0.05, VEcutoffWeek=26, stage1=78, saveDir="./")

</code></pre>


</div>