<div class="container">

<table style="width: 100%;"><tr>
<td>HFWM_pred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction Function for Hierarchical Finlay-Wilkinson Model</h2>

<h3>Description</h3>

<p>This function ignores spatial effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HFWM_pred(Y, VAR, ENV, VAR2, ENV2, save_int = FALSE, kin_info = FALSE,
  A = NULL, inits = NULL, hyper_para = NULL, M_iter = 5000,
  burn_in = 3000, thin = 5, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A length-N1 numerical response vector from training set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR</code></td>
<td>
<p>A length-N1 factor/character vector indicating the genotype information of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENV</code></td>
<td>
<p>A length-N1 factor/character vector indicating the field information of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR2</code></td>
<td>
<p>A length-N2 factor/character vector indicating the genotype information of testing set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENV2</code></td>
<td>
<p>A length-N2 factor/character vector indicating the field information of of testing set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_int</code></td>
<td>
<p>A logical parameter controling whether to save prediction credible intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kin_info</code></td>
<td>
<p>A logical parameter controling if to use kinship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>kinship matrix, give value only if kin_info = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>initial values, default is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper_para</code></td>
<td>
<p>hyper-parameter values, default is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_iter</code></td>
<td>
<p>Total iteration number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>Burn in number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed value</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Mean prediction values and/or prediction intervals
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(spFW)

# load and split data
data(spFW_example_data)
idx_pred &lt;- sample(125, 25)

Y0 &lt;- spFW_example_data$yield
VAR0 &lt;- spFW_example_data$geno
ENV0 &lt;- spFW_example_data$loc


Y1 &lt;- Y0[-idx_pred]
Y2 &lt;- Y0[idx_pred]
VAR1 &lt;- VAR0[-idx_pred]
VAR2 &lt;- VAR0[idx_pred]
ENV1 &lt;- ENV0[-idx_pred]
ENV2 &lt;- ENV0[idx_pred]
order_y &lt;- order(Y2)

# run model
pred0 &lt;- HFWM_pred(Y1, VAR1, ENV1, VAR2, ENV2, save_int = TRUE,
                   M_iter = 1000, burn_in = 500, thin = 5)

# visualize prediction results
plot(1:25, pred0$PY[order_y], ylim = c(50, 250), pch = 15, col = "red",
     xlab = "Plant ID for Prediction", ylab = "Yield",
     main = "95% Prediction Intervals with Predicted Mean (Red) Versus True Yield (Blue)")
points(1:25, Y2[order_y], col = "blue")
for (i in 1:25){
  lines(x = c(i,i), y = c(pred0$PY_CI[,order_y][1,i], pred0$PY_CI[,order_y][4,i]))
}



</code></pre>


</div>