<div class="container">

<table style="width: 100%;"><tr>
<td>gofFun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit and Information Criteria</h2>

<h3>Description</h3>

<p>Calculates goodness-of-fit criteria and the likelihood-based Akaike 
and Bayesian Information Criterion based on a given parameter set,
typically from the estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofFun(
  phat,
  shpmodel = "01110",
  retdata = NULL,
  condata = NULL,
  weight,
  psel,
  ivap.query = NULL,
  hclip.query = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phat</code></td>
<td>
<p>Vector of non-transformed (back-transformed) model parameters after estimation, i.e. the best fit or maximum likelihood estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shpmodel</code></td>
<td>
<p>Character specifying the soil hydraulic property model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retdata</code></td>
<td>
<p>Dataframe or matrix with 2 columns. The first with pressure head values in log<sub>10</sub> [cm], i.e. pF values, and the second with volumetric water contents in [cm cm-3].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condata</code></td>
<td>
<p>Dataframe or matrix with 2 columns. The first with pressure head values in log<sub>10</sub> [cm], i.e. pF values, and the second with hydraulic conductivity values log<sub>10</sub> [cm d-1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>List of the model residual weights used or estimated by the parameter estimation scheme, to calculate the weighted statistical analyses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psel</code></td>
<td>
<p>Vector specifying the selected parameters for the parameter estimation from <code>parL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ivap.query</code></td>
<td>
<p>Specification of <em>ivap</em> method, if FALSE selected, no isothermal vapour conductivity is consideredSee <code>Details</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclip.query</code></td>
<td>
<p>Implemented purely for future compatability. Currently no use. See <code>Details</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Output for data groups.
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>th</code>
</td>
<td style="text-align: left;">      <code>list</code> with goodness of fit statistics for the retention curve <em>see below</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>logKh</code>
</td>
<td style="text-align: left;">   <code>list</code>with output same as <code>th</code> but for the log<sub>10</sub> fitted conductivity curve</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>combined</code>
</td>
<td style="text-align: left;">
<code>list</code> with <code>AIC</code>, <code>AICc</code>, and <code>BIC</code> calculated for the multi-objective function if arguments <code>retdata</code> and <code>condata</code> are both <code>!NULL</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<p>Statistical analyses of the inverse modelling results.
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>me</code>
</td>
<td style="text-align: left;">mean (weighted) error</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mae</code>
</td>
<td style="text-align: left;">mean absolute (weighted) error</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mse</code>
</td>
<td style="text-align: left;">mean squared (weighted) error</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>rss</code>
</td>
<td style="text-align: left;">sum of squared (weighted) errors</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>rmse</code>
</td>
<td style="text-align: left;">root mean squared (weighted) error</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>AIC</code>
</td>
<td style="text-align: left;">Akaike Information Criteria</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>AICc</code>
</td>
<td style="text-align: left;">corrected Akaike Information Criteria</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>BIC</code>
</td>
<td style="text-align: left;">Bayesian Information Criteria</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>m</code>
</td>
<td style="text-align: left;">number of observations</td>
</tr>
<tr>
<td style="text-align: left;">
            </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>HÃƒÂ¶ge M, WÃƒÂ¶hling T, Nowak W (2018).
“A Primer for Model Selection: The Decisive Role of Model Complexity.”
<em>Water Resources Research</em>, <b>54</b>(3), 1688–1715.
doi: <a href="https://doi.org/10.1002/2017WR021902">10.1002/2017WR021902</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("shpdata1")
retdata &lt;- shpdata1$TS1$wrc
condata &lt;- shpdata1$TS1$hcc
condata &lt;- condata[!is.na(condata[,1]),]
# Parameter list
parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
             "psel" = c(1, 1, 0, 1, 1, 1),
             "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
             "pup" = c(0.3, 0.95, 1, 10, 1e4, 10)
             )
# Calulation of the goodness of fit.
gofL &lt;-gofFun(parL$p, shpmodel = "01110", retdata = retdata, condata = condata, 
              weight = weightFun(weightmethod = "fix1"), parL$psel, 
              ivap.query = NULL, hclip.query = FALSE)
</code></pre>


</div>