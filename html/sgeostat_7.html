<div class="container">

<table style="width: 100%;"><tr>
<td>fit.variogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variogram Model Fit</h2>

<h3>Description</h3>

<p>Fit variogram models (exponential, spherical, gaussian, linear) to empirical variogram estimates. 
</p>
<p>An object of class variogram.model represents a fitted variogram model generated by fitting a function to a variogram object. A
variogram.model object is composed of a list consisting of a vector of parameters, <code>parameters</code>, and a semi-variogram model
function, <code>model</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.variogram(model="exponential", v.object, nugget, sill,
              range, slope, ...)
fit.exponential(v.object, c0, ce, ae, type='c', 
                iterations=10, tolerance=1e-06, echo=FALSE, plot.it=FALSE, weighted=TRUE)
fit.gaussian(v.object, c0, cg, ag, type='c', 
             iterations=10, tolerance=1e-06, echo=FALSE,  plot.it=FALSE, weighted=TRUE)
fit.spherical(v.object, c0, cs, as, type='c', iterations=10,
             tolerance=1e-06, echo=FALSE,  plot.it=FALSE, weighted=TRUE,
             delta=0.1, verbose=TRUE)
fit.wave(v.object, c0, cw, aw, type='c', 
         iterations=10, tolerance=1e-06, echo=FALSE,  plot.it=FALSE, weighted=TRUE)
fit.linear(v.object, type='c', plot.it=FALSE,iterations=1, c0=0, cl=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>only available for <code>fit.variogram</code>, switches what kind
of model should be fitted (<code>"exponential", "wave", "gaussian",
  "spherical", "linear"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.object</code></td>
<td>
<p>a variogram object generated by <code>est.variogram()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget, sill, range, slope</code></td>
<td>
<p>only available for <code>fit.variogram</code>,
initial estimates for specified variogram model (<code>slope</code> only for
<code>fit.linear</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p>initial estimate for nugget effect, valid for all variogram
types, partial sill (<code>cX</code>) and (asymptotical) range (<code>aX</code>)
as follows:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ce, ae</code></td>
<td>
<p>initial estimates for the exponential variogram model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cg, ag</code></td>
<td>
<p>initial estimates for the gaussian variogram model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs, as</code></td>
<td>
<p>initial estimates for the sperical variogram model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw, aw</code></td>
<td>
<p>initial estimates for the periodical variogram model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>initial estimates for the linear variogram model (slope)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>one of <code>'c'</code> (classic), <code>'r'</code> (robust), <code>'m'</code> (median). Indicates to which type of empirical variogram estimate the model is
to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of iterations of the fitting procedure to execute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>the tolerance used to determine if model convergence has been achieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>initial stepsize (relative) for pseudo Newton approximation, applies only to <code>fit.spherical</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echo</code></td>
<td>
<p>if TRUE, be verbose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if TRUE, be verbose (show iteration for spherical model fit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>if TRUE, the variogram estimate will be plotted each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>if TRUE, the fit will be done using weighted least squares,
where the weightes are given in Cressie (1991, p. 99)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>only <code>fit.variogram</code>: additional parameters to hand
through to specific model fit functions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A variogram.model object:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>vector of fitted model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>function implementing a valid variogram model</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>fit.exponential</code>, <code>fit.gaussian</code> and <code>fit.wave</code>
use an iterative, Gauss-Newton fitting algorithm to fit to an
exponential or gaussian variogram model to empirical variogram estimates.
<code>fit.spherical</code> uses the same algorithm but with differential
quotients in place of first derivatives. When <code>weighted</code> is
<code>TRUE</code>, the regression is weighted by <code class="reqn">n(h)/gamma(h)^2</code> where
the numerator is the number of pairs of points in a given lag.
</p>
<p>Setting <code>iterations</code> to 0 means no fit procedure is applied. Thus
parameter values from external sources can be plugged into a variogram
model object.
</p>


<h3>References</h3>

<p>http://www.gis.iastate.edu/SGeoStat/homepage.html
</p>


<h3>See Also</h3>

<p><code>est.variogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
#
# automatic fit:
#
maas.vmod&lt;-fit.gaussian(maas.v,c0=60000,cg=110000,ag=800,plot.it=TRUE,
                        iterations=30)
#
# iterations=0, means no fit, intended for "subjective" fit
#
maas.vmod.fixed&lt;-fit.variogram("gaussian",maas.v,nugget=60000,sill=110000,
                               range=800,plot.it=TRUE,iterations=0)
</code></pre>


</div>