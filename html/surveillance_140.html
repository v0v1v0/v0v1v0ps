<div class="container">

<table style="width: 100%;"><tr>
<td>hhh4_formula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Specify Formulae in a Random Effects HHH Model
</h2>

<h3>Description</h3>

<p>The special functions <code>fe</code> and <code>ri</code> are used to specify 
unit-specific effects of covariates and random intercept terms, 
respectively, in the component formulae of <code>hhh4</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fe(x, unitSpecific = FALSE, which = NULL, initial = NULL)

ri(type = c("iid","car"), corr = c("none", "all"),
   initial.fe = 0, initial.var = -.5, initial.re = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an expression like <code>sin(2*pi*t/52)</code> involving the time
variable <code>t</code>, or just <code>1</code> for an intercept.
In general this covariate expression might use any variables
contained in the <code>control$data</code> argument of the parent
<code>hhh4</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitSpecific</code></td>
<td>
<p>logical indicating if the effect of <code>x</code>
should be unit-specific. This is a convenient shortcut for
<code>which = rep(TRUE, nUnits)</code>, where <code>nUnits</code> is the number
of units (i.e., columns of the <code>"sts"</code> object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>vector of logicals indicating which unit(s)
should get an unit-specific parameter.
For units with a <code>FALSE</code>
value, the effect term for <code>x</code> will be zero in the log-linear
predictor. Note especially that setting a <code>FALSE</code> value for the
intercept term of a unit, e.g.,
<code>ar = list(f = ~-1 + fe(1, which=c(TRUE, FALSE)))</code>
in a bivariate <code>hhh4</code> model, does <em>not</em> mean that the
(autoregressive) model component is omitted for this unit, but that
<code class="reqn">\log(\lambda_1) = \alpha_1</code> and <code class="reqn">\log(\lambda_2) = 0</code>, which
is usually not of interest. ATM, omitting an autoregressive effect for
a specific unit is not possible.<br>
If <code>which=NULL</code>, the parameter is assumed to be the same
for all units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>initial values (on internal scale!) 
for the fixed effects used for optimization. The default
(<code>NULL</code>) means to use zeroes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>random intercepts either follow an IID or a CAR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>whether random effects
in different components (such as <code>ar</code> and <code>end</code>)
should be correlated or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.fe</code></td>
<td>
<p>initial value for the random intercept mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.var</code></td>
<td>
<p>initial values (on internal scale!) 
for the variance components used for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.re</code></td>
<td>
<p>initial values (on internal scale!) for the random effects 
used for optimization. The default <code>NULL</code> are random numbers
from a normal distribution with zero mean and variance 0.001.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>These special functions are intended for use in component formulae of
<code>hhh4</code> models and are not exported from the package namespace.
</p>
<p>If unit-specific fixed or random intercepts are specified, an overall
intercept must be excluded (by <code>-1</code>) in the component formula.
</p>


<h3>See Also</h3>

<p><code>addSeason2formula</code>
</p>
<p><code>hhh4</code> model specifications in <code>vignette("hhh4")</code>,
<code>vignette("hhh4_spacetime")</code> or on the help page of
<code>hhh4</code>.
</p>


</div>