<div class="container">

<table style="width: 100%;"><tr>
<td>stcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Space-time covariance function</h2>

<h3>Description</h3>

<p><code>stcov</code> computes the space-time covariance of the serie <code>data</code> between <code>slag1</code>-th and <code>slag2</code>-th order neighbours at time lag <code>tlag</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stcov(data, wlist, slag1, slag2, tlag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a matrix or data frame containing the space-time series: row-wise should be the temporal observations, with each column corresponding to a site. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wlist</code></td>
<td>
<p> a list of the weight matrices for each k-th order neighbours, first one being the identity. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slag1, slag2</code></td>
<td>
<p> the space lags for the space-time covariance. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlag</code></td>
<td>
<p> the time lag for the space-time covariance. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>stcov</code> is mainly used as an internal function for the computation of <code>stacf</code> and <code>stpacf</code>.
<code>slag1</code> and <code>slag2</code> must be lower than <code>length(wlist)</code>.
</p>
<p>It is computed as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}_{lk}(s) = \frac{1}{N(T-s)} Tr \left( \sum_{t=s+1}^{T} W^{(k)\prime} W^{(l)} z_t z_{t-k}^\prime \right)</code>
</p>



<h3>Value</h3>

<p>A numeric.
</p>


<h3>Author(s)</h3>

<p>Felix Cheysson</p>


<h3>References</h3>

<p>Pfeifer, P., &amp; Deutsch, S. (1980). A Three-Stage Iterative Procedure for Space-Time Modeling. Technometrics, 22(1), 35-47. doi:10.1080/00401706.1980.10486099
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nb_mat)	# Get neighbourhood matrices

data &lt;- matrix(rnorm(9400), 100, 94)

# Compute covariance between 2-nd and 1-st order neighbours, at time lag 5
stcov(data, blist, 2, 1, 5)		
</code></pre>


</div>