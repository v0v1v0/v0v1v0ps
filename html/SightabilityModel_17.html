<div class="container">

<table style="width: 100%;"><tr>
<td>Sight.Est.Ratio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sightability Model Estimator - Ratio of variables</h2>

<h3>Description</h3>

<p>Estimates population ratios by 1) fitting a sightability (logistic
regression) model to "test trial" data; 2) applying the fitted model to
independent (operational) survey data to correct for detection rates &lt; 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Sight.Est.Ratio(
  form,
  sdat = NULL,
  odat,
  sampinfo,
  method = "Wong",
  logCI = TRUE,
  alpha = 0.05,
  Vm.boot = FALSE,
  nboot = 1000,
  bet = NULL,
  varbet = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a symbolic description of the sightability model to be fit
(e.g., "y ~ x1 + x2 + ..."), where y is a binary response variable (= 1 if
the animal is seen and 0 otherwise) and x1, x2, ... are a set of predictor
variables thought to influence detection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdat</code></td>
<td>
<p>'sightability' data frame.  Each row represents an independent
sightability trial, and columns contain the response (a binary random
variable = 1 if the animal was observed and 0 otherwise) and the covariates
used to model detection probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odat</code></td>
<td>
<p>'observational survey' data frame containing the following
variable names (<em>stratum, subunit, numerator, denominator</em>) along with
the same covariates used to model detection probabilities (each record
corresponds to an independently sighted group of animals).  <em>stratum</em>
= stratum identifier (will take on a single value for non-stratified
surveys); <em>subunit</em> = numeric plot unit identifier; <em>numerator</em> =
total number of observed animals (for each independently sighted group of
animals for numerator of ratio); <em>denominator</em> = total number of
observed animals (for each independently sighted group of animals for
denominator of ratio).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampinfo</code></td>
<td>
<p>data frame containing sampling information pertaining to the
observational survey.  Must include the following variables (<em>stratum,
nh, Nh</em>).  <em>stratum</em> = stratum identifier (must take on the same values
as <em>stratum</em> variable in observational data set), <em>nh</em> = number of
sampled units in stratum h, <em>Nh</em> = number of population units in
stratum h; note (this dataset will contain a single record for
non-stratified designs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for estimating variance of the abundance estimator.
Should be one of ("Wong", "SS").  See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logCI</code></td>
<td>
<p>Boolean variable, default (= TRUE), indicates the confidence
interval should be constructed under the assumption that (tau^ - T) has a
lognormal distribution, where T is the total number of animals observed
(see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>type I error rate for confidence interval construction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vm.boot</code></td>
<td>
<p>Boolean variable, when = TRUE indicates a bootstrap should be
used to estimate cov(theta[i,j],theta[i',j']), var/cov matrix of the
expansion factors (1/detection prob)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap replicates to use if Vm.boot = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bet</code></td>
<td>
<p>regression parameters (if the sightability model is not to be fit
by Sight.Est).  Make sure the order is consistent with the specification in
the "form" argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varbet</code></td>
<td>
<p>variance-covariance matrix for beta^ (if the sightability
model is not to be fit by Sight.Est).  Make sure the order is consistent
with the specification in the "form" argument.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Variance estimation methods: method = Wong implements the variance estimator
from Wong (1996) and is the recommended approach.  Method = SS implements
the variance estimator of Steinhorst and Samuel (1989), with a modification
detailed in the Appendix of Samuel et al. (1992).
</p>
<p>Estimates of the variance may be biased low when the number of test trials
used to estimate model parameters is small (see Wong 1996, Fieberg and
Giudice 2008).  A bootstrap can be used to aid the estimation process by
specifying Vm.boot = TRUE [note: this method is experimental, and can be
time intensive].
</p>
<p>Confidence interval construction: often the sampling distribution of tau^ is
skewed right.  If logCI = TRUE, the confidence interval for tau^ will be
constructed under an assumption that (tau^ - T) has a lognormal distribution,
where T is the total number of animals seen.  In this case, the upper and
lower limits are constructed as follows [see Wong(1996, p. 64-67)]:
</p>
<p>LCL = T + [(tau^-T)/C]*sqrt(1+cv^2), UCL = T+[(tau^-T)*C]*sqrt(1+cv^2),
where cv^2 = var(tau^)/(tau^-T)^2 and C = exp[z[alpha/2]*sqrt(ln(1+cv^2))].
</p>


<h3>Value</h3>

<p>An object of class <code>sightest_ratio</code>, a list that includes the
following elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>sight.model</code></td>
<td>
<p>the fitted sightability model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>ratio estimate, ratio.hat,abundance estimate [tau.hat] and its
estimate of uncertainty [Varratio] as well as variance components due to
sampling [Varsamp], detection [VarSight], and model uncertainty [VarMod]</p>
</td>
</tr>
</table>
<p>The list also includes the estimates for the numerator and denominator
total, the original test trial and operational survey data, sampling
information, and information needed to construct a confidence interval for
the population estimate.
</p>


<h3>Author(s)</h3>

<p>Carl James Schwarz, StatMathComp Consulting by Schwarz,
cschwarz.stat.sfu.ca@gmail.com
</p>


<h3>References</h3>

<p>Fieberg, J.  2012.  Estimating Population Abundance Using Sightability
Models: R SightabilityModel Package. Journal of Statistical Software, 51(9),
1-20.  URL https://doi.org/10.18637/jss.v051.i09.
</p>
<p>Fieberg, John and Giudice, John. 2008 Variance of Stratified Survey
Estimators With Probability of Detection Adjustments. Journal of Wildlife
Management 72:837-844.
</p>
<p>Samuel, Michael D. and Steinhorst, R. Kirk and Garton, Edward O. and
Unsworth, James W. 1992.  Estimation of Wildlife Population Ratios
Incorporating Survey Design and Visibility Bias.  Journal of Wildlife
Management 56:718-725.
</p>
<p>Steinhorst, R. K., and M.D. Samuel. 1989.  Sightability adjustment methods
for aerial surveys of wildlife populations.  Biometrics 45:415-425.
</p>
<p>Wong, C. 1996.  Population size estimation using the modified
Horvitz-Thompson estimator with estimated sighting probabilities.
Dissertation, Colorado State University, Fort Collins, USA.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load data frames
  data(obs.m) # observational survey data frame
  data(exp.m) # experimental survey data frame
  data(sampinfo.m) # information on sampling rates (contained in a data frame)
 
# Estimate ratio of bulls to cows in 2007 only
  sampinfo &lt;- sampinfo.m[sampinfo.m$year == 2007,]

  obs.m$numerator   &lt;- obs.m$bulls
  obs.m$denominator &lt;- obs.m$cows
  
  Sight.Est.Ratio(observed ~ voc, odat = obs.m[obs.m$year == 2007,],
    sdat = exp.m, sampinfo, method = "Wong", 
    logCI = TRUE, alpha = 0.05, Vm.boot = FALSE) 


</code></pre>


</div>