<div class="container">

<table style="width: 100%;"><tr>
<td>sparsereg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse regression for experimental and observational data.</h2>

<h3>Description</h3>

<p>Function for fitting a Bayesian LASSOplus model for sparse models with uncertainty, facilitating the discovery of various types of interactions. Function takes a dependent variable, an optional matrix of (pre-treatment) covariates, and a (optional) matrix of categorical treatment variables. Includes correct calculation of uncertainty estimates, including for data with repeated observations.</p>


<h3>Usage</h3>

<pre><code class="language-R">sparsereg(y, X, treat=NULL, EM=FALSE, gibbs=200, burnin=200, thin=10,  
type="linear", scale.type="none", baseline.vec=NULL, 
id=NULL, id2=NULL, id3=NULL, save.temp=FALSE, conservative=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariates. Typical vocabulary would refer to these as "pre-treatment" covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat</code></td>
<td>
<p>Matrix of categorical treatment variables. May be a matrix with one column in the case of there being only one treatment variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM</code></td>
<td>
<p>Whether to fit model via EM or MCMC.  EM is much quicker, but only returns point estimates.  MCMC is slower, but returns posterior intervals and approximate confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gibbs</code></td>
<td>
<p>Number of posterior samples to save.  Between each saved sample,  <span class="env">thin</span> samples are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>

<p>Number of burnin samples.   Between each burnin sample,  <span class="env">thin</span> samples are drawn.
These iterations will not be included in the resulting analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>Extent of thinning of the MCMC chain.  Between each posterior sample, whether burnin or saved, <span class="env">thin</span> draws are made.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of regression model to fit.  Allowed types are linear or probit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline.vec</code></td>
<td>
<p>Optional vector with one entry for each column of the treatment matrix.  Each entry gives the baseline condition for that treatment, which then during pre-processing is omitted for estimation so it serves as an excluded category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id, id2, id3</code></td>
<td>

<p>Vectors the same lenght of the sample denoting clustering in the data.  In a conjoint experiment with repeated observations, these correspond with respondent IDs.  Up to three different sets of random effects are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.type</code></td>
<td>

<p>Indicates the types of interactions that will be created and used in estimation. <span class="env">scale.type="none"</span> generates no interactions and corresponds to simply running LASSOplus with no interactions between variables.
<span class="env">scale.type="TX"</span> creates interactions between each X variable and each level of the treatment variables. <span class="env">scale.type="TT"</span> creates interactions between each level of separate treatment variables.
<span class="env">scale.type="TTX"</span> interacts each X variable with all values generated by <span class="env">scale.type="TT"</span>. 
Note that users can create their own interactions of interest, select <span class="env">scale.type="none"</span>, to return the sparse version of the user specified model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.temp</code></td>
<td>
<p>Whether to save intermediate output in a file named <span class="env">temp_sparsereg</span>.  Useful for very long runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conservative</code></td>
<td>
<p>Experimental.  If set to <span class="env">FALSE</span>, the estimate is less conservative in selecting a variable.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <span class="env">sparsereg</span> allows for estimation of a broad range of sparse regressions.  The method allows for continuous, binary, and censored outcomes.  In experimental data, it can be used for subgroup analysis.  It pre-processes lower-order terms to generate higher-order interactions terms that are uncorrelated with their lower order component, with pre-processing generated through <span class="env">scale.type</span>.  In observational data, it can be used in place of a standard regression, especially in the presence of a large number of variables.  The method also adjusts uncertainty estimates when there are repeated observations through using random effects.  For example, a conjoint design may have the same people make several comparisons, or a panel data regression may have multiple observations on the same unit.
</p>
<p>The object contains the estimated posterior for all of the modeled effects, and analyzing the object is facilitated by the functions <span class="env">plot</span>, <span class="env">summary</span>, <span class="env">violinplot</span>, and <span class="env">difference</span>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta.mode</code></td>
<td>
<p>Matrix of sparse (mode) estimates with rows equal to number of effects and columns for posterior samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.mean</code></td>
<td>
<p>Matrix of mean estimates with rows equal to number of effects and columns for posterior samples.  These estimates are not sparse, but they do predict better than the mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.ci</code></td>
<td>
<p>Matrix of effects used to calculate approximate confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sq</code></td>
<td>
<p>Vector of posterior estimate of error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of covariates fit.  Includes interaction terms, depending on <span class="env">scale.type</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmat</code></td>
<td>
<p>Matrix of showing which lower-order terms correspond with which effects.  Used in producing figures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>Vector of baseline categories for treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeltype</code></td>
<td>
<p>Type of sparsereg model fit. In this case, <span class="env">onestage</span>.  Used by summary functions.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ratkovic, Marc and Tingley, Dustin.  2015.  "Sparse Estimation with Uncertainty: Subgroup Analysis in Large Dimensional Design."  Working paper.
</p>
<p>Egami, Naoki and Imai, Kosuke. 2015. "Causal Interaction in High-Dimension."  Working paper.
</p>


<h3>See Also</h3>

<p>plot.sparsereg, summary.sparsereg, violinplot, difference, print.sparsereg</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
 set.seed(1)
 n&lt;-500
 k&lt;-5
 treat&lt;-sample(c("a","b","c"),n,replace=TRUE,pr=c(.5,.25,.25))
 treat2&lt;-sample(c("a","b","c","d"),n,replace=TRUE,pr=c(.25,.25,.25,.25))
 Sigma&lt;-diag(k)
 Sigma[Sigma==0]&lt;-.5
 X&lt;-mvrnorm(n,m=rep(0,k),S=Sigma)
 y.true&lt;-3+X[,2]*2+(treat=="a")*2 +(treat=="b")*(-2)+X[,2]*(treat=="b")*(-2)+
  X[,2]*(treat2=="c")*2
 y&lt;-y.true+rnorm(n,sd=2)

##Fit a linear model.
s1&lt;-sparsereg(y, X, cbind(treat,treat2), scale.type="TX")
s1.EM&lt;-sparsereg(y, X, cbind(treat,treat2), EM=TRUE, scale.type="TX")

##Summarize results from MCMC fit
summary(s1)
plot(s1)
violinplot(s1)

##Summarize results from MCMC fit
summary(s1.EM)
plot(s1.EM)

##Extension using a baseline category
s1.base&lt;-sparsereg(y, X, treat, scale.type="TX", baseline.vec="a")

summary(s1.base)
plot(s1.base)
violinplot(s1.base)


## End(Not run)

</code></pre>


</div>