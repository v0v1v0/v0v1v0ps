<div class="container">

<table style="width: 100%;"><tr>
<td>gsPEN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
SummaryLasso incorporating multiple traits
</h2>

<h3>Description</h3>

<p>SummaryLasso to model pleiotropy by introducing a group-Lasso type penalty, 
which is sensitive to select SNPs modestly associated with multiple traits. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsPEN(summaryZ, Nvec, plinkLD, NumIter = 100, breaking = 1, numChrs = 22, 
ChrIndexBeta = 0, Init_summaryBetas = 0, Zscale = 1, RupperVal = NULL, 
tuningMatrix = NULL, penalty = c("mixLOG"), taufactor = c(1/25, 1, 10), 
llim_length = 10, subtuning = 50, Lambda_limit = c(0.5, 0.9), 
Lenlam_singleTrait = 200, dfMax = NULL, IniBeta = 0, inverseTuning = 0, 
outputAll = 0, warmStart = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>summaryZ</code></td>
<td>

<p>The Z statistics of p SNPs from q GWA studies. A matrix with dimension p x q for p SNPs and q traits.
The first column corresponds to the primary trait and the rest columns correspond to the secondary traits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nvec</code></td>
<td>

<p>A vector of length q for the sample sizes of q GWA studies.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plinkLD</code></td>
<td>

<p>.ld file of the LD calculation from plink.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumIter</code></td>
<td>

<p>The number of maximum iteraions for the estimation procedure. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaking</code></td>
<td>

<p>A binary (0,1) variable to check if there are some certain estimates of coefficients to diverge during 
the iterations. This may happen when the signs of the correlation coefficinets were estimated incorrectly. 
The default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numChrs</code></td>
<td>

<p>The number of chromosomes used in the analysis. Current version of pacakge does not use this argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChrIndexBeta</code></td>
<td>

<p>The chromosome index for each SNP. Current version of pacakge does not use this argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Init_summaryBetas</code></td>
<td>

<p>Can be used to set the initial values of the coefficients for the iterative estimation. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zscale</code></td>
<td>

<p>A binary (0,1) variable to make the coefficients from different GWA studies with unequal sample sizes comparable.
The default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RupperVal</code></td>
<td>

<p>The maximum tolerable magnitude of the estimates of coefficients during the iterations. 
This is to avoid a certain estimates of coefficients to diverge during the iterations. This may happen when 
the signs of the correlation coefficinets were estimated incorrectly. The default value is 50 times the 
maximum of coeffcients from the input in absolute values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuningMatrix</code></td>
<td>

<p>Inputs for the tuning values of the tuning parameters. Default is null and it will be generated automatically. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>Current version of pacakge does not use this argument. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taufactor</code></td>
<td>

<p>The weights to generate the tuning values for the tuning paramter "tau" and the default is c(1/25, 1, 10) 
times the median of the p summation of the coefficients for each SNP across q traits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llim_length</code></td>
<td>

<p>The argument to set up the number of tuning values for lambdas between the lower and upper bound. The default 
value is 10.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtuning</code></td>
<td>

<p>The argument to set up the number of tuning values for lambdas between the lower and upper bound. The default 
value is 50.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda_limit</code></td>
<td>

<p>The quantiles to set up the tuning values of lambda. The default value is c(0.5, 0.9).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lenlam_singleTrait</code></td>
<td>

<p>The quantiles to set up the tuning values of lambda for single trait analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfMax</code></td>
<td>

<p>The upper bound of the number of non-zero estimates of coefficients for the primary trait.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IniBeta</code></td>
<td>

<p>A binary (0,1) variable to indicate if the regression coefficients need to be initialized or not. 1 is for yes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverseTuning</code></td>
<td>

<p>For internal checking usage. The default value is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputAll</code></td>
<td>

<p>For internal checking usage. The default value is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmStart</code></td>
<td>

<p>For analysis with single trait or multiple traits without functional annotations, it is recommended to use 
warmStart = 1 to enhance computations. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the tuning values for the tuning parameters may need to be modified manually when the selected 
optimal tuning parameters are at the boundary of the inputs.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BetaMatrix</code></td>
<td>
<p>The output of the coefficients matrix with dimensions (total number of combinations 
of the tuning values times (pq)). Each column represents the vectorization of the p x q coefficients 
matrix given a particular combination of the tuning values (stacking its columns into a column vector). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Numitervec</code></td>
<td>
<p>This vector shows the number of iterations to converge for each combination 
of the tuning values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AllTuningMatrix</code></td>
<td>
<p>This matrix shows all combination of tuning values used in the estimation process. 
Its dimension is that total number of combinations of the tuning values times total number of tuning parameters.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ting-Huei Chen
</p>


<h3>References</h3>

<p>This R packages is based on the method introduced in the manuscript "A comprehensive statistical framework for building polygenic risk prediction models based on summary statistics of genome-wide association studies."
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("summaryZ")
data("Nvec")
data("plinkLD")
output = gsPEN(summaryZ=summaryZ, Nvec=Nvec, plinkLD=plinkLD)

</code></pre>


</div>