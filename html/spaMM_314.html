<div class="container">

<table style="width: 100%;"><tr>
<td>rankinfo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Checking the rank of the fixed-effects design matrix
</h2>

<h3>Description</h3>

<p>By default, fitting functions in <code>spaMM</code> check the rank of the design matrix for fixed effects, as <code>stats::lm</code>
or <code>stats::glm</code> do (but not, say, <code>nlme::lme</code>). This computation can be quite long.  
To save time when fitting different models with the same fixed-effect terms to the same data, 
the result of the check can be extracted from a return object by <code>get_rankinfo()</code>,
and can be provided as argument <code>control.HLfit$rankinfo</code> to another fit. Alternatively, the check will not be performed if
<code>control.HLfit$rankinfo</code> is set to <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_rankinfo(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>HLfit</code>, as returned by the fitting functions in <code>spaMM</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The check is performed by a call to <code>qr()</code> methods for either dense or sparse matrices. 
If the design matrix is singular, a set of columns from the design matrix that define a non-singular matrix is identified. Note that different sets may be identified by sparse- and dense-matrix <code>qr</code> methods.
</p>


<h3>Value</h3>

<p>A list with elements <code>rank</code>, <code>whichcols</code> (a set of columns that define a non-singular matrix), and <code>method</code> (identifying the algorithm used).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Data preparation
# Singular matrix from ?Matrix::qr :
singX &lt;- cbind(int = 1,
           b1=rep(1:0, each=3), b2=rep(0:1, each=3),
           c1=rep(c(1,0,0), 2), c2=rep(c(0,1,0), 2), c3=rep(c(0,0,1),2))
rownames(singX) &lt;- paste0("r", seq_len(nrow(singX)))
donn &lt;- as.data.frame(singX)
set.seed(123)
donn$y &lt;- runif(6)

fitlm &lt;- fitme(y~int+ b1+b2+c1+c2+c3,data=donn)
get_rankinfo(fitlm)

</code></pre>


</div>