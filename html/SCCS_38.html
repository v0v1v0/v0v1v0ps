<div class="container">

<table style="width: 100%;"><tr>
<td>standardsccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The standard SCCS method

</h2>

<h3>Description</h3>

<p>Fits the standard SCCS model where age and exposure effects are represented by piecewise constant functions. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardsccs(formula, indiv, astart, aend, aevent, adrug, aedrug,
            expogrp = list(), washout = list(), sameexpopar = list(),
            agegrp = NULL, seasongrp=NULL, dob=NULL, dataformat="stack",
            data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>model formula. The dependent variable should always be "event" e.g. event ~ itp. If age and/or season effects are included, they should always be included as 'age' and 'season', e.g. event ~ itp + age.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at which the observation periods start. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event; an individual can experience multiple events
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a list of vectors of ages at start of exposures or a list of matrices if the exposures have multiple episodes (<code>dataformat</code> multi). Multiple exposures of the same type can be recorded as multiple rows (<code>dataformat</code> stack). One list item per exposure type.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a list of vectors of ages at which exposure-related risk ends or a list of matrices if there are multiple episodes (repeat exposures in different columns) of the same exposure type. The dimension of each item of <code>aedrug</code> has to be equal to that of <code>adrug</code>, that is <code>aedrug</code> should be given for each exposure in <code>adrug</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expogrp</code></td>
<td>

<p>list of vectors of days to the start of exposure-related risk, counted from <code>adrug</code>. E.g if the risk period is [<code>adrug</code>+c,<code>aedrug</code>], use expogrp =  c or expogrp = list(c). For multiple exposure types <code>expogrp</code> is a list of the same length as list <code>adrug</code>. The DEFAULT is a list of zeros where the exposure-related risk periods are [<code>adrug</code>, <code>aedrug</code>].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>washout</code></td>
<td>

<p>list of vectors with days to start of washout periods counted from <code>aedrug</code>, the number of vectors in the list is equal to the number of exposures or the length of list <code>adrug</code>. The default is  NULL, no washout periods. The order of the list corresponds to the order of exposures in <code>adrug</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sameexpopar</code></td>
<td>

<p>a vector of logical values. If TRUE (the default) no dose effect is assumed: the same exposure parameters are used for multiple doses/episodes of the same exposure type, presented in <code>dataformat</code> 'multi'. If FALSE different relative incidences are estimated for different doses of the same exposure. The length of the vector is equal to the length of list <code>adrug</code>. The order of the elements of the vector corrosponds to the order of exposures in list <code>adrug</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agegrp</code></td>
<td>

<p>a vector of cut points of the age groups where each value represents the start of an age category. The first element in the vector is the start of the second age group. The first age group starts at the minimum of <code>astart</code>, the start of the observation period. The default is NULL (i.e no age effects included). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasongrp</code></td>
<td>

<p>a vector of cut points for seasonal effects. The values should be given in ddmm format, representing the first days of each season group. The seasonal effect is a factor, the reference level being the time interval starting at the earliest date in <code>seasongrp</code>. The default is NULL where no seasonal effects are included.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dob</code></td>
<td>

<p>a vector of birth dates of the cases, in ddmmyyyy format. They are used if seasonal effects are included in the model. The default <code>dob</code> is NULL. Required if <code>seasongrp</code> is not NULL.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataformat</code></td>
<td>

<p>the way the input data are assembled. It accepts "multi" or "stack" (the default), where "multi" refers to a data assembled with one row representing one event and "stack" refers to a data frame where repeated exposures of the same type are stack in one column. In the "multi" dataformat different episodes of the same exposure type are recorded as separate columns in the dataframe. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the input data. The data should be in 'stack' or 'multi' (see <code>dataformat</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>In the standard SCCS model, originally described in Farrington (1995), age and exposure effects are represented by step functions. Suppose that individual <code class="reqn">i</code> has <code class="reqn">n_i</code> events, <code class="reqn">n_{ijk}</code> occurring in age group <code class="reqn">j</code> and exposure group <code class="reqn">k</code> and that the <code class="reqn">s^{{th}}</code> event falls within age group <code class="reqn">j_s</code> and exposure group <code class="reqn">k_s</code>. The SCCS likelihood contribution for individual <code class="reqn">i</code> is
</p>
<p style="text-align: center;"><code class="reqn">l_i = \frac{\prod_{s=1}^{n_i} \exp(\alpha_{j_s} + \beta_{k_s}) }{\Big(\sum_{j=1}^J\sum_{k=1}^K\exp(\alpha_j + \beta_k) e_{ijk}\Big)^{n_i}}.</code>
</p>

<p>This is a multinomial likelihood with index <code class="reqn">n_i</code>, responses <code class="reqn">n_{ijk}</code> and probabilities
</p>
<p style="text-align: center;"><code class="reqn">p_{iuv} = \frac{\exp(\alpha_{u} + \beta_{v})e_{iuv} }{\sum_{j=1}^J \sum_{k=1}^K\exp(\alpha_j + \beta_k) e_{ijk}}.</code>
</p>

<p>The standard SCCS likelihood is equivalent to a product multinomial likelihood.
</p>
<p>The SCCS likelihood is equivalent to that of the conditional logistic model for <code class="reqn">1:M</code> matched case-control studies: see Breslow and Day (1980), Chapter 7. This means that SCCS models can be fit using conditional logistic regression, with a factor for each individual event. 
</p>
<p>The SCCS R package maximises the likelihood using clogit. Each event is assigned an identifier (indivL), and direct estimation is avoided using the option strata(indivL).
</p>


<h3>Value</h3>

<p>Relative incidence estimates along with their 95% confidence limits. 





</p>


<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington.
</p>


<h3>References</h3>

<p>Farrington, C.P. (1995). Relative incidence estimation from case series for vaccine safety evaluation. Biometrics 51, 228â€“235.
</p>
<p>Breslow, N. E. and  Day, N. E. (1980). Statistical Methods in Cancer Research, volume I: The analysis of case-control studies. IARC Publications No.32.
</p>
<p>Farrington, P., Whitaker, H., and Ghebremichael-Weldeselassie, Y. (2018). Self-controlled Case Series studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>semisccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Single exposure-related risk period with no age effect

  itp.mod1 &lt;- standardsccs(event~mmr, indiv=case, astart=sta, aend=end,
                        aevent=itp, adrug=mmr, aedrug=mmr+42, data=itpdat)

  itp.mod1

# Single exposure-related risk period and age effect included

  itp.mod2 &lt;- standardsccs(event~mmr+age, indiv=case, astart=sta, aend=end,
                        aevent=itp, adrug=mmr, aedrug=mmr+42,
                        agegrp=c(427,488,549,610,671), data=itpdat)

  itp.mod2

# Multiple risk periods and age effect included  
  
  itp.mod3 &lt;- standardsccs(event~mmr+age, indiv=case, astart=sta, aend=end,
                        aevent=itp, adrug=mmr, aedrug=mmr+42, expogrp=c(0,15,29),
                        agegrp=c(427,488,549,610,671), data=itpdat)

  itp.mod3

# Multiple risk periods, washout periods and age effects

   ageq &lt;- floor(quantile(hipdat$frac, seq(0.05,0.95,0.05), 
                         names=FALSE)) # Age group 
                                      # cut points
   
   hip.mod1 &lt;- standardsccs(event~ad+age, indiv=case, astart=sta, aend=end,
                           aevent=frac, adrug=ad, aedrug=endad, expogrp=c(0,15,43),
                           washout=c(1,92,182), agegrp=ageq, data=hipdat)


# Multiple/repeat exposures of the same exposure type, dataformat="stack" 

   ageq &lt;- floor(quantile(gidat$bleed[duplicated(gidat$case)==0], 
                seq(0.025,0.975,0.025), names=FALSE))

   gi.mod1 &lt;- standardsccs(event~ns+relevel(age,ref=21), indiv=case, astart=sta,
                         aend=end, aevent=bleed, adrug=ns, aedrug=endns,
                         agegrp=ageq, dataformat="stack", data=gidat)

   gi.mod1
   
#  Multiple doses of a vaccine each with different parameter estimates (sameexpopar=F)
  
   
   ageg &lt;- c(57,85,113,141,169,197,225,253,281,309,337) # age group cut points
   
   dtp.mod2 &lt;- standardsccs(event~dtp+age, indiv=case, astart=sta, aend=end,
                           aevent=conv, adrug=cbind(dtp,dtpd2, dtpd3), 
                           aedrug=cbind(dtp+14,dtpd2+14,dtpd3+14), 
                           expogrp=c(0,4,8),agegrp=ageg, dataformat="multi", 
                           sameexpopar=FALSE, data=dtpdat)

   dtp.mod2
   
# Multiple exposure types 

  ageg &lt;- seq(387,707,20) # Age group cut points
 con.mod &lt;- standardsccs(event~hib+mmr+age, indiv=case, astart=sta, aend=end,
                          aevent=conv, adrug=cbind(hib,mmr), aedrug=cbind(hib+14,mmr+14), 
                          expogrp=list(c(0,8), c(0,8)), agegrp=ageg, data=condat)

  con.mod

   
# Multiple doses/episodes of several exposure types, the doses of each exposure type
# have same paramter


   ageg &lt;- c(57,85,113,141,169,197,225,253,281,309,337)   # age group cut points 

   hib.mod1 &lt;- standardsccs(event~dtp+hib+age, indiv=case, astart=sta, 
                            aend=end, aevent=conv, 
                           adrug=list(cbind(dtp, dtpd2,dtpd3),
                                       cbind(hib,hibd2,hibd3)),
                            aedrug=list(cbind(dtp+14,dtpd2+14,dtpd3+14),
                                        cbind(hib+14,hibd2+14,hibd3+14)),
                            expogrp=list(c(0,4,8),c(0,8)),agegrp=ageg, 
                            dataformat="multi", data=hibdat)
                            
   hib.mod1                   


# Multiple doses/episodes of several exposure types, the doses of "dtp" 
# different parameters and the doses of the second exposure hib have
# same paramters


   ageg &lt;- c(57,85,113,141,169,197,225,253,281,309,337)
                    # age group cut points 

   hib.mod2 &lt;- standardsccs(event~dtp+hib+age, 
                                   indiv=case, astart=sta, aend=end,
                        aevent=conv, adrug=list(cbind(dtp,dtpd2,dtpd3), 
                                      cbind(hib,hibd2,hibd3)), 
                        aedrug=list(cbind(dtp+3,dtpd2+3,dtpd3+3),
                                      cbind(hib+7,hibd2+7,hibd3+7)),
                        sameexpopar=c(FALSE,TRUE), agegrp=ageg, 
                        dataformat="multi", data=hibdat)
   hib.mod2

   
# Season included in a model 

   month &lt;- c(0101,0102,0103,0104,0105,0106,0107,0108,0109,0110,0111,0112) 
   # season cutpoints 
   
   int.mod &lt;- standardsccs(event~opv+age+season, indiv=case, astart=sta,
                          aend=end, aevent=intus, adrug=cbind(opv,opvd2),
                          aedrug=cbind(opv+42,opvd2+42), expogrp=c(0,15,29),
                          agegrp=seq(30,330,30), seasongrp=month,dob=dob, 
                          dataformat="multi", data=intdat)
   int.mod
</code></pre>


</div>