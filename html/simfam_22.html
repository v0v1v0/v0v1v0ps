<div class="container">

<table style="width: 100%;"><tr>
<td>recomb_map_simplify_chr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simplify recombination map of one chromosome to a desired numerical precision</h2>

<h3>Description</h3>

<p>Given an input recombination map, this function iteratively removes rows that can be interpolated to less than a given error <code>tol</code>.
This is a heuristic that works very well in practice, resulting in average interpolation errors well below <code>tol</code>, and maximum final errors no greater than <code>3 * tol</code> in our internal benchmarks (expected in extremely concave or convex regions of the map; final errors are rarely above <code>tol</code> with few exceptions).
</p>


<h3>Usage</h3>

<pre><code class="language-R">recomb_map_simplify_chr(map, tol = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A tibble with two columns: <code>pos</code> position in base pairs, and <code>posg</code> position in centiMorgans (cM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance of interpolation errors, in cM.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reduces recombination map sizes drastically, in order to include them in packages, and also makes linear interpolation faster.
This simplification operation can be justified as the precision of many existing maps is both limited and overstated, and a high accuracy is not needed for simulations with many other approximations in place.
</p>


<h3>Value</h3>

<p>The recombination map with rows (positions) removed (if they are interpolated with errors below <code>tol</code> in most cases).
</p>


<h3>See Also</h3>

<p><code>recomb_map_fix_ends_chr()</code> to shift and extrapolate recombination map to ends of chromosome.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)
# create a toy recombination map to simplify
# in this case all middle rows can be interpolated from the ends with practically no error
map &lt;- tibble(
    pos  = c(  1L, 1e6L, 2e6L, 3e6L ),
    posg = c( 0.0,  1.0,  2.0,  3.0 )
)

# simplify map!
map_simple &lt;- recomb_map_simplify_chr( map )
# inspect
map_simple

</code></pre>


</div>