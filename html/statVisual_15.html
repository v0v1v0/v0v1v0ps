<div class="container">

<table style="width: 100%;"><tr>
<td>iprcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Improved Function for Obtaining Principal Components
</h2>

<h3>Description</h3>

<p>Calculate principal components when data contains missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">iprcomp(dat, center = TRUE, scale. = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>n by p matrix. rows are subjects and columns are variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>logical. Indicates if each row of <code>dat</code> needs to be mean-centered
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.</code></td>
<td>

<p>logical. Indicates if each row of <code>dat</code> needs to be scaled to have variance one
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We first set missing values as median of the corresponding variable, then call the function <code>prcomp</code>.
This is a very simple solution. The user can use their own imputation methods before calling <code>prcomp</code>.
</p>


<h3>Value</h3>

<p>A list of 3 elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sdev </code></td>
<td>
<p>square root of the eigen values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation </code></td>
<td>
<p>a matrix with columns are eigen vectors, i.e., projection direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>a matrix with columns are principal components</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wenfei Zhang &lt;Wenfei.Zhang@sanofi.com&gt;,
Weiliang Qiu &lt;Weiliang.Qiu@sanofi.com&gt;,
Xuan Lin &lt;Xuan.Lin@sanofi.com&gt;,
Donghui Zhang &lt;Donghui.Zhang@sanofi.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate simulated data
set.seed(1234567)
dat.x = matrix(rnorm(500), nrow = 100, ncol = 5)
dat.y = matrix(rnorm(500, mean = 2), nrow = 100, ncol = 5)
dat = rbind(dat.x, dat.y)
grp = c(rep(0, 100), rep(1, 100))
print(dim(dat))

res = iprcomp(dat, center = TRUE, scale.  =  FALSE)

# for each row, set one artificial missing value
dat.na=dat
nr=nrow(dat.na)
nc=ncol(dat.na)
for(i in 1:nr)
{
  posi=sample(x=1:nc, size=1)
  dat.na[i,posi]=NA
}

res.na = iprcomp(dat.na, center = TRUE, scale.  =  FALSE)

##
# pca plot
##
par(mfrow = c(3,1))
# original data without missing values
plot(x = res$x[,1], y = res$x[,2], xlab = "PC1", ylab  =  "PC2")
# perturbed data with one NA per probe 
# the pattern of original data is captured
plot(x = res.na$x[,1], y = res.na$x[,2], xlab = "PC1", ylab  =  "PC2", main = "with missing values")
par(mfrow = c(1,1))

</code></pre>


</div>