<div class="container">

<table style="width: 100%;"><tr>
<td>tolerance_limit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tolerance Limits from an Agreement Study</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt="[Maturing]"></a>
</p>
<p>A function for calculating tolerance limits for the difference between two measurements (difference = x-y).
This is a procedure that should produce results similar to the Bland-Altman limits of agreement.
See vignettes for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tolerance_limit(
  data,
  x,
  y,
  id = NULL,
  condition = NULL,
  time = NULL,
  pred_level = 0.95,
  tol_level = 0.95,
  tol_method = c("approx", "perc"),
  prop_bias = FALSE,
  log_tf = FALSE,
  cor_type = c("sym", "car1", "ar1", "none"),
  correlation = NULL,
  weights = NULL,
  keep_model = TRUE,
  replicates = 999
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of the column for the first measurement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Name of the column for the second measurement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Name of the column for the subject ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>Name of the column indicating different conditions subjects were tested under. This can be left missing if there are no differing conditions to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Name of the column indicating the time points. Only necessary if the data is from time series or repeated measures collection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_level</code></td>
<td>
<p>Prediction level for the prediction interval. Default is 95%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_level</code></td>
<td>
<p>Tolerance level for the tolerance limit (i.e., the CI of the prediction limit). Default is 95%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_method</code></td>
<td>
<p>Method for calculating the tolerance interval. Options are "approx" for a chi-square based approximation and "perc" for a parametric percentile bootstrap method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_bias</code></td>
<td>
<p>Whether to include a proportional bias term in the model. Determines whether proportional bias should be considered for the prediction/tolerance limits calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_tf</code></td>
<td>
<p>Calculate limits of agreement using log-transformed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_type</code></td>
<td>
<p>The type of correlation structure. "sym" is for Compound Symmetry, "car1" is for continuous autocorrelation structure of order 1, or "ar1" for autocorrelation structure of order 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional corStruct object describing the within-group correlation structure that overrides the default setting. See the documentation of corClasses for a description of the available corStruct classes. If a grouping variable is to be used, it must be specified in the form argument to the corStruct constructor. Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional varFunc object or one-sided formula describing the within-group heteroskedasticity structure that overrides the default setting. If given as a formula, it is used as the argument to varFixed, corresponding to fixed variance weights. See the documentation on varClasses for a description of the available varFunc classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_model</code></td>
<td>
<p>Logical indicator to retain the GLS model. Useful when working with large data and the model is very large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>The number of bootstrap replicates. Passed on to the boot function. Default is 999.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The tolerance limits calculated in this function are based on the papers by Francq &amp; Govaerts (2016), Francq, et al. (2019), and Francq, et al. (2020).
When <code>tol_method</code> is set to "approx", the tolerance limits are calculated using the approximation detailed in Francq et al. (2020).
However, these are only an approximation and conservative.
Therefore, as suggested by Francq, et al. (2019), a parametric bootstrap approach can be utilized to calculate percentile tolerance limits (<code>tol_method = "perc"</code>).
</p>


<h3>Value</h3>

<p>Returns single <code>tolerance_delta</code> class object with the results of the agreement analysis with a prediction interval and tolerance limits.
</p>

<ul>
<li> <p><code>limits</code>: A data frame containing the prediction/tolerance limits.
</p>
</li>
<li> <p><code>model</code>: The GLS model; NULL if keep_model set to FALSE.
</p>
</li>
<li> <p><code>call</code>: The matched call.
</p>
</li>
</ul>
<h3>References</h3>

<p>Francq, B. G., &amp; Govaerts, B. (2016). How to regress and predict in a Bland–Altman plot? Review and contribution based on tolerance intervals and correlated‐errors‐in‐variables models. Statistics in mMdicine, 35(14), 2328-2358.
</p>
<p>Francq, B. G., Lin, D., &amp; Hoyer, W. (2019). Confidence, prediction, and tolerance in linear mixed models. Statistics in Medicine, 38(30), 5603-5622.
</p>
<p>Francq, B. G., Berger, M., &amp; Boachie, C. (2020). To tolerate or to agree: A tutorial on tolerance intervals in method comparison studies with BivRegBLS R Package. Statistics in Medicine, 39(28), 4334-4349.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data('reps')

# Simple
tolerance_limit(x = "x", y ="y", data = reps)

# Nested
tolerance_limit(x = "x", y ="y", data = reps, id = "id")

</code></pre>


</div>