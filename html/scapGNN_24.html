<div class="container">

<table style="width: 100%;"><tr>
<td>Preprocessing</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data preprocessing</h2>

<h3>Description</h3>

<p>This function is to prepare data for the <code>ConNetGNN</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Preprocessing(data, parallel.cores = 1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input data should be a data frame or a matrix where the rows are genes and the columns are cells. The <code>seurat</code> object are also accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.cores</code></td>
<td>
<p>Number of processors to use when doing the calculations in parallel (default: <code>2</code>). If <code>parallel.cores=0</code>, then it will use all available core processors unless we set this argument with a smaller number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Gives information about each step. Default: <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Preprocessing
</p>
<p>The function is able to interface with the <code>seurat</code> framework. The process of <code>seurat</code> data processing refers to <code>Examples</code>.
The input data should be containing hypervariable genes and log-transformed. Left-truncated mixed Gaussian (LTMG) modeling to calculate gene
regulatory signal matrix. Positively correlated gene-gene and cell-cell are used as the initial gene correlation matrix and cell correlation matrix.
</p>


<h3>Value</h3>

<p>A list:
</p>

<dl>
<dt>orig_dara</dt>
<dd>
<p>User-submitted raw data, rows are highly variable genes and columns are cells.</p>
</dd>
<dt>cell_features</dt>
<dd>
<p>Cell feature matrix.</p>
</dd>
<dt>gene_features</dt>
<dd>
<p>Gene feature matrix.</p>
</dd>
<dt>ltmg_matrix</dt>
<dd>
<p>Gene regulatory signal matrix for LTMG.</p>
</dd>
<dt>cell_adj</dt>
<dd>
<p>The adjacency matrix of the cell correlation network.</p>
</dd>
<dt>gene_adj</dt>
<dd>
<p>The adjacency matrix of the gene correlation network.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# Load dependent packages.
# require(coop)

# Seurat data processing.
# require(Seurat)

# Load the PBMC dataset (Case data for seurat)
# pbmc.data &lt;- Read10X(data.dir = "../data/pbmc3k/filtered_gene_bc_matrices/hg19/")

# Our recommended data filtering is that only genes expressed as non-zero in more than
# 1% of cells, and cells expressed as non-zero in more than 1% of genes are kept.
# In addition, users can also filter mitochondrial genes according to their own needs.
# pbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = "case",
#                                     min.cells = 3, min.features = 200)
# pbmc[["percent.mt"]] &lt;- PercentageFeatureSet(pbmc, pattern = "^MT-")
# pbmc &lt;- subset(pbmc, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; percent.mt &lt; 5)

# Normalizing the data.
# pbmc &lt;- NormalizeData(pbmc, normalization.method = "LogNormalize")

# Identification of highly variable features.
# pbmc &lt;- FindVariableFeatures(pbmc, selection.method = 'vst', nfeatures = 2000)

# Run Preprocessing.
# Prep_data &lt;- Preprocessing(pbmc)



# Users can also directly input data
# in data frame or matrix format
# containing highly variable genes.
data("Hv_exp")
Hv_exp &lt;- Hv_exp[,1:20]
Hv_exp &lt;- Hv_exp[which(rowSums(Hv_exp) &gt; 0),]
Prep_data &lt;- Preprocessing(Hv_exp[1:10,])
</code></pre>


</div>