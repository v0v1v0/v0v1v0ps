<div class="container">

<table style="width: 100%;"><tr>
<td>simex-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Error or misclassification correction in models using (MC)SIMEX</h2>

<h3>Description</h3>

<p>Package <code>simex</code> is an implementation of the SIMEX–algorithm by Cook
and Stephanski and the MCSIMEX–Algorithm by Küchenhoff, Mwalili and Lesaffre.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
    Package: </td>
<td style="text-align: left;"> simex</td>
</tr>
<tr>
<td style="text-align: left;">
    Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
    Version: </td>
<td style="text-align: left;"> 1.8</td>
</tr>
<tr>
<td style="text-align: left;">
    Date: </td>
<td style="text-align: left;"> 2019-07-28</td>
</tr>
<tr>
<td style="text-align: left;">
    License: </td>
<td style="text-align: left;"> GPL 2 or above</td>
</tr>
<tr>
<td style="text-align: left;">
    LazyLoad: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>The package includes first of all the implementation for the SIMEX– and
MCSIMEX–Algorithms. Jackknife and asymptotic variance estimation are
implemented. Various methods and analytic tools are provided for a simple and
fast access to the SIMEX– and MCSIMEX–Algorithm.
</p>
<p>Functions <code>simex()</code> and <code>mcsimex()</code> can be used on models issued
from <code>lm()</code>, <code>glm()</code> with asymtotic estimation.
Models from <code>nls()</code>, <code>gam()</code> (package <span class="pkg">mgcv</span>),
<code>polr()</code> (package <span class="pkg">MASS</span>),
<code>lme()</code>, <code>nlme()</code> (package <span class="pkg">nlme</span>) and <code>coxph()</code> (package <span class="pkg">survival</span>) can also be corrected with
these algorithms, but without asymptotic estimations.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Lederer, Heidi Seibold, Helmut Küchenhoff
</p>
<p>Maintainer: Wolfgang Lederer,<a href="mailto:wolfgang.lederer@gmail.com">wolfgang.lederer@gmail.com</a>
</p>


<h3>References</h3>

<p>Lederer, W. and Küchenhoff, H. (2006) A short introduction to the SIMEX and
MCSIMEX. <em>R News</em>, <b>6/4</b>, 26 – 31
</p>


<h3>See Also</h3>

<p><code>simex</code>, <code>mcsimex</code>, <code>misclass</code>
</p>
<p>and for functions generating the initial naive models:
<code>lm</code>, <code>glm</code>, <code>nls</code>,
<code>gam</code>, <code>lme</code>, <code>nlme</code>, <code>polr</code>, <code>coxph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See example(simex) and example(mcsimex)
## Seed
set.seed(49494)

## simulating the measurement error standard deviations
sd_me1 &lt;- 0.3
sd_me2 &lt;- 0.4
temp &lt;- runif(100, min = 0, max = 0.6)
sd_me_het1 &lt;- sort(temp)
temp2 &lt;- rnorm(100, sd = 0.1)
sd_me_het2 &lt;- abs(sd_me_het1 + temp2)

## simulating the independent variables x (real and with measurement error):
x_real1 &lt;- rnorm(100)
x_real2 &lt;- rpois(100, lambda = 2)
x_real3 &lt;- -4*x_real1 + runif(100, min = -2, max = 2)  # correlated to x_real

x_measured1 &lt;- x_real1 + sd_me1 * rnorm(100)
x_measured2 &lt;- x_real2 + sd_me2 * rnorm(100)
x_het1 &lt;- x_real1 + sd_me_het1 * rnorm(100)
x_het2 &lt;- x_real3 + sd_me_het2 * rnorm(100)

## calculating dependent variable y:
y1  &lt;- x_real1 + rnorm(100, sd = 0.05)
y2 &lt;- x_real1 + 2*x_real2 + rnorm(100, sd = 0.08)
y3 &lt;- x_real1 + 2*x_real3 + rnorm(100, sd = 0.08)


### one variable with homoscedastic measurement error
(model_real &lt;- lm(y1  ~ x_real1))

(model_naiv &lt;- lm(y1  ~ x_measured1, x = TRUE))

(model_simex &lt;- simex(model_naiv, SIMEXvariable = "x_measured1", measurement.error = sd_me1))
plot(model_simex)


### two variables with homoscedastic measurement errors
(model_real2 &lt;- lm(y2 ~ x_real1 + x_real2))

(model_naiv2 &lt;- lm(y2 ~ x_measured1 + x_measured2, x = TRUE))

(model_simex2 &lt;- simex(model_naiv2, SIMEXvariable = c("x_measured1", "x_measured2"),
                       measurement.error = cbind(sd_me1, sd_me2)))

plot(model_simex2)


### one variable with increasing heteroscedastic measurement error
model_real

(mod_naiv1 &lt;- lm(y1  ~ x_het1, x = TRUE))

(mod_simex1 &lt;- simex(mod_naiv1, SIMEXvariable = "x_het1",
     measurement.error = sd_me_het1, asymptotic = FALSE))

plot(mod_simex1)

## Not run: 
### two correlated variables with heteroscedastic measurement errors
(model_real3 &lt;- lm(y3 ~ x_real1 + x_real3))

(mod_naiv2 &lt;- lm(y3 ~ x_het1 + x_het2, x = TRUE))

(mod_simex2 &lt;- simex(mod_naiv2, SIMEXvariable = c("x_het1", "x_het2"),
                     measurement.error = cbind(sd_me_het1, sd_me_het2), asymptotic = FALSE))
plot(mod_simex2)


### two variables, one with homoscedastic, one with heteroscedastic measurement error
model_real2

(mod_naiv3 &lt;- lm(y2 ~ x_measured1 + x_het2, x = TRUE))

(mod_simex3 &lt;- simex(mod_naiv3, SIMEXvariable = c("x_measured1", "x_het2"),
                     measurement.error = cbind(sd_me1, sd_me_het2), asymptotic = FALSE))


### glm: two variables, one with homoscedastic, one with heteroscedastic measurement error
t &lt;- x_real1 + 2*x_real2
g &lt;- 1 / (1 + exp(-t))
u &lt;- runif(100)
ybin &lt;- as.numeric(u &lt; g)


(logit_real &lt;- glm(ybin ~ x_real1 + x_real2, family = binomial))

(logit_naiv &lt;- glm(ybin ~ x_measured1 + x_het2, x = TRUE, family = binomial))

(logit_simex &lt;- simex(logit_naiv, SIMEXvariable = c("x_measured1", "x_het2"),
                      measurement.error = cbind(sd_me1, sd_me_het2), asymptotic = FALSE))
summary(logit_simex)
print(logit_simex)
plot(logit_simex)

## End(Not run)
</code></pre>


</div>