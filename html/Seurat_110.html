<div class="container">

<table style="width: 100%;"><tr>
<td>FindClusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster Determination</h2>

<h3>Description</h3>

<p>Identify clusters of cells by a shared nearest neighbor (SNN) modularity
optimization based clustering algorithm. First calculate k-nearest neighbors
and construct the SNN graph. Then optimize the modularity function to
determine clusters. For a full description of the algorithms, see Waltman and
van Eck (2013) <em>The European Physical Journal B</em>. Thanks to Nigel
Delaney (evolvedmicrobe@github) for the rewrite of the Java modularity
optimizer code in Rcpp!
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindClusters(object, ...)

## Default S3 method:
FindClusters(
  object,
  modularity.fxn = 1,
  initial.membership = NULL,
  node.sizes = NULL,
  resolution = 0.8,
  method = "matrix",
  algorithm = 1,
  n.start = 10,
  n.iter = 10,
  random.seed = 0,
  group.singletons = TRUE,
  temp.file.location = NULL,
  edge.file.name = NULL,
  verbose = TRUE,
  ...
)

## S3 method for class 'Seurat'
FindClusters(
  object,
  graph.name = NULL,
  cluster.name = NULL,
  modularity.fxn = 1,
  initial.membership = NULL,
  node.sizes = NULL,
  resolution = 0.8,
  method = "matrix",
  algorithm = 1,
  n.start = 10,
  n.iter = 10,
  random.seed = 0,
  group.singletons = TRUE,
  temp.file.location = NULL,
  edge.file.name = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modularity.fxn</code></td>
<td>
<p>Modularity function (1 = standard; 2 = alternative).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.membership, node.sizes</code></td>
<td>
<p>Parameters to pass to the Python leidenalg function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>Value of the resolution parameter, use a value above
(below) 1.0 if you want to obtain a larger (smaller) number of communities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for running leiden (defaults to matrix which is fast for small datasets).
Enable method = "igraph" to avoid casting large data to a dense matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>Algorithm for modularity optimization (1 = original Louvain
algorithm; 2 = Louvain algorithm with multilevel refinement; 3 = SLM
algorithm; 4 = Leiden algorithm). Leiden requires the leidenalg python.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.start</code></td>
<td>
<p>Number of random starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Maximal number of iterations per random start.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.seed</code></td>
<td>
<p>Seed of the random number generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.singletons</code></td>
<td>
<p>Group singletons into nearest cluster. If FALSE, assign all singletons to
a "singleton" group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.file.location</code></td>
<td>
<p>Directory where intermediate files will be written.
Specify the ABSOLUTE path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.file.name</code></td>
<td>
<p>Edge file to use as input for modularity optimizer jar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.name</code></td>
<td>
<p>Name of graph to use for the clustering algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.name</code></td>
<td>
<p>Name of output clusters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To run Leiden algorithm, you must first install the leidenalg python
package (e.g. via pip install leidenalg), see Traag et al (2018).
</p>


<h3>Value</h3>

<p>Returns a Seurat object where the idents have been updated with new cluster info;
latest clustering results will be stored in object metadata under 'seurat_clusters'.
Note that 'seurat_clusters' will be overwritten everytime FindClusters is run
</p>


</div>