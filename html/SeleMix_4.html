<div class="container">

<table style="width: 100%;"><tr>
<td>pred.y</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Prediction of y variables  
</h2>

<h3>Description</h3>

<p>Provides predictions of y variables according to a Gaussian contamination model
</p>


<h3>Usage</h3>

<pre><code class="language-R">    pred.y (y, x=NULL, B, sigma, lambda, w, model="LN", t.outl=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix or data frame containing the response variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>optional matrix or data frame containing the error free covariates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>matrix of regression coefficients
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>covariance matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>variance inflation factor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>proportion of erroneous data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>data distribution: LN = lognormal(default), N=normal
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.outl</code></td>
<td>

<p>threshold value for posterior probabilities of identifying outliers (default=0.5)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides expected values of a set of variables (<code>y1.p,y2.p,...</code> ) according 
to a mixture of two regression models with Gaussian residuals (see <code>ml.est</code>). If no covariates are available 
(<code>x</code> variables), a two component Gaussian mixture is used. Expected values (predictions) are computed
on the base of a set of parameters of appropriate dimensions (<code>B, sigma, lambda,w</code>) and (possibly) 
a matrix (or data frame) containing the error-free <code>x</code> variables. 
</p>
<p>Missing values in the <code>x</code> variables are not allowed. However, robust predictions of <code>y</code> variables are 
also provided when these variables are not observed. A vector of missing pattern (<code>pattern</code>) indicates 
which item is observed and which is missing.  
</p>
<p>For each unit in the data set the posterior probability of being erroneous (<code>tau</code>)  is computed and a
flag (<code>outlier</code>) is provided taking value 0 or 1 depending on whether <code>tau</code>  is greater than the user 
specified threshold  (<code>t.outl</code>).
</p>


<h3>Value</h3>

<p><code>pred.y</code> returns a data frame containing the following columns:<br><br></p>
<table>
<tr style="vertical-align: top;">
<td><code>y1.p,y2.p,...</code></td>
<td>

<p>predicted values for y variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p> posterior probabilities of being contaminated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier </code></td>
<td>
<p> 1 if the observation is classified as an outlier, 0 otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p> non-response patterns for y variables: 0 = missing, 1 = present value</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>"Use of Contamination Models for Selective Editing"</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Parameter estimation with one contaminated variable and one covariate
  data(ex1.data)
# Parameters estimated applying ml.est to \code{ex1.data} 
  B1 &lt;- as.matrix(c(-0.152, 1.215))
  sigma1 &lt;- as.matrix(1.25)
  lambda1 &lt;- 15.5
  w1 &lt;- 0.0479

# Variable prediction
  ypred &lt;- pred.y (y=ex1.data[,"Y1"],  x=ex1.data[,"X1"], B=B1,
          sigma=sigma1, lambda=lambda1, w=w1, model="LN", t.outl=0.5)
# Plot ypred vs Y1
  sel.pairs(cbind(ypred[,1,drop=FALSE],ex1.data[,"Y1",drop=FALSE]),
            outl=ypred[,"outlier"])
</code></pre>


</div>