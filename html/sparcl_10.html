<div class="container">

<table style="width: 100%;"><tr>
<td>KMeansSparseCluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs sparse k-means clustering</h2>

<h3>Description</h3>

<p>This function performs sparse k-means clustering. You must specify a number of clusters K and an L1 bound on w, the feature weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KMeansSparseCluster(x, K=NULL, wbounds = NULL, nstart = 20, silent =
FALSE, maxiter=6, centers=NULL)
## S3 method for class 'KMeansSparseCluster'
plot(x,...)
## S3 method for class 'KMeansSparseCluster'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An nxp data matrix. There are n observations and p features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of clusters desired ("K" in K-means
clustering). Must provide either K or centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wbounds</code></td>
<td>
<p>A single L1 bound on w (the feature weights), or a vector of L1 bounds on w. If wbound is small,
then few features will have non-zero weights. If wbound is large then all
features will have non-zero weights. Should be greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>The number of random starts for the k-means
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Print out progress?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>Optional argument. If you want to run the k-means
algorithm starting from a particular set of clusters, then you can
enter the Kxp matrix of cluster centers here. Default use case
involves taking centers=NULL and instead specifying K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> not used. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We seek a p-vector of weights w (one per feature) and a set of clusters
C1,...,CK that optimize
</p>
<p>$maximize_C1,...,CK,w sum_j w_j BCSS_j$ subject to $||w||_2 &lt;= 1,
||w||_1 &lt;= wbound, w_j &gt;= 0$
</p>
<p>where $BCSS_j$ is the between cluster sum of squares for feature j. An
iterative approach is taken: with w fixed, optimize with respect to
C1,...,CK, and with C1,...,CK fixed, optimize with respect to w. Here,
wbound is a tuning parameter which determines the L1 bound on w.
</p>
<p>The non-zero elements of w indicate features that are used in the sparse clustering.
</p>


<h3>Value</h3>

<p>If wbounds is a vector, then a list with elements as follows (one per
element of wbounds). If
wbounds is just a single value, then elements as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ws</code></td>
<td>
<p>The p-vector of feature weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cs</code></td>
<td>
<p>The clustering obtained.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniela M. Witten and Robert Tibshirani</p>


<h3>References</h3>

<p>Witten and Tibshirani (2009) A framework for feature
selection in clustering.</p>


<h3>See Also</h3>

<p>KMeansSparseCluster.permute,HierarchicalSparseCluster</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data
set.seed(11)
x &lt;- matrix(rnorm(50*70),ncol=70)
x[1:25,1:20] &lt;- x[1:25,1:20]+1
x &lt;- scale(x, TRUE, TRUE)
# choose tuning parameter
km.perm &lt;- KMeansSparseCluster.permute(x,K=2,wbounds=seq(3,7,len=15),nperms=5)
print(km.perm)
plot(km.perm)
# run sparse k-means
km.out &lt;- KMeansSparseCluster(x,K=2,wbounds=km.perm$bestw)
print(km.out)
plot(km.out)
# run sparse k-means for a range of tuning parameter values
km.out &lt;- KMeansSparseCluster(x,K=2,wbounds=seq(1.3,4,len=8))
print(km.out)
plot(km.out)
# Run sparse k-means starting from a particular set of cluster centers
#in the k-means algorithm.
km.out &lt;- KMeansSparseCluster(x,wbounds=2:7,centers=x[c(1,3,5),])
</code></pre>


</div>