<div class="container">

<table style="width: 100%;"><tr>
<td>finalize.report</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Finalize Estimation Report
</h2>

<h3>Description</h3>

<p><code>finalize.report</code> is a secondary function called at the end of the 
estimation runs. It outputs to the report file the final parameter estimates
for structural model parameters, residual variability and secondary parameters
as well as the related statistics (coefficients of variation, confidence
intervals, covariance and correlation matrix). <code>finalize.report</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  finalize.report(problem = NULL,
                  Fit = NULL,
                  files = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt>
<dd>
<p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt>
<dd>
<p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt>
<dd>
<p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt>
<dd>
<p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt>
<dd>
<p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt>
<dd>
<p>the particular treatment identifier.</p>
</dd>
</dl>
</dd>
<dt>method</dt>
<dd>
<p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt>
<dd>
<p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt>
<dd>
<p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt>
<dd>
<p>Model function.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fit</code></td>
<td>
<p>A list containing the following elements:</p>

<dl>
<dt>estimations</dt>
<dd>
<p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt>
<dd>
<p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt>
<dd>
<p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt>
<dd>
<p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt>
<dd>
<p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt>
<dd>
<p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt>
<dd>
<p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt>
<dd>
<p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt>
<dd>
<p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt>
<dd>
<p>The vector of secondary parameter estimates calculated
using the initial estimates of the primary model parameters.</p>
</dd>
<dt>estimates</dt>
<dd>
<p>The vector of secondary parameter estimates calculated
using the final estimates of the primary model parameters.</p>
</dd>
<dt>names</dt>
<dd>
<p>The vector of names of the secondary parameter estimates.</p>
</dd>
<dt>pder</dt>
<dd>
<p>The matrix of partial derivatives for the secondary
parameter estimates.</p>
</dd>
<dt>cov</dt>
<dd>
<p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt>
<dd>
<p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt>
<dd>
<p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt>
<dd>
<p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt>
<dd>
<p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt>
<dd>
<p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt>
<dd>
<p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt>
<dd>
<p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt>
<dd>
<p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt>
<dd>
<p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt>
<dd>
<p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a modified version of <code>Fit</code>, containing the following elements:
</p>

<dl>
<dt>estimations</dt>
<dd>
<p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt>
<dd>
<p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt>
<dd>
<p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt>
<dd>
<p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt>
<dd>
<p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt>
<dd>
<p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt>
<dd>
<p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt>
<dd>
<p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt>
<dd>
<p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt>
<dd>
<p>A vector of secondary parameter estimates.</p>
</dd>
<dt>cov</dt>
<dd>
<p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt>
<dd>
<p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt>
<dd>
<p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>
</dd>
<dt>orderedfixed</dt>
<dd>
<p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted fixed estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>orderedinitial</dt>
<dd>
<p>A data.frame with the same content as
<code>problem$init</code> but sorted by <code>order.param.list</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code>order.parms.list</code>,
</p>


</div>