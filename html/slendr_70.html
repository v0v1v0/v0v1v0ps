<div class="container">

<table style="width: 100%;"><tr>
<td>ts_tracts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract ancestry tracts from a tree sequence (EXPERIMENTAL)</h2>

<h3>Description</h3>

<p>Extract a data frame with coordinates of ancestry tracts from a given tree sequence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ts_tracts(
  ts,
  census,
  squashed = TRUE,
  source = NULL,
  target = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>Tree sequence object of the class <code>slendr_ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>census</code></td>
<td>
<p>Census time. See the documentation linked in the Details for more
information. If a slendr-specific tree sequence was provided as <code>ts</code>,
the census time is expected to be given in slendr model-specific time units,
and must correspond to some gene-flow event encoded by the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squashed</code></td>
<td>
<p>Should ancestry tracts be squashed (i.e., should continuous
tracts that can be traced to different ancestral nodes be merged)? Default
is <code>TRUE</code>. If <code>FALSE</code>, these effectively continuous ancestry
tracts will be split into individual segments, each assigned to a specific
ancestral node ID (recorded in a column <code>ancestor_id</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>From which source population to extract tracts for? if <code>NULL</code>
(the default), ancestry tracts for all populations contributing gene flow
at the census time will be reported. Otherwise, ancestry tracts from only
specified source populations will be extracted. Note that this option is
ignored for non-slendr tree sequences!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Similar purpose as <code>source</code> above, except that it filters
for tracts discovered in the target population(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Should the default summary output of the <code>tspop</code> Python package
be silenced? Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements an R-friendly interface to an algorithm for
extracting ancestry tracts provided by the Python module tspop
<a href="https://tspop.readthedocs.io/en/latest/">https://tspop.readthedocs.io/en/latest/</a> and developed by Georgia Tsambos.
Please make sure to cite the paper which describes the algorithm in
detail: <a href="https://academic.oup.com/bioinformaticsadvances/article/3/1/vbad163/7429395">https://academic.oup.com/bioinformaticsadvances/article/3/1/vbad163/7429395</a>.
For more technical details, see also the tutorial at:
<a href="https://tspop.readthedocs.io/en/latest/basicusage.html">https://tspop.readthedocs.io/en/latest/basicusage.html</a>.
</p>
<p>In general, when using this function on a slendr-generated tree sequence,
please be aware that the output changes slightly to what you would get by
running the pure <code>tspop.get_pop_ancestry()</code> in Python. First,
<code>ts_tracts()</code> populates the output data frame with additional metadata
(such as names of individuals or populations). Additionally, for slendr models,
it is specifically designed to only return ancestry tracts originating to a
an ancestral population which contributed its ancestry during a gene-flow
event which started at a specific time (i.e., scheduled in a model via
the <code>gene_flow()</code>) function. It does not return every single ancestry
tracts present in the tree sequence for every single sample node (and every
single potential ancestry population) as does the <code>tspop.get_pop_ancestry()</code>
Python method.
</p>
<p>That said, when run on a tree sequence which does not originate from a slendr
simulation, the behavior of <code>ts_tracts()</code> is identical to that of the
underlying <code>tspop.get_pop_ancestry()</code>.
</p>
<p>As of the current version of slendr, <code>ts_tracts()</code> only works for
slendr/msprime sequences but not on slendr/SLiM tree sequences. Support for
slendr-generated SLiM tree sequences is in development. Tracts from tree
sequences originating from non-slendr msprime and SLiM simulations are not
restricted in any way and, as mentioned in the previous paragraph,
<code>ts_tracts()</code> in this situation effectively reduces to the standard
<code>tspop.get_pop_ancestry()</code> call.
</p>


<h3>Value</h3>

<p>A data frame containing coordinates of ancestry tracts
</p>


<h3>Examples</h3>

<pre><code class="language-R">
init_env(quiet = TRUE)

# load an example model with an already simulated tree sequence
slendr_ts &lt;- system.file("extdata/models/introgression_msprime.trees", package = "slendr")
model &lt;- read_model(path = system.file("extdata/models/introgression", package = "slendr"))

# load the tree-sequence object from disk
ts &lt;- ts_load(file = slendr_ts, model = model)

# extract Neanderthal ancestry tracts (i.e. those corresponding to the
# census event at the gene-flow time at 55000 kya as scheduled by
# the simulation which produced the tree sequence)
nea_tracts &lt;- ts_tracts(ts, census = 55000, source = "NEA")
nea_tracts
</code></pre>


</div>