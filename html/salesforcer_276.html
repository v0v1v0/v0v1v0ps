<div class="container">

<table style="width: 100%;"><tr>
<td>sf_upsert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Upsert Records</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Upserts one or more new records to your organizationâ€™s data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sf_upsert(
  input_data,
  object_name,
  external_id_fieldname,
  api_type = c("SOAP", "REST", "Bulk 1.0", "Bulk 2.0"),
  guess_types = TRUE,
  control = list(...),
  ...,
  all_or_none = deprecated(),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input_data</code></td>
<td>
<p><code>named vector</code>, <code>matrix</code>, <code>data.frame</code>, or
<code>tbl_df</code>; data can be coerced into a <code>data.frame</code>. If performing an
<code>update</code>, <code>upsert</code>, or <code>delete</code> operation, then one column or
field must be the <code>Id</code> of the record to modify or delete.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object_name</code></td>
<td>
<p><code>character</code>; the name of the Salesforce object that the
function is operating against (e.g. "Account", "Contact", "CustomObject__c").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external_id_fieldname</code></td>
<td>
<p><code>character</code>; string identifying a custom field on the
object that has been set as an "External ID" field. This field is used to reference
objects during upserts to determine if the record already exists in Salesforce or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_type</code></td>
<td>
<p><code>character</code>; one of <code>"REST"</code>, <code>"SOAP"</code>,
<code>"Bulk 1.0"</code>, or <code>"Bulk 2.0"</code> indicating which API to use when
making the request.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess_types</code></td>
<td>
<p><code>logical</code>; indicating whether or not to use <code>col_guess()</code>
to try and cast the data returned in the recordset. If <code>TRUE</code> then
<code>col_guess()</code> is used, if <code>FALSE</code> then all fields will be returned
as character. This is helpful when <code>col_guess()</code> will mangle field values
in Salesforce that you'd like to preserve during translation into a <code>tbl_df</code>,
like numeric looking values that must be preserved as strings ("48.0").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p><code>list</code>; a list of parameters for controlling the behavior of
the API call being used. For more information of what parameters are available
look at the documentation for <code>sf_control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>sf_control</code> or further downstream
to <code>sf_bulk_operation</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_or_none</code></td>
<td>
<p><code>logical</code>; allows a call to roll back all changes unless all
records are processed successfully.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>logical</code>; an indicator of whether to print additional
detail for each API call, which is useful for debugging. More specifically, when
set to <code>TRUE</code> the URL, header, and body will be printed for each request,
along with additional diagnostic information where available.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>tbl_df</code> of records with success indicator
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
n &lt;- 2
new_contacts &lt;- tibble(FirstName = rep("Test", n),
                       LastName = paste0("Contact-Create-", 1:n),
                       My_External_Id__c=letters[1:n])
new_contacts_result &lt;- sf_create(new_contacts, object_name="Contact")

upserted_contacts &lt;- tibble(FirstName = rep("Test", n),
                            LastName = paste0("Contact-Upsert-", 1:n),
                            My_External_Id__c=letters[1:n])
new_record &lt;- tibble(FirstName = "Test",
                     LastName = paste0("Contact-Upsert-", n+1),
                     My_External_Id__c=letters[n+1])
upserted_contacts &lt;- bind_rows(upserted_contacts, new_record)

upserted_contacts_result1 &lt;- sf_upsert(upserted_contacts, 
                                       object_name="Contact", 
                                       "My_External_Id__c")

## End(Not run)
</code></pre>


</div>