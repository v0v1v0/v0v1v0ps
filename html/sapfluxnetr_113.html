<div class="container">

<table style="width: 100%;"><tr>
<td>sfn_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot method for sfn_data class</h2>

<h3>Description</h3>

<p>Plot the desired data from a site object
</p>


<h3>Usage</h3>

<pre><code class="language-R">sfn_plot(
  sfn_data,
  type = c("sapf", "env", "ta", "rh", "vpd", "ppfd_in", "netrad", "sw_in", "ext_rad",
    "ws", "precip", "swc_shallow", "swc_deep"),
  formula_env = NULL,
  solar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sfn_data</code></td>
<td>
<p>sfn_data object to plot. It can be also an sfn_data_multi
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character indicating which data to plot. See Type section for
detailed information about the available values. Ignored if formula is
provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula_env</code></td>
<td>
<p>Right side formula indicating an environmental variable to
plot vs. the sapflow values. If NULL (default), <code>sfn_plot</code> will use
"type" to guess which plot show.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solar</code></td>
<td>
<p>Logical indicating if the solar timestamp must be used instead
of the site timestamp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed on <code>geom_point</code> or
<code>geom_col</code> to modify geometry aesthetics.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object that can be called to see the plot. If input is an
sfn_data_multi object, a list with the plots
</p>


<h3>ggplot plotting system</h3>

<p><code>plot</code> is a base R function which uses the base R plotting system
to show the plot. We prefer the ggplot plotting system, which allow for
storing the plots in objects and can be subjected to further modifications.
This allow the package users to generate rather simple plots that can be
fine tuned afterwards to the user taste. Generating a <code>plot</code>
method for the <code>sfn_data</code> class returning a ggplot object is not
desired (it change the way plot works and can be misleading about the plot
general usage). So, instead, we offer this function, <code>sfn_plot</code>.
</p>


<h3>Type</h3>

<p><code>type</code> argument controls what is going to be plotted. It accepts
the following:
</p>

<ul>
<li>
<p>"sapf": It will plot sapflow data vs. TIMESTAMP
</p>
</li>
<li>
<p>"env": It will plot environmental variables vs. TIMESTMAP
</p>
</li>
<li>
<p>"ta", "rh", "vpd", "ppfd_in", "netrad", "sw_in", "ext_rad",
"ws", "precip", "swc_shallow" and "swc_deep": They will plot
the corresponding variable vs. TIMESTAMP
</p>
</li>
</ul>
<h3>Formula</h3>

<p><code>formula</code> argument can be used to select an environmental variable to
plot versus all the sapflow measurements. Any environmental variable is
allowed, if it exist in the site provided.
</p>


<h3>Geometry</h3>

<p>By default <code>sfn_plot</code> generates plots using <code>geom_point</code>
geometry, except in the case of <code>type = "ws"</code> and
<code>type = "precip"</code> where <code>geom_col</code> is used. These
geometries can be modified with the <code>...</code> argument.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)

# data
data('ARG_TRE', package = 'sapfluxnetr')

# plotting directly
sfn_plot(ARG_TRE, type = 'sapf')

# this could be noisy, you can facet by "Tree" (for sapflow) or by
# "Variable" (for environmental data):
sfn_plot(ARG_TRE, type = 'sapf') +
  facet_wrap(~ Tree)

sfn_plot(ARG_TRE, type = 'env') +
  facet_wrap(~ Variable, scales = 'free_y')

# saving and modifying:
env_plot &lt;- sfn_plot(ARG_TRE, type = 'env', solar = FALSE) +
  facet_wrap(~ Variable, scales = 'free_y')
env_plot + labs(title = 'Environmental variables facet plot')

# formula
sfn_plot(ARG_TRE, formula_env = ~ vpd)

</code></pre>


</div>