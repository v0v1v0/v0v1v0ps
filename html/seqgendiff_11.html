<div class="container">

<table style="width: 100%;"><tr>
<td>ThinDataToDESeqDataSet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converts a ThinData S3 object into a DESeqDataSet S4 object.</h2>

<h3>Description</h3>

<p>The design formula in the resulting DESeqDataSet is just the sum of all
variables in <code>designmat</code> from the ThinData object (except the
intercept term). You should change this design formula if you want to
study other models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ThinDataToDESeqDataSet(obj)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A ThinData S3 object. This is generally output by either
<code>thin_diff</code>, <code>thin_2group</code>,
<code>thin_lib</code>, <code>thin_gene</code>, or
<code>thin_all</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A <code>DESeqDataSet</code> S4
object. This will allow you to insert the simulated
data directly into DESeq2.
</p>


<h3>Author(s)</h3>

<p>David Gerard
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Generate simulated data and modify using thin_diff().
## In practice, you would use real data, not simulated.
set.seed(1)
n &lt;- 10
p &lt;- 1000
Z &lt;- matrix(abs(rnorm(n, sd = 4)))
alpha &lt;- matrix(abs(rnorm(p, sd = 1)))
mat &lt;- round(2^(alpha %*% t(Z) + abs(matrix(rnorm(n * p, sd = 5),
                                            nrow = p,
                                            ncol = n))))
design_perm &lt;- cbind(rep(c(0, 1), length.out = n), runif(n))
coef_perm   &lt;- matrix(rnorm(p * ncol(design_perm), sd = 6), nrow = p)
design_obs  &lt;- matrix(rnorm(n), ncol = 1)
target_cor &lt;- matrix(c(0.9, 0))
thout &lt;- thin_diff(mat            = mat,
                   design_perm    = design_perm,
                   coef_perm      = coef_perm,
                   target_cor     = target_cor,
                   design_obs     = design_obs,
                   permute_method = "hungarian")

## Convert ThinData object to DESeqDataSet object.
seobj &lt;- ThinDataToDESeqDataSet(thout)
class(seobj)

## The "O1" variable in the colData corresponds to design_obs.
## The "P1" and "P2" variables in colData correspond to design_perm.
seobj


</code></pre>


</div>