<div class="container">

<table style="width: 100%;"><tr>
<td>scan.stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial scan statistic</h2>

<h3>Description</h3>

<p><code>scan.stat</code> calculates the spatial scan statistic
for a zone (a set of spatial regions).  The statistic is
the log of the likelihood ratio test statistic of the
chosen distribution.  If <code>type = "poisson"</code> and
<code>a</code> is more than zero, this statistic is penalized.
See references.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scan.stat(
  yin,
  ein = NULL,
  eout = NULL,
  ty,
  type = "poisson",
  popin = NULL,
  tpop = NULL,
  a = 0,
  shape = 1,
  yout = NULL,
  popout = NULL
)

stat.poisson(yin, yout, ein, eout, a = 0, shape = 1)

stat.binom(yin, yout, ty, popin, popout, tpop)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yin</code></td>
<td>
<p>The total number of cases in the zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ein</code></td>
<td>
<p>The expected number of cases in the zone.
Conventionally, this is the estimated overall disease
risk across the study area, multiplied by the total
population size of the zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eout</code></td>
<td>
<p>The expected number of cases outside the
zone.  This should be <code>ty - ein</code> and is computed
automatically if not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ty</code></td>
<td>
<p>The total number of cases in the study area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of scan statistic to implement. The
default choice are <code>"poisson"</code>.  The other choice
is <code>"binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popin</code></td>
<td>
<p>The total population in the zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpop</code></td>
<td>
<p>The total population in the study area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A tuning parameter for the adjusted
log-likelihood ratio.  See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>The shape of the ellipse, which is the ratio
of the length of the longest and shortest axes of the
ellipse.  The default is 1, meaning it is a circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yout</code></td>
<td>
<p>The observed number of cases outside the
zone.  This should be <code>ty - yin</code> and is computed
automatically if not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popout</code></td>
<td>
<p>The population outside the zone.  This
should be <code>tpop - popin</code> and is computed
automatically if not provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of scan statistics.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Poisson scan statistic:  Kulldorff, M. (1997) A spatial
scan statistic. Communications in Statistics - Theory and
Methods, 26(6): 1481-1496,
&lt;doi:10.1080/03610929708831995&gt;
</p>
<p>Penalized Poisson scan statistic: Kulldorff, M., Huang,
L., Pickle, L. and Duczmal, L. (2006) An elliptic spatial
scan statistic. Statistics in Medicine, 25:3929-3943.
&lt;doi:10.1002/sim.2490&gt;
</p>
<p>Binomial scan statistic: Duczmal, L. and Assuncao, R.
(2004) A simulated annealing strategy for the detection
of arbitrarily shaped spatial clusters. Computational
Statistics &amp; Data Analysis, 45(2):269-286.
&lt;doi:10.1016/S0167-9473(02)00302-X&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># New York leukemia data
# total cases
ty &lt;- 552
# total population
tpop &lt;- 1057673

# poisson example with yin = 106 and ein = 62.13
scan.stat(yin = 106, ty = ty, ein = 62.13)
stat.poisson(
  yin = 106, yout = 552 - 106,
  ein = 62.13, eout = 552 - 62.13
)

# binomial example with yin = 41 and popin = 38999
scan.stat(
  yin = 41, ty = ty,
  popin = 38999, tpop = tpop, type = "binomial"
)
stat.binom(41, ty - 41, ty, 38999, tpop - 38999, tpop)
</code></pre>


</div>