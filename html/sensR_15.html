<div class="container">

<table style="width: 100%;"><tr>
<td>discrimSS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensory discrimination sample size calculation</h2>

<h3>Description</h3>

<p>Computes the sample size for a difference or similarity test for a
sensory discrimination experiment using the binomial distribution.
<code>d.primeSS</code> is a convenience function that calls
<code>discrimSS</code> but has arguments in terms of d-prime rather than
pd, the expected proportion of discriminators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discrimSS(pdA, pd0 = 0, target.power = 0.90, alpha = 0.05,
          pGuess = 1/2, test = c("difference", "similarity"),
          statistic = c("exact", "stable.exact", "both.exact",
           "normal", "cont.normal"))

d.primeSS(d.primeA, d.prime0 = 0, target.power = 0.90, alpha = 0.05,
          method = c("duotrio", "tetrad", "threeAFC", "twoAFC",
            "triangle", "hexad", "twofive", "twofiveF"),
          double = FALSE,
          test = c("difference", "similarity"),
          statistic = c("exact", "stable.exact", "both.exact",
           "normal", "cont.normal"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdA</code></td>
<td>
<p>the probability of discrimination for the model under the
alternative hypothesis; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.primeA</code></td>
<td>
<p>d-prime for the model under the
alternative hypothesis; non-negative numerical scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd0</code></td>
<td>
<p>the probability of discrimination under the
null hypothesis; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.prime0</code></td>
<td>
<p>d-prime under the null hypothesis; non-negative
numerical scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.power</code></td>
<td>
<p>the desired power for the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the type I level of the test; scalar between zero and
one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the discrimination protocol for which the sample size
should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>double</code></td>
<td>
<p>should the 'double' variant of the discrimination protocol
be used? Logical scalar. Currently not implemented for "twofive",
"twofiveF", and "hexad".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pGuess</code></td>
<td>
<p>the guessing probability for the discrimination
protocol, e.g. 1/2 for duo-trio and 2-AFC, 1/3 for
triangle, tetrad and 3-AFC, 1/10 for two-out-of-five and hexad
and 2/5 for two-out-of-five with forgiveness;; scalar between zero and one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the type of one-sided binomial test (direction of the
alternative hypothesis): "difference" corresponds "greater" and
"similarity" corresponds to "less"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>options are explained in the Details section below</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For difference tests <code>pdA</code> or <code>d.primeA</code> (the sensory
difference under the alternative hypothesis) has to be larger than
<code>pd0</code> or <code>d.prime0</code> (the sensory  difference under the null
hypothesis). The sample size of the standard one-tailed difference
test where the null hypothesis of "no difference" is obtained with
<code>pd0 = 0</code> or <code>d.prime0 = 0</code>.
</p>
<p>For similarity tests it is required that <code>pd0</code> &gt; <code>pdA</code> or
equivalently that <code>d.prime0</code> &gt; <code>d.primeA</code>. Here, the
interval [0, <code>pdA</code>] or [0, <code>d.primeA</code>]
is the similarity region covering sensory differences for which we
would say that the products are similar.
</p>
<p>The probability of a correct answer under the null hypothesis is
given by <code>pd0 + pGuess * (1 - pd0)</code>. Similarly, the probability
of a correct answer under the alternative hypothesis is given by
<code>pdA + pGuess * (1 - pdA)</code>.
</p>
<p>The <code>statistic</code> argument:
</p>

<ul>
<li> <p><code>"exact"</code>  
is the conventional sample size for the exact binomial test:
The smallest sample size that gives the desired power
(<code>target.power</code>) at the given
significance level. Ususally slightly higher sample sizes will not
have the desired power, however. This is due to the non-monotonic
behavior of power as a function of sample size.
</p>
</li>
<li> <p><code>"stable.exact"</code> 
is so-called stable exact sample size proposed by Ennis and
Jesionka (2011) which has the property that no larger sample sizes
has a power less than the <code>target.power</code>.
</p>
</li>
<li> <p><code>"both.exact"</code> 
returns both <code>exact</code> and <code>stable.exact</code>
sample sizes
</p>
</li>
<li> <p><code>"normal"</code> 
is the normal approximation to the exact binomial sample size
without any continuity adjustment. This usually provides a sample
size that is smaller than the sample size for the exact binomial
test.
</p>
</li>
<li> <p><code>"cont.normal"</code> 
is the continuity adjusted normal approximation to
the sample size for the exact binomial test. This sample size is
usually closer to the exact sample size than the unadjusted
approximation and usually higher than the unadjusted
approximation.
</p>
</li>
</ul>
<p>If the sample size based on the continuity adjusted normal
approximation is larger than 10,000, the function returns the normal
approximation and issues a warning.
</p>


<h3>Value</h3>

<p>The sample size; an integer.
</p>


<h3>Author(s)</h3>

<p>Per Bruun Brockhoff and Rune Haubo B Christensen</p>


<h3>References</h3>

<p>Brockhoff, P.B. and Christensen, R.H.B (2010). Thurstonian
models for sensory discrimination tests as generalized linear models.
Food Quality and Preference, 21, pp. 330-338.
</p>
<p>Ennis, J.M. and V. Jesionka (2011). The power of sensory
discrimination methods revisited. Journal of Sensory Studies, 26,
pp. 371-382.
</p>


<h3>See Also</h3>

<p><code>AnotA</code>, <code>discrimPwr</code>,
<code>samediff</code>, <code>findcr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Finding the smallest necessary sample size:
discrimSS(pdA = 0.5, pd0 = 0, target.power = 0.80, alpha = 0.05,
   pGuess = 1/2, test = "difference", statistic = "exact")
## The stable-exact sample size is larger:
discrimSS(pdA = 0.5, pd0 = 0, target.power = 0.80, alpha = 0.05,
   pGuess = 1/2, test = "difference", statistic = "stable.exact")

## Give identical results:
pd &lt;- coef(rescale(d.prime = 1, method = "twoAFC"))$pd
discrimSS(pdA = pd, pd0 = 0, target.power = 0.90, alpha = 0.05,
   pGuess = 1/2, test = "difference", statistic = "exact")
d.primeSS(1, target.power = 0.90, method = "twoAFC")

## A similarity example:
discrimSS(pdA = 0.1, pd0 = 0.2, target.power = 0.80, alpha = 0.05,
   pGuess = 1/2, test = "similarity", statistic = "exact")

</code></pre>


</div>