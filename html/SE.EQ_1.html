<div class="container">

<table style="width: 100%;"><tr>
<td>SE.EQ-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
SE-Test for Equivalence
</h2>

<h3>Description</h3>

<p>Implements the SE-test for equivalence
    according to Hoffelder et al. (2015) &lt;DOI:10.1080/10543406.2014.920344&gt;.
    The SE-test for equivalence is a multivariate two-sample equivalence test. 
    Distance measure of the test is the sum of standardized differences
    between the expected values or in other words: the sum of effect sizes (SE)
    of all components of the two multivariate samples. 
    The test is an asymptotically valid test for normally distributed data 
    (see Hoffelder et al.,2015).
    The function SE.EQ() implements the SE-test for equivalence 
    according to Hoffelder et al. (2015).
    The function SE.EQ.dissolution.profiles() implements a variant 
    of the SE-test for equivalence for similarity analyses of dissolution 
    profiles as mentioned in Suarez-Sharp et al.(2020) 
    &lt;DOI:10.1208/s12248-020-00458-9&gt;). The equivalence margin used in 
    SE.EQ.dissolution.profiles() is analogically defined as for the T2EQ
    approach according to Hoffelder (2019) &lt;DOI:10.1002/bimj.201700257&gt;) 
    by means of a systematic shift in location
    of 10 [% of label claim] of both dissolution profile populations. 
    SE.EQ.dissolution.profiles() checks whether the weighted mean of the 
    differences of the expected values of both dissolution profile populations 
    is statistically significantly smaller than 10 [% of label claim]. The 
    weights are built up by the inverse variances.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> SE.EQ</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> SE-Test for Equivalence</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2020-10-06</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Thomas Hoffelder</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Thomas Hoffelder &lt;thomas.hoffelder@boehringer-ingelheim.com&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Implements the SE-test for equivalence
    according to Hoffelder et al. (2015) &lt;DOI:10.1080/10543406.2014.920344&gt;.
    The SE-test for equivalence is a multivariate two-sample equivalence test. 
    Distance measure of the test is the sum of standardized differences
    between the expected values or in other words: the sum of effect sizes (SE)
    of all components of the two multivariate samples. 
    The test is an asymptotically valid test for normally distributed data 
    (see Hoffelder et al.,2015).
    The function SE.EQ() implements the SE-test for equivalence 
    according to Hoffelder et al. (2015).
    The function SE.EQ.dissolution.profiles() implements a variant 
    of the SE-test for equivalence for similarity analyses of dissolution 
    profiles as mentioned in Suarez-Sharp et al.(2020) 
    &lt;DOI:10.1208/s12248-020-00458-9&gt;). The equivalence margin used in 
    SE.EQ.dissolution.profiles() is analogically defined as for the T2EQ
    approach according to Hoffelder (2019) &lt;DOI:10.1002/bimj.201700257&gt;) 
    by means of a systematic shift in location
    of 10 [% of label claim] of both dissolution profile populations. 
    SE.EQ.dissolution.profiles() checks whether the weighted mean of the 
    differences of the expected values of both dissolution profile populations 
    is statistically significantly smaller than 10 [% of label claim]. The 
    weights are built up by the inverse variances.</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> MASS</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
SE.EQ                   The SE-test for equivalence
SE.EQ-package           SE-Test for Equivalence
SE.EQ.dissolution.profiles
                        The SE-test for equivalence for dissolution
                        profile similarity analyses
ex_data_JoBS            Example dataset from Hoffelder et al. (2015)
</pre>


<h3>Author(s)</h3>

<p>Thomas Hoffelder
</p>
<p>Maintainer: Thomas Hoffelder &lt;thomas.hoffelder@boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>EMA (2010). Guidance on the Investigation of Bioequivalence.
European Medicines Agency, CHMP, London. Doc. 
Ref.: CPMP/EWP/QWP/1401/98 Rev. 1/ Corr **. 
URL: <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>
</p>
<p>FDA (1997). Guidance for Industry: Dissolution Testing of Immediate Release 
Solid Oral Dosage Forms. 
Food and Drug Administration FDA, CDER, Rockville.
URL: <a href="https://www.fda.gov/media/70936/download">https://www.fda.gov/media/70936/download</a>
</p>
<p>Hoffelder, T., Goessl, R., Wellek, S. (2015). Multivariate Equivalence Tests 
for Use in Pharmaceutical Development. 
<em>Journal of Biopharmaceutical Statistics</em>, 25:3, 417-437.
URL: <a href="http://dx.doi.org/10.1080/10543406.2014.920344">http://dx.doi.org/10.1080/10543406.2014.920344</a>
</p>
<p>Hoffelder, T. (2019) Equivalence analyses of dissolution profiles with the 
Mahalanobis distance. 
<em>Biometrical Journal</em>, 61:5, 1120-1137. 
URL: <a href="https://doi.org/10.1002/bimj.201700257">https://doi.org/10.1002/bimj.201700257</a>
</p>
<p>Suarez-Sharp, S., Abend, A., Hoffelder, T., Leblond, D., Delvadia, P., Kovacs, 
E., Diaz, D.A. (2020). In Vitro Dissolution Profiles Similarity Assessment in 
Support of Drug Product Quality: What, How, When - Workshop Summary Report. 
<em>The AAPS Journal</em>, 22:74.
URL: <a href="http://dx.doi.org/10.1208/s12248-020-00458-9">http://dx.doi.org/10.1208/s12248-020-00458-9</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A reproduction of the three-dimensional SE example evaluation 
# in Hoffelder et al. (2015) can be done with the following code:


data(ex_data_JoBS)
REF_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='REF'), ]
                  [c("Diss_15_min","Diss_20_min","Diss_25_min")])
TEST_JoBS &lt;- cbind(ex_data_JoBS[ which(ex_data_JoBS$Group=='TEST'), ]
                   [c("Diss_15_min","Diss_20_min","Diss_25_min")])
equivalence_margin_SE_JoBS &lt;- 0.74^2
test_SE_JoBS &lt;- SE.EQ(X=REF_JoBS
                      , Y=TEST_JoBS
                      , eq_margin=equivalence_margin_SE_JoBS
                      , print.results = TRUE)


# Apart from simulation errors, a recalculation of the SE results 
# of some parts (normal distribution only) of the simulation study in 
# Hoffelder et al. (2015) can be done with the following code. Please note that 
# the simulation takes approximately 20 minutes for 50.000 simulation 
# runs (number_of_simu_runs &lt;- 50000). To shorten calculation time for 
# test users, number_of_simu_runs is set to 100 here and can/should be adapted.
# In the result of the simulation the variable empirical.size.se presents the
# simulated size obtained by function \code{SE.EQ()} whereas variable 
# empirical.size.se.disso shows the
# simulated size obtained by function \code{SE.EQ.dissolution.profiles()}. 
# A detailed analysis of the operating characteristics of the SE variant 
# implemented in \code{SE.EQ.dissolution.profiles()} is the content of 
# a future paper.

library(MASS)
number_of_simu_runs &lt;- 100
set.seed(2020)

mu1 &lt;- c(41,76,97)
mu2 &lt;- mu1 - c(10,10,10)
SIGMA_1 &lt;- matrix(data = c(537.4 , 323.8 , 91.8 ,
                           323.8 , 207.5 , 61.7 ,
                           91.8  , 61.7  , 26.1) ,ncol = 3)
SIGMA_2 &lt;- matrix(data = c(324.1 , 233.6 , 24.5 ,
                           233.6 , 263.5 , 61.4 ,
                           24.5  , 61.4  , 32.5) ,ncol = 3)
SIGMA   &lt;- matrix(data = c(430.7 , 278.7 , 58.1 ,
                           278.7 , 235.5 , 61.6 ,
                           58.1  , 61.6  , 29.3) ,ncol = 3)


SIMULATION_SIZE_SE &lt;- function(disttype , Hom , Var , mu_1 , mu_2 
                               ,  n_per_group , n_simus ) {
  
  n_success_SE        &lt;- 0
  n_success_SE_disso  &lt;- 0
  if 	( Hom == "Yes" ) 	{
    COVMAT_1 &lt;- SIGMA
    COVMAT_2 &lt;- SIGMA
  }
  else 	   {
    COVMAT_1 &lt;- SIGMA_1
    COVMAT_2 &lt;- SIGMA_2
  } 
  if 	( Var == "Low" ) 	{
    COVMAT_1 &lt;- COVMAT_1 / 4
    COVMAT_2 &lt;- COVMAT_2 / 4
  }
  
  d &lt;- ncol(COVMAT_1)
  Mean_diff &lt;- mu_1 - mu_2                    # Difference of both exp. values
  vars_X      &lt;- diag(COVMAT_1)               #  variances of first sample
  vars_Y      &lt;- diag(COVMAT_2)               #  variances of second sample
  dist_SE     &lt;- sum( (Mean_diff * Mean_diff) / (0.5 * (vars_X + vars_Y) ) )   
     # true SE distance and equivalence margin for SE.EQ
  
  
  if 	( n_per_group == 10 ) 	{
    cat("Expected value sample 1:",mu_1,"\n",
        "Expected value sample 2:",mu_2,"\n",
        "Covariance matrix sample 1:",COVMAT_1,"\n",
        "Covariance matrix sample 2:",COVMAT_2,"\n",
        "EM_SE:",dist_SE,"\n")
  }  
  
  for (i in 1:n_simus)  {
    if 	( disttype == "Normal" ) 	{
      REF &lt;- mvrnorm(n = n_per_group, mu=mu_1, Sigma=COVMAT_1)
      TEST&lt;- mvrnorm(n = n_per_group, mu=mu_2, Sigma=COVMAT_2)
    }
    n_success_SE_disso  &lt;- n_success_SE_disso + 
                            SE.EQ.dissolution.profiles( X = REF ,
                                                        Y = TEST , 
                                                        print.results = FALSE
                                                      )$testresult.num
    n_success_SE        &lt;- n_success_SE   + 
                            SE.EQ( X=REF , 
                                   Y=TEST , 
                                   eq_margin = dist_SE , 
                                   print.results = FALSE
                                  )$testresult.num
  }
  empirical_succ_prob_SE        &lt;- n_success_SE / n_simus  
  empirical_succ_prob_SE_disso  &lt;- n_success_SE_disso / n_simus  
  simuresults  &lt;- data.frame(dist = disttype , Hom = Hom , Var = Var 
                     , dimension = d , em_se = dist_SE 
                     , sample.size = n_per_group 
                     , empirical.size.se = empirical_succ_prob_SE
                     , empirical.size.se.disso = empirical_succ_prob_SE_disso)
}

SIMULATION_LOOP_SAMPLE_SIZE &lt;- function(disttype , Hom , Var 
                                        , mu_1 , mu_2 ,  n_simus ) {
  
  run_10  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 10 , n_simus = n_simus) 
  run_30  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 30 , n_simus = n_simus) 
  run_50  &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 50 , n_simus = n_simus) 
  run_100 &lt;- SIMULATION_SIZE_SE(disttype = disttype , Hom = Hom , Var = Var 
                                  , mu_1 = mu_1 , mu_2 = mu_2 
                                  , n_per_group = 100 , n_simus = n_simus) 
  RESULT_MATRIX &lt;- rbind(run_10 , run_30 , run_50 , run_100)
  RESULT_MATRIX                               
}

simu_1 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "High" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_2 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "Yes" 
                                      , Var = "Low" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_3 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "High" , mu_1 = mu1  , mu_2 = mu2
                                      , n_simus = number_of_simu_runs)
simu_4 &lt;- SIMULATION_LOOP_SAMPLE_SIZE(disttype = "Normal", Hom = "No" 
                                      , Var = "Low" , mu_1 = mu1  , mu_2 = mu2 
                                      , n_simus = number_of_simu_runs)

FINAL_RESULT &lt;- rbind(simu_1 , simu_2 , simu_3 , simu_4)

cat("******  Simu results n_simu_runs: ",number_of_simu_runs,"   ***** \n")
FINAL_RESULT
</code></pre>


</div>