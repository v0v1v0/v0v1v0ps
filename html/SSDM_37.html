<div class="container">

<table style="width: 100%;"><tr>
<td>stacking</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stack different ensemble SDMs in an SSDM</h2>

<h3>Description</h3>

<p>This is a function to stack several ensemble SDMs in an SSDM. The function
takes as inputs several S4 Ensemble.SDM class objects produced
with <code>ensemble_modelling</code> or <code>ensemble</code> functions. The
function returns an S4 Stacked.SDM class object containing the
local species richness map, the between-algorithm variance map, and all
evaluation tables coming with (model evaluation, algorithm evaluation,
algorithm correlation matrix and variable importance), and a list of ensemble
SDMs for each species (see <code>ensemble_modelling</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stacking(
  esdm,
  ...,
  name = NULL,
  method = "pSSDM",
  rep.B = 1000,
  Env = NULL,
  range = NULL,
  endemism = c("WEI", "Binary"),
  eval = TRUE,
  uncertainty = TRUE,
  verbose = TRUE,
  GUI = FALSE
)

## S4 method for signature 'Ensemble.SDM'
stacking(
  esdm,
  ...,
  name = NULL,
  method = "pSSDM",
  rep.B = 1000,
  Env = NULL,
  range = NULL,
  endemism = c("WEI", "Binary"),
  eval = TRUE,
  uncertainty = TRUE,
  verbose = TRUE,
  GUI = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>esdm, ...</code></td>
<td>
<p>character. Ensemble SDMs to be stacked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character. Optional name given to the final SSDM produced (by
default 'Species.SDM').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character. Define the method used to create the local species
richness map (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep.B</code></td>
<td>
<p>integer. If the method used to create the local species richness
is the random bernoulli (<strong>Bernoulli</strong>), rep.B parameter defines the number of
repetitions used to create binary maps for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Env</code></td>
<td>
<p>raster object. Stacked raster object of environmental variables
(can be processed first by <code>load_var</code>). Needed only for stacking
method using probability ranking from richness (<strong>PRR</strong>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>integer. Set a value of range restriction (in pixels) around
presences occurrences on habitat suitability maps (all further points will
have a null probability, see Crisp et al (2011) in references). If NULL, no
range restriction will be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endemism</code></td>
<td>
<p>character. Define the method used to create an endemism map
(see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval</code></td>
<td>
<p>logical. If set to FALSE, disable stack evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty</code></td>
<td>
<p>logical. If set to TRUE, generates an uncertainty map and
an algorithm correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If set to TRUE, allows the function to print text in
the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GUI</code></td>
<td>
<p>logical. Don't take that argument into account (parameter for the
user interface).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Methods:</strong> Choice of the method used to compute the local
species richness map (see Calabrese et al. (2014) and D'Amen et al (2015) for
more informations, see reference below): </p>
<dl>
<dt>pSSDM</dt>
<dd>
<p>sum
probabilities of habitat suitability maps</p>
</dd>
<dt>Bernoulli</dt>
<dd>
<p>draw repeatedly
from a Bernoulli distribution</p>
</dd>
<dt>bSSDM</dt>
<dd>
<p>sum the binary map obtained with
the thresholding (depending on the metric of the
ESDM).</p>
</dd>
<dt>MaximumLikelihood</dt>
<dd>
<p>adjust species richness of the model by
linear regression</p>
</dd>
<dt>PRR.MEM</dt>
<dd>
<p>model richness with a macroecological model
(MEM) and adjust each ESDM binary map by ranking habitat suitability and
keeping as much as predicted richness of the MEM</p>
</dd>
<dt>PRR.pSSDM</dt>
<dd>
<p>model
richness with a pSSDM and adjust each ESDM binary map by ranking habitat
suitability and keeping as much as predicted richness of the pSSDM</p>
</dd>
</dl>
<p><strong>Endemism:</strong> Choice of the method used to compute the endemism map
(see Crisp et al. (2001) for more information, see reference below):
</p>
<dl>
<dt>NULL</dt>
<dd>
<p>No endemism map</p>
</dd>
<dt>WEI</dt>
<dd>
<p>(Weighted Endemism Index)
Endemism map built by counting all species in each cell and weighting each
by the inverse of its range</p>
</dd> <dt>CWEI</dt>
<dd>
<p>(Corrected Weighted Endemism Index)
Endemism map built by dividing the weighted endemism index by the total
count of species in the cell.</p>
</dd>
</dl>
<p>First string of the character is the method
either WEI or CWEI, and in those cases second string of the vector is used
to precise range calculation, whether the total number of occurrences
<strong>'NbOcc'</strong> whether the surface of the binary map species distribution
<strong>'Binary'</strong>.
</p>


<h3>Value</h3>

<p>an S4 Stacked.SDM class object viewable with the
<code>plot.model</code> function.
</p>


<h3>References</h3>

<p>M. D'Amen, A. Dubuis, R. F. Fernandes, J. Pottier, L. Pelissier, &amp;
A Guisan (2015) "Using species richness and functional traits prediction to
constrain assemblage predicitions from stacked species distribution models"
<em>Journal of Biogeography</em> 42(7):1255-1266
<a href="http://doc.rero.ch/record/235561/files/pel_usr.pdf">http://doc.rero.ch/record/235561/files/pel_usr.pdf</a>
</p>
<p>J.M. Calabrese, G. Certain, C.  Kraan, &amp; C.F. Dormann (2014) "Stacking
species distribution  models  and  adjusting  bias  by linking them to
macroecological models." <em>Global Ecology and Biogeography</em> 23:99-112
<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/geb.12102">https://onlinelibrary.wiley.com/doi/full/10.1111/geb.12102</a>
</p>
<p>M. D. Crisp, S. Laffan, H. P. Linder &amp; A. Monro (2001) "Endemism in the
Australian flora"  <em>Journal of Biogeography</em> 28:183-198
<a href="http://biology-assets.anu.edu.au/hosted_sites/Crisp/pdfs/Crisp2001_endemism.pdf">http://biology-assets.anu.edu.au/hosted_sites/Crisp/pdfs/Crisp2001_endemism.pdf</a>
</p>
<p>C. Liu, P. M. Berry, T. P. Dawson,  R. &amp; G. Pearson (2005) "Selecting
thresholds of occurrence in the prediction of species distributions."
<em>Ecography</em> 28:85-393
<a href="http://www.researchgate.net/publication/230246974_Selecting_Thresholds_of_Occurrence_in_the_Prediction_of_Species_Distributions">http://www.researchgate.net/publication/230246974_Selecting_Thresholds_of_Occurrence_in_the_Prediction_of_Species_Distributions</a>
</p>


<h3>See Also</h3>

<p><code>stack_modelling</code> to build SSDMs.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Loading data
data(Env)
data(Occurrences)
Occ1 &lt;- subset(Occurrences, Occurrences$SPECIES == 'elliptica')
Occ2 &lt;- subset(Occurrences, Occurrences$SPECIES == 'gracilis')

# SSDM building
ESDM1 &lt;- ensemble_modelling(c('CTA', 'SVM'), Occ1, Env, rep = 1,
                           Xcol = 'LONGITUDE', Ycol = 'LATITUDE',
                           name = 'elliptica', ensemble.thresh = c(0.6))
ESDM2 &lt;- ensemble_modelling(c('CTA', 'SVM'), Occ2, Env, rep = 1,
                           Xcol = 'LONGITUDE', Ycol = 'LATITUDE',
                           name = 'gracilis', ensemble.thresh = c(0.6))
SSDM &lt;- stacking(ESDM1, ESDM2)

# Results plotting
plot(SSDM)

## End(Not run)

</code></pre>


</div>