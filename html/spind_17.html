<div class="container">

<table style="width: 100%;"><tr>
<td>scaleWMRR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scaling by wavelet multiresolution regression (WMRR)</h2>

<h3>Description</h3>

<p>scaleWMRR performs a scale-specific regression based on a
wavelet multiresolution analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scaleWMRR(
  formula,
  family,
  data,
  coord,
  scale = 1,
  detail = TRUE,
  wavelet = "haar",
  wtrafo = "dwt",
  b.ini = NULL,
  pad = list(),
  control = list(),
  moran.params = list(),
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>With specified notation according to names in data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p><code>gaussian</code>, <code>binomial</code>, or <code>poisson</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>Corresponding coordinates which have to be integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>0 (which is equivalent to GLM) or
higher integers possible (limit depends on sample size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detail</code></td>
<td>
<p>Remove smooth wavelets? If <code>TRUE</code>, only detail components are analyzed.
If set to <code>FALSE</code>, smooth and detail components are analyzed. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wavelet</code></td>
<td>
<p>Type of wavelet: <code>haar</code> or <code>d4</code> or <code>la8</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtrafo</code></td>
<td>
<p>Type of wavelet transform: <code>dwt</code> or <code>modwt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.ini</code></td>
<td>
<p>Initial parameter values. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>A list of parameters for padding wavelet coefficients.
</p>

<ul>
<li>
<p>padform - 0, 1, and 2 are possible.
<code>padform</code> is automatically set to
0 when either <code>level</code>=0 or
the <code>formula</code> includes an intercept and has a non-<code>gaussian</code>
<code>family</code>.
</p>

<ul>
<li>
<p>0 - Padding with 0s.
</p>
</li>
<li>
<p>1 - Padding with mean values.
</p>
</li>
<li>
<p>2 - Padding with mirror values.
</p>
</li>
</ul>
</li>
<li>
<p>padzone - Factor for expanding the padding zone
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of parameters for controlling the fitting process.
</p>

<ul>
<li>
<p><code>eps</code> - Positive convergence tolerance. Smaller values of
<code>eps</code> provide better parameter estimates, but also reduce the probability
of the iterations converging. In case of issues with convergence, test larger
values of <code>eps</code>. Default is 10^-5.
</p>
</li>
<li>
<p><code>denom.eps</code> - Default is 10^-20.
</p>
</li>
<li>
<p><code>itmax</code> - Integer giving the maximum number of iterations.
Default is 200.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moran.params</code></td>
<td>
<p>A list of parameters for calculating Moran's I.
</p>

<ul>
<li>
<p><code>lim1</code> - Lower limit for first bin. Default is 0.
</p>
</li>
<li>
<p><code>increment</code> - Step size for calculating Moran's I. Default is 1.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>A logical value indicating whether to print parameter estimates
to the console</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits generalized linear models while taking the
two-dimensional grid structure of
datasets into account. The following error distributions (in
conjunction with appropriate link functions) are allowed: <code>gaussian</code>,
<code>binomial</code>, or <code>poisson</code>. The model provides scale-specific
results for data sampled on a contiguous geographical area. The
dataset is assumed to be regular gridded and the grid cells are
assumed to be square. A function from the package 'waveslim' is used
for the wavelet transformations (Whitcher, 2005).
Furthermore, this function requires that <strong>all predictor variables
be continuous</strong>.
</p>


<h3>Value</h3>

<p>scaleWMRR returns a list containing the following elements
</p>

<dl>
<dt><code>call</code></dt>
<dd>
<p>Model call</p>
</dd>
<dt><code>b</code></dt>
<dd>
<p>Estimates of regression parameters</p>
</dd>
<dt><code>s.e.</code></dt>
<dd>
<p>Standard errors of the parameter estimates</p>
</dd>
<dt><code>z</code></dt>
<dd>
<p>Z values (or corresponding values for statistics)</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p>p-values for each parameter estimate</p>
</dd>
<dt><code>df</code></dt>
<dd>
<p>Degrees of freedom</p>
</dd>
<dt><code>fitted</code></dt>
<dd>
<p>Fitted values</p>
</dd>
<dt><code>resid</code></dt>
<dd>
<p>Pearson residuals</p>
</dd>
<dt><code>converged</code></dt>
<dd>
<p>Logical value whether the procedure converged</p>
</dd>
<dt><code>trace</code></dt>
<dd>
<p>Logical. If TRUE:</p>
</dd>
</dl>
<ul>
<li>
<p><code>ac.glm</code> Autocorrelation of glm.residuals
</p>
</li>
<li>
<p><code>ac</code> Autocorrelation of wavelet.residuals
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Gudrun Carl
</p>


<h3>References</h3>

<p>Carl G, Doktor D, Schweiger O, Kuehn I (2016)
Assessing relative variable importance across different spatial
scales: a two-dimensional wavelet analysis.
Journal of Biogeography 43: 2502-2512.
</p>
<p>Whitcher, B. (2005) Waveslim: basic wavelet routines for one-, two-
and three-dimensional signal processing. R package version 1.5.
</p>


<h3>See Also</h3>

<p><span class="pkg">waveslim</span>,<code>mra.2d</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(carlinadata)
coords &lt;- carlinadata[ ,4:5]

## Not run: 

# scaleWMRR at scale = 0 is equivalent to GLM

ms0 &lt;- scaleWMRR(carlina.horrida ~ aridity + land.use,
                 family = "poisson",
                 data = carlinadata,
                 coord = coords,
                 scale = 0,
                 trace = TRUE)

# scale-specific regressions for detail components
ms1 &lt;- scaleWMRR(carlina.horrida ~ aridity + land.use,
                 family = "poisson",
                 data = carlinadata,
                 coord = coords,
                 scale = 1,
                 trace = TRUE)

ms2 &lt;- scaleWMRR(carlina.horrida ~ aridity + land.use,
                 family = "poisson",
                 data = carlinadata,
                 coord = coords,
                 scale = 2,
                 trace = TRUE)

ms3&lt;- scaleWMRR(carlina.horrida ~ aridity + land.use,
                 family = "poisson",
                 data = carlinadata,
                 coord = coords,
                 scale = 3,
                 trace = TRUE)


## End(Not run)
</code></pre>


</div>