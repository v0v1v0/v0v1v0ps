<div class="container">

<table style="width: 100%;"><tr>
<td>slurm_available</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R wrappers for <em>Slurm</em> commands</h2>

<h3>Description</h3>

<p>The functions <code>sbatch</code>, <code>scancel</code>, <code>squeue</code>, <code>sacct</code>, and <code>slurm.conf</code> are
wrappers of calls to Slurm functions via system2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">slurm_available()

squeue(x = NULL, ...)

## Default S3 method:
squeue(x = NULL, ...)

## S3 method for class 'slurm_job'
squeue(x, ...)

scancel(x = NULL, ...)

## Default S3 method:
scancel(x = NULL, ...)

## S3 method for class 'slurm_job'
scancel(x = NULL, ...)

sacct(x, ...)

## Default S3 method:
sacct(x = NULL, brief = TRUE, parsable = TRUE, allocations = TRUE, ...)

## S3 method for class 'slurm_job'
sacct(x, ...)

slurm.conf()

SchedulerParameters()

sacct_(x = NULL, ..., no_sacct = FALSE)

sbatch(x, wait = FALSE, submit = TRUE, ...)

## S3 method for class 'slurm_job'
sbatch(x, wait = FALSE, submit = TRUE, ...)

## S3 method for class 'character'
sbatch(x, wait = FALSE, submit = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either an object of class <code>slurm_job</code>, or, in some cases, an
integer as a Slurm jobid. Note that some functions allow passing no arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further flags passed to the command line function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brief, parsable, allocations</code></td>
<td>
<p>Logical. When <code>TRUE</code>, these are passed as flags directly
to the command line function <code>sacct</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_sacct</code></td>
<td>
<p>Logical. Skip <code>sacct</code> directly (for internal use only.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wait</code></td>
<td>
<p>Logical scalar. When <code>TRUE</code> the function will pass the <code>--wait</code>
flag to <code>Slurm</code> and set <code>wait = TRUE</code> in the system2 call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submit</code></td>
<td>
<p>Logical, when <code>TRUE</code> calls sbatch to submit the job to slurm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>slurm_available</code> checks whether Slurm is available in
the system or not. It is usually called before calling any bash wrapper.
If available, the function will return <code>TRUE</code>, otherwise <code>FALSE</code>.
</p>
<p>The wrapper of squeue includes the flag <code style="white-space: pre;">⁠-o%all⁠</code> which returns all
available fields separated by a vertical bar. This cannot be changed since it
is the easiest way of processing the information in R.
</p>
<p>The function <code>slurm.conf</code> is a wrapper of the function <code>scontrol</code> that
returns configuration info about Slurm, in particular, the underlying command
that is called is <code style="white-space: pre;">⁠scontrol show conf⁠</code>. This returns a named character vector
with configuration info about the cluster. The name of this function matches
the name of the file that holds this information.
</p>
<p>The function <code>SchedulerParameters</code> is just a wrapper of slurm.conf.
It processes the field "SchedulerParameters" included in the configuration
file and has information relevant for the scheduler.
</p>
<p><code>sacct.</code> is an alternative that works around when <code>sacct</code> fails due to
lack of accounting on. This function is not intended for direct call.
</p>
<p>In the case of <code>sbatch</code>, function takes an object of class <code>slurm_job</code> and
submits it to the queue. In debug mode the job will be submitted via <code>sh</code>
instead.
</p>
<p>The method for character scalars is used to submit jobs using a slurm
script.
</p>


<h3>Value</h3>

<p>In the case of <code>sbatch</code>, depends on what <code>x</code> is:
</p>

<ul>
<li>
<p> If <code>x</code> is of class slurm_job, then it returns the same object including
the Slurm job ID (if the job was submitted to the queue).
</p>
</li>
<li>
<p> If <code>x</code> is a file path (e.g. a bash script), an integer with the jobid number
(again, if the job was submitted to Slurm).
</p>
</li>
</ul>
<p>The functions <code>squeue</code> and <code>sacct</code> return a data frame with the information
returned by the command line utilities. The function <code>scancel</code> returns NULL.
</p>
<p><code>slurm_available()</code> returns a logical scalar equal to <code>TRUE</code> if Slurm is
available.
</p>
<p><code>slurm.conf()</code> and <code>SchedulerParameters()</code> return information about the
Slurm cluster, if available.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Are we under a Slurm Cluster?
slurm_available()


## Not run: 
# What is the maximum number of jobs (array size) that the system
# allows?
sconfig &lt;- slurm.conf() # We first retrieve the info.
sconfig["MaxArraySize"]

## End(Not run)

## Not run: 
# Submitting a simple job
job &lt;- Slurm_EvalQ(slurmR::WhoAmI(), njobs = 4L, plan = "submit")

# Checking the status of the job (we can simply print)
job
status(job) # or use the state function
sacct(job) # or get more info with the sactt wrapper.

# Suppose one of the jobs is taking too long to complete (say #4)
# we can stop it and resubmit the job as follows:
scancel(job)

# Resubmitting only 4
sbatch(job, array = 4) # A new jobid will be assigned


## End(Not run)
</code></pre>


</div>