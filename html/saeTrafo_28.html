<div class="container">

<table style="width: 100%;"><tr>
<td>map_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualizes regional disaggregated estimates on a map</h2>

<h3>Description</h3>

<p>Function <code>map_plot</code> creates spatial visualizations of the estimates
obtained by small area estimation methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">map_plot(
  object,
  MSE = FALSE,
  CV = FALSE,
  map_obj = NULL,
  map_dom_id = NULL,
  map_tab = NULL,
  color = c("white", "red4"),
  scale_points = NULL,
  guide = "colourbar",
  return_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of type <code>saeTrafo</code>, containing the estimates to
be visualized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the MSE is also visualized.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the CV is also visualized.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_obj</code></td>
<td>
<p>an <code>sf</code> object (map object) as defined by the
<span class="pkg">sf</span> package on which the data should be visualized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_dom_id</code></td>
<td>
<p>a character string containing the name of a variable in
<code>map_obj</code> that indicates the domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_tab</code></td>
<td>
<p>a <code>data.frame</code> object with two columns that match the
domain variable from the census data set (first column) with the domain
variable in the map_obj (second column). This should only be used if the IDs
in both objects differ.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>a <code>vector</code> of length 2 defining the lowest and highest
color in the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_points</code></td>
<td>
<p>a numeric vector of length two. This
scale will be used for every plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guide</code></td>
<td>
<p>character passed to <code>scale_fill_gradient</code> from
<span class="pkg">ggplot2</span>. Possible values are "none", "colourbar", and "legend".
Defaults to "colourbar".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_data</code></td>
<td>
<p>if set to <code>TRUE</code>, a fortified data frame including
the map data as well as the chosen indicators is returned. Customized maps
can easily be obtained from this data frame via the package <span class="pkg">ggplot2</span>.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Creates the plots demanded and, if selected, a fortified data.frame
containing the mapdata and chosen indicators.
</p>


<h3>See Also</h3>

<p><code>sf</code>, <code>NER_Trafo</code>,
<code>saeTrafoObject</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Examples for creating maps to visualize the saeTrafo estimates

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

# Load shape file
load_shapeaustria()

# Example 1: Map plots with uncertainty plots (for MSE and CV)
map_plot(NER_model, MSE = TRUE, CV = TRUE, map_obj = shape_austria_dis,
         map_dom_id = "PB")

# Example 2: Personalize map plot for point estimates
map_plot(NER_model, map_obj = shape_austria_dis, map_dom_id = "PB",
         color = c("white", "darkblue"),
         scale_points = c(0, max(NER_model$ind$Mean)))

# Example 3: More options to personalize map plot by using return_data = TRUE
# and ggplot2
require(ggplot2)
library(ggplot2)
data_plot &lt;- map_plot(NER_model, map_obj = shape_austria_dis, map_dom_id = "PB",
                      return_data = TRUE)
ggplot(data_plot, aes(long = NULL, lat = NULL,
                      group = "PB", fill = Mean))+
       geom_sf(color = "black") +
       theme_void() +
       ggtitle("Personalized map") +
       scale_fill_gradient2(low = "red", mid = "white", high = "darkgreen",
                            midpoint = 20000)

# Example 4: Create a suitable mapping table to use numerical identifiers of
# the shape file

# First find the right order
dom_ord &lt;- match(shape_austria_dis$PB, NER_model$ind$Domain)

#Create the mapping table based on the order obtained above
map_tab &lt;- data.frame(pop_data_id = NER_model$ind$Domain[dom_ord],
                      shape_id = shape_austria_dis$BKZ)

# Create map plot for mean indicator - point and CV estimates but no MSE
# using the numerical domain identifiers of the shape file
map_plot(object = NER_model, MSE = FALSE, CV = TRUE,
         map_obj = shape_austria_dis,
         map_dom_id = "BKZ", map_tab = map_tab)


</code></pre>


</div>