<div class="container">

<table style="width: 100%;"><tr>
<td>wilcox_keselman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wilcox and Keselman's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the nonparametric test of
Wilcox and Keselman (2006) for testing for heteroskedasticity
in a simple linear regression model, and extends it to the multiple linear
regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wilcox_keselman(
  mainlm,
  gammapar = 0.2,
  B = 500L,
  p.adjust.method = "none",
  seed = NA,
  rqwarn = FALSE,
  matchWRS = FALSE,
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammapar</code></td>
<td>
<p>A double value between 0 and 0.5 exclusive specifying the
quantile value <code class="reqn">gamma</code>. Defaults to 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer specifying the number of nonparametric bootstrap samples
to use to estimate standard error(s) of the quantile difference(s).
Defaults to <code>500L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>A character specifying the family-wise error rate
method to use in adjusting <code class="reqn">p</code>-values (if it is a multiple linear
regression model). The value is passed to <code>p.adjust</code>.
By default no adjustment is made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer specifying a seed to pass to
<code>set.seed</code> for random number generation. This allows
reproducibility of bootstrap results. The value <code>NA</code>
results in not setting a seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rqwarn</code></td>
<td>
<p>A logical specifying whether warnings generated by
<code>rq.fit</code> (such as 'Solution may be nonunique')
should be printed (<code>TRUE</code>) or suppressed (<code>FALSE</code>). Defaults
to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matchWRS</code></td>
<td>
<p>A logical specifying whether bootstrap samples should be
generated in the exact same manner as in the <code>qhomtv2</code> function in
<a href="https://github.com/nicebread/WRS">WRS</a> package. If <code>TRUE</code>, and
<code>seed</code> is set to <code>2</code> and <code>B</code> to <code>100</code> and
<code>p.adjust.method</code> to <code>"none"</code>, results will
be identical to those of the default settings of <code>qhomtv2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Wilcox RR, Keselman HJ (2006).
“Detecting Heteroscedasticity in a Simple Regression Model via Quantile Regression Slopes.”
<em>Journal of Statistical Computation and Simulation</em>, <b>76</b>(8), 705–712.
</p>


<h3>See Also</h3>

<p>Rand R. Wilcox's package
<a href="https://github.com/nicebread/WRS">WRS</a> on Github; in particular
the functions <code>qhomt</code> and <code>qhomtv2</code>, which implement this
method for simple and multiple linear regression respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
wilcox_keselman(mtcars_lm)

</code></pre>


</div>