<div class="container">

<table style="width: 100%;"><tr>
<td>getConfEll</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence ellipse</h2>

<h3>Description</h3>

<p>Calculates the confidence ellipse for the true mean of shot coordinates under the assumption of multivariate normality. Also includes the ellipse based on a robust estimate for the covariance matrix of the shot coordinates.</p>


<h3>Usage</h3>

<pre><code class="language-R">getConfEll(xy, level = 0.5, dstTarget, conversion,
          center = FALSE, doRob=TRUE)

## S3 method for class 'data.frame'
getConfEll(xy, level = 0.5, dstTarget, conversion,
          center = FALSE, doRob=TRUE)

## Default S3 method:
getConfEll(xy, level = 0.5, dstTarget, conversion,
          center = FALSE, doRob=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>Shot coordinates of n points: either a numerical (n x p)-matrix (1 row of p coordinates per point), or a data frame with either the variables <code>x</code>, <code>y</code> or <code>point.x</code>, <code>point.y</code> (optionally <code>z</code> or <code>point.z</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a numerical value with the coverage for the confidence ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dstTarget</code></td>
<td>
<p>a numerical value giving the distance to the target - used in MOA calculation. Acts as override if variable <code>distance</code> is already included in <code>xy</code>. See <code>getMOA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conversion</code></td>
<td>
<p>how to convert the measurement unit for distance to target to that of the (x,y)-coordinates in MOA calculation. Acts as override if variables <code>dist.unit</code> and <code>point.unit</code> are already included in <code>xy</code>. Example <code>'m2cm'</code>. See <code>getMOA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>logical: center groups to mean (0,0) first? If variable <code>series</code> does not exist, all shots are treated as belonging to the same group. Only available in method <code>getConfEll.data.frame()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doRob</code></td>
<td>
<p>logical: should robust covariance matrix estimate be used as well?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>No coordinate transforms are done (unlike in <code>groupLocation</code>, <code>groupShape</code>, <code>groupSpread</code>), i.e., origin is not assumed to be in top-left corner, and points are not taken relative to point of aim.
</p>
<p>Robust estimate for the covariance matrix of coordinates is from <code>covMcd</code> using the MCD algorithm. See <code>getCEP</code> for estimates of the circular/spherical error probable.</p>


<h3>Value</h3>

<p>A list with the confidence ellipse measures.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ctr</code></td>
<td>
<p>coordinates group center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrRob</code></td>
<td>
<p>coordinates robust estimate of group center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covRob</code></td>
<td>
<p>robust estimate of covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a numerical matrix with the lengths of the semi-axes of the ellipse (in original measurement units, MOA, SMOA, milliradian).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeRob</code></td>
<td>
<p>a numerical matrix with the lengths of the semi-axes of the ellipse based on a robust estimate for the covariance matrix of shot coordinates (in original measurement units, MOA, SMOA, milliradian).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a numerical vector with the angle, the aspect ratio of the ellipse (square root of condition index <code>kappa</code>), its flattening (1 - inverse aspect ratio) as well as the trace and determinant of the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeRob</code></td>
<td>
<p>a numerical vector with the aspect ratio and the flattening of the ellipse as well as the trace and determinant based on a robust estimate for the covariance matrix of shot coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magFac</code></td>
<td>
<p>magnification factor used to turn the error ellipse into the confidence ellipse as determined by the F(p, n-1)-distribution.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>getCEP</code>,
<code>covMcd</code>,
<code>drawEllipse</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># coordinates given by a suitable data frame
(ce &lt;- getConfEll(DFsavage, level=0.5, dstTarget=100,
                  conversion='yd2in'))

# plot points, center, parametric confidence
# ellipse, and its axes
plot(point.y ~ point.x, data=DFsavage, asp=1, pch=16)
drawEllipse(ce, axes=TRUE, fg='blue', colCtr='blue', lwd=2, pch=4, cex=2)

# coordinates given by a matrix
## Not run: 
xy &lt;- matrix(round(rnorm(100, 0, 5), 2), ncol=2)
getConfEll(xy, level=0.5, dstTarget=25, conversion='m2cm')

## End(Not run)
</code></pre>


</div>