<div class="container">

<table style="width: 100%;"><tr>
<td>SEMace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Average Causal Effect (ACE) for a given source-sink pair</h2>

<h3>Description</h3>

<p>Compute total effects as ACEs of variables X
on variables Y in a directed acyclic graph (DAG). The ACE will be estimated
as the path coefficient of X (i.e., theta) in the linear equation
Y ~ X + Z. The set Z is defined as the adjustment (or conditioning) set of
Y over X, applying various adjustement sets. Standard errors (SE),
for each ACE, are computed following the <code>lm</code> standard procedure
or a bootstrap-based procedure (see <code>boot</code> for details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SEMace(
  graph,
  data,
  group = NULL,
  type = "parents",
  effect = "all",
  method = "BH",
  alpha = 0.05,
  boot = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>An igraph object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. If <code>group = NULL</code> (default), group influence
will not be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character Conditioning set Z. If "parents" (default) the
Pearl's back-door set (Pearl, 1998), "minimal" the dagitty minimal set
(Perkovic et al, 2018), or "optimal" the O-set with the smallest
asymptotic variance (Witte et al, 2020) are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>character X to Y effect. If "all" (default) all effects from
X to Y, "source2sink" only effects from source X to sink Y, or "direct"
only direct effects from X to Y are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Multiple testing correction method. One of the values
available in <code>p.adjust</code>.
By default, <code>method = "BH"</code> (i.e., FDR multiple test correction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for ACE selection (by default,
<code>alpha = 0.05</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>The number of bootstrap samplings enabling bootstrap
computation of ACE standard errors. If <code>NULL</code> (default), bootstrap
is disabled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame of ACE estimates between network sources and sinks.
</p>


<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>References</h3>

<p>Pearl J (1998). Graphs, Causality, and Structural Equation Models.
Sociological Methods &amp; Research, 27(2):226-284.
&lt;https://doi.org/10.1177/0049124198027002004&gt;
</p>
<p>Perkovic E, Textor J, Kalisch M, Maathuis MH (2018). Complete graphical
characterization and construction of adjustment sets in Markov equivalence
classes of ancestral graphs. Journal of Machine Learning Research, 18:1-62.
&lt;http://jmlr.org/papers/v18/16-319.html&gt;
</p>
<p>Witte J, Henckel L, Maathuis MH, Didelez V (2020). On efficient
adjustment in causal graphs. Journal of Machine Learning Research, 21:1-45.
&lt;http://jmlr.org/papers/v21/20-175.htm&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# ACE without group, O-set, all effects:
ace1 &lt;- SEMace(graph = sachs$graph, data = log(sachs$pkc),
               group = NULL, type = "optimal", effect = "all",
               method = "BH", alpha = 0.05, boot = NULL)
print(ace1)

# ACE with group perturbation, Pa-set, direct effects:
ace2 &lt;- SEMace(graph = sachs$graph, data = log(sachs$pkc),
               group = sachs$group, type = "parents", effect = "direct",
               method = "none", alpha = 0.05, boot = NULL)
print(ace2)

</code></pre>


</div>