<div class="container">

<table style="width: 100%;"><tr>
<td>meigen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extraction of Moran eigenvectors</h2>

<h3>Description</h3>

<p>This function extracts spatial and temporal eigenvectors (i.e., basis functions describing spatial and temporal patterns).
</p>


<h3>Usage</h3>

<pre><code class="language-R">meigen( coords = NULL,model = "exp", enum = NULL, s_id = NULL,
        threshold = 0, cmat = NULL, coords_z=NULL, enum_z=NULL,
        interact=TRUE, interact_max_dim = 600  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Matrix of spatial coordinates (N x 2). If cmat is specified, it is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Type of kernel to model spatial dependence. The currently available options are "exp" for the exponential kernel, "gau" for the Gaussian kernel, and "sph" for the spherical kernel. Default is "exp"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enum</code></td>
<td>
<p>Optional. The maximum mumber of spatial eigenvectors to be extracted (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_id</code></td>
<td>
<p>Optional. Location/zone ID for modeling inter-group spatial effects. If specified, Moran eigenvectors are extracted by groups. It is useful e.g. for multilevel modeling (s_id is the groups) and panel data modeling (s_id is given by individual location id). Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Optional. Threshold for the eigenvalues. Suppose that lambda_1 is the maximum eigenvalue, this function extracts eigenvectors whose corresponding eigenvalue is equal or greater than (threshold x lambda_1). threshold must be a value between 0 and 1. Default is zero (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>
<p>Optional. A user-specified spatial connectivity matrix (N x N). It must be provided when the user wants to use a spatial connectivity matrix other than the default matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords_z</code></td>
<td>
<p>Optional. One- or two-column matrix whose t-th column represents t-th temporal coordinate (N x 1 or N x 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enum_z</code></td>
<td>
<p>Optional. The maximum mumber of temporal eigenvectors to be extracted (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interact</code></td>
<td>
<p>Optional. If TRUE, space-time eigenvectors (space x time) are considered in addition to spatial eigenvectors and temporal eigenvectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interact_max_dim</code></td>
<td>
<p>Optional. The maximum mumber of the space-time eigenvectors to be extracted (scalar)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function extracts spatial eigenvectors from MCM, where M = I - 11'/N is a centering operator. By default, C is a N x N connectivity matrix whose (i, j)-th element equals exp(-d(i,j)/h), where d(i,j) is the spatial Euclidean distance between the sample sites i and j. h is the maximum length of the minimum spanning tree connecting sample sites (see Dray et al., 2006). If cmat is provided, this function performs the same calculation after C is replaced with cmat.
</p>
<p>The temporal eigenvectors are extracted in the same way where the spatial distance d(i,j) is replaced with temporal difference. If two temporal coordinates are given, their eigenvectors are evaluated respectively.
</p>
<p>If threshold = 0.00 (default), all the eigenvectors corresponding to positive eigenvalues explaining positive spatial/temporal dependence are extracted. threshold = 0.00 or 0.25 are standard assumptions (see Griffith, 2003; Murakami and Griffith, 2015).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>Matrix of the spatial eigenvectors (N x L)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev</code></td>
<td>
<p>Vector of the spatial eigenvalues (L x 1), scaled to have the maximum value of 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf_z</code></td>
<td>
<p>List. t-th element is the matrix of the t-th temporal eigenvectors (N x L_t)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ev_z</code></td>
<td>
<p>List. t-th element is the vector of the t-th temporal eigenvalues (L_t x 1), scaled to have the maximum value of 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other</code></td>
<td>
<p>List of other outcomes, which are internally used</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daisuke Murakami
</p>


<h3>References</h3>

<p>Dray, S., Legendre, P., and Peres-Neto, P.R. (2006) Spatial modelling: a comprehensive framework for principal coordinate analysis of neighbour matrices (PCNM). Ecological Modelling, 196 (3), 483-493.
</p>
<p>Griffith, D.A. (2003) Spatial autocorrelation and spatial filtering: gaining understanding through theory and scientific visualization. Springer Science &amp; Business Media.
</p>
<p>Murakami, D. and Griffith, D.A. (2015) Random effects specifications in eigenvector spatial filtering: a simulation study. Journal of Geographical Systems, 17 (4), 311-331.
</p>
<p>Murakami, D., Shirota, S., Kajita, S., and Kajita, S. (2024) Fast spatio-temporally varying coefficient modeling with reluctant interaction selection. ArXiv.
</p>


<h3>See Also</h3>

<p><code>meigen_f</code> for fast eigen-decomposition
</p>


</div>