<div class="container">

<table style="width: 100%;"><tr>
<td>sobol_indices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of Sobol' indices</h2>

<h3>Description</h3>

<p>It allows to compute Sobol' indices up to the fourth-order using state-of-the-art estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sobol_indices(
  matrices = c("A", "B", "AB"),
  Y,
  N,
  params,
  first = "saltelli",
  total = "jansen",
  order = "first",
  boot = FALSE,
  R = NULL,
  parallel = "no",
  ncpus = 1,
  conf = 0.95,
  type = "norm"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matrices</code></td>
<td>
<p>Character vector with the required matrices. The default is <code>matrices = c("A", "B", "AB")</code>.
See <code>sobol_matrices</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric vector with the model output obtained from the matrix created with
<code>sobol_matrices</code>. The numeric vector should not contain any NA or NaN values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Positive integer, the initial sample size of the base sample matrix created with <code>sobol_matrices</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Character vector with the name of the model inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first</code></td>
<td>
<p>Estimator to compute first-order indices. Options are:
</p>

<ul>
<li> <p><code>first = "saltelli"</code> (Saltelli et al. 2010).
</p>
</li>
<li> <p><code>first = "jansen"</code> (Jansen 1999).
</p>
</li>
<li> <p><code>first = "sobol"</code>  (Sobol' 1993).
</p>
</li>
<li> <p><code>first = "azzini"</code> (Azzini et al. 2020).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>Estimator to compute total-order indices. Options are:
</p>

<ul>
<li> <p><code>total = "jansen"</code> (Jansen 1999).
</p>
</li>
<li> <p><code>total = "sobol"</code> (Sobol' 2001).
</p>
</li>
<li> <p><code>total = "homma"</code> (Homma and Saltelli 1996).
</p>
</li>
<li> <p><code>total = "janon"</code> (Janon et al. 2014).
</p>
</li>
<li> <p><code>total = "glen"</code> (Glen and Isaacs 2012).
</p>
</li>
<li> <p><code>total = "azzini"</code> (Azzini et al. 2020).
</p>
</li>
<li> <p><code>total = "saltelli"</code> (Saltelli et al. 2008).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Whether to compute "first", "second", "third" or fourth-order Sobol' indices. Default
is <code>order = "first"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Logical. If TRUE, the function bootstraps the Sobol' indices. If FALSE, it provides point
estimates. Default is <code>boot = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Positive integer, number of bootstrap replicas. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>The type of parallel operation to be used (if any).
If missing, the default is taken from the option "boot.parallel"
(and if that is not set, "no"). For more information, check the
<code>parallel</code> option in the <code>boot</code> function of the <code>boot</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>Positive integer: number of processes to be used in parallel operation:
typically one would chose this to the number of available CPUs.
Check the <code>ncpus</code> option in the <code>boot</code> function of the <code>boot</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Confidence interval if <code>boot = TRUE</code>. Number between 0 and 1. Default is <code>conf = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Method to compute the confidence interval if <code>boot = TRUE</code>. Default is "norm".
Check the <code>type</code> option in the <code>boot</code> function of the <code>boot</code> package.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Any first and total-order estimator can be combined with the appropriate sampling design.
Check Table 3 of the vignette for a summary of all possible combinations, and Tables 1 and 2 for a
mathematical description of the estimators. If the analyst mismatches estimators and sampling designs,
the function will generate an error and urge to redefine the sample matrices or the estimators.
</p>
<p>For all estimators except Azzini et al. (2020)'s and Janon et al. (2014)'s,
<code>sobol_indices()</code> calculates the sample mean as </p>
<p style="text-align: center;"><code class="reqn">\hat{f}_0=\frac{1}{2N} \sum_{v=1}^{N}(f(\mathbf{A})_v + f(\mathbf{B})_v)\,,</code>
</p>

<p>where <code class="reqn">N</code> is the row dimension of the base sample matrix, and the unconditional sample variance as
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(y) = \frac{1}{2N-1} \sum{v=1}^{N} ((f(\mathbf{A})_v - \hat{f})^2 + (f(\mathbf{B})_v - \hat{f})^2)\,,</code>
</p>

<p>where <code class="reqn">f(\mathbf{A})_v</code> (<code class="reqn">f(\mathbf{B})_v</code>) indicates the model output <code class="reqn">y</code> obtained after running the model <code class="reqn">f</code>
in the <code class="reqn">v</code>-th row of the <code class="reqn">\mathbf{A}</code> (<code class="reqn">\mathbf{B}</code>) matrix.
</p>
<p>For the Azzini estimator,
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(y) = \sum_{v=1}^{N} (f(\mathbf{A})_v - f(\mathbf{B})_v)^2 + (f(\mathbf{B}_A^{(i)})_v - f(\mathbf{A}_B^{(i)})_v) ^ 2</code>
</p>

<p>and for the Janon estimator,
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(y)=\frac{1}{N} \sum_{v=1}^{N} \frac{f(\mathbf{A})_v^2 + f(\mathbf{A}_B^{(i)})_v^2}{2}-f_0^2</code>
</p>

<p>where <code class="reqn">f(\mathbf{A}_B^{(i)})_v</code> (<code class="reqn">f(\mathbf{B}_A^{(i)})_v</code>) is the model output obtained after running the model <code class="reqn">f</code> in
the <code class="reqn">v</code>-th row of an <code class="reqn">\mathbf{A}_B^{(i)})_v</code> (<code class="reqn">\mathbf{B}_A^{(i)})_v</code>) matrix, where all columns come from <code class="reqn">\mathbf{A}</code> (<code class="reqn">\mathbf{B}</code>)
except the <code class="reqn">i</code>-th, which comes from <code class="reqn">\mathbf{B}</code> (<code class="reqn">\mathbf{A}</code>).
</p>


<h3>Value</h3>

<p>A <code>sensobol</code> object.
</p>


<h3>References</h3>

<p>Azzini I, Mara T, Rosati R (2020).
“Monte Carlo estimators of first-and total-orders Sobol' indices.”
<em>arXiv</em>.
2006.08232, <a href="https://arxiv.org/abs/2006.08232">https://arxiv.org/abs/2006.08232</a>.<br><br> Glen G, Isaacs K (2012).
“Estimating Sobol sensitivity indices using correlations.”
<em>Environmental Modelling and Software</em>, <b>37</b>, 157–166.
<a href="https://doi.org/10.1016/j.envsoft.2012.03.014">doi:10.1016/j.envsoft.2012.03.014</a>.<br><br> Homma T, Saltelli A (1996).
“Importance measures in global sensitivity analysis of nonlinear models.”
<em>Reliability Engineering and System Safety</em>, <b>52</b>, 1–17.
<a href="https://doi.org/10.1016/0951-8320%2896%2900002-6">doi:10.1016/0951-8320(96)00002-6</a>.<br><br> Janon A, Klein T, Lagnoux A, Nodet M, Prieur C (2014).
“Asymptotic normality and efficiency of two Sobol index estimators.”
<em>ESAIM: Probability and Statistics</em>, <b>18</b>(3), 342–364.
<a href="https://doi.org/10.1051/ps/2013040">doi:10.1051/ps/2013040</a>.<br><br> Jansen M (1999).
“Analysis of variance designs for model output.”
<em>Computer Physics Communications</em>, <b>117</b>(1), 35–43.
<a href="https://doi.org/10.1016/S0010-4655%2898%2900154-4">doi:10.1016/S0010-4655(98)00154-4</a>.<br><br> Saltelli A, Annoni P, Azzini I, Campolongo F, Ratto M, Tarantola S (2010).
“Variance based sensitivity analysis of model output. Design and estimator for the total sensitivity index.”
<em>Computer Physics Communications</em>, <b>181</b>(2), 259–270.
<a href="https://doi.org/10.1016/j.cpc.2009.09.018">doi:10.1016/j.cpc.2009.09.018</a>.<br><br> Saltelli A, Ratto M, Andres T, Campolongo F, Cariboni J, Gatelli D, Saisana M, Tarantola S (2008).
<em>Global Sensitivity Analysis. The Primer</em>.
John Wiley and Sons, Ltd, Chichester, UK.
<a href="https://doi.org/10.1002/9780470725184">doi:10.1002/9780470725184</a>.<br><br> Sobol' IM (1993).
“Sensitivity analysis for nonlinear mathematical models.”
<em>Mathematical Modeling and Computational Experiment</em>, <b>1</b>(4), 407–414.<br><br> Sobol' IM (2001).
“Global sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates.”
<em>Mathematics and Computers in Simulation</em>, <b>55</b>(1-3), 271–280.
<a href="https://doi.org/10.1016/S0378-4754%2800%2900270-6">doi:10.1016/S0378-4754(00)00270-6</a>.
</p>


<h3>See Also</h3>

<p>Check the function <code>boot</code> for further details on the bootstrapping
with regards to the methods available for the computation of confidence intervals in the <code>type</code> argument.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define settings
N &lt;- 1000; params &lt;- paste("X", 1:3, sep = ""); R &lt;- 10

# Create sample matrix
mat &lt;- sobol_matrices(N = N, params = params)

# Compute Ishigami function
Y &lt;- ishigami_Fun(mat)

# Compute and bootstrap Sobol' indices
ind &lt;- sobol_indices(Y = Y, N = N, params = params, boot = TRUE, R = R)
</code></pre>


</div>