<div class="container">

<table style="width: 100%;"><tr>
<td>do_AlluvialPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Alluvial plots.</h2>

<h3>Description</h3>

<p>This function is based on the <span class="pkg">ggalluvial</span> package. It allows you to generate alluvial plots from a given Seurat object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_AlluvialPlot(
  sample,
  first_group,
  last_group,
  middle_groups = NULL,
  colors.use = NULL,
  plot.title = NULL,
  plot.subtitle = NULL,
  plot.caption = NULL,
  font.size = 14,
  font.type = "sans",
  xlab = NULL,
  ylab = "Number of cells",
  repel = FALSE,
  fill.by = last_group,
  use_labels = FALSE,
  stratum.color = "black",
  stratum.fill = "white",
  stratum.width = 1/3,
  stratum.fill.conditional = FALSE,
  use_geom_flow = FALSE,
  alluvium.color = "white",
  flow.color = "white",
  flip = FALSE,
  label.color = "black",
  curve_type = "sigmoid",
  use_viridis = FALSE,
  viridis.palette = "G",
  viridis.direction = -1,
  sequential.palette = "YlGnBu",
  sequential.direction = 1,
  plot.grid = FALSE,
  grid.color = "grey75",
  grid.type = "dashed",
  na.value = "white",
  legend.position = "right",
  legend.title = NULL,
  plot.title.face = "bold",
  plot.subtitle.face = "plain",
  plot.caption.face = "italic",
  axis.title.face = "bold",
  axis.text.face = "plain",
  legend.title.face = "bold",
  legend.text.face = "plain"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p><strong><code>Seurat</code></strong> | A Seurat object, generated by CreateSeuratObject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first_group</code></td>
<td>
<p><strong><code>character</code></strong> | Categorical metadata variable. First group of nodes of the alluvial plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last_group</code></td>
<td>
<p><strong><code>character</code></strong> | Categorical metadata variable. Last group of nodes of the alluvial plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>middle_groups</code></td>
<td>
<p><strong><code>character</code></strong> | Categorical metadata variable. Vector of groups of nodes of the alluvial plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors.use</code></td>
<td>
<p><strong><code>character</code></strong> | Named list of colors corresponding to the unique values in fill.by (which defaults to last_group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title, plot.subtitle, plot.caption</code></td>
<td>
<p><strong><code>character</code></strong> | Title, subtitle or caption to use in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.size</code></td>
<td>
<p><strong><code>numeric</code></strong> | Overall font size of the plot. All plot elements will have a size relationship with this font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.type</code></td>
<td>
<p><strong><code>character</code></strong> | Base font family for the plot. One of:
</p>

<ul>
<li> <p><em><code>mono</code></em>: Mono spaced font.
</p>
</li>
<li> <p><em><code>serif</code></em>: Serif font family.
</p>
</li>
<li> <p><em><code>sans</code></em>: Default font family.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p><strong><code>character</code></strong> | Titles for the X and Y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repel</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to repel the text labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.by</code></td>
<td>
<p><strong><code>character</code></strong> | One of first_group, middle_groups (one of the values, if multiple mid_groups) or last_group. These values will be used to color the alluvium/flow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_labels</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to use labels instead of text for the stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum.color, alluvium.color, flow.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color for the border of the alluvium (and flow) and stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum.fill</code></td>
<td>
<p><strong><code>character</code></strong> | Color to fill the stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum.width</code></td>
<td>
<p><strong><code>logical</code></strong> | Width of the stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum.fill.conditional</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to fill the stratum with the same colors as the alluvium/flow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_geom_flow</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to use <code>geom_flow</code> instead of <code>geom_alluvium</code>. Visual results might differ.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to invert the axis of the displayed plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color for the text labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_type</code></td>
<td>
<p><strong><code>character</code></strong> | Type of curve used in <code>geom_alluvium</code>. One of:
</p>

<ul>
<li> <p><em><code>linear</code></em>.
</p>
</li>
<li> <p><em><code>cubic</code></em>.
</p>
</li>
<li> <p><em><code>quintic</code></em>.
</p>
</li>
<li> <p><em><code>sine</code></em>.
</p>
</li>
<li> <p><em><code>arctangent</code></em>.
</p>
</li>
<li> <p><em><code>sigmoid</code></em>.
</p>
</li>
<li> <p><em><code>xspline</code></em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_viridis</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to use viridis color scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis.palette</code></td>
<td>
<p><strong><code>character</code></strong> | A capital letter from A to H or the scale name as in scale_fill_viridis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis.direction</code></td>
<td>
<p><strong><code>numeric</code></strong> | Either 1 or -1. Controls how the gradient of viridis scale is formed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential.palette</code></td>
<td>
<p><strong><code>character</code></strong> | Type of sequential color palette to use. Out of the sequential palettes defined in <strong><code>brewer.pal</code></strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential.direction</code></td>
<td>
<p><strong><code>numeric</code></strong> | Direction of the sequential color scale. Either 1 or -1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.grid</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to plot grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the grid in the plot. In heatmaps, color of the border of the cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.type</code></td>
<td>
<p><strong><code>character</code></strong> | One of the possible linetype options:
</p>

<ul>
<li> <p><em><code>blank</code></em>.
</p>
</li>
<li> <p><em><code>solid</code></em>.
</p>
</li>
<li> <p><em><code>dashed</code></em>.
</p>
</li>
<li> <p><em><code>dotted</code></em>.
</p>
</li>
<li> <p><em><code>dotdash</code></em>.
</p>
</li>
<li> <p><em><code>longdash</code></em>.
</p>
</li>
<li> <p><em><code>twodash</code></em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.value</code></td>
<td>
<p><strong><code>character</code></strong> | Color value for NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p><strong><code>character</code></strong> | Position of the legend in the plot. One of:
</p>

<ul>
<li> <p><em><code>top</code></em>: Top of the figure.
</p>
</li>
<li> <p><em><code>bottom</code></em>: Bottom of the figure.
</p>
</li>
<li> <p><em><code>left</code></em>: Left of the figure.
</p>
</li>
<li> <p><em><code>right</code></em>: Right of the figure.
</p>
</li>
<li> <p><em><code>none</code></em>: No legend is displayed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>
<p><strong><code>character</code></strong> | Title for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.face, plot.subtitle.face, plot.caption.face, axis.title.face, axis.text.face, legend.title.face, legend.text.face</code></td>
<td>
<p><strong><code>character</code></strong> | Controls the style of the font for the corresponding theme element.  One of:
</p>

<ul>
<li> <p><em><code>plain</code></em>: For normal text.
</p>
</li>
<li> <p><em><code>italic</code></em>: For text in itallic.
</p>
</li>
<li> <p><em><code>bold</code></em>: For text in bold.
</p>
</li>
<li> <p><em><code>bold.italic</code></em>: For text both in itallic and bold.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Check Suggests.
  value &lt;- SCpubr:::check_suggests(function_name = "do_AlluvialPlot", passive = TRUE)
  message(value)
  if (isTRUE(value)){
    # Consult the full documentation in https://enblacar.github.io/SCpubr-book/

    # Define your Seurat object.
    sample &lt;- readRDS(system.file("extdata/seurat_dataset_example.rds", package = "SCpubr"))

    # Compute basic sankey plot.
    p &lt;- SCpubr::do_AlluvialPlot(sample = sample,
                                 first_group = "orig.ident",
                                 last_group = "seurat_clusters")

  } else if (base::isFALSE(value)){
    message("This function can not be used without its suggested packages.")
    message("Check out which ones are needed using `SCpubr::state_dependencies()`.")
  }

</code></pre>


</div>