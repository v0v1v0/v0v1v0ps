<div class="container">

<table style="width: 100%;"><tr>
<td>surrosurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit and print the models for evaluating the surrogacy strength 
of a candidate surrogate endpoint
</h2>

<h3>Description</h3>

<p>The function <code>surrosurv</code> fits (all or a subset of) statistical
models to evaluate a surrogate endpoint S for a given true endpoint T,
using individual data from a meta-analysis of randomized controlled trials.
</p>


<h3>Usage</h3>

<pre><code class="language-R">surrosurv(data,
          models = c('Clayton', 'Plackett', 'Hougaard',
                     'Poisson I', 'Poisson T', 'Poisson TI', 'Poisson TIa'),
          intWidth = NULL,  nInts = 8,
          cop.OPTIMIZER = "bobyqa",
          poi.OPTIMIZER = "bobyqa",
          verbose = TRUE,
          twoStage = FALSE,
          keep.data = TRUE)

## S3 method for class 'surrosurv'
predict(object, models = names(object), exact.models, ...)

## S3 method for class 'surrosurv'
print(x, silent = FALSE, 
      digits = 2, na.print = "-.--", ...)
          
## S3 method for class 'predictSurrosurv'
print(x, n = 6, ...)
          
## S3 method for class 'surrosurv'
plot(x, ...)

## S3 method for class 'predictSurrosurv'
plot(x, models = names(x), exact.models,
                      pred.ints = TRUE,
                      show.ste = TRUE,
                      surro.stats = TRUE, 
                      xlab, ylab, 
                      xlim, ylim, mfrow, main, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data.frame with columns
</p>

<ul>
<li> <p><code>trialref</code>, the trial reference
</p>
</li>
<li> <p><code>trt</code>, the treatment arm (-0.5 or 0.5)
</p>
</li>
<li> <p><code>id</code>, the patient id
</p>
</li>
<li> <p><code>timeT</code>, the value of the true endpoint T
</p>
</li>
<li> <p><code>statusT</code>, the censoring/event (0/1) indicator of the true endpoint T
</p>
</li>
<li> <p><code>timeS</code>, the value of the surrogate endpoint S
</p>
</li>
<li> <p><code>statusS</code>, the censoring/event (0/1) indicator of the surrogate endpoint S
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>

<p>For <code>surrosurv()</code>, the models should be fitted/plotted/predicted.
Possible models are:
Clayton copula (unadjusted and adjusted),
Plackett copula (unadjusted and adjusted),
Hougaard copula (unadjusted and adjusted),
Poisson (with individual-level heterogeneity only,
with trial-level heterogeneity only,
with both individual- and trial-level heterogeneity,
with both individual- and trial-level heterogeneity 
and with random per-trial intercept).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.models</code></td>
<td>

<p>If <code>TRUE</code>, plots or predictions are generated only
for the elements of <code>x</code> which match exactly any of <code>models</code>.
If <code>exact.models = TRUE</code>, partial matching is used.
By default, <code>exact.models = TRUE</code> if all the <code>models</code>
match exactly any of the <code>names(x)</code> (or  <code>names(object)</code>)
and <code>exact.models = FALSE</code> otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intWidth</code></td>
<td>

<p>the width of time intervals for data Poissonization
(see poissonize)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInts</code></td>
<td>

<p>the number of time intervals for data Poissonization
(see poissonize)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop.OPTIMIZER</code></td>
<td>

<p>the optimizer for copula models (see <code>optimx</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poi.OPTIMIZER</code></td>
<td>

<p>the optimizer for Poisson models (see <code>optimx</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>should the function print out the model being fitted
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoStage</code></td>
<td>

<p>should the parameters of the baseline hazard functions
fixed to their marginal estimates (Shih and Louis, 1995)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>

<p>should the data object be kept as attribute of the returned results?
(this is needed for <code>confint.surrosurv()</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>

<p>The fitted models, an object of class <code>surrosurv</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>Should the results be return for storing without printing them?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits, na.print, xlab, ylab, xlim, ylim, main, ...</code></td>
<td>

<p>other parameters for <code>print</code> or <code>plot</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>

<p>the number of rows and columns for displaying the plots
(see <code>par</code>).
If missing, the default is computed using the function
<code>n2mfrow</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>the number of rows to print
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.ints</code></td>
<td>

<p>Should the prediction intervals be plotted?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.ste</code></td>
<td>

<p>Should the surrogate threshold effect be showed?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surro.stats</code></td>
<td>

<p>Should the surrogacy statistics be showed?
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Three copula models can be fit: Clayton (1978), Plackett (1965), and
Hougaard (1986).
For all of them the linear regression at the second step
is computed both via simple LS regression
and via a linear model adjusted for measurement error
of the log-hazard ratios estimated at the first step.
This adjusted model is the one described by
Burzykowski et al. (2001), which relies on the results
by van Houwelingen et al. (2002).
</p>
<p>The mixed Poisson models that can be fit
are used to estimate parameters of mixed proportional hazard models,
as described for instance by Crowther et al (2014).
The statistical details are provided in Rotolo et al (WP).
</p>
<p>The function <code>predict()</code> returns the estimated values
of the log-hazard ratios on the true and the surrogate endpoints.
The list of the prediction functions (for all the <code>models</code>)
is available as <code>attr(predict.surrosurv(...), 'predf')</code>.
</p>


<h3>Value</h3>

<p>The fitted models, an object of class <code>surrosurv</code>.
</p>


<h3>Author(s)</h3>

<p>NA
</p>


<h3>References</h3>

<p>Burzykowski T, Molenberghs G, Buyse M et al.
Validation of surrogate end points in multiple randomized clinical trials
with failure time end points.
<em>Journal of the Royal Statistical Society C</em> 2001;
<b>50</b>:405–422.
doi: <a href="https://doi.org/10.1111/1467-9876.00244">10.1111/1467-9876.00244</a>
</p>
<p>Clayton DG.
A model for association in bivariate life tables
and its application in epidemiological studies of familial tendency 
in chronic disease incidence.
<em>Biometrika</em> 1978; <b>65</b>:141–151.
doi: <a href="https://doi.org/10.1093/biomet/65.1.141">10.1093/biomet/65.1.141</a>
</p>
<p>Crowther MJ, Riley RD, Staessen JA, Wang J, Gueyffier F, Lambert PC.
Individual patient data meta-analysis of survival data
using Poisson regression models.
<em>BMC Medical Research Methodology</em> 2012; <b>12</b>:34.
doi: <a href="https://doi.org/10.1186/1471-2288-12-34">10.1186/1471-2288-12-34</a>.
</p>
<p>Gasparrini A, Armstrong B, Kenward MG.
Multivariate meta-analysis for non-linear and other multi-parameter associations.
<em>Statistics in Medicine</em> 2012; <b>31</b>:3821–39.
doi: <a href="https://doi.org/10.1002/sim.5471">10.1002/sim.5471</a>
</p>
<p>Hougaard P.
A class of multivariate failure time distributions.
<em>Biometrika</em> 1986; <b>73</b>:671–678.
doi: <a href="https://doi.org/10.1093/biomet/73.3.671">10.1093/biomet/73.3.671</a>
</p>
<p>Plackett RL.
A class of bivariate distributions. 
<em>Journal of the America Statistical Association</em> 1965; <b>60</b>:516–522.
doi: <a href="https://doi.org/10.1080/01621459.1965.10480807">10.1080/01621459.1965.10480807</a>
</p>
<p>Rotolo F, Paoletti X, Burzykowski T, Buyse M, Michiels S.
A Poisson approach for the validation of failure time surrogate endpoints
in individual patient data meta-analyses.
<em>Statistical Methods in Medical Research</em> 2017;
<b>In Press</b>.
doi: <a href="https://doi.org/10.1177/0962280217718582">10.1177/0962280217718582</a>
</p>
<p>Shih JH, Louis TA.
Inferences on the Association Parameter in Copula Models
for Bivariate Survival Data.
<em>Biometrics</em> 1995; <b>51</b>:1384–1399.
doi: <a href="https://doi.org/10.2307/2533269">10.2307/2533269</a>
</p>
<p>van Houwelingen HC, Arends LR, Stijnen T.
Advanced methods in meta-analysis: multivariate approach and meta-regression.
<em>Statistics in Medicine</em> 2002; <b>21</b>:589–624.
doi: <a href="https://doi.org/10.1002/sim.1040">10.1002/sim.1040</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(150)
  data &lt;- simData.re(N = 20, ni = 250,
                     R2 = 0.8, kTau = 0.4,
                     alpha = log(0.95), beta = log(0.85),
                     censorA = 15 * 365.25)
  library(survival)
  par(mfrow = 1:2)
  plot(survfit(Surv(timeS, statusS) ~ trt, data = data), lty = 1:2, 
       xscale = 365.25, main = 'Progression-Free Survival\n(S)', col = 2)
  plot(survfit(Surv(timeT, statusT) ~ trt, data = data), lty = 1:2,
       xscale = 365.25, main = 'Overall Survival\n(T)')
       
  ## Not run: 
    # Long computation time!
    surrores &lt;- surrosurv(data, verbose = TRUE)
    convergence(surrores)
    surrores
  
## End(Not run)
  
  # Advanced GASTRIC data
  ## Not run: 
    # Long computation time!
    data('gastadv')
    allSurroRes &lt;- surrosurv(gastadv, c('Clayton', 'Poisson'), verbose = TRUE)
    convergence(allSurroRes)
    allSurroRes
    predict(allSurroRes)
    plot(allSurroRes)
  
## End(Not run)
</code></pre>


</div>