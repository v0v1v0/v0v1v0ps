<div class="container">

<table style="width: 100%;"><tr>
<td>fitdistr.grouped</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum-likelihood fitting of a univariate distribution from grouped data
</h2>

<h3>Description</h3>

<p>Maximum-likelihood fitting of a univariate distribution when the data are
represented by a set of frequencies pertaining to given set of contiguous 
intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitdistr.grouped(breaks, counts, family, weights, trace = FALSE, wpar = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A numeric vector of strictly increasing values which identify 
a set of contiguous intervals on the real line.
See ‘Details’ for additional information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A vector of non-negative integers representing the number 
of observations falling in the intervals specified by <code>breaks</code>;
it is then required that <code>length(counts)+1=length(breaks)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string specifying the parametric family of 
distributions to be used for fitted. 
Admissible names are: <code>"normal"</code>, <code>"logistic"</code>, <code>"t"</code>, 
<code>"Cauchy"</code>, <code>"SN"</code>, <code>"ST"</code>, <code>"SC"</code>, <code>"gamma"</code>, 
<code>"Weibull"</code>;
the names <code>"gaussian"</code> and <code>"Gaussian"</code> are also allowed, 
and are converted to <code>"normal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An alias for <code>counts</code>, allowed for analogy with the 
<code>selm</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>A logical value which indicates whether intermediate evaluations 
of the optimization process are printed (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wpar</code></td>
<td>

<p>An optional vector with initial values of the ‘working parameters’
for starting the maximization of the log-likelihood function; 
see ‘Details’ for their description. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The original motivation of this function was fitting a univariate <abbr><span class="acronym">SN</span></abbr>, 
<abbr><span class="acronym">ST</span></abbr> or <abbr><span class="acronym">SC</span></abbr> distribution from grouped data;
its scope was later extended to include some other continuous distributions. 
The adopted name of the function reflects the broad similarity of its purpose 
with the one of <code>fitdistr</code>, but there are substantial 
differences in the actual working of the two functions.
</p>
<p>The parameter set of a given <code>family</code> is the same as appearing in the
corresponding <code>d&lt;basename&gt;</code> function, with the exception of the <code>"t"</code> 
distribution, for which a location and a scale parameter are included, 
besides <code>df</code>.
</p>
<p>The range of <code>breaks</code> does not need to span the whole support of the
chosen <code>family</code> of distributions, that is, 
<code>(0, Inf)</code> for <code>"Weibull"</code> and <code>"gamma"</code> families,
<code>(-Inf, Inf)</code> for the other families.
In fact, for the purpose of post-fitting plotting, an infinite 
<code>range(breaks)</code> represents a complication, requiring an <em>ad hoc</em> 
handling;  so it is sensible to avoid it.
However, at the maximum-likelihood fitting stage, the full support of
the  probability distribution is considered, with the following implications. 
If <code>max(breaks)=xR</code>, say, and <code>xR&lt;Inf</code>,  then an additional 
interval <code>(xR, Inf)</code> is introduced, with value <code>counts=0</code> assigned.
A similar action is taken at the lower end: if <code>min(breaks)=xL</code> is
larger than the infimum of the support of the distribution,
an extra  0-<code>counts</code> interval is introduced as <code>(0, xL)</code> 
or <code>(-Inf, xL)</code>, depending on the support of the <code>family</code>.
</p>
<p>Maximum likelihood fitting is obtained by maximizing the pertaining 
multinomial log-likelihood using the <code>optim</code> function 
with  <code>method="Nelder-Mead"</code>. For numerical convenience, the numerical 
search is performed using ‘working parameters’ in place of the original
ones, with reverse conversion at the end. The working parameters coincide
with the original distribution parameters when they have unbounded range,
while they are log-transformed in case of intrinsically positive parameters.
This transformation applies to the parameters of the positive-valued
distributions ("gamma" and "Weibull"), all scale parameters and <code>df</code>
of the <code>"t"</code> distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>fitdistr.grouped</code>, whose components are described in 
<code>fitdistr.grouped-class</code>.
</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini </p>


<h3>See Also</h3>

<p>For methods pertaining to this class of objects, see
<code>fitdistr.grouped-class</code> and
<code>plot.fitdistr.grouped</code>; see also 
<code>dsn</code>, <code>dst</code>, <code>dsc</code>,
<code>Distributions</code>, <code>dmultinom</code>;
see also <code>selm</code> for ungrouped data fitting and an example
elaborated on below.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(barolo)
attach(barolo)
A75 &lt;- (reseller=="A" &amp; volume==75)
logPrice &lt;- log(price[A75], 10) # used in documentation of 'selm'; see its fitting
detach(barolo)
breaks&lt;- seq(1, 3, by=0.25)
f &lt;- cut(logPrice, breaks = breaks)
counts &lt;- tabulate(f, length(levels(f))) 
logPrice.grouped &lt;- fitdistr.grouped(breaks, counts, family='ST')
summary(logPrice.grouped) # compare this fit with the ungrouped data fitting 
</code></pre>


</div>