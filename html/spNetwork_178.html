<div class="container">

<table style="width: 100%;"><tr>
<td>worker_adaptive_bw_tnkde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Worker function for adaptive bandwidth for TNDE</h2>

<h3>Description</h3>

<p>The worker function to calculate Adaptive bandwidths according
to Abramsonâ€™s smoothing regimen for TNKDE with a space-time interaction (INTERNAL).
</p>


<h3>Usage</h3>

<pre><code class="language-R">worker_adaptive_bw_tnkde(
  lines,
  quad_events,
  events_loc,
  events,
  w,
  kernel_name,
  bw_net,
  bw_time,
  method,
  div,
  digits,
  tol,
  sparse,
  max_depth,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>A feature collection of linestrings representing the underlying
network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quad_events</code></td>
<td>
<p>a feature collection of points indicating for which events
the densities must be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events_loc</code></td>
<td>
<p>A feature collection of points representing the location of
the events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>A feature collection of points representing the events.
Multiple events can share the same location. They are linked by the goid
column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A numeric vector with the weight of the events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_name</code></td>
<td>
<p>The name of the kernel to use (string)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw_net</code></td>
<td>
<p>The fixed kernel bandwidth for the network dimension. Can also be a vector
if several bandwidth must be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw_time</code></td>
<td>
<p>The fixed kernel bandwidth for the time dimension. Can also be a vector
if several bandwidth must be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The type of NKDE to use (string)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>div</code></td>
<td>
<p>The divisor to use for the kernel. Must be "n" (the number of
events within the radius around each sampling point), "bw" (the bandwidth)
"none" (the simple sum).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to retain from the spatial coordinates. It
ensures that topology is good when building the network. Default is 3. Too
high a precision (high number of digits) might break some connections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A float indicating the minimum distance between the events and the
lines' extremities when adding the point to the network. When points are
closer, they are added at the extremity of the lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>A Boolean indicating if sparse or regular matrices should be
used by the Rcpp functions. These matrices are used to store edge indices
between two nodes in a graph. Regular matrices are faster, but require more
memory, in particular with multiprocessing. Sparse matrices are slower (a
bit), but require much less memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_depth</code></td>
<td>
<p>An integer, the maximum depth to reach for continuous and
discontinuous NKDE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A Boolean, indicating if the function should print messages
about the process.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with the local bandwidths or an array if bw_net and bw_time are vectors
</p>


<h3>Examples</h3>

<pre><code class="language-R">#This is an internal function, no example provided
</code></pre>


</div>