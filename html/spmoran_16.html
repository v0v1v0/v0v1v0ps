<div class="container">

<table style="width: 100%;"><tr>
<td>predict0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial and spatio-temporal predictions</h2>

<h3>Description</h3>

<p>It is a function for spatial/spatio-temporal pprediction using the model estimated from <code>esf</code>, <code>resf</code>, or <code>resf_vc</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict0( mod, meig0, x0 = NULL, xconst0 = NULL, xgroup0 = NULL, offset0 = NULL,
weight0 = NULL, compute_se=FALSE, compute_quantile = FALSE )
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>Output from <code>esf</code> <code>resf</code></p>
</td>
</tr></table>
<p>, or <code>resf_vc</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>meig0</code></td>
<td>
<p>Moran eigenvectors at prediction sites. Output from <code>meigen0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Matrix of explanatory variables at prediction sites (N_0 x K). Each column of x0 must correspond to those in x in the input model (mod). Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xconst0</code></td>
<td>
<p>Effective for <code>resf_vc</code>. Matrix of explanatory variables at prediction sites whose coefficients are assumed constant across space (N_0 x K_const). Each column of xconst0 must correspond to those in xconst in the input model. Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgroup0</code></td>
<td>
<p>Matrix/vector of group IDs at prediction sites that may be integer or name by group (N_0 x K_g). Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset0</code></td>
<td>
<p>Vector of offset variables at prediction sites (N_0 x 1). Effective if y is count (see <code>nongauss_y</code>). Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight0</code></td>
<td>
<p>Vector of weights for prediction sites (N_0 x 1). Required if compute_se = TRUE or compute_quantile = TRUE, and weight in the input model is not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_se</code></td>
<td>
<p>If TRUE, predictive standard error is evaulated. It is currently supported only for continuous variables. If nongauss is specified in the input model (mod), standard error for the transformed y is evaluated. Default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_quantile</code></td>
<td>
<p>If TRUE, Matrix of the quantiles for the predicted values (N x 15) is evaulated. It is currently supported only for continuous variables. Default is FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Matrix with the first column for the predicted values (pred). The second and the third columns are the predicted trend component (xb) and the residual spatial process (sf_residual). If xgroup0 is specified, the fourth column is the predicted group effects (group). If tr_num &gt; 0 or tr_nonneg ==TRUE (i.e., y is transformed) in mod, there is another column of the predicted values in the transformed/normalized scale (pred_trans). In addition, if compute_quantile =TRUE, predictive standard error (pred_se) is evaluated and added as another column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_quantile</code></td>
<td>
<p>Effective if compute_quantile = TRUE. Matrix of the quantiles for the predicted values (N x 15). It is useful for evaluating uncertainty in the predictive values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_vc</code></td>
<td>
<p>Matrix of estimated spatially (spatio-temporally) varying coefficients (S(T)VCs) on x0 (N_0 x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bse_vc</code></td>
<td>
<p>Matrix of estimated standard errors for the S(T)VCs (N_0 x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_vc</code></td>
<td>
<p>Matrix of estimated t-values for the S(T)VCs (N_0 x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_vc</code></td>
<td>
<p>Matrix of estimated p-values for the S(T)VCs (N_0 x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_vc</code></td>
<td>
<p>Matrix of estimated non-spatially varying coefficients (NVCs) on x0 (N x K). Effective if nvc =TRUE in <code>resf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cse_vc</code></td>
<td>
<p>Matrix of standard errors for the NVCs on x0 (N x K).Effective if nvc =TRUE in <code>resf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct_vc</code></td>
<td>
<p>Matrix of t-values for the NVCs on x0 (N x K). Effective if nvc =TRUE in <code>resf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp_vc</code></td>
<td>
<p>Matrix of p-values for the NVCs on x0 (N x K). Effective if nvc =TRUE in <code>resf</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>meigen0</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(spdep)
data(boston)
samp    &lt;- sample( dim( boston.c )[ 1 ], 300)

d       &lt;- boston.c[ samp, ]    ## Data at observed sites
y	      &lt;- d[, "CMEDV"]
x       &lt;- d[,c("ZN", "LSTAT")]
xconst  &lt;- d[,c("CRIM", "NOX", "AGE", "DIS", "RAD", "TAX", "PTRATIO", "B", "RM")]
coords  &lt;- d[,c("LON", "LAT")]

d0      &lt;- boston.c[-samp, ]    ## Data at unobserved sites
y0      &lt;- d0[, "CMEDV"]
x0      &lt;- d0[,c("ZN", "LSTAT")]
xconst0 &lt;- d0[,c("CRIM", "NOX", "AGE", "DIS", "RAD", "TAX", "PTRATIO", "B", "RM")]
coords0 &lt;- d0[,c("LON", "LAT")]

meig 	  &lt;- meigen( coords = coords )
meig0 	&lt;- meigen0( meig = meig, coords0 = coords0 )

############ Spatial prediction ############
#### model with residual spatial dependence
mod	    &lt;- resf(y=y, x=x, meig=meig)
pred0   &lt;- predict0( mod = mod, x0 = x0, meig0 = meig0 )
pred0$pred[1:5,]  # Predicted values

#### model with spatially varying coefficients (SVCs)
mod	    &lt;- resf_vc(y=y, x=x, xconst=xconst, meig=meig )
pred0   &lt;- predict0( mod = mod, x0 = x0, xconst0=xconst0, meig0 = meig0 )
pred0$pred[1:5,]  # Predicted values
pred0$b_vc[1:5,]  # SVCs
pred0$bse_vc[1:5,]# standard errors of the SVCs
pred0$t_vc[1:5,]  # t-values of the SNVCs
pred0$p_vc[1:5,]  # p-values of the SNVCs

plot(y0,pred0$pred[,1]);abline(0,1)


</code></pre>


</div>