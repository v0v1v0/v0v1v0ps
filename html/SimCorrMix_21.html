<div class="container">

<table style="width: 100%;"><tr>
<td>ord_norm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation to Generate Variables Treated as Ordinal</h2>

<h3>Description</h3>

<p>This function calculates the intermediate MVN correlation needed to generate a variable described by
a discrete marginal distribution and associated finite support.  This includes ordinal (<code class="reqn">r \ge 2</code> categories) variables
or variables that are treated as ordinal (i.e. count variables in the Barbiero &amp; Ferrari, 2015 method used in
<code>corrvar2</code>, doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>).  The function is a modification of Barbiero &amp; Ferrari's
<code>ordcont</code> function in <code>GenOrd-package</code>.
It works by setting the intermediate MVN correlation equal to the target correlation and updating each intermediate pairwise
correlation until the final pairwise correlation is within <code>epsilon</code> of the target correlation or the maximum number of
iterations has been reached.  This function uses <code>norm_ord</code> to calculate the ordinal correlation obtained
from discretizing the normal variables generated from the intermediate correlation matrix.  The <code>ordcont</code> has been modified in the following ways:
</p>
<p>1) the initial correlation check has been removed because this is done within the simulation functions
</p>
<p>2) the final positive-definite check has been removed
</p>
<p>3) the intermediate correlation update function was changed to accommodate more situations
</p>
<p>This function would not ordinarily be called by the user.  Note that this will return a matrix that is NOT positive-definite
because this is corrected for in the simulation functions <code>corrvar</code> and <code>corrvar2</code>
using the method of Higham (2002) and the <code>nearPD</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ord_norm(marginal = list(), rho = NULL, support = list(),
  epsilon = 0.001, maxit = 1000, Spearman = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>a list of length equal to the number of variables; the i-th element is a vector of the cumulative
probabilities defining the marginal distribution of the i-th variable;
if the variable can take r values, the vector will contain r - 1 probabilities (the r-th is assumed to be 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the target correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support</code></td>
<td>
<p>a list of length equal to the number of variables; the i-th element is a vector of containing the r
ordered support values; if not provided (i.e. support = list()), the default is for the i-th element to be the vector 1, ..., r</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>the maximum acceptable error between the final and target pairwise correlations (default = 0.001);
smaller values take more time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the maximum number of iterations to use (default = 1000) to find the intermediate correlation; the
correction loop stops when either the iteration number passes <code>maxit</code> or <code>epsilon</code> is reached</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Spearman</code></td>
<td>
<p>if TRUE, Spearman's correlations are used (and support is not required); if FALSE (default) Pearson's correlations
are used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<p><code>SigmaC</code> the intermediate MVN correlation matrix
</p>
<p><code>rho0</code> the calculated final correlation matrix generated from <code>SigmaC</code>
</p>
<p><code>rho</code> the target final correlation matrix
</p>
<p><code>niter</code> a matrix containing the number of iterations required for each variable pair
</p>
<p><code>maxerr</code> the maximum final error between the final and target correlation matrices
</p>


<h3>References</h3>

<p>Barbiero A, Ferrari PA (2015). Simulation of correlated Poisson variables. Applied Stochastic Models
in Business and Industry, 31:669-80. doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.
</p>
<p>Barbiero A, Ferrari PA (2015). GenOrd: Simulation of Discrete Random Variables with Given
Correlation Matrix and Marginal Distributions. R package version 1.4.0. <br><a href="https://CRAN.R-project.org/package=GenOrd">https://CRAN.R-project.org/package=GenOrd</a>
</p>
<p>Ferrari PA, Barbiero A (2012). Simulating ordinal data, Multivariate Behavioral Research, 47(4):566-589. doi: <a href="http://doi.org/10.1080/00273171.2012.692630">10.1080/00273171.2012.692630</a>.
</p>


<h3>See Also</h3>

<p><code>corrvar</code>, <code>corrvar2</code>, <code>norm_ord</code>,
<code>intercorr</code>, <code>intercorr2</code>
</p>


</div>