<div class="container">

<table style="width: 100%;"><tr>
<td>gibbs_stcos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for STCOS Model</h2>

<h3>Description</h3>

<p>Gibbs Sampler for STCOS Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">gibbs_stcos(
  z,
  v,
  H,
  S,
  Kinv,
  R,
  report_period = R + 1,
  burn = 0,
  thin = 1,
  init = NULL,
  fixed = NULL,
  hyper = NULL
)

## S3 method for class 'stcos_gibbs'
logLik(object, ...)

## S3 method for class 'stcos_gibbs'
DIC(object, ...)

## S3 method for class 'stcos_gibbs'
print(x, ...)

## S3 method for class 'stcos_gibbs'
fitted(object, H, S, ...)

## S3 method for class 'stcos_gibbs'
predict(object, H, S, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Vector which represents the outcome; assumed to be direct
estimates from the survey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Vector which represents direct variance estimates from the survey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Matrix of overlaps between source and fine-level supports.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Design matrix for basis decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p>The precision matrix <code class="reqn">\bm{K}^{-1}</code> of the
random coefficient <code class="reqn">\bm{\eta}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of MCMC reps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report_period</code></td>
<td>
<p>Gibbs sampler will report progress each time this many
iterations are completed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Number of the <code>R</code> draws to discard at the beginning of the
chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>After burn-in period, save one out of every <code>thin</code> draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A list containing the following initial values for the MCMC:
<code>sig2mu</code>, <code>sig2xi</code>, <code>sig2K</code>, <code>muB</code>, <code>eta</code>,
<code>xi</code>. Any values which are not specified are set to arbitrary
choices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A list specifying which parameters to keep fixed in the MCMC.
This can normally be left blank. If elements <code>sig2mu</code>,
<code>sig2xi</code>, or <code>sig2K</code> are specified they should be boolean,
where TRUE means fixed (i.e. not drawn). If elements <code>muB</code>,
<code>eta</code>, or <code>xi</code> are specified, they should each be a vector
of indicies; the specified indices are to be treated as fixed (i.e.
not drawn).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>A list containing the following hyperparameter values:
<code>a_sig2mu</code>, <code>a_sig2K</code>, <code>a_sig2xi</code>, <code>b_sig2mu</code>,
<code>b_sig2K</code>, <code>b_sig2xi</code>. Any hyperparameters which are not
specified are set to a default value of 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A result from <code>gibbs_stcos</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A result from <code>gibbs_stcos</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits the model
</p>
<p style="text-align: center;"><code class="reqn">
  \bm{Z} = \bm{H} \bm{\mu}_B + \bm{S} \bm{\eta} + \bm{\xi} + \bm{\varepsilon}, \quad
  \bm{\varepsilon} \sim \textrm{N}(0, \bm{V}),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \bm{\eta} \sim \textrm{N}(\bm{0}, \sigma_K^2 \bm{K}), \quad
  \bm{\xi} \sim \textrm{N}(0, \sigma_{\xi}^2 \bm{I}),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\bm{\mu}_B \sim \textrm{N}(\bm{0}, \sigma_\mu^2 \bm{I}), \quad
\sigma_\mu^2 \sim \textrm{IG}(a_\mu, b_\mu),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\sigma_K^2 \sim \textrm{IG}(a_K, b_K), \quad
\sigma_\xi^2 \sim \textrm{IG}(a_\xi, b_\xi),
</code>
</p>

<p>using a Gibbs sampler with closed-form draws.
</p>
<p>Helper functions produce the following outputs:
</p>

<ul>
<li> <p><code>logLik</code> computes the log-likelihood for each saved draw.
</p>
</li>
<li> <p><code>DIC</code> computes the Deviance information criterion for each saved draw.
</p>
</li>
<li> <p><code>print</code> displays a summary of the draws.
</p>
</li>
<li> <p><code>fitted</code> computes the mean <code class="reqn">E(Y_i)</code> for each observation
<code class="reqn">i = 1, \ldots, n</code>, for each saved draw.
</p>
</li>
<li> <p><code>predict</code> draws <code class="reqn">Y_i</code> for each observation
<code class="reqn">i = 1, \ldots, n</code>, using the parameter values for each saved
Gibbs sampler draw.
</p>
</li>
</ul>
<h3>Value</h3>

<p><code>gibbs_stcos</code> returns an <code>stcos</code> object which contains
draws from the sampler. Helper functions take this object as an input
and produce various outputs (see details).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
demo = prepare_stcos_demo()
out = gibbs_stcos(demo$z, demo$v, demo$H, demo$S, solve(demo$K),
    R = 100, burn = 0, thin = 1)
print(out)
logLik(out)
DIC(out)
fitted(out, demo$H, demo$S)
predict(out, demo$H, demo$S)

## End(Not run)
</code></pre>


</div>