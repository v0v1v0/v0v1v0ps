<div class="container">

<table style="width: 100%;"><tr>
<td>pca.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ordination of Principal Components with convex hulls</h2>

<h3>Description</h3>

<p>Ordination of Principal Components from the output of a Principal Components Analysis performed by <code>prcomp</code> function (<code>stats</code> package). Require a <code>factor</code> object with <code>groups</code>, which enable the plot to feature colored groups and convex hulls (if desired).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pca.plot(
  PCA.out = NULL,
  groups = NULL,
  col.gp = grDevices::rainbow(length(levels(groups))),
  conv.hulls = NULL,
  col.conv = grDevices::rainbow(length(levels(conv.hulls))),
  PCs = c(1, 2),
  main = "Ordination of PCA coordinates",
  sp.as = "points",
  sp.text = NULL,
  cross.origin = TRUE,
  lwd = 1,
  lty = "dotted",
  leg = TRUE,
  leg.labels = groups,
  leg.pos = "topright",
  cex.leg = 1,
  cex = 1,
  cex.axis = 1,
  cex.lab = 1,
  cex.main = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PCA.out</code></td>
<td>
<p>the output of a Principal Components Analysis performed by <code>prcomp</code> (<code>stats</code> package). By default: <code>PCA.out = NULL</code> (i.e. output must be specified before ploting)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>groups to use as colors and/or convex hulls. Must be a <code>factor</code> object with the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(groups) == nrow(PCA.out$x)</code>). By default: <code>groups = NULL</code> (i.e. <code>factor</code> must be specified before ploting)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.gp</code></td>
<td>
<p>a <code>factor</code> object with the colours intended for <code>groups</code>. Must be the same length as the number of levels from <code>groups</code> (i.e. <code>length(col.gp) == length(levels(groups))</code>). By default: <code>col.gp = grDevices::rainbow(length(levels(groups)))</code> (i.e. colors defined automatically)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv.hulls</code></td>
<td>
<p>groups to use for convex hulls. Must be a <code>factor</code> object with the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(conv.hulls) == nrow(PCA.out$x)</code>). By default: <code>conv.hulls = NULL</code> (i.e. plot without convex hulls)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.conv</code></td>
<td>
<p>a <code>factor</code> object with the colours intended for <code>conv.hulls</code>. Must be the same length as the number of levels in <code>conv.hulls</code> (i.e. <code>length(col.conv) == length(levels(conv.hulls))</code>). By default: <code>col.conv = grDevices::rainbow(length(levels(conv.hulls)))</code> (i.e. colors defined automatically)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCs</code></td>
<td>
<p>a vector of length two with the Principal Components intended for the plot. By default: <code>PCs = c(1, 2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title of output plot. Should be presented between quotation marks. By default: <code>main = "Ordination of PCA coordinates"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.as</code></td>
<td>
<p>enables one to choose between ploting elements as <code>"points"</code> or <code>"text"</code>. If <code>sp.as = "text"</code>, also input a <code>factor</code> of characters to use as text (i.e. <code>sp.text</code>). By default: <code>sp.as = "points"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.text</code></td>
<td>
<p>only applies when <code>sp.as = "text"</code>. A <code>factor</code> including elements as texts intended in the plot. Has to be the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(sp.text) == nrow(PCA.out$x)</code>) . By default: <code>sp.text = NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cross.origin</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the ordination plot will include lines crossing at the origin (i.e. x = 0, y = 0). By default: <code>cross.origin = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>only applies when <code>cross.origin = TRUE</code>. The width for lines crossing at the origin. Same as in <code>par</code>. By default: <code>lwd = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>only applies when <code>cross.origin = TRUE</code>. The type of lines crossing at the origin. Same as in <code>par</code>: "Line types can either be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash) or as one of the character strings "blank", "solid", "dashed", "dotted", "dotdash", "longdash", or "twodash", where "blank" uses ‘invisible lines’ (i.e., does not draw them)." By default: <code>lty = "dotted"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p>a logical. If <code>TRUE</code>, a legend is added to plot. By default: <code>leg = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.labels</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. Must be the same length of levels in <code>groups</code> (i.e. <code>length(leg.labels) == length(levels(groups))</code>). By default: <code>leg.labels = groups</code> (i.e. labels will be the same as the levels from <code>groups</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.pos</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. Specify legend location in the plot by using a keyword from the list: <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>. Alternatively, a single value can be provided and used for both margins, or two values, in which the first is used for X distance, and the second for Y distance. See also <code>legend</code> for details. By default: <code>leg.pos = "topright"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.leg</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. The magnification to be used in the legend. By default: <code>cex.leg = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>same as in <code>par</code>: "A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default". By default: <code>cex = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>same as in <code>par</code>. Relative to <code>cex</code>. The magnification to be used for axis annotation. By default: <code>cex.axix = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>same as in <code>par</code>. Relative to <code>cex</code>. The magnification to be used for x and y labels. By default: <code>cex.lab = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>same as in <code>par</code>. Relative to <code>cex</code>. The magnification to be used for main title. By default: <code>cex.main = 1</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Require the output of <code>prcomp</code> and a vector with <code>groups</code> to plot. In addition, it is also possible to include convex hulls around each group (i.e. <code>conv.hulls</code>) and to control the colors intended for each group (i.e. <code>col.gp</code>) and for each convex hull (i.e. <code>col.conv</code>).
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code>prcomp</code>, <code>palette</code>, <code>rgb</code>, <code>rainbow</code>, <code>legend</code>
</p>
<p>Useful links:
</p>

<ul>
<li>
<p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li>
<p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(eig.sample)

# PCA using 3D semilandmark coordinates
pca.eig.sample &lt;- stats::prcomp(geomorph::two.d.array(eig.sample))

# Verify names for each acoustic unit and the order in which they appear
dimnames(eig.sample)[[3]]

# Create factor to use as groups in subsequent ordination plot
sample.gr &lt;- factor(c(rep("centralis", 3), rep("cuvieri", 3), rep("kroyeri", 3)))

# Clear current R plot to prevent errors
grDevices::dev.off()

# Plot result of Principal Components Analysis
pca.plot(PCA.out = pca.eig.sample, groups = sample.gr, conv.hulls = sample.gr,
         main="PCA of 3D coordinates", leg=TRUE, leg.pos = "top")

</code></pre>


</div>