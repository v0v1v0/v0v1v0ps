<div class="container">

<table style="width: 100%;"><tr>
<td>fitVoigtIBIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the model with Voigt peaks using iterated batch importance sampling (IBIS).</h2>

<h3>Description</h3>

<p>Fit the model with Voigt peaks using iterated batch importance sampling (IBIS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitVoigtIBIS(
  wl,
  spc,
  n,
  lResult,
  conc = rep(1, nrow(spc)),
  batch = rep(1, nrow(spc)),
  npart = 10000,
  rate = 0.9,
  mcAR = 0.234,
  mcSteps = 20,
  minESS = npart/2,
  minPart = npart,
  destDir = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>Vector of <code>nwl</code> wavenumbers at which the spetra are observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spc</code></td>
<td>
<p><code>n_y * nwl</code> Matrix of observed Raman spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>index of the new observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lResult</code></td>
<td>
<p>List of results from the previous call to “fitVoigtPeaksSMC“ or “fitVoigtIBIS“</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Vector of <code>n_y</code> nanomolar (nM) dye concentrations for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>
<p>identifies to which batch each observation belongs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npart</code></td>
<td>
<p>number of SMC particles to use for the importance sampling distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>the target rate of reduction in the effective sample size (ESS).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcAR</code></td>
<td>
<p>target acceptance rate for the MCMC kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcSteps</code></td>
<td>
<p>number of iterations of the MCMC kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minESS</code></td>
<td>
<p>minimum effective sample size, below which the particles are resampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPart</code></td>
<td>
<p>target number of unique particles for the MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destDir</code></td>
<td>
<p>destination directory to save intermediate results (for long-running computations)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chopin (2002) "A Sequential Particle Filter Method for Static Models," Biometrika 89(3): 539–551,
doi: <a href="https://doi.org/10.1093/biomet/89.3.539">10.1093/biomet/89.3.539</a>
</p>


</div>