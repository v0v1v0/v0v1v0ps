<div class="container">

<table style="width: 100%;"><tr>
<td>pcf3est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pair Correlation Function of a Three-Dimensional Point Pattern
</h2>

<h3>Description</h3>

<p>Estimates the pair correlation function
from a three-dimensional point pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   pcf3est(X, ..., rmax = NULL, nrval = 128,
           correction = c("translation", "isotropic"),
           delta=NULL, adjust=1, biascorrect=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Three-dimensional point pattern (object of class <code>"pp3"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>

<p>Optional. Maximum value of argument <code class="reqn">r</code> for which
<code class="reqn">g_3(r)</code> will be estimated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrval</code></td>
<td>

<p>Optional. Number of values of <code class="reqn">r</code> for which
<code class="reqn">g_3(r)</code> will be estimated. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>Optional. Character vector specifying the edge correction(s)
to be applied. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>Optional. Half-width of the Epanechnikov smoothing kernel.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>

<p>Optional. Adjustment factor for the default value of <code>delta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biascorrect</code></td>
<td>

<p>Logical value. Whether to correct for underestimation due to
truncation of the kernel near <code class="reqn">r=0</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a stationary point process <code class="reqn">\Phi</code> in three-dimensional
space, the pair correlation function is
</p>
<p style="text-align: center;"><code class="reqn">
    g_3(r) = \frac{K_3'(r)}{4\pi r^2}
  </code>
</p>

<p>where <code class="reqn">K_3'</code> is the derivative of the
three-dimensional <code class="reqn">K</code>-function (see <code>K3est</code>).
</p>
<p>The three-dimensional point pattern <code>X</code> is assumed to be a
partial realisation of a stationary point process <code class="reqn">\Phi</code>.
The distance between each pair of distinct points is computed.
Kernel smoothing is applied to these distance values (weighted by
an edge correction factor) and the result is 
renormalised to give the estimate of <code class="reqn">g_3(r)</code>.
</p>
<p>The available edge corrections are:
</p>

<dl>
<dt>
<code>"translation"</code>:</dt>
<dd>
<p>the Ohser translation correction estimator
(Ohser, 1983; Baddeley et al, 1993)
</p>
</dd>
<dt>
<code>"isotropic"</code>:</dt>
<dd>
<p>the three-dimensional counterpart of
Ripley's isotropic edge correction (Ripley, 1977; Baddeley et al, 1993).
</p>
</dd>
</dl>
<p>Kernel smoothing is performed using the Epanechnikov kernel
with half-width <code>delta</code>. If <code>delta</code> is missing, the
default is to use the rule-of-thumb
<code class="reqn">\delta = 0.26/\lambda^{1/3}</code> where
<code class="reqn">\lambda = n/v</code> is the estimated intensity, computed
from the number <code class="reqn">n</code> of data points and the volume <code class="reqn">v</code> of the
enclosing box. This default value of <code>delta</code> is multiplied by
the factor <code>adjust</code>. 
</p>
<p>The smoothing estimate of the pair correlation <code class="reqn">g_3(r)</code>
is typically an underestimate when <code class="reqn">r</code> is small, due to
truncation of the kernel at <code class="reqn">r=0</code>. 
If <code>biascorrect=TRUE</code>, the smoothed estimate is
approximately adjusted for this bias. This is advisable whenever
the dataset contains a sufficiently large number of points.
</p>


<h3>Value</h3>

<p>A function value table (object of class <code>"fv"</code>) that can be
plotted, printed or coerced to a data frame containing the function
values.
</p>
<p>Additionally the value of <code>delta</code> is returned as an attribute
of this object.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rana Moyeed.
</p>


<h3>References</h3>

<p>Baddeley, A.J, Moyeed, R.A., Howard, C.V. and Boyde, A. (1993)
Analysis of a three-dimensional point pattern with replication.
<em>Applied Statistics</em> <b>42</b>, 641–668.
</p>
<p>Ohser, J. (1983)
On estimators for the reduced second moment measure of
point processes. <em>Mathematische Operationsforschung und
Statistik, series Statistics</em>, <b>14</b>, 63 – 71.
</p>
<p>Ripley, B.D. (1977)
Modelling spatial patterns (with discussion).
<em>Journal of the Royal Statistical Society, Series B</em>,
<b>39</b>, 172 – 212.
</p>


<h3>See Also</h3>

<p><code>pp3</code> to create a three-dimensional point
pattern (object of class <code>"pp3"</code>).
</p>
<p><code>F3est</code>,
<code>G3est</code>,
<code>K3est</code> for other summary functions of
a three-dimensional point pattern.
</p>
<p><code>pcf</code> to estimate the pair correlation function of
point patterns in two dimensions or other spaces.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  X &lt;- rpoispp3(250)
  Z &lt;- pcf3est(X)
  Zbias &lt;- pcf3est(X, biascorrect=FALSE)
  if(interactive()) {
    opa &lt;- par(mfrow=c(1,2))
    plot(Z,     ylim.covers=c(0, 1.2))
    plot(Zbias, ylim.covers=c(0, 1.2))
    par(opa)
  }
  attr(Z, "delta")
</code></pre>


</div>