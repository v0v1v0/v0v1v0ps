<div class="container">

<table style="width: 100%;"><tr>
<td>varSel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Selection</h2>

<h3>Description</h3>

<p>The function performs a data-driven variable selection. Starting from the
provided model it iterates through all the variables starting from the one
with the highest contribution (permutation importance or maxent percent
contribution). If the variable is correlated with other variables (according
to the given method and threshold) it performs a Jackknife test and among the
correlated variables it removes the one that results in the best performing
model when removed (according to the given metric for the training dataset).
The process is repeated until the remaining variables are not highly
correlated anymore.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varSel(
  model,
  metric,
  bg4cor,
  test = NULL,
  env = NULL,
  method = "spearman",
  cor_th = 0.7,
  permut = 10,
  use_pc = FALSE,
  interactive = TRUE,
  progress = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>SDMmodel or SDMmodelCV object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>character. The metric used to evaluate the models, possible
values are: "auc", "tss" and "aicc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg4cor</code></td>
<td>
<p>SWD object. Background locations used to test the
correlation between environmental variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>SWD. Test dataset used to evaluate the model, not
used with aicc and SDMmodelCV objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>rast containing the environmental variables, used
only with "aicc".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character. The method used to compute the correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_th</code></td>
<td>
<p>numeric. The correlation threshold used to select highly
correlated variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permut</code></td>
<td>
<p>integer. Number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_pc</code></td>
<td>
<p>logical, use percent contribution. If <code>TRUE</code> and the model is
trained using the Maxent method, the algorithm uses the percent
contribution computed by Maxent software to score the variable importance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>logical. If <code>FALSE</code> the interactive chart is not created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>logical. If <code>TRUE</code> shows a progress bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If <code>TRUE</code> prints informative messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An interactive chart showing in real-time the steps performed by the
algorithm is displayed in the Viewer pane.
</p>
<p>To find highly correlated variables the following formula is used:
</p>
<p style="text-align: center;"><code class="reqn">| coeff | \le cor_th</code>
</p>



<h3>Value</h3>

<p>The SDMmodel or SDMmodelCV object trained
using the selected variables.
</p>


<h3>Author(s)</h3>

<p>Sergio Vignali
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Acquire environmental variables
files &lt;- list.files(path = file.path(system.file(package = "dismo"), "ex"),
                    pattern = "grd",
                    full.names = TRUE)

predictors &lt;- terra::rast(files)

# Prepare presence and background locations
p_coords &lt;- virtualSp$presence
bg_coords &lt;- virtualSp$background

# Create SWD object
data &lt;- prepareSWD(species = "Virtual species",
                   p = p_coords,
                   a = bg_coords,
                   env = predictors,
                   categorical = "biome")

# Split presence locations in training (80%) and testing (20%) datasets
datasets &lt;- trainValTest(data,
                         test = 0.2,
                         only_presence = TRUE)
train &lt;- datasets[[1]]
test &lt;- datasets[[2]]

# Train a model
model &lt;- train(method = "Maxnet",
               data = train,
               fc = "l")

# Prepare background locations to test autocorrelation, this usually gives a
# warning message given that less than 10000 points can be randomly sampled
bg_coords &lt;- terra::spatSample(predictors,
                               size = 9000,
                               method = "random",
                               na.rm = TRUE,
                               xy = TRUE,
                               values = FALSE)

bg &lt;- prepareSWD(species = "Virtual species",
                 a = bg_coords,
                 env = predictors,
                 categorical = "biome")

## Not run: 
# Remove variables with correlation higher than 0.7 accounting for the AUC,
# in the following example the variable importance is computed as permutation
# importance
vs &lt;- varSel(model,
             metric = "auc",
             bg4cor = bg,
             test = test,
             cor_th = 0.7,
             permut = 1)
vs

# Remove variables with correlation higher than 0.7 accounting for the TSS,
# in the following example the variable importance is the MaxEnt percent
# contribution
# Train a model
model &lt;- train(method = "Maxent",
               data = train,
               fc = "l")

vs &lt;- varSel(model,
             metric = "tss",
             bg4cor = bg,
             test = test,
             cor_th = 0.7,
             use_pc = TRUE)
vs

# Remove variables with correlation higher than 0.7 accounting for the aicc,
# in the following example the variable importance is the MaxEnt percent
# contribution
vs &lt;- varSel(model,
             metric = "aicc",
             bg4cor = bg,
             cor_th = 0.7,
             use_pc = TRUE,
             env = predictors)
vs
## End(Not run)
</code></pre>


</div>