<div class="container">

<table style="width: 100%;"><tr>
<td>fitMRME</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Moving-Resting Model with Measurement Error</h2>

<h3>Description</h3>

<p>'fitMRME' fits a Moving-Resting Model with Measurement Error. The measurement
error is modeled by Guassian noise. Using <code>segment</code> to fit part
of observations to the model. A practical application of this feature
is seasonal analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitMRME(
  data,
  start,
  segment = NULL,
  lower = c(1e-06, 1e-06, 1e-06, 1e-06),
  upper = c(10, 10, 10, 10),
  print_level = 3,
  integrControl = integr.control()
)

fitMRME_naive(
  data,
  start,
  segment = NULL,
  lower = c(1e-06, 1e-06, 1e-06, 1e-06),
  upper = c(10, 10, 10, 10),
  integrControl = integr.control()
)

fitMRMEapprox(
  data,
  start,
  segment = NULL,
  approx_norm_even = approxNormalOrder(5),
  approx_norm_odd = approxNormalOrder(6),
  method = "Nelder-Mead",
  optim.control = list(),
  integrControl = integr.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame whose first column is the observation time, and other
columns are location coordinates. If <code>segment</code> is not <code>NULL</code>,
additional column with the same name given by <code>segment</code> should be
included. This additional column is used to indicate which part of
observations shoule be used to fit model. The value of this column can
be any integer with 0 means discarding this observation and non-0 means
using this obversvation. Using different non-zero numbers indicate different
segments. (See vignette for more details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value of the model, a vector of four components
in the order of rate for moving, rate for resting, volatility, and
s.d. of Guassian measurement error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment</code></td>
<td>
<p>character variable, name of the column which indicates segments,
in the given <code>data.frame</code>. The default value, <code>NULL</code>, means using
whole dataset to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>Lower and upper bound for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_level</code></td>
<td>
<p>print_level passed to nloptr::nloptr. Possible values: 0 (default):
no output; 1: show iteration number and value of objective function; 2: 1 + show
value of (in)equalities; 3: 2 + show value of controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>a list of control parameters for the <code>integrate</code>
function: rel.tol, abs.tol, subdivision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx_norm_even, approx_norm_odd</code></td>
<td>
<p>numeric matrixes specify the
discrete distributions used to approximate standard normal distribution.
The first column is support of discrete distribution and the second
column is probability mass function. <code>approx_norm_even</code> is used to
approximate even step error and <code>approx_norm_odd</code> is used to
approximate odd step error. We mention that the supports of these two
discrete distributions should not have any common elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method argument to feed <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>a list of control to be passed to <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the esimated parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>maximized loglikelihood or composite loglikelihood
evaluated at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>convergence code from <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>fitted data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Hu, C., Elbroch, L.M., Meyer, T., Pozdnyakov, V. and Yan, J. (2021),
Moving-resting process with measurement error in animal movement modeling.
Methods in Ecology and Evolution. doi:10.1111/2041-210X.13694
</p>


<h3>Examples</h3>

<pre><code class="language-R">## time consuming example
#tgrid &lt;- seq(0, 10*100, length=100)
#set.seed(123)
#dat &lt;- rMRME(tgrid, 1, 0.5, 1, 0.01, "m")

## fit whole dataset to the MRME model
#fit &lt;- fitMRME(dat, start=c(1, 0.5, 1, 0.01))
#fit

## fit whole dataset to the MRME model with naive composite likelihood
#fit.naive &lt;- fitMRME_naive(dat, start=c(1, 0.5, 1, 0.01))
#fit.naive

## fit whole dataset to the MRME model with approximate error
#fit.approx &lt;- fitMRMEapprox(dat, start=c(1, 0.5, 1, 0.01))
#fit.approx

## fit part of dataset to the MR model
#batch &lt;- c(rep(0, 5), rep(1, 17), rep(0, 4), rep(2, 30), rep(0, 4), rep(3, 40))
#dat.segment &lt;- cbind(dat, batch)
#fit.segment &lt;- fitMRME(dat.segment, start = c(1, 0.5, 1, 0.01), segment = "batch")
#fit.segment.approx &lt;- fitMRMEapprox(dat.segment, start = c(1, 0.5, 1, 0.01), segment = "batch")
#head(dat.segment)
#fit.segment

</code></pre>


</div>