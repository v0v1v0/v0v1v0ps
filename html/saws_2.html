<div class="container">

<table style="width: 100%;"><tr>
<td>clogistCalc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Conditional Logistic Regression fit</h2>

<h3>Description</h3>

<p>Perform conditional logistic regression with output formatted for input into <code>saws</code> which 
will give confidence intervals and p-values. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">clogistCalc(n, m, x, set, initb = NA, h = 1e-04, maxitr = 15,
     epsilon = 1e-08, conf.level = 0.95)
clogistLoglike(n, m, x, beta)
clogistInfo(n, m, x, beta, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of number at risk</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector of number of events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>vector of denoting clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initb</code></td>
<td>
<p>vector of initial parameter estimates, initb=NA uses unconditional logistic regression for initial estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>small value for numeric integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitr</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>convergence criteria (see details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> confidence level for confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of current parameter estimate</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main program is <code>clogistCalc</code>. It calls  <code>clogistLoglike</code> and 
<code>clogistInfo</code> which are not to be called explicitly. The function
<code>clogistLoglike</code> finds the loglikelihood using recursive methods, 
and <code>clogistInfo</code> calculates score vector and information
matrix using numerical methods. Both methods are described in Gail, Lubin and Rubinstein (1981), and the h value is 
the same as is defined in that paper. 
</p>
<p>The algorithm stops when the largest absolute relative change in either the loglikelihood or in any parameter 
is less than epsilon. For parameters close to zero (i.e., less than 0.01 in absolute value) the relative change 
is defined as change/0.01.
</p>


<h3>Value</h3>

<p>A list for input into the <code>saws</code> function, containing  
the following elements (K=number of clusters, p=number of parameters):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>p by 1 vector of parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>K by p matrix of scores or estimating equations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>K by p by p array of -1*information</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Fay, modeled after a Fortran program by Doug Midthune</p>


<h3>References</h3>

<p>     Gail, Lubin and Rubinstein (1981) Biometrika, 703-707 </p>


<h3>See Also</h3>

<p> See also <code>saws</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(micefat)
cout&lt;-clogistCalc(micefat$N,micefat$NTUM,micefat[,c("fatCal","totalCal")],micefat$cluster)
## usual model based variance
saws(cout,method="dm")
## sandwich based variance with small sample correction
s3&lt;-saws(cout,method="d3")
s3
print.default(s3)
</code></pre>


</div>