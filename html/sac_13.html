<div class="container">

<table style="width: 100%;"><tr>
<td>plots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualized Model Diagnostic and Loglikelihood Plot</h2>

<h3>Description</h3>

<p>Plot and compare the empirical likelihood and semiparametric empirical
likelihood distribution functions, plot loglikelihood function. </p>


<h3>Usage</h3>

<pre><code class="language-R">Graf.Diagnostic(x, k, m, Alpha, Beta, Color, LTY, xlab = "x", 
    ylab = "Estimated DF's", main = "Model Diagnostic", 
    OneLegend = TRUE, lgnd1, lgnd2, arw1, arw2, ...)
Plot.ll(x, ll, col, xaxis.lab = NULL, xlab = "k", ylab = "Loglikelihood", 
    main = "Plot of Loglikelihood",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p> loglikelihood function, output of <code>SemiparChangePoint</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p> color code or character string for the loglikelihood curve </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.lab</code></td>
<td>
<p>a vector of character strings or numeric values to be placed at
the tickpoints as <code>labels</code> of <code>axis</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> the estimated change-point, output of <code>SemiparChangePoint</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> = <code>n</code>, the sample size, for <code>"one-change"</code> alternative,
or the estimated second change-point for <code>"epidemic"</code> alternative,
an output of <code>SemiparChangePoint</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p> estimated parameter <code class="reqn">\alpha</code>, output of <code>SemiparChangePoint</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p> estimated parameter <code class="reqn">\beta</code>, output of <code>SemiparChangePoint</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Color</code></td>
<td>
<p>a vector of character strings or color codes for
curves of estimated distribution functions <code class="reqn">\hat F</code>, <code class="reqn">\tilde F</code>,
<code class="reqn">\hat G</code> and <code class="reqn">\tilde G</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LTY</code></td>
<td>
<p> vector of lty's, LTY=c(lty1, lty2, lty3, lty4), corresponds to the above color codes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> character string for x-axis lable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> character string for y-axis lable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> character string for main title </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OneLegend</code></td>
<td>
<p> a logical indicating whether plot one or two legend. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgnd1</code></td>
<td>
<p> a numeric vector of two specify the position of the first legend box </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgnd2</code></td>
<td>
<p> a numeric vector of two specify the position of the second legend box,
if <code>OneLegend</code> = FALSE </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arw1</code></td>
<td>
<p> a numeric vector of four numbers indicating start and end positions of
the first arrows point to curves </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arw2</code></td>
<td>
<p> a numeric vector of four numbers indicating start and end positions of
the second arrows point to curves </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other arguments of function <code>plot</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a> </p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>;
</p>
<p>Guan, Z.(2004) A semiparametric change-point model, <em>Biometrika</em>, 91, 4, 849â€“862.
</p>
<p>Guan, Z. Semiparametric Tests for Changepoints with Epidemic Alternatives.
</p>


<h3>See Also</h3>

<p><code>schapt</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">require(sac) #load the package
k&lt;-30
n&lt;-80
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
res&lt;-SemiparChangePoint(x, alternative = "one.change")
Plot.ll(x, res$ll, col="blue")

## Nile data with one change-point: the annual flows drop in 1898 which corresponds 
## to k=28. It is believed to be caused by the building of the first Aswan dam.
if(! "package:sac" %in% search()) library(sac) 
    #if package sac has not been loaded, load it.
if(! "package:stats" %in% search()) library(stats)
data(Nile)
plot(Nile, type="p")
Nile.res&lt;-SemiparChangePoint(Nile, alternative = "one.change")
Color&lt;-c(1,2,3,4); LTY&lt;-c(1,2,3,4)

## Plots of estimated distribution functions
Graf.Diagnostic(Nile, Nile.res$k.hat, length(Nile), Nile.res$alpha.hat, 
    Nile.res$beta.hat, Color, LTY, xlab = "x", ylab = "Estimated DF's", 
    main="Model Diagnostic for Nile Data", OneLegend = FALSE, lgnd1 = 
    c(1100, 0.15), lgnd2 = c(600, .99), arw1=c(780, .93, 1010, .9),
    arw2 = c(1165, .15, 1015, .24))

## Plot of loglikelihood function
Plot.ll(Nile, Nile.res$ll, col = "blue")
Plot.ll(Nile, Nile.res$ll, col = "blue", xaxis.lab = seq(1871,1970, length = 100), 
    xlab = "Year")
</code></pre>


</div>