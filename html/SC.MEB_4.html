<div class="container">

<table style="width: 100%;"><tr>
<td>ICMEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ICMEM.</h2>

<h3>Description</h3>

<p>The function ICMEM was used to conduct spatial clustering with hidden Markov random field for a sequence of beta and fixed number of clusters
</p>


<h3>Usage</h3>

<pre><code class="language-R">ICMEM(
  y,
  x_int,
  Adj,
  mu_int,
  sigma_int,
  alpha,
  beta_grid,
  PX,
  maxIter_ICM,
  maxIter
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is a matrix of PCs containing gene expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_int</code></td>
<td>
<p>is a vector of initial cluster label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adj</code></td>
<td>
<p>is a matrix containing neighborhood information generated by find_neighbors2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_int</code></td>
<td>
<p>is a initial mean vector. we often generated it by Gaussian mixture model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_int</code></td>
<td>
<p>is a initial co-variance matrix. we often generated it by Gaussian mixture model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>is a intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_grid</code></td>
<td>
<p>is a sequence of smoothing parameter that can be specified by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PX</code></td>
<td>
<p>is a logical value specifying the parameter expansion in EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter_ICM</code></td>
<td>
<p>is the maximum iteration of ICM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>is the maximum iteration of EM algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function ICMEM was used to conduct spatial clustering with hidden Markov random field for fixed beta and fixed number of clusters
</p>


<h3>Value</h3>

<p>a list.
</p>
<p>The item 'x' is the clustering result. 
</p>
<p>The item 'gam' is the posterior probability matrix.
</p>
<p>The item 'ell' is the opposite log-likelihood. 
</p>
<p>The item 'mu' is the mean of each component.
</p>
<p>The item 'sigma' is the variance of each component.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y = matrix(rnorm(50, 0, 1), 25,2)
pos = cbind(rep(1:5, each=5), rep(1:5, 5))
Adj = getneighborhood_fast(pos, 1.2)
beta_grid = c(0.5,1)
G = 2
fit_int = Mclust(y, G = G)
x_gmm &lt;- fit_int$classification
mu_int &lt;- unname(fit_int$parameter$mean)
sigma_int &lt;- unname(fit_int$parameter$variance$sigma) 
alpha &lt;- -log(fit_int$parameter$pro)*0
reslist &lt;- ICMEM(y = y, x_int = x_gmm, Adj = Adj, mu_int = mu_int, sigma_int = sigma_int,
alpha = alpha, beta_grid = beta_grid, 
PX = TRUE, maxIter_ICM = 10, maxIter = 50) 
</code></pre>


</div>