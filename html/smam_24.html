<div class="container">

<table style="width: 100%;"><tr>
<td>fitMRH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Moving-Resting-Handling Model with Embedded Brownian Motion</h2>

<h3>Description</h3>

<p>Fit a Moving-Resting-Handling Model with Embedded Brownian Motion with
animal movement data at discretely observation times by maximizing
a full likelihood. Using <code>segment</code> to fit part of observations to
the model. A practical application of this feature is seasonal analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitMRH(
  data,
  start,
  segment = NULL,
  numThreads = RcppParallel::defaultNumThreads() * 3/4,
  lower = c(0.001, 0.001, 0.001, 0.001, 0.001),
  upper = c(10, 10, 10, 10, 0.999),
  integrControl = integr.control(),
  print_level = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame whose first column is the observation time, and other
columns are location coordinates. If <code>segment</code> is not <code>NULL</code>,
additional column with the same name given by <code>segment</code> should be
included. This additional column is used to indicate which part of
observations shoule be used to fit model. The value of this column can
be any integer with 0 means discarding this observation and non-0 means
using this obversvation. Using different non-zero numbers indicate different
segments. (See vignette for more details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The initial value for optimization, in the order of rate
of moving, rate of resting, rate of handling, volatility and switching
probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment</code></td>
<td>
<p>character variable, name of the column which indicates segments,
in the given <code>data.frame</code>. The default value, <code>NULL</code>, means using
whole dataset to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numThreads</code></td>
<td>
<p>int, the number of threads allocated for parallel
computation. The default setup is 3/4 available threads. If this parameter
is less or equal to 1, the serial computation will be processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>Lower and upper bound for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>Integration control vector includes rel.tol,
abs.tol, and subdivisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_level</code></td>
<td>
<p>print_level passed to nloptr::nloptr. Possible values: 0 (default):
no output; 1: show iteration number and value of objective function; 2: 1 + show
value of (in)equalities; 3: 2 + show value of controls.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of estimation result with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>maximized loglikelihood or composite loglikelihood
evaluated at the estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>convergence code from <code>nloptr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>fitted data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Pozdnyakov, V., Elbroch, L.M., Hu, C. et al. On Estimation for
Brownian Motion Governed by Telegraph Process with Multiple Off States.
Methodol Comput Appl Probab 22, 1275â€“1291 (2020).
doi:10.1007/s11009-020-09774-1
</p>


<h3>See Also</h3>

<p><code>rMRH</code> for simulation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## time consuming example
set.seed(06269)
tgrid &lt;- seq(0, 400, by = 8)
dat &lt;- rMRH(tgrid, 4, 0.5, 0.1, 5, 0.8, 'm')
fitMRH(dat, c(4, 0.5, 0.1, 5, 0.8)) ## parallel process
fitMRH(dat, c(4, 0.5, 0.1, 5, 0.8), numThreads = -1) ## serial process

## fit part of dataset to the MRH model
batch &lt;- c(rep(0, 10), rep(1, 7), rep(0, 10), rep(2, 10), rep(0, 14))
dat.segment &lt;- cbind(dat, batch)
fit.segment &lt;- fitMRH(dat.segment, start = c(4, 0.5, 0.1, 5, 0.8), segment = "batch")
head(dat.segment)
fit.segment

## End(Not run)

</code></pre>


</div>