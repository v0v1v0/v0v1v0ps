<div class="container">

<table style="width: 100%;"><tr>
<td>locmeasures2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Binary Image Measures
</h2>

<h3>Description</h3>

<p>Calculate some binary image measures between two fields.
</p>


<h3>Usage</h3>

<pre><code class="language-R">locmeasures2d(object, which.stats = c("bdelta", "haus", "qdmapdiff", 
    "med", "msd", "ph", "fom"), distfun = "distmapfun", distfun.params = NULL, 
    k = NULL, alpha = 0.1, bdconst = NULL, p = 2, ...)

## Default S3 method:
locmeasures2d(object, which.stats = c("bdelta", "haus", "qdmapdiff", 
    "med", "msd", "ph", "fom"), distfun = "distmapfun", distfun.params = NULL, 
    k = NULL, alpha = 0.1, bdconst = NULL, p = 2, ..., Y, thresholds=NULL)

## S3 method for class 'SpatialVx'
locmeasures2d(object, which.stats = c("bdelta", "haus", "qdmapdiff", 
    "med", "msd", "ph", "fom"), distfun = "distmapfun", distfun.params = NULL, 
    k = NULL, alpha = 0.1, bdconst = NULL, p = 2, ..., time.point = 1, 
    obs = 1, model = 1)

## S3 method for class 'locmeasures2d'
print(x, ...)

## S3 method for class 'locmeasures2d'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>For <code>locmeasures2d</code>, an object of class “SpatialVx” or a valid matrix in which case <code>Y</code> must be explicitly provided.  For <code>summary</code> method function, a list object output from <code>locmeasures2d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>returned object from <code>locmeasures2d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.stats</code></td>
<td>

<p>character vector telling which measures should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distfun</code></td>
<td>
<p>character naming a function to calculate the shortest distances between each point x in the grid and the set of events.  Default is the Euclidean distance metric. Must take <code>x</code> as an argument, which is the event field for which the distances are to be calculated.  Must return a matrix of the same dimension as x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distfun.params</code></td>
<td>
<p>list with named components giving any additional arguments to the <code>distfun</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>numeric vector for use with the partial Hausdorff distance.  For k that are whole numerics or integers &gt;= 1, then the k-th highest value is returned by <code>locmeasures2d</code>.  If 0 &lt;= k &lt; 1, then the corresponding quantile is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric giving the alpha parameter for Pratt's Figure of Merit (FOM).  See the help file for <code>locperf</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdconst</code></td>
<td>

<p>numeric giving the cut-off value for Baddeley's delta metric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>numeric vector giving one or more values for the parameter p in Baddeley's delta metric.  Usually this is just 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>m X n matrix giving the forecast field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>numeric or two-column matrix giving the threshold to be applied to the verification (column one) and forecast (column two) fields.  If a vector, same thresholds are applied to both fields.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.point</code></td>
<td>
<p>numeric or character indicating which time point from the “SpatialVx” verification set to select for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs, model</code></td>
<td>
<p>numeric indicating which observation/forecast model to select for the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments to <code>deltametric</code> and <code>distmap</code> from package spatstat.  Not used by the <code>summary</code> or <code>print</code> methods here.  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is useful to introduce some notation.  Let d(x,A) be the shortest distance from a point x, anywhere in the grid, to a set A contained in the grid.  Here, Euclidean distance is used (default) for d(x,A), but note that some papers (e.g., Venugopal et al., 2005) use other distances, such as the taxi-cab distance (use <code>distfun</code> argument to change the distance method).
</p>
<p>The Hausdorff distance between two sets A and B contained in the finite grid is given by max( max( d(x,A), x in B), max( d(x,B), x in A)), and can be re-written as H(A,B) = max( abs( d(x,A) - d(x,B))), where x is taken over all points in the grid.  Several of the distances here are modifications of the Hausdorff distance.  The Baddeley metric, for example, is the Lp norm of abs( w(d(x,A)) - w(d(x,B))), where again x is taken from over the entire grid, and w is any concave continuous function that is strictly increasing at zero.  Here, w(t) = min( t, c), where c is some constant given by the <code>bdconst</code> argument.
</p>
<p>Calculates one or more of the following binary image measures:
</p>
<p>“bdelta” Baddeley delta metric (Baddeley, 1992a,b; Gilleland, 2011; Schwedler and Baldwin, 2011)
</p>
<p>“haus” Hausdorff distance (Baddeley, 1992b; Schwedler and Baldwin, 2011)
</p>
<p>“qdmapdiff” Quantile (or rank) of the differences in distance maps.  See the help file for <code>locperf</code>.
</p>
<p>“med” Mean Error Distance (Peli and Malah, 1982; Baddeley, 1992a).  See the help file for <code>locperf</code>.
</p>
<p>“msd” Mean Square Error Distance (Peli and Malah, 1982; Baddeley, 1992a).  See the help file for <code>locperf</code>.
</p>
<p>“ph” Partial Hausdorff distance.  See the help file for <code>locperf</code>.
</p>
<p>“fom” Pratt's Figure of Merit (Peli and Malah, 1982; Baddeley, 1992a, Eq (1)).  See the help file for <code>locperf</code>.
</p>
<p>These distances are summaries in and of themselves, so the summary method function simply displays the results in an easy to read manner.
</p>


<h3>Value</h3>

<p>A list with at least one of the following components depending on the argument which.stats
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bdelta </code></td>
<td>
<p>p by q matrix giving the Baddeley delta metric for each desired value of p (rows) and each threshold (columns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haus</code></td>
<td>
<p>numeric vector giving the Hausdorff distance for each threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qdmapdiff</code></td>
<td>
<p>k by q matrix giving the difference in distance maps for each of the k-th largest value(s) or quantile(s) (rows) for each threshold (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medMiss, medFalseAlarm, msdMiss, msdFalseAlarm</code></td>
<td>
<p>two-row matrix giving the mean error (or square error) distance as (Forecast, Observation) or misses and (Observation, Forecast) or false alarms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ph</code></td>
<td>
<p>k by q matrix giving the k-th largest value(s) or quantile(s) (rows) for each threshold (columns) of the maximum between the distances from one field to the other.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fom</code></td>
<td>
<p>numeric vector giving Pratt's figure of merit.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Binary fields are determined by having values &gt;= the thresholds.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Baddeley, A. (1992a)  An error metric for binary images.  In <em>Robust Computer Vision Algorithms</em>, W. Forstner and S. Ruwiedel, Eds., Wichmann, 59–78.
</p>
<p>Baddeley, A. (1992b)  Errors in binary images and an Lp version of the Hausdorff metric.  <em>Nieuw Arch. Wiskunde</em>, <b>10</b>, 157–183.
</p>
<p>Gilleland, E. (2011)  Spatial forecast verification: Baddeley's delta metric applied to the ICP test cases.  <em>Wea. Forecasting</em>, <b>26</b>, 409–415, doi:10.1175/WAF-D-10-05061.1.  
</p>
<p>Peli, T. and Malah, D. (1982) A study on edge detection algorithms.  <em>Computer Graphics and Image Processing</em>, <b>20</b>, 1–21.
</p>
<p>Schwedler, B. R. J. and Baldwin, M. E. (2011)  Diagnosing the sensitivity of binary image measures to bias, location, and event frequency within a forecast verification framework.  <em>Wea. Forecasting</em>, <b>26</b>, 1032–1044, doi:10.1175/WAF-D-11-00032.1.
</p>
<p>Venugopal, V., Basu, S. and Foufoula-Georgiou, E. (2005) A new metric for comparing precipitation patterns with an application to ensemble forecasts.  <em>J. Geophys. Res.</em>, <b>110</b>, D08111, doi:10.1029/2004JD005395, 11pp.
</p>


<h3>See Also</h3>

<p><code>deltametric</code>, <code>distmap</code>, <code>make.SpatialVx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- y &lt;- matrix(0, 10, 12)
x[2,3] &lt;- 1
y[4,7] &lt;- 1

hold &lt;- make.SpatialVx(x, y, thresholds = 0.1,
    field.type = "random", units = "grid squares")
locmeasures2d(hold, k = 1)

# Alternatively ...
locmeasures2d(x, thresholds = 0.1, k = 1, Y = y)

## Not run: 
data( "geom000" )
data( "geom001" )
data( "ICPg240Locs" )

hold &lt;- make.SpatialVx( geom000, geom001, thresholds = c(0.1, 50.1), 
    projection = TRUE, map=TRUE, loc = ICPg240Locs, loc.byrow = TRUE,
    field.type = "Precipitation", units = "in/100",
    data.name= "ICP Geometric Cases", obs.name = "geom000",
    model.name = "geom001" )

hold2 &lt;- locmeasures2d(hold, k=c(4, 0.975), alpha=c(0.1,0.9))
summary(hold2)

## End(Not run)
</code></pre>


</div>