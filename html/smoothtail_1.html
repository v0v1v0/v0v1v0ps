<div class="container">

<table style="width: 100%;"><tr>
<td>smoothtail-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth Estimation of GPD Shape Parameter</h2>

<h3>Description</h3>

<p>Given independent and identically distributed observations <code class="reqn">X_1 &lt; \ldots &lt; X_n</code> from a 
Generalized Pareto distribution with shape parameter <code class="reqn">\gamma \in [-1,0]</code>, offers three 
methods to compute estimates of <code class="reqn">\gamma</code>. The estimates are based on the principle of replacing the order 
statistics <code class="reqn">X_{(1)}, \ldots, X_{(n)}</code> of the sample by quantiles <code class="reqn">\hat X_{(1)}, \ldots, \hat X_{(n)}</code> of the distribution function <code class="reqn">\hat F_n</code> based on the 
log–concave density estimator <code class="reqn">\hat f_n</code>. This procedure is justified by the fact that the GPD density is 
log–concave for <code class="reqn">\gamma \in [-1,0]</code>.</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> smoothtail </td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 2.0.5 </td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2016-07-12 </td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Use this package to estimate the shape parameter <code class="reqn">\gamma</code> of a Generalized Pareto Distribution (GPD). In 
extreme value theory, <code class="reqn">\gamma</code> is denoted tail index. We offer three new estimators, all based on the fact 
that the density function of the GPD is log–concave if <code class="reqn">\gamma \in [-1,0]</code>, see Mueller and Rufibach (2009). 
The functions for estimation of the tail index are:
</p>
<p><code>pickands</code> <br><code>falk</code><br><code>falkMVUE</code><br><code>generalizedPick</code>
</p>
<p>This package depends on the package <span class="pkg">logcondens</span> for estimation of a log–concave density: all the above functions take as first argument a <code>dlc</code> object as generated by <code>logConDens</code> in <span class="pkg">logcondens</span>.
</p>
<p>Additionally, functions for density, distribution function, quantile function and random number generation for
a GPD with location parameter 0, shape parameter <code class="reqn">\gamma</code> and scale parameter <code class="reqn">\sigma</code> are provided:
</p>
<p><code>dgpd</code><br><code>pgpd</code><br><code>qgpd</code><br><code>rgpd</code>.
</p>
<p>Let us shortly clarify what we mean with log–concave density estimation. Suppose we are given an ordered sample
<code class="reqn">Y_1 &lt; \ldots &lt; Y_n</code> of i.i.d. random variables having density function <code class="reqn">f</code>, where <code class="reqn">f = \exp \varphi</code>
for a concave function <code class="reqn">\varphi : [-\infty, \infty) \to R</code>. Following the development in 
Duembgen and Rufibach (2009), it is then possible to get an estimator <code class="reqn">\hat f_n = \exp \hat \varphi_n</code> 
of <code class="reqn">f</code> via the maximizer <code class="reqn">\hat \varphi_n</code> of
</p>
<p style="text-align: center;"><code class="reqn">L(\varphi) =  \sum_{i=1}^n \varphi(Y_i) -  \int \exp \varphi (t) d t</code>
</p>

<p>over all concave functions <code class="reqn">\varphi</code>. It turns out that <code class="reqn">\hat \varphi_n</code> is piecewise linear, with 
knots only at (some of the) observation points. Therefore, the infinite-dimensional optimization problem of finding 
the function <code class="reqn">\hat \varphi_n</code> boils down to a finite dimensional problem of finding the vector <code class="reqn">(\hat \varphi_n(Y_1),\ldots,\hat \varphi(Y_n))</code>. 
How to solve this problem is
described in Rufibach (2006, 2007) and in a more general setting in Duembgen, Huesler, and Rufibach (2010). The distribution function based on <code class="reqn">\hat f_n</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\hat F_n(x) = \int_{Y_1}^x \hat f_n(t) d t</code>
</p>

<p>for <code class="reqn">x</code> a real number. The definition of <code class="reqn">\hat F_n</code> is justified by the fact that <code class="reqn">\hat F_n(Y_1) = 0</code>.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> , <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br><a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Duembgen, L. and Rufibach, K. (2009)
Maximum likelihood estimation of a log–concave density and its distribution function: basic properties and uniform consistency. 
<em>Bernoulli</em>, <b>15(1)</b>, 40–68.  
</p>
<p>Duembgen, L., Huesler, A. and Rufibach, K. (2010)
Active set and EM algorithms for log-concave densities based on complete and censored data.
Technical report 61, IMSV, Univ. of Bern, available at <a href="http://arxiv.org/abs/0707.4643">http://arxiv.org/abs/0707.4643</a>.
</p>
<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155–1167.
</p>
<p>Mueller, S. and Rufibach K. (2008).
On the max–domain of attraction of distributions with log–concave densities.
<em>Statist. Probab. Lett.</em>, <b>78</b>, 1440–1444.
</p>
<p>Rufibach K. (2006) <em>Log-concave Density Estimation and Bump Hunting for i.i.d. Observations.</em>
PhD Thesis, University of Bern, Switzerland and Georg-August University of Goettingen, Germany, 2006.
<br> Available at <a href="http://www.zb.unibe.ch/download/eldiss/06rufibach_k.pdf">http://www.zb.unibe.ch/download/eldiss/06rufibach_k.pdf</a>.
</p>
<p>Rufibach, K. (2007)
Computing maximum likelihood estimators of a log-concave density function.
<em>J. Stat. Comput. Simul.</em>, <b>77</b>, 561–574.
</p>


<h3>See Also</h3>

<p>Package <span class="pkg">logcondens</span>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

# compute known endpoint
omega &lt;- -1 / gam

# estimate log-concave density, i.e. generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# plot distribution functions
s &lt;- seq(0.01, max(x), by = 0.01)
plot(0, 0, type = 'n', ylim = c(0, 1), xlim = range(c(x, s))); rug(x)
lines(s, pgpd(s, gam), type = 'l', col = 2)
lines(x, 1:n / n, type = 's', col = 3)
lines(x, est$Fhat, type = 'l', col = 4)
legend(1, 0.4, c('true', 'empirical', 'estimated'), col = c(2 : 4), lty = 1)

# compute tail index estimators for all sensible indices k
falk.logcon &lt;- falk(est)
falkMVUE.logcon &lt;- falkMVUE(est, omega)
pick.logcon &lt;- pickands(est)
genPick.logcon &lt;- generalizedPick(est, c = 0.75, gam0 = -1/3)

# plot smoothed and unsmoothed estimators versus number of order statistics
plot(0, 0, type = 'n', xlim = c(0,n), ylim = c(-1, 0.2))
lines(1:n, pick.logcon[, 2], col = 1); lines(1:n, pick.logcon[, 3], col = 1, lty = 2)
lines(1:n, falk.logcon[, 2], col = 2); lines(1:n, falk.logcon[, 3], col = 2, lty = 2)
lines(1:n, falkMVUE.logcon[,2], col = 3); lines(1:n, falkMVUE.logcon[,3], col = 3, 
    lty = 2)
lines(1:n, genPick.logcon[, 2], col = 4); lines(1:n, genPick.logcon[, 3], col = 4, 
    lty = 2)
abline(h = gam, lty = 3)
legend(11, 0.2, c("Pickands", "Falk", "Falk MVUE", "Generalized Pickands'"), 
    lty = 1, col = 1:8)
</code></pre>


</div>