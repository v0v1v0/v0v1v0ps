<div class="container">

<table style="width: 100%;"><tr>
<td>run_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function that optimizes sinusoid parameters to fit d18O data</h2>

<h3>Description</h3>

<p>The second core function of the ShellChron growth model. Loops
through all data windows and uses the <code>growth_model</code> function
to create d18O series that match the input data. This step is
iterated and optimized (minimizing the Sum of Squared Residuals)
through the SCEUA algorithm (by Duan et al., 1992) which finds
the optimal input parameters to the growth rate and Sea Surface
Temperature (SST) sinusoids to simulate d18O data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_model(
  dat,
  dynwindow,
  transfer_function = "KimONeil97",
  d18Ow = 0,
  T_per = 365,
  G_per = 365,
  t_int = 1,
  t_maxtemp = 182.5,
  SCEUApar = c(1, 25, 10000, 5, 0.01, 0.01),
  sinfit = TRUE,
  MC = 1000,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Matrix containing the input data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dynwindow</code></td>
<td>
<p>Information on the position and length of modeling
windows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transfer_function</code></td>
<td>
<p>Transfer function used to convert d18Oc to temperature
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d18Ow</code></td>
<td>
<p>Either a single value (constant d18Ow) or a vector of length
equal to the period in SST data (365 days by default) containing information
about seasonality in d18Ow. Defaults to constant d18Ow of 0 permille VSMOW
(the modern mean ocean value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_per</code></td>
<td>
<p>Period of SST sinusoid (in days; default = 365)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G_per</code></td>
<td>
<p>Period of growth rate sinusoid (in days; default = 365)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_int</code></td>
<td>
<p>Time interval (in days; default = 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_maxtemp</code></td>
<td>
<p>Timing of the warmest day of the year (in julian day;
default = 182.5, or May 26th halfway through the year)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SCEUApar</code></td>
<td>
<p>Parameters for SCEUA optimization (iniflg, ngs, maxn, kstop
pcento, peps). For details, refer to Duan et al. (1992) in references</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sinfit</code></td>
<td>
<p>Apply sinusoidal fitting to guess initial parameters for SCEUA
optimization? <code>TRUE/FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>Number of Monte Carlo simulations to apply for error propagation
Default = 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Should results of modeling be plotted? <code>TRUE/FALSE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the <code>resultarray</code> which contains the full
result of all simulations on each data window and the <code>parmat</code> listing
all optimized growth rate and SST parameters used to model d18O in each data
window
</p>


<h3>References</h3>

<p>package dependencies: ggplot2 3.2.1; rtop 0.5.14
Function dependencies: sinreg, d18O_model, growth_model
</p>
<p>doi: <a href="https://doi.org/10.1029/91WR02985">10.1029/91WR02985</a>
</p>


<h3>See Also</h3>

<p>Duan, Qingyun, Soroosh Sorooshian, and Vijai Gupta. "Effective and
efficient global optimization for conceptual rainfall runoff models." Water
resources research 28.4 (1992): 1015-1031. https://doi.org/10.1029/91WR02985
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create dummy input data column by column
dat &lt;- as.data.frame(seq(1000, 40000, 1000))
colnames(dat) &lt;- "D"
dat$d18Oc &lt;- sin((2 * pi * (seq(1, 40, 1) - 8 + 7 / 4)) / 7)
dat$YEARMARKER &lt;- c(0, rep(c(0, 0, 0, 0, 0, 0, 1), 5), 0, 0, 0, 0)
dat$D_err &lt;- rep(100, 40)
dat$d18Oc_err &lt;- rep(0.1, 40)
# Create dummy dynwindow data
dynwindow &lt;- as.data.frame(seq(1, 29, 2))
colnames(dynwindow) &lt;- "x"
dynwindow$y &lt;- rep(12, 15)
# Run model function
resultlist &lt;- run_model(dat = dat,
    dynwindow = dynwindow,
    transfer_function = "KimONeil97",
    d18Ow = 0,
    T_per = 365,
    G_per = 365,
    t_int = 1,
    t_maxtemp = 182.5,
    SCEUApar = c(1, 25, 10000, 5, 0.01, 0.01),
    sinfit = TRUE,
    MC = 1000,
    plot = FALSE)
</code></pre>


</div>