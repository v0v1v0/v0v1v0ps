<div class="container">

<table style="width: 100%;"><tr>
<td>spfda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse Function-on-scalar Regression with Group Bridge Penalty</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p> Function-on-scalar regression model, denote
\(n\) as total number of observations, \(p\) the number of
coefficients, \(K\) as the number of B-splines, \(T\) as total
time points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spfda(
  Y,
  X,
  lambda,
  time = seq(0, 1, length.out = ncol(Y)),
  nsp = "auto",
  ord = 4,
  alpha = 0.5,
  W = NULL,
  init = NULL,
  max_iter = 50,
  inner_iter = 50,
  CI = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric \(n \times T\) matrix, response function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric \(n \times p\) matrix, design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Regularization parameter \(\gamma\)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time domain, numerical length of \(T\)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsp</code></td>
<td>
<p>Integer or 'auto', number of B-splines \(K\);
default is 'auto'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>B-spline order, default is <code>4</code>; must be \(\geq 3\)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Bridge parameter \(\alpha\), default is <code>0.5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>A \(T \times T\) weight matrix or <code>NULL</code>
(identity matrix); default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Initial \(\gamma\); default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Number of outer iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner_iter</code></td>
<td>
<p>Number of \(ADMM\) iterations (inner steps)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Logical, whether to calculate theoretical confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements "Functional Group Bridge for Simultaneous
Regression and Support Estimation" (<a href="https://arxiv.org/abs/2006.10163">https://arxiv.org/abs/2006.10163</a>).
The model estimates functional coefficients \(\beta(t)\) under model
\[y(t) = X\beta(t) + \epsilon(t)\] with B-spline basis expansion
\[\beta(t) = \gamma B(t) + R(t), \] where \( R(t) \) is B-spline
approximation error. The objective function
\[
\left\| (Y-X\gamma B)W \right\|_{2}^{2} + \sum_{j,m}
\left\| \gamma_{j}^{T}\mathbf{1}(B^{t} &gt; 0) \right\|_{1}^{\alpha}.
\]
The input response variable is a matrix. If \(y_{i}(t)\) are observed
at different time points, please interpolate (e.g.
<code>kernel</code>) before feeding in.
</p>


<h3>Value</h3>

<p>A <code>spfda.model</code> object (environment) with following elements:
</p>

<dl>
<dt>B</dt>
<dd>
<p>B-spline basis functions used</p>
</dd>
<dt>error</dt>
<dd>
<p>Root Mean Square Error ('RMSE')</p>
</dd>
<dt>CI</dt>
<dd>
<p>Whether confidence intervals are calculated</p>
</dd>
<dt>gamma</dt>
<dd>
<p>B-spline coefficient \(\gamma_{p \times K}\)</p>
</dd>
<dt>generate_splines</dt>
<dd>
<p>Function to generate B-splines given time points</p>
</dd>
<dt>K</dt>
<dd>
<p>Number of B-spline basis functions</p>
</dd>
<dt>knots</dt>
<dd>
<p>B-spline knots used to fit the model</p>
</dd>
<dt>predict</dt>
<dd>
<p>Function to predict responses \(\beta(t)\) given new
<code>X</code> and/or time points</p>
</dd>
<dt>raw</dt>
<dd>
<p>A list of raw variables</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
dat &lt;- spfda_simulate()
x &lt;- dat$X
y &lt;- dat$Y

fit &lt;- spfda(y, x, lambda = 5, CI = TRUE)

BIC(fit)

plot(fit, col = c("orange", "dodgerblue3", "darkgreen"),
     main = "Fitted with 95% CI", aty = c(0, 0.5, 1), atx = c(0,0.2,0.8,1))
matpoints(fit$time, t(dat$env$beta), type = 'l', col = 'black', lty = 2)
legend('topleft', c("Fitted", "Underlying"), lty = c(1,2))

print(fit)
coefficients(fit)

</code></pre>


</div>