<div class="container">

<table style="width: 100%;"><tr>
<td>checkResidualProcess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Check the residual process of a fitted <code>twinSIR</code> or <code>twinstim</code>
</h2>

<h3>Description</h3>

<p>Transform the residual process (cf. the
<code>residuals</code> methods for classes
<code>"twinSIR"</code> and <code>"twinstim"</code>) such that the transformed
residuals should be uniformly distributed if the fitted model
well describes the true conditional intensity function. Graphically
check this using <code>ks.plot.unif</code>.
The transformation for the residuals <code>tau</code> is
<code>1 - exp(-diff(c(0,tau)))</code> (cf. Ogata, 1988).
Another plot inspects the serial correlation between the transformed
residuals (scatterplot between <code class="reqn">u_i</code> and <code class="reqn">u_{i+1}</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">checkResidualProcess(object, plot = 1:2, mfrow = c(1,length(plot)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object of class <code>"twinSIR"</code> or <code>"twinstim"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>logical (or integer index) vector indicating if (which) plots of the
transformed residuals should be produced. The <code>plot</code> index 1
corresponds to a <code>ks.plot.unif</code> to check for deviations
of the transformed residuals from the uniform distribution. The
<code>plot</code> index 2 corresponds to a scatterplot of <code class="reqn">u_i</code> vs.
<code class="reqn">u_{i+1}</code>. By default (<code>plot = 1:2</code>), both plots are produced.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>

<p>see <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to <code>ks.plot.unif</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list (returned invisibly, if <code>plot = TRUE</code>) with the following
components:
</p>

<dl>
<dt>tau</dt>
<dd>
<p>the residual process obtained by
<code>residuals(object)</code>.</p>
</dd>
<dt>U</dt>
<dd>
<p>the transformed residuals which should be distributed as
U(0,1).</p>
</dd>
<dt>ks</dt>
<dd>
<p>the result of the <code>ks.test</code> for the uniform
distribution of <code>U</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>References</h3>

<p>Ogata, Y. (1988)
Statistical models for earthquake occurrences and residual analysis
for point processes.
<em>Journal of the American Statistical Association</em>, 83, 9-27
</p>


<h3>See Also</h3>

<p><code>ks.plot.unif</code> and the
<code>residuals</code>-method for classes
<code>"twinSIR"</code> and <code>"twinstim"</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hagelloch")
fit &lt;- twinSIR(~ household, data = hagelloch)  # a simplistic model
## extract the "residual process", i.e., the fitted cumulative intensities
residuals(fit)
## assess goodness of fit based on these residuals
checkResidualProcess(fit)  # could be better
</code></pre>


</div>