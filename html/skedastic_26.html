<div class="container">

<table style="width: 100%;"><tr>
<td>harvey</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Harvey Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the method of
Harvey (1976) for testing for "multiplicative"
heteroskedasticity in a linear regression model.
Mittelhammer et al. (2000) gives the
formulation of the test used here.
</p>


<h3>Usage</h3>

<pre><code class="language-R">harvey(mainlm, auxdesign = NA, statonly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auxdesign</code></td>
<td>
<p>A <code>data.frame</code> or
<code>matrix</code> representing an auxiliary design matrix of
containing exogenous variables that (under alternative hypothesis) are
related to error variance, or a character "fitted.values" indicating
that the fitted <code class="reqn">\hat{y}_i</code> values from OLS should be used.
If set to <code>NA</code> (the default), the
design matrix of the original regression model is used. An intercept
is included in the auxiliary regression even if the first column of
<code>auxdesign</code> is not a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Harvey's Test entails fitting an auxiliary regression model in
which the response variable is the log of the  vector of squared
residuals from the original model and the design matrix <code class="reqn">Z</code>
consists of one or more exogenous variables that are suspected of being
related to the error variance. In the absence of prior information on
a possible choice of <code class="reqn">Z</code>, one would typically use the explanatory
variables from the original model. Under the null hypothesis of
homoskedasticity, the distribution of the test statistic is
asymptotically chi-squared with <code>parameter</code> degrees of freedom.
The test is right-tailed.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Harvey AC (1976).
“Estimating Regression Models with Multiplicative Heteroscedasticity.”
<em>Econometrica</em>, <b>44</b>(3), 461–465.<br><br> Mittelhammer RC, Judge GG, Miller DJ (2000).
<em>Econometric Foundations</em>.
Cambridge University Press, Cambridge.
</p>


<h3>See Also</h3>

<p>the description of the test in
<a href="http://www.econometrics.com/intro/testhet.htm">SHAZAM</a> software
(which produces identical results).
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
harvey(mtcars_lm)
harvey(mtcars_lm, auxdesign = "fitted.values")

</code></pre>


</div>