<div class="container">

<table style="width: 100%;"><tr>
<td>cvx.pen.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Penalized Smooth Convex Regression.
</h2>

<h3>Description</h3>

<p>This function provides an estimate of the non-parametric regression function with a shape constraint of convexity and smoothness constraint provided through square integral of second derivative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvx.pen.reg(x, y, lambda, w = NULL, tol = 1e-05, maxit = 1000,...)
## Default S3 method:
cvx.pen.reg(x, y, lambda, w = NULL, tol = 1e-05, maxit = 1000,...)
## S3 method for class 'cvx.pen.reg'
plot(x,...)
## S3 method for class 'cvx.pen.reg'
print(x,...)
## S3 method for class 'cvx.pen.reg'
predict(object, newdata = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector giving the values of the predictor variable. For <code>plot</code> and <code>print</code> functions, <code>x</code> represents an object of class <code>cvx.pen.reg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector giving the values of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a numeric value giving the penalty value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an optional numeric vector of the same length as x; Defaults to all 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an integer giving the maxmimum number of steps taken by the algorithm; defaults to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a numeric providing the tolerance level for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class ‘cvx.pen.reg’. This is for predict function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a vector of new data points to be used in the predict function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function minimizes 
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^n w_i(y_i - f(x_i))^2 + \lambda\int\{f''(x)\}^2dx</code>
</p>
 
<p>subject to convexity constraint on <code class="reqn">f</code>. <code>plot</code> function provides the scatterplot along with fitted curve; it also includes some diagnostic plots for residuals. Predict function returns a matrix containing the inputted newdata along with the function values, derivatives and second derivatives.
</p>


<h3>Value</h3>

<p>An object of class ‘cvx.pen.reg’, basically a list including the elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x.values</code></td>
<td>
<p>sorted ‘x’ values provided as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.values</code></td>
<td>
<p>corresponding ‘y’ values in input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.values</code></td>
<td>
<p>corresponding fit values of same length as that of ‘x.values’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>corresponding values of the derivative of same length as that of ‘x.values’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of steps taken to complete the iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals obtained from the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvalue</code></td>
<td>
<p>minimum value of the objective function attained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a numeric indicating the convergence of the code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric vector of length 2 less than ‘x’. This represents the coefficients of the B-splines in the second derivative of the estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AlphaMVal</code></td>
<td>
<p>a numeric vector needed for predict function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>a numeric vector needed for predict function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>a numeric vector needed for predict function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arun Kumar Kuchibhotla, arunku@wharton.upenn.edu, 
Rohit Kumar Patra, rohit@stat.columbia.edu.</p>


<h3>Source</h3>

<p>Elfving, T. and Andersson, L. (1988). An Algorithm for Computing Constrained Smoothing Spline Functions. Numer. Math., 52(5):583–595.
</p>
<p>Dontchev, A. L., Qi, H. and Qi, L. (2003). Quadratic Convergence of Newton's Method for Convex Interpolation and Smoothing. Constructive Approximation, 19(1):123-143.
</p>


<h3>Examples</h3>

<pre><code class="language-R">args(cvx.pen.reg)
x &lt;- runif(50,-1,1)
y &lt;- x^2 + rnorm(50,0,0.3)
tmp &lt;- cvx.pen.reg(x, y, lambda = 0.01)
print(tmp)
plot(tmp)
predict(tmp, newdata = rnorm(10,0,0.1))
</code></pre>


</div>