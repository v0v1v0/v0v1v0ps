<div class="container">

<table style="width: 100%;"><tr>
<td>plm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Piecewise linear model / piecewise regression</h2>

<h3>Description</h3>

<p>The <code>plm</code> function computes a piecewise regression model (see Huitema &amp;
McKean, 2000).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plm(
  data,
  dvar,
  pvar,
  mvar,
  AR = 0,
  model = c("W", "H-M", "B&amp;L-B", "JW"),
  family = "gaussian",
  trend = TRUE,
  level = TRUE,
  slope = TRUE,
  contrast = c("first", "preceding"),
  contrast_level = c(NA, "first", "preceding"),
  contrast_slope = c(NA, "first", "preceding"),
  formula = NULL,
  update = NULL,
  na.action = na.omit,
  r_squared = TRUE,
  var_trials = NULL,
  dvar_percentage = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A single-case data frame. See <code>scdf()</code> to learn about this
format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dvar</code></td>
<td>
<p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvar</code></td>
<td>
<p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mvar</code></td>
<td>
<p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR</code></td>
<td>
<p>Maximal lag of autoregression. Modeled based on the
Autoregressive-Moving Average (ARMA) function.  When AR is set, the family
argument must be set to <code>family = "gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model used for calculating the dummy parameters (see Huitema &amp;
McKean, 2000). Default is <code>model = "W"</code>. Possible values are: <code>"B&amp;L-B"</code>,
<code>"H-M"</code>, <code>"W"</code>, and deprecated <code>"JW"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Set the distribution family. Defaults to a gaussian
distribution. See the <code>family</code> function for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>A logical indicating if a trend parameters is included in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>A logical indicating if a level parameters is included in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>A logical indicating if a slope parameters is included in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>Sets contrast_level and contrast_slope. Either "first",
"preceding" or a contrast matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast_level</code></td>
<td>
<p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast_slope</code></td>
<td>
<p>Either "first", "preceding" or a contrast matrix. If NA
contrast_level is a copy of contrast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Defaults to the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the
level effect of the corresponding phase. The parameter 'inter' followed by
the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further variables into the regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>An easier way to change the regression formula (e.g., <code>. ~ . + newvariable</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Defines how to deal with missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_squared</code></td>
<td>
<p>Logical. If TRUE, delta r_squares will be calculated for
each predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_trials</code></td>
<td>
<p>Name of the variable containing the number of trials (only
for binomial regressions). If a single integer is provided this is
considered to be a the constant number of trials across all measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dvar_percentage</code></td>
<td>
<p>Only for binomial distribution. If set TRUE, the
dependent variable is assumed to represent proportions <code style="white-space: pre;">⁠[0,1]⁠</code>. Otherwise
dvar is assumed to represent counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the glm function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>plm formula. Uselful if you want to use the update or
formula argument and you don't know the names of the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Character string from function call (see <code>Arguments</code>
above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.test</code></td>
<td>
<p>F-test values of modelfit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.squares</code></td>
<td>
<p>Explained variance
R squared for each model parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>Autoregression lag from function call (see <code>Arguments</code>
above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Distribution family from function call
(see <code>Arguments</code> above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.model</code></td>
<td>
<p>Full regression model list from the gls or glm function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juergen Wilbert
</p>


<h3>References</h3>

<p>Beretvas, S., &amp; Chung, H. (2008). An evaluation of modified
R2-change effect size indices for single-subject experimental designs.
<em>Evidence-Based Communication Assessment and Intervention, 2</em>,
120-128.
</p>
<p>Huitema, B. E., &amp; McKean, J. W. (2000). Design specification issues in
time-series intervention models. <em>Educational and Psychological
Measurement, 60</em>, 38-58.
</p>


<h3>See Also</h3>

<p>Other regression functions: 
<code>autocorr()</code>,
<code>corrected_tau()</code>,
<code>hplm()</code>,
<code>mplm()</code>,
<code>trend()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compute a piecewise regression model for a random single-case
set.seed(123)
AB &lt;- design(
  phase_design = list(A = 10, B = 20),
  level = list(A = 0, B = 1), slope = list(A = 0, B = 0.05),
  trend = 0.05
)
dat &lt;- random_scdf(design = AB)
plm(dat, AR = 3)

## Another example with a more complex design
A1B1A2B2 &lt;- design(
  phase_design = list(A1 = 15, B1 = 20, A2 = 15, B2 = 20),
  level = list(A1 = 0, B1 = 1, A2 = -1, B2 = 1),
  slope = list(A1 = 0, B1 = 0.0, A2 = 0, B2 = 0.0),
  trend = 0.0)
dat &lt;- random_scdf(design = A1B1A2B2, seed = 123)
plm(dat, contrast = "preceding")

## no slope effects were found. Therefore, you might want to the drop slope
## estimation:
plm(dat, slope = FALSE, contrast = "preceding")

## and now drop the trend estimation as well
plm(dat, slope = FALSE, trend = FALSE, contrast = "preceding")

## A poisson regression
example_A24 %&gt;%
  plm(family = "poisson")

## A binomial regression (frequencies as dependent variable)
plm(exampleAB_score$Christiano, family = "binomial", var_trials = "trials")

## A binomial regression (percentage as dependent variable)
exampleAB_score$Christiano %&gt;%
  transform(percentage = values/trials) %&gt;%
  set_dvar("percentage") %&gt;%
  plm(family = "binomial", var_trials = "trials", dvar_percentage = TRUE)
</code></pre>


</div>