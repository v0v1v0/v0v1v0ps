<div class="container">

<table style="width: 100%;"><tr>
<td>deglmx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions for estimating parameters in the linear/nonlinear mixed models with dynamic covariates.
</h2>

<h3>Description</h3>

<p>Functions for estimating parameters in the linear/nonlinear mixed models with dynamic covariates. Those dynamic covariates will have restricted-shape effects such as monotonic increasing, decreasing or quadratic shape. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">deglmx(fixed, data, dyn.data, id, time, random = NULL, linear = TRUE, ytrend, 
splinetrend = NULL, splinetype = NULL, degree = NULL, knots = NULL, 
weights = NULL, subset = NULL, start, maxiter = 10, method = "BFGS", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>

<p>Formula with fixed effect.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data with id, time, response, and fixed covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dyn.data</code></td>
<td>

<p>Dynamic data with id, time, dynamic covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>The name of the id which is characters or string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>The name of time in the data or dyn.data which is characters or string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>The formula for random parts which should condition on the id.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear</code></td>
<td>

<p>The index of linear or nonlinear. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytrend</code></td>
<td>

<p>If ytrend=1 indicates the increasing trend of the response, if ytrend=-1 indicates the decreasing trend of the response.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splinetrend</code></td>
<td>

<p>They are a vector of trends of dynamic covariate effects. Define 1 as increasing trend and -1 as decreasing trend.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splinetype</code></td>
<td>

<p>They are a vector of the spline basis type which can be chosen among "Ms", "Is", and "Cs".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>

<p>The degree of the spline functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>

<p>The number of knots in the spline functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Weights of the observation. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>Subset of the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>The initial values for covariance and variance matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>The maximum number of iteration in the optimization. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The method of optim function with "BFGS" as default. More details in optim.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other items. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned outputs belong to class of "deglmx".
list(type = type, fit = fit, dat = dat.obj, dyn.mat = cov.mat.tmp, 
ytrend = ytrend, dyncovnames = dyncovnames, dyn.data = dyn.data, 
beta.index = beta.index, call = mfun)
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of the model either linear mixed or nonlinear mixed models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitting results in the model including estimates, residuals, loglikelihood, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>The modified data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dyn.mat</code></td>
<td>
<p>The spline basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytrend</code></td>
<td>
<p>The indication of response trend either increasing (1) or decreasing (-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dyncovnames</code></td>
<td>
<p>Names of dynamic covariates in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dyn.data</code></td>
<td>
<p>The modified dynamic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.index</code></td>
<td>
<p>Indications of parameters in the dyanmic covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call function in the model.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For the nonlinear model, we currently only implement one specific nonlinear relationship.
</p>


<h3>Author(s)</h3>

<p>Yili Hong
</p>


<h3>References</h3>

<p>Hong. Y., Y. Duan, W. Q. Meeker, D. L. Stanley, and X. Gu (2014), Statistical Methods for Degradation Data with Dynamic Covariates Information and an Application to Outdoor Weathering Data, <em>Technometrics</em>, DOI: 10.1080/00401706.2014.915891. 
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(Coatingenv)
 data(Coatingout)
 
 
 fit=deglmx(DAMAGE_Y~UV+RH+TEMP, data=Coatingout, dyn.data=Coatingenv, 
           id="SPEC_NUM", time="TIME", random=~TIME|SPEC_NUM, linear=TRUE, ytrend=-1,  
           splinetrend=c(-1, -1, -1), splinetype=c("Is", "Cs", "Is"), degree=c( 3, 3, 3), 
           knots=c(4, 4, 4), weights=NULL, subset=NULL,start=c(0.017,0.0013,-0.404,0.0176), 
           maxiter=10, method='BFGS')
           
 fit=deglmx(DAMAGE_Y~G/(1+exp(-log(UV+RH+TEMP)/H)), data=Coatingout, dyn.data=Coatingenv, 
           id="SPEC_NUM", time="TIME", random=~G+H|SPEC_NUM, linear=FALSE, ytrend=-1,  
           splinetrend=c(1, 1, 1), splinetype=c("Is", "Cs", "Is"), degree=c( 3, 3, 3), 
           knots=c(4, 4, 4), weights=NULL, subset=NULL, start=c(0.1, 0.1, -0.5, 0.01), 
           maxiter=4)
         
</code></pre>


</div>