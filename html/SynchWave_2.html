<div class="container">

<table style="width: 100%;"><tr>
<td>curve_ext_multi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a Maximum Energy / Minimum Curvature Curves</h2>

<h3>Description</h3>

<p>This function consecutively extracts maximum energy / minimum curvature curves
from a synchrosqueezing representation.
This code is translated from MATLAB Synchrosqueezing Toolbox, version 1.1 developed by Eugene Brevdo (http://www.math.princeton.edu/~ebrevdo/).
</p>


<h3>Usage</h3>

<pre><code class="language-R">curve_ext_multi(Tx, fs, nc, lambda = 1e3, clwin = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tx</code></td>
<td>
<p>same as input to <code>curve_ext</code>. synchrosqueezed output of <code>x</code> (columns associated with time <code>t</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fs</code></td>
<td>
<p>same as input to <code>curve_ext</code>. frequencies associated with rows of <code>Tx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Number of curves to extract</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>same as input to <code>curve_ext</code>. lambda default = 1e3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clwin</code></td>
<td>
<p>frequency clearing window; after curve extraction, a window
of frequencies (<code>Cs[,i]-clwin) : (Cs[,i]+clwin)</code> is removed from the
original representation. (default = 2)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function consecutively extracts maximum energy / minimum curvature curves
from a synchrosqueezing representation. As curves are extracted,
their associated energies are zeroed out in the synsq
representation. Curve extraction is then again performed on
the remaining representaton.
</p>
<p>For more details, see help <code>curve_ext</code> and Sec. IIID of [1].
</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>Cs</code></td>
<td>
<p><code>[N x nc]</code> matrix of curve indices (<code>N=ncol(Tx)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Es</code></td>
<td>
<p><code>[nc x 1]</code> vector of associated (logarithmic) energies</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>[1] Thakur, G., Brevdo, E., Fuckar, N. S. and Wu, H-T. (2013) The Synchrosqueezing algorithm for time-varying spectral analysis: 
Robustness properties and new paleoclimate applications. 
<em>Signal Processing</em>, <b>93</b>, 1079â€“1094.
</p>


<h3>See Also</h3>

<p><code>synsq_cwt_fw</code>, <code>curve_ext</code>, <code>curve_ext_recon</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(7)
tt &lt;- seq(0, 10, , 1024)
nv &lt;- 32
f0 &lt;- (1+0.6*cos(2*tt))*cos(4*pi*tt+1.2*tt^2)
sigma &lt;- 0.5
f &lt;- f0 + sigma*rnorm(length(tt))

# Continuous wavelet transform
opt &lt;- list(type = "bump")
cwtfit &lt;- cwt_fw(f, opt$type, nv, tt[2]-tt[1], opt)

# Hard thresholing
thresh &lt;- est_riskshrink_thresh(cwtfit$Wx, nv)
cwtfit$Wx[which(abs(cwtfit$Wx) &lt; thresh)] &lt;- 0.0

# Denoised signal
opt$gamma &lt;- thresh
fr &lt;- cwt_iw(cwtfit$Wx, opt$type, opt)

# Synchrosqueezed wavelet transform using denoised signal
sstfit2 &lt;- synsq_cwt_fw(tt, fr, nv, opt)

# Ridge extraction
lambda &lt;- 1e+04
nw &lt;- 16
imtfit &lt;- curve_ext_multi(sstfit2$Tx, log2(sstfit2$fs), 1, lambda, nw)

# Reconstruction
curvefit &lt;- curve_ext_recon(sstfit2$Tx, sstfit2$fs, imtfit$Cs, opt, nw)

par(mfrow=c(2,1))
image.plot(list(x=tt, y=sstfit2$fs, z=t(abs(sstfit2$Tx))), log="y", 
    xlab="Time", ylab="Frequency", main="Time-Frequency Representation by SST", 
    col=designer.colors(64, c("azure", "cyan", "blue", "darkblue")), ylim=c(0.5, 25))
lines(tt, sstfit2$fs[imtfit$Cs[,1]], col="red", lty=3, lwd=2)

plot(tt, f0, type="l")
lines(tt, curvefit, lty=2)
</code></pre>


</div>