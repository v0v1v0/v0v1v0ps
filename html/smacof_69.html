<div class="container">

<table style="width: 100%;"><tr>
<td>permtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SMACOF Permutation</h2>

<h3>Description</h3>

<p>These methods perform a permutation test for a symmetric or an unfolding SMACOF model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'smacof'
permtest(object, data,  method.dat = "pearson", nrep = 100, verbose = TRUE, ...)
## S3 method for class 'smacofR'
permtest(object, data = NULL,  method.dat = "rows", nrep = 100, verbose = TRUE, ...)
## S3 method for class 'smacofPerm'
plot(x, alpha = 0.05, main, xlab, ylab, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>"smacofB"</code>, i.e., an MDS solution from <code>smacofSym()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional argument; if provided permutations are performed on the data matrix (see details; ignored for unfolding models)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.dat</code></td>
<td>
<p>If data are provided, this must be one of <code>"pearson"</code>, <code>"spearman"</code>, <code>"kendall"</code>, <code>"euclidean"</code>, <code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>, <code>"binary"</code>. For unfolding models it is either <code>"full"</code> for full permutations or <code>"rows"</code> for permutations within rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, permutation index is printed out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>"smacofPerm"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Alpha level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label of y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional plot arguments for plot function; additional arguments to be passed to <code>sim2diss</code> in permutation functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This routine permutes m dissimilarity values, where m is the number of lower diagonal elements in the corresponding dissimilarity matrix. For each sample a symmetric, nonmetric SMACOF of dimension <code>ndim</code> is computed and the stress values are stored in <code>stressvec</code>. Using the fitted stress value, the p-value is computed. Subsequently, the empirical cumulative distribution function can be plotted using the plot method. 
</p>
<p>If the MDS fit provided on derived proximities of a data matrix, this matrix can be passed to the <code>permtest</code> function. Consequently, the data 
matrix is subject to permutations. The proximity measure used for MDS fit has to match the one used for the permutation test. If a correlation 
similarity is provided, it is converted internally into a dissimilarity using <code>sim2diss</code> with corresponding arguments passed to the
<code>...</code> argument. 
</p>


<h3>Value</h3>

   
<table>
<tr style="vertical-align: top;">
<td><code>stressvec</code></td>
<td>
<p>Vector containing the stress values of the permutation samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stress.obs</code></td>
<td>
<p>Stress (observed sample)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>Resulting p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Model call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobj</code></td>
<td>
<p>Number of objects</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Patrick Mair and Ingwer Borg</p>


<h3>References</h3>

<p>Mair, P., Borg, I., and Rusch, T. (2016). Goodness-of-fit assessment in multidimensional scaling
and unfolding. Multivariate Behavioral Research, 51, 772-789.
</p>
<p>Mair, P, Groenen, P. J. F., De Leeuw, J. (2022). More on multidimensional scaling in R: smacof version 2, Journal of Statistical Software, 102(10), 1-47. <a href="https://doi.org/10.18637/jss.v102.i10">doi:10.18637/jss.v102.i10</a>
</p>


<h3>See Also</h3>

<p><code>jackmds</code>, <code>bootmds</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## permuting the dissimilarity matrix (full)
data(kinshipdelta)
fitkin &lt;- mds(kinshipdelta, ndim = 2, type = "interval")
set.seed(222)
res.perm &lt;- permtest(fitkin)
res.perm
plot(res.perm)

## permuting the data matrix
GOPdtm[GOPdtm &gt; 1] &lt;- 1     ## use binary version
diss1 &lt;- dist(t(GOPdtm[,1:10]), method = "binary")  ## Jaccard distance
fitgop1 &lt;- mds(diss1, type = "ordinal")
fitgop1
set.seed(123)
permtest(fitgop1, GOPdtm[,1:10], nrep = 10, method.dat = "binary")

rmat &lt;- cor(GOPdtm[,1:10], method = "kendall")  ## Kendall correlation
diss2 &lt;- sim2diss(rmat, method = 1)
fitgop2 &lt;- mds(diss2, type = "ordinal")
fitgop2
set.seed(123)
permtest(fitgop2, GOPdtm[,1:10], nrep = 10, method.dat = "kendall", method = 1)

## unfolding permutation
data(breakfast)
res.unfolding &lt;- unfolding(breakfast, ndim = 2)
set.seed(123)
permtest(res.unfolding, nrep = 20, method.dat = "rows")
</code></pre>


</div>