<div class="container">

<table style="width: 100%;"><tr>
<td>sample_size</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Required Sample Size for the Test on Subgroup Existence.</h2>

<h3>Description</h3>

<p>Estimation of the required sample size for the 
test on subgroup existence. With a pre-specified 
significance level of the test <code class="reqn">\alpha</code> and a 
desired power <code class="reqn">1-\beta</code> at a treatment effect 
<code class="reqn">\tau</code>, and other information about data, the 
required sample size that achieves power <code class="reqn">1-\beta</code> 
can be estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_size(outcome, theta0, sigma2, tau, N = 1000L, prob = 0.5, 
            alpha = 0.05, power = 0.9, K = 1000L, M = 1000L, seed = NULL,
            precision = 0.01, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>A formula object.
The model of the indicator function. 
The model must include an intercept.                     
Any lhs variable will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0 </code></td>
<td>
<p>A named numeric vector.
The true parameters of the indicator model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2 </code></td>
<td>
<p>A numeric object.
The variance of the random error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau    </code></td>
<td>
<p>A numeric object.
The desired treatment effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N      </code></td>
<td>
<p>An integer object. 
The number of random samples to draw.
Default value is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob   </code></td>
<td>
<p>A numeric object.
The probability of assigning individuals treatment 1.
<code>0&lt;=prob&lt;=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha  </code></td>
<td>
<p>A numeric object.
The significance level of the test, <code>0&lt;alpha&lt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power  </code></td>
<td>
<p>A numeric object.
The desired power of the test, <code>0&lt;power&lt;1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K      </code></td>
<td>
<p>An integer object. 
The number of random sampled points on the unit ball 
surface <code class="reqn">\{\theta:||\theta||^2=1\}</code>. 
These randomly sampled points are used for approximating 
the Gaussian process in the null and local alternative       
distributions of the test statistic with multivariate    
normal distributions.                                    
It is recommended that K be set to 10^p, where p is the  
number of parameters in theta0.                          
Note that it is recommended that the number of covariates
be less than 10 for this implementation.                 
Default value is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M      </code></td>
<td>
<p>An integer object. 
The number of resamplings of the perturbed test statistic.
This sample is used to calculate the critical value of the
test.
Default and minimum values are 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed   </code></td>
<td>
<p>An integer object or NULL. 
If set, the seed for generating random values set at
the onset of the calculation.
If NULL, current seed in R environment is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>A numeric object.
The precision tolerance for estimating the power from the
calculated sample size.
Specifically, the power of the sample size returned, P,
will be (power - precision) &lt; P &lt; (power + precision).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...    </code></td>
<td>
<p>For each covariate in outcome, user must provide a list
object indicating the distribution function to be sampled
and any parameters to be set when calling that function.
Each list contains "FUN", the function name of the
random generator of the distribution, and any formal
arguments of that function. For example:
x1 = list("FUN" = rnorm, sd = 2.0, mean = 10.0)          
x2 = list("FUN" = rbinom, size = 1, prob = 0.5)          
The number of points generated is determined by input N. 
Most distributions available through R's stats package   
can be used. Exceptions are: rhyper, rsignrank, rwilcox. 
Specifically, any random generator that passes the
the number of observations to generate through formal
argument 'n' can be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size calculation is based on the asymptotic null 
and local alternative distributions of the test statistic. 
More details can be  found in the reference paper.
</p>
<p>The difference between true baseline mean 
function and posited mean function, <code class="reqn">\mu(X)-h(X,\beta_0)</code>, 
is set to zero when calculating the sample size.
</p>
<p>Because the calculated sample size is based on simulated 
data following the null and local alternative distributions 
of the test statistic, the results can be different with 
different choices of <code>M</code> and <code>K</code>, as well as 
different seeds. When the signal <code>tau</code> to noise 
<code>sigma2</code> ratio is large, the calculated sample size 
can be more robust.
</p>


<h3>Value</h3>

<p>A list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n    </code></td>
<td>
<p>An integer object.
The estimated sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>A numeric object.
The estimated power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed </code></td>
<td>
<p>If seed was provided as input, the user specified 
integer seed. If seed was not provided, not present. </p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ailin Fan, Rui Song, and Wenbin Lu, (2016).
Change-plane analysis for subgroup detection and sample size calculation, 
Journal of the American Statistical Association, in press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- ~ x1
theta0 &lt;- c("(Intercept)" = 0.0, "x1" = 1.0)
sample_size(outcome = ~ x1,
            theta0 = theta0,
            N = 1000,
            sigma2 = 0.25,
            tau = 0.25,
            K = 100, 
            M = 1000,
            x1 = list(FUN=runif, min = -1, max = 1))
</code></pre>


</div>