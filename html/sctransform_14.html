<div class="container">

<table style="width: 100%;"><tr>
<td>plot_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot observed UMI counts and model</h2>

<h3>Description</h3>

<p>Plot observed UMI counts and model
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_model(
  x,
  umi,
  goi,
  x_var = x$arguments$latent_var[1],
  cell_attr = x$cell_attr,
  do_log = TRUE,
  show_fit = TRUE,
  show_nr = FALSE,
  plot_residual = FALSE,
  batches = NULL,
  as_poisson = FALSE,
  arrange_vertical = TRUE,
  show_density = FALSE,
  gg_cmds = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The output of a vst run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umi</code></td>
<td>
<p>UMI count matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goi</code></td>
<td>
<p>Vector of genes to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_var</code></td>
<td>
<p>Cell attribute to use on x axis; will be taken from x$arguments$latent_var[1] by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_attr</code></td>
<td>
<p>Cell attributes data frame; will be taken from x$cell_attr by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_log</code></td>
<td>
<p>Log10 transform the UMI counts in plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_fit</code></td>
<td>
<p>Show the model fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_nr</code></td>
<td>
<p>Show the non-regularized model (if available)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_residual</code></td>
<td>
<p>Add panels for the Pearson residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batches</code></td>
<td>
<p>Manually specify a batch variable to break up the model plot in segments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_poisson</code></td>
<td>
<p>Fix model parameter theta to Inf, effectively showing a Poisson model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrange_vertical</code></td>
<td>
<p>Stack individual ggplot objects or place side by side</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_density</code></td>
<td>
<p>Draw 2D density lines over points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg_cmds</code></td>
<td>
<p>Additional ggplot layer commands</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class="language-R">
vst_out &lt;- vst(pbmc, return_cell_attr = TRUE)
plot_model(vst_out, pbmc, 'EMC4')


</code></pre>


</div>