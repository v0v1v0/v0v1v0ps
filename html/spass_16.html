<div class="container">

<table style="width: 100%;"><tr>
<td>rnbinom.gf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Time Series with Negative Binomial Distribution and Multivariate Gamma Frailty with Autoregressive Correlation Structure of Order One</h2>

<h3>Description</h3>

<p><code>rnbinom.gf</code> generates one or more independent time series following the Gamma frailty model. The generated data has negative binomial marginal distribution and the underlying multivariate Gamma frailty an autoregressive covariance structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnbinom.gf(n, size, mu, rho, tp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If length(n) &gt; 1, the length is taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>dispersion parameter (the shape parameter of the gamma mixing distribution). Must be strictly positive, need not be integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of means of time points: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of the underlying autoregressive Gamma frailty. Must be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp</code></td>
<td>
<p>number of observed time points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generated marginal negative binomial distribution with mean <code>mu</code> = <code class="reqn">\mu</code> and <code>size</code> = <code class="reqn">\eta</code> has density
</p>
<p style="text-align: center;"><code class="reqn">(\mu/(\mu+\eta))^x \Gamma(x + \eta)/(\Gamma(x+1)\Gamma(\eta)) (\eta/(\mu+\eta))^\eta</code>
</p>

<p>for <code class="reqn">0 &lt; \mu</code>, <code class="reqn">0 &lt; \eta</code> and <code class="reqn">x=0, 1, 2, ...</code>. Hereby, each entry of vector <code>mu</code> corresponds to
one time point. Therefore, each timepoint can have its distinct mean.
</p>
<p>Within the Gamma frailty model, the correlation between two frailties of time points <code class="reqn">t</code> and <code class="reqn">s</code> for <code>rho</code> = <code class="reqn">\rho</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\rho^|t-s|</code>
</p>

<p>for <code class="reqn">0 \le \rho \le 1</code>. Note: this does not correspond to the correlation of observations.
</p>


<h3>Value</h3>

<p><code>rnbinom.gf</code> returns a matrix of dimension <code>n</code> x <code>tp</code> with marginal negative binomial
distribution with means <code>mu</code>, common dispersion parameter <code>size</code> and a correlation induce by the autoregressive
multivariate Gamma frailty.
</p>


<h3>Source</h3>

<p><code>rnbinom.gf</code> computes observations from a Gamma frailty model by <em>Fiocco et. al. 2009</em> using code contributed by Thomas Asendorf.
</p>


<h3>References</h3>

<p>Fiocco M, Putter H, Van Houwelingen JC, (2009), A new serially correlated gamma-frailty process for longitudinal count data <em>Biostatistics</em> Vol. 10, No. 2, pp. 245-257.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(8)
random&lt;-rnbinom.gf(n=1000, size=0.6, mu=1:6, rho=0.8, tp=6)
cor(random)

#Check the marginal distribution of time point 3
plot(table(random[,3])/1000, xlab="Probability", ylab="Observation")
lines(0:26, dnbinom(0:26, mu=3, size=0.6), col="red")
legend("topright",legend=c("Theoretical Marginal Distribution", "Observed Distribution"),
  col=c("red", "black"), lty=1, lwd=c(1,2))

</code></pre>


</div>