<div class="container">

<table style="width: 100%;"><tr>
<td>bamset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ramsey's BAMSET Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the Bartlett's <code class="reqn">M</code> Specification Error Test
(BAMSET) method of Ramsey (1969) for testing
for heteroskedasticity in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bamset(
  mainlm,
  k = 3,
  deflator = NA,
  correct = TRUE,
  omitatmargins = TRUE,
  omit = NA,
  categorical = FALSE,
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer. The number of subsets (&gt;= 2) into which the BLUS residuals are
to be partitioned. Defaults to 3, the value suggested in
Ramsey (1969).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>A logical. Should the test statistic be divided by a scaling
constant to improve the chi-squared approximation? Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omitatmargins</code></td>
<td>
<p>A logical. Should the indices of observations at the
margins of the <code>k</code> subsets be passed to <code>blus</code> as the
<code>omit</code> argument? If <code>TRUE</code> (the default), this overrides any
<code>omit</code> argument passed directly. If <code>FALSE</code>, the <code>omit</code>
argument must be specified and cannot be left as <code>NA</code>. If
<code>categorical</code> is <code>TRUE</code>, setting <code>omitatmargins</code> to
<code>TRUE</code> results in omitting observations from the most frequently
occurring factor levels or values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>A numeric vector of length <code class="reqn">p</code> (the number of columns in the
linear model design matrix) giving the indices of <code class="reqn">p</code> observations to
omit in the BLUS residual vector; or a character partially matching
<code>"first"</code> (for the first <code class="reqn">p</code>) observations, <code>"last"</code> (for
the last <code class="reqn">p</code> observations), or <code>"random"</code> (for a random sample
of <code class="reqn">p</code> indices between 1 and <code class="reqn">n</code>). Defaults to <code>"first"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>A logical. Is the deflator a categorical variable? If
so, the number of levels will be used as <code class="reqn">k</code> with each level forming
a subset. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>BAMSET is an analogue of Bartlett's <code class="reqn">M</code> Test for heterogeneity
of variances across independent samples from <code class="reqn">k</code> populations. In this
case the populations are <code class="reqn">k</code> subsets of the residuals from a linear
regression model. In order to meet the independence assumption,
BLUS residuals are computed, meaning that only <code class="reqn">n-p</code>
observations are used (where <code class="reqn">n</code> is the number of rows and <code class="reqn">p</code>
the number of columns in the design matrix). Under the null hypothesis
of homoskedasticity, the test statistic is asymptotically chi-squared
distributed with <code class="reqn">k-1</code> degrees of freedom. The test is right-tailed.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Ramsey JB (1969).
“Tests for Specification Errors in Classical Linear Least-Squares Regression Analysis.”
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>31</b>(2), 350–371.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
bamset(mtcars_lm, deflator = "qsec", k = 3)

# BLUS residuals cannot be computed with given `omit` argument and so
# omitted indices are randomised:
bamset(mtcars_lm, deflator = "qsec", k = 4, omitatmargins = FALSE, omit = "last")

</code></pre>


</div>