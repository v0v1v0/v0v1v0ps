<div class="container">

<table style="width: 100%;"><tr>
<td>sampsd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling Simulated Data and Estimates of Multivariate Standard Errors
</h2>

<h3>Description</h3>

<p>Each set of simulated data is sampled many times for each sampling effort, from 2 replicates to those defined as an argument in the function. Then, distance-based multivariate standard errors are estimated using pseudo-variance (for single site evaluation) or Mean Squares Estimates in a linear model (for multisite evaluation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampsd(dat.sim, Par, transformation, method, n, m, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat.sim</code></td>
<td>

<p>A list of data sets generated by <code>simdata</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Par</code></td>
<td>

<p>A list of parameters estimated by <code>assempar</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>

<p>Mathematical function to reduce the weight of very dominant species: 'square root', 'fourth root', 'Log (X+1)', 'P/A', 'none'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The appropriate distance/dissimilarity metric (e.g. Gower, Bray–Curtis, Jaccard, etc). The function <code>vegdist</code> is called for that purpose.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Maximum number of samples to take at each site. Can be equal or less than N
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>Maximum number of sites to sample at each data set. Can be equal or less than sites
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>Number of repetitions of each sampling effort (samples and sites) for each data set
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If several virtual sites have been generated, subsets of sites of size 2 to m are sampled, followed by the selection of sampling units (from 2 to n) using inclusion probabilities and self-weighted two-stage sampling (Tille, 2006). Each combination of sampling effort (number of sample units and sites), are repeated several times (e.g. k = 100) for all simulated matrices. If simulated data correspond to a single site, sampling without replacement is performed several times (e.g. k = 100) for each sample size (from 2 to n) within each simulated matrix. This approach is computationally intensive, especially when k is high (&gt; 10). Keep this in mind as it will affect the time to get results. For each sample, suitable pre-treatments are applied and distance/similarity matrices constructed using the appropriate coefficient. When simulations are done for a single site, the MultSE is estimated as <code class="reqn">\sqrt(V/n)</code>, being V the pseudo variance measured at each sample of size n (Anderson &amp; Santana-Garcon, 2015). When several sites were generated, MultSE are estimated using the residual mean squares and the sites mean squares from a PERMANOVA model (Anderson &amp; Santana-Garcon, 2015).
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>mse.results</code></td>
<td>

<p>A matrix including all estimated MultSE for each simulated data, combination of sample replicates and sites for each k repetition. This matrix will be used by <code>summary_ssp</code></p>
</td>
</tr></table>
<h3>Note</h3>

<p>For quick exploratory analyzes, keep the number of repetitions small. Once you have explored the behavior of the MultSE, you can repeat the process keeping k-values large (e.g. 100). This process will take some time and it will depend on the power of your computer.
</p>


<h3>Author(s)</h3>

<p>Edlin Guerra-Castro (edlinguerra@gmail.com), Juan Carlos Cajas, Juan Jose Cruz-Motta, Nuno Simoes and Maite Mascaro (mmm@ciencias.unam.mx).
</p>


<h3>References</h3>

<p>Anderson, M.J. &amp; Santana-Garcon, J. (2015) Measures of precision for dissimilarity-based multivariate analysis of ecological communities. Ecology Letters, 18, 66-73
</p>
<p>Guerra-Castro, E. J., J. C. Cajas, F. N. Dias Marques Simoes, J. J. Cruz-Motta, and M. Mascaro. (2020). SSP: An R package to estimate sampling effort in studies of ecological communities. bioRxiv:2020.2003.2019.996991.
</p>
<p>Tillé, Y. (2006). Sampling algorithms. Springer, New York, NY.
</p>


<h3>See Also</h3>

<p><code>assempar</code>, <code>simdata</code>, <code>summary_ssp</code>, <code>vegdist</code></p>


<h3>Examples</h3>

<pre><code class="language-R">###To speed up the simulation of these examples, the cases, sites and n were set small.

##Single site: micromollusk from Cayo Nuevo (Yucatan, Mexico)
data(micromollusk)

#Estimation of parameters of pilot data
par.mic&lt;-assempar (data = micromollusk,
                    type= "P/A",
                    Sest.method = "average")

#Simulation of 3 data sets, each one with 20 potential sampling units from a single site
sim.mic&lt;-simdata(par.mic, cases = 3, N = 20, sites = 1)

#Sampling and estimation of MultSE for each sample size (few repetitions to speed up the example)
sam.mic&lt;-sampsd(dat.sim = sim.mic,
               Par = par.mic,
               transformation = "P/A",
               method = "jaccard",
               n = 10,
               m = 1,
               k = 3)

##Multiple sites: Sponges from Alacranes National Park (Yucatan, Mexico).
data(sponges)

#Estimation of parameters of pilot data
par.spo&lt;-assempar(data = sponges,
                  type= "counts",
                  Sest.method = "average")

#Simulation of 3 data sets, each one with 20 potential sampling units in 3 sites.
sim.spo&lt;-simdata(par.spo, cases = 3, N = 20, sites = 3)

#Sampling and estimation of MultSE for each sampling design (few
#repetitions to speed up the example)

sam.spo&lt;-sampsd(dat.sim = sim.spo,
                Par = par.spo,
                transformation = "square root",
                method = "bray",
                n = 10,
                m = 3,
                k = 3)

</code></pre>


</div>