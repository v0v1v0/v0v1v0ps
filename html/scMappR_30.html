<div class="container">

<table style="width: 100%;"><tr>
<td>tissue_scMappR_internal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gene List Visualization and Enrichment (Internal)</h2>

<h3>Description</h3>

<p>This function loops through every signature matrix in a particular tissue and generates heatmaps, cell-type preferences, and co-enrichment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tissue_scMappR_internal(
  gene_list,
  species,
  output_directory,
  tissue,
  rda_path = "",
  cluster = "Pval",
  genecex = 0.01,
  raw_pval = FALSE,
  path = NULL,
  toSave = FALSE,
  drop_unkown_celltype = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gene_list</code></td>
<td>
<p>A list of gene symbols, mouse or human.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>"mouse", "human" or "-9" if using a precomputed signature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_directory</code></td>
<td>
<p>If toSave = TRUE, the name of the output directory that would be built.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tissue</code></td>
<td>
<p>Name of the tissue in "get_tissues".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rda_path</code></td>
<td>
<p>Path to the .rda file containing all of the signature matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>'Pval' or 'OR' depending on if you want to cluster odds ratios or p-values of cell-type preferences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genecex</code></td>
<td>
<p>The size of the gene names of the rows in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw_pval</code></td>
<td>
<p>If the inputted signature matrix are raw (untransformed) p-values â€“ recommended to generate rank first (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_unkown_celltype</code></td>
<td>
<p>Whether or not to remove "unknown" cell-types from the signature matrix (T/F).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes a list of genes and a tissue that is contained in current signature matrices before and generating heatmaps of cell-type preferences.
It then completes cell-type enrichment of each individual cell-type, then, if more than two cell-types are significantly enriched, co-enrichment.
of those enriched cell-types is then computed.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>background_heatmap</code></td>
<td>
<p>Data frame of the entire gene by cell-type signature matrix inputted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_list_heatmap</code></td>
<td>
<p>Data frame of inputted signature matrix subsetted by input genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single_celltype_preferences</code></td>
<td>
<p>Data frame of enriched cell-types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_celtype_preference</code></td>
<td>
<p>Data frame of groups of cell-types enriched by the same genes.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

data(POA_example) # region to preoptic area
Signature &lt;- POA_example$POA_Rank_signature # signature matrix
rowname &lt;- get_gene_symbol(Signature) # get signature
rownames(Signature) &lt;- rowname$rowname
genes &lt;- rownames(Signature)[1:60]
rda_path1 = "" # data directory (if it exists)

# set toSave = TRUE and path = output directory of your choice
internal &lt;- tissue_scMappR_internal(gene_list = genes, species = "mouse",
                                   output_directory = "scMappR_TesInternal",
                                   tissue = "hypothalamus", toSave = FALSE) 

 
</code></pre>


</div>