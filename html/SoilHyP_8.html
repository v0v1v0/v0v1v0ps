<div class="container">

<table style="width: 100%;"><tr>
<td>fitSHP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit soil hydraulic properties</h2>

<h3>Description</h3>

<p>Estimate parameter for soil water retention (SWC) and/or unsaturated hydraulic conductivity function (Ku) using Shuffled Complex Evolution (SCE) optimisation. Parameter can be estimated for van Genuchten-Mualem (vg or vgm) or Peters-Durner-Iden (PDI) parameterisation of the soil hydraulic properties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitSHP(
  obs = list(th = NULL, K = NULL),
  suc = list(th = NULL, K = NULL),
  par = NULL,
  lower = NULL,
  upper = NULL,
  FUN.shp = "vg",
  modality = "uni",
  par.shp = NULL,
  fit = "both",
  weighting = "var",
  log = c("alfa", "n", "ks"),
  control = list(ncomplex = 15, reltol = 1e-07, tolsteps = 7),
  suc.negativ = FALSE,
  integral = FALSE,
  L = NULL,
  log_Ku = TRUE,
  print.info = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>list with named observations (th for water content and K for unsaturated hydraulic conductivity data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suc</code></td>
<td>
<p>list of named suctions corresponding to th and/or K</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a numeric vector of initial parameter values (see also <code>SCEoptim</code>). If missing default values are set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>lower bounds on the parameters. Should be the same length as <code>par</code> and as <code>upper</code>, or length 1 if a bound applies to all parameters. If missing default values are set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper bounds on the parameters. Should be the same length as <code>par</code> and as <code>lower</code>, or length 1 if a bound applies to all parameters. If missing default values are set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN.shp</code></td>
<td>
<p>Funktion for soil hydraulic properties (vG, PDI or bc) (see <code>SWC</code> or <code>Ku</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modality</code></td>
<td>
<p>pore size distribution ('uni' or 'bi')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.shp</code></td>
<td>
<p>fixed parameter value named in list or vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>fit parameter for 'SWC', 'Ku' or 'both' simultaneous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting</code></td>
<td>
<p>weighting between SWC and Ku. Used if fit == both ('var', 'norm' or '2step').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>names of parameter in list or vector which should be logarithmized during optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of options as in <code>optim()</code>, see <code>SCEoptim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suc.negativ</code></td>
<td>
<p>set TRUE if suction/pressure heads are negative and FALSE if positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integral</code></td>
<td>
<p>th as point value vs. suc(h) (FALSE) or th as mean water content over the column divided by the height (L) vs. suc(h) (TRUE) (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>sample height [cm]. Only needed for integral == TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_Ku</code></td>
<td>
<p>logarithmize Ku in the objective function and for weighting (TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.info</code></td>
<td>
<p>print information about default values for par, lower, and upper if missing or fitting accuracy (TRUE or FALSE)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<dl>
<dt>weigthing:<br>
</dt>
<dd>
<p>var: th and K are weighted in the objective fuction by the measurement variance  <br>
norm: th and K are normed in objective fuction<br>
stepwise: the parameter for th are fitted first and the remaining parameter for K afterwards (2step works aswell)</p>
</dd>
</dl>
<dl>
<dt>log:<br>
</dt>
<dd>
<p>The use of log is suggested for paramter 'alfa', 'n' and 'ks' for modality == 'uni'. For modality 'bi' additional 'alfa2' and 'n2' and for Fun.shp == 'pdi' additional 'omega'.
Parameter in output ($par) are not returned logarithmized. <br>
Delfault paramter values for par, lower and upper are logarithmized automatatically <br>
If not the default values for par, lower and upper are taken, parameter which are named in 'log' must be scaled by the user in par, lower and upper.
</p>
</dd>
</dl>
<dl>
<dt>integral:<br>
</dt>
<dd>
<p>The "integral" method is suggested from Peters and Durner (2008, 2015) to fit parameter on data from
experiments were water contents are measured as mean water contents (e.g. simplified evaporation method or multi-step outflow experiments).
Under the assumption that the water content is distributed linear over the column, the measured
mean water content of the column is the integral over the whole column divided by the column length (L).
Under hydraulic equilibrium this is equal to the integral of the retention function over the matric
heads from the lower boundary to the upper boundary of the column divided by the height of the column (Peters 2008, 2015). <br><br>
integral == TRUE can be very slow.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>"fitSHP" class
</p>


<h3>Author(s)</h3>

<p>Ullrich Dettmann
</p>


<h3>References</h3>

<p>Peters, A., &amp; Durner, W. (2008). Simplified evaporation method for determining soil hydraulic properties. Journal of Hydrology, 356(1), 147-162.
</p>
<p>Peters and Durner (2015). SHYPFIT 2.0 Userâ€™s Manual
</p>
<p>Peters, A., Iden, S. C., &amp; Durner, W. (2015). Revisiting the simplified evaporation method: Identification of hydraulic functions considering vapor, film and corner flow. Journal of Hydrology, 527, 531-542.
</p>


<h3>See Also</h3>

<p><code>SCEoptim</code>, <code>SWC</code>, <code>Ku</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data('dataSHP')
# -------------------------------------------------------------------
# fit Soil Hydraulic Properties (SHP)
# -------------------------------------------------------------------
ans &lt;- fitSHP(obs         = list(th = dataSHP$th, K = dataSHP$Ku),
             suc          = list(th = dataSHP$suc, K = dataSHP$suc),
             FUN.shp      = 'vg',
             modality     = 'uni',
             par.shp      =  NULL,
             fit          = 'both',
             weighting    = 'var',
             log          = c('alfa', 'n', 'ks'),
             control      = list(ncomplex = 15, reltol = 1e-07,tolsteps = 7),
             suc.negativ  = TRUE,
             integral     = FALSE,
             L            = 0,
             print.info   = TRUE
)
ans$par
plot(ans)
# --------------------------------------------------------------------
# bimodal van Genuchten-Mualem
ans &lt;- fitSHP(obs         = list(th = dataSHP$th, K = dataSHP$Ku),
             suc          = list(th = dataSHP$suc, K = dataSHP$suc),
             FUN.shp      = 'vg',
             modality     = 'bi',
             par.shp      =  c(),
             fit          = 'both',
             weighting    = 'var',
             log          = c('alfa', 'n', 'ks', 'alfa2', 'n2'),
             suc.negativ  = TRUE,
             integral     = FALSE,
             L            = 0,
             print.info   = TRUE,
             control      = list(ncomplex = 15, reltol = 1e-07,tolsteps = 7)
)
ans$par
plot(ans)

## End(Not run)
</code></pre>


</div>