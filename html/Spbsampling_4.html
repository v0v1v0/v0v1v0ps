<div class="container">

<table style="width: 100%;"><tr>
<td>pwd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Product Within Distance (Spatially Balanced Sampling Design)</h2>

<h3>Description</h3>

<p>Selects spatially balanced samples through the use of the
Product Within Distance design (PWD). To have constant inclusion
probabilities <code class="reqn">\pi_{i}=n/N</code>, where <code class="reqn">n</code> is sample size and
<code class="reqn">N</code> is population size, the distance matrix has to be standardized with
function <code>stprod</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwd(dis, n, beta = 10, nrepl = 1L, niter = 10L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>A distance matrix NxN that specifies how far all the pairs
of units in the population are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Parameter <code class="reqn">\beta</code> for the algorithm. The higher
<code class="reqn">\beta</code> is, the more the sample is going to be spread (default = 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepl</code></td>
<td>
<p>Number of samples to draw (default = 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Maximum number of iterations for the algorithm. More iterations are
better but require more time. Usually 10 is very efficient (default = 10).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following components:
</p>

<ul>
<li> <p><code>s</code>, a matrix <code>nrepl</code> x <code>n</code>, which contains the
<code>nrepl</code> selected samples, each of them stored in a row. In particular,
the i-th row contains all labels of units selected in the i-th sample.
</p>
</li>
<li> <p><code>iterations</code>, number of iterations run by the algorithm.
</p>
</li>
</ul>
<h3>References</h3>

<p>Benedetti R, Piersimoni F (2017). A spatially balanced design with
probability function proportional to the within sample distance.
<em>Biometrical Journal</em>, <strong>59</strong>(5), 1067-1084.
<a href="https://doi.org/10.1002/bimj.201600194">doi:10.1002/bimj.201600194</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1
# Draw 1 sample of dimension 15 without constant inclusion probabilities
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
s &lt;- pwd(dis = dis, n = 15)$s  # drawn sample

# Example 2
# Draw 1 sample of dimension 15 with constant inclusion probabilities
# equal to n/N, with N = population size
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
con &lt;- rep(0, nrow(dis)) # vector of constraints
stand_dist &lt;- stprod(mat = dis, con = con) # standardized matrix
s &lt;- pwd(dis = stand_dist$mat, n = 15)$s  # drawn sample

# Example 3
# Draw 2 samples of dimension 15 with constant inclusion probabilities
# equal to n/N, with N = population size, and an increased level of spread, beta = 20
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
con &lt;- rep(0, nrow(dis)) # vector of constraints
stand_dist &lt;- stprod(mat = dis, con = con) # standardized matrix
s &lt;- pwd(dis = stand_dist$mat, n = 15, beta = 20, nrepl = 2)$s  # drawn samples

</code></pre>


</div>