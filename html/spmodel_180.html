<div class="container">

<table style="width: 100%;"><tr>
<td>splmRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit random forest spatial residual models</h2>

<h3>Description</h3>

<p>Fit random forest spatial residual models
for point-referenced data (i.e., geostatistical models) using
random forest to fit the mean and a spatial linear model to fit the residuals.
The spatial linear model fit to the residuals can incorporate variety of estimation methods,
allowing for random effects, anisotropy, partition factors, and big data methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">splmRF(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A two-sided linear formula describing the fixed effect structure
of the model, with the response to the left of the <code>~</code> operator and
the terms on the right, separated by <code>+</code> operators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or <code>sf</code> object object that contains
the variables in <code>fixed</code>, <code>random</code>, and <code>partition_factor</code>
as well as geographical information. If an <code>sf</code> object is
provided with <code>POINT</code> geometries, the x-coordinates and y-coordinates
are used directly. If an <code>sf</code> object is
provided with <code>POLYGON</code> geometries, the x-coordinates and y-coordinates
are taken as the centroids of each polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional named arguments to <code>ranger::ranger()</code> or <code>splm()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The random forest residual spatial linear model is described by
Fox et al. (2020). A random forest model is fit to the mean portion of the
model specified by <code>formula</code> using <code>ranger::ranger()</code>. Residuals
are computed and used as the response variable in an intercept-only spatial
linear model fit using <code>splm()</code>. This model object is intended for use with
<code>predict()</code> to perform prediction, also called random forest
regression Kriging.
</p>


<h3>Value</h3>

<p>A list with several elements to be used with <code>predict()</code>. These
elements include the function call (named <code>call</code>), the random forest object
fit to the mean (named <code>ranger</code>),
the spatial linear model object fit to the residuals
(named <code>splm</code> or <code>splm_list</code>), and an object can contain data for
locations at which to predict (called <code>newdata</code>). The <code>newdata</code>
object contains the set of
observations in <code>data</code> whose response variable is <code>NA</code>.
If <code>spcov_type</code> or <code>spcov_initial</code> (which are passed to <code>splm()</code>)
are length one, the list has class <code>splmRF</code> and the spatial linear
model object fit to the residuals is called <code>splm</code>, which has
class <code>splm</code>. If
<code>spcov_type</code> or <code>spcov_initial</code> are length greater than one, the
list has class <code>splmRF_list</code> and the spatial linear model object
fit to the residuals is called <code>splm_list</code>, which has class <code>splm_list</code>.
and contains several objects, each with class <code>splm</code>.
</p>
<p>An <code>splmRF</code> object to be used with <code>predict()</code>. There are
three elements: <code>ranger</code>, the output from fitting the mean model with
<code>ranger::ranger()</code>; <code>splm</code>, the output from fitting the spatial
linear model to the ranger residuals; and <code>newdata</code>, the <code>newdata</code>
object, if relevant.
</p>


<h3>Note</h3>

<p>This function does not perform any internal scaling. If optimization is not
stable due to large extremely large variances, scale relevant variables
so they have variance 1 before optimization.
</p>


<h3>References</h3>

<p>Fox, E.W., Ver Hoef, J. M., &amp; Olsen, A. R. (2020). Comparing spatial
regression to random forests for large environmental data sets.
<em>PloS one</em>, 15(3), e0229509.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sulfate$var &lt;- rnorm(NROW(sulfate)) # add noise variable
sulfate_preds$var &lt;- rnorm(NROW(sulfate_preds)) # add noise variable
sprfmod &lt;- splmRF(sulfate ~ var, data = sulfate, spcov_type = "exponential")
predict(sprfmod, sulfate_preds)

</code></pre>


</div>