<div class="container">

<table style="width: 100%;"><tr>
<td>TestRankhist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical tests for rank histograms</h2>

<h3>Description</h3>

<p>Perform statistical tests related to the deviation from flatness of a rank histogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TestRankhist(rank.hist)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>rank.hist</code></td>
<td>
<p>Vector of rank counts. Generated by function 'Rankhist()'</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Given a vector of rank counts 'x', the Pearson Chi^2 statistic is calculated by
</p>
<p>sum((x - sum(x)/length(x))^2 / (sum(x)/length(x)))
</p>
<p>and has a chi^2 distribution with (length(x)-1) degrees of freedom if every rank is equally likely on average.
The Jolliffe-Primo test statistics are calculated by projecting the vector
</p>
<p>(x-sum(x)/length(x)) / sqrt(sum(x)/length(x))
</p>
<p>onto a linear, respectively squared contrast, i.e. a linear and quadratic function defined over the index set 1:length(x), who are mutually orthogonal, whose elements sum to zero, and whose squared elements sum to one. The projections independently have chi^2 distributions with 1 degree of freedom under the null hypothesis of a flat rank histogram.
</p>


<h3>Value</h3>

<p>A dataframe whose columns refer to the Pearson Chi^2 statistic, the Jolliffe-Primo test statistic for slope, and the Jolliffe-Primo test statistic for convexity. The rows refer to the actual test statistic and its p-value under the null hypothesis of a flat rank histogram.
</p>


<h3>References</h3>

<p>Pearson K. (1900): X. On the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling.  Phil. Mag. Series 5, 50(302) doi: <a href="https://doi.org/10.1080/14786440009463897">10.1080/14786440009463897</a>
</p>
<p>Jolliffe I.T., Primo C. (2008): Evaluating rank histograms using decompositions of the chi-square test statistic. Mon. Wea. Rev. 136(6) doi: <a href="https://doi.org/10.1175/2007MWR2219.1">10.1175/2007MWR2219.1</a>
</p>


<h3>See Also</h3>

<p>Rankhist, PlotRankhist
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eurotempforecast)
rh &lt;- Rankhist(ens, obs)
TestRankhist(rh)
</code></pre>


</div>