<div class="container">

<table style="width: 100%;"><tr>
<td>plotNMRspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create and Plot an NMR Spectrum</h2>

<h3>Description</h3>

<p>This function simulates simple NMR spectra.  Only 1st order coupling can be
handled â€“ there is currently no capacity for doublet of doublets and
other such peaks.  The field strength of the "instrument" is taken into
account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotNMRspec(peaks, x.range = c(12, 0), MHz = 300, ppHz = 1,
  nuclei = "1H", pkLabs = TRUE, lab.pos = NULL, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p>A data frame with the following columns: delta, mult
(multiplicity), J, area, pw.  Multiplicity should be given by a number, so
use 2 for a doublet.  J is in Hz (use 0 for singlets).  pw is the peak width
at half-height in Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.range</code></td>
<td>
<p>A numeric vector of length 2 giving the ppm range desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MHz</code></td>
<td>
<p>Integer.  The operating frequency of the instrument, in MHz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppHz</code></td>
<td>
<p>Integer, but numeric works too!
Points per Hz: The number of data points per Hz to use in
calculating the spectrum (passed as argument <code>dd</code> to <code>makeSpec</code>).
The default (1) works well for 1H NMR spectra.  For 13C NMR spectra, where
the peaks are very narrow, one may need to increase the data density so that
enough points define the peaks (a value of 4 is a good starting point).
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuclei</code></td>
<td>
<p>Character.  One of <code>c("1H", "13C")</code>. Controls the spacing
of the tick marks and labeling of the peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pkLabs</code></td>
<td>
<p>Logical.  If <code>TRUE</code>, and <code>nuclei = 1H</code>, the integral
is drawn next to the peak.  If <code>FALSE</code>, no labels are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.pos</code></td>
<td>
<p>A vector of label positions as along as the number of rows in
<code>peaks</code> (the number of peaks in the spectrum).  A numeric vector
where 2 = left and 4 = right.  This adjusts the positions of the labels
to be either left or right of the peak as a way to avoid overlaps.  The
order must correspond to the order in <code>peaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical: Shall a plot be made?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed downstream.  These may affect
the plot.  You can also include <code>noise = some number</code> to add noise
(passed through to <code>makeSpec</code>).  In this case, warnings are raised
from the plotting routines, but they can be ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data frame of the type produced by <code>makeSpec</code>.
See there for details.  x values are in Hz.
</p>


<h3>Details</h3>

<p>Note that this function uses Hz internally so that the <code>x.range</code>, which
is in ppm, is multiplied by <code>Mhz</code> before being sent to
<code>makeSpec</code>, and once there, <code>makeSpec</code> will multiply it by
<code>ppHz</code>.  Thus the total data points used is <code>floor(ppHz * Mhz *
abs(diff(x.range)))</code>.  This approach ensures that peaks are not distorted
when changing <code>x.range</code> for the same <code>peak.list</code>.
</p>
<p>Note that <code>ppHz</code> can be numeric as well, due to the use of <code>floor</code>.
This can be useful: if you wanted your simulated NMR spectrum to be composed
of exactly 16384 data points as real data might be, you can call the function
with <code>ppHz</code> specified like <code>ppHz = 2^14/(12*500)</code> and it works!
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University. <a href="mailto:hanson@depauw.edu">hanson@depauw.edu</a>
</p>


<h3>See Also</h3>

<p><code>lorentzCurve</code>, <code>makeSpec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### A simulated 1H NMR spectrum

peaks1 &lt;- data.frame(
	delta = c(1.3, 3.75, 3.9, 10.2),
	mult = c(3, 4, 2, 1),
	J = c(14, 14, 14, 0),
	area = c(3, 2, 1, 1),
	pw = c(2, 2, 2, 10))

res &lt;- plotNMRspec(peaks1, x.range = c(12, 0), MHz = 500,
	main = "500 MHz Simulated 1H NMR Spectrum")

### Compare to the same data at 200 MHz and plot together

par(mfrow = c(2,1))
res &lt;- plotNMRspec(peaks1, x.range = c(12, 0), MHz = 500,
	main = "500 MHz Simulated 1H NMR Spectrum")
res &lt;- plotNMRspec(peaks1, x.range = c(12, 0), MHz = 200,
	main = "200 MHz Simulated 1H NMR Spectrum")
par(mfrow = c(1,1))

### Zoom in to show off

par(mfrow = c(2,1))
res &lt;- plotNMRspec(peaks1, x.range = c(4.5, 1), MHz = 500,
	main = "500 MHz Simulated 1H NMR Spectrum")
res &lt;- plotNMRspec(peaks1, x.range = c(4.5, 1), MHz = 200,
	main = "200 MHz Simulated 1H NMR Spectrum")
par(mfrow = c(1,1))

### A simulated 13C NMR spectrum

# This is substantially slower due to the large
# chemical shift range

peaks2 &lt;- data.frame(
	delta = c(160, 155, 145, 143, 135, 60, 32),
	mult = rep(1, 7),
	J = rep(1, 7),
	area = c(0.1, 0.3, 0.3, 1, 1, 0.5, 0.5),
	pw = rep(1, 7))

res &lt;- plotNMRspec(peaks2, x.range = c(180, 0), MHz = 200,
	main = "200 MHz Simulated 13C NMR Spectrum", ppHz = 4,
	pkLabs = FALSE, nuclei = "13C")

# Try repeating the above with ppHz = 1; note the peaks heights are not quite right
# as there are not enough data points to define the peak properly.

</code></pre>


</div>