<div class="container">

<table style="width: 100%;"><tr>
<td>harmonic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basis for Harmonic Functions</h2>

<h3>Description</h3>

<p>Evaluates a basis for the harmonic polynomials in <code class="reqn">x</code> and <code class="reqn">y</code>
of degree less than or equal to <code class="reqn">n</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   harmonic(x, y, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector of <code class="reqn">x</code> coordinates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Vector of <code class="reqn">y</code> coordinates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Maximum degree of polynomial
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes a basis for the harmonic polynomials
in two variables <code class="reqn">x</code> and <code class="reqn">y</code> up to a given degree <code class="reqn">n</code>
and evaluates them at given <code class="reqn">x,y</code> locations.
It can be used in model formulas (for example in
the model-fitting functions
<code>lm,glm,gam</code> and 
<code>ppm</code>) to specify a
linear predictor which is a harmonic function.
</p>
<p>A function <code class="reqn">f(x,y)</code> is harmonic if
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial^2}{\partial x^2} f
    + \frac{\partial^2}{\partial y^2}f = 0.</code>
</p>

<p>The harmonic polynomials of degree less than or equal to
<code class="reqn">n</code> have a basis consisting of <code class="reqn">2 n</code> functions.
</p>
<p>This function was implemented on a suggestion of P. McCullagh
for fitting nonstationary spatial trend to point process models.
</p>


<h3>Value</h3>

<p>A data frame with <code>2 * n</code> columns giving the values of the
basis functions at the coordinates. Each column is labelled by an
algebraic expression for the corresponding basis function.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code>ppm</code>,
<code>polynom</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # inhomogeneous point pattern
   X &lt;- unmark(longleaf)
   

   # fit Poisson point process with log-cubic intensity
   fit.3 &lt;- ppm(X ~ polynom(x,y,3), Poisson())

   # fit Poisson process with log-cubic-harmonic intensity
   fit.h &lt;- ppm(X ~ harmonic(x,y,3), Poisson())

   # Likelihood ratio test
   lrts &lt;- 2 * (logLik(fit.3) - logLik(fit.h))
   df &lt;- with(coords(X),
              ncol(polynom(x,y,3)) - ncol(harmonic(x,y,3)))
   pval &lt;- 1 - pchisq(lrts, df=df)
</code></pre>


</div>