<div class="container">

<table style="width: 100%;"><tr>
<td>hauto</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Auto-calibrate Hargreaves model
</h2>

<h3>Description</h3>

<p>Function estimates Hargreaves model coefficients 'A' and 'B' based on autocalibration procedure
</p>


<h3>Usage</h3>

<pre><code class="language-R">hauto(lat, lon, days,extraT = NULL, Tmax, Tmin, tal,
Ha_guess = 0.16, Hb_guess = 0.1, epsilon=0.5, perce = NA) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>

<p>Latitude in decimal degrees.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>

<p>Longitude in decimal degrees.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>days</code></td>
<td>

<p>Vector of class 'Date' of length n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraT</code></td>
<td>

<p>Optional. Vector of length n of extraterrestrial solar radiation [MJm-2]. If 'NULL' then it is calculated by the function. Providing extraterrestrial solar radiation speeds up the computation 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmax</code></td>
<td>

<p>Vector of length n containing daily maximum temperature [C].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmin</code></td>
<td>

<p>Vector of length n containing daily minumum temperature [C].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tal</code></td>
<td>

<p>Clear sky transmissivity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ha_guess</code></td>
<td>

<p>Assumption of Hargreaves Ha coefficient. Default set to 0.16.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hb_guess</code></td>
<td>

<p>Assumption of Hargreaves Hb coefficient. Default set to 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>A value of which potential radiation is decreased. See "details".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perce</code></td>
<td>

<p>Percent of clear days. Default set to 1.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The auto-calibration method bases on the assumption that on the clear-sky days model should not overpredict potential values. To define those clear-sky days, we estimate daily solar radiation using Hargreaves model with default values of A = 0.16, B = 0.1 and tal = 0.72 and we select those days for which estimated daily solar radiation is the closest to the potential values (extra-terrestrial*tal). The number of clear-sky days is estimated based on the mean Cloud Fraction Cover map. Next, based on selected clear-sky days, we perform a non-linear least squares regression to derive A and B coefficients treating potential values decreased by 'epsilon' as a reference solar radiation values. The analysis of auto-calibration results showed clear correlation between optimal 'epsilon' and distance to the coast. We proposed simplified method in which 'epsilon' is equal to 0.1 MJm-2 or to 0.5 MJm-2 when distance to the coast is smaller or bigger than 15 km respectively.
</p>


<h3>Value</h3>

<p>Vector of length 3 containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Ha</code></td>
<td>
<p>Hargreaves 'A' coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hb</code></td>
<td>
<p>Hargreaves 'B' coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hr2</code></td>
<td>
<p>Coefficient of determination of performed linear regression</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jedrzej S. Bojanowski
</p>


<h3>References</h3>

<p>Hargreaves, G.H., Samani, Z.A. 1892. Estimating potential evapotranspiration. J. Irrig. Darin. Eng., ASCE 108 (3), 225-230.
Bojanowski, J.S., Donatelli, M., Skidmore, A.K., Vrieling, A., 2013. An auto-calibration procedure for empirical solar radiation models Environmental Modelling and Software 49, 118-128.
</p>


<h3>See Also</h3>

<p>'hacal'
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Metdata)
Tmax &lt;- Metdata$meteo$TEMP_MAX
Tmin &lt;- Metdata$meteo$TEMP_MIN
days &lt;- Metdata$meteo$DAY
lat &lt;- Metdata$LATITUDE
lon &lt;- Metdata$LONGITUDE
hauto(lat,lon,days,extraT=NULL,Tmax,Tmin,tal=0.76)
</code></pre>


</div>