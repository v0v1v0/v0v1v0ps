<div class="container">

<table style="width: 100%;"><tr>
<td>transformData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform data methods</h2>

<h3>Description</h3>

<p>Implements various data trasformation methods with
optimal scaling for ordinal or nominal data, and to help relax
the assumption of normality (gaussianity) for continuous data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">transformData(x, method = "npn", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix or data.frame (n x p). Rows correspond to subjects, and
columns to graph nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Trasform data method. It can be one of the following:
</p>

<ol>
<li>
<p> "npn" (default), performs nonparanormal(npn) or semiparametric
Gaussian copula model (Liu et al, 2009), estimating the Gaussian copula
by marginally transforming the variables using smooth ECDF functions.
The npn distribution corresponds to the latent underlying multivariate
normal distribution, preserving the conditional independence structure
of the original variables.
</p>
</li>
<li>
<p> "spearman", computes a trigonometric trasformation of Spearman
rho correlation for estimation of latent Gaussian correlations
parameter of a nonparanormal distribution (Harris &amp; Dorton (2013),
and generates the data matrix with the exact same sample covariance
matrix as the estimated one.
</p>
</li>
<li>
<p> "kendall", computes a trigonometric trasformation of Kendall
tau correlation for estimation of latent Gaussian correlations
parameter of a nonparanormal distribution (Harris &amp; Dorton (2013),
and generates the data matrix with the exact same sample covariance
matrix as the estimated one.
</p>
</li>
<li>
<p> "polychoric", computes the polychoric correlation matrix and
generates the data matrix with the exact same sample covariance matrix
as the estimated one. The polychoric correlation (Olsson, 1974) is a
measure of association between two ordinal variables. It is based on the
assumption that two latent bivariate normally distributed random variables
generate couples of ordinal scores. Tetrachoric (two binary variables) and
biserial (an ordinal and a numeric variables) correlations are special cases.
</p>
</li>
<li>
<p> "lineals", performs optimal scaling in order to achieve linearizing
transformations for each bivariate regression between pairwise variables for
subsequent structural equation models using the resulting correlation
matrix computed on the transformed data (de Leeuw, 1988).
</p>
</li>
<li>
<p> "mca", performs optimal scaling of categorical data by Multiple
Correspondence Analysis (MCA, a.k.a homogeneity analysis) maximizing
the first eigenvalues of the trasformed correlation matrix. The estimates
of the corresponding structural parameters are consistent if the underlying
latent space of the observed variables is unidimensional.
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nonparanormal trasformation is computationally very efficient
and only requires one ECDF pass of the data matrix. Polychoric correlation
matrix is computed with the <code>lavCor()</code> function of the <code>lavaan</code>
package. Optimal scaling (lineals and mca) is performed with the
<code>lineals()</code> and <code>corAspect()</code> functions of the <code>aspect</code>
package (Mair and De Leeuw, 2008). To note, SEM fitting of the generate data
(fake data) must be done with a covariance-based method and bootstrap SE,
i.e., with <code>SEMrun(..., algo="ricf", n_rep=1000)</code>.
</p>


<h3>Value</h3>

<p>A list of 2 objects is returned:
</p>

<ol>
<li>
<p> "data", the matrix (n x p) of n observations and p transformed
variables or the matrix (n x p) of simulate observations based on the
selected correlation matrix.  
</p>
</li>
<li>
<p> "catscores", the category weights for "lineals" or "mca"
methods or NULL otherwise.
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>References</h3>

<p>Liu H, Lafferty J, and Wasserman L (2009). The Nonparanormal: Semiparametric Estimation of
High Dimensional Undirected Graphs. Journal of Machine Learning Research 10(80): 2295-2328
</p>
<p>Harris N, and Drton M (2013). PC Algorithm for Nonparanormal Graphical Models.
Journal of Machine Learning Research 14 (69): 3365-3383
</p>
<p>Olsson U (1979). Maximum likelihood estimation of the polychoric correlation coefficient.
Psychometrika, 44(4), 443-460.
</p>
<p>Mair P, and De Leeuw J (2008). Scaling variables by optimizing correlational and
non-correlational aspects in R. Journal of Statistical Software, 32(9), 1-23.
</p>
<p>de Leeuw J (1988). Multivariate analysis with linearizable regressions. Psychometrika,
53, 437-454.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#... with continuous ALS data
graph&lt;- alsData$graph
data&lt;- alsData$exprs; dim(data)
X&lt;- data[, colnames(data) %in% V(graph)$name]; dim(X)

npn.data&lt;- transformData(X, method="npn")
sem0.npn&lt;- SEMrun(graph, npn.data$data, algo="cggm")

mvnS.data&lt;- transformData(X, method="spearman")
sem0.mvnS&lt;- SEMrun(graph, mvnS.data$data, algo="cggm")

mvnK.data&lt;- transformData(X, method="kendall")
sem0.mvnK&lt;- SEMrun(graph, mvnK.data$data, algo="cggm")

#...with ordinal (K=4 categories) ALS data
Xord &lt;- data.frame(X)
Xord &lt;- as.data.frame(lapply(Xord, cut, 4, labels = FALSE))
colnames(Xord) &lt;- sub("X", "", colnames(Xord))

mvnP.data&lt;- transformData(Xord, method="polychoric")
sem0.mvnP&lt;- SEMrun(graph, mvnP.data$data, algo="cggm")

#...with nominal (K=4 categories) ALS data
mca.data&lt;- transformData(Xord, method="mca")
sem0.mca&lt;- SEMrun(graph, mca.data$data, algo="cggm")
mca.data$catscores
gplot(sem0.mca$graph, l="fdp", main="ALS mca")

# plot colored graphs
#par(mfrow=c(2,2), mar=rep(1,4))
#gplot(sem0.npn$graph, l="fdp", main="ALS npm")
#gplot(sem0.mvnS$graph, l="fdp", main="ALS mvnS")
#gplot(sem0.mvnK$graph, l="fdp", main="ALS mvnK")
#gplot(sem0.mvnP$graph, l="fdp", main="ALS mvnP")

</code></pre>


</div>