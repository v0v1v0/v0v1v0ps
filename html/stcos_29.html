<div class="container">

<table style="width: 100%;"><tr>
<td>spacetime_bisquare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Space-Time Bisquare Basis</h2>

<h3>Description</h3>

<p>Space-time bisquare basis on point data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spacetime_bisquare(dom, knots, w_s, w_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dom</code></td>
<td>
<p>Space-time points <code class="reqn">(\bm{u}_1,v_1), \ldots, (\bm{u}_n,v_n)</code>
to evaluate. See "Details".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Spatio-temporal knots
<code class="reqn">(\bm{c}_1,g_1), \ldots, (\bm{c}_r,g_r)</code>
for the basis. See "Details".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_s</code></td>
<td>
<p>Spatial radius for the basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_t</code></td>
<td>
<p>Temporal radius for the basis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Notes about arguments:
</p>

<ul>
<li>
<p> Both <code>dom</code> and <code>knots</code> may be provided as either <code>sf</code> or
<code>sfc</code> objects, or as matrices of points.
</p>
</li>
<li>
<p> If an <code>sf</code> or <code>sfc</code> object is provided for <code>dom</code>, <code class="reqn">n</code>
three-dimensional <code>POINT</code> entries are expected in <code>st_geometry(dom)</code>.
Otherwise, <code>dom</code> will be interpreted as an <code class="reqn">n \times 3</code> numeric matrix.
</p>
</li>
<li>
<p> If an <code>sf</code> or <code>sfc</code> object is provided for <code>knots</code>, <code class="reqn">r</code>
three-dimensional <code>POINT</code> entries are expected in <code>st_geometry(knots)</code>.
Otherwise, <code>knots</code> will be interpreted as an <code class="reqn">r \times 3</code> numeric matrix.
</p>
</li>
<li>
<p> If both <code>dom</code> and <code>knots_s</code> are given as <code>sf</code> or <code>sfc</code> objects,
they will be checked to ensure a common coordinate system.
</p>
</li>
</ul>
<p>For each <code class="reqn">(\bm{u}_i,v_i)</code>, compute the basis functions
</p>
<p style="text-align: center;"><code class="reqn">
\psi_j(\bm{u},v) =
\left[ 2 - \frac{\Vert \bm{u} - \bm{c}_j \Vert^2}{w_s^2}- \frac{|v - g_j|^2}{w_t^2} \right]^2  \cdot
I(\Vert \bm{u} - \bm{c}_j \Vert \leq w_s) \cdot
I(|v - g_j| \leq w_t)
</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, r</code>.
</p>
<p>Due to the treatment of <code class="reqn">\bm{u}_i</code> and <code class="reqn">\bm{c}_j</code> as points in a
Euclidean space, this basis is more suitable for coordinates from a map
projection than coordinates based on a globe representation.
</p>


<h3>Value</h3>

<p>A sparse <code class="reqn">n \times r</code> matrix whose <code class="reqn">i</code>th row
is
</p>
<p style="text-align: center;"><code class="reqn">
\bm{s}_i^\top =
\Big(
\psi_1(\bm{u}_i,v_i), \ldots, \psi_r(\bm{u}_i,v_i)
\Big).
</code>
</p>



<h3>See Also</h3>

<p>Other bisquare: 
<code>areal_spacetime_bisquare()</code>,
<code>areal_spatial_bisquare()</code>,
<code>spatial_bisquare()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)

# Create knot points
seq_x = seq(0, 1, length.out = 3)
seq_y = seq(0, 1, length.out = 3)
seq_t = seq(0, 1, length.out = 3)
knots = expand.grid(x = seq_x, y = seq_y, t = seq_t)
knots_sf = st_as_sf(knots, coords = c("x","y","t"), crs = NA, dim = "XYM", agr = "constant")

# Points to evaluate
x = runif(50)
y = runif(50)
t = sample(1:3, size = 50, replace = TRUE)
pts = data.frame(x = x, y = y, t = t)
dom = st_as_sf(pts, coords = c("x","y","t"), crs = NA, dim = "XYM", agr = "constant")

rad = 0.5
spacetime_bisquare(cbind(x,y,t), knots, w_s = rad, w_t = 1)
spacetime_bisquare(dom, knots_sf, w_s = rad, w_t = 1)

# Plot the (spatial) knots and the points at which we evaluated the basis
plot(knots[,1], knots[,2], pch = 4, cex = 1.5, col = "red")
text(x, y, labels = t, cex = 0.75)

# Draw a circle representing the basis' radius around one of the knot points
tseq = seq(0, 2*pi, length=100) 
coords = cbind(rad * cos(tseq) + seq_x[2], rad * sin(tseq) + seq_y[2])
lines(coords, col = "red")

</code></pre>


</div>