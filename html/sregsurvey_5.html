<div class="container">

<table style="width: 100%;"><tr>
<td>sreg_stsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Model-Assisted Estimation under a Stratified Sampling
with Simple Random Sampling Without Replace in each stratum.</h2>

<h3>Description</h3>

<p><code>sreg_stsi</code> is used to estimate the total parameter of a finite population generated from a semi-parametric generalized gamma population
under a stratified sampling with simple random sampling without-replacement in each stratum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sreg_stsi(
  location_formula,
  scale_formula,
  stratum,
  data,
  n,
  ss_sizes,
  allocation_type = "PA",
  aux_x,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>location_formula</code></td>
<td>
<p>a symbolic description of the systematic component of the location model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_formula</code></td>
<td>
<p>a symbolic description of the systematic component of the scale model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum</code></td>
<td>
<p>vector, represents the strata of each unit in the population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame, list containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, represents a fixed sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss_sizes</code></td>
<td>
<p>vector, represents a vector with the sample size in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allocation_type</code></td>
<td>
<p>character, there is two choices, proportional allocation, 'PA', and x-optimal allocation,'XOA'. By default is a 'PA', Sarndal et. al. (2003).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux_x</code></td>
<td>
<p>vector, represents an auxiliary variable to help to calculate the sample sizes by the x-optimum allocation method, Sarndal et. al. (2003).
This option is validated only when the argument allocation_type is equal to 'XOA'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters accepted by caret and survey functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>sampling_design</code> is the name of the sampling design used in the estimation process.
</p>
<p><code>N</code> is the population size.
</p>
<p><code>H</code> is the number of strata.
</p>
<p><code>Ns</code> is the population strata sizes.
</p>
<p><code>allocation_type</code> is the method used to calculate sample strata sizes.
</p>
<p><code>global_n</code> is the global sample size used in the estimation process.
</p>
<p><code>first_order_probabilities</code> vector of the first order probabilities used in the estimation process.
</p>
<p><code>sample</code> is the random sample used in the estimation process.
</p>
<p><code>estimated_total_y_sreg</code> is the SREG estimate of the total parameter of the finite population.
</p>


<h3>Author(s)</h3>

<p>Carlos Alberto Cardozo Delgado &lt;cardozorpackages@gmail.com&gt;
</p>


<h3>References</h3>

<p>Cardozo C.A, Alonso C. (2021) Semi-parametric model assisted estimation in finite populations. In preparation.
</p>
<p>Cardozo C.A.,  Paula G., and Vanegas L. (2022). Generalized log-gamma additive partial linear models with P-spline smoothing. Statistical Papers.
</p>
<p>Sarndal C.E.,  Swensson B., and Wretman J. (2003). Model Assisted Survey Sampling. Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sregsurvey)
library(survey)
library(dplyr)
library(magrittr)
library(gamlss)
data(api)
attach(apipop)
Apipop &lt;- filter(apipop,full!= 'NA')
Apipop &lt;- Apipop %&gt;% dplyr::select(api00,grad.sch,full,stype)
dim(Apipop)
fit &lt;- sreg_stsi(api00~ pb(grad.sch), scale_formula =~ full-1, n=400, stratum='stype', data=Apipop)
fit
# The total population value is
true_total &lt;- sum(Apipop$api00)
# The estimated relative bias in percentage is
round(abs((fit$estimated_total_y_sreg - true_total)/true_total),3)*100

</code></pre>


</div>