<div class="container">

<table style="width: 100%;"><tr>
<td>susie_get_objective</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inferences From Fitted SuSiE Model</h2>

<h3>Description</h3>

<p>These functions access basic properties or draw
inferences from a fitted susie model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">susie_get_objective(res, last_only = TRUE, warning_tol = 1e-06)

susie_get_posterior_mean(res, prior_tol = 1e-09)

susie_get_posterior_sd(res, prior_tol = 1e-09)

susie_get_niter(res)

susie_get_prior_variance(res)

susie_get_residual_variance(res)

susie_get_lfsr(res)

susie_get_posterior_samples(susie_fit, num_samples)

susie_get_cs(
  res,
  X = NULL,
  Xcorr = NULL,
  coverage = 0.95,
  min_abs_corr = 0.5,
  dedup = TRUE,
  squared = FALSE,
  check_symmetric = TRUE,
  n_purity = 100,
  use_rfast
)

susie_get_pip(res, prune_by_cs = FALSE, prior_tol = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A susie fit, typically an output from
<code>susie</code> or one of its variants. For
<code>susie_get_pip</code> and <code>susie_get_cs</code>, this may instead be
the posterior inclusion probability matrix, <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last_only</code></td>
<td>
<p>If <code>last_only = FALSE</code>, return the ELBO from
all iterations; otherwise return the ELBO from the last iteration
only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning_tol</code></td>
<td>
<p>Warn if ELBO is decreasing by this
tolerance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_tol</code></td>
<td>
<p>Filter out effects having estimated prior variance
smaller than this threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>susie_fit</code></td>
<td>
<p>A susie fit, an output from <code>susie</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_samples</code></td>
<td>
<p>The number of draws from the posterior
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>n by p matrix of values of the p variables (covariates) in
n samples. When provided, correlation between variables will be
computed and used to remove CSs whose minimum correlation among
variables is smaller than <code>min_abs_corr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcorr</code></td>
<td>
<p>p by p matrix of correlations between variables
(covariates). When provided, it will be used to remove CSs whose
minimum correlation among variables is smaller than
<code>min_abs_corr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>A number between 0 and 1 specifying desired
coverage of each CS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_abs_corr</code></td>
<td>
<p>A "purity" threshold for the CS. Any CS that
contains a pair of variables with correlation less than this
threshold will be filtered out and not reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dedup</code></td>
<td>
<p>If <code>dedup = TRUE</code>, remove duplicate CSs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>If <code>squared = TRUE</code>, report min, mean and
median of squared correlation instead of the absolute correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_symmetric</code></td>
<td>
<p>If <code>check_symmetric = TRUE</code>, perform a
check for symmetry of matrix <code>Xcorr</code> when <code>Xcorr</code> is
provided (not <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_purity</code></td>
<td>
<p>The maximum number of credible set (CS) variables
used in calculating the correlation (“purity”)
statistics. When the number of variables included in the CS is
greater than this number, the CS variables are randomly subsampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_rfast</code></td>
<td>
<p>Use the Rfast package for the purity calculations.
By default <code>use_rfast = TRUE</code> if the Rfast package is
installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune_by_cs</code></td>
<td>
<p>Whether or not to ignore single effects not in
a reported CS when calculating PIP.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>susie_get_objective</code> returns the evidence lower bound
(ELBO) achieved by the fitted susie model and, optionally, at each
iteration of the IBSS fitting procedure.
</p>
<p><code>susie_get_residual_variance</code> returns the (estimated or
fixed) residual variance parameter.
</p>
<p><code>susie_get_prior_variance</code> returns the (estimated or fixed)
prior variance parameters.
</p>
<p><code>susie_get_posterior_mean</code> returns the posterior mean for the
regression coefficients of the fitted susie model.
</p>
<p><code>susie_get_posterior_sd</code> returns the posterior standard
deviation for coefficients of the fitted susie model.
</p>
<p><code>susie_get_niter</code> returns the number of model fitting
iterations performed.
</p>
<p><code>susie_get_pip</code> returns a vector containing the posterior
inclusion probabilities (PIPs) for all variables.
</p>
<p><code>susie_get_lfsr</code> returns a vector containing the average lfsr
across variables for each single-effect, weighted by the posterior
inclusion probability (alpha).
</p>
<p><code>susie_get_posterior_samples</code> returns a list containing the
effect sizes samples and causal status with two components: <code>b</code>,
an <code>num_variables</code> x <code>num_samples</code> matrix of effect
sizes; <code>gamma</code>, an <code>num_variables</code> x <code>num_samples</code>
matrix of causal status random draws.
</p>
<p><code>susie_get_cs</code> returns credible sets (CSs) from a susie fit,
as well as summaries of correlation among the variables included in
each CS. If desired, one can filter out CSs that do not meet a
specified “purity” threshold; to do this, either <code>X</code> or
<code>Xcorr</code> must be supplied. It returns a list with the following
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cs</code></td>
<td>
<p>A list in which each list element is a vector containing
the indices of the variables in the CS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>The nominal coverage specified for each CS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purity</code></td>
<td>
<p>If <code>X</code> or <code>Xcorr</code> iis provided), the
purity of each CS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs_index</code></td>
<td>
<p>If <code>X</code> or <code>Xcorr</code> is provided) the index
(number between 1 and L) of each reported CS in the supplied susie
fit.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n = 1000
p = 1000
beta = rep(0,p)
beta[1:4] = 1
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
s = susie(X,y,L = 10)
susie_get_objective(s)
susie_get_objective(s, last_only=FALSE)
susie_get_residual_variance(s)
susie_get_prior_variance(s)
susie_get_posterior_mean(s)
susie_get_posterior_sd(s)
susie_get_niter(s)
susie_get_pip(s)
susie_get_lfsr(s)

</code></pre>


</div>