<div class="container">

<table style="width: 100%;"><tr>
<td>image.multi_tpfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Images with Multidimensional Transiograms</h2>

<h3>Description</h3>

<p>The function plots <code class="reqn">2</code>-D sections of a predicted multidimensional transiograms computed through ellipsoidal interpolation.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'multi_tpfit'
image(x, mpoints, which.dire, max.dist, main,
      mar, ask = TRUE, ..., nlevels = 10, contour = TRUE)</code></pre>


<h3>Arguments</h3>











<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>multi_tpfit</code>, typically with the output of the function <code>multi_tpfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpoints</code></td>
<td>
<p>the number of points per axes. It controls the accuracy of images to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.dire</code></td>
<td>
<p>a vector with two chosen axial directions. If omitted, all <code class="reqn">2</code>-D sections are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>a scalar or a vector of maximum length for the chosen axial directions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the main title (on top) whose font and size are fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>a scalar or a numerical vector of the form <code>c(bottom, left, top, right)</code> which gives the number of margin lines to be specified on the four sides of image to plot. See <code>par</code>(<code>mar=</code>.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, the user is asked for input, before each plot. See <code>par</code>(<code>ask=</code>.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to pass to the function <code>image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>the number of levels to pass to the function <code>contour</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>logical. If <code>TRUE</code>, the function <code>contour</code> is used to draw contour lines over the image. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A multidimensional transiogram is a diagram which shows the transition probabilities for a single pair of categories. It is computed for any lag vector <code class="reqn">h</code> through 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{expm} (\Vert h \Vert R),</code>
</p>

<p>where entries of <code class="reqn">R</code> are ellipsoidally interpolated (see <code>multi_tpfit</code>).
</p>
<p>The exponential matrix is evaluated by the scaling and squaring algorithm.
</p>


<h3>Value</h3>

<p>An image is produced on the current graphics device. No values are returned.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Higham, N. J. (2008) <em>Functions of Matrices: Theory and Computation</em>. Society for Industrial and Applied Mathematics.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>multi_tpfit</code>, <code>pemt</code>, <code>image.pemt</code>, <code>image</code>, <code>plot.transiogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Estimate model parameter
x &lt;- multi_tpfit(ACM$MAT5, ACM[, 1:3])

# Set short names for categories 3 and 4
names(x$prop)[3:4] &lt;- c("Clay and Sand", "Gravel and Sand")

# Plot 2-D theoretical sections of
# a multidimensional transiogram
image(x, 40, max.dist=c(200,200,20), which.dire=2:3,
    mar = .7, col=rev(heat.colors(500)),
    breaks=0:500/500, nlevels = 5)
</code></pre>


</div>