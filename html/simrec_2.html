<div class="container">

<table style="width: 100%;"><tr>
<td>simrec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>simrec</h2>

<h3>Description</h3>

<p>Simulation of recurrent event data for non-constant baseline hazard
(total-time model)
</p>
<p>This function allows simulation of recurrent event data following the multiplicative
intensity model described in Andersen and Gill [1] with the baseline hazard being a
function of the total/calendar time. To induce between-subject-heterogeneity a random
effect covariate (frailty term) can be incorporated. Data for individual <code class="reqn">i</code> are generated
according to the intensity process </p>
<p style="text-align: center;"><code class="reqn">Y_i(t) * \lambda_0(t)* Z_i *exp(\beta^t X_i),</code>
</p>

<p>where <code class="reqn">X_i</code> defines the covariate vector and <code class="reqn">\beta</code> the regression coefficient vector.
<code class="reqn">\lambda_0(t)</code> denotes the baseline hazard, being a function of the total/calendar
time <code class="reqn">t</code>, and <code class="reqn">Y_i(t)</code> the predictable process
that equals one as long as individual <code class="reqn">i</code> is under observation and at risk for experiencing events.
<code class="reqn">Z_i</code> denotes the frailty variable with <code class="reqn">(Z_i)_i</code> iid with <code class="reqn">E(Z_i)=1</code> and
<code class="reqn">Var(Z_i)=\theta</code>. The parameter <code class="reqn">\theta</code> describes the degree of
between-subject-heterogeneity. Data output is in the counting process format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simrec(
  N,
  fu.min,
  fu.max,
  cens.prob = 0,
  dist.x = "binomial",
  par.x = 0,
  beta.x = 0,
  dist.z = "gamma",
  par.z = 0,
  dist.rec,
  par.rec,
  pfree = 0,
  dfree = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu.min</code></td>
<td>
<p>Minimum length of follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu.max</code></td>
<td>
<p>Maximum length of follow-up. Individuals length of follow-up is
generated from a uniform distribution on
<code>[fu.min, fu.max]</code>. If <code>fu.min=fu.max</code>, then all individuals have a common
follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.prob</code></td>
<td>
<p>Gives the probability of being censored due to loss to follow-up before
<code>fu.max</code>. For a random set of individuals defined by a B(N,<code>cens.prob</code>)-distribution,
the time to censoring is generated from a uniform
distribution on <code>[0, fu.max]</code>. Default is <code>cens.prob=0</code>, i.e. no censoring
due to loss to follow-up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.x</code></td>
<td>
<p>Distribution of the covariate(s) <code class="reqn">X</code>. If there is more than one covariate,
<code>dist.x</code> must be a vector of distributions with one entry for each covariate. Possible
values are <code>"binomial"</code> and <code>"normal"</code>, default is <code>dist.x="binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.x</code></td>
<td>
<p>Parameters of the covariate distribution(s). For <code>"binomial", par.x</code> is
the probability for <code class="reqn">x=1</code>. For <code>"normal"</code>, <code>par.x=c(</code><code class="reqn">\mu, \sigma</code><code>)</code>
where <code class="reqn">\mu</code> is the mean and <code class="reqn">\sigma</code> is the standard deviation of a normal distribution.
If one of the covariates is defined to be normally distributed, <code>par.x</code> must be a list,
e.g. <code> dist.x &lt;- c("binomial", "normal")</code> and <code>par.x  &lt;- list(0.5, c(1,2))</code>.
Default is <code>par.x=0</code>, i.e. <code class="reqn">x=0</code> for all individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.x</code></td>
<td>
<p>Regression coefficient(s) for the covariate(s) <code class="reqn">x</code>. If there is more than one
covariate, <code>beta.x</code> must be a vector of coefficients with one entry for each covariate.
<code>simrec</code> generates as many covariates as there are entries in <code>beta.x</code>. Default is
<code>beta.x=0</code>, corresponding to no effect of the covariate <code class="reqn">x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.z</code></td>
<td>
<p>Distribution of the frailty variable <code class="reqn">Z</code> with <code class="reqn">E(Z)=1</code> and
<code class="reqn">Var(Z)=\theta</code>. Possible values are <code>"gamma"</code> for a Gamma distributed frailty
and <code>"lognormal"</code> for a lognormal distributed frailty.
Default is <code>dist.z="gamma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.z</code></td>
<td>
<p>Parameter <code class="reqn">\theta</code> for the frailty distribution: this parameter gives
the variance of the frailty variable <code class="reqn">Z</code>.
Default is <code>par.z=0</code>, which causes <code class="reqn">Z=1</code>, i.e. no frailty effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.rec</code></td>
<td>
<p>Form of the baseline hazard function. Possible values are <code>"weibull"</code> or
<code>"gompertz"</code> or <code>"lognormal"</code> or <code>"step"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.rec</code></td>
<td>
<p>Parameters for the distribution of the event data.
If <code>dist.rec="weibull"</code> the  hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=\lambda*\nu* t^{\nu - 1},</code>
</p>

<p>where <code class="reqn">\lambda&gt;0</code> is the scale and <code class="reqn">\nu&gt;0</code> is the shape parameter. Then
<code>par.rec=c(</code><code class="reqn">\lambda, \nu</code><code>)</code>. A special case
of this is the exponential distribution for <code class="reqn">\nu=1</code>.\
If <code>dist.rec="gompertz"</code>, the hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=\lambda*exp(\alpha t),</code>
</p>

<p>where <code class="reqn">\lambda&gt;0</code> is the scale and <code class="reqn">\alpha\in(-\infty,+\infty)</code> is the shape parameter.
Then <code>par.rec=c(</code><code class="reqn">\lambda, \alpha</code><code>)</code>.\
If <code>dist.rec="lognormal"</code>, the hazard function is
</p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=[(1/(\sigma t))*\phi((ln(t)-\mu)/\sigma)]/[\Phi((-ln(t)-\mu)/\sigma)],</code>
</p>

<p>where <code class="reqn">\phi</code> is the probability density function and <code class="reqn">\Phi</code> is the cumulative
distribution function of the standard normal distribution, <code class="reqn">\mu\in(-\infty,+\infty)</code> is a
location parameter and <code class="reqn">\sigma&gt;0</code> is a shape parameter. Then <code>par.rec=c(</code><code class="reqn">\mu,\sigma</code><code>)</code>.
Please note, that specifying <code>dist.rec="lognormal"</code> together with some covariates does not
specify the usual lognormal model (with covariates specified as effects on the parameters of the
lognormal distribution resulting in non-proportional hazards), but only defines the baseline
hazard and incorporates covariate effects using the proportional hazard assumption.\
If <code>dist.rec="step"</code> the hazard function is </p>
<p style="text-align: center;"><code class="reqn">\lambda_0(t)=a, t&lt;=t_1, and \lambda_0(t)=b, t&gt;t_1</code>
</p>
<p>.
Then <code>par.rec=c(</code><code class="reqn">a,b,t_1</code><code>)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfree</code></td>
<td>
<p>Probability that after experiencing an event the individual is not at risk
for experiencing further events for a length of <code>dfree</code> time units.
Default is <code>pfree=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfree</code></td>
<td>
<p>Length of the risk-free interval. Must be in the same time unit as <code>fu.max</code>.
Default is <code>dfree=0</code>, i.e. the individual is continously at risk for experiencing
events until end of follow-up.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulation of recurrent event data for non-constant baseline hazard
in the total time model with risk-free intervalls and possibly a competing
event. The simrec package enables to cut the data to an interim data set,
and provides functionality to plot.
</p>
<p>Data are simulated by extending the methods proposed by Bender et al [2]
to the multiplicative intensity model.
</p>


<h3>Value</h3>

<p>The output is a data.frame consisting of the columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>An integer number for identification of each individual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>or <code>x.V1, x.V2, ...</code> - depending on the covariate matrix. Contains the
randomly generated value of the covariate(s) <code class="reqn">X</code> for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Contains the randomly generated value of the frailty variable <code class="reqn">Z</code> for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The start of interval <code>[start, stop]</code>, when the individual
starts to be at risk for a next event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>The time of an event or censoring, i.e. the end of interval
<code>[start, stop]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>An indicator of whether an event occured at time <code>stop</code> (<code>status=1</code>)
or the individual is censored at time <code>stop</code> (<code>status=0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu</code></td>
<td>
<p>Length of follow-up period <code>[0,fu]</code> for each individual.</p>
</td>
</tr>
</table>
<p>For each individual there are as many lines as it experiences events,
plus one line if being censored.
The data format corresponds to the counting process format.
</p>


<h3>Author(s)</h3>

<p>Katharina Ingel, Stella Preussler, Antje Jahn-Eimermacher, Federico Marini
</p>
<p>Maintainer: Antje Jahn-Eimermacher <a href="mailto:jahna@uni-mainz.de">jahna@uni-mainz.de</a>
</p>
<p>Katharina Ingel, Stella Preussler, Antje Jahn-Eimermacher.
Institute of Medical Biostatistics, Epidemiology and Informatics (IMBEI),
University Medical Center of the Johannes Gutenberg-University Mainz, Germany
</p>


<h3>References</h3>


<ol>
<li>
<p> Andersen P, Gill R (1982): Cox's regression model for counting processes:
a large sample study. The Annals of Statistics 10:1100-1120
</p>
</li>
<li>
<p> Bender R, Augustin T, Blettner M (2005): Generating survival times to simulate Cox
proportional hazards models. Statistics in Medicine 24:1713-1723
</p>
</li>
<li>
<p> Jahn-Eimermacher A, Ingel K, Ozga AK, Preussler S, Binder H (2015): Simulating recurrent event data
with hazard functions defined on a total time scale. BMC Medical Research Methodology 15:16
</p>
</li>
</ol>
<h3>See Also</h3>

<p>Useful links:
</p>

<ul><li> <p><a href="https://github.com/federicomarini/simrec">https://github.com/federicomarini/simrec</a>
</p>
</li></ul>
<p>simreccomp
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example:
### A sample of 10 individuals

N &lt;- 10

### with a binomially distributed covariate with a regression coefficient
### of beta=0.3, and a standard normally distributed covariate with a
### regression coefficient of beta=0.2,

dist.x &lt;- c("binomial", "normal")
par.x &lt;- list(0.5, c(0, 1))
beta.x &lt;- c(0.3, 0.2)

### a gamma distributed frailty variable with variance 0.25

dist.z &lt;- "gamma"
par.z &lt;- 0.25

### and a Weibull-shaped baseline hazard with shape parameter lambda=1
### and scale parameter nu=2.

dist.rec &lt;- "weibull"
par.rec &lt;- c(1, 2)

### Subjects are to be followed for two years with 20% of the subjects
### being censored according to a uniformly distributed censoring time
### within [0,2] (in years).

fu.min &lt;- 2
fu.max &lt;- 2
cens.prob &lt;- 0.2

### After each event a subject is not at risk for experiencing further events
### for a period of 30 days with a probability of 50%.

dfree &lt;- 30 / 365
pfree &lt;- 0.5

simdata &lt;- simrec(
  N, fu.min, fu.max, cens.prob, dist.x, par.x, beta.x, dist.z, par.z,
  dist.rec, par.rec, pfree, dfree
)
# print(simdata)  # only run for small N!
</code></pre>


</div>