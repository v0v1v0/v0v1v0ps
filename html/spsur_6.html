<div class="container">

<table style="width: 100%;"><tr>
<td>dgp_spsur</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of a random dataset with a spatial SUR structure.</h2>

<h3>Description</h3>

<p>The purpose of the function <code>dgp_spsur</code> is to generate a random 
dataset with the dimensions and spatial structure decided by the user. 
This function may be useful in pure simulation experiments or with the 
aim of showing specific properties and characteristics
of a spatial SUR dataset and inferential procedures related to them.
</p>
<p>The user of <code>dgp_spsur</code> should think in terms of a Monte Carlo 
experiment. The arguments of the function specify the dimensions of the 
dataset to be generated, the spatial mechanism underlying the data, the 
intensity of the SUR structure among the equations and the values of the 
parameters to be used to obtain the simulated data, which includes the 
error terms, the regressors and the explained variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgp_spsur(Sigma, Tm = 1, G, N, Betas, Thetas = NULL, 
                 rho = NULL, lambda = NULL, p = NULL, listw = NULL, 
                 X = NULL, type = "matrix", pdfU = "nvrnorm", 
                 pdfX = "nvrnorm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Covariance matrix between the <em>G</em> equations of the 
SUR model. This matrix should be definite positive and the user must 
check for that.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tm</code></td>
<td>
<p>Number of time periods. Default = <code>1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of cross-section or spatial units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Betas</code></td>
<td>
<p>A row vector of order <code class="reqn">(1xP)</code> showing the values for 
the <em>beta</em> coefficients.
The first <code class="reqn">P_{1}</code> terms correspond to the first equation (where 
the first element is the intercept), the second <code class="reqn">P_{2}</code> terms to 
the coefficients of the second equation and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Thetas</code></td>
<td>
<p>Values for the <code class="reqn">\theta</code> coefficients in the 
<em>G</em> equations of the model, when the type of spatial SUR model to 
be simulated is a "slx", "sdm"  or "sdem". <em>Thetas</em> is a 
row vector of order <em><code class="reqn">1xPTheta</code></em>, where 
<em><code class="reqn">PThetas=p-G</code></em>; let us note that the intercept cannot 
appear among the spatial lags of the regressors. The first 
<em><code class="reqn">1xKTheta_{1}</code></em> terms correspond to the first equation, 
the second <em><code class="reqn">1xPTheta_{2}</code></em> terms correspond to the
second equation, and so on. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Values of the coefficients <code class="reqn">\rho_{g}; g=1,2,..., G</code> 
related to the spatial lag of the explained variable of the g-th equation. 
If <code class="reqn">rho</code> is an scalar and there are <em>G</em> equations in the 
model, the same value will be used for all the equations. If <code class="reqn">rho</code> 
is a row vector, of order <em>(1xG)</em>, the function <code>dgp_spsur</code> 
will use these values, one for each equation. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Values of the coefficients <code class="reqn">\lambda_{g}; g=1,2,..., G</code> 
related to the spatial lag of the errors in the <em>G</em> equations. 
If <code class="reqn">lambda</code> is an scalar and there are <em>G</em> equations
in the model, the same value will be used for all the equations. 
If <code class="reqn">lambda</code> is a row vector, of order <em>(1xG)</em>, the function 
<code>dgp_spsur</code> will use these values, one for each equation of the 
spatial errors. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of regressors by equation, including the intercept. 
<em>p</em> can be a row vector of order <em>(1xG)</em>, if the number of 
regressors is not the same for all the equations, or a scalar, if the 
<em>G</em> equations have the same number of regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>A <code>listw</code> object created for example by 
<code>nb2listw</code> from <span class="pkg">spatialreg</span> package; if 
<code>nb2listw</code> not given, set to 
the same spatial weights as the <code>listw</code> argument. It can
also be a spatial weighting matrix of order <em>(NxN)</em> instead of
a <code>listw</code> object. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>This argument tells the function <code>dgp_spsur</code> which <em>X</em> 
matrix should be used to generate the SUR dataset. If <em>X</em> is 
different from <code>NULL</code>, <code>{dgp_spsur}</code> will upload the <em>X</em> 
matrix selected in this argument. Note that the <em>X</em> must be consistent
with the dimensions of the model. If <em>X</em> is <code>NULL</code>, 
<code>dgp_spsur</code> will generate the desired matrix of regressors from a 
multivariate Normal distribution with mean value zero and identity 
<code class="reqn">(PxP)</code> covariance matrix. As an alternative, the user may change 
this probability distribution function to the uniform case, <code class="reqn">U(0,1)</code>, 
through the argument <em>pdfX</em>. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Selection of the type of output. The alternatives are 
<code>matrix</code>, <code>df</code>, <code>panel</code>, <code>all</code>. Default <code>matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfU</code></td>
<td>
<p>Multivariate probability distribution function, Mpdf, from 
which the values of the error terms will be drawn. The covariance matrix 
is the <code class="reqn">\Sigma</code> matrix specified by the user in the argument. Two alternatives
<code>"lognvrnorm"</code>, <code>"nvrnorm"</code>. Default <code>"nvrnorm"</code>.   
</p>
<p><em>Sigma</em>.
The function <code>dgp_spsur</code> provides two Mpdf, the multivariate Normal, 
which is the default, and the log-Normal distribution function which 
means just exponenciate the sampling drawn form a <code class="reqn">N(0,\Sigma)</code>
distribution. Default = <code>"nvrnorm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfX</code></td>
<td>
<p>Multivariate probability distribution function (Mpdf), from 
which the values of the regressors will be drawn. The regressors are 
assumed to be independent. <code>dgp_spsur</code> provides two Mpdf, 
the multivariate Normal, which is the default, and the uniform in the 
interval <code class="reqn">U[0,1]</code>, using the dunif function.
<code>dunif</code>, from the <span class="pkg">stats</span> package. Two alternatives
<code>"nvrunif"</code>, <code>"nvrnorm"</code>. Default <code>"nvrnorm"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of the function <code>dgp_spsur</code> is to generate random 
datasets, of a SUR nature, with the spatial structure decided by the user. 
The function requires certain information to be supplied externally 
because, in fact, <code>dgp_spsur</code> constitutes a Data Generation
Process, DGP. The following aspects should be addressed:
</p>

<ul>
<li>
<p> The user must define the dimensions of the dataset, that is, 
number of equations, <em>G</em>, number of time periods, <em>Tm</em>, and number of 
cross-sectional units, <em>N</em>.
</p>
</li>
<li>
<p> The user must choose the type of spatial structure desired 
for the model from among the list of candidates of "sim", "slx", 
"slm", "sem", "sdm", "sdem" or  "sarar". The default is the "sim" 
specification which does not have spatial structure. The decision is 
made implicitly, just omitting the specification of the spatial 
parameters which are not involved in the model (i.e., in a "slm"
there are no <code class="reqn">\lambda</code> parameters but appear <code class="reqn">\rho</code> 
parameters; in a "sdem" model there are <code class="reqn">\lambda</code> and <code class="reqn">\theta</code> 
parameters but no <code class="reqn">\rho</code> coefficients). 
</p>
</li>
<li>
<p> If the user needs a model with spatial structure, a <em>(NxN)</em>  weighting 
matrix, <em>W</em>, should be chosen.
</p>
</li>
<li>
<p> The next step builds the equations of the SUR model. In this 
case, the user must specify the number of regressors that intervene 
in each equation and the coefficients, <code class="reqn">\beta</code> parameters,
associated with each regressor. The <em>first</em> question is solved 
through the argument <em>p</em> which, if a scalar, indicates that 
the same number of regressors should appear in all the equations
of the model; if the user seeks for a model with different number 
of regressors in the <em>G</em> equations, the argument <em>p</em> must 
be a <em>(1xG)</em> row vector with the required information. It must 
be remembered that <code>dgp_spsur</code> assumes that an
intercept appears in all equations of the model.
</p>
<p>The <em>second</em> part of the problem posited above is solved through 
the argument <em>Betas</em>, which is a row vector of order <em>(1xp)</em> 
with the information required for this set of coefficients.
</p>
</li>
<li>
<p> The user must specify, also, the values of the spatial parameters 
corresponding to the chosen specification; we are referring to the 
<code class="reqn">\rho_{g}</code>, <code class="reqn">\lambda_{g}</code> and  <code class="reqn">\theta_{g}</code>,
for <code class="reqn">g=1, ..., G and k=1,..., K_{g}</code> parameters. This is done 
thought the arguments <em>rho</em>, <em>lambda</em> and <em>theta</em>. 
The firs two, <em>rho</em> and <em>lambda</em>, work as <em>K</em>: if 
they are scalar, the same value will be used in the <em>G</em> 
equations of the SUR model; if they are <em>(1xG)</em> row vectors, 
a different value will be assigned for each equation.
</p>
<p>Moreover, <em>Theta</em> works like the argument <em>Betas</em>. The user 
must define a row vector of order <code class="reqn">1xPTheta</code> showing these values. 
It is worth to remember that in no case the intercept will appear 
among the lagged regressors.
</p>
</li>
<li>
<p> With the argument <code>type</code> the user take the decision of the 
output format. See Value section.
</p>
</li>
<li>
<p> Finally, the user must decide which values of the regressors and 
of the error terms are to be used in the simulation. The regressors 
can be uploaded from an external matrix generated previously by the
user. This is the argument <em>X</em>. It is the responsibility of the 
user to check that the dimensions of the external matrix are consistent 
with the dataset required for the SUR model. A second possibility
implies  the regressors to be generated randomly by the function 
<code>dgp_spsur</code>.
In this case, the user must select the probability distribution 
function from which the corresponding data (of the regressors and 
the error terms) are to be drawn.<br></p>
</li>
</ul>
<p><code>dgp_spsur</code> provides two multivariate distribution functions, 
namely, the Normal and the log-Normal for the errors (the second 
should be taken as a clear departure from the standard assumption of
normality). In both cases, random matrices of order <em>(TmNxG)</em> 
are obtained from a multivariate normal distribution, with a mean 
value of zero and the covariance matrix specified in the argument
<em>Sigma</em>; then, this matrix is exponentiated for the log-Normal 
case. Roughly, the same procedure applies for drawing the values of 
the regressor. There are two distribution functions available, the
normal and the uniform in the interval <code class="reqn">U[0,1]</code>; the regressors 
are always independent.
</p>


<h3>Value</h3>

<p>The default output ("matrix") is a list with a vector <code class="reqn">Y</code> of order 
<em>(TmNGx1)</em> with the values 
generated for the explained variable in the G equations of the SUR and 
a matrix <code class="reqn">XX</code> of order (<em>(TmNGxsum(p))</em>, with the values
generated for the regressors of the SUR, including an intercept for 
each equation.
</p>
<p>In case of Tm = 1 or G = 1 several alternatives 
output can be select:
</p>

<ul>
<li>
<p> If the user select <code>type = "df"</code> the output is a data frame where each
column is a variable.
</p>
</li>
<li>
<p> If the user select <code>type = "panel"</code> the output is a data frame in 
panel format including two factors. The first factor point out the observation 
of the individual and the second the equation for different Tm or G.
</p>
</li>
<li>
<p> Finally, if <code>type = "all"</code> is select the output is a list including all 
alternatives format.
</p>
</li>
</ul>
<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;">
  Fernando Lopez  </td>
<td style="text-align: left;"> <a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Roman Minguez  </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Jesus Mur  </td>
<td style="text-align: left;"> <a href="mailto:jmur@unizar.es">jmur@unizar.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Lopez, F. A., Minguez, R., Mur, J. (2020). ML versus IV estimates 
of spatial SUR models: evidence from the case of Airbnb in Madrid urban 
area. <em>The Annals of Regional Science</em>, 64(2), 313-347.
&lt;doi:10.1007/s00168-019-00914-1&gt;
</p>
</li>
<li>
<p> Minguez, R., Lopez, F.A. and Mur, J.  (2022).
spsur: An R Package for Dealing with Spatial 
Seemingly Unrelated Regression Models. 
<em>Journal of Statistical Software</em>, 
104(11), 1–43. &lt;doi:10.18637/jss.v104.i11&gt;
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>spsurml</code>, <code>spsur3sls</code>, <code>spsurtime</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## VIP: The output of the whole set of the examples can be examined 
## by executing demo(demo_dgp_spsur, package="spsur")

################################################
### PANEL DATA (Tm = 1 or G = 1)              ##
################################################

################################################
#### Example 1: DGP SLM model. G equations
################################################
rm(list = ls()) # Clean memory
Tm &lt;- 1 # Number of time periods
G &lt;- 3 # Number of equations
N &lt;- 200 # Number of spatial elements
p &lt;- 3 # Number of independent variables
Sigma &lt;- matrix(0.3, ncol = G, nrow = G)
diag(Sigma) &lt;- 1
Betas &lt;- c(1, 2, 3, 1, -1, 0.5, 1, -0.5, 2)
rho &lt;- 0.5 # level of spatial dependence
lambda &lt;- 0.0 # spatial autocorrelation error term = 0
##  random coordinates
co &lt;- cbind(runif(N,0,1),runif(N,0,1))
lw &lt;- spdep::nb2listw(spdep::knn2nb(spdep::knearneigh(co, k = 5,
                                                   longlat = FALSE)))
DGP &lt;- dgp_spsur(Sigma = Sigma, Betas = Betas,
                 rho = rho, lambda = lambda, Tm = Tm,
                 G = G, N = N, p = p, listw = lw)

SLM &lt;- spsurml(X = DGP$X, Y = DGP$Y, Tm = Tm, N = N, G = G, 
               p = c(3, 3, 3), listw = lw, type = "slm") 
summary(SLM)

################################################
### MULTI-DIMENSIONAL PANEL DATA G&gt;1 and Tm&gt;1 ##
################################################

rm(list = ls()) # Clean memory
Tm &lt;- 10 # Number of time periods
G &lt;- 3 # Number of equations
N &lt;- 100 # Number of spatial elements
p &lt;- 3 # Number of independent variables
Sigma &lt;- matrix(0.5, ncol = G, nrow = G)
diag(Sigma) &lt;- 1
Betas &lt;- rep(1:3, G)
rho &lt;- c(0.5, 0.1, 0.8)
lambda &lt;- 0.0 # spatial autocorrelation error term = 0
## random coordinates
co &lt;- cbind(runif(N,0,1),runif(N,0,1))
lw &lt;- spdep::nb2listw(spdep::knn2nb(spdep::knearneigh(co, k = 5,
                                                   longlat = FALSE)))
DGP4 &lt;- dgp_spsur(Sigma = Sigma, Betas = Betas, rho = rho, 
                  lambda = lambda, Tm = Tm, G = G, N = N, p = p, 
                  listw = lw)
SLM4  &lt;- spsurml(Y = DGP4$Y, X = DGP4$X, G = G, N = N, Tm = Tm,
                 p = p, listw = lw, type = "slm")
summary(SLM4)

</code></pre>


</div>