<div class="container">

<table style="width: 100%;"><tr>
<td>fichiers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create and read a file of p-values for all pairwise tests of all possible
ratios of a compositional vector
</h2>

<h3>Description</h3>

<p>These functions allow to perform hypothesis testing on all possible pairwise
ratios or differences of a set of variables in a given data frame, and
store or read their results in a file
</p>


<h3>Usage</h3>

<pre><code class="language-R">creer.Fp( d, nom.fichier,
          noms, f.p = student.fpc,
          log = FALSE, en.log = !log,
          nom.var = 'R',
          noms.colonnes = c( "Cmp.1", "Cmp.2", "p" ),
          add.col = "delta",
          sep = ";", dec = ".", row.names = FALSE, col.names = TRUE,
          ... )

grf.Fp( nom.fichier, col.noms = c( 1, 2 ), p = 0.05, col.p = 'p',
        reference = NULL, groupes = NULL,
        sep = ";", dec = ".", header = TRUE,
        ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>The data frame that contains the compositional variables. Other
objects will be coerced as data frames using
<code>as.data.frame</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nom.fichier</code></td>
<td>

<p>A length-one character vector giving the name of the file
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noms</code></td>
<td>

<p>A character vector containing the column names of the compositional
variables to be used for ratio computations. Names absent from the
data frame will be ignored with a warning.
</p>
<p>Optionnally, an integer vector containing the column numbers can be
given instead. They will be converted to column names before further
processing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.p</code></td>
<td>

<p>An R function that will perform the hypothesis test on a single
ratio (or log ratio, depending on <code>log</code> and <code>en.log</code>
values).
</p>
<p>This function should return a numeric vector, of which the first one
will typically be the p-value from the test â€” see
<code>creer.Mp</code> for details. 
</p>
<p>Such functions are provided for several common situations, see
links at the end of this manual page.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>If <code>TRUE</code>, values in the columns are assumed to be
log-transformed, and consequently ratios are computed as differences
of the columns. The result is in the log scale.
</p>
<p>If <code>FALSE</code>, values are assumed to be raw data and ratios are
computed directly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en.log</code></td>
<td>
<p> If <code>TRUE</code>, the ratio will be log-transformed
before applying the hypothesis test computed by <code>f.p</code>. Don't
change the default unless you really know what you are doing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nom.var</code></td>
<td>
<p> A length-one character vector giving the name of the
variable containing a single ratio (or log-ratio). No sanity check
is performed on it: if you experience strange behaviour, check you
gave a valid column name, for instance using
<code>make.names</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noms.colonnes</code></td>
<td>
<p> A length-three character vector giving the names
of, respectively, the two columns of the data frame that will contain
the components identifiers and of the column that will contain the
p-value from the test (the first value returned by <code>f.p</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.col</code></td>
<td>
<p>A character vector giving the names of additional
columns of the data.frame, used for storing additional return values
of <code>f.p</code> (all but the first one).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep, dec, row.names, col.names, header</code></td>
<td>
<p>Options for controling
the file format, used by <code>write.table</code> and
<code>read.table</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.noms</code></td>
<td>
<p> A length-two vector giving the two columns that
contain the two components of the ratio. Can be given either as
column number or column name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.p</code></td>
<td>
<p> A length-one vector giving the column that contain the
<em>p</em>-value of the ratio. Can be given either as column number or
column name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The <em>p</em>-value cut-off to be used when creating the
graph, see <code>grf.Mp</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p> A character vector giving the names of nodes that
should be displayed with a different color in the created graph.
These names should match components names present un the
file. Typical use would be for reference genes in qRT-PCR
experiments.  By default, all nodes are displayed in palegreen;
reference nodes, if any, will be displayed in orange. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupes</code></td>
<td>
<p> A list of character vectors giving set of logically
related nodes, defining groups of nodes that will share common color.
Currently unimplemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>f.p</code>, passed unchanged to
it.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> These functions are basically the same as the function that
create data.frames (<code>creer.DFp</code>) and use data.frames to
create a graph (<code>grf.DFp</code>), except thatthey work on text
files.  This allow to deal with compositionnal data including
thousands of components, like RNA-Seq or microarray data.
</p>
<p>Seeing the results as a matrix, computations are done in rows and the
file is updated after each row. Only the upper-triangular part,
without the diagonal, is stored in the file.
</p>
<p>The function that creates the graphe from file is not very efficient
and can take a lot of time for huge matrices.  Making a first filter
on the file using shell tools, like <code>gawk</code> or <code>perl</code>, or a
dedicated C software and loading the resulting file as a data.frame
before converting it into a graph is a better alternative, but may
lose some isolated nodes.
</p>


<h3>Value</h3>

 <p><code>creer.Fp</code> does not return anything.
<code>grf.Fp</code> returns the result graph.
</p>


<h3>Note</h3>

<p>Creating a file and working from a file is quite inefficient (in terms
of speed), so for compositionnal data with only a few components,
consider using <code>creer.DFp</code> that creates the data.frame
directly in memory and <code>grf.DFp</code> that creates the graphe
from a data.frame instead.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p>Predefined <code>f.p</code> functions: <code>anva1.fpc</code> for one-way
analysis of variance; <code>kw.fpc</code> for the non-parametric
equivalent (Kruskal-Wallis test).
</p>
<p>For directly creating and manipulating matrices,
<code>creer.Mp</code> and  <code>grf.Mp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # load the potery data set
   data( poteries )

   # Create the file name in R temporary directory
   nom.fichier &lt;- paste0( tempdir(), "/fichier_test.csv" )
   nom.fichier

   # Compute one-way ANOVA p-values for all ratios in this data set
   #  and store them in a text file
   creer.Fp( poteries, nom.fichier,
             c( 'Al', 'Na', 'Fe', 'Ca', 'Mg' ),
             f.p = anva1.fpc, v.X = 'Site',
             add.col = c( 'mu0', 'd.C', 'd.CoA', 'd.IT', 'd.L' ) )

   # Make a graphe from it and plot it
   plot( grf.Fp( nom.fichier ) )

   # The file is a simple text-file that can be read as a data.frame
   DFp &lt;- read.table( nom.fichier, header = TRUE, sep = ";", dec = "," )
   DFp  
</code></pre>


</div>