<div class="container">

<table style="width: 100%;"><tr>
<td>spEigen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse Spectral Decomposition of a Matrix</h2>

<h3>Description</h3>

<p>Computes sparse (orthogonal) eigenvectors of covariance matrix or directly of data matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spEigen(X, q = 1, rho = 0.5, data = FALSE, d = NA, V = NA,
  thres = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>m-by-m covariance matrix or n-by-m data matrix (n samples, m variables). Both real and complex matrices are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>number of eigenvectors to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>sparsity weight factor. Any nonnegative number (suggested range [0,1]).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>boolean variable. If <code>TRUE</code>, <code>X</code> is treated as a data matrix, else as a covariance matrix (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>vector with q weights. The default value is <code>seq(from = 1, to = 0.5, length.out = q)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>initial m-by-q matrix point. If not provided, the eigenvectors of the sample covariance matrix are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>threshold value. All the entries of the sparse eigenvectors less or equal to <code>thres</code> are set to 0. The default value is <code>1e-9</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>m-by-q matrix, columns corresponding to the q leading sparse eigenvectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard_vectors</code></td>
<td>
<p>m-by-q matrix, columns corresponding to standard (non-sparse) leading eigenvectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>vector with the q leading eigenvalues (in decreasing order).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Konstantinos Benidis and Daniel P. Palomar
</p>


<h3>References</h3>

<p>K. Benidis, Y. Sun, P. Babu, D. P. Palomar, "Orthogonal Sparse PCA and Covariance Estimation via Procrustes Reformulation,"
<em>IEEE Transactions on Signal Processing</em>, vol. 64, no. 23, pp. 6211-6226, Dec. 2016.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sparseEigen)
n &lt;- 100  # samples
m &lt;- 500  # dimension
q &lt;- 3  # number of sparse eigenvectors to be estimated
sp_card &lt;- 0.1*m  # sparsity of each eigenvector

# generate covariance matrix with sparse eigenvectors
V &lt;- matrix(0, m, q)
V[cbind(seq(1, q*sp_card), rep(1:q, each = sp_card))] &lt;- 1/sqrt(sp_card)
V &lt;- cbind(V, matrix(rnorm(m*(m-q)), m, m-q))
V &lt;- qr.Q(qr(V))  # orthogonalize eigenvectors
lmd &lt;- c(100*seq(from = q, to = 1), rep(1, m-q))  # generate eigenvalues
R &lt;- V %*% diag(lmd) %*% t(V)  # covariance matrix

# generate data
X &lt;- MASS::mvrnorm(n, rep(0, m), R)  # random data with underlying sparse structure

# standardand sparse eigenvectors
res_standard &lt;- eigen(cov(X))
res_sparse &lt;- spEigen(cov(X), q)

# show inner product between estimated eigenvectors and originals (the closer to 1 the better)
abs(diag(t(res_standard$vectors) %*% V[, 1:q]))  #for standard estimated eigenvectors
abs(diag(t(res_sparse$vectors) %*% V[, 1:q]))    #for sparse estimated eigenvectors
</code></pre>


</div>