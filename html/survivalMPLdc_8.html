<div class="container">

<table style="width: 100%;"><tr>
<td>surv_data_dc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a sample of time to event dataset with dependent right censoring under an Archimedean copula</h2>

<h3>Description</h3>

<p>Generate a sample of time to event dataset with, dependent right censoring based on one of the Archimedean copulas the given Kendall's tau, sample size n and covariates matrix Z.
</p>


<h3>Usage</h3>

<pre><code class="language-R">surv_data_dc(n, a, Z, lambda, betas, phis, cons7, cons9, tau, copula, distr.ev, distr.ce)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size, or the number of the subjects in a sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the shape parameter of baseline hazard for the event time <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the covariate matrix with dimension of <code class="reqn">n</code> by <code class="reqn">p</code>, where <code class="reqn">p</code> is the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the scale parameter of baseline hazard for event time <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>the regression coefficient vector of proportional hazard model for the event time <code class="reqn">T</code> with dimenion of <code class="reqn">p</code> by <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phis</code></td>
<td>
<p>the regression coefficient vector of proportional hazard model for dependent censoring time <code class="reqn">C</code> with dimenion of <code class="reqn">p</code> by <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cons7</code></td>
<td>
<p>the parameter of baseline hazard for the dependent censoring time <code class="reqn">C</code> if assuming an exponential distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cons9</code></td>
<td>
<p>the upper limit parameter of uniform distribution for the independent censoring time <code class="reqn">A</code>,
i.e. <code class="reqn">A</code>~U(0, cons9).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the Kendall's correlation coefficient between <code class="reqn">T</code> and <code class="reqn">C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the Archemedean copula that captures the dependence between <code class="reqn">T</code> and <code class="reqn">C</code>, a characteristc value,
i.e. 'independent', 'clayton', 'gumbel' or 'frank'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr.ev</code></td>
<td>
<p>the distribution of the event time, a characteristc value, i.e. 'weibull' or 'log logit'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr.ce</code></td>
<td>
<p>the distribution of the dependent censoring time, a characteristc value, i.e. 'exponential' or 'weibull'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>surv_data_dc allows to generate a survival dataset under dependent right censoring, at sample size <code>n</code>, based on one of the Archimedean <code>copula</code>,
Kendall's <code>tau</code>, and covariates matrix <code>Z</code> with dimension of <code class="reqn">n</code> by <code class="reqn">p</code>. For example, at <code>p=2</code>, we have <code>Z=cbind(Z1, Z2)</code>,
where <code>Z1</code> is treatment generated by distribution of bernoulli(0.5), i.e. 1 represents treatment group and 0 represents control group; <code>Z2</code> is the age
generated by distribution of U(-10, 10).
</p>
<p>The generated dataset includes three varaibles, which are <code class="reqn">X_i</code>, <code class="reqn">\delta_i</code> and <code class="reqn">\eta_i</code>, i.e.
<code class="reqn">X_i=min(T_i, C_i, A_i)</code>, <code class="reqn">\delta_i=I(X_i=T_i)</code> and <code class="reqn">\eta_i=I(X_i=C_i)</code>, for <code class="reqn">i=1,\ldots,n</code>.
'T' represents the event time, whose hazard function is </p>
<p style="text-align: center;"><code class="reqn">h_T(x)=h_{0T}(x)exp(Z^{\top}\beta)</code>
</p>
<p>,
where the baseline hazard can take weibull form, i.e. <code class="reqn">h_{0T}(x) = ax^{a-1} / \lambda^a</code>, or log logistic form, i.e.
</p>
<p style="text-align: center;"><code class="reqn"> h_{0T}(x) = \frac{ \frac{ 1 }{ a exp( \lambda ) } ( \frac{ x }{ exp( \lambda ) } )^{1/a -1 } }{ 1 + ( \frac{ x }{ exp( \lambda ) } )^{1/a}  } </code>
</p>
<p>.
'C' represents the dependent censoring time, whose hazard function is <code class="reqn"> h_{C}(x) = h_{0C}(x)exp( Z^{\top}\phi) </code>, where the baseline hazard can take exponential form, i.e.
<code class="reqn">h_{0C}(x)=cons7</code>, or weibull form, i.e. <code class="reqn">h_{0C}(x) = ax^{a-1} / \lambda^a</code>.'A' represents the administrative or independent censoring time, where A~U(0, cons9).
</p>


<h3>Value</h3>

<p>A sample of time to event dataset under dependent right censoring, which includes observed time <code class="reqn">X</code>, event indicator <code class="reqn">\delta</code> and dependent censoring indicator <code class="reqn">\eta</code>.
</p>


<h3>Author(s)</h3>

<p>Jing Xu, Jun Ma, Thomas Fung
</p>


<h3>References</h3>

<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>"Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood"</em>.
Statistics in Medicine 37, 2238â€“2251.
</p>


<h3>See Also</h3>

<p><code>coxph_mpl_dc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ##-- Copula types
 copula3 &lt;- 'frank'

 ##-- Marginal distribution for T, C, and A
 a &lt;- 2
 lambda &lt;- 2
 cons7 &lt;- 0.2
 cons9 &lt;- 10
 tau &lt;- 0.8
 betas &lt;- c(-0.5, 0.1)
 phis &lt;- c(0.3, 0.2)
 distr.ev &lt;- 'weibull'
 distr.ce &lt;- 'exponential'

 ##-- Sample size
 n &lt;- 200

 ##-- One sample Monte Carlo dataset
 cova &lt;- cbind(rbinom(n, 1, 0.5), runif(n, min=-10, max=10))
 surv &lt;- surv_data_dc(n, a, cova, lambda, betas, phis, cons7, cons9,
                     tau, copula3, distr.ev, distr.ce)
 n &lt;- nrow(cova)
 p &lt;- ncol(cova)
 ##-- event and dependent censoring proportions
 colSums(surv)[c(2,3)]/n
 X &lt;- surv[,1] # Observed time
 del&lt;-surv[,2] # failure status
 eta&lt;-surv[,3] # dependent censoring status


</code></pre>


</div>