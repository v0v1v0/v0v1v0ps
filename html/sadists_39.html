<div class="container">

<table style="width: 100%;"><tr>
<td>kprime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The K prime distribution.</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the K prime distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dkprime(x, v1, v2, a, b = 1, order.max=6, log = FALSE)

pkprime(q, v1, v2, a, b = 1, order.max=6, lower.tail = TRUE, log.p = FALSE)

qkprime(p, v1, v2, a, b = 1, order.max=6, lower.tail = TRUE, log.p = FALSE)

rkprime(n, v1, v2, a, b = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v1</code></td>
<td>
<p>the degrees of freedom in the numerator chisquare. When
(positive) infinite, we recover a non-central t 
distribution with <code>v2</code> degrees of freedom and non-centrality
parameter <code>a</code>, scaled by <code>b</code>.
This is not recycled against the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v2</code></td>
<td>
<p>the degrees of freedom in the denominator chisquare.
When equal to infinity, we recover the Lambda prime distribution.
This is not recycled against the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the non-centrality scaling parameter. When equal to zero,
we recover the (central) t distribution.
This is not recycled against the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>the scaling parameter.
This is not recycled against the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.max</code></td>
<td>
<p>the order to use in the approximate density,
distribution, and quantile computations, via the Gram-Charlier,
Edeworth, or Cornish-Fisher expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, densities <code class="reqn">f</code> are given 
as <code class="reqn">\mbox{log}(f)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given 
as <code class="reqn">\mbox{log}(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose <code class="reqn">y \sim \chi^2\left(\nu_1\right)</code>, and
<code class="reqn">x \sim t \left(\nu_2, a\sqrt{y/\nu_1}/b\right)</code>.
Then the random variable
</p>
<p style="text-align: center;"><code class="reqn">T = b x</code>
</p>

<p>takes a K prime distribution with parameters 
<code class="reqn">\nu_1, \nu_2, a, b</code>. In Lecoutre's terminology,
<code class="reqn">T \sim K'_{\nu_1, \nu_2}\left(a, b\right)</code>
</p>
<p>Equivalently, we can think of
</p>
<p style="text-align: center;"><code class="reqn">T = \frac{b Z + a \sqrt{\chi^2_{\nu_1} / \nu_1}}{\sqrt{\chi^2_{\nu_2} / \nu_2}}</code>
</p>

<p>where <code class="reqn">Z</code> is a standard normal, and the normal and the (central) chi-squares are
independent of each other. When <code class="reqn">a=0</code> we recover
a central t distribution; 
when <code class="reqn">\nu_1=\infty</code> we recover a rescaled non-central t distribution;
when <code class="reqn">b=0</code>, we get a rescaled square root of a central F
distribution; when <code class="reqn">\nu_2=\infty</code>, we recover a 
Lambda prime distribution.
</p>


<h3>Value</h3>

<p><code>dkprime</code> gives the density, <code>pkprime</code> gives the 
distribution function, <code>qkprime</code> gives the quantile function, 
and <code>rkprime</code> generates random deviates.
</p>
<p>Invalid arguments will result in return value <code>NaN</code> with a warning.
</p>


<h3>Note</h3>

<p>The PDF, CDF, and quantile function are approximated, via
the Edgeworth or Cornish Fisher approximations, which may
not be terribly accurate in the tails of the distribution.
You are warned.
</p>
<p>The distribution parameters are <em>not</em> recycled
with respect to the <code>x, p, q</code> or <code>n</code> parameters,
for, respectively, the density, distribution, quantile
and generation functions. This is for simplicity of
implementation and performance. It is, however, in contrast
to the usual R idiom for dpqr functions.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lecoutre, Bruno. "Two Useful distributions for Bayesian predictive
procedures under normal models." Journal of Statistical Planning and
Inference 79, no. 1 (1999): 93-105. 
</p>
<p>Poitevineau, Jacques, and Lecoutre, Bruno. "Implementing Bayesian predictive
procedures: The K-prime and K-square distributions." Computational Statistics 
and Data Analysis 54, no. 3 (2010): 724-731.  <a href="https://arxiv.org/abs/1003.4890v1">https://arxiv.org/abs/1003.4890v1</a>
</p>


<h3>See Also</h3>

<p>t distribution functions, <code>dt, pt, qt, rt</code>,
lambda prime distribution functions, <code>dlambdap, plambdap, qlambdap, rlambdap</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">d1 &lt;- dkprime(1, 50, 20, a=0.01)
d2 &lt;- dkprime(1, 50, 20, a=0.0001)
d3 &lt;- dkprime(1, 50, 20, a=0)
d4 &lt;- dkprime(1, 10000, 20, a=1)
d5 &lt;- dkprime(1, Inf, 20, a=1)

</code></pre>


</div>