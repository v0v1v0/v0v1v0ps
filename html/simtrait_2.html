<div class="container">

<table style="width: 100%;"><tr>
<td>allele_freqs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute locus allele frequencies</h2>

<h3>Description</h3>

<p>On a regular matrix, this is essentially a wrapper for <code>colMeans()</code> or <code>rowMeans()</code> depending on <code>loci_on_cols</code>.
On a BEDMatrix object, the locus allele frequencies are computed keeping memory usage low.
</p>


<h3>Usage</h3>

<pre><code class="language-R">allele_freqs(X, loci_on_cols = FALSE, fold = FALSE, m_chunk_max = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The genotype matrix (regular R matrix or BEDMatrix object).
Missing values are ignored in averages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loci_on_cols</code></td>
<td>
<p>If <code>TRUE</code>, <code>X</code> has loci on columns and individuals on rows; if false (the default), loci are on rows and individuals on columns.
If <code>X</code> is a BEDMatrix object, code assumes loci on columns (<code>loci_on_cols</code> is ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p>If <code>TRUE</code>, allele frequencies are converted to minor allele frequencies.
Default is to return frequencies for the given allele counts in <code>X</code> (regardless of whether it is the minor or major allele).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_chunk_max</code></td>
<td>
<p>BEDMatrix-specific, sets the maximum number of loci to process at the time.
If memory usage is excessive, set to a lower value than default (expected only for extremely large numbers of individuals).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The vector of allele frequencies, one per locus.
Names are set to the locus names, if present.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Construct toy data
X &lt;- matrix(
    c(0, 1, 2,
      1, 0, 1,
      1, NA, 2),
    nrow = 3,
    byrow = TRUE
)

# row means
allele_freqs(X)
c(1/2, 1/3, 3/4)

# row means, in minor allele frequencies
allele_freqs(X, fold = TRUE)
c(1/2, 1/3, 1/4)

# col means
allele_freqs(X, loci_on_cols = TRUE)
c(1/3, 1/4, 5/6)

</code></pre>


</div>