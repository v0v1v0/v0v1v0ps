<div class="container">

<table style="width: 100%;"><tr>
<td>adonis.tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to perform adonis test of independence on p-values from tests of multiple OTUs. 
</h2>

<h3>Description</h3>

<p><code>adonis.tree</code> takes <code>tree</code> and <code>unsorted.pvalues</code> and computes a p-value corresponding to a test for significant differences among the p-values in <code>unsorted.pvalues</code> based on the between-OTU distances in the phylogenetic tree <code>tree</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adonis.tree(tree, unsorted.pvalues, seed=1234, perms=10000, z=TRUE, make2sided=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree of class <code>phylo</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unsorted.pvalues</code></td>
<td>
<p>a data frame (or matrix) with tip labels in column 1 and p-values in column 2.  The tip labels must correspond to the tip labels in <code>tree</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>positive integer seed value, to force reproducibility of permutations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>number of permutations to employ for adonis test
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>logical argument (TRUE or FALSE) indicating whether or not to convert p-values to corresponding standard normal (Z) variates, on which scale the adonis test would subsequently be performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make2sided</code></td>
<td>
<p>logical argument (TRUE or FLASE) indicating whether or not to convert p-values to two-sided; this should be TRUE whenever <code>unsorted.pvalues</code> are one-sided p-values.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After converting p-values to corresponding standard normal (Z) variates (when <code>make2sided=TRUE</code>), and obtaining the distance matrix of between-OTU distances, this function employs the <code>adonis</code> function of the package <code>vegan</code>.  This effectively results in a test of whether the OTU p-values are independent (the null hypothesis here), or whether differences among the OTU p-values are associated with between-OTU distances.
</p>
<p>The "adonis" method was apparently originally called "anodis", for "analysis of dissimilarities".  To more easily distinguish this method from ANOSIM ("analysis of similarities", which also handles dissimilarities), it was re-named "anodis".  According to the help file for <code>adonis</code>, "Most anosim models could be analyzed with adonis, which seems to be a more robust alternative" because it is less sensitive to dispersion effects (Warton et al., 2012).
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function returns a single numeric value, corresponding to a p-value of null: "p-values for OTUs are independent" vs. alternative: "OTU p-value differences are associated with pairwise OTU distances".
</p>


<h3>Author(s)</h3>

<p>John R. Stevens
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) "SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree."  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) "SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree" (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>
<p>Anderson, M.J. (2001) "A new method for non-parametric multivariate analysis of variance." Austral Ecology, 26: 32-46.
</p>
<p>Reiss P.T., Stevens M.H.H., Shehzad Z., Petkova E., and Milham M.P. (2010) "On Distance-Based Permutation Tests for Between-Group Comparisons." Biometrics 66:636-643.
</p>
<p>Warton, D.I., Wright, T.W., Wang, Y. (2012)  "Distance-based multivariate analyses confound location and dispersion effects." Methods in Ecology and Evolution, 3, 89-101. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">### To access the tutorial document for this package, type in R (not run here): 
# vignette('SigTree')

### Create tree, then data frame, then use plotSigTree to plot the tree
### Code for random tree and data frame
node.size &lt;- 10
seed &lt;- 109
# Create tree
set.seed(seed);
library(ape)
r.tree &lt;- rtree(node.size)
# Create p-values data frame
set.seed(seed)
r.pval &lt;- rbeta(node.size, .1, .1)
# Randomize the order of the tip labels
# (just to emphasize that labels need not be sorted)
set.seed(seed)
r.tip.label &lt;- sample(r.tree$tip.label, size=length(r.tree$tip.label))
r.pvalues &lt;- data.frame(label=r.tip.label, pval=r.pval)

# Check for dependence among p-values; lack of significance here
# indicates default test="Stouffer" would be appropriate in other 
# main SigTree package functions (plotSigTree, export.figtree, 
# and export.inherit); otherwise, test="Hartung" would be more 
# appropriate.
adonis.tree(r.tree,r.pvalues)

</code></pre>


</div>