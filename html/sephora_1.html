<div class="container">

<table style="width: 100%;"><tr>
<td>sephora-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical Estimation of Phenological Parameters</h2>

<h3>Description</h3>

<p>Estimates phenological dates of satellite imagery time series. Originally
conceived to handle <a href="https://modis.gsfc.nasa.gov/">MODIS</a> time series (especifically
<a href="https://lpdaac.usgs.gov/products/mod13q1v006/">MOD13Q1</a>), this package can handle 
Earth Observation time series from any satellite mission.
</p>


<h3>Details</h3>

<p>The main function of this package, <code>phenopar</code>, allows a <code>numeric</code> 
vector containing satellite-based measurements (preferably, vegetation indices for better results). 
These observations can be construed as realizations of an underlying periodic stochastic process that has been recorded 
from the first day of the year (DoY) of <code>startYear</code> to the last DoY of <code>endYear</code>. 
Thus, each numeric vector can be assembled as a matrix whose number of rows and columns equal
to <code>length(startYear:endYear)</code> and <code>frequency</code>, respectively, see <code>get_metadata_years</code>. Moreover,
each row of this matrix can be thought as the realization of the periodic stochastic
process throughout a season. Thus, having multiple measurements of such a process, functional 
principal component methods are employed to extract an underlying idealized (vegetation index) curve. 
</p>
<p>The phenological dates that can be estimated with sephora are:
</p>

<ul>
<li> <p><b>Green Up (GU)</b>.
</p>
</li>
<li> <p><b>Start of Season (SoS)</b>.
</p>
</li>
<li> <p><b>Maturity (Mat)</b>.
</p>
</li>
<li> <p><b>Senescence (Sen)</b>.
</p>
</li>
<li> <p><b>End of Season (EoS)</b>.
</p>
</li>
<li> <p><b>Dormancy (Dor)</b>.
</p>
</li>
</ul>
<h3>Data handling</h3>

<p>The following functions allow to access numeric vectors of time series satellite 
imagery, in particular, MOD13Q1 time series starting at February 18, 2000. 
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>fill_initialgap_MOD13Q1</code>
</td>
<td style="text-align: left;"> Fill first 3 MOD13Q1 observations </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>vecFromData</code>
</td>
<td style="text-align: left;"> Get numeric vector from an RData file </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>vecToMatrix</code>
</td>
<td style="text-align: left;"> Set numeric vector as a matrix </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>get_metadata_years</code>
</td>
<td style="text-align: left;"> Get metadata useful in certain visualizations </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Modeling</h3>

<p>The following functions allow to smooth out and fit a regression model based on 
Functional Principal Components. Applications of these functions allow to estimate 
phenological parameters of numeric vectors of Earth Observation time series:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>ndvi_derivatives</code>
</td>
<td style="text-align: left;"> Derivatives of idealized NDVI curve </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>phenopar</code>
</td>
<td style="text-align: left;"> Estimate phenological dates </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>phenopar_polygon</code>
</td>
<td style="text-align: left;"> Estimate phenological dates (parallel processing) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Plotting</h3>

<p>Plot methods for numeric and <code>sephora</code> objects:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>getSpiralPlot</code>
</td>
<td style="text-align: left;"> Spiral plot of polygon-based phenological date estimates </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>plot.sephora</code>
</td>
<td style="text-align: left;"> Plot methods for <code>sephora-class</code> object </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Miscellaneous</h3>


<table>
<tr>
<td style="text-align: left;">
  <code>datesToDoY</code>
</td>
<td style="text-align: left;"> Maps estimated phenological dates to days of a year </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>getDist_phenoParam</code>
</td>
<td style="text-align: left;"> Access to vectors of phenological date estimates from a list </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>global_min_max</code>
</td>
<td style="text-align: left;"> Global critical points of a curve on a closed interval </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>local_min_max</code>
</td>
<td style="text-align: left;"> Local critical points of a curve on a union of open intervals </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tecuapetla-GÃ³mez, I. <a href="mailto:itecuapetla@conabio.gob.mx">itecuapetla@conabio.gob.mx</a>
</p>


</div>