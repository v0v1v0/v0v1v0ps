<div class="container">

<table style="width: 100%;"><tr>
<td>panelReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits Semiparametric Regression Models for Panel Count Survival Data</h2>

<h3>Description</h3>

<p>Fits an proportional means model:
</p>
<p style="text-align: center;"><code class="reqn">\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(t)e^{X_i ' \beta},</code>
</p>

<p>where <code class="reqn">\beta</code> is a <code class="reqn">p \times 1</code> vector of covariate
coefficient and <code class="reqn">\Lambda(\cdot)</code> is a completely unspecified
baseline mean function.
</p>
<p>Estimating procedures include: Wang-Yan's augmented estimating
equations (<code>"AEE"</code>, <code>"AEEX"</code>),
Huang-Wang-Zhang's method (<code>"HWZ"</code>),
Zhang's maximum pseudo-likelihood (<code>"MPL"</code>),
Maximum pseudolikelihood with I-Splines (<code>"MPLs"</code>),
Maximum likelihood with I-Splines (<code>"MLs"</code>),
Sun-Wei's method (<code>"EE.SWa"</code>, <code>"EE.SWb"</code>, <code>"EE.SWc"</code>),
and Hu-Sun-Wei's method (<code>"EE.HSWc"</code>, <code>"EE.HSWm"</code>).
</p>
<p>The function can also fits an accelerated mean model (<code>"AMM"</code>):
</p>
<p style="text-align: center;"><code class="reqn">\Lambda (t; X_i) = E[N_i(t)|X_i] = \Lambda(te^{X_i ' \beta})e^{X_i ' \beta}.</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">panelReg(formula, data, method = c("AEE", "AEEX", "HWZ", "MPL", "MPLs",
  "MLs", "AMM", "EE.SWa", "EE.SWb", "EE.SWc", "EE.HSWc", "EE.HSWm"),
  se = c("NULL", "smBootstrap", "Bootstrap", "Impute", "Sandwich"),
  control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, with the response on the left of a
"~" operator, and the terms on the right. The response must be a
panel count survival object as returned by function <code>PanelSurv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame in which to interpret the variables named in
the <code>formula</code>. Three variables including subjects' id,
observation times, and number of new events since last
observation time are required to feed into function
<code>PanelSurv</code> as response. At least one covariate variable is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Fitting method. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Standard error estimation method. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters. See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Some assumptions details about the observation times and censoring
time need clarification. Three possible scenarios of observation
times are considered: 1) independent observation times – the
observation times are independent of the underlying recurrent event
process; 2) conditional independent observation times – the
observation times are independent of the event process given
observed covariates; 3) informative observation times – after
conditioning on observed covariates, the observation times and the
event process are still dependent through an unobserved
multiplicative frailty. Similarly, the three scenarios apply to the
censoring time.
</p>
<p><code>"AEE"</code> and <code>"AEEX"</code> are the augmented estimating
equation methods under conditional independent censoring and
informative censoring respectively. Both allow informative observation times.
</p>
<p><code>"HWZ"</code> is Huang-Wang-Zhang's method. It allows both
information observation times and informative censoring time. It does
not need to specify the dependence structure or model the frailty.
</p>
<p><code>"MPL"</code> and <code>"MPLs"</code> are maximum pseudolikelihood
methods, with nonparametric and monotone spline estimates of the baseline
mean function respectively. They assume conditional independent
observation times and censoring time. The underlying event process
is assumed to be Poisson, and the within subjects dependence is ignored.
</p>
<p><code>"MLs"</code> is maximum likelihood method with monotone splines
estimates of the baseline mean function. It assumes conditional
independent observation times and censoring time, and a Poisson
underlying event process.
</p>
<p><code>"EE.SWa"</code>, <code>"EE.SWb"</code> and <code>"EE.SWc"</code> are estimating
equation approaches based on Sun-Wei's methods.
The first assumes independent observation times and censoring
time. The second assumes conditional independent observation times but
independent censoring time. The third assumes conditional independent
observation times and censoring time. All three variations work on
centered covariates and avoid estimating the baseline mean.
</p>
<p><code>"EE.HSWc"</code> and <code>"EE.HSWm"</code> are estimating
equation approaches based on Hu-Sun-Wei's methods.
The first assumes independent observation times and censoring
time. The second assumes conditional independent observation times but
independent censoring time. Both variations work on centered covariates
and avoid estimating the baseline mean.
</p>
<p><code>"AMM"</code> is the accelerated mean model.
The observation time process is allowed to be correlated with
the underlying recurrent event process through a frailty variable,
which does not need to be specified. The model also allows marginal
interpretations for the regression parameters and connects naturally
with AFT model. See Chiou et al. (2017) for more details.
</p>
<p>For standard errors estimation method:
</p>
<p><code>"NULL"</code> means do not calculate standard errors;
<code>"smBootstrap"</code> is the smoothed bootstrap estimation method
that works with <code>"AMM"</code>.
<code>"Bootstrap"</code> works with all fitting methods; <code>"Impute"</code> is
the multiple imputation method that works with <code>"AEE"</code> and
<code>"AEEX"</code>; <code>"Sandwich"</code> is the robust sandwich estimation
method that works with <code>"AEE"</code> and <code>"AEEX"</code>.
</p>
<p>The <code>control</code> argument is a list that can supply any of the
following components:
</p>

<dl>
<dt>
<code>betaInit</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>,
initial value for covariate coefficient, default <code>0</code>.</p>
</dd>
<dt>
<code>interval</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>,
initial search interval for solving <code>beta</code>, default
<code>(-5, 5)</code>.</p>
</dd>
<dt>
<code>maxIter</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>, maximum
iteration allowed, default <code>500</code> for <code>"AEEX"</code> and
<code>"HWZ"</code>, <code>150</code> for others.</p>
</dd>
<dt>
<code>absTol</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>, absolute
tolerance, default <code>1e-6</code>.</p>
</dd>
<dt>
<code>relTol</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>, relative
tolerance, default <code>1e-6</code>.</p>
</dd>
<dt>
<code>a</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>, a tune parameter,
default <code>0.1</code>. In the case of gamma frailty, <code>"a"</code>
corresponds to the value of both shape and rate parameters.</p>
</dd>
<dt>
<code>R</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>, number of
bootstrap or imputation, default 30.</p>
</dd>
</dl>
<h3>Value</h3>

<p>An object of S3 class <code>"panelReg"</code> representing the fit.
See <code>panelReg.object</code> for details.
</p>


<h3>References</h3>

<p>Chiou, S., Xu, G., Yan, J., and Huang, C.-Y. (2017).
Semiparametric estimation of the accelerated mean model with panel count data under
informative examination times. <em>Biometrics</em>, to appear.
&lt;doi: 10.1111/biom.12840&gt;.
</p>
<p>Huang, C.-Y., Wang, M., and Zhang, Y. (2006).
Analysing panel count data with informative observation times.
<em>Biometrika</em>, <b>93</b>(4), 763–776.
</p>
<p>Hu, X. J., Sun, J. and Wei, L. J. (2003).
Regression parameter estimation from panel counts.
<em>Scandinavian Journal of Statistics</em>, <b>30</b>, 25–43.
</p>
<p>Lu, M., Zhang, Y., and Huang, J. (2007).
Estimation of the mean function with panel count data using monotone polynomial splines.
<em>Biometrika</em>, <b>94</b>(3), 705–718.
</p>
<p>Sun, J. and Wei, L. J. (2000). Regression analysis of panel count
data with covariates-dependent observation and censoring times.
<em>Journal of the Royal Statistical Society, Series B: Statistical Methodology</em>,
<b>62</b>(2), 293–302.
</p>
<p>Wang, X. and Yan, J. (2011). Fitting semiparametric regressions for panel
count survival data with an R package spef.
<em>Computer Methods and Programs in Biomedicine</em>, <b>104</b>(2), 278–285.
</p>
<p>Wang, X. and Yan, J. (2013). Augmented estimating equations for
semiparametric panel count regression with informative observation
times and censoring time. <em>Statistica Sinica</em>, 359–381.
</p>
<p>Zhang, Y. (2002). A Semiparametric pseudolikelihood estimation method
for panel count data. <em>Biometrika</em>, <b>89</b>(1), 39–48.
</p>


<h3>See Also</h3>

<p><code>panelReg.object</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(blaTum)
## Fit the bladder tumor data set
formula &lt;- PanelSurv(id, time, count) ~ num + size + treatment

panelReg(formula, data = blaTum, method = "AEE", se = "Sandwich")
panelReg(formula, data = blaTum, method = "AEEX", se = "Impute",
         control = list(a = 0.1, R = 30))
panelReg(formula, data = blaTum, method = "HWZ", se = "Bootstrap",
         control = list(R = 30))
panelReg(formula, data = blaTum, method = "MLs", se = "NULL")
panelReg(formula, data = blaTum, method = "EE.SWa", se = "Bootstrap",
         control = list(R = 30))
panelReg(formula, data = blaTum, method = "EE.HSWc", se = "Bootstrap",
         control = list(R = 30))

## End(Not run)

</code></pre>


</div>