<div class="container">

<table style="width: 100%;"><tr>
<td>fitsadC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML fitting of species abundance distributions to data pooled in abundance classes</h2>

<h3>Description</h3>

<p>Fits probability distributions for abundances of species
aggregated in abundance classes in a sample or assemblage by maximum
likelihood.</p>


<h3>Usage</h3>

<pre><code class="language-R">fitsadC(x, sad = c("exp","gamma","lnorm","pareto", "weibull"), ...)

fitexpC(x, trunc = NULL, start.value, ...)

fitgammaC(x, trunc, start.value,  ...)

fitlnormC(x, trunc, start.value,  ...)

fitparetoC(x, trunc, start.value,  upper = 20, ...)

fitweibullC(x, trunc, start.value,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>histogram</code> with the number of species in
abundance classes, in a sample or ecological assemblage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sad</code></td>
<td>

<p>character; root name of community sad distribution to be fitted.
<kbd>"exp"</kbd> for exponential distribution,
<kbd>"gamma"</kbd> for gamma distribution,
<kbd>"lnorm"</kbd> for lognormal,
<kbd>"pareto"</kbd> for Pareto distribution,
<kbd>"weibull"</kbd> for Weibull distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.value</code></td>
<td>

<p>named numeric vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function,
and in the same order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>real positive; upper bound for Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>in <code>fitsad</code> further arguments to be passed to the specific fitting
function (most used are <code>trunc</code>, <code>start.value</code>)
In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

 <p><code>fitsadC</code> is simply a wrapper that calls the specific
functions to fit the distribution chosen with the argument
<code>sad</code>. Users can interchangeably use <code>fitsadC</code> or the
individual functions detailed below (e.g. <code>fitsad(x, sad="exp",
    ...)</code> is the same as <code>fitexpC(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the maximum likelihood method using
numerical optimization, with <code>mle2</code>.  The resulting object is of
<code>fitsadC-class</code> which can be handled with <code>mle2</code> methods for
fitted models and has also some additional methods for SADs models
(see <code>fitsadC-class</code> and examples).
</p>
<p>For counts of species in abundances classes the likelihood function is
</p>
<p style="text-align: center;"><code class="reqn">L(\theta) = \sum^C n_i \ln P_i</code>
</p>
<p> for
i = 1, 2, 3, ... C, where C is the number of abundance classes,
<code class="reqn">n_i</code> is the number of species in abundance class i.
</p>
<p><code class="reqn">P_i</code> is the probability attributed by the distribution model
to the observation of one species in class i, which depends on the
vector <code class="reqn">\theta</code> of free parameters of the distribution model:
</p>
<p style="text-align: center;"><code class="reqn">P_i = \int_{L_i}^{U_i} F(x \mid \theta) dx</code>
</p>

<p>where F(x|theta) is the value of the probability density function for a
cover value x, under parameter values fixed at theta, and L_i and U_i
are the lower and upper limits of the cover class i.
</p>
<p>See <code>fitsad</code> for descriptions of each distribution model.
</p>


<h3>Value</h3>

<p>An object of <code>fitsadC-class</code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle SADs models
(see <code>fitsadC-class</code>).
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and
Andre Chalom, after Ben Bolker, R Core Team.</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from <span class="pkg">bbmle</span> package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods.
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Chapman, D. G. 1956. Estimating the parameters of a truncated gamma
distribution. <em>The Annals of Mathematical Statistics, 27(2)</em>:
498–506.
</p>
<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princenton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254–283.
</p>
<p>Rinne, H. 2009. <em>The Weibull distribution: a handbook</em>. CRC Press
</p>


<h3>See Also</h3>

 <p><code>dpareto</code>,for corresponding density functions created for
fitting SADs; standard distributions <code>dexp</code>, <code>dgamma</code>,
<code>dlnorm</code>, <code>dweibull</code>;
<code>fitsadC-class</code>.  </p>


<h3>Examples</h3>

<pre><code class="language-R">## An example using data from Vieira et al, see dataset "grasslands"
## Breakpoints of the abundance classes used (cover classes)
vieira.brk &lt;- c(0,1,3,5,seq(15,100, by=10),100)
##  creates an histogram object 
grass.h &lt;- hist(grasslands$mids, breaks = vieira.brk, plot = FALSE)
#Fits Pareto, lognormal and gamma distributions
grass.p &lt;- fitparetoC(grass.h)
grass.l &lt;- fitlnormC(grass.h)
grass.g &lt;- fitgammaC(grass.h)
## Predicted values by each model
grass.p.pred &lt;- coverpred(grass.p)
grass.l.pred &lt;- coverpred(grass.l)
grass.g.pred &lt;- coverpred(grass.g)
## model selection
AICctab(grass.p, grass.l, grass.g, weights =TRUE, base = TRUE)
## A histogram with the densities predicted by each model
plot(grass.h, main = "", xlab = "Abundance (cover)")
## Adds predicted densities by each model to the plot
points(grass.p.pred, col = 1)
points(grass.l.pred, col = 2)
points(grass.g.pred, col = 3)
legend("topright", legend=c("Pareto","Log-normal", "Gamma"), col = 1:3, lty=1, pch =1) 
</code></pre>


</div>