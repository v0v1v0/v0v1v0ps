<div class="container">

<table style="width: 100%;"><tr>
<td>oneill</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>O'Neill's entropy.</h2>

<h3>Description</h3>

<p>This function computes O'Neill's entropy for a data matrix (see O'Neill et al, 1988).
</p>


<h3>Usage</h3>

<pre><code class="language-R">oneill(
  data,
  win = spatstat.geom::owin(xrange = c(0, ncol(data)), yrange = c(0, nrow(data))),
  plotout = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix, can be numeric, factor, character, ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>Optional, an object of class <code>owin</code>, the observation window for data plotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotout</code></td>
<td>
<p>Logical. Default to <code>TRUE</code>, produces an informative plot as part of the function output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>O'Neill's entropy index is based on the transformed variable <code class="reqn">Z</code>, identifying couples of realizations
of the variable of interest:
</p>
<p style="text-align: center;"><code class="reqn">H_O(Z)=\sum p(z_r|C) \log(1/p(z_r|C))</code>
</p>

<p>where <code class="reqn">z_r=(x_i, x_{i'})</code> is a generic couple of realizations of the study variable <code class="reqn">X</code>.
The conditioning on <code class="reqn">C</code> for grid data means that only contiguous couples are considered, i.e.
couples of pixels sharing a border.
All contiguous couples of realizations of the variable of interest are counted
and their relative frequencies are used to compute the index. The maximum value for O'Neill's entropy is
<code class="reqn">\log(I^2)</code> where <code class="reqn">I</code> is the number of categories of <code class="reqn">X</code>. The relative version of O'Neill's entropy
is obtained by dividing the entropy value by its maximum, and is useful for comparison across datasets with
a different number of categories.
The function is able to work with grids containing missing data, specified as NA values.
All NAs are ignored in the computation and only couples of non-NA observations are considered.
</p>


<h3>Value</h3>

<p>a list of four elements:
</p>

<ul>
<li> <p><code>oneill</code> O'Neill's entropy
</p>
</li>
<li> <p><code>range</code> the theoretical range of O'Neill's entropy, from 0 to <code class="reqn">\log(I^2)</code>
</p>
</li>
<li>
<p><code>rel.oneill</code> O'Neill's relative entropy
</p>
</li>
<li> <p><code>probabilities</code> a table with absolute frequencies and estimated probabilities (relative frequencies) for all couple categories
</p>
</li>
</ul>
<p>Moreover, a plot of the dataset is produced.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#numeric data, square grid
data=matrix(sample(1:5, 100, replace=TRUE), nrow=10)
oneill(data)
#plot data
plot(as.im(data, W=square(nrow(data))),
     col=grDevices::gray(seq(1,0,length.out=length(unique(c(data))))),
     main="", ribbon=TRUE)

#character data, rectangular grid
data=matrix(sample(c("a","b","c"), 300, replace=TRUE), nrow=30)
oneill(data)
#plot data
plot(as.im(data, W=owin(xrange=c(0,ncol(data)), yrange=c(0,nrow(data)))),
     col=terrain.colors(length(unique(c(data)))),
     main="", ribbon=TRUE)

#data with missing values
data=matrix(sample(1:5, 100, replace=TRUE), nrow=10)
data=rbind(rep(NA, ncol(data)), data, rep(NA, ncol(data)))
oneill(data)

</code></pre>


</div>