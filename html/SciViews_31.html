<div class="container">

<table style="width: 100%;"><tr>
<td>panels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>More panel plots.</h2>

<h3>Description</h3>

<p>Several panel plots that can be used with functions like <code>coplot()</code> and
[pairs))].
</p>
<p>[pairs))]: R:pairs))
</p>


<h3>Usage</h3>

<pre><code class="language-R">panel_reg(x, y, col = par("col"), bg = par("bg"), pch = par("pch"),
  cex = par("cex"), lwd = par("lwd"), line.reg = lm, line.col = "red",
  line.lwd = lwd, untf = TRUE, ...)

panel.reg(x, y, col = par("col"), bg = par("bg"), pch = par("pch"),
  cex = par("cex"), lwd = par("lwd"), line.reg = lm, line.col = "red",
  line.lwd = lwd, untf = TRUE, ...)

panel_ellipse(x, y, col = par("col"), bg = par("bg"), pch = par("pch"),
  cex = par("cex"), el.level = 0.7, el.col = "cornsilk",
  el.border = "red", major = TRUE, ...)

panel.ellipse(x, y, col = par("col"), bg = par("bg"), pch = par("pch"),
  cex = par("cex"), el.level = 0.7, el.col = "cornsilk",
  el.border = "red", major = TRUE, ...)

panel_cor(x, y, use = "everything", method = c("pearson", "kendall",
  "spearman"), alternative = c("two.sided", "less", "greater"), digits = 2,
  prefix = "", cex = par("cex"), cor.cex = cex, stars.col = "red", ...)

panel.cor(x, y, use = "everything", method = c("pearson", "kendall",
  "spearman"), alternative = c("two.sided", "less", "greater"), digits = 2,
  prefix = "", cex = par("cex"), cor.cex = cex, stars.col = "red", ...)

panel_smooth(x, y, col = par("col"), bg = NA, pch = par("pch"), cex = 1,
  col.smooth = "red", span = 2/3, iter = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The color of the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>The background color for symbol used for the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>The symbol used for the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>The expansion factor used for the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>The line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.reg</code></td>
<td>
<p>A function that calculates coefficients of a straight line,
for instance, <code>lm()</code>, or <code>rlm()</code> for robust linear regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>The color of the line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>
<p>The width of the line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>untf</code></td>
<td>
<p>Logical asking whether to untransform the straight line in case
one or both axis are in log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to plot functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>el.level</code></td>
<td>
<p>The confidence level for the bivariate normal ellipse around
data; the default value of 0.7 draws an ellipse of roughly +/-1 sd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>el.col</code></td>
<td>
<p>The color used to fill the ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>el.border</code></td>
<td>
<p>The color used to draw the border of the ellipse and the
standardized major axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>major</code></td>
<td>
<p>If <code>TRUE</code>, the standardized major axis is also drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>One of <code>"everything"</code>, <code>"all.obs"</code>, <code>"complete.obs"</code>,
<code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code> (can be abbreviated).
Defines how the <code>cor()</code> function behaves with missing observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of the three correlation coefficients <code>"pearson"</code>
(default), <code>"kendall"</code>, or <code>"spearman"</code>. Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The alternative hypothesis in correlation test, see
<code>cor.test()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of decimal digits to print when the correlation
coefficient is printed in the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>
<p>A prefix (character string) to use before the correlation
coefficient printed in the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.cex</code></td>
<td>
<p>Expansion coefficient for text in printing correlation
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stars.col</code></td>
<td>
<p>The color used for significance stars (with: *** p &lt; 0.001,
** p &lt; 0.1, * p &lt; 0.05, . p &lt; 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.smooth</code></td>
<td>
<p>Color to be used by lines for drawing the smooths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>Smoothing parameter f for <code>lowess()</code>, see there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of robustness iterations for <code>lowess()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Theses functions should be used outside of the diagonal in
<code>pairs()</code>, or with <code>coplot()</code>, as they are bivariate plots.
</p>


<h3>Value</h3>

<p>These functions return nothing and are used for their side effect of
plotting in panels of composite plots.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean <a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a>, but code inspired from
<code>panel.smooth()</code> in <strong>graphics</strong> and <code>panel.car()</code> in package <strong>car</strong>.
</p>


<h3>See Also</h3>

<p><code>coplot()</code>, <code>pairs()</code>, <code>panel.smooth()</code>, <code>lm()</code>, <code>ellipse()</code>,
<code>cor()</code> and <code>cor.test()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Smooth lines in lower graphs and straight lines in upper graphs
pairs(trees, lower.panel = panel_smooth, upper.panel = panel_reg)
# Robust regression lines
library(MASS)  # For rlm()
pairs(trees, panel = panel_reg, diag.panel = panel_boxplot,
  reg.line = rlm, line.col = "blue", line.lwd = 2)
# A Double log graph
pairs(trees, lower.panel = panel_smooth, upper.panel = panel_reg, log = "xy")

# Graph suitables to explore correlations (take care there are potentially
# many simultaneous tests done here... So, you loose much power in the whole
# analysis... use it just as an indication!)
# Pearson's r
pairs(trees, lower.panel = panel_ellipse, upper.panel = panel_cor)
# Spearman's rho (ellipse and straight lines not suitable here!)
pairs(trees, lower.panel = panel_smooth, upper.panel = panel_cor,
  method = "spearman", span = 1)
# Several groups (visualize how bad it is to consider the whole set at once!)
pairs(iris[, -5], lower.panel = panel_smooth, upper.panel = panel_cor,
  method = "kendall", span = 1,
  col = c("red3", "blue3", "green3")[iris$Species])
# Now analyze correlation for one species only
pairs(iris[iris$Species == "virginica", -5], lower.panel = panel_ellipse,
  upper.panel = panel_cor)

# A coplot with custom panes
coplot(Petal.Length ~ Sepal.Length | Species, data = iris,
  panel = panel_ellipse)
</code></pre>


</div>