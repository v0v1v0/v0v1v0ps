<div class="container">

<table style="width: 100%;"><tr>
<td>ddfilter_loop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter locations by quality index, inner angle, and speed</h2>

<h3>Description</h3>

<p>A partial component of <code>ddfilter</code>, although works as a stand-alone function. 
This function removes locations by speed, inner angle, and quality index as described in Shimada et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ddfilter_loop(sdata, qi = 4, ia = 90, vmaxlp = 1.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: "id", "DateTime", "lat", "lon", "qi". 
See the data <code>turtle</code> for an example.
The function filters the input data by a unique "id" (e.g. transmitter number, identifier for each animal). 
"DateTime" is the GMT date &amp; time of each location in class <code>POSIXct</code> or <code>character</code> with the following format "2012-06-03 01:33:46".
"lat" and "lon" are the latitude and longitude of each location in decimal degrees. 
"qi" is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where "A", "B", "Z" will be replaced with "-1", "-2", "-3" respectively.
The greater number indicates a higher accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qi</code></td>
<td>
<p>An integer specifying a threshold of quality index, which is used to evaluate the locations of loop trips. 
Default is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ia</code></td>
<td>
<p>An integer specifying a threshold of inner angle, which is used to evaluate the locations of loop trips. 
Default is 90 degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmaxlp</code></td>
<td>
<p>A numeric value specifying a threshold of speed, which is used to evaluate the locations of loop trips. 
Default is 1.8 km/h.
If this value is unknown, it can be estimated from <em>sdata</em> using the function <code>vmaxlp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function removes locations if all of the following criteria apply: 
the number of source satellites are less than or equal to <em>qi</em>, 
the inner angle is less than and equal to <em>ia</em> and the speed either from a previous or to a subsequent location exceeds <em>vmaxlp</em>. 
If <em>vmaxlp</em> is unknown, it can be estimated using the function <code>vmaxlp</code>.
</p>


<h3>Value</h3>

<p>The input data is returned without locations identified by this filter.
The following columns are added: "pTime", "sTime", "pDist", "sDist", "pSpeed", "sSpeed", "inAng".
"pTime" and "sTime" are hours from a previous and to a subsequent fix respectively.
"pDist" and "sDist" are straight distances in kilometres from a previous and to a subsequent fix respectively.
"pSpeed" and "sSpeed" are linear speed from a previous and to a subsequent fix respectively.
"inAng" is the degree between the bearings of lines joining successive location points.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code>ddfilter</code>, <code>ddfilter_speed</code>, <code>vmaxlp</code>
</p>


</div>