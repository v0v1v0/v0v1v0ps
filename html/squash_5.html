<div class="container">

<table style="width: 100%;"><tr>
<td>colorgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Draw a colorgram (heatmap) of a matrix </h2>

<h3>Description</h3>

<p>Plot a visual representation of a numeric matrix using colors to indicate values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">colorgram(x = NULL, y = NULL, z = NULL, zsize = 1, 
          map, nz = 10, breaks = pretty, symm = FALSE, base = NA, colFn = jet,
          key = hkey, key.args = list(), 
          xlab = NULL, ylab = NULL, zlab = NULL, 
          outlier = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p> Locations of grid lines at which the values in z are measured. 
These must be finite, non-missing and in (strictly) ascending order.  (see Details below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p> A numeric matrix containing the values to be visualized as colors (NAs are allowed). Note that x can be used instead of z for convenience. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zsize</code></td>
<td>
<p> A numeric matrix specifying the relative size of each rectangle. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p> A list, as generated by <code>makecmap</code>.  If missing, a color map is generated automatically. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nz, breaks, symm, base, colFn</code></td>
<td>
<p> Arguments passed to <code>makecmap</code>, if <code>map</code> is missing. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p> A function to draw a color key, such as <code>hkey</code> or <code>vkey</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.args</code></td>
<td>
<p> Arguments passed to the function given by <code>key</code>.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p> Labels for axes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlab</code></td>
<td>
<p> Label (title) for the color key. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier</code></td>
<td>
<p> Color for values outside the <code>map</code> domain.  
If NULL, values falling outside the map domain will generate an error. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments passed to <code>cimage</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function assigns colors to the elements of a matrix and plots it using <code>cimage</code>.  
</p>
<p>Data can be passed to this function in any format recognized by <code>xyzmat.coords</code>.
</p>
<p><code>colorgram</code> is somewhat similar to <code>image</code>.  However, <code>colorgram</code> adds the following functionality:  1. The value-to-color mapping can be specified (thus allowing unequal bin sizes).  2. A color key can be added, optionally.  3. A color can be specified for missing values.  4. The size of each grid rectangle can be adjusted to convey additional information.
</p>
<p>Two color key functions are provided in the squash package: 1) <code>hkey</code> draws a horizontal key, in the lower-left corner by default. 2) <code>vkey</code>) draws a vertical key, in the lower-right corner by default. The latter usually looks better if the right-hand margin is increased. These keys can be controlled somewhat using <code>key.args</code>.  However, that <code>title</code> and <code>map</code> cannot be specified in <code>key.args</code>; use the <code>zlab</code> and <code>map</code> arguments instead.
</p>


<h3>Value</h3>

<p>Invisibly, <code>map</code>.
</p>


<h3>See Also</h3>

  
<p>If this is not quite what you are looking for, consider <code>image</code>, <code>filled.contour</code>, or <code>levelplot</code>.  Also <code>color2D.matplot</code> in the <span class="pkg">plotrix</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## median Petal.Length as function of Sepal.Length and Sepal.Width
  pl &lt;- matapply( iris[,1:3], FUN = median, nx = 20, ny = 15 )

  ## Draw a colorgram with the default horizontal color key  
  colorgram(pl, main = 'iris')

  ## ... or with the vertical color key  
  colorgram(pl, main = 'iris', key = vkey)

  ## ... add margin space to improve legibility 
  op &lt;- par(mar = c(5,4,4,4)+0.1)
  colorgram(pl, main = 'iris', key = vkey, 
    key.args = list(skip = 2), zlab = 'Petal\nlength')
  par(op)
  
  ##  Here is the example from the base function "persp"
  x &lt;- seq(-10, 10, length= 30)
  y &lt;- x
  f &lt;- function(x,y) { r &lt;- sqrt(x^2+y^2); 10 * sin(r)/(r) }
  z &lt;- outer(x, y, f)
  colorgram(x, y, z)

  ## ... and with a slight fix to the key:
  colorgram(x, y, z, key.args = list(wh = c(1, 4, 14)))

  ## We could also make more space for the key:
  op &lt;- par(mar = c(7,4,4,2)+0.1)
  colorgram(x, y, z, key.args = list(stretch = 3))
  par(op)
  
  ## Here are some alternatives to colorgram  
  persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
  image(x, y, z)  
  contour(x, y, z)

  ## Use 'xlabels' and 'ylabels' to create categorical axes
  colorgram(t(mtcars[,c(2,8:11)]), colFn = heat, 
    xlabels = TRUE, ylabels = TRUE, 
    xlab = NA, ylab = NA, zlab = 'Value', 
    main = 'Motor car specifications', las = 1)
  
</code></pre>


</div>