<div class="container">

<table style="width: 100%;"><tr>
<td>graph.loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph log-likelihood of data</h2>

<h3>Description</h3>

<p>Graph log-likelihood of data
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph.loglik(
  pop_data,
  curve_params,
  noise_params,
  antigen_isos,
  x = 10^seq(-3, 0, by = 0.1),
  highlight_points = NULL,
  highlight_point_names = "highlight_points",
  log_x = FALSE,
  previous_plot = NULL,
  curve_label = paste(antigen_isos, collapse = " + "),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop_data</code></td>
<td>
<p>a <code>data.frame()</code> with cross-sectional serology data per antibody and age, and additional columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_params</code></td>
<td>
<p>a <code>data.frame()</code> containing MCMC samples of parameters from the Bayesian posterior distribution of a longitudinal decay curve model. The parameter columns must be named:
</p>

<ul>
<li> <p><code>antigen_iso</code>: a <code>character()</code> vector indicating antigen-isotype combinations
</p>
</li>
<li> <p><code>iter</code>: an <code>integer()</code> vector indicating MCMC sampling iterations
</p>
</li>
<li> <p><code>y0</code>: baseline antibody level at <code class="reqn">t=0</code> (<code class="reqn">y(t=0)</code>)
</p>
</li>
<li> <p><code>y1</code>: antibody peak level (ELISA units)
</p>
</li>
<li> <p><code>t1</code>: duration of infection
</p>
</li>
<li> <p><code>alpha</code>: antibody decay rate (1/days for the current longitudinal parameter sets)
</p>
</li>
<li> <p><code>r</code>: shape factor of antibody decay
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_params</code></td>
<td>
<p>a <code>data.frame()</code> (or <code>tibble::tibble()</code>) containing the following variables, specifying noise parameters for each antigen isotype:
</p>

<ul>
<li> <p><code>antigen_iso</code>: antigen isotype whose noise parameters are being specified on each row
</p>
</li>
<li> <p><code>nu</code>: biological noise
</p>
</li>
<li> <p><code>eps</code>: measurement noise
</p>
</li>
<li> <p><code>y.low</code>: lower limit of detection for the current antigen isotype
</p>
</li>
<li> <p><code>y.high</code>: upper limit of detection for the current antigen isotype
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antigen_isos</code></td>
<td>
<p>Character vector listing one or more antigen isotypes. Values must match <code>pop_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sequence of lambda values to graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_points</code></td>
<td>
<p>a possible highlighted value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_point_names</code></td>
<td>
<p>labels for highlighted points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_x</code></td>
<td>
<p>should the x-axis be on a logarithmic scale (<code>TRUE</code>) or linear scale (<code>FALSE</code>, default)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous_plot</code></td>
<td>
<p>if not NULL, the current data is added to the existing graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_label</code></td>
<td>
<p>if not NULL, add a label for the curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>log_likelihood</code>
</p>

<dl>
<dt><code>verbose</code></dt>
<dd>
<p>logical: if TRUE, print verbose log information to console</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>ggplot2::ggplot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(tibble)

# Load cross-sectional data
xs_data &lt;- load_pop_data("https://osf.io/download//n6cp3/") %&gt;%
  clean_pop_data()

# Load curve parameters and subset for the purposes of this example
dmcmc &lt;- load_curve_params("https://osf.io/download/rtw5k/") %&gt;%
  filter(antigen_iso %in% c("HlyE_IgA", "HlyE_IgG")) %&gt;%
  slice(1:100, .by = antigen_iso)

# Load noise parameters
cond &lt;- tibble(
  antigen_iso = c("HlyE_IgG", "HlyE_IgA"),
  nu = c(0.5, 0.5),                          # Biologic noise (nu)
  eps = c(0, 0),                             # M noise (eps)
  y.low = c(1, 1),                           # Low cutoff (llod)
  y.high = c(5e6, 5e6))                      # High cutoff (y.high)

# Graph the log likelihood
lik_HlyE_IgA &lt;- graph.loglik(
  pop_data = xs_data,
  curve_params = dmcmc,
  noise_params = cond,
  antigen_isos = "HlyE_IgA",
  log_x = TRUE
)

lik_HlyE_IgA

</code></pre>


</div>