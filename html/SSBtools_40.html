<div class="container">

<table style="width: 100%;"><tr>
<td>FormulaSelection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Limit matrix or data frame to selected model terms</h2>

<h3>Description</h3>

<p>For use with output from <code>ModelMatrix</code> or data frames derived from such output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FormulaSelection(x, formula, intercept = NA)

formula_selection(x, formula, intercept = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Model matrix or a data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula representing the limitation
or character string(s) to be converted to a formula (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Parameter that specifies whether a possible intercept term (overall total) should be included in the output.
Default is <code>TRUE</code> when a formula is input. Otherwise, see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The selection is based on <code>startCol</code> or <code>startRow</code> attribute in input <code>x</code>.
</p>
<p>With <strong>formula as character</strong>:
</p>

<ul>
<li> <p><strong><code>~</code></strong> is included:
Input is converted by <code>as.formula</code> and default intercept is <code>TRUE</code>.
</p>
</li>
<li> <p><strong><code>~</code></strong> is not included:
Internally, input data is converted to a formula by adding <code>~</code> and possibly <code>+</code>'s when the length is <code style="white-space: pre;">⁠&gt;1⁠</code>.
Default intercept is <code>FALSE</code> unless <code>"1"</code> or <code>"(Intercept)"</code> (is changed internally to <code>"1"</code>) is included.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Limited model matrix or a data frame
</p>


<h3>Note</h3>

<p><code>formula_selection</code> and <code>FormulaSelection</code> are identical
</p>


<h3>Examples</h3>

<pre><code class="language-R">z &lt;- SSBtoolsData("sprt_emp_withEU")
z$age[z$age == "Y15-29"] &lt;- "young"
z$age[z$age == "Y30-64"] &lt;- "old"

x &lt;- ModelMatrix(z, formula = ~age * year)

FormulaSelection(x, "age")
FormulaSelection(x, ~year)
FormulaSelection(x, ~year:age)

# x1, x2, x3, x4 and x4 are identical
x1 &lt;- FormulaSelection(x, ~age)
x2 &lt;- FormulaSelection(x, "~age")
x3 &lt;- FormulaSelection(x, "age", intercept = TRUE)
x4 &lt;- FormulaSelection(x, c("1", "age"))
x5 &lt;- FormulaSelection(x, c("(Intercept)", "age"))


a &lt;- ModelMatrix(z, formula = ~age * geo + year, crossTable = TRUE)
b &lt;- cbind(as.data.frame(a$crossTable), 
           sum = (t(a$modelMatrix) %*% z$ths_per)[, 1], 
           max = DummyApply(a$modelMatrix, 
           z$ths_per, max))
rownames(b) &lt;- NULL
attr(b, "startRow") &lt;- attr(a$modelMatrix, "startCol", exact = TRUE)

FormulaSelection(b, ~geo * age)
FormulaSelection(b, "age:geo")
FormulaSelection(b, ~year - 1)
</code></pre>


</div>