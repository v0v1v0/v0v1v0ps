<div class="container">

<table style="width: 100%;"><tr>
<td>fitStateMR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of states at each time point with Moving-Resting Process</h2>

<h3>Description</h3>

<p>Estimate the state at each time point under the Moving-Resting
process with Embedded Brownian Motion with animal movement data at
discretely time points. See the difference between <code>fitStateMR</code>
and <code>fitViterbiMR</code> in detail part. Using <code>fitPartialViterbiMR</code>
to estimate the state within a small piece of time interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitStateMR(data, theta, cutoff = 0.5, integrControl = integr.control())

fitViterbiMR(data, theta, cutoff = 0.5, integrControl = integr.control())

fitPartialViterbiMR(
  data,
  theta,
  cutoff = 0.5,
  startpoint,
  pathlength,
  integrControl = integr.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> whose first column is the observation
time, and other columns are location coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the parameters for Moving-Resting model, in the
order of rate of moving, rate of resting, volatility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the cut-off point for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>Integration control vector includes rel.tol,
abs.tol, and subdivisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoint</code></td>
<td>
<p>Start time point of interested time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathlength</code></td>
<td>
<p>the length of interested time interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fitStateMR</code> estimates the most likely state by maximizing
the probability of <code class="reqn">Pr(S(t = t_k) = s_k | X)</code>, where X is the whole
data and <code class="reqn">s_k</code> is the possible sates at <code class="reqn">t_k</code> (moving, resting).
</p>
<p><code>fitViterbiMR</code> estimates the most likely state path by maximizing
<code class="reqn">Pr(S(t = t_0) = s_0, S(t = t_1) = s_1, ..., S(t = t_n) = s_n | X)</code>, where
X is the whole data and <code class="reqn">s_0, s_1, ..., s_n</code> is the possible
state path.
</p>
<p><code>fitPartialViterbiMR</code> estimates the most likely state path of
a small peice of time interval, by maximizing the probability of
<code class="reqn">Pr(S(t = t_k) = s_k, ..., S(t = t_{k+q-1}) = s_{k+q-1} | X)</code>,
where <code class="reqn">k</code> is the start time point and <code class="reqn">q</code> is the length of interested
time interval.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> contains estimated results, with elements:
</p>

<ul>
<li>
<p> original data be estimated.
</p>
</li>
<li>
<p> conditional probability of moving, resting (<code>p.m</code>,
<code>p.r</code>), which is <code class="reqn">Pr(S(t = t_k) = s_k | X)</code> for
<code>fitStateMR</code>; <code class="reqn">log-Pr(s_0, ..., s_k | X_k)</code> for
<code>fitViterbiMR</code>, where <code class="reqn">X_k</code> is <code class="reqn">(X_0, ..., X_k)</code>;
and <code class="reqn">log-Pr(s_k, ..., s_{k+q-1}|X)</code> for <code>fitPartialViterbiMR</code>.
</p>
</li>
<li>
<p> estimated states with 1-moving, 0-resting.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>See Also</h3>

<p><code>rMR</code> for simulation.
<code>fitMR</code> for estimation of parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(06269)
tgrid &lt;- seq(0, 400, by = 8)
dat &lt;- rMR(tgrid, 4, 3.8, 5, 'm')
fitStateMR(dat, c(4, 3.8, 5), cutoff = 0.5)
fitViterbiMR(dat, c(4, 3.8, 5), cutoff = 0.5)
fitPartialViterbiMR(dat, c(4, 3.8, 5), cutoff = 0.5, 20, 10)

</code></pre>


</div>