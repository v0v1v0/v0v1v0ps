<div class="container">

<table style="width: 100%;"><tr>
<td>mvrnormSeries</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate data under the Dynamic or Rao-Yu Time Series Models</h2>

<h3>Description</h3>

<p>Function to generate data under a Rao-Yu time series model, a
dynamic model, or a mixture of both. The function can produce either
univariate or multivariate observations. All components of the returned
random variable have unconditional mean zero. The function calls 
<code>mvrnorm</code> in <span class="pkg">MASS</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvrnormSeries(NV=1,  D,  TI,  sigma.e, 
   rho.dyn,  sigma.v.dyn,  sigma.u.dyn, rho.u.dyn, 
   rho.RY,   sigma.v.RY,   sigma.u.RY,   rho.u.RY,  tol=1e-6,
   conditional.mean=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>NV</code></td>
<td>
<p>The number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The number of domains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TI</code></td>
<td>
<p>The number of time instances (constant for all domains).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.e</code></td>
<td>
<p>The covariance matrix for the variation due to sampling,
specified either as a single square matrix with <code>NV*TI</code> rows and 
columns, or as a list of <code>D</code> matrices, each with <code>NV*TI</code> rows 
and columns. The rows should vary over <code>TI</code> more quickly than over
<code>NV</code>. Sampling covariances between domains are assumed to be zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.dyn</code></td>
<td>
<p>The temporal correlation parameter in the dynamic model.
This parameter is not a true correlation, however, and it may exceed 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.v.dyn</code></td>
<td>
<p>A vector of length <code>NV</code> with the v (nu) component
of the variance under the dynamic model. This component measures the
variance of the random effect at the beginning of the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.u.dyn</code></td>
<td>
<p>A vector of length <code>NV</code> with the u component
of the variance under the dynamic model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.u.dyn</code></td>
<td>
<p>For <code>NV&gt;1</code>, the cross-sectional correlation(s) under
the model. The vector should specify <code>(NV*(NV-1))/2</code> correlations, in 
lower triangular form. For example, for <code>NV=3</code>, the 
correlations should be specified in the order (2,1), (3,1), (3,2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.RY</code></td>
<td>
<p>The temporal correlation parameter in the Rao-Yu model. This
is a true correlation, unlike the parameter in the dynamic model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.v.RY</code></td>
<td>
<p>A vector of length <code>NV</code> with the v (nu) component
of the variance under the Rao-Yu model. This component reflects a constant
random effect for each domain unchanging over time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.u.RY</code></td>
<td>
<p>A vector of length <code>NV</code> with the u component
of the variance under the Rao-Yu model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.u.RY</code></td>
<td>
<p>For <code>NV&gt;1</code>, the cross-sectional correlation under
the model. The vector should specify <code>(NV*(NV-1))/2</code> correlations, in 
lower triangular form. For example, for <code>NV=3</code>, the 
correlations should be specified in the order (2,1), (3,1), (3,2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A tolerance parameter used by <code>mvrnorm</code> in <span class="pkg">MASS</span> to
determine if the covariance matrix is non-singular.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditional.mean</code></td>
<td>
<p>If true, the function will also return the 
generated values of the random effects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function assembles the covariance matrix from the covariance matrix 
under the dynamic model (if specified), the Rao-Yu model (if specified)
and a required sampling covariance matrix.
</p>


<h3>Value</h3>

<p>If <code>conditional.mean=FALSE</code>, then for <code>NV=1</code>, a multivariate 
normal random vector with mean zero and length <code>D*TI</code>. 
For <code>NV&gt;1</code>, a matrix with <code>D*TI</code> rows and <code>NV</code> 
columns.
</p>
<p>If <code>conditional.mean=TRUE</code>, a list with the first element as above 
and a second element that is the sum of the random effects without
the sampling error. Simulation studies can evaluate the small area
estimates using the first element of the list as input against
the second element of the list, which is the target of the small area
estimation.            
</p>


<h3>Author(s)</h3>

<p>Robert E. Fay
</p>


<h3>See Also</h3>

<p><code>mvrnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(7)
mvrnormSeries(D=2, TI=5, sigma.e=diag(5), rho.dyn=.8,
    sigma.v.dyn=2, sigma.u.dyn=.72, conditional.mean=TRUE)
mvrnormSeries(NV=2, D=2, TI=5, sigma.e=diag(10), rho.dyn=.8,
    sigma.v.dyn=2, sigma.u.dyn=.72, rho.u.dyn=.8)
</code></pre>


</div>