<div class="container">

<table style="width: 100%;"><tr>
<td>svycollinear</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Condition indexes and variance decompositions in linear models fitted with complex survey data
</h2>

<h3>Description</h3>

<p>Compute condition indexes and variance decompositions for diagnosing collinearity in fixed effects, linear regression models fitted with data collected from one- and two-stage complex survey designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">svycollinear(mod, intcpt=TRUE, w, Vcov, sc=TRUE, svyglm.obj, rnd=3, fuzz=0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>

<p>Either (i) an <code class="reqn">n \times p</code> matrix of real-valued covariates used in fitting a linear regression; <code class="reqn">n</code> = number of observations, <code class="reqn">p</code> = number of covariates in model, excluding the intercept; the matrix <code>mod</code> should not contain columns for the strata and cluster identifiers (unless those variables are part of the model). No missing values are allowed. The matrix can be created with <code>model.matrix</code>; see the example below. The <code>model</code> list component of an <code>svyglm</code> object cannot be used as it does not have factor variables coded as zero-ones.
</p>
<p>Or, (ii) a model object produced by <code>svyglm</code> in the <code>survey</code> package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intcpt</code></td>
<td>

<p><code>TRUE</code> if the model contains an intercept; <code>FALSE</code> if not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p><code class="reqn">n</code>-vector of survey weights used in fitting the model. No missing values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vcov</code></td>
<td>

<p>Variance-covariance matrix of the estimated slopes in the regression model; component <code>cov.unscaled</code> in an <code>svyglm</code> object. This matrix can also be extracted with <code>vcov(m)</code> where <code>m</code> is an <code>svyglm</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>

<p><code>TRUE</code> if the columns of the weighted model matrix <code class="reqn">\tilde{\mathbf{X}}</code> (defined in Details) should be scaled for computing condition indexes; <code>FALSE</code> if not. If <code>TRUE</code>, each column of  <code class="reqn">\tilde{\mathbf{X}}</code> is divided by its Euclidean norm, <code class="reqn">\sqrt{\tilde{\mathbf{x}}^T \tilde{\mathbf{x}}}</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svyglm.obj</code></td>
<td>

<p>Is <code>mod</code> a <code>svyglm.obj</code> object? <code>TRUE</code> or <code>FALSE</code>. If <code>mod</code> is a matrix, set <code>svyglm.obj</code> to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>

<p>Round the output to <code>rnd</code> decimal places.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzz</code></td>
<td>

<p>Replace any variance decomposition proportions that are less than <code>fuzz</code> by '.' in the output.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>svycollinear</code> computes condition indexes and variance decomposition proportions to use for diagnosing collinearity in a linear model fitted from complex survey data as discussed in Liao and Valliant (2012). All measures are based on <code class="reqn">\widetilde{\mathbf{X}} = \mathbf{W}^{1/2}\mathbf{X}</code> where <code class="reqn">\mathbf{W}</code> is the diagonal matrix of survey weights and <b>X</b> is the <code class="reqn">n \times p</code> matrix of covariates. In a full-rank model with <em>p</em> covariates, there are <em>p</em> condition indexes, defined as the ratio of the maximum eigenvalue of <code class="reqn">\widetilde{\mathbf{X}}</code> to its minimum eigenvalue. Before computing condition indexes, as recommended by Belsley (1991), the columns are normalized by their individual Euclidean norms, <code class="reqn">\sqrt{\tilde{\mathbf{x}}^T\tilde{\mathbf{x}}}</code>, so that each column has unit length. The columns are not centered around their means because that can obscure near-dependencies between the intercept and other covariates (Belsley 1984).
</p>
<p>Variance decompositions are for the variance of each estimated regression coefficient and are based on a singular value decomposition of the variance formula. Proportions of the model variance, <code class="reqn">Var_M(\hat{\mathbf{\beta}}_k)</code>, associated with each column of <code class="reqn">\widetilde{\mathbf{X}}</code> are displayed in an output matrix described below.
</p>


<h3>Value</h3>

<p><code class="reqn">p \times (p+1)</code> data frame, <code class="reqn">\mathbf{\Pi}</code>. The first column gives the condition indexes of <code class="reqn">\widetilde{\mathbf{X}}</code>. Values of 10 or more are usually considered to potentially signal collinearity of two or more columns of <code class="reqn">\widetilde{\mathbf{X}}</code>. The remaining columns give the proportions (within columns) of variance of each estimated regression coefficient associated with a singular value decomposition into <em>p</em> terms. Columns <code class="reqn">2, \ldots, p+1</code> will each approximately sum to 1. Note that some ‘proportions’ can be negative due to the nature of the variance decomposition. If two proportions in a given row of <code class="reqn">\mathbf{\Pi}</code> are relatively large and its associated condition index in that row in the first column of <code class="reqn">\mathbf{\Pi}</code> is also large, then near dependencies between the covariates associated with those elements are influencing the regression coefficient estimates.
</p>


<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. and Welsch, R.E. (1980). <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. New York: Wiley-Interscience.
</p>
<p>Belsley, D.A. (1984). Demeaning conditioning diagnostics through centering. <em>The American Statistician</em>, 38(2), 73-77.
</p>
<p>Belsley, D.A. (1991). <em>Conditioning Diagnostics, Collinearity, and Weak Data in Regression</em>. New York: John Wiley &amp; Sons, Inc.
</p>
<p>Liao, D, and Valliant, R. (2012). Condition indexes and variance decompositions for diagnosing
collinearity in linear model analysis of survey data. <em>Survey Methodology</em>, 38, 189-202.
</p>
<p>Lumley, T. (2010). <em>Complex Surveys</em>. New York: John Wiley &amp; Sons.
</p>
<p>Lumley, T. (2023). survey: analysis of complex survey samples. R package version 4.2.
</p>


<h3>See Also</h3>

<p><code>svyvif</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(survey)
    # example from svyglm help page
data(api)
dstrat &lt;- svydesign(id=~1,strata=~stype, weights=~pw, data=apistrat, fpc=~fpc)
m1 &lt;- svyglm(api00~ell+meals+mobility, design=dstrat)
    # send model object from svyglm
CI.out &lt;- svycollinear(mod = m1, w=apistrat$pw, Vcov=vcov(m1), sc=TRUE, svyglm.obj=TRUE,
        rnd=3, fuzz= 0.3)

    # use model.matrix to create matrix of covariates in model
data(nhanes2007)
newPSU &lt;- paste(nhanes2007$SDMVSTRA, nhanes2007$SDMVPSU, sep=".")
nhanes.dsgn &lt;- svydesign(ids = ~newPSU,
                         strata = NULL,
                         weights = ~WTDRD1, data=nhanes2007)
m1 &lt;- svyglm(BMXWT ~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL +
    DR1TTFAT + DR1TMFAT + DR1TSFAT + DR1TPFAT, design=nhanes.dsgn)
X &lt;- model.matrix(~ RIDAGEYR + as.factor(RIDRETH1) + DR1TKCAL + DR1TTFAT + DR1TMFAT
            + DR1TSFAT + DR1TPFAT,
        data = data.frame(nhanes2007))
CI.out &lt;- svycollinear(mod = X, w=nhanes2007$WTDRD1, Vcov=vcov(m1), sc=TRUE, svyglm.obj=FALSE,
        rnd=2, fuzz=0.3)
</code></pre>


</div>