<div class="container">

<table style="width: 100%;"><tr>
<td>shapley_interaction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decomposition of squared Mahalanobis distance using Shapley interaction indices.</h2>

<h3>Description</h3>

<p>The <code>shapley_interaction</code> function computes a <code class="reqn">p \times p</code> matrix
containing pairwise outlyingness scores based on Shapley interaction indices.
It decomposes the squared Mahalanobis distance of <code>x</code> (with respect to <code>mu</code> and <code>Sigma</code>)
into outlyingness contributions of pairs of variables (Mayrhofer and Filzmoser 2022).
</p>


<h3>Usage</h3>

<pre><code class="language-R">shapley_interaction(x, mu, Sigma, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data vector with <code class="reqn">p</code> entries containing only numeric entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Either <code>NULL</code> (default) or mean vector of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Either <code>NULL</code> (default) or covariance matrix <code class="reqn">p \times p</code> of <code>x</code>. If NULL, <code>method</code> is used for parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, <code>Sigma</code> is supposed to contain the inverse of the covariance matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code class="reqn">p \times p</code> matrix containing the decomposition of the squared Mahalanobis distance of <code>x</code>
into outlyingness scores for pairs of variables with respect to <code>mu</code> and <code>Sigma</code>.
</p>


<h3>References</h3>

<p>Mayrhofer M, Filzmoser P (2022).
“Multivariate outlier explanations using Shapley values and Mahalanobis distances.”
<a href="https://doi.org/10.48550/ARXIV.2210.10063">doi:10.48550/ARXIV.2210.10063</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- 5
mu &lt;- rep(0,p)
Sigma &lt;- matrix(0.9, p, p); diag(Sigma) = 1
Sigma_inv &lt;- solve(Sigma)
x &lt;- c(0,1,2,2.3,2.5)
shapley_interaction(x, mu, Sigma)
PHI &lt;- shapley_interaction(x, mu, Sigma_inv, inverted = TRUE)
plot(PHI)
</code></pre>


</div>