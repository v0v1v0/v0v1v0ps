<div class="container">

<table style="width: 100%;"><tr>
<td>make.spcosa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct Spatial Coverage Design</h2>

<h3>Description</h3>

<p>A spatial coverage design places one cluster of detectors in each compact subregion of a region of interest. Equal subregions are determined by <em>k</em>-means clustering of pixels (Walvoort et al. 2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">
make.spcosa(n, cluster, region, rotation = 0, randomize = FALSE, maxtries = 100, 
    keep.mask = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer number of subregions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>traps object defining a cluster of detectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>boundary of region of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>numeric angular rotation of each cluster (negative for random)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomize</code></td>
<td>
<p>logical; if TRUE then cluster is located at random within subregion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtries</code></td>
<td>
<p>integer maximum attempts to find random location</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.mask</code></td>
<td>
<p>logical; if TRUE then a habitat mask with covariate ‘stratum’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>make.mask</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The region may be specified in any form acceptable as the ‘poly’ argument of <code>make.mask</code> (see also boundarytoSF).
</p>
<p>The ... argument determines the coarseness of the discretization used to define the subregions, via the ‘nx’ or ‘spacing’ arguments of <code>make.mask</code>. 
</p>
<p>By default  (randomize = FALSE) clusters are centred at subregion centroids. Otherwise (randomize = TRUE) clusters are centred in a randomly selected cell of each subregion, subject to the constraint that all detectors fall within the subregion. An error results if no cluster meeting the constraint is found in ‘maxtries’ attempts.
</p>
<p>Slightly different partitions of ‘poly’ are generated depending on the value of the random seed, so for consistency this should be first set with <code>set.seed</code>.
</p>
<p>The argument ‘rotation’ is applied separately to each cluster, as in <code>trap.builder</code> and unlike the argument ‘rotate’ of <code>make.systematic</code>.
</p>


<h3>Value</h3>

<p>A traps object with n x nrow(cluster) detectors.
</p>


<h3>References</h3>

<p>Walvoort, D., Brus, D., and de Gruijter, J. (2010) An R package for spatial
coverage sampling and random sampling from compact geographical strata by k-means. 
<em>Computers &amp; Geosciences</em> 36:1261–1267.
</p>


<h3>See Also</h3>

<p><code>make.mask</code>,  
<code>trap.builder</code>,  
<code>boundarytoSF</code>,  
traps
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# preliminaries
polygonfile &lt;- system.file("extdata/possumarea.txt", package = "secr")
poly &lt;- read.table(polygonfile, header = TRUE)
subgrid &lt;- make.grid(3,3, spacing = 80)
set.seed(123)

# nx and keep.mask refer to the discretized region of interest
tr &lt;- make.spcosa(n = 5, subgrid, poly, nx = 32, randomize = TRUE, 
          keep.mask = TRUE)

plot(attr(tr,'mask'), dots = FALSE, cov = 'stratum', legend = FALSE)
plot(tr, add = TRUE)
lines(poly)


</code></pre>


</div>