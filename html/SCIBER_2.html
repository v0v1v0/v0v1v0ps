<div class="container">

<table style="width: 100%;"><tr>
<td>SCIBER</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Batch effect removal with SCIBER</h2>

<h3>Description</h3>

<p>Batch effect removal with SCIBER
</p>


<h3>Usage</h3>

<pre><code class="language-R">SCIBER(
  input_batches,
  ref_index = NULL,
  batches_meta_data = NULL,
  omega = 0.5,
  h_fisher = 75,
  n_core = parallel::detectCores(),
  seed = 7,
  k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input_batches</code></td>
<td>
<p>A list contains all the pre-processed matrices with dimension of n_genes*n_cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_index</code></td>
<td>
<p>The index of the reference batch in the object "input_batches"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batches_meta_data</code></td>
<td>
<p>A list contains the meta data for all the batches. The order should be consistent with that in "input_batches". Each meta data contains three columns, "cell_id", "cell_type", and "dataset". "dataset" indicates which batch the data comes from. The row names of meta data should match the column names of batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>A list of proportion of matched clusters or a single value between 0 and 1 applied to all query batches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_fisher</code></td>
<td>
<p>The number of marker genes used for Fisher exact test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_core</code></td>
<td>
<p>Specify the number of cores otherwise use all the available cores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of clusters used for K-means. If not provided, the default is k = the square root of n_0, where n_0 is the number of cells in the reference batch.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list which contains the reference and batch-effect-corrected batches. The order is the same as that in input_batches.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HumanDC)
exp &lt;- HumanDC[["exp"]]
meta &lt;- HumanDC[["metadata"]]
omega &lt;- c()
omega[[1]] &lt;- 0.5
res &lt;- SCIBER(input_batches = exp, ref_index = 1,
batches_meta_data = meta, omega = omega, n_core = 1)
</code></pre>


</div>