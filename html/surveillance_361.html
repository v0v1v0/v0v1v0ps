<div class="container">

<table style="width: 100%;"><tr>
<td>stK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diggle et al (1995) K-function test for space-time clustering
</h2>

<h3>Description</h3>

<p>The function <code>stKtest</code> wraps functions in package <span class="pkg">splancs</span> to
perform the K-function based Monte Carlo permutation test for space-time
clustering (Diggle et al, 1995) for <code>"epidataCS"</code>.
The implementation is due to Meyer et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stKtest(object, eps.s = NULL, eps.t = NULL, B = 199,
        cores = 1, seed = NULL, poly = object$W)

## S3 method for class 'stKtest'
plot(x, which = c("D", "R", "MC"),
     args.D = list(), args.D0 = args.D, args.R = list(), args.MC = list(),
     mfrow = sort(n2mfrow(length(which))), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"epidataCS"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.s, eps.t</code></td>
<td>

<p>numeric vectors defining the spatial and temporal
grids of critical distances over which to evaluate the test.
The default (<code>NULL</code>) uses equidistant values from 0 to the
smallest <code>eps.s</code>/<code>eps.t</code> value in <code>object$events</code>,
but not larger than half the observed spatial/temporal domain.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>

<p>the number of parallel processes over which to distribute the
requested number of permutations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>argument for <code>set.seed</code> to initialize the random number
generator such that results become reproducible
(also if <code>cores &gt; 1</code>, see <code>plapply</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly</code></td>
<td>

<p>the polygonal observation region of the events (as an object handled
by <code>xylist</code>). The default <code>object$W</code> might not work
since package <span class="pkg">splancs</span> does not support multi-polygons. In this
case, the <code>poly</code> argument can be used to specify a substitute.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>"stKtest"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>a character vector indicating which diagnostic plots to produce.
The full set is <code>c("D", "D0", "R", "MC")</code>.
The special value <code>which = "stdiagn"</code> means to call the
associated <span class="pkg">splancs</span> function <code>stdiagn</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.D,args.D0,args.R,args.MC</code></td>
<td>

<p>argument lists for the plot functions <code>persp</code> (for
<code>"D"</code> and <code>"D0"</code>), <code>plot.default</code>
(<code>"R"</code>), and <code>truehist</code> (<code>"MC"</code>),
respectively, to modify the default settings.
Ignored if <code>which = "stdiagn"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>

<p><code>par</code>-setting to layout the plots.
Ignored for <code>which = "stdiagn"</code> and if set to <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored (argument of the generic).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"stKtest"</code> (inheriting from <code>"htest"</code>),
which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string naming the supplied <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the sum <code class="reqn">U</code> of the standardized residuals <code class="reqn">R(s,t)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the number <code>B</code> of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>the coordinate matrix of the event locations (for
<code>stdiagn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stK</code></td>
<td>
<p>the estimated K-function as returned by
<code>stkhat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seD</code></td>
<td>
<p>the standard error of the estimated <code class="reqn">D(s,t)</code> as
returned by <code>stsecal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mctest</code></td>
<td>
<p>the observed and permutation values of the test
statistic as returned by <code>stmctest</code>.</p>
</td>
</tr>
</table>
<p>The <code>plot</code>-method invisibly returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>References</h3>

<p>Diggle, P. J.; Chetwynd, A. G.; Häggkvist, R. and Morris, S. E. (1995):
Second-order analysis of space-time clustering
<em>Statistical Methods in Medical Research</em>, <b>4</b>, 124-136.
</p>
<p>Meyer, S., Warnke, I., Rössler, W. and Held, L. (2016):
Model-based testing for space-time interaction using point processes:
An application to psychiatric hospital admissions in an urban area.
<em>Spatial and Spatio-temporal Epidemiology</em>, <b>17</b>, 15-25.
<a href="https://doi.org/10.1016/j.sste.2016.03.002">doi:10.1016/j.sste.2016.03.002</a>.
Eprint: <a href="https://arxiv.org/abs/1512.09052">https://arxiv.org/abs/1512.09052</a>.
</p>


<h3>See Also</h3>

<p>the simple <code>knox</code> test and function <code>epitest</code>
for testing <code>"twinstim"</code> models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("splancs")) {
    data("imdepi")
    imdepiB &lt;- subset(imdepi, type == "B")
    mainpoly &lt;- coordinates(imdepiB$W@polygons[[1]]@Polygons[[5]])
    SGRID &lt;- c(10, 25, 50, 100, 150)
    TGRID &lt;- c(1, 7, 14, 21)
    B &lt;- 19  # limited here for speed
     
    imdBstKtest &lt;- stKtest(imdepiB, eps.s = SGRID, eps.t = TGRID, B = B,
                           cores = 2, seed = 1, poly = list(mainpoly))
    print(imdBstKtest)
    plot(imdBstKtest)
}
</code></pre>


</div>