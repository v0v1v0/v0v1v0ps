<div class="container">

<table style="width: 100%;"><tr>
<td>suffstat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sufficient Statistic of Point Process Model</h2>

<h3>Description</h3>

<p>The canonical sufficient statistic of a 
point process model is evaluated for a given point pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  suffstat(model, X=data.ppm(model))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A fitted point process model (object of class
<code>"ppm"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A point pattern (object of class <code>"ppp"</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The canonical sufficient statistic
of <code>model</code> is evaluated for the point pattern <code>X</code>.
This computation is useful for various Monte Carlo methods.
</p>
<p>Here <code>model</code> should be a point process model (object of class
<code>"ppm"</code>, see <code>ppm.object</code>), typically obtained
from the model-fitting function <code>ppm</code>. The argument
<code>X</code> should be a point pattern (object of class <code>"ppp"</code>).
</p>
<p>Every point process model fitted by <code>ppm</code> has
a probability density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x) = Z(\theta) \exp(\theta^T S(x))</code>
</p>

<p>where <code class="reqn">x</code> denotes a typical realisation (i.e. a point pattern),
<code class="reqn">\theta</code> is the vector of model coefficients,
<code class="reqn">Z(\theta)</code> is a normalising constant,
and <code class="reqn">S(x)</code> is a function of the realisation <code class="reqn">x</code>, called the
“canonical sufficient statistic” of the model.
</p>
<p>For example, the stationary Poisson process has canonical sufficient
statistic <code class="reqn">S(x)=n(x)</code>, the number of points in <code class="reqn">x</code>.
The stationary Strauss process with interaction range <code class="reqn">r</code>
(and fitted with no edge correction) has canonical sufficient statistic
<code class="reqn">S(x)=(n(x),s(x))</code> where <code class="reqn">s(x)</code> is the number of pairs
of points in <code class="reqn">x</code> which are closer than a distance <code class="reqn">r</code>
to each other. 
</p>
<p><code>suffstat(model, X)</code> returns the value of <code class="reqn">S(x)</code>, where <code class="reqn">S</code> is
the canonical sufficient statistic associated with <code>model</code>,
evaluated when <code class="reqn">x</code> is the given point pattern <code>X</code>.
The result is a numeric vector, with entries which correspond to the
entries of the coefficient vector <code>coef(model)</code>.
</p>
<p>The sufficient statistic <code class="reqn">S</code>
does not depend on the fitted coefficients
of the model. However it does depend on the irregular parameters
which are fixed in the original call to <code>ppm</code>, for
example, the interaction range <code>r</code> of the Strauss process.
</p>
<p>The sufficient statistic also depends on the edge correction that
was used to fit the model. For example in a Strauss process,
</p>

<ul>
<li>
<p>If the model is fitted with <code>correction="none"</code>, the sufficient
statistic is <code class="reqn">S(x) = (n(x), s(x))</code> where <code class="reqn">n(x)</code> is the
number of points and <code class="reqn">s(x)</code> is the number of pairs of points
which are closer than <code class="reqn">r</code> units apart.
</p>
</li>
<li>
<p>If the model is fitted with <code>correction="periodic"</code>, the sufficient
statistic is the same as above, except that distances are measured
in the periodic sense. 
</p>
</li>
<li>
<p>If the model is fitted with
<code>correction="translate"</code>, then <code class="reqn">n(x)</code> is unchanged
but <code class="reqn">s(x)</code> is replaced by a weighted sum (the sum of the translation
correction weights for all pairs of points which are closer than
<code class="reqn">r</code> units apart).
</p>
</li>
<li>
<p>If the model is fitted with
<code>correction="border"</code> (the default), then points lying less than
<code class="reqn">r</code> units from the boundary of the observation window are
treated as fixed. Thus <code class="reqn">n(x)</code> is
replaced by the number <code class="reqn">n_r(x)</code>
of points lying at least <code class="reqn">r</code> units from
the boundary of the observation window, and <code class="reqn">s(x)</code> is replaced by
the number <code class="reqn">s_r(x)</code> of pairs of points, which are closer
than <code class="reqn">r</code> units apart, and at least one of which lies
more than <code class="reqn">r</code> units from the boundary of the observation window.
</p>
</li>
</ul>
<p>Non-finite values of the sufficient statistic (<code>NA</code> or
<code>-Inf</code>) may be returned if the point pattern <code>X</code> is
not a possible realisation of the model (i.e. if <code>X</code> has zero
probability of occurring under <code>model</code> for all values of
the canonical coefficients <code class="reqn">\theta</code>).
</p>


<h3>Value</h3>

<p>A numeric vector of sufficient statistics. The entries
correspond to the model coefficients <code>coef(model)</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code>ppm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    fitS &lt;- ppm(swedishpines~1, Strauss(7))
    suffstat(fitS)
    X &lt;- rpoispp(intensity(swedishpines), win=Window(swedishpines))
    suffstat(fitS, X)
</code></pre>


</div>