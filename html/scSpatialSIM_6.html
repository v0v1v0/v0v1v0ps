<div class="container">

<table style="width: 100%;"><tr>
<td>GenerateCellPositivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Cell Positivity</h2>

<h3>Description</h3>

<p>Generate the probability of a cell being positive given a set of simulation parameters for each file in a SpatSimObj.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GenerateCellPositivity(
  sim_object,
  k = NA,
  xmin = NA,
  xmax = NA,
  ymin = NA,
  ymax = NA,
  sdmin = 1/2,
  sdmax = 2,
  probs = c(0, 1),
  Force = FALSE,
  density_heatmap = FALSE,
  step_size = 1,
  cores = 1,
  shift = 0,
  random = FALSE,
  overwrite = FALSE,
  use_window = FALSE,
  no_kernel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim_object</code></td>
<td>
<p>A <code>SpatSimObj</code> object containing the simulated data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer specifying the number of clusters for each simulated patterns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>A numeric value specifying the minimum x value for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>A numeric value specifying the maximum x value for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>A numeric value specifying the minimum y value for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>A numeric value specifying the maximum y value for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdmin</code></td>
<td>
<p>A numeric value specifying the minimum standard deviation for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdmax</code></td>
<td>
<p>A numeric value specifying the maximum standard deviation for the kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Either a vector of c(low probability, high probability) for all cell types or data frame where each row
is the low and high probabilities for the cell type. If data frame, number of rows must equal number of cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Force</code></td>
<td>
<p>A logical value indicating whether to force simulation parameters to be within the simulation window limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_heatmap</code></td>
<td>
<p>A logical value indicating whether to compute a density heatmap for each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_size</code></td>
<td>
<p>A numeric value specifying the step size for the grid of points within the window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>An integer value specifying the number of cores to use for parallel computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>A value between 0 and 1 for how related a second or more cell type is to the first</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>whether or not to randomly generate kernels for cells 2 or more, uf TRUE, shift is not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>boolean whether to overwrite existing cell kernels and assignments if present</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_window</code></td>
<td>
<p>boolean whether to use the simulation window to set x and y limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_kernel</code></td>
<td>
<p>boolean whether to create kernels or to randomly assign points positive based on <code>probs</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function generates the probability of a cell being positive given a set of simulation parameters f
or each file in a <code>scSpatialSIM</code> object. It creates a kernel parameter list for <code>k</code> clusters
in each simulated pattern and computes the probability of each point in the grid of points within the
window for each cell. The function also computes a density heatmap for each cell if <code>density_heatmap</code> is set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>Returns the original <code>scSpatialSIM</code> object with additional generated data added to each cell object.
</p>


</div>