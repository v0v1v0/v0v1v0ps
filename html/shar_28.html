<div class="container">

<table style="width: 100%;"><tr>
<td>reconstruct_pattern_multi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>reconstruct_pattern_multi</h2>

<h3>Description</h3>

<p>Pattern reconstruction of a pattern marked by multiple traits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reconstruct_pattern_multi(
  marked_pattern,
  xr = marked_pattern$window$xrange,
  yr = marked_pattern$window$yrange,
  n_repetitions = 1,
  max_steps = 10000,
  no_change = 5,
  rcount = 250,
  rmax = 25,
  issue = 1000,
  divisor = "r",
  kernel_arg = "epanechnikov",
  timing = FALSE,
  energy_evaluation = FALSE,
  plot = FALSE,
  Lp = 1,
  bw = if (divisor %in% c("r", "d")) 0.5 else 5,
  sd = "step",
  steps_tol = 1000,
  tol = 1e-04,
  w_markcorr = c(d_d = 1, all = 1, d_all = 1, all_all = 1, d_d0 = 1, all0 = 1, d_all0 =
    1, all_all0 = 1),
  prob_of_actions = c(move_coordinate = 0.4, switch_coords = 0.1, exchange_mark_one =
    0.1, exchange_mark_two = 0.1, pick_mark_one = 0.2, pick_mark_two = 0.1),
  k = 1,
  w_statistics = c(),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marked_pattern</code></td>
<td>
<p>ppp  object with marked pattern. See Details section
for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xr, yr</code></td>
<td>
<p>Maximum extent in x and y direction of observation window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_repetitions</code></td>
<td>
<p>Integer representing the number of simulations to be
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_steps</code></td>
<td>
<p>Maximum number simulation steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_change</code></td>
<td>
<p>Integer representing the number of iterations
(per 1000 simulation steps) after which the reconstruction is terminated if the
energy does not decrease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcount</code></td>
<td>
<p>Integer representing the number of intervals for which the
summary statistics are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>
<p>Maximum distance [m] up to which the summary statistics are
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>issue</code></td>
<td>
<p>Integer that determines after how many simulations steps an
output occurs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divisor</code></td>
<td>
<p>Choice of divisor in the estimation formula: either "r" or "d".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_arg</code></td>
<td>
<p>The kernel used to calculate the energy, possible kernels
can be: Gaussian, Epanechnikov, Rectangular, Cumulative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timing</code></td>
<td>
<p>Logical value: The computation time is measured if this is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>energy_evaluation</code></td>
<td>
<p>Logical value: If this is TRUE, the procedure stores
the energy shares of the total energy per simulation step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical value: If this is TRUE, the procedure records the
point pattern during optimization and updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lp</code></td>
<td>
<p>Distance measure for the calculation of the energy function
(Lp distance, 1 &lt;= p &lt; Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth [m] with which the kernels are scaled, so that this is
the standard deviation of the smoothing kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>This is the standard deviation [m] used in the move_coordinate action.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps_tol</code></td>
<td>
<p>After the value steps_tol it is checked whether the energy
change is smaller than tol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Stops the procedure of energy if more than 1 - tol times no changes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_markcorr</code></td>
<td>
<p>Vector of possible weightings of individual mcf's. (Default: all equal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_of_actions</code></td>
<td>
<p>Vector of probabilities for the actions performed.
<code>c(move_coordinate = 0.4, switch_coords = 0.1, exchange_mark_one = 0.1,
exchange_mark_two = 0.1, pick_mark_one = 0.2, pick_mark_two = 0.1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Vector of values k; used only if Dk is included in w_statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_statistics</code></td>
<td>
<p>vector of named weights for optional spatial statistics
from the <code>spatstat</code> package to be included in the energy calculation. This may
include Dk, K, Hs, pcf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical if progress report is printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A novel approach carries out a pattern reconstruction of marked dot patterns
as described by Tscheschel and Stoyan (2006) and Wiegand and Moloney (2014).
</p>
<p>One particular feature is the simultaneous consideration of both marks,
accounting for their correlation during reconstruction.
</p>
<p>The marked point pattern (PPP object) must is currently structured as follows:
X-coordinate, Y-coordinate, metric mark (e.g. diameter at breast height),
and nominal mark (e.g. tree species).It is calculated in the unit metre [m].
</p>
<p>A combination of the mark correlation function and pair correlation function
is used for pattern description. Additional summary statistics may be
considered.Two randomly selected marks are chosen in each iteration, and one
of various actions is performed. Changes will only be retained if the
difference between the observed and reconstructed pattern decreases
(minimizing energy).
</p>
<p>This method is currently only suitable for homogeneous point patterns.
</p>
<p>A comprehensive description of the method can be found in Wudel et al. (2023).
</p>


<h3>Value</h3>

<p>rd_multi
</p>


<h3>References</h3>

<p>Kirkpatrick, S., Gelatt, C.D.Jr., Vecchi, M.P., 1983. Optimization by simulated
annealing. Science 220, 671–680. &lt;https://doi.org/10.1126/science.220.4598.671&gt;
</p>
<p>Tscheschel, A., Stoyan, D., 2006. Statistical reconstruction of random point
patterns. Computational Statistics and Data Analysis 51, 859–871.
&lt;https://doi.org/10.1016/j.csda.2005.09.007&gt;
</p>
<p>Wiegand, T., Moloney, K.A., 2014. Handbook of spatial point-pattern analysis in
ecology. Chapman and Hall/CRC Press, Boca Raton. ISBN 978-1-4200-8254-8
</p>
<p>Wudel, C., Schlicht, R., &amp; Berger, U. (2023). Multi-trait point pattern
reconstruction of plant ecosystems. Methods in Ecology and Evolution, 14, 2668–2679.
https://doi.org/10.1111/2041-210X.14206
</p>


<h3>See Also</h3>

<p><code>fit_point_process</code> <br><code>reconstruct_pattern</code> <br><code>reconstruct_pattern_marks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Random example data set
xr &lt;- 500
yr &lt;- 1000
N &lt;- 400
y &lt;- runif(N, min = 0, max = yr)
x &lt;- runif(N, min = 0, max = xr)

species &lt;- sample(c("A","B"), N, replace = TRUE)
diameter &lt;- runif(N, 0.1, 0.4)

random &lt;- data.frame(x = x, y = y, dbh = diameter, species = factor(species))

marked_pattern &lt;- spatstat.geom::as.ppp(random, W = spatstat.geom::owin(c(0, xr), c(0, yr)))

# Reconstruction function
reconstruction &lt;- reconstruct_pattern_multi(marked_pattern, n_repetitions = 2,
max_steps = 10000)

## End(Not run)

</code></pre>


</div>