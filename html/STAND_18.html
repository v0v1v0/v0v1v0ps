<div class="container">

<table style="width: 100%;"><tr>
<td>percentile.ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate ML Estimate of Xp and Confidence Limits </h2>

<h3>Description</h3>

<p>Calculate the ML estimate of Xp the 100p<em>th</em> percentile
of the lognormal distribution, and the lower and upper <code class="reqn">100*\gamma</code>% confidence limits
LX(<code>p</code>,<code class="reqn">\gamma</code>) and UX(<code>p</code>,<code class="reqn">\gamma</code>).  The upper confidence limit is used to
test the null hypothesis that the exposure profile is "unacceptable".
If UX(<code>p</code>,<code class="reqn">\gamma) &lt; L</code> the null hypothesis is rejected and workplace
is considered "safe" or the object/area is not contaminated.  The
Type I error is <code class="reqn">\le \alpha = 1 - \gamma</code>.  The resulting interval (LX,UX)
is an approximate <code class="reqn">100*(2\gamma - 1)</code> percent confidence interval for Xp.
</p>


<h3>Usage</h3>

<pre><code class="language-R">percentile.ml(dd, p = 0.95, gam = 0.95, dat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dd</code></td>
<td>
<p>An n by 2 matrix or data frame with <br>
x (exposure) variable in column 1, and <br>
det= 0 for non-detect or 1 for detect in column 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>is probability for Xp the 100p<em>th</em> percentile. Default is 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p> one-sided confidence level <code class="reqn">\gamma</code>. Default is 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p> if <code>dat</code> is <code>FALSE</code> then <code>dd</code> is a list from
<code>lnorm.ml</code>. Default is <code>TRUE</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The point estimate of <code class="reqn">Yp = log(Xp)</code> is <code class="reqn">\mu  + z \sigma</code> where <code class="reqn">\mu</code> and
<code class="reqn">\sigma</code> are ML estimates and <code class="reqn">z</code> is qnorm(p). The variance of the estimate is
</p>
<p style="text-align: center;"><code class="reqn">var(\mu  + z\sigma ) = var(\mu ) + Z^2p var (\sigma )+ 2z 
cov(\mu ,\sigma)</code>
</p>
 
<p>The <code class="reqn">100\gamma {\%}</code> LCL and UCL for Xp are
</p>
<p style="text-align: center;"><code class="reqn">LX(p,\gamma ) = exp[Yp- t(\gamma ,(m-1))var(Yp)^{1/2}],</code>
</p>

<p style="text-align: center;"><code class="reqn">UX(p,\gamma ) = exp[Yp + t(\gamma ,(m-1))var(Yp)^{1/2}].</code>
</p>

<p>The ML estimates of <code class="reqn">var(\mu)</code>, <code class="reqn">var(\sigma)</code>, and <code class="reqn">cov(\mu 
,\sigma)</code> are obtained from the ML variance-covariance matrix using 
<code>lnorm.ml</code>. The null hypothesis <code class="reqn">Ho: Xp \ge Lp</code> is rejected at the <code class="reqn">\alpha = (1-
\gamma )</code> significance level if the <code class="reqn">100\gamma\%</code> UCL for Xp &lt; Lp (indicating the exposure profile is acceptable).
</p>


<h3>Value</h3>

<p>A LIST with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Xp</code></td>
<td>
<p>ML estimate of the p<em>th</em> percentile of lognormal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xp.LCL</code></td>
<td>
 <p><code class="reqn">100*\gamma</code>% lower confidence limit for Xp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xp.UCL</code></td>
<td>
 <p><code class="reqn">100*\gamma</code>% upper confidence limit for Xp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>probability for Xp the 100p<em>th</em> percentile. Default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>one-sided confidence level <code class="reqn">\gamma</code>. Default is 0.95</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The UCL is also referred to as an upper tolerance limit(UTL),
i.e., if p = 0.95 and gam = 0.99 then Xp.UCL is the UTL-95%-99%.
</p>


<h3>Author(s)</h3>

<p>E. L. Frome </p>


<h3>References</h3>

<p>Cohen, A. C. (1991), <em>Truncated and Censored Samples</em>, Marcel Decker, New York
</p>
<p>Cox, D. R. and D. V. Hinkley (1979), <em>Theoretical Statistics</em>, Chapman and Hall, New York.
</p>
<p>Frome, E. L. and Wambach, P. F. (2005), "Statistical Methods and Software for 
the Analysis of Occupational Exposure Data with Non-Detectable Values," 
<em>ORNL/TM-2005/52,Oak Ridge National Laboratory</em>, Oak Ridge, TN 37830.
Available at: <a href="http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf">http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf</a>
</p>


<h3>See Also</h3>

<p> Help files for <code>lnorm.ml</code>,<code>efraction.ml</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(beTWA)
# calculate ML estimate of 95th percentile and CLs for Example 2 in ORNLTM2005-52 
unlist(percentile.ml(beTWA,0.95,0.95))

</code></pre>


</div>