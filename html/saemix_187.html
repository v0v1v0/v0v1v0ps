<div class="container">

<table style="width: 100%;"><tr>
<td>saemix.plot.select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots of the results obtained by SAEM</h2>

<h3>Description</h3>

<p>Several plots (selectable by the type argument) are currently available:
convergence plot, individual plots, predictions versus observations,
distribution plots, residual plots, VPC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">saemix.plot.select(
  saemixObject,
  data = FALSE,
  convergence = FALSE,
  likelihood = FALSE,
  individual.fit = FALSE,
  population.fit = FALSE,
  both.fit = FALSE,
  observations.vs.predictions = FALSE,
  residuals.scatter = FALSE,
  residuals.distribution = FALSE,
  random.effects = FALSE,
  correlations = FALSE,
  parameters.vs.covariates = FALSE,
  randeff.vs.covariates = FALSE,
  marginal.distribution = FALSE,
  vpc = FALSE,
  npde = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>saemixObject</code></td>
<td>
<p>an object returned by the <code>saemix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>if TRUE, produce a plot of the data. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>if TRUE, produce a convergence plot. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>if TRUE, produce a plot of the estimation of the LL by
importance sampling. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual.fit</code></td>
<td>
<p>if TRUE, produce individual fits with individual
estimates. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population.fit</code></td>
<td>
<p>if TRUE, produce individual fits with population
estimates. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>both.fit</code></td>
<td>
<p>if TRUE, produce individual fits with both individual and
population estimates. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observations.vs.predictions</code></td>
<td>
<p>if TRUE, produce a plot of observations
versus predictions. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.scatter</code></td>
<td>
<p>if TRUE, produce scatterplots of residuals versus
predictor and predictions. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.distribution</code></td>
<td>
<p>if TRUE, produce plots of the distribution of
residuals. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effects</code></td>
<td>
<p>if TRUE, produce boxplots of the random effects.
Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p>if TRUE, produce a matrix plot showing the correlation
between random effects. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters.vs.covariates</code></td>
<td>
<p>if TRUE, produce plots of the relationships
between parameters and covariates, using the Empirical Bayes Estimates of
individual parameters. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randeff.vs.covariates</code></td>
<td>
<p>if TRUE, produce plots of the relationships
between random effects and covariates, using the Empirical Bayes Estimates
of individual random effects. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal.distribution</code></td>
<td>
<p>if TRUE, produce plots of the marginal
distribution of the random effects. Defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpc</code></td>
<td>
<p>if TRUE, produce Visual Predictive Check plots. Defaults to FALSE (we suggest to use <code>npdeSaemix</code> instead)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npde</code></td>
<td>
<p>if TRUE, produce plots of the npde. Defaults to FALSE (deprecated in 3.0, please use <code>npdeSaemix</code> instead)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the plots</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots different graphs related to the algorithm (convergence
plots, likelihood estimation) as well as diagnostic graphs. A description is
provided in the PDF documentation.
</p>

<dl>
<dt>data</dt>
<dd>
<p>A spaghetti plot of the data, displaying the observed data y as a function of the regression
variable (eg time for a PK application)</p>
</dd>
<dt>convergence</dt>
<dd>
<p>For each parameter in the model, this plot shows the evolution of the parameter
estimate versus the iteration number</p>
</dd>
<dt>likelihood</dt>
<dd>
<p>Estimation of the likelihood estimated by importance sampling, as a function of the number of
MCMC samples</p>
</dd>
<dt>individual.fit</dt>
<dd>
<p>Individual fits, using the individual parameters with the individual covariates</p>
</dd>
<dt>population.fit</dt>
<dd>
<p>Individual fits, using the population parameters with the individual covariates</p>
</dd>
<dt>both.fit</dt>
<dd>
<p>Individual fits, using the population parameters with the individual covariates and the individual parameters with the individual covariates</p>
</dd>
<dt>observations.vs.predictions</dt>
<dd>
<p>Plot of the predictions computed with the population parameters versus the observations (left), and plot of the predictions computed with the individual parameters versus the observations (right)</p>
</dd>
<dt>residuals.scatter</dt>
<dd>
<p>Scatterplot of standardised residuals versus the X predictor and versus predictions. These plots are shown for individual and population residuals, as well as for npde when they are available</p>
</dd>
<dt>residuals.distribution</dt>
<dd>
<p>Distribution of standardised residuals, using histograms and QQ-plot. These plots are shown for
individual and population residuals, as well as for npde when they are available</p>
</dd>
<dt>random.effects</dt>
<dd>
<p>Boxplot of the random effects</p>
</dd>
<dt>correlations</dt>
<dd>
<p>Correlation between the random effects, with a smoothing spline</p>
</dd>
<dt>parameters.versus.covariates</dt>
<dd>
<p>Plots of the estimate of the individual parameters versus the covariates, using scatterplot for continuous covariates, boxplot for categorical covariates</p>
</dd>
<dt>randeff.versus.covariates</dt>
<dd>
<p>Plots of the estimate of the individual random effects versus the covariates, using scatterplot for continuous covariates, boxplot for categorical covariates</p>
</dd>
<dt>marginal.distribution</dt>
<dd>
<p>Distribution of each parameter in the model (conditional on covariates when some are included in the model)</p>
</dd>
<dt>npde</dt>
<dd>
<p>Plot of npde as in package npde (deprecated in 3.0, please use <code>npdeSaemix</code> instead)</p>
</dd>
<dt>vpc</dt>
<dd>
<p>Visual Predictive Check (we suggest to use <code>npdeSaemix</code> instead)</p>
</dd>
</dl>
<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixObject</code>,<code>saemix</code>,
<code>default.saemix.plots</code>, <code>saemix.plot.setoptions</code>,
<code>saemix.plot.data</code>, <code>saemix.plot.convergence</code>,
<code>saemix.plot.llis</code>, <code>saemix.plot.randeff</code>,
<code>saemix.plot.obsvspred</code>, <code>saemix.plot.fits</code>,
<code>saemix.plot.parcov</code>, <code>saemix.plot.randeffcov</code>,
<code>saemix.plot.distpsi</code>, <code>npdeSaemix</code>
<code>saemix.plot.scatterresiduals</code>,
<code>saemix.plot.distribresiduals</code>, <code>saemix.plot.vpc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA, 
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

saemix.options&lt;-list(seed=632545,save=FALSE,save.graphs=FALSE)

# Not run (strict time constraints for CRAN)
# saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)

# saemix.plot.select(saemix.fit,data=TRUE,main="Spaghetti plot of data")

# Putting several graphs on the same plot
# par(mfrow=c(2,2))
# saemix.plot.select(saemix.fit,data=TRUE,vpc=TRUE,observations.vs.predictions=TRUE, new=FALSE)

</code></pre>


</div>