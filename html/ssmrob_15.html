<div class="container">

<table style="width: 100%;"><tr>
<td>heckitrob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Heckit Fit
</h2>

<h3>Description</h3>

<p>Fits the sample selection model using a robust two-stage estimator
</p>


<h3>Usage</h3>

<pre><code class="language-R">heckitrob(selection, outcome, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>formula, the outcome equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>heckitrob</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute robust two-stage estimates of the Heckman's selection model. The robust probit is fitted in the first stage. In the second stage the Mallows type M-estimator is used. 
The values of the tuning constants and the robustness weights can be modified in <code>heckitrob.control</code>.
</p>


<h3>Value</h3>

<p>Object of class "heckitrob".

</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>object of class <code>glmrob</code> that contains robust probit fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage2</code></td>
<td>
<p>object of class <code>rlm</code> that contains second stage robust fit. Note that the standard errors in this object are biased, since they are not corrected for the uncertainty in the first estimation step. Use <code>vcov</code> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance matrix of the second stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the standard error of the error term of the outcome equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IMR1</code></td>
<td>
<p>inverse Mills ratio for the case when y_1=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of estimation, currently only "robust two-stage" is implemented</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical. Did all the estimators converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>list containing the numbers of iterations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Cameron, C.A., Trivedi, P.K. (2009) Microeconometrics Using Stata. College Station, TX: Stata Press. 
</p>
<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a>
</p>


<h3>See Also</h3>

<p><code>glmrob</code>, <code>rlm</code>, <code>ssmrob</code>, <code>heckitrob.control</code>, <code>heckit5rob</code>, <code>etregrob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Zhelonkin, Genton, Ronchetti (2016): page 823
data(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
meps.fit &lt;- ssmrob(selectEq, outcomeEq, data = MEPS2001, control = heckitrob.control(tcc = 3.2))
summary(meps.fit)
</code></pre>


</div>