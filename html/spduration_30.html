<div class="container">

<table style="width: 100%;"><tr>
<td>spdur</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Split-population duration (cure) regression</h2>

<h3>Description</h3>

<p>This function estimates a split-population duration model and returns a 
object of class <code>spdur</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spdur(
  duration,
  atrisk,
  data = NULL,
  last = "end.spell",
  t.0 = "t.0",
  fail = "failure",
  distr = c("weibull", "loglog"),
  max.iter = 300,
  na.action,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>A formula of the form Y ~ X1 + X2 ..., where Y is duration 
until failure or censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atrisk</code></td>
<td>
<p>A formula of the form C ~ Z1 + Z2 ..., where C is a binary 
indicator of risk (1 - cure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables in formula and formula2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last</code></td>
<td>
<p>A string identifying the vector in <code>data</code> that indicates 
when a spell ends due to failure or right-censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.0</code></td>
<td>
<p>The starting point for time-varying covariate intervals, by 
default <code>duration-1</code> when using <code>add_duration</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>Name of the variable indicating that a spell ended in failure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>The type of distribution to use in the hazard rate. Valid 
options are “weibull” or “loglog”; defaults to “weibull”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Maximum number of iterations to use in the likelihood 
maximization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data 
contain NAs. The default is set by the <code>na.action</code> setting of options, 
and is <code>na.fail</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Suppress optimization output, <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments, see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>summary.spdur</code>, <code>predict.spdur</code> ,
and <code>plot.spdur</code> for post-estimation options.
</p>
<p>Optional arguments:
</p>

<dl>
<dt>base.inits</dt>
<dd>
<p>Initial values for the base duration model that is 
estimated to get initial values for the full split-population model. This
needs to be a vector with starting values for the constant, coefficients
in the duration equation, and an additional value for the shape parameter
of the density used, e.g. Weibull. By default they are 0 for all 
coefficients and 0 or 1 for the Weibull and LogLog shape parameters 
respectively.</p>
</dd>
</dl>
<h3>Value</h3>

<p>Returns an object of class <code>spdur</code>, with attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients </code></td>
<td>
<p>A named vector of coefficient point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv </code></td>
<td>
<p>Estimated covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se </code></td>
<td>
<p>Standard error estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zstat </code></td>
<td>
<p>Z-statistic values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>P-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mf.dur </code></td>
<td>
<p>Model frame for the duration equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mf.risk </code></td>
<td>
<p>Model frame for the risk equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y </code></td>
<td>
<p>Matrix of duration variables: risk, duration, end of spell, and
t.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action </code></td>
<td>
<p>What action was taken for missing values in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The original, unevaluated <code>spdur</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr </code></td>
<td>
<p>Distribution used for the hazard rate.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Prepare data
data(coups)
dur.coups &lt;- add_duration(coups, "succ.coup", unitID="gwcode", tID="year",
                           freq="year")

# Estimate model
model.coups &lt;- spdur(duration ~ polity2, atrisk ~ polity2, data=dur.coups)
model.coups &lt;- spdur(duration ~ polity2, atrisk ~ polity2, data=dur.coups,
                     distr="loglog")

</code></pre>


</div>