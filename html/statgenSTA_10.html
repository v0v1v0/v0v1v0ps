<div class="container">

<table style="width: 100%;"><tr>
<td>plot.STA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot function for class STA</h2>

<h3>Description</h3>

<p>This function draws either four base plots:
</p>

<ul>
<li>
<p>A histogram of the residuals
</p>
</li>
<li>
<p>A normal Q-Q plot
</p>
</li>
<li>
<p>A residuals vs fitted values plot
</p>
</li>
<li>
<p>An absolute residuals vs fitted values plot
</p>
</li>
</ul>
<p>or five or six spatial plots:
</p>

<ul>
<li>
<p>A spatial plot of the raw data
</p>
</li>
<li>
<p>A spatial plot of the fitted data
</p>
</li>
<li>
<p>A spatial plot of the residuals
</p>
</li>
<li>
<p>A spatial plot of the estimated spatial trend (SpATS only)
</p>
</li>
<li>
<p>A spatial plot of the BLUEs or BLUPs
</p>
</li>
<li>
<p>A histogram of the BLUEs or BLUPs
</p>
</li>
</ul>
<p>Spatial plots can only be made if the data contains both row and column
information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'STA'
plot(
  x,
  ...,
  trials = NULL,
  traits = NULL,
  what = NULL,
  plotType = c("base", "spatial"),
  spaTrend = c("raw", "percentage"),
  outCols = ifelse(plotType == "base", 2, 3),
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class STA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>A character vector indicating the trials to plot. If
<code>trials = NULL</code>, all trials are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>A character vector indicating the traits to plot. If
<code>traits = NULL</code>, all traits are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A character string indicating whether the fitted model with
genotype as fixed (<code>what = "fixed"</code>) or genotype as random
(<code>what = "random"</code>) factor should be plotted.
If <code>x</code> contains only one model this model is chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>A character string indicating whether <code>base</code> plots or
<code>spatial</code> plots should be made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spaTrend</code></td>
<td>
<p>A character string indicating how the spatial trend should
be displayed. Either "raw" (original scale), or "percentage". If
"percentage", the estimated spatial trend is scaled (i.e., divided by the
average of the observed response variable of interest across the field) and
results are shown as a percentage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outCols</code></td>
<td>
<p>An integer indicating the number of columns to use for
displaying the plots. Usually the default of 2 for base plots and 3 for
spatial plots will be fine, but decreasing the numbers may help for nicer
printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A character string used a title for the plot. Note that when
a title is specified and multiple plots are created, all plots will get the
same title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing ggplot objects for the selected plots.
</p>


<h3>See Also</h3>

<p>Other functions for STA objects: 
<code>STAtoCross()</code>,
<code>STAtoTD()</code>,
<code>report.STA()</code>,
<code>summary.STA()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Run a single trait analysis using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield")

## Create base plots.
plot(modSp,
     what = "fixed",
     plotType = "base")

## Create spatial plots.
plot(modSp,
     what = "fixed",
     plotType = "spatial")

## Create spatial plots showing the spatial trend as percentage.
plot(modSp,
     what = "fixed",
     plotType = "spatial",
     spaTrend = "percentage")

</code></pre>


</div>