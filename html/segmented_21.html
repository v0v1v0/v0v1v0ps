<div class="container">

<table style="width: 100%;"><tr>
<td>plot.segmented</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot method for segmented objects  </h2>

<h3>Description</h3>

<p>Takes a fitted <code>segmented</code> object returned by <code>segmented()</code> and plots (or adds)
the fitted broken-line relationship for the selected segmented term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'segmented'
plot(x, term, add=FALSE, res=FALSE, conf.level=0, interc=TRUE, link=TRUE, 
    res.col=grey(.15, alpha = .4), rev.sgn=FALSE, const=NULL, shade=FALSE, rug=!add, 
    dens.rug=FALSE, dens.col = grey(0.8), transf=I, isV=FALSE, is=FALSE, var.diff=FALSE, 
    p.df="p", .vcov=NULL, .coef=NULL, prev.trend=FALSE, smoos=NULL, hide.zeros=FALSE, 
    leg="topleft", psi.lines=FALSE, ...)
      </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a fitted <code>segmented</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>Numerical or character to indicate the segmented variable having the piece-wise relationship to be plotted. If there is a single segmented variable in the fitted model <code>x</code>, <code>term</code> can be omitted.
If vector, multiple segmented lines will be drawn on the same plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p> when <code>TRUE</code> the fitted lines are added to the current device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p> when <code>TRUE</code> the fitted lines are plotted along with corresponding partial residuals.
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> If greater than zero, it means the confidence level at which the pointwise confidence itervals have to 
be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interc</code></td>
<td>
<p> If <code>TRUE</code> the computed segmented components include the model intercept (if it exists).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p> when <code>TRUE</code> (default), the fitted lines are plotted on the link scale, otherwise they are
tranformed on the response scale before plotting. Ignored for linear segmented fits. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.col</code></td>
<td>
<p>when <code>res=TRUE</code> it means the color of the points representing the partial residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev.sgn</code></td>
<td>
<p> when <code>TRUE</code> it is assumed that current <code>term</code> is ‘minus’ the actual segmented variable,
therefore the sign is reversed before plotting. This is useful when a null-constraint has been set on the last slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p> constant to add to each fitted segmented relationship (on the scale of the linear predictor) before plotting.
If <code>const=NULL</code> and the fit includes a segmented interaction term (obtained via <code>seg(..,by)</code> in the formula), the group-specific intercept is included. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>if <code>TRUE</code> and <code>conf.level&gt;0</code> it produces shaded regions (in grey color) for the pointwise confidence 
intervals embracing the fitted segmented line. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>when <code>TRUE</code> the covariate values are displayed as a rug plot
at the foot of the plot. Default is to <code>!add</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dens.rug</code></td>
<td>
<p>when <code>TRUE</code> then smooth covariate distribution is plotted on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dens.col</code></td>
<td>
<p>if <code>dens.rug=TRUE</code>, it means the colour to be used to plot the density.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>transf</code></td>
<td>
<p> A possible function to convert the fitted values before plotting. It is only effective 
if <code>res=FALSE</code>. If <code>res=TRUE</code> any transformation is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isV</code></td>
<td>
<p>logical value (to be passed to <code>broken.line</code>). Ignored if <code>conf.level=0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is</code></td>
<td>
<p>logical value (to be passed to <code>broken.line</code>) indicating if the covariance matrix based on the induced smoothing should be used. Ignored if <code>conf.level=0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.diff</code></td>
<td>
<p>logical value to be passed to <code>summary.segmented</code> to compute dthe standard errors of fitted values (if <code>conf.level&gt;0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.df</code></td>
<td>
<p> degrees of freedom when <code>var.diff=TRUE</code>, see <code>summary.segmented</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.vcov</code></td>
<td>
<p> The <em>full</em> covariance matrix of estimates to be used when <code>conf.level&gt;0</code>. If unspecified (i.e. <code>NULL</code>), the covariance matrix is computed internally by the function <code>vcov.segmented</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.coef</code></td>
<td>
<p> The regression parameter estimates. If unspecified (i.e. <code>NULL</code>), it is computed internally by <code>coef()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev.trend</code></td>
<td>
<p>logical. If <code>TRUE</code> dashed lines corresponding to the ‘previous’ trends (i.e. the trends if the breakpoints would not have occurred) are also drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoos</code></td>
<td>

<p>logical, indicating if the residuals (provided that <code>res=TRUE</code>) will be drawn using a <em>smoothed</em> scatterplot. If <code>NULL</code> (default) the smoothed scatterplot will be employed when the number of observation is larger than 10000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide.zeros</code></td>
<td>

<p>logical, indicating if the residuals (provided that <code>res=TRUE</code>) corresponding to the covariate zero values should be deleted. Useful when the fit includes an interaction term in the formula, such as <code>seg(.., by=..)</code>, and the zeros in covariates indicate units in other groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>

<p>If the plot refers to segmented relationships in groups, i.e. <code>term</code> has been specified as a vector, a legend is placed at the specified <code>leg</code> position. Put <code>NA</code> not to draw the legend.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi.lines</code></td>
<td>

<p>if <code>TRUE</code> vertical lines corresponding to the estimated breakpoints are also drawn. Ignored if <code>term</code> is not a vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other graphics parameters to pass to plotting commands: ‘col’, ‘lwd’ and ‘lty’ (that
can be vectors and are recycled if necessary, see the example below) for the fitted piecewise lines; ‘ylab’, ‘xlab’, ‘main’, ‘sub’, ‘cex.axis’, ‘cex.lab’, ‘xlim’ and 
‘ylim’ when a new plot is produced (i.e. when <code>add=FALSE</code>); ‘pch’ and ‘cex’ for the partial residuals (when <code>res=TRUE</code>, <code>res.col</code> is for the color); <code>col.shade</code> for the shaded regions (provided that <code>shade=TRUE</code> and <code>conf.level&gt;0</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces (or adds to the current device) the fitted segmented relationship between the
response and the selected <code>term</code>. If the fitted model includes just a single ‘segmented’ variable,
<code>term</code> may be omitted. <br> 
The partial residuals are computed as ‘fitted + residuals’, where ‘fitted’ are the fitted values of the
segmented relationship relevant to the covariate specified in <code>term</code>. 
Notice that for GLMs the residuals are the response residuals if <code>link=FALSE</code> and
the working residuals if <code>link=TRUE</code>.<br></p>


<h3>Value</h3>

<p>None.
</p>


<h3>Note</h3>

<p> For models with offset, partial residuals on the response scale are not defined. Thus <code>plot.segmented</code> does not work 
when <code>link=FALSE</code>, <code>res=TRUE</code>, and the fitted model includes an offset.<br>
When <code>term</code> is a vector and multiple segmented relationships are being drawn on the same plot, <code>col</code> and <code>res.col</code> can be vectors. Also <code>pch</code>, <code>cex</code>, <code>lty</code>, and <code>lwd</code> can be vectors, if specified.
</p>


<h3>Author(s)</h3>

<p> Vito M. R. Muggeo </p>


<h3>See Also</h3>

 <p><code>segmented</code> to fit the model, <code>lines.segmented</code> to add the estimated breakpoints on the current plot. 
<code>points.segmented</code> to add the joinpoints of the segmented relationship.
<code>predict.segmented</code> to compute standard errors and confidence intervals for predictions from a 
"segmented" fit. </p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
z&lt;-runif(100)
y&lt;-rpois(100,exp(2+1.8*pmax(z-.6,0)))
o&lt;-glm(y~z,family=poisson)
o.seg&lt;-segmented(o) #single segmented covariate and one breakpoint: 'seg.Z' and 'psi' can be omitted
par(mfrow=c(1,2))
plot(o.seg, conf.level=0.95, shade=TRUE)
points(o.seg, link=TRUE, col=2)
## new plot
plot(z,y)
## add the fitted lines using different colors and styles..
plot(o.seg,add=TRUE,link=FALSE,lwd=2,col=2:3, lty=c(1,3))
lines(o.seg,col=2,pch=19,bottom=FALSE,lwd=2) #for the CI for the breakpoint
points(o.seg,col=4, link=FALSE)
## using the options 'is', 'isV', 'shade' and 'col.shade'.
par(mfrow=c(1,2))
plot(o.seg, conf.level=.9, is=TRUE, isV=TRUE, col=1, shade = TRUE, col.shade=2)
plot(o.seg, conf.level=.9, is=TRUE, isV=FALSE, col=2, shade = TRUE, res=TRUE, res.col=4, pch=3)
</code></pre>


</div>