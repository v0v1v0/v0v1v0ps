<div class="container">

<table style="width: 100%;"><tr>
<td>pemt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-directional Transiograms Estimation</h2>

<h3>Description</h3>

<p>The function computes the multi-directional transiograms without any ellipsoidal interpolation for <code class="reqn">2</code>-D sections.</p>


<h3>Usage</h3>

<pre><code class="language-R">pemt(data, coords, mpoints, which.dire, max.dist,
     tolerance = pi/8, rotation = NULL, mle = "avg")
</code></pre>


<h3>Arguments</h3>









<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpoints</code></td>
<td>
<p>the number of points per axes. It controls the accuracy of images to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.dire</code></td>
<td>
<p>a vector with two chosen axial directions. If omitted, all <code class="reqn">2</code>-D sections are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>a scalar or a vector of maximum length for the chosen axial directions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value for the tolerance angle (in radians). It's <code>pi/8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>a numerical vector of length <code class="reqn">d - 1</code> with rotation angles (in radians), in order to perform the main axes rotation when multidimensional transiogram is estimated. No rotation is performed by default. See <code>multi_tpfit_ml</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>a character value to pass to the function <code>tpfit_ml</code>. It is <code>"avg"</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A multidimensional transiogram is a diagram which shows the transition probabilities for a single pair of categories. The probability is computed for any lag vector <code class="reqn">h</code> through 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{expm} (\Vert h \Vert R_h),</code>
</p>

<p>where entries of <code class="reqn">R_h</code> are not ellipsoidally interpolated, but they are estimated for the direction specified by the vector <code class="reqn">h</code>.
</p>
<p>In particular cases, some entries of the estimated matrix <code class="reqn">R_h</code> might be not finite, so that the exponential matrix is computable and the resulting transition probabilities are set to be <code>NaN</code>. If <code>mle = "mlk"</code>, this problem may be partially solved.
</p>
<p>The exponential matrix is evaluated by the scaling and squaring algorithm.
</p>


<h3>Value</h3>

<p>An object of class <code>pemt</code> is returned.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Higham, N. J. (2008) <em>Functions of Matrices: Theory and Computation</em>. Society for Industrial and Applied Mathematics.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>multi_tpfit_ml</code>, <code>tpfit_ml</code>, <code>image.pemt</code>, <code>plot.transiogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Compute a 2-D section of a
# multi-directional transiogram
pemt(ACM$MAT3, ACM[, 1:3], 2,
     max.dist = c(200, 200, 20), 
     which.dire=c(1, 3), mle = "mdn")
</code></pre>


</div>