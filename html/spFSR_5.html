<div class="container">

<table style="width: 100%;"><tr>
<td>spFeatureSelection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SPSA-FSR for Feature Selection and Ranking</h2>

<h3>Description</h3>

<p>This function searches for the best performing features and rank the feature importance by implementing simultaneous perturbation stochastic approximation (SPSA) algorithm given a task and a wrapper. The task and wrapper are defined using the <span class="pkg">mlr3</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spFeatureSelection(task, wrapper = NULL, scoring = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>task</code></td>
<td>
<p>A <code>task</code> object created using <span class="pkg">mlr3</span> package. It must be either a <code>ClassifTask</code> or <code>RegrTask</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrapper</code></td>
<td>
<p>A <code>Learner</code> object created using <span class="pkg">mlr3</span> package. Multiple learners object is not supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoring</code></td>
<td>
<p>A performance measure within the <span class="pkg">mlr3</span> package supported by the <code>task</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. For more details, see spFSR.default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>spFSR</code> returns an object of class "spFSR". An object of class "spFSR" consists of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>task.spfs</code></td>
<td>
<p>An <span class="pkg">mlr3</span> package <code>tsk</code> object defined on the best performing features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrapper</code></td>
<td>
<p>An <span class="pkg">mlr3</span> package <code>lrn</code> object, default is random forest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoring</code></td>
<td>
<p>An <span class="pkg">mlr3</span> package <code>msr</code> object as specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param best.model</code></td>
<td>
<p>An <span class="pkg">mlr3</span> package <code>model</code> object trained by the <code>wrapper</code> using <code>task.spfs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.results</code></td>
<td>
<p>A <code>data.frame</code> object containing detailed information on each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Names of the best performing features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.features</code></td>
<td>
<p>The number of best performing features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>importance</code></td>
<td>
<p>A vector of importance ranks of the best performing features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.iters</code></td>
<td>
<p>The total number of iterations executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.iter</code></td>
<td>
<p>The iteration where the best performing feature subset was encountered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.value</code></td>
<td>
<p>The best measure value encountered during execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.std</code></td>
<td>
<p>The standard deviation corresponding to the best measure value encountered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run.time</code></td>
<td>
<p>Total run time in minutes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Dataframe with boolean of selected features, names and measure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Call</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>David V. Akman et al. (2022) k-best feature selection and ranking via stochastic approximation,  <em>Expert Systems with Applications</em>, <b>Vol. 213</b>. See <a href="https://doi.org/10.1016/j.eswa.2022.118864">doi:10.1016/j.eswa.2022.118864</a>
</p>
<p>G.F.A Yeo and V. Aksakalli (2021) A stochastic approximation approach to simultaneous feature weighting and selection for nearest neighbour learners,  <em>Expert Systems with Applications</em>, <b>Vol. 185</b>. See <a href="https://doi.org/10.1016/j.eswa.2021.115671">doi:10.1016/j.eswa.2021.115671</a>
</p>


<h3>See Also</h3>

<p>tsk, lrn, msr and spFSR.default.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mlr3)          # load the mlr3 package
library(mlr3learners) # load the mlr3learners package

task    &lt;- tsk('iris') # define task
wrapper &lt;- lrn('classif.rpart')                # define wrapper
measure &lt;- msr('classif.acc')

# run spsa
spsaMod &lt;- spFeatureSelection( task = task,
                               wrapper = wrapper,
                               scoring = measure,
                               num.features.selected = 3,
                               n.jobs = 1,
                               iters.max = 2,
                               num.grad.avg = 1)


# obtain summary
summary(spsaMod)

# plot spsaMod
plot(spsaMod)                                # simplest plot
plot(spsaMod, errorBar = TRUE)               # plot with error bars
plot(spsaMod, errorBar = TRUE, se = TRUE)    # plot with error bars based on se
plot(spsaMod, errorBar = TRUE, annotateBest = TRUE)  # annotate best value
plot(spsaMod, errorBar = TRUE, ylab = 'Acc measure', type = 'o')

# obtain the wrapped model with the best performing features
bestMod &lt;- getBestModel(spsaMod)

# predict using the best mod
pred &lt;- bestMod$predict( task = spsaMod$task.spfs )

# Obtain confusion matrix
pred$confusion

# Get the importance ranks of best performing features
getImportance(spsaMod)
plotImportance(spsaMod)


</code></pre>


</div>