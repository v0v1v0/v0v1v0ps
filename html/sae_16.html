<div class="container">

<table style="width: 100%;"><tr>
<td>mseFH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean squared error estimator of the EBLUP under a Fay-Herriot model.</h2>

<h3>Description</h3>

<p>Calculates the mean squared error estimator of the EBLUP under a Fay-Herriot model.
The EBLUP might have been obtained by either ML, REML or by FH 
fitting methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mseFH(formula, vardir, method = "REML", MAXITER = 100, PRECISION = 0.0001, B = 0, 
      data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): 
a symbolic description of the model to be fitted. The variables included in <code>formula</code>
must have a length equal to the number of domains <code>D</code>. Details of model 
specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>vector containing the <code>D</code> sampling variances of direct estimators for each domain. The values must be sorted as the 
variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method used to fit the Fay-Herriot model, which can be either <code>"ML"</code>, <code>"REML"</code> or <code>"FH"</code> methods.
Default is <code>"REML"</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm.
Default is 100 iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replicates to calculate the goodness-of-fit measures proposed by Marhuenda et al. (2014). Default value is <code>0</code> indicating that these measures are not calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>vardir</code>. By default the variables are taken from the environment from which <code>mseFH</code> is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A typical model has the form response ~ terms where response is the (numeric) response vector
and terms is a series of terms which specifies a linear predictor for response. A terms specification
of the form first + second indicates all the terms in first together with all the terms in second with duplicates removed.
</p>
<p>A formula has an implied intercept term. To remove this use either y ~ x - 1 or y ~ 0 + x. See <code>formula</code> for more details of allowed formulae
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>a list with the results of the estimation process: <code>eblup</code> and <code>fit</code>. For the description of these objects, see Value of  <code>eblupFH</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>a vector with the estimated mean squared errors of the EBLUPs for the small domains.</p>
</td>
</tr>
</table>
<p>In case that <code>formula</code> or <code>vardir</code> contain NA values a message is printed and no action is done.
</p>


<h3>References</h3>

<p>- Datta, G.S. and Lahiri, P. (2000). A unified measure of uncertainty of estimated
best linear unbiased predictors in small area estimation problems. Statistica Sinica 10, 613-627.
</p>
<p>- Datta, G.S., Rao, J.N.K. and Smith D.D. (2005). On measuring the variability of small area estimators under a basic area level model. Biometrika 92, 183-196.
</p>
<p>- Fay, R.E. and Herriot, R.A. (1979). Estimation of income from small places: An application of James-Stein procedures to census data. Journal of the American Statistical Association 74, 269-277.
</p>
<p>- Jiang, J. (1996). REML estimation: asymptotic behavior and related topics.
Annals of Statistics 24, 255-286.
</p>
<p>- Marhuenda, Y., Morales, D. and Pardo, M.C. (2014). Information criteria for Fay-Herriot model selection. Computational Statistics and Data Analysis 70, 268-280.
</p>
<p>- Prasad, N. and Rao, J. (1990). The estimation of the mean squared error of small-area estimators. Journal of the American Statistical Association 85, 163-171.
</p>


<h3>See Also</h3>

 <p><code>eblupFH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data set  
data(milk)   
attach(milk)

# Fit Fay-Herriot model using ML method with indicators 
# of 4 Major Areas as explanatory variables and compute
# estimated MSEs of EB estimators
resultML &lt;- mseFH(yi ~ as.factor(MajorArea), SD^2, method="ML")
resultML

# Fit Fay-Herriot model using REML method and compute 
# estimated MSEs of EB estimators
resultREML &lt;- mseFH(yi ~ as.factor(MajorArea), SD^2)
resultREML

# Fit Fay-Herriot model using FH method and compute 
# estimated MSEs of EB estimators
resultFH &lt;- mseFH(yi ~ as.factor(MajorArea), SD^2, method="FH")
resultFH

detach(milk)
</code></pre>


</div>