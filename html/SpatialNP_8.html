<div class="container">

<table style="width: 100%;"><tr>
<td>Shape matrices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shape matrices based on spatial ranks and signed ranks</h2>

<h3>Description</h3>

<p> Iterative algorithms to find shape matrices based on
spatial signs and ranks and the k-step versions of these.  </p>


<h3>Usage</h3>

<pre><code class="language-R"> 

spatial.shape(X, score = c("sign", "symmsign", "rank", "signrank"), 
fixed.loc = FALSE, location = NULL, init = NULL, steps = Inf, 
eps = 1e-06, maxiter = 100, na.action = na.fail)

signs.shape(X, fixed.loc = FALSE, location = NULL, init = NULL, 
steps = Inf, eps = 1e-6, maxiter = 100, na.action = na.fail) 

symmsign.shape(X, init = NULL, steps = Inf, eps = 1e-6, 
maxiter = 100, na.action = na.fail)

symmsign.shape.inc(X, m=10, init=NULL, steps=Inf, permute=TRUE, 
eps=1e-6, maxiter=100, na.action=na.fail)

rank.shape(X, init = NULL, steps = Inf, eps = 1e-06, 
maxiter = 100, na.action = na.fail)

signrank.shape(X, fixed.loc = FALSE, location = NULL, init = NULL, 
steps = Inf, eps = 1e-06, maxiter = 100, na.action = na.fail)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix or a data frame </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>a character string indicating which transformation of the observations should be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.loc</code></td>
<td>
<p>a logical, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>an optional vector giving the location of the data or the initial value for the location if it is estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional starting value for the iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>fixed number of iteration steps to take, if <code>Inf</code> iteration is repeated until convergence (or until <code>maxiter</code> steps)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a parameter in <code>symmsign.shape.inc</code> which defines how many pairwise differences are used, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permute</code></td>
<td>
<p>logical in <code>symmsign.shape.inc</code> which determines whether the rows of <code>X</code> are permuted randomly, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>tolerance for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iteration steps. Ignored if <code>steps</code> 
is finite</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain 'NA's.  Default is to fail.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sign.shape</code> is Tyler's shape matrix and <code>symmsign.shape</code> is Duembgen's shape matrix. Function
<code>symmsign.shape.inc</code> is for a computationally lighter estimator to approximate Duembgen's shape matrix. Only a subset of the pairwise differences are used 
in the computation in the incomplete case. The magnitude of the subset used is controlled by the argument <code>m</code> which is half of the number of how many 
differences each observation is part of. Differences of successive observations are used, and therefore random permutation of the rows of <code>X</code> is suggested 
and is the default choice in the function. For details see Miettinen et al., 2016.
<code>rank.shape</code> and <code>signrank.shape</code> are the so called inner standardization matrices of location etc. tests based on spatial signs and ranks. When data is standardized using these matrices the corresponding sign or rank scores will appear “uncorrelated”: the corresponding outer standardization matrices will be proportional to the identity matrix, see examples.
</p>
<p><code>spatial.shape</code> is a wrapper function for a unified access to all
four shape estimates (not including <code>symmsign.shape.inc</code>). The choice of estimate is done via <code>score</code>:
</p>

<ul>
<li> <p><code>"sign"</code> for <code>signs.shape</code> 
</p>
</li>
<li> <p><code>"symmsign"</code> for <code>symmsign.shape</code>
</p>
</li>
<li> <p><code>"rank"</code> for <code>rank.shape</code> 
</p>
</li>
<li> <p><code>"signrank"</code> for <code>signrank.shape</code>
</p>
</li>
</ul>
<p><code>signrank.shape</code> and <code>sign.shape</code> include options to compute the shape matrix either with respect to fixed location (<code>fixed.loc = TRUE</code>) or so that the location and the shape are estimated simultaneously (<code>fixed.loc = FALSE</code>).
</p>


<h3>Value</h3>

<p>The estimate matrix with the (final estimate of or given) location vector 
as attribute <code>"location"</code>.
</p>


<h3>Author(s)</h3>

<p>Seija Sirkia, <a href="mailto:seija.sirkia@iki.fi">seija.sirkia@iki.fi</a>, Jari Miettinen, <a href="mailto:jari.p.miettinen@aalto.fi">jari.p.miettinen@aalto.fi</a></p>


<h3>References</h3>

<p><cite>Oja, H., Randles R. (2004) Multivariate Nonparametric Tests. <em>Statistical Science</em> 19, 598-605.</cite>
</p>
<p><cite>Sirkia et al. (2009) Tests and estimates of shape based on spatial signs and ranks. <em>Journal of Nonparametric Statistics</em>, 21, 155-176.</cite>
</p>
<p><cite>Sirkia, S., Taskinen, S., Oja, H. (2007) Symmetrised M-estimators of scatter. <em>Journal of Multivariate Analysis</em>, 98, 1611-1629.</cite>
</p>
<p><cite>Miettinen, J., Nordhausen, K., Taskinen, S., Tyler, D.E. (2016) On the computation of symmetrized M-estimators of scatter. <em>In Agostinelli, C. Basu, A., Filzmoser, P. and Mukherje, D. (editors) ”Recent Advances in Robust Statistics: Theory and Application”</em>, 131-149, Springer India, New Delhi.</cite></p>


<h3>See Also</h3>

<p><code>tyler.shape</code>, <code>duembgen.shape</code>, also spatial sign and rank covariance matrices and spatial signs and ranks</p>


<h3>Examples</h3>

<pre><code class="language-R">A&lt;-matrix(c(1,2,-3,4,3,-2,-1,0,4),ncol=3)
X&lt;-matrix(rnorm(1500),ncol=3)%*%t(A)
symmsign.shape(X)
to.shape(symmsign.shape(X),trace=3)
spatial.shape(X,score="sign")
spatial.shape(X,score="sign",fixed.loc=TRUE)
to.shape(A%*%t(A))
# one-step shape estimate based on spatial ranks and covariance matrix:
spatial.shape(X,score="rank",init=cov(X),steps=1)
symmsign.shape.inc(X, m=5)
</code></pre>


</div>