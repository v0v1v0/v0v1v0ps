<div class="container">

<table style="width: 100%;"><tr>
<td>reconstruct_pattern_marks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>reconstruct_pattern_marks</h2>

<h3>Description</h3>

<p>Pattern reconstruction of marked pattern
</p>


<h3>Usage</h3>

<pre><code class="language-R">reconstruct_pattern_marks(
  pattern,
  marked_pattern,
  n_random = 1,
  e_threshold = 0.01,
  max_runs = 10000,
  no_change = Inf,
  annealing = 0.01,
  r_length = 250,
  r_max = NULL,
  return_input = TRUE,
  simplify = FALSE,
  verbose = TRUE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>ppp object with pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marked_pattern</code></td>
<td>
<p>ppp  object with marked pattern. See Details section for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_random</code></td>
<td>
<p>Integer with number of randomizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_threshold</code></td>
<td>
<p>Double with minimum energy to stop reconstruction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_runs</code></td>
<td>
<p>Integer with maximum number of iterations if <code>e_threshold</code>
is not reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_change</code></td>
<td>
<p>Integer with number of iterations at which the reconstruction will
stop if the energy does not decrease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annealing</code></td>
<td>
<p>Double with probability to keep relocated point even if energy
did not decrease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_length</code></td>
<td>
<p>Integer with number of intervals from <code>r = 0</code> to <code>r = rmax</code> for which
the summary functions are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_max</code></td>
<td>
<p>Double with maximum distance used during calculation of summary functions. If <code>NULL</code>,
will be estimated from data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_input</code></td>
<td>
<p>Logical if the original input data is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>Logical if only pattern will be returned if <code>n_random = 1</code>
and <code>return_input = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical if progress report is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical if pcf(r) function is plotted and updated during optimization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function randomizes the numeric marks of a point pattern using pattern reconstruction
as described in Tscheschel &amp; Stoyan (2006) and Wiegand &amp; Moloney (2014). Therefore,
an unmarked as well as a marked pattern must be provided. The unmarked pattern must have
the spatial characteristics and the same observation window and number of points
as the marked one (see <code>reconstruct_pattern_*</code> or <code>fit_point_process</code>).
Marks must be numeric because the mark-correlation function is used as summary function.
Two randomly chosen marks are switch each iterations and changes only kept if the
deviation between the observed and the reconstructed pattern decreases.
</p>
<p><code>spatstat</code> sets <code>r_length</code> to 513 by default. However, a lower value decreases
the computational time while increasing the "bumpiness" of the summary function.
</p>


<h3>Value</h3>

<p>rd_mar
</p>


<h3>References</h3>

<p>Kirkpatrick, S., Gelatt, C.D.Jr., Vecchi, M.P., 1983. Optimization by simulated
annealing. Science 220, 671–680. &lt;https://doi.org/10.1126/science.220.4598.671&gt;
</p>
<p>Tscheschel, A., Stoyan, D., 2006. Statistical reconstruction of random point
patterns. Computational Statistics and Data Analysis 51, 859–871.
&lt;https://doi.org/10.1016/j.csda.2005.09.007&gt;
</p>
<p>Wiegand, T., Moloney, K.A., 2014. Handbook of spatial point-pattern analysis in
ecology. Chapman and Hall/CRC Press, Boca Raton. ISBN 978-1-4200-8254-8
</p>


<h3>See Also</h3>

<p><code>fit_point_process</code> <br><code>reconstruct_pattern</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
pattern_recon &lt;- reconstruct_pattern(species_a, n_random = 1, max_runs = 1000,
simplify = TRUE, return_input = FALSE)
marks_sub &lt;- spatstat.geom::subset.ppp(species_a, select = dbh)
marks_recon &lt;- reconstruct_pattern_marks(pattern_recon, marks_sub,
n_random = 19, max_runs = 1000)

## End(Not run)

</code></pre>


</div>