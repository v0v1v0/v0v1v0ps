<div class="container">

<table style="width: 100%;"><tr>
<td>spreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GM estimation of a Cliff-Ord type model with Heteroskedastic Innovations</h2>

<h3>Description</h3>

<p>Multi step GM/IV estimation of a linear Cliff and Ord -type of model 
of the form:
</p>
<p style="text-align: center;"><code class="reqn">y=\lambda W y + X \beta + u  </code>
</p>

<p style="text-align: center;"><code class="reqn">u=\rho W u + e</code>
</p>
<p>  with </p>
<p style="text-align: center;"><code class="reqn">e ~ N(0,\sigma^2_i) </code>
</p>

<p>The model allows for spatial lag in the dependent variable
and disturbances. The innovations in the disturbance process are assumed 
heteroskedastic of an unknown form.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spreg(formula, data = list(), listw, listw2 = NULL, 
        endog = NULL, instruments = NULL, 
        lag.instr = FALSE, initial.value = 0.2, 
        model = c("sarar", "lag", "error", "ivhac", "ols"),
        het = FALSE, verbose = FALSE, 
        na.action = na.fail,  HAC = FALSE, 
        distance = NULL, type =  c("Epanechnikov","Triangular",
                                   "Bisquare", "Parzen", "QS", "TH","Rectangular"), 
        bandwidth = "variable" , step1.c = FALSE,
        control = list(), Durbin = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a description of the model to be fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class data.frame. An optional data frame containing the variables 
in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>an object of class <code>listw</code>, <code>matrix</code>, or <code>Matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw2</code></td>
<td>
<p>an object of class <code>listw</code>, <code>matrix</code>, or <code>Matrix</code> specified only when <code>sarar</code> is true</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endog</code></td>
<td>
<p>additional endogenous variables. Default <code>NULL</code>. If not <code>NULL</code> should be specified
as a formula with no dependent variable (endog = ~ x1 + x2). Note the ~ before the expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instruments</code></td>
<td>
<p>external instruments. Default <code>NULL</code>. If not <code>NULL</code> should be specified 
as a formula with no dependent variable (instruments = ~ x1 + x2). Note the ~ before the expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.instr</code></td>
<td>
<p>should the external instruments be spatially lagged?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.value</code></td>
<td>
<p>The initial value for <code class="reqn">\rho</code>. It can be either numeric (default is 0.2) or
set to <code>'SAR'</code>, in which case the optimization will start from the estimated coefficient of a regression of the 2SLS 
residuals over their spatial lag (i.e. a spatial AR model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>one of <code>lag</code>, <code>error</code>, <code>sarar</code>, <code>ivhac</code>, or <code>ols</code>. 
If HAC is TRUE, model should be one of <code>ivhac</code>, or <code>ols</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>het</code></td>
<td>
<p>default FALSE: if TRUE uses the methods developed for heteroskedasticity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print optimization details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contains missing values. See lm for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HAC</code></td>
<td>
<p>perform the HAC estimator of Kelejian and Prucha, 2007.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>an object of class <code>distance</code> created for example by read.gwt2dist
The object contains the specification of the distance measure 
to be employed in the estimation of the VC matrix. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of <code>c("Epanechnikov","Triangular","Bisquare","Parzen", "QS","TH","Rectangular")</code>.
The type of Kernel to be used. default = <code>"Epanechnikov"</code> See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>"variable" (default) - or numeric when a fixed bandwidth is specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step1.c</code></td>
<td>
<p>Should step 1.c from Arraiz et al. 2012 be performed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control arguments. See nlminb</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Durbin</code></td>
<td>
<p>Should (some of) the regressors be lagged? Default FALSE. If not <code>FALSE</code> should be specified 
as a formula with no dependent variable (Durbin = ~ x1 + x2) or set to <code>TRUE</code>. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure consists of two steps alternating GM and IV estimators. Each step consists of sub-steps.
In step one <code class="reqn">\delta = [\beta',\lambda]'</code> is estimated by 2SLS. The 2SLS residuals are first employed
to obtain an consistent GM estimator of <code class="reqn">\rho</code>.
</p>
<p>In step two, the spatial Cochrane-Orcutt transformed model is estimated by 2SLS. This corresponds to a GS2SLS procedure. 
The GS2SLS residuals are used to obtain a consistent and efficient GM estimator for <code class="reqn">\rho</code>. 
</p>
<p>The initial value for the optimization in step 1b is taken to be <code>initial.value</code>. 
The initial value for the optimization of step 2b is the optimal parameter of step 1b.
</p>
<p>Internally, the object of class <code>listw</code> is transformed into a Matrix 
using the function listw2dgCMatrix.
</p>
<p>For the HAC estimator (Kelejian and Prucha, 2007),  there are four possibilities:
</p>

<ul>
<li>
<p> A model with only Wy
</p>
</li>
<li>
<p> A model with Wy and additional endogenous 
</p>
</li>
<li>
<p> Only additional endogenous (with no Wy)
</p>
</li>
<li>
<p> No additional endogenous variables
</p>
</li>
</ul>
<p>Furthermore, the default sets the bandwith for each observation to the maximum distance for that observation (i.e.
the max of each element of the list of distances). 
</p>
<p>Six different kernel functions are implemented:
</p>

<ul>
<li> <p><code>'Epanechnikov'</code>: <code class="reqn">K(z) = 1-z^2</code>
</p>
</li>
<li> <p><code>'Triangular'</code>: <code class="reqn">K(z) = 1-z</code> 
</p>
</li>
<li> <p><code>'Bisquare'</code>: <code class="reqn">K(z) = (1-z^2)^2</code>
</p>
</li>
<li> <p><code>'Parzen'</code>: <code class="reqn">K(z) = 1-6z^2+6 |z|^3</code> if  <code class="reqn">z \leq 0.5</code> and  
<code class="reqn"> K(z) = 2(1-|z|)^3</code> if <code class="reqn">0.5 &lt; z \leq 1</code> 
</p>
</li>
<li> <p><code>'TH'</code> (Tukey - Hanning):  <code class="reqn"> K(z) = \frac{1+ \cos(\pi z)}{2}</code>
</p>
</li>
<li> <p><code>'Rectangular'</code>:  <code class="reqn"> K(z) = 1</code>
</p>
</li>
<li> <p><code>'QS'</code> (Quadratic Spectral): <code class="reqn">K(z) = \frac{25}{12\pi^2z^2} 
                                                  (\frac{\sin(6\pi z)/5)}{6\pi z/5} - \cos(6\pi z)/5)</code>). 
</p>
</li>
</ul>
<p>If the kernel type is not one of the six implemented, the function will terminate with an error message.
</p>


<h3>Value</h3>

<p>A list object of class <code>sphet</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Generalized Spatial two stage least squares coefficient estimates of <code class="reqn">\delta</code> and GM estimator for <code class="reqn">\rho</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>variance-covariance matrix of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>GS2SLS residuals variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>GS2SLS residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>difference between GS2SLS residuals and response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to create this object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model matrix of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>'gs2slshac'</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianfranco Piras <a href="mailto:gpiras@mac.com">gpiras@mac.com</a>
</p>


<h3>References</h3>

<p>Arraiz, I. and Drukker, M.D. and Kelejian, H.H. and Prucha, I.R. (2010) 
A spatial Cliff-Ord-type Model with Heteroskedastic Innovations: Small and Large Sample Results,
<em>Journal of Regional Sciences</em>, <b>50</b>, pages 592–614.
</p>
<p>Drukker, D.M. and Egger, P. and Prucha, I.R. (2013)
On Two-step Estimation of a Spatial Auto regressive Model with Autoregressive
Disturbances and Endogenous Regressors, 
<em>Econometric Review</em>, <b>32</b>, pages 686–733. 
</p>
<p>Kelejian, H.H. and Prucha, I.R. (2010) 
Specification and Estimation of Spatial Autoregressive Models with Autoregressive and Heteroskedastic Disturbances,
<em>Journal of Econometrics</em>, <b>157</b>, pages 53–67. 
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1999) 
A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model,
<em>International Economic Review</em>, <b>40</b>, pages 509–533.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1998) 
A Generalized Spatial Two Stage Least Square Procedure for Estimating a Spatial Autoregressive
Model with Autoregressive Disturbances,
<em>Journal of Real Estate Finance and Economics</em>, <b>17</b>, pages 99–121.
</p>
<p>Gianfranco Piras (2010). sphet: Spatial Models with Heteroskedastic Innovations in R. <em>Journal of Statistical Software</em>, 35(1), 1-21. doi: <a href="https://doi.org/10.18637/jss.v035.i01">10.18637/jss.v035.i01</a>.
</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. doi: <a href="https://doi.org/10.18637/jss.v063.i18">10.18637/jss.v063.i18</a>.
</p>


<h3>See Also</h3>

<p><code>stslshac</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(columbus, package="spdep")
listw &lt;- spdep::nb2listw(col.gal.nb)
res &lt;- spreg(CRIME ~ HOVAL + INC, data = columbus , listw = listw,
             het = TRUE, verbose = FALSE, model = "sarar")
summary(res)
Effects &lt;- impacts(res, listw = listw, R = 1000)
</code></pre>


</div>