<div class="container">

<table style="width: 100%;"><tr>
<td>stableSpec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stable specifications of constrained structural equation models.</h2>

<h3>Description</h3>

<p>Search stable specifications (structures) of constrained structural equation models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stableSpec(theData = NULL, nSubset = NULL, iteration = NULL,
  nPop = NULL, mutRate = NULL, crossRate = NULL, longitudinal = NULL,
  numTime = NULL, seed = NULL, co = NULL, consMatrix = NULL,
  threshold = NULL, toPlot = NULL, mixture = NULL, log = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theData</code></td>
<td>
<p>a data frame containing the data to which the model will be
be fit. If argument <code>longitudinal</code> is <code>TRUE</code>, the data frame
should be reshaped such that the first <code>n</code> data points contain the
relations that occur in the first two time slices <code>t_0</code> and <code>t_1</code>.
The next <code>n</code> data points contain the relations that occur in
time slices <code>t_1</code> and <code>t_2</code>. The <code>i-th</code> subset of <code>n</code>
data points contain the relations in time slices <code>t_i-1</code> and <code>t_i</code>.
One can use function <code>dataReshape</code> to reshape longitudinal data.
Uses the <code>foreach</code> package for parallel computation. You need to register
a parallel backend before calling <code>stableSpec</code> if you want to parallize
computation. For details see the <code>foreach</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSubset</code></td>
<td>
<p>number of subsets to draw. In practice, it is suggested
to have at least 25 subsets. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>number of iterations/generations for NSGA-II.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPop</code></td>
<td>
<p>population size (number of models) in a generation.
The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutRate</code></td>
<td>
<p>mutation rate. The default is 0.075.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossRate</code></td>
<td>
<p>crossover rate. The default is 0.85.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitudinal</code></td>
<td>
<p><code>TRUE</code> for longitudinal data,
and <code>FALSE</code> for cross-sectional data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numTime</code></td>
<td>
<p>number of time slices. If the data is cross-sectional,
this argument must be set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer vector representing seeds that are used to subsample data.
The default is an integer vector with range <code>100:1000</code> with length
equal to <code>nSubset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>whether to use <code>"covariance"</code> or <code>"correlation"</code> matrix.
The default is <code>"covariance"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consMatrix</code></td>
<td>
<p><code>m by 2</code> binary <code>matrix</code>
representing constraint/prior knowledge,
where <code>m</code> is the number of constraint. For example, known that
variables 2 and 3 do not cause variable 1, then
<code>constraint &lt;- matrix(c(2, 1, 3, 1), 2, 2, byrow=TRUE))</code> will be
the constraint matrix. If <code>NULL</code>, then it is assumed
that there is no constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>threshold of stability selection. The default is 0.6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toPlot</code></td>
<td>
<p>if <code>TRUE</code> a plot of inferred causal model is generated,
otherwise a graph object is returned. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>
<p>if the data contains both continuous and
categorical (or ordinal) variables, this argument can be set
to <code>TRUE</code>. This implies the use of
<code>polychoric</code> and <code>polyserial</code> correlation in the SEM computation.
Note that, the categorical variables should be represented as <code>factor</code>
or <code>logical</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>an optional logfile to monitor the progress of the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs exploratory search over
recursive (acyclic) SEM models.
Models are scored along two objectives: the model fit and
the model complexity. Since both objectives are often conflicting
we use NSGA-II to search for Pareto optimal models. To handle the
instability of small finite data samples, we repeatedly subsample
the data and select those substructures that are both stable and
parsimonious which are then used to infer a causal model.
</p>


<h3>Value</h3>

<p>a list of the following elements:
</p>

<ul>
<li> <p><code>listofFronts</code> is a <code>list</code> of optimal models for
the whole range of model complexity of all subsets.
</p>
</li>
<li> <p><code>causalStab</code> is a <code>list</code> of causal path stability
for the whole range of model complexity
</p>
</li>
<li> <p><code>causalStab_l1</code> is a <code>list</code> of
causal path stability of length 1
for the whole range of model complexity
</p>
</li>
<li> <p><code>edgeStab</code> is a <code>list</code> of edge stability
for the whole range of mdoel complexity
</p>
</li>
<li> <p><code>relCausalPath</code> is <code>n by n</code> <code>matrix</code> of
relevant causal path,
where <code>n</code> is the number of variables. Each positive element
<code>i,j</code> represents the stability of causal path
from <code>i</code> to <code>j</code>.
</p>
</li>
<li> <p><code>relCausalPath_l1</code> is <code>n by n</code> <code>matrix</code>
of relevant causal path with length 1, where <code>n</code> is
the number of variables. Each positive element <code>i,j</code>
represents the stability of causal path
from <code>i</code> to <code>j</code> with length 1.
</p>
</li>
<li> <p><code>relEdge</code> is <code>n by n</code> <code>matrix</code> of relevant edge,
where <code>n</code> is the number of variables. Each positive element
<code>i,j</code> represents the stability of edge
between <code>i</code> to <code>j</code>.
</p>
</li>
<li>
<p> If argument <code>toPlot = TRUE</code>, then a visualization of relevant
model structures is generated. Otherwise an object of graph is returned.
An arc represents a causal path, and an (undirected)
edge represents strong association where the direction is undecidable. The
graph is annotated with reliability scores, which are
the highest selection probability in the top-left region of the edge
stability graph.
</p>
</li>
<li> <p><code>allSeed</code> is an integer vector representing seeds that are used in
subsampling data. This can be used to replicate the result
in next computation.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ridho Rahmadi <a href="mailto:r.rahmadi@cs.ru.nl">r.rahmadi@cs.ru.nl</a>, Perry Groot, Tom Heskes.
Christoph Stich is the contributor for parallel support.
</p>


<h3>References</h3>

<p>Rahmadi, R., Groot, P., Heins, M., Knoop, H., and Heskes, T. (2016)
Causality on cross-sectional data: Stable specification search in
constrained structural equation modeling. <em>Applied Soft Computing</em>,
ISSN 1568-4946, http://www.sciencedirect.com/science/article/pii/S1568494616305130.
</p>
<p>Rahmadi, R., Groot, P., Heins, M., Knoop, H., &amp; Heskes, T. (2015).
Causality on Longitudinal Data: Stable Specification Search in
Constrained Structural Equation Modeling. <em>Proceedings of AALTD 2015</em>, 101.
</p>
<p>Fox, J., Nie, Z., and Byrnes, J. (2015). sem:
Structural Equation Models. R package version 3.1-6.
https://CRAN.R-project.org/package=sem
</p>
<p>Ching-Shih Tsou (2013). nsga2R: Elitist Non-dominated Sorting
Genetic Algorithm based on R. R package version 1.0.
https://CRAN.R-project.org/package=nsga2R
</p>
<p>Kalisch, M., Machler, M., Colombo, D., Maathuis, M. H., and
Buehlmann, P. (2012). Causal inference using graphical models
with the R package pcalg.
<em>Journal of Statistical Software</em>, 47(11), 1-26.
</p>
<p>Meinshausen, N., and Buehlmann, P. (2010). Stability selection.
<em>Journal of the Royal Statistical Society:
Series B (Statistical Methodology)</em>, 72(4), 417-473.
</p>
<p>Deb, K., Pratap, A., Agarwal, S., and Meyarivan, T. (2002),
A fast and elitist multiobjective genetic algorithm: NSGA-II,
<em>IEEE Transactions on Evolutionary Computation</em>, 6(2), 182-197.
</p>
<p>Chickering, D. M. (2002). Learning equivalence classes of
Bayesian-network structures. <em>The Journal of
Machine Learning Research</em>, 2, 445-498.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Cross-sectional data example,
# with an artificial data set of six continuous variables.
# Detail about the data set can be found in the documentation.
# As an example, we only run one subset.
# Note that stableSpec() uses foreach to support
# parallel computation, which could issue a warning
# when running sequentially as the following example. However
# the warning can be just ignored.

the_data &lt;- crossdata6V
numSubset &lt;- 1
num_iteration &lt;- 5
num_pop &lt;- 10
mut_rate &lt;- 0.075
cross_rate &lt;- 0.85
longi &lt;- FALSE
num_time &lt;- 1
the_seed &lt;- NULL
the_co &lt;- "covariance"
#assummed that variable 5 does not cause variables 1, 2, and 3
cons_matrix &lt;- matrix(c(5, 1, 5, 2, 5, 3), 3, 2, byrow=TRUE)
th &lt;- 0.1
to_plot &lt;- FALSE
mix &lt;- FALSE

result &lt;- stableSpec(theData=the_data, nSubset=numSubset,
iteration=num_iteration,
nPop=num_pop, mutRate=mut_rate, crossRate=cross_rate,
longitudinal=longi, numTime=num_time, seed=the_seed,
co=the_co, consMatrix=cons_matrix, threshold=th,
toPlot=to_plot, mixture = mix)

##########################################################
## Parallel computation is possible by
## registering parallel backend, e.g., package doParallel.
## For example, add the following lines on top of
## the example above.
#
# library(parallel)
# library(doParallel)
# cl &lt;- makeCluster(detectCores())
# registerDoParallel(cl)
#
## Then call stableSpec() as normal.
##
## Note that makeCluster() and detectCores() are
## from package parallel, and registerDoParallel()
## is from package doParallel. For more detail
## check the aforementioned packages' documentations.
###########################################################

</code></pre>


</div>