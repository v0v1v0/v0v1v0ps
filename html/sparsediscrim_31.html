<div class="container">

<table style="width: 100%;"><tr>
<td>lda_schafer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Discriminant Analysis using the Schafer-Strimmer Covariance Matrix
Estimator</h2>

<h3>Description</h3>

<p>Given a set of training data, this function builds the Linear Discriminant
Analysis (LDA) classifier, where the distributions of each class are assumed
to be multivariate normal and share a common covariance matrix. When the
pooled sample covariance matrix is singular, the linear discriminant function
is incalculable. This function replaces the inverse of pooled sample
covariance matrix with an estimator proposed by Schafer and Strimmer
(2005). The estimator is calculated via <code>corpcor::invcov.shrink()</code>.
</p>
<p>The Linear Discriminant Analysis (LDA) classifier involves the assumption
that the distributions of each class are assumed to be multivariate normal
and share a common covariance matrix. When the pooled sample covariance
matrix is singular, the linear discriminant function is incalculable. Here,
the inverse of the pooled sample covariance matrix is replaced with an
estimator from Schafer and Strimmer (2005).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lda_schafer(x, ...)

## Default S3 method:
lda_schafer(x, y, prior = NULL, ...)

## S3 method for class 'formula'
lda_schafer(formula, data, prior = NULL, ...)

## S3 method for class 'lda_schafer'
predict(object, newdata, type = c("class", "prob", "score"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix or data frame containing the training data. The rows are the
sample observations, and the columns are the features. Only complete data are
retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options passed to <code>corpcor::invcov.shrink()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of class labels for each training observation. Only complete
data are retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Vector with prior probabilities for each class. If NULL
(default), then equal probabilities are used. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula of the form <code>groups ~ x1 + x2 + ...</code> That is,
the response is the grouping factor and the right hand side specifies the
(non-factor) discriminators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame from which variables specified in <code>formula</code> are
preferentially to be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Fitted model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Matrix or data frame of observations to predict. Each row
corresponds to a new observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Prediction type: either <code>"class"</code>, <code>"prob"</code>, or <code>"score"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix of training observations are given in <code>x</code>. The rows of <code>x</code>
contain the sample observations, and the columns contain the features for each
training observation.
</p>
<p>The vector of class labels given in <code>y</code> are coerced to a <code>factor</code>.
The length of <code>y</code> should match the number of rows in <code>x</code>.
</p>
<p>An error is thrown if a given class has less than 2 observations because the
variance for each feature within a class cannot be estimated with less than 2
observations.
</p>
<p>The vector, <code>prior</code>, contains the <em>a priori</em> class membership for
each class. If <code>prior</code> is NULL (default), the class membership
probabilities are estimated as the sample proportion of observations belonging
to each class. Otherwise, <code>prior</code> should be a vector with the same length
as the number of classes in <code>y</code>. The <code>prior</code> probabilities should be
nonnegative and sum to one.
</p>


<h3>Value</h3>

<p><code>lda_schafer</code> object that contains the trained classifier
</p>


<h3>References</h3>

<p>Schafer, J., and Strimmer, K. (2005). "A shrinkage approach to
large-scale covariance estimation and implications for functional genomics,"
Statist. Appl. Genet. Mol. Biol. 4, 32.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(modeldata)
data(penguins)
pred_rows &lt;- seq(1, 344, by = 20)
penguins &lt;- penguins[, c("species", "body_mass_g", "flipper_length_mm")]
lda_schafer_out &lt;- lda_schafer(species ~ ., data = penguins[-pred_rows, ])
predicted &lt;- predict(lda_schafer_out, penguins[pred_rows, -1], type = "class")

lda_schafer_out2 &lt;- lda_schafer(x = penguins[-pred_rows, -1], y = penguins$species[-pred_rows])
predicted2 &lt;- predict(lda_schafer_out2, penguins[pred_rows, -1], type = "class")
all.equal(predicted, predicted2)
</code></pre>


</div>