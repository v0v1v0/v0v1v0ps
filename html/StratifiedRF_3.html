<div class="container">

<table style="width: 100%;"><tr>
<td>stratified_rf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratified Random Forest</h2>

<h3>Description</h3>

<p>Random Forest that works with groups of predictor variables. When building a tree, a number of variables is taken from each group separately. Useful when rows contain information about different things (e.g. user information and product information) and it's not sensible to make a prediction with information from only one group of variables, or when there are far more variables from one group than the other and it's desired to have groups appear evenly on trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stratified_rf(df, targetvar, groups, mtry = "auto", ntrees = 500,
  multicore = TRUE, class_quotas = NULL, sample_weights = NULL,
  fulldepth = TRUE, replacement = TRUE, c50_control = NULL,
  na.action = na.pass, drop_threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Data to build the model (data.frame only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetvar</code></td>
<td>
<p>String indicating the name of the target or outcome variable in the data. Character types will be coerced to factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Unnamed list, containing at each entry a group of variables (as a string vector with their names).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p>A numeric vector indicating how many variables to take from each group when building each tree. If set to "auto" then, for each group, mtry=round(sqrt(m_total)*len(m_group)/len(m_total)) (with a minimum of 1 for each group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrees</code></td>
<td>
<p>Number of trees to grow. When setting multicore=TRUE, the number of trees should be a multiple of the number of cores, otherwise it will get rounded downwards to the nearest multiple.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>Whether to use multiple CPU cores to parallelize the construction of trees. Parallelization is done with the 'parallel' library's default settings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_quotas</code></td>
<td>
<p>How many rows from each class to use in each tree (useful when there is a class imbalance). Must be a numeric vector or a named list with the number of desired rows to sample for each level of the target variable. Ignored when sample_weights is passed. Note that using more rows than the data originally had might result in incorrect out-of-bag error estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_weights</code></td>
<td>
<p>Probability of sampling each row when building a tree. Must be a numeric vector. If not defined, then all rows have the same probability. Note that, depending on the structure of the data, setting this might result in incorret out-of-bag error estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fulldepth</code></td>
<td>
<p>Whether to grow the trees to full depth. Ignored when passing c50_control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replacement</code></td>
<td>
<p>Whether to sample rows with replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c50_control</code></td>
<td>
<p>Custom parameters for growing trees. Must be a C5.0Control object compatible with the 'C50' package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function indicating how to handle NAs. Default is to include missing values when building a tree (see 'C50' documentation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_threshold</code></td>
<td>
<p>Drop a tree whenever its resulting out-of-bag classification accuracy falls below a certain threshold specified here. Must be a number between 0 and 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that while this algorithm forces each tree to consider possible splits with variables from all groups, it doesn't guarantee that they will end up having splits with variables from different groups.
</p>
<p>The original Random Forest algorithm recommends a total number of sqrt(n_features), but this might not work so well when there are unequal groups of variables.
</p>
<p>Implementation of everything outside the tree-building is in native R code, thus might be slow. Trees are grown using the C5.0 algorithm from the 'C50' library, thus it can be used for classification only (not for regression). Refer to the 'C50' library for any documentation about the tree-building algorithm.
</p>


<h3>See Also</h3>

<p>'C50' library: <a href="https://cran.r-project.org/package=C50">https://cran.r-project.org/package=C50</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(iris)
groups &lt;- list(c("Sepal.Length","Sepal.Width"),c("Petal.Length","Petal.Width"))
mtry &lt;- c(1,1)
m &lt;- stratified_rf(iris,"Species",groups,mtry,ntrees=2,multicore=FALSE)
summary(m)
</code></pre>


</div>