<div class="container">

<table style="width: 100%;"><tr>
<td>locppm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Locally Fitted Poisson or Gibbs Point Process Model
</h2>

<h3>Description</h3>

<p>Fits Poisson or Gibbs point process model
using local likelihood or pseudolikelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">locppm(..., sigma = NULL, f = 1/4,
       vcalc = c("none", "t", "hessian", "hom", "lik", "full"),
       locations=c("split", "fine", "coarse"),
       ngrid = NULL, grideps = NULL, verbose = TRUE,
       use.fft=FALSE, fft.algorithm="closepairs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to <code>ppm</code>
to fit the homogeneous model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Standard deviation of Gaussian kernel for local likelihood.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>Argument passed to <code>bw.frac</code> to
compute a value for <code>sigma</code> if it is missing or <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcalc</code></td>
<td>

<p>Type of variance calculation to be performed. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>

<p>Spatial locations for local calculations. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>

<p>Dimensions of coarse grid, if used. See Details.
Incompatible with <code>grideps</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grideps</code></td>
<td>

<p>Grid spacing of  coarse grid, if used. See Details.
Incompatible with <code>ngrid</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical. If <code>TRUE</code>, print progress reports.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.fft</code></td>
<td>

<p>Logical value indicating whether to perform
computations using the Fast Fourier Transform.
With <code>use.fft = TRUE</code> the code runs much faster
but some quantities are not computed exactly.
See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fft.algorithm</code></td>
<td>

<p>Developer use only.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a Poisson or Gibbs point process model
to point pattern data by local likelihood or local pseudolikelihood
respectively.
</p>
<p>This command should be used in the same way as
<code>ppm</code>. 
The point pattern data and the specification of the model
are given in the leading arguments <code>...</code> which are passed
directly to <code>ppm</code>.
</p>
<p>In all cases, the local estimates of the coefficients are
computed. However, because the variance calculations are
time-consuming, the default is not to perform them.
This is controlled by the argument <code>vcalc</code>.
</p>

<dl>
<dt>
<code>vcalc = "none"</code>:</dt>
<dd>
<p>no variance calculations are performed.
</p>
</dd>
<dt>
<code>vcalc = "t"</code>:</dt>
<dd>
<p>the <code class="reqn">t</code> statistic for each parameter is computed
for the local model.
</p>
</dd>
<dt>
<code>vcalc = "hessian"</code>:</dt>
<dd>
<p>the local Hessian matrix is computed,
and its negative inverse is used as a surrogate for the local variance.
</p>
</dd>
<dt>
<code>vcalc = "hom"</code>:</dt>
<dd>
<p>No local fitting is performed.
Calculations are performed only for the homogeneous (template)
model. The variance of the local parameter estimates
<em>under the homogeneous model</em> is computed.
</p>
</dd>
<dt>
<code>vcalc = "lik"</code>:</dt>
<dd>
<p>In addition to the calculations for <code>vcalc="hom"</code> described
above, if <code>use.fft=FALSE</code>
the algorithm also computes the local composite likelihood
ratio test statistic for the test of homogeneity.
If <code>use.fft=TRUE</code> then <code>vcalc="lik"</code> is equivalent to
<code>vcalc="hom"</code>.
</p>
</dd>
<dt>
<code>vcalc = "full"</code>:</dt>
<dd>
<p>all variance calculations are performed for the local model.
</p>
</dd>
</dl>
<p>The spatial locations, where the model fits and variance calculations
are performed, are determined by the argument <code>locations</code>.
</p>

<dl>
<dt>
<code>locations = "fine"</code>:</dt>
<dd>
<p>The calculations are performed at every quadrature point
of the model. This can take a very long time.
</p>
</dd>
<dt>
<code>locations = "coarse"</code>:</dt>
<dd>
<p>The calculations are performed at the points of a coarse grid
with dimensions specified by <code>ngrid</code> or <code>grideps</code>.
</p>
</dd>
<dt>
<code>locations = "split"</code>:</dt>
<dd>
<p>The fitted coefficients are computed at every quadrature point
of the model, but the variance calculations (if any) are
performed at a coarse grid of locations,
specified by <code>ngrid</code> or <code>grideps</code>.
If neither <code>ngrid</code> nor <code>grideps</code> is specified,
the default is <code>ngrid=10</code>.
</p>
</dd>
</dl>
<p>If <code>use.fft=FALSE</code> (the default), all desired quantities are
computed exactly, by an iterative algorithm that 
fits a separate model at each spatial location. This can be quite
slow.
</p>
<p>If <code>use.fft=TRUE</code>, we only compute quantities that can be
obtained using the Fast Fourier Transform, resulting in much faster
calculations (sometimes 3 orders of magnitude faster) when
<code>locations="fine"</code>.
Properties of the homogeneous model are
computed accurately. Properties of the locally-fitted model are
approximated by a first order Taylor expansion. 
</p>


<h3>Value</h3>

<p>An object of class <code>"locppm"</code> representing the fitted model.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Baddeley, A. (2017) Local composite likelihood
  for spatial point patterns. <em>Spatial Statistics</em> <b>22</b>, 261â€“295. DOI: 10.1016/j.spasta.2017.03.001
</p>
<p>Baddeley, A., Rubak, E. and Turner, R. (2015) <em>Spatial Point Patterns: Methodology and Applications with R</em>. Chapman and Hall/CRC Press. 
</p>


<h3>See Also</h3>

<p><code>methods.locppm</code>, 
<code>plot.locppm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   fit &lt;- locppm(swedishpines, ~1, sigma=9, nd=20)
   fit
</code></pre>


</div>