<div class="container">

<table style="width: 100%;"><tr>
<td>log_likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate log-likelihood</h2>

<h3>Description</h3>

<p>Calculates the log-likelihood of a set of cross-sectional antibody response data, for a given incidence rate (<code>lambda</code>) value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">log_likelihood(
  lambda,
  pop_data,
  antigen_isos,
  curve_params,
  noise_params,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p><code>numeric()</code> incidence parameter, in events per person-year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_data</code></td>
<td>
<p>a <code>data.frame()</code> with cross-sectional serology data per antibody and age, and additional columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antigen_isos</code></td>
<td>
<p>Character vector listing one or more antigen isotypes. Values must match <code>pop_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_params</code></td>
<td>
<p>a <code>data.frame()</code> containing MCMC samples of parameters from the Bayesian posterior distribution of a longitudinal decay curve model. The parameter columns must be named:
</p>

<ul>
<li> <p><code>antigen_iso</code>: a <code>character()</code> vector indicating antigen-isotype combinations
</p>
</li>
<li> <p><code>iter</code>: an <code>integer()</code> vector indicating MCMC sampling iterations
</p>
</li>
<li> <p><code>y0</code>: baseline antibody level at <code class="reqn">t=0</code> (<code class="reqn">y(t=0)</code>)
</p>
</li>
<li> <p><code>y1</code>: antibody peak level (ELISA units)
</p>
</li>
<li> <p><code>t1</code>: duration of infection
</p>
</li>
<li> <p><code>alpha</code>: antibody decay rate (1/days for the current longitudinal parameter sets)
</p>
</li>
<li> <p><code>r</code>: shape factor of antibody decay
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_params</code></td>
<td>
<p>a <code>data.frame()</code> (or <code>tibble::tibble()</code>) containing the following variables, specifying noise parameters for each antigen isotype:
</p>

<ul>
<li> <p><code>antigen_iso</code>: antigen isotype whose noise parameters are being specified on each row
</p>
</li>
<li> <p><code>nu</code>: biological noise
</p>
</li>
<li> <p><code>eps</code>: measurement noise
</p>
</li>
<li> <p><code>y.low</code>: lower limit of detection for the current antigen isotype
</p>
</li>
<li> <p><code>y.high</code>: upper limit of detection for the current antigen isotype
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical: if TRUE, print verbose log information to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to other functions (not currently used).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the log-likelihood of the data with the current parameter values
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(tibble)

#load in longitudinal parameters
dmcmc = load_curve_params("https://osf.io/download/rtw5k")
 
xs_data &lt;- "https://osf.io/download//n6cp3/" %&gt;%
load_pop_data() %&gt;%
clean_pop_data()

#Load noise params
  cond &lt;- tibble(
  antigen_iso = c("HlyE_IgG", "HlyE_IgA"),
  nu = c(0.5, 0.5),                          # Biologic noise (nu)
  eps = c(0, 0),                             # M noise (eps)
  y.low = c(1, 1),                           # low cutoff (llod)
  y.high = c(5e6, 5e6))                      # high cutoff (y.high)

#Calculate log-likelihood
  ll_AG = log_likelihood(
  pop_data = xs_data,
  curve_params = dmcmc,
  noise_params = cond,
  antigen_isos = c("HlyE_IgG","HlyE_IgA"),
  lambda = 0.1) %&gt;% print()

</code></pre>


</div>