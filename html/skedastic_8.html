<div class="container">

<table style="width: 100%;"><tr>
<td>bickel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bickel's Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the method of
Bickel (1978) for testing for
heteroskedasticity in a linear regression model, with or without the
scale-invariance modification of
Carroll and Ruppert (1981).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bickel(
  mainlm,
  fitmethod = c("lm", "rlm"),
  a = "identity",
  b = c("hubersq", "tanhsq"),
  scale_invariant = TRUE,
  k = 1.345,
  statonly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitmethod</code></td>
<td>
<p>A character indicating the method to be used to fit the
regression model. This can be "OLS" for ordinary least squares (the
default) or "robust" in which case a robust fitting method is called
from <code>rlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A character argument specifying the name of a function to be
applied to the fitted values, or an integer <code class="reqn">m</code> in which case the
function applied is <code class="reqn">f(x) = x^m</code>. Defaults to <code>"identity"</code> for
<code>identity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A character argument specifying a function to be applied to the
residuals. Defaults to Huber's function squared, as recommended by
Carroll and Ruppert (1981). Currently the only supported
functions are <code>"hubersq"</code> (for Huber's function squared) and
<code>"tanhsq"</code> (for <code class="reqn">b(x)=\mathrm{tanh}(x)^2</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_invariant</code></td>
<td>
<p>A logical indicating whether the scale-invariance
modification proposed by Carroll and Ruppert (1981)
should be implemented. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A double argument specifying a parameter for Huber's function
squared; used only if <code>b == "hubersq"</code>. This is not to be confused
with the argument <code>k2</code> that could be passed to
<code>rlm</code> if the regression is fitted using robust methods.
<code>k</code> defaults to 1.345.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to be passed to <code>rlm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bickel's Test is a robust extension of Anscombe's Test
(Anscombe 1961) in which the OLS residuals and
estimated standard error are replaced with an <code class="reqn">M</code> estimator. Under
the null hypothesis of homoskedasticity, the distribution of the test
statistic is asymptotically standard normally distributed. The test is
two-tailed.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Anscombe FJ (1961).
“Examination of Residuals.”
In Neyman J (ed.), <em>Fourth Berkeley Symposium on Mathematical Statistics and Probability June 20-July 30, 1960</em>, 1–36.
Berkeley: University of California Press.<br><br> Bickel PJ (1978).
“Using Residuals Robustly I: Tests for Heteroscedasticity, Nonlinearity.”
<em>The Annals of Statistics</em>, <b>6</b>(2), 266–291.<br><br> Carroll RJ, Ruppert D (1981).
“On Robust Tests for Heteroscedasticity.”
<em>The Annals of Statistics</em>, <b>9</b>(1), 206–210.
</p>


<h3>See Also</h3>

<p>discussions of this test in
Carroll and Ruppert (1981) and
Ali and Giaccotto (1984).
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
bickel(mtcars_lm)
bickel(mtcars_lm, fitmethod = "rlm")
bickel(mtcars_lm, scale_invariant = FALSE)

</code></pre>


</div>