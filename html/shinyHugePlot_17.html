<div class="container">

<table style="width: 100%;"><tr>
<td>plotly_datahandler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class for handling plotly data</h2>

<h3>Description</h3>

<p>A class for handling <code>plotly</code> data,
which defines functions used in the <code>downsampler</code> class
</p>


<h3>Format</h3>

<p>An <code>R6::R6Class</code> object
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>figure</code></dt>
<dd>
<p><code>plotly</code> object.</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>orig_data</code></dt>
<dd>
<p>Data frame representing <code>plotly</code> traces.</p>
</dd>
<dt><code>trace_df_default</code></dt>
<dd>
<p>Data frame representing default values
of <code>plotly</code> traces.
<code>name</code> column represents the names of the attributes.
<code>required</code> column represents whether the attributes are necessary
to construct a data frame of a trace.
<code>data</code> column represents whether the attributes are the data.
<code>default</code> attributes represents default values of the attributes.
When constructing a data frame of a trace, default values are used
if no values are assigned.
<code>class</code> column represents the acceptable classes of the attributes.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-plotly_datahandler-new"><code>plotly_datahandler$new()</code></a>
</p>
</li>
<li> <p><a href="#method-plotly_datahandler-set_trace_data"><code>plotly_datahandler$set_trace_data()</code></a>
</p>
</li>
<li> <p><a href="#method-plotly_datahandler-srcs_to_df"><code>plotly_datahandler$srcs_to_df()</code></a>
</p>
</li>
<li> <p><a href="#method-plotly_datahandler-plotly_data_to_df"><code>plotly_datahandler$plotly_data_to_df()</code></a>
</p>
</li>
<li> <p><a href="#method-plotly_datahandler-clone"><code>plotly_datahandler$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-plotly_datahandler-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Constructing an instance.
The data contained in a <code>plotly</code> object (<code>figure</code> argument)
will be included in the instance (as a reference).
</p>


<h5>Usage</h5>

<div class="r"><pre>plotly_datahandler$new(
  figure = NULL,
  srcs = NULL,
  formula = NULL,
  srcs_ext = NULL,
  legend_options = list(name_prefix = "&lt;b style=\"color:sandybrown\"&gt;[S]&lt;/b&gt; ",
    name_suffix = "", xdiff_prefix = "&lt;i style=\"color:#fc9944\"&gt; ~", xdiff_suffix =
    "&lt;/i&gt;"),
  tz = Sys.timezone(),
  use_light_build = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>figure</code></dt>
<dd>
<p><code>plotly</code> object.
The traces of this object will be down-sampled.</p>
</dd>
<dt><code>srcs, srcs_ext, formula</code></dt>
<dd>
<p>Character and formula, optional.
<code>srcs</code> is the path of the source data (or directory).
When a directory is specified, <code>srcs_ext</code> is the extension of the source file.
<code>formula</code> is the formula to extract the data from the source data.</p>
</dd>
<dt><code>legend_options</code></dt>
<dd>
<p>Named list, optional.
Names of the elements are <code>name_prefix</code>,
<code>name_suffix</code>, <code>xdiff_prefix</code>,
and <code>xdiff_suffix</code>.
<code>name_prefix</code> and <code>name_suffix</code>
will be added to the name of the trace when the down-sampling is applied.
By default, prefix is a bold orange <code>[S]</code> and suffix is none.
<code>xdiff_prefix</code> and <code>xdiff_suffix</code> are employed to show
the mean aggregation size of the down-sampling.</p>
</dd>
<dt><code>tz</code></dt>
<dd>
<p>Character, optional.
Time zone used to display time-series data.
By default <code>Sys.timezone()</code>.</p>
</dd>
<dt><code>use_light_build</code></dt>
<dd>
<p>Boolean, optional.
Whether <code>plotly_build_light</code> is used.
It quickly build scatter-type <code>plotly</code> data.
By default, <code>TRUE</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotly_datahandler-set_trace_data"></a>



<h4>Method <code>set_trace_data()</code>
</h4>

<p>In the instance, data is contained as a data frame
(see <code>self$orig_data</code> for detailed information).
Using this method, the data can be added or overwritten.
If a data frame (<code>traces_df</code> argument) is given, it will be
added to <code>self$orig_data</code> or reassigned as <code>self$orig_data</code>.
If attributes to construct a <code>plotly</code> object (<code>...</code> argument)
are given, a data frame is constructed and used.
</p>


<h5>Usage</h5>

<div class="r"><pre>plotly_datahandler$set_trace_data(..., traces_df = NULL, append = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>Arguments to constitute a <code>plotly</code> attributes, optional.
For instance, <code>x</code>, <code>y</code>, <code>type</code>, and <code>mode</code>
are applicable. See <code>plotly::plot_ly</code>.</p>
</dd>
<dt><code>traces_df</code></dt>
<dd>
<p>Data frame, optional.
Data frame whose format is agreed with <code>self$orig_data</code>.
If <code>traces_df</code> is given, arguments in <code>...</code> are neglected.</p>
</dd>
<dt><code>append</code></dt>
<dd>
<p>Boolean, optional.
Whether the data is append or overwrite. By default, <code>FALSE</code>
(the traces are overwritten).</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotly_datahandler-srcs_to_df"></a>



<h4>Method <code>srcs_to_df()</code>
</h4>

<p>Covert the data contained in <code>srcs</code> file(s) to a duck-db.
A minimum data and the path of the database will be returned.
</p>


<h5>Usage</h5>

<div class="r"><pre>plotly_datahandler$srcs_to_df(fml, srcs, srcs_ext = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>fml</code></dt>
<dd>
<p>Formula.
The formula to extract the data from the source data.</p>
</dd>
<dt><code>srcs</code></dt>
<dd>
<p>Character.
The name of the source file (e.g. data.parquet) or the directory can be specified.</p>
</dd>
<dt><code>srcs_ext</code></dt>
<dd>
<p>Character, optional.
The extension of the source file, if <code>srcs</code> is a directory.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotly_datahandler-plotly_data_to_df"></a>



<h4>Method <code>plotly_data_to_df()</code>
</h4>

<p>Covert the data contained in <code>plotly</code> object to a data frame.
A unique id (<code>uid</code>) is granted to each data.
The data frame will be returned.
</p>


<h5>Usage</h5>

<div class="r"><pre>plotly_datahandler$plotly_data_to_df(plotly_data, use_datatable = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>plotly_data</code></dt>
<dd>
<p>List.
The list whose elements are named list representing <code>plotly</code> traces.
All elements must have elements named <code>type</code>.</p>
</dd>
<dt><code>use_datatable</code></dt>
<dd>
<p>Boolean.
If it is <code>TRUE</code>, data such as <code>x</code> and <code>y</code> are nested
in a <code>data.table</code>, of which key column is <code>x</code>.
By default, <code>TRUE</code>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-plotly_datahandler-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>plotly_datahandler$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




</div>