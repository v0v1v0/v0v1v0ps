<div class="container">

<table style="width: 100%;"><tr>
<td>extract_modules</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract modules of features</h2>

<h3>Description</h3>

<p><code>extract_modules</code> uses adaptive branch pruning to extract modules of features,
which is typically done on the smoothed expression returned by <code>gene_importances</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_modules(
  x,
  time = NULL,
  suppress_warnings = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric matrix or a data frame with <em>M</em> rows (one per sample) and <em>P</em> columns (one per feature).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>(Optional) Order the modules according to a pseudotime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress_warnings</code></td>
<td>
<p>Whether or not to suppress warnings when P &gt; 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether or not Mclust will print output or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra parameters passed to <code>Mclust</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame containing meta-data for the features in <code>x</code>, namely the order in which to visualise the features in and which module they belong to.
</p>


<h3>See Also</h3>

<p><code>gene_importances</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate a dataset and visualise
dataset &lt;- generate_dataset(num_genes=300, num_samples=200, num_groups=4)
expression &lt;- dataset$expression
group_name &lt;- dataset$sample_info$group_name
space &lt;- reduce_dimensionality(expression, ndim=2)
traj &lt;- infer_trajectory(space)
time &lt;- traj$time
draw_trajectory_plot(space, path=traj$path, group_name)

## Select most important genes (set ntree to at least 10000!)
gimp &lt;- gene_importances(expression, traj$time, num_permutations = 0, ntree = 1000)
gene_sel &lt;- gimp[1:50,]
expr_sel &lt;- expression[,gene_sel$gene]

## Group the genes into modules and visualise the modules in a heatmap
modules &lt;- extract_modules(scale_quantile(expr_sel))
draw_trajectory_heatmap(expr_sel, time, group_name, modules)
</code></pre>


</div>