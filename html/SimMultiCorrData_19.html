<div class="container">

<table style="width: 100%;"><tr>
<td>findintercorr_cont_nb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Continuous - Negative Binomial Variables: Correlation Method 1</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_cont x k_nb</code> intermediate matrix of correlations for the <code>k_cont</code> continuous and
<code>k_nb</code> Negative Binomial variables. It extends the method of Amatya &amp; Demirtas (2015, doi: <a href="http://doi.org/10.1080/00949655.2014.953534">10.1080/00949655.2014.953534</a>) to
continuous variables generated using
Headrick's fifth-order polynomial transformation and Negative Binomial variables.  Here, the intermediate correlation
between Z1 and Z2 (where Z1 is the standard normal variable transformed using Headrick's fifth-order or Fleishman's
third-order method to produce a continuous variable Y1, and Z2 is the standard normal variable used to generate a
Negative Binomial variable via the inverse cdf method) is calculated by dividing the target correlation by a correction factor.
The correction factor is the product of the upper Frechet-Hoeffding bound on the correlation between a Negative Binomial
variable and the normal variable used to generate it (see <code>chat_nb</code>) and the power method
correlation (described in Headrick &amp; Kowalchuk, 2007, doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>) between Y1 and Z1.  The function is used in
<code>findintercorr</code> and <code>rcorrvar</code>.
This function would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findintercorr_cont_nb(method, constants, rho_cont_nb, size, prob, mu = NULL,
  nrand = 100000, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to generate the <code>k_cont</code> continuous variables.  "Fleishman" uses a third-order polynomial transformation
and "Polynomial" uses Headrick's fifth-order transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>a matrix with <code>k_cont</code> rows, each a vector of constants c0, c1, c2, c3 (if <code>method</code> = "Fleishman") or
c0, c1, c2, c3, c4, c5 (if <code>method</code> = "Polynomial"), like that returned by <code>find_constants</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_cont_nb</code></td>
<td>
<p>a <code>k_cont x k_nb</code> matrix of target correlations among continuous and Negative Binomial variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector of size parameters for the Negative Binomial variables (see <code>NegBinomial</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of success probability parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of mean parameters (*Note: either <code>prob</code> or <code>mu</code> should be supplied for all Negative Binomial variables,
not a mixture; default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>the number of random numbers to generate in calculating the bound (default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used in random number generation (default = 1234)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>k_cont x k_nb</code> matrix whose rows represent the <code>k_cont</code> continuous variables and columns represent the
<code>k_nb</code> Negative Binomial variables
</p>


<h3>References</h3>

<p>Please see references for <code>findintercorr_cont_pois</code>.
</p>


<h3>See Also</h3>

<p><code>chat_nb</code>, <code>power_norm_corr</code>,
<code>find_constants</code>,
<code>findintercorr</code>, <code>rcorrvar</code>
</p>


</div>