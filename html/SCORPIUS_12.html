<div class="container">

<table style="width: 100%;"><tr>
<td>infer_trajectory</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer linear trajectory through space</h2>

<h3>Description</h3>

<p><code>infer_trajectory</code> infers a trajectory through samples in a given space in a four-step process:
</p>

<ol>
<li>
<p> Perform <em>k</em>-means clustering
</p>
</li>
<li>
<p> Calculate distance matrix between cluster centers using a custom distance function
</p>
</li>
<li>
<p> Find the shortest path connecting all cluster centers using the custom distance matrix
</p>
</li>
<li>
<p> Iteratively fit a curve to the given data using principal curves
</p>
</li>
</ol>
<h3>Usage</h3>

<pre><code class="language-R">infer_trajectory(
  space,
  k = 4,
  thresh = 0.001,
  maxit = 10,
  stretch = 0,
  smoother = "smooth_spline",
  approx_points = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>A numeric matrix or a data frame containing the coordinates of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of clusters to cluster the data into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>convergence threshold on shortest distances to the curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stretch</code></td>
<td>
<p>A stretch factor for the endpoints of the curve,
allowing the curve to grow to avoid bunching at the end.
Must be a numeric value between 0 and 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother</code></td>
<td>
<p>choice of smoother. The default is
<code>"smooth_spline"</code>, and other choices are <code>"lowess"</code> and
<code>"periodic_lowess"</code>. The latter allows one to fit closed curves.
Beware, you may want to use <code>iter = 0</code> with <code>lowess()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx_points</code></td>
<td>
<p>Approximate curve after smoothing to reduce computational time.
If <code>FALSE</code>, no approximation of the curve occurs. Otherwise,
<code>approx_points</code> must be equal to the number of points the curve
gets approximated to; preferably about 100.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing several objects:
</p>

<ul>
<li> <p><code>path</code>: the trajectory obtained by principal curves.
</p>
</li>
<li> <p><code>time</code>: the time point of each sample along the inferred trajectory.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>reduce_dimensionality</code>, <code>draw_trajectory_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate an example dataset and visualise it
dataset &lt;- generate_dataset(num_genes = 200, num_samples = 400, num_groups = 4)
space &lt;- reduce_dimensionality(dataset$expression, ndim = 2)
draw_trajectory_plot(space, progression_group = dataset$sample_info$group_name)

## Infer a trajectory through this space
traj &lt;- infer_trajectory(space)

## Visualise the trajectory
draw_trajectory_plot(space, path=traj$path, progression_group = dataset$sample_info$group_name)
</code></pre>


</div>