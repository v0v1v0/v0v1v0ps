<div class="container">

<table style="width: 100%;"><tr>
<td>single_gene_preferences</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Single cell-type gene preferences</h2>

<h3>Description</h3>

<p>Measure enrichment of individual cell-types in a signature matrix.
</p>
<p>Internal function as part of tissue_scMappR_internal().
This function takes genes preferentially expressed within a gene list, each cell-type
and the background (i.e. all genes within the signature matrix) before completing 
the cell-type specific enrichment of the inputted gene list on each cell type.
This function then returns a table describing the cell-type enrichments (p-value and odds ratio)
of each cell-type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">single_gene_preferences(
  hg_short,
  hg_full,
  study_name,
  outDir,
  toSave = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hg_short</code></td>
<td>
<p>A list with two objects: a "preferences" and a "genesIn". Preferences is a list of gene symbols over-represented in each cell-type and genesIn were all the inputted genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hg_full</code></td>
<td>
<p>The same as hg_short but for every gene in the signature matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study_name</code></td>
<td>
<p>Name of output table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outDir</code></td>
<td>
<p>Directory where table is outputted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>single_gene_preferences</code> A gene-set enrichment table of individual cell-type enrichment. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">

# load in signature matrices
data(POA_example)
POA_generes &lt;- POA_example$POA_generes
POA_OR_signature &lt;- POA_example$POA_OR_signature
POA_Rank_signature &lt;- POA_example$POA_Rank_signature
sig &lt;- get_gene_symbol(POA_Rank_signature)
Signature &lt;- POA_Rank_signature
rownames(Signature) &lt;- sig$rowname
genes &lt;- rownames(Signature)[1:60]
heatmap_test &lt;- tissue_scMappR_custom(gene_list = genes, signature_matrix = Signature,
                                      output_directory =  "scMappR_test", toSave = FALSE)
single_preferences &lt;- heatmap_test$single_celltype_preferences
 
</code></pre>


</div>