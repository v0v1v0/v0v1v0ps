<div class="container">

<table style="width: 100%;"><tr>
<td>rflex.midp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute middle p-value</h2>

<h3>Description</h3>

<p>Computes P(Y &gt; cases) + P(Y = cases)/2 when Y ~
Poisson(ex) or Y ~ Binomial(n = pop, p = ex/pop).  This
is middle p-value computed by Tango and Takahashi (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rflex.midp(cases, ex, type = "poisson", pop = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of scan statistic to compute. The
default is <code>"poisson"</code>. The other choice
is <code>"binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of middle p-values
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Tango, T. and Takahashi, K. (2012), A
flexible spatial scan statistic with a restricted
likelihood ratio for detecting disease clusters.
Statist. Med., 31: 4207-4218. &lt;doi:10.1002/sim.5478&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
cases &lt;- floor(nydf$cases)
pop &lt;- nydf$pop
ex &lt;- pop * sum(cases) / sum(pop)
# zones for poisson model
pp &lt;- rflex.midp(cases, ex)
# zones for binomial model
bp &lt;- rflex.midp(cases, ex, type = "binomial", pop = pop)
</code></pre>


</div>