<div class="container">

<table style="width: 100%;"><tr>
<td>rats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Alignment to a Target Spectrum (RATS).</h2>

<h3>Description</h3>

<p>Robust Alignment to a Target Spectrum (RATS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rats(
  mrs_data,
  ref = NULL,
  xlim = c(4, 0.5),
  max_shift = 20,
  p_deg = 2,
  sp_N = 2,
  sp_deg = 3,
  max_t = 0.2,
  basis_type = "poly",
  rescale_output = TRUE,
  phase_corr = TRUE,
  ret_corr_only = TRUE,
  zero_freq_shift_t0 = FALSE,
  remove_freq_outliers = FALSE,
  freq_outlier_thresh = 3,
  remove_phase_outliers = FALSE,
  phase_outlier_thresh = 3,
  remove_amp_outliers = FALSE,
  amp_outlier_thresh = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mrs_data</code></td>
<td>
<p>MRS data to be corrected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>optional MRS data to use as a reference, the mean of all dynamics
is used if this argument is not supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>optional frequency range to perform optimisation, set to NULL
to use the full range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_shift</code></td>
<td>
<p>maximum allowable frequency shift in Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_deg</code></td>
<td>
<p>polynomial degree used for baseline modelling. Negative values
disable baseline modelling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_N</code></td>
<td>
<p>number of spline functions, note the true number will be sp_N +
sp_deg.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_deg</code></td>
<td>
<p>degree of spline functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_t</code></td>
<td>
<p>truncate the FID when longer than max_t to reduce time taken,
set to NULL to use the entire FID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis_type</code></td>
<td>
<p>may be one of "poly" or "spline".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_output</code></td>
<td>
<p>rescale the bl_matched_spec and bl output to improve
consistency between dynamic scans.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase_corr</code></td>
<td>
<p>apply phase correction (in addition to frequency). TRUE by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret_corr_only</code></td>
<td>
<p>return the corrected mrs_data object only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_freq_shift_t0</code></td>
<td>
<p>perform a linear fit to the frequency shifts and
set the (linearly modeled) shift to be 0 Hz for the first dynamic scan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_freq_outliers</code></td>
<td>
<p>remove dynamics based on their frequency shift.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq_outlier_thresh</code></td>
<td>
<p>threshold to remove frequency outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_phase_outliers</code></td>
<td>
<p>remove dynamics based on their phase shift.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase_outlier_thresh</code></td>
<td>
<p>threshold to remove phase outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_amp_outliers</code></td>
<td>
<p>remove dynamics based on their amplitude change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp_outlier_thresh</code></td>
<td>
<p>threshold to remove amplitude outliers.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the corrected data; phase and shift values in units
of degrees and Hz respectively.
</p>


</div>