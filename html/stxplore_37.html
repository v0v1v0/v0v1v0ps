<div class="container">

<table style="width: 100%;"><tr>
<td>semivariogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the semi-variogram using a dataframe or a stars object.</h2>

<h3>Description</h3>

<p>Computes the semi-variogram from a stars or a dataframe. Input arguments differ
for each case. Function autoplot can plot the output.
</p>
<p>When the input is a dataframe, the locations, time and the quantity of interest needs to
be given. When the input is a stars object, a 3 dimensional stars object needs to be given
as input with the first 2 dimensions being spatial and the third being time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semivariogram(
  x,
  latitude_linear = TRUE,
  longitude_linear = TRUE,
  missing_value = -9999,
  width = 80,
  cutoff = 1000,
  tlagmax = 6,
  ...
)

## S3 method for class 'data.frame'
semivariogram(
  x,
  latitude_linear = TRUE,
  longitude_linear = TRUE,
  missing_value = -9999,
  width = 80,
  cutoff = 1000,
  tlagmax = 6,
  times_df,
  values_df,
  ...
)

## S3 method for class 'stars'
semivariogram(
  x,
  latitude_linear = TRUE,
  longitude_linear = TRUE,
  missing_value = -9999,
  width = 80,
  cutoff = 1000,
  tlagmax = 6,
  ...
)

## S3 method for class 'semivariogramobj'
autoplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The dataframe or stars object. If it is a dataframe, then it should have the locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latitude_linear</code></td>
<td>
<p>If <code>TRUE</code>  a linear model is fitted with latitude as a covariate is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitude_linear</code></td>
<td>
<p>If <code>TRUE</code>  a linear model is fitted with longitude as a covariate is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_value</code></td>
<td>
<p>If a certain value such as -9999 denotes the missing values for given locations and times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>A parameter to the <code>gstat::variogram</code> function. The width of the distance intervals to be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>A parameter to the <code>gstat::variogram</code> function. The spatial separation distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlagmax</code></td>
<td>
<p>A parameter to the <code>gstat::variogram</code> function. The maximum time lag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that need to be used for datafames  or currently ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times_df</code></td>
<td>
<p>For dataframes: the dataframe containing the dates in <code>Date</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values_df</code></td>
<td>
<p>For dataframes: the dataframe of dimension <code>length(times) x length(locations)</code> containing the quantity of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>For autoplot: the output from the semivariogram function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A semivariogram object with a gstat variogram and the original data.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Dataframe example
library(dplyr)
data(locs)
data(Times)
data(Tmax)
temp_part &lt;- with(Times, paste(year, month, day, sep = "-"))
temp_part &lt;- data.frame(date = as.Date(temp_part)[913:923])
Tmax &lt;- Tmax[913:923, ]
semidf &lt;- semivariogram(locs,
        temp_part,
        Tmax,
        latitude_linear = FALSE,
        longitude_linear = FALSE,
        missing_value = -9999,
        width = 50,
        cutoff = 1000,
        tlagmax = 7
)
autoplot(semidf)

# Stars example
library(stars)
# Create a stars object from a data frame
precip_df &lt;- NOAA_df_1990[NOAA_df_1990$proc == 'Precip', ] %&gt;%
  filter(date &gt;= "1992-02-01" &amp; date &lt;= "1992-02-05")
precip &lt;- precip_df[ ,c('lat', 'lon', 'date', 'z')]
st_precip &lt;- st_as_stars(precip, dims = c("lon", "lat", "date"))
semist &lt;- semivariogram(st_precip)
autoplot(semist)

</code></pre>


</div>