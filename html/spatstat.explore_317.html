<div class="container">

<table style="width: 100%;"><tr>
<td>pcf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pair Correlation Function</h2>

<h3>Description</h3>

<p>Estimate the pair correlation function.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> pcf(X, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Either the observed data point pattern,
or an estimate of its <code class="reqn">K</code> function,
or an array of multitype <code class="reqn">K</code> functions
(see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments passed to the appropriate method.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The pair correlation function of a stationary point process is
</p>
<p style="text-align: center;"><code class="reqn">
    g(r) = \frac{K'(r)}{2\pi r}
  </code>
</p>

<p>where <code class="reqn">K'(r)</code> is the derivative of <code class="reqn">K(r)</code>, the
reduced second moment function (aka “Ripley's <code class="reqn">K</code> function”)
of the point process. See <code>Kest</code> for information
about <code class="reqn">K(r)</code>. For a stationary Poisson process, the
pair correlation function is identically equal to 1. Values
<code class="reqn">g(r) &lt; 1</code> suggest inhibition between points;
values greater than 1 suggest clustering.
</p>
<p>We also apply the same definition to
other variants of the classical <code class="reqn">K</code> function,
such as the multitype <code class="reqn">K</code> functions
(see <code>Kcross</code>, <code>Kdot</code>) and the
inhomogeneous <code class="reqn">K</code> function (see <code>Kinhom</code>).
For all these variants, the benchmark value of
<code class="reqn">K(r) = \pi r^2</code> corresponds to
<code class="reqn">g(r) = 1</code>.
</p>
<p>This routine computes an estimate of <code class="reqn">g(r)</code>
either directly from a point pattern,
or indirectly from an estimate of <code class="reqn">K(r)</code> or one of its variants.
</p>
<p>This function is generic, with methods for
the classes <code>"ppp"</code>, <code>"fv"</code> and <code>"fasp"</code>.
</p>
<p>If <code>X</code> is a point pattern (object of class <code>"ppp"</code>)
then the pair correlation function is estimated using
a traditional kernel smoothing method (Stoyan and Stoyan, 1994).
See <code>pcf.ppp</code> for details.
</p>
<p>If <code>X</code> is a function value table (object of class <code>"fv"</code>),
then it is assumed to contain estimates of the <code class="reqn">K</code> function
or one of its variants (typically obtained from <code>Kest</code> or
<code>Kinhom</code>).
This routine computes an estimate of <code class="reqn">g(r)</code> 
using smoothing splines to approximate the derivative.
See <code>pcf.fv</code> for details.
</p>
<p>If <code>X</code> is a function value array (object of class <code>"fasp"</code>),
then it is assumed to contain estimates of several <code class="reqn">K</code> functions
(typically obtained from <code>Kmulti</code> or
<code>alltypes</code>). This routine computes
an estimate of <code class="reqn">g(r)</code> for each cell in the array,
using smoothing splines to approximate the derivatives.
See <code>pcf.fasp</code> for details.
</p>


<h3>Value</h3>

<p>Either a function value table
(object of class <code>"fv"</code>, see <code>fv.object</code>)
representing a pair correlation function,
or a function array (object of class <code>"fasp"</code>,
see <code>fasp.object</code>)
representing an array of pair correlation functions.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>
</p>


<h3>References</h3>

<p>Stoyan, D. and Stoyan, H. (1994)
Fractals, random shapes and point fields:
methods of geometrical statistics.
John Wiley and Sons.
</p>


<h3>See Also</h3>

<p><code>pcf.ppp</code>,
<code>pcf.fv</code>,
<code>pcf.fasp</code>,
<code>Kest</code>,
<code>Kinhom</code>,
<code>Kcross</code>,
<code>Kdot</code>,
<code>Kmulti</code>,
<code>alltypes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # ppp object
  X &lt;- simdat
  
  p &lt;- pcf(X)
  plot(p)

  # fv object
  K &lt;- Kest(X)
  p2 &lt;- pcf(K, spar=0.8, method="b")
  plot(p2)

  # multitype pattern; fasp object
  amaK &lt;- alltypes(amacrine, "K")
  amap &lt;- pcf(amaK, spar=1, method="b")
  plot(amap)
</code></pre>


</div>