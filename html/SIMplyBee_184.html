<div class="container">

<table style="width: 100%;"><tr>
<td>nDronesPoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample a number of drones</h2>

<h3>Description</h3>

<p>Sample a number of drones - used when <code>nDrones = NULL</code>
(see <code>SimParamBee$nDrones</code>).
</p>
<p>This is just an example. You can provide your own functions that satisfy
your needs!
</p>


<h3>Usage</h3>

<pre><code class="language-R">nDronesPoisson(x, n = 1, average = 100)

nDronesTruncPoisson(x, n = 1, average = 100, lowerLimit = 0)

nDronesColonyPhenotype(
  x,
  queenTrait = 1,
  workersTrait = NULL,
  checkProduction = FALSE,
  lowerLimit = 0,
  simParamBee = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>Pop-class</code> or <code>Colony-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, number of samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>numeric, average number of drones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerLimit</code></td>
<td>
<p>numeric, returned numbers will be above this value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queenTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents queen's effect on the colony phenotype (defined in
<code>SimParamBee</code> - see examples); if <code>0</code> then this effect is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workersTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents workers's effect on the colony phenotype (defined in
<code>SimParamBee</code> - see examples); if <code>0</code> then this effect is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkProduction</code></td>
<td>
<p>logical, does the phenotype depend on the production
status of colony; if yes and production is not <code>TRUE</code>, the result is
above <code>lowerLimit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParamBee</code></td>
<td>
<p><code>SimParamBee</code>, global simulation parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments of <code>mapCasteToColonyPheno</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>nDronesPoisson</code> samples from a Poisson distribution with a
given average, which can return a value 0.
</p>
<p><code>nDronesTruncPoisson</code> samples from a zero truncated Poisson
distribution.
</p>
<p><code>nDronesColonyPhenotype</code> returns a number (above <code>lowerLimit</code>) as
a function of colony phenotype, say queen's fecundity. Colony phenotype is
provided by <code>mapCasteToColonyPheno</code>. You need to set up
traits influencing the colony phenotype and their parameters (mean and
variances) via <code>SimParamBee</code> (see examples).
</p>
<p>When <code>x</code> is <code>Pop-class</code>, only <code>workersTrait</code> is not
used, that is, only <code>queenTrait</code> is used.
</p>


<h3>Value</h3>

<p>numeric, number of drones
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>nDronesTruncPoisson()</code>: Sample a non-zero number of drones
</p>
</li>
<li> <p><code>nDronesColonyPhenotype()</code>: Sample a non-zero number of drones based on
colony phenotype, say queen's fecundity
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>SimParamBee</code> field <code>nDrones</code> and
<code>vignette(topic = "QuantitativeGenetics", package = "SIMplyBee")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">nDronesPoisson()
nDronesPoisson()
n &lt;- nDronesPoisson(n = 1000)
hist(n, breaks = seq(from = min(n), to = max(n)), xlim = c(0, 200))
table(n)

nDronesTruncPoisson()
nDronesTruncPoisson()
n &lt;- nDronesTruncPoisson(n = 1000)
hist(n, breaks = seq(from = min(n), to = max(n)), xlim = c(0, 200))
table(n)

# Example for nDronesColonyPhenotype()
founderGenomes &lt;- quickHaplo(nInd = 3, nChr = 1, segSites = 100)
SP &lt;- SimParamBee$new(founderGenomes)

average &lt;- 100
h2 &lt;- 0.1
SP$addTraitA(nQtlPerChr = 100, mean = average, var = average * h2)
SP$setVarE(varE = average * (1 - h2))
basePop &lt;- createVirginQueens(founderGenomes)
drones &lt;- createDrones(x = basePop[1], nInd = 50)
droneGroups &lt;- pullDroneGroupsFromDCA(drones, n = 2, nDrones = 15)
colony1 &lt;- createColony(x = basePop[2])
colony2 &lt;- createColony(x = basePop[3])
colony1 &lt;- cross(colony1, drones = droneGroups[[1]])
colony2 &lt;- cross(colony2, drones = droneGroups[[2]])
colony1@queen@pheno
colony2@queen@pheno
createDrones(colony1, nInd = nDronesColonyPhenotype)
createDrones(colony2, nInd = nDronesColonyPhenotype)
</code></pre>


</div>