<div class="container">

<table style="width: 100%;"><tr>
<td>dirichlet.mle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum Likelihood Estimation of the Dirichlet Distribution
</h2>

<h3>Description</h3>

<p>Maximum likelihood estimation of the parameters of the Dirichlet
distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">dirichlet.mle(x, weights=NULL, eps=10^(-5), convcrit=1e-05, maxit=1000,
     oldfac=.3, progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Data frame with <code class="reqn">N</code> observations and <code class="reqn">K</code> variables
of a Dirichlet distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of frequency weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Tolerance number which is added to prevent from logarithms of zero
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convcrit</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldfac</code></td>
<td>
<p>Convergence acceleration factor. It must be a parameter
between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Display iteration progress?
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Vector of <code class="reqn">\alpha</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>The concentration parameter <code class="reqn">\alpha_0=\sum_k \alpha_k</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsi</code></td>
<td>
<p>Vector of proportions <code class="reqn">\xi_k=\alpha_k / \alpha_0</code> </p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Minka, T. P. (2012). <em>Estimating a Dirichlet distribution</em>.
Technical Report.
</p>


<h3>See Also</h3>

<p>For simulating Dirichlet vectors with matrix-wise
<code class="reqn">\bold{\alpha}</code> parameters see <code>dirichlet.simul</code>.
</p>
<p>For a variety of functions concerning the Dirichlet distribution
see the <span class="pkg">DirichletReg</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Simulate and estimate Dirichlet distribution
#############################################################################

# (1) simulate data
set.seed(789)
N &lt;- 200
probs &lt;- c(.5, .3, .2 )
alpha0 &lt;- .5
alpha &lt;- alpha0*probs
alpha &lt;- matrix( alpha, nrow=N, ncol=length(alpha), byrow=TRUE  )
x &lt;- sirt::dirichlet.simul( alpha )

# (2) estimate Dirichlet parameters
dirichlet.mle(x)
  ##   $alpha
  ##   [1] 0.24507708 0.14470944 0.09590745
  ##   $alpha0
  ##   [1] 0.485694
  ##   $xsi
  ##   [1] 0.5045916 0.2979437 0.1974648

## Not run: 
#############################################################################
# EXAMPLE 2: Fitting Dirichlet distribution with frequency weights
#############################################################################

# define observed data
x &lt;- scan( nlines=1)
    1 0   0 1   .5 .5
x &lt;- matrix( x, nrow=3, ncol=2, byrow=TRUE)

# transform observations x into (0,1)
eps &lt;- .01
x &lt;- ( x + eps ) / ( 1 + 2 * eps )

# compare results with likelihood fitting package maxLik
miceadds::library_install("maxLik")
# define likelihood function
dirichlet.ll &lt;- function(param) {
    ll &lt;- sum( weights * log( ddirichlet( x, param ) ) )
    ll
}

#*** weights 10-10-1
weights &lt;- c(10, 10, 1 )
mod1a &lt;- sirt::dirichlet.mle( x, weights=weights )
mod1a
# estimation in maxLik
mod1b &lt;- maxLik::maxLik(loglik, start=c(.5,.5))
print( mod1b )
coef( mod1b )

#*** weights 10-10-10
weights &lt;- c(10, 10, 10 )
mod2a &lt;- sirt::dirichlet.mle( x, weights=weights )
mod2a
# estimation in maxLik
mod2b &lt;- maxLik::maxLik(loglik, start=c(.5,.5))
print( mod2b )
coef( mod2b )

#*** weights 30-10-2
weights &lt;- c(30, 10, 2 )
mod3a &lt;- sirt::dirichlet.mle( x, weights=weights )
mod3a
# estimation in maxLik
mod3b &lt;- maxLik::maxLik(loglik, start=c(.25,.25))
print( mod3b )
coef( mod3b )

## End(Not run)
</code></pre>


</div>