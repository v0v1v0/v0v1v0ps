<div class="container">

<table style="width: 100%;"><tr>
<td>scan_bayes_negbin_cpp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the "Bayesian Spatial Scan Statistic" by Neill et al. (2006).</h2>

<h3>Description</h3>

<p>Calculate the "Bayesian Spatial Scan Statistic" by Neill et al. (2006),
adapted to a spatio-temporal setting. The scan statistic assumes that,
given the relative risk, the data follows a Poisson distribution. The 
relative risk is in turn assigned a Gamma distribution prior, yielding a 
negative binomial marginal distribution for the counts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scan_bayes_negbin_cpp(
  counts,
  baselines,
  zones,
  zone_lengths,
  outbreak_prob,
  alpha_null,
  beta_null,
  alpha_alt,
  beta_alt,
  inc_values,
  inc_probs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>An integer matrix (most recent timepoint in first row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselines</code></td>
<td>
<p>A matrix with positive entries (most recent timepoint in 
first row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zones</code></td>
<td>
<p>An integer vector (all zones concatenated; locations indexed 
from 0 and up).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zone_lengths</code></td>
<td>
<p>An integer vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outbreak_prob</code></td>
<td>
<p>A scalar; the probability of an outbreak (at any time,
any place).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_null</code></td>
<td>
<p>A scalar; the shape parameter for the gamma distribution
under the null hypothesis of no anomaly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_null</code></td>
<td>
<p>A scalar; the scale parameter for the gamma distribution
under the null hypothesis of no anomaly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_alt</code></td>
<td>
<p>A scalar; the shape parameter for the gamma distribution
under the alternative hypothesis of an anomaly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_alt</code></td>
<td>
<p>A scalar; the scale parameter for the gamma distribution
under the alternative hypothesis of an anomaly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_values</code></td>
<td>
<p>A vector of possible values for the increase in the mean
(and variance) of an anomalous count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc_probs</code></td>
<td>
<p>A vector of the prior probabilities of each value in 
<code>inc_values</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>priors</code> (list), <code>posteriors</code> (list), 
and <code>marginal_data_prob</code> (scalar). The list <code>priors</code> has 
elements
</p>

<dl>
<dt>null_prior</dt>
<dd>
<p>The prior probability of no anomaly.</p>
</dd>
<dt>alt_prior</dt>
<dd>
<p>The prior probability of an anomaly.</p>
</dd>
<dt>inc_prior</dt>
<dd>
<p>A vector (matrix with 1 row) of prior probabilities
of each value in the argument <code>m_values</code>.</p>
</dd>
<dt>window_prior</dt>
<dd>
<p>The prior probability of an outbreak in any of the
space-time windows.</p>
</dd>
</dl>
<p>The list <code>posteriors</code> has elements
</p>

<dl>
<dt>null_posterior</dt>
<dd>
<p>The posterior probability of no anomaly.</p>
</dd>
<dt>alt_posterior</dt>
<dd>
<p>The posterior probability of an anomaly.</p>
</dd>
<dt>inc_posterior</dt>
<dd>
<p>A data frame with columns <code>inc_values</code> and
<code>inc_posterior</code>.</p>
</dd>
<dt>window_posteriors</dt>
<dd>
<p>A data frame with columns <code>zone</code>, 
<code>duration</code>, <code>log_posterior</code> and 
<code>log_bayes_factor</code>, each row 
corresponding to a space-time window.</p>
</dd>
<dt>space_time_posteriors</dt>
<dd>
<p>A matrix with the posterior anomaly 
probability of each location-time 
combination.</p>
</dd>
<dt>location_posteriors</dt>
<dd>
<p>A vector (matrix with 1 row) with the 
posterior probability of an anomaly at each
location.</p>
</dd>
</dl>
</div>