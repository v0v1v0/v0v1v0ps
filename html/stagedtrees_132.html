<div class="container">

<table style="width: 100%;"><tr>
<td>stages_hclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Learn a staged tree with hierarchical clustering</h2>

<h3>Description</h3>

<p>Build a stage event tree with <code>k</code> stages for each variable by
clustering stage probabilities with hierarchical clustering.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stages_hclust(
  object,
  distance = "totvar",
  k = NA,
  method = "complete",
  ignore = object$name_unobserved,
  limit = length(object$tree),
  scope = NULL,
  score = function(x) {
     return(-BIC(x))
 }
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>sevt</code> with fitted probabilities and
data, as returned by <code>full</code> or <code>sevt_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>character, the distance measure to be used, either
a possible <code>method</code> for <code>dist</code> or
one of the following: <code>"totvar", "hellinger"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer or (named) vector: number of clusters, that is stages per variable.
Values will be recycled if needed. If <code>NA</code> (default) a search of
the number of stage is performed with respect to the maximization of
the <code>score</code> function. <code>NA</code> and integer can be mixed
to fix the number of stage for some variables and use the
score to select others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the agglomeration method to be used in <code>hclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore</code></td>
<td>
<p>vector of stages which will be ignored and left untouched.
By default the name of the unobserved stages stored in
<code>object$name_unobserved</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>the maximum number of variables to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>names of the variables to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>A function. Score to maximize for automatic selection
of the number of stages. Used if <code>k=NA</code> for some variables.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hclust_sevt</code> performs hierarchical clustering
of the initial stage probabilities in <code>object</code>
and it aggregates them into the specified number
of stages (<code>k</code>).
A different number of stages for the different variables
in the model can be specified by supplying a (named) vector
via the argument <code>k</code>.
If <code>k</code> is <code>NA</code> for some variables, all
possible number of stages will be checked and the
one that maximize the <code>score</code> will be selected.
</p>


<h3>Value</h3>

<p>A staged event tree object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("Titanic")
model &lt;- stages_hclust(full(Titanic, join_unobserved = TRUE, lambda = 1), k = 2)
summary(model)

### or search k via BIC minimization
model1 &lt;- stages_hclust(full(Titanic), k = NA)
</code></pre>


</div>