<div class="container">

<table style="width: 100%;"><tr>
<td>spectro3D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>3D-spectrogram of a time wave</h2>

<h3>Description</h3>

<p>This function returns a three-dimension spectrographic representation of a
time wave. The function corresponds to short-term Fourier transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectro3D(wave, f, channel = 1, wl = 512, wn = "hanning", zp = 0,
ovlp = 0, noisereduction = FALSE, norm = TRUE, correction = "none", fftw = FALSE,
dB = "max0", dBref = NULL, plot = TRUE,
magt = 10, magf = 10, maga = 2,
palette = reverse.terrain.colors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis
(even number of points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default <code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zp</code></td>
<td>
<p>zero-padding (even number of points), see <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in % ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noisereduction</code></td>
<td>
<p>a logical, if <code>TRUE</code> a noise reduction is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>if <code>TRUE</code> the STFT is normalised (i. e. scaled) by its maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>a character vector of length 1 to apply an
amplitude ("amplitude") or an energy ("energy") correction
to the FT window. This argument is useful only when one wish to obtain
absolute values that is when <code>norm=FALSE</code>, <code>scaled=FALSE</code>,
and <code>PMF=FALSE</code>. By default no correction is applied ("none").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code>. See Notes of the <code>spectro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>a character string specifying the type dB to return:
"max0" for a maximum dB value at 0, "A", "B", "C", "D", and "ITU" for common dB weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBref</code></td>
<td>
<p>a dB reference value when <code>dB</code> is <code>TRUE</code>. <code>NULL</code> by default
but should be set to 2*10e-5 for a 20 microPa reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the spectrogram
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magt</code></td>
<td>
<p>magnification of the time axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magf</code></td>
<td>
<p>magnification of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maga</code></td>
<td>
<p>magnification of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>a color palette function to be used to assign colors in
the plot, see <code>Details</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Following Heisenberg uncertainty principle, the short-term Fourier transform
cannot be precised in both time and frequency. The temporal and frequency
precisions of the function are actually dependent of the <code>wl</code> value.
Choosing a high <code>wl</code> value will increase the frequency resolution but
reduce the temporal one, and <em>vice versa</em>. The frequency precision is
obtained by calculating the ratio <code>f</code>/<code>wl</code>,
and the temporal precision is obtained by calculating the reverse ratio
<code>wl</code>/<code>f</code>. This problem can be reduced in some way with <code>zp</code> that
adds 0 values on both sides of the analysis window. This increases frequency
resolution without altering time resolution.<br>
Any colour palette can be used. In particular, it is possible to use other palettes coming with
<span class="pkg">seewave</span>: <code>reverse.gray.colors.1</code>, <code>reverse.gray.colors.2</code>,
<code>spectro.colors</code>, <code>temp.colors</code>, <code>reverse.heat.colors</code>, 
<code>reverse.cm.colors</code>, <code>reverse.topo.colors</code>, corresponding to the reverse
of <code>heat.colors</code>,<code>topo.colors</code>,
<code>cm.colors</code>.<br>
Use <code>magt</code>, <code>magf</code> and <code>maga</code> to resize the plot.   
</p>


<h3>Value</h3>

<p>This function returns a list of three items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>a numeric vector corresponding to the time axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>a numeric vector corresponding to the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp</code></td>
<td>
<p>a numeric matrix corresponding to the amplitude
values. Each column is a Fourier transform of length <code>wl</code>/2.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function requires <span class="pkg">rgl</span> and is based on <code>fft</code>.
See examples of <code>spectro</code> for analysis arguments
(<code>wl</code>,<code>zp</code>, <code>ovlp</code>).</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a> and 
Caroline Simonis <a href="mailto:csimonis@mnhn.fr">csimonis@mnhn.fr</a>.</p>


<h3>See Also</h3>

<p><code>spectro</code>, <code>ggspectro</code>, <code>lts</code>, <code>dynspec</code>,
<code>wf</code>, <code>fft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
require(rgl)
data(tico)
spectro3D(tico,f=22050,wl=512,ovlp=75,zp=16,maga=4,palette=reverse.terrain.colors)
# linear amplitude scale without a normisation of the STFT matrix
# time and frequency scales need to be dramatically amplified
spectro3D(tico, norm=FALSE, dB=NULL, magt=100000, magf=100000)

## End(Not run)</code></pre>


</div>