<div class="container">

<table style="width: 100%;"><tr>
<td>intensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>M-spline estimate of the transition intensity function</h2>

<h3>Description</h3>

<p>M-spline estimate of the transition intensity function
and the cumulative transition intensity function
for survival and illness-death models
</p>


<h3>Usage</h3>

<pre><code class="language-R">intensity(times, knots, number.knots, theta, linear.predictor = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Time points at which to estimate the intensity function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Knots for the M-spline</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number.knots</code></td>
<td>
<p>Number of knots for the M-splines (and I-splines see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The coefficients for the linear combination of M-splines (and I-splines see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictor</code></td>
<td>
<p>Linear predictor beta*Z. When it is non-zero, 
transition and cumulative transition are multiplied by <code>exp(linear.predictor)</code>. Default is zero.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimate of the transition intensity function is a linear
combination of M-splines and the estimate of the cumulative transition
intensity function is a linear combination of I-splines (the integral of a
M-spline is called I-spline). The coefficients <code>theta</code> are the same for
the M-splines and I-splines.
</p>
<p>Important: the theta parameters returned by <code>idm</code> and <code>shr</code> are in fact
the square root of the splines coefficients. See examples.
</p>
<p>This function is a R-translation of a corresponding Fortran function called <code>susp</code>. <code>susp</code> is
used internally by <code>idm</code> and <code>shr</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>The time points at which the following estimates are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity</code></td>
<td>
<p>The transition intensity function evaluated at <code>times</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulative.intensity</code></td>
<td>
<p>The cumulative transition intensity function evaluated at <code>times</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survival</code></td>
<td>
<p>The "survival" function, i.e., exp(-cumulative.intensity)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>R: Celia Touraine &lt;Celia.Touraine@isped.u-bordeaux2.fr&gt; and Thomas Alexander Gerds &lt;tag@biostat.ku.dk&gt;
Fortran: Pierre Joly &lt;Pierre.Joly@isped.u-bordeaux2.fr&gt;
</p>


<h3>See Also</h3>

<p><code>shr</code>, <code>idm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(testdata)
fit.su &lt;- shr(Hist(time=list(l, r), id) ~ cov,
              data = testdata,method = "Splines",CV = TRUE)
intensity(times = fit.su$time, knots = fit.su$knots,
           number.knots = fit.su$nknots, theta = fit.su$theta^2)


  data(Paq1000)
  fit.idm &lt;-  idm(formula02 = Hist(time = t, event = death, entry = e) ~ certif,
                  formula01 = Hist(time = list(l,r), event = dementia) ~ certif,
                  formula12 = ~ certif, method = "Splines", data = Paq1000)
  # Probability of survival in state 0 at age 80 for a subject with no cep given
  # that he is in state 0 at 70
  su0 &lt;- (intensity(times = 80, knots = fit.idm$knots01, 
                   number.knots = fit.idm$nknots01, 
                   theta = fit.idm$theta01^2)$survival
         *intensity(times = 80, knots = fit.idm$knots02, 
                   number.knots = fit.idm$nknots02, 
                   theta = fit.idm$theta02^2)$survival)/
        (intensity(times = 70, knots = fit.idm$knots01, 
                   number.knots = fit.idm$nknots01, 
                   theta = fit.idm$theta01^2)$survival
        *intensity(times = 70, knots = fit.idm$knots02, 
                   number.knots = fit.idm$nknots02, 
                   theta = fit.idm$theta02^2)$survival)
  # Same result as:  
  predict(fit.idm, s = 70, t = 80, conf.int = FALSE) # see first element               

</code></pre>


</div>