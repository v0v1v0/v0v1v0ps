<div class="container">

<table style="width: 100%;"><tr>
<td>qq.lnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Quantile-Quantile Plot for Censored Lognormal Data </h2>

<h3>Description</h3>

<p>qq.lnorm produces a lognormal quantile-quantile (q-q) plot based on the product limit estimate (PLE) 
of the cumulative distribution function (CDF) F(x) for censored data.  A line is added to the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qq.lnorm(pl, mu, sigma, aveple = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p> A data frame with the data(x) in column 1 and PLE in column 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> estimate of the log scale mean </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> estimate of log scale standard deviation </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aveple</code></td>
<td>
<p> if <code>TRUE</code>, calculate plotting positions by averaging</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The PLE is used to determine the plotting positions on the horizontal
axis for the censored data version of a theoretical q-q plot for the lognormal distribution.  Waller and Turnbull (1992)
provide a good overview of q-q plots and other graphical methods for
censored data.  The lognormal q-q plot is obtained by plotting
detected values <code class="reqn">a[j]</code>(on log scale) versus <code class="reqn">H[p(j)]</code> where <code class="reqn">H(p)</code> is the
inverse of the distribution function of the standard normal
distribution. If the largest data value is not censored then the PLE
is 1 and H(1) is off scale.  The "plotting positions" <code class="reqn">p[j]</code> are
determined from the PLE of F(x) by multiplying each estimate by
<code class="reqn">n /(n+1)</code>, or by averaging adjacent valuesâ€“see Meeker and Escobar
(1998, Chap 6)]. In complete data case without ties the first approach
is equivalent to replacing the sample CDF <code class="reqn">j / n</code> with <code class="reqn">j / (n+1)</code>, and for
the second approach the plotting positions are equal to <code class="reqn">(j - .5) / n</code>. If
the lognormal distribution is a close approximation to the empirical
distribution, the points on the plot will fall near a straight line.
An objective evaluation of this is obtained by calculating <code>Rsq</code> the
square of the correlation coefficient associated with the plot.
</p>
<p>A line is added to the plot based on the values of <code>mu</code> and <code>sigma</code>.
If either of these is missing <code>mu</code> and <code>sigma</code> are estimated by
linear regression of <code class="reqn">log(y)</code> on <code class="reqn">H[p(j)]</code>.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> The x coordinates of the points that were plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> The y coordinates of the points that were plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p> The adjusted probabilities use to determine <code>x</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p> The values of <code>mu</code>, <code>sigma</code>, and  <code>Rsq</code> </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Helsel and Cohen (1988) consider alternative procedures that
can be used for calculating plotting positions for left censored
data. Waller and Turnbull (1992) describe a modification of the
Kaplan-Meier estimator that can be used for right censored data and
note that for the purpose of assessing goodness of fit the choice of
plotting positions makes little qualitative difference in the
appearance of any particular plot. The two options in this function
can be used for any type of censoring.
</p>


<h3>Author(s)</h3>

<p> E. L. Frome </p>


<h3>References</h3>

<p>Fay, M. P. (1999), "Comparing Several Score Tests for Interval Censored Data," 
<em>Statistics in Medicine</em>, 1999; 18:273-85. (Corr: 1999, Vol 19, p.2681).
</p>
<p>Frome, E. L. and Wambach, P. F. (2005), "Statistical Methods and Software for 
the Analysis of Occupational Exposure Data with Non-Detectable Values," 
<em>ORNL/TM-2005/52,Oak Ridge National Laboratory</em>, Oak Ridge, TN 37830.
Available at: <a href="http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf">http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf</a>
</p>
<p>Hesel, D. R. and T. A. Cohn (1988), "Estimation of Descriptive
Statistics for Multiply Censored Water Quality Data," <em>Water
Resources Research</em>, 24, 1997-2004.  
</p>
<p>Meeker, W. Q. and L. A. Escobar (1998), <em>Statistical Methods for
Reliability Data</em>, John Wiley and Sons, New York.  
</p>
<p>Ny, M. P. (2002), "A Modification of Peto's Nonparametric Estimation of
Survival Curves for Interval-Censored Data," <em>Biometrics</em>, 58,
439-442. 
</p>
<p>Waller, L. A. and B. W. Turnbull (1992), "Probability Plotting with Censored Data," 
<em>The American Statistician</em>, 46(1), 5-12.
</p>


<h3>See Also</h3>

  <p><code>plekm</code>, <code>plend</code>, <code>pleicf</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">data(SESdata) #  use SESdata data set Example 1 from ORNLTM-2005/52
pnd&lt;- plend(SESdata)
qq.lnorm(pnd) #  lognormal q-q plot based on PLE 
Ia &lt;- "Q-Q plot For SESdata "
qqout &lt;- qq.lnorm(pnd,main=Ia) #  lognormal q-q plot based on PLE 
qqout
</code></pre>


</div>