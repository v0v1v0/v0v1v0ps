<div class="container">

<table style="width: 100%;"><tr>
<td>etreg2steprobVcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Variance Covariance Matrix
</h2>

<h3>Description</h3>

<p>Computation of the asymptotic variance matrix of the robust Heckman's two-stage estimator for endogenous treatment model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">etreg2steprobVcov(y1vec, y2vec, x1Matr, x2Matr, eststage1, eststage2, eststage2sigma, 
				  weights = rep(1, nrow(y1vec)), t.c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1vec</code></td>
<td>

<p>vector of endogenous variables of the selection stage
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2vec</code></td>
<td>

<p>vector of endogenous variables of the outcome stage
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1Matr</code></td>
<td>

<p>matrix of exogenous variables of the selection stage
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2Matr</code></td>
<td>

<p>matrix of exogenous variables of the outcome stage
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eststage1</code></td>
<td>

<p>object of class "<code>glmrob</code>", corresponding to the robust probit fit
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eststage2</code></td>
<td>

<p>vector of the coefficients of the outcome stage
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eststage2sigma</code></td>
<td>

<p>the robust scale estimate of the second stage regression
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>robustness weights 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.c</code></td>
<td>

<p>tuning constant of the second stage
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The computation is made using the Huber (1967) - White (1980) sandwich estimator.  In the computation of leverage weights the lambda's are assumed to be fixed.
</p>


<h3>Value</h3>

<p>Variance covariance matrix of the second stage estimator
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin
</p>


<h3>References</h3>

<p>Huber, P.J. (1967) The Behavior of Maximum Likelihood Estimates under Nonstandard Conditions. <em> Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability; L.M. LeCam, J. Neyman (Eds.), Berkeley: University of California Press</em>, p. 221-233.
</p>
<p>White, H.J. (1980) A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity. <em>Econometrica</em>, 48, p. 817-838.
</p>


</div>