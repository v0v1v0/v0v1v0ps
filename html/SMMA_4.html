<div class="container">

<table style="width: 100%;"><tr>
<td>predict.SMMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make Prediction From a SMMA Object</h2>

<h3>Description</h3>

<p>Given new covariate data this function computes the linear predictors
based on the estimated model coefficients in an object produced by the function <code>softmaximin</code>. Note that the
data can be supplied in two different formats: i) as a <code class="reqn">n' \times p</code> matrix (<code class="reqn">p</code> is the number of model
coefficients and <code class="reqn">n'</code> is the number of new data points) or ii) as a list of two or three matrices each of
size <code class="reqn">n_i' \times p_i, i = 1, 2, 3</code> (<code class="reqn">n_i'</code> is the number of new marginal data points in the <code class="reqn">i</code>th dimension).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'SMMA'
predict(object, x = NULL, X = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class SMMA, produced with <code>softmaximin</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of size <code class="reqn">n' \times p</code> with <code class="reqn">n'</code> is the number of new data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a list containing the data matrices each of size <code class="reqn">n'_{i} \times p_i</code>,
where <code class="reqn">n'_{i}</code> is the number of new data points in  the <code class="reqn">i</code>th dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of length <code>nlambda</code> containing the linear predictors for each  model. If
new covariate data is supplied in one <code class="reqn">n' \times p</code> matrix <code>x</code> each
item  is a vector of length <code class="reqn">n'</code>. If the data is supplied as a list of
matrices each of size <code class="reqn">n'_{i} \times p_i</code>,  each item is an array of size <code class="reqn">n'_1 \times \cdots \times n'_d</code>, with <code class="reqn">d\in \{1,2,3\}</code>.
</p>


<h3>Author(s)</h3>

<p>Adam Lund
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##size of example
n1 &lt;- 65; n2 &lt;- 26; n3 &lt;- 13; p1 &lt;- 13; p2 &lt;- 5; p3 &lt;- 4

##marginal design matrices (Kronecker components)
X1 &lt;- matrix(rnorm(n1 * p1, 0, 0.5), n1, p1)
X2 &lt;- matrix(rnorm(n2 * p2, 0, 0.5), n2, p2)
X3 &lt;- matrix(rnorm(n3 * p3, 0, 0.5), n3, p3)
X &lt;- list(X1, X2, X3)

component &lt;- rbinom(p1 * p2 * p3, 1, 0.1)
Beta1 &lt;- array(rnorm(p1 * p2 * p3, 0, .1) + component, c(p1 , p2, p3))
Beta2 &lt;- array(rnorm(p1 * p2 * p3, 0, .1) + component, c(p1 , p2, p3))
mu1 &lt;- RH(X3, RH(X2, RH(X1, Beta1)))
mu2 &lt;- RH(X3, RH(X2, RH(X1, Beta2)))
Y1 &lt;- array(rnorm(n1 * n2 * n3, mu1), dim = c(n1, n2, n3))
Y2 &lt;- array(rnorm(n1 * n2 * n3, mu2), dim = c(n1, n2, n3))

Y &lt;- array(NA, c(dim(Y1), 2))
Y[,,, 1] &lt;- Y1; Y[,,, 2] &lt;- Y2;

fit &lt;- softmaximin(X, Y, zeta = 10, penalty = "lasso", alg = "npg")

##new data in matrix form
x &lt;- matrix(rnorm(p1 * p2 * p3), nrow = 1)
predict(fit, x = x)[[15]]

##new data in tensor component form
X1 &lt;- matrix(rnorm(p1), nrow = 1)
X2 &lt;- matrix(rnorm(p2), nrow = 1)
X3 &lt;- matrix(rnorm(p3), nrow = 1)
predict(fit, X = list(X1, X2, X3))[[15]]


</code></pre>


</div>