<div class="container">

<table style="width: 100%;"><tr>
<td>Bernoulli_diff_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the distribution of differences of replacement samples of two Binomial or Bernoulli experiments.</h2>

<h3>Description</h3>

<p>Assuming <code>max(nA, nB) %% min(nA, nB) == 0</code>:
compute the distribution of differences of weighted sums between
<code>max(1, nB/nA)*sum(a)</code>
and  <code>max(1, nA/nB)*sum(b)</code>
where <code>a</code> is a 0/1 vector of length <code>nA</code> with each item 1 with independent probability <code>(kA+kB)/(nA+nB)</code>,
and <code>b</code> is a 0/1 vector of length <code>nB</code> with each item 1 with independent probability <code>(kA+kB)/(nA+nB)</code>.
Then return the significance of a direct two-sided test that the absolute value of this difference is at least as large
as the test_rate_difference (if supplied) or the empirically observed rate difference <code>abs(nB*kA - nA*kB)/(nA*nB)</code>.
The idea is: under this scaling differences in success rates between the two processes are easily observed as differences
in counts returned by the scaled processes.
The method can be used to get the exact probability of a given difference under the null hypothesis that
both the <code>A</code> and <code>B</code> processes have the same success rate <code>(kA+kB)/(nA+nB)</code>.
When <code>nA</code> and <code>nB</code> don't divide evenly into to each
other two calculations are run with the larger process is alternately padded and truncated to look like a larger or smaller
experiment that meets the above conditions.  This gives us a good range of significances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bernoulli_diff_stat(kA, nA, kB, nB, test_rate_difference, common_rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kA</code></td>
<td>
<p>number of A successes observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nA</code></td>
<td>
<p>number of A experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kB</code></td>
<td>
<p>number of B successes observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nB</code></td>
<td>
<p>number of B experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_rate_difference</code></td>
<td>
<p>numeric, difference in rate of A-B to test.  Note: it is best to specify this prior to looking at the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common_rate</code></td>
<td>
<p>rate numeric, assumed null-rate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note the intent is that we are measuring the results of an A/B test with <code>max(nA, nB) %% min(nA, nB) == 0</code>
(no padding needed), or <code>max(nA,nB) &gt;&gt; min(nA,nB)</code> (padding is small effect).
</p>
<p>The idea of converting a rate problem into a counting problem follows from reading Wald's <em>Sequential Analysis</em>.
</p>
<p>For very small p-values the calculation is sensitive to rounding in the observed ratio-difference,
as an arbitrarily small change in test-rate can move an entire set of observed differences in or out of the significance calculation.
</p>


<h3>Value</h3>

<p>Bernoulli difference test statistic.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Bernoulli_diff_stat(2000, 5000, 100, 200)
Bernoulli_diff_stat(2000, 5000, 100, 200, 0.1)
Bernoulli_diff_stat(2000, 5000, 100, 199)
Bernoulli_diff_stat(2000, 5000, 100, 199, 0.1)
Bernoulli_diff_stat(100, 200, 2000, 5000)

# sigr adjusts experiment sizes when lengths
# don't divide into each other.
Bernoulli_diff_stat(100, 199, 2000, 5000)
Bernoulli_diff_stat(100, 199, 2000, 5000)$pValue

</code></pre>


</div>