<div class="container">

<table style="width: 100%;"><tr>
<td>rollback</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rollback to a Previous Activity</h2>

<h3>Description</h3>

<p>Activity for going backwards to a previous point in the trajectory. Useful to
implement loops.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rollback(.trj, target, times = Inf, check = NULL, ..., tag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.trj</code></td>
<td>
<p>the trajectory object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>tag name (previously set with the <code>tag</code> argument in any
activity) or amount of activities (of the same or parent trajectories) to
roll back (see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>the number of repetitions until an arrival may continue.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>a callable object (a function) which must return a boolean. If
present, the <code>times</code> parameter is ignored, and the activity uses this
function to check whether the rollback must be done or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag</code></td>
<td>
<p>activity tag name to perform named rollbacks (see
<code>rollback</code>) or just to better identify your activities.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the trajectory object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## rollback a specific number of times
traj &lt;- trajectory() %&gt;%
  log_("hello!") %&gt;%
  timeout(1) %&gt;%
  rollback(2, 3)

simmer() %&gt;%
  add_generator("hello_sayer", traj, at(0)) %&gt;%
  run() %&gt;% invisible

## same but with a tag as target
traj &lt;- trajectory() %&gt;%
  log_("hello!", tag="msg") %&gt;%
  timeout(1) %&gt;%
  rollback("msg", 3)

simmer() %&gt;%
  add_generator("hello_sayer", traj, at(0)) %&gt;%
  run() %&gt;% invisible

## custom check
env &lt;- simmer()

traj &lt;- trajectory() %&gt;%
  set_attribute("var", 0) %&gt;%
  log_(tag="msg", function()
    paste("attribute level is at:", get_attribute(env, "var"))) %&gt;%
  set_attribute("var", 25, mod="+") %&gt;%
  rollback("msg", check=function() get_attribute(env, "var") &lt; 100) %&gt;%
  log_("done")

env %&gt;%
  add_generator("dummy", traj, at(0)) %&gt;%
  run() %&gt;% invisible

</code></pre>


</div>