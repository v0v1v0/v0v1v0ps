<div class="container">

<table style="width: 100%;"><tr>
<td>BICadj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ways to compare SITAR models for fit</h2>

<h3>Description</h3>

<p><code>BICadj</code> and <code>AICadj</code> calculate the BIC and AIC for SITAR models,
adjusting the likelihood for Box-Cox transformed y variables. <code>varexp</code>
calculates the variance explained by SITAR models, compared to the
corresponding fixed effect models. <code>getL</code> is used by <code>[AB]ICadj</code> to
find what power the y variable is raised to.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BICadj(..., pattern = NULL)

AICadj(..., k = 2, pattern = NULL)

varexp(..., pattern = NULL)

getL(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>one or more SITAR models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>regular expression defining names of models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric, the penalty per parameter to be used; the default k = 2 is
the classical AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>quoted or unquoted expression containing a single variable name.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The deviance is adjusted if the y variable is power-transformed, using the
formula
</p>
<p style="text-align: center;"><code class="reqn">adjusted deviance = deviance - 2n ( (\lambda-1) * log(gm) + %
log(abs(\lambda)) )</code>
</p>

<p>where <code class="reqn">\lambda</code> is the power transform, and <code class="reqn">n</code> and
<code class="reqn">gm</code> are the length and geometric mean of <code>y</code>.
</p>
<p>The variance explained is given by </p>
<p style="text-align: center;"><code class="reqn">\% explained = 100 * (1 -%
(\sigma_2/\sigma_1)^2)</code>
</p>
<p> where
<code class="reqn">\sigma_1</code> is the fixed effects RSD and <code class="reqn">\sigma_2</code>
the SITAR random effects RSD.
</p>
<p><code>BICadj</code> and <code>AICadj</code> accept non-<code>sitar</code> models with a
<code>logLik</code> class. <code>varexp</code> ignores objects not of class
<code>sitar</code>.
</p>
<p><code>getL</code> does not detect if the variable in <code>expr</code>, or its log, contains a multiplying constant,
so that the expressions <code>log(x)</code> and <code>1 + 2 * log(3 * x)</code> both return 0.
</p>


<h3>Value</h3>

<p>For <code>BICadj</code> and <code>AICadj</code> a named vector of deviances in
increasing order.  For <code>varexp</code> a named vector of percentages in
decreasing order. For <code>getL</code> the power the variable in <code>expr</code>
is raised to, or <code>NA</code> if <code>expr</code> is not a power of (a multiple of)
the variable.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>BIC</code>, <code>AIC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(heights)
## fit sitar model for height
m1 &lt;- sitar(x=age, y=height, id=id, data=heights, df=5)

## update it for log(height)
m2 &lt;- update(m1, y=sqrt(height))

## compare variance explained in the two models
varexp(m1, m2)

## compare BIC adjusting for sqrt transform
## the pattern matches names starting with "m" followed by a digit
BICadj(pattern="^m[0-9]")

## find what power height is raised to
getL(quote(sqrt(sqrt(height))))
</code></pre>


</div>