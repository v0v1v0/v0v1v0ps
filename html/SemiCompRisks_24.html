<div class="container">

<table style="width: 100%;"><tr>
<td>PPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to predict the joint probability involving two event times in Bayesian illness-death models
</h2>

<h3>Description</h3>

<p><code>PPD</code> is a function to predict the joint probability involving two event times in Bayesian illness-death models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PPD(fit, x1, x2, x3, t1, t2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>an object of class <code>Bayes_HReg</code>. Currently, the function is available for PEM illness-death models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>

<p>a vector of covariates for <code class="reqn">h_1</code> with which to predict.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>

<p>a vector of covariates for <code class="reqn">h_2</code> with which to predict.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x3</code></td>
<td>

<p>a vector of covariates for <code class="reqn">h_3</code> with which to predict.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>

<p>time to non-terminal event for which the joint probability is calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>

<p>time to terminal event for which the joint probability is calculated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the posterior predictive density, given (<code class="reqn">x_1</code>, <code class="reqn">x_2</code>, <code class="reqn">x_3</code>), one can predict any joint probability involving the two event times such as <code class="reqn">P(T_1&lt;t_1, T_2&lt;t_2| x_1, x_2, x_3)</code> for <code class="reqn">0&lt;t_1\le t_2</code> and <code class="reqn">P(T_1=\infty, T_2&lt;t_2| x_1, x_2, x_3)</code> for <code class="reqn">t_2&gt;0</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>F_u</code></td>
<td>
<p>Predicted <code class="reqn">P(T_1\le t_1, T_2\le t_2| x_1, x_2, x_3)</code> in the upper wedge of the support of <code class="reqn">(T_1, T_2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F_l</code></td>
<td>
<p>Predicted <code class="reqn">P(T_1=\infty, T_2\le t_2| x_1, x_2, x_3)</code> in the lower wedge of the support of <code class="reqn">(t1, t2)</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kyu Ha Lee and Sebastien Haneuse<br>
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, K. H., Haneuse, S., Schrag, D., and Dominici, F. (2015), 
Bayesian semiparametric analysis of semicompeting risks data: 
investigating hospital readmission after a pancreatic cancer diagnosis, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 2, 253-273.<br></p>


<h3>See Also</h3>

<p><code>BayesID_HReg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:    
# loading a data set
data(scrData)
id=scrData$cluster

form &lt;- Formula(time1 + event1 | time2 + event2 ~ x1 + x2 | x1 + x2 | x1 + x2)

#####################
## Hyperparameters ##
#####################

## Subject-specific frailty variance component
##  - prior parameters for 1/theta
##
theta.ab &lt;- c(0.7, 0.7)

## PEM baseline hazard function
##
PEM.ab1 &lt;- c(0.7, 0.7) # prior parameters for 1/sigma_1^2
PEM.ab2 &lt;- c(0.7, 0.7) # prior parameters for 1/sigma_2^2
PEM.ab3 &lt;- c(0.7, 0.7) # prior parameters for 1/sigma_3^2
##
PEM.alpha1 &lt;- 10 # prior parameters for K1
PEM.alpha2 &lt;- 10 # prior parameters for K2
PEM.alpha3 &lt;- 10 # prior parameters for K3

##
hyperParams &lt;- list(theta=theta.ab,
                   PEM=list(PEM.ab1=PEM.ab1, PEM.ab2=PEM.ab2, PEM.ab3=PEM.ab3,
                    PEM.alpha1=PEM.alpha1, PEM.alpha2=PEM.alpha2,
                    PEM.alpha3=PEM.alpha3))
                    
###################
## MCMC SETTINGS ##
###################

## Setting for the overall run
##
numReps    &lt;- 2000
thin       &lt;- 10
burninPerc &lt;- 0.5

## Settings for storage
##
nGam_save &lt;- 0

## Tuning parameters for specific updates
##
##  - those common to all models
mhProp_theta_var  &lt;- 0.05
##
## - those specific to the Weibull specification of the baseline hazard functions
mhProp_alphag_var &lt;- c(0.01, 0.01, 0.01)
##
## - those specific to the PEM specification of the baseline hazard functions
Cg        &lt;- c(0.2, 0.2, 0.2)
delPertg  &lt;- c(0.5, 0.5, 0.5)
rj.scheme &lt;- 1
Kg_max    &lt;- c(50, 50, 50)
sg_max    &lt;- c(max(scrData$time1[scrData$event1 == 1]),
               max(scrData$time2[scrData$event1 == 0 &amp; scrData$event2 == 1]),
               max(scrData$time2[scrData$event1 == 1 &amp; scrData$event2 == 1]))

time_lambda1 &lt;- seq(1, sg_max[1], 1)
time_lambda2 &lt;- seq(1, sg_max[2], 1)
time_lambda3 &lt;- seq(1, sg_max[3], 1)               

##
mcmc.PEM &lt;- list(run=list(numReps=numReps, thin=thin, burninPerc=burninPerc),
                storage=list(nGam_save=nGam_save),
                tuning=list(mhProp_theta_var=mhProp_theta_var,
                Cg=Cg, delPertg=delPertg,
                rj.scheme=rj.scheme, Kg_max=Kg_max,
                time_lambda1=time_lambda1, time_lambda2=time_lambda2,
                time_lambda3=time_lambda3))
    
##						
myModel &lt;- c("semi-Markov", "PEM")
myPath  &lt;- "Output/02-Results-PEM/"

startValues      &lt;- initiate.startValues_HReg(form, scrData, model=myModel, nChain=2)

##
fit_PEM &lt;- BayesID_HReg(form, scrData, id=NULL, model=myModel,
                 hyperParams, startValues, mcmc.PEM, path=myPath)
				
PPD(fit_PEM, x1=c(1,1), x2=c(1,1), x3=c(1,1), t1=3, t2=6)
		

## End(Not run)
</code></pre>


</div>