<div class="container">

<table style="width: 100%;"><tr>
<td>DGobj.simul.regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of a DG object under a regression model
</h2>

<h3>Description</h3>

<p>Simulation of a DG object under a regression model generating proportions of pathogen strains in each node of a square grid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DGobj.simul.regression(sqrtn, size1, size2, theta, alpha.function, sigma,
 plots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sqrtn</code></td>
<td>

<p>[Positive integer] Side size of the square grid over which the proportions are simulated. The inter-node distance in the grid is one in the horizontal and vertical directions. The total number of grid nodes is sqrtn^2. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size1</code></td>
<td>

<p>[Positive integer] Number of grid nodes where pathogen isolates are collected (sampling sites).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size2</code></td>
<td>

<p>[Positive integer] Number of pathogen isolates sampled in each sampling site.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>[Vector of numerics] Regression coefficients representing the fitness of the strains. The length of this vector determines the number of strains.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.function</code></td>
<td>

<p>[Function] Function whose value is a matrix of positive numerics with number of columns equal to the number of strains and the number of rows is the number of grid nodes. Each row of the matrix provides the parameters of the Dirichlet distribution used to draw the proportions of strains at each node. The argument of the function is a 2-column matrix of coordinates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>[Postive numeric] Standard deviation of the white noise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>

<p>[Logical] If TRUE, plots are produced. The plots show the proportion of each strain in space.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object from the DG class.
</p>


<h3>Note</h3>

<p>The function <code>DGobj.simul.regression</code> generates a growth variable (third column of the demographic slot of the returned DG object) satisfying:
</p>
<p style="text-align: center;"><code class="reqn">Z_i=\left(\sum_{s=1}^S p_i(s) \code{theta}[s])\right) + \eta_i,</code>
</p>

<p>for each demographic sampling site <code class="reqn">i</code>. In this expression, <code class="reqn">(p_i(1),...,p_i(S))</code> are the proportions of the strains at sampling site <code class="reqn">i</code>, where <code class="reqn">S</code> is the number of different strains. These proportions are drawn in Dirichlet distributions. <code>theta</code><code class="reqn">[s]</code> denotes the <code class="reqn">s</code>-th component of <code>theta</code>. <code class="reqn">\eta_i</code> denotes a centered random normal variable (white noise) with standard deviation <code>sigma</code>.
</p>


<h3>Author(s)</h3>

<p>Soubeyrand, S., Tollenaere, C., Haon-Lasportes, E. and Laine, A.-L. 
</p>


<h3>References</h3>

<p>Soubeyrand S., Tollenaere C., Haon-Lasportes E. &amp; Laine A.-L. (2014). Regression-based ranking of pathogen strains with respect to their contributions to natural epidemics. PLOS ONE 9(1): e86591.
</p>


<h3>See Also</h3>

<p>DGobj-class, DGobj.rawdata, DGobj.simul.mechanistic, generation.alpha.3strains
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulation of a data set
DGreg=DGobj.simul.regression(sqrtn=10, size1=30, size2=10, theta=c(1.5,2,3), 
	alpha.function=generation.alpha.3strains, sigma=0.1)
summary(DGreg)

## Simulation of a data set and plots of the proportions in space the strains
DGreg=DGobj.simul.regression(sqrtn=10, size1=30, size2=10, theta=c(1.5,2,3), 
	alpha.function=generation.alpha.3strains, sigma=0.1,plots=TRUE)
summary(DGreg)
</code></pre>


</div>