<div class="container">

<table style="width: 100%;"><tr>
<td>filter.lomb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter and reconstruction of data analysed via spec.lomb</h2>

<h3>Description</h3>

<p>Given an object of class <code>lomb</code>, this function allows the
reconstruction of the input signal using (a) a frequency selection
of single or multiple frequency (ranges), and/or (b) the most
significant peaks in the periodogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter.lomb(
  l = stop("No Lomb-Data"),
  newx = NULL,
  threshold = 6,
  filt = NULL,
  phase = "nextnb"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>lomb object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newx</code></td>
<td>
<p>vector of new values at which the restored function is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>statistical threshold in terms of a standard deaviation of
the amplidudes. It determines which frequencies are used. Lower values give
more frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filt</code></td>
<td>
<p>vector or matix of frequencies (ranges) in which to select the frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>set the method to determine the phase at a given frequency</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To properly reconstruct the signal out of the calculated
<code>lomb</code>-object, three different methods are available, which are
controlled by the <code>filt</code>-argument.
</p>

<ol>
<li>
<p> If <code>filt=NULL</code>, the most significant values in the (dense) spectrum
are used.
</p>
</li>
<li>
<p> If <code>filt=c(f1, .., fn)</code>, the given frequencies are used. The corresponding
phase is approximated.
</p>
</li>
<li>
<p> If <code>class(filt)=="matrix"</code>, each row of the 2 x n matrix defines a
frequency range. With in each range the "significant" frequencies are selected for
reconstruction.
</p>
</li>
</ol>
<p>Prior to the reconstruction the <code>filter.lomb</code>-function calculates the
most significant amplitudes and corresponding phases. As a measure to select
the "correct" frequencies, the <code>threshold</code> argument can be adjusted.
The corresponding phases of the underlying sine/cosine-waves are estimated by
one of the four following methods.
</p>

<ol>
<li> <p><code>phase=="nextnb"</code>... use the phase of the bin of nearest neighbour.
</p>
</li>
<li> <p><code>phase=="lin"</code>... linear interpolation between the two closest bins.
</p>
</li>
<li> <p><code>phase=="lockin"</code>... principle of lock-in amplification, also known as
quadrature-demodulation technique.
</p>
</li>
<li> <p><code>phase=="fit"</code>... non-linear least squares fit with <code>stats::nls</code>
</p>
</li>
</ol>
<h3>Value</h3>

<p>This function returns a list which contains the reconstruction according to the
<code>lomb</code>-object and <code>newx</code> for the given data <code>x</code> and <code>y</code>. The returned
object contains the following:
</p>

<dl>
<dt><code>x,y</code></dt>
<dd>
<p>reconstructed signal</p>
</dd>
<dt><code>f,A,phi</code></dt>
<dd>
<p>used parameters from the <code>lomb</code>-object</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p>corresponding significance values</p>
</dd>
</dl>
</div>