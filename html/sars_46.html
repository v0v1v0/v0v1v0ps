<div class="container">

<table style="width: 100%;"><tr>
<td>threshold_ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate confidence intervals around breakpoints</h2>

<h3>Description</h3>

<p>Generate confidence intervals around the breakpoints of the
one-threshold continuous and left-horizontal models. Two types of
confidence interval can be implemented: a confidence interval derived from
an inverted F test and an empirical bootstrap confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">threshold_ci(object, cl = 0.95, method = "boot", interval = NULL,
  Nboot = 100, verb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class 'thresholds', generated using the
<code>sar_threshold</code> function. The object must contain fits of
either (or both) of the one-threshold continuous or the one-threshold
left-horizontal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>The confidence level. Default value is 0.95 (95 percent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either bootstraping (<code>boot</code>) or inverted F test
(<code>F</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The amount to increment the threshold value by in the
iterative model fitting process used in both the F and boot methods. The
default for non-transformed area reverts to 1, while for log-transformed
area it is 0.01. It is advised that the same interval value used when
running <code>sar_threshold</code> is used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nboot</code></td>
<td>
<p>Number of bootstrap samples (for use with <code>method =
"boot"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>Should progress be reported. If <code>TRUE</code>, every 50th bootstrap
sample is reported (for use with <code>method = "boot"</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Full details of the two approaches can be found in Toms and
Lesperance (2003). If the number of bootstrap samples is large, the
function can take a while to run. Following Toms and Lesperance (2003), we
therefore recommend the use of the inverted F test confidence interval when
sample size is large, and bootstrapped confidence intervals when sample
size is smaller.
</p>
<p>Currently only available for the one-threshold continuous and left-
horizontal threshold models.
</p>


<h3>Value</h3>

<p>A list of class "sars" with two elements. If method “F” is used, the
list contains only the confidence interval values. If method “boot” is
used, the list contains two elements. The first element is the full set of
bootstrapped breakpoint estimates for each model and the second contains
the confidence interval values.
</p>


<h3>Author(s)</h3>

<p>Francois Rigal and Christian Paroissin
</p>


<h3>References</h3>

<p>Toms, J.D. &amp; Lesperance, M.L. (2003) Piecewise regression: a tool
for identifying ecological thresholds. Ecology, 84, 2034-2041.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(aegean2)
a2 &lt;- aegean2[1:168,]
fitT &lt;- sar_threshold(data = a2, mod = "ContOne", 
interval = 0.1, non_th_models = TRUE, logAxes = "area", logT = log10)
#calculate confidence intervals using bootstrapping
#(very low Nboot just as an example)
CI &lt;- threshold_ci(fitT, method = "boot", interval = NULL, Nboot = 3)
CI
#Use the F method instead, with 90% confidence interval
CI2 &lt;- threshold_ci(fitT, cl = 0.90, method = "F", interval = NULL)
CI2
</code></pre>


</div>