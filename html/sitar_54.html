<div class="container">

<table style="width: 100%;"><tr>
<td>timegap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select equally spaced ages from a vector of ages</h2>

<h3>Description</h3>

<p><code>timegap</code> indexes elements in a vector of ages such that the indexed
ages are spaced integer multiples of a time interval apart, to within a given
tolerance. <code>timegap.id</code> is a wrapper to apply <code>timegap</code> within levels
of factor <code>id</code>. The selected ages can then be split into age groups the
specified time interval wide, ensuring that (virtually) every subject
has at most one measurement per interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">timegap(age, gap, tol = 0.1 * gap, multiple = FALSE)

timegap.id(
  age,
  id,
  data = parent.frame(),
  gap,
  tol = 0.1 * gap,
  multiple = FALSE
)

diffid(
  age,
  id,
  data = parent.frame(),
  lag = 1,
  differences = 1,
  sort = FALSE,
  keepNA = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>vector of ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>numeric, the required positive time gap between selected ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric, the positive tolerance around the gap (default <code>0.1 * gap</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiple</code></td>
<td>
<p>logical, whether or not to return multiple solutions
when found (default FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>factor of subject ids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame optionally containing <code>age</code> and <code>id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>an integer indicating which lag to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>differences</code></td>
<td>
<p>an integer indicating the order of the difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>a logical indicating whether to first sort by id and age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepNA</code></td>
<td>
<p>a logical indicating whether to keep generated NAs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>timegap</code> calculates all possible differences between pairs of ages,
expresses them as integer multiples of <code>gap</code>, restricts them to
those within tolerance and identifies those providing the longest sequences.
For sequences of the same length, those with the smallest standard deviation
of successive differences (modulo the time interval) are selected.
</p>


<h3>Value</h3>

<p>With <code>timegap</code>, for unique solutions, or multiple solutions with
<code>multiple FALSE</code>, a vector of indices named with <code>age</code>. With
<code>timegap.id</code> the subject vectors are returned invisibly, concatenated.
</p>
<p>With <code>multiple TRUE</code>, where there are multiple solutions
they are returned as a named matrix.
</p>
<p><code>diffid</code> returns <code>diff(age)</code> applied within <code>id</code>.
With <code>keepNA</code> TRUE a suitable number of <code>NA</code>s are added at the end,
while if FALSE all <code>NA</code>s are omitted.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(heights)

## bin age into 1-year groups by id
## gives multiple measurements per id per year
with(heights, table(floor(age), id))

## now select heights measured multiples of 1 year apart
(tg1 &lt;- timegap.id(age, id, heights, 1))

## no more than one measurement per id per year
with(heights[tg1, ], table(floor(age), id))

## most time intervals close to 1 year
summary(diffid(age, id, heights[tg1, ], lag=1))
</code></pre>


</div>