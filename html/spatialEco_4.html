<div class="container">

<table style="width: 100%;"><tr>
<td>aspline.downscale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Raster Downscale using adaptive regression splines</h2>

<h3>Description</h3>

<p>Downscales a raster to a higher resolution raster multivariate adaptive
regression splines (MARS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">aspline.downscale(
  x,
  y,
  add.coords = TRUE,
  keep.model = FALSE,
  grid.search = FALSE,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A terra SpatRaster object representing independent variable(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A terra SpatRaster object representing dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.coords</code></td>
<td>
<p>(FALSE/TRUE) Add spatial coordinates to model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.model</code></td>
<td>
<p>(FALSE/TRUE) Keep MARS model (earth class object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.search</code></td>
<td>
<p>(FALSE/TRUE) perform a hyper-parameter grid se</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>(FALSE/TRUE) Plot results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to earth</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses Multivariate Adaptive Regression Splines, to downscale a raster based
on higher-resolution or more detailed raster data specified as covariate(s). This is similar
to the raster.downsample function which uses a robust regression and is a frequentest model for
fitting linear asymptotic relationships whereas, this approach is for fitting nonparametric
functions and should be used when the distributional relationship are complex/nonlinear.
Using add.coords adds spatial coordinates to the model, including creating the associated
rasters for prediction.
</p>


<h3>Value</h3>

<p>A list object containing:
</p>

<ul>
<li>
<p> downscale         Downscaled terra SpatRaster object
</p>
</li>
<li>
<p> GCV Generalized   Cross Validation (GCV)
</p>
</li>
<li>
<p> GRSq              Estimate of the predictive power
</p>
</li>
<li>
<p> RSS               Residual sum-of-squares (RSS)
</p>
</li>
<li>
<p> RSq               R-square
</p>
</li>
<li>
<p> model             earth MARS model object (if keep.model = TRUE)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jeffrey S. Evans  <a href="mailto:jeffrey_evans@tnc.org">jeffrey_evans@tnc.org</a>
</p>


<h3>References</h3>

<p>Friedman (1991) Multivariate Adaptive Regression Splines (with discussion)
Annals of Statistics 19(1):1â€“141
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (require(geodata, quietly = TRUE)) {
library(terra)
library(geodata)

# Download example data (requires geodata package)
  elev &lt;- elevation_30s(country="SWZ",  path=tempdir())
    slp &lt;- terrain(elev, v="slope")
	  x &lt;- c(elev,slp)
        names(x) &lt;- c("elev","slope")
  tmax &lt;- worldclim_country(country="SWZ", var="tmax", 
                                     path=tempdir())
    tmax &lt;- crop(tmax[[1]], ext(elev))
	  names(tmax) &lt;- "tmax"
	  
tmax.ds &lt;- aspline.downscale(x, tmax, add.coords=TRUE, keep.model=TRUE)
  plot(tmax.ds$model) 

  # plot prediction and parameters	
  opar &lt;- par(no.readonly=TRUE)
    par(mfrow=c(2,2))
      plot(tmax, main="Original Temp max")
      plot(x[[1]], main="elevation")
      plot(x[[2]], main="slope")
      plot(tmax.ds$downscale, main="Downscaled Temp max")
  par(opar)

} else { 
  cat("Please install geodata package to run example", "\n")
}


</code></pre>


</div>