<div class="container">

<table style="width: 100%;"><tr>
<td>kriging_rss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Distribution of z-scores of Variant j Given Other z-scores, and Detect Possible Allele Switch Issue</h2>

<h3>Description</h3>

<p>Under the null, the rss model with regularized LD
matrix is <code class="reqn">z|R,s ~ N(0, (1-s)R + s I))</code>. We use a mixture of
normals to model the conditional distribution of z_j given other z
scores, <code class="reqn">z_j | z_{-j}, R, s ~ \sum_{k=1}^{K} \pi_k
  N(-\Omega_{j,-j} z_{-j}/\Omega_{jj}, \sigma_{k}^2/\Omega_{jj})</code>,
<code class="reqn">\Omega = ((1-s)R + sI)^{-1}</code>, <code class="reqn">\sigma_1, ..., \sigma_k</code>
is a grid of fixed positive numbers. We estimate the mixture
weights <code class="reqn">\pi</code>  We detect the possible allele switch issue
using likelihood ratio for each variant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kriging_rss(
  z,
  R,
  n,
  r_tol = 1e-08,
  s = estimate_s_rss(z, R, n, r_tol, method = "null-mle")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A p-vector of z scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A p by p symmetric, positive semidefinite correlation
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size. (Optional, but highly recommended.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_tol</code></td>
<td>
<p>Tolerance level for eigenvalue check of positive
semidefinite matrix of R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>an estimated s from <code>estimate_s_rss</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing a ggplot2 plot object and a table. The plot
compares observed z score vs the expected value. The possible allele
switched variants are labeled as red points (log LR &gt; 2 and abs(z) &gt; 2).
The table summarizes the conditional distribution for each variant
and the likelihood ratio test. The table has the following columns:
the observed z scores, the conditional expectation, the conditional
variance, the standardized differences between the observed z score
and expected value, the log likelihood ratio statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See also the vignette, "Diagnostic for fine-mapping with summary
# statistics."
set.seed(1)
n = 500
p = 1000
beta = rep(0,p)
beta[1:4] = 0.01
X = matrix(rnorm(n*p),nrow = n,ncol = p)
X = scale(X,center = TRUE,scale = TRUE)
y = drop(X %*% beta + rnorm(n))
ss = univariate_regression(X,y)
R = cor(X)
attr(R,"eigen") = eigen(R,symmetric = TRUE)
zhat = with(ss,betahat/sebetahat)
cond_dist = kriging_rss(zhat,R,n = n)
cond_dist$plot

</code></pre>


</div>