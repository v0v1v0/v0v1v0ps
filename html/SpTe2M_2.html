<div class="container">

<table style="width: 100%;"><tr>
<td>cv_mspe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation mean squared prediction error</h2>

<h3>Description</h3>

<p>The spatio-temporal covariance function is estimated by the 
weighted moment estimation method in Yang and Qiu (2019). The function 
<code>cv_mspe</code> is developed to select the bandwidths <code>(gt,gs)</code> used 
in the estimation of the spatio-temporal covariance function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_mspe(y, st, gt = NULL, gs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing data of the observed response 
<code class="reqn">y(t,s)</code>, where <code class="reqn">N</code> is the total number of observations over space 
and time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations 
(i.e., (<code class="reqn">s_u</code>,<code class="reqn">s_v</code>)) and times (i.e., <code class="reqn">t</code>) for all the 
observations in <code>y</code>. The three columns of <code>st</code> correspond to 
<code class="reqn">s_u</code>, <code class="reqn">s_v</code> and <code class="reqn">t</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gt</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>gt</code> provided by users; 
default is <code>NULL</code>,  and <code>cv_mspe</code> will choose its own sequence 
if <code>gt=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs</code></td>
<td>
<p>A sequence of spatial kernel bandwidth <code>gs</code> provided by users; 
default is <code>NULL</code>,  and <code>cv_mspe</code> will choose its own sequence 
if <code>gs=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>A matrix containing all the bandwidths 
(<code>gt</code>, <code>gs</code>) provided by users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mspe</code></td>
<td>
<p>The mean squared prediction errors for all the bandwidths 
provided by users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth.opt</code></td>
<td>
<p>The bandwidths <code>(gt, gs)</code> that minimizes the 
mean squared prediction error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mspe.opt</code></td>
<td>
<p>The minimal mean squared prediction error.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2019). Nonparametric Estimation of the Spatio-Temporal 
Covariance Structure. <em>Statistics in Medicine</em>, <strong>38</strong>, 4555-4565.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
gt &lt;- seq(0.3,0.4,0.1); gs &lt;- seq(0.3,0.4,0.1)
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
mspe &lt;- cv_mspe(y.sub,st.sub,gt,gs)
</code></pre>


</div>