<div class="container">

<table style="width: 100%;"><tr>
<td>Spectrum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate frequency spectrum</h2>

<h3>Description</h3>

<p>Estimate the frequency spectrum of the data array together with a 
user-specified confidence level. The output is provided as an array with 
dimensions c(number of frequencies, stats = 3, other margin dimensions of 
data). The 'stats' dimension contains the frequencies at which the spectral 
density is estimated, the estimates of the spectral density, and the 
significance level.<br>
The spectrum estimation relies on an R built-in function <code>spectrum()</code> 
and the confidence interval is estimated by the Monte-Carlo method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Spectrum(data, time_dim = "ftime", alpha = 0.05, ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A vector or numeric array of which the frequency spectrum is 
required. If it's a vector, it should be a time series. If it's an array,
the  dimensions must have at least 'time_dim'. The data is assumed to be  
evenly spaced in time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the dimension along which to 
compute the frequency spectrum. The default value is 'ftime'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric indicating the significance level for the Monte-Carlo
significance test. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric array of the frequency spectrum with dimensions 
c(&lt;time_dim&gt; = number of frequencies, stats = 3, the rest of the 
dimensions of 'data'). The 'stats' dimension contains the frequency values,
the spectral density, and the confidence interval.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load sample data as in Load() example:
example(Load)
ensmod &lt;- MeanDims(sampleData$mod, 2)
spectrum &lt;- Spectrum(ensmod)

for (jsdate in 1:dim(spectrum)['sdate']) {
 for (jlen in 1:dim(spectrum)['ftime']) {
   if (spectrum[jlen, 2, 1, jsdate] &gt; spectrum[jlen, 3, 1, jsdate]) {
     ensmod[1, jsdate, ] &lt;- Filter(ensmod[1, jsdate, ], spectrum[jlen, 1, 1, jsdate])
   }
 }
}
 
PlotAno(InsertDim(ensmod, 2, 1), sdates = startDates)
 

</code></pre>


</div>