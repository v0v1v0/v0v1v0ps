<div class="container">

<table style="width: 100%;"><tr>
<td>musvtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple univariate suvival tests with a set of genes
</h2>

<h3>Description</h3>

<p>Function musvtest performs SKMCresult by an iteration from the specified first 
gene to the specified last gene. The output of musvtest is used to build a 
weight vector for signature survival analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">musvtest(sdata,stn,gn,time="month",status="status",quant=c("No",-0.2,0.2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>

<p>survival and gene-expression data containing patients in row, survival status
for death or recurrence or relapse, survival time such as month, day or year
and a set of genes in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stn</code></td>
<td>

<p>character value specifying the first gene symbol or gene id existed in sdata or
int value specifying column number for the first gene in survival data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gn</code></td>
<td>

<p>character value specifying the last gene symbol or gene id existed in sdata or 
int value specifying column number for the last gene in survival data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>string for survival time and may be one of c("day", "month", "year"), depending 
on the clinical data. The default value is "month".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>

<p>string for survival status which is binary variable: 1 for event
occurrence and 0 for no event occurrence. status may be "death","relapse"
or "recurrence", depending on clinical data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>

<p>vector for quantile, low and high values. the low and high values are used to
define or classify low and high expression groups. If quantile is "yes" or 
"YES", then the low and high are non-negative precent values, for example, 
quant=c("yes",0.25,0.75). If quantile is "no", then the low and high values 
are z-scores, the low value may be negative. For example, quant=c("no",-0.2,
0.2). The quantile = "yes" or = "No" may produce different results of survival
analysis. User should carefully choose quantile or no quantile according to
the data. The default values are c("no",-0.2,0.2).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Patient survival status is a binary variable with 1 for an event (such as death)
and 0 for no event(such as alive). Genes have expression values(numeric values),
which are used to calculate z-scores for classifying patients into two groups:
high-expression patients and low-expression patients. SKMCresult performs
univariate Cox proportional hazard survival analyses of patients with
expression values of a specified gene and outputs hazard risk (HR), z-score
and p-value of this specified gene. At first, user can run this function by
performing musvtest to screen genes for prognostic signature by using HRs,
z-scores, and p-values. Once getting a set of genes for signature, user can
perform this function to build a weight vector using
</p>
<p style="text-align: center;"><code class="reqn">w_i=\frac{log_{10}(p_i)}{\sum_{i=1}^g{log_{10}(p_i)}}</code>
</p>

<p>where <code class="reqn">p_i</code> is p-value for Ward-test of gene i. For a patient,
the signature score or expression value is given by weighting expression values
of genes in the signature:
</p>
<p style="text-align: center;"><code class="reqn">y_j=\sum_{i}^g{w_ix_{ij}}</code>
</p>

<p>where <code class="reqn">x_{ij}</code> is expression of gene i in patient j.
</p>


<h3>Value</h3>

<p>output a matrix with n rows for gene name and hazard risk, hazard rate, standard
error, z-value and p-value of each gene.
</p>


<h3>Note</h3>

<p>All inputting parameters are not sensitive to upper or lower. That is, user can
input upper or lower string or letter. For example, both time ="MONTH" or time =
"month" work.
</p>


<h3>Author(s)</h3>

<p>Yuan-De Tan<br><a href="mailto:yxt477@med.miami.edu">yxt477@med.miami.edu</a><br><a href="mailto:tanyuande@gmail.com">tanyuande@gmail.com</a>
Yuguang Ban <br><a href="mailto:Yuguang.ban@med.miami.edu">Yuguang.ban@med.miami.edu</a>
</p>


<h3>See Also</h3>

<p><code>SKMCresult</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(GSE50081)
res&lt;-musvtest(sdata=GSE50081,stn=3500,gn=3506,time="month",status="status")
#res
#              Gene Hazad risk hazard rate standard error    z-value     p-value
#3500  X209170_s_at -0.6510414   0.5215024      0.3133664 -2.0775721 0.037748792
#3501   X1556325_at -0.6041918   0.5465159      0.3507459 -1.7225913 0.084962455
#3502    X228915_at -0.4992865   0.6069636      0.3394520 -1.4708606 0.141328818
#3503 X1555216_a_at -0.5465844   0.5789238      0.3143044 -1.7390290 0.082029656
#3504  X203548_s_at -0.2004345   0.8183751      0.3018504 -0.6640193 0.506677970
#3505    X205433_at -1.3528063   0.2585138      0.4134465 -3.2720229 0.001067809
#3506    X209614_at -0.8389441   0.4321666      0.3905470 -2.1481262 0.031703733
</code></pre>


</div>