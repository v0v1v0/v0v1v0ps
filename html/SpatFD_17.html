<div class="container">

<table style="width: 100%;"><tr>
<td>ggmap_KS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Map plot of a 'KS_pred' object
</h2>

<h3>Description</h3>

<p>A visualization of the predicted kriging in a colormap for a specific window time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggmap_KS(KS, map_path, window_time = NULL, method = "lambda", map_n = 5000,
zmin = NULL, zmax = NULL, graph = "plotly")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>KS</code></td>
<td>

<p>Object of class 'KS_pred'. Not NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_path</code></td>
<td>

<p>Character indicating the directory of the shape file or an object of class SpatialPolygonDataFrame load from a shape file by <code>rgdal::readOGR</code>. If NULL the prediction is plot in a rectangle. Default NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_time</code></td>
<td>

<p>numeric. Vector of window time to see the spatial prediction. If NULL choose the range values of KS$SFD. Default NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character. "lambda" or "scores". Default "lambda".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_n</code></td>
<td>

<p>numeric. Number of points to sample in the map. Default 5000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zmin</code></td>
<td>

<p>numeric. Minimum value predicted for the color scale. If NULL is chosen from the data. Default NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zmax</code></td>
<td>

<p>numeric. Maximum value predicted for the color scale. If NULL is chosen from the data. Default NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>

<p>character. "plotly" or "gg" whether to use plotly or ggplot graphics. Default "plotly".
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Plotly or ggplot image
</p>


<h3>Author(s)</h3>

<p>Diego Sandoval <a href="mailto:diasandovalsk@unal.edu.co">diasandovalsk@unal.edu.co</a>.
</p>


<h3>References</h3>

<p>Bohorquez, M., Giraldo, R., &amp; Mateu, J. (2016). Multivariate functional random fields: prediction and optimal sampling. Stochastic Environmental Research and Risk Assessment, 31, pages53â€“70 (2017).
</p>


<h3>See Also</h3>

<p><code>KS_scores_lambdas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gstat)
data(AirQualityBogota)
newcoorden=data.frame(X=seq(93000,105000,len=100),Y=seq(97000,112000,len=100))

SFD_PM10 &lt;- SpatFD(PM10, coords = coord[, -1], basis = "Bsplines", nbasis = 17,
norder=5, lambda = 0.00002, nharm=3)

modelos &lt;- list(vgm(psill = 2634000, "Exp", range = 2103.25, nugget =  0),
                vgm(psill = 101494.96, "Exp", range = 1484.57, nugget = 0),
                vgm(psill =53673, "Exp", range = 42406, nugget =  0))

KS_SFD_PM10_both &lt;- KS_scores_lambdas(SFD_PM10, newcoorden, method = "both",
model = modelos)

ggmap_KS(KS_SFD_PM10_both,
         map_path = map,
         window_time = c(5108,5109,5110),
         method = "scores",
         zmin = 50,
         zmax = 120)
         
</code></pre>


</div>