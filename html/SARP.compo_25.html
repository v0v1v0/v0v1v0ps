<div class="container">

<table style="width: 100%;"><tr>
<td>distances</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate the distribution of maximal minimal distances in a random graph
</h2>

<h3>Description</h3>

<p>This function simulates the distribution of the maximum of the minimal
distances between nodes of a random graph, for a given cut-off
threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distrib.distances( n.genes,
                   taille.groupes = c( 10, 10 ), masque,
                   me.composition = 0, cv.composition = 1, en.log = TRUE,
                   seuil.p = 0.05,
                   B = 3000, conf.level = 0.95,
                   f.p = student.fpc, frm = R ~ Groupe,
                   n.coeurs = 1 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The confidence level for the exact confidence
intervals of estimated probabilities of maximal minimal distances in
the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.genes</code></td>
<td>
<p>Number of components in the system (of nodes in the
total graph). Ignored if <code>me.composition</code> is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>me.composition</code></td>
<td>
<p>The expected median quantity of each component,
in the log scale. Can be either a single value, used for two
conditions and <code>n.genes</code> components (hence, assuming the null
hypothesis that no change occurs), or a matrix with one row by
experimental condition and one column by component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.composition</code></td>
<td>
<p>The expected coefficient of variation of the
quantified amounts. Should be either a single value, that will be
used for all components and all conditions, or a matrix with the
same structure than <code>me.composition</code>: one row for each
condition, one column for each component, in the same order and with
the same names.  Coefficients of variations are expected in the
amount scale, in raw form (that is, give 0.2 for a 20% coefficient
of variation)</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>en.log</code></td>
<td>
<p>If <code>TRUE</code>, the values in the matrices are given in
the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taille.groupes</code></td>
<td>
<p>The sample size for each condition. Unused if
<code>masque</code> is given.  If a single value, it will be used for all
conditions.  Otherwise, should have the same length that the number
of rows in the provided matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>masque</code></td>
<td>
<p>A data.frame that will give the dataset design for a
given experiment. Should contain at least one column containing the
names of the conditions, with values being in the conditions names
in  <code>composition</code>.  If not provided, it is generated from
<code>taille.groupes</code> as a single column named ‘Condition’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.p, frm</code></td>
<td>
<p>The function used to analyse the dataset, and its
parameter. See <code>creer.Mp</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seuil.p</code></td>
<td>
<p>The p-value cut-off to be used when creating the
graph. Should be between 0 and 1. See <code>grf.Mp</code> for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of simulations to be done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.coeurs</code></td>
<td>
<p>The number of CPU cores to use to parallelize the
simulation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In an undirected graph, minimal distance between two nodes is the
minimal number of edges to cross to go from one node to the other. The
maximal minimal distance is the largest of all possible minimal
distances in a given graph.
</p>
<p>The function simulates the distribution of the maximal minimal
distance in a graph whose edges were removed according to the
specified p-value cut-off. To avoid infinite distances, these
distances are computed in the largest connected component of the
graph.
</p>
<p>In the observed graph, nodes that are at a largest minimal distance
than probable maximal minimal distances may signal components belonging to
different sets, that could not be disconnected because of some nodes
having intermediate changes.
</p>


<h3>Value</h3>

<p>A 4-columns data.frame, with additional attributes giving the number
of simulations (<code>Nombre.simulations</code>) and their results
(<code>Tirages</code>).  The first column contains the maximal minimal
distances, the second contains their observed frequencies in the
simulated datasets, the third and fourth contain the limits of the
confidence interval of the corresponding probability.
</p>
<p>Confidence intervals are exacts, using the Clopper-Pearson method.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>distances</code>, in package igraph, to compute the matrix of all
minimal distances of a graphe.
</p>
<p><code>creer.Mp</code> and <code>grf.Mp</code>, which are used
internally, for details about analysis functions and p-value cutoff.
</p>


</div>