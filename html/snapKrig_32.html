<div class="container">

<table style="width: 100%;"><tr>
<td>sk_pars_update</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert covariance parameter list to/from vectorized form</h2>

<h3>Description</h3>

<p>Converts parameter list <code>pars</code> to vector <code>p</code> and back again. A convenience function for
numerical optimization where objective functions accept numeric vectors only.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sk_pars_update(
  pars,
  p = NULL,
  iso = FALSE,
  eps_scaled = FALSE,
  na_omit = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list of kernel parameters (in form understood by <code>sk_pars_make</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric vector (optional) kernel parameters to update in <code>pars</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iso</code></td>
<td>
<p>logical, indicating to treat y and x kernel parameters as equal (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps_scaled</code></td>
<td>
<p>logical, indicates to drop partial sill from input/output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_omit</code></td>
<td>
<p>logical, toggles handling of <code>NA</code>s (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>p</code> is not supplied, the function un-lists the numeric values of <code>pars</code>, returning
them as a vector. When <code>na_omit=TRUE</code>, only the non-NA values are returned; and when
<code>iso=TRUE</code> the x kernel parameters are also omitted from the output vector.
</p>
<p>When <code>p</code> is supplied, the function copies its values to the corresponding entries in
<code>pars</code>, returning the result as a list. In this case, when <code>na_omit=TRUE</code>, only the
NA entries of <code>pars</code> are filled; and when <code>iso=TRUE</code>, parameters for the y kernel
are recycled to fill entries for the x kernel.
</p>
<p>The order returned (and expected in <code>p</code>, if supplied) is:
</p>
<p>'eps', 'psill', 'y.rho', ('y.kap'), 'x.rho', ('x.kap')
</p>
<p>where 'y.kap' and 'x.kap' are omitted in kernels without shape parameters (see
<code>sk_corr</code>). Only the order matters here, as names are ignored in <code>p</code>.
</p>
<p>With <code>na_omit=FALSE</code>, <code>p</code> should have length 3-6, the same as the vector returned by
<code>sk_pars_update(pars)</code>; NAs in <code>p</code> are copied over in this case, effectively inverting
the vectorization.
</p>
<p>With <code>na_omit=TRUE</code>, values in <code>p</code> are copied only to the NA entries of <code>pars</code>; ie the
length of <code>p</code> should equal the number of NA entries in <code>pars</code> (less any redundant x
kernel parameters when <code>iso=TRUE</code>). Note that this does NOT invert the vectorization
<code>p=sk_pars_update(pars, na_omit=TRUE)</code>, which returns non-NA entries of <code>pars</code>.
</p>


<h3>Value</h3>

<p>numeric vector of parameters, or, if <code>p</code> is supplied, the updated <code>pars</code> list
</p>


<h3>See Also</h3>

<p>Other parameter managers: 
<code>sk_bds()</code>,
<code>sk_fit()</code>,
<code>sk_kp()</code>,
<code>sk_pars_make()</code>,
<code>sk_pars()</code>,
<code>sk_to_string()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># initialize a parameter list and pass to sk_pars_update
k = c('gau', 'mat')
pars_empty = sk_pars_make(k)
sk_pars_update(pars_empty)

# pars can be a character vector passed directly to sk_pars_update
sk_pars_update(k)

# single kernel definitions are duplicated
sk_pars_update('mat')

# example parameter vector to illustrate ordering
p_update = seq(5)

# (inverse) pass a modified vector back to the function to update pars
pars_filled = sk_pars_update(pars_empty, p_update)
print(pars_filled)

# p_update is unchanged by round trip
sk_pars_update(pars_filled)

# NAs in pars can be filtered out with na_omit=TRUE
pars_filled$eps = NA
pars_filled$x$kp[1] = NA
sk_pars_update(pars_filled)
sk_pars_update(pars_filled, na_omit=TRUE)

# when updating parameters, NAs in pars identify parameters to receive the new values
p_update = abs(stats::rnorm(2))
sk_pars_update(pars_filled, p_update, na_omit=TRUE)

# when na_omit=FALSE, all parameters in pars are updated
p_update = stats::rnorm(5)
sk_pars_update(pars_filled, p_update)

# iso=TRUE is for when x kernel parameters are assigned values from the y kernel
pars_empty = sk_pars_make('mat')
p_update = seq(length(sk_pars_update(pars_empty, iso=TRUE)))
pars_filled = sk_pars_update(pars_empty, p_update, iso=TRUE)
print(pars_filled)

# notice NA shape parameter in x ignored while NA in eps is copied
pars_filled$eps = NA
pars_filled$x$kp[2] = NA
sk_pars_update(pars_filled, iso=TRUE)

# update calls with iso=TRUE should omit the x kernel parameters (p is shorter)
sk_pars_update(pars_filled, seq(4), iso=TRUE)

# if eps_scaled=TRUE, psill is ignored (useful for when eps is scaled by psill)
sk_pars_update(pars_filled)
sk_pars_update(pars_filled, eps_scaled=TRUE)

# notice value of psill not updated
sk_pars_update(pars_filled, -seq(5), eps_scaled=TRUE)

# compare/combine with other modes
pars_filled$y$kp[2] = NA
sk_pars_update(pars_filled)
sk_pars_update(pars_filled, -seq(2), iso=TRUE, na_omit=TRUE)
sk_pars_update(pars_filled, -seq(4), iso=TRUE)
sk_pars_update(pars_filled, -seq(3), iso=TRUE, eps_scaled=TRUE)
sk_pars_update(pars_filled, -seq(3), na_omit=TRUE)

</code></pre>


</div>