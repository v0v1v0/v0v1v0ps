<div class="container">

<table style="width: 100%;"><tr>
<td>PrenticeGloeckler.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression for Grouped Survival Data Function</h2>

<h3>Description</h3>

<p>This function calculates the estimated hazard ratio for grouped survival data described in the reference below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PrenticeGloeckler.test(time,event,grp,r)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>vector of times to event or censoring. The times are assumed to be integers from 1, 2, .., r corresponding to the discrete time points or the continuous time intervals A1, ..., Ar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>vector of binary status indicator variables (0 = censored at the start of the interval, 1 = event during the interval)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>vector of binary group indicators (0 or 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of time points or intervals</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hazard functions and hazard ratio are estimated for grouped survival data.
</p>


<h3>Value</h3>

<p>A list consisting of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>The estimated coefficient (log hazard ratio) found by maximizing the likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indx</code></td>
<td>
<p>vector of time points where the hazard functions are estimated. The subset of <code>1,...,r-1</code> with at least one event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>numeric vector with the same length as <code>indx</code> representing the log(-log(hazard rate)) in the control group for time points in the vector <code>indx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad1</code></td>
<td>
<p>gradient evaluated at <code>(gamma[indx],ceofficient)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of time points or time intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess1</code></td>
<td>
<p>hessian matrix evaluated at the maximum likelihood estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll0</code></td>
<td>
<p>log-likelihood evaluated at ceofficient=0. includes attributes <code>"gradient"</code> and <code>"hessian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll1</code></td>
<td>
<p>log-likelihood at maximum likeohood estimate.  includes attributes <code>"gradient"</code> and <code>"hessian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.test</code></td>
<td>
<p>value of the score test statistic for testing coefficient=0 (see reference).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr.test</code></td>
<td>
<p>value of the likelihood ratio test statistic, 2*(ll0-ll1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald.test</code></td>
<td>
<p>value of the Wald test statistic; the estimated coefficient divided by the square root of the estimated variance.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>John Lawrence</p>


<h3>References</h3>

<p>Prentice, R. L. and Gloeckler, L.A. (1978). Regression analysis of grouped survival data with application to breast cancer data. <em>Biometrics</em>, 57 â€“ 67
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
nsim=1
n=250
tn=2*n
k=0.1*tn
betaef=rep(0,nsim)
betapg=rep(0,nsim)
cens=rep(1,2*n)
trt=c(rep(0,n),rep(1,n))

for (i in 1:nsim) {
  x=rexp(tn,1)
  x[(n+1):tn]=x[(n+1):tn]/2
  m1=max(x[(n+1):tn])
  x=ceiling(x*(k-1)/m1)
  x[(n+1):tn]=pmin(x[(n+1):tn],k-1)
  x[1:n]=pmin(x[1:n],k)
  pg1=PrenticeGloeckler.test(x,cens,trt,k)
  betapg[i]=pg1$coefficient
  betaef[i]=survival::coxph(survival::Surv(x,cens)~trt,ties="efron")$coef}
mean(betaef)
mean(betapg)
</code></pre>


</div>