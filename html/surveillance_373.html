<div class="container">

<table style="width: 100%;"><tr>
<td>stsplot_time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Time-Series Plots for <code>"sts"</code> Objects
</h2>

<h3>Description</h3>

<p>These are the <code>plot</code> variants of <code>type=observed~time|unit</code>,
<code>type=observed~time</code>, and <code>type=alarm~time</code>
for <code>"sts"</code> objects (see the central <code>"sts"</code>
<code>plot</code>-method for
an overview of plot types).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stsplot_time(x, units=NULL,
             as.one=FALSE, same.scale=TRUE, par.list=list(), ...)

stsplot_time1(x, k=1, ylim=NULL,
              axes=TRUE, xaxis.tickFreq=list("%Q"=atChange),
              xaxis.labelFreq=xaxis.tickFreq, xaxis.labelFormat="%G\n\n%OQ",
              epochsAsDate=x@epochAsDate,
              xlab="time", ylab="No. infected", main=NULL,
              type="s", lty=c(1,1,2), col=c(NA,1,4), lwd=c(1,1,1),
              outbreak.symbol=list(pch=3, col=3, cex=1, lwd=1),
              alarm.symbol=list(pch=24, col=2, cex=1, lwd=1),
              legend.opts=list(),
              dx.upperbound=0L, hookFunc=function(){},
              .hookFuncInheritance=function() {}, ...)

stsplot_alarm(x, lvl=rep(1,ncol(x)),
              xaxis.tickFreq=list("%Q"=atChange),
              xaxis.labelFreq=xaxis.tickFreq, xaxis.labelFormat="%G\n\n%OQ",
              epochsAsDate=x@epochAsDate,
              xlab="time", ylab="", main=NULL,
              outbreak.symbol=list(pch=3, col=3, cex=1, lwd=1),
              alarm.symbol=list(pch=24, col=2, cex=1, lwd=1),
              cex.yaxis=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"sts"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>optional integer or character vector to select the units (=columns of
<code>observed(x)</code>) to plot. The default is to plot all time series.
If <code>as.one=FALSE</code>, <code>stsplot_time1</code> is called
<code>for (k in units)</code> with <code>mfrow</code> splitting (see <code>par.list</code>).
Note that if there are too many <code>units</code>, the default <code>mfrow</code>
setting might lead to the error “figure margins too large”
(meaning that the units do not fit onto a single page).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.one</code></td>
<td>
<p>logical indicating if all time series should be plotted
in a single frame (using <code>matplot</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.scale</code></td>
<td>
<p>logical indicating if all time series should be
plotted with the same <code>ylim</code>. Default is to do so. Only
relevant for multivariate plots (<code>ncol(x) &gt; 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.list</code></td>
<td>
<p>a list of arguments delivered to a call of
<code>par</code> to set graphical parameters before plotting.
The <code>mfrow</code> splitting is handled per default. Afterwards,
the <code>par</code>ameters are reverted to their original values.
Use <code>par.list=NULL</code> to disable the internal <code>par</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the unit to plot, i.e., an element of <code>1:ncol(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the y limits of the plot(s). Ignored if
<code>same.scale=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>a logical value indicating whether both axes should be drawn
on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.tickFreq,xaxis.labelFreq,xaxis.labelFormat</code></td>
<td>

<p>arguments for <code>addFormattedXAxis</code>
if <code>epochsAsDate=TRUE</code>.
Use <code>xaxis.labelFormat=NULL</code> to get a standard x-axis
(without date labels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochsAsDate</code></td>
<td>
<p>Boolean indicating whether to treat the epochs as
Date objects (or to transform them to dates such that the new x-axis
formatting is applied).
Default: Value of the <code>epochAsDate</code> slot of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a title for the x axis. See <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a title for the y axis. See <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>an overall title for the plot: see 'title'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of plot to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>vector of length 3 specifying the line type for the three
lines in the plot – see <code>col</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of length 3 specifying the color to use in the
plot. The first color is the fill color of the polygons for the
counts bars (<code>NA</code> for unfilled), the 2nd element denotes their
border color, the 3rd element is the color of the <code>upperbound</code>
plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Vector of length 3 specifying the line width of the three
elements to plot. See also the <code>col</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alarm.symbol</code></td>
<td>
<p>a list with entries <code>pch</code>, <code>col</code>,
<code>cex</code> and <code>lwd</code> specifying the appearance of the alarm
symbol in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outbreak.symbol</code></td>
<td>
<p>a list with entries <code>pch</code>, <code>col</code>,
<code>cex</code> and <code>lwd</code> specifying the appearance of the outbreak
symbol in the plot.  Currently ignored by <code>stsplot_alarm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.opts</code></td>
<td>
<p>a list of arguments for the <code>legend</code>.
If <code>missing(legend.opts)</code> (i.e., not explicitly
specified), the default legend will only be added if the <code>"sts"</code> object
contains outbreaks, alarms, or upperbounds.
The default legend options are
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p><code>"top"</code></p>
</dd>
<dt><code>legend</code></dt>
<dd>
<p><code>c("Infected","Threshold","Outbreak","Alarm")[included]</code></p>
</dd>
<dt><code>lty,lwd,pch,col</code></dt>
<dd>
<p>the corresponding graphical settings
of the included elements</p>
</dd>
</dl>
<p>where individual elements are only <code>included</code> in the legend if
they are plotted (except for alarms, which are also included if
upperbounds exist).
To disable the legend, use <code>legend.opts=NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx.upperbound</code></td>
<td>
<p>horizontal change in the plotting of the
upperbound line. Sometimes it can be convenient to offset this line
a little for better visibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvl</code></td>
<td>
<p>A vector of length <code>ncol(x)</code>, which is used to
specify the hierarchy level for each time series in the sts object
for alarm plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.yaxis</code></td>
<td>
<p>The magnification to be used for y-axis annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hookFunc</code></td>
<td>
<p>a function that is called after all the basic plotting
has be done, i.e., it is not possible to control formatting with
this function. See Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.hookFuncInheritance</code></td>
<td>
<p>a function which is altered by sub-classes
plot method. Do not alter this function manually.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments for the function <code>matplot</code>. If
e.g. <code>xlab</code> or <code>main</code> are provided they overwrite the
default values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The time series plot relies on the work-horse <code>stsplot_time1</code>.
Its arguments are (almost) similar to <code>plot.survRes</code>.
</p>


<h3>Value</h3>

<p><code>NULL</code> (invisibly).
The functions are called for their side-effects.
</p>


<h3>Author(s)</h3>

<p>Michael Höhle and Sebastian Meyer
</p>


<h3>See Also</h3>

<p>There is an <code>autoplot</code>-method, which
implements <a href="https://CRAN.R-project.org/package=ggplot2"><span class="pkg">ggplot2</span></a>-based time-series plots of <code>"sts"</code>
objects.
</p>
<p>The <code>stsplot</code> help page gives an overview of other
types of plots for <code>"sts"</code> objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("ha.sts")
print(ha.sts)

plot(ha.sts, type=observed ~ time | unit)  # default multivariate type
plot(ha.sts, units=c("mitt", "pank"))      # selected units
plot(ha.sts, type=observed ~ time)         # aggregated over all districts

## Hook function example
hookFunc &lt;- function() grid(NA,NULL,lwd=1)
plot(ha.sts, hookFunc=hookFunc)

## another multivariate time series example plotted "as.one"
data("measlesDE")
plot(measlesDE, units=1:2, as.one=TRUE, legend.opts=list(cex=0.8))
## more sophisticated plots are offered by package "xts"
if (requireNamespace("xts"))
    plot(as.xts.sts(measlesDE))

## Use ISO8601 date formatting (see ?strptime) and no legend
data("salmNewport")
plot(aggregate(salmNewport,by="unit"), xlab="Time (weeks)",
     xaxis.tickFreq=list("%m"=atChange,"%G"=atChange),
     xaxis.labelFreq=list("%G"=atMedian),xaxis.labelFormat="%G")

## Formatting also works for daily data (illustrated by artificial
## outbreak converted to sts object via 'linelist2sts')
set.seed(123)
exposureTimes &lt;-  as.Date("2014-03-12") + sample(x=0:25,size=99,replace=TRUE)
sts &lt;- linelist2sts(data.frame(exposure=exposureTimes),
                               dateCol="exposure",aggregate.by="1 day")
## Plot it with larger ticks for days than usual
surveillance.options("stsTickFactors"=c("%d"=1, "%W"=0.33,
                "%V"=0.33, "%m"=1.75, "%Q"=1.25, "%Y"=1.5, "%G"=1.5))
plot(sts,xaxis.tickFreq=list("%d"=atChange,"%m"=atChange),
     xaxis.labelFreq=list("%d"=at2ndChange),xaxis.labelFormat="%d-%b",
     xlab="Time (days)")
</code></pre>


</div>