<div class="container">

<table style="width: 100%;"><tr>
<td>hotbox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Heat Kernel for a Two-Dimensional Rectangle
</h2>

<h3>Description</h3>

<p>Calculate values of the heat kernel in a rectangle
with insulated edges.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hotbox(Xsource, Xquery, sigma,
       ..., W=NULL, squared=FALSE, nmax=20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xsource</code></td>
<td>

<p>Point pattern of sources of heat.
Object of class <code>"ppp"</code>
or convertible to a point pattern using <code>as.ppp(Xsource, W)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xquery</code></td>
<td>

<p>Locations where the heat kernel value is required.
An object of class <code>"ppp"</code> specifying query location points,
or an object of class <code>"im"</code> or <code>"owin"</code> specifying a
grid of query points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Bandwidth for kernel. A single number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Extra arguments (passed to <code>as.mask</code>)
controlling the
pixel resolution of the result, when <code>Xquery</code> is a window
or an image.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>Window (object of class <code>"owin"</code>) used to define the spatial domain
when <code>Xsource</code> is not of class <code>"ppp"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>

<p>Logical value indicating whether to take the square
of each heat kernel value, before summing over the source points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>

<p>Number of terms to be used from the infinite-sum expression
for the heat kernel. A single integer.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the sum of heat kernels
associated with each of the source points, evaluating them
at each query location.
</p>
<p>The window for evaluation of the heat kernel must be a rectangle.
</p>
<p>The heat kernel in any region can be expressed as an infinite sum of terms
associated with the eigenfunctions of the Laplacian. The heat kernel
in a rectangle is the product of heat kernels for
one-dimensional intervals on the horizontal and vertical axes. This
function uses <code>hotrod</code> to compute the
one-dimensional heat kernels, truncating the infinite sum to the
first <code>nmax</code> terms, and then calculates the two-dimensional heat
kernel from each source point to each query location. If
<code>squared=TRUE</code> these values are squared. Finally the values are
summed over all source points to obtain a single value for each
query location.
</p>


<h3>Value</h3>

<p>If <code>Xquery</code> is a point pattern,
the result is a numeric vector with one entry for each query point.
</p>
<p>If <code>Xquery</code> is an image or window, the result is
a pixel image.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley and Greg McSwiggan.
</p>


<h3>References</h3>

<p>Baddeley, A., Davies, T., Rakshit, S., Nair, G. and McSwiggan, G. (2021)
Diffusion smoothing for spatial point patterns.
<em>Statistical Science</em>, in press.
</p>


<h3>See Also</h3>

<p><code>densityHeat.ppp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  X &lt;- runifpoint(10)

  Y &lt;- runifpoint(5)
  hotbox(X, Y, 0.1)

  plot(hotbox(X, Window(X), 0.1))
  points(X, pch=16)
</code></pre>


</div>