<div class="container">

<table style="width: 100%;"><tr>
<td>spml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial Panel Model by Maximum Likelihood</h2>

<h3>Description</h3>

<p>Maximum likelihood (ML) estimation of spatial panel models, possibly with fixed or random effects.</p>


<h3>Usage</h3>

<pre><code class="language-R">spml(formula, data, index=NULL, listw, listw2=listw, na.action,
                 model=c("within","random","pooling"),
                 effect=c("individual","time","twoways"),
                 lag=FALSE, spatial.error=c("b","kkp","none"),
                 ...)
## S3 method for class 'splm_ML'
impacts(obj, listw = NULL,
                         time = NULL, ...,
                         tr = NULL, R = 200,
                         type = "mult",
                         empirical = FALSE, Q = NULL)
## S3 method for class 'splm_GM'
impacts(obj, ..., tr=NULL, 
                            R=NULL, listw=NULL,
                            type = "mult",
                            time = NULL,
                            evalues=NULL, tol=1e-6, 
                            empirical=FALSE, Q=NULL, 
                            KPformula = FALSE, prt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. A data frame containing the variables
in the model. When the object is a <code>data.frame</code>, the first two columns shall contain the indexes, unless otherwise specified. See <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>an object of class <code>listw</code> or a <code>matrix</code>. It represents the spatial weights to be used in estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw2</code></td>
<td>
<p>an object of class <code>listw</code> or a
<code>matrix</code>. Second of set spatial weights for estimation, if
different from the first (e.g., in a 'sarar' model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>see <span class="pkg">spdep</span> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>one of <code>c("within", "random", "pooling").</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>one of <code>c("individual","time","twoways")</code>; the
effects introduced in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code>, a spatial lag of the dependent variable is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial.error</code></td>
<td>
<p>one of <code>c("b","kkp","none")</code>. The type of
spatial error in the specification, if any. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional argument to pass over to other functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>fitted model object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>??time??</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>A vector of traces of powers of the spatial weights matrix created using 'trW', for approximate impact measures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>If given, simulations are used to compute distributions for the impact measures, returned as 'mcmc' objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Either "mult" (default) for powering a sparse matrix (with moderate or larger N, the matrix becomes dense, and may lead to swapping), or "MC" for Monte Carlo simulation of the traces (the first two simulated traces are replaced by their analytical equivalents), or "moments" to use the looping space saving algorithm proposed by Smirnov and Anselin (2009) - for "moments", 'W' must be symmetric, for row-standardised weights through a similarity transformation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>Argument passed to 'mvrnorm' (default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>default NULL, else an integer number of cumulative power series impacts to calculate if 'tr' is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalues</code></td>
<td>
<p>vector of eigenvalues of spatial weights matrix for impacts calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Argument passed to 'mvrnorm'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KPformula</code></td>
<td>
<p>not yet implemented</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prt</code></td>
<td>
<p>not yet implemented</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The models are estimated by two-step Maximum Likelihood.
Further optional parameters to be passed on to the estimator may be:
pvar: if <code>TRUE</code> the <code>pvar</code> function is called
hess: if <code>TRUE</code> use numerical Hessian instead of GLS for the
standard errors of the estimates
quiet: if <code>FALSE</code> report function and parameters values during
optimization
initval: one of <code>c("zeros", "estimate")</code>, the initial values for
the parameters. If <code>"zeros"</code> a vector of zeros is used. if
<code>"estimate"</code> the initial values are retreived from the estimation
of the nested specifications. Alternatively, a numeric vector can be
specified.
x.tol: Tolerance. See <code>nlminb</code> for details.
rel.tol: Relative tolerance. See <code>nlminb</code> for details.
</p>


<h3>Value</h3>

<p>An object of class <code>"splm"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>coefficients estimate of the model parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arcoef</code></td>
<td>
<p>the coefficient for the spatial lag on <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errcomp</code></td>
<td>
<p>the estimates of the error variance components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>the asymptotic variance covariance matrix of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.arcoef</code></td>
<td>
<p>the asymptotic variance of the
estimated spatial lag parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.errcomp</code></td>
<td>
<p>the asymptotic variance covariance matrix of the
estimated error covariance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>'random effects ML'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the model residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted values, calculated as <code class="reqn">\hat{y}=X \hat{\beta}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>GLS residuals variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the matrix of the data used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to create the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the value of the log likelihood function at the optimum </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>the value of the <code>errors</code> argument</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Baltagi, B.H., Song, S.H., Jung B. and Koh, W. (2007)
Testing panel data regression models with spatial and serial error correlation.
<em>Journal of Econometrics</em>, <b>140</b>, 5-51.
</p>
<p>Millo, G., Piras, G. (2012)
splm: Spatial Panel Data Models in R.
<em>Journal of Statistical Software</em>, <b>47(1)</b>, 1â€“38.
URL http://www.jstatsoft.org/v47/i01/.
</p>


<h3>See Also</h3>

<p><code>spgm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## the two standard specifications (SEM and SAR) one with FE
## and the other with RE:
## fixed effects panel with spatial errors
fespaterr &lt;- spml(fm, data = Produc, listw = spdep::mat2listw(usaww),
                   model="within", spatial.error="b", Hess = FALSE)
summary(fespaterr)
## random effects panel with spatial lag
respatlag &lt;- spml(fm, data = Produc, listw = spdep::mat2listw(usaww),
                   model="random", spatial.error="none", lag=TRUE)
summary(respatlag)
## calculate impact measures
#impac1 &lt;- impacts.splm(respatlag, listw = spdep::mat2listw(usaww, #style = "W"), time = 17)
#summary(impac1, zstats=TRUE, short=TRUE)
</code></pre>


</div>