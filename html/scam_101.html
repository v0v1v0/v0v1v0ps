<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.tismd.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tensor product interaction with decreasing constraint along the first
covariate and unconstrained along the second covariate
</h2>

<h3>Description</h3>

<p>This is a special method function
for creating tensor product bivariate interaction smooths with decreasing constraint in the first covariate,
appropriate when the main effects (and any lower interactions) are also present.
It is built by the <code>mgcv</code> constructor function for smooth terms, <code>smooth.construct</code>, and constructed from a pair of single penalty marginal smooths. This tensor product is specified by model terms such as <code>s(x1,x2,k=c(q1,q2),bs="tismd")</code>.
See example below.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tismd.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A smooth specification object, generated by an <code>s</code> term in a GAM formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or list containing the values of the elements of <code>object$term</code>,
with names given by <code>object$term</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing the knots corresponding to <code>object$term</code>. 
If it is <code>NULL</code> then the knot locations are generated automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In some cases, it is helpful to consider models with a main-effects + interactions structure, for example,
</p>
<p style="text-align: center;"><code class="reqn">f_1(x)  + f_2(z) + f_3(x,z)</code>
</p>

<p>where <code class="reqn">f_1</code> and <code class="reqn">f_2</code> are smooth ‘main effects’ and <code class="reqn">f_3</code> is a smooth ‘interaction’ subject to decreasing constraint wrt <code class="reqn">x</code> (<code class="reqn">f_1</code> can be subject to decreasing constraint). 
</p>
<p>Constructing such functional ANOVA decomposition recognises the fact that the tensor produc basis construction is exactly the same as the construction used for any interaction in a linear model. <code>tismd</code> produce tensor product interactions with decreasing constraint along the first covariate from which the main effects have been excluded, under the assumption that they will be included separately. For example, the <code>~ s(x) + s(z) + s(x,z,bs="tismd")</code> would produce the above main effects + interaction structure. Specifically, the marginal smooths of a tensor product, <code>tismd</code>, are subject to identifiability constraints before constructing the tensor product basis. This results in the interaction smooths that do not include the corresponding main effects. <code>tismd</code> apply SCOP identifiability constraints to the first marginal and sum-to-zero constraints to the second unconstrained marginal. See Wood (2017, section 5.6.3) for ANOVA decompositions of unconstrained smooths.
</p>


<h3>Value</h3>

<p>An object of class <code>"tismd.smooth"</code>. In addition to the usual 
elements of a smooth class documented under <code>smooth.construct</code> of the <code>mgcv</code> library, 
this object contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.ident</code></td>
<td>
<p>A vector of 0's and 1's for model parameter identification: 
1's indicate parameters which will be exponentiated, 0's - otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zc</code></td>
<td>
<p>A matrix of identifiability constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin.bs</code></td>
<td>
<p>A two letter character string indicating the (penalized) smoothing basis to use for the second unconstrained marginal smooth. (eg <code>"cc"</code> for cyclic cubic regression spline).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Natalya Pya <a href="mailto:nat.pya@gmail.com">nat.pya@gmail.com</a>
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Wood S.N. (2017) Generalized Additive Models: An Introduction with R (2nd edition). Chapman
and Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>smooth.construct.tesmd1.smooth.spec</code>
</p>
<p><code>smooth.construct.tismi.smooth.spec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
## tensor product `tismd' example... 
  ## simulating data...
require(scam)
test &lt;- function(x,z){
  -exp(4*x)/(1+exp(4*x))-2*sin(pi*z)-(x+1)^0.6*z
}
set.seed(7)
n &lt;- 600
x &lt;- runif(n)*4-1
z &lt;- runif(n)
xs &lt;- seq(-1,3,length=30); zs &lt;- seq(0,1,length=30)
pr &lt;- data.frame(x=rep(xs,30),z=rep(zs,rep(30,30)))
truth &lt;- matrix(test(pr$x,pr$z),30,30)
f &lt;- test(x,z)
y &lt;- f + rnorm(n)*0.3
bi &lt;- scam(y~ ti(x)+ti(z)+ s(x,z,bs="tismd"))
summary(bi)
old.par &lt;- par(mfrow=c(2,2))
persp(xs,zs,truth);title("truth")
vis.scam(bi);title("tismd")

## fitting with "tesmd1" instead...
bc &lt;- scam(y~s(x,z,bs="tesmd1"))
vis.scam(bc);title("tesmd1")
par(old.par)

plot(bi,pages=1,scheme=2)
plot(bi,select=3,scheme=1,zlim=c(-3,3))
 
## End(Not run)
</code></pre>


</div>