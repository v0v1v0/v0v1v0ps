<div class="container">

<table style="width: 100%;"><tr>
<td>get_index</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a relative biomass/abundance index or a center of gravity</h2>

<h3>Description</h3>

<p>Extract a relative biomass/abundance index or a center of gravity
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_index(
  obj,
  bias_correct = FALSE,
  level = 0.95,
  area = 1,
  silent = TRUE,
  ...
)

get_cog(
  obj,
  bias_correct = FALSE,
  level = 0.95,
  format = c("long", "wide"),
  area = 1,
  silent = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Output from <code>predict.sdmTMB()</code> with <code>return_tmb_object = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias_correct</code></td>
<td>
<p>Should bias correction be implemented <code>TMB::sdreport()</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>Grid cell area. A vector of length <code>newdata</code> from
<code>predict.sdmTMB()</code> or a value of length 1, which will be repeated
internally to match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Silent?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to <code>TMB::sdreport()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>Long or wide.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>get_index()</code>:
A data frame with a columns for time, estimate, lower and upper
confidence intervals, log estimate, and standard error of the log estimate.
</p>
<p>For <code>get_cog()</code>:
A data frame with a columns for time, estimate (center of gravity in x and y
coordinates), lower and upper confidence intervals, and standard error of
center of gravity coordinates.
</p>


<h3>References</h3>

<p>Geostatistical random-field model-based indices of abundance
(along with many newer papers):
</p>
<p>Shelton, A.O., Thorson, J.T., Ward, E.J., and Feist, B.E. 2014. Spatial
semiparametric models improve estimates of species abundance and
distribution. Canadian Journal of Fisheries and Aquatic Sciences 71(11):
1655–1666. <a href="https://doi.org/10.1139/cjfas-2013-0508">doi:10.1139/cjfas-2013-0508</a>
</p>
<p>Thorson, J.T., Shelton, A.O., Ward, E.J., and Skaug, H.J. 2015.
Geostatistical delta-generalized linear mixed models improve precision for
estimated abundance indices for West Coast groundfishes. ICES J. Mar. Sci.
72(5): 1297–1310. <a href="https://doi.org/10.1093/icesjms/fsu243">doi:10.1093/icesjms/fsu243</a>
</p>
<p>Geostatistical model-based centre of gravity:
</p>
<p>Thorson, J.T., Pinsky, M.L., and Ward, E.J. 2016. Model-based inference for
estimating shifts in species distribution, area occupied and centre of
gravity. Methods Ecol Evol 7(8): 990–1002. <a href="https://doi.org/10.1111/2041-210X.12567">doi:10.1111/2041-210X.12567</a>
</p>
<p>Bias correction:
</p>
<p>Thorson, J.T., and Kristensen, K. 2016. Implementing a generic method for
bias correction in statistical models using random effects, with spatial and
population dynamics examples. Fisheries Research 175: 66–74.
<a href="https://doi.org/10.1016/j.fishres.2015.11.016">doi:10.1016/j.fishres.2015.11.016</a>
</p>


<h3>See Also</h3>

<p><code>get_index_sims()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Use a small number of knots for this example to make it fast:
pcod_spde &lt;- make_mesh(pcod, c("X", "Y"), n_knots = 60, type = "kmeans")
m &lt;- sdmTMB(
 data = pcod,
 formula = density ~ 0 + as.factor(year),
 time = "year", mesh = pcod_spde, family = tweedie(link = "log")
)

# make prediction grid:
nd &lt;- replicate_df(qcs_grid, "year", unique(pcod$year))

# Note `return_tmb_object = TRUE` and the prediction grid:
predictions &lt;- predict(m, newdata = nd, return_tmb_object = TRUE)
ind &lt;- get_index(predictions)

if (require("ggplot2", quietly = TRUE)) {
ggplot(ind, aes(year, est)) + geom_line() +
  geom_ribbon(aes(ymin = lwr, ymax = upr), alpha = 0.4)
}

cog &lt;- get_cog(predictions)
cog


</code></pre>


</div>