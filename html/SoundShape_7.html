<div class="container">

<table style="width: 100%;"><tr>
<td>hypo.surf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothetical 3D sound surfaces representing a sample of sound waves</h2>

<h3>Description</h3>

<p>Using the coordinates acquired by <code>eigensound(analysis.type = "threeDshape")</code>, this function creates 3D plots containing hypothetical sound surfaces that represent either the mean shape configuration (consensus), or minimum and maximum deformations relative to Principal Components in a Principal Components Analysis (PCA).
</p>
<p><strong>Note:</strong> The output of <code>hypo.surf</code> must be interpreted along with the ordination of Principal Components (e.g. <code>pca.plot</code>), both featuring the same object used for <code>threeD.out</code> argument. By doing so, <code>hypo.surf</code> enhance the comprehension on how sound shape changed along the ordination plot .
</p>


<h3>Usage</h3>

<pre><code class="language-R">hypo.surf(
  threeD.out = NULL,
  PC = 1,
  flim = c(0, 4),
  tlim = c(0, 0.8),
  x.length = 70,
  y.length = 47,
  log.scale = TRUE,
  f = 44100,
  wl = 512,
  ovlp = 70,
  plot.exp = FALSE,
  plot.as = "jpeg",
  store.at = NULL,
  rotate.Xaxis = 60,
  rotate.Yaxis = 40,
  cex.axis = 0.5,
  cex.lab = 0.9,
  cex.main = 1.1,
  lwd = 0.1,
  xlab = "Time coordinates",
  ylab = "Frequency coordinates",
  zlab = "Amplitude",
  colkey = list(plot = TRUE, cex.clab = 0.9, cex.axis = 0.8, side = 4, length = 0.5,
    width = 0.7, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>threeD.out</code></td>
<td>
<p>the output of <code>eigensound</code> analysis with <code>analysis.type = "threeDshape"</code>. By default: <code>threeD.out = NULL</code> (i.e. output must be specified before ploting)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PC</code></td>
<td>
<p>Principal Component intended for the plot. Alternativaly, it is also possible to create mean shape configuration (consensus) from sample <code>PC = "mean"</code>. By default: <code>PC = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis). Vector with two values in kHz. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code> By default: <code>flim = c(0, 10)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>modifications of the time limits (X-axis). Vector with two values in seconds. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>tlim = c(0, 1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.length</code></td>
<td>
<p>length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the time (X-axis). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>x.length = 70</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.length</code></td>
<td>
<p>length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the frequency (Y-axis). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>y.length = 47</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.scale</code></td>
<td>
<p>a logical. If <code>TRUE</code>, <code>hypo.surf</code> will use a logarithmic scale on the time (X-axis), which is recommeded when the analyzed sounds present great variation on this axis (e.g. emphasize short duration sounds). If <code>FALSE</code>, a linear scale is used instead (same as MacLeod et al., 2013). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>log.scale = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>".wav"</code> files (in Hz). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>f = 44100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>wl = 512</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>ovlp = 70</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.exp</code></td>
<td>
<p>a logical. If <code>TRUE</code>, exports the 3D output plot containing mean shape (<code>PC = "mean"</code>), or minimum and maximum deformations for the desired Principal Component (e.g. <code>PC = 1</code>). Exported plot will be stored on the folder indicated by <code>store.at</code>. By default: <code>plot.exp = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.as</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. <code>plot.as = "jpeg"</code> will generate compressed images for quick inspection; <code>plot.as = "tiff"</code> or <code>"tif"</code> will generate uncompressed high resolution images that can be edited and used for publication. By default: <code>plot.as = "jpeg"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store.at</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. Filepath to the folder where output plots will be stored. Should be presented between quotation marks. By default: <code>store.at = NULL</code> (i.e. user must specify the filepath where plots of hypothetical sound surfaces will be stored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate.Xaxis</code></td>
<td>
<p>rotation of the X-axis. Same as <code>theta</code> from <code>persp3D</code> (<code>plot3D</code> package). By default: <code>rotate.Xaxis = 60</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate.Yaxis</code></td>
<td>
<p>rotation of the Y-axis. Same as <code>phi</code> from <code>persp3D</code> (<code>plot3D</code> package). By default: <code>rotate.Yaxis = 40</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>similarly as in <code>par</code>, magnification to be used for axis values. By default: <code>cex.axis = 0.9</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>similarly as in <code>par</code>, magnification to be used for x and y labels. By default: <code>cex.lab = 1.2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>similarly as in <code>par</code>, magnification to be used for main titles. By default: <code>cex.main = 1.3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Similarly as in <code>par</code>, intended line width for sampling grid. By default: <code>lwd = 0.1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>x</em>-axis. By default: <code>xlab="Time coordinates"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>y</em>-axis. By default: <code>ylab="Frequency coordinates"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>z</em>-axis. By default: <code>zlab="Amplitude"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colkey</code></td>
<td>
<p>Similarly as <code>plot3D</code>, a list with parameters for the color key (legend). By default: <code>colkey = list(plot = TRUE, cex.clab = 0.9, cex.axis = 0.8, side = 4, length = 0.5, width = 0.7, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)</code>. See also <code>colkey</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Some codes from <code>hypo.surf</code> were adapted from <code>plotTangentSpace</code> function (<code>geomorph</code> package version 3.1.2), which is now deprecated and replaced by current functions <code>gm.prcomp</code>, <code>summary.gm.prcomp</code> and <code>plot.gm.prcomp</code>. More specifically, the code chunk related to the acquisition of hypothetical point configurations from each PC (i.e. warp grids) was the same as in <code>plotTangentSpace</code>. However, the hypothetical configurations from <code>plotTangentSpace</code> were plotted along with ordination of PCs, whereas <code>hypo.surf</code> focuses solely on hypothetical 3D surfaces that represent minimum, maximum and mean deformations relative to each PCs.
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code>gm.prcomp</code>, <code>summary.gm.prcomp</code>, <code>plot.gm.prcomp</code>, <code>geomorph</code>, <code>eigensound</code>, <code>pca.plot</code>
</p>
<p>Useful links:
</p>

<ul>
<li>
<p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li>
<p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(eig.sample)

# PCA using three-dimensional semilandmark coordinates
pca.eig.sample &lt;- stats::prcomp(geomorph::two.d.array(eig.sample))

# Verify names for each acoustic unit and the order in which they appear
dimnames(eig.sample)[[3]]

# Create factor to use as groups in subsequent ordination plot
sample.gr &lt;- factor(c(rep("centralis", 3), rep("cuvieri", 3), rep("kroyeri", 3)))

# Clear current R plot to prevent errors
grDevices::dev.off()

# Plot result of Principal Components Analysis
pca.plot(PCA.out = pca.eig.sample, groups = sample.gr, conv.hulls = sample.gr,
         main="PCA of 3D coordinates", leg=TRUE, leg.pos = "top")

# Verify hypothetical sound surfaces using hypo.surf
hypo.surf(threeD.out=eig.sample, PC=1, flim=c(0, 4), tlim=c(0, 0.8), x.length=70, y.length=47)


</code></pre>


</div>