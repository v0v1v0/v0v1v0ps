<div class="container">

<table style="width: 100%;"><tr>
<td>bootlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Bootstrapping of Heteroskedastic Linear Regression Models</h2>

<h3>Description</h3>

<p>Generates <code class="reqn">B</code> nonparametric bootstrap replications of a linear
regression model that may have heteroskedasticity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootlm(
  object,
  sampmethod = c("pairs", "wild"),
  B = 1000L,
  resfunc = c("identity", "hccme"),
  fastfit = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Either an object of class <code>"lm"</code> (generated by
<code>lm</code>), an object of class <code>"alvm.fit"</code>
(generated by <code>alvm.fit</code>), or an object of class
<code>"anlvm.fit"</code> (generated by <code>anlvm.fit</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampmethod</code></td>
<td>
<p>A character, either <code>"pairs"</code> or <code>"wild"</code>,
indicating the method to be used to generate the resampled models:
bootstrapping pairs (Efron and Tibshirani 1993) or the wild bootstrap
(Davidson and Flachaire 2008). Defaults to <code>"pairs"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer representing the number of bootstrapped linear
regression models to generate; defaults to <code>1000L</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resfunc</code></td>
<td>
<p>Either a character naming a function to call to apply a
transformation to the Ordinary Least Squares residuals, or a function
to apply for the same purpose. This argument is ignored if
<code>sampmethod</code> is <code>"pairs"</code>. The only two character values
accepted are <code>"identity"</code>, in which case no transformation is
applied to the residuals, and <code>"hccme"</code>, in which case the
transformation corresponds to a heteroskedasticity-consistent
covariance matrix estimator calculated from <code>hccme</code>. If
<code>resfunc</code> is a function, it is assumed that its first argument
is the numeric vector of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastfit</code></td>
<td>
<p>A logical indicating whether the <code>lm.fit</code>
function should be used to fit the bootstrapped regression models for
greater computational speed; defaults to <code>TRUE</code>. This affects the
class of the returned value (see below). If <code>FALSE</code>,
<code>lm</code> is used to fit the bootstrapped regression
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass to <code>hccme</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each replication of the pairs bootstrap entails drawing a sample
of size <code class="reqn">n</code> (the number of observations) with replacement from the
indices <code class="reqn">i=1,2,\ldots,n</code>. The pair or case <code class="reqn">(y_i, X_i)</code> is
included as an observation in the bootstrapped data set for each sampled
index. An Ordinary Least Squares fit to the bootstrapped data set is then
computed.
</p>
<p>Under the wild bootstrap, each replication of the linear regression model
is generated by first independently drawing <code class="reqn">n</code> random values
<code class="reqn">r_i</code>, <code class="reqn">i=1,2,\ldots,n</code>, from a distribution with zero mean and
unit variance. The <code class="reqn">i</code>th bootstrap response is then computed as
</p>
<p style="text-align: center;"><code class="reqn">X_i'\hat{\beta} + f_i(e_i) r_i</code>
</p>
<p>, where <code class="reqn">X_i</code> is the <code class="reqn">i</code>th
design observation, <code class="reqn">\hat{\beta}</code> is the Ordinary Least Squares
estimate of the coefficient vector <code class="reqn">\beta</code>, <code class="reqn">e_i</code> is the
<code class="reqn">i</code>th Ordinary Least Squares residual, and <code class="reqn">f_i(\cdot)</code> is a
function performing some transformation on the residual. An Ordinary
Least Squares fit is then computed on the original design matrix and the
bootstrap response vector.
</p>


<h3>Value</h3>

<p>A list object of class <code>"bootlm"</code>, containing <code>B</code> objects,
each of which is a bootstrapped linear regression model fit by Ordinary
Least Squares. If <code>fastfit</code> was set to <code>TRUE</code>, each of these
objects will be a list containing named objects <code>y</code> (the bootstrap
response vector), <code>X</code> (the bootstrap design matrix, which is just
the original design matrix under the wild bootstrap), <code>e</code> (the
residual vector from the Ordinary Least Squares fit to this bootstrap
data set), <code>beta.hat</code> (the vector of coefficient estimates from the
Ordinary Least Squares fit to this bootstrap data set),
<code>sampmethod</code>, and <code>ind</code> (a vector of the indices from the
original data set used in this bootstrap sample; ignored under the
wild bootstrap)
of the kind returned by
<code>lm.fit</code>; otherwise, each will be an object of class
<code>"lm"</code>.
</p>


<h3>References</h3>

<p>Davidson R, Flachaire E (2008).
“The Wild Bootstrap, Tamed at Last.”
<em>Journal of Econometrics</em>, <b>146</b>, 162–169.<br><br> Efron B, Tibshirani RJ (1993).
<em>An Introduction to the Bootstrap</em>.
Springer Science+Business Media, Dordrecht.
</p>


<h3>See Also</h3>

<p><code>paired.boot</code> and
<code>wild.boot</code> for the pairs bootstrap and wild
bootstrap, respectively. The latter function does not appear to allow
transformations of the residuals in the wild bootstrap.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
mybootlm &lt;- bootlm(mtcars_lm)

</code></pre>


</div>