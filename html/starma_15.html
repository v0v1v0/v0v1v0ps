<div class="container">

<table style="width: 100%;"><tr>
<td>stcor.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Space-time series non correlation test</h2>

<h3>Description</h3>

<p><code>stcor.test</code> computes an extension of the Box-Pierce test statistic to accept or reject the
non correlation of the distinct observations of a given space-time series.
It is one of the main functions for the diagnostic part of the three-stage iterative model building procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stcor.test(data, wlist, tlag=NULL, slag=NULL, fitdf=0)

## S3 method for class 'stcor.test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a matrix or data frame containing the space-time series: row-wise should be the temporal observations, with each column corresponding to a site. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wlist</code></td>
<td>
<p> a list of the weight matrices for each k-th order neighbours, first one being the identity. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlag</code></td>
<td>
<p> the maximum time lag for the space-time autocorrelation functions. If <code>tlag = NULL</code>, it will use a large enough number of time lags. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slag</code></td>
<td>
<p> the maximum space lag for the space-time autocorrelation functions. If <code>slag = NULL</code>, it will use as many space lags as possible (as many as <code>length(wlist)</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitdf</code></td>
<td>
<p> number of degrees of freedom to be subtracted if <code>data</code> is a series of residuals. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a <code>starma</code> class object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> unused </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since (Pfeifer and Deutsch, 1981) gives:
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\rho}_l(s)) \approx \frac{1}{N(T-s)}</code>
</p>

<p>We can extend Box-Pierce test statistic to space-time series:
</p>
<p style="text-align: center;"><code class="reqn">N \sum (T-s) \hat{\rho}_l(s)^2 \sim \chi^2(slag \times tlag)</code>
</p>

<p><code>stcor.test</code> can be applied to a space-time series to test the null hypothesis of non correlation.
</p>
<p>It is useful to check if the residuals of a STARMA models are multivariate white noise.
In this case, <code>fitdf</code> should be set equal to the number of parameters in the model.
</p>
<p>Please note that this is an empirical extension and it has not yet been the subject of a paper.
The specifications of the weight matrices has not been studied either and could lead to inconsistencies.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X_squared</code></td>
<td>
<p> The value of the chi squared statistic </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p> The degrees of freedom of the statistic (taking <code>fitdf</code> into account) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p> The p-value of the test </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felix Cheysson</p>


<h3>References</h3>

<p>- Pfeifer, P., &amp; Deutsch, S. (1980). A Three-Stage Iterative Procedure for Space-Time Modeling. Technometrics, 22(1): 35-47. doi:10.1080/00401706.1980.10486099
</p>
<p>- Pfeifer, P., &amp; Deutsch, S. (1981). Variance of the Sample Space-Time Autocorrelation Function. Journal of the Royal Statistical Society. Series B (Methodological), 43(1): 28-33.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nb_mat)

eps &lt;- matrix(rnorm(94*200), 200, 94)
sim &lt;- eps
for (t in 3:200) {
	sim[t,] &lt;- (.4*blist[[1]] + .25*blist[[2]]) %*% sim[t-1,] +
		(.25*blist[[1]]                ) %*% sim[t-2,] +
		(            - .3*blist[[2]]) %*% eps[t-1,] +
		eps[t, ]
}

sim &lt;- sim[101:200,]
sim &lt;- stcenter(sim)	# Center and scale the dataset

# Test for multivariate normality
stcor.test(sim, blist)	# Data is correlated
stcor.test(eps, blist)		# Data should not be correlated (unless you're 5% unlucky)
</code></pre>


</div>