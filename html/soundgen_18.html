<div class="container">

<table style="width: 100%;"><tr>
<td>.phasegram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phasegram per sound</h2>

<h3>Description</h3>

<p>Internal soundgen function called by <code>phasegram</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.phasegram(
  audio,
  windowLength = 10,
  step = windowLength/2,
  timeLag = NULL,
  theilerWindow = NULL,
  nonlinStats = c("ed", "d2", "ml", "sur"),
  pars_ed = list(max.embedding.dim = 15),
  pars_d2 = list(min.embedding.dim = 2, min.radius = 0.001, n.points.radius = 20),
  pars_ml = list(min.embedding.dim = 2, radius = 0.001),
  pars_sur = list(FUN = nonlinearTseries::timeAsymmetry, K = 1),
  bw = 0.01,
  bins = 5/bw,
  plot = TRUE,
  rasterize = FALSE,
  colorTheme = c("bw", "seewave", "heat.colors", "...")[1],
  col = NULL,
  xlab = "Time",
  ylab = "",
  main = NULL,
  width = 900,
  height = 500,
  units = "px",
  res = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>audio</code></td>
<td>
<p>a list returned by <code>readAudio</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowLength</code></td>
<td>
<p>the length of each frame analyzed separately (ms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>time step between consecutive frames (ms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeLag</code></td>
<td>
<p>time lag between the original and time-shifted version of each
frame that together represent the phase portrait (ms). Defaults to the
number of steps beyond which the mutual information function reaches its
minimum or, if that fails, the steps until mutual information experiences
the first exponential decay - see <code>timeLag</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theilerWindow</code></td>
<td>
<p>time lag between two points that are considered locally
independent and can be treated as neighbors in the reconstructed phase
space. defaults to the first minimum or, if unavailable, the first zero of
the autocorrelation function (or, failing that, to <code>timeLag * 2</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonlinStats</code></td>
<td>
<p>nonlinear statistics to report: "ed" = the optimal number
of embedding dimensions, "d2" = correlation dimension D2, "ml" = maximum
Lyapunov exponent, "sur" = the results of surrogate data testing for
stochasticity. These are calculated using the functionality of the package
nonlinearTseries, which is seriously slow, so the default is just to get
the phasegram itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_ed</code></td>
<td>
<p>a list of control parameters passed to
<code>estimateEmbeddingDim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_d2</code></td>
<td>
<p>a list of control parameters passed to
<code>corrDim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_ml</code></td>
<td>
<p>a list of control parameters passed to
<code>maxLyapunov</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_sur</code></td>
<td>
<p>a list of control parameters passed to
<code>surrogateTest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>standard deviation of the smoothing kernel, as in
<code>density</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>the number of bins along the Y axis after rasterizing (has no
effect if <code>rasterize = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>should a spectrogram be plotted? TRUE / FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rasterize</code></td>
<td>
<p>if FALSE, only plots and returns Poincare sections on the
original scale (most graphical parameters will then have no effect); if
TRUE, rasterizes the phasegram matrix and plots it with more graphical
parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorTheme</code></td>
<td>
<p>black and white ('bw'), as in seewave package ('seewave'),
matlab-type palette ('matlab'), or any palette from
<code>palette</code> such as 'heat.colors', 'cm.colors', etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>actual colors, eg rev(rainbow(100)) - see ?hcl.colors for colors
in base R (overrides colorTheme)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main</code></td>
<td>
<p>graphical parameters passed to
soundgen:::filled.contour.mod (if <code>rasterize = TRUE</code>) or plot (if
<code>rasterize = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height, units, res</code></td>
<td>
<p>graphical parameters for saving plots passed to
<code>png</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters passed to soundgen:::filled.contour.mod
(if <code>rasterize = TRUE</code>)  or plot (if <code>rasterize = FALSE</code>)</p>
</td>
</tr>
</table>
</div>