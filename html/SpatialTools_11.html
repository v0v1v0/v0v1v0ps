<div class="container">

<table style="width: 100%;"><tr>
<td>maxlik.cov.sp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Determines maximum likelihood estimates of covariance parameters
</h2>

<h3>Description</h3>

<p>Estimates covariance parameters of spatial covariance functions using maximum likelihood or restricted maximum likelihood.  See <code>cov.sp</code> for more details of covariance functions to be estimated.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">	maxlik.cov.sp(X, y, coords, sp.type = "exponential", 
	    range.par = stop("specify range.par argument"), 
	    error.ratio = stop("specify error.ratio argument"), 
	    smoothness = 0.5,  
	    D = NULL, reml = TRUE, lower = NULL, upper = NULL, 
	    control = list(trace = TRUE), optimizer="nlminb")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">n \times k</code> containing the design matrix of the data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> containing the observed responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A numeric matrix of size <code class="reqn">n \times d</code> containing the locations of the observed responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.type</code></td>
<td>
<p>A character vector specifying the spatial covariance type.  Valid types are currently exponential, gaussian, matern, and spherical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.par</code></td>
<td>
<p>An initial guess for the spatial dependence parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.ratio</code></td>
<td>
<p>A value non-negative value indicating the ratio <code>error.var/sp.par[1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothness</code></td>
<td>
<p>A positive number indicating the smoothness of the matern covariance function, if applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The Euclidean distance matrix for the coords matrix.  Must be of size <code class="reqn">n \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reml</code></td>
<td>
<p>A boolean value indicating whether restricted maximum likelihood estimation should be used.  Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A vector giving lower bounds for the covariance parameters <code>sp.par[2]</code>, <code>error.ratio</code>, and <code>smoothness</code> (when the model is matern).  Order matters!  If not given defaults to an upper bound of Inf for <code>sp.par[2]</code>, 1 for <code>error.ratio</code>, and 10 for <code>smoothness</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector giving upper bounds for the covariance parameters <code>sp.par[2]</code>, <code>error.ratio</code>, and <code>smoothness</code> (when the model is matern).  Order matters!  If not given defaults to an upper bound of Inf for <code>sp.par[2]</code>, 1 for <code>error.ratio</code>, and 10 for <code>smoothness</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list giving tuning parameters for the <code>nlminb</code> function.  See <code>nlminb</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>A vector describing the optimization function to use for the optimization.  Currently, only <code>nlminb</code> is an acceptable value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When doing the numerical optimizaiton, the covariance function is reparameterized slightly to speedup computation.  
Specifically, the variance parameter for the process of interest,<code>sp.par[1]</code>, is profiled out,
and the <code>error.var</code> parameter is parameterized as <code>sp.par[1] * error.ratio</code>, where <code>error.ratio = error.var/sp.par[1]</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sp.type</code></td>
<td>
<p> The covariance form used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.par</code></td>
<td>
<p> A vector containing the estimated variance of the hidden process and the spatial dependence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.var</code></td>
<td>
<p> The estimated error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothness</code></td>
<td>
<p> The smoothness of the matern covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p> The final values of the optimization parameters.  Note that these will not necessarily match <code>sp.par</code>, <code>error.var</code>, and <code>smoothness</code> because of the reparameterization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> Convergence message from <code>nlminb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p> Message from <code>nlminb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p> Number of iterations for optimization to converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluations</code></td>
<td>
<p> Evaluations from <code>nlminb</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua French</p>


<h3>See Also</h3>

 <p><code>cov.st</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">#generate 20 random (x, y) coordinates
coords &lt;- matrix(rnorm(20), ncol = 2)

#create design matrix
X &lt;- cbind(1, coords)

#create mean for observed data to be generated
mu &lt;- X %*% c(1, 2, 3)

#generate covariance matrix
V &lt;- exp(-dist1(coords))

#generate observe data
y &lt;- rmvnorm(mu = mu, V = V)

#find maximum likelihood estimates of covariance parameters
maxlik.cov.sp(X = X, y = y, coords = coords,
    sp.type = "exponential", range.par = 1, error.ratio = 0, 
    reml = TRUE)
</code></pre>


</div>