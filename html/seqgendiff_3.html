<div class="container">

<table style="width: 100%;"><tr>
<td>effective_cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the effective correlation.</h2>

<h3>Description</h3>

<p>Will return the estimated correlation between the design matrix and the
surrogate variables when you assign a target correlation. The method is
described in detail in Gerard (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">effective_cor(
  design_perm,
  sv,
  target_cor,
  calc_first = c("cor", "mean"),
  method = c("hungarian", "marriage"),
  iternum = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design_perm</code></td>
<td>
<p>A numeric design matrix whose rows are to be permuted
(thus controlling the amount by which they are correlated with the
surrogate variables). The rows index the samples and the columns index
the variables. The intercept should <em>not</em> be included
(though see Section "Unestimable Components").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv</code></td>
<td>
<p>A matrix of surrogate variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_cor</code></td>
<td>
<p>A numeric matrix of target correlations between the
variables in <code>design_perm</code> and the surrogate variables. The
rows index the observed covariates and the columns index the surrogate
variables. That is, <code>target_cor[i, j]</code> specifies the target
correlation between the <code>i</code>th column of <code>design_perm</code> and the
<code>j</code>th surrogate variable. The surrogate variables are estimated
either using factor analysis or surrogate variable analysis (see the
parameter <code>use_sva</code>).
The number of columns in <code>target_cor</code> specifies the number of
surrogate variables. Set <code>target_cor</code> to <code>NULL</code> to indicate
that <code>design_perm</code> and the surrogate variables are independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc_first</code></td>
<td>
<p>Should we calculate the correlation of the mean
<code>design_perm</code> and <code>sv</code> (<code>calc_first = "mean"</code>), or
should we calculate the mean of the correlations between
<code>design_perm</code> and <code>sv</code> (<code>calc_first = "cor"</code>)? This
should only be changed by expert users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Should we use the Gale-Shapley algorithm
for stable marriages (<code>"marriage"</code>) (Gale and Shapley, 1962)
as implemented in the matchingR package, or the Hungarian algorithm
(Papadimitriou and Steiglitz, 1982) (<code>"hungarian"</code>)
as implemented in the clue package (Hornik, 2005)? The
Hungarian method almost always works better, so is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iternum</code></td>
<td>
<p>The total number of simulated correlations to consider.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function permutes the rows of <code>design_perm</code> many times, each
time calculating the Pearson correlation between the columns of
<code>design_perm</code> and the columns of <code>sv</code>. It then returns the
averages of these Pearson correlations. The permutation is done
using <code>permute_design</code>.
</p>


<h3>Value</h3>

<p>A matrix of correlations. The rows index the observed covariates
and the columns index the surrogate variables. Element (i, j) is
the estimated correlation between the ith variable in
<code>design_perm</code> and the jth variable in <code>sv</code>.
</p>


<h3>Author(s)</h3>

<p>David Gerard
</p>


<h3>References</h3>


<ul>
<li>
<p>Gale, David, and Lloyd S. Shapley. "College admissions and the stability of marriage." <em>The American Mathematical Monthly</em> 69, no. 1 (1962): 9-15. <a href="https://doi.org/10.1080/00029890.1962.11989827">doi:10.1080/00029890.1962.11989827</a>.
</p>
</li>
<li>
<p>Gerard, D (2020). "Data-based RNA-seq simulations by binomial thinning." <em>BMC Bioinformatics</em>. 21(1), 206. <a href="https://doi.org/10.1186/s12859-020-3450-9">doi:10.1186/s12859-020-3450-9</a>.
</p>
</li>
<li>
<p>Hornik K (2005). "A CLUE for CLUster Ensembles." <em>Journal of Statistical Software</em>, 14(12). <a href="https://doi.org/10.18637/jss.v014.i12">doi:10.18637/jss.v014.i12</a>. <a href="https://doi.org/10.18637/jss.v014.i12">doi:10.18637/jss.v014.i12</a>.
</p>
</li>
<li>
<p>C. Papadimitriou and K. Steiglitz (1982), Combinatorial Optimization: Algorithms and Complexity. Englewood Cliffs: Prentice Hall.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Generate the design matrices and set target correlation -----------------
n &lt;- 10
design_perm &lt;- cbind(rep(c(0, 1), each = n / 2),
                     rep(c(0, 1), length.out = n))
sv &lt;- matrix(rnorm(n))
target_cor &lt;- matrix(c(0.9, 0.1), ncol = 1)

## Get estimated true correlation ------------------------------------------
## You should use a much larger iternum in practice
effective_cor(design_perm = design_perm,
              sv = sv,
              target_cor = target_cor,
              iternum = 10)

</code></pre>


</div>