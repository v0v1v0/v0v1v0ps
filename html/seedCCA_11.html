<div class="container">

<table style="width: 100%;"><tr>
<td>seedCCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Seeded Canonical correlation analysis</h2>

<h3>Description</h3>

<p>The function <code>seedCCA</code> is mainly for implementing seeded canonical correlation analysis proposed by Im et al. (2015). The function conducts the following four methods, depending on the value of <code>type</code>. The option <code>type</code> has one of <code>c("cca", "seed1", "seed2", "pls")</code>. </p>


<h3>Usage</h3>

<pre><code class="language-R">seedCCA(X,Y,type="seed2",ux=NULL,uy=NULL,u=10,eps=0.01,cut=0.9,d=NULL,AS=TRUE,scale=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric vector or matrix (n * p), the first set of variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>numeric vector or matrix (n * r), the second set of variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character, a choice of methods among <code>c("cca", "seed1", "seed2", "pls")</code>. The default is <code>"seed2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ux</code></td>
<td>
<p>numeric, maximum number of projections for X. The default is NULL. If this is not NULL, it surpasses the option <code>u</code> with <code>type="seed1"</code> and p&gt;r. For <code>type="seed2"</code>, if <code>ux</code> and <code>uy</code> are not NULL, they surpass <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uy</code></td>
<td>
<p>numeric, maximum number of projections for Y. The default is NULL. If this is not NULL, it surpasses the option <code>u</code> with <code>type="seed1"</code> and p&lt;r. For <code>type="seed2"</code>, if <code>ux</code> and <code>uy</code> are not NULL, they surpass <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>numeric, maximum number of projections. The default is 10. This is used for <code>type="seed1"</code>, <code>type="seed2"</code> and tyepe="pls".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric, the criteria to terminate iterative projections. The default is 0.01. If increment of projections is less than <code>eps</code>, then the iterative projection is terminated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut</code></td>
<td>
<p>numeric, between 0 and 1. The default is 0.9.
If <code>d</code> is NULL, <code>cut</code> is used for automatic replacements of cov(X,Y) and cov(Y,X) with their eigenvectors, depending on the value of <code>cut</code>. So, if any value of <code>d</code> is given, <code>cut</code> is not effective. cov(X,Y) and cov(Y,X) are replaced with their largest eigenvectors, whose cumulative eigenvalue proportion is bigger than the value of <code>cut</code>. This only works for <code>type="seed2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>numeric, the user-selected number of largest eigenvectors of cov(X, Y) and cov(Y, X). The default is NULL. This only works for <code>type="seed2"</code>. If any value of <code>d</code> is given, <code>cut</code> does not work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AS</code></td>
<td>
<p>logical, status of automatic stop of projections. The default is <code>TRUE</code>. If TRUE, the iterative projection is automatically stopped, when the terminaion condition <code>eps</code> is satisfied. If<code>AS=FALSE</code>, the iterative projections are stopped at the value of <code>u</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical. scaling predictors to have zero mean and one standard deviation. The default is <code>FALSE</code>. If <code>scale=TRUE</code>, each predictor is scaled with mean 0 and variance 1 for partial least squares. This option works only for <code>type="pls"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let p and r stand for the numbers of variables in the two sets and n stands for the sample size. The option of <code>type="cca"</code> can work only when max(p,r) &lt; n, and <code>seedCCA</code> conducts standard canonical correlation analysis (Johnson and Wichern, 2007). If <code>type="cca"</code> is given and either p or r is equal to one, ordinary least squares (OLS) is done instead of canonical correlation analysis. If max(p,r) &gt;= n, either <code>type="seed1"</code> or <code>type="seed2"</code> has to be chosen. This is the main purpose of <code>seedCCA</code>. If <code>type="seed1"</code>, only one set of variables, saying X with p for convenience, to have more variables than the other, saying Y with r, is initially reduced by the iterative projection approach (Cook et al. 2007). And then, the canonical correlation analysis of the initially-reduced X and the original Y is finalized. If <code>type="seed2"</code>, both X and Y are initially reduced. And then, the canonical correlation analysis of the two initially-reduced X and Y are finalzed. If <code>type="pls"</code>, partial least squares (PLS) is done. If <code>type="pls"</code> is given, the first set of variables in <code>seedCCA</code> is predictors and the second set is response. This matters The response can be multivariate. Depeding on the value of <code>type</code>, the resulted subclass by <code>seedCCA</code> are different.:
</p>
<p><code>type="cca"</code>: subclass "finalCCA" (p &gt;2; r &gt;2; p,r&lt;n)
</p>
<p><code>type="cca"</code>: subclass "seedols"  (either p or r is equal to 1.)
</p>
<p><code>type="seed1"</code> and <code>type="seed2"</code>: subclass "finalCCA" (max(p,r)&gt;n)
</p>
<p><code>type="pls"</code>: subclass "seedpls" (p&gt;n and r &lt;n)
</p>
<p>So, <code>plot(object)</code> will result in different figure depending on the object.
</p>
<p>The order of the values depending on type is follows.:
</p>
<p><code>type="cca"</code>: standard CCA (max(p,r)&lt;n, min(p,r)&gt;1) / "finalCCA" subclass
</p>
<p><code>type="cca"</code>: ordinary least squares (max(p,r)&lt;n, min(p,r)=1) / "seedols" subclass
</p>
<p><code>type="seed1"</code>: seeded CCA with case1 (max(p,r)&gt;n and p&gt;r) / "finalCCA" subclass
</p>
<p><code>type="seed1"</code>: seeded CCA with case1 (max(p,r)&gt;n and p&lt;=r) / "finalCCA" subclass
</p>
<p><code>type="seed2"</code>: seeded CCA with case2 (max(p,r)&gt;n) / "finalCCA" subclass
</p>
<p><code>type="pls"</code>: partial least squares (p&gt;n and r&lt;n) / "seedpls" subclass
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type="cca"</code></td>
<td>
<p>Values with selecting <code>type="cca"</code>: standard CCA (max(p,r)&lt;n, min(p,r)&gt;1) / "finalCCA" subclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>canonical correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoef</code></td>
<td>
<p>the estimated canonical coefficients for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoef</code></td>
<td>
<p>the estimated canonical coefficients for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xscores</code></td>
<td>
<p>the estimated canonical variates for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yscores</code></td>
<td>
<p>the estimated canonical variates for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type="cca"</code></td>
<td>
<p>Values with selecting <code>type="cca"</code>: ordinary least squares (max(p,r)&lt;n, min(p,r)=1) / "seedols" subclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the estimated ordinary least squares coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>X, the first set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y, the second set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type="seed1"</code></td>
<td>
<p>Values with selecting <code>type="seed1"</code>: seeded CCA with case1 (max(p,r)&gt;n and p&gt;r) / "finalCCA" subclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>canonical correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoef</code></td>
<td>
<p>the estimated canonical coefficients for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoef</code></td>
<td>
<p>the estimated canonical coefficients for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proper.u</code></td>
<td>
<p>a suggested proper number of projections for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialMX0</code></td>
<td>
<p>the initialized canonical coefficient matrices of X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newX</code></td>
<td>
<p>initially-reduced X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the original Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xscores</code></td>
<td>
<p>the estimated canonical variates for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yscores</code></td>
<td>
<p>the estimated canonical variates for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type="seed1"</code></td>
<td>
<p>Values with selecting <code>type="seed1"</code>: seeded CCA with case1 (max(p,r)&gt;n and p&lt;=r) / "finalCCA" subclass)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>canonical correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoef</code></td>
<td>
<p>the estimated canonical coefficients for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoef</code></td>
<td>
<p>the estimated canonical coefficients for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proper.u</code></td>
<td>
<p>a suggested proper number of projections for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the original X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialMY0</code></td>
<td>
<p>the initialized canonical coefficient matrices of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newY</code></td>
<td>
<p>initially-reduced Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xscores</code></td>
<td>
<p>the estimated canonical variates for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yscores</code></td>
<td>
<p>the estimated canonical variates for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type="seed2"</code></td>
<td>
<p>Values with selecting <code>type="seed2"</code>: seeded CCA with case2 (max(p,r)&gt;n) / "finalCCA" subclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>canonical correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoef</code></td>
<td>
<p>the estimated canonical coefficients for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoef</code></td>
<td>
<p>the estimated canonical coefficients for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proper.ux</code></td>
<td>
<p>a suggested proper number of projections for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proper.uy</code></td>
<td>
<p>a suggested proper number of projections for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>suggested number of eigenvectors of cov(X,Y)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialMX0</code></td>
<td>
<p>the initialized canonical coefficient matrices of X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialMY0</code></td>
<td>
<p>the initialized canonical coefficient matrices of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newX</code></td>
<td>
<p>initially-reduced X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newY</code></td>
<td>
<p>initially-reduced Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xscores</code></td>
<td>
<p>the estimated canonical variates for X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yscores</code></td>
<td>
<p>the estimated canonical variates for Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type="pls"</code></td>
<td>
<p>Values with selecting <code>type="pls"</code>:: partial least squares (p&gt;n and r&lt;n) / "seedpls" subclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the estimated coefficients for each iterative projection upto u</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>the maximum number of projections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>status of scaling predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>the number of observations</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>R. D. Cook, B. Li and F. Chiaromonte. Dimension reduction in regression without matrix inversion. Biometrika 2007; 94: 569-584.
</p>
<p>Y. Im, H. Gang and JK. Yoo. High-throughput data dimension reduction via seeded canonical correlation analysis, J. Chemometrics 2015; 29: 193-199.
</p>
<p>R. A. Johnson and D. W. Wichern. Applied Multivariate Statistical Analysis. Pearson Prentice Hall: New Jersey, USA; 6 edition. 2007; 539-574.
</p>
<p>K. Lee and JK. Yoo. Canonical correlation analysis through linear modeling, AUST. NZ. J. STAT. 2014;  56: 59-72.
</p>


<h3>Examples</h3>

<pre><code class="language-R">######  data(cookie) ######
data(cookie)
myseq&lt;-seq(141,651,by=2)
X&lt;-as.matrix(cookie[-c(23,61),myseq])
Y&lt;-as.matrix(cookie[-c(23,61),701:704])
dim(X);dim(Y)

## standard CCA
fit.cca &lt;-seedCCA(X[,1:4], Y, type="cca")  ## standard canonical correlation analysis is done.
plot(fit.cca)

## ordinary least squares
fit.ols1 &lt;-seedCCA(X[,1:4], Y[,1], type="cca")  ## ordinary least squares is done, because r=1.
fit.ols2 &lt;-seedCCA(Y[,1], X[,1:4], type="cca")  ## ordinary least squares is done, because p=1.

## seeded CCA with case 1
fit.seed1 &lt;- seedCCA(X, Y, type="seed1") ## suggested proper value of u is equal to 3.
fit.seed1.ux &lt;- seedCCA(X, Y, ux=6, type="seed1") ## iterative projections done 6 times.
fit.seed1.uy &lt;- seedCCA(Y, X, uy=6, type="seed1", AS=FALSE)  ## projections not done until uy=6.
plot(fit.seed1)

## partial least squares
fit.pls1 &lt;- seedCCA(X, Y[,1], type="pls")
fit.pls.m &lt;- seedCCA(X, Y, type="pls") ## multi-dimensional response
par(mfrow=c(1,2))
plot(fit.pls1); plot(fit.pls.m)


########  data(nutrimouse) ########
data(nutrimouse)
X&lt;-as.matrix(nutrimouse$gene)
Y&lt;-as.matrix(nutrimouse$lipid)
dim(X);dim(Y)

## seeded CCA with case 2
fit.seed2 &lt;- seedCCA(X, Y, type="seed2")  ## d not specified, so cut=0.9 (default) used.
fit.seed2.99 &lt;- seedCCA(X, Y, type="seed2", cut=0.99)  ## cut=0.99 used.
fit.seed2.d3 &lt;- seedCCA(X, Y, type="seed2", d=3)  ## d is specified with 3.

## ux and uy specified, so proper values not suggested.
fit.seed2.uxuy &lt;- seedCCA(X, Y, type="seed2", ux=10, uy=10)
plot(fit.seed2)
</code></pre>


</div>