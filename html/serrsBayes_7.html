<div class="container">

<table style="width: 100%;"><tr>
<td>fitVoigtPeaksSMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the model with Voigt peaks using Sequential Monte Carlo (SMC).</h2>

<h3>Description</h3>

<p>Fit the model with Voigt peaks using Sequential Monte Carlo (SMC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitVoigtPeaksSMC(
  wl,
  spc,
  lPriors,
  conc = rep(1, nrow(spc)),
  npart = 10000,
  rate = 0.9,
  mcAR = 0.234,
  mcSteps = 20,
  minESS = npart/2,
  destDir = NA,
  minPart = npart
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>Vector of <code>nwl</code> wavenumbers at which the spetra are observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spc</code></td>
<td>
<p><code>n_y * nwl</code> Matrix of observed Raman spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lPriors</code></td>
<td>
<p>List of hyperparameters for the prior distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Vector of <code>n_y</code> nanomolar (nM) dye concentrations for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npart</code></td>
<td>
<p>number of SMC particles to use for the importance sampling distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>the target rate of reduction in the effective sample size (ESS).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcAR</code></td>
<td>
<p>target acceptance rate for the MCMC kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcSteps</code></td>
<td>
<p>number of iterations of the MCMC kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minESS</code></td>
<td>
<p>minimum effective sample size, below which the particles are resampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destDir</code></td>
<td>
<p>destination directory to save intermediate results (for long-running computations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPart</code></td>
<td>
<p>target number of unique particles for the MCMC iterations</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">wavenumbers &lt;- seq(200,600,by=10)
spectra &lt;- matrix(nrow=1, ncol=length(wavenumbers))
peakLocations &lt;- c(300,500)
peakAmplitude &lt;- c(10000,4000)
peakScale &lt;- c(10, 15)
signature &lt;- weightedLorentzian(peakLocations, peakScale, peakAmplitude, wavenumbers)
baseline &lt;- 1000*cos(wavenumbers/200) + 2*wavenumbers
spectra[1,] &lt;- signature + baseline + rnorm(length(wavenumbers),0,200)
lPriors &lt;- list(scaG.mu=log(11.6) - (0.4^2)/2, scaG.sd=0.4, scaL.mu=log(11.6) - (0.4^2)/2,
   scaL.sd=0.4, bl.smooth=5, bl.knots=20, loc.mu=peakLocations, loc.sd=c(5,5),
   beta.mu=c(5000,5000), beta.sd=c(5000,5000), noise.sd=200, noise.nu=4)
## Not run: 
result &lt;- fitVoigtPeaksSMC(wavenumbers, spectra, lPriors, npart=50, mcSteps=1)

## End(Not run)
</code></pre>


</div>