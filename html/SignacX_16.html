<div class="container">

<table style="width: 100%;"><tr>
<td>MASC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixed effect modeling</h2>

<h3>Description</h3>

<p><code>MASC</code> was imported from <a href="https://github.com/immunogenomics/masc">https://github.com/immunogenomics/masc</a>.
Performs mixed-effect modeling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MASC(
  dataset,
  cluster,
  contrast,
  random_effects = NULL,
  fixed_effects = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>data frame of covariate, cell type, clustering or disease information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>celltypes returned by Signac or cluster identities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>Typically disease</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_effects</code></td>
<td>
<p>User specified random effect variables in dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_effects</code></td>
<td>
<p>User specific fixed effects in dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE, algorithm reports outputs</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>mixed effect model results
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load metadata
file.dir = "https://kleintools.hms.harvard.edu/tools/client_datasets/"
file = "AMP_Phase1_SLE_Apr2019/FullDataset_v1/categorical_coloring_data.json"
download.file(paste0(file.dir, file, "?raw=true"), destfile = "categorical_coloring_data.json")
d = rjson::fromJSON(file='categorical_coloring_data.json')
d = data.frame(sapply(d, function(x) x$label_list))

# run MASC
x = d$CellStates # optionally use clusters or cell types
d$Disease = factor(d$Disease) # the contrast term must be encoded as a factor
Q = MASC(d, cluster = x, contrast = 'Disease', random_effects = c( "Tissue", "Plate", "Sample"))

## End(Not run)
</code></pre>


</div>