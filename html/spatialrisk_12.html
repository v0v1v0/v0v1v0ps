<div class="container">

<table style="width: 100%;"><tr>
<td>interpolate_spline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Splines on the sphere</h2>

<h3>Description</h3>

<p>Spline interpolation and smoothing on the sphere.
</p>


<h3>Usage</h3>

<pre><code class="language-R">interpolate_spline(
  observations,
  targets,
  value,
  lon_obs = lon,
  lat_obs = lat,
  lon_targets = lon,
  lat_targets = lat,
  k = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observations</code></td>
<td>
<p>data.frame of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>data.frame of locations to calculate the interpolated and
smoothed values for (target points).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Column with values in <code>observations</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_obs</code></td>
<td>
<p>Column in <code>observations</code> with longitude (lon is default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_obs</code></td>
<td>
<p>Column in <code>observations</code> with latitude (lat is default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_targets</code></td>
<td>
<p>Column in <code>targets</code> with longitude (lon is default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_targets</code></td>
<td>
<p>Column in <code>targets</code> with latitude (lat is default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(default 50) is the basis dimension. For small data sets reduce
<code>k</code> manually rather than using default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>observations</code> should include at least columns for longitude
and latitude.
</p>
<p><code>targets</code> should include at least columns for longitude,
latitude and value of interest to interpolate and smooth.
</p>
<p>A smooth of the general type discussed in Duchon (1977) is used:
the sphere is embedded in a 3D Euclidean space, but smoothing employs a
penalty based on second derivatives (so that locally as the smoothing
parameter tends to zero we recover a "normal" thin plate spline on the
tangent space). This is an unpublished suggestion of Jean Duchon.
</p>
<p>See <code>ordinary kriging</code>
for interpolation and smoothing on the sphere by means of kriging.
</p>


<h3>Value</h3>

<p>Object equal to object <code>targets</code> including an extra column
with predicted values.
</p>


<h3>Author(s)</h3>

<p>Martin Haringa
</p>


<h3>References</h3>

<p><code>Splines on
the sphere</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
target &lt;- sf::st_drop_geometry(nl_postcode3)
obs &lt;- dplyr::sample_n(insurance, 1000)
pop_df &lt;- interpolate_spline(obs, target, population_pc4, k = 20)
pop_sf &lt;- left_join(nl_postcode3, pop_df)
choropleth(pop_sf, value = "population_pc4_pred", n = 13)

## End(Not run)

</code></pre>


</div>