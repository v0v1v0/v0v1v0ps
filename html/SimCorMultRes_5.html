<div class="container">

<table style="width: 100%;"><tr>
<td>rmult.clm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating Correlated Ordinal Responses Conditional on a Marginal Cumulative
Link Model Specification</h2>

<h3>Description</h3>

<p>Simulates correlated ordinal responses assuming a cumulative link model for
the marginal probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmult.clm(clsize = clsize, intercepts = intercepts, betas = betas,
  xformula = formula(xdata), xdata = parent.frame(), link = "logit",
  cor.matrix = cor.matrix, rlatent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clsize</code></td>
<td>
<p>integer indicating the common cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercepts</code></td>
<td>
<p>numerical vector or matrix containing the intercepts of
the marginal cumulative link model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>numerical vector or matrix containing the value of the marginal
regression parameter vector associated with the covariates (i.e., excluding
<code>intercepts</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xformula</code></td>
<td>
<p>formula expression as in other marginal regression models
but without including a response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>optional data frame containing the variables provided in
<code>xformula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character string indicating the link function in the marginal
cumulative link model. Options include <code>'probit'</code>, <code>'logit'</code>,
<code>'cloglog'</code> or <code>'cauchit'</code>. Required when <code>rlatent = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.matrix</code></td>
<td>
<p>matrix indicating the correlation matrix of the
multivariate normal distribution when the NORTA method is employed
(<code>rlatent = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>matrix with <code>clsize</code> columns containing realizations of
the latent random vectors when the NORTA method is not preferred. See
details for more info.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formulae are easier to read from either the Vignette or the Reference
Manual (both available
<a href="https://CRAN.R-project.org/package=SimCorMultRes">here</a>).
</p>
<p>The assumed marginal cumulative link model is </p>
<p style="text-align: center;"><code class="reqn">Pr(Y_{it}\le j
|x_{it})=F(\beta_{tj0} +\beta^{'}_{t} x_{it})</code>
</p>
<p> where <code class="reqn">F</code> is the
cumulative distribution function determined by <code>link</code>. For subject
<code class="reqn">i</code>, <code class="reqn">Y_{it}</code> is the <code class="reqn">t</code>-th ordinal response and <code class="reqn">x_{it}</code> is
the associated covariates vector. Finally, <code class="reqn">\beta_{tj0}</code> is the
<code class="reqn">j</code>-th category-specific intercept at the <code class="reqn">t</code>-th measurement
occasion and <code class="reqn">\beta_{tj}</code> is the <code class="reqn">j</code>-th category-specific regression
parameter vector at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p>The ordinal response <code class="reqn">Y_{it}</code> is obtained by extending the approach of
<cite>McCullagh (1980)</cite> as suggested in <cite>Touloumis (2016)</cite>.
</p>
<p>When <code class="reqn">\beta_{tj0}=\beta_{j0}</code> for all <code class="reqn">t</code>, then <code>intercepts</code>
should be provided as a numerical vector. Otherwise, <code>intercepts</code> must
be a numerical matrix such that row <code class="reqn">t</code> contains the category-specific
intercepts at the <code class="reqn">t</code>-th measurement occasion.
</p>
<p><code>betas</code> should be provided as a numeric vector only when
<code class="reqn">\beta_{t}=\beta</code> for all <code class="reqn">t</code>. Otherwise, <code>betas</code> must be
provided as a numeric matrix with <code>clsize</code> rows such that the
<code class="reqn">t</code>-th row contains the value of <code class="reqn">\beta_{t}</code>. In either case,
<code>betas</code> should reflect the order of the terms implied by
<code>xformula</code>.
</p>
<p>The appropriate use of <code>xformula</code> is <code>xformula = ~ covariates</code>,
where <code>covariates</code> indicate the linear predictor as in other marginal
regression models.
</p>
<p>The optional argument <code>xdata</code> should be provided in “long” format.
</p>
<p>The NORTA method is the default option for simulating the latent random
vectors denoted by <code class="reqn">e^{O1}_{it}</code> in <cite>Touloumis (2016)</cite>. To import
simulated values for the latent random vectors without utilizing the NORTA
method, the user can employ the <code>rlatent</code> argument. In this case,
element (<code class="reqn">i,t</code>) of <code>rlatent</code> represents the realization of
<code class="reqn">e^{O1}_{it}</code>.
</p>


<h3>Value</h3>

<p>Returns a list that has components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>Ysim</code></td>
<td>
<p>the simulated
ordinal responses. Element (<code class="reqn">i</code>,<code class="reqn">t</code>) represents the realization of
<code class="reqn">Y_{it}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simdata</code></td>
<td>
<p>a data frame that includes the simulated
response variables (y), the covariates specified by <code>xformula</code>,
subjects' identities (id) and the corresponding measurement occasions
(time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlatent</code></td>
<td>
<p>the latent random variables denoted by
<code class="reqn">e^{O1}_{it}</code> in <cite>Touloumis (2016)</cite>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anestis Touloumis
</p>


<h3>References</h3>

<p>Cario, M. C. and Nelson, B. L. (1997) <em>Modeling and
generating random vectors with arbitrary marginal distributions and
correlation matrix</em>. Technical Report, Department of Industrial Engineering
and Management Sciences, Northwestern University, Evanston, Illinois.
</p>
<p>Li, S. T. and Hammond, J. L. (1975) Generation of pseudorandom numbers with
specified univariate distributions and correlation coefficients. <em>IEEE
Transactions on Systems, Man and Cybernetics</em> <b>5</b>, 557–561.
</p>
<p>McCullagh, P. (1980) Regression models for ordinal data. <em>Journal of
the Royal Statistical Society B</em> <b>42</b>, 109–142.
</p>
<p>Touloumis, A. (2016) Simulating Correlated Binary and Multinomial Responses
under Marginal Model Specification: The SimCorMultRes Package. <em>The R
Journal</em> <b>8</b>, 79–91.
</p>
<p>Touloumis, A., Agresti, A. and Kateri, M. (2013) GEE for multinomial
responses using a local odds ratios parameterization. <em>Biometrics</em>
<b>69</b>, 633–640.
</p>


<h3>See Also</h3>

<p><code>rmult.bcl</code> for simulating correlated nominal
responses, <code>rmult.crm</code> and <code>rmult.acl</code> for
simulating correlated ordinal responses and <code>rbin</code> for
simulating correlated binary responses.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See Example 3.2 in the Vignette.
set.seed(12345)
sample_size &lt;- 500
cluster_size &lt;- 4
beta_intercepts &lt;- c(-1.5, -0.5, 0.5, 1.5)
beta_coefficients &lt;- matrix(c(1, 2, 3, 4), 4, 1)
x &lt;- rep(rnorm(sample_size), each = cluster_size)
latent_correlation_matrix &lt;- toeplitz(c(1, 0.85, 0.5, 0.15))
simulated_ordinal_dataset &lt;- rmult.clm(clsize = cluster_size,
  intercepts = beta_intercepts, betas = beta_coefficients, xformula = ~x,
  cor.matrix = latent_correlation_matrix, link = "probit")
head(simulated_ordinal_dataset$simdata, n = 8)

## Same sampling scheme except that the parameter vector is time-stationary.
set.seed(12345)
simulated_ordinal_dataset &lt;- rmult.clm(clsize = cluster_size, betas = 1,
  xformula = ~x, cor.matrix = latent_correlation_matrix,
  intercepts = beta_intercepts, link = "probit")
## Fit a GEE model (Touloumis et al., 2013) to estimate the regression
## coefficients.
library(multgee)
ordinal_gee_model &lt;- ordLORgee(y ~ x, id = id, repeated = time,
  link = "probit", data = simulated_ordinal_dataset$simdata)
coef(ordinal_gee_model)
</code></pre>


</div>