<div class="container">

<table style="width: 100%;"><tr>
<td>selectSpecies</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select species based on traits</h2>

<h3>Description</h3>

<p>This function returns a probability distribution for a species pool based on their traits and a desired trait profile (Laughlin 2014). It can simultaneously constrain specific trait value(s) and optimise functional diversity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectSpecies(t2c = NULL, constraints = NULL, t2d, obj = c("QH", "Q",
  "H"), phi = 0.5, capd = FALSE, euclid = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t2c</code></td>
<td>
<p>"Traits to constrain": A matrix of species trait values, where species are organized as rows and traits as columns. These should be numeric arrays, and no missing values are tolerated. Ordinal data will yield meaningful results, but nominal data entered as numeric vectors are invalid. Row and column names are optional. This matrix can be any dimension, but the number of traits should be less than the number of species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>Trait constraints: A vector of trait values that serve as constants in the constraint equations. If not specified, the function will not constrain solutions to trait means. These trait contraints must be listed in the same order as columns in t2c. These constraints are community-weighted mean trait values, i.e., average traits weighted by the relative abundance of each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2d</code></td>
<td>
<p>"Traits to diversify": Can be 1) a matrix of species trait values to diversify where species are organized as rows and traits as columns. NAs are tolerated as long as each pair of species can be compared by at least one trait. In this case, dissimilarities among species are computed using Euclidean distance. The number of species in t2d must match those in t2c. Or 2) a distance matrix of class 'dist' that contains dissimilarities among species, no NAs are tolerated in the distance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Objective function: The objective function to optimise, one of three possibilities = c("QH", "Q", "H"). QH = Quadratic entropy (Q) plus entropy (H'); Q = Quadratic entropy; H = entropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A parameter bounded between 0 and 1 that weights the importance of either quadratic entropy or entropy (default = 0.5). Phi of 1 corresponds to 100 percent Q, phi of 0.5 corresponds to 50 percent Q and 50 perfect H', phi of 0 corresponds to 100 percent H'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>capd</code></td>
<td>
<p>A logical stating whether the distance matrix should be capped at the mean distance among species (default = FALSE). Mean distance is calculated as the average of all upper triangular entries in the distance matrix calculated from t2d.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>euclid</code></td>
<td>
<p>A logical stating whether the distance matrix should be transformed to an Euclidean matrix if necessary (default = TRUE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the elements: </p>
<table>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Probabilities, i.e. optimal solutions of species relative abundance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cwm_t2d</code></td>
<td>
<p>Community-weighted mean trait values of resulting community for traits that were diversified, computed as probabilities x t2d using matrix multiplication</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cwm_t2c</code></td>
<td>
<p>Community-weighted mean trait values of resulting community for traits that were constrained, computed as probabilities x t2d using matrix multiplication</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Final entropy of community</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Final Rao Q of community</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objval</code></td>
<td>
<p>Values of the objective function being maximized. The last value is the maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagrange</code></td>
<td>
<p>Lagrange multipliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>The Hessian at the optimal solution.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Laughlin, D.C. 2014. Applying trait-based models to achieve functional targets for theory-driven ecological restoration. Ecology Letters, 17, 771-784.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### 1 trait constraint with maximum entropy
Spp &lt;- 5 #S = number of species
trait &lt;- as.matrix(data.frame(trait=c(1:Spp)))
rownames(trait) &lt;- c(letters[1:nrow(trait)])
result1 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="H", capd=FALSE)
### compare result1 with virtually identical maxent output from FD package
#FD::maxent(constr=c(3.5),states=trait)$prob
### 1 trait constraint with maximum functional diversity
result2 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="Q", capd=FALSE)
### 1 trait constraint with maximum functional diversity and entropy
result3 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="QH", capd=FALSE)

### Plot results
plotProbs(result1,trait, xlab="Trait")
plotProbs(result2,trait, xlab="Trait")
plotProbs(result3,trait, xlab="Trait")

### 1 trait and no trait constraint
result4 &lt;- selectSpecies(t2d=trait, obj="QH", capd=FALSE)
plotProbs(result4,trait, xlab="Trait")

##### 2 traits: Constrain trait X at X=3, diversify trait Y
traitX &lt;- matrix(c(rep(1,4),rep(2,4),rep(3,4),rep(4,4)))
traitY &lt;- matrix(c(rep(c(1,2,3,4),4)))
rownames(traitX) &lt;- c(letters[1:16]); colnames(traitX) &lt;- c("traitX")
rownames(traitY) &lt;- c(letters[1:16]); colnames(traitY) &lt;- c("traitY")

result5 &lt;- selectSpecies(t2c=traitX,constraints=c(traitX=3),t2d=traitY,obj="Q",capd=FALSE)
result6 &lt;- selectSpecies(t2c=traitX,constraints=c(traitX=3),t2d=traitY,obj="QH",capd=TRUE)

trait.matrix &lt;- cbind(traitX, traitY)
plotProbs(result5,trait.matrix)
plotProbs(result6,trait.matrix)

##### 3 traits: Constrain trait Z to value 2.5, diversify trait X and Y
traitZ &lt;- as.matrix(data.frame(c(1,3,2,2,3,1,2,3,1,2,1,3,2,3,2,2)))
rownames(traitZ) &lt;- c(letters[1:16]); colnames(traitZ) &lt;- c("traitZ")
result7 &lt;- selectSpecies(t2c=traitZ,constraints=c(traitZ=2.5),t2d=trait.matrix, capd=TRUE, obj="QH")
plotProbs(result7,trait.matrix)

</code></pre>


</div>