<div class="container">

<table style="width: 100%;"><tr>
<td>simpleCache</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a new cache or load a previously created cache.</h2>

<h3>Description</h3>

<p>Given a unique name for an  R object, and instructions for how to make that
object, use the simpleCache function to create and cache or load the object.
This should be used for computations that take a long time and generate a
table or something used repeatedly (in other scripts, for example). Because
the cache is tied to the object name, there is some danger of causing
troubles if you misuse the caching system. The object should be considered
static.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simpleCache(
  cacheName,
  instruction = NULL,
  buildEnvir = NULL,
  reload = FALSE,
  recreate = FALSE,
  noload = FALSE,
  cacheDir = getCacheDir(),
  cacheSubDir = NULL,
  timer = FALSE,
  buildDir = getOption("RBUILD.DIR"),
  assignToVariable = NULL,
  loadEnvir = parent.frame(),
  searchEnvir = getOption("SIMPLECACHE.ENV"),
  nofail = FALSE,
  batchRegistry = NULL,
  batchResources = NULL,
  pepSettings = NULL,
  ignoreLock = FALSE,
  lifespan = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cacheName</code></td>
<td>
<p>A character vector for a unique name for the cache. Be careful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instruction</code></td>
<td>
<p>R expression (in braces) to be evaluated. The returned value of this
code is what will be cached under the cacheName.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buildEnvir</code></td>
<td>
<p>An environment (or list) providing additional variables
necessary for evaluating the code in instruction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reload</code></td>
<td>
<p>Logical indicating whether to force re-loading the cache,
even if it exists in the env.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recreate</code></td>
<td>
<p>Logical indicating whether to force reconstruction of the
cache</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noload</code></td>
<td>
<p>Logical indicating whether to create but not load the cache.
noload is useful for: you want to create the caches, but not load (like a
cache creation loop).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cacheDir</code></td>
<td>
<p>Character vector specifying the directory where caches are
saved (and loaded from). Defaults to the variable set by
<code>setCacheDir()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cacheSubDir</code></td>
<td>
<p>Character vector specifying a subdirectory within the
<code>cacheDir</code> variable. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timer</code></td>
<td>
<p>Logical indicating whether to report how long it took to create
the cache.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buildDir</code></td>
<td>
<p>Location of Build files (files with instructions for use If
the instructions argument is not provided). Defaults to RBUILD.DIR
global option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assignToVariable</code></td>
<td>
<p>Character vector for a variable name to load the
cache into. By default, <code>simpleCache</code> assigns the cache to a
variable named <code>cacheName</code>; you can overrule that here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadEnvir</code></td>
<td>
<p>An environment. Into which environment would you like to
load the variable? Defaults to <code>parent.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchEnvir</code></td>
<td>
<p>a vector of environments to search for the already loaded
cache.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nofail</code></td>
<td>
<p>By default, simpleCache throws an error if the instructions
fail. Use this option to convert this error into a warning. No cache will
be created, but simpleCache will not then hard-stop your processing. This
is useful, for example, if you are creating a bunch of caches (for
example using <code>lapply</code>) and it's ok if some of them do not complete.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batchRegistry</code></td>
<td>
<p>A <code>batchtools</code> registry object (built with
<code>makeRegistry</code>). If provided, this cache will be created on
the cluster using your batchtools configuration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batchResources</code></td>
<td>
<p>A list of variables to provide to batchtools for
cluster resource managers. Used as the <code>res</code> argument to
<code>batchMap</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pepSettings</code></td>
<td>
<p>Experimental untested feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignoreLock</code></td>
<td>
<p>Internal parameter used for batch job submission; don't
touch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lifespan</code></td>
<td>
<p>Numeric specifying the maximum age of cache, in days, to
allow before automatically triggering <code>recreate=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You should pass a bracketed R code snippet like <code>rnorm(500)</code> as the
instruction, and simpleCache will create the object. Alternatively, if the
code to create the cache is large, you can put an R script called object.R in
the <code>RBUILD.DIR</code> (the name of the file *must* match the name of the object it
creates *exactly*). If you don't provide an instruction, the function sources
RBUILD.DIR/object.R and caches the result as the object. This source file
*must* create an object with the same name of the object. If you already have
an object with the name of the object to load in your current environment,
this function will not try to reload the object; instead, it returns the
local object. In essence, it assumes that this is a static object, which you
will not change. You can force it to load the cached version instead with
"reload".
</p>
<p>Because R uses lexical scope and not dynamic scope, you may need to pass some
environment variables you use in your instruction code. You can use this
using the parameter buildEnvir (just provide a list of named variables).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># choose location to store caches
cacheDir = tempdir()
cacheDir
setCacheDir(cacheDir)

# build some caches
simpleCache("normSample", { rnorm(5e3, 0,1) }, recreate=TRUE, timer=TRUE)
simpleCache("normSample", { rnorm(5e3, 0,1) })
simpleCache("normSample", { rnorm(5e3, 0,1) }, reload=TRUE)

# storing a cache after-the-fact
normSample2 = rnorm(10, 0, 1)
storeCache("normSample2")

# what's available?
listCaches()

# load a cache
simpleCache("normSample")

# load multiples caches
loadCaches(c("normSample", "normSample2"), reload=TRUE)
</code></pre>


</div>