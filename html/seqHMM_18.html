<div class="container">

<table style="width: 100%;"><tr>
<td>hmm_biofam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hidden Markov model for the biofam data</h2>

<h3>Description</h3>

<p>A five-state hidden Markov model (HMM) fitted for the <code>biofam</code> data.
</p>


<h3>Format</h3>

<p>A hidden Markov model of class <code>hmm</code>;
a left-to-right model with four hidden states.
</p>


<h3>Details</h3>

<p>The model is loaded by calling <code>data(hmm_biofam)</code>. It was created with the
following code:
</p>
<pre>
data("biofam3c")

# Building sequence objects
marr_seq &lt;- seqdef(biofam3c$married, start = 15,
  alphabet = c("single", "married", "divorced"))
child_seq &lt;- seqdef(biofam3c$children, start = 15,
  alphabet = c("childless", "children"))
left_seq &lt;- seqdef(biofam3c$left, start = 15,
  alphabet = c("with parents", "left home"))

## Choosing colors
attr(marr_seq, "cpal") &lt;- c("violetred2", "darkgoldenrod2", "darkmagenta")
attr(child_seq, "cpal") &lt;- c("darkseagreen1", "coral3")
attr(left_seq, "cpal") &lt;- c("lightblue", "red3")

init &lt;- c(0.9, 0.05, 0.02, 0.02, 0.01)

# Starting values for transition matrix
trans &lt;- matrix(
  c(0.8, 0.10, 0.05, 0.03, 0.02,
    0,    0.9, 0.05, 0.03, 0.02,
    0,      0,  0.9, 0.07, 0.03,
    0,      0,    0,  0.9,  0.1,
    0,      0,    0,    0,    1),
  nrow = 5, ncol = 5, byrow = TRUE)

# Starting values for emission matrices
emiss_marr &lt;- matrix(
  c(0.9, 0.05, 0.05, # High probability for single
    0.9, 0.05, 0.05,
    0.05, 0.9, 0.05, # High probability for married
    0.05, 0.9, 0.05,
    0.3, 0.3, 0.4), # mixed group
  nrow = 5, ncol = 3, byrow = TRUE)

emiss_child &lt;- matrix(
  c(0.9, 0.1, # High probability for childless
    0.9, 0.1,
    0.1, 0.9,
    0.1, 0.9,
    0.5, 0.5),
  nrow = 5, ncol = 2, byrow = TRUE)

emiss_left &lt;- matrix(
  c(0.9, 0.1, # High probability for living with parents
    0.1, 0.9,
    0.1, 0.9,
    0.1, 0.9,
    0.5, 0.5),
  nrow = 5, ncol = 2, byrow = TRUE)

initmod &lt;- build_hmm(
  observations = list(marr_seq, child_seq, left_seq),
  initial_probs = init, transition_probs = trans,
  emission_probs = list(emiss_marr, emiss_child,
    emiss_left),
  channel_names = c("Marriage", "Parenthood", "Residence"))

fit_biofam &lt;- fit_model(initmod, em = FALSE, local = TRUE)
hmm_biofam &lt;- fit_biofam$model
</pre>


<h3>See Also</h3>

<p>Examples of building and fitting HMMs in <code>build_hmm</code> and
<code>fit_model</code>; and <code>biofam</code> for the original data and
<code>biofam3c</code> for the three-channel version used in this model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Plotting the model
plot(hmm_biofam)

</code></pre>


</div>