<div class="container">

<table style="width: 100%;"><tr>
<td>computeLogLikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the log-likelihood.</h2>

<h3>Description</h3>

<p>This is an internal function that is only exposed on the public API for unit testing purposes.
It computes the log-likelihood of the spline and the noise, once the spectral signature has
been subtracted from the observed data. Thus, it can be used with either Lorentzian, Gaussian,
or pseudo-Voigt broadening functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">computeLogLikelihood(
  obsi,
  lambda,
  prErrNu,
  prErrSS,
  basisMx,
  eigVal,
  precMx,
  xTx,
  aMx,
  ruMx
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obsi</code></td>
<td>
<p>Vector of residuals after the spectral signature has been subtracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter of the penalised B-spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prErrNu</code></td>
<td>
<p>hyperparameter of the additive noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prErrSS</code></td>
<td>
<p>hyperparameter of the additive noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basisMx</code></td>
<td>
<p>Matrix of B-spline basis functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigVal</code></td>
<td>
<p>eigenvalues of the Demmler-Reinsch factorisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precMx</code></td>
<td>
<p>precision matrix for the spline</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xTx</code></td>
<td>
<p>sparse matrix cross-product</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aMx</code></td>
<td>
<p>orthoganal matrix A from the Demmler-Reinsch factorisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ruMx</code></td>
<td>
<p>product of Ru from the Demmler-Reinsch factorisation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The logarithm of the likelihood.
</p>


</div>