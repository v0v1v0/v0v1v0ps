<div class="container">

<table style="width: 100%;"><tr>
<td>sbdiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Perform simultaneous confidence intervals or adjusted p–values
for the Shannon and the Simpson index.
</h2>

<h3>Description</h3>

<p>Function <code>sbdiv</code> estimates simultaneous confidence intervals for the
Shannon or the Simpson index. This function provides calculation of
several pre–defined contrasts for confidence intervals.Further
self-defined contrast are applicable. Simultaneous resampling confidence
intervals are estimated according to the Algorithm of Besag et
al. (1995) using method <code>rpht</code>, Westfall et al. (1993) using
method <code>WYht</code> or similar to Beran (1988) using method
<code>tsht</code>. Further estimation of simultaneous asymptotic
intervals adjusting for heterogeneous variances is provided by method
<code>asht</code> according to Fritsch and Hsu (1999) and Rogers and
Hsu (2001). However, estimation of asymptotic intervals may make
no sense in data sets with replicated samples due to overdispersion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sbdiv(X, f, theta = c("Shannon", "Simpson"),
type = c("Dunnett", "Tukey", "Sequen", "AVE", 
                     "Changepoint", "Williams", "Marcus", 
                     "McDermott", "UmbrellaWilliams", "GrandMean"),
cmat = NULL, method = c("WYht", "tsht", "rpht", "asht"), conf.level =
0.95, alternative = c("two.sided", "less", "greater"), R = 2000, base =
1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Data frame containing numerical values for counts in columns. Every
column represents on species.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>Vector of factorial variables for treatment groups. Vector length
must be equal to the length of treatment groups multiplicated with
sample replications.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Biodiversity index. Options are Shannon and Simpson index.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of comparison. Options are Dunnett, Tukey, Sequen, AVE,
Changepoint, Williams, Marcus, McDermott, UmbrellaWilliams,
GrandMean intervals. We tested only Dunnett and Tukey contrasts in
simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmat</code></td>
<td>

<p>Optional self-defined contrast matrix. In case of using this
argument, the type argument is not considered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Possible methods are simultaneous bootstrap confidence intervals:
<code>WYht</code>, <code>tsht</code>, <code>rpht</code> and asymptotic
simultaneous confidence intervals: <code>asht</code>. Adjusted and
unadjusted <code class="reqn">p</code>–values are estimated with method
<code>WYht</code> and method <code>tsht</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>Pre-defined overall confidence level. Default is 0.95, while
two-sided inference is estimated with <code class="reqn">(1-conf.level)/2</code> for
each side and one-sided inference is estimated with
<code class="reqn">1-conf.level</code> for the side of interest.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>Specified type of interval. Could be "one-sided" or "two.sided".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Number of bootstrap steps. Default is 2000, which is a good
compromise between accuracy and computing time
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>

<p>Control group. base = 1 uses the first group in alphabetical order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further optional arguments for the internal used function <code>boot</code> from
package <span class="pkg">boot</span>. Most importantly, the number of Bootstrap samples can
be chosen via the parameter <code>R</code> (default is <code>R=2000</code>); see
<code>?boot</code> for further options.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sbdiv</code> is the main function for estimating the different
multiplicity adjusted confidence intervals. Different methods are
called from internal functions.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conf.int </code></td>
<td>
<p>estimate: Estimated difference between groups. Estimators
differ between the methods due to calculation. lower: Lower bounds
of estimated intervals. upper: Upper bounds of estimated intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value </code></td>
<td>
<p>adj. p: multiplicity adjusted p-values. raw p:
unadjusted p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level </code></td>
<td>
<p>Pre-specified confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative </code></td>
<td>
<p>Pre-specified alternative</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ralph Scherer
</p>


<h3>References</h3>

<p>Scherer, R. and Schaarschmidt, F. (2013) Simultaneous confidence intervals
for comparing biodiversity indices estimated from overdispersed count
data. <em>Biometrical Journal</em> 55, 246–263.
</p>
<p>Evaluation of the methods in <code>sbdiv</code>
</p>
<p>Westfall, P. H. and Young, S. S. (1993) Resampling-Based
Multiple Testing: Examples and Methods for <code class="reqn">p</code>–Value
Adjustment. New York: Wiley.
</p>
<p>Corresponding method <code>sbdiv</code> with method <code>WYht</code>
</p>
<p>Besag, J., Green, P. J., Higdon, D., Mengersen, K. (1995)
Bayesian computation and stochastic systems (with discussion)
. <em>Statistical Science</em>, 10, 3–66.
</p>
<p>Corresponding method <code>sbdiv</code> with method <code>rpht</code>
</p>
<p>Beran, R. (1988) Balanced simultaneous confidence
sets. <em>Journal of the American Statistical Association</em>, 83, 679–686.
</p>
<p>Corresponding method <code>sbdiv</code> with method <code>tsht</code>
</p>
<p>Fritsch, K. S., Hsu, J. C. (1999) Multiple comparison of
entropies with application to dinosaur biodiversity. <em>Biometrics</em>,
55, 4, 1300–1305.
</p>
<p>Rogers, J. A., Hsu, J. C. (2001) Multiple comparisons of
biodiversity. <em>Biometrical Journal</em>, 43, 5, 617–625.
</p>
<p>Corresponding method <code>sbdiv</code> with method <code>asht</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## For plots of the datasets see the help files for the data sets.

## First dataset
data(predatGM)

## structure of data
str(predatGM)

## remove block variable
datspec_1 &lt;- predatGM[, -1]
str(datspec_1)

## Order of factorial variable
datspec_1$Variety

## argument base = 1 uses GM as control group. Not directly executable
## due to intensive computing time
# sbdiv(X = datspec_1[, 2:length(datspec_1)], f = datspec_1[, 1], theta =
# "Shannon", type = "Dunnett", method = "WYht", conf.level = 0.95,
# alternative = "two.sided", R = 2000, base = 1)

## Directly executable but senseless value for boot steps R
sbdiv(X = datspec_1[, 2:length(datspec_1)], f = datspec_1[, 1], theta =
"Shannon", type = "Dunnett", method = "WYht", conf.level = 0.95,
alternative = "two.sided", R = 100, base = 1)


## Second dataset
data(saproDipGM)

## structure
str(saproDipGM)

## remove block variable
datspec_2 &lt;- saproDipGM[, -1]
str(datspec_2)

## Order of factor variable
datspec_2$Variety

## argument base = 2 uses Ins as control group. Not directly executable
## due to intensive computing time
# sbdiv(X = datspec_2[, 2:length(datspec_2)], f = datspec_2[, 1], theta =
# "Shannon", type = "Dunnett", method = "rpht", conf.level = 0.95,
# alternative = "two.sided", R = 2000, base = 2)

## Directly executable but senseless value for boot steps R
sbdiv(X = datspec_2[, 2:length(datspec_2)], f = datspec_2[, 1], theta =
"Shannon", type = "Dunnett", method = "rpht", conf.level = 0.95,
alternative = "two.sided", R = 100, base = 2)

</code></pre>


</div>