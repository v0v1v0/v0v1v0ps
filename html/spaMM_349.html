<div class="container">

<table style="width: 100%;"><tr>
<td>spaMM.filled.contour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Level (Contour) Plots with better aspect ratio control (for geographical maps, at least)</h2>

<h3>Description</h3>

<p>This function is derived from <code>filled.contour</code> in the <code>graphics</code> package, and 
this documentation is likewise heavily based on that of <code>filled.contour</code>.
</p>
<p>This function likewise produces a contour plot with the areas between the
contours filled in solid color, and a 
key showing how the colors map to z values is likewise shown to the right of
the plot.
The only difference is the way the aspect ratio is determined and can be controlled (using the <code>map.asp</code> parameter instead of <code>asp</code>),
They thus easily provide nice-looking maps with meaningful latitude/longitude ratio (see Examples). However, this does not work well with rstudio.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spaMM.filled.contour(x = seq(0, 1, length.out = nrow(z)),
               y = seq(0, 1, length.out = ncol(z)),
               z,
               xrange = range(x, finite = TRUE),
               yrange = range(y, finite = TRUE),
               zrange = range(z, finite = TRUE, na.rm=TRUE),
               margin=1/20,
               levels = pretty(zrange, nlevels), nlevels = 20,
               color.palette = spaMM.colors,
               col = color.palette(length(levels) - 1),
               plot.title, plot.axes, key.title=NULL, key.axes=NULL,
               map.asp = NULL, xaxs = "i", yaxs = "i", las = 1,
               axes = TRUE, frame.plot = axes, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  (The rest of this
description does not apply to <code>.filled.contour</code>.)
By default, equally spaced values from 0 to 1 are used.  If <code>x</code>
is a <code>list</code>, its components <code>x$x</code> and <code>x$y</code> are used
for <code>x</code> and <code>y</code>, respectively.  If the list has component
<code>z</code> this is used for <code>z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a numeric matrix containing the values to be plotted..  Note that
<code>x</code> can be used instead of <code>z</code> for convenience.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xrange</code></td>
<td>
<p>x range of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrange</code></td>
<td>
<p>y range of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zrange</code></td>
<td>
<p>z range of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>

<p>This controls how far (in relative terms) the plot extends beyond the x and y ranges 
of the analyzed points, and is overriden by explicit <code>xrange</code> and <code>yrange</code> arguments.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a set of levels which are used to partition the range
of <code>z</code>.  Must be <b>strictly</b> increasing (and finite).  Areas
with <code>z</code> values between consecutive levels are painted with the
same color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>if <code>levels</code> is not specified, the range of <code>z</code>,
values is divided into approximately this many levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>a color palette function to be used to assign
colors in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>an explicit set of colors to be used in the plot.
This argument overrides any palette function specification.  There
should be one less color than levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>statements which add titles to the main plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.axes</code></td>
<td>
<p>statements which draw axes (and a <code>box</code>)
on the main plot.  This overrides the default axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.title</code></td>
<td>
<p>statements which add titles for the plot key.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.axes</code></td>
<td>
<p>statements which draw axes on the plot key.
This overrides the default axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.asp</code></td>
<td>
  
<p>the y/x aspect ratio of the 2D plot area (not of the full figure including the scale). Default is (plotted y range)/(plotted x range) (i.e., scales for x are identical). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs</code></td>
<td>
<p>the x axis style.  The default is to use internal
labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxs</code></td>
<td>
<p>the y axis style.  The default is to use internal
labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p>the style of labeling to be used.  The default is to
use horizontal labeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes, frame.plot</code></td>
<td>
<p>logicals indicating if axes and a box should be
drawn, as in <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphical parameters, currently only passed to
<code>title()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values to be plotted can contain <code>NA</code>s.  Rectangles with two
or more corner values are <code>NA</code> are omitted entirely: where there
is a single <code>NA</code> value the triangle opposite the <code>NA</code> is
omitted.
</p>
<p>Values to be plotted can be infinite: the effect is similar to that
described for <code>NA</code> values.
</p>


<h3>Value</h3>

<p>This returns invisibly a list with elements of the plot, the  <code>x</code>,  <code>y</code>,  <code>z</code> coordinates and the contour <code>levels</code>.
</p>


<h3>Note</h3>

<p>Builds heavily on filled.contour by Ross Ihaka and R-core.
<code>spaMM.filled.contour</code> uses the <code>layout</code> function and so is
restricted to a full page display.
</p>
<p>The output produced by <code>spaMM.filled.contour</code> is actually a combination
of two plots; one is the filled contour and one is the legend.  Two
separate coordinate systems are set up for these two plots, but they
are only used internally â€“ once the function has returned these
coordinate systems are lost.  If you want to annotate the main contour
plot, for example to add points, you can specify graphics commands in
the <code>plot.axes</code> argument.  See the Examples.
</p>


<h3>References</h3>

<p>Cleveland, W. S. (1993)
<em>Visualizing Data</em>.
Summit, New Jersey: Hobart.
</p>


<h3>See Also</h3>

<p><code>contour</code>, <code>image</code>,
<code>palette</code>; <code>contourplot</code>
and <code>levelplot</code> from package <code>lattice</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">spaMM.filled.contour(volcano, color.palette = spaMM.colors) # simple

## Comparing the layout with that of filled.contour:
#  (except that it does not always achieve the intended effect 
#  in RStudio Plots pane). 

x &lt;- 10*1:nrow(volcano)
y &lt;- 10*1:ncol(volcano)
spaMM.filled.contour(x, y, volcano, color.palette = terrain.colors,
    plot.title = title(main = "The Topography of Maunga Whau",
    xlab = "Meters North", ylab = "Meters West"),
    plot.axes = { axis(1, seq(100, 800, by = 100))
                  axis(2, seq(100, 600, by = 100)) },
    key.title = title(main = "Height\n(meters)"),
    key.axes = axis(4, seq(90, 190, by = 10)))  # maybe also asp = 1
mtext(paste("spaMM.filled.contour(.) from", R.version.string),
      side = 1, line = 4, adj = 1, cex = .66)

## compare with      

filled.contour(x, y, volcano, color.palette = terrain.colors,
    plot.title = title(main = "The Topography of Maunga Whau",
    xlab = "Meters North", ylab = "Meters West"),
    plot.axes = { axis(1, seq(100, 800, by = 100))
                  axis(2, seq(100, 600, by = 100)) },
    key.title = title(main = "Height\n(meters)"),
    key.axes = axis(4, seq(90, 190, by = 10)))  # maybe also asp = 1
mtext(paste("filled.contour(.) from", R.version.string),
      side = 1, line = 4, adj = 1, cex = .66)

</code></pre>


</div>