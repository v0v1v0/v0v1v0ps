<div class="container">

<table style="width: 100%;"><tr>
<td>hyperpar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Scale Parameters for Inverse Gamma Hyperprior of Nonlinear Effects with Spike and Slab Prior (Simulation-based)</h2>

<h3>Description</h3>

<p>This function implements a optimisation routine that computes the scale parameter <code class="reqn">b</code> and selection parameter
<code class="reqn">r</code>. . Here, we assume an inverse gamma prior IG(<code class="reqn">a</code>,<code class="reqn">b</code>) for <code class="reqn">\psi^2</code> and <code class="reqn">\tau^2\sim N(0,r(\delta)\psi^2)</code> 
and given shape paramter <code class="reqn">a</code>,
such that approximately <code class="reqn">P(f(x)\le c|spike,\forall x\in D)\ge 1-\alpha1</code> and <code class="reqn">P(\exists x\in D s.t. f(x)\ge c|slab)\ge 1-\alpha2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hyperpar(Z, Kinv, a = 5, c = 0.1, alpha1 = 0.1, alpha2 = 0.1,
  R = 10000, myseed = 123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the row of the design matrix (or the complete matrix of several observations) evaluated at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p>the generalised inverse of <code class="reqn">K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>is the shape parameter of the inverse gamma distribution, default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>denotes the expected range of eqnf .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>
<p>denotes the 1-<code class="reqn">\alpha1</code> level for <code class="reqn">b</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>
<p>denotes the 1-<code class="reqn">\alpha2</code> level for <code class="reqn">r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>denotes the number of replicates drawn during simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myseed</code></td>
<td>
<p>denotes the required seed for the simulation based method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>list</code> with root values <code class="reqn">r</code>, <code class="reqn">b</code> from <code>uniroot</code>.
</p>


<h3>Author(s)</h3>

<p>Nadja Klein
</p>


<h3>References</h3>

<p>Nadja Klein, Thomas Kneib, Stefan Lang and Helga Wagner (2016). Spike and Slab Priors for Effect Selection in Distributional Regression. 
<em>Working Paper</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
library(MASS)
# prior precision matrix (second order differences) 
# of a spline of degree l=3 and with m=22 inner knots
# yielding dim(K)=m+l-1=22
K &lt;- t(diff(diag(22), differences=2))%*%diff(diag(22), differences=2)
# generalised inverse of K (same as if we used mixed model representation!)
Kinv &lt;- ginv(K)
# covariate x
x &lt;- runif(1)
Z &lt;- matrix(DesignM(x)$Z_B,nrow=1)
fgrid &lt;- seq(-3,3,length=1000)
mdf &lt;- hyperpar(Z,Kinv,a=5,c=0.1,alpha1=0.05,alpha2=0.05,R=10000,myseed=123)

</code></pre>


</div>