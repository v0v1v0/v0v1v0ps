<div class="container">

<table style="width: 100%;"><tr>
<td>summarize_ewma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exponential weighted moving average summarizer</h2>

<h3>Description</h3>

<p>Compute exponential weighted moving average (EWMA) of 'column' and store
results in a new column named '&lt;column&gt;_ewma'
At time t[n], the i-th value x[i] with timestamp t[i] will have a weighted
value of [weight(i, n) * x[i]], where weight(i, n) is determined by both
'alpha' and 'smoothing_duration'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">summarize_ewma(
  ts_rdd,
  column,
  alpha = 0.05,
  smoothing_duration = "1d",
  time_column = "time",
  convention = c("core", "legacy"),
  key_columns = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts_rdd</code></td>
<td>
<p>Timeseries RDD being summarized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>
<p>Column to be summarized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A smoothing factor between 0 and 1 (default: 0.05) â€“ a higher
alpha discounts older observations faster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing_duration</code></td>
<td>
<p>A time duration specified in string form (e.g.,
"1d", "1h", "15m", etc) or "constant".
The weight applied to a past observation from time t[p] at time t[n] is
jointly determined by 'alpha' and 'smoothing_duration'.
</p>
<p>If 'smoothing_duration' is a fixed time duration such as "1d", then
weight(p, n) = (1 - alpha) ^ [(t[n] - t[p]) / smoothing_duration]
</p>
<p>If 'smoothing_duration' is "constant", then
weight(p, n) = (1 - alpha) ^ (n - p)
(i.e., this option assumes the difference between consecutive timestamps
is equal to some constant 'diff', and 'smoothing_duration' is effectively
also equal to 'diff', so that t[n] - t[p] = (n - p) * diff and
weight(p, n) = (1 - alpha) ^ [(t[n] - t[p]) / smoothing_duration] =
(1 - alpha) ^ [(n - p) * diff / diff] = (1 - alpha) ^ (n - p))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_column</code></td>
<td>
<p>Name of the column containing timestamps (default: "time")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convention</code></td>
<td>
<p>One of "core" or "legacy" (default: "core")
</p>
<p>If 'convention' is "core", then the output will be weighted sum of all
observations divided by the sum of all weight coefficients (see
https://github.com/twosigma/flint/blob/master/doc/ema.md#core).
</p>
<p>If 'convention' is "legacy", then the output will simply be the weighted
sum of all observations, without being normalized by the sum of all weight
coefficients (see
https://github.com/twosigma/flint/blob/master/doc/ema.md#legacy).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key_columns</code></td>
<td>
<p>Optional list of columns that will form an equivalence
relation associating each record with the time series it belongs to (i.e.,
any 2 records having equal values in those columns will be associated with
the same time series, and any 2 records having differing values in those
columns are considered to be from 2 separate time series and will therefore
be summarized separately)
By default, 'key_colums' is empty and all records are considered to be part
of a single time series.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Other summarizers: 
<code>ols_regression()</code>,
<code>summarize_avg()</code>,
<code>summarize_corr2()</code>,
<code>summarize_corr()</code>,
<code>summarize_count()</code>,
<code>summarize_covar()</code>,
<code>summarize_dot_product()</code>,
<code>summarize_ema_half_life()</code>,
<code>summarize_geometric_mean()</code>,
<code>summarize_kurtosis()</code>,
<code>summarize_max()</code>,
<code>summarize_min()</code>,
<code>summarize_nth_central_moment()</code>,
<code>summarize_nth_moment()</code>,
<code>summarize_product()</code>,
<code>summarize_quantile()</code>,
<code>summarize_skewness()</code>,
<code>summarize_stddev()</code>,
<code>summarize_sum()</code>,
<code>summarize_var()</code>,
<code>summarize_weighted_avg()</code>,
<code>summarize_weighted_corr()</code>,
<code>summarize_weighted_covar()</code>,
<code>summarize_z_score()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(sparklyr)
library(sparklyr.flint)

sc &lt;- try_spark_connect(master = "local")

if (!is.null(sc)) {
  price_sdf &lt;- copy_to(
    sc,
    data.frame(
      time = ceiling(seq(12) / 2),
      price = seq(12) / 2,
      id = rep(c(3L, 7L), 6)
    )
  )
  ts &lt;- fromSDF(price_sdf, is_sorted = TRUE, time_unit = "DAYS")
  ts_ewma &lt;- summarize_ewma(
    ts,
    column = "price",
    smoothing_duration = "1d",
    key_columns = "id"
  )
} else {
  message("Unable to establish a Spark connection!")
}

</code></pre>


</div>