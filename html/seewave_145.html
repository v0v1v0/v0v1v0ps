<div class="container">

<table style="width: 100%;"><tr>
<td>specprop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral properties</h2>

<h3>Description</h3>

<p>This function returns a list of statistical properties of a frequency spectrum.</p>


<h3>Usage</h3>

<pre><code class="language-R">specprop(spec, f=NULL,
str = FALSE, flim=NULL, mel=FALSE,
plot = FALSE, type = "l", xlab=NULL, ylab = NULL,
col.mode = 2, col.quartiles = 4, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>a data set resulting of a spectral analysis obtained
with <code>spec</code> or <code>meanspec</code> (not in dB).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>spec</code> (in Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>str</code></td>
<td>
<p>logical, if <code>TRUE</code> returns the results in a structured table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>a vector of length 2 to specifgy the frequency limits of the analysis (in kHz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mel</code></td>
<td>
<p>a logical, if <code>TRUE</code> the (htk-)mel scale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>1</code> returns the spectrum , if <code>2</code> returns 
the cumulative spectrum, both of them with the first quartile, the third quartile,
the median and the mode plotted (by default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label of the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.mode</code></td>
<td>
<p>colour of the mode segments (by default blue).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.quartiles</code></td>
<td>
<p>colour of the quartiles segments (by default red).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>plot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The spectrum is converted in a probability mass function (PMF).<br>
If a selected value has to be selected with $,
the argument <code>str</code> has to be set to <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>A list of 15 values is returned
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>mean frequency (see <code>mean</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>standard deviation of the mean (see <code>sd</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sem</code></td>
<td>
<p>standard error of the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>median frequency (see <code>median</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>mode frequency, <em>i.e.</em> the dominant frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q25</code></td>
<td>
<p>first quartile (see <code>quantile</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q75</code></td>
<td>
<p>third quartile (see <code>quantile</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IQR</code></td>
<td>
<p>interquartile range (see <code>IQR</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cent</code></td>
<td>
<p>centroid, see <code>note</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skewness</code></td>
<td>
<p>skewness, a measure of asymmetry, see <code>note</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kurtosis</code></td>
<td>
<p>kurtosis, a measure of peakedness, see <code>note</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sfm</code></td>
<td>
<p>spectral flatness measure (see <code>sfm</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sh</code></td>
<td>
<p>spectral entropy (see <code>sh</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>frequency precision of the spectrum</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Centroid is computed according to:<br></p>
<p style="text-align: center;"><code class="reqn">C = \sum_{i = 1}^{N} x_i\times{y_i}</code>
</p>
<p><br>
with:<br><em>x</em> = frequencies,
<em>y</em> = relative amplitude of the <em>i</em> frequency,<br><em>N</em> = number of frequencies.<br><br>
Skewness is computed according to:<br></p>
<p style="text-align: center;"><code class="reqn">S = \frac{\sum_{i = 1}^{N}(x_i-\bar{x})^{3}}{N-1}\times{\frac{1}{\sigma^{3}}}</code>
</p>
<p>.<br>
S &lt; 0 when the spectrum is skewed to left,<br>
S = 0 when the spectrum is symetric,<br>
S &gt; 0 when the spectrum is skewed to right.<br>
Spectrum asymmetry increases with |S|.<br><br> 
Kurtosis is computed according to:<br></p>
<p style="text-align: center;"><code class="reqn">K = \frac{\sum_{i = 1}^{N}(x_i-\bar{x})^{4}}{N-1}\times{\frac{1}{\sigma^{4}}}</code>
</p>
<p>.<br>
K &lt; 3 when the spectrum is platikurtic, <em>i.e.</em> it has fewer items at the
center and at the tails than the normal curve but has more items in the shoulders,<br>
K = 3 when the spectrum shows a normal shape,<br>
K &gt; 3 when the spectrum is leptokurtic, <em>i.e.</em> it has more items near
the center and at the tails, with fewer items in the shoulders
relative to normal distribution with the same mean and variance.
</p>


<h3>Author(s)</h3>

<p>Jerome Sueur and Caroline Simonis, and a patch by Jesse Ross
(Dec. 2012)</p>


<h3>Examples</h3>

<pre><code class="language-R">data(orni)
a&lt;-meanspec(orni,f=22050,plot=FALSE)
specprop(a,f=22050)
# to get a single measure of the list
specprop(a,f=22050)$mode
# to get the results structured
specprop(a,f=22050,str=TRUE)
# to limit the analysis between 4 and 6 kHz
specprop(a,f=22050,flim=c(4,6),str=TRUE)
# plots
specprop(a,f=22050,plot=1)
specprop(a,f=22050,plot=2)
# (htk-)mel scale
require(tuneR)
mel &lt;- melfcc(orni, nbands = 256, dcttype = "t3", fbtype = "htkmel", spec_out=TRUE)
melspec.mean &lt;- apply(mel$aspectrum, MARGIN=2, FUN=mean)
specprop(melspec.mean, f=22050, mel=TRUE)
# be aware that flim is always given in kHz even if mel=TRUE
specprop(melspec.mean, f=22050, flim=c(4,6), mel=TRUE, plot=TRUE)
</code></pre>


</div>