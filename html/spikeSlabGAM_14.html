<div class="container">

<table style="width: 100%;"><tr>
<td>srf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate design for penalized surface estimation.</h2>

<h3>Description</h3>

<p>This function generates the design for a 2-D penalized spline using (almost)
radial basis functions. Use this type of term to account for <em>spatial</em>
variation. Smooth interactions between covariates are often better fitted via
the interactions of <code>lin</code> and <code>sm</code> terms, because
they allow a decomposition into (linear and smooth) marginal trends and
(linear-linear, linear-smooth/"varying coefficients", and smooth-smooth)
interactions. This decomposition usually makes no sense for spatial data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">srf(
  coords,
  K = min(50, sum(nd)/4),
  rankZ = 0.999,
  centerBase = TRUE,
  baseType = c("B", "thinPlate"),
  decomposition = c("ortho", "MM", "asIs"),
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>a <code>data.frame</code> with two columns containing the coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>(approximate) number of basis functions in the original basis
(defaults to 50). If <code>baseType ="B"</code> you can specify a vector giving
the number of marginal basis functions in each direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerBase</code></td>
<td>
<p>project the basis of the penalized part into the complement
of the column space of the basis of the unpenalized part? defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseType</code></td>
<td>
<p>Defaults to <code>"B"</code>, i.e. a tensor product basis based on
marginal cubic B-splines with ridge penalty (i.e. penalizing deviations
from the constant). Set to <code>"thinPlate"</code> if cubic thin plate splines
are desired, see note below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomposition</code></td>
<td>
<p>use a (truncated) spectral decomposition of the implied
prior covariance of <code class="reqn">f(x, y)</code> for a low rank representation with
orthogonal    basis functions and i.i.d. coefficients (<code>"ortho"</code>), or use
the mixed model reparameterization for non-orthogonal basis functions and
i.i.d. coefficients (<code>"MM"</code>) or use basis functions as they are with
i.i.d. coefficients (<code>"asIs"</code>). Defaults to <code>"ortho"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>count eigenvalues smaller than this as zero</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that <code>srf()</code> expects <code>coords</code> to be a <code>data.frame</code> within
the larger <code>data.frame</code> supplied to <code>spikeSlabGAM</code> in its
<code>data</code> argument, i.e. <code>coords</code> is considered a two-dimensional
covariate.
</p>
<p>If <code>baseType</code> is <code>'thinPlate'</code>, knot locations for the thin plate
spline basis are chosen via a space-filling algorithm (i.e. medoids returned
by <code>clara</code>) as suggested in Ruppert/Wand/Carroll, ch.
13.5. Since the thin plate penalty term penalizes deviations from a linear
trend, it is recommended to add marginal linear trends and their interaction
to the model if <code>baseType ="thinPlate"</code> to improve the fit.  
</p>
<p>Note that predictions outside the convex hull (sometimes even just close its 
border) of the original data tend to become rather unstable very quickly.
</p>


<h3>Value</h3>

<p>a design matrix for the 2-D spline.
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P., Carroll, R.J. (2003). Semiparametric
Regression. Cambridge University Press
</p>


</div>