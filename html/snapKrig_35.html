<div class="container">

<table style="width: 100%;"><tr>
<td>sk_plot_semi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a semi-variogram</h2>

<h3>Description</h3>

<p>Plots a sample semi-variogram using the point pair difference data in <code>vg</code>.
Binned summary statistics are drawn as circles with size scaled to the sample sizes.
A covariance model (<code>pars</code>) is optionally drawn over the sample data as a ribbon plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sk_plot_semi(vg, pars = NULL, add = FALSE, fun = "classical", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vg</code></td>
<td>
<p>data frame of sample absolute differences, with columns 'dabs', 'd' (and 'bin')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list of the form returned by <code>sk_pars</code> with entries 'y', 'x', 'eps', 'psill'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, indicates to draw on an existing plot rather than create a new one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>character or function, the aggregation function (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further plotting parameters (see below)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>vg</code> is a data frame, it should contain absolute differences (numeric 'dabs'),
inter-point distances (numeric 'd'), and, optionally, an assignment into distance bins
(integer 'bin') for a sample of point pairs. If 'bin' is missing, the function calls
<code>sk_add_bins</code> to assign them automatically.
</p>
<p>Function <code>fun</code> is the statistic to use for estimating the variogram (ie twice the
semi-variogram) from the distance-binned absolute differences in <code>vg</code>. If <code>fun</code> is a
function, it must accept sub-vectors of the numeric <code>vg$dabs</code> as its only argument,
returning a non-negative numeric scalar. <code>fun</code> can also be set to one of the names
'root_median', 'root_mean' (the default), or 'classical', as shorthand for the robust
fourth-root-based methods in section 2.4 of Cressie (1993), or the classical mean of
squares method of Matheron.
</p>
<p>Optional list <code>pars</code> defines a theoretical semi-variogram to draw over the sample data.
When <code>add=TRUE</code>, the function overlays it on an existing plot (without changing the
legend, plot limits etc). Anisotropic models, which may assume a range of semi-variances
for any given distance, are drawn as a ribbon plot.
</p>
<p><code>add=TRUE</code> can only be used in combination with an earlier call to <code>sk_plot_semi</code>
where <code>reset=FALSE</code> (which allows the function to change R's graphical parameters)
</p>
<p><code>vg</code> can be a grid object (anything understood by <code>sk</code>) rather than a
variogram data frame. When <code>add=FALSE</code>, the function uses it to set the distance limits
for an initial empty plot (the model semi-variance is then drawn if <code>pars</code> is supplied).
</p>


<h3>Value</h3>

<p>nothing
</p>


<h3>Plotting parameters</h3>

<p>The following style parameters are optional:
</p>

<dl>
<dt>alpha_bin, alpha_model, alpha_bin_b, alpha_model_b</dt>
<dd>
<p>numeric in [0,1]: respectively,
the transparency of the fill color for circles and ribbons (default 0.3), and their borders
(default 0.5 )</p>
</dd>
<dt>bty</dt>
<dd>
<p>character: plot frame border type, passed to base::plot (default 'n' for no border)</p>
</dd>
<dt>col_bin, col_model</dt>
<dd>
<p>character: respectively, the color to use for circles (default
'black') and ribbons (default 'blue')</p>
</dd>
<dt>cex_bin</dt>
<dd>
<p>numeric &gt; 0: scaling factor for circles (default 1.5)</p>
</dd>
<dt>d_max</dt>
<dd>
<p>numeric &gt; 0: x (distance) limit for plotting in input units</p>
</dd>
<dt>leg</dt>
<dd>
<p>logical: adds a sample bin legend</p>
</dd>
<dt>leg_main</dt>
<dd>
<p>character: title for the sample bin legend (default 'model')</p>
</dd>
<dt>lwd</dt>
<dd>
<p>numeric: line width for the model semi-variance</p>
</dd>
<dt>main</dt>
<dd>
<p>character: a title</p>
</dd>
<dt>n_bin, n_test</dt>
<dd>
<p>integer: respectively, the number of distance bins for the sample
(optional if <code>vg</code> has a 'bin' column, and ignored if <code>vg</code> is a grid object), and the
number of distances at which to evaluate the semi-variogram for model <code>pars</code> (default 5e3,
ignored if <code>pars</code> not supplied)</p>
</dd>
<dt>reset</dt>
<dd>
<p>logical: indicates to reset graphical parameters to their original values
when finished (default TRUE)</p>
</dd>
<dt>xlab, ylab</dt>
<dd>
<p>character: titles for the y and x axes. The default for y is
'semi-variance (gamma)', and for x 'distance'</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# make example grid and reference covariance model
gdim = c(10, 15)
g_empty = sk(gdim)
pars = sk_pars(g_empty, 'mat')

# plot a semivariance model
sk_plot_semi(g_empty)
sk_plot_semi(g_empty, pars)

# change annotations, sharpen ribbon border
sk_plot_semi(g_empty, pars, main='title', xlab='x', ylab='y')
sk_plot_semi(g_empty, pars, alpha_model_b=1, main='example title', xlab='x', ylab='y')

# generate sample data and sample semivariogram
g_obs = sk_sim(g_empty, pars)
vg = sk_sample_vg(g_obs)
sk_plot_semi(vg)

# different aggregation methods produce variety of results
sk_plot_semi(vg, fun='root_median')
sk_plot_semi(vg, fun='root_mean')
sk_plot_semi(vg, fun='classical') # default
sk_plot_semi(vg, fun=function(x) mean(x^2)) # same as classical

# plot again with reference model and adjust distance limits, number of bins
sk_plot_semi(vg, pars)
sk_plot_semi(vg, pars, d_max=10)
sk_plot_semi(vg, pars, d_max=10, n_bin=1e2)

# add dashed line for half sample variance (this tends to underestimate the sill)
sk_plot_semi(vg, pars)
sample_var = var(g_obs[['gval']], na.rm=TRUE)
abline(h=sample_var/2, lty='dashed')

# initial call with reset=FALSE, then use add=TRUE to overlay the same model with a green fill
sk_plot_semi(vg, pars, lwd=2, reset=FALSE)
sk_plot_semi(vg, pars, add=TRUE, col_model='green', alpha_model_b=0)

# overlay several models with varying nugget effect
pars_vary = pars
for(i in seq(3))
{
  pars_vary$eps = 0.8 * pars_vary$eps
  sk_plot_semi(vg, pars_vary, add=TRUE, alpha_model_b=0)
}
dev.off()

</code></pre>


</div>