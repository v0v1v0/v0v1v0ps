<div class="container">

<table style="width: 100%;"><tr>
<td>bread.systemfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bread for Sandwiches</h2>

<h3>Description</h3>

<p>Extract the estimator for the bread of sandwhiches
(see <code>bread</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'systemfit'
bread( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Quadratic symmetric matrix,
which is an estimator for the expectation of the negative derivative 
of the estimating function (see <code>estfun.systemfit</code>).
</p>


<h3>Warnings</h3>

<p>The <span class="pkg">sandwich</span> package must be loaded before this method
can be used.
</p>
<p>This method might not be suitable for specific formulas 
for 3SLS estimations in case of unbalanced systems
or different instruments for different equations.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen
</p>


<h3>See Also</h3>

<p><code>bread</code>, <code>systemfit</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )
inst &lt;- ~ income + farmPrice + trend

## OLS estimation
fitols &lt;- systemfit( system, "OLS", data = Kmenta )

## obtain the bread
library( "sandwich" )
bread( fitols )

## this is only true for OLS models
all.equal( bread( fitols ),
   solve( crossprod( model.matrix( fitols ) ) / 40 ) )


## 2SLS estimation
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )

## obtain the bread
bread( fit2sls )

## this is only true for 2SLS models
all.equal( bread( fit2sls ),
   solve( crossprod( model.matrix( fit2sls, which = "xHat" ) ) / 40 ) )


## iterated SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta, maxit = 100 )

## obtain the bread
bread( fitsur )

## this should be true for SUR and WLS models
all.equal( bread( fitsur ),
   solve( t( model.matrix( fitsur ) ) %*%
      (  ( solve( fitsur$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fitsur ) ) / 40 ), check.attributes = FALSE )


## 3SLS estimation
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )

## obtain the bread
bread( fit3sls )

## this should be true for 3SLS and W2SLS models
all.equal( bread( fit3sls ),
   solve( t( model.matrix( fit3sls, which = "xHat" ) ) %*%
      (  ( solve( fit3sls$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fit3sls, which = "xHat" ) ) / 40 ), check.attributes = FALSE )
</code></pre>


</div>