<div class="container">

<table style="width: 100%;"><tr>
<td>coefs.sensmed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML estimation of regression parameters for calculation of direct and indirect effects under unobserved confounding</h2>

<h3>Description</h3>

<p>This function gives ML estimates of the regression parameters used to calculate mediation effects and perform sensitivity analysis. The optimization is
performed using <code>maxLik</code>, see Details for more information. Called by <code>sensmediation</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coefs.sensmed(model.expl, model.resp, Rho, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model.expl</code></td>
<td>
<p>Fitted <code>glm</code> model object. If sensitivity analysis to mediator-outcome confounding the mediator model. Otherwise the exposure model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.resp</code></td>
<td>
<p>Fitted <code>glm</code> model object. If sensitivity analysis to exposure-mediator confounding the mediator model. Otherwise the outcome model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector. If <code>type="my"</code> the correlation between the error terms in the mediator and outcome models. If <code>type="zm"</code> the correlation between the error terms in the exposure and mediator models. If <code>type="zy"</code> the correlation between the error terms in the exposure and outcome models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical, indicating whether or not the progress (i.e. the <code>proc.time</code> for each <code>Rho</code>) of the optimization will be output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed on to the <code>maxLik</code> function. Can be used to set the <code>method</code> and <code>control</code> arguments of the <code>maxLik</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The maximization of the log-likelihood is performed using <code>maxLik</code>, the default is to use the Newton-Raphson method and an analytic gradient and Hessian.
</p>


<h3>Value</h3>

<p><code>coefs.sensmed</code> returns a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.resp</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.res.resp</code></td>
<td>
<p>If <code>model.resp</code> is a linear regression model, the estimated standard deviation of the error term for each <code>Rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.res.expl</code></td>
<td>
<p>If <code>model.expl</code> is a linear regression model, the estimated standard deviation of the error term for each <code>Rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho</code></td>
<td>
<p>The sensitivity parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expl.coef</code></td>
<td>
<p>A matrix with the estimated regression parameters for <code>model.expl</code> over the range of <code>Rho</code>. One column per value of <code>Rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.expl</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.expl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.resp</code></td>
<td>
<p>the original fitted <code>glm</code> object of <code>model.resp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.expl</code></td>
<td>
<p>The model matrix (see <code>model.matrix</code>) of <code>model.expl</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.resp</code></td>
<td>
<p>The model matrix (see <code>model.matrix</code>) of <code>model.resp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outc.resp</code></td>
<td>
<p>The outcome variable of <code>model.resp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outc.expl</code></td>
<td>
<p>The outcome variable of <code>model.expl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmas</code></td>
<td>
<p>A list with the estimated covariance matrices for the regression parameters of <code>model.resp</code> and <code>model.expl</code> over <code>Rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.info</code></td>
<td>
<p>Information about the maximization (whether or not the convergence was successful, <code>message</code>, <code>method</code> and number of iterations) for each <code>Rho</code>, see <code>maxLik</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>The values of the loglikelihood function for the best set of regression parameters from the optimization for each <code>Rho</code>, see <code>maxLik</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anita Lindmark
</p>


<h3>References</h3>

<p>Henningsen, A., Toomet, O. (2011). maxLik: A Package for Maximum Likelihood Estimation in R, <em>Computational Statistics</em>, <b>26(3)</b>, pp. 443â€“458.
</p>


<h3>See Also</h3>

<p><code>sensmediation</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Example with data from Riksstroke (the Swedish stroke register)

data(RSdata)

# Probit mediator and outcome models:
m.model &lt;- glm(lowered.consc ~ AF + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))
o.model &lt;- glm(cf.3mo ~ AF + lowered.consc + age.cat + sex, data = RSdata,
   family = binomial(link = 'probit'))

# Estimation of regression coefficients under different values of Rho
# Rho = correlation between error terms in mediator and outcome model:
coefs.MY &lt;- coefs.sensmed(model.expl = m.model, model.resp = o.model, Rho = seq(0, 0.5, 0.1))
# Outcome model regression coefficients:
coefs.MY$coef

## End(Not run)

</code></pre>


</div>