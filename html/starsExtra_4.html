<div class="container">

<table style="width: 100%;"><tr>
<td>CI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Convergence Index (CI) from a slope raster</h2>

<h3>Description</h3>

<p>Calculates the Convergence Index (CI) given a topographic slope raster. Input and output are rasters of class <code>stars</code>, single-band (i.e., only '"x"' and '"y"' dimensions), with one attribute.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CI(x, k, na.rm = FALSE, na_flag = -9999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A raster (class <code>stars</code>) with two dimensions: <code>x</code> and <code>y</code>, i.e., a single-band raster, representing aspect in decimal degrees clockwise from north, possibly including <code>-1</code> to specify flat terrain, such as returned by function <code>aspect</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>k Neighborhood size around focal cell. Must be an odd number. For example, <code>k=3</code> implies a 3*3 neighborhood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Should <code>NA</code> values be ignored when calculating CI? Default is <code>FALSE</code>, i.e., when at least one aspect value in the neighborhood is <code>NA</code> the CI is also set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_flag</code></td>
<td>
<p>Value used to mark <code>NA</code> values in C code. This should be set to a value which is guaranteed to be absent from the input raster <code>x</code> (default is <code>-9999</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>stars</code> raster with CI values.
</p>


<h3>Note</h3>

<p>The raster is "padded" with <code>(k-1)/2</code> more rows and columns of <code>NA</code> values on all sides, so that the neighborhood of the outermost rows and columns is still a complete neighborhood. Those rows and columns are removed from the final result before returning it.
Aspect values of <code>-1</code>, specifying flat terrain, are assigned with a CI value of <code>0</code> regardless of their neighboring values.
</p>


<h3>References</h3>

<p>The Convergence Index algorithm is described in:
</p>
<p>Thommeret, N., Bailly, J. S., &amp; Puech, C. (2010). Extraction of thalweg networks from DTMs: application to badlands.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Small example
data(dem)
dem_asp = aspect(dem)
dem_ci = CI(dem_asp, k = 3)
r = c(dem, round(dem_ci, 1), along = 3)
r = st_set_dimensions(r, 3, values = c("input (aspect)", "output (CI, k=3)"))
plot(r, text_values = TRUE, breaks = "equal", col = terrain.colors(10), mfrow = c(1, 2))

# Larger example
data(golan)
golan_asp = aspect(golan)
golan_ci = CI(golan_asp, k = 25)
plot(golan_asp, breaks = "equal", col = hcl.colors(11, "Spectral"), main = "input (aspect)")
plot(golan_ci, breaks = "equal", col = hcl.colors(11, "Spectral"), main = "output (CI, k=25)")


</code></pre>


</div>