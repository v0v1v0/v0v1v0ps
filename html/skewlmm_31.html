<div class="container">

<table style="width: 100%;"><tr>
<td>rsmsn.lmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate data from SMSN-LMM

</h2>

<h3>Description</h3>

<p>It creates a simulated data set from SMSN-LMM (or from SMN-LMM, if <code>lambda = 0</code>) with several possible dependence structures, for one subject.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsmsn.lmm(time1, x1, z1, sigma2, D1, beta, lambda, depStruct = "UNC",
          phi = NULL, distr = "sn", nu = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time1</code></td>
<td>
<p>Vector containing times that should be used in data generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>Design matrix for fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>Design matrix for random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Common variance parameter, such that <code class="reqn">\Sigma=\sigma^2*R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>Variance matrix for random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Vector of fixed effects parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Skewness parameter of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>Dependence structure. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) – p is <code>length(phi)</code>–, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Parameter vector indexing the dependence structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>Distribution that should be used. <code>"sn"</code> for skew-normal, <code>"st"</code> for skew-t, <code>"ss"</code> for skew-slash, and <code>"scn"</code> for skew-contaminated normal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Parameter vector indexing <code>distr</code>. Should be <code>NULL</code> for <code>"sn"</code>, be a vector of length 1 for <code>"st"</code> and <code>"ss"</code>, and of length 2 for <code>"scn"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame containing time, the generated response variable (<code>y</code>), and possible covariates.





</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Lachos, V. H., P. Ghosh, and R. B. Arellano-Valle (2010). Likelihood based inference for skew-normal independent linear mixed models. Statistica Sinica 20, 303-322.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code>smsn.lmm</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generating a sample for 1 individual at 5 times
nj1 = 5
rsmsn.lmm(1:nj1, cbind(1, 1:nj1), rep(1, nj1), sigma2=.25, D1=diag(1),
          beta=c(1, 2), lambda=2, depStruct="ARp", phi=.5,
          distr="st", nu=5)

# Generating a sample for m=25 individuals with 5 times
library(dplyr)
library(purrr)
library(ggplot2)
nj1 = 5
m = 25
gendatList = map(rep(nj1, m),
                 function(nj) rsmsn.lmm(1:nj, cbind(1, 1:nj), rep(1, nj),
                                        sigma2=.25, D1=.5*diag(1), beta=c(1, 2),
                                        lambda=2, depStruct="ARp", phi=.5))
gendat = bind_rows(gendatList, .id="ind")
ggplot(gendat, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=2)
#
fm1 = smsn.lmm(y ~ x, data=gendat, groupVar="ind", depStruct="ARp",
                pAR=1)
summary(fm1)

</code></pre>


</div>