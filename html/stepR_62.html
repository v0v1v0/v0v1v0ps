<div class="container">

<table style="width: 100%;"><tr>
<td>stepbound</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jump estimation under restrictions</h2>

<h3>Description</h3>

<p>Computes piecewise constant maximum likelihood estimators with minimal number of jumps under given restrictions on subintervals.
</p>
<p><b>Deprecation warning:</b> This function is a help function for <code>smuceR</code> and <code>jsmurf</code> and may be removed when these function will be removed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepbound(y, bounds, ...)
## Default S3 method:
stepbound(y, bounds, x = 1:length(y), x0 = 2 * x[1] - x[2],
  max.cand = NULL, family = c("gauss", "gaussvar", "poisson", "binomial", "gaussKern"),
  param = NULL, weights = rep(1, length(y)), refit = y,
  jumpint = confband, confband = FALSE, ...)
## S3 method for class 'stepcand'
stepbound(y, bounds, refit = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of numerical observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>bounds on the value allowed on intervals; typically computed with <code>bounds</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of the same length as <code>y</code> containing the corresponding sample points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a single numeric giving the last unobserved sample point directly before sampling started</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cand, weights</code></td>
<td>
<p>see <code>stepcand</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family, param</code></td>
<td>
<p>specifies distribution of data, see family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p><code>logical</code>, for <code>family = "gaussKern"</code>; determines whether a fit taken the filter kernel into account will be computed at the end</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpint</code></td>
<td>
<p><code>logical</code> (<code>FALSE</code> by default), indicates if confidence sets for jumps should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confband</code></td>
<td>
<p><code>logical</code>, indicates if a confidence band for the piecewise-continuous function should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to generic methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>stepfit</code> that contains the fit; if <code>jumpint == TRUE</code> function <code>jumpint</code> allows to extract the confidence interval for the jumps, if <code>confband == TRUE</code> function <code>confband</code> allows to extract the confidence band.
</p>


<h3>References</h3>

<p>Frick, K., Munk, A., and Sieling, H. (2014) Multiscale change-point inference. With discussion and rejoinder by the authors. <em>Journal of the Royal Statistical Society, Series B</em> <b>76</b>(3), 495–580.
</p>
<p>Hotz, T., Schütte, O., Sieling, H., Polupanow, T., Diederichsen, U., Steinem, C., and Munk, A. (2013) Idealizing ion channel recordings by a jump segmentation multiresolution filter. <em>IEEE Transactions on NanoBioscience</em> <b>12</b>(4), 376–386.
</p>


<h3>See Also</h3>

<p><code>bounds</code>, <code>smuceR</code>, <code>jsmurf</code>, <code>stepsel</code>, <code>stepfit</code>, <code>jumpint</code>, <code>confband</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate poisson data with two levels
y &lt;- rpois(100, c(rep(1, 50), rep(4, 50)))
# compute bounds
b &lt;- bounds(y, penalty="len", family="poisson", q=4)
# fit step function to bounds
sb &lt;- stepbound(y, b, family="poisson", confband=TRUE)
plot(y)
lines(sb)
# plot confidence intervals for jumps on axis
points(jumpint(sb), col="blue")
# confidence band
lines(confband(sb), lty=2, col="blue")
</code></pre>


</div>