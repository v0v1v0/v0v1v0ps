<div class="container">

<table style="width: 100%;"><tr>
<td>ml.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Contamination Model
</h2>

<h3>Description</h3>

<p>Provides ML estimates of a Gaussian contamination model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    ml.est (y, x=NULL, model = "LN", lambda=3,  w=0.05,
            lambda.fix=FALSE, w.fix=FALSE, eps=1e-7,  
            max.iter=500, t.outl=0.5, graph=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix or data frame containing the response variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>optional matrix or data frame containing the error free covariates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>data distribution: LN = lognormal(default), N=normal
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>starting value for the variance inflation factor (default=3)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>starting value for the proportion of contaminated data (default=0.05)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.fix</code></td>
<td>
<p> logical. TRUE if lambda is known
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.fix</code></td>
<td>
<p> logical. TRUE if w is known
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>epsilon : tolerance parameter for the log-likelihood convergence (default=1e-7)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>

<p>maximum number of EM iterations (default=500)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.outl</code></td>
<td>

<p>threshold value for posterior probabilities of identifying outliers (default=0.5)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>

<p>logical. TRUE to display graphics (default=FALSE)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides the parameter estimates of a contamination model where a set of <code>y</code>
variables is assumed to depend on a (possibly empty) set of covariates (<code>x</code> variables) 
through a mixture of two linear regressions with Gaussian residuals. The covariance matrices
of the two mixture components are assumed to be proportional (the proportionality constant being 
<code>lambda</code>). In case of no <code>x</code> variables a mixture of two Gaussian distribution is estimated.  
BIC and AIC scores (<code>bic.aic</code>) are returned corresponding to both standard Gaussian model
and contamination model in order to help the user to avoid possible over-parametrisation.  
</p>
<p>According to the estimated model parameters, a matrix of predictions of ‘true’ <code>y</code> values 
(<code>ypred</code>) is computed. To each unit in the dataset, a flag (<code>outlier</code>) is assigned taking 
value 0 or 1 depending on whether the posterior probability of being erroneous (<code>tau</code>) is 
greater than the user specified threshold  (<code>t.outl</code>). 
</p>
<p>The model is estimated using complete observations. Missing values in the <code>x</code> variables are
not allowed. However,  <code>y</code> variables can be partly observed. Robust predictions of <code>y</code> variables 
are provided even when they are not observed.
A vector of missing pattern (<code>pattern</code>) indicates which  item is observed and which is missing.  
</p>
<p>In case the option ‘model = LN’  is specified, each zero value is changed in 1e-7 and 
a warning is returned. 
</p>
<p>In order to graphically monitor EM algorithm, a scatter plot is showed where outliers 
are depicted as long as they are identified. The trajectory of the <code>lambda</code> parameter 
is also showed until convergence. 
</p>


<h3>Value</h3>

<p><code>ml.est</code> returns a list containing the following components:<br><br></p>
<table>
<tr style="vertical-align: top;">
<td><code>ypred </code></td>
<td>
<p>matrix of predicted values for y variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B </code></td>
<td>
<p>matrix of estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma </code></td>
<td>
<p>estimated covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda </code></td>
<td>
<p>estimated variance inflation factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w </code></td>
<td>
<p>estimated proportion of erroneous data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p>vector of posterior probabilities of being contaminated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier </code></td>
<td>
<p>1 if the observation is classified as an outlier, 0 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.outlier </code></td>
<td>
<p>total of outlier observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern </code></td>
<td>
<p>vector of non-response patterns for y variables: 0 = missing, 1 = present value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.conv </code></td>
<td>
<p>logical value: TRUE if the EM algorithm has converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter </code></td>
<td>
<p>number of iterations of EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sing </code></td>
<td>
<p>if TRUE iteration are stopped because there is an almost perfect fit </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic.aic </code></td>
<td>
<p>Bayesian Information Criterion and Akaike Information Criterion for contaminated 
and non contaminated Gaussian models</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M. Teresa Buglielli &lt;bugliell@istat.it&gt;, Ugo Guarnera &lt;guarnera@istat.it&gt;
</p>


<h3>References</h3>

<p>Di Zio, M., Guarnera, U. (2013) <em>"A Contamination Model for Selective Editing"</em>, 
Journal of Official Statistics. Volume 29, Issue 4, Pages 539-555
(<a href="https://doi.org/10.2478/jos-2013-0039">https://doi.org/10.2478/jos-2013-0039</a>). <br></p>
<p>Buglielli, M.T., Di Zio, M., Guarnera, U. (2010) <em>"Use of Contamination Models for Selective Editing"</em>, 
European Conference on Quality in Survey Statistics Q2010, Helsinki, 4-6 May 2010
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Parameter estimation with one contaminated variable and one covariate
        data(ex1.data)
        ml.par &lt;- ml.est(y=ex1.data[,"Y1"], x=ex1.data[,"X1"], graph=TRUE) 
        str(ml.par)
        sum(ml.par$outlier)  # number of outliers
# Parameter estimation with two contaminated variables and no covariates   
## Not run:  
        data(ex2.data)
        par.joint &lt;- ml.est(y=ex2.data, x=NULL, graph=TRUE)  
        sum(par.joint$outlier)  # number of outliers  
  
## End(Not run)      
</code></pre>


</div>