<div class="container">

<table style="width: 100%;"><tr>
<td>mirt.wrapper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Some Functions for Wrapping with the <span class="pkg">mirt</span> Package
</h2>

<h3>Description</h3>

<p>Some functions for wrapping with the <span class="pkg">mirt</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R"># extract coefficients
mirt.wrapper.coef(mirt.obj)

# summary output
mirt_summary(object, digits=4, file=NULL, ...)

# extract posterior, likelihood, ...
mirt.wrapper.posterior(mirt.obj, weights=NULL, group=NULL)
## S3 method for class 'SingleGroupClass'
IRT.likelihood(object, ...)
## S3 method for class 'MultipleGroupClass'
IRT.likelihood(object, ...)
## S3 method for class 'SingleGroupClass'
IRT.posterior(object, ...)
## S3 method for class 'MultipleGroupClass'
IRT.posterior(object, ...)
## S3 method for class 'SingleGroupClass'
IRT.expectedCounts(object, ...)
## S3 method for class 'MultipleGroupClass'
IRT.expectedCounts(object, ...)

# S3 method for extracting item response functions
## S3 method for class 'SingleGroupClass'
IRT.irfprob(object, ...)
## S3 method for class 'MultipleGroupClass'
IRT.irfprob(object, group=1, ...)

# compute factor scores
mirt.wrapper.fscores(mirt.obj, weights=NULL)

# convenience function for itemplot
mirt.wrapper.itemplot( mirt.obj, ask=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mirt.obj</code></td>
<td>

<p>A fitted model in <span class="pkg">mirt</span> package
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted object in <span class="pkg">mirt</span> package of class
<code>SingleGroupClass</code> or <code>MultipleGroupClass</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Group index for <code>IRT.irfprob</code> (only
applicable for object of class <code>MultipleGroupClass</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimal used for rounding</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>File name for sinking summary output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of student weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Optional logical indicating whether each new plot should be
confirmed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>mirt.wrapper.coef</code> collects all item parameters
in a data frame.
</p>
<p>The function <code>mirt.wrapper.posterior</code> extracts the individual
likelihood, individual likelihood and expected counts. This function does not
yet cover the case of multiple groups.
</p>
<p>The function <code>mirt.wrapper.fscores</code> computes factor scores
EAP, MAP and MLE. The factor scores are computed on the
discrete grid of latent traits (contrary to the computation in <code>mirt</code>) as
specified in <code>mirt.obj@Theta</code>. This function does also not work
for multiple groups.
</p>
<p>The function <code>mirt.wrapper.itemplot</code> displays all item plots
after each other.
</p>


<h3>Value</h3>

<p>Function <code>mirt.wrapper.coef</code> – List with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Data frame with item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GroupPars</code></td>
<td>
<p>Data frame or list with distribution parameters</p>
</td>
</tr>
</table>
<p>Function <code>mirt.wrapper.posterior</code> – List with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta.k</code></td>
<td>
<p>Grid of theta points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.k</code></td>
<td>
<p>Trait distribution on <code>theta.k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.yi.qk</code></td>
<td>
<p>Individual likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.qk.yi</code></td>
<td>
<p>Individual posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ik</code></td>
<td>
<p>Expected counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Used dataset</p>
</td>
</tr>
</table>
<p>Function <code>mirt.wrapper.fscores</code> – List with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with person parameter estimates (factor scores)
EAP, MAP and MLE for all dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EAP.rel</code></td>
<td>
<p>EAP reliabilities</p>
</td>
</tr>
</table>
<h3>Examples for the <span class="pkg">mirt</span> Package</h3>




<ol>
<li>
<p> Latent class analysis (<code>data.read</code>, Model 7)
</p>

</li>
<li>
<p> Mixed Rasch model  (<code>data.read</code>, Model 8)
</p>

</li>
<li>
<p> Located unidimensional and multidimensional
latent class models / Multidimensional latent class IRT models
(<code>data.read</code>, Model 12;
<code>rasch.mirtlc</code>, Example 4)
</p>

</li>
<li>
<p> Multidimensional IRT model with discrete latent traits
(<code>data.read</code>, Model 13)
</p>

</li>
<li>
<p> DINA model (<code>data.read</code>, Model 14;
<code>data.dcm</code>, <span class="pkg">CDM</span>, Model 1m)
</p>

</li>
<li>
<p> Unidimensional IRT model with non-normal distribution
(<code>data.read</code>, Model 15)
</p>

</li>
<li>
<p> Grade of membership model  (<code>gom.em</code>, Example 2)
</p>

</li>
<li>
<p> Rasch copula model (<code>rasch.copula2</code>, Example 5)
</p>

</li>
<li>
<p> Additive GDINA model
(<code>data.dcm</code>, <span class="pkg">CDM</span>, Model 6m)
</p>

</li>
<li>
<p> Longitudinal Rasch model (<code>data.long</code>, Model 3)
</p>

</li>
<li>
<p> Normally distributed residuals (<code>data.big5</code>, Example 1, Model 5)
</p>

</li>
<li>
<p> Nedelsky model (<code>nedelsky.irf</code>,
Examples 1, 2)
</p>

</li>
<li>
<p> Beta item response model (<code>brm.irf</code>, Example 1)
</p>
</li>
</ol>
<h3>See Also</h3>

<p>See the <span class="pkg">mirt</span> package manual for more information.
</p>
<p>See for the main estimation functions in <span class="pkg">mirt</span>:
<code>mirt::mirt</code>,
<code>mirt::multipleGroup</code>
and <code>mirt::bfactor</code>.
</p>
<p>See <code>mirt::coef-method</code> for extracting
coefficients.
</p>
<p>See <code>mirt::mod2values</code> for collecting
parameter values in a mirt parameter table.
</p>
<p>See <code>lavaan2mirt</code> for converting <code>lavaan</code> syntax
to <code>mirt</code> syntax.
</p>
<p>See <code>tam2mirt</code> for converting fitted <code>tam</code> models
into <code>mirt</code> objects.
</p>
<p>See also <code>CDM::IRT.likelihood</code>,
<code>CDM::IRT.posterior</code> and
<code>CDM::IRT.irfprob</code> for general
extractor functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# A development version can be installed from GitHub
if (FALSE){ # default is set to FALSE, use the installed version
   library(devtools)
   devtools::install_github("philchalmers/mirt")
          }
# now, load mirt
library(mirt)

#############################################################################
# EXAMPLE 1: Extracting item parameters and posterior LSAT data
#############################################################################

data(LSAT7, package="mirt")
data &lt;- mirt::expand.table(LSAT7)

#*** Model 1: 3PL model for item 5 only, other items 2PL
mod1 &lt;- mirt::mirt(data, 1, itemtype=c("2PL","2PL","2PL","2PL","3PL"), verbose=TRUE)
print(mod1)
summary(mod1)
# extracting coefficients
coef(mod1)
mirt.wrapper.coef(mod1)$coef
# summary output
mirt_summary(mod1)
# extract parameter values in mirt
mirt::mod2values(mod1)
# extract posterior
post1 &lt;- sirt::mirt.wrapper.posterior(mod1)
# extract item response functions
probs1 &lt;- IRT.irfprob(mod1)
str(probs1)
# extract individual likelihood
likemod1 &lt;- IRT.likelihood(mod1)
str(likemod1)
# extract individual posterior
postmod1 &lt;- IRT.posterior(mod1)
str(postmod1)

#*** Model 2: Confirmatory model with two factors
cmodel &lt;- mirt::mirt.model("
        F1=1,4,5
        F2=2,3
        ")
mod2 &lt;- mirt::mirt(data, cmodel, verbose=TRUE)
print(mod2)
summary(mod2)
# extract coefficients
coef(mod2)
mirt.wrapper.coef(mod2)$coef
# extract posterior
post2 &lt;- sirt::mirt.wrapper.posterior(mod2)

#############################################################################
# EXAMPLE 2: Extracting item parameters and posterior for differering
#            number of response catagories | Dataset Science
#############################################################################

data(Science,package="mirt")
library(psych)
psych::describe(Science)

# modify dataset
dat &lt;- Science
dat[ dat[,1] &gt; 3,1] &lt;- 3
psych::describe(dat)

# estimate generalized partial credit model
mod1 &lt;- mirt::mirt(dat, 1, itemtype="gpcm")
print(mod1)
# extract coefficients
coef(mod1)
mirt.wrapper.coef(mod1)$coef
# extract posterior
post1 &lt;- sirt::mirt.wrapper.posterior(mod1)

#############################################################################
# EXAMPLE 3: Multiple group model; simulated dataset from mirt package
#############################################################################

#*** simulate data (copy from the multipleGroup manual site in mirt package)
set.seed(1234)
a &lt;- matrix(c(abs( stats::rnorm(5,1,.3)), rep(0,15),abs( stats::rnorm(5,1,.3)),
          rep(0,15),abs( stats::rnorm(5,1,.3))), 15, 3)
d &lt;- matrix( stats::rnorm(15,0,.7),ncol=1)
mu &lt;- c(-.4, -.7, .1)
sigma &lt;- matrix(c(1.21,.297,1.232,.297,.81,.252,1.232,.252,1.96),3,3)
itemtype &lt;- rep("dich", nrow(a))
N &lt;- 1000
dataset1 &lt;- mirt::simdata(a, d, N, itemtype)
dataset2 &lt;- mirt::simdata(a, d, N, itemtype, mu=mu, sigma=sigma)
dat &lt;- rbind(dataset1, dataset2)
group &lt;- c(rep("D1", N), rep("D2", N))

#group models
model &lt;- mirt::mirt.model("
   F1=1-5
   F2=6-10
   F3=11-15
      ")

# separate analysis
mod_configural &lt;- mirt::multipleGroup(dat, model, group=group, verbose=TRUE)
mirt.wrapper.coef(mod_configural)

# equal slopes (metric invariance)
mod_metric &lt;- mirt::multipleGroup(dat, model, group=group, invariance=c("slopes"),
                verbose=TRUE)
mirt.wrapper.coef(mod_metric)

# equal slopes and intercepts (scalar invariance)
mod_scalar &lt;- mirt::multipleGroup(dat, model, group=group,
          invariance=c("slopes","intercepts","free_means","free_varcov"), verbose=TRUE)
mirt.wrapper.coef(mod_scalar)

# full constraint
mod_fullconstrain &lt;- mirt::multipleGroup(dat, model, group=group,
             invariance=c("slopes", "intercepts", "free_means", "free_var"), verbose=TRUE )
mirt.wrapper.coef(mod_fullconstrain)

#############################################################################
# EXAMPLE 4: Nonlinear item response model
#############################################################################

data(data.read)
dat &lt;- data.read
# specify mirt model with some interactions
mirtmodel &lt;- mirt.model("
   A=1-4
   B=5-8
   C=9-12
   (A*B)=4,8
   (C*C)=9
   (A*B*C)=12
   " )
# estimate model
res &lt;- mirt::mirt( dat, mirtmodel, verbose=TRUE, technical=list(NCYCLES=3) )
# look at estimated parameters
mirt.wrapper.coef(res)
coef(res)
mirt::mod2values(res)
# model specification
res@model

#############################################################################
# EXAMPLE 5: Extracting factor scores
#############################################################################

data(data.read)
dat &lt;- data.read
# define lavaan model and convert syntax to mirt
lavmodel &lt;- "
    A=~ a*A1+a*A2+1.3*A3+A4       # set loading of A3 to 1.3
    B=~ B1+1*B2+b3*B3+B4
    C=~ c*C1+C2+c*C3+C4
    A1 | da*t1
    A3 | da*t1
    C4 | dg*t1
    B1 | 0*t1
    B3 | -1.4*t1                  # fix item threshold of B3 to -1.4
    A ~~ B                        # estimate covariance between A and B
    A ~~ .6 * C                   # fix covariance to .6
    B ~~ B                        # estimate variance of B
    A ~ .5*1                      # set mean of A to .5
    B ~ 1                         # estimate mean of B
    "
res &lt;- sirt::lavaan2mirt( dat, lavmodel, verbose=TRUE, technical=list(NCYCLES=3) )
# estimated coefficients
mirt.wrapper.coef(res$mirt)
# extract factor scores
fres &lt;- sirt::mirt.wrapper.fscores(res$mirt)
# look at factor scores
head( round(fres$person,2))
  ##     case    M EAP.Var1 SE.EAP.Var1 EAP.Var2 SE.EAP.Var2 EAP.Var3 SE.EAP.Var3 MLE.Var1
  ##   1    1 0.92     1.26        0.67     1.61        0.60     0.05        0.69     2.65
  ##   2    2 0.58     0.06        0.59     1.14        0.55    -0.80        0.56     0.00
  ##   3    3 0.83     0.86        0.66     1.15        0.55     0.48        0.74     0.53
  ##   4    4 1.00     1.52        0.67     1.57        0.60     0.73        0.76     2.65
  ##   5    5 0.50    -0.13        0.58     0.85        0.48    -0.82        0.55    -0.53
  ##   6    6 0.75     0.41        0.63     1.09        0.54     0.27        0.71     0.00
  ##     MLE.Var2 MLE.Var3 MAP.Var1 MAP.Var2 MAP.Var3
  ##   1     2.65    -0.53     1.06     1.59     0.00
  ##   2     1.06    -1.06     0.00     1.06    -1.06
  ##   3     1.06     2.65     1.06     1.06     0.53
  ##   4     2.65     2.65     1.59     1.59     0.53
  ##   5     0.53    -1.06    -0.53     0.53    -1.06
  ##   6     1.06     2.65     0.53     1.06     0.00
# EAP reliabilities
round(fres$EAP.rel,3)
  ##    Var1  Var2  Var3
  ##   0.574 0.452 0.541

## End(Not run)
</code></pre>


</div>