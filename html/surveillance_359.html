<div class="container">

<table style="width: 100%;"><tr>
<td>stcd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatio-temporal cluster detection</h2>

<h3>Description</h3>

<p>Shiryaev-Roberts based prospective spatio-temporal cluster detection
as in Assuncao &amp; Correa (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stcd(x, y,t,radius,epsilon,areaA, areaAcapBk, threshold, cusum=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector containing spatial x coordinate of the events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector containing spatial y coordinate of the events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Vector containing the time points of the events. It is
assumed that the vector is sorted (early-&gt;last).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Radius of the cluster to detect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Relative change of event-intensity within the cluster
to detect. See reference paper for an explicit definition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>areaA</code></td>
<td>
<p>Area of the observation region A (single number) – This
argument is currently ignored!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>areaAcapBk</code></td>
<td>
<p>Area of A \ B(s_k,rho) for all k=1,...,n
(vector). This argument is currently ignored!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold limit for the alarm and should be equal to
the desired Average-Run-Length (ARL) of the detector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cusum</code></td>
<td>
<p>(logical) If <code>FALSE</code> (default) then the
Shiryaev-Roberts detector is used as in the original article by
Assuncao &amp; Correa (2009), i.e. <code class="reqn">R_n = \sum_{k=1}^n
      \Lambda_{k,n}</code>, where <code class="reqn">\Lambda_{k,n}</code> denotes the likelihood
ratio between the in-control and out-of control model. If
<code>TRUE</code>, CUSUM test statistic is 
used instead. Here, </p>
<p style="text-align: center;"><code class="reqn">R_n = \max_{1\leq k \leq n}
      \Lambda_{k,n}</code>
</p>
<p>. Note that this has implications on what threshold
will sound the alarm (CUSUM threshold needs to be smaller).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Shiryaev-Roberts based spatio-temporal cluster detection based
on the work in Assuncao and Correa (2009). The implementation
is based on C++ code originally written by Marcos Oliveira Prates, UFMG,
Brazil and provided by Thais Correa, UFMG, Brazil during her research
stay in Munich. This stay was financially supported by the Munich
Center of Health Sciences.
</p>
<p>Note that the vectors <code>x</code>, <code>y</code> and <code>t</code> need to be of the
same length. Furthermore, the vector <code>t</code> needs to be sorted (to
improve speed, the latter is not verified within the function).
</p>
<p>The current implementation uses a call to a C++ function to perform the
actual computations of the test statistic. The function is currently
experimental – data type and results may be subject to changes.
</p>


<h3>Value</h3>

<p>A list with three components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A vector of the same length as the input containing the value
of the test statistic for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idxFA</code></td>
<td>
<p>Index in the x,y,t vector causing a possible alarm. If no
cluster was detected, then a value of <code>-1</code> is returned here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idxCC</code></td>
<td>
<p>index in the x,y,t vector of the event containing the
cluster. If no cluster was detected, then a value of <code>-1</code> is
returned here.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M. O. Prates, T. Correa and M. Höhle</p>


<h3>References</h3>

<p>Assuncao, R. and Correa, T. (2009), Surveillance to detect emerging
space-time clusters, Computational Statistics &amp; Data Analysis,
53(8):2817-2830.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (require("splancs")) {
    # load the data from package "splancs"
    data(burkitt, package="splancs")

    # order the times
    burkitt &lt;- burkitt[order(burkitt$t), ]

    #Parameters for the SR detection
    epsilon &lt;- 0.5 # relative change within the cluster
    radius &lt;- 20 # radius
    threshold &lt;- 161 # threshold limit

    res &lt;- stcd(x=burkitt$x,
                y=burkitt$y,
                t=burkitt$t,
                radius=radius,
                epsilon=epsilon,
                areaA=1,
                areaAcapBk=1,
                threshold=threshold)

    #Index of the event
    which.max(res$R &gt;= threshold)
}
</code></pre>


</div>