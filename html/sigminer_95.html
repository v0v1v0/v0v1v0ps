<div class="container">

<table style="width: 100%;"><tr>
<td>show_group_comparison</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Group Comparison Result</h2>

<h3>Description</h3>

<p>Using result data from get_group_comparison, this function plots
genotypes/phenotypes comparison between signature groups using <strong>ggplot2</strong> package and return
a list of <code>ggplot</code> object contains individual and combined plots. The combined
plot is easily saved to local using <code>cowplot::save_plot()</code>. Of note, default fisher
test p values are shown for categorical data and fdr values are shown for
continuous data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">show_group_comparison(
  group_comparison,
  xlab = "group",
  ylab_co = NA,
  legend_title_ca = NA,
  legend_position_ca = "bottom",
  set_ca_sig_yaxis = FALSE,
  set_ca_custom_xlab = FALSE,
  show_pvalue = TRUE,
  ca_p_threshold = 0.01,
  method = "wilcox.test",
  p.adjust.method = "fdr",
  base_size = 12,
  font_size_x = 12,
  text_angle_x = 30,
  text_hjust_x = 0.2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>group_comparison</code></td>
<td>
<p>a <code>list</code> from result of get_group_comparison function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>lab name of x axis for all plots. if it is <code>NA</code>, remove title for x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_co</code></td>
<td>
<p>lab name of y axis for plots of continuous type data. Of note,
this argument should be a character vector has same length as <code>group_comparison</code>,
the location for categorical type data should mark with <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_title_ca</code></td>
<td>
<p>legend title for plots of categorical type data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_position_ca</code></td>
<td>
<p>legend position for plots of categorical type data.
Of note,
this argument should be a character vector has same length as <code>group_comparison</code>,
the location for continuous type data should mark with <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_ca_sig_yaxis</code></td>
<td>
<p>if <code>TRUE</code>, use y axis to show signature proportion instead of
variable proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_ca_custom_xlab</code></td>
<td>
<p>only works when <code>set_ca_sig_yaxis</code> is <code>TRUE</code>. If
<code>TRUE</code>, set x labels using input <code>xlab</code>, otherwise variable names will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_pvalue</code></td>
<td>
<p>if <code>TRUE</code>, show p values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ca_p_threshold</code></td>
<td>
<p>a p threshold for categorical variables, default is 0.01.
A p value less than 0.01 will be shown as <code>P &lt; 0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which method to be used for comparing means.
It can be 't.test', 'wilcox.test' etc..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>correction method, default is 'fdr'. Run <code>p.adjust.methods</code> to
see all available options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>overall font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size_x</code></td>
<td>
<p>font size for x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_angle_x</code></td>
<td>
<p>text angle for x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_hjust_x</code></td>
<td>
<p>adjust x axis text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other paramters pass to <code>ggpubr::compare_means()</code> or <code>ggpubr::stat_compare_means()</code>
according to the specified <code>method</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>list</code> of <code>ggplot</code> objects.
</p>


<h3>Author(s)</h3>

<p>Shixiang Wang <a href="mailto:w_shixiang@163.com">w_shixiang@163.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
load(system.file("extdata", "toy_copynumber_signature_by_W.RData",
  package = "sigminer", mustWork = TRUE
))

# Assign samples to clusters
groups &lt;- get_groups(sig, method = "k-means")

set.seed(1234)

groups$prob &lt;- rnorm(10)
groups$new_group &lt;- sample(c("1", "2", "3", "4", NA), size = nrow(groups), replace = TRUE)

# Compare groups (filter NAs for categorical coloumns)
groups.cmp &lt;- get_group_comparison(groups[, -1],
  col_group = "group",
  cols_to_compare = c("prob", "new_group"),
  type = c("co", "ca"), verbose = TRUE
)

# Compare groups (Set NAs of categorical columns to 'Rest')
groups.cmp2 &lt;- get_group_comparison(groups[, -1],
  col_group = "group",
  cols_to_compare = c("prob", "new_group"),
  type = c("co", "ca"), NAs = "Rest", verbose = TRUE
)

show_group_comparison(groups.cmp)

ggcomp &lt;- show_group_comparison(groups.cmp2)
ggcomp$co_comb
ggcomp$ca_comb

</code></pre>


</div>