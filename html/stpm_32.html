<div class="container">

<table style="width: 100%;"><tr>
<td>spm_con_1d_g</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a 1-D genetic SPM model with constant parameters</h2>

<h3>Description</h3>

<p>This function implements a continuous genetic SPM model by assuming all the parameters are constants.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm_con_1d_g(
  spm_data,
  gene_data,
  a = NA,
  b = NA,
  q = NA,
  f = NA,
  f1 = NA,
  mu0 = NA,
  theta = NA,
  effect = c("a"),
  lower = c(),
  upper = c(),
  control = list(xtol_rel = 1e-06),
  global = FALSE,
  verbose = TRUE,
  ahessian = FALSE,
  method = "lbfgs",
  method.hessian = "L-BFGS-B"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spm_data</code></td>
<td>
<p>A dataset for the SPM model. See the STPM pacakge for more details about the format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_data</code></td>
<td>
<p>A two column dataset containing the genotypes for the individuals in spm_data. 
The first column <code>id</code> is the ID of the individuals in spm_data, 
and the second column <code>geno</code> is the genotype.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">a</code>. 
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">b</code>. 
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">q</code>. 
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f</code>. 
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f_1</code>. 
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\mu_0</code> 
in the baseline hazard.
The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\theta</code> 
in the baseline hazard. The initial value will be predicted if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>A character vector of the parameters that are linked to genotypes. 
The vector can contain any combination of <code>a</code>, <code>b</code>, <code>q</code>, <code>f</code>, <code>mu0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A vector of the lower bound of the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector of the upper bound of the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of the control parameters for the optimization paramters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global</code></td>
<td>
<p>A logical variable indicating whether the MLSL (TRUE) or 
the L-BFGS (FALSE) algorithm is used for the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical variable indicating whether initial 
information is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ahessian</code></td>
<td>
<p>A logical variable indicating whether the 
approximate (FALSE) or analytical (TRUE) Hessian is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimization method. 
Can be one of the following: lbfgs, mlsl, mma, slsqp, tnewton, varmetric.
Default: <code>lbfgs.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.hessian</code></td>
<td>
<p>Optimization method for hessian calculation (if ahessian=F).
Default: <code>L-BFGS-B</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>est The estimates of the parameters.
</p>
<p>hessian The Hessian matrix of the estimates.
</p>
<p>hessian The Hessian matrix of the estimates.
</p>
<p>lik The minus log-likelihood.
</p>
<p>con A number indicating the convergence. See the 'nloptr' package for more details.
</p>
<p>message Extra message about the convergence. See the 'nloptr' package for more details.
</p>
<p>beta The coefficients of the genetic effect on the parameters to be linked to genotypes.
</p>


<h3>References</h3>

<p>He, L., Zhbannikov, I., Arbeev, K. G., Yashin, A. I., and Kulminski, A.M., 2017. 
Genetic stochastic process model for detecting pleiotropic and interaction effects with longitudinal data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
library(stpm) 
data(ex_spmcon1dg)
res &lt;- spm_con_1d_g(ex_data$spm_data, ex_data$gene_data, 
a = -0.02, b=0.2, q=0.01, f=3, f1=3, mu0=0.01, theta=1e-05, 
upper=c(-0.01,3,0.1,10,10,0.1,1e-05), lower=c(-1,0.01,0.00001,1,1,0.001,1e-05), 
effect=c('q'))

## End(Not run)
</code></pre>


</div>