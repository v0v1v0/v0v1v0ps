<div class="container">

<table style="width: 100%;"><tr>
<td>mlePde2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MLE for toroidal process via PDE solving in 2D</h2>

<h3>Description</h3>

<p>Maximum Likelihood Estimation (MLE) for arbitrary diffusions,
based on the transition probability density (tpd) obtained as the numerical
solution of the Fokker–Planck Partial Differential Equation (PDE) in 2D.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlePde2D(data, delta, b, sigma2, Mx = 50, My = 50, Mt = ceiling(100 *
  delta), sdInitial = 0.1, linearBinning = FALSE, start, lower, upper, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix of dimension <code>c(n, p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>discretization step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>drift function. Must return a vector of the same size as its
argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>function giving the diagonal of the diffusion matrix. Must
return a vector of the same size as its argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mx, My</code></td>
<td>
<p>sizes of the equispaced spatial grids in <code class="reqn">[-\pi,\pi)</code> for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mt</code></td>
<td>
<p>size of the time grid in <code class="reqn">[0, t]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdInitial</code></td>
<td>
<p>standard deviations of the concentrated WN giving the
initial condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linearBinning</code></td>
<td>
<p>flag to indicate whether linear binning should be
applied for the initial values of the tpd, instead of usual simple binning
(cheaper). Linear binning is always done in the evaluation of the tpd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values, a matrix with <code>p</code> columns, with each
entry representing a different starting value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>bound for box constraints as in method <code>"L-BFGS-B"</code>
of <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to <code>mleOptimWrapper</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Sections 3.4.2 and 3.4.4 in García-Portugués et al. (2019) for
details. The function currently includes the <code>region</code> function for
imposing a feasibility region on the parameters of the bivariate WN
diffusion.
</p>


<h3>Value</h3>

<p>Output from <code>mleOptimWrapper</code>.
</p>


<h3>References</h3>

<p>García-Portugués, E., Sørensen, M., Mardia, K. V. and Hamelryck, T. (2019)
Langevin diffusions on the torus: estimation and applications.
<em>Statistics and Computing</em>, 29(2):1–22. <a href="https://doi.org/10.1007/s11222-017-9790-2">doi:10.1007/s11222-017-9790-2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Test in OU process
alpha &lt;- c(1, 2, -0.5)
mu &lt;- c(0, 0)
sigma &lt;- c(0.5, 1)
set.seed(2334567)
data &lt;- rTrajMou(x0 = c(0, 0), A = alphaToA(alpha = alpha, sigma = sigma),
                 mu = mu, Sigma = diag(sigma^2), N = 500, delta = 0.5)
b &lt;- function(x, pars) sweep(-x, 2, pars[4:5], "+") %*%
                       t(alphaToA(alpha = pars[1:3], sigma = sigma))
sigma2 &lt;- function(x, pars) repRow(sigma^2, nrow(x))

exactOu &lt;- mleMou(data = data, delta = 0.5, sigma = sigma,
                  start = c(1, 1, 0, 2, 2),
                  lower = c(0.1, 0.1, -25, -10, -10),
                  upper = c(25, 25, 25, 10, 10))
head(exactOu, 2)
pdeOu &lt;- mlePde2D(data = data, delta = 0.5, b = b, sigma2 = sigma2,
                  Mx = 10, My = 10, Mt = 10,
                  start = rbind(c(1, 1, 0, 2, 2)),
                  lower = c(0.1, 0.1, -25, -10, -10),
                  upper = c(25, 25, 25, 10, 10), verbose = 2)
head(pdeOu, 2)
pdeOuLin &lt;- mlePde2D(data = data, delta = 0.5, b = b, sigma2 = sigma2,
                     Mx = 10, My = 10, Mt = 10,
                     start = rbind(c(1, 1, 0, 2, 2)),
                     lower = c(0.1, 0.1, -25, -10, -10),
                     upper = c(25, 25, 25, 10, 10), verbose = 2,
                     linearBinning = TRUE)
head(pdeOuLin, 2)

# Test in WN diffusion
alpha &lt;- c(1, 0.5, 0.25)
mu &lt;- c(0, 0)
sigma &lt;- c(2, 1)
set.seed(234567)
data &lt;- rTrajWn2D(x0 = c(0, 0), alpha = alpha, mu = mu, sigma = sigma,
                    N = 200, delta = 0.5)
b &lt;- function(x, pars) driftWn2D(x = x, A = alphaToA(alpha = pars[1:3],
                                                     sigma = sigma),
                                 mu = pars[4:5], sigma = sigma)
sigma2 &lt;- function(x, pars) repRow(sigma^2, nrow(x))

exactOu &lt;- mleMou(data = data, delta = 0.5, sigma = sigma,
                  start = c(1, 1, 0, 1, 1),
                  lower = c(0.1, 0.1, -25, -25, -25),
                  upper = c(25, 25, 25, 25, 25), optMethod = "nlm")
pdeWn &lt;- mlePde2D(data = data, delta = 0.5, b = b, sigma2 = sigma2,
                  Mx = 20, My = 20, Mt = 10, start = rbind(c(1, 1, 0, 1, 1)),
                  lower = c(0.1, 0.1, -25, -25, -25),
                  upper = c(25, 25, 25, 25, 25), verbose = 2,
                  optMethod = "nlm")
pdeWnLin &lt;- mlePde2D(data = data, delta = 0.5, b = b, sigma2 = sigma2,
                     Mx = 20, My = 20, Mt = 10,
                     start = rbind(c(1, 1, 0, 1, 1)),
                     lower = c(0.1, 0.1, -25, -25, -25),
                     upper = c(25, 25, 25, 25, 25), verbose = 2,
                     linearBinning = TRUE)

head(exactOu)
head(pdeOu)
head(pdeOuLin)

</code></pre>


</div>