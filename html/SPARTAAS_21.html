<div class="container">

<table style="width: 100%;"><tr>
<td>mapclust_cut_tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to cut the dendrogram for a new height (distance limit) or a new number of clusters and map the new partition
</h2>

<h3>Description</h3>

<p>The function returns the new map, one dendrogram with the cut line, the silhouette width and the new vector cluster. You must call mapclust beforehand to get a <code>mapclust_cl</code> object that can be used by mapclust_cut_tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapclust_cut_tree(classification, nb_grp = NA, dlim = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>classification</code></td>
<td>

<p>The object return by mapclust  <code>Class: mapclust_cl</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_grp</code></td>
<td>

<p>The number of groups you want to have on the partition. Must be an integer. (don't use dlim in this case)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlim</code></td>
<td>

<p>The value of dlim at which you wish to cut the dendrogram. You can enter any value (numerical) and the function will select the nearest lower dlim with the same partition. (do not use nb_grp in this case).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the function returns a list.
</p>
<p><strong>Plot:</strong>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dendrogram</code></td>
<td>
<p>The global dendrogram (hclust object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendrogram_ggplot</code></td>
<td>
<p>The global dendrogram (ggplot2 object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuttree</code></td>
<td>
<p>The cut dendrogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>The map of the selected partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AveSilPlot</code></td>
<td>
<p>The average silhouette width plot (for each partition)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WSSPlot</code></td>
<td>
<p>The Within Sum of Square plot (for each partition)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silhouette</code></td>
<td>
<p>The silhouette plot of the selected partition</p>
</td>
</tr>
</table>
<p><strong>Value:</strong>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The x-coordinate data you have used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The y-coordinate data you have used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>The regionalised variable data you have used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>The label vector you have used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>The estimated density based on var. Equal to var if you used a unidimensional density variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>The cluster vector of the selected partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plabel</code></td>
<td>
<p>Logical parameter to activate or not the printing of labels on the dendrogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullhist</code></td>
<td>
<p>The compositional cluster for each observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>The compositional cluster without duplicates (corresponds to the split on the dendogram)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlim</code></td>
<td>
<p>The vector of the different limit distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutdlim</code></td>
<td>
<p>The select dlim for the cut of the current partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DiMatrix</code></td>
<td>
<p>The weighted euclidean distance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silhouetteData</code></td>
<td>
<p>The silhouette data of the selected partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AveSilData</code></td>
<td>
<p>The average silhouette value for each partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Moran</code></td>
<td>
<p>The Moran index for each group for each partition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonlat</code></td>
<td>
<p>Logical parameter, whether your coordinates are in latitude-longitude format or not</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A. COULON
L. BELLANGER
P. HUSI
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## loading data
library(SPARTAAS)
data(datarcheo)

##First you need to run the mapclust function.
#This function allow you to obtain one partition
# object &lt;- mapclust( coord = ..., var = ..., label = ...)
OldClassif &lt;- mapclust(datarcheo$coord, datarcheo$var, datarcheo$label, n = 4)

##In order to cut the dendrogram for another dlim
NewCut &lt;- mapclust_cut_tree(classification = OldClassif, dlim = 0.37)
##In order to cut the dendrogram for another number of cluster
NewCut2 &lt;- mapclust_cut_tree(classification = OldClassif, nb_grp = 4)

#See evaluation using Silhouette width by running:
NewCut$silhouette
#If the plot is empty try to increase the height of the window (full screen).

#See summary of the data by running:
summary(NewCut$silhouetteData)

</code></pre>


</div>