<div class="container">

<table style="width: 100%;"><tr>
<td>bayes_inference</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian hypothesis tests and credible intervals</h2>

<h3>Description</h3>

<p>Bayesian hypothesis tests and credible intervals
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayes_inference(
  y,
  x = NULL,
  data,
  type = c("ci", "ht"),
  statistic = c("mean", "proportion"),
  method = c("theoretical", "simulation"),
  success = NULL,
  null = NULL,
  cred_level = 0.95,
  alternative = c("twosided", "less", "greater"),
  hypothesis_prior = c(H1 = 0.5, H2 = 0.5),
  prior_family = "JZS",
  n_0 = 1,
  mu_0 = null,
  s_0 = 0,
  v_0 = -1,
  rscale = 1,
  beta_prior = NULL,
  beta_prior1 = NULL,
  beta_prior2 = NULL,
  nsim = 10000,
  verbose = TRUE,
  show_summ = verbose,
  show_res = verbose,
  show_plot = verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response variable, can be numerical or categorical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Explanatory variable, categorical (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Name of data frame that y and x are in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>of inference; "ci" (credible interval) or "ht" (hypothesis test)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>population parameter to estimate: mean or proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>of inference; "theoretical" (quantile based) or "simulation"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>success</code></td>
<td>
<p>which level of the categorical variable to call "success", i.e. do inference on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>null value for the hypothesis test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred_level</code></td>
<td>
<p>confidence level, value between 0 and 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>direction of the alternative hypothesis; "less","greater", or "twosided"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis_prior</code></td>
<td>
<p>discrete prior for H1 and H2, default is the uniform prior: c(H1=0.5,H2=0.5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_family</code></td>
<td>
<p>character string representing default priors for inference or testing ("JSZ", "JUI","ref"). 
See notes for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_0</code></td>
<td>
<p>n_0 is the prior sample size in the Normal prior for the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_0</code></td>
<td>
<p>the prior mean in one sample mean problems or the prior difference 
in two sample problems.  For hypothesis testing, this is all the null value
if null is not supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_0</code></td>
<td>
<p>the prior standard deviation of the data for the conjugate Gamma prior on 1/sigma^2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_0</code></td>
<td>
<p>prior degrees of freedom for conjugate Gamma prior on 1/sigma^2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscale</code></td>
<td>
<p>is the scaling parameter in the Cauchy prior:  1/n_0 ~ Gamma(1/2, rscale^2/2)
leads to mu_0  having a Cauchy(0, rscale^2*sigma^2) prior distribution for prior_family="JZS".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_prior, beta_prior1, beta_prior2</code></td>
<td>
<p>beta priors for p (or p_1 and p_2) for one or two proportion inference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of Monte Carlo draws; default is 10,000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether output should be verbose or not, default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_summ</code></td>
<td>
<p>print summary stats, set to verbose by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_res</code></td>
<td>
<p>print results, set to verbose by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_plot</code></td>
<td>
<p>print inference plot, set to verbose by default</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Results of inference task performed.
</p>


<h3>Note</h3>

<p>For inference and testing for normal means several default options are available.
"JZS"  corresponds to using the Jeffreys reference prior on sigma^2, p(sigma^2) = 1/sigma^2, 
and the Zellner-Siow Cauchy prior on the standardized effect size mu/sigma or ( mu_1 - mu_2)/sigma
with a location of mu_0 and scale  rscale.  The "JUI" option also uses the
Jeffreys reference prior on sigma^2, but the Unit Information prior on the
standardized effect, N(mu_0, 1).  The option "ref" uses the improper uniform prior  on 
the standardized effect and the Jeffreys reference prior on  sigma^2.  The latter 
cannot be used for hypothesis testing due to the ill-determination of Bayes
factors.  Finally "NG" corresponds to the conjugate Normal-Gamma prior.
</p>


<h3>References</h3>

<p><a href="https://statswithr.github.io/book/">https://statswithr.github.io/book/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# inference for the mean from a single normal population using
# Jeffreys Reference prior, p(mu, sigma^2) = 1/sigma^2

library(BayesFactor)
data(tapwater)

# Calculate 95% CI using quantiles from Student t derived from ref prior
bayes_inference(tthm, data=tapwater,
                statistic="mean", 
                type="ci", prior_family="ref",
                method="theoretical")
 
# Calculate 95% CI using simulation from Student t using an informative mean and ref
# prior for sigma^2

bayes_inference(tthm, data=tapwater,
                statistic="mean", mu_0=9.8,
                type="ci",  prior_family="JUI",
                method="theo")

# Calculate 95% CI using simulation  with the 
# Cauchy prior on mu and reference prior on sigma^2


bayes_inference(tthm, data=tapwater,
                statistic="mean", mu_0 = 9.8, rscale=sqrt(2)/2,
                type="ci", prior_family="JZS",
                method="simulation")

                
# Bayesian t-test mu = 0 with ZJS prior  
bayes_inference(tthm, data=tapwater,
                statistic="mean",
                type="ht", alternative="twosided", null=80,
                prior_family="JZS",
                method="sim")
                
               
# Bayesian t-test for two means 

data(chickwts)
chickwts = chickwts[chickwts$feed %in% c("horsebean","linseed"),]
# Drop unused factor levels
chickwts$feed = factor(chickwts$feed)                
bayes_inference(y=weight, x=feed, data=chickwts,
                statistic="mean", mu_0 = 0, alt="twosided",
                type="ht", prior_family="JZS",
                method="simulation")               

</code></pre>


</div>