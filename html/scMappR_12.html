<div class="container">

<table style="width: 100%;"><tr>
<td>gProfiler_cellWeighted_Foldchange</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pathway enrichment for cwFold-changes</h2>

<h3>Description</h3>

<p>This function runs through each list of cell weighted Fold changes (cwFold-changes) and completes both pathway and transcription factor (TF) enrichment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gProfiler_cellWeighted_Foldchange(
  cellWeighted_Foldchange_matrix,
  species,
  background,
  gene_cut,
  newGprofiler
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cellWeighted_Foldchange_matrix</code></td>
<td>
<p>Matrix of cell weighted Fold changes from the deconvolute_and_contextualize functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Human, mouse, or a name that is compatible with gProfileR (e.g. "mmusculus").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>A list of background genes to test against.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_cut</code></td>
<td>
<p>The top number of genes in pathway analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newGprofiler</code></td>
<td>
<p>Using gProfileR or gprofiler2, (T/F).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes a matrix of cellWeighted_Foldchange and a species (human, mouse, or a character directly compatible with g:ProfileR).
Before completing pathway analysis with g:ProfileR. Enriched pathways are stored in a list and returned.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>BP</code></td>
<td>
<p>gprofiler enrichment of biological pathways for each cell-type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TF</code></td>
<td>
<p>gprofiler enrichment of transcription factors for eachc cell-type.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

data(PBMC_example)

bulk_DE_cors &lt;- PBMC_example$bulk_DE_cors
bulk_normalized &lt;- PBMC_example$bulk_normalized
odds_ratio_in &lt;- PBMC_example$odds_ratio_in

case_grep &lt;- "_female"
control_grep &lt;- "_male"
max_proportion_change &lt;- 10
print_plots &lt;- FALSE
theSpecies &lt;- "human"
norm &lt;- deconvolute_and_contextualize(count_file = bulk_normalized,
                                     signature_matrix = odds_ratio_in,
                                      DEG_list = bulk_DE_cors, case_grep = case_grep, 
                                      control_grep = control_grep,
                                       max_proportion_change = max_proportion_change,
                                       print_plots = print_plots,
                                       theSpecies = theSpecies)
background = rownames(bulk_normalized)
STVs &lt;- gProfiler_cellWeighted_Foldchange(
 cellWeighted_Foldchange_matrix = norm$cellWeighted_Foldchange,
 species = theSpecies, background = background, gene_cut = -9,
 newGprofiler = TRUE)

 
 
</code></pre>


</div>