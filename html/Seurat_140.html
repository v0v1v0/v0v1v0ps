<div class="container">

<table style="width: 100%;"><tr>
<td>FindVariableFeatures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find variable features</h2>

<h3>Description</h3>

<p>Identifies features that are outliers on a 'mean variability plot'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindVariableFeatures(object, ...)

## S3 method for class 'V3Matrix'
FindVariableFeatures(
  object,
  selection.method = "vst",
  loess.span = 0.3,
  clip.max = "auto",
  mean.function = FastExpMean,
  dispersion.function = FastLogVMR,
  num.bin = 20,
  binning.method = "equal_width",
  verbose = TRUE,
  ...
)

## S3 method for class 'Assay'
FindVariableFeatures(
  object,
  selection.method = "vst",
  loess.span = 0.3,
  clip.max = "auto",
  mean.function = FastExpMean,
  dispersion.function = FastLogVMR,
  num.bin = 20,
  binning.method = "equal_width",
  nfeatures = 2000,
  mean.cutoff = c(0.1, 8),
  dispersion.cutoff = c(1, Inf),
  verbose = TRUE,
  ...
)

## S3 method for class 'SCTAssay'
FindVariableFeatures(object, nfeatures = 2000, ...)

## S3 method for class 'Seurat'
FindVariableFeatures(
  object,
  assay = NULL,
  selection.method = "vst",
  loess.span = 0.3,
  clip.max = "auto",
  mean.function = FastExpMean,
  dispersion.function = FastLogVMR,
  num.bin = 20,
  binning.method = "equal_width",
  nfeatures = 2000,
  mean.cutoff = c(0.1, 8),
  dispersion.cutoff = c(1, Inf),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection.method</code></td>
<td>
<p>How to choose top variable features. Choose one of :
</p>

<ul>
<li> <p>“<code>vst</code>”:  First, fits a line to the relationship of
log(variance) and log(mean) using local polynomial regression (loess).
Then standardizes the feature values using the observed mean and
expected variance (given by the fitted line). Feature variance is then
calculated on the standardized values
after clipping to a maximum (see clip.max parameter).
</p>
</li>
<li> <p>“<code>mean.var.plot</code>” (mvp): First, uses a function to
calculate average expression (mean.function) and dispersion
(dispersion.function) for each feature. Next, divides features into
<code>num.bin</code> (deafult 20) bins based on their average expression,
and calculates z-scores for dispersion within each bin. The purpose of
this is to identify variable features while controlling for the
strong relationship between variability and average expression
</p>
</li>
<li> <p>“<code>dispersion</code>” (disp): selects the genes with the
highest dispersion values
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loess.span</code></td>
<td>
<p>(vst method) Loess span parameter used when fitting the
variance-mean relationship</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clip.max</code></td>
<td>
<p>(vst method) After standardization values larger than
clip.max will be set to clip.max; default is 'auto' which sets this value to
the square root of the number of cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.function</code></td>
<td>
<p>Function to compute x-axis value (average expression).
Default is to take the mean of the detected (i.e. non-zero) values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion.function</code></td>
<td>
<p>Function to compute y-axis value (dispersion).
Default is to take the standard deviation of all values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.bin</code></td>
<td>
<p>Total number of bins to use in the scaled analysis (default
is 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binning.method</code></td>
<td>
<p>Specifies how the bins should be computed. Available
methods are:
</p>

<ul>
<li> <p>“<code>equal_width</code>”: each bin is of equal width along the
x-axis (default)
</p>
</li>
<li> <p>“<code>equal_frequency</code>”: each bin contains an equal number
of features (can increase statistical power to detect overdispersed
eatures at high expression values, at the cost of reduced resolution
along the x-axis)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>show progress bar for calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfeatures</code></td>
<td>
<p>Number of features to select as top variable features;
only used when <code>selection.method</code> is set to <code>'dispersion'</code> or
<code>'vst'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.cutoff</code></td>
<td>
<p>A two-length numeric vector with low- and high-cutoffs for
feature means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion.cutoff</code></td>
<td>
<p>A two-length numeric vector with low- and high-cutoffs for
feature dispersions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Assay to use</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the mean.var.plot method:
Exact parameter settings may vary empirically from dataset to dataset, and
based on visual inspection of the plot. Setting the y.cutoff parameter to 2
identifies features that are more than two standard deviations away from the
average dispersion within a bin. The default X-axis function is the mean
expression level, and for Y-axis it is the log(Variance/mean). All mean/variance
calculations are not performed in log-space, but the results are reported in
log-space - see relevant functions for exact details.
</p>


</div>