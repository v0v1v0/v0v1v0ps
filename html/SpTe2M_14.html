<div class="container">

<table style="width: 100%;"><tr>
<td>spte_semiparmreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the semiparametric spatio-temporal model</h2>

<h3>Description</h3>

<p>The function <code>spte_semiparmreg</code> fits the semiparametric spatio-temporal 
model to study the relationship between the response <code class="reqn">y</code> and covariates 
<code class="reqn">\bm{x}</code> by the method discussed in Qiu and Yang (2021), in which an 
iterative algorithm is used to compute the estimated regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spte_semiparmreg(
  y,
  st,
  x,
  ht = NULL,
  hs = NULL,
  maxIter = 1000,
  tol = 10^(-4),
  stE = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing the data of the spatio-temporal 
response <code class="reqn">y(t,s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>An <code class="reqn">N \times 3</code> matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">N \times p</code> matrix containing the data of the <code class="reqn">p</code> covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>A positive integer specifying the maximum number of iterations allowed. 
Default value is 1,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A positive numeric value specifying the tolerance level for the convergence 
criterion. Default value is 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stE</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times where we 
want to calculate the estimate of the mean. Default is NULL, and 
<code>stE=st</code> if <code>stE=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>The bandwidths (<code>ht</code>, <code>hs</code>) used in the estimation 
procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stE</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>The estimated mean values at spatial locations and times 
specified by <code>stE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The vector of the estimated regression coefficient vector.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2021). Effective Disease Surveillance by Using 
Covariate Information. <em>Statistics in Medicine</em>, <strong>40</strong>, 5725-5745.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st; x &lt;- sim_dat$x
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]; x.sub &lt;- x[ids]
semi.est &lt;- spte_semiparmreg(y.sub,st.sub,x.sub,maxIter=2)   
</code></pre>


</div>