<div class="container">

<table style="width: 100%;"><tr>
<td>reWeightParticles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update the importance weights of each particle.</h2>

<h3>Description</h3>

<p>Update the importance weights of each particle.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reWeightParticles(
  spectra,
  peaks,
  baselines,
  i,
  start,
  sigma,
  old_weights,
  alpha,
  idx
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p><code>n_y * nwl</code> Matrix of observed Raman spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p><code>nwl * npart</code> Matrix containing the spectral signatures for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselines</code></td>
<td>
<p><code>nwl * npart</code> Matrix containing the current values of the baselines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>index of the current observation to use in calculating the likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>index of the next wavelength to use in calculating the likelihood, permuted by <code>idx</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Vector of <code>npart</code> standard deviations for each particle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>old_weights</code></td>
<td>
<p>logarithms of the importance weights of each particle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the target learning rate for the reduction in effective sample size (ESS).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>permutation of the indices of the wavelengths.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a List containing:
</p>

<dl>
<dt><code>ess</code></dt>
<dd>
<p>The effective sample size, after reweighting.</p>
</dd>
<dt><code>weights</code></dt>
<dd>
<p>Vector of updated importance weights.</p>
</dd>
<dt><code>index</code></dt>
<dd>
<p>index of the last wavelength used.</p>
</dd>
<dt><code>evidence</code></dt>
<dd>
<p>SMC estimate of the logarithm of the model evidence.</p>
</dd>
</dl>
<h3>References</h3>

<p>Pitt, dos Santos Silva, Giordani &amp; Kohn (2012)
"On some properties of Markov chain Monte Carlo simulation methods based on the particle filter"
J. Econometrics 171(2): 134â€“151,
DOI: doi: <a href="https://doi.org/10.1016/j.jeconom.2012.06.004">10.1016/j.jeconom.2012.06.004</a>
</p>
<p>Zhou, Johansen &amp; Aston (2015) "Towards Automatic Model Comparison: An Adaptive Sequential Monte Carlo Approach"
<a href="https://arxiv.org/abs/1303.3123">arXiv:1303.3123</a> [stat.ME]
</p>


</div>