<div class="container">

<table style="width: 100%;"><tr>
<td>n.nb.inar1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size Calculation for Comparing Two Groups when observing Longitudinal Count Data with marginal Negative Binomial Distribution and Autoregressive Correlation Structure of Order One: NB-INAR(1)</h2>

<h3>Description</h3>

<p><code>n.nb.inar1</code> calculates the required sample size for proving a desired alternative when testing for
a rate ratio between two groups unequal to one. Also gives back power for a specified sample size. See 'Details' for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">n.nb.inar1(
  alpha,
  power = NULL,
  delta,
  muC,
  size,
  rho,
  tp,
  k,
  npow = NULL,
  nmax = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power (1 - type II error) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the rate ratio which is to be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muC</code></td>
<td>
<p>the rate observed within the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>dispersion parameter (the shape parameter of the gamma mixing distribution). Must be strictly positive, need not be integer (see <code>rnbinom.inar1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of the underlying autoregressive correlation structure. Must be between 0 and 1 (see <code>rnbinom.inar1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp</code></td>
<td>
<p>number of observed time points. (see <code>rnbinom.inar1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npow</code></td>
<td>
<p>sample size for which a power is to be calculated. Can not be specified if power is also specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum total sample size of both groups. If maximum is reached a warning message is broadcasted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When testing for differences between rates <code class="reqn">\mu_C</code> and <code class="reqn">\mu_T</code> of two groups, a control and a treatment group respectively, we usually
test for the ratio between the two rates, i.e. <code class="reqn">\mu_T/\mu_C = 1</code>. The ratio of the two rates is refered to as <code class="reqn">\delta</code>, i.e.
<code class="reqn">\delta = \mu_T/\mu_C</code>.
</p>
<p><code>n.nb.inar1</code> gives back the required sample size for the control and treatment group required to prove an existing
alternative <code>theta</code> with a specified power <code>power</code> when testing the null hypothesis <code class="reqn">H_0: \mu_T/\mu_C \ge 1</code> to level <code>alpha</code>.
If <code>power</code> is not specified but instead <code>npow</code>, the power achieved with a total sample size of <code>npow</code> is calculated.
</p>
<p>For sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the
sample size allocation factor, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>


<h3>Value</h3>

<p><code>rnbinom.inar1</code> returns the required sample size within the control group and treatment group.
</p>


<h3>Source</h3>

<p><code>rnbinom.inar1</code> uses code contributed by Thomas Asendorf.
</p>


<h3>See Also</h3>

<p><code>rnbinom.inar1</code> for information on the NB-INAR(1) model, <code>fit.nb.inar1</code> for calculating
initial parameters required when performing sample size estimation, <code>bssr.nb.inar1</code> for blinded
sample size reestimation within a running trial.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Calculate required sample size to find significant difference with
#80% probability when testing the Nullhypothesis H_0: mu_T/mu_C &gt;= 1
#assuming the true effect delta is 0.8 and rate, size and correlation
#parameter in the control group are 2, 1 and 0.5, respectively.

estimate&lt;-n.nb.inar1(alpha=0.025, power=0.8, delta=0.8, muC=2, size=1, rho=0.5, tp=7, k=1)
summary(estimate)

estimate&lt;-n.nb.inar1(alpha=0.025, npow=200, delta=0.8, muC=2, size=1, rho=0.5, tp=7, k=1)
summary(estimate)
</code></pre>


</div>