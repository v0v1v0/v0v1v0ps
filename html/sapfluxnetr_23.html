<div class="container">

<table style="width: 100%;"><tr>
<td>diurnal_centroid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diurnal centroid calculation</h2>

<h3>Description</h3>

<p>Calculate the diurnal centroid for sapflow variables
</p>


<h3>Usage</h3>

<pre><code class="language-R">diurnal_centroid(variable)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>A numeric vector containing the sapflow values for a day at a
regular intervals. Missing values are allowed but not recommended</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The code for this function has been kindly provided by Jacob Nelson in python
(see https://github.com/jnelson18/FluxnetTools/blob/master/FileS3.py) and has
been translated to a tidy data philosophy in R to be used inside a
<code>summarise</code> statement.
</p>


<h3>Value</h3>

<p>A numeric value with the diurnal centroid value (0 to 24 h)
</p>


<h3>Diurnal centroid algorithm</h3>

<p>Given a continuous subdaily sapflow values at regular intervals
<code class="reqn">V = {x_1, ..., x_n}</code> to obtain the diurnal centroid each value is
multiplied by its interval index and summed up and divided
by the sum of the values for the day and finally the value is normalized to
24h:
</p>
<p style="text-align: center;"><code class="reqn">
\sum {x_1 * 1, x_2 * 2, ... , x_n * n} / \sum {x_1, x_2, ... , x_n} * (24/n)
</code>
</p>

<p>With even values for all the intervals (i.e. 100 for all), centroid converges
to 12h at more than 1000 intervals per day. With only 48 (half hourly
measurements) centroid converges to 12.25h and with 24 intervals (hourly
measurements) centroid converges to 12.5h. So, using diurnal centroid value
in half hourly datasets or above can have a considerable error associated.
</p>


<h3>Author(s)</h3>

<p>Jacob Nelson &amp; VÃ­ctor Granda
</p>


<h3>Examples</h3>

<pre><code class="language-R"># dplyr
library(dplyr)

# check convergence to 12h:
diurnal_centroid(rep(1, 1000)) # 12.012 h
diurnal_centroid(rep(10000, 1000)) # 12.012 h, variable scale not affects calculation

# sapflow diurnal centroid
data('ARG_TRE', package = 'sapfluxnetr')

sfn_metrics(
  ARG_TRE,
  period = '1 day',
  .funs = list(~ diurnal_centroid(.),
               ~ data_coverage(., timestep, period_minutes)),
  solar = FALSE,
  interval = 'general'
)

</code></pre>


</div>