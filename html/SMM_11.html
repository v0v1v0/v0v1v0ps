<div class="container">

<table style="width: 100%;"><tr>
<td>LoglikelihoodSM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Loglikelihood (semi-Markov model)
</h2>

<h3>Description</h3>

<p>Computation of the loglikelihood starting from sequence(s), alphabet, initial distribution, transition matrix and type of sojourn times</p>


<h3>Usage</h3>

<pre><code class="language-R">## parametric case
LoglikelihoodSM(seq, E, mu, Ptrans, distr, param, laws = NULL, TypeSojournTime)
## non-parametric case
LoglikelihoodSM(seq, E, mu, Ptrans, distr, param = NULL, laws, TypeSojournTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seq</code></td>
<td>

<p>List of sequence(s)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>

<p>Vector of state space
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>Vector of initial distribution of length S
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ptrans</code></td>
<td>

<p>Matrix of transition probabilities of the embedded Markov chain <code class="reqn">J=(J_m)_{m}</code> of size SxS
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>

<p>- "NP" for nonparametric case, laws have to be used, param is useless
</p>
<p>- Matrix of distributions of size SxS if TypeSojournTime is equal to "fij";
</p>
<p>- Vector of distributions of size S if TypeSojournTime is equal to "fi" or "fj";
</p>
<p>- A distribution if TypeSojournTime is equal to "f".
</p>
<p>The distributions to be used in distr must be one of "uniform", "geom", "pois", "dweibull", "nbinom".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>

<p>- Useless if distr = "NP"
</p>
<p>- Array of distribution parameters of size SxSx2 (2 corresponds to the maximal number of distribution parameters) if TypeSojournTime is equal to "fij";
</p>
<p>- Matrix of distribution parameters of size Sx2 if TypeSojournTime is equal to "fi" or "fj";
</p>
<p>- Vector of distribution parameters of length 2 if TypeSojournTime is equal to "f". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>laws</code></td>
<td>

<p>- Useless if distr <code class="reqn">\neq</code> "NP"
</p>
<p>- Array of size SxSxKmax if TypeSojournTime is equal to "fij";
</p>
<p>- Matrix of size SxKmax if TypeSojournTime is equal to "fi" or "fj";
</p>
<p>- Vector of length Kmax if the TypeSojournTime is equal to "f". 
</p>
<p>Kmax is the maximum length of the sojourn times. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TypeSojournTime</code></td>
<td>

<p>Character: "fij", "fi", "fj", "f" (for more explanations, see Details)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this package we can choose differents types of sojourn time. Four options are available for the sojourn times:
</p>

<ul>
<li>
<p> depending on the present state and on the next state ("fij");
</p>
</li>
<li>
<p> depending only on the present state ("fi");
</p>
</li>
<li>
<p> depending only on the next state ("fj");
</p>
</li>
<li>
<p> depending neither on the current, nor on the next state ("f").
</p>
</li>
</ul>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Value of loglikelihood for each sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmax</code></td>
<td>
<p>The maximal observed sojourn time</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vlad Stefan Barbu, barbu@univ-rouen.fr <br> Caroline Berard, caroline.berard@univ-rouen.fr <br> Dominique Cellier, dominique.cellier@laposte.net <br> Mathilde Sautreuil, mathilde.sautreuil@etu.univ-rouen.fr <br> Nicolas Vergne, nicolas.vergne@univ-rouen.fr 
</p>


<h3>See Also</h3>

<p>simulSM,
estimMk,
simulMk,
estimSM
</p>


<h3>Examples</h3>

<pre><code class="language-R">alphabet = c("a","c","g","t")
S = length(alphabet)
# creation of the transition matrix
Pij = matrix(c(0,0.2,0.3,0.5,0.4,0,0.2,0.4,0.1,0.2,0,0.7,0.8,0.1,0.1,0), 
nrow = S, ncol = S, byrow = TRUE)

Pij
#     [,1] [,2] [,3] [,4]
#[1,]  0.0  0.2  0.3  0.5
#[2,]  0.4  0.0  0.2  0.4
#[3,]  0.1  0.2  0.0  0.7
#[4,]  0.8  0.1  0.1  0.0

################################
## Parametric estimation of a trajectory (of length equal to 5000), 
## where the sojourn times depend neither on the present state nor on the next state.
################################
## Simulation of a sequence of length 5000
seq5000 = simulSM(E = alphabet, NbSeq = 1, lengthSeq = 5000, TypeSojournTime = "f", 
                init = c(1/4,1/4,1/4,1/4), Ptrans = Pij, distr = "pois", param = 2)
                
#################################
## Computation of the loglikelihood
#################################
LoglikelihoodSM(seq = seq5000, E = alphabet, mu = rep(1/4,4), Ptrans = Pij, 
distr = "pois", param = 2, TypeSojournTime = "f")

#$L
#$L[[1]]
#[1] -1475.348
#
#
#$Kmax
#[1] 10

#------------------------------#
################################
## Non-parametric simulation of several trajectories (3 trajectories of length 1000, 
## 10 000 and 2000 respectively),
## where the sojourn times depend on the present state and on the next state.
################################
## creation of a matrix corresponding to the conditional sojourn time distributions
lengthSeq3 = c(1000, 10000, 2000)
Kmax = 4 
mat1 = matrix(c(0,0.5,0.4,0.6,0.3,0,0.5,0.4,0.7,0.2,0,0.3,0.4,0.6,0.2,0), 
nrow = S, ncol = S, byrow = TRUE)
mat2 = matrix(c(0,0.2,0.3,0.1,0.2,0,0.2,0.3,0.1,0.4,0,0.3,0.2,0.1,0.3,0), 
nrow = S, ncol = S, byrow = TRUE)
mat3 = matrix(c(0,0.1,0.3,0.1,0.3,0,0.1,0.2,0.1,0.2,0,0.3,0.3,0.3,0.4,0), 
nrow = S, ncol = S, byrow = TRUE)
mat4 = matrix(c(0,0.2,0,0.2,0.2,0,0.2,0.1,0.1,0.2,0,0.1,0.1,0,0.1,0), 
nrow = S, ncol = S, byrow = TRUE)
f &lt;- array(c(mat1,mat2,mat3,mat4), c(S,S,Kmax))
### Simulation of 3 sequences
seqNP3 = simulSM(E = alphabet, NbSeq = 3, lengthSeq = lengthSeq3, 
TypeSojournTime = "fij", init = rep(1/4,4), Ptrans = Pij, laws = f, 
File.out = NULL)

#################################
## Computation of the loglikelihood
#################################
LoglikelihoodSM(seq = seqNP3, E = alphabet, mu = rep(1/4,4), Ptrans = Pij, laws = f, 
TypeSojournTime = "fij")

#$L
#$L[[1]]
#[1] -429.35
#
#$L[[2]]
#[1] -4214.521
#
#$L[[3]]
#[1] -818.6451
#
#
#$Kmax
#[1] 4
</code></pre>


</div>