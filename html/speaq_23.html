<div class="container">

<table style="width: 100%;"><tr>
<td>PeakGrouper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Peak grouping with hierarchical clustering</h2>

<h3>Description</h3>

<p>This functions groups the peaks obtained after wavelet based peak detection (with the 'getWaveletPeaks' function).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PeakGrouper(
  Y.peaks,
  grouping.window.width = 100,
  verbose = FALSE,
  min.samp.grp = 1,
  max.dupli.prop = 0.25,
  maxClust = 10,
  Jaccard.regroup.threshold = 0.25,
  linkage = "average"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y.peaks</code></td>
<td>
<p>data frame obtained from the 'getWaveletPeaks' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping.window.width</code></td>
<td>
<p>The width of the sliding window (in measurement points). Measurements are taken for when this sliding window is taken too small, but best set this too a value that a normal peak is comfortably in a window. Note if large shifts occur in your dataset (like in the wine dataset) it is best to set this parameter larger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If set to TRUE the window selection process is documented in real time (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.samp.grp</code></td>
<td>
<p>The minimal amount of samples needed to form a group, see hclust.grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dupli.prop</code></td>
<td>
<p>The maximal duplication proportion allowed for a group to be considered a single group, see hclust.grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxClust</code></td>
<td>
<p>The maximum number of clusters (depth of the tree), see hclust.grouping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jaccard.regroup.threshold</code></td>
<td>
<p>If 2 neighbouring groups have a jaccard index smaller than this 'Jaccard.regroup.threshold' (indicating that they are quite complementary as they have little peaks samples in common), then they are merged and regrouped. This situation can occur if a group is accidentally cut in half by the window approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkage</code></td>
<td>
<p>The linkage to be used in the hierarchical clustering. See the 'method' argument in hclust.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data frame with grouped peaks. Peaks in a group are indicated with an identical peakIndex
</p>


<h3>Author(s)</h3>

<p>Charlie Beirnaert, <a href="mailto:charlie.beirnaert@uantwerpen.be">charlie.beirnaert@uantwerpen.be</a>
</p>


<h3>See Also</h3>

<p><code>hclust.grouping</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">subset &lt;- GetWinedata.subset()
# to reduce the example time we only select spectra 1 &amp; 2
subset.spectra = as.matrix(subset$Spectra)[1:2,] 
subset.ppm = as.numeric(subset$PPM)

test.peaks &lt;- getWaveletPeaks(Y.spec=subset.spectra, 
                              X.ppm=subset.ppm ,
                              nCPU = 1) # nCPU set to 2 for the vignette build

test.grouped &lt;- PeakGrouper(Y.peaks = test.peaks)

</code></pre>


</div>