<div class="container">

<table style="width: 100%;"><tr>
<td>lrt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fix a Free Parameter to Zero and Do an LR Test</h2>

<h3>Description</h3>

<p>Fix the designated
free parameter to zero and do a
likelihood ratio test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lrt(
  fit,
  par_id,
  store_fit = FALSE,
  group = NULL,
  se_keep_bootstrap = FALSE,
  LRT_method = "default",
  scaled.shifted = TRUE,
  fallback_method = "satorra.2000"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A <code>lavaan</code>-class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_id</code></td>
<td>
<p>It can be an integer.
or a string. If it is an integer,
it should be the row
number of the free parameter in the
parameter table of <code>fit</code> to be
fixed to zero. If it is a string,
it must be
a valid <code>lavaan</code> model syntax for
a parameter, or
the label of a labelled parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_fit</code></td>
<td>
<p>Logical. If <code>TRUE</code>,
<code>fit</code> will be stored in the output.
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>If a model syntax
is used in <code>par_id</code> and the model
is a multigroup model, this should
be either the group label or the
group number of the parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_keep_bootstrap</code></td>
<td>
<p>Logical.
If <code>TRUE</code> and <code>fit</code> used
bootstrapping standard error
(with <code>se = "bootstrap"</code>), bootstrapping
will also be use in fitting the
restricted model. If <code>FALSE</code>, the
default, then <code>se</code> will be set
to <code>"standard"</code> if it is <code>"bootstrap"</code>
in <code>fit</code>, to speed up the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRT_method</code></td>
<td>
<p>String. Passed to
the <code>method</code> argument of
<code>lavaan::lavTestLRT()</code>. Default is
<code>"default"</code>, and let
<code>lavaan::lavTestLRT()</code> decide the
method based on <code>fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled.shifted</code></td>
<td>
<p>Logical.
Used when the method used in
<code>lavaan::lavTestLRT()</code> is
<code>"satorra.2000"</code>. Default is
<code>TRUE</code> and a scaled and shifted
test statistic is used, the same
default of <code>lavaan::lavTestLRT()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fallback_method</code></td>
<td>
<p>The default
method of <code>lavaan::lavTestLRT()</code>,
<code>"satorra.bentler.2001"</code>,
may sometimes fail. If failed,
this function will call
<code>lavaan::lavTestLRT()</code>
again using <code>fallback_method</code>. which
is <code>"satorra.2000"</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It fixes the designated
free parameter in a <code>lavaan</code> output,
refit the model, and do a likelihood
ratio test comparing this model with
the original model.
</p>
<p>The model to be fixed is generated
by <code>fix_to_zero()</code>.
</p>
<p>If the parameter to be fixed is
a variance, related covariance(s),
if any, will also be fixed to zero.
</p>
<p>Users should usually call
<code>lrtp()</code> directly instead of calling
this function. It is exported for
developers.
</p>


<h3>Value</h3>

<p>A <code>lrt</code>-class object, which is a
list with the following elements:
</p>

<ul>
<li> <p><code>lrt</code>: The output of <code>lavaan::lavTestLRT()</code>.
If there is an error message or
warning, it is set to <code>NA</code>.
</p>
</li>
<li> <p><code>par_id</code>: The row number of the
designated free parameter.
</p>
</li>
<li> <p><code>par_label</code>: The label of the
designated free parameter,
generated by <code>lavaan::lav_partable_labels()</code>.
</p>
</li>
<li> <p><code>fit1</code>: The original <code>lavaan</code>
output, if <code>store_fit</code> is <code>TRUE</code>.
<code>NA</code> if <code>store_fit</code> is <code>FALSE</code>,
the default.
</p>
</li>
<li> <p><code>fix_to_zero</code>: The output of
<code>fit_to_zero()</code>.
</p>
</li>
<li> <p><code>call</code>: The call to this function.
</p>
</li>
<li> <p><code>lrt_status</code>: Integer. If 0, then
there is no error nor warning
in the likelihood ratio test and
<code>lavaan::lavTestLRT()</code> returns a
table (<code>data.frame</code>) of the test.
If -1, then something is wrong,
e.g., an error or warning occurred
when doing the likelihood ratio
test.
</p>
</li>
<li> <p><code>lrt_msg</code>: If something went wrong
when doing the likelihood ratio
test, this is the error or warning
message when calling
<code>lavaan::lavTestLRT()</code>.
If no error nor warning,
this is <code>NA</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Shu Fai Cheung <a href="https://orcid.org/0000-0002-9871-9448">https://orcid.org/0000-0002-9871-9448</a>
</p>


<h3>See Also</h3>

<p><code>print.lrt()</code> for its
print-method, and <code>lrtp()</code> for the
main function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(lavaan)
data(data_sem16)
mod &lt;-
"
f1 =~ x1 + x2 + x3
f2 =~ x4 + x5 + x6
"
fit &lt;- sem(mod, data_sem16)
# Fix the factor covariance to zero
out &lt;- lrt(fit, par_id = 15)
out$lrt
parameterEstimates(fit)[15, ]
parameterEstimates(out$fix_to_zero$fit0)[15, ]

# Can use model syntax for par_id

out &lt;- lrt(fit, par_id = "f1 =~ x3")
out$lrt

</code></pre>


</div>