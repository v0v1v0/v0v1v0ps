<div class="container">

<table style="width: 100%;"><tr>
<td>secure.path</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential Co-Sparse Factor Regression</h2>

<h3>Description</h3>

<p>Sequential factor extraction via co-sparse unit-rank estimation (SeCURE)
</p>


<h3>Usage</h3>

<pre><code class="language-R">secure.path(Y, X = NULL, nrank = 3, nlambda = 100, U0 = NULL,
  V0 = NULL, D0 = NULL, orthXU = FALSE, orthV = FALSE,
  keepPath = TRUE, control = list(), ic = c("GIC", "BICP", "AIC")[1])
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>covariate matrix; when X = NULL, the fucntion performs unsupervised learning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrank</code></td>
<td>
<p>an integer specifying the desired rank/number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>number of lambda values to be used along each path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U0</code></td>
<td>
<p>initial value of U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V0</code></td>
<td>
<p>initial value of V</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D0</code></td>
<td>
<p>initial value of D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orthXU</code></td>
<td>
<p>if TRUE, orthogonality of XU is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orthV</code></td>
<td>
<p>if TRUE, orthogonality of V is required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepPath</code></td>
<td>
<p>if TRUE, th solution paths of U, V, D are reported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of internal parameters controlling the model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>character specifying which information criterion to use for selecting the tuning parameter: "GIC"(default), "BICP", and "AIC"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>C.est</code></td>
<td>
<p>estimated coefficient matrix; based on modified BIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>estimated U matrix (factor weights)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>estimated singular values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>estimated V matrix (factor loadings)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortX</code></td>
<td>
<p>if TRUE, X is treated as an orthogonal matrix in the computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>selected lambda values based on the chosen information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lampath</code></td>
<td>
<p>sequences of lambda values used in model fitting. In each sequential unit-rank estimation step,
a sequence of length nlambda is first generated between (lamMax*lamMaxFac, lamMax*lamMaxFac*lamMinFac) equally 
spaced on the log scale, in which lamMax is estimated and the other parameters are specified in secure.control.
The model fitting starts from the largest lambda and stops when the maximum proportion of nonzero elements is reached in 
either u or v, as specified by spU and spV in secure.control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>values of information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upath</code></td>
<td>
<p>solution path of U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dpath</code></td>
<td>
<p>solution path of D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vpath</code></td>
<td>
<p>solution path of D</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Mishra, A., Dey, D., Chen, K. (2017) <em> Sequential Co-Sparse Factor Regression, To appear in Journal of Computational and Graphical Statistics (JCGS)</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#require(secure)

# Simulate data from a sparse factor regression model
p &lt;- 100; q &lt;- 100; n &lt;- 200
xrho &lt;- 0.5; nlambda &lt;- 100 
nrank &lt;- 3 

U &lt;- matrix(0,ncol=nrank ,nrow=p);  V &lt;- matrix(0,ncol=nrank ,nrow=q)
U[,1]&lt;-c(sample(c(1,-1),8,replace=TRUE),rep(0,p-8))
U[,2]&lt;-c(rep(0,5),sample(c(1,-1),9,replace=TRUE),rep(0,p-14))
U[,3]&lt;-c(rep(0,11),sample(c(1,-1),9,replace=TRUE),rep(0,p-20))
V[,1]&lt;-c(sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-5))
V[,2]&lt;-c(rep(0,5),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-10))
V[,3]&lt;-c(rep(0,10),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-15))
U[,1:3]&lt;- apply(U[,1:3],2,function(x)x/sqrt(sum(x^2)))
V[,1:3]&lt;- apply(V[,1:3],2,function(x)x/sqrt(sum(x^2)))
D &lt;- diag(c(20,15,10)) 
C &lt;- U%*%D%*%t(V)

Xsigma &lt;- xrho^abs(outer(1:p, 1:p,FUN="-"))
sim.sample &lt;- secure.sim(U,D,V,n,snr = 0.25,Xsigma,rho=0.3)
Y &lt;- sim.sample$Y; 
X &lt;- sim.sample$X



# Fitting secure. Set maximum rank to be 4.
rank.ini &lt;- 4

# Set largest model to about 25% sparsity
# See secure.control for setting other parameters
control &lt;- secure.control(spU=0.25, spV=0.25)

# Complete data case. 
# Fit secure without orthogonality
fit.orthF &lt;- secure.path(Y,X,nrank=rank.ini,nlambda = nlambda,
                        control=control)
# check orthogonality
crossprod(X%*%fit.orthF$U)/n
# check solution
# fit.orthF$U
# fit.orthF$V
# fit.orthF$D

# Fit secure with orthogonality if desired. It takes longer time.
# fit.orthT &lt;- secure.path(Y,X,nrank=rank.ini,nlambda = nlambda,
#                                   orthXU=TRUE,orthV=TRUE,control=control)
# check orthogonality
# crossprod(X%*%fit.orthT$U)/n

  
# 15% missing case
miss &lt;- 0.15
t.ind &lt;- sample.int(n*q, size = miss*n*q)
y &lt;- as.vector(Y); y[t.ind] &lt;- NA;  Ym &lt;- matrix(y,n,q)

fit.orthF.miss &lt;- secure.path(Ym, X, nrank = rank.ini, nlambda = nlambda, 
                            control = control) 
# fit.orthT.miss &lt;- secure.path(Ym, X, nrank = rank.ini, nlambda = nlambda,
#                           orthXU=TRUE,orthV=TRUE, control = control)
</code></pre>


</div>