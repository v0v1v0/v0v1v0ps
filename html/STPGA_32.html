<div class="container">

<table style="width: 100%;"><tr>
<td>CRITERIA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimality Criteria</h2>

<h3>Description</h3>

<p>These are some default design criteria to be minimized. There is a table in the details section that gives the formula for each design criterion and describes their usage. Note that the inputs for these functions come in 3 syntax flavors, namely Type-X, Type-D and Type-K. Users can define and use their owm design criteria as long as it has the Type-X syntax as shown with the examples.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">AOPT(Train, Test, P, lambda = 1e-05, C=NULL)
CDMAX(Train, Test, P, lambda = 1e-05, C=NULL)
CDMAX0(Train, Test, P, lambda = 1e-05, C=NULL)
CDMAX2(Train, Test, P, lambda = 1e-05, C=NULL)
CDMEAN(Train, Test, P, lambda = 1e-05, C=NULL)
CDMEAN0(Train, Test, P, lambda = 1e-05, C=NULL)
CDMEAN2(Train, Test, P, lambda = 1e-05, C=NULL)
CDMEANMM(Train, Test, Kinv,K, lambda = 1e-05, C=NULL, Vg=NULL, Ve=NULL)
DOPT(Train, Test, P, lambda = 1e-05, C=NULL)
EOPT(Train, Test, P, lambda = 1e-05, C=NULL)
GAUSSMEANMM(Train, Test, Kinv, K, lambda = 1e-05, C=NULL, Vg=NULL, Ve=NULL)
GOPTPEV(Train, Test, P, lambda = 1e-05, C=NULL)
GOPTPEV2(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMAX(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMAX0(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMAX2(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMEAN(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMEAN0(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMEAN2(Train, Test, P, lambda = 1e-05, C=NULL)
PEVMEANMM(Train, Test, Kinv,K, lambda = 1e-05, C=NULL, Vg=NULL, Ve=NULL)
dist_to_test(Train, Test, Dst, lambda, C)
dist_to_test2(Train, Test, Dst, lambda, C)
neg_dist_in_train(Train, Test, Dst, lambda, C)
neg_dist_in_train2(Train, Test, Dst, lambda, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Train</code></td>
<td>

<p>vector of identifiers for individuals in the training set
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Test</code></td>
<td>

<p>vector of identifiers for individuals in the test set
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p> (Only for Type-X)
<code class="reqn">n \times k</code> matrix of the first PCs of the predictor variables. The matrix needs to have union of the identifiers of the candidate and test individuals as rownames.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dst</code></td>
<td>
<p> (Only for Type-D)
<code class="reqn">n \times n</code> symmetric distance matrix with row and column names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p> (Only for Type-K)
<code class="reqn">n \times n</code> symmetric matrix (inverse of the relationship matrix K  between n individuals) with row and column names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p> (Only for Type-K)
<code class="reqn">n \times n</code> symmetric matrix (the relationship matrix K  between n individuals).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>scalar shrinkage parameter (<code class="reqn">\lambda&gt;0</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Contrast Matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vg</code></td>
<td>
<p> (Only for PEVMEANMM)
covariance matrix between traits generated by the relationship K (multi-trait version).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ve</code></td>
<td>
<p> (Only for PEVMEANMM)
residual covariance matrix for the traits (multi-trait version). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
  <strong>criterion name</strong>
</td>
<td style="text-align: left;"> <strong>formula</strong> </td>
<td style="text-align: left;"> <strong>Type</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
 

   AOPT </td>
<td style="text-align: left;"> <code class="reqn">trace[C(P'_{Train}P_{Train}+lambda*I)^{-1}C']</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  CDMAX </td>
<td style="text-align: left;"> <code class="reqn">max[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C')/</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">diag(CP_{Test}P'_{Test}C')]</code>   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  CDMAX0 </td>
<td style="text-align: left;"> <code class="reqn">max[diag(CP_{Train}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}C')/</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">diag(CP_{Train}P'_{Train}C')]</code>   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   
 CDMAX2 </td>
<td style="text-align: left;"> <code class="reqn">max[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}P_{Train}</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">  <code class="reqn">(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C')/diag(CP_{Test}P'_{Test}C')]</code> </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  CDMEAN </td>
<td style="text-align: left;"> <code class="reqn">mean[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C')/</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">diag(CP_{Test}P'_{Test}C')]</code>  </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
    
  CDMEAN0 </td>
<td style="text-align: left;">  <code class="reqn">mean[diag(CP_{Train}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}C')/</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">diag(CP_{Train}P'_{Train}C')]</code>  </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

   CDMEAN2 </td>
<td style="text-align: left;">  <code class="reqn">mean[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}P_{Train}</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">  <code class="reqn">(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C')/diag(CP_{Test}P'_{Test}C')] </code> </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  CDMEANMM </td>
<td style="text-align: left;"> <code class="reqn">-mean[diag(CZ_{Test}(K-lambda*(Z_{Train}'MZ_{Train}+\lambda*Kinv)^{-1}Z_{Test}'C')/</code>  </td>
<td style="text-align: left;"> K </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">(diag(CZ_{Test}KZ_{Test}'C'))]</code>   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  DOPT </td>
<td style="text-align: left;">  <code class="reqn">logdet(C(P'_{Train}P_{Train}+lambda*I))^{-1}C'</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  EOPT </td>
<td style="text-align: left;"> <code class="reqn">max(eigenval(C(P'_{Train}P_{Train}+lambda*I))^{-1}C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

   GAUSSMEANMM </td>
<td style="text-align: left;">   <code class="reqn">-mean(diag(Z_{Test}KZ_{Test}'-</code>  </td>
<td style="text-align: left;">  K </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;"> <code class="reqn">Z_{Test}KZ_{Train}'(Z_{Train}KZ_{Train}'+\lambda*I_{ntrain})^{-1}Z_{Train}KZ_{Test}')</code>  </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  GOPTPEV </td>
<td style="text-align: left;"> <code class="reqn">max(eigenval(CP_{Test}(P_{Train}'P_{Train}+\lambda*I_{ntrain})^{-1}P_{Test}'C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  GOPTPEV2 </td>
<td style="text-align: left;"> <code class="reqn">mean(eigenval(CP_{Test}(P_{Train}'P_{Train}+\lambda*I_{ntrain})^{-1}P_{Test}'C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

   PEVMAX </td>
<td style="text-align: left;">   <code class="reqn">max(diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  PEVMAX0 </td>
<td style="text-align: left;">  <code class="reqn">max(diag(CP_{Train}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  PEVMAX2 </td>
<td style="text-align: left;">  <code class="reqn">max[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}P_{Train}</code>  </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">  <code class="reqn">(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C']</code> </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">

  PEVMEAN </td>
<td style="text-align: left;">  <code class="reqn">mean(diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C'))</code>  </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">


  PEVMEAN0 </td>
<td style="text-align: left;"> <code class="reqn">mean(diag(CP_{Train}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Train}C'))</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
  
  PEVMEAN2 </td>
<td style="text-align: left;"> <code class="reqn">mean[diag(CP_{Test}(P'_{Train}P_{Train}+lambda*I)^{-1}</code> </td>
<td style="text-align: left;"> X </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">  <code class="reqn">P'_{Train}P_{Train}(P'_{Train}P_{Train}+lambda*I)^{-1}P'_{Test}C']</code>  </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
   
   PEVMEANMM </td>
<td style="text-align: left;"> <code class="reqn">mean(diag(CZ_{test}(Ztrain'MZtrain+lambda*Kinv)^{-1}Ztest'C')))</code> </td>
<td style="text-align: left;"> K </td>
</tr>
<tr>
<td style="text-align: left;">
   dist_to_test </td>
<td style="text-align: left;"> maximum distance from training set to test set based on Dst  </td>
<td style="text-align: left;"> D </td>
</tr>
<tr>
<td style="text-align: left;">
    dist_to_test2 </td>
<td style="text-align: left;"> mean distance from training set to test set based on Dst  </td>
<td style="text-align: left;"> D </td>
</tr>
<tr>
<td style="text-align: left;">
    neg_dist_in_train </td>
<td style="text-align: left;"> negative of minimum distance between pairs in the training set based on Dst  </td>
<td style="text-align: left;"> D </td>
</tr>
<tr>
<td style="text-align: left;">
    neg_dist_in_train2 </td>
<td style="text-align: left;"> negative of mean distance between distinct pairs in the training set based on Dst  </td>
<td style="text-align: left;"> D </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
<td style="text-align: left;">   </td>
<td style="text-align: left;">  </td>
</tr>
<tr>
<td style="text-align: left;">
 </td>
</tr>
</table>
<h3>Value</h3>

<p>value of the criterion.</p>


<h3>Author(s)</h3>

<p>Deniz Akdemir</p>


<h3>Examples</h3>

<pre><code class="language-R">	## Not run: 
#Examples to new criterion:
#1- PEVmax
STPGAUSERFUNC&lt;-function(Train,Test, P, lambda=1e-6, C=NULL){
  PTrain&lt;-P[rownames(P)%in%Train,]
  PTest&lt;-P[rownames(P)%in%Test,]
  if (length(Test)==1){PTest=matrix(PTest, nrow=1)}
  if (!is.null(C)){ PTest&lt;-C%*%PTest}
  PEV&lt;-PTest%*%solve(crossprod(PTrain)+lambda*diag(ncol(PTrain)),t(PTrain))
    PEVmax&lt;-max(diag(tcrossprod(PEV)))
  return(PEVmax)
}




######Here is an example of usage
data(iris)
#We will try to estimate petal width from
#variables sepal length and width and petal length.
X&lt;-as.matrix(iris[,1:4])
distX&lt;-as.matrix(dist(X))
rownames(distX)&lt;-colnames(distX)&lt;-rownames(X)&lt;-paste(iris[,5],rep(1:50,3),sep="_" )
#test data 25 iris plants selected at random from the virginica family,
#candidates are the plants in the  setosa and versicolor families.
candidates&lt;-rownames(X)[1:100]
test&lt;-sample(setdiff(rownames(X),candidates), 25)
#want to select 25 examples using the criterion defined in STPGAUSERFUNC
#Increase niterations and npop substantially for better convergence.
ListTrain&lt;-GenAlgForSubsetSelection(P=distX,Candidates=candidates,
Test=test,ntoselect=25,npop=50,
nelite=5, mutprob=.8, niterations=30,
lambda=1e-5, errorstat="STPGAUSERFUNC", plotiters=TRUE)

## End(Not run)
</code></pre>


</div>