<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mhmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interactive Plotting for Mixed Hidden Markov Model (mhmm)</h2>

<h3>Description</h3>

<p>Function <code>plot.mhmm</code> plots a directed graph of the parameters of each model
with pie charts of emission probabilities as vertices/nodes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mhmm'
plot(
  x,
  interactive = TRUE,
  ask = FALSE,
  which.plots = NULL,
  nrow = NA,
  ncol = NA,
  byrow = FALSE,
  row.prop = "auto",
  col.prop = "auto",
  layout = "horizontal",
  pie = TRUE,
  vertex.size = 40,
  vertex.label = "initial.probs",
  vertex.label.dist = "auto",
  vertex.label.pos = "bottom",
  vertex.label.family = "sans",
  loops = FALSE,
  edge.curved = TRUE,
  edge.label = "auto",
  edge.width = "auto",
  cex.edge.width = 1,
  edge.arrow.size = 1.5,
  edge.label.family = "sans",
  label.signif = 2,
  label.scientific = FALSE,
  label.max.length = 6,
  trim = 1e-15,
  combine.slices = 0.05,
  combined.slice.color = "white",
  combined.slice.label = "others",
  with.legend = "bottom",
  ltext = NULL,
  legend.prop = 0.5,
  cex.legend = 1,
  ncol.legend = "auto",
  cpal = "auto",
  main = "auto",
  withlegend,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A hidden Markov model object of class <code>mhmm</code> created with
<code>build_mhmm</code> (or <code>build_mmm</code> or
<code>build_lcm</code>). Multichannel
<code>mhmm</code> objects are automatically transformed into single-channel objects.
See function <code>mc_to_sc</code> for more information on the
transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>Whether to plot each cluster in succession or in a grid.
Defaults to <code>TRUE</code>, i.e. clusters are plotted one after another.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>If <code>TRUE</code> and <code>which.plots</code> is NULL,
<code>plot.mhmm</code> operates in interactive mode, via <code>menu</code>.
Defaults to <code>FALSE</code>. Ignored if <code>interactive = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>The number(s) of the requested cluster(s) as an integer
vector. The default <code>NULL</code> produces all plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow, ncol</code></td>
<td>
<p>Optional arguments to arrange plots in a grid. Ignored if
<code>interactive = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byrow</code></td>
<td>
<p>Controls the order of plotting in a grid. Defaults to <code>FALSE</code>,
i.e. plots are arranged column-wise. Ignored if <code>interactive = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.prop</code></td>
<td>
<p>Sets the proportions of the row heights of the grid. The default
value is <code>"auto"</code> for even row heights. Takes a vector of values from
0 to 1, with values summing to 1. Ignored if <code>interactive = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.prop</code></td>
<td>
<p>Sets the proportion of the column heights of the grid. The default
value is <code>"auto"</code> for even column widths. Takes a vector of values
from 0 to 1, with values summing to 1. Ignored if <code>interactive = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>specifies the layout of vertices (nodes). Accepts a
numerical matrix, a <code>layout_</code> function (without quotation marks),
or either of the predefined options <code>"horizontal"</code> (the
default) and <code>"vertical"</code>. Options <code>"horizontal"</code> and
<code>"vertical"</code> position vertices at the same horizontal or vertical
line. A two-column numerical matrix can be used to give x and y coordinates of
the vertices. The <code>layout_</code> functions available in the
<code>igraph</code> package offer other automatic layouts for graphs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie</code></td>
<td>
<p>Are vertices plotted as pie charts of emission probabilities?
Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.size</code></td>
<td>
<p>Size of vertices, given as a scalar or numerical
vector. The default value is 40.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.label</code></td>
<td>
<p>Labels for vertices. Possible options include
<code>"initial.probs"</code>, <code>"names"</code>, <code>NA</code>, and a character or
numerical vector. The default <code>"initial.probs"</code> prints the initial
probabilities of the model and <code>"names"</code> prints the names of the
hidden states as labels. <code>NA</code> prints no labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.label.dist</code></td>
<td>
<p>Distance of the label of the vertex from its
center. The default value <code>"auto"</code> places the label outside the
vertex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.label.pos</code></td>
<td>
<p>Positions of vertex labels, relative to
the center of the vertex. A scalar or numerical vector giving
position(s) as radians or one of <code>"bottom"</code> (<code>pi/2</code> as radians),
<code>"top"</code> (<code>-pi/2</code>), <code>"left"</code> (<code>pi</code>), or
<code>"right"</code> (<code>0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.label.family, edge.label.family</code></td>
<td>
<p>Font family to be used for
vertex/edge labels. See argument <code>family</code> in <code>par</code> for
more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loops</code></td>
<td>
<p>Defines whether transitions back to same states are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.curved</code></td>
<td>
<p>Defines whether to plot curved edges (arcs, arrows)
between vertices. A logical or numerical vector or scalar. Numerical
values specify curvatures of edges. The default value <code>TRUE</code>
gives curvature of 0.5 to all edges. See <code>igraph.plotting</code> for
more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.label</code></td>
<td>
<p>Labels for edges. Possible options include
<code>"auto"</code>, <code>NA</code>, and a character or numerical vector. The
default <code>"auto"</code> prints transition probabilities as edge labels.
<code>NA</code> prints no labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.width</code></td>
<td>
<p>Width(s) for edges. The default <code>"auto"</code> determines
widths according to transition probabilities between hidden states.
Other possibilities are a scalar or a numerical vector of widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.edge.width</code></td>
<td>
<p>An expansion factor for edge widths. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.arrow.size</code></td>
<td>
<p>Size of the arrow in edges (constant). Defaults to 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.signif</code></td>
<td>
<p>Rounds labels of model parameters to specified number
of significant digits, 2 by default. Ignored for user-given labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.scientific</code></td>
<td>
<p>Defines if scientific notation should be used to
describe small numbers. Defaults to <code>FALSE</code>, e.g. 0.0001 instead of
1e-04. Ignored for user-given labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.max.length</code></td>
<td>
<p>Maximum number of digits in labels of model
parameters. Ignored for user-given labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Scalar between 0 and 1 giving the highest probability of
transitions that are plotted as edges, defaults to 1e-15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine.slices</code></td>
<td>
<p>Scalar between 0 and 1 giving the highest probability
of emission probabilities that are combined into one state. The dafault
value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combined.slice.color</code></td>
<td>
<p>Color of the combined slice that includes
the smallest emission probabilities (only if argument
<code>"combine.slices"</code> is greater than 0). The default color is white.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combined.slice.label</code></td>
<td>
<p>The label for combined states (when argument
<code>"combine.slices"</code> is greater than 0) to appear in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>Defines if and where the legend of state colors is
plotted. Possible values include <code>"bottom"</code> (the default),
<code>"top"</code>, <code>"left"</code>, and <code>"right"</code>. <code>FALSE</code> omits the
legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltext</code></td>
<td>
<p>Optional description of (combined) observed states to appear
in the legend. A vector of character strings. See <code>seqplot</code> for
more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.prop</code></td>
<td>
<p>Proportion used for plotting the legend. A scalar between
0 and 1, defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>Expansion factor for setting the size of the font for
labels in the legend. The default value is 1. Values lesser than 1 will
reduce the size of the font, values greater than 1 will increase the size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.legend</code></td>
<td>
<p>The number of columns for the legend. The default value
<code>"auto"</code> sets the number of columns automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpal</code></td>
<td>
<p>Optional color palette for (combinations of) observed states.
The default value <code>"auto"</code> uses automatic color palette. Otherwise a
vector of length <code>x$n_symbols</code> is given, i.e. the argument requires a color
specified for all (combinations of) observed states even if they are not
plotted (if the probability is less than <code>combine.slices</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Optional main titles for plots. The default <code>"auto"</code> uses
<code>cluster_names</code> as titles, <code>NULL</code> prints no titles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withlegend</code></td>
<td>
<p>Deprecated. Use <code>with.legend</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters passed on to <code>plot.igraph</code> such as
<code>vertex.color</code>, <code>vertex.label.cex</code>, or <code>edge.lty</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Helske S. and Helske J. (2019). Mixture Hidden Markov Models for Sequence Data: The seqHMM Package in R,
Journal of Statistical Software, 88(3), 1-32. doi:10.18637/jss.v088.i03
</p>


<h3>See Also</h3>

<p><code>build_mhmm</code> and <code>fit_model</code> for building and
fitting mixture hidden Markov models; <code>plot.igraph</code> for plotting
directed graphs; and <code>mhmm_biofam</code> and <code>mhmm_mvad</code> for
the models used in examples.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading mixture hidden Markov model (mhmm object)
# of the biofam data
data("mhmm_biofam")

# Plotting only the first cluster
plot(mhmm_biofam, which.plots = 1)

if (interactive()) {
  # Plotting each cluster (change with Enter)
  plot(mhmm_biofam)

  # Choosing the cluster (one at a time)
  plot(mhmm_biofam, ask = TRUE)

  # Loading MHMM of the mvad data
  data("mhmm_mvad")

  # Plotting models in the same graph (in a grid)
  # Note: the plotting window must be high enough!
  set.seed(123)
  plot(mhmm_mvad,
    interactive = FALSE,
    # automatic layout, legend on the right-hand side
    layout = layout_nicely, with.legend = "right",
    # Smaller and less curved edges
    edge.curved = 0.2, cex.edge.width = 0.5, edge.arrow.size = 0.7,
    vertex.label.pos = -4 * pi / 5, vertex.label.dist = 5
  )
}

</code></pre>


</div>