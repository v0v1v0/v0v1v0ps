<div class="container">

<table style="width: 100%;"><tr>
<td>plotSlideWindowTune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize parameter tuning for sliding window approach</h2>

<h3>Description</h3>

<p>Visualize results from slideWindowTune
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSlideWindowTune(
  tuneList,
  plotFiltered = c("filtered", "remaining", "per_mutation"),
  percentage = FALSE,
  jitter.x = FALSE,
  jitter.x.amt = 0.1,
  jitter.y = FALSE,
  jitter.y.amt = 0.1,
  pchs = 1:length(tuneList),
  ltys = 1:length(tuneList),
  cols = 1,
  plotLegend = TRUE,
  legendPos = "topright",
  legendHoriz = FALSE,
  legendCex = 1,
  title = NULL,
  returnRaw = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tuneList</code></td>
<td>
<p>a list of logical matrices returned by slideWindowTune.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotFiltered</code></td>
<td>
<p>whether to plot the number of filtered ('filtered'), 
or remaining ('remaining') sequences for each mutation threshold. 
Use 'per_mutation' to plot the number of sequences at each mutation
value. Default is <code>'filtered'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentage</code></td>
<td>
<p>whether to plot on the y-axis the percentage of filtered sequences
(as opposed to the absolute number). Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.x</code></td>
<td>
<p>whether to jitter x-axis values. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.x.amt</code></td>
<td>
<p>amount of jittering to be applied on x-axis values if 
<code>jitter.x=TRUE</code>. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.y</code></td>
<td>
<p>whether to jitter y-axis values. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.y.amt</code></td>
<td>
<p>amount of jittering to be applied on y-axis values if 
<code>jitter.y=TRUE</code>. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchs</code></td>
<td>
<p>point types to pass on to plot. Default is
<code>1:length(tuneList)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltys</code></td>
<td>
<p>line types to pass on to plot. Default is
<code>1:length(tuneList)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>colors to pass on to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotLegend</code></td>
<td>
<p>whether to plot legend. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPos</code></td>
<td>
<p>position of legend to pass on to legend. Can be either a
numeric vector specifying x-y coordinates, or one of 
<code>"topright"</code>, <code>"center"</code>, etc. Default is <code>"topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendHoriz</code></td>
<td>
<p>whether to make legend horizontal. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendCex</code></td>
<td>
<p>numeric values by which legend should be magnified relative to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>plot main title. Default is NULL (no title)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnRaw</code></td>
<td>
<p>Return a data.frame with sequence counts (TRUE) or a
plot. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each <code>windowSize</code>, if <code>plotFiltered='filtered'</code>, the x-axis 
represents a mutation threshold range, and the y-axis the number of
sequences that have at least that number of mutations. If 
<code>plotFiltered='remaining'</code>, the y-axis represents the number of sequences
that have less mutations than the mutation threshold range. For the same
window size, a sequence can be included in the counts for different
mutation thresholds. For example, sequence "CCACCAAAA" with germline
"AAAAAAAAA" has 4 mutations. This sequence has at least 2 mutations 
and at least 3 mutations, in a window of size 4. the sequence will
be included in the sequence count for mutation thresholds 2 and 3.
If <code>plotFiltered='per_mutation'</code>, the sequences are counted only once 
for each window size, at their largest mutation threshold. The above 
example sequence would be included in the sequence count for 
mutation threshold 3. 
</p>
<p>When plotting, a user-defined <code>amount</code> of jittering can be applied on values plotted
on either axis or both axes via adjusting <code>jitter.x</code>, <code>jitter.y</code>, 
<code>jitter.x.amt</code> and <code>jitter.y.amt</code>. This may be help with visually distinguishing
lines for different window sizes in case they are very close or identical to each other. 
If plotting percentages (<code>percentage=TRUE</code>) and using jittering on the y-axis values 
(<code>jitter.y=TRUE</code>), it is strongly recommended that <code>jitter.y.amt</code> be set very
small (e.g. 0.01). 
</p>
<p><code>NA</code> for a combination of <code>mutThresh</code> and <code>windowSize</code> where 
<code>mutThresh</code> is greater than <code>windowSize</code> will not be plotted.
</p>


<h3>See Also</h3>

<p>See slideWindowTune for how to get <code>tuneList</code>. See jitter for 
use of <code>amount</code> of jittering.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use an entry in the example data for input and germline sequence
data(ExampleDb, package="alakazam")

# Try out thresholds of 2-4 mutations in window sizes of 3-5 nucleotides 
# on a subset of ExampleDb
tuneList &lt;- slideWindowTune(db = ExampleDb[1:10, ], 
                           mutThreshRange = 2:4, windowSizeRange = 3:5,
                           verbose = FALSE)

# Visualize
# Plot numbers of sequences filtered without jittering y-axis values
plotSlideWindowTune(tuneList, pchs=1:3, ltys=1:3, cols=1:3, 
                    plotFiltered='filtered', jitter.y=FALSE)
                    
# Notice that some of the lines overlap
# Jittering could help
plotSlideWindowTune(tuneList, pchs=1:3, ltys=1:3, cols=1:3,
                    plotFiltered='filtered', jitter.y=TRUE)
                    
# Plot numbers of sequences remaining instead of filtered
plotSlideWindowTune(tuneList, pchs=1:3, ltys=1:3, cols=1:3, 
                    plotFiltered='remaining', jitter.y=TRUE, 
                    legendPos="bottomright")
                    
# Plot percentages of sequences filtered with a tiny amount of jittering
plotSlideWindowTune(tuneList, pchs=1:3, ltys=1:3, cols=1:3,
                    plotFiltered='filtered', percentage=TRUE, 
                    jitter.y=TRUE, jitter.y.amt=0.01)
</code></pre>


</div>