<div class="container">

<table style="width: 100%;"><tr>
<td>psm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Posterior Pairwise Similarity for All Pairs of Items</h2>

<h3>Description</h3>

<p>Compute the Posterior Pairwise Similarity for All Pairs of Items
</p>


<h3>Usage</h3>

<pre><code class="language-R">psm(partitions)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>partitions</code></td>
<td>
<p>A matrix, with each row a numeric vector cluster labels</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A symmetric matrix of pairwise similarities based on the partitions
given.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Neal (2000) model and data
nealData &lt;- c(-1.48, -1.40, -1.16, -1.08, -1.02, 0.14, 0.51, 0.53, 0.78)
mkLogPosteriorPredictiveDensity &lt;- function(data = nealData,
                                            sigma2 = 0.1^2,
                                            mu0 = 0,
                                            sigma02 = 1) {
  function(i, subset) {
    posteriorVariance &lt;- 1 / ( 1/sigma02 + length(subset)/sigma2 )
    posteriorMean &lt;- posteriorVariance * ( mu0/sigma02 + sum(data[subset])/sigma2 )
    posteriorPredictiveSD &lt;- sqrt(posteriorVariance + sigma2)
    dnorm(data[i], posteriorMean, posteriorPredictiveSD, log=TRUE)
  }
}

logPostPredict &lt;- mkLogPosteriorPredictiveDensity()

nSamples &lt;- 500L
partitions &lt;- matrix(0, nrow=nSamples, ncol=length(nealData))
for ( i in 2:nSamples ) {
  partitions[i,] &lt;- nealAlgorithm3(partitions[i-1,], logPostPredict, mass = 1.0, nUpdates = 2)
}

psm(partitions)
</code></pre>


</div>