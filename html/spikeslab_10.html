<div class="container">

<table style="width: 100%;"><tr>
<td>sparsePC.spikeslab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiclass Prediction using Spike and Slab Regression</h2>

<h3>Description</h3>

<p>Variable selection for the multiclass gene prediction problem.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparsePC.spikeslab(x = NULL, y = NULL, n.rep = 10,
  n.iter1 = 150, n.iter2 = 100, n.prcmp = 5, max.genes = 100,
  ntree = 1000, nodesize = 1, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x matrix of gene expressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Class labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep</code></td>
<td>
<p>Number of Monte Carlo replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter1</code></td>
<td>
<p>Number of burn-in Gibbs sampled values (i.e., discarded values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter2</code></td>
<td>
<p>Number of Gibbs sampled values, following burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.prcmp</code></td>
<td>
<p>Number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.genes</code></td>
<td>
<p>Maximum number of genes in final model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>Number of trees used by random forests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodesize</code></td>
<td>
<p>Nodesize of trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE, verbose output is sent to the terminal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiclass prediction using a hybrid combination of spike and slab
linear regression and random forest multiclass prediction (Ishwaran
and Rao, 2009).  A pseudo y-vector of response values is calculated
using each of the top <code>n.prcmp</code> principal components of the
x-gene expression matrix.  The generalized elastic net obtained from
using spike and slab regression is used to select genes; one
regression fit is used for each of the pseduo y-response vectors.  The
final combined set of genes are passed to random forests and used to
construct a multiclass forest predictor.  This procedure is repeated
<code>n.rep</code> times with each Monte Carlo replicate based on balanced
cross-validation with 2/3rds of the data used for training and 1/3rd
used for testing.
</p>
<p>â€”&gt; Miscellanea:
</p>
<p>Test set error is only computed when <code>n.rep</code> is larger than 1.
If <code>n.rep</code>=1 the full data is used without any cross-validation.
</p>


<h3>Value</h3>

<p>Invisibly, the final set of selected genes as well as the complete set
of genes selected over the <code>n.rep</code> Monte Carlo replications.  The
random forest classifier is also returned.
</p>
<p>The misclassification error rate, error rate for each class, and other
summary information are output to the terminal.
</p>


<h3>Author(s)</h3>

<p>Hemant Ishwaran (<a href="mailto:hemant.ishwaran@gmail.com">hemant.ishwaran@gmail.com</a>)
</p>
<p>J. Sunil Rao (<a href="mailto:rao.jsunil@gmail.com">rao.jsunil@gmail.com</a>)
</p>
<p>Udaya B. Kogalur (<a href="mailto:ubk@kogalur.com">ubk@kogalur.com</a>)
</p>


<h3>References</h3>

<p>Ishwaran H. and Rao J.S. (2009).  Generalized ridge regression:
geometry and computational solutions when p is larger than n.
</p>


<h3>See Also</h3>

<p><code>spikeslab</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#------------------------------------------------------------
# Example 1:  leukemia data
#------------------------------------------------------------

data(leukemia, package = "spikeslab")
sparsePC.out &lt;- sparsePC(x = leukemia[, -1], y = leukemia[, 1], n.rep = 3)
rf.obj &lt;- sparsePC.out$rf.obj
varImpPlot(rf.obj)

## End(Not run)
</code></pre>


</div>