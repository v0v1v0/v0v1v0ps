<div class="container">

<table style="width: 100%;"><tr>
<td>localmoran_bv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Local Bivariate Moran's I Statistic</h2>

<h3>Description</h3>

<p>Given two continuous numeric variables, calculate the bivariate Local Moran's I.
</p>


<h3>Usage</h3>

<pre><code class="language-R">localmoran_bv(x, y, listw, nsim = 199, scale = TRUE, alternative="two.sided",
 iseed=1L, no_repeat_in_row=FALSE, zero.policy=attr(listw, "zero.policy"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of same length as <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a listw object for example as created by <code>nb2listw()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of "greater" (default), "two.sided", or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iseed</code></td>
<td>
<p>default NULL, used to set the seed; the output will only be reproducible if the count of CPU cores across which computation is distributed is the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_repeat_in_row</code></td>
<td>
<p>default <code>FALSE</code>, if <code>TRUE</code>, sample conditionally in each row without replacements to avoid duplicate values, <a href="https://github.com/r-spatial/spdep/issues/124">https://github.com/r-spatial/spdep/issues/124</a></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bivariate Local Moran, like its global counterpart, evaluates the value
of x at observation i with its spatial neighbors' value of y. The value of <code class="reqn">I_i^B</code> is xi * Wyi. Or, in simpler words, the local bivariate Moran is the result of multiplying x by the spatial lag of y. Formally it is defined as
</p>
<p><code class="reqn">
I_i^B= cx_i\Sigma_j{w_{ij}y_j}
</code>
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> containing two columns <code>Ib</code> and <code>p_sim</code> containing the local bivariate Moran's I and simulated p-values respectively.
</p>


<h3>Author(s)</h3>

<p>Josiah Parry <a href="mailto:josiah.parry@gmail.com">josiah.parry@gmail.com</a></p>


<h3>References</h3>

<p>Anselin, Luc, Ibnu Syabri, and Oleg Smirnov. 2002. “Visualizing Multivariate Spatial Correlation with Dynamically Linked Windows.” In New Tools for Spatial Data Analysis: Proceedings of the Specialist Meeting, edited by Luc Anselin and Sergio Rey. University of California, Santa Barbara: Center for Spatially Integrated Social Science (CSISS).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load columbus datay
columbus &lt;- st_read(system.file("shapes/columbus.gpkg", package="spData"))
nb &lt;- poly2nb(columbus)
listw &lt;- nb2listw(nb)
set.seed(1)
(res &lt;- localmoran_bv(columbus$CRIME, columbus$INC, listw, nsim = 499))
columbus$hs &lt;- hotspot(res, Prname="Pr(folded) Sim", cutoff=0.05,
 quadrant.type="pysal", p.adjust="none")

if (require("tmap", quietly=TRUE)) {
tmap4 &lt;- packageVersion("tmap") &gt;= "3.99"
if (tmap4) {
  tm_shape(columbus) + tm_polygons(fill="hs",
    fill.scale=tm_scale(values="brewer.set3"),
    fill.legend=tm_legend(position=tm_pos_in("left", "top"),
      frame=FALSE, item.r=0), lwd=0.01)
} else {
  tm_shape(columbus) + tm_fill("hs")
}
}

moran.plot(x=columbus$CRIME, y=columbus$INC, listw=listw)
</code></pre>


</div>