<div class="container">

<table style="width: 100%;"><tr>
<td>slapmeg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for
longitudinal Omics data</h2>

<h3>Description</h3>

<p>A two-step procedure is adopted, first a joint latent process mixed effects model
is fitted and on the longitudinal data to summarize the temporal trend in terms of
several random effects. For computational efficacy, if the size of pathway is
larger than 10 a paired approah is used to estimate the random effects with the
<code>pairslapmeg</code> function. The random effects are the input for globaltest which
is used to compare the two groups at a pathway level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">slapmeg(fixed, random, grouping, subject, data, nlimit = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A two-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level. Names
of omics in the pathway are separated by <code>+</code> on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of the <code>~</code>. For
identifiability purposes, the intercept should always be present in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>name of the covariate representing grouping by the phenotype</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables named in <code>fixed</code>, <code>random</code>,
<code>grouping</code> and <code>subject</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlimit</code></td>
<td>
<p>A controling arguments telling slapmeg to use pairwise approach for pathways larger than this value,
default is 10. Note: fitting the joint model may take long for pathways larger than 20 omics.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned including: </p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfix</code></td>
<td>
<p>Number
of fixed effect terms in the model, excluding the mandatory intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>Number of
random effect terms in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsubj</code></td>
<td>
<p>Number of subjects in the sataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Table of repeated measures, and number of subjects with the specified number of repeated measures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tgroup</code></td>
<td>
<p>Table of grouping, and number of subjects in each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ynames</code></td>
<td>
<p>Name of the
Omics in the pathway</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slapconv</code></td>
<td>
<p>Status of convergence: For joint method(=1 if the convergence
criteria were satisfied, =2 if the maximum number of iterations was reached, =4 or 5 if a problem
occured during optimisation); for the pairwise method, proportion of successfully converged pairs
is reported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedform</code></td>
<td>
<p>Names of Fixed effect terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randform</code></td>
<td>
<p>Names of random effect
terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slapmethod</code></td>
<td>
<p>The method which is "joint" if the original slapmeg approach is adopted
and pairwise for the pairwise method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SLaP.par</code></td>
<td>
<p>Fitted values for
the parameters in the joint class mixed model in the first step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Globaltest</code></td>
<td>
<p>The output
from Globaltest at the second step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EB_pred</code></td>
<td>
<p>Empirical
bayes estimates for the random effects from the joint model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>


<h3>References</h3>

<p>Ebrahimpoor, Mitra, Pietro Spitali, Jelle J. Goeman, and Roula Tsonaka. "Pathway testing for longitudinal metabolomics." Statistics in Medicine (2021).
</p>


<h3>See Also</h3>

<p><code>multslapmeg</code>, <code>pairslapmeg</code>, <code>plotslapmeg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simulate data with 8 omics
testdata&lt;-simslapmeg(nY=8, ntime=5, nsubj = 30, seed=123)
head(testdata)

#fit slapmeg to test for the differential expression of a pathway of size 5
fit&lt;- slapmeg(Y1+Y2+Y6+Y7+Y8~time, ~1, grouping="group", subject="ID", data=testdata)
fit
summary(fit)

</code></pre>


</div>