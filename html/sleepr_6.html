<div class="container">

<table style="width: 100%;"><tr>
<td>sleep_annotation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score sleep behaviour from immobility</h2>

<h3>Description</h3>

<p>This function first uses a motion classifier to decide whether an animal is moving during a given time window.
Then, it defines sleep as contiguous immobility for a minimum duration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sleep_annotation(data, time_window_length = 10,
  min_time_immobile = 300, motion_detector_FUN = max_velocity_detector,
  ...)

sleep_dam_annotation(data, min_time_immobile = 300)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.table containing behavioural variable from or one multiple animals.
When it has a key, unique values, are assumed to represent unique individuals (e.g. in a behavr table).
Otherwise, it analysis the data as coming from a single animal. <code>data</code> must have a column <code>t</code> representing time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_window_length</code></td>
<td>
<p>number of seconds to be used by the motion classifier.
This corresponds to the sampling period of the output data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_time_immobile</code></td>
<td>
<p>Minimal duration (in s) of a sleep bout.
Immobility bouts longer or equal to this value are considered as sleep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>motion_detector_FUN</code></td>
<td>
<p>function used to classify movement</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments to be passed to <code>motion_classifier_FUN</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default <code>time_window_length</code> is 300 seconds – it is also known as the "5-minute rule".
<code>sleep_annotation</code> is typically used for ethoscope data, whilst <code>sleep_dam_annotation</code> only works on DAM2 data.
These functions are <em>rarely used directly</em>, but rather passed as an argument to a data loading function,
so that analysis can be performed on the go.
</p>


<h3>Value</h3>

<p>a behavr table similar to <code>data</code> with additional variables/annotations (i.e. <code>moving</code> and <code>asleep</code>).
The resulting data will only have one data point every <code>time_window_length</code> seconds.
</p>


<h3>References</h3>


<ul><li>
<p> The relevant <a href="https://rethomics.github.io/sleepr">rethomic tutorial section</a> – on sleep analysis
</p>
</li></ul>
<h3>See Also</h3>


<ul>
<li> <p>motion_detectors – options for the <code>motion_detector_FUN</code> argument
</p>
</li>
<li> <p>bout_analysis – to further analyse sleep bouts in terms of onset and length
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">dt_one_animal &lt;- toy_ethoscope_data(seed=2)
####### Ethoscope, corrected velocity classification #########
sleep_dt &lt;-  sleep_annotation(dt_one_animal, masking_duration=0)
print(sleep_dt)
# We could make a sleep `barecode'
## Not run: 
library(ggplot2)
ggplot(sleep_dt, aes(t,y="Animal 1",fill=asleep)) +
                                   geom_tile() + scale_x_time()

## End(Not run)
####### Ethoscope, virutal beam cross classification #########
sleep_dt2 &lt;-  sleep_annotation(dt_one_animal,
                             motion_detector_FUN=virtual_beam_cross_detector)
## Not run: 
library(ggplot2)
ggplot(sleep_dt2, aes(t,y="Animal 1",fill=asleep)) +
                                   geom_tile() + scale_x_time()

## End(Not run)
####### DAM data, de facto beam cross classification ######
dt_one_animal &lt;- toy_dam_data(seed=7)
sleep_dt &lt;- sleep_dam_annotation(dt_one_animal)
## Not run: 
library(ggplot2)
ggplot(sleep_dt, aes(t,y="Animal 1",fill=asleep)) +
                                   geom_tile() + scale_x_time()

## End(Not run)
</code></pre>


</div>