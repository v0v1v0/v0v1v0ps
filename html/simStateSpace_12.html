<div class="container">

<table style="width: 100%;"><tr>
<td>SimSSMLinGrowthIVary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Data from the
Linear Growth Curve Model
(Individual-Varying Parameters)</h2>

<h3>Description</h3>

<p>This function simulates data from the
linear growth curve model.
It assumes that the parameters can vary
across individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimSSMLinGrowthIVary(
  n,
  time,
  mu0,
  sigma0_l,
  theta_l,
  type = 0,
  x = NULL,
  gamma = NULL,
  kappa = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Positive integer.
Number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Positive integer.
Number of time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>A list of numeric vectors.
Each element of the list
is a vector of length two.
The first element is the mean of the intercept,
and the second element is the mean of the slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0_l</code></td>
<td>
<p>A list of numeric matrices.
Each element of the list is the
Cholesky factorization (<code>t(chol(sigma0))</code>)
of the covariance matrix
of the intercept and the slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_l</code></td>
<td>
<p>A list numeric values.
Each element of the list
is the square root of the common measurement error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Integer.
State space model type.
See Details in <code>SimSSMLinGrowth()</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>List.
Each element of the list is a matrix of covariates
for each individual <code>i</code> in <code>n</code>.
The number of columns in each matrix
should be equal to <code>time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the latent variables
at current time point
(<code class="reqn">\boldsymbol{\Gamma}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>List of numeric matrices.
Each element of the list
is the matrix linking the covariates to the observed variables
at current time point
(<code class="reqn">\boldsymbol{\kappa}</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameters can vary across individuals
by providing a list of parameter values.
If the length of any of the parameters
(<code>mu0</code>,
<code>sigma0</code>,
<code>mu</code>,
<code>theta_l</code>,
<code>gamma</code>, or
<code>kappa</code>)
is less the <code>n</code>,
the function will cycle through the available values.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>simstatespace</code>
which is a list with the following elements:
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>args</code>: Function arguments.
</p>
</li>
<li> <p><code>data</code>: Generated data which is a list of length <code>n</code>.
Each element of <code>data</code> is a list with the following elements:
</p>

<ul>
<li> <p><code>id</code>: A vector of ID numbers with length <code>l</code>,
where <code>l</code> is the value of the function argument <code>time</code>.
</p>
</li>
<li> <p><code>time</code>: A vector time points of length <code>l</code>.
</p>
</li>
<li> <p><code>y</code>: A <code>l</code> by <code>k</code> matrix of values for the manifest variables.
</p>
</li>
<li> <p><code>eta</code>: A <code>l</code> by <code>p</code> matrix of values for the latent variables.
</p>
</li>
<li> <p><code>x</code>: A <code>l</code> by <code>j</code> matrix of values for the covariates
(when covariates are included).
</p>
</li>
</ul>
</li>
<li> <p><code>fun</code>: Function used.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Chow, S.-M., Ho, M. R., Hamaker, E. L., &amp; Dolan, C. V. (2010).
Equivalence and differences between structural equation modeling
and state-space modeling techniques.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
17(2), 303â€“332.
<a href="https://doi.org/10.1080/10705511003661553">doi:10.1080/10705511003661553</a>
</p>


<h3>See Also</h3>

<p>Other Simulation of State Space Models Data Functions: 
<code>LinSDE2SSM()</code>,
<code>SimBetaN()</code>,
<code>SimPhiN()</code>,
<code>SimSSMFixed()</code>,
<code>SimSSMIVary()</code>,
<code>SimSSMLinGrowth()</code>,
<code>SimSSMLinSDEFixed()</code>,
<code>SimSSMLinSDEIVary()</code>,
<code>SimSSMOUFixed()</code>,
<code>SimSSMOUIVary()</code>,
<code>SimSSMVARFixed()</code>,
<code>SimSSMVARIVary()</code>,
<code>TestPhi()</code>,
<code>TestStability()</code>,
<code>TestStationarity()</code>
</p>
<p>Other Simulation of State Space Models Data Functions: 
<code>LinSDE2SSM()</code>,
<code>SimBetaN()</code>,
<code>SimPhiN()</code>,
<code>SimSSMFixed()</code>,
<code>SimSSMIVary()</code>,
<code>SimSSMLinGrowth()</code>,
<code>SimSSMLinSDEFixed()</code>,
<code>SimSSMLinSDEIVary()</code>,
<code>SimSSMOUFixed()</code>,
<code>SimSSMOUIVary()</code>,
<code>SimSSMVARFixed()</code>,
<code>SimSSMVARIVary()</code>,
<code>TestPhi()</code>,
<code>TestStability()</code>,
<code>TestStationarity()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># prepare parameters
# In this example, the mean vector of the intercept and slope vary.
# Specifically,
# there are two sets of values representing two latent classes.
set.seed(42)
## number of individuals
n &lt;- 10
## time points
time &lt;- 5
## dynamic structure
p &lt;- 2
mu0_1 &lt;- c(0.615, 1.006) # lower starting point, higher growth
mu0_2 &lt;- c(1.000, 0.500) # higher starting point, lower growth
mu0 &lt;- list(mu0_1, mu0_2)
sigma0 &lt;- matrix(
  data = c(
    1.932,
    0.618,
    0.618,
    0.587
  ),
  nrow = p
)
sigma0_l &lt;- list(t(chol(sigma0)))
## measurement model
k &lt;- 1
theta &lt;- 0.50
theta_l &lt;- list(sqrt(theta))
## covariates
j &lt;- 2
x &lt;- lapply(
  X = seq_len(n),
  FUN = function(i) {
    matrix(
      data = stats::rnorm(n = time * j),
      nrow = j,
      ncol = time
    )
  }
)
gamma &lt;- list(
  diag(x = 0.10, nrow = p, ncol = j)
)
kappa &lt;- list(
  diag(x = 0.10, nrow = k, ncol = j)
)

# Type 0
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 0
)

plot(ssm)

# Type 1
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 1,
  x = x,
  gamma = gamma
)

plot(ssm)

# Type 2
ssm &lt;- SimSSMLinGrowthIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  theta_l = theta_l,
  type = 2,
  x = x,
  gamma = gamma,
  kappa = kappa
)

plot(ssm)

</code></pre>


</div>