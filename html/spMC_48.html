<div class="container">

<table style="width: 100%;"><tr>
<td>tpfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One-dimensional Model Parameters Estimation</h2>

<h3>Description</h3>

<p>The function estimates the model parameters of a 1-D continuous lag spatial Markov chain. Transition rates matrix along a user defined direction and proportions of categories are computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tpfit(data, coords, direction, method = "ml",
      tolerance = pi/8, max.it = 9000, mle = "avg", ...)</code></pre>


<h3>Arguments</h3>















<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a <code class="reqn">d</code>-D numerical vector (or versor) which represents the chosen direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character object specifying the method to estimate the transition rates. Possible choises are <code>"ml"</code> (by default) for the mean length method, <code>"ils"</code> for the iterated least squares and <code>"me"</code> for the maximum entropy method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value for the tolerance angle (in radians). It's <code>pi/8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>a numerical value which denotes the maximum number of iterations to perform during the optimization phase. It is <code>9000</code> by default and used only when the method is <code>"me"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>a character value to pass to the function <code>mlen</code>. It is <code>"avg"</code> by default and not use when the method is <code>"ils"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to pass to the functions <code>tpfit_ml</code>, <code>tpfit_ils</code> or <code>tpfit_me</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A 1-D continuous-lag spatial Markov chain is probabilistic model which involves a transition rate matrix <code class="reqn">R</code> computed for the direction <code class="reqn">\phi</code>. It defines the transition probability <code class="reqn">\Pr(Z(s + h) = z_k | Z(s) = z_j)</code> through the entry <code class="reqn">t_{jk}</code> of the following matrix
</p>
<p style="text-align: center;"><code class="reqn">T = \mbox{expm} (h R),</code>
</p>

<p>where <code class="reqn">h</code> is a positive lag value.
</p>
<p>Three methods are available to calculate entries of the transition rate matrix. The mean length method is performed by the use of the function <code>tpfit_ml</code>, the iterated least squares are applied through the function <code>tpfit_ils</code>, while the function <code>tpfit_me</code> implements the maximum entropy method.
</p>


<h3>Value</h3>

<p>An object of the class <code>tpfit</code> is returned. The function <code>print.tpfit</code> is used to print the fitted model. The object is a list with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the transition rates matrix computed for the user defined direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>a vector containing the proportions of each observed category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>a numerical value which denotes the tolerance angle (in radians).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1997) Modelling Spatial Variability with One and Multidimensional Continuous-Lag Markov Chains. <em>Mathematical Geology</em>, <b>29</b>(7), 891-918.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.</p>


<h3>See Also</h3>

<p><code>predict.tpfit</code>, <code>print.tpfit</code>, <code>multi_tpfit</code>, <code>transiogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Estimate the parameters of a 
# one-dimensional MC model
tpfit(ACM$MAT5, ACM[, 1:3], c(0, 0, 1))
</code></pre>


</div>