<div class="container">

<table style="width: 100%;"><tr>
<td>solveTridiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Thomas algorithm for solving tridiagonal matrix systems, with optional presaving of LU decomposition</h2>

<h3>Description</h3>

<p>Implementation of the Thomas algorithm to solve efficiently the tridiagonal matrix system
</p>
<p style="text-align: center;"><code class="reqn">b_1 x_1 + c_1 x_2 + a_1x_n = d_1</code>
</p>

<p style="text-align: center;"><code class="reqn">a_2 x_1 + b_2 x_2 + c_2x_3 = d_2</code>
</p>

<p style="text-align: center;"><code class="reqn">\vdots \vdots \vdots</code>
</p>

<p style="text-align: center;"><code class="reqn">a_{n-1} x_{n-2} + b_{n-1} x_{n-1} + c_{n-1}x_{n} = d_{n-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">c_n x_1 + a_{n} x_{n-1} + b_nx_n = d_n</code>
</p>

<p>with <code class="reqn">a_1=c_n=0</code> (usual tridiagonal matrix). If <code class="reqn">a_1\neq0</code> or <code class="reqn">c_n\neq0</code> (circulant tridiagonal matrix), then the Sherman–Morrison formula is employed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">solveTridiag(a, b, c, d, LU = 0L)

solveTridiagMatConsts(a, b, c, d, LU = 0L)

solvePeriodicTridiag(a, b, c, d, LU = 0L)

forwardSweepTridiag(a, b, c)

forwardSweepPeriodicTridiag(a, b, c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b, c</code></td>
<td>
<p>subdiagonal (below main diagonal), diagonal and superdiagonal (above main diagonal), respectively. They all are vectors of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>vector of constant terms, of length <code>n</code>. For <code>solveTridiagMatConsts</code>, it can be a matrix with <code>n</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LU</code></td>
<td>
<p>flag denoting if the forward sweep encoding the LU decomposition is supplied in vectors <code>b</code> and <code>c</code>. See details and examples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Thomas algorithm is stable if the matrix is diagonally dominant.
</p>
<p>For the periodic case, two non-periodic tridiagonal systems with different constant terms (but same coefficients) are solved using <code>solveTridiagMatConsts</code>. These two solutions are combined by the Sherman–Morrison formula to obtain the solution to the periodic system.
</p>
<p>Note that the output of <code>solveTridiag</code> and <code>solveTridiagMatConsts</code> are independent from the values of <code>a[1]</code> and <code>c[n]</code>, but <code>solvePeriodicTridiag</code> is not.
</p>
<p>If <code>LU</code> is <code>TRUE</code>, then <code>b</code> and <code>c</code> must be precomputed with <code>forwardSweepTridiag</code> or<br><code>forwardSweepPeriodicTridiag</code> for its use in the call of the appropriate solver, which will be slightly faster.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>solve*</code> functions: the solution, a vector of length <code>n</code> and a matrix with <code>n</code> rows for<br><code>solveTridiagMatConsts</code>.
</p>
</li>
<li> <p><code>forward*</code> functions: the matrix <code>cbind(b, c)</code> creating the suitable <code>b</code> and <code>c</code> arguments for calling <code>solve*</code> when <code>LU</code> is <code>TRUE</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Thomas, J. W. (1995). <em>Numerical Partial Differential Equations: Finite Difference Methods</em>. Springer, New York. <a href="https://doi.org/10.1007/978-1-4899-7278-1">doi:10.1007/978-1-4899-7278-1</a>
</p>
<p>Conte, S. D. and de Boor, C. (1980). <em>Elementary Numerical Analysis: An Algorithmic Approach</em>. Third edition. McGraw-Hill, New York. <a href="https://doi.org/10.1137/1.9781611975208">doi:10.1137/1.9781611975208</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Tridiagonal matrix
n &lt;- 10
a &lt;- rnorm(n, 3, 1)
b &lt;- rnorm(n, 10, 1)
c &lt;- rnorm(n, 0, 1)
d &lt;- rnorm(n, 0, 1)
A &lt;- matrix(0, nrow = n, ncol = n)
diag(A) &lt;- b
for (i in 1:(n - 1)) {
  A[i + 1, i] &lt;- a[i + 1]
  A[i, i + 1] &lt;- c[i]
}
A

# Same solutions
drop(solveTridiag(a = a, b = b, c = c, d = d))
solve(a = A, b = d)

# Presaving the forward sweep (encodes the LU factorization)
LU &lt;- forwardSweepTridiag(a = a, b = b, c = c)
drop(solveTridiag(a = a, b = LU[, 1], c = LU[, 2], d = d, LU = 1))

# With equal coefficient matrix
solveTridiagMatConsts(a = a, b = b, c = c, d = cbind(d, d + 1))
cbind(solve(a = A, b = d), solve(a = A, b = d + 1))
LU &lt;- forwardSweepTridiag(a = a, b = b, c = c)
solveTridiagMatConsts(a = a, b = LU[, 1], c = LU[, 2], d = cbind(d, d + 1), LU = 1)

# Periodic matrix
A[1, n] &lt;- a[1]
A[n, 1] &lt;- c[n]
A

# Same solutions
drop(solvePeriodicTridiag(a = a, b = b, c = c, d = d))
solve(a = A, b = d)

# Presaving the forward sweep (encodes the LU factorization)
LU &lt;- forwardSweepPeriodicTridiag(a = a, b = b, c = c)
drop(solvePeriodicTridiag(a = a, b = LU[, 1], c = LU[, 2], d = d, LU = 1))
</code></pre>


</div>