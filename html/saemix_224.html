<div class="container">

<table style="width: 100%;"><tr>
<td>SaemixModel-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "SaemixModel"</h2>

<h3>Description</h3>

<p>An object of the SaemixModel class, representing a nonlinear mixed-effect
model structure, used by the SAEM algorithm.
</p>


<h3>Objects from the Class</h3>

<p>An object of the SaemixModel class can be created by using the function <code>saemixModel</code> and contain the following slots:
</p>

<dl>
<dt>
<code>model</code>:</dt>
<dd>
<p>Object of class <code>"function"</code>: name of the function used to get predictions from the model (see the User Guide and the online examples for the format and what this function should return).</p>
</dd>
<dt>
<code>description</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>: an optional text description of the model</p>
</dd>
<dt>
<code>psi0</code>:</dt>
<dd>
<p>Object of class <code>"matrix"</code>: a matrix with named columns containing the initial estimates for the parameters in the model (first line) and for the covariate effects (second and subsequent lines, optional). The number of columns should be equal to the number of parameters in the model.</p>
</dd>
<dt>
<code>simulate.function</code>:</dt>
<dd>
<p>Object of class <code>"function"</code>: for non-Gaussian data models, name of the function used to simulate from the model.</p>
</dd>
<dt>
<code>transform.par</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>: vector giving the distribution for each model parameter (0: normal, 1: log-normal, 2: logit, 3: probit). Its length should be equal to the number of parameters in the model.</p>
</dd>
<dt>
<code>fixed.estim</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>: for each parameter, 0 if the parameter is fixed and 1 if it should be estimated. Defaults to a vector of 1 (all parameters are estimated). Its length should be equal to the number of parameters in the model.</p>
</dd>
<dt>
<code>error.model</code>:</dt>
<dd>
<p>Object of class <code>"character"</code>: name of the error model. Valid choices are "constant" (default), "proportional" and "combined" (see equations in User Guide, except for combined which was changed to y = f + sqrt(a^2+b^2*f^2)*e )</p>
</dd>
<dt>
<code>covariate.model</code>:</dt>
<dd>
<p>Object of class <code>"matrix"</code>: a matrix of 0's and 1's, with a 1 indicating that a parameter-covariate relationship is included in the model (and an associated fixed effect will be estimated). The nmuber of columns should be equal to the number of parameters in the model and the number of rows to the number of covariates.</p>
</dd>
<dt>
<code>covariance.model</code>:</dt>
<dd>
<p>Object of class <code>"matrix"</code>: a matrix f 0's and 1's giving the structure of the variance-covariance matrix. Defaults to the Identity matrix (diagonal IIV, no correlations between parameters)</p>
</dd>
<dt>
<code>omega.init</code>:</dt>
<dd>
<p>Object of class <code>"matrix"</code>: a matrix giving the initial estimate for the variance-covariance matrix</p>
</dd>
<dt>
<code>error.init</code>:</dt>
<dd>
<p>Object of class <code>"numeric"</code>: a vector giving the initial estimate for the parameters of the residual error</p>
</dd>
</dl>
<p>Additional elements are added to the model object after a call to <code>saemix</code> and are used in the algorithm.
</p>


<h3>Methods</h3>


<dl>
<dt>[&lt;-</dt>
<dd>
<p><code>signature(x = "SaemixModel")</code>: replace elements of object</p>
</dd>
<dt>[</dt>
<dd>
<p><code>signature(x = "SaemixModel")</code>: access elements of object</p>
</dd>
<dt>initialize</dt>
<dd>
<p><code>signature(.Object = "SaemixModel")</code>: internal function to initialise object, not to be used</p>
</dd>
<dt>plot</dt>
<dd>
<p><code>signature(x = "SaemixModel")</code>: plot predictions from the model</p>
</dd>
<dt>print</dt>
<dd>
<p><code>signature(x = "SaemixModel")</code>: prints details about the object (more extensive than show)</p>
</dd>
<dt>showall</dt>
<dd>
<p><code>signature(object = "SaemixModel")</code>: shows all the elements in the object</p>
</dd>
<dt>show</dt>
<dd>
<p><code>signature(object = "SaemixModel")</code>: prints details about the object</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>
</p>
<p>Audrey Lavenu
</p>
<p>Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixData</code> <code>SaemixObject</code> <code>saemixControl</code> <code>saemix</code>
<code>plot.saemix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
showClass("SaemixModel")

# Model function for continuous data 
## structural model: a one-compartment model with oral absorption
model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

# Corresponding SaemixModel, assuming starting parameters ka=1, V=20, CL=0.5
# and log-normal distributions for the parameters
model1 &lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1,20,0.5),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1))

# Model function for discrete data
## logistic regression for the probability of the observed outcome
binary.model&lt;-function(psi,id,xidep) {
  tim&lt;-xidep[,1]
  y&lt;-xidep[,2]
  inter&lt;-psi[id,1]
  slope&lt;-psi[id,2]
  logit&lt;-inter+slope*tim
  pevent&lt;-exp(logit)/(1+exp(logit))
  pobs = (y==0)*(1-pevent)+(y==1)*pevent
  logpdf &lt;- log(pobs)
  return(logpdf)
}

## Corresponding SaemixModel, assuming starting parameters inter=-5, slope=-1
# and normal distributions for both parameters
# note that the modeltype argument is set to likelihood
saemix.model&lt;-saemixModel(model=binary.model,description="Binary model",
     modeltype="likelihood",
     psi0=matrix(c(-5,-.1,0,0),ncol=2,byrow=TRUE,dimnames=list(NULL,c("inter","slope"))),
     transform.par=c(0,0))
     
## saemix cannot infer the distribution of the outcome directly from the model
## Here we therefore define a simulation function, needed for diagnostics
### Note the similarity and differences with the model function
simulBinary&lt;-function(psi,id,xidep) {
    tim&lt;-xidep[,1]
    y&lt;-xidep[,2]
    inter&lt;-psi[id,1]
    slope&lt;-psi[id,2]
    logit&lt;-inter+slope*tim
    pevent&lt;-1/(1+exp(-logit))
    ysim&lt;-rbinom(length(tim),size=1, prob=pevent)
    return(ysim)
    }

saemix.model&lt;-saemixModel(model=binary.model,description="Binary model",
     modeltype="likelihood", simulate.function=simulBinary,
     psi0=matrix(c(-5,-.1,0,0),ncol=2,byrow=TRUE,dimnames=list(NULL,c("inter","slope"))),
     transform.par=c(0,0))
</code></pre>


</div>