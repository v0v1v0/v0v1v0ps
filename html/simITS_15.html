<div class="container">

<table style="width: 100%;"><tr>
<td>make_model_smoother</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a smoother that fits a model and then smooths residuals</h2>

<h3>Description</h3>

<p>This helper function gives back a function that takes the resulting
simulation data from a single iteration of the simulation, and fits
'fit_model' to it, smoothes the residuals, and puts the predictions from
'fit_model' back.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_model_smoother(fit_model, covariates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit_model</code></td>
<td>
<p>A function that takes data, fits a linear model, and returns
the fit model. This function needs an option to include (or not) lagged
covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A dataframe with all covariates needed in the model fitting
defined by fit_model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This can be used to build smoothers that smooth using models other than the
model being used for extrapolation (e.g., a model without temperature).
</p>
<p>Resulting functions have the following parameters: 'res' (the data), 't0'
(start time), 'outcomename', 'post.only' flag (for smoothing only post data
or not), and 'smooth_k', a tuning parameter for degree of smoothing.
</p>


<h3>Value</h3>

<p>A smoother function that can be passed to the smoothing routines.
This function is of the form listed above.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( "newjersey")
modA = make_fit_season_model( ~ temperature )
modB = make_fit_season_model( ~ sin.m + cos.m )
newjersey = add_lagged_covariates( newjersey, "n.warrant", 
                                   covariates = c("sin.m", "cos.m", "temperature") )
smoother = make_model_smoother( fit_model = modA, covariates = newjersey )
class(smoother)

# Pass made function to process_outcome_model()
envelope = process_outcome_model( "n.warrant", newjersey, t0=-8, R = 1,
                                  summarize = TRUE, smooth=TRUE, 
                                  smoother = smoother, smooth_k = 11,
                                  fit.model = modB )

</code></pre>


</div>