<div class="container">

<table style="width: 100%;"><tr>
<td>stprod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standardize a symmetric matrix (distances) to fixed row (column) products</h2>

<h3>Description</h3>

<p>Standardizes a distance matrix to fixed rows and columns
products. The function iteratively constrains a logarithmic transformed
matrix to know products, and in order to keep the symmetry of the matrix,
at each iteration performs an average with its transpose. When the known
products are all equal to a constant (e.g. 0), this method provides a
simple and accurate way to scale a distance matrix to a doubly stochastic
matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stprod(mat, con, differ = 1e-15, niter = 1000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A distance matrix size NxN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p>A vector of row (column) constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>differ</code></td>
<td>
<p>A scalar with the maximum accepted difference with the constraint (default = 1e-15).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>An integer with the maximum number of iterations (default = 1000).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standardized matrix will not be affected by problems arising from units
with different inclusion probabilities caused by undesired features of the
spatial distribution of the population, as edge effects and/or isolated
points.
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>

<ul>
<li> <p><code>mat</code>, the standardized distance matrix of size NxN.
</p>
</li>
<li> <p><code>iterations</code>, number of iterations run by the algorithm.
</p>
</li>
<li> <p><code>conv</code>, convergence reached by the algorithm.
</p>
</li>
</ul>
<h3>References</h3>

<p>Benedetti R, Piersimoni F (2017). A spatially balanced design with
probability function proportional to the within sample distance.
<em>Biometrical Journal</em>, <strong>59</strong>(5), 1067-1084.
<a href="https://doi.org/10.1002/bimj.201600194">doi:10.1002/bimj.201600194</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

dis &lt;- as.matrix(dist(cbind(simul1$x, simul1$y))) # distance matrix
con &lt;- rep(0, nrow(dis)) # vector of constraints
stand_dist &lt;- stprod(mat = dis, con = con) # standardized matrix

</code></pre>


</div>