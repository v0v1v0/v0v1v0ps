<div class="container">

<table style="width: 100%;"><tr>
<td>SCTransform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform sctransform-based normalization</h2>

<h3>Description</h3>

<p>This function calls sctransform::vst. The sctransform package is available at
https://github.com/satijalab/sctransform.
Use this function as an alternative to the NormalizeData,
FindVariableFeatures, ScaleData workflow. Results are saved in a new assay
(named SCT by default) with counts being (corrected) counts, data being log1p(counts),
scale.data being pearson residuals; sctransform::vst intermediate results are saved
in misc slot of new assay.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SCTransform(object, ...)

## Default S3 method:
SCTransform(
  object,
  cell.attr,
  reference.SCT.model = NULL,
  do.correct.umi = TRUE,
  ncells = 5000,
  residual.features = NULL,
  variable.features.n = 3000,
  variable.features.rv.th = 1.3,
  vars.to.regress = NULL,
  latent.data = NULL,
  do.scale = FALSE,
  do.center = TRUE,
  clip.range = c(-sqrt(x = ncol(x = umi)/30), sqrt(x = ncol(x = umi)/30)),
  vst.flavor = "v2",
  conserve.memory = FALSE,
  return.only.var.genes = TRUE,
  seed.use = 1448145,
  verbose = TRUE,
  ...
)

## S3 method for class 'Assay'
SCTransform(
  object,
  cell.attr,
  reference.SCT.model = NULL,
  do.correct.umi = TRUE,
  ncells = 5000,
  residual.features = NULL,
  variable.features.n = 3000,
  variable.features.rv.th = 1.3,
  vars.to.regress = NULL,
  latent.data = NULL,
  do.scale = FALSE,
  do.center = TRUE,
  clip.range = c(-sqrt(x = ncol(x = object)/30), sqrt(x = ncol(x = object)/30)),
  vst.flavor = "v2",
  conserve.memory = FALSE,
  return.only.var.genes = TRUE,
  seed.use = 1448145,
  verbose = TRUE,
  ...
)

## S3 method for class 'Seurat'
SCTransform(
  object,
  assay = "RNA",
  new.assay.name = "SCT",
  reference.SCT.model = NULL,
  do.correct.umi = TRUE,
  ncells = 5000,
  residual.features = NULL,
  variable.features.n = 3000,
  variable.features.rv.th = 1.3,
  vars.to.regress = NULL,
  do.scale = FALSE,
  do.center = TRUE,
  clip.range = c(-sqrt(x = ncol(x = object[[assay]])/30), sqrt(x = ncol(x =
    object[[assay]])/30)),
  vst.flavor = "v2",
  conserve.memory = FALSE,
  return.only.var.genes = TRUE,
  seed.use = 1448145,
  verbose = TRUE,
  ...
)

## S3 method for class 'IterableMatrix'
SCTransform(
  object,
  cell.attr,
  reference.SCT.model = NULL,
  do.correct.umi = TRUE,
  ncells = 5000,
  residual.features = NULL,
  variable.features.n = 3000,
  variable.features.rv.th = 1.3,
  vars.to.regress = NULL,
  latent.data = NULL,
  do.scale = FALSE,
  do.center = TRUE,
  clip.range = c(-sqrt(x = ncol(x = object)/30), sqrt(x = ncol(x = object)/30)),
  vst.flavor = "v2",
  conserve.memory = FALSE,
  return.only.var.genes = TRUE,
  seed.use = 1448145,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>UMI counts matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to <code>sctransform::vst</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.attr</code></td>
<td>
<p>A metadata with cell attributes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.SCT.model</code></td>
<td>
<p>If not NULL, compute residuals for the object
using the provided SCT model; supports only log_umi as the latent variable.
If residual.features are not specified, compute for the top variable.features.n
specified in the model which are also present in the object. If
residual.features are specified, the variable features of the resulting SCT
assay are set to the top variable.features.n in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.correct.umi</code></td>
<td>
<p>Place corrected UMI matrix in assay counts slot; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncells</code></td>
<td>
<p>Number of subsampling cells used to build NB regression; default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.features</code></td>
<td>
<p>Genes to calculate residual features for; default is NULL (all genes).
If specified, will be set to VariableFeatures of the returned object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable.features.n</code></td>
<td>
<p>Use this many features as variable features after
ranking by residual variance; default is 3000. Only applied if residual.features is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable.features.rv.th</code></td>
<td>
<p>Instead of setting a fixed number of variable features,
use this residual variance cutoff; this is only used when <code>variable.features.n</code>
is set to NULL; default is 1.3. Only applied if residual.features is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars.to.regress</code></td>
<td>
<p>Variables to regress out in a second non-regularized linear</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent.data</code></td>
<td>
<p>Extra data to regress out, should be cells x latent data
regression. For example, percent.mito. Default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.scale</code></td>
<td>
<p>Whether to scale residuals to have unit variance; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.center</code></td>
<td>
<p>Whether to center residuals to have mean zero; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clip.range</code></td>
<td>
<p>Range to clip the residuals to; default is <code>c(-sqrt(n/30), sqrt(n/30))</code>,
where n is the number of cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vst.flavor</code></td>
<td>
<p>When set to 'v2' sets method = glmGamPoi_offset, n_cells=2000,
and exclude_poisson = TRUE which causes the model to learn theta and intercept
only besides excluding poisson genes from learning and regularization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conserve.memory</code></td>
<td>
<p>If set to TRUE the residual matrix for all genes is never
created in full; useful for large data sets, but will take longer to run;
this will also set return.only.var.genes to TRUE; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.only.var.genes</code></td>
<td>
<p>If set to TRUE the scale.data matrices in output assay are
subset to contain only the variable genes; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.use</code></td>
<td>
<p>Set a random seed. By default, sets the seed to 1448145. Setting
NULL will not set a seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to print messages and progress bars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of assay to pull the count data from; default is 'RNA'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.assay.name</code></td>
<td>
<p>Name for the new assay containing the normalized data; default is 'SCT'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a Seurat object with a new assay (named SCT by default) with
counts being (corrected) counts, data being log1p(counts), scale.data being
pearson residuals; sctransform::vst intermediate results are saved in misc
slot of the new assay.
</p>


<h3>See Also</h3>

<p><code>correct_counts</code> <code>get_residuals</code>
</p>


</div>