<div class="container">

<table style="width: 100%;"><tr>
<td>sobolroalhs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sobol' Indices Estimation Using Replicated OA-based LHS</h2>

<h3>Description</h3>

<p><code>sobolroalhs</code> implements the estimation of the Sobol' sensitivity indices introduced by Tissot &amp; Prieur (2015) using two replicated designs (Latin hypercubes or orthogonal arrays). This function estimates either all first-order indices or all closed second-order indices at a total cost of <code class="reqn">2 \times N</code> model evaluations. For closed second-order indices <code class="reqn">N=q^{2}</code> where <code class="reqn">q \geq d-1</code> is a prime number corresponding to the number of levels of the orthogonal array, and where <code class="reqn">d</code> indicates the number of factors.</p>


<h3>Usage</h3>

<pre><code class="language-R">sobolroalhs(model = NULL, factors, N, p=1, order, tail=TRUE, conf=0.95, nboot=0, ...)
## S3 method for class 'sobolroalhs'
tell(x, y = NULL, ...)
## S3 method for class 'sobolroalhs'
print(x, ...)
## S3 method for class 'sobolroalhs'
plot(x, ylim = c(0,1), ...)
## S3 method for class 'sobolroalhs'
ggplot(data, mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>an integer giving the number of factors, or a vector of character strings giving their names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an integer giving the size of each replicated design (for a total of <code class="reqn">2 \times N</code> model evaluations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>an integer giving the number of model outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>an integer giving the order of the indices (1 or 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>a boolean specifying the method used to choose the number of levels of the orthogonal array (see "Warning messages").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"sobolroalhs"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"sobolroalhs"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sobolroalhs</code> automatically assigns a uniform distribution on [0,1] to each input. Transformations of distributions (between U[0,1] and the wanted distribution) have to be realized before the call to tell() (see "Examples").
</p>
<p>Missing values (i.e <code>NA</code> values) in outputs are automatically handled by the function.
</p>
<p>This function also supports multidimensional outputs (matrices in <code>y</code> or as output of <code>model</code>). In this case, aggregated Sobol' indices are returned (<code>see sobolMultOut</code>).
</p>


<h3>Value</h3>

<p><code>sobolroalhs</code> returns a list of class <code>"sobolroalhs"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments (row concatenation of the two replicated designs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the responses used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OA</code></td>
<td>
<p>the orthogonal array constructed (<code>NULL</code> if <code>order</code>=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of Variances of the Conditional Expectations (VCE) with respect to each factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' indices.</p>
</td>
</tr>
</table>
<h3>Warning messages</h3>


<dl>
<dt>"The value entered for <code>N</code> is not the square of a prime number. It has been replaced by: "</dt>
<dd>
<p>when <code>order</code><code class="reqn">=2</code>, the number of levels of the orthogonal array must be a prime number. If <code>N</code> is not a square of a prime number, then this warning message indicates that it was replaced depending on the value of <code>tail</code>. If <code>tail=TRUE</code> (resp. <code>tail=FALSE</code>) the new value of <code>N</code> is equal to the square of the prime number preceding (resp. following) the square root of <code>N</code>.</p>
</dd>
<dt>"The value entered for <code>N</code> is not satisfying the constraint <code class="reqn">N \geq (d-1)^2</code>. It has been replaced by: "</dt>
<dd>
<p>when <code>order</code><code class="reqn">=2</code>, the following constraint must be satisfied <code class="reqn">N \geq (d-1)^{2}</code> where <code class="reqn">d</code> is the number of factors. This warning message indicates that <code>N</code> was replaced by the square of the prime number following (or equals to) <code class="reqn">d-1</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Laurent Gilquin
</p>


<h3>References</h3>

<p>A.S. Hedayat, N.J.A. Sloane and J. Stufken, 1999, <em>Orthogonal Arrays: Theory and Applications</em>, Springer Series in Statistics.
</p>
<p>F. Gamboa, A. Janon, T. Klein and A. Lagnoux, 2014, <em>Sensitivity indices for multivariate outputs</em>, Electronic Journal of Statistics, 8:575-603.
</p>
<p>J.Y. Tissot and C. Prieur, 2015, <em>A randomized orthogonal orray-based procedure for the estimation of first- and second-order Sobol' indices</em>, J. Statist. Comput. Simulation, 85:1358-1381.
</p>


<h3>See Also</h3>

<p><code>sobolmara</code>,
<code>sobolroauc</code>,
<code>sobolMultOut</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(boot)
library(numbers)

####################
# Test case: the non-monotonic Sobol g-function

# The method of sobol requires 2 samples
# (there are 8 factors, all following the uniform distribution on [0,1])

# first-order sensitivity indices
x &lt;- sobolroalhs(model = sobol.fun, factors = 8, N = 1000, order = 1, nboot=100)
print(x)
plot(x)

library(ggplot2)
ggplot(x)

# closed second-order sensitivity indices
x &lt;- sobolroalhs(model = sobol.fun, factors = 8, N = 1000, order = 2, nboot=100)
print(x)
ggplot(x)

####################
# Test case: dealing with non-uniform distributions

x &lt;- sobolroalhs(model = NULL, factors = 3, N = 1000, order =1, nboot=0)

# X1 follows a log-normal distribution:
x$X[,1] &lt;- qlnorm(x$X[,1])

# X2 follows a standard normal distribution:
x$X[,2] &lt;- qnorm(x$X[,2])

# X3 follows a gamma distribution:
x$X[,3] &lt;- qgamma(x$X[,3],shape=0.5)

# toy example
toy &lt;- function(x){rowSums(x)}
y &lt;- toy(x$X)
tell(x, y)
print(x)
ggplot(x)

####################
# Test case : multidimensional outputs


toy &lt;- function(x){cbind(x[,1]+x[,2]+x[,1]*x[,2],2*x[,1]+3*x[,1]*x[,2]+x[,2])}
x &lt;- sobolroalhs(model = toy, factors = 3, N = 1000, p=2, order =1, nboot=100)
print(x)
ggplot(x)


</code></pre>


</div>