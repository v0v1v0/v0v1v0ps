<div class="container">

<table style="width: 100%;"><tr>
<td>DR_sharpen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Shape-Constrained Local Linear Regression via Douglas-Rachford 
</h2>

<h3>Description</h3>

<p>Local linear regression is applied to bivariate
data.  The response is ‘sharpened’ or perturbed in a way to render a
curve estimate that satisfies some specified shape constraints. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">DR_sharpen(
x, y, xgrid=NULL, M=200,  h=NULL, mode=NULL, 
    ratio_1=0.14,ratio_2=0.14,ratio_3=0.14,ratio_4=0.14,
    constraint_1=NULL, constraint_2=NULL, constraint_3=NULL,
    constraint_4=NULL, norm="l2", augmentation=FALSE, maxit = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of explanatory variable observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>binary vector of responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>gridpoints on x-axis where estimates are taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of equally-spaced gridpoints (if xgrid not specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>the location of the peak on the x-axis, valid in the unimode case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_1</code></td>
<td>
<p>control the first derivative shape constraint gap aroud the peak, 
valid in the unimode case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_2</code></td>
<td>
<p>control the second derivative shape constraint gap aroud the peak, 
valid in the unimode case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_3</code></td>
<td>
<p>control the third derivative shape constraint gap aroud the peak, 
valid in the unimode case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_4</code></td>
<td>
<p>control the fourth derivative shape constraint gap aroud the peak,
valid in the unimode case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint_1</code></td>
<td>
<p>a vector of the first derivative shape constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint_2</code></td>
<td>
<p>a vector of the second derivative shape constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint_3</code></td>
<td>
<p>a vector of the third derivative shape constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint_4</code></td>
<td>
<p>a vector of the fourth derivative shape constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>the smallest possible distance type: "l2", "l1" or "linf". Default is "l2"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>augmentation</code></td>
<td>
<p>data augmentation: "TRUE" or "FALSE", default is "FALSE"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum iterarion number, default is 10^5</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are perturbed the smallest possible L2 or L1 or Linf distance subject to the 
constraint that the local linear estimate satisfies some specified 
shape constraints.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ysharp</code></td>
<td>
<p>sharpened responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>number of iterations the function has been 
spend for the convergence</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>D.Wang and W.J.Braun
</p>


<h3>References</h3>

<p>Wang, D. (2022). Penalized and constrained data sharpening methods for kernel regression (Doctoral dissertation, University of British Columbia).
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234567)
gam&lt;-4
g &lt;- function(x) (3*sin(x*(gam*pi))+5*cos(x*(gam*pi))+6*x)*x
n&lt;-100
M&lt;-200
noise &lt;- 1
x&lt;-sort(runif(n,0,1))
y&lt;-g(x)+rnorm(n,sd=noise)
z&lt;- seq(min(x)+1/M, max(x)-1/M, length=M) ############xgrid points
h1&lt;-dpill(x,y)
A&lt;-lprOperator(h=h1,x=x,z=z,p=1)
local_fit&lt;-t(A)
ss_1&lt;-c(sign(numericalDerivative(z,g,k=1)))
DR_sharpen(x=x, y=y, xgrid=z, h=h1, constraint_1=ss_1, norm="linf",maxit =10^3)
</code></pre>


</div>