<div class="container">

<table style="width: 100%;"><tr>
<td>get_theta_ig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Scale Parameter for Inverse Gamma Hyperprior</h2>

<h3>Description</h3>

<p>This function implements a optimisation routine that computes the scale parameter <code>b</code>
of the inverse gamma prior for <code class="reqn">\tau^2</code> when <code class="reqn">a=b=\epsilon</code> with <code class="reqn">\epsilon</code> small
for a given design matrix and prior precision matrix
such that approximately <code class="reqn">P(|f(x_{k}|\le c,k=1,\ldots,p)\ge 1-\alpha</code>
When <code>a</code> unequal to <code>a</code> the shape parameter <code>a</code> has to be specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_theta_ig(alpha = 0.01, method = "integrate", Z, c = 3,
  eps = .Machine$double.eps, Kinv, equals = FALSE, a = 1,
  type = "marginalt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>denotes the 1-<code class="reqn">\alpha</code> level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>with <code>integrate</code> as default.
Currently no further method implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>denotes the expected range of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>denotes the error tolerance of the result, default is <code>.Machine$double.eps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p>the generalised inverse of K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equals</code></td>
<td>
<p>saying whether <code>a</code>=<code>b</code>. The default is FALSE due to the fact that a is a shape parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>is the shape parameter of the inverse gamma distribution, default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>is either numerical integration (<code>integrate</code>) of to obtain the marginal distribution of <code class="reqn">z_p'\beta</code>
or the theoretical marginal t-distribution (<code>marginalt</code>). <code>marginalt</code> is the default value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently, the implementation only works properly for the cases <code>a</code> unequal <code>b</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>list</code> with values from <code>uniroot</code>.
</p>


<h3>Author(s)</h3>

<p>Nadja Klein
</p>


<h3>References</h3>

<p>Nadja Klein and Thomas Kneib (2015). Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression. 
<em>Working Paper</em>.
</p>
<p>Stefan Lang and Andreas Brezger (2004). Bayesian P-Splines. 
<em>Journal of Computational and Graphical Statistics</em>, <b>13</b>, 183-212.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
library(MASS)
# prior precision matrix (second order differences) 
# of a spline of degree l=3 and with m=20 inner knots
# yielding dim(K)=m+l-1=22
K &lt;- t(diff(diag(22), differences=2))%*%diff(diag(22), differences=2)
# generalised inverse of K
Kinv &lt;- ginv(K)
# covariate x
x &lt;- runif(1)
Z &lt;- matrix(DesignM(x)$Z_B,nrow=1)
theta &lt;- get_theta_ig(alpha = 0.01, method = "integrate", Z = Z, 
                      c = 3, eps = .Machine$double.eps, Kinv = Kinv, 
					 equals = FALSE, a = 1, type="marginalt")$root

</code></pre>


</div>