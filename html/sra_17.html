<div class="container">

<table style="width: 100%;"><tr>
<td>3. Mechanistic models</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Descriptive models of artificial-selection responses: quantitative genetics models </h2>

<h3>Description</h3>

<p>The sra functions for mechanistic model are wrappers for the maximum-likelihood optimization routine <code>mle</code>. They implement classical quantitative genetics models, fit them to artificial-selection time series, and provide estimates of e.g. the effective population size, the mutational variance, the strength of genetic / environmental canalization, the directionality and strength of epistasis, etc., given some assumptions about the properties of the genetic architecture. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">sraCstvar(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraDrift(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraMutation(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraCanalization(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraCanalizationOpt(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraSelection(sradata, start=NULL, fixed=NULL, macroE=FALSE, Bulmer=TRUE, ...)
sraDirepistasis(sradata, start=NULL, fixed=NULL, macroE=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sradata</code></td>
<td>
<p> A data object generated by <code>sraData</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p> A named list of starting values for the convergence algorithm. <code>NA</code> is allowed and lets the function <code>sraStartingvalues</code> calculating a (hopefully) educated guess on the starting values. Parameters are described below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p> A named list of the parameters that have to be kept constant. <code>NA</code> is not allowed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>macroE</code></td>
<td>
<p> Whether or not macro-environmental effects (random deviation of the phenotypic mean each generation) should be included. This might have some side effects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bulmer</code></td>
<td>
<p> Whether or not the impact of linkage disequilibrium (Bulmer effect) due to selection on variance should be accounted for. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional parameters to be passed to <code>mle</code>, and thus to <code>optim</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All functions (except <code>sraDirepistasis</code>) rely on the same underlying model, and thus simply provide convenient shortcuts for different sets of parameters to fit. 
</p>
<p><code>mu0</code> is the initial phenotype of the population.
</p>
<p><code>logvarA0</code> is the logarithm of the initial additive variance in the population.
</p>
<p><code>logvarE0</code> is the logarithm of the initial environmental variance in the population.
</p>
<p><code>logNe</code> is the logarithm of the effective population size.
</p>
<p><code>logn</code> is the logarithm of the effective number of loci.
</p>
<p><code>logvarM</code> is the logarithm of the mutational variance.
</p>
<p><code>kc</code> and <code>kg</code> are the strength of environmental and genetic canalization, respectively. 
</p>
<p><code>o</code> corresponds to the 'optimum' phenotype. When fixed and set to <code>NA</code>, <code>o</code> is identical to <code>mu0</code>. For convenience, the same optimum is used for environmental canalization, genetic canalization and natural stabilizing selection. 
</p>
<p><code>s</code> corresponds to the strength of natural selection.
</p>
<p><code>logvarepsilon</code> is the logarithm of the variance of the epistatic coefficient (<code class="reqn">\varepsilon</code>). This parameter is fixed by default, since it is unlikely that realistic data sets contain enough information to estimate it properly. 
</p>
<p>The dynamic model that is fitted (except of the directional epistasis, detailed in the next paragraph) is:
</p>
<p style="text-align: center;"><code class="reqn">\mu(t+1) = \mu(t) + VarA(t) * (\beta(t) + s \delta(t)) </code>
</p>

<p style="text-align: center;"><code class="reqn">VarA(t+1) = VarM + VarA(t) * (1 - 1/(2*N_e)) * e^{kg*(|\delta(t+1)| - |\delta(t)|)}</code>
</p>

<p style="text-align: center;"><code class="reqn">VarE(t+1) = VarE(t) * e^{kc*|\delta(t)|}</code>
</p>

<p><code class="reqn">\mu(1)</code>, <code class="reqn">VarA(1)</code> and <code class="reqn">varE(1)</code> are parameters of the model, <code class="reqn">\beta(t)</code> is the selection gradient, calculated for each generation from the data set, and <code class="reqn">\delta(t) = \mu(t) - o</code>. 
</p>
<p>The directional epistasis model has its own setting:
</p>
<p style="text-align: center;"><code class="reqn">\mu(t+1) = \mu(t) + varA(t) * \beta(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">VarA(t+1) = VarA(t) + 2*\beta(t)*\varepsilon*VarA(t)^2</code>
</p>

<p style="text-align: center;"><code class="reqn">VarE(t+1) = VarE(1) + (\varepsilon^2 + Var\varepsilon)*VarA(t)^2</code>
</p>

<p>Where <code>epsilon</code> is a key parameter, representing the directionality of epistasis (Hansen and Wagner 2001, Carter et al. 2005). The properties of the likelihood function when epsilon varies makes numerical convergence tricky, and the function <code>SRAdirepistasis</code> actually performs two model fits: one for positive epsilons (the estimated parameter being <code>logepsilon</code>) and one for negative epsilons (estimating <code>logminusepsilon</code>). The likelihood of both models is then compared, and the best model is returned, providing either <code>logepsilon</code> or <code>logminusepsilon</code>. Although part of the model, the parameter <code>logvarepsilon</code> appeared to affect environmental variance only weakly, and its estimation is problematic in most cases. 
</p>
<p>These models are extensively described in le Rouzic et al 2010. 
</p>


<h3>Value</h3>

<p>The functions return objects of class <code>srafit</code>, a list containing information about the model, the data, and the parameter estimates. Some standard <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> functions can be applied to the object, including <code>AIC</code> (<code>AIC.srafit</code>), <code>logLik</code> (<code>logLik.srafit</code>), <code>vcov</code> (<code>vcov.srafit</code>), <code>coef</code> (<code>coef.srafit</code>) <code>confint</code> (<code>confint.srafit</code>), and <code>plot</code> (<code>plot.srafit</code>).
</p>


<h3>Author(s)</h3>

<p> Arnaud Le Rouzic </p>


<h3>References</h3>

 
<p>Carter, A.J.R., Hermisson, J. and Hansen, T.F. (2005) The role of epistatic genetic interactions in the response to selection and the evolution of evolvability. Theor. Pop. Biol. 68, 179-196. 
</p>
<p>Hansen, T.F. and Wagner, G.P. (2001) Modelling genetic architecture: a multilinear theory of gene interaction. Theor. Pop. biol. 59, 61-86.
</p>
<p>Le Rouzic, A., Houle, D., and Hansen, T.F. (2010) A modelling framework for the analysis of artificial selection-response time series. in prep.
</p>


<h3>See Also</h3>

 <p><code>sraAutoreg</code>, <code>sraAutoregHerit</code> and <code>sraAutoregEvolv</code> for phenomenological models, <code>sraAutoregTsMinuslogL</code> and <code>sraAutoregTimeseries</code> for some details about the internal functions, <code>AIC.srafit</code>, <code>logLik.srafit</code>,<code>vcov.srafit</code>, <code>coef.srafit</code>, <code>confint.srafit</code>, <code>plot.srafit</code> for the analysis of the results. </p>


<h3>Examples</h3>

<pre><code class="language-R">########### Generating a dummy dataset ################

m &lt;- c(12,11,12,14,18,17,19,22,20,19)
v &lt;- c(53,47,97,155,150,102,65,144,179,126)
s &lt;- c(15,14,14,17,21,20,22,25,24,NA)
n &lt;- c(100,80,120,60,100,90,110,80,60,100)

########## Making a sra data set #######################
data &lt;- sraData(phen.mean=m, phen.var=v, phen.sel=s, N=n)

#################### Data Analysis ####################

cstvar &lt;- sraCstvar(data)
drift &lt;- sraDrift(data)
direpi &lt;- sraDirepistasis(data)

# In case of convergence problems, better starting values can be provided:
direpi &lt;- sraDirepistasis(data, start=list(mu0=10, logvarA0=log(20), logvarE0=NA), 
fixed=list(logNe=log(50)))

plot(cstvar)

AIC(direpi)
</code></pre>


</div>