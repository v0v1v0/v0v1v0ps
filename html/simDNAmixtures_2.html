<div class="container">

<table style="width: 100%;"><tr>
<td>gamma_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defines a gamma model for peak height variability</h2>

<h3>Description</h3>

<p>Defines a gamma model for peak height variability
</p>


<h3>Usage</h3>

<pre><code class="language-R">gamma_model(
  mixture_proportions,
  mu,
  cv,
  degradation_beta = rep(1, length(mixture_proportions)),
  LSAE = stats::setNames(rep(1, length(model_settings$locus_names)),
    model_settings$locus_names),
  model_settings
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mixture_proportions</code></td>
<td>
<p>Numeric vector with the mixture proportion for each contributor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Numeric. Expectation of a full heterozygote contributing allele peak height.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Numeric. Coefficient of variation of a full heterozygote contributing allele peak height</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degradation_beta</code></td>
<td>
<p>Numeric Vector of same length as mixture_proportions. Degradation slope parameters for each contributor. Defaults to 1 for each contributor (i.e. not degraded)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LSAE</code></td>
<td>
<p>Numeric vector (named) with Locus Specific Amplification Efficiencies. See sample_LSAE. Defaults to 1 for each locus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_settings</code></td>
<td>
<p>List. Possible parameters: </p>

<ul>
<li>
<p> locus_names. Character vector.
</p>
</li>
<li>
<p> detection_threshold. Numeric vector (named) with Detection Thresholds.
</p>
</li>
<li>
<p> size_regression. Function, see read_size_regression.
</p>
</li>
<li>
<p> stutter_model. Optionally a stutter_model object that gives expected stutter heights. See global_stutter_model.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Define a gamma model for peak height variability with the parametrisation as described by Bleka et al. The model may then be used to sample DNA profiles using the sample_mixture_from_genotypes function. Alternatively, to sample many models and profiles in one go with parameters according to a specified distribution, the sample_mixtures function can be used.
</p>


<h3>Value</h3>

<p>Object of class <code>pg_model</code>.
</p>


<h3>References</h3>

<p>Bleka, Ã˜., Storvik, G., &amp; Gill, P. (2016). EuroForMix: An open source software based on a continuous model to evaluate STR DNA profiles from a mixture of contributors with artefacts. Forensic Science International: Genetics, 21, 35-44. doi: <a href="https://doi.org/10.1016/j.fsigen.2015.11.008">10.1016/j.fsigen.2015.11.008</a>
</p>


<h3>See Also</h3>

<p>log_normal_model.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># read allele frequencies
freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                                       package = "simDNAmixtures"))

data(gf)

# define the gamma model for peak heights
model &lt;- gamma_model(mixture_proportions = 1, mu = 1000.,
                    cv = 0.1, model_settings = gf$gamma_settings_no_stutter)

# sample a single source profile (1-person 'mixture')
u1 &lt;- sample_contributor_genotypes("U1", freqs, loci = gf$autosomal_markers)
sample &lt;- sample_mixture_from_genotypes(u1, model)

# peaks follow a gamma distribution with an expected height of
# 1,000 for heterozygous alleles; 2,000 for homozygotes
hist(sample$Height)

# the gamma distribution is more obvious if many samples are taken
many_samples &lt;- replicate(n = 1e2,
                          sample_mixture_from_genotypes(u1, model),
                          simplify = FALSE)

hist(sapply(many_samples, function(x) x$Height))
</code></pre>


</div>