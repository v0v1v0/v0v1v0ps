<div class="container">

<table style="width: 100%;"><tr>
<td>DensityScatter.DDCAL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scatter density plot [Brinkmann et al., 2023]
</h2>

<h3>Description</h3>

<p>Density estimation (PDE) [Ultsch, 2005] or "SDH" [Eilers/Goeman, 2004] used for a scatter density plot, with clustering of densities with DDCAL [Lux/Rinderle-Ma, 2023] proposed by [Brinkmann et al., 2023].
</p>


<h3>Usage</h3>

<pre><code class="language-R">DensityScatter.DDCAL(X, Y, nClusters = 12, Plotter = "native", 
SDHorPDE = TRUE, PDEsample = 5000,
Marginals = FALSE, na.rm=TRUE,
pch = 10, Size = 1, 
xlab="x", ylab="y", main = "",lwd = 2,
xlim=NULL,ylim=NULL,Polygon,BW = TRUE,Silent = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Numeric vector [1:n], first feature (for x axis values)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Numeric vector [1:n], second feature (for y axis values)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nClusters</code></td>
<td>

<p>Integer defining the number of clusters (colors) used for finding a hard color
transition.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plotter</code></td>
<td>

<p>(Optional) String, name of the plotting backend to use. Possible values are: "<code>native</code>" or "<code>ggplot2</code>"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SDHorPDE</code></td>
<td>

<p>(Optional) Boolean, if TRUE SDH is used to calculate density, if FALSE PDE is used
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PDEsample</code></td>
<td>

<p>(Optional) Scalar, Sample size for PDE and/or for ggplot2 plotting. Default is 5000
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Marginals</code></td>
<td>

<p>(Optional) Boolean, if TRUE the marginal distributions of X and Y will be plotted together with the 2D density of X and Y. Default is FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>(Optional) Boolean, if TRUE non finite values will be removed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>(Optional) Scalar or character. Indicates the shape of data points, see <code>plot()</code> function or the <code>shape</code> argument in ggplot2. Default is 10
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Size</code></td>
<td>

<p>(Optional) Scalar, size of data points in plot, default is 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>String, title of the x axis. Default: "X",   see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>String, title of the y axis. Default: "Y",   see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>(Optional)  Character, title of the plot. [1:2] 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>(Optional) Scalar, thickness of the lines used for the marginal distributions (only needed if <code>Marginals=TRUE</code>), see <code>plot()</code>. Default = 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>(Optional) numerical vector, min and max of x values to be plottet
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>(Optional) numerical vector, min and max of y values to be plottet
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Polygon</code></td>
<td>

<p>(Optional) [1:p,1:2] numeric matrix that defines for x and y coordinates a polygon in magenta
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BW</code></td>
<td>

<p>(Optional) Boolean, if TRUE ggplot2 will use a white background, if FALSE the typical ggplot2 backgournd is used. Not needed if "<code>native</code>" as Plotter is used. Default is TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Silent</code></td>
<td>

<p>(Optional) Boolean, if TRUE no messages will be printed, default is FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further plot arguments
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>DensityScatter.DDCAL</code> function generates the density of the xy data as a z coordinate. Afterwards xyz will be plotted as a contour plot. It assumens that the cases of x and y are mapped to each other meaning that a <code>cbind(x,y)</code> operation is allowed.
The colors for the densities in the contour plot are calculated with DDCAL, which produces clusters to evenly distribute the densities in low variance clusters.
</p>
<p>In the case of "<code>native</code>" as Plotter, the handle returns <code>NULL</code> because the basic R functon <code>plot</code>() is used
</p>


<h3>Value</h3>

<p>If "<code>ggplot2</code>" as Plotter is used, the ggobj is returned
</p>


<h3>Note</h3>

<p>Support for plotly will be implemented later
</p>


<h3>Author(s)</h3>

<p>Luca Brinkmann, Michael Thrun
</p>


<h3>References</h3>

<p>[Ultsch, 2005]  Ultsch, A.: Pareto density estimation: A density estimation for knowledge discovery, In Baier, D. &amp; Werrnecke, K. D. (Eds.), Innovations in classification, data science, and information systems, (Vol. 27, pp. 91-100), Berlin, Germany, Springer, 2005.
</p>
<p>[Eilers/Goeman, 2004]  Eilers, P. H., &amp; Goeman, J. J.: Enhancing scatterplots with smoothed densities, Bioinformatics, Vol. 20(5), pp. 623-628. 2004.
</p>
<p>[Lux/Rinderle-Ma, 2023]  Lux, M. &amp; Rinderle-Ma, S.: DDCAL: Evenly Distributing Data into Low Variance Clusters Based on Iterative Feature Scaling, Journal of Classification vol. 40, pp. 106-144, 2023.
</p>
<p>[Brinkmann et al., 2023]  Brinkmann, L., Stier, Q., &amp; Thrun, M. C.: Computing Sensitive Color Transitions for the Identification of Two-Dimensional Structures, Proc. Data Science, Statistics &amp; Visualisation (DSSV) and the European Conference on Data Analysis (ECDA), p.109, Antwerp, Belgium, July 5-7, 2023. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Create two bimodial distributions
x1=rnorm(n = 7500,mean = 0,sd = 1)
y1=rnorm(n = 7500,mean = 0,sd = 1)
x2=rnorm(n = 7500,mean = 2.5,sd = 1)
y2=rnorm(n = 7500,mean = 2.5,sd = 1)
x=c(x1,x2)
y=c(y1,y2)

DensityScatter.DDCAL(x, y, Marginals = TRUE)

</code></pre>


</div>