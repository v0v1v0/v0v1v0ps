<div class="container">

<table style="width: 100%;"><tr>
<td>getSTB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load/unload C-lib.
Simultaneous Tolerance Bands Using R-Implementation.</h2>

<h3>Description</h3>

<p>Compute simultaneous tolerance bounds (STB) from a matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getSTB(
  mat,
  alpha = 0.05,
  tol = 1e-04,
  max.iter = 100L,
  q.type = 2L,
  logfile = NULL,
  output = TRUE,
  timer = FALSE,
  Ncpu = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>(numeric) matrix with nrow=N_simulation, ncol=N_points, where each row is sorted in increasing order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(numeric) 100(1-alpha)% simultaneous tolerance-level will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(numeric) value controlling the termination of the bisection algorithm, i.e. the condition <code>coverage-(1-alpha)&lt;=tol</code>
has to be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>(integer) maximum number of iterations of the bisection algorithm. If this number is reached the algorithm terminates
and returns the best approximation of lower and upper bounds reached up to this iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.type</code></td>
<td>
<p>(integer) the quantile-type used if <code>algo="R"</code>, see ? quantile for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfile</code></td>
<td>
<p>(character) string specifying the name of the (optional) log-file, storing the iteration history</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>(logical) TRUE a txtProgressBar will be printed as well as additional status information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timer</code></td>
<td>
<p>(logical) TRUE = the time spent for computing the STB will be printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncpu</code></td>
<td>
<p>(integer) specifying the number cores/CPUs to be used in computing the coverage on C-level,
for N&gt;1 multi-processing is applied</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function computes 100(1-alpha)% simultaneous tolerance bounds (intervals, bands) from a matrix, where rows correspond
to order statistics (sorted) of random samples of a, e.g. normal distribution. It starts by computing joint coverage 
of the naive unadjusted (point-wise) alpha-level  intervals, computed as percentiles across each order statistic (columns).
Alpha is decreased using a bisection search until the joint coverage becomes at least 100(1-alpha)% depending on arguments
<code>max.iter</code> and <code>tol</code>. If the number of simulated random samples goes to infinity, the STB becomes exact.
Note that checking whether a numeric vector is normally distributed is equal to checking whether the residuals of the simplest
linear model y = mu + e (y~1) are normally distributed [e ~ N(0, sigma^2)].
</p>


<h3>Value</h3>

<p>(list) with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>(numeric) matrix with two rows, where the 1st row = lower bounds of the STB, 2nd row = upper bounds of the STB</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>(numeric) value indicating the actual coverage of the STB</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andre Schuetzenmeister <a href="mailto:andre.schuetzenmeister@roche.com">andre.schuetzenmeister@roche.com</a>
</p>


<h3>References</h3>

<p>Schuetzenmeister, A., Jensen, U., Piepho, H.P. (2011), Checking assumptions of normality and homoscedasticity in the general linear model. 
Communications in Statistics - Simulation and Computation; S. 141-154
</p>


<h3>See Also</h3>

<p>fastSTB stb
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(333)
mat &lt;- t(apply(matrix(rnorm(10000*30), ncol=30), 1, sort))
stb.obj &lt;- getSTB(mat, timer=TRUE)
stb.obj$cov

## End(Not run)
</code></pre>


</div>