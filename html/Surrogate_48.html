<div class="container">

<table style="width: 100%;"><tr>
<td>ICA.ContCont.MultS_alt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, alternative approach</h2>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS_alt</code> quantifies surrogacy in the single-trial causal-inference framework  where T is continuous and there are multiple continuous S. This function provides an alternative for <code>ICA.ContCont.MultS</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">ICA.ContCont.MultS_alt(M = 500, N, Sigma, 
G = seq(from=-1, to=1, by = .00001),
Seed=c(123), Model = "Delta_T ~ Delta_S1 + Delta_S2", 
Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code>. The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A vector of the values that should be considered for the unidentified correlations. Default <code>G=seq(-1, 1, by=.00001)</code>, i.e., values with range <code class="reqn">-1</code> to <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is essentially the coefficient of determination of a regression model in which <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ... and so on. The <code>Model=</code> argument specifies the regression model to be used in the analysis. For example, for 2 surrogates, <code>Model = "Delta_T ~ Delta_S1 + Delta_S2")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
\sigma_{T_{0}T_{0}}\\
\sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
\sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
\sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
\sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
\sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
\sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
\sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
\end{array}\right)</code>
</p>

<p>The <code>ICA.ContCont.MultS_alt</code> function requires the user to specify a distribution <code class="reqn">G</code> for the unidentified correlations. Next, the identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled from <code class="reqn">G</code>. In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). The algorithm generates a large number of 'completed' matrices, and only those that are positive definite are retained (the number of positive definite matrices that should be obtained is specified by the <code>M=</code> argument in the function call). Based on the identifiable variances, these positive definite correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated.
</p>
<p>An issue with this approach (i.e., substituting unidentified correlations by random and independent samples from <code class="reqn">G</code>) is that the probability of obtaining a positive definite matrix is very low when the dimensionality of the matrix increases. One approach to increase the efficiency of the algorithm is to build-up the correlation matrix in a gradual way. In particular, the property that a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite if and only if all principal minors are positive (i.e., Sylvester's criterion) can be used. In other words, a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite when the determinants of the upper-left <code class="reqn">\left(2 \times 2\right)</code>, <code class="reqn">\left(3 \times 3\right)</code>, ..., <code class="reqn">\left(k \times k\right)</code> submatrices all have a positive determinant. Thus, when a positive definite <code class="reqn">\left(k \times k\right)</code> matrix has to be generated, one can start with the upper-left <code class="reqn">\left(2 \times 2\right)</code> submatrix and randomly sample a value from the unidentified correlation (here: <code class="reqn">\rho_{T_0T_0}</code>) from <code class="reqn">G</code>. When the determinant is positive (which will always be the case for a <code class="reqn">\left(2 \times 2\right)</code> matrix), the same procedure is used for the upper-left <code class="reqn">\left(3 \times 3\right)</code> submatrix, and so on. When a particular draw from <code class="reqn">G</code> for a particular submatrix does not give a positive determinant, new values are sampled for the unidentified correlations until a positive determinant is obtained. In this way, it can be guaranteed that the final <code class="reqn">\left(k \times k\right)</code> submatrix will be positive definite. The latter approach is used in the current function. This procedure is used to generate many positive definite matrices. These positive definite matrices are used to generate <code>M</code> datasets which contain <code class="reqn">\Delta T</code>, <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ..., <code class="reqn">\Delta S_k</code>.
Finally, the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated by regressing <code class="reqn">\Delta T</code> on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ..., <code class="reqn">\Delta S_k</code> and computing the multiple coefficient of determination.</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS_alt</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Res_Err_Delta_T</code></td>
<td>
<p>The residual errors (prediction errors) for intercept-only models of <code class="reqn">\Delta T</code> (i.e., models that do not include <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, etc as predictors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Res_Err_Delta_T_Given_S</code></td>
<td>
<p>The residual errors (prediction errors) for models where <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code>MICA.ContCont</code>, <code>ICA.ContCont</code>, <code>Single.Trial.RE.AA</code>, 
<code>plot Causal-Inference ContCont</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  #time-consuming code parts
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like (NA indicates unidentified covariances):
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS_alt(M=100, N=200, Show.Progress = TRUE,
  Sigma=s, G = seq(from=-1, to=1, by = .00001), Seed=c(123), 
  Model = "Delta_T ~ Delta_S1 + Delta_S2 + Delta_S3")

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>


</div>