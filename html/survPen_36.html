<div class="container">

<table style="width: 100%;"><tr>
<td>smf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defining smooths in survPen formulae</h2>

<h3>Description</h3>

<p>Used inside a formula object to define a smooth, a tensor product smooth or a tensor product interaction. 
Natural cubic regression splines (linear beyond the knots, equivalent to <code>ns</code> from package <code>splines</code>) are used as marginal bases. While <code>tensor</code> builds a tensor product of marginal bases including 
the intercepts, <code>tint</code> applies a tensor product of the marginal bases without their intercepts.
Unlike <code>tensor</code>, the marginal effects of the covariates should also be present in the formula when using <code>tint</code>.
For a conceptual difference between tensor products and tensor product interactions see Section 5.6.3 from Wood (2017)
</p>


<h3>Usage</h3>

<pre><code class="language-R">smf(..., knots = NULL, df = NULL, by = NULL, same.rho = FALSE)

tensor(..., knots = NULL, df = NULL, by = NULL, same.rho = FALSE)

tint(..., knots = NULL, df = NULL, by = NULL, same.rho = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any number of covariates separated by ","</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>numeric vector that specifies the knots of the splines (including boundaries); default is NULL, in which case the knots are spread through the covariate values using quantiles. Precisely, for the term "smf(x,df=df1)", the vector of knots will be: quantile(unique(x),seq(0,1,length=df1))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>numeric value that indicates the number of knots (or degrees of freedom) desired; default is NULL. If knots and df are NULL, df will be set to 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>numeric or factor variable in order to define a varying coefficient smooth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.rho</code></td>
<td>
<p>if the specified by variable is a factor, specifies whether the smoothing parameters should be the same for all levels; default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>object of class <code>smf.smooth.spec</code>, <code>tensor.smooth.spec</code> or <code>tint.smooth.spec</code>  (see <code>smooth.spec</code> for details)
</p>


<h3>References</h3>

<p>Wood, S. N. (2017), Generalized additive models: an introduction with R. Second Edition. London: Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># penalized cubic regression spline of time with 5 unspecified knots
formula.test &lt;- ~smf(time,df=5)

# suppose that we want to fit a model from formula.test
library(survPen)
data(datCancer)

mod.test &lt;- survPen(~smf(fu,df=5) ,data=datCancer,t1=fu,event=dead)

# then the knots can be retrieved like this:
mod.test$list.smf[[1]]$knots
# or calculated like this
quantile(unique(datCancer$fu),seq(0,1,length=5))


# penalized cubic regression splines of time and age with respectively 5 and 7 unspecified knots
formula.test2 &lt;- ~smf(time,df=5)+smf(age,df=7)

# penalized cubic regression splines of time and age with respectively 3 and 4 specified knots
formula.test3 &lt;- ~smf(time,knots=c(0,3,5))+smf(age,knots=c(30,50,70,90))

# penalized tensor product for time and age with respectively 5 and 4 unspecified knots leading
# to 5*4 = 20 regression parameters
formula.test &lt;- ~tensor(time,age,df=c(5,4))

# penalized tensor product for time and age with respectively 3 and 4 specified knots
formula.test3 &lt;- ~tensor(time,agec,knots=list(c(0,3,5),c(30,50,70,90)))

# penalized tensor product for time, age and year with respectively 6, 5 and 4 unspecified knots
formula.test &lt;- ~tensor(time,age,year,df=c(6,5,4))

# penalized tensor product interaction for time and age with respectively 5 and 4 unspecified knots
# main effects are specified as penalized cubic regression splines
formula.test &lt;- ~smf(time,df=5)+smf(age,df=4)+tint(time,age,df=c(5,4))

</code></pre>


</div>