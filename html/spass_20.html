<div class="container">

<table style="width: 100%;"><tr>
<td>sim.bssr.1subgroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a One Subgroup Design with Internal Pilot Study</h2>

<h3>Description</h3>

<p>Given estimates of the treatment effects to be proven, the variances, and the prevalence,
<code>sim.bssr.1subgroup</code> calculates a initial sample size and performes a blinded sample size recalculation
after a prespecified number of subjects have been enrolled. Each oberservation is simulated and a final analysis executed.
Several variations are included, such as different approximations or sample size allocation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bssr.1subgroup(
  nsim = 1000,
  alpha,
  beta,
  delta,
  sigma,
  tau,
  vdelta,
  vsigma,
  vtau,
  rec.at = 1/2,
  eps = 0.001,
  approx = c("conservative.t", "liberal.t", "normal"),
  df = c("n", "n1"),
  fix.tau = c("YES", "NO"),
  k = 1,
  adjust = c("YES", "NO")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulation runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>type II error (power=1-beta) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>vector of true treatment effects, c(outside subgroup, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of true standard deviations, c(outside subgroup, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>subgroup prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdelta</code></td>
<td>
<p>vector of treatment effects to be proven, c(outside subgroup, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsigma</code></td>
<td>
<p>vector of assumed standard deviations, c(outside subgroup, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vtau</code></td>
<td>
<p>expected subgroup prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rec.at</code></td>
<td>
<p>blinded sample size review is performed after <code>rec.at</code>*<code class="reqn">100\%</code> subjects of the initial sample size calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>precision parameter concerning the power calculation in the iterative sample size search algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>approximation method: Use a conservative multivariate t distribution ("conservative.t"), a liberal multivariate t distribution ("liberal.t") or a multivariate normal distribution ("normal") to approximate the joint distribution of the standardized teststatistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>in case of a multivariate t distribution approximation, recalculate sample size with degrees of freedom depending on the size of the IPS (df=n1) or depending on the final sample size (df=n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.tau</code></td>
<td>
<p>subgroup prevalence is fixed by design (e.g. determined by recruitment) or is simulated and has to be reestimated during the blinded review.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>adjust blinded estimators for assumed treatment effect ("YES","No").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function combines sample size estimation, blinded sample size reestimation and analysis in a design with a subgroup within a full population where we want to test for treatment effects between a control and a treatment group.
The required sample size for the control and treatment group to prove an existing
alternative <code>delta</code> with a specified power 1-<code>beta</code> when testing the global null hypothesis <code class="reqn">H_0: \Delta_F=\Delta_S=0</code> to level <code>alpha</code> is calculated prior to the study and then recalculated in an internal pilot study.
</p>
<p>For sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the
sample size allocation factor, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>
<p>The parameter <code>df</code> provides a difference to the standard sample size calculation procedure implemented in <code>n.1subgroup</code>.
When applying a multivariate t distribution approximation to approximate the joint distribution of the standardized test statistics it gives the opportunity to use degrees of freedom depending on the number of subjects in the IPS instead of degrees of freedom depending on the projected final sample size.
Note that this leads to better performance when dealing with extremely small subgroup sample sizes but significantly increases the calculated final sample size.
</p>


<h3>Value</h3>

<p><code>sim.bssr.1subgroup</code> returns a data.frame containing the mean recalculated sample size within the control group and treatment group and the achieved simulated power along with all relevant parameters.
</p>


<h3>Source</h3>

<p><code>sim.bssr.1subgroup</code> uses code contributed by Marius Placzek.
</p>


<h3>See Also</h3>

<p><code>sim.bssr.1subgroup</code> makes use of <code>n.1subgroup</code>, <code>bssr.1subgroup</code>, and <code>r.1subgroup</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim.bssr.1subgroup(nsim=10,alpha=0.025,beta=0.1,delta=c(0,1),sigma=c(1,1.3),tau=0.2,
vdelta=c(0,1),vsigma=c(1,1),vtau=0.3,eps=0.002, approx="conservative.t",df="n",
fix.tau="YES",k=1,adjust="NO")

</code></pre>


</div>