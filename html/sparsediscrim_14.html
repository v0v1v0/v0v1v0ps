<div class="container">

<table style="width: 100%;"><tr>
<td>generate_intraclass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates data from <code>K</code> multivariate normal data populations, where each
population (class) has an intraclass covariance matrix.</h2>

<h3>Description</h3>

<p>This function generates <code>K</code> multivariate normal data sets, where each
class is generated with a constant mean vector and an intraclass covariance
matrix. The data are returned as a single matrix <code>x</code> along with a vector
of class labels <code>y</code> that indicates class membership.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_intraclass(n, p, rho, mu, sigma2 = rep(1, K))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of the sample sizes of each class. The length of <code>n</code>
determines the number of classes <code>K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of features (variables) in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>vector of the values of the off-diagonal elements for each
intraclass covariance matrix. Must equal the length of <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector containing the mean for each class. Must equal the length of
<code>n</code> (i.e., equal to <code>K</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>vector of variances for each class. Must equal the length of
<code>n</code>. Default is 1 for each class.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For simplicity, we assume that a class mean vector is constant for each
feature. That is, we assume that the mean vector of the <code class="reqn">k</code>th class is
<code class="reqn">c_k * j_p</code>, where <code class="reqn">j_p</code> is a <code class="reqn">p \times 1</code> vector of ones and
<code class="reqn">c_k</code> is a real scalar.
</p>
<p>The intraclass covariance matrix for the <code class="reqn">k</code>th class is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\sigma_k^2 * (\rho_k * J_p + (1 - \rho_k) * I_p),</code>
</p>

<p>where <code class="reqn">J_p</code> is the <code class="reqn">p \times p</code> matrix of ones and <code class="reqn">I_p</code> is the
<code class="reqn">p \times p</code> identity matrix.
</p>
<p>By default, with <code class="reqn">\sigma_k^2 = 1</code>, the diagonal elements of the intraclass
covariance matrix are all 1, while the off-diagonal elements of the matrix
are all <code>rho</code>.
</p>
<p>The values of <code>rho</code> must be between <code class="reqn">1 / (1 - p)</code> and 1,
exclusively, to ensure that the covariance matrix is positive definite.
</p>
<p>The number of classes <code>K</code> is determined with lazy evaluation as the
length of <code>n</code>.
</p>


<h3>Value</h3>

<p>named list with elements:
</p>

<ul>
<li> <p><code>x</code>: matrix of observations with <code>n</code> rows and <code>p</code>
columns
</p>
</li>
<li> <p><code>y</code>: vector of class labels that indicates class membership for
each observation (row) in <code>x</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Generates data from K = 3 classes.
data &lt;- generate_intraclass(n = 3:5, p = 5, rho = seq(.1, .9, length = 3),
                            mu = c(0, 3, -2))
data$x
data$y

# Generates data from K = 4 classes. Notice that we use specify a variance.
data &lt;- generate_intraclass(n = 3:6, p = 4, rho = seq(0, .9, length = 4),
                            mu = c(0, 3, -2, 6), sigma2 = 1:4)
data$x
data$y
</code></pre>


</div>