<div class="container">

<table style="width: 100%;"><tr>
<td>atc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>atc covariance structure</h2>

<h3>Description</h3>

<p><code>atc</code> creates a diagonal covariance structure for specific levels of the random effect to be used with the <code>mmec</code> solver.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  atc(x, levs, thetaC, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of observations for the random effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levs</code></td>
<td>
<p>levels of the random effect to use for building the incidence matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaC</code></td>
<td>
<p>an optional symmetric matrix for constraints in the variance-covariance components. The symmetric matrix should have as many rows and columns as the number of levels in the factor 'x'. The values in the matrix define how the variance-covariance components should be estimated:
</p>
<p>0: component will not be estimated
</p>
<p>1: component will be estimated and constrained to be positive
</p>
<p>2: component will be estimated and unconstrained
</p>
<p>3: component will be fixed to the value provided in the theta argument
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>an optional symmetric matrix for initial values of the variance-covariance components. The symmetric matrix should have as many rows and columns as the number of levels in the factor 'x'. The values in the matrix define the initial values of the variance-covariance components that will be subject to the constraints provided in thetaC. If not provided, initial values will be calculated as:
</p>
<p>theta* = diag(ncol(mm))*.05 + matrix(.1,ncol(mm),ncol(mm))
</p>
<p>where mm is the incidence matrix for the factor 'x'. The values provided should be scaled by the variance of the response variable.
</p>
<p>theta = theta*/var(y)
</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt>$res</dt>
<dd>
<p> a list with the provided vector and the variance covariance structure expected.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Giovanny Covarrubias-Pazaran
</p>


<h3>References</h3>

<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744 
</p>


<h3>See Also</h3>

<p>The function <code>vsc</code> to know how to use <code>atc</code> in the <code>mmec</code> solver. </p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- as.factor(c(1:5,1:5,1:5));x
atc(x, c("1","2"))
## how to use the theta and thetaC arguments:
# data(DT_example)
# DT &lt;- DT_example
# theta &lt;- diag(2)*2; theta # initial VCs
# thetaC &lt;- diag(2)*3; thetaC # fixed VCs
# ans1 &lt;- mmec(Yield~Env,
#              random= ~ vsc( atc(Env, levs=c("CA.2013", "CA.2011"),
#                             theta = theta,thetaC = thetaC),isc(Name) ),
#              rcov= ~ units, nIters = 1,
#              data=DT)
# summary(ans1)$varcomp

</code></pre>


</div>