<div class="container">

<table style="width: 100%;"><tr>
<td>fitrfh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Precedures</h2>

<h3>Description</h3>

<p>Several fitting procedures. The arguments can be passed to these functions
using the interface in rfh. The functions here listed are the low
level implementations and are not intended for interactive use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitrfh(y, x, samplingVar, ...)

fitrsfh(y, x, samplingVar, W, x0Var = c(0.01, 1), ...)

fitrtfh(y, x, samplingVar, nTime, x0Var = c(0.01, 1, 1), ...)

fitrstfh(y, x, samplingVar, W, nTime, x0Var = c(0.01, 0.01, 1, 1), ...)

fitGenericModel(
  y,
  x,
  matVFun,
  fixedPointParam,
  k = 1.345,
  K = getK(k),
  x0Coef = NULL,
  x0Var = 1,
  x0Re = NULL,
  tol = 1e-06,
  maxIter = 100,
  maxIterParam = 10,
  maxIterRe = 100,
  convCrit = convCritRelative(tol),
  ...
)

## S4 method for signature 'numeric,matrixORMatrix,numeric,'NULL''
rfh(formula, data, samplingVar, correlation = NULL, ...)

## S4 method for signature 'numeric,matrixORMatrix,numeric,corSAR1'
rfh(formula, data, samplingVar, correlation = NULL, ...)

## S4 method for signature 'numeric,matrixORMatrix,numeric,corAR1'
rfh(formula, data, samplingVar, correlation = NULL, ...)

## S4 method for signature 'numeric,matrixORMatrix,numeric,corSAR1AR1'
rfh(formula, data, samplingVar, correlation = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>(numeric) response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>([m|M]atrix) the design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingVar</code></td>
<td>
<p>(numeric) vector with sampling variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>fitGenericModel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>(matrix) proximity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0Var</code></td>
<td>
<p>(numeric) starting values for variance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTime</code></td>
<td>
<p>(integer) number of time periods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matVFun</code></td>
<td>
<p>(function) a function with one argument - the variance
parameters - constructing something like variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedPointParam</code></td>
<td>
<p>(function) a function with one argument. The vector of
model parameters. Returns a list of results of the next iteration in the
overall algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(numeric) tuning constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>(numeric) scaling constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0Coef</code></td>
<td>
<p>(numeric) starting values for regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0Re</code></td>
<td>
<p>(numeric) starting values for random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(numeric) numerical toloerance to be used during optimisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>(integer) the maximum number of iterations for model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIterParam</code></td>
<td>
<p>(integer) the maximum number of iterations for each
parameter in each overall iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIterRe</code></td>
<td>
<p>(integer) the maximum number of iterations for fitting the
random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convCrit</code></td>
<td>
<p>(function) a function defining the stopping rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(formula) a formula specifying the fixed effects part of the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(data.frame) a data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>an optional correlation structure, e.g. corSAR1,
for the random effects part of the model. Default is no correlation, i.e. a
random intercept.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fitrfh</code> implements the robust Fay-Herriot model; <code>fitrsfh</code> the
spatial, <code>fitrtfh</code> the temporal, and <code>fitrstfh</code> the spatio-temporal
extension to this model type. See rfh how to fit such models.
<code>fitGenericModel</code> is used by all these implementations and can be used
for possible extensions of the framework.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(milk, package = "sae")
x &lt;- matrix(1, nrow = NROW(milk))
y &lt;- milk$yi
samplingVar &lt;- milk$SD^2
fitrfh(y, x, samplingVar)
</code></pre>


</div>