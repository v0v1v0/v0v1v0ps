<div class="container">

<table style="width: 100%;"><tr>
<td>plot_sim_ext</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Simulated Data and Target External Data for Continuous or Count Variables</h2>

<h3>Description</h3>

<p>This plots simulated continuous or count data and overlays external data, both as histograms.
The external data is a required input.  The simulated data is centered and scaled to have the same mean and variance as the external
data set.  If the user wants to only plot simulated data, <code>plot_sim_theory</code> should be used instead
with <code>overlay = FALSE</code>.
It returns a <code>ggplot2-package</code> object so the user can modify as necessary.
The graph parameters (i.e. <code>title</code>, <code>power_color</code>, <code>target_color</code>, <code>nbins</code>) are
<code>ggplot2-package</code> parameters.  It works for valid or invalid power method pdfs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_sim_ext(sim_y, title = "Simulated Data Values", ylower = NULL,
  yupper = NULL, power_color = "dark blue", ext_y = NULL,
  target_color = "dark green", nbins = 100, legend.position = c(0.975,
  0.9), legend.justification = c(1, 1), legend.text.size = 10,
  title.text.size = 15, axis.text.size = 10, axis.title.size = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim_y</code></td>
<td>
<p>a vector of simulated data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title for the graph (default = "Simulated Data Values")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylower</code></td>
<td>
<p>the lower y value to use in the plot (default = NULL, uses minimum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yupper</code></td>
<td>
<p>the upper y value (default = NULL, uses maximum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_color</code></td>
<td>
<p>the histogram fill color for the simulated variable (default = "dark blue")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext_y</code></td>
<td>
<p>a vector of external data (required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_color</code></td>
<td>
<p>the histogram fill color for the target data (default = "dark green")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>the number of bins to use in generating the histograms (default = 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>the position of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.justification</code></td>
<td>
<p>the justification of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>the size of the legend labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.text.size</code></td>
<td>
<p>the size of the plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.size</code></td>
<td>
<p>the size of the axes text (tick labels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.size</code></td>
<td>
<p>the size of the axes titles</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot2-package</code> object.
</p>


<h3>References</h3>

<p>Please see the references for <code>plot_cdf</code>.
</p>
<p>Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.
</p>


<h3>See Also</h3>

<p><code>ggplot2-package</code>, <code>geom_histogram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Logistic Distribution: mean = 0, variance = 1

seed = 1234

# Simulate "external" data set
set.seed(seed)
ext_y &lt;- rlogis(10000)

# Find standardized cumulants
stcum &lt;- calc_theory(Dist = "Logistic", params = c(0, 1))

# Simulate without the sixth cumulant correction
# (invalid power method pdf)
Logvar1 &lt;- nonnormvar1(method = "Polynomial", means = 0, vars = 1,
                      skews = stcum[3], skurts = stcum[4],
                      fifths = stcum[5], sixths = stcum[6],
                      n = 10000, seed = seed)

# Plot simulated variable and external data
plot_sim_ext(sim_y = Logvar1$continuous_variable,
             title = "Invalid Logistic Simulated Data Values",
             ext_y = ext_y)

# Simulate with the sixth cumulant correction
# (valid power method pdf)
Logvar2 &lt;- nonnormvar1(method = "Polynomial", means = 0, vars = 1,
                      skews = stcum[3], skurts = stcum[4],
                      fifths = stcum[5], sixths = stcum[6],
                      Six = seq(1.5, 2, 0.05), n = 10000, seed = seed)

# Plot simulated variable and external data
plot_sim_ext(sim_y = Logvar2$continuous_variable,
             title = "Valid Logistic Simulated Data Values",
             ext_y = ext_y)

# Simulate 2 Poisson distributions (means = 10, 15) and correlation 0.3
# using Method 1
Pvars &lt;- rcorrvar(k_pois = 2, lam = c(10, 15),
                  rho = matrix(c(1, 0.3, 0.3, 1), 2, 2), seed = seed)

# Simulate "external" data set
set.seed(seed)
ext_y &lt;- rpois(10000, 10)

# Plot 1st simulated variable and external data
plot_sim_ext(sim_y = Pvars$Poisson_variable[, 1], ext_y = ext_y)


## End(Not run)

</code></pre>


</div>