<div class="container">

<table style="width: 100%;"><tr>
<td>AA.MultS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the multiple-surrogate adjusted association</h2>

<h3>Description</h3>

<p>The function <code>AA.MultS</code> computes the multiple-surrogate adjusted correlation. This is a generalisation of the adjusted association proposed by Buyse &amp; Molenberghs (1998) (see <code>Single.Trial.RE.AA</code>) to the setting where there are multiple endpoints. See <b>Details</b> below. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">AA.MultS(Sigma_gamma, N, Alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Sigma_gamma</code></td>
<td>
<p>The variance covariance matrix of the residuals of regression models in which the true endpoint (<code class="reqn">T</code>) is regressed on the treatment (<code class="reqn">Z</code>), the first surrogate (<code class="reqn">S1</code>) is regressed on <code class="reqn">Z</code>, ..., and the <code class="reqn">k</code>-th surrogate (<code class="reqn">Sk</code>) is regressed on <code class="reqn">Z</code>. See <b>Details</b> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The sample size (needed to compute a CI around the multiple adjusted association; <code class="reqn">\gamma_M</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence interval around <code class="reqn">\gamma_M</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The multiple-surrogate adjusted association (<code class="reqn">\gamma_M</code>) is obtained by regressing <code class="reqn">T</code>, <code class="reqn">S1</code>, <code class="reqn">S2</code>, ..., <code class="reqn">Sk</code> on the treatment (<code class="reqn">Z</code>):
</p>
<p style="text-align: center;"><code class="reqn">T_{j}=\mu_{T}+\beta Z_{j}+\varepsilon_{Tj},</code>
</p>

<p style="text-align: center;"><code class="reqn">S1_{j}=\mu_{S1}+\alpha_{1}Z_{j}+\varepsilon_{S1j},</code>
</p>

<p style="text-align: center;"><code class="reqn">\ldots,</code>
</p>

<p style="text-align: center;"><code class="reqn">Sk_{j}=\mu_{Sk}+\alpha_{k}Z_{j}+\varepsilon_{Skj},</code>
</p>

<p>where the error terms have a joint zero-mean normal distribution with variance-covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">{\boldsymbol{\Sigma}=\left(\begin{array}{cc}
\sigma_{TT} &amp; \Sigma_{\boldsymbol{S}T}\\
\Sigma^{'}_{\boldsymbol{S}T} &amp; \Sigma_{\boldsymbol{SS}} \\
\end{array}\right).}</code>
</p>

<p>The multiple adjusted association is then computed as
</p>
<p style="text-align: center;"><code class="reqn">\gamma_M = \sqrt(\frac{\left(\Sigma^{'}_{ST} \Sigma^{-1}_{SS} \Sigma_{ST}\right)}{\sigma_{TT}})</code>
</p>



<h3>Value</h3>

<p>An object of class <code>AA.MultS</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Gamma.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the multiple-surrogate adjusted association (i.e., <code class="reqn">\gamma_M</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corr.Gamma.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the bias-corrected multiple-surrogate adjusted association (i.e., corrected <code class="reqn">\gamma_M</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_gamma</code></td>
<td>
<p>The variance covariance matrix of the residuals of regression models in which <code class="reqn">T</code> is regressed on <code class="reqn">Z</code>, <code class="reqn">S1</code> is regressed on <code class="reqn">Z</code>, ..., and <code class="reqn">Sk</code> is regressed on <code class="reqn">Z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The sample size (used to compute a CI around the multiple adjusted association; <code class="reqn">\gamma_M</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence interval around <code class="reqn">\gamma_M</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., &amp; Molenberghs, G. (1998). The validation of surrogate endpoints in randomized experiments. <em>Biometrics, 54,</em> 1014-1029.
</p>
<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). A causal inference-based approach to evaluate surrogacy using multiple surrogates.</p>


<h3>See Also</h3>

<p><code>Single.Trial.RE.AA</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ARMD.MultS)

# Regress T on Z, S1 on Z, ..., Sk on Z 
# (to compute the covariance matrix of the residuals)
Res_T &lt;- residuals(lm(Diff52~Treat, data=ARMD.MultS))
Res_S1 &lt;- residuals(lm(Diff4~Treat, data=ARMD.MultS))
Res_S2 &lt;- residuals(lm(Diff12~Treat, data=ARMD.MultS))
Res_S3 &lt;- residuals(lm(Diff24~Treat, data=ARMD.MultS))
Residuals &lt;- cbind(Res_T, Res_S1, Res_S2, Res_S3)

# Make covariance matrix of residuals, Sigma_gamma
Sigma_gamma &lt;- cov(Residuals)

# Conduct analysis
Result &lt;- AA.MultS(Sigma_gamma = Sigma_gamma, N = 188, Alpha = .05)

# Explore results
summary(Result)
</code></pre>


</div>