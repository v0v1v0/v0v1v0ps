<div class="container">

<table style="width: 100%;"><tr>
<td>gmwm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Method of Wavelet Moments (GMWM)</h2>

<h3>Description</h3>

<p>Performs estimation of time series models by using the GMWM estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gmwm(
  model,
  data,
  model.type = "imu",
  compute.v = "auto",
  robust = FALSE,
  eff = 0.6,
  alpha = 0.05,
  seed = 1337,
  G = NULL,
  K = 1,
  H = 100,
  freq = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A <code>ts.model</code> object containing one of the allowed models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>matrix</code> or <code>data.frame</code> object with only column
(e.g. <code class="reqn">N \times 1</code>), a <code>lts</code> object,
or a <code>gts</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.type</code></td>
<td>
<p>A <code>string</code> containing the type of GMWM needed:
<code>"imu"</code> or <code>"ssm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.v</code></td>
<td>
<p>A <code>string</code> indicating the type of covariance matrix
solver. Valid values are:
<code>"fast"</code>, <code>"bootstrap"</code>,
<code>"diag"</code> (asymptotic diag),
<code>"full"</code> (asymptotic full). By default, the program
will fit a "fast" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>A <code>boolean</code> indicating whether to use the robust
computation (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff</code></td>
<td>
<p>A <code>double</code> between 0 and 1 that indicates the
efficiency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A <code>double</code> between 0 and 1 that correspondings to the
<code class="reqn">\frac{\alpha}{2}</code> value for the wavelet
confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An <code>integer</code> that controls the reproducibility of the
auto model selection phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>An <code>integer</code> to sample the space for IMU and SSM
models to ensure optimal identitability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>An <code>integer</code> that controls how many times the
bootstrapping procedure will be initiated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>An <code>integer</code> that indicates how many different
samples the bootstrap will be collect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>A <code>double</code> that indicates the sampling frequency. By
default, this is set to 1 and only is important if <code>GM()</code>
is in the model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is under work. Some of the features are active. Others... Not so much.
</p>
<p>The V matrix is calculated by:
<code class="reqn">diag\left[ {{{\left( {Hi - Lo} \right)}^2}} \right]</code>.
</p>
<p>The function is implemented in the following manner:
1. Calculate MODWT of data with levels = floor(log2(data))
2. Apply the brick.wall of the MODWT (e.g. remove boundary values)
3. Compute the empirical wavelet variance (WV Empirical).
4. Obtain the V matrix by squaring the difference of the WV Empirical's Chi-squared confidence interval (hi - lo)^2
5. Optimize the values to obtain <code class="reqn">\hat{\theta}</code>
6. If FAST = TRUE, return these results. Else, continue.
</p>
<p>Loop  k = 1 to K
Loop h = 1 to H
7. Simulate xt under <code class="reqn">F_{\hat{\theta}}</code>
8. Compute WV Empirical
END
9. Calculate the covariance matrix
10. Optimize the values to obtain <code class="reqn">\hat{\theta}</code>
END
11. Return optimized values.
</p>
<p>The function estimates a variety of time series models. If type = "imu" or "ssm", then
parameter vector should indicate the characters of the models that compose the latent or state-space model. The model
options are:
</p>

<ul>
<li>
<p> "AR1": a first order autoregressive process with parameters <code class="reqn">(\phi,\sigma^2)</code>
</p>
</li>
<li>
<p> "GM": a guass-markov process <code class="reqn">(\beta,\sigma_{gm}^2)</code>
</p>
</li>
<li>
<p> "ARMA": an autoregressive moving average process with parameters <code class="reqn">(\phi _p, \theta _q, \sigma^2)</code>
</p>
</li>
<li>
<p> "DR": a drift with parameter <code class="reqn">\omega</code>
</p>
</li>
<li>
<p> "QN": a quantization noise process with parameter <code class="reqn">Q</code>
</p>
</li>
<li>
<p> "RW": a random walk process with parameter <code class="reqn">\sigma^2</code>
</p>
</li>
<li>
<p> "WN": a white noise process with parameter <code class="reqn">\sigma^2</code>
</p>
</li>
</ul>
<p>If only an ARMA() term is supplied, then the function takes conditional least squares as starting values
If robust = TRUE the function takes the robust estimate of the wavelet variance to be used in the GMWM estimation procedure.
</p>


<h3>Value</h3>

<p>A <code>gmwm</code> object with the structure:
</p>

<ul>
<li>
<p> estimate: Estimated Parameters Values from the GMWM Procedure
</p>
</li>
<li>
<p> init.guess: Initial Starting Values given to the Optimization Algorithm
</p>
</li>
<li>
<p> wv.empir: The data's empirical wavelet variance
</p>
</li>
<li>
<p> ci_low: Lower Confidence Interval
</p>
</li>
<li>
<p> ci_high: Upper Confidence Interval
</p>
</li>
<li>
<p> orgV: Original V matrix
</p>
</li>
<li>
<p> V: Updated V matrix (if bootstrapped)
</p>
</li>
<li>
<p> omega: The V matrix inversed
</p>
</li>
<li>
<p> obj.fun: Value of the objective function at Estimated Parameter Values
</p>
</li>
<li>
<p> theo: Summed Theoretical Wavelet Variance
</p>
</li>
<li>
<p> decomp.theo: Decomposed Theoretical Wavelet Variance by Process
</p>
</li>
<li>
<p> scales: Scales of the GMWM Object
</p>
</li>
<li>
<p> robust: Indicates if parameter estimation was done under robust or classical
</p>
</li>
<li>
<p> eff: Level of efficiency of robust estimation
</p>
</li>
<li>
<p> model.type: Models being guessed
</p>
</li>
<li>
<p> compute.v: Type of V matrix computation
</p>
</li>
<li>
<p> augmented: Indicates moments have been augmented
</p>
</li>
<li>
<p> alpha: Alpha level used to generate confidence intervals
</p>
</li>
<li>
<p> expect.diff: Mean of the First Difference of the Signal
</p>
</li>
<li>
<p> N: Length of the Signal
</p>
</li>
<li>
<p> G: Number of Guesses Performed
</p>
</li>
<li>
<p> H: Number of Bootstrap replications
</p>
</li>
<li>
<p> K: Number of V matrix bootstraps
</p>
</li>
<li>
<p> model: <code>ts.model</code> supplied to gmwm
</p>
</li>
<li>
<p> model.hat: A new value of <code>ts.model</code> object supplied to gmwm
</p>
</li>
<li>
<p> starting: Indicates whether the procedure used the initial guessing approach
</p>
</li>
<li>
<p> seed: Randomization seed used to generate the guessing values
</p>
</li>
<li>
<p> freq: Frequency of data
</p>
</li>
</ul>
</div>