<div class="container">

<table style="width: 100%;"><tr>
<td>simData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating Matrix of Statistics</h2>

<h3>Description</h3>

<p>This function simulates a matrix of permutation statistics,
by performing a t test on normal data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simData(prop, m, B = 200, rho = 0, n = 50, alpha = 0.05, pw = 0.8, p = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>proportion of non-null hypotheses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>total number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>level of equicorrelation between pairs of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pw</code></td>
<td>
<p>power of the t test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>logical, <code>TRUE</code> to compute p-values, <code>FALSE</code> to compute t-scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function applies the one-sample two-sided t test to a matrix of simulated data,
for <code>B</code> data permutations.
Data is obtained by simulating <code>n</code> independent observations from a multivariate normal distribution,
where a proportion <code>prop</code> of the variables has non-null mean.
This mean is such that the one-sample t test with significance level <code>alpha</code> has power equal to <code>pw</code>.
Each pair of distinct variables has equicorrelation <code>rho</code>.
</p>


<h3>Value</h3>

<p><code>simData</code> returns a matrix where the <code>B</code> rows correspond to permutations (the first is the identity),
and the <code>m</code> columns correspond to variables.
The matrix contains p-values if <code>p</code> is <code>TRUE</code>, and t-scores otherwise.
The first columns (a proportion <code>prop</code>) correspond to non-null hypotheses.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>See Also</h3>

<p>True discovery guarantee: <code>sumStats</code>, <code>sumPvals</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>


</div>