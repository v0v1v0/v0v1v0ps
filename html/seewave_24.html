<div class="container">

<table style="width: 100%;"><tr>
<td>corenv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-correlation between two time wave envelopes</h2>

<h3>Description</h3>

<p>This function tests the similarity between two time wave envelopes by returning
their maximal correlation and the time shift related to it. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">corenv(wave1, wave2, f, channel=c(1,1), envt="hil", msmooth = NULL, ksmooth = NULL,
ssmooth = NULL, plot = TRUE, plotval = TRUE,
method = "spearman", col = "black", colval = "red",
cexval = 1, fontval = 1, xlab = "Time (s)",
ylab = "Coefficient of correlation (r)", type = "l", pb = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave1</code></td>
<td>
<p>a first R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave2</code></td>
<td>
<p>a second R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R objects, by default left channel (1)
for each object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envt</code></td>
<td>
<p>the type of envelope to be used: either "abs" for absolute
amplitude envelope or "hil" for Hilbert amplitude envelope. See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msmooth</code></td>
<td>
<p>a vector of length 2 to smooth the amplitude envelope with a 
mean sliding window. The first component is the window length
(in number of points). The second component is the overlap between
successive windows (in %). See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksmooth</code></td>
<td>
<p>kernel smooth via <code>kernel</code>. See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssmooth</code></td>
<td>
<p>sum smooth. See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots r values against frequency shift
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotval</code></td>
<td>
<p>logical, if <code>TRUE</code> adds to the plot maximum r value
and frequency offset (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which correlation coefficient is
to be computed ("pearson", "spearman", or "kendall")
(see <code>cor</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of r values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colval</code></td>
<td>
<p>colour of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexval</code></td>
<td>
<p>character size of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontval</code></td>
<td>
<p>font of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the r axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>if <code>TRUE</code> returns a text progress bar in the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Successive correlations between the envelopes of <code>wave1</code> and <code>wave2</code>
are computed when regularly sliding forward and backward <code>wave2</code> along
<code>wave1</code>.<br>
The maximal correlation is obtained at a particular shift (time offset). 
This shift may be positive or negative.<br>
The higher <code>smooth</code> is set up,
the faster will be the computation but less precise the results will be.<br> 
The corresponding p value, obtained with <code>cor.test</code>, is  plotted.
Inverting <code>wave1</code> and <code>wave2</code> may give slight different results.
</p>


<h3>Value</h3>

<p>If <code>plot</code> is <code>FALSE</code>, <code>corenv</code> returns a list containing four
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a two-column matrix, the first colum corresponding to the time
shift (frequency x-axis) and the second column corresponding to the successive
r correlation values between <code>env1</code> and <code>env2</code> (correlation y-axis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>
<p>the maximum correlation value between <code>x</code> and <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p value corresponding to <code>rmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the time offset corresponding to <code>rmax</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>See Also</h3>

<p><code>env</code>,<code>corspec</code>,<code>covspectro</code>,
<code>cor</code>,<code>cor.test</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(orni)
# cross-correlation between two echemes of a cicada song
wave1&lt;-cutw(orni,f=22050,from=0.3,to=0.4,plot=FALSE)
wave2&lt;-cutw(orni,f=22050,from=0.58,to=0.68,plot=FALSE)
corenv(wave1,wave2,f=22050)

## End(Not run)
</code></pre>


</div>