<div class="container">

<table style="width: 100%;"><tr>
<td>lavTestLRT.mi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Ratio Test for Multiple Imputations</h2>

<h3>Description</h3>

<p>Likelihood ratio test (LRT) for lavaan models fitted to multiple imputed
data sets. Statistics for comparing nested models can be calculated by
pooling the likelihood ratios across imputed data sets, as described by
Meng &amp; Rubin (1992), or by pooling the LRT statistics from each imputation,
as described by Li, Meng, Raghunathan, &amp; Rubin (1991).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lavTestLRT.mi(object, h1 = NULL, test = c("D3", "D2"),
  omit.imps = c("no.conv", "no.se"), asymptotic = FALSE,
  pool.robust = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, h1</code></td>
<td>
<p>An object of class <code>lavaan.mi</code>.
<code>object</code> should be nested within (more constrained than) <code>h1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p><code>character</code> indicating which pooling method to use.
<code>"D3"</code>, <code>"mr"</code>, or <code>"meng.rubin"</code> (default) requests the
method described by Meng &amp; Rubin (1992). <code>"D2"</code>, <code>"LMRR"</code>,
or <code>"Li.et.al"</code> requests the complete-data LRT statistic should be
calculated using each imputed data set, which will then be pooled across
imputations, as described in Li, Meng, Raghunathan, &amp; Rubin (1991).
Find additional details in Enders (2010, chapter 8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.imps</code></td>
<td>
<p><code>character</code> vector specifying criteria for omitting
imputations from pooled results.  Can include any of
<code>c("no.conv", "no.se", "no.npd")</code>, the first 2 of which are the
default setting, which excludes any imputations that did not
converge or for which standard errors could not be computed.  The
last option (<code>"no.npd"</code>) would exclude any imputations which
yielded a nonpositive definite covariance matrix for observed or
latent variables, which would include any "improper solutions" such
as Heywood cases. Specific imputation numbers can also be included in this
argument, in case users want to  apply their own custom omission criteria
(or simulations can use different numbers of imputations without
redundantly refitting the model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymptotic</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code> (default), the pooled test
will be returned as an <em>F</em>-distributed statistic with numerator
(<code>df1</code>) and denominator (<code>df2</code>) degrees of freedom.
If <code>TRUE</code>, the pooled <em>F</em> statistic will be multiplied by its
<code>df1</code> on the assumption that its <code>df2</code> is sufficiently large
enough that the statistic will be asymptotically <code class="reqn">\chi^2</code> distributed
with <code>df1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool.robust</code></td>
<td>
<p><code>logical</code>. Ignored unless <code>test = "D2"</code> and a
robust test was requested. If <code>pool.robust = TRUE</code>, the robust test
statistic is pooled, whereas <code>pool.robust = FALSE</code> will pool
the naive test statistic (or difference statistic) and apply the average
scale/shift parameter to it (unavailable for mean- and variance-adjusted
difference statistics, so <code>pool.robust</code> will be set <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>lavTestLRT</code>,
only if <code>test = "D2"</code> and <code>pool.robust = TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Meng &amp; Rubin (1992) method, also referred to as the <code>"D3"</code>
statistic, is only applicable when using a likelihood-based estimator.
Otherwise (e.g., DWLS for categorical outcomes), users are notified that
<code>test</code> was set to <code>"D2"</code>.
</p>
<p><code>test = "Mplus"</code> implies <code>"D3"</code> and <code>asymptotic = TRUE</code>
(see Asparouhov &amp; Muthen, 2010).
</p>
<p>Note that unlike <code>lavTestLRT</code>, <code>lavTestLRT</code> can
only be used to compare a single pair of models, not a longer list of
models.  To compare several nested models fitted to multiple imputations,
see examples on the <code>compareFit</code> help page.
</p>


<h3>Value</h3>

<p>A vector containing the LRT statistic (either an <code>F</code> or <code class="reqn">\chi^2</code>
statistic, depending on the <code>asymptotic</code> argument), its degrees of
freedom (numerator and denominator, if <code>asymptotic = FALSE</code>), its
<em>p</em> value, and 2 missing-data diagnostics: the relative invrease
in variance (RIV, or average for multiparameter tests: ARIV) and the
fraction missing information (FMI = ARIV / (1 + ARIV)). Robust statistics
will also include the average (across imputations) scaling factor and
(if relevant) shift parameter(s), unless <code>pool.robust = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Terrence D. Jorgensen (University of Amsterdam;
<a href="mailto:TJorgensen314@gmail.com">TJorgensen314@gmail.com</a>)
</p>


<h3>References</h3>

<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>.
New York, NY: Guilford.
</p>
<p>Li, K.-H., Meng, X.-L., Raghunathan, T. E., &amp; Rubin, D. B. (1991).
Significance levels from repeated <em>p</em>-values with multiply-imputed
data. <em>Statistica Sinica, 1</em>(1), 65–92. Retrieved from
<a href="https://www.jstor.org/stable/24303994">https://www.jstor.org/stable/24303994</a>
</p>
<p>Meng, X.-L., &amp; Rubin, D. B. (1992). Performing likelihood ratio tests with
multiply-imputed data sets. <em>Biometrika, 79</em>(1), 103–111.
<a href="https://doi.org/10.2307/2337151">doi:10.2307/2337151</a>
</p>
<p>Rubin, D. B. (1987). <em>Multiple imputation for nonresponse in surveys</em>.
New York, NY: Wiley.
</p>


<h3>See Also</h3>

<p><code>lavTestLRT</code>, <code>compareFit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
## impose missing data for example
HSMiss &lt;- HolzingerSwineford1939[ , c(paste("x", 1:9, sep = ""),
                                      "ageyr","agemo","school")]
set.seed(12345)
HSMiss$x5 &lt;- ifelse(HSMiss$x5 &lt;= quantile(HSMiss$x5, .3), NA, HSMiss$x5)
age &lt;- HSMiss$ageyr + HSMiss$agemo/12
HSMiss$x9 &lt;- ifelse(age &lt;= quantile(age, .3), NA, HSMiss$x9)

## impute missing data
library(Amelia)
set.seed(12345)
HS.amelia &lt;- amelia(HSMiss, m = 20, noms = "school", p2s = FALSE)
imps &lt;- HS.amelia$imputations

## specify CFA model from lavaan's ?cfa help page
HS.model &lt;- '
  visual  =~ x1 + b1*x2 + x3
  textual =~ x4 + b2*x5 + x6
  speed   =~ x7 + b3*x8 + x9
'

fit1 &lt;- cfa.mi(HS.model, data = imps, estimator = "mlm")
fit0 &lt;- cfa.mi(HS.model, data = imps, estimator = "mlm", orthogonal = TRUE)

## By default, use D3.
## Must request a chi-squared statistic to be robustified.
lavTestLRT.mi(fit1, h1 = fit0, asymptotic = TRUE)

## Using D2, you can either robustify the pooled naive statistic ...
lavTestLRT.mi(fit1, h1 = fit0, asymptotic = TRUE, test = "D2")
## ... or pool the robust chi-squared statistic
lavTestLRT.mi(fit1, h1 = fit0, asymptotic = TRUE, test = "D2",
              pool.robust = TRUE)

## End(Not run)

</code></pre>


</div>