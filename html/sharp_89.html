<div class="container">

<table style="width: 100%;"><tr>
<td>StabilityScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stability score</h2>

<h3>Description</h3>

<p>Computes the stability score from selection proportions of models with a
given parameter controlling the sparsity and for different thresholds in
selection proportions. The score measures how unlikely it is that the
selection procedure is uniform (i.e. uninformative) for a given combination
of parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StabilityScore(
  selprop,
  pi_list = seq(0.6, 0.9, by = 0.01),
  K,
  n_cat = 3,
  group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>selprop</code></td>
<td>
<p>array of selection proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_list</code></td>
<td>
<p>vector of thresholds in selection proportions. If
<code>n_cat=NULL</code> or <code>n_cat=2</code>, these values must be <code>&gt;0</code> and
<code>&lt;1</code>. If <code>n_cat=3</code>, these values must be <code>&gt;0.5</code> and
<code>&lt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of resampling iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cat</code></td>
<td>
<p>computation options for the stability score. Default is
<code>NULL</code> to use the score based on a z test. Other possible values are 2
or 3 to use the score based on the negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>vector encoding the grouping structure among predictors. This
argument indicates the number of variables in each group and only needs to
be provided for group (but not sparse group) penalisation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The stability score is derived from the likelihood under the
assumption of uniform (uninformative) selection.
</p>
<p>We classify the features into three categories: the stably selected ones
(that have selection proportions <code class="reqn">\ge \pi</code>), the stably excluded ones
(selection proportion <code class="reqn">\le 1-\pi</code>), and the unstable ones (selection
proportions between <code class="reqn">1-\pi</code> and <code class="reqn">\pi</code>).
</p>
<p>Under the hypothesis of equiprobability of selection (instability), the
likelihood of observing stably selected, stably excluded and unstable
features can be expressed as:
</p>
<p><code class="reqn">L_{\lambda, \pi} = \prod_{j=1}^N [ ( 1 - F( K \pi - 1 ) )^{1_{H_{\lambda} (j) \ge K \pi}}
  \times ( F( K \pi - 1 ) - F( K ( 1 - \pi ) )^{1_{ (1-\pi) K &lt; H_{\lambda} (j) &lt; K \pi }}
  \times F( K ( 1 - \pi ) )^{1_{ H_{\lambda} (j) \le K (1-\pi) }} ]</code>
</p>
<p>where <code class="reqn">H_{\lambda} (j)</code> is the selection count of feature <code class="reqn">j</code> and
<code class="reqn">F(x)</code> is the cumulative probability function of the binomial
distribution with parameters <code class="reqn">K</code> and the average proportion of selected
features over resampling iterations.
</p>
<p>The stability score is computed as the minus log-transformed likelihood
under the assumption of equiprobability of selection:
</p>
<p><code class="reqn">S_{\lambda, \pi} = -log(L_{\lambda, \pi})</code>
</p>
<p>The stability score increases with stability.
</p>
<p>Alternatively, the stability score can be computed by considering only two
sets of features: stably selected (selection proportions <code class="reqn">\ge \pi</code>) or
not (selection proportions <code class="reqn">&lt; \pi</code>). This can be done using
<code>n_cat=2</code>.
</p>


<h3>Value</h3>

<p>A vector of stability scores obtained with the different thresholds
in selection proportions.
</p>


<h3>References</h3>

<p>Bodinier B, Filippi S, Nøst TH, Chiquet J, Chadeau-Hyam M (2023).
“Automated calibration for stability selection in penalised regression and graphical models.”
<em>Journal of the Royal Statistical Society Series C: Applied Statistics</em>, qlad058.
ISSN 0035-9254, <a href="https://doi.org/10.1093/jrsssc/qlad058">doi:10.1093/jrsssc/qlad058</a>, https://academic.oup.com/jrsssc/advance-article-pdf/doi/10.1093/jrsssc/qlad058/50878777/qlad058.pdf.
</p>


<h3>See Also</h3>

<p>Other stability metric functions: 
<code>ConsensusScore()</code>,
<code>FDP()</code>,
<code>PFER()</code>,
<code>StabilityMetrics()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulating set of selection proportions
set.seed(1)
selprop &lt;- round(runif(n = 20), digits = 2)

# Computing stability scores for different thresholds
score &lt;- StabilityScore(selprop, pi_list = c(0.6, 0.7, 0.8), K = 100)
</code></pre>


</div>