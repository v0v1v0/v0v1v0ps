<div class="container">

<table style="width: 100%;"><tr>
<td>samonIM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>samonIM: Sensitivity analysis for monotone missing and
intermittent missing data</h2>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial, produces estimates of the expected value of the outcome at the
final time-point for a range of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class="language-R">samonIM(mat, Npart = 10, InitialSigmaH = 1.0, 
HighSigmaH = 2.0, InitialSigmaF = 1.0, HighSigmaF = 2.0, 
inmodel = inmodel, NSamples = 0, NIMimpute = 1, lb = 0, 
ub = 101, zeta1 = 1, zeta2 = 1, seed0 = 1, seed1 = 1, 
MaxIter = 25, FAconvg = 1E-7, FRconvg = 1E-7, 
SAconvg = 1E-7, alphaList = c(0), retIFiM  = FALSE, 
retIFiS  = FALSE, retSample = FALSE,
retFMatM = FALSE, retFMatS = FALSE, Tfun=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InitialSigmaF</code></td>
<td>
<p> Initial value when calculation optimal sigma F. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculation
optimal sigma F. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inmodel</code></td>
<td>
<p> NT by 6 matrix indicating which variables to include
in logistic model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NIMimpute</code></td>
<td>
<p> How many times to fill in intermittent missing data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p> Lower bound for Y. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p> Upper bound for Y. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta1</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta2</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed0</code></td>
<td>
<p> Seed to use for parametric bootstrap sampling </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed1</code></td>
<td>
<p> Seed to use for filling intermittent missing data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaList</code></td>
<td>
<p> a vector of sensitivity parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retIFiM</code></td>
<td>
<p> return individual IF estimates from main data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retIFiS</code></td>
<td>
<p> return individual IF estimates from sample data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retSample</code></td>
<td>
<p> return the Sample generated </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retFMatM</code></td>
<td>
<p> return the main data with intermittent missing data
filled in NIMimpute + 1 times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retFMatS</code></td>
<td>
<p> retrun the sample data with intermittent missing data
filled in NIMimpute + 1 times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tfun</code></td>
<td>
<p> n by 2 matrix with tilting function values. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point.  
</p>
<p>The values in the first column of mat are the baseline values and should
not be missing.  Samon creates bias-corrected estimates of the mean
value of Y at the last time-point for a number of specified sensitivity
parameters, alpha.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the "missingness" model and, sigma F, which represents
smoothing in the "outcome" model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model and
InitialSigmaF is used as the initial value in the optimization of the
outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i)) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>
<p>The inmodel matrix specifies a set of logistic models used to impute
intermittent missing data.  This is an NT by 6 matrix of 0s and 1s.
Each row represents a time-point.  Since intermittent missing data
cannot occur at baseline or at the final timepoint, the first and NT'th
row of inmodel are 0.  The six values on a row indicate the following
terms should be included in the model:
</p>

<dl>
<dt>1</dt>
<dd>
<p> a value of 1 in this position indicates that the logistic
model should include an intercept</p>
</dd>
<dt>2</dt>
<dd>
<p> a value of 1 in this position indicates that the model should
contain a term for the previous available outcome</p>
</dd>
<dt>3</dt>
<dd>
<p> a value of 1 in this position indicates that the model should
contain a term for the next available outcome</p>
</dd>
<dt>4</dt>
<dd>
<p> a value of 1 in this position indicates that the model should
contain a term for the location of the next available outcome</p>
</dd>
<dt>5</dt>
<dd>
<p> a value of 1 in this position indicates that the model should
contain a term for the interaction between the next available outcome
and the position of the next available outcome</p>
</dd>
<dt>6</dt>
<dd>
<p> a value of 1 in this position indicates that the model should
contain a term for the last available outcome before dropout.</p>
</dd>
</dl>
<p>For example suppose the data consists of the 8 columns v1-v8 and
suppose we wish to model the intermittent missingness at the third
time-point, that is, we wish to model when v3 has an intermittent
missing value.   We might model this as is.na(v3) ~ 1 + v2 + n3 + i3 +
i3 * n3 + l3 where n3 refers to the next non-missing value of v after
the third time-point. i3 refers to the location of that non-missing
value, i3 * n3 and interaction between these and l3 the last available
value of v for an individual.  Specifically we might calculate n3, i3
and l3 as shown:
</p>

<table>
<tr>
<td style="text-align: right;">
 v1 </td>
<td style="text-align: right;">  v2 </td>
<td style="text-align: right;">    v3 </td>
<td style="text-align: right;">    v4  </td>
<td style="text-align: right;">   v5  </td>
<td style="text-align: right;">   v6 </td>
<td style="text-align: right;">    v7  </td>
<td style="text-align: right;">   v8  </td>
<td style="text-align: right;">     v2 </td>
<td style="text-align: right;">    n3 </td>
<td style="text-align: right;">    i3 </td>
<td style="text-align: right;">    l3</td>
</tr>
<tr>
<td style="text-align: right;">
 10 </td>
<td style="text-align: right;">     8 </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">     9 </td>
<td style="text-align: right;">    32 </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">       8 </td>
<td style="text-align: right;">     9 </td>
<td style="text-align: right;">     1 </td>
<td style="text-align: right;">    32</td>
</tr>
<tr>
<td style="text-align: right;">
 11 </td>
<td style="text-align: right;">     4 </td>
<td style="text-align: right;">     3 </td>
<td style="text-align: right;">     5 </td>
<td style="text-align: right;">     4 </td>
<td style="text-align: right;">     7 </td>
<td style="text-align: right;">     7 </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">       4 </td>
<td style="text-align: right;">     5 </td>
<td style="text-align: right;">     1 </td>
<td style="text-align: right;">     7</td>
</tr>
<tr>
<td style="text-align: right;">
 22 </td>
<td style="text-align: right;">    15 </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">    NA </td>
<td style="text-align: right;">     6 </td>
<td style="text-align: right;">     2 </td>
<td style="text-align: right;">     9 </td>
<td style="text-align: right;">      15 </td>
<td style="text-align: right;">     6 </td>
<td style="text-align: right;">     3 </td>
<td style="text-align: right;">     9</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>Note that when considering missing values at the NT - 1 time-point the
last three terms in the model are not identifiable.
</p>
<p>Fitting as many terms in the intermittent missing model might use an
inmodel parameter with a matrix like this:
</p>

<table>
<tr>
<td style="text-align: right;"> 
 0 </td>
<td style="text-align: right;">   0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>A simpler model using only the intercept and the previous and next
available non-missing value would be specified by
</p>

<table>
<tr>
<td style="text-align: right;"> 
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>This simpler model but restricted to an intercept only model at the
second and fourth timepoints can be specified by using:  
</p>

<table>
<tr>
<td style="text-align: right;"> 
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0  </td>
<td style="text-align: right;">  0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   1 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
 0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0 </td>
<td style="text-align: right;">   0</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p>In practice the amount of intermittent missing data at a timepoint may
not be large enough to support a logistic model with all six
parameters.  At each step samonIM  will attempt to fit the models
indicated by the inmodel matrix and reduce the number of model
parameters if collinearity is found among the independent variables.  
</p>


<h3>Value</h3>

<p>samon returns a list which includes the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The "M" in the
name "HM" refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The "M" in the
name "FM" refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td>
</tr>
</table>
<p>The return code takes the following values:   
</p>

<ol>
<li>
<p> absolute function convergence was met 
</p>
</li>
<li>
<p> relative function convergence was met 
</p>
</li>
<li>
<p> second derivative has become too small
</p>
</li>
<li>
<p> maximum iterations reached 
</p>
</li>
<li>
<p> value reset to HighSigmaH or HighSigmaF 
</p>
</li>
<li>
<p> loss function smaller at HighSigmaH or HighSigmaF 
</p>
</li>
</ol>
<table><tr style="vertical-align: top;">
<td><code>Sample</code></td>
<td>
<p> The generated sample of dimension NSamples by ncol(Mat)</p>
</td>
</tr></table>
<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("VAS1")

# inputation model
NT            &lt;- ncol(VAS1)
inmodel       &lt;- matrix(1,NT,6)
inmodel[1,]   &lt;- 0
inmodel[NT,]  &lt;- 0
inmodel[,4:6] &lt;- 0

Results &lt;- samonIM(
  mat           =    VAS1, # imput matrix
  Npart         =       2, # number of partitions
    
  InitialSigmaH =    25.0, # initial value
  HighSigmaH    =   100.0, # high value for H
    
  InitialSigmaF =     8.0, # initial value
  HighSigmaF    =   100.0, # high value for F
    
  lb            =       0, # parameters for
  ub            =     102, # cumulative 
  zeta1         =     1.2, # beta distribution
  zeta2         =     1.6,

  NSamples      =       0, # no of bootstraps
  NIMimpute     =       2, # no of imputations 
    
  seed0         =     441, # seed for bootstraps
  seed1         =     511, # seed for imputations
  inmodel       = inmodel, # input model
    
  alphaList     =   -1:1 )
</code></pre>


</div>