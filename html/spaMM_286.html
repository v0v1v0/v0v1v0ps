<div class="container">

<table style="width: 100%;"><tr>
<td>Poisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Family function for GLMs and mixed models with Poisson and zero-truncated Poisson response.
</h2>

<h3>Description</h3>

<p><code>Poisson</code> (with a capital P) is a <code>family</code> that specifies the information required to fit a Poisson generalized linear model. Differs from the base version <code>stats::poisson</code> only in that it handles the zero-truncated variant, which can be specified either as <code>Tpoisson(&lt;link&gt;)</code> or as <code>Poisson(&lt;link&gt;, trunc = 0L)</code>. The truncated poisson with mean <code class="reqn">\mu_T</code> is defined from the un-truncated poisson with mean <code class="reqn">\mu_U</code>, by restricting its response strictly positive value. <code class="reqn">\mu_T=\mu_U/(1-p0)</code>, where <code class="reqn">p0:=\exp(-\mu_U)</code> is the probability that the response is 0. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Poisson(link = "log", trunc = -1L, LLgeneric=TRUE)
Tpoisson(link="log")
# &lt;Poisson object&gt;$linkfun(mu, mu_truncated = FALSE)
# &lt;Poisson object&gt;$linkinv(eta, mu_truncated = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>log, sqrt or identity link, specified by any of the available ways for GLM links (name, character string, one-element character vector, or object of class <code>link-glm</code> as returned by <code>make.link</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>Either <code>0L</code> for zero-truncated distribution, or <code>-1L</code> for default untruncated distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta,mu</code></td>
<td>
<p>Numeric (scalar or array). The linear predictor; and the expectation of response, truncated or not depending on <code>mu_truncated</code> argument. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_truncated</code></td>
<td>
<p>Boolean. For <code>linkinv</code>, whether to return the expectation of truncated (<code class="reqn">\mu_T</code>) or un-truncated (<code class="reqn">\mu_U</code>) response. For <code>linkfun</code>, whether the <code>mu</code> argument is <code class="reqn">\mu_T</code>, or is <code class="reqn">\mu_U</code>  but has <code class="reqn">\mu_T</code>  as attribute (<code class="reqn">\mu_U</code> without the attribute is not sufficient). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLgeneric</code></td>
<td>

<p>For development purposes, not documented. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Molas &amp; Lesaffre (2010) developed expressions for deviance residuals for the truncated Poisson distribution, which were the ones implemented in <span class="pkg">spaMM</span> until version 3.12.0. Later versions implement the (non-equivalent) definition as “2*(saturated_logLik - logLik)”.   
</p>
<p><code>predict</code>, when applied on an object with a truncated-response family, by default returns <code class="reqn">\mu_T</code>. The simplest way to predict <code class="reqn">\mu_U</code> is to get the linear predictor value by <code>predict(.,type="link")</code>, and deduce <code class="reqn">\mu_U</code> using <code>linkinv(.)</code> (with default argument <code>mu_truncated=FALSE</code>), since getting <code class="reqn">\mu_U</code> from <code class="reqn">\mu_T</code> is comparatively less straightforward. The <code>mu.eta</code> member function is that of the base <code>poisson</code> family, hence its <code>mu</code> argument represents <code class="reqn">\mu_U</code>. 
</p>
<p><code>simulate</code>, when applied on an object with a truncated-response family, simulates the truncated family. There is currently no clean way to override this (trying to pass<code>type="link"</code> to <code>predict</code> will not have the intended effect). 
</p>


<h3>Value</h3>

<p>A <code>family</code> object suitable for use with <code>glm</code>, as <code>stats::</code> family objects.
</p>


<h3>References</h3>

<p>McCullagh, P. and Nelder, J.A. (1989) Generalized Linear Models, 2nd edition. London: Chapman &amp; Hall.
</p>
<p>Molas M. and Lesaffre E. (2010). Hurdle models for multilevel zero-inflated data via h-likelihood. Statistics in Medicine 29: 3294-3310.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("scotlip")
logLik(glm(I(1+cases)~1,family=Tpoisson(),data=scotlip))
logLik(fitme(I(1+cases)~1+(1|id),family=Tpoisson(),fixed=list(lambda=1e-8),data=scotlip))
</code></pre>


</div>