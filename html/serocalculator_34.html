<div class="container">

<table style="width: 100%;"><tr>
<td>sim.cs.multi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate multiple data sets</h2>

<h3>Description</h3>

<p>Simulate multiple data sets
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.cs.multi(
  nclus = 10,
  lambdas = c(0.05, 0.1, 0.15, 0.2, 0.3),
  num_cores = max(1, parallel::detectCores() - 1),
  rng_seed = 1234,
  renew.params = TRUE,
  add.noise = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nclus</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>#incidence rate, in events/person*year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>number of cores to use for parallel computations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rng_seed</code></td>
<td>
<p>starting seed for random number generator, passed to <code>rngtools::RNGseq()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>renew.params</code></td>
<td>
<p>whether to generate a new parameter set for each infection
</p>

<ul>
<li> <p><code>renew.params = TRUE</code> generates a new parameter set for each infection
</p>
</li>
<li> <p><code>renew.params = FALSE</code> keeps the one selected at birth, but updates baseline y0
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.noise</code></td>
<td>
<p>a <code>logical()</code> indicating whether to add biological and measurement noise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether to report verbose information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>sim.cs</code>
</p>

<dl>
<dt><code>lambda</code></dt>
<dd>
<p>a <code>numeric()</code> scalar indicating the incidence rate (in events per person-years)</p>
</dd>
<dt><code>n.smpl</code></dt>
<dd>
<p>number of samples to simulate</p>
</dd>
<dt><code>age.rng</code></dt>
<dd>
<p>age range of sampled individuals, in years</p>
</dd>
<dt><code>age.fx</code></dt>
<dd>
<p>specify the curve parameters to use by age (does nothing at present?)</p>
</dd>
<dt><code>antigen_isos</code></dt>
<dd>
<p>Character vector with one or more antibody names. Values must match <code>curve_params</code>.</p>
</dd>
<dt><code>n.mc</code></dt>
<dd>
<p>how many MCMC samples to use:
</p>

<ul>
<li>
<p> when <code>n.mc</code> is in <code>1:4000</code> a fixed posterior sample is used
</p>
</li>
<li>
<p> when <code>n.mc</code> = <code>0</code>, a random sample is chosen
</p>
</li>
</ul>
</dd>
<dt><code>noise_limits</code></dt>
<dd>
<p>biologic noise distribution parameters</p>
</dd>
<dt><code>format</code></dt>
<dd>
<p>a <code>character()</code> variable, containing either:
</p>

<ul>
<li> <p><code>"long"</code> (one measurement per row) or
</p>
</li>
<li> <p><code>"wide"</code> (one serum sample per row)
</p>
</li>
</ul>
</dd>
<dt><code>curve_params</code></dt>
<dd>
<p>a <code>data.frame()</code> containing MCMC samples of parameters from the Bayesian posterior distribution of a longitudinal decay curve model. The parameter columns must be named:
</p>

<ul>
<li> <p><code>antigen_iso</code>: a <code>character()</code> vector indicating antigen-isotype combinations
</p>
</li>
<li> <p><code>iter</code>: an <code>integer()</code> vector indicating MCMC sampling iterations
</p>
</li>
<li> <p><code>y0</code>: baseline antibody level at <code class="reqn">t=0</code> (<code class="reqn">y(t=0)</code>)
</p>
</li>
<li> <p><code>y1</code>: antibody peak level (ELISA units)
</p>
</li>
<li> <p><code>t1</code>: duration of infection
</p>
</li>
<li> <p><code>alpha</code>: antibody decay rate (1/days for the current longitudinal parameter sets)
</p>
</li>
<li> <p><code>r</code>: shape factor of antibody decay
</p>
</li>
</ul>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>tibble::tibble()</code>
</p>


</div>