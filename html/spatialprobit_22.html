<div class="container">

<table style="width: 100%;"><tr>
<td>sar_lndet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Approximation of the log determinant <code class="reqn">\ln{|I_n - \rho W|}</code> of a spatial weight matrix 
</h2>

<h3>Description</h3>

<p>Compute the log determinant <code class="reqn">\ln{|I_n - \rho W|}</code> of a 
spatial weight matrix W
using either the exact approach, or using some approximations like 
the Chebyshev log determinant approximation or Pace and Barry approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sar_lndet(ldetflag, W, rmin, rmax)
lndetfull(W, rmin, rmax)
lndetChebyshev(W, rmin, rmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ldetflag</code></td>
<td>
<p>flag to compute the exact or approximate log-determinant (Chebychev approximation, Pace and Barry approximation). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmin</code></td>
<td>
<p>minimum eigen value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>
<p>maximum eigen value</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method will no longer provide its own implementation and 
will use the already existing methods in the package <span class="pkg">spatialreg</span> (do_ldet).
</p>
<p><code>ldetflag=0</code> will compute the exact log-determinant at some gridpoints, whereas
<code>ldetflag=1</code> will compute the Chebyshev log-determinant approximation.
<code>ldetflag=2</code> will compute the Barry and Pace (1999) Monte Carlo approximation 
of the log-determinant.
</p>
<p><b>Exact log-determinant:</b><br>
The exact log determinant <code class="reqn">\ln|I_n - \rho W|</code> 
is evaluated on a grid from <code class="reqn">\rho=-1,...,+1</code>. The gridpoints
are then approximated by a spline function.
</p>
<p><b>Chebychev approximation:</b><br>
This option provides the Chebyshev log-determinant approximation as proposed 
by Pace and LeSage (2004). The implementation is faster than the full 
log-determinant method.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>detval</code></td>
<td>
<p>a 2-column <code>Matrix</code> with gridpoints for rho from <code>rmin</code>,...,<code>rmax</code> and corresponding log-determinant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>execution time</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James P. LeSage, Adapted to R by Miguel Godinho de Matos &lt;miguelgodinhomatos@cmu.edu&gt;
</p>


<h3>References</h3>

<p>Pace, R. K. and Barry, R. (1997), Quick Computation of Spatial Autoregressive Estimators, <em>Geographical Analysis</em>, <b>29</b>, 232–247
</p>
<p>R. Barry and R. K. Pace (1999) A Monte Carlo Estimator of the Log Determinant of Large Sparse Matrices, <em>Linear Algebra and its Applications</em>, <b>289</b>, 41–54.
</p>
<p>Pace, R. K. and LeSage, J. (2004), Chebyshev Approximation of log-determinants of spatial weight matrices, <em>Computational Statistics and Data Analysis</em>, <b>45</b>, 179–196.
</p>
<p>LeSage, J. and Pace, R. K. (2009), <em>Introduction to Spatial Econometrics</em>, CRC Press, chapter 4 
</p>


<h3>See Also</h3>

<p>do_ldet for computation of log-determinants
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(Matrix)

# sparse matrix representation for spatial weight matrix W (d x d) 
# and m nearest neighbors
d &lt;- 10
m &lt;- 3
W &lt;- sparseMatrix(i=rep(1:d, each=m), 
  j=replicate(d, sample(x=1:d, size=m, replace=FALSE)), x=1/m, dims=c(d, d))

# exact log determinant
ldet1 &lt;- sar_lndet(ldetflag=0, W, rmin=-1, rmax=1)

# Chebychev approximation of log determinant
ldet2 &lt;- sar_lndet(ldetflag=1, W, rmin=-1, rmax=1)

plot(ldet1$detval[,1], ldet1$detval[,2], type="l", col="black", 
  xlab="rho", ylab="ln|I_n - rho W|",
  main="Log-determinant ln|I_n - rho W| Interpolations")
lines(ldet2$detval[,1], ldet2$detval[,2], type="l", col="red")
legend("bottomleft", legend=c("Exact log-determinant", "Chebychev approximation"), 
  lty=1, lwd=1, col=c("black","red"), bty="n")

</code></pre>


</div>