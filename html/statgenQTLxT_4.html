<div class="container">

<table style="width: 100%;"><tr>
<td>EMFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor analytic variation of EM algoritm</h2>

<h3>Description</h3>

<p>Implementation of the factor analytic variation of the EM algoritm as
proposed by Dahl et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMFA(
  y,
  k,
  size_param_x = NULL,
  cmHet = TRUE,
  dmHet = TRUE,
  tolerance = 1e-06,
  maxIter = 300L,
  size_param_cmStart = NULL,
  size_param_dmStart = NULL,
  mG = 1L,
  mE = 1L,
  maxDiag = 10000,
  stopIfDecreasing = TRUE,
  traits = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An n x p matrix of observed phenotypes, on p traits or environments
for n individuals. No missing values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An n x n kinship matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_param_x</code></td>
<td>
<p>An n x c covariate matrix, c being the number of
covariates and n being the number of genotypes. c has to be at least one
(typically an intercept). No missing values are allowed. If not provided a
vector of 1s is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmHet</code></td>
<td>
<p>Should an extra diagonal part be added in the model for the
precision matrix Cm?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmHet</code></td>
<td>
<p>Should an extra diagonal part be added in the model for the
precision matrix Dm?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>A numerical value. The iterating process stops if the
difference in conditional log-likelihood between two consecutive iterations
drops below tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>A numerical value for the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_param_cmStart</code></td>
<td>
<p>A p x p matrix containing starting values for the
precision matrix Cm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_param_dmStart</code></td>
<td>
<p>A p x p matrix containing starting values for the
precision matrix Dm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mG</code></td>
<td>
<p>An integer. The order of the genetic part of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mE</code></td>
<td>
<p>An integer. The order of the environmental part of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxDiag</code></td>
<td>
<p>A numical value. The maximal value of the diagonal elements
in the precision matrices Cm and Dm (ignoring the low-rank part W W^t)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopIfDecreasing</code></td>
<td>
<p>Should the iterating process stop if after 50
iterations the log-likelihood decreases between two consecutive iterations?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components
</p>

<ul>
<li>
<p><code>Vg</code> The genetic variance components matrix.
</p>
</li>
<li>
<p><code>Ve</code> The environmental variance components matrix.
</p>
</li>
</ul>
<h3>References</h3>

<p>Dahl et al. (2013). Network inference in matrix-variate Gaussian
models with non-independent noise. arXiv preprint arXiv:1312.1622.
</p>
<p>Zhou, X. and Stephens, M. (2014). Efficient multivariate linear
mixed model algorithms for genome-wide association studies. Nature Methods,
February 2014, Vol. 11, p. 407â€“409
</p>


</div>