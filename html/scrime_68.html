<div class="container">

<table style="width: 100%;"><tr>
<td>rowChisqStats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rowwise Pearson's ChiSquare Statistic</h2>

<h3>Description</h3>

<p>Computes for each row of a matrix the value of Pearson's ChiSquare statistic
for testing if the corresponding categorical variable is associated with a (categorical)
response, or determines for each pair of rows of a matrix the value of
Pearson's ChiSquare statistic for testing if the two corresponding variables
are independent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rowChisqStats(data, cl, compPval = TRUE, asMatrix = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a numeric matrix consisting of the integers between 1 and <code class="reqn">n_{cat}</code>,
where <code class="reqn">n_{cat}</code> is the maximum number of levels the categorical variables can
take. Each row of <code>data</code> must correspond to a variable, each row to an observation.
Missing values and different numbers of levels a variable might take are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>a numeric vector of length <code>ncol(data)</code> containing the class labels for
the observations represented by the columns of <code>data</code>. The class labels must be
coded by the integers between 1 and <code class="reqn">n_{cl}</code>, where <code class="reqn">n_{cl}</code>
is the number of classes. If missing, the value of the statistic for Pearson's
<code class="reqn">\chi^2</code>-test of independence will be computed for each pair of rows
of <code>data</code>. Otherwise, the value of Pearson's <code class="reqn">\chi^2</code>-statistic
for testing if the distribution of the variable differs between the groups specified
by <code>cl</code> will be determined for each row of <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compPval</code></td>
<td>
<p>should also the p-value (based on the approximation to a 
<code class="reqn">\chi^2</code>-distribution) be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asMatrix</code></td>
<td>
<p>should the pairwise test scores be returned as matrix? Ignored
if <code>cl</code> is specified. If <code>TRUE</code>,
a matrix with <code class="reqn">m</code> rows and columns is returned that contains the values
of Pearson's <code class="reqn">\chi^2</code>-statistic in its lower triangle, where <code class="reqn">m</code>
is the number of variables. If <code>FALSE</code>,
a vector of length <code class="reqn">m * (m - 1) / 2</code> is returned, where the value for
testing the <code class="reqn">i</code>th and <code class="reqn">j</code>th variable is given by the
<code class="reqn">j + m * (i - 1) - i * (i - 1) / 2</code> element of this vector.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>compPval = FALSE</code>, a vector (or matrix if <code>cl</code> is not specified and
<code>as.matrix = TRUE</code>) composed of the values of Pearson's <code class="reqn">\chi^2</code>-statistic.
Otherwise, a list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>a vector (or matrix) containing the values of Pearson's <code class="reqn">\chi^2</code>-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a vector (or matrix) comprising the degrees of freedom of the asymptotic
<code class="reqn">\chi^2</code>-distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rawp</code></td>
<td>
<p>a vector (or matrix) containing the (unadjusted) p-values.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Contrary to <code>chisq.test</code>, currently no continuity correction is done 
for 2 x 2 tables.
</p>


<h3>Author(s)</h3>

<p>Holger Schwender, <a href="mailto:holger.schwender@udo.edu">holger.schwender@udo.edu</a></p>


<h3>References</h3>

<p>Schwender, H.\ (2007). A Note on the Simultaneous Computation of Thousands of 
Pearson's <code class="reqn">\chi^2</code>-Statistics. <em>Technical Report</em>, SFB 475,
Deparment of Statistics, University of Dortmund. 
</p>


<h3>See Also</h3>

<p><code>computeContCells</code>, <code>computeContClass</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Generate an example data set consisting of 5 rows (variables)
# and 200 columns (observations) by randomly drawing integers 
# between 1 and 3.

mat &lt;- matrix(sample(3, 1000, TRUE), 5)
rownames(mat) &lt;- paste("SNP", 1:5, sep = "")

# For each pair of rows of mat, test if they are independent.

r1 &lt;- rowChisqStats(mat)

# The values of Pearson's ChiSquare statistic as matrix.

r1$stats

# And the corresponding (unadjusted) p-values.

r1$rawp

# Obtain only the values of the test statistic as vector

rowChisqStats(mat, compPval = FALSE, asMatrix =FALSE)


# Generate an example data set consisting of 10 rows (variables)
# and 200 columns (observations) by randomly drawing integers 
# between 1 and 3, and a vector of class labels of length 200
# indicating that the first 100 observation belong to class 1
# and the other 100 to class 2. 

mat2 &lt;- matrix(sample(3, 2000, TRUE), 10)
cl &lt;- rep(1:2, e = 100)

# For each row of mat2, test if they are associated with cl.

r2 &lt;- rowChisqStats(mat2, cl)
r2$stats

# And the results are identical to the one of chisq.test
pv &lt;- stat &lt;- numeric(10)
for(i in 1:10){
    tmp &lt;- chisq.test(mat2[i,], cl)
    pv[i] &lt;- tmp$p.value
    stat[i] &lt;- tmp$stat
}

all.equal(r2$stats, stat)
all.equal(r2$rawp, pv)


## End(Not run)</code></pre>


</div>