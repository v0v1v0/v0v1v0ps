<div class="container">

<table style="width: 100%;"><tr>
<td>twoACpwr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exact Power Computation for the 2-AC Discrimination Protocol</h2>

<h3>Description</h3>

<p>Computes the exact power for the 2-AC protocol using the (signed)
likelihood root statistic. Power is computed for a significance test
of d-prime. The <code>tol</code> argument specifies the
precision with which power should be computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
twoACpwr(tau, d.prime, size, d.prime0 = 0, alpha = 0.05, tol = 1e-5, 
         return.dist = FALSE, statistic = "likelihood",
         alternative = c("two.sided", "less", "greater"))

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the value of tau under the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.prime</code></td>
<td>
<p>the value of d.prime under the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.prime0</code></td>
<td>
<p>the value of d-prime under the null hypothesis in the
significance test for which power should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the size of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>specifies the precision with which power should be
computed, e.g., <code>1e-4</code> cause power to be computed correctly to
three significant digits. Lower values of <code>tau</code> gives higher
precision, but also longer computation times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.dist</code></td>
<td>
<p>should the p-value distribution be returned rather
than the power be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the statistic used in the significance test for which
the power should be computed. Currently only the (signed) likelihood
root statistic is availableâ€”se the details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the type of alternative hypothesis in the
significance test for which the power should be computed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main idea in this function is to compute all possible data
outcomes and then compute the p-value for the chosen significance test
for each of these outcomes. This gives the exact distribution of
p-values from which the exact power can be computed. This is basically
what happens if <code>tol = 0</code>.
</p>
<p>There is, however, a problem with this approach if <code>size</code> is
large, since the the number of possible outcomes increases very fast
with the <code>size</code>; the order is O(<code>n^2</code>). The solution to this
problem is to ignore those outcomes which will occur with very small
probability. Often, a large proportion of the outcomes, say 90% will
occur so rarely that they account for, say <code>1e-4</code> percent of the
probability mass; it is therefore safe to ignore those outcomes
without compromising the accuracy of the computed power by any
relevant amount. For more information see the referenced paper and the
package vignette Statistical Methodology. 
</p>
<p>The Wald statistic is not available here. The reason is that the Wald
statistic is not always defined and the problem is therefore what to
do with those cases where it is not defined?
On the other hand the likelihood root statistic
is defined in all cases, so theres is no problem here, and since the
likelihood root statistic is more accurate than the Wald statistic,
there is not much reason to use the Wald statistic after all.
</p>
<p>For the record; the Wald statistic is not defined, when the standard
error of d-prime is not defined. This happens when the
variance-covariance matrix of tau and d-prime is not defined, which
occurs in a number of boundary cases, i.e., when one or more cells
contain zero frequencies. Since these outcomes occur with positive
probability, the algorithm used by <code>twoACpwr</code> will always
encounter those cases and have to deal with them. This would be
cumbersome to implement.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with one line and the following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the computed power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actual.alpha</code></td>
<td>
<p>the actual size of the test (different from the
nominal alpha given as argument due to the discreteness of the
observations). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>the number of possible outcomes for this <code>size</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discarded</code></td>
<td>
<p>the number of outcomes for which the p-value is not
computed. This number is zero if <code>tol = 0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kept</code></td>
<td>
<p>the number of outcomes for which the p-value is computed
in. This number equals <code>samples</code> if <code>tol = 0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the probability vector of the multinomial distribution
implied by the values of <code>tau</code> and <code>d.prime</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rune Haubo B Christensen</p>


<h3>References</h3>

<p>Christensen R.H.B., Lee H-S and Brockhoff P.B. (2012). Estimation of
the Thurstonian model for the 2-AC protocol. Food Quality
and Preference, 24(1), pp.119-128.
</p>


<h3>See Also</h3>

<p><code>clm2twoAC</code>, <code>twoACpwr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Exact power: 
twoACpwr(tau = .5, d.prime = .7, size = 50, tol = 0)

## Power exact to a reasonable number of digits
twoACpwr(tau = .5, d.prime = .7, size = 50, tol = 1e-5)

## Power for a similarity test in a discrimination setting where the
## true parameter values are expected to be tau = 0.4 and true d.prime
## = .5, while we want to show that d.prime &lt; 1, i.e., under the null
## hypothesis d.prime = 1:
twoACpwr(tau = .4, d.prime = .5, size = 100, d.prime0 = 1, tol = 1e-5, 
         alternative = "less")

## Power for a difference test in a preference setting where the true
## parameter values are expected to be tau = 0.4 and d.prime = -0.5,
## while we want to show that d.prime is different from zero:
twoACpwr(tau = 0.4, d.prime = -0.5, size = 100, d.prime0 = 0, tol = 1e-5, 
         alternative = "two.sided")

</code></pre>


</div>