<div class="container">

<table style="width: 100%;"><tr>
<td>getAIC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Akaike's Information Criterion for SURFACE Models
</h2>

<h3>Description</h3>

<p>Calculates AICc for a Hansen model using combined likelihoods across multiple traits
</p>


<h3>Usage</h3>

<pre><code class="language-R">getAIC(L, np, n, AICc = TRUE)
npSurface(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>Fitted Hansen model object (the list returned by one iteration of <code>surfaceForward</code> or <code>surfaceBackward</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>

<p>Log-likelihood of the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>

<p>Number of parameters in the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Sample size (total number of trait values)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc</code></td>
<td>

<p>A logical indicating whether to use small-sample size corrected AIC; defaults to <code>TRUE</code>, and is currently set to <code>TRUE</code> during all calls within the <code>surface</code> functions
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The number of parameters is calculated as p = k + (k' + 2) m, where k is the number of regime shifts, k' is the number of distinct regimes, and m is the number of traits. Note that this differs from many applications of Hansen models, in that SURFACE counts regime shifts as "parameters", modeling the complexity of both the adaptive landscape (number of regimes) and the evolutionary history of the clade (number of regime shifts). For AICc, the sample size is taken to be the total number of trait values mn, where n is the number of taxa
</p>


<h3>Value</h3>

<p><code>npSurface</code> returns an integer number of parameters. <code>getAIC</code> returns a numeric AIC or AICc value
</p>


<h3>Author(s)</h3>

<p>Travis Ingram
</p>


<h3>References</h3>

<p>Ingram, T. &amp; Mahler, D.L. (2013) SURFACE: detecting convergent evolution from comparative data by fitting Ornstein-Uhlenbeck models with stepwise AIC. Methods in Ecology and Evolution 4: 416-425. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(surfaceDemo)
tree&lt;-surfaceDemo$tree
dat&lt;-surfaceDemo$sim$dat
olist&lt;-convertTreeData(tree,dat)
otree&lt;-olist[[1]]; odata&lt;-olist[[2]]
startmod&lt;-startingModel(otree, odata, shifts = c("6"="b")) 
np&lt;-as.numeric(npSurface(startmod[[1]]))
LnL&lt;-sum(sapply(startmod[[1]]$fit, function(x) summary(x)$loglik))
getAIC(LnL,np,n=ncol(dat)*nrow(dat),AICc=TRUE)
</code></pre>


</div>