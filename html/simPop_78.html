<div class="container">

<table style="width: 100%;"><tr>
<td>simCategorical</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate categorical variables of population data</h2>

<h3>Description</h3>

<p>Simulate categorical variables of population data. The household structure
of the population data needs to be simulated beforehand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simCategorical(
  simPopObj,
  additional,
  method = c("multinom", "distribution", "ctree", "cforest", "ranger", "xgboost"),
  limit = NULL,
  censor = NULL,
  maxit = 500,
  MaxNWts = 1500,
  eps = NULL,
  nr_cpus = NULL,
  regModel = NULL,
  seed = 1,
  verbose = FALSE,
  by = "strata",
  model_params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>simPopObj</code></td>
<td>
<p>a <code>simPopObj</code> containing population and household
survey data as well as optionally margins in standardized format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional</code></td>
<td>
<p>a character vector specifying additional categorical
variables available in the sample object of <code>simPopObj</code> that should be
simulated for the population data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the method to be used for
simulating the additional categorical variables. Accepted values are
<code>"multinom"</code> (estimation of the conditional probabilities using
multinomial log-linear models and random draws from the resulting
distributions) or <code>"distribution"</code> (random draws from the observed
conditional distributions of their multivariate realizations).
<code>"ctree"</code>  for using Classification trees
<code>"cforest"</code>  for using random forest (implementation in package party)
<code>"ranger"</code>  for using random forest (implementation in package ranger)
<code>"xgboost"</code>  for using xgboost (implementation in package xgboost)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>if <code>method</code> is <code>"multinom"</code>, this can be used to
account for structural zeros. If only one additional variable is requested,
a named list of lists should be supplied. The names of the list components
specify the predictor variables for which to limit the possible outcomes of
the response. For each predictor, a list containing the possible outcomes of
the response for each category of the predictor can be supplied. The
probabilities of other outcomes conditional on combinations that contain the
specified categories of the supplied predictors are set to 0. If more than
one additional variable is requested, such a list of lists can be supplied
for each variable as a component of yet another list, with the component
names specifying the respective variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>if <code>method</code> is <code>"multinom"</code>, this can be used to
account for structural zeros. If only one additional variable is requested,
a named list of lists or <code>data.frame</code>s should be supplied. The names of
the list components specify the categories that should be censored. For each
of these categories, a list or <code>data.frame</code> containing levels of the
predictor variables can be supplied. The probability of the specified
categories is set to 0 for the respective predictor levels. If more than one
additional variable is requested, such a list of lists or <code>data.frame</code>s
can be supplied for each variable as a component of yet another list, with
the component names specifying the respective variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit, MaxNWts</code></td>
<td>
<p>control parameters to be passed to
<code>multinom</code> and <code>nnet</code>. See the help file
for <code>nnet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a small positive numeric value, or <code>NULL</code> (the default). In
the former case and if <code>method</code> is <code>"multinom"</code>, estimated
probabilities smaller than this are assumed to result from structural zeros
and are set to exactly 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_cpus</code></td>
<td>
<p>if specified, an integer number defining the number of cpus
that should be used for parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regModel</code></td>
<td>
<p>allows to specify the variables or model that is used when
simulating additional categorical variables. The following choices are
available if different from NULL.  </p>
 <ul>
<li>
<p>'basic'only the basic
household variables (generated with <code>simStructure</code>) are used.
</p>
</li>
<li>
<p>'available'all available variables (that are common in the sample and
the synthetic population such as previously generated varaibles) excluding
id-variables, strata variables and household sizes are used for the
modelling. This parameter should be used with care because all factors are
automatically used as factors internally.  </p>
</li>
<li>
<p> formula-objectUsers may also
specify a specifiy formula (class 'formula') that will be used. Checks are
performed that all required variables are available.  </p>
</li>
</ul>
<p> If method
'distribution' is used, it is only possible to specify a vector of length
one containing one of the choices described above.  If parameter 'regModel'
is NULL, only basic household variables are used in any case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional; an integer value to be used as the seed of the random
number generator, or an integer vector containing the state of the random
number generator to be restored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>set to TRUE if additional print output should be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>defining which variable to use as split up variable of the estimation. Defaults to the strata variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_params</code></td>
<td>
<p>NULL or a named list which can contain model specific parameters which will be passed onto the function call for the respective model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The number of cpus are selected automatically in the following manner. The
number of cpus is equal the number of strata. However, if the number of cpus
is less than the number of strata, the number of cpus - 1 is used by
default. This should be the best strategy, but the user can also overwrite
this decision.
</p>


<h3>Value</h3>

<p>An object of class <code>simPopObj</code> containing survey
data as well as the simulated population data including the categorical
variables specified by argument <code>additional</code>.
</p>


<h3>Note</h3>

<p>The basic household structure needs to be simulated beforehand with
the function <code>simStructure</code>.
</p>


<h3>Author(s)</h3>

<p>Bernhard Meindl, Andreas Alfons, Stefan Kraft, Alexander Kowarik, Matthias Templ, Siro Fritzmann
</p>


<h3>References</h3>

<p>B. Meindl, M. Templ, A. Kowarik, O. Dupriez (2017) Simulation of Synthetic Populations for Survey Data Considering Auxiliary
Information. <em>Journal of Statistical Survey</em>, <strong>79</strong> (10), 1–38. <a href="https://doi.org/10.18637/jss.v079.i10">doi:10.18637/jss.v079.i10</a>
</p>
<p>A. Alfons, M. Templ (2011) Simulation of close-to-reality population data for household surveys with application to EU-SILC.
<em>Statistical Methods &amp; Applications</em>, <strong>20</strong> (3), 383–407. <a href="https://doi.org/10.1080/02664763.2013.859237">doi:10.1080/02664763.2013.859237</a>
</p>


<h3>See Also</h3>

<p><code>simStructure</code>, <code>simRelation</code>,
<code>simContinuous</code>, <code>simComponents</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(eusilcS) # load sample data
## Not run: 
## approx. 20 seconds computation time
inp &lt;- specifyInput(data=eusilcS, hhid="db030", hhsize="hsize", strata="db040", weight="db090")
## in the following, nr_cpus are selected automatically
simPop &lt;- simStructure(data=inp, method="direct", basicHHvars=c("age", "rb090"))
simPop &lt;- simCategorical(simPop, additional=c("pl030", "pb220a"), method="multinom", nr_cpus=1)
simPop

## End(Not run)
</code></pre>


</div>