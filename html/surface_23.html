<div class="container">

<table style="width: 100%;"><tr>
<td>surfaceTreePlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Visualize Results of a SURFACE Analysis
</h2>

<h3>Description</h3>

<p>Plotting functions to visualize the results of a SURFACE analysis, with colors depicting regime structure: <code>surfaceTreePlot</code> produces a customized <code>plot.phylo</code> figure, and <code>surfaceTraitPlot</code> produces a scatterplot of trait values and optima
</p>


<h3>Usage</h3>

<pre><code class="language-R">surfaceTreePlot(tree, hansenfit, cols = NULL, convcol = TRUE, labelshifts = FALSE, ...)
surfaceTraitPlot(dat, hansenfit, whattraits = c(1, 2), cols = NULL, 
convcol = TRUE, pchs = c(21, 21), cex.opt = 2.5, optellipses = FALSE, 
ellipsescale = 1, flatten1D = FALSE, add = FALSE, ypos = 0,
 plotoptima = TRUE, plottraits = TRUE, y.lim = NULL, x.lim = NULL, 
y.lab = NULL, x.lab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>Phylogenetic tree in <code>phylo</code> format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Trait data formatted as a data frame with named rows and at least two columns
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hansenfit</code></td>
<td>

<p>An object containing the fitted Hansen model to use in plotting, with elements <code>fit</code> and <code>savedshifts</code>. This may be the list produced by any one iteration of <code>surfaceForward</code> or <code>surfaceBackward</code>, or the list produced by <code>surfaceSimulate</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whattraits</code></td>
<td>

<p>A two-element integer (or a single integer; see Details) indicating which traits to use for the (x,y) axes of a trait plot (defaults to <code>c(1,2)</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>

<p>An optional character vector of colors for painting branches in <code>surfaceTreePlot</code> or coloring symbols in <code>surfaceTraitPlot</code>. One color should be provided per regime in <code>hansenfit</code>; if <code>cols=NULL</code> the function will attempt an appropriate default 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convcol</code></td>
<td>

<p>A logical indicating whether to select separate colors for convergent (colorful) and non-convergent (greyscale) regimes (defaults to <code>TRUE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelshifts</code></td>
<td>

<p>A logical indicating whether to add integer labels to branches in the tree to show the order in which regime shifts were added in the forward phase (defaults to <code>FALSE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchs</code></td>
<td>

<p>Vector with two integers representing the plotting characters to use for trait values and optima, respectively, in <code>surfaceTraitPlot</code>; both default to 21 (filled circles) 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.opt</code></td>
<td>

<p>Character expansion for symbols representing the optima in <code>surfaceTraitPlot</code>; defaults to 2.5 (symbols representing data points can be specified with <code>cex</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optellipses</code></td>
<td>

<p>A logical indicating whether to draw ellipses based on the fitted OU model instead of denoting optimum positions with <code>pchs</code> and <code>cex.opt</code>. The ellipses are drawn as the optima +/- the standard deviation of the stationary distribution of the inferred OU process: sigma_squared/(2*alpha), multiplied by <code>ellipsescale</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipsescale</code></td>
<td>

<p>A scalar or vector indicating how many standard deviations to draw ellipses above and below the optima; if a vector, concentric ellipses of various sizes will be drawn; defaults to 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flatten1D</code></td>
<td>

<p>A logical indicating whether all regimes should be placed on a single line when <code>surfaceTraitPlot</code> is called for a single trait; defaults to <code>FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>A logical indicating whether to add a new element to an existing <code>surfaceTraitPlot</code> graph instead of creating a new one; defaults to <code>FALSE</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypos</code></td>
<td>

<p>Position on the y axis to place the traits and optima on; only applies if a single trait is used and <code>flatten1D = TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotoptima</code></td>
<td>

<p>A logical indicating whether the optima should be displayed in <code>surfaceTraitPlot</code>; defaults to <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottraits</code></td>
<td>

<p>A logical indicating whether the trait values should be displayed in <code>surfaceTraitPlot</code>; defaults to <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.lim</code></td>
<td>

<p>Lower and upper limits for the y-axis; by default will be calculated to fit all points and ellipses fit in the frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lim</code></td>
<td>

<p>Lower and upper limits for the x-axis; by default will be calculated to fit all points and ellipses fit in the frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.lab</code></td>
<td>

<p>y-axis label; defaults to the column name in the data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lab</code></td>
<td>

<p>x-axis label; defaults to the column name in the data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to the <code>plot</code> or <code>points</code> functions
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For trait plots using the option <code>optellipses=TRUE</code>, note that in some cases (e.g. if alpha is very small) the ellipses will not convey useful information. If trait data are unidimensional, or if <code>whattraits</code> is provided as a single integer, data will be plotted on the x-axis and the y-axis will separate different regimes (and ellipse width in the y-dimension will not be meaningful)
</p>


<h3>Value</h3>

<p>Creates one tree or trait plot on the current graphics device
</p>


<h3>Author(s)</h3>

<p>Travis Ingram
</p>


<h3>References</h3>

<p>Ingram, T. &amp; Mahler, D.L. (2013) SURFACE: detecting convergent evolution from comparative data by fitting Ornstein-Uhlenbeck models with stepwise AIC. Methods in Ecology and Evolution 4: 416-425. 
</p>
<p>Mahler, D.L., Ingram, T., Revell, L.J. &amp; Losos, J.B. (2013) Exceptional convergence on the macroevolutionary landscape in island lizard radiations. Science 341: 292-295.
</p>


<h3>See Also</h3>

<p><code>surfaceForward</code>, <code>surfaceBackward</code>, <code>surfaceSimulate</code>, <code>surfaceSummary</code>, <code>surfaceAICPlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(surfaceDemo)
tree&lt;-surfaceDemo$tree
dat&lt;-surfaceDemo$sim$dat
olist&lt;-convertTreeData(tree,dat)
otree&lt;-olist[[1]]; odata&lt;-olist[[2]]
startmod&lt;-startingModel(otree, odata, shifts = c("6"="b")) 
surfaceTreePlot(tree,startmod[[1]],labelshifts=TRUE,cols=c("black","red"))
surfaceTraitPlot(dat,startmod[[1]],whattraits=c(1,2),cols=c("black","red"))
</code></pre>


</div>