<div class="container">

<table style="width: 100%;"><tr>
<td>ppeak</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cumulative distribution function of number of peaks in an i.i.d. random sequence</h2>

<h3>Description</h3>

<p>This function computes <code class="reqn">\sum_{k} P(n,k)</code>, i.e. the probability that a
sequence of <code class="reqn">n</code> independent and identically distributed random variables
contains <code class="reqn">\ge k</code> <code class="reqn">(\le k)</code> peaks, with peaks as defined in
Goldfeld and Quandt (1965). The function may be used to
compute <code class="reqn">p</code>-values for the Goldfeld-Quandt nonparametric test for
heteroskedasticity in a linear model. Computation time is very slow for
<code class="reqn">n &gt; 170</code> if <code>usedata</code> is set to <code>FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppeak(k, n, lower.tail = FALSE, usedata = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer or a sequence of integers strictly incrementing by 1,
with all values between 0 and <code>n - 1</code> inclusive. Represents the
number of peaks in the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer representing the number of observations in the
sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>A logical. Should lower tailed cumulative probability be
calculated? Defaults to <code>FALSE</code> due to function being designed
primarily for calculating <code class="reqn">p</code>-values for the peaks test, which is
by default an upper-tailed test. Note that both upper and lower tailed
cumulative probabilities are computed inclusive of <code>k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usedata</code></td>
<td>
<p>A logical. Should probability mass function values be
read from <code>dpeakdat</code> rather than computing them from
<code>dpeak</code>? This option will save significantly on
computation time if <code class="reqn">n &lt; 170</code> but is currently only available
for <code class="reqn">n \le 1000</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A double between 0 and 1 representing the probability of at least
(at most) k peaks occurring in a sequence of <code class="reqn">n</code> independent and
identically distributed continuous random variables. The double has a
<code>names</code> attribute with the values corresponding to the
probabilities.
</p>


<h3>References</h3>

<p>Goldfeld SM, Quandt RE (1965).
“Some Tests for Homoscedasticity.”
<em>Journal of the American Statistical Association</em>, <b>60</b>(310), 539–547.
</p>


<h3>See Also</h3>

<p><code>dpeak</code>, <code>goldfeld_quandt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For an independent sample of size 250, the probability of at least 10
# peaks is 0.02650008
ppeak(k = 10, n = 250, lower.tail = FALSE, usedata = TRUE)
# For an independent sample of size 10, the probability of at most 2 peaks
# is 0.7060615
ppeak(k = 2, n = 10, lower.tail = TRUE, usedata = FALSE)

</code></pre>


</div>