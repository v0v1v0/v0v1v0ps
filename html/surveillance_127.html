<div class="container">

<table style="width: 100%;"><tr>
<td>epidataCS_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting the Events of an Epidemic over Time and Space
</h2>

<h3>Description</h3>

<p>The <code>plot</code> method for class <code>"epidataCS"</code> either plots the
number of events along the time axis (<code>epidataCSplot_time</code>) as a
<code>hist()</code>, or the locations of the events in the observation region
<code>W</code> (<code>epidataCSplot_space</code>).
The spatial plot can be enriched with tile-specific color levels to
indicate attributes such as the population (using <code>spplot</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'epidataCS'
plot(x, aggregate = c("time", "space"), subset, by = type, ...)

epidataCSplot_time(x, subset, by = type,
                   t0.Date = NULL, breaks = "stgrid", freq = TRUE,
                   col = rainbow(nTypes), cumulative = list(),
                   add = FALSE, mar = NULL, xlim = NULL, ylim = NULL,
                   xlab = "Time", ylab = NULL, main = NULL,
                   panel.first = abline(h=axTicks(2), lty=2, col="grey"),
                   legend.types = list(), ...)

epidataCSplot_space(x, subset, by = type, tiles = x$W, pop = NULL,
                    cex.fun = sqrt, points.args = list(), add = FALSE,
                    legend.types = list(), legend.counts = list(),
                    sp.layout = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>"epidataCS"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate</code></td>
<td>

<p>character, one of <code>"time"</code> and <code>"space"</code>, referring to the
specific plot functions <code>epidataCSplot_time</code> and
<code>epidataCSplot_time</code>, respectively.
For <code>"time"</code>, the number of events over time is plotted as
<code>hist</code> (or <code>hist.Date</code>).
For <code>"space"</code>, the observation region <code>x$W</code> (or the
<code>tiles</code>) and the locations of the events therein are plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>logical expression indicating a subset of events to consider for
plotting: missing values are taken as false. Note that the
expression is evaluated in the data frame of event marks
(<code>marks(x)</code>), which means that column names can be referred to
by name (like in <code>subset.data.frame</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>in the basic <code>plot</code>-method further arguments are passed to the
<code>aggregate</code>-specific plot function.
In <code>epidataCSplot_time</code>, further graphical parameters are
passed to <code>hist</code> or <code>hist.Date</code>,
respectively. In <code>epidataCSplot_space</code>, further arguments are
passed to the <code>plot</code>-method for
<code>"SpatialPolygons"</code>, which draws <code>tiles</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>an expression evaluated in <code>marks(x)</code>, defining how
events should be stratified in the plot (the result is converted to
a factor), or <code>NULL</code> to disregard event types.
By default (<code>by = type</code>) the plot distinguishes between event
types, i.e., the bars of the temporal plot are stacked by type, and
the point colors in the spatial plot differ by type, respectively.<br>
Note: to select specific event types for plotting use the
<code>subset</code> argument, e.g., <code>subset=(type=="B")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0.Date</code></td>
<td>
<p>the beginning of the observation period
<code>t0 = x$stgrid$start[1]</code> as a <code>"Date"</code> (or
anything coercible by <code>as.Date</code> without further arguments),
enabling a nice x-axis using <code>hist.Date</code> and sensible
<code>breaks</code> of the histogram, e.g., <code>breaks="months"</code>.
The event times then equal
<code>t0.Date + as.integer(x$events$time - t0)</code>, i.e. possible
fractional parts of the event times are removed (which ensures that
using <code>breaks = "months"</code> or other automatic types always
works).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>a specification of the histogram break points, see
<code>hist</code> (or <code>hist.Date</code> if <code>t0.Date</code> is
used). The default value <code>"stgrid"</code> is special and means to use
the temporal grid points
<code>with(x$stgrid, c(start[1L], unique.default(stop)))</code>
as breaks (or their <code>"Date"</code> equivalents).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>see <code>hist</code>, defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>fill colour for the bars of the histogram, defaults to
the vector of <code>rainbow</code> colours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulative</code></td>
<td>
<p>if a list (of style options),
lines for the cumulative number of events (per type) will be
added to the plot. Possible options are <code>axis</code> (logical),
<code>lab</code> (axis label), <code>maxat</code> (single integer affecting
the axis range), <code>lwd</code>, <code>col</code>, and <code>offset</code> (a
numeric vector of length the number of types).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical (default: <code>FALSE</code>) indicating if the plot
should be added to an existing window.
Ignored if an <code>spplot</code> is created (if <code>pop</code> is
non-<code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>see <code>par</code>. The default (<code>NULL</code>) is
<code>mar &lt;- par("mar")</code>, with <code>mar[4] &lt;- mar[2]</code> if an
axis is requested for the <code>cumulative</code> numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim,ylim</code></td>
<td>
<p><code>NULL</code> provides automatic axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>axis labels (with sensible defaults).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title of the plot (defaults to no title).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel.first</code></td>
<td>
<p>expression that should be evaluated after the
plotting window has been set up but before the histogram is plotted.
Defaults to adding horizontal grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.types</code></td>
<td>
<p>if a list (of arguments for <code>legend</code>),
a legend for the event types is added to the plot in case there is
more than one type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tiles</code></td>
<td>
<p>the observation region <code>x$W</code> (default) or,
alternatively, a <code>"SpatialPolygons"</code>
representation of the tiles of <code>x$stgrid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>if <code>tiles</code> is a
<code>"SpatialPolygonsDataFrame"</code>, <code>pop</code> can
specify an attribute to be displayed in a <code>levelplot</code> behind the
point pattern, see <code>spplot</code>. By default (<code>NULL</code>),
the conventional graphics system is used to display the <code>tiles</code>
and event locations, otherwise the result is a
<code>trellis.object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.fun</code></td>
<td>
<p>function which takes a vector of counts of events
at each unique location and returns a (vector of) <code>cex</code>
value(s) for the sizes of the corresponding <code>points</code>.
Defaults to the <code>sqrt()</code> function, which for the default
circular <code>pch=1</code> means that the area of each point is
proportional to the number of events at its location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.args</code></td>
<td>
<p>a list of (type-specific) graphical parameters
for <code>points</code>, specifically <code>pch</code>, <code>lwd</code>,
and <code>col</code>, which are all recycled to give the length
<code>nlevels(x$events$type)</code>. In contrast, a possible
<code>cex</code> element should be scalar (default: 0.5) and 
multiplies the sizes obtained from <code>cex.fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.counts</code></td>
<td>
<p>if a list (of arguments for
<code>legend</code>), a legend illustrating the effect of 
<code>cex.fun</code> is added to the plot. This list may contain a
special element <code>counts</code>, which is an integer vector
specifying the counts to illustrate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.layout</code></td>
<td>
<p>optional list of additional layout items in case
<code>pop</code> is non-<code>NULL</code>, see <code>spplot</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>aggregate="time"</code> (i.e., <code>epidataCSplot_time</code>) the data
of the histogram (as returned by <code>hist</code>),
and for <code>aggregate="space"</code> (i.e., <code>epidataCSplot_space</code>)
<code>NULL</code>, invisibly, or the <code>trellis.object</code> generated by
<code>spplot</code> (if <code>pop</code> is non-<code>NULL</code>).
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>See Also</h3>

<p><code>animate.epidataCS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("imdepi")

## show the occurrence of events along time
plot(imdepi, "time", main = "Histogram of event time points")
plot(imdepi, "time", by = NULL, main = "Aggregated over both event types")

## show the distribution in space
plot(imdepi, "space", lwd = 2, col = "lavender")

## with the district-specific population density in the background,
## a scale bar, and customized point style
load(system.file("shapes", "districtsD.RData", package = "surveillance"))
districtsD$log10popdens &lt;- log10(districtsD$POPULATION/districtsD$AREA)
keylabels &lt;- (c(1,2,5) * rep(10^(1:3), each=3))[-1]
plot(imdepi, "space", tiles = districtsD, pop = "log10popdens",
     ## modify point style for better visibility on gray background
     points.args = list(pch=c(1,3), col=c("orangered","blue"), lwd=2),
     ## metric scale bar, see proj4string(imdepi$W)
     sp.layout = layout.scalebar(imdepi$W, scale=100, labels=c("0","100 km")),
     ## gray scale for the population density and white borders
     col.regions = gray.colors(100, start=0.9, end=0.1), col = "white",
     ## color key is equidistant on log10(popdens) scale
     at = seq(1.3, 3.7, by=0.05),
     colorkey = list(labels=list(at=log10(keylabels), labels=keylabels),
                     title=expression("Population density per " * km^2)))
</code></pre>


</div>