<div class="container">

<table style="width: 100%;"><tr>
<td>BVCfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a Semi-parametric Bayesian variable selection</h2>

<h3>Description</h3>

<p>fit a Bayesian semi-parametric model for both linear and non-linear G×E interactions. Users can also specify all the interactions as linear and fit a Bayesian LASSO type of model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BVCfit(
  X,
  Y,
  Z,
  E = NULL,
  clin = NULL,
  iterations = 10000,
  burn.in = NULL,
  sparse = TRUE,
  structural = TRUE,
  VC = TRUE,
  kn = 2,
  degree = 2,
  hyper = NULL,
  debugging = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of predictors (genetic factors) without intercept. Each row should be an observation vector. A column of 1 will be added to the X matrix
as the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the response variable. The current version of BVCfit only supports continuous response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>a vector of environmental factor for non-linear G×E interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>a vector of environmental factor for linear G×E interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clin</code></td>
<td>
<p>a matrix of clinical variables. Clinical variables are not subject to penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>the number of iterations for burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly. 'sparse' has effect only when VC=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structural</code></td>
<td>
<p>logical flag. If TRUE, the coefficient functions with varying effects and constant effects will be penalized separately. 'structural' has effect only when VC=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VC</code></td>
<td>
<p>logical flag. If TRUE, varying coefficient functions will be used for modeling the interactions between Z and X.
If FALSE, interactions between Z and X will be modeled as linear interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>
<p>the number of interior knots for B-spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>a named list of hyperparameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debugging</code></td>
<td>
<p>logical flag. If TRUE, progress will be output to the console and extra information will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, varying coefficient functions are used for modeling the nonlinear interactions between Z and X. Assuming both E and clin are NULL, the model can be expressed as
</p>
<p style="text-align: center;"><code class="reqn">Y = \beta_{0}(Z)+\sum\beta_{j}(Z)X_{j} + \epsilon </code>
</p>

<p>The basis expansion and changing of basis with B splines will be done automatically:
</p>
<p style="text-align: center;"><code class="reqn">\beta_{j}(\cdot)\approx \gamma_{j1} + \sum_{k=2}^{q}{B}_{jk}(\cdot)\gamma_{jk}</code>
</p>

<p>where <code class="reqn">B_{jk}(\cdot)</code> represents B spline basis. <code class="reqn">\gamma_{j1}</code> and <code class="reqn">(\gamma_{j2}, \ldots, \gamma_{jq})^\top</code> correspond to the constant and varying parts of the coefficient functional, respectively.
q=kn+degree+1 is the number of basis functions. By default, kn=degree=2. User can change the values of kn and degree to any other positive integers.
If E is provided, the linear interactions between E and X will be added modeled as pairwise-products:
</p>
<p style="text-align: center;"><code class="reqn">Y = \beta_{0}(Z)+\sum\beta_{j}(Z)X_{j} + \zeta_{0}E + \sum \zeta_{j}EX_{j} + \epsilon</code>
</p>

<p>If clin is provided, clinical variables
will be added to the model.
</p>
<p>If VC=FALSE, all interactions are treated as linear and a Bayesian LASSO model will be used. With non-null values of E and clin, the full linear model is:
</p>
<p style="text-align: center;"><code class="reqn">Y \sim Z + ZX + clin + E + EX</code>
</p>

<p>Please check the references for more details about the model.
</p>
<p>Users can modify the hyper-parameters by providing a named list of hyper-parameters via the argument 'hyper'.
The list can have the following named components
</p>

<ul>
<li>
<p> a.c, a.v, a.e: shape parameters of the Gamma priors on <code class="reqn">\lambda_{c}</code>, <code class="reqn">\lambda_{v}</code> and <code class="reqn">\lambda_{e}</code>, respectively.
</p>
</li>
<li>
<p> b.c, b.v, b.e: rate parameters of the Gamma priors on <code class="reqn">\lambda_{c}</code>, <code class="reqn">\lambda_{v}</code> and <code class="reqn">\lambda_{e}</code>, respectively.
</p>
</li>
<li>
<p> r.c, r.v, r.e: shape parameters of the Beta priors (<code class="reqn">\pi^{r-1}(1-\pi)^{w-1}</code>) on <code class="reqn">\pi_{c}</code>, <code class="reqn">\pi_{v}</code> and <code class="reqn">\pi_{e}</code>, respectively.
</p>
</li>
<li>
<p> w.c, w.v, w.e: shape parameters of the Beta priors on <code class="reqn">\pi_{c}</code>, <code class="reqn">\pi_{v}</code> and <code class="reqn">\pi_{e}</code>, respectively.
</p>
</li>
<li>
<p> s: shape parameters of the Inverse-gamma prior on <code class="reqn">\sigma^{2}</code>.
</p>
</li>
<li>
<p> h: scale parameters of the Inverse-gamma prior on <code class="reqn">\sigma^{2}</code>.
</p>
</li>
</ul>
<p>Please check the references for more details about the prior distributions.
</p>


<h3>Value</h3>

<p>an object of class "BVCfit" is returned, which is a list with components:
</p>

<ul>
<li>
<p> posterior: posterior samples from the MCMC
</p>
</li>
<li>
<p> coefficients: a list of posterior estimates of coefficients
</p>
</li>
<li>
<p> burn.in: the number of iterations for burn-in
</p>
</li>
<li>
<p> iterations: the number of MCMC iterations.
</p>
</li>
</ul>
<h3>References</h3>

<p>Ren, J., Zhou, F., Li, X., Chen, Q., Zhang, H., Ma, S., Jiang, Y., Wu, C. (2020) Semiparametric Bayesian variable selection for gene-environment interactions.
<em>Statistics in Medicine</em>, 39(5): 617– 638 <a href="https://doi.org/10.1002/sim.8434">doi:10.1002/sim.8434</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gExp)

## default method
spbayes=BVCfit(X, Y, Z, E, clin)
spbayes


## non-structural
structural=FALSE
spbayes=BVCfit(X, Y, Z, E, clin, structural=structural)
spbayes

## non-sparse
sparse=FALSE
spbayes=BVCfit(X, Y, Z, E, clin, sparse=sparse)
spbayes


</code></pre>


</div>