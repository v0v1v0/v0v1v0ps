<div class="container">

<table style="width: 100%;"><tr>
<td>nb2lines</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use vector files for import and export of weights</h2>

<h3>Description</h3>

<p>Use vector files for import and export of weights, storing spatial entity coordinates in the arcs, and the entity indices in the data frame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nb2lines(nb, wts, coords, proj4string=NULL, as_sf=FALSE)
listw2lines(listw, coords, proj4string=NULL, as_sf=FALSE)
df2sn(df, i="i", i_ID="i_ID", j="j", wt="wt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>a neighbour object of class <code>nb</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>list of general weights corresponding to neighbours</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>matrix of region point coordinates, a <code>Spatial</code> object (points or polygons), or an <code>sfc</code> object (points or polygons)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj4string</code></td>
<td>
<p>default NULL; if <code>coords</code> is a Spatial or sf object, this value will be used, otherwise the value will be converted appropriately</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_sf</code></td>
<td>
<p>output object in <code>Spatial</code> or <code>sf</code> format, default FALSE, set to TRUE if coords is an <code>sfc</code> object and FALSE if a <code>Spatial</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object of spatial weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a data frame read from a shapefile, derived from the output of <code>nb2lines</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>character name of column in df with from entity index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i_ID</code></td>
<td>
<p>character name of column in df with from entity region ID</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>character name of column in df with to entity index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>character name of column in df with weights</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The neighbour and weights objects may be retrieved by converting the specified columns of the data slot of the SpatialLinesDataFrame object into a spatial.neighbour object, which is then converted into a weights list object.
</p>


<h3>Value</h3>

<p><code>nb2lines</code> and <code>listw2lines</code> return a SpatialLinesDataFrame object or an sf object; the data frame contains with the from and to indices of the neighbour links and their weights. <code>df2sn</code> converts the data retrieved from reading the data from <code>df</code> back into a <code>spatial.neighbour</code> object.
</p>


<h3>Note</h3>

<p>Original idea due to Gidske Leknes Andersen, Department of Biology, University of Bergen, Norway</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>See Also</h3>

<p><code>sn2listw</code></p>


<h3>Examples</h3>

<pre><code class="language-R">columbus &lt;- st_read(system.file("shapes/columbus.gpkg", package="spData")[1], quiet=TRUE)
col.gal.nb &lt;- read.gal(system.file("weights/columbus.gal", package="spData")[1])
res &lt;- listw2lines(nb2listw(col.gal.nb), st_geometry(columbus))
summary(res)
tf &lt;- paste0(tempfile(), ".gpkg")
st_write(res, dsn=tf, driver="GPKG")
inMap &lt;- st_read(tf)
summary(inMap)
diffnb(sn2listw(df2sn(as.data.frame(inMap)))$neighbours, col.gal.nb)
res1 &lt;- listw2lines(nb2listw(col.gal.nb), as(columbus, "Spatial"))
summary(res1)
</code></pre>


</div>