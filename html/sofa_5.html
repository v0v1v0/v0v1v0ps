<div class="container">

<table style="width: 100%;"><tr>
<td>Cushion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sofa connection client</h2>

<h3>Description</h3>

<p>sofa connection client
</p>
<p>sofa connection client
</p>


<h3>Value</h3>

<p>An object of class <code>Cushion</code>, with variables accessible for
host, port, path, transport, user, pwd, and headers. Functions are callable
to get headers, and to make the base url sent with all requests.
</p>


<h3>CouchDB versions</h3>

<p><span class="pkg">sofa</span> was built assuming CouchDB version 2 or greater. Some
functionality of this package will work with versions &lt; 2, while
some may not (mango queries, see <code>db_query()</code>). I don't
plan to support older CouchDB versions per se.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>host</code></dt>
<dd>
<p>(character) host</p>
</dd>
<dt><code>port</code></dt>
<dd>
<p>(integer) port</p>
</dd>
<dt><code>path</code></dt>
<dd>
<p>(character) url path, if any</p>
</dd>
<dt><code>transport</code></dt>
<dd>
<p>(character) transport schema, (http|https)</p>
</dd>
<dt><code>user</code></dt>
<dd>
<p>(character) username</p>
</dd>
<dt><code>pwd</code></dt>
<dd>
<p>(character) password</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>(list) named list of headers</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>Cushion$new()</code></a>
</p>
</li>
<li> <p><a href="#method-print"><code>Cushion$print()</code></a>
</p>
</li>
<li> <p><a href="#method-ping"><code>Cushion$ping()</code></a>
</p>
</li>
<li> <p><a href="#method-make_url"><code>Cushion$make_url()</code></a>
</p>
</li>
<li> <p><a href="#method-get_headers"><code>Cushion$get_headers()</code></a>
</p>
</li>
<li> <p><a href="#method-get_auth"><code>Cushion$get_auth()</code></a>
</p>
</li>
<li> <p><a href="#method-version"><code>Cushion$version()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>Cushion$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new <code>Cushion</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$new(host, port, path, transport, user, pwd, headers)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>host</code></dt>
<dd>
<p>(character) A base URL (without the transport), e.g.,
<code>localhost</code>, <code style="white-space: pre;">⁠127.0.0.1⁠</code>, or <code>foobar.cloudant.com</code></p>
</dd>
<dt><code>port</code></dt>
<dd>
<p>(numeric) Port. Remember that if you don't want a port set,
set this parameter to <code>NULL</code>. Default: <code>5984</code></p>
</dd>
<dt><code>path</code></dt>
<dd>
<p>(character) context path that is appended to the end of
the url. e.g., <code>bar</code> in <code style="white-space: pre;">⁠http://foo.com/bar⁠</code>. Default: <code>NULL</code>,
ignored</p>
</dd>
<dt><code>transport</code></dt>
<dd>
<p>(character) http or https. Default: http</p>
</dd>
<dt><code>user, pwd</code></dt>
<dd>
<p>(character) user name, and password. these are used in all
requests. if absent, they are not passed to requests</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>A named list of headers. These headers are used in all
requests. To use headers in individual requests and not others, pass
in headers via <code>...</code> in a function call.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>Cushion</code> object
</p>


<hr>
<a id="method-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print method for <code>Cushion</code>
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$print()</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>self</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>ignored</p>
</dd>
</dl>
</div>


<hr>
<a id="method-ping"></a>



<h4>Method <code>ping()</code>
</h4>

<p>Ping the CouchDB server
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$ping(as = "list", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>as</code></dt>
<dd>
<p>(character) One of list (default) or json</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options passed to crul::verb-GET</p>
</dd>
</dl>
</div>


<hr>
<a id="method-make_url"></a>



<h4>Method <code>make_url()</code>
</h4>

<p>Construct full base URL from the pieces in the
connection object
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$make_url()</pre></div>


<hr>
<a id="method-get_headers"></a>



<h4>Method <code>get_headers()</code>
</h4>

<p>Get list of headers that will be sent with
each request
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$get_headers()</pre></div>


<hr>
<a id="method-get_auth"></a>



<h4>Method <code>get_auth()</code>
</h4>

<p>Get list of auth values, user and pwd
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$get_auth()</pre></div>


<hr>
<a id="method-version"></a>



<h4>Method <code>version()</code>
</h4>

<p>Get the CouchDB version as a numeric
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$version()</pre></div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Cushion$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Create a CouchDB connection client
user &lt;- Sys.getenv("COUCHDB_TEST_USER")
pwd &lt;- Sys.getenv("COUCHDB_TEST_PWD")
(x &lt;- Cushion$new(user=user, pwd=pwd))

## metadata
x$host
x$path
x$port
x$type

## ping the CouchDB server
x$ping()

## get CouchDB version
x$version()

# create database
if (!"stuff" %in% db_list(x)) {
  db_create(x, "stuff")
}

# add documents to a database
if (!"sofadb" %in% db_list(x)) {
  db_create(x, "sofadb")
}
doc1 &lt;- '{"name": "drink", "beer": "IPA", "score": 5}'
doc_create(x, dbname="sofadb", docid="abeer", doc1)

# bulk create
if (!"mymtcars" %in% db_list(x)) {
  db_create(x, "mymtcars")
}
db_bulk_create(x, dbname="mymtcars", doc = mtcars)
db_list(x)

## database info
db_info(x, "mymtcars")

## list dbs
db_list(x)

## all docs
db_alldocs(x, "mymtcars", limit = 3)

## changes
db_changes(x, "mymtcars")

# With auth
# x &lt;- Cushion$new(user = 'sckott', pwd = 'sckott')

# Using Cloudant
# z &lt;- Cushion$new(host = "ropensci.cloudant.com", transport = 'https', port = NULL,
#   user = 'ropensci', pwd = Sys.getenv('CLOUDANT_PWD'))
# z
# db_list(z)
# db_create(z, "stuff2")
# db_info(z, "stuff2")
# db_alldocs(z, "foobar")

## End(Not run)
</code></pre>


</div>