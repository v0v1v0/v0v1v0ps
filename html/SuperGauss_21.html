<div class="container">

<table style="width: 100%;"><tr>
<td>NormalToeplitz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate normal with Toeplitz variance matrix.</h2>

<h3>Description</h3>

<p>Provides methods for the Normal-Toeplitz (NTz) distribution defined as</p>
<pre>z ~ NTz(acf)   &lt;=&gt;   z ~ Normal(0, toeplitz(acf)),
</pre>
<p>i.e., for a multivariate normal with mean zero and variance <code>Tz = toeplitz(acf)</code>.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>NormalToeplitz$new()</code></a>
</p>
</li>
<li> <p><a href="#method-size"><code>NormalToeplitz$size()</code></a>
</p>
</li>
<li> <p><a href="#method-logdens"><code>NormalToeplitz$logdens()</code></a>
</p>
</li>
<li> <p><a href="#method-grad"><code>NormalToeplitz$grad()</code></a>
</p>
</li>
<li> <p><a href="#method-hess"><code>NormalToeplitz$hess()</code></a>
</p>
</li>
<li> <p><a href="#method-grad_full"><code>NormalToeplitz$grad_full()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>NormalToeplitz$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Class constructor.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$new(N)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>N</code></dt>
<dd>
<p>Size of the NTz random vector.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A <code>NormalToeplitz</code> object.
</p>


<hr>
<a id="method-size"></a>



<h4>Method <code>size()</code>
</h4>

<p>Get the size of the NTz random vector.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$size()</pre></div>



<h5>Returns</h5>

<p>Size of the NTz random vector.
</p>


<hr>
<a id="method-logdens"></a>



<h4>Method <code>logdens()</code>
</h4>

<p>Log-density function.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$logdens(z, acf)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>z</code></dt>
<dd>
<p>Density argument. A vector of length <code>N</code> or an <code style="white-space: pre;">⁠N x n_obs⁠</code> matrix where each column is an <code>N</code>-dimensional observation.</p>
</dd>
<dt><code>acf</code></dt>
<dd>
<p>A vector of length <code>N</code> containing the autocorrelation (i.e., first row/column) of the Toeplitz variance matrix.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A scalar or vector of length <code>n_obs</code> containing the log-density of the NTz evaluated at its arguments.
</p>


<hr>
<a id="method-grad"></a>



<h4>Method <code>grad()</code>
</h4>

<p>Gradient of the log-density with respect to parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$grad(z, dz, acf, dacf, full_out = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>z</code></dt>
<dd>
<p>Density argument.  A vector of length <code>N</code>.</p>
</dd>
<dt><code>dz</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta⁠</code> matrix containing the gradient <code>dz/dtheta</code>.</p>
</dd>
<dt><code>acf</code></dt>
<dd>
<p>A vector of length <code>N</code> containing the autocorrelation of the Toeplitz variance matrix.</p>
</dd>
<dt><code>dacf</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta⁠</code> matrix containing the gradient <code>dacf/dtheta</code>.</p>
</dd>
<dt><code>full_out</code></dt>
<dd>
<p>If <code>TRUE</code>, returns the log-density as well (see 'Value').</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A vector of length <code>n_theta</code> containing the gradient of the NTz log-density with respect to <code>theta</code>, or a list with elements <code>ldens</code> and <code>grad</code> consisting of the log-density and the gradient vector.
</p>


<hr>
<a id="method-hess"></a>



<h4>Method <code>hess()</code>
</h4>

<p>Hessian of log-density with respect to parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$hess(z, dz, d2z, acf, dacf, d2acf, full_out = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>z</code></dt>
<dd>
<p>Density argument.  A vector of length <code>N</code>.</p>
</dd>
<dt><code>dz</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta⁠</code> matrix containing the gradient <code>dz/dtheta</code>.</p>
</dd>
<dt><code>d2z</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta x n_theta⁠</code> array containing the Hessian <code style="white-space: pre;">⁠d^2z/dtheta^2⁠</code>.</p>
</dd>
<dt><code>acf</code></dt>
<dd>
<p>A vector of length <code>N</code> containing the autocorrelation of the Toeplitz variance matrix.</p>
</dd>
<dt><code>dacf</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta⁠</code> matrix containing the gradient <code>dacf/dtheta</code>.</p>
</dd>
<dt><code>d2acf</code></dt>
<dd>
<p>An <code style="white-space: pre;">⁠N x n_theta x n_theta⁠</code> array containing the Hessian <code>dacf^2/dtheta^2</code>.</p>
</dd>
<dt><code>full_out</code></dt>
<dd>
<p>If <code>TRUE</code>, returns the log-density and its gradient as well (see 'Value').</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>An <code style="white-space: pre;">⁠n_theta x n_theta⁠</code> matrix containing the Hessian of the NTz log-density with respect to <code>theta</code>, or a list with elements <code>ldens</code>, <code>grad</code>, and <code>hess</code> consisting of the log-density, its gradient (a vector of size <code>n_theta</code>), and the Hessian matrix, respectively.
</p>


<hr>
<a id="method-grad_full"></a>



<h4>Method <code>grad_full()</code>
</h4>

<p>Full gradient of log-density function.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$grad_full(z, acf, calc_dldz = TRUE, calc_dlda = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>z</code></dt>
<dd>
<p>Density argument.  A vector of length <code>N</code>.</p>
</dd>
<dt><code>acf</code></dt>
<dd>
<p>A vector of length <code>N</code> containing the autocorrelation of the Toeplitz variance matrix.</p>
</dd>
<dt><code>calc_dldz</code></dt>
<dd>
<p>Whether or not to calculate the gradient with respect to <code>z</code>.</p>
</dd>
<dt><code>calc_dlda</code></dt>
<dd>
<p>Whether or not to calculate the gradient with respect to <code>acf</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A list with elements:
</p>

<dl>
<dt><code>ldens</code></dt>
<dd>
<p>The log-density evaluated at <code>z</code> and <code>acf</code>.</p>
</dd>
<dt><code>dldz</code></dt>
<dd>
<p>The length-<code>N</code> gradient vector with respect to <code>z</code>, if <code>calc_dldz = TRUE</code>.</p>
</dd>
<dt><code>dlda</code></dt>
<dd>
<p>The length-<code>N</code> gradient vector with respect to <code>acf</code>, if <code>calc_dlda = TRUE</code>.</p>
</dd>
</dl>
<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>NormalToeplitz$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




</div>