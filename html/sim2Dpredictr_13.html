<div class="container">

<table style="width: 100%;"><tr>
<td>sample_FP_Power</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain Sample False Positive Rates and Power</h2>

<h3>Description</h3>

<p>This function calculates sample FDR, FWER, and Power for large numbers of
predictors, given a vector of "true" parameter values and a vector of 
associated rejections. In the case that more than 1 predictor has a "true"
non-zero parameter, then Power is defined as the proportion/percentage of
those "true" parameters identified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_FP_Power(
  rejections = NULL,
  FP = NULL,
  TP = NULL,
  test.statistic = NULL,
  reject.threshold = NULL,
  B = NULL,
  B.incl.B0 = TRUE,
  full.summary = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rejections</code></td>
<td>
<p>A binary vector; <code>rejection[i] = 1</code> means the null
hypothesis is rejected for parameter <code>B[i]</code>, whereas 
<code>rejection[i] = 0</code> means that the null hypothesis was not rejected
for parameter <code>B[i]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP, TP</code></td>
<td>
<p>Binary vectors of false positive and true positive indicators,
respectively. <code>FP[i] = 1</code> means the null hypothesis was incorrectly 
rejected, and <code>TP[i] = 1</code> means the null hypothesis was correctly 
rejected. If either argument is <code>NULL</code>, then these vectors are 
computed; this is the default setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.statistic</code></td>
<td>
<p>A vector of test statistics; e.g., t-statistics or
p-values that are used to determine whether or not to reject the null
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject.threshold</code></td>
<td>
<p>A list whose first element is the rejection 
criteria, e.g., the minimum t-statistic or maximum p-value for which to
reject the null hypothesis. The second element is one of 
<code>c("greater", "less", "2-tailed")</code>, which tell the function to reject
when the values in <code>test.statistic</code> are greater than or less than the
threshold, the test is a 2-tailed, respectively. In the latter case the 
function internally calculates the upper or lower threshold needed for the
2-tailed test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A vector of "true" parameter values. For inference purposes, this
can be a vector of actual parameter values, or a binary vector indicating
non-zero status.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.incl.B0</code></td>
<td>
<p>If <code>B.incl.B0 = TRUE</code> then the first entry should be
the intercept, B0. <code>B.incl.B0 = FALSE</code> indicates that the first entry
of B is not an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.summary</code></td>
<td>
<p>If <code>full.summary = TRUE</code> then the total numbers of
rejections, false positives, true positives, and non-zero parameters are
output along with FDR, FWER, and Power; otherwise, only FDR, FWER, and 
Power are output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns for sample FDR, FWER, and Power.
</p>


<h3>Note</h3>

<p>The default operating approach is that the null hypothesis is 
<code>B[i] = 0</code> for each parameter. If other hypotheses are being tested 
then <code>B</code> should be converted to a binary vector indicating whether 
the null hypothesis <em>should</em> have been rejected.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example 1

## rejection vector
rej.ex &lt;- c(0, 1, 1, 0, 0, 1, 0)
## false positive vector
fp.ex  &lt;- c(0, 0, 1, 0, 0, 0, 0)
## true positive vector
tp.ex  &lt;- c(0, 1, 0, 0, 0, 1, 0)
## parameter vector
par.ex &lt;- c(0, 4, 0, 0, 3, 9, 0)

sample_FP_Power(rej.ex, fp.ex, tp.ex, par.ex, B.incl.B0 = FALSE)

## Function can calculate TP and FP vectors
sample_FP_Power(rejections = rej.ex, 
                FP = NULL, TP = NULL, 
                B = par.ex, B.incl.B0 = FALSE)

## example 2: sum(FP, TP) must equal sum(rejections) or
## function stops execution

rej.ex2 &lt;- c(0, 1, 0, 0, 0, 1, 0)
fp.ex2  &lt;- c(0, 0, 1, 0, 0, 0, 0)
tp.ex2  &lt;- c(0, 1, 0, 0, 0, 1, 0)
par.ex2 &lt;- c(0, 4, 0, 0, 3, 9, 0)

## Not run: sample_FP_Power(rej.ex2, 
                         fp.ex2, tp.ex2, par.ex2, 
                         B.incl.B0 = FALSE)
## End(Not run)

## example 3: calculate rejections from vector of test statistics
zstat &lt;- c(-0.5, 1.98, 2.01, 1.45, -1.99)
# 2-tailed
sample_FP_Power(test.statistic = zstat,
                reject.threshold = list(1.96, "2-tailed"),
                B = c(0, 0, 4, 1, -2), B.incl.B0 = FALSE)
# 1-tailed (upper)
sample_FP_Power(test.statistic = zstat,
                reject.threshold = list(1.96, "greater"),
                B = c(0, 0, 4, 1, -2), B.incl.B0 = FALSE)
## p-value
sample_FP_Power(test.statistic = c(0.44, 0.04, 0.01, 0.06, 0.02 ),
                reject.threshold = list(0.05, "less"),
                B = c(0, 0, 4, 1, -2), B.incl.B0 = FALSE)
</code></pre>


</div>