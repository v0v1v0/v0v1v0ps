<div class="container">

<table style="width: 100%;"><tr>
<td>ICA.BinBin.Grid.Sample.Uncert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the grid-based sample approach, accounting for sampling variability in the marginal <code class="reqn">\pi</code>.</h2>

<h3>Description</h3>

<p>The function <code>ICA.BinBin.Grid.Sample.Uncert</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. This method provides an alternative for <code>ICA.BinBin</code> and <code>ICA.BinBin.Grid.Full</code>. It  uses an alternative strategy to identify plausible values for <code class="reqn">\pi</code>. The function allows to account for sampling variability in the marginal <code class="reqn">\pi</code>. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class="language-R">ICA.BinBin.Grid.Sample.Uncert(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_,
pi_0_1, Monotonicity=c("General"), M=100000,
Volume.Perc=0, Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi1_1_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>. A vector is specified to account for uncertainty, i.e., rather than keeping <code class="reqn">P(T=1,S=1|Z=0)</code> fixed at one estimated value, a distribution can be specified (see <b>examples</b> below) from which a value is drawn in each run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1_0_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_1_1</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_1_0</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0_1_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_0_1</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>. Default <code>Monotonicity=c("General")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of random samples that have to be drawn for the freely varying parameters. Default <code>M=100000</code>. This argument is not used when <code>Volume.Perc=0</code>. Default <code>M=10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.Perc</code></td>
<td>
<p>Note that the marginals that are observable in the data set a number of restrictions on the unidentified correlations. For example, under montonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, it holds that <code class="reqn">\pi_{0111}&lt;=min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})</code> and <code class="reqn">\pi_{1100}&lt;=min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})</code>. For example, when <code class="reqn">min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})=0.10</code> and <code class="reqn">min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})=0.08</code>, then all valid  <code class="reqn">\pi_{0111}&lt;=0.10</code> and  all valid <code class="reqn">\pi_{1100}&lt;=0.08</code>. The argument <code>Volume.Perc</code> specifies the fraction  of the 'volume' of the paramater space that is explored. This volume is computed based on the grids G={0, 0.01, ..., maximum possible value for the counterfactual probability at hand}. E.g., in the previous example, the 'volume' of the parameter space would be <code class="reqn">11*9=99</code>, and when e.g., the argument <code>Volume.Perc=1</code> is used a total of <code class="reqn">99</code> runs will be conducted. Notice that when monotonicity is not assumed, relatively high values of <code>Volume.Perc</code> will lead to a large number of runs and consequently a long analysis time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>M=100000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code>ICA.ContCont</code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles.
</p>
<p>The function <code>ICA.BinBin.Grid.Full</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed that are allowed to vary freely are considered.  When it is not assumed that monotonicity holds for both <code class="reqn">S</code> and <code class="reqn">T</code>, the number of possible combinations become very high. The function <code>ICA.BinBin.Grid.Sample.Uncert</code> considers a random sample of all possible combinations.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.No</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity is not assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.T</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">T</code> is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.S</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Volume.ST</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>
<p>Buyse, M., Burzykowski, T., Aloso, A., &amp; Molenberghs, G. (2014). Direct estimation of joint counterfactual probabilities, with application to surrogate marker validation.
</p>


<h3>See Also</h3>

<p><code>ICA.ContCont</code>, <code>MICA.ContCont</code>, <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Sample.Uncert</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compute R2_H given the marginals (sample from uniform),
# assuming no monotonicity
ICA_No2 &lt;- ICA.BinBin.Grid.Sample.Uncert(pi1_1_=runif(10000, 0.3562, 0.4868),
pi0_1_=runif(10000, 0.0240, 0.0837), pi1_0_=runif(10000, 0.0240, 0.0837),
pi_1_1=runif(10000, 0.4434, 0.5742), pi_1_0=runif(10000, 0.0081, 0.0533),
pi_0_1=runif(10000, 0.0202, 0.0763), Seed=1, Monotonicity=c("No"), M=1000)

summary(ICA_No2)

# obtain plot of R2_H
plot(ICA_No2)
</code></pre>


</div>