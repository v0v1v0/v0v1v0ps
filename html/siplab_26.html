<div class="container">

<table style="width: 100%;"><tr>
<td>kernel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Competition Kernel Functions
</h2>

<h3>Description</h3>


<p>Functions representing the effect of a competitor on a subject plant, depending on distance and plant sizes (marks). For use in <code>pairwise()</code>.
</p>
<p>Note: In previous versions of <span class="pkg">siplab</span> the function names had
<code>.ker</code> in place of <code>_ker</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powers_ker(imarks, jmarks, dists, dranks, par = list(pi=1, pj=1,
    pr=1, smark = 1))

staebler_ker(imarks, jmarks, dists, dranks, par = list(k=0.1, p=1,
    smark=1))

spurr_ker(imarks, jmarks, dists, dranks, par = list(type=1,
    smark=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>imarks</code></td>
<td>


<p>Marks for the subject plant, a 1-row data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jmarks</code></td>
<td>


<p>Data frame with marks for competitors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>


<p>Vector of distances between the subject plant and the competitors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dranks</code></td>
<td>


<p>Distance ranks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>


<p>List of parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>The values of <code>par</code> are taken from the argument <code>kerpar</code> of <code>pairwise()</code>, if not <code>NULL</code>.
</p>
<p><code>smark</code> in <code>par</code> must be 1 or “mark” if there is only one mark. If the marks are a data frame, <code>smark</code> must be the number or name of the column with the plant size variable.
</p>
<p><code>powers_ker()</code> is a general form that includes many examples from the literature. If <code class="reqn">S_i</code> is the size of the subject plant, <code class="reqn">S_j</code> the size of the competitor, and <code class="reqn">R</code> is the distance between them, then this kernel is <code class="reqn">(S_j^{p_j} / S_i^{p_i}) / R^{p_r}</code>. For instance, the popular Hegyi's index corresponds to <code>pi=1, pj=1, pr=1</code>.
This and other examples could be coded directly if computational efficiency is important, see the  example below.
</p>
<p><code>staebler_ker()</code> is the width of the overlap of zones of influence (ZOI), used by Staebler in 1951. Assumes that the ZOI radius is <code class="reqn">k S^p</code>, where <code class="reqn">S</code> is size.
</p>
<p><code>spurr_ker()</code> is an example of an index that depends on distance ranks: equations (9.5a), (9.5b) of Burkhart and Tomé (2012).
</p>
<p>Competition kernels seem to be limited only by the researchers imagination. Others can be written following these examples.
</p>


<h3>Value</h3>






<p>Vector of length equal to the length of <code>dists</code>.
</p>


<h3>Author(s)</h3>


<p>Oscar García.
</p>


<h3>References</h3>


<p><a href="https://github.com/ogarciav/siplab">https://github.com/ogarciav/siplab</a>
</p>
<p>Burkhart, H. E. and Tomé, M. (2012) <em>Modeling Forest Trees and Stands</em>. Springer.
</p>
<p>García, O. “Siplab, a spatial individual-based plant modelling system”. Computational Ecology and Software 4(4), 215-222. 2014.
</p>


<h3>See Also</h3>


<p><code>pairwise</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Originally Hegyi added one foot to the distance:
hegyiorig_ker &lt;- function(imarks, jmarks, dists, ...) {
# Assume coordinates in meters, and a single mark (dbh)
    (jmarks$mark / imarks$mark) / (dists + 0.30481)
}
</code></pre>


</div>