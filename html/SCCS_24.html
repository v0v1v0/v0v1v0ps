<div class="container">

<table style="width: 100%;"><tr>
<td>nonparasccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spline-based non parametric SCCS method

</h2>

<h3>Description</h3>

<p>Fits a spline-based non parametric SCCS model where both the exposure related relative incidence and age related relative incidence functions are represented by spline functions; that is, linear combinations of M-splines. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">nonparasccs(indiv, astart, aend, aevent, adrug, aedrug, kn1=12, kn2=12,
            sp1=NULL, sp2=NULL, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at start of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event, an individual can experience multiple events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a vector of  ages at which exposure related risk period starts. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a vector of ages at which exposure-related risk ends. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn1</code></td>
<td>

<p>an integer &gt;= 5 representing the number of interior knots used to define the M-spline basis functions which are related to the age specific relative incidence function, usually between 8 and 12 knots is sufficient. It defaults to 12 knots. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn2</code></td>
<td>

<p>a an integer &gt;= 5 representing the number of interior knots used to define the M-spline basis functions which are related to the exposure specific relative incidence function, usually between 8 and 12 knots is sufficient. The default value is 12. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp1</code></td>
<td>

<p>smoothing parameter value for age related relative incidence function. It defaults to "NULL" where the smoothing parameter is obtained automatically using an approximate cross-validation method. The value of "sp1" must be a number greater or equal to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp2</code></td>
<td>

<p>smoothing parameter value for exposure related relative incidence function. It defaults to "NULL" where the smoothing paramter is obtained automatically using an approximate cross-validation method. The value of "sp1" must be a number greater or equal to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame containing the input data. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The smoothing parameters for the age and exposure related relative incidence functions are chosen using a cross-validation method. To visualize the exposure-related relative incidence function, use the plot function. 
</p>


<h3>Value</h3>

<p>Relative incidence estimates along with their 95% confidence intervals.


</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>exposure related relative incidence estimates at each point of time since start of exposure until the maximum difference between the start and end of exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timesinceexposure</code></td>
<td>
<p>time units since the start of exposure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lci </code></td>
<td>
<p>lower confidence limits of the exposure related relative incidence estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uci </code></td>
<td>
<p>upper confidence limits of the exposure related relative incidence estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington. 
</p>


<h3>References</h3>

<p>Ghebremichael-Weldeselassie, Y., Whitaker, H. J., Farrington, C. P. (2016). Flexible modelling of vaccine effects in self-controlled case series models. Biometrical Journal, 58(3):607-622.
</p>
<p>Ghebremichael-Weldeselassie, Y., Whitaker, H. J., Farrington, C. P. (2017). Spline-based self controlled case series method. Statistics in Medicine 33:639-649.
</p>
<p>Farrington P., Whitaker H., and Ghebremichael-Weldeselassie Y. (2018). Self-controlled Case Series Studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>smoothagesccs</code>, <code>smoothexposccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# ITP and MMR data 

  itp.mod &lt;- nonparasccs(indiv=case, astart=sta, aend=end,
                         aevent=itp, adrug=mmr, aedrug=mmr+42, sp1=28000, sp2=1200,
                         data=itpdat)

  itp.mod
  
# Plot the exposure and age related relative incidence functions

  plot(itp.mod)
  
</code></pre>


</div>