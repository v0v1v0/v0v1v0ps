<div class="container">

<table style="width: 100%;"><tr>
<td>censTrial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of Pre-Unblinded Follow-Up Data-Sets by Applying the Monitoring Outcomes</h2>

<h3>Description</h3>

<p><code>censTrial</code> ‘correctly censors’ treatment arms in data-sets generated by <code>simTrial</code> by including pre-unblinded follow-up data only according to the monitoring conclusions as reported by <code>monitorTrial</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">censTrial(dataFile, monitorFile, stage1, stage2, saveFile = NULL,
  saveDir = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataFile</code></td>
<td>
<p>if <code>saveDir = NULL</code>, a list returned by <code>simTrial</code>; otherwise a name (character string) of an <code>.RData</code> file created by <code>simTrial</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitorFile</code></td>
<td>
<p>if <code>saveDir = NULL</code>, a list returned by <code>monitorTrial</code>; otherwise a name (character string) of an <code>.RData</code> file created by <code>monitorTrial</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>the final week of stage 1 in a two-stage trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage2</code></td>
<td>
<p>the final week of stage 2 in a two-stage trial, i.e., the maximum follow-up time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveFile</code></td>
<td>
<p>a character string specifying the name of the output <code>.RData</code> file. If <code>NULL</code> (default), a default file name will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveDir</code></td>
<td>
<p>a character string specifying a path for both <code>dataFile</code> and <code>monitorFile</code>. If supplied, the output is also saved as an <code>.RData</code> file in this directory; otherwise the output is returned as a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value indicating whether information on the output directory and file name should be printed out (default is <code>TRUE</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All time variables use week as the unit of time. Month is defined as 52/12 weeks.
</p>
<p>The following censoring rules are applied to each data-set generated by <code>simTrial</code>:
</p>

<ul>
<li>
<p> If no vaccine arm registers efficacy or high efficacy in Stage 1, the placebo arm is censored on the date when the last vaccine arm hits the harm or non-efficacy boundary.
</p>
</li>
<li>
<p> If a vaccine arm hits the harm boundary, censor the arm immediately.
</p>
</li>
<li>
<p> If a vaccine arm hits the non-efficacy boundary, censor the arm on the earliest date of the two events: (1) the last vaccine arm hits the harm or non-efficacy boundary (if applicable); and (2) all subjects in the vaccine arm have completed the final <code>stage1</code> visit.
</p>
</li>
</ul>
<h3>Value</h3>

<p>If <code>saveDir</code> is specified, the output list (named <code>trialListCensor</code>) is saved as an <code>.RData</code> file in <code>saveDir</code> (the path to <code>saveDir</code> is printed); otherwise it is returned. 
The output object is a list of length equal to the number of simulated trials, each of which is a <code>data.frame</code> with at least the variables <code>trt</code>, <code>entry</code>, <code>exit</code>, and <code>event</code> 
storing the treatment assignments, enrollment times, correctly censored study exit times, and event indicators, respectively. If available, indicators belonging to the per-protocol cohort 
(named <code>pp1</code>, <code>pp2</code>, etc.) are copied from the uncensored data-sets.
</p>


<h3>See Also</h3>

<p><code>simTrial</code>, <code>monitorTrial</code>, and <code>rankTrial</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">simData &lt;- simTrial(N=c(1000, rep(700, 2)), aveVE=seq(0, 0.4, by=0.2), 
                    VEmodel="half", vePeriods=c(1, 27, 79), enrollPeriod=78, 
                    enrollPartial=13, enrollPartialRelRate=0.5, dropoutRate=0.05, 
                    infecRate=0.04, fuTime=156, 
                    visitSchedule=c(0, (13/3)*(1:4), seq(13*6/3, 156, by=13*2/3)),
                    missVaccProb=c(0,0.05,0.1,0.15), VEcutoffWeek=26, nTrials=5, 
                    stage1=78, randomSeed=300)

monitorData &lt;- monitorTrial(dataFile=simData, stage1=78, stage2=156, 
                            harmMonitorRange=c(10,100), alphaPerTest=NULL, 
                            nonEffStartMethod="FKG", nonEffInterval=20, 
                            lowerVEnoneff=0, upperVEnoneff=0.4, highVE=0.7, 
                            stage1VE=0, lowerVEuncPower=0, alphaNoneff=0.05, 
                            alphaHigh=0.05, alphaStage1=0.05, 
                            alphaUncPower=0.05, estimand="cuminc", lagTime=26)

censData &lt;- censTrial(dataFile=simData, monitorFile=monitorData, stage1=78, stage2=156)

### alternatively, to save the .RData output file (no '&lt;-' needed):
###
### simTrial(N=c(1400, rep(1000, 2)), aveVE=seq(0, 0.4, by=0.2), VEmodel="half", 
###          vePeriods=c(1, 27, 79), enrollPeriod=78, enrollPartial=13, 
###          enrollPartialRelRate=0.5, dropoutRate=0.05, infecRate=0.04, fuTime=156, 
###          visitSchedule=c(0, (13/3)*(1:4), seq(13*6/3, 156, by=13*2/3)), 
###          missVaccProb=c(0,0.05,0.1,0.15), VEcutoffWeek=26, nTrials=30, 
###          stage1=78, saveDir="./", randomSeed=300)
###
### monitorTrial(dataFile=
###              "simTrial_nPlac=1400_nVacc=1000_1000_aveVE=0.2_0.4_infRate=0.04.RData", 
###              stage1=78, stage2=156, harmMonitorRange=c(10,100), alphaPerTest=NULL, 
###              nonEffStartMethod="FKG", nonEffInterval=20, lowerVEnoneff=0, 
###              upperVEnoneff=0.4, highVE=0.7, stage1VE=0, lowerVEuncPower=0, 
###              alphaNoneff=0.05, alphaHigh=0.05, alphaStage1=0.05, alphaUncPower=0.05, 
###              estimand="cuminc", lagTime=26, saveDir="./")
###
### censTrial(dataFile=
###          "simTrial_nPlac=1400_nVacc=1000_1000_aveVE=0.2_0.4_infRate=0.04.RData",
###          monitorFile=
###          "monitorTrial_nPlac=1400_nVacc=1000_1000_aveVE=0.2_0.4_infRate=0.04_cuminc.RData",
###          stage1=78, stage2=156, saveDir="./")
 
</code></pre>


</div>