<div class="container">

<table style="width: 100%;"><tr>
<td>scPathway</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer pathway activation score matrix at single-cell resolution</h2>

<h3>Description</h3>

<p>Calculate pathway activity score of single-cell by random walk with restart (RWR).
</p>


<h3>Usage</h3>

<pre><code class="language-R">scPathway(
  network.data,
  gmt.path = NULL,
  pathway.min = 10,
  pathway.max = 500,
  nperm = 50,
  parallel.cores = 2,
  rwr.gamma = 0.7,
  normal_dist = TRUE,
  seed = 1217,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>network.data</code></td>
<td>
<p>The input network data is the result from the <code>ConNetGNN</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmt.path</code></td>
<td>
<p>Pathway database in <code>GMT</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway.min</code></td>
<td>
<p>Minimum size (in genes) for pathway to be considered. Default: <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway.max</code></td>
<td>
<p>Maximum size (in genes) for database gene sets to be considered. Default: <code>500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of random permutations. Default: <code>50</code>. We recommend the setting of 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.cores</code></td>
<td>
<p>Number of processors to use when doing the calculations in parallel (default: <code>2</code>). If <code>parallel.cores=0</code>, then it will use all available core processors unless we set this argument with a smaller number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rwr.gamma</code></td>
<td>
<p>Restart parameter. Default: <code>0.7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal_dist</code></td>
<td>
<p>Whether to use pnorm to calculate P values. Default: <code>TRUE</code>.Note that if normal_dist is FALSE, we need to increase nperm (we recommend 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random number generator seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Gives information about each step. Default: <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>scPathway
</p>
<p>The <code>scPathway</code> function integrates the results of ConNetGNN into a gene-cell association network.
The genes included in each pathway are used as a restart set in the gene-cell association network to calculate the strength of its association with each cell through <code>RWR</code>.
Perturbation analysis was performed to remove noise effects in the network and to obtain the final single-cell pathway activity score matrix.
</p>


<h3>Value</h3>

<p>A matrix of single-cell pathway activity score.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(parallel)
require(utils)
# Load the result of the ConNetGNN function.
data(ConNetGNN_data)
kegg.path&lt;-system.file("extdata", "KEGG_human.gmt", package = "scapGNN")
# We recommend the use of a compiler.
# The compiler package can be used to speed up the operation.
# library(compiler)
# scPathway&lt;- cmpfun(scPathway)
scPathway_data&lt;-scPathway(ConNetGNN_data,gmt.path=kegg.path,
                          pathway.min=25,nperm=2,parallel.cores=1)

</code></pre>


</div>