<div class="container">

<table style="width: 100%;"><tr>
<td>Estim_Simulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Monte Carlo simulation
</h2>

<h3>Description</h3>

<p>Runs Monte Carlo simulation for a selected estimation method. The
function can save a file and produce a statistical summary.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Estim_Simulation(AlphaBetaMatrix = abMat, SampleSizes = c(200, 1600),
                 MCparam = 100, Estimfct = c("ML", "GMM", "Cgmm","Kout"),
                 HandleError = TRUE, FctsToApply = StatFcts,
                 saveOutput = TRUE, StatSummary = FALSE,
                 CheckMat = TRUE, tolFailCheck = tolFailure,
                 SeedOptions=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>AlphaBetaMatrix</code></td>
<td>

<p>values of the parameter <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> from which we
simulate the data. By default, the values of <code class="reqn">\gamma</code> and
<code class="reqn">\delta</code> are set to 1 and 0, respectively;
a <code class="reqn">2 \times n</code> matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleSizes</code></td>
<td>

<p>sample sizes to be used to simulate the data. By default, we use
<code>200</code> (small sample size) and <code>1600</code> (large sample size);
vector of integers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCparam</code></td>
<td>

<p>Number of Monte Carlo simulation for each couple of parameter,
default = 100; an integer number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimfct</code></td>
<td>

<p>the estimation function to be used, one of 
<code>"ML"</code>, <code>"GMM"</code>, <code>"Cgmm"</code> or <code>"Kout"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HandleError</code></td>
<td>

<p>logical flag: if set to TRUE, the simulation doesn't stop when an
error in the estimation function is encountered. A vector of (size
4) <code>NA</code> is saved and the the simulation carries on. See
details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FctsToApply</code></td>
<td>

<p>functions used to produce the statistical summary. See details;
a character vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveOutput</code></td>
<td>

<p>logical flag: if set to TRUE, a csv file (for each couple of
parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>) with the the estimation
information is saved in the current directory. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StatSummary</code></td>
<td>

<p>logical flag: if set to TRUE, a statistical summary (using
<code>FctsToApply</code>) is returned. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckMat</code></td>
<td>

<p>logical flag: if set to TRUE, an estimation is declared failed if
the squared error of the estimation is larger than
<code>tolFailCheck</code>; default = TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolFailCheck</code></td>
<td>

<p>tolerance on the squared error of the estimation to be declared
failed; default = 1.5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SeedOptions</code></td>
<td>

<p>list to control the seed generation. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments to be passed to the estimation function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p><b>Error Handling</b>

It is advisable to set it to TRUE when the user is planning to launch
long simulations as it will prevent the procedure from stopping if an
error occurs for one sample data. The estimation function will produce
a vector of <code>NA</code> as estimated parameters related to this (error
generating) sample data and move on to the next Monte Carlo step.

<b>Statistical summary</b>

The function is able to produce a statistical summary of the Monte
Carlo simulation for each parameter (slices of the list). Each slice
is a matrix where the rows represents the true values of the
parameters and the columns the statistical information.

In all cases, the following quantities are computed:
</p>

<dl>
<dt>
<code>sample size</code>:</dt>
<dd>
<p>the sample size used to produce the simulated data.
</p>
</dd>
<dt>
<code>alphaT</code>, <code>betaT</code>:</dt>
<dd>
<p>the true values of the parameters.
</p>
</dd>
<dt>
<code>failure</code>:</dt>
<dd>
<p>the number of times the procedure failed to produce relevant
estimation.
</p>
</dd>
<dt>
<code>time</code>:</dt>
<dd>
<p>the average running time in seconds of the estimation procedure
</p>
</dd>
</dl>
<p>Besides, the (vector of <code>character</code>) <code>FctsToApply</code> controls
the other quantities to be computed by providing the name of the
function object to be applied to the vector of estimated
parameters. The signature of the function should be of the form
<code>fctName = function(p,...){...}</code>, where <code>p</code> is the vector
(<code>length(p) = MCparam</code>) of parameter estimates and <code>...</code>
is the extra arguments to be passed the function.
</p>
<p>By default, the functions from <code>StatFcts</code> will be applied but the
user can pass his own functions by providing their names in argument
<code>FctsToApply</code> and their definitions in the global environment.
</p>
<p>Note that if <code>CheckMat</code> is set to TRUE, the estimation is
considered failed if the squared error (of the first 2 parameters
<code>alpha</code> and <code>beta</code>) is larger than <code>tolFailCheck</code>.
</p>
<p><b>Output file</b>
</p>
<p>Setting <code>saveOutput</code> to TRUE will have the side effect of saving
a csv file in the working directory. This file will have
<code>MCparam * length(SampleSizes)</code> lines and its columns will
be:
</p>

<dl>
<dt>
<code>alphaT</code>, <code>betaT</code>:</dt>
<dd>
<p>the true values of the parameters.
</p>
</dd> 
<dt>
<code>data size</code>:</dt>
<dd>
<p>the sample size used to generate the simulated data.
</p>
</dd>
<dt>
<code>seed</code>:</dt>
<dd>
<p>the seed value used to generate the simulated data.
</p>
</dd>
<dt>
<code>alphaE</code>, <code>betaE</code>, <code>gammaE</code>, <code>deltaE</code>:</dt>
<dd>
<p>the estimates of the 4 parameters.
</p>
</dd>
<dt>
<code>failure</code>:</dt>
<dd>
<p>binary: 0 for success, 1 for failure.
</p>
</dd>
<dt>
<code>time</code>:</dt>
<dd>
<p>estimation running time in seconds.
</p>
</dd>
</dl>
<p>The file name is informative to let the user identify the values of
the true parameters, the MC parameters, as well as the options
selected for the estimation method.
</p>
<p>The csv file is updated after each MC estimation, which is useful when
the simulation stops before it finishes. Besides, using the
check-pointing mechanism explained below, the simulation can re-start
from where it stopped.
</p>
<p><em>Check-pointing.</em>
Checkpointing is the act of saving enough program state and results so
far calculated that a computation can be stopped and restarted. The
way we did it here is to save a text file with some useful information
about the state of the estimation. This text file is updated after
each MC iteration and read at the beginning of function
<code>Estim_Simulation</code> to allow the simulation to re-start from where
it stopped. This file is deleted at the end of the simulation
procedure.
</p>
<p><em>SeedOptions.</em>
Users who do not want to control the seed generation can ignore this
argument (its default value is <code>NULL</code>). This argument can be more
useful when one wants to cut the simulation (even for one parameter
value) into pieces. In that case, the user can control which part of
the seed vector to use.
</p>

<dl>
<dt>
<code>MCtot</code>:</dt>
<dd>
<p>total values of MC simulations in the entire process.
</p>
</dd>
<dt>
<code>seedStart</code>:</dt>
<dd>
<p>starting index in the seed vector. The vector extracted will be of
size <code>MCparam</code>.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>If <code>StatSummary</code> is set to TRUE, a <code>list</code> with 4 components
(corresponding to the 4 parameters) is returned. Each component is a
matrix. If <code>SaveOutput</code> is set to TRUE, only a csv file is saved
and nothing is returned (if <code>StatSummary</code> is FALSE).  If both are
FALSE, the function stops.
</p>


<h3>See Also</h3>

<p><code>Estim</code>,
<code>CgmmParametersEstim</code>,
<code>GMMParametersEstim</code>,
<code>MLParametersEstim</code>
</p>


</div>