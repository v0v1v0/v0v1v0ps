<div class="container">

<table style="width: 100%;"><tr>
<td>SerialRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stability selection in regression (internal)</h2>

<h3>Description</h3>

<p>Runs stability selection regression models with different combinations of
parameters controlling the sparsity of the underlying selection algorithm
(e.g. penalty parameter for regularised models) and thresholds in selection
proportions. These two parameters are jointly calibrated by maximising the
stability score of the model (possibly under a constraint on the expected
number of falsely stably selected features). This function uses a serial
implementation and requires the grid of parameters controlling the underlying
algorithm as input (for internal use only).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SerialRegression(
  xdata,
  ydata = NULL,
  Lambda,
  pi_list = seq(0.6, 0.9, by = 0.01),
  K = 100,
  tau = 0.5,
  seed = 1,
  n_cat = 3,
  family = "gaussian",
  implementation = PenalisedRegression,
  resampling = "subsampling",
  cpss = FALSE,
  PFER_method = "MB",
  PFER_thr = Inf,
  FDP_thr = Inf,
  group_x = NULL,
  group_penalisation = FALSE,
  output_data = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>
<p>matrix of predictors with observations as rows and variables as
columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydata</code></td>
<td>
<p>optional vector or matrix of outcome(s). If <code>family</code> is set
to <code>"binomial"</code> or <code>"multinomial"</code>, <code>ydata</code> can be a vector
with character/numeric values or a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>matrix of parameters controlling the level of sparsity in the
underlying feature selection algorithm specified in <code>implementation</code>.
With <code>implementation="glmnet"</code>, <code>Lambda</code> contains penalty
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_list</code></td>
<td>
<p>vector of thresholds in selection proportions. If
<code>n_cat=NULL</code> or <code>n_cat=2</code>, these values must be <code>&gt;0</code> and
<code>&lt;1</code>. If <code>n_cat=3</code>, these values must be <code>&gt;0.5</code> and
<code>&lt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of resampling iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>subsample size. Only used if <code>resampling="subsampling"</code> and
<code>cpss=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>value of the seed to initialise the random number generator and
ensure reproducibility of the results (see <code>set.seed</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cat</code></td>
<td>
<p>computation options for the stability score. Default is
<code>NULL</code> to use the score based on a z test. Other possible values are 2
or 3 to use the score based on the negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>type of regression model. This argument is defined as in
<code>glmnet</code>. Possible values include <code>"gaussian"</code>
(linear regression), <code>"binomial"</code> (logistic regression),
<code>"multinomial"</code> (multinomial regression), and <code>"cox"</code> (survival
analysis).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>implementation</code></td>
<td>
<p>function to use for variable selection. Possible
functions are: <code>PenalisedRegression</code>, <code>SparsePLS</code>,
<code>GroupPLS</code> and <code>SparseGroupPLS</code>. Alternatively, a user-defined
function can be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resampling</code></td>
<td>
<p>resampling approach. Possible values are:
<code>"subsampling"</code> for sampling without replacement of a proportion
<code>tau</code> of the observations, or <code>"bootstrap"</code> for sampling with
replacement generating a resampled dataset with as many observations as in
the full sample. Alternatively, this argument can be a function to use for
resampling. This function must use arguments named <code>data</code> and
<code>tau</code> and return the IDs of observations to be included in the
resampled dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpss</code></td>
<td>
<p>logical indicating if complementary pair stability selection
should be done. For this, the algorithm is applied on two non-overlapping
subsets of half of the observations. A feature is considered as selected if
it is selected for both subsamples. With this method, the data is split
<code>K/2</code> times (<code>K</code> models are fitted). Only used if
<code>PFER_method="MB"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_method</code></td>
<td>
<p>method used to compute the upper-bound of the expected
number of False Positives (or Per Family Error Rate, PFER). If
<code>PFER_method="MB"</code>, the method proposed by Meinshausen and BÃ¼hlmann
(2010) is used. If <code>PFER_method="SS"</code>, the method proposed by Shah and
Samworth (2013) under the assumption of unimodality is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_thr</code></td>
<td>
<p>threshold in PFER for constrained calibration by error
control. If <code>PFER_thr=Inf</code> and <code>FDP_thr=Inf</code>, unconstrained
calibration is used (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP_thr</code></td>
<td>
<p>threshold in the expected proportion of falsely selected
features (or False Discovery Proportion) for constrained calibration by
error control. If <code>PFER_thr=Inf</code> and <code>FDP_thr=Inf</code>, unconstrained
calibration is used (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_x</code></td>
<td>
<p>vector encoding the grouping structure among predictors. This
argument indicates the number of variables in each group. Only used for
models with group penalisation (e.g. <code>implementation=GroupPLS</code> or
<code>implementation=SparseGroupPLS</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_penalisation</code></td>
<td>
<p>logical indicating if a group penalisation should
be considered in the stability score. The use of
<code>group_penalisation=TRUE</code> strictly applies to group (not sparse-group)
penalisation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_data</code></td>
<td>
<p>logical indicating if the input datasets <code>xdata</code> and
<code>ydata</code> should be included in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating if a loading bar and messages should be
printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to the functions provided in
<code>implementation</code> or <code>resampling</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with: </p>
<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a matrix of the best stability scores for
different parameters controlling the level of sparsity in the underlying
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>a matrix of parameters controlling the level of
sparsity in the underlying algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>a matrix of the average
number of selected features by the underlying algorithm with different
parameters controlling the level of sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_s</code></td>
<td>
<p>a matrix of the
calibrated number of stably selected features with different parameters
controlling the level of sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a matrix of calibrated
thresholds in selection proportions for different parameters controlling
the level of sparsity in the underlying algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER</code></td>
<td>
<p>a matrix of
upper-bounds in PFER of calibrated stability selection models with
different parameters controlling the level of sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP</code></td>
<td>
<p>a
matrix of upper-bounds in FDP of calibrated stability selection models with
different parameters controlling the level of sparsity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_2d</code></td>
<td>
<p>a
matrix of stability scores obtained with different combinations of
parameters. Columns correspond to different thresholds in selection
proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PFER_2d</code></td>
<td>
<p>a matrix of upper-bounds in FDP obtained with
different combinations of parameters. Columns correspond to different
thresholds in selection proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP_2d</code></td>
<td>
<p>a matrix of
upper-bounds in PFER obtained with different combinations of parameters.
Columns correspond to different thresholds in selection proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selprop</code></td>
<td>
<p>a matrix of selection proportions. Columns correspond to
predictors from <code>xdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>an array of model coefficients.
Columns correspond to predictors from <code>xdata</code>. Indices along the third
dimension correspond to different resampling iterations. With multivariate
outcomes, indices along the fourth dimension correspond to outcome-specific
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a list with <code>type="variable_selection"</code>
and values used for arguments <code>implementation</code>, <code>family</code>,
<code>resampling</code>, <code>cpss</code> and <code>PFER_method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a
list with values used for arguments <code>K</code>, <code>pi_list</code>, <code>tau</code>,
<code>n_cat</code>, <code>pk</code>, <code>n</code> (number of observations),
<code>PFER_thr</code>, <code>FDP_thr</code> and <code>seed</code>. The datasets <code>xdata</code>
and <code>ydata</code> are also included if <code>output_data=TRUE</code>.</p>
</td>
</tr>
</table>
<p> For all
matrices and arrays returned, the rows are ordered in the same way and
correspond to parameter values stored in <code>Lambda</code>.
</p>


</div>