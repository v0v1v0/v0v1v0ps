<div class="container">

<table style="width: 100%;"><tr>
<td>Exam8.3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Example 8.3 from Generalized Linear Mixed Models: Modern Concepts, Methods and Applications by Walter W. Stroup (p-255)</h2>

<h3>Description</h3>

<p>Exam8.3 explains Response surface design with incomplete blocking
</p>


<h3>Author(s)</h3>


<ol>
<li>
<p>  Muhammad Yaseen (<a href="mailto:myaseen208@gmail.com">myaseen208@gmail.com</a>)
</p>
</li>
<li>
<p> Adeela Munawar (<a href="mailto:adeela.uaf@gmail.com">adeela.uaf@gmail.com</a>)
</p>
</li>
</ol>
<h3>References</h3>


<ol><li>
<p> Stroup, W. W. (2012).
<em>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications</em>.
CRC Press.
</p>
</li></ol>
<h3>See Also</h3>

<p><code>DataSet8.3</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Response Surface Design with incomplete blocking (page 255)
data(DataSet8.3)
DataSet8.3$block &lt;- factor(x = DataSet8.3$block)
DataSet8.3$aa &lt;- factor(x = DataSet8.3$a)
DataSet8.3$bb &lt;- factor(x = DataSet8.3$b)
DataSet8.3$cc &lt;- factor(x = DataSet8.3$c)

library(lmerTest)
library(lattice)

Exam8.3.fm1 &lt;-
         lmer(
             y ~ aa:bb:cc + a + b + c +
                 I(a^2) + I(b^2) + I(c^2) +
                 a*b + a*c + b*c + (1|block)
           , data = DataSet8.3
           )

##--- page 256
anova(Exam8.3.fm1, ddf = "Kenward-Roger", type = 1)


Exam8.3.fm2 &lt;-
           lmer(
                y ~ a + b + c +
                    I(a^2) + I(b^2) + I(c^2) +
                    a*b + a*c + b*c + (1|block)
              , data = DataSet8.3
              )
##--- page 257
anova(Exam8.3.fm2, ddf = "Kenward-Roger", type = 1)

##--- page 257
Exam8.3.fm3 &lt;-
        lmer(
             y ~ a + b + c +
                 I(a^2) + I(b^2) +
                 a*c + b*c + (1|block)
          , DataSet8.3
          )
anova(Exam8.3.fm3, ddf = "Kenward-Roger", type = 1)

##--- scatter plot with regression plane by using Hoerl function ( page#233)
a &lt;- seq(from = -1, to = 1, by = 1)
b &lt;- seq(from = -1, to = 1, by = 1)
c &lt;- seq(from = -1, to = 1, by = 1)
abc &lt;- expand.grid(a = a, b = b, c = c)

Yhat &lt;- NULL
for(i in 1:nrow(abc)) {
Yhat[i] &lt;- 50.08500 + 1.6*abc$a[i] + 1.69375*abc$b[i] +  0.51875*abc$c[i]-
           3.30250*I((abc$a[i])^2)-3.51500*I((abc$b)^2)[i] -
           0.52500*(abc$a)[i]*(abc$c)[i]-1.16250*(abc$b)[i]*(abc$c)[i]
}

Newdata &lt;- data.frame(abc, Yhat)
Plot1 &lt;-
  wireframe(Yhat ~ b*a, data = subset(Newdata,c==-1),
  xlab = "b", ylab = "a",
  main = "Predicte response surface at C=-1",  colorkey = FALSE,
  drape = TRUE, scales = list(arrows = FALSE),xlim=c(max(b),(min(b))),
  screen = list(z = -50, x =-70)
)

Plot2 &lt;-
  wireframe(Yhat ~ b*a, data = subset(Newdata,c==0),
  xlab = "b", ylab = "a",
  main = "Predicte response surface at C=0",  colorkey = FALSE ,
  drape = TRUE, scales = list(arrows = FALSE),xlim=c(max(b),(min(b))),
  screen = list(z = -50, x =-70)
)

Plot3 &lt;-
 wireframe(Yhat ~ b*a, data = subset(Newdata,c==1),
  xlab = "b", ylab = "a",
  main = "Predicte response surface at C=1",  colorkey = FALSE,
  drape = TRUE, scales = list(arrows = FALSE),xlim=c(max(b),(min(b))),
  screen = list(z = -50, x =-70)
)

print(Plot1)
print(Plot2)
print(Plot3)

</code></pre>


</div>