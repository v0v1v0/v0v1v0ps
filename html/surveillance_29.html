<div class="container">

<table style="width: 100%;"><tr>
<td>algo.farrington.fitGLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Poisson GLM of the Farrington procedure for a single time point</h2>

<h3>Description</h3>

<p>The function fits a Poisson regression model (GLM) with mean predictor
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_t = \alpha + \beta t</code>
</p>

<p>as specified by the Farrington procedure. If 
requested, Anscombe residuals are computed based on an initial fit
and a 2nd fit is made using weights, where base counts suspected to
be caused by earlier outbreaks are downweighted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">algo.farrington.fitGLM(response, wtime, timeTrend = TRUE,
                       reweight = TRUE, ...)
algo.farrington.fitGLM.fast(response, wtime, timeTrend = TRUE,
                            reweight = TRUE, ...)
algo.farrington.fitGLM.populationOffset(response, wtime, population,
                                        timeTrend=TRUE,reweight=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The vector of observed base counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtime</code></td>
<td>
<p>Vector of week numbers corresponding to <code>response</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeTrend</code></td>
<td>
<p>Boolean whether to fit the <code class="reqn">\beta t</code> or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reweight</code></td>
<td>
<p>Fit twice â€“ 2nd time with Anscombe residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>Population size. Possibly used as offset, i.e. in
<code>algo.farrington.fitGLM.populationOffset</code> the value 
<code>log(population)</code> is used as offset in the linear
predictor of the GLM:   
</p>
<p style="text-align: center;"><code class="reqn">\log \mu_t = \log(\texttt{population}) + \alpha + \beta t</code>
</p>

<p>This provides a way to adjust the Farrington procedure to the case
of greatly varying populations. Note: This is an experimental implementation with methodology not covered by the original paper.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Used to catch additional arguments, currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute weights from an initial fit and rescale using
Anscombe based residuals as described in the
<code>anscombe.residuals</code> function.
</p>
<p>Note that <code>algo.farrington.fitGLM</code> uses the <code>glm</code> routine
for fitting. A faster alternative is provided by
<code>algo.farrington.fitGLM.fast</code> which uses the <code>glm.fit</code>
function directly (thanks to Mikko Virtanen). This saves
computational overhead and increases speed for 500 monitored time
points by a factor of approximately two. However, some of the
routine <code>glm</code> functions might not work on the output of this
function. Which function is used for <code>algo.farrington</code> can be
controlled by the <code>control$fitFun</code> argument.
</p>


<h3>Value</h3>

<p>an object of class GLM with additional fields <code>wtime</code>,
<code>response</code> and <code>phi</code>. If the <code>glm</code> returns without
convergence <code>NULL</code> is returned.
</p>


<h3>See Also</h3>

<p><code>anscombe.residuals</code>,<code>algo.farrington</code></p>


</div>