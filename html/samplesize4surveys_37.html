<div class="container">

<table style="width: 100%;"><tr>
<td>ss4stm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size for Estimation of Means in Stratified Sampling</h2>

<h3>Description</h3>

<p>This function computes the minimum sample size required for estimating a single mean, in a stratified sampling, subject to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ss4stm(Nh, muh, sigmah, DEFFh = 1, conf = 0.95, rme = 0.03)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Nh</code></td>
<td>
<p>Vector. The population size for each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muh</code></td>
<td>
<p>Vector. The means of the variable of interest in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmah</code></td>
<td>
<p>Vector. The standard deviation of the variable of interest in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DEFFh</code></td>
<td>
<p>Vector. The design effect of the sample design in each stratum. By default <code>DEFFh = 1</code>, which corresponds to a stratified simple random sampling design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rme</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let assume that the population U is partitioned in H strate. 
Under a stratified sampling, the neccesary sample size to achieve a relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{(\sum_{h=1}^H w_h S_h)^2}{\frac{\varepsilon^2}{z^2_{1-\frac{\alpha}{2}}}+\frac{\sum_{h=1}^H w_h S^2_h}{N}}</code>
</p>
 
<p>Where </p>
<p style="text-align: center;"><code class="reqn">S^2_h = DEFF_h \sigma^2_h</code>
</p>

<p>Then, the required sample size in each stratum is given by:
</p>
<p style="text-align: center;"><code class="reqn">n_h = n \frac{w_h S_h}{\sum_{h=1}^H w_h S_h}</code>
</p>



<h3>Value</h3>

<p>The required sample size for the sample and the required sample size per stratum.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code>ss4m</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Nh &lt;- c(15000, 10000, 5000)
muh &lt;- c(300, 200, 100)
sigmah &lt;- c(200, 100, 20)
DEFFh &lt;- c(1, 1.2, 1.5)

ss4stm(Nh, muh, sigmah, rme=0.03)
ss4stm(Nh, muh, sigmah, conf = 0.99, rme=0.03)
ss4stm(Nh, muh, sigmah, DEFFh, conf= 0.99, rme=0.03)

##########################
# Example with Lucy data #
##########################
data(Lucy)
attach(Lucy)

Strata &lt;- as.factor(paste(Zone, Level))
levels(Strata)

Nh &lt;- summary(Strata)
muh &lt;- tapply(Income, Strata, mean)
sigmah &lt;- tapply(Income, Strata, sd)

ss4stm(Nh, muh, sigmah, DEFFh=1, conf = 0.95, rme = 0.03)
ss4stm(Nh, muh, sigmah, DEFFh=1.5, conf = 0.95, rme = 0.03)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

Nh &lt;- summary(Zone)
muh &lt;- tapply(Income, Zone, mean)
sigmah &lt;- tapply(Income, Zone, sd)

ss4stm(Nh, muh, sigmah, DEFFh=1, conf = 0.95, rme = 0.03)
ss4stm(Nh, muh, sigmah, DEFFh=1.5, conf = 0.95, rme = 0.03)
</code></pre>


</div>