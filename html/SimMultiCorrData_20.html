<div class="container">

<table style="width: 100%;"><tr>
<td>findintercorr_cont_nb2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Continuous - Negative Binomial Variables: Correlation Method 2</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_cont x k_nb</code> intermediate matrix of correlations for the <code>k_cont</code> continuous and
<code>k_nb</code> Negative Binomial variables. It extends the methods of Demirtas et al. (2012, doi: <a href="http://doi.org/10.1002/sim.5362">10.1002/sim.5362</a>) and
Barbiero &amp; Ferrari (2015, doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>) by:
</p>
<p>1) including non-normal continuous and count (Poisson and Negative Binomial) variables
</p>
<p>2) allowing the continuous variables to be generated via Fleishman's third-order or Headrick's fifth-order transformation, and
</p>
<p>3) since the count variables are treated as ordinal, using the point-polyserial and polyserial correlations to calculate the
intermediate correlations (similar to <code>findintercorr_cont_cat</code>).
</p>
<p>Here, the intermediate correlation between Z1 and Z2 (where Z1
is the standard normal variable transformed using Headrick's fifth-order or Fleishman's third-order method to produce a
continuous variable Y1, and Z2 is the standard normal variable used to generate a Negative Binomial variable via the inverse
cdf method) is calculated by dividing the target correlation by a correction factor.  The correction factor is the product of the
point-polyserial correlation between Y2 and Z2 (described in Olsson et al., 1982, doi: <a href="http://doi.org/10.1007/BF02294164">10.1007/BF02294164</a>)
and the power method correlation (described in Headrick &amp; Kowalchuk, 2007, doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>) between Y1 and Z1.
After the maximum support value has been found using
<code>max_count_support</code>, the point-polyserial correlation is given by:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{y2,z2} = (1/\sigma_{y2})\sum_{j = 1}^{r-1} \phi(\tau_{j})(y2_{j+1} - y2_{j})</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">\phi(\tau) = (2\pi)^{-1/2}*exp(-\tau^2/2)</code>
</p>
<p>  Here, <code class="reqn">y_{j}</code> is the j-th support
value and <code class="reqn">\tau_{j}</code> is <code class="reqn">\Phi^{-1}(\sum_{i=1}^{j} Pr(Y = y_{i}))</code>.  The power method correlation is given by:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{y1,z1} = c1 + 3c3 + 15c5</code>
</p>
<p>, where c5 = 0 if <code>method</code> = "Fleishman".  The function is used in
<code>findintercorr2</code> and <code>rcorrvar2</code>.
This function would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findintercorr_cont_nb2(method, constants, rho_cont_nb, nb_marg, nb_support)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to generate the <code>k_cont</code> continuous variables.  "Fleishman" uses Fleishman's third-order polynomial transformation
and "Polynomial" uses Headrick's fifth-order transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>a matrix with <code>k_cont</code> rows, each a vector of constants c0, c1, c2, c3 (if <code>method</code> = "Fleishman") or
c0, c1, c2, c3, c4, c5 (if <code>method</code> = "Polynomial"), like that returned by <code>find_constants</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_cont_nb</code></td>
<td>
<p>a <code>k_cont x k_nb</code> matrix of target correlations among continuous and Negative Binomial variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_marg</code></td>
<td>
<p>a list of length equal to <code>k_nb</code>; the i-th element is a vector of the cumulative
probabilities defining the marginal distribution of the i-th variable;
if the variable can take r values, the vector will contain r - 1 probabilities (the r-th is assumed to be 1);
this is created within <code>findintercorr2</code> and <code>rcorrvar2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_support</code></td>
<td>
<p>a list of length equal to <code>k_nb</code>; the i-th element is a vector of containing the r
ordered support values, with a minimum of 0 and maximum determined via <code>max_count_support</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>k_cont x k_nb</code> matrix whose rows represent the <code>k_cont</code> continuous variables and columns represent the
<code>k_nb</code> Negative Binomial variables
</p>


<h3>References</h3>

<p>Please see additional references in <code>findintercorr_cont_cat</code>.
</p>
<p>Barbiero A &amp; Ferrari PA (2015). Simulation of correlated Poisson variables. Applied Stochastic Models in
Business and Industry, 31: 669-80. doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.
</p>


<h3>See Also</h3>

<p><code>find_constants</code>, <code>power_norm_corr</code>,
<code>findintercorr2</code>, <code>rcorrvar2</code>
</p>


</div>