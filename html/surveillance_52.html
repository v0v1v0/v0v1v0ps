<div class="container">

<table style="width: 100%;"><tr>
<td>sts_animate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Animated Maps and Time Series of Disease Counts or Incidence
</h2>

<h3>Description</h3>

<p>The <code>animate</code>-method for <code>sts</code> objects
iterates over time points, plotting maps of the current|cumulative
counts|incidence via <code>stsplot_space</code>, optionally
including a time series chart below the map to track the epidemic curve.
It is worth using functionality of the <span class="pkg">animation</span> package
(e.g., <code>saveHTML</code>) to directly export the
animation into a useful format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sts'
animate(object, tps = NULL, cumulative = FALSE,
        population = NULL, at = 10, ...,
        timeplot = list(pos = 1, size = 0.3, fill = TRUE),
        sleep = 0.5, verbose = interactive(), draw = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object of class <code>"sts"</code> or a matrix of counts,
i.e., <code>observed(stsObj)</code>, where especially
<code>colnames(x)</code> have to be contained in <code>row.names(map)</code>.
If a matrix, the <code>map</code> object has to be provided explicitly (as
part of <code>...</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tps</code></td>
<td>

<p>a numeric vector of one or more time points at which to plot the map.
The default <code>tps=NULL</code> means the whole time period <code>1:nrow(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulative</code></td>
<td>

<p>logical specifying if the cumulative counts/incidence over time
should be plotted. The cumulative incidence is relative to the
population from the first time point <code>tps[1]</code> throughout the
whole animation, while <code>cumulative=FALSE</code> computes the
incidence from the current population numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population,at,...</code></td>
<td>

<p>arguments for <code>stsplot_space</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeplot</code></td>
<td>

<p>if a list and package <a href="https://CRAN.R-project.org/package=gridExtra"><span class="pkg">gridExtra</span></a> is available,
a time series chart of the counts along
the selected time points <code>tps</code> will be plotted next to the map.
The list elements determine both the positioning of this plot
(<code>pos</code>, <code>size</code>, and <code>fill</code>) and its appearance.
The default <code>pos=1</code> and <code>size=0.3</code> arguments put the time
series plot below the map, using 30% of the total plot height.
The logical value <code>fill</code> indicates whether to make the panel as
big as possible (default: TRUE). An alternative to <code>fill=FALSE</code>
is to manually specify an <code>aspect</code> (ratio) value in <code>timeplot</code>.
Other list elements are arguments for the internal (and currently
undocumented) function <code>stsplot_timeSimple</code>. For example,
<code>inactive</code> and <code>active</code> are lists of graphical parameters
(e.g., <code>col</code>) determining the appearance of the bars (e.g.,
default color is grey when inactive and black when active),
and the boolean <code>as.Date</code> determines whether dates should be
put on the x-axis (instead of the <code>tps</code> indexes).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sleep</code></td>
<td>

<p>time to wait (<code>Sys.sleep</code>) between subsequent snapshots (only if
<code>dev.interactive</code>), in seconds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical indicating if a <code>txtProgressBar</code> should be shown
during generation of the animation â€“ which may take a while.
Default is to do so in <code>interactive</code> sessions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>

<p>logical indicating if the produced plots at each time point should
be drawn directly (the default) or not.
The setting <code>draw = FALSE</code> is useful if one would like to
manually arrange the plots, which are always returned invisibly in a
list of length <code>length(tps)</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>(invisibly) a list of the <code>length(tps)</code> sequential plot objects.
These are of class <code>"gtable"</code> (from <a href="https://CRAN.R-project.org/package=gtable"><span class="pkg">gtable</span></a>)
if the <code>timeplot</code> is included, otherwise of class
<code>"\code{trellis"</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>See Also</h3>

<p>the other plot types documented in <code>stsplot</code> for static
time series plots and maps.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("measlesWeserEms")

## animate the weekly counts of measles (during weeks 12-16 only, for speed)
if (interactive() &amp;&amp; require("animation")) {
    oldwd &lt;- setwd(tempdir())  # to not clutter up the current working dir
    saveHTML(animate(measlesWeserEms, tps=12:16),
             title="Evolution of the measles epidemic in the Weser-Ems region",
             ani.width=500, ani.height=600)
    setwd(oldwd)
}

## Not run: 
## animate the weekly incidence of measles (per 100'000 inhabitants),
## and label the time series plot with dates in a specified format
animate(measlesWeserEms, tps=12:16,
        population = measlesWeserEms@map$POPULATION / 100000,
        timeplot = list(as.Date = TRUE,
                        scales = list(x = list(format = "%G/%V"))))

## End(Not run)
</code></pre>


</div>