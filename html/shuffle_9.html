<div class="container">

<table style="width: 100%;"><tr>
<td>MSbetAvg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Mean-square-between
</h2>

<h3>Description</h3>

<p>MSbetAvg calculates the mean-square-between contrast according to the design vector.
Responses for each condition are averaged, and the sample variance is calculated for these averages. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">MSbetAvg(dat, avgmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>The vector of measurements on which the constrast is computed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avgmat</code></td>
<td>

<p>The design parameters, as extracted by getAveraging(). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value of the quadratic contrast computed on the data vector.
</p>


<h3>Author(s)</h3>

<p>Yuval Benjamini
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fMRI_responses,design_vec)

msbet = MSbetAvg(fMRI_responses[1,], getAveraging(design_vec))

# Compute same value using "aov" when design is balanced ... 
ns =tapply(design_vec,design_vec, length)
# (check that design is balanced)
stopifnot(length(unique(ns))==1)

m = length(unique(design_vec))

aov_sum = summary(aov(fMRI_responses[1,] ~ factor(design_vec)))
ss_bet = aov_sum[[1]][1,2]
# In unbalanced designs, each example should require more care...
msbet_aov = (ss_bet / ns[1] )/(m-1) 

cat(msbet, msbet_aov)

</code></pre>


</div>