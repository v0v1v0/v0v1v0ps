<div class="container">

<table style="width: 100%;"><tr>
<td>influ_discrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Influential Species Detection - Trait Evolution Discrete Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of discrete (binary) characters, 
detecting influential species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">influ_discrete(
  data,
  phy,
  model,
  transform = "none",
  bounds = list(),
  cutoff = 2,
  n.cores = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data vector for a single binary trait, with names matching tips in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The Mkn model to use (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>The evolutionary model to transform the tree (see Details). Default is <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitDiscrete</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cut-off parameter for influential species (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitDiscrete</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function sequentially removes one species at a time,  
fits a model of discrete character evolution using <code>fitDiscrete</code>, 
stores the results and calculates the effects on model parameters. Currently, only 
binary discrete traits are supported.
</p>
<p><code>influ_discrete</code> detects influential species based on the standardised
difference in q12 or q21 when removing a given species compared
to the full model including all species. Species with a standardised difference
above the value of <code>cutoff</code> are identified as influential. 
</p>
<p>Different character model from <code>fitDiscrete</code> can be used, including <code>ER</code> (equal-rates), 
<code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion). 
</p>
<p>Different transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used, i.e. <code>none</code>,
<code>EB</code>, <code>lambda</code>, <code>kappa</code> and<code>delta</code>.
</p>
<p>See <code>fitDiscrete</code> for more details on character models and tree transformations.
</p>


<h3>Value</h3>

<p>The function <code>tree_discrete</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>cutoff</code>: The value selected for <code>cutoff</code>
</p>
<p><code>data</code>: The original full data vector
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>
<p><code>full.model.estimates</code>: Parameter estimates (transition rates q12 and q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for the full model.
</p>
<p><code>influential_species</code>: List of influential species, based on standardised 
difference in estimates for q12 and q21. Species are ordered from most influential to 
less influential and only include species with a standardised difference &gt; <code>cutoff</code>.
</p>
<p><code>sensi.estimates</code>: Parameter estimates (transition rates q12 and q21),,(percentual) difference 
in parameter estimate compared to the full model (DIFq12, sigsq.q12,sDIFq12, DIFq21, optpar.q21,sDIFq21),  
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for each analysis with a species deleted.
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Gustavo Paterno
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467.  
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>


<h3>See Also</h3>

<p><code>fitDiscrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Load data:
data("primates")
#Create a binary trait factor 
adultMass_binary&lt;-ifelse(primates$data$adultMass &gt; 7350, "big", "small")
adultMass_binary&lt;-as.factor(as.factor(adultMass_binary))
names(adultMass_binary)&lt;-rownames(primates$data)
#Model trait evolution accounting for influential species
influ_binary&lt;-influ_discrete(data = adultMass_binary,phy = primates$phy[[1]],
model = "SYM",transform = "none",cutoff = 2,n.cores = 2,track = TRUE)
#Print summary statistics
summary(influ_binary)
sensi_plot(influ_binary) #q12 and q21 are, as expected, exactly the same in symmetrical model. 
#Use a different evolutionary model. 
influ_binary2&lt;-influ_discrete(data = adultMass_binary,phy = primates$phy[[1]],
model = "SYM",transform = "delta",n.cores = 2,track = TRUE)
summary(influ_binary2)
sensi_plot(influ_binary2)
#Or change the cutoff and transformation
influ_binary3&lt;-influ_discrete(data = adultMass_binary,phy = primates$phy[[1]],
model = "ARD",transform = "none",cutoff = 1.2,n.cores = 2,track = TRUE)
summary(influ_binary3)
sensi_plot(influ_binary3) 

## End(Not run)
</code></pre>


</div>