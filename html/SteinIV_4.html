<div class="container">

<table style="width: 100%;"><tr>
<td>sps.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semi-parametric Stein-like (SPS) estimator.</h2>

<h3>Description</h3>

<p>Computes the SPS estimator for a two-stage structural model, as well
as the set of standard errors for each individual estimator, and
the sample estimate of the asymptotic variance/covariance matrix.</p>


<h3>Usage</h3>

<pre><code class="language-R">  sps.est(y,X,Z,SE=FALSE,ALPHA=TRUE,REF="TSLS",n.bt=100,n.btj=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric: A vector of observations, representing the outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric: A matrix of observations, whose number of columns
corresponds to the number of predictors in the model, and the number
of rows should be conformal with the number of entries in <code class="reqn">y</code>. This
matrix may contain both endogenous and exogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Numeric: A matrix of observations representing the
intrumental variables (IVs) in the first-stage structural equation. The
number of IVs should be at least as large as the number of
endogenous variables in <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Logical: If TRUE, then the function also returns the
standard errors of the individual SPS estimators, and a sample (or
bootstrap, if JIVE is selected as a reference estimator)
estimate of its asymptotic variance/covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ALPHA</code></td>
<td>
<p>Logical: If TRUE, the function returns the value of the
sample estimate of the parameter controlling the respective
contribution of the <em>reference</em> estimator (by default, this is the TSLS
estimator), and the one of the <em>alternative</em> estimator (by
default, this is the OLS estimator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REF</code></td>
<td>
<p>Character: Controls the choice of the <em>reference</em>
estimator in the SPS framework. This can accept two values: "TSLS" or "JIVE",
with the former being the default option. The <em>alternative</em>
estimator is always the OLS estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bt</code></td>
<td>
<p>Numeric: The number of bootstrap samples performed, when
the sample variance/covariance matrix is estimated using the
bootstrap. This automatically occurs, whenever the user selects the
JIVE as the reference estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.btj</code></td>
<td>
<p>Numeric: The number of boostrap iterations performed, when
computing the SPS estimator, when using the JIVE as reference
estimator. This option is only relevant, when JIVE has   
been selected as the reference estimator. These iterations are used
to compute the various components entering in the calculation of the
SPS estimator.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The SPS estimator is applied to a two-stage structural
model. We here adopt the terminology commonly used in
econometrics. See, for example, the references below for Cameron 
and Trivedi (2005), Davidson and MacKinnon (1993), as well as
Wooldridge (2002). The second-stage equation is thus modelled as follows,
</p>
<p style="text-align: center;"><code class="reqn">y = X\beta + \epsilon,</code>
</p>

<p>in which <code class="reqn">y</code> is a vector of <code class="reqn">n</code> observations representing the
outcome variable, <code class="reqn">X</code> is a matrix of order <code class="reqn">n\times k</code>
denoting the predictors of the model, and comprised of both exogenous
and endogenous variables, <code class="reqn">\beta</code> is the <code class="reqn">k</code>-dimensional
vector of parameters of interest; whereas <code class="reqn">\epsilon</code> is an unknown
vector of error terms.
The first-stage level of the model is given by a multivariate
multiple regression. That is, this is a linear modle with a
<em>multivariate</em> outcome variable, as well as <em>multiple</em>
predictors. This first-stage model is represented in this manner, 
</p>
<p style="text-align: center;"><code class="reqn">X = Z\Gamma + \Delta,</code>
</p>

<p>where <code class="reqn">X</code> is the matrix of predictors from the second-stage
equation, <code class="reqn">Z</code> is a matrix of instrumental variables (IVs) of order
<code class="reqn">n \times l</code>, <code class="reqn">\Gamma</code> is a matrix of unknown parameters of
order <code class="reqn">l\times k</code>; whereas <code class="reqn">\Delta</code> denotes an unknown matrix of order
<code class="reqn">n\times k</code> of error terms. 
</p>
<p>As for the TSLS estimator, whenever certain variables in <code class="reqn">X</code> are
assumed to be exogenous, these variables should be incorporated into 
<code class="reqn">Z</code>. That is, all the exogneous variables are their own
instruments. Moreover, it is also assumed that the model contains at
least as many instruments as predictors, in the sense that <code class="reqn">l\geq
    k</code>, as commonly donein practice (Wooldridge, 2002). Also, the matrices,
<code class="reqn">X^TX</code>, <code class="reqn">Z^TX</code>, and <code class="reqn">Z^TZ</code> are all assumed to be full
rank. Finally, both <code class="reqn">X</code> and <code class="reqn">Z</code> should comprise a column of
one's, representing the intercept in each structural equation. 
</p>
<p>The formula for the SPS estimator is then obtained as a weigthed
combination of the OLS and TSLS estimators (using the default
options), such that 
</p>
<p style="text-align: center;"><code class="reqn">\hat\beta_{SPS}(\alpha) :=
      \alpha\hat\beta_{OLS} + (1-\alpha)\hat\beta_{TSLS},</code>
</p>

<p>for every <code class="reqn">\alpha</code>. The <em>proportion parameter</em>, <code class="reqn">\alpha</code>,
controls the respective contributions of the OLS and TSLS estimators. 
(Despite our choice of name, however, note that <code class="reqn">\alpha</code> needs not be bounded
between 0 and 1.) This parameter is selected in order to minimize the
trace of the theoretical MSE of the corresponding SPS estimator,
</p>
<p style="text-align: center;"><code class="reqn">MSE(\hat\beta_{SPS}(\alpha)) 
      = E[(\bar\beta(\alpha)-\beta)(\hat\beta(\alpha)-\beta)^{T}] 
      = Var(\hat\beta(\alpha)) + Bias^{2}(\hat\beta(\alpha)),</code>
</p>

<p>where <code class="reqn">\beta\in R^{k}</code> is the true parameter of interest and the MSE is
a <code class="reqn">k\times k</code> matrix. It is particularly appealing to combine these
two estimators, because the asymptotic unbiasedness of the TSLS
estimator guarantees that the resulting SPS is asymptotically
unbiased. Thus, the MSE automatically strikes a trade-off between the
unbiasedness of the TSLS estimator and the efficiency of the OLS
estimator.   
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>A list with one or four arguments, depending on whether
the user has activated the SE flag, and the ALPHA flag. The first
element (est) in the list    
is the SPS estimate of the model in vector format. The second
element (se) is the vector of standard errors; the third
element (var) is the sample estimate of the asymptotic
variance/covariance matrix; the fourth element (alpha) is a real
number representing the estimate of the contribution of the OLS to
the combined SPS estimator.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Cedric E. Ginestet &lt;cedric.ginestet@kcl.ac.uk&gt;
</p>


<h3>References</h3>

<p>Judge, G.G. and Mittelhammer, R.C. (2004). A semiparametric basis for combining esti-
mation problems under quadratic loss. Journal of the American Statistical Association,
99(466), 479–487.
</p>
<p>Judge, G.G. and Mittelhammer, R.C. (2012a). An information theoretic approach to econo-
metrics. Cambridge University Press.
</p>
<p>Judge, G. and Mittelhammer, R. (2012b). A risk superior semiparametric estimator for
over-identified linear models. Advances in Econometrics, 237–255.
</p>
<p>Judge, G. and Mittelhammer, R. (2013). A minimum mean squared error semiparametric
combining estimator. Advances in Econometrics, 55–85.
</p>
<p>Mittelhammer, R.C. and Judge, G.G. (2005). Combining estimators to improve structural
model estimation and inference under quadratic loss. Journal of econometrics, 128(1),
1–29.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Generate a simple example with synthetic data, and no intercept. 
n &lt;- 100; k &lt;- 3; l &lt;- 3;
Ga&lt;- diag(rep(1,l)); be &lt;- rep(1,k);
Z &lt;- matrix(0,n,l); for(j in 1:l) Z[,j] &lt;- rnorm(n); 
X &lt;- matrix(0,n,k); for(j in 1:k) X[,j] &lt;- Z[,j]*Ga[j,j] + rnorm(n); 
y &lt;- X%*%be + rnorm(n);

### Compute SPS estimator with SEs and variance/covariance matrix.
print(sps.est(y,X,Z))
print(sps.est(y,X,Z,SE=TRUE));

</code></pre>


</div>