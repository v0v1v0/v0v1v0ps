<div class="container">

<table style="width: 100%;"><tr>
<td>sdmTMBpriors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prior distributions</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>Optional priors/penalties on model parameters. This results in penalized
likelihood within TMB or can be used as priors if the model is passed to
<span class="pkg">tmbstan</span> (see the Bayesian vignette).
</p>
<p><strong>Note that Jacobian adjustments are only made if <code>bayesian = TRUE</code></strong> when the
<code>sdmTMB()</code> model is fit. I.e., the final model will be fit with <span class="pkg">tmbstan</span>
and priors are specified then <code>bayesian</code> should be set to <code>TRUE</code>. Otherwise,
leave <code>bayesian = FALSE</code>.
</p>
<p><code>pc_matern()</code> is the Penalized Complexity prior for the Matern
covariance function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sdmTMBpriors(
  matern_s = pc_matern(range_gt = NA, sigma_lt = NA),
  matern_st = pc_matern(range_gt = NA, sigma_lt = NA),
  phi = halfnormal(NA, NA),
  ar1_rho = normal(NA, NA),
  tweedie_p = normal(NA, NA),
  b = normal(NA, NA),
  sigma_G = halfnormal(NA, NA)
)

normal(location = 0, scale = 1)

halfnormal(location = 0, scale = 1)

mvnormal(location = 0, scale = diag(length(location)))

pc_matern(range_gt, sigma_lt, range_prob = 0.05, sigma_prob = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matern_s</code></td>
<td>
<p>A PC (Penalized Complexity) prior (<code>pc_matern()</code>) on the
spatial random field Matérn parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matern_st</code></td>
<td>
<p>Same as <code>matern_s</code> but for the spatiotemporal random field.
Note that you will likely want to set <code>share_fields = FALSE</code> if you choose
to set both a spatial and spatiotemporal Matérn PC prior since they both
include a prior on the spatial range parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A <code>halfnormal()</code> prior for the dispersion parameter in the
observation distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar1_rho</code></td>
<td>
<p>A <code>normal()</code> prior for the AR1 random field parameter. Note
the parameter has support <code style="white-space: pre;">⁠-1 &lt; ar1_rho &lt; 1⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tweedie_p</code></td>
<td>
<p>A <code>normal()</code> prior for the Tweedie power parameter. Note the
parameter has support <code style="white-space: pre;">⁠1 &lt; tweedie_p &lt; 2⁠</code> so choose a mean appropriately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p><code>normal()</code> priors for the main population-level 'beta' effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_G</code></td>
<td>
<p><code>halfnormal()</code> priors for the random intercept SDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>Location parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scale parameter. For <code>normal()</code>/<code>halfnormal()</code>: standard
deviation(s). For <code>mvnormal()</code>: variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_gt</code></td>
<td>
<p>A value one expects the spatial or spatiotemporal range is
<strong>g</strong>reater <strong>t</strong>han with <code>1 - range_prob</code> probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_lt</code></td>
<td>
<p>A value one expects the spatial or spatiotemporal marginal
standard deviation (<code>sigma_O</code> or <code>sigma_E</code> internally) is <strong>l</strong>ess <strong>t</strong>han
with <code>1 - sigma_prob</code> probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range_prob</code></td>
<td>
<p>Probability. See description for <code>range_gt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_prob</code></td>
<td>
<p>Probability. See description for <code>sigma_lt</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Meant to be passed to the <code>priors</code> argument in <code>sdmTMB()</code>.
</p>
<p><code>normal()</code> and <code>halfnormal()</code> define normal and half-normal priors that, at
this point, must have a location (mean) parameter of 0. <code>halfnormal()</code> is the
same as <code>normal()</code> but can be used to make the syntax clearer. It is intended
to be used for parameters that have support <code style="white-space: pre;">⁠&gt; 0⁠</code>.
</p>
<p>See <a href="https://arxiv.org/abs/1503.00256">https://arxiv.org/abs/1503.00256</a> for a description of the
PC prior for Gaussian random fields. Quoting the discussion (and substituting
the argument names in <code>pc_matern()</code>):
"In the simulation study we observe good coverage of the equal-tailed 95%
credible intervals when the prior satisfies <code>P(sigma &gt; sigma_lt) = 0.05</code> and
<code>P(range &lt; range_gt) = 0.05</code>, where <code>sigma_lt</code> is between 2.5 to 40 times
the true marginal standard deviation and <code>range_gt</code> is between 1/10 and 1/2.5
of the true range."
</p>
<p>Keep in mind that the range is dependent on the units and scale of the
coordinate system. In practice, you may choose to try fitting the model
without a PC prior and then constraining the model from there. A better
option would be to simulate from a model with a given range and sigma to
choose reasonable values for the system or base the prior on knowledge from a
model fit to a similar system but with more spatial information in the data.
</p>


<h3>Value</h3>

<p>A named list with values for the specified priors.
</p>


<h3>References</h3>

<p>Fuglstad, G.-A., Simpson, D., Lindgren, F., and Rue, H. (2016) Constructing
Priors that Penalize the Complexity of Gaussian Random Fields.
arXiv:1503.00256
</p>
<p>Simpson, D., Rue, H., Martins, T., Riebler, A., and Sørbye, S. (2015)
Penalising model component complexity: A principled, practical approach to
constructing priors. arXiv:1403.4630
</p>


<h3>See Also</h3>

<p><code>plot_pc_matern()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">normal(0, 1)
halfnormal(0, 1)
mvnormal(c(0, 0))
pc_matern(range_gt = 5, sigma_lt = 1)
plot_pc_matern(range_gt = 5, sigma_lt = 1)


d &lt;- subset(pcod, year &gt; 2011)
pcod_spde &lt;- make_mesh(d, c("X", "Y"), cutoff = 30)

# - no priors on population-level effects (`b`)
# - halfnormal(0, 10) prior on dispersion parameter `phi`
# - Matern PC priors on spatial `matern_s` and spatiotemporal
#   `matern_st` random field parameters
m &lt;- sdmTMB(density ~ s(depth, k = 3),
  data = d, mesh = pcod_spde, family = tweedie(),
  share_range = FALSE, time = "year",
  priors = sdmTMBpriors(
    phi = halfnormal(0, 10),
    matern_s = pc_matern(range_gt = 5, sigma_lt = 1),
    matern_st = pc_matern(range_gt = 5, sigma_lt = 1)
  )
)

# - no prior on intercept
# - normal(0, 1) prior on depth coefficient
# - no prior on the dispersion parameter `phi`
# - Matern PC prior
m &lt;- sdmTMB(density ~ depth_scaled,
  data = d, mesh = pcod_spde, family = tweedie(),
  spatiotemporal = "off",
  priors = sdmTMBpriors(
    b = normal(c(NA, 0), c(NA, 1)),
    matern_s = pc_matern(range_gt = 5, sigma_lt = 1)
  )
)

# You get a prior, you get a prior, you get a prior!
# (except on the annual means; see the `NA`s)
m &lt;- sdmTMB(density ~ 0 + depth_scaled + depth_scaled2 + as.factor(year),
  data = d, time = "year", mesh = pcod_spde, family = tweedie(link = "log"),
  share_range = FALSE, spatiotemporal = "AR1",
  priors = sdmTMBpriors(
    b = normal(c(0, 0, NA, NA, NA), c(2, 2, NA, NA, NA)),
    phi = halfnormal(0, 10),
    # tweedie_p = normal(1.5, 2),
    ar1_rho = normal(0, 1),
    matern_s = pc_matern(range_gt = 5, sigma_lt = 1),
    matern_st = pc_matern(range_gt = 5, sigma_lt = 1))
)

</code></pre>


</div>