<div class="container">

<table style="width: 100%;"><tr>
<td>smmnonparametric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-parametric semi-Markov model specification</h2>

<h3>Description</h3>

<p>Creates a non-parametric model specification for a semi-Markov model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smmnonparametric(
  states,
  init,
  ptrans,
  type.sojourn = c("fij", "fi", "fj", "f"),
  distr,
  cens.beg = FALSE,
  cens.end = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Vector of state space of length <code class="reqn">s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Vector of initial distribution of length <code class="reqn">s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrans</code></td>
<td>
<p>Matrix of transition probabilities of the embedded Markov
chain <code class="reqn">J=(J_m)_{m}</code> of dimension <code class="reqn">(s, s)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.sojourn</code></td>
<td>
<p>Type of sojourn time (for more explanations, see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>

<ul>
<li>
<p> Array of dimension <code class="reqn">(s, s, kmax)</code> if <code>type.sojourn = "fij"</code>;
</p>
</li>
<li>
<p> Matrix of dimension <code class="reqn">(s, kmax)</code> if <code>type.sojourn = "fi"</code> or <code>"fj"</code>;
</p>
</li>
<li>
<p> Vector of length <code class="reqn">kmax</code> if the <code>type.sojourn = "f"</code>.
</p>
</li>
</ul>
<p><code class="reqn">kmax</code> is the maximum length of the sojourn times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.beg</code></td>
<td>
<p>Optional. A logical value indicating whether or not
sequences are censored at the beginning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.end</code></td>
<td>
<p>Optional. A logical value indicating whether or not
sequences are censored at the end.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a semi-Markov model object in the
non-parametric case, taking into account the type of sojourn time and the
censoring described in references. The non-parametric specification concerns
sojourn time distributions defined by the user.
</p>
<p>The difference between the Markov model and the semi-Markov model concerns
the modeling of the sojourn time. With a Markov chain, the sojourn time
distribution is modeled by a Geometric distribution (in discrete time).
With a semi-Markov chain, the sojourn time can be any arbitrary distribution.
</p>
<p>We define :
</p>

<ul>
<li>
<p> the semi-Markov kernel <code class="reqn">q_{ij}(k) = P( J_{m+1} = j, T_{m+1} - T_{m} = k | J_{m} = i )</code>;
</p>
</li>
<li>
<p> the transition matrix <code class="reqn">(p_{trans}(i,j))_{i,j} \in states</code> of the embedded Markov chain <code class="reqn">J = (J_m)_m</code>, <code class="reqn">p_{trans}(i,j) = P( J_{m+1} = j | J_m = i )</code>;
</p>
</li>
<li>
<p> the initial distribution <code class="reqn">\mu_i = P(J_1 = i) = P(Z_1 = i)</code>, <code class="reqn">i \in 1, 2, \dots, s</code>;
</p>
</li>
<li>
<p> the conditional sojourn time distributions <code class="reqn">(f_{ij}(k))_{i,j} \in states,\ k \in N ,\ f_{ij}(k) = P(T_{m+1} - T_m = k | J_m = i, J_{m+1} = j )</code>,
f is specified by the argument <code>distr</code> in the non-parametric case.
</p>
</li>
</ul>
<p>In this package we can choose different types of sojourn time.
Four options are available for the sojourn times:
</p>

<ul>
<li>
<p> depending on the present state and on the next state (<code class="reqn">f_{ij}</code>);
</p>
</li>
<li>
<p> depending only on the present state (<code class="reqn">f_{i}</code>);
</p>
</li>
<li>
<p> depending only on the next state (<code class="reqn">f_{j}</code>);
</p>
</li>
<li>
<p> depending neither on the current, nor on the next state (<code class="reqn">f</code>).
</p>
</li>
</ul>
<p>Let define <code class="reqn">kmax</code> the maximum length of the sojourn times.
If  <code>type.sojourn = "fij"</code>, <code>distr</code> is an array of dimension <code class="reqn">(s, s, kmax)</code>.
If <code>type.sojourn = "fi"</code> or <code>"fj"</code>, <code>distr</code> must be a matrix of dimension <code class="reqn">(s, kmax)</code>.
If <code>type.sojourn = "f"</code>, <code>distr</code> must be a vector of length <code class="reqn">kmax</code>.
</p>
<p>If the sequence is censored at the beginning and/or at the end, <code>cens.beg</code>
must be equal to <code>TRUE</code> and/or <code>cens.end</code> must be equal to <code>TRUE</code>.
All the sequences must be censored in the same way.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>smm</code>, smmnonparametric.
</p>


<h3>References</h3>

<p>V. S. Barbu, N. Limnios. (2008). Semi-Markov Chains and Hidden Semi-Markov
Models Toward Applications - Their Use in Reliability and DNA Analysis.
New York: Lecture Notes in Statistics, vol. 191, Springer.
</p>


<h3>See Also</h3>

<p>simulate, fitsmm, smmparametric
</p>


<h3>Examples</h3>

<pre><code class="language-R">states &lt;- c("a", "c", "g", "t")
s &lt;- length(states)

# Creation of the initial distribution
vect.init &lt;- c(1 / 4, 1 / 4, 1 / 4, 1 / 4)

# Creation of the transition matrix
pij &lt;- matrix(c(0, 0.2, 0.5, 0.3, 
                0.2, 0, 0.3, 0.5, 
                0.3, 0.5, 0, 0.2, 
                0.4, 0.2, 0.4, 0), 
              ncol = s, byrow = TRUE)

# Creation of a matrix corresponding to the 
# conditional sojourn time distributions
kmax &lt;- 6
nparam.matrix &lt;- matrix(c(0.2, 0.1, 0.3, 0.2, 
                          0.2, 0, 0.4, 0.2, 
                          0.1, 0, 0.2, 0.1, 
                          0.5, 0.3, 0.15, 0.05, 
                          0, 0, 0.3, 0.2, 
                          0.1, 0.2, 0.2, 0), 
                        nrow = s, ncol = kmax, byrow = TRUE)

semimarkov &lt;- smmnonparametric(states = states, init = vect.init, ptrans = pij, 
                               type.sojourn = "fj", distr = nparam.matrix)

semimarkov
</code></pre>


</div>