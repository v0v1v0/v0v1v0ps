<div class="container">

<table style="width: 100%;"><tr>
<td>derivative.scam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derivative of the univariate smooth model terms
</h2>

<h3>Description</h3>

<p>Function to get derivatives of the smooth model terms (currently only of the univariate smooths).
Analytical derivatives for SCOP-splines (shape constrained P-splines), finite difference approximation is used for all others                                   
</p>


<h3>Usage</h3>

<pre><code class="language-R">derivative.scam(object,smooth.number=1,deriv=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>fitted scam object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.number</code></td>
<td>
<p>ordered number of the smooth model term (1,2,...), ordered as in the formula, which derivative is needed to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>either 1 if the 1st derivative is required, or 2 if the 2nd</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>values of the derivative of the smooth term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.d</code></td>
<td>
<p>standard errors of the derivative.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

 
<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>


<h3>See Also</h3>

<p><code>scam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 set.seed(2)
n &lt;- 200
x1 &lt;- runif(n)*4-1;
f1 &lt;- exp(4*x1)/(1+exp(4*x1)) # monotone increasing smooth
x2 &lt;- sort(runif(n)*3-1)      # decreasing smooth
f2 &lt;- exp(-1.3*x2)
f &lt;- f1+ f2 
y &lt;- f+ rnorm(n)*0.2
## fit model, results, and plot...
b &lt;- scam(y~ s(x1,k=20,bs="mpi")+s(x2,k=15,bs="mpd"))

d1 &lt;- derivative.scam(b,smooth.number=1,deriv=1)

par(mfrow=c(1,2))

xx &lt;- sort(x1,index=TRUE)
plot(xx$x,d1$d[xx$ix],type="l",xlab=expression(x[1]),
     ylab=expression(df[1]/dx[1]))

d2 &lt;- derivative.scam(b,smooth.number=2,deriv=1)

xx &lt;- sort(x2,index=TRUE)
plot(xx$x,d2$d[xx$ix],type="l",xlab=expression(x[2]),
     ylab=expression(df[2]/dx[2]))

</code></pre>


</div>