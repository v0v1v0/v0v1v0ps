<div class="container">

<table style="width: 100%;"><tr>
<td>stv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Implement STV Counting Systems</h2>

<h3>Description</h3>

<p>Analyze a data frame of STV election ballot rankings and return
the elected voters and details of the steps in the election counting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stv(
  x,
  seats = 1,
  file = "",
  surplusMethod = "Cambridge",
  quotaMethod = "Droop",
  quotaFloor = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data frame with rows of ballots and columns for each
candidate. <code>x</code> must pass all checks from
<code>validateBallots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seats</code></td>
<td>
<p>an integer (default = 1) indicating candidates to elect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a character string naming a file; <code>""</code> (default) indicates 
output to the console only (default), otherwise a CSV file is created
(and thus <code>file</code> should end with <code>".csv"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surplusMethod</code></td>
<td>
<p>a character string indicating which method to use for
surplus allocation. Currently supports <code>"Cambridge"</code> (default) and
<code>"Fractional"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quotaMethod</code></td>
<td>
<p>a character string indicating which method to use for
calculation of quota. Currently supports <code>"Droop"</code> (default) and 
<code>"Hare"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quotaFloor</code></td>
<td>
<p>a logical value indicating that candidates must reach
the integer part of the quota in order to be elected if <code>"TRUE"</code> 
(default) or that they must reach the exact quota which may be 
fractional if <code>"FALSE"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Revise the details:
<code>stv()</code> first validates <code>x</code> by running the <code>validateBallots()</code> function.
Once validation is complete, it implements the selected single transferable vote
counting method. Each round of counting starts with idetification of active
ballots. Then a quota is calculated (currently only supports Droop method 
<code>floor(votes/(seats + 1)) + 1</code> and Hare method <code>floor(votes/seats)</code>)
with or without the <code>floor()</code> rounding. A tally of each candidate's vote share 
is obtained using top choices of active ballots, where a ballot stays active until it 
runs out of marked choices or gets removed during surplus reallocation. If a candidate 
reaches the quota, she/he is elected and associated surplus ballots are reallocated 
(currently only supports Cambridge and Fractional methods). If multiple candidates reach 
the quota, all of them are elected and their surpluses are all reallocated. If no candidate 
reaches the quota, then the candidate with the minimum number of votes is eliminated. 
If multiple candidates tie for minimum number of votes, one of them is selected at random 
and eliminated. The process is repeated until all of the seats are filled or the number of 
candidates still in race equals the number of unfilled seats. In the later case, 
all of the active candidates are elected.
</p>


<h3>Value</h3>

<p>The object returned is a list consisting of two components: a
vector of the elected candidates, and a data frame with rows containing
detailed results from each round of STV counting.
</p>
<p>For every round of vote counting, a row of the detailed information
contains: number of active ballots, seats to remaining to be filled,
the current quota, the maximum and minimum votes obtained by each
candidate, who was eliminated (if applicable), whether there was a
tie for elimination (indicated by how many tied), who was elected
(if applicable), the surplus if elected (or multiple surpluses if
multiple candidates were elected), and each candidate's votes tally
for that round.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ballots)
cballots &lt;- cleanBallots(ballots)

set.seed(1)
result1 &lt;- stv(cballots, seats = 4)
names(result1)
result1$elected

set.seed(4)
result2 &lt;- stv(cballots, seats = 4)
result2$elected

## Not run: 
result3 &lt;- stv(cballots, seats = 4, surplusMethod = "Fractional")
result3$elected

result4 &lt;- stv(cballots, seats = 4, surplusMethod = "Fractional",
               quotaMethod = "Hare")
result4$elected

result5 &lt;- stv(cballots, seats = 4, surplusMethod = "Cambridge",
               quotaMethod = "Hare")
result5$elected

## End(Not run)

</code></pre>


</div>