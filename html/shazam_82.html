<div class="container">

<table style="width: 100%;"><tr>
<td>shmulateSeq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate mutations in a single sequence</h2>

<h3>Description</h3>

<p>Generates random mutations in a sequence iteratively using a targeting model.
Targeting probabilities at each position are updated after each iteration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shmulateSeq(
  sequence,
  numMutations,
  targetingModel = HH_S5F,
  start = 1,
  end = nchar(sequence),
  frequency = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>
<p>sequence string in which mutations are to be introduced.
Accepted alphabet: <code>{A, T, G, C, N, .}</code>. Note
that <code>-</code> is not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numMutations</code></td>
<td>
<p>a whole number indicating the number of mutations to be 
introduced into <code>sequence</code>, if <code>frequency=FALSE</code>.
A fraction bewteen 0 and 1 indicating the mutation frequency
if <code>frequency=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetingModel</code></td>
<td>
<p>5-mer TargetingModel object to be used for computing 
probabilities of mutations at each position. Defaults to
HH_S5F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Initial position in <code>sequence</code> where mutations can 
be introduced. Default: 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>Last position in <code>sequence</code> where mutations can 
be introduced. Default: last position (sequence length).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequency</code></td>
<td>
<p>If <code>TRUE</code>, treat <code>numMutations</code> as a frequency.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the input <code>sequence</code> has a non-triplet overhang at the end, it will be trimmed
to the last codon. For example, <code>ATGCATGC</code> will be trimmed to <code>ATGCAT</code>.
</p>
<p>Mutations are not introduced to positions in the input <code>sequence</code> that contain 
<code>.</code> or <code>N</code>.
</p>
<p>With <code>frequency=TRUE</code>, the number of mutations introduced is the <code>floor</code> of 
the length of the sequence multiplied by the mutation frequency specified via
<code>numMutations</code>.
</p>


<h3>Value</h3>

<p>A string defining the mutated sequence.
</p>


<h3>See Also</h3>

<p>See shmulateTree for imposing mutations on a lineage tree. 
See HH_S5F and MK_RS5NF for predefined 
TargetingModel objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define example input sequence
sequence &lt;- "NGATCTGACGACACGGCCGTGTATTACTGTGCGAGAGATA.TTTA"

# Simulate using the default human 5-mer targeting model
# Introduce 6 mutations
shmulateSeq(sequence, numMutations=6, frequency=FALSE)

# Introduction 5% mutations
shmulateSeq(sequence, numMutations=0.05, frequency=TRUE)

</code></pre>


</div>