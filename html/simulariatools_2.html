<div class="container">

<table style="width: 100%;"><tr>
<td>contourPlot2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>New contour plot of pollutant concentration field</h2>

<h3>Description</h3>

<p><code>contourPlot2</code> plots a contour map of a given quantity, such as the
ground concentration of an airborne pollutant or odour, defined on a
regular grid.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contourPlot2(
  data,
  x = "x",
  y = "y",
  z = "z",
  domain = NULL,
  background = NULL,
  underlayer = NULL,
  overlayer = NULL,
  legend = NULL,
  levels = NULL,
  size = 0,
  fill = TRUE,
  tile = FALSE,
  transparency = 0.75,
  colors = NULL,
  bare = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataframe in long format, with three columns for Easting,
Northing and values to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>name of the column with Easting data (default "x").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>name of the column with Northing data (default "y").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>name of the column with the values to be plotted (default
"z").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>optional list with six numeric values defining the
boundaries of the domain to be plotted: minimum X, maximum X, minimum Y,
maximum Y, number of ticks on X axis, number of ticks on Y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>optional path to a png file to be plotted as the base map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>underlayer</code></td>
<td>
<p>optional list of layers to be plotted between base map
and contour plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlayer</code></td>
<td>
<p>optional list of layers to be plotted on top of the contour
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>optional title of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>numeric vector of levels for contour plot. If not set,
automatic pretty levels are computed. If <code>-Inf</code> and <code>Inf</code> are used as the lowest
and highest limits of the array, the lowest and highest bands are unbounded
and the legend shows <code>&lt;</code> and <code>&gt;=</code> symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>thickness of the contour line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>boolean (default TRUE). If TRUE the contour plot is filled with
colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tile</code></td>
<td>
<p>boolean (default FALSE). If TRUE rectangular tiles are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transparency</code></td>
<td>
<p>transparency level of the contour plot between 0.0
(fully transparent) and 1.0 (fully opaque). Default = 0.75).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>colour palette for contour plot, as an array of colours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bare</code></td>
<td>
<p>boolean (default FALSE). If TRUE only the bare plot is shown:
axis, legend, titles and any other graphical element of the plot are removed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a convenience function to plot contour levels of a scalar quantity
such as pollutants computed by a dispersion model, with <code>ggplot2</code>
version &gt;= 3.3.0.
</p>
<p>Data are required to be on a regular grid, typically (but not necessarily)
in UTM coordinates. The input dataframe has to be in long format, i.e. one
line per value to be plotted. The names of the columns corresponding to <code>x</code>,
<code>y</code> and <code>z</code> can be specified in the input parameters.
</p>
<p>If <code>tile = TRUE</code> data are shown as they are, without any graphical
interpolation required for contour plots. This is helpful when you want to
visualise the raw data.
Since version 2.4.0, when <code>tile = TRUE</code> the intervals include the lowest
bound and exclude the highest bound: <code style="white-space: pre;">⁠[min, max)⁠</code>. Note: In previous version
it was the opposite.
</p>
<p><code>underlayer</code> and <code>overlayer</code> layers are <code>ggplot2</code> objects to be shown at
different levels of the vertical stack of the plot. These are useful to
show topographical information related to the plot, such as sources
or receptors locations.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example data in long format
data(volcano)
volcano3d &lt;- reshape2::melt(volcano)
names(volcano3d) &lt;- c("x", "y", "z")
# Contour plot with default options
v &lt;- contourPlot2(volcano3d)
v

# Set levels, and properly format the legend title:
contourPlot2(volcano3d, 
             levels = c(-Inf, seq(100, 200, 20), Inf),
             legend = expression(PM[10]~"["~mu*g~m^-3~"]"))

# Sometimes, instead of a contour plot it is better to plot the original
# raster data, without any interpolation:
contourPlot2(volcano3d, 
             levels = c(-Inf, seq(100, 200, 20), Inf), 
             tile = TRUE)

# Since contourPlot2 returns a `ggplot2` object, you can add instructions as:
library(ggplot2)
v + ggtitle("Example volcano data") +
    labs(x = NULL, y = NULL)

</code></pre>


</div>