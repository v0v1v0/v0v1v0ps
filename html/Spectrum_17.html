<div class="container">

<table style="width: 100%;"><tr>
<td>Spectrum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectrum: Fast Adaptive Spectral Clustering for Single and Multi-view Data</h2>

<h3>Description</h3>

<p>Spectrum is a self-tuning spectral clustering method for single or multi-view data. Spectrum uses a new type of adaptive
density-aware kernel that strengthens connections between points that share common nearest neighbours in the graph. 
For integrating multi-view data and reducing noise a tensor product graph data integration and diffusion procedure is used. 
Spectrum analyses eigenvector variance or distribution to determine the number of clusters. Spectrum is well suited for a wide 
range of data, including both Gaussian and non-Gaussian structures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Spectrum(data, method = 1, silent = FALSE, showres = TRUE,
  diffusion = TRUE, kerneltype = c("density", "stsc"), maxk = 10,
  NN = 3, NN2 = 7, showpca = FALSE, frac = 2, thresh = 7,
  fontsize = 18, dotsize = 3, tunekernel = FALSE,
  clusteralg = "GMM", FASP = FALSE, FASPk = NULL, fixk = NULL,
  krangemax = 10, runrange = FALSE, diffusion_iters = 4,
  KNNs_p = 10, missing = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame or list of data frames: contains the data with points to cluster as columns and rows as features. For multi-view data a list of dataframes is to be supplied with the samples in the same order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Numerical value: 1 = default eigengap method (Gaussian clusters), 2 = multimodality gap method (Gaussian/ non-Gaussian clusters), 3 = no automatic method (see fixk param)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Logical flag: whether to turn off messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showres</code></td>
<td>
<p>Logical flag: whether to show the results on the screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffusion</code></td>
<td>
<p>Logical flag: whether to perform graph diffusion to reduce noise (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kerneltype</code></td>
<td>
<p>Character string: 'density' (default) = adaptive density aware kernel, 'stsc' = Zelnik-Manor self-tuning kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxk</code></td>
<td>
<p>Numerical value: the maximum number of expected clusters (default=10). This is data dependent, do not set excessively high.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN</code></td>
<td>
<p>Numerical value: kernel param, the number of nearest neighbours to use sigma parameters (default=3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN2</code></td>
<td>
<p>Numerical value: kernel param, the number of nearest neighbours to use for the common nearest neigbours (default = 7)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showpca</code></td>
<td>
<p>Logical flag: whether to show pca when running on one view</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Numerical value: optk search param, fraction to find the last substantial drop (multimodality gap method param)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Numerical value: optk search param, how many points ahead to keep searching (multimodality gap method param)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize</code></td>
<td>
<p>Numerical value: controls font size of the ggplot2 plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dotsize</code></td>
<td>
<p>Numerical value: controls the dot size of the ggplot2 plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tunekernel</code></td>
<td>
<p>Logical flag: whether to tune the kernel, only applies for method 2 (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusteralg</code></td>
<td>
<p>Character string: clustering algorithm for eigenvector matrix (GMM or km)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FASP</code></td>
<td>
<p>Logical flag: whether to use Fast Approximate Spectral Clustering (for v. high sample numbers)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FASPk</code></td>
<td>
<p>Numerical value: the number of centroids to compute when doing FASP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixk</code></td>
<td>
<p>Numerical value: if we are just performing spectral clustering without automatic selection of K, set this parameter and method to 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>krangemax</code></td>
<td>
<p>Numerical value: the maximum K value to iterate towards when running a range of K</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runrange</code></td>
<td>
<p>Logical flag: whether to run a range of K or not (default=FALSE), puts Kth results into Kth element of list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffusion_iters</code></td>
<td>
<p>Numerical value: number of diffusion iterations for the graph (default=4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KNNs_p</code></td>
<td>
<p>Numerical value: number of KNNs when making KNN graph (default=10, suggested=10-20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>Logical flag: whether to impute missing data in multi-view analysis (default=FALSE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list, containing: 
1) cluster assignments, in the same order as input data columns 
2) eigenvector analysis results (either eigenvalues or dip test statistics)
3) optimal K
4) final similarity matrix
5) eigenvectors and eigenvalues of graph Laplacian
</p>


<h3>Examples</h3>

<pre><code class="language-R">res &lt;- Spectrum(brain[[1]][,1:50])
</code></pre>


</div>