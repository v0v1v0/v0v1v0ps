<div class="container">

<table style="width: 100%;"><tr>
<td>covariance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defines and computes covariance functions</h2>

<h3>Description</h3>

<p>This function defines and computes several covariance
function either from a fitted “max-stable” model; either by
specifying directly the covariance parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covariance(fitted, nugget, sill, range, smooth, smooth2 = NULL, cov.mod =
"whitmat", plot = TRUE, dist, xlab, ylab, col = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class “maxstab”. Most often this will be
the output of the <code>fitmaxstab</code> function. May be missing
if <code>sill</code>, <code>range</code>, <code>smooth</code> and <code>cov.mod</code> are
given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget,sill,range,smooth,smooth2</code></td>
<td>
<p>The nugget, sill, scale and smooth parameters
for the covariance function. May be missing if <code>fitted</code> is
given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>Character string. The name of the covariance
model. Must be one of "whitmat", "cauchy", "powexp", "bessel" or
"caugen" for the Whittle-Matern, Cauchy, Powered Exponential, Bessel
and Generalized Cauchy models. May be missing if <code>fitted</code> is
given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default) the covariance function
is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A numeric vector corresponding to the distance at which
the covariance function should be evaluated. May be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>The x-axis and y-axis labels. May be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The color to be used for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Several option to be passed to the <code>plot</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently, four covariance functions are defined: the Whittle-Matern,
powered exponential (also known as "stable"), Cauchy and Bessel
models. These covariance functions are defined as follows for <code class="reqn">h &gt;
    0</code>
</p>

<dl>
<dt>Whittle-Matern</dt>
<dd>
<p><code class="reqn">\gamma(h) = \sigma
	\frac{2^{1-\kappa}}{\Gamma(\kappa)} \left(\frac{h}{\lambda}
	\right)^{\kappa} K_{\kappa}\left(\frac{h}{\lambda} \right)</code></p>
</dd>
<dt>Powered Exponential</dt>
<dd>
<p><code class="reqn">\gamma(h) = \sigma \exp \left[-
	\left(\frac{h}{\lambda} \right)^{\kappa} \right]</code></p>
</dd>
<dt>Cauchy</dt>
<dd>
<p><code class="reqn">\gamma(h) = \sigma \left[1 + \left(\frac{h}{\lambda}
	\right)^2 \right]^{-\kappa}</code></p>
</dd>
<dt>Bessel</dt>
<dd>
<p><code class="reqn">\gamma(h) = \sigma \left(\frac{2
	  \lambda}{h}\right)^{\kappa} \Gamma(\kappa + 1)
	J_{\kappa}\left(\frac{h}{\lambda} \right)</code></p>
</dd>
<dt>Generalized Cauchy</dt>
<dd>
<p><code class="reqn">\gamma(h) = \sigma \left\{1 +
    \left(\frac{h}{\lambda} \right)^{\kappa_2} \right\}^{-\kappa /
    \kappa_2}</code></p>
</dd>
</dl>
<p>where <code class="reqn">\sigma</code>, <code class="reqn">\lambda</code> and
<code class="reqn">\kappa</code> are the sill, the range and shape parameters,
<code class="reqn">\Gamma</code> is the gamma function,
<code class="reqn">K_{\kappa}</code> and  <code class="reqn">J_\kappa</code> are both
modified Bessel functions of order <code class="reqn">\kappa</code>. In addition
a nugget effect can be set that is there is a jump at the origin,
i.e., <code class="reqn">\gamma(o) = \nu + \sigma</code>, where
<code class="reqn">\nu</code> is the nugget effect.
</p>


<h3>Value</h3>

<p>This function returns the covariance function. Eventually, if
<code>dist</code> is given, the covariance function is computed for each
distance given by <code>dist</code>. If <code>plot = TRUE</code>, the covariance
function is plotted.</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1- Calling covariance using fixed covariance parameters
covariance(nugget = 0, sill = 1, range = 1, smooth = 0.5, cov.mod = "whitmat")
covariance(nugget = 0, sill = 0.5, range = 1, smooth = 0.5, cov.mod = "whitmat",
  dist = seq(0,5, 0.2), plot = FALSE)

## 2- Calling covariance from a fitted model
##Define the coordinate of each location
n.site &lt;- 30
locations &lt;- matrix(runif(2*n.site, 0, 10), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(30, locations, cov.mod = "whitmat", nugget = 0, range =
3, smooth = 1)

##Fit a max-stable model
fitted &lt;- fitmaxstab(data, locations, "whitmat", nugget = 0)
covariance(fitted, ylim = c(0, 1))
covariance(nugget = 0, sill = 1, range = 3, smooth = 1, cov.mod = "whitmat", add =
TRUE, col = 3)
title("Whittle-Matern covariance function")
legend("topright", c("Theo.", "Fitted"), lty = 1, col = c(3,1), inset =
.05)
</code></pre>


</div>