<div class="container">

<table style="width: 100%;"><tr>
<td>do_BoxPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Box Plots.</h2>

<h3>Description</h3>

<p>Generate Box Plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_BoxPlot(
  sample,
  feature,
  group.by = NULL,
  split.by = NULL,
  assay = NULL,
  slot = "data",
  font.size = 14,
  font.type = "sans",
  axis.text.x.angle = 45,
  colors.use = NULL,
  na.value = "grey75",
  plot.title = NULL,
  plot.subtitle = NULL,
  plot.caption = NULL,
  xlab = NULL,
  ylab = NULL,
  legend.title = NULL,
  legend.title.position = "top",
  legend.position = "bottom",
  boxplot.line.color = "black",
  outlier.color = "black",
  outlier.alpha = 0.5,
  boxplot.linewidth = 0.5,
  boxplot.width = NULL,
  plot.grid = TRUE,
  grid.color = "grey75",
  grid.type = "dashed",
  flip = FALSE,
  order = FALSE,
  use_silhouette = FALSE,
  use_test = FALSE,
  comparisons = NULL,
  test = "wilcox.test",
  map_signif_level = TRUE,
  plot.title.face = "bold",
  plot.subtitle.face = "plain",
  plot.caption.face = "italic",
  axis.title.face = "bold",
  axis.text.face = "plain",
  legend.title.face = "bold",
  legend.text.face = "plain"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p><strong><code>Seurat</code></strong> | A Seurat object, generated by CreateSeuratObject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature</code></td>
<td>
<p><strong><code>character</code></strong> | Feature to represent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p><strong><code>character</code></strong> | Metadata variable to group the output by. Has to be a character of factor column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.by</code></td>
<td>
<p><strong><code>character</code></strong> | Secondary metadata variable to further group (split) the output by. Has to be a character of factor column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p><strong><code>character</code></strong> | Assay to use. Defaults to the current assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p><strong><code>character</code></strong> | Data slot to use. Only one of: counts, data, scale.data. Defaults to "data".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.size</code></td>
<td>
<p><strong><code>numeric</code></strong> | Overall font size of the plot. All plot elements will have a size relationship with this font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.type</code></td>
<td>
<p><strong><code>character</code></strong> | Base font family for the plot. One of:
</p>

<ul>
<li> <p><em><code>mono</code></em>: Mono spaced font.
</p>
</li>
<li> <p><em><code>serif</code></em>: Serif font family.
</p>
</li>
<li> <p><em><code>sans</code></em>: Default font family.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.x.angle</code></td>
<td>
<p><strong><code>numeric</code></strong> | Degree to rotate the X labels. One of: 0, 45, 90.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors.use</code></td>
<td>
<p><strong><code>named_vector</code></strong> | Named vector of valid color representations (either name of HEX codes) with as many named colors as unique values of group.by. If group.by is not provided, defaults to the unique values of Idents. If not provided, a color scale will be set by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.value</code></td>
<td>
<p><strong><code>character</code></strong> | Color value for NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title, plot.subtitle, plot.caption</code></td>
<td>
<p><strong><code>character</code></strong> | Title, subtitle or caption to use in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p><strong><code>character</code></strong> | Titles for the X and Y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>
<p><strong><code>character</code></strong> | Title for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title.position</code></td>
<td>
<p><strong><code>character</code></strong> | Position for the title of the legend. One of:
</p>

<ul>
<li> <p><em><code>top</code></em>: Top of the legend.
</p>
</li>
<li> <p><em><code>bottom</code></em>: Bottom of the legend.
</p>
</li>
<li> <p><em><code>left</code></em>: Left of the legend.
</p>
</li>
<li> <p><em><code>right</code></em>: Right of the legend.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p><strong><code>character</code></strong> | Position of the legend in the plot. One of:
</p>

<ul>
<li> <p><em><code>top</code></em>: Top of the figure.
</p>
</li>
<li> <p><em><code>bottom</code></em>: Bottom of the figure.
</p>
</li>
<li> <p><em><code>left</code></em>: Left of the figure.
</p>
</li>
<li> <p><em><code>right</code></em>: Right of the figure.
</p>
</li>
<li> <p><em><code>none</code></em>: No legend is displayed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxplot.line.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the borders of the boxplots if use_silhouette is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the outlier dots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.alpha</code></td>
<td>
<p><strong><code>numeric</code></strong> | Alpha applied to the outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxplot.linewidth</code></td>
<td>
<p><strong><code>numeric</code></strong> | Width of the lines in the boxplots. Also controls the lines of the tests applied if use_test is set to true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxplot.width</code></td>
<td>
<p><strong><code>numeric</code></strong> | Width of the boxplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.grid</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to plot grid lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the grid in the plot. In heatmaps, color of the border of the cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.type</code></td>
<td>
<p><strong><code>character</code></strong> | One of the possible linetype options:
</p>

<ul>
<li> <p><em><code>blank</code></em>.
</p>
</li>
<li> <p><em><code>solid</code></em>.
</p>
</li>
<li> <p><em><code>dashed</code></em>.
</p>
</li>
<li> <p><em><code>dotted</code></em>.
</p>
</li>
<li> <p><em><code>dotdash</code></em>.
</p>
</li>
<li> <p><em><code>longdash</code></em>.
</p>
</li>
<li> <p><em><code>twodash</code></em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to invert the axis of the displayed plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to order the boxplots by average values. Can not be used alongside split.by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_silhouette</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to color the borders of the boxplots instead of the inside area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_test</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to apply a statistical test to a given pair of elements. Can not be used alongside split.by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparisons</code></td>
<td>
<p>A list of length-2 vectors. The entries in the vector are
either the names of 2 values on the x-axis or the 2 integers that
correspond to the index of the columns of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the name of the statistical test that is applied to the values of
the 2 columns (e.g. <code>t.test</code>, <code>wilcox.test</code> etc.). If you implement a
custom test make sure that it returns a list that has an entry called
<code>p.value</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_signif_level</code></td>
<td>
<p>Boolean value, if the p-value are directly written as
annotation or asterisks are used instead. Alternatively one can provide a
named numeric vector to create custom mappings from p-values to annotation:
For example: <code>c("***"=0.001, "**"=0.01, "*"=0.05)</code>.
Alternatively, one can provide a function that takes a numeric argument
(the p-value) and returns a string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.face, plot.subtitle.face, plot.caption.face, axis.title.face, axis.text.face, legend.title.face, legend.text.face</code></td>
<td>
<p><strong><code>character</code></strong> | Controls the style of the font for the corresponding theme element.  One of:
</p>

<ul>
<li> <p><em><code>plain</code></em>: For normal text.
</p>
</li>
<li> <p><em><code>italic</code></em>: For text in itallic.
</p>
</li>
<li> <p><em><code>bold</code></em>: For text in bold.
</p>
</li>
<li> <p><em><code>bold.italic</code></em>: For text both in itallic and bold.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Check Suggests.
  value &lt;- SCpubr:::check_suggests(function_name = "do_BoxPlot", passive = TRUE)

  if (isTRUE(value)){
    # Consult the full documentation in https://enblacar.github.io/SCpubr-book/

    # Define your Seurat object.
    sample &lt;- readRDS(system.file("extdata/seurat_dataset_example.rds", package = "SCpubr"))

    # Basic box plot.
    p &lt;- SCpubr::do_BoxPlot(sample = sample,
                            feature = "nCount_RNA")
    p

    # Use silhouette style.
    p &lt;- SCpubr::do_BoxPlot(sample = sample,
                            feature = "nCount_RNA",
                            use_silhouette = TRUE)
    p

    # Order by mean values.
    p &lt;- SCpubr::do_BoxPlot(sample = sample,
                            feature = "nCount_RNA",
                            order = TRUE)
    p

    # Apply second grouping.
    sample$orig.ident &lt;- ifelse(sample$seurat_clusters %in% c("0", "1", "2", "3"), "A", "B")
    p &lt;- SCpubr::do_BoxPlot(sample = sample,
                            feature = "nCount_RNA",
                            split.by = "orig.ident")
    p

    # Apply statistical tests.
    p &lt;- SCpubr::do_BoxPlot(sample = sample,
                            feature = "nCount_RNA",
                            group.by = "orig.ident",
                            use_test = TRUE,
                            comparisons = list(c("A", "B")))
    p

  } else if (base::isFALSE(value)){
    message("This function can not be used without its suggested packages.")
    message("Check out which ones are needed using `SCpubr::state_dependencies()`.")
  }

</code></pre>


</div>