<div class="container">

<table style="width: 100%;"><tr>
<td>pbmseBHF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric bootstrap mean squared error estimators of the EBLUPs of means obtained under a nested error linear regression model.</h2>

<h3>Description</h3>

<p>Calculates, for selected domains, parametric bootstrap mean squared error  
estimators of the EBLUPs of means, when EBLUPs are obtained from a nested error linear regression model.</p>


<h3>Usage</h3>

<pre><code class="language-R">pbmseBHF(formula, dom, selectdom, meanxpop, popnsize, B = 200, method = "REML", 
         data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): 
a symbolic description of the model to be fitted. The details of model 
specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dom</code></td>
<td>
<p><code>n*1</code> vector or factor (same size as <code>y</code> in <code>formula</code>) with domain codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectdom</code></td>
<td>
<p><code>I*1</code> optional vector or factor with the domain codes for which we 
want to estimate the means. It must be a subset of the domain codes in <code>dom</code>. 
If this parameter is not included all the domain codes included in <code>dom</code> 
are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanxpop</code></td>
<td>
<p><code>D*(p+1)</code> data frame with domain codes in the first column. Each remaining column contains the  
population means of each of the <code>p</code> auxiliary variables for the D domains. 
The domains considered in <code>meanxpop</code> must contain those specified in <code>selectdom</code> (D&gt;=I).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popnsize</code></td>
<td>
<p><code>D*2</code> data frame with domain codes in the first column
and the corresponding domain population sizes in the second column. 
The domains considered in <code>popnsize</code> must contain those specified in <code>selectdom</code> (D&gt;=I).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replicates. Default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string. If <code>"REML"</code> the model is fitted by maximizing the restricted 
log-likelihood. If <code>"ML"</code> the log-likelihood is maximized. Defaults to <code>"REML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in <code>formula</code> and <code>dom</code>. By default the variables are taken from the environment from which <code>pbmseBHF</code> is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses random number generation. To fix the seed, use <code>set.seed</code>.
</p>
<p>A typical model has the form response ~ terms where response is the (numeric) response vector and 
terms is a series of terms which specifies a linear predictor for response. A terms specification of 
the form first + second indicates all the terms in first together with all the terms in second with 
duplicates removed. 
</p>
<p>A formula has an implied intercept term. To remove this use either y ~ x - 1 or y ~ 0 + x. See <code>formula</code> 
for more details of allowed formulae. 
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>a list with the results of the estimation process: <code>eblup</code> and <code>fit</code>. For the description of these objects, see Value of  <code>eblupBHF</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>data frame with number of rows equal to number of selected domains, containing in its columns the domain codes (<code>domain</code>) and the parametric bootstrap mean squared error estimators (<code>mse</code>).</p>
</td>
</tr>
</table>
<p>Cases with NA values in <code>formula</code> or <code>dom</code> are ignored. 
</p>


<h3>References</h3>

<p>- Gonzalez-Manteiga, W., Lombardia, M., Molina, I., Morales, D. and Santamaria, L. (2008). Analytic and bootstrap approximations of prediction errors under a multivariate Fay-Herriot model. Computational Statistics and Data Analysis 52, 5242-5252.
</p>
<p>- Molina, I. and Rao, J.N.K. (2010). Small Area Estimation of Poverty Indicators. The Canadian Journal of Statistics 38, 369-385.
</p>


<h3>See Also</h3>

 <p><code>eblupBHF</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data set for segments (units within domains)
data(cornsoybean)

# Load data set for counties
data(cornsoybeanmeans)
attach(cornsoybeanmeans)

# Construct data frame with county means of auxiliary variables for 
# domains. First column must include the county code
Xmean &lt;- data.frame(CountyIndex, MeanCornPixPerSeg, MeanSoyBeansPixPerSeg)
Popn  &lt;- data.frame(CountyIndex, PopnSegments)

# Compute parametric bootstrap MSEs of the EBLUPs of means of crop areas 
# for each county.
set.seed(123) 
result &lt;- pbmseBHF(CornHec ~ CornPix + SoyBeansPix, dom=County,
                   selectdom=c(10,1,5), meanxpop=Xmean, popnsize=Popn,
                   B=50, data=cornsoybean)
result

detach(cornsoybeanmeans)
</code></pre>


</div>