<div class="container">

<table style="width: 100%;"><tr>
<td>elev.com</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Test for equal elevation among several lines fitted with (standardised) major axes of common slope. </h2>

<h3>Description</h3>

<p>Test if several major axis or standardised major axis lines share a common elevation. 
This can now be done via <code>sma(y~x+groups)</code>, see help on the <code>sma</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">elev.com(y, x, groups, data = NULL, method = 'SMA', alpha = 0.05, robust=FALSE,
  V = array(0, c(2, 2, length(unique(groups)))),
  group.names = sort(unique(groups)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> The Y-variable for all observations (as a vector). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> The X-variable for all observations (as a vector). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p> Coding variable identifying which group each observation belongs to (as a factor or vector). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> The line fitting method: 
</p>

<dl>
<dt>'SMA' or 1</dt>
<dd>
<p> standardised major axis (this is the default) </p>
</dd>
<dt>'MA' or 2</dt>
<dd>
<p> major axis </p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> The desired confidence level for the 100(1-alpha)% confidence interval for the common elevation. (Default value is 0.05, which returns a 95% confidence interval.) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p> The estimated variance matrices of measurement error, for each group. This is a 3-dimensional array with measurement error in Y in the first row and column, error in X in the second row and column,and groups running along the third dimension. Default is that there is no measurement error. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.names</code></td>
<td>
<p> (optional: rarely required). A vector containing the labels for ‘groups’. (Only actually useful for reducing computation time in simulation work). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates a Wald statistic to test for equal elevation of several MA's or SMA's with a common slope. This is done by testing for equal mean residual scores across groups.
</p>
<p>Note that this test is only valid if it is reasonable to assume that the axes for the different groups all have the same slope.
</p>
<p>The test assumes the following:
</p>

<ul>
<li>
<p> each group of observations was independently sampled
</p>
</li>
<li>
<p> the axes fitted to all groups have a common slope
</p>
</li>
<li>
<p> y and x are linearly related within each group
</p>
</li>
<li>
<p> residual scores independently follow a normal distribution with equal variance at all points along the line, within each group
</p>
</li>
</ul>
<p>Note that we do not need to assume equal variance across groups, unlike in tests comparing several linear regression lines.
</p>
<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code>plot.sma</code> function. On a residual plot, if there is a distinct increasing or decreasing trend within any of the groups, this suggests that all groups do not share a common slope.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>
<p>The common slope (<code class="reqn">\hat{\beta}</code>) is estimated from a maximum of 100 iterations, convergence is reached when the change in <code class="reqn">\hat{\beta} &lt; 10^{-6}</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat </code></td>
<td>
<p>The Wald statistic testing for no shift along the common axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>The P-value of the test. This is calculated assuming that stat has a chi-square distribution with (g-1) df, if there are g groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a </code></td>
<td>
<p>The estimated common elevation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci </code></td>
<td>
<p>A 100(1-alpha)% confidence interval for the true common elevation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as </code></td>
<td>
<p>Separate elevation estimates for each group</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259–291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

 <p><code>sma</code>, <code>plot.sma</code>, <code>line.cis</code>, <code>slope.com</code>, <code>shift.com</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load leaf longevity data
data(leaflife)

# Test for common SMA slope amongst species at low soil nutrient sites
# with different rainfall:
leaf.low.soilp &lt;- subset(leaflife, soilp == 'low')
with(leaf.low.soilp, slope.com(log10(longev), log10(lma), rain))

# Now test for common elevation of the groups fitted with an axis
# of common slope, at low soil nutrient sites:
with(leaf.low.soilp, elev.com(log10(longev), log10(lma), rain))

# Or test for common elevation amongst the MA's of common slope,
# for low soil nutrient sites, and construct 99% a confidence interval
# for the common elevation:
with(leaf.low.soilp, elev.com(log10(longev), log10(lma), rain, method='MA',
   alpha=0.01))
</code></pre>


</div>