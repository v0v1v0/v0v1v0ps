<div class="container">

<table style="width: 100%;"><tr>
<td>LMTrainer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Models Trainer</h2>

<h3>Description</h3>

<p>Trains regression, lasso, ridge model in R
</p>


<h3>Details</h3>

<p>Trains linear models such as Logistic, Lasso or Ridge regression model. It is built on glmnet R package.
This class provides fit, predict, cross valdidation functions.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>family</code></dt>
<dd>
<p>type of regression to perform, values can be "gaussian" ,"binomial", "multinomial","mgaussian"</p>
</dd>
<dt><code>weights</code></dt>
<dd>
<p>observation weights. Can be total counts if responses are proportion matrices. Default is 1 for each observation</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>The elasticnet mixing parameter, alpha=1 is the lasso penalty, alpha=0 the ridge penalty, alpha=NULL is simple regression</p>
</dd>
<dt><code>lambda</code></dt>
<dd>
<p>the number of lambda values - default is 100</p>
</dd>
<dt><code>standardize</code></dt>
<dd>
<p>normalise the features in the given data</p>
</dd>
<dt><code>standardize.response</code></dt>
<dd>
<p>normalise the dependent variable between 0 and 1, default = FALSE</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>internal use</p>
</dd>
<dt><code>cvmodel</code></dt>
<dd>
<p>internal use</p>
</dd>
<dt><code>Flag</code></dt>
<dd>
<p>internal use</p>
</dd>
<dt><code>is_lasso</code></dt>
<dd>
<p>internal use</p>
</dd>
<dt><code>iid_names</code></dt>
<dd>
<p>internal use</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-LMTrainer-new"><code>LMTrainer$new()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-fit"><code>LMTrainer$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-predict"><code>LMTrainer$predict()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-cv_model"><code>LMTrainer$cv_model()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-cv_predict"><code>LMTrainer$cv_predict()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-get_importance"><code>LMTrainer$get_importance()</code></a>
</p>
</li>
<li> <p><a href="#method-LMTrainer-clone"><code>LMTrainer$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-LMTrainer-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$new(family, weights, alpha, lambda, standardize.response)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>family</code></dt>
<dd>
<p>character, type of regression to perform, values can be "gaussian" ,"binomial", "multinomial","mgaussian"</p>
</dd>
<dt><code>weights</code></dt>
<dd>
<p>numeric, observation weights. Can be total counts if responses are proportion matrices. Default is 1 for each observation</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>integer, The elasticnet mixing parameter, alpha=1 is the lasso penalty, alpha=0 the ridge penalty, alpha=NULL is simple regression</p>
</dd>
<dt><code>lambda</code></dt>
<dd>
<p>integer, the number of lambda values - default is 100</p>
</dd>
<dt><code>standardize.response</code></dt>
<dd>
<p>logical, normalise the dependent variable between 0 and 1, default = FALSE</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>Create a new 'LMTrainer' object.
</p>



<h5>Returns</h5>

<p>A 'LMTrainer' object.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-fit"></a>



<h4>Method <code>fit()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$fit(X, y)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X</code></dt>
<dd>
<p>data.frame containing train featuers</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>character, name of target variable</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>Fits the LMTrainer model on given data
</p>



<h5>Returns</h5>

<p>NULL, train the model and saves internally
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$fit(X = housing, y = 'MEDV')
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-predict"></a>



<h4>Method <code>predict()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$predict(df, lambda = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>df</code></dt>
<dd>
<p>data.frame containing test features</p>
</dd>
<dt><code>lambda</code></dt>
<dd>
<p>integer, the number of lambda values - default is 100. By default it picks the best value from the model.</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>Returns predictions for test data
</p>



<h5>Returns</h5>

<p>vector, a vector containing predictions
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$fit(X = housing, y = 'MEDV')
predictions &lt;- lf$cv_predict(df = housing)
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-cv_model"></a>



<h4>Method <code>cv_model()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$cv_model(X, y, nfolds, parallel, type.measure = "deviance")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X</code></dt>
<dd>
<p>data.frame containing test features</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>character, name of target variable</p>
</dd>
<dt><code>nfolds</code></dt>
<dd>
<p>integer, number of folds</p>
</dd>
<dt><code>parallel</code></dt>
<dd>
<p>logical, if do parallel computation. Default=FALSE</p>
</dd>
<dt><code>type.measure</code></dt>
<dd>
<p>character, evaluation metric type. Default = deviance</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>Train regression model using cross validation
</p>



<h5>Returns</h5>

<p>NULL, trains the model and saves it in memory
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-cv_predict"></a>



<h4>Method <code>cv_predict()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$cv_predict(df, lambda = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>df</code></dt>
<dd>
<p>data.frame containing test features</p>
</dd>
<dt><code>lambda</code></dt>
<dd>
<p>integer, the number of lambda values - default is 100. By default it picks the best value from the model.</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>Get predictions from the cross validated regression model
</p>



<h5>Returns</h5>

<p>vector a vector containing predicted values
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)
predictions &lt;- lf$cv_predict(df = housing)
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-get_importance"></a>



<h4>Method <code>get_importance()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>LMTrainer$get_importance()</pre></div>



<h5>Details</h5>

<p>Get feature importance using model coefficients
</p>



<h5>Returns</h5>

<p>a matrix containing feature coefficients
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>\dontrun{
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)
predictions &lt;- lf$cv_predict(df = housing)
coefs &lt;- lf$get_importance()
}
</pre>
</div>


<hr>
<a id="method-LMTrainer-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>LMTrainer$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
## ------------------------------------------------
## Method `LMTrainer$new`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)

## End(Not run)

## ------------------------------------------------
## Method `LMTrainer$fit`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$fit(X = housing, y = 'MEDV')

## End(Not run)

## ------------------------------------------------
## Method `LMTrainer$predict`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$fit(X = housing, y = 'MEDV')
predictions &lt;- lf$cv_predict(df = housing)

## End(Not run)

## ------------------------------------------------
## Method `LMTrainer$cv_model`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)

## End(Not run)

## ------------------------------------------------
## Method `LMTrainer$cv_predict`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)
predictions &lt;- lf$cv_predict(df = housing)

## End(Not run)

## ------------------------------------------------
## Method `LMTrainer$get_importance`
## ------------------------------------------------

## Not run: 
LINK &lt;- "http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data"
housing &lt;- read.table(LINK)
names &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS",
           "RAD","TAX","PTRATIO","B","LSTAT","MEDV")
names(housing)  &lt;-  names
lf &lt;- LMTrainer$new(family = 'gaussian', alpha=1)
lf$cv_model(X = housing, y = 'MEDV', nfolds = 5, parallel = FALSE)
predictions &lt;- lf$cv_predict(df = housing)
coefs &lt;- lf$get_importance()

## End(Not run)
</code></pre>


</div>