<div class="container">

<table style="width: 100%;"><tr>
<td>sk_bds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set default parameter covariance parameter bounds for a Kronecker covariance model</h2>

<h3>Description</h3>

<p>Returns a data-frame of initial values and upper/lower bounds on covariance
parameters for the Kronecker covariance model defined by the correlation function
names in <code>pars</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sk_bds(pars, g, var_obs = NULL, var_mult = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list or character vector of 1-2 kernel names (see <code>sk_pars</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a sk grid (or any object accepted by <code>sk</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_obs</code></td>
<td>
<p>positive numeric, the sample variance of data <code>g$gval</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_mult</code></td>
<td>
<p>numeric &gt; 1, constant to multiply by <code>var_obs</code> to get upper bounds</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Range parameters (<code>y.rho</code> and <code>x.rho</code>) are bounded by the shortest and longest
inter-point distances along the corresponding dimension (y or x). This is
computed by taking the element-wise product of dimensions and resolution, ie
<code>g$gres * dim(g)</code>. Ranges are initialized to the geometric mean of the upper
and lower bounds.
</p>
<p>Variance bounds are centered around <code>var_obs</code>, which by default is set to the sample
variance of the data in <code>g</code>. <code>eps</code> (measurement variance) and <code>psill</code> (partial
sill) are both initialized to one half of <code>var_obs</code>, bounded above by <code>var_obs</code>
times <code>var_mult</code>, and bounded below by a small positive number (<code>1e-6</code>). Note that
while <code>eps=0</code> produces valid models in theory, in practice <code>eps&gt;0</code> is often
necessary for numerical stability.
</p>
<p>Shape parameter bounds are hard-coded, and are set conservatively to avoid problems
with numerical precision in functions like <code>exp</code> and <code>gamma</code> when evaluating very
large or small distances.
</p>


<h3>Value</h3>

<p>a data frame of initial values and lower/upper bounds for the parameters in <code>pars</code>
</p>


<h3>See Also</h3>

<p>sk
</p>
<p>Other parameter managers: 
<code>sk_fit()</code>,
<code>sk_kp()</code>,
<code>sk_pars_make()</code>,
<code>sk_pars_update()</code>,
<code>sk_pars()</code>,
<code>sk_to_string()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">gdim = c(10, 15)
g = sk(gdim)
g[] = stats::rnorm(length(g))
sk_bds('mat', g)

# same result by passing in observed variance
sk_bds('mat', g, stats::var(g[]))

# a less conservative bound for variance (only eps and psill affected)
sk_bds('mat', g, var_mult=1)
</code></pre>


</div>