<div class="container">

<table style="width: 100%;"><tr>
<td>function_map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create new <code style="white-space: pre;">⁠*_map()⁠</code> functions</h2>

<h3>Description</h3>

<p><code>function_map()</code> creates new basic mapper functions for
consistency tests, such as <code>grim_map()</code> or <code>debit_map()</code>.
</p>
<p>For context, see <a href="https://lhdjung.github.io/scrutiny/articles/consistency-tests.html#creating-basic-mappers-with-function_map"><em>Creating basic mappers with <code>function_map()</code></em></a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">function_map(
  .fun,
  .reported,
  .name_test,
  .name_key_result = "consistency",
  .name_class = NULL,
  .args_disabled = NULL,
  .col_names = NULL,
  .col_control = NULL,
  .col_filler = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.fun</code></td>
<td>
<p>Single-case consistency testing function that will be applied to
each row in a data frame. The function must return a single logical value,
i.e., <code>TRUE</code>, <code>FALSE</code>, or <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.reported</code></td>
<td>
<p>String. Names of the columns to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_test</code></td>
<td>
<p>String (length 1). Plain-text name of the consistency test,
such as <code>"GRIM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_key_result</code></td>
<td>
<p>(Experimental) Optionally, a single string that will
be the name of the key result column in the output. Default is
<code>"consistency"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_class</code></td>
<td>
<p>String. Optionally, one or more classes to be added to the
output data frame. Default is <code>NULL</code>, i.e., no extra class (but see
<em>Details</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.args_disabled</code></td>
<td>
<p>Optionally, a string vector with names of arguments of
the <code style="white-space: pre;">⁠*_scalar()⁠</code> function that don't work with the factory-made function.
If the user  tries to specify these arguments, an informative error will be
thrown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.col_names</code></td>
<td>
<p>(Experimental) Optionally, a string vector with the names
of additional columns that are derived from the <code style="white-space: pre;">⁠*_scalar()⁠</code> function.
Requires <code>.col_control</code> and <code>.col_filler</code> specifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.col_control</code></td>
<td>
<p>(Experimental) Optionally, a single string with the name
of the <code style="white-space: pre;">⁠*_scalar()⁠</code> function's logical argument that controls if the
columns named in <code>.col_names</code> will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.col_filler</code></td>
<td>
<p>(Experimental) Optionally, a vector specifying the values
of <code>.col_names</code> columns in rows where the <code style="white-space: pre;">⁠*_scalar()⁠</code> function only
returned the <code>consistency</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>These dots must be empty.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output tibble returned by the factory-made function will inherit
one or two classes independently of the <code>.name_class</code> argument:
</p>

<ul>
<li>
<p> It will inherit a class named <code>"scr_{tolower(.name_test)}_map"</code>; for
example, the class is <code>"scr_grim_map"</code> if <code>.name_test</code> is <code>"GRIM"</code>.
</p>
</li>
<li>
<p> If a <code>rounding</code> argument is specified via <code>...</code>, or else if <code>.fun</code> has a
<code>rounding</code> argument with a default, the output tibble will inherit a class
named <code>"scr_rounding_{rounding}"</code>; for example,
<code>"scr_rounding_up_or_down"</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A factory-made function with these arguments:
</p>

<ul>
<li> <p><code>data</code>: Data frame with all the columns named in <code>.reported</code>. It must
have columns named after the key arguments in <code>.fun</code>. Other columns are
permitted.
</p>
</li>
<li>
<p> Arguments named after the <code>.reported</code> values. They can be specified as the
names of <code>data</code> columns so that the function will rename that column using
the <code>.reported</code> name.
</p>
</li>
<li> <p><code>reported</code>, <code>fun</code>, <code>name_class</code>: Same as when calling <code>function_map()</code> but
spelled without dots. You can override these defaults when calling the
factory-made function.
</p>
</li>
<li> <p><code>...</code>: Arguments passed down to <code>.fun</code>. This does not include the
column-identifying arguments derived from <code>.reported</code>.
</p>
</li>
</ul>
<h3>Value returned by the factory-made function</h3>

<p>A tibble that includes
<code>"consistency"</code>: a logical column showing whether the values to its left
are mutually consistent (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Basic test implementation for "SCHLIM",
# a mock test with no real significance:
schlim_scalar &lt;- function(y, n) {
  (y / 3) &gt; n
}

# Let the function factory produce
# a mapper function for SCHLIM:
schlim_map &lt;- function_map(
  .fun = schlim_scalar,
  .reported = c("y", "n"),
  .name_test = "SCHLIM"
)

# Example data:
df1 &lt;- tibble::tibble(y = 16:25, n = 3:12)

# Call the "factory-made" function:
schlim_map(df1)
</code></pre>


</div>