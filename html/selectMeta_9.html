<div class="container">

<table style="width: 100%;"><tr>
<td>DearBeggMonotoneCItheta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute an approximate profile likelihood ratio confidence interval for effect estimate</h2>

<h3>Description</h3>

<p>Under some assumptions on the true underlying <code class="reqn">p</code>-value density the usual likelihood ratio theory for the finite-dimensional
parameter of interest, <code class="reqn">\theta</code>, holds although we estimate the infinite-dimensional nuisance parameter <code class="reqn">w</code>, see Murphy and van der Vaart (2000). 
These functions implement such a confidence interval. To this end we compute the set
</p>
<p style="text-align: center;"><code class="reqn">\{\theta : \tilde l(\theta, \hat \sigma(\theta), \hat w(\theta)) \ge c\}</code>
</p>

<p>where <code class="reqn">c = - 0.5 \cdot \chi_{1-\alpha}^2(1)</code> and <code class="reqn">\tilde l</code> is the relative profile log-likelihood function.
</p>
<p>The functions <code>DearBeggProfileLL</code> and <code>DearBeggToMinimizeProfile</code> are not intended to be called by the user directly.</p>


<h3>Usage</h3>

<pre><code class="language-R">DearBeggMonotoneCItheta(res, lam = 2, conf.level = 0.95, maxiter = 500)
DearBeggProfileLL(z, res0, lam, conf.level = 0.95, maxiter = 500)
DearBeggToMinimizeProfile(vec, theta, y, u, lam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Output from function <code>DearBeggMonotone</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>Weight of the first entry of <code class="reqn">w</code> in the likelihood function. Should be the same as used to generate <code>res</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level of confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations of differential evolution algorithm used in computation of confidence limits. Increase this number to get higher accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Variable to maximize over, corresponds to <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res0</code></td>
<td>
<p>Output from <code>DearBeggMonotone</code>, contains initial estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>Vector of parameters over which we maximize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Current <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Normally distributed effect sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Associated standard errors.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the element
</p>
<table><tr style="vertical-align: top;">
<td><code>ci.theta</code></td>
<td>
<p>that contains the profile likelihood confidence interval for <code class="reqn">\theta</code>.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>Since we have to numerically find zeros of a suitable function, via <code>uniroot</code>, to get the limits and each iteration involves
computation of <code class="reqn">w(\theta)</code> via a variant of <code>DearBeggMonotone</code>, computation of a confidence interval may take some time (typically seconds
to minutes).</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Murphy, S. and van der Vaart, A. (2000).
On profile likelihood.
<em>J. Amer. Statist. Assoc.</em>, <b>95</b>, 449–485.
</p>
<p>Rufibach, K. (2011).
Selection Models with Monotone Weight Functions in Meta-Analysis.
<em>Biom. J.</em>, <b>53</b>(4), 689–704. 
</p>


<h3>See Also</h3>

<p>The estimate under a monotone selection function can be computed using <cite>DearBeggMonotone</cite>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## compute confidence interval for theta in the education dataset
data(education)
N  &lt;- education$N
y  &lt;- education$theta
u  &lt;- sqrt(2 / N)
lam1 &lt;- 2
res.edu &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, 
    CR = 1, trace = FALSE)
r1 &lt;- DearBeggMonotoneCItheta(res.edu, lam = 2, conf.level = 0.95)
res.edu$theta
r1$ci.theta

## compute confidence interval for theta in the passive smoking dataset
data(passive_smoking)
u &lt;- passive_smoking$selnRR
y &lt;- passive_smoking$lnRR
lam1 &lt;- 2
res.toba &lt;- DearBeggMonotone(y, u, lam = lam1, maxiter = 1000, 
    CR = 1, trace = FALSE)
r2 &lt;- DearBeggMonotoneCItheta(res.toba, lam = 2, conf.level = 0.95)
res.toba$theta
r2$ci.theta

## End(Not run)
</code></pre>


</div>