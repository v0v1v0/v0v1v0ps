<div class="container">

<table style="width: 100%;"><tr>
<td>HierarchyCompute2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended Hierarchical Computations</h2>

<h3>Description</h3>

<p>Extended variant of <code>HierarchyCompute</code> with several column variables (not just <code>"colFactor"</code>).
Parameter colVar splits the hierarchy variables in two groups and this variable overrides the difference between <code>"rowFactor"</code> and <code>"colFactor"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HierarchyCompute2(
  data,
  hierarchies,
  valueVar,
  colVar,
  rowSelect = NULL,
  colSelect = NULL,
  select = NULL,
  output = "data.frame",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierarchies</code></td>
<td>
<p>A named list with hierarchies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valueVar</code></td>
<td>
<p>Name of the variable(s) to be aggregated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colVar</code></td>
<td>
<p>Name of the column variable(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowSelect</code></td>
<td>
<p>Data frame specifying variable combinations for output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colSelect</code></td>
<td>
<p>Data frame specifying variable combinations for output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>Data frame specifying variable combinations for output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>One of "data.frame" (default), "outputMatrix", "matrixComponents".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters sent to <code>HierarchyCompute</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Within this function, <code>HierarchyCompute</code> is called two times.
By specifying output as <code>"matrixComponents"</code>,
output from the two runs are retuned as a list with elements <code>hcRow</code> and <code>hcCol</code>.
The matrix multiplication in HierarchyCompute is extended to
<code>outputMatrix</code> <code>=</code> <code>hcRow$dataDummyHierarchy</code>
<code>%*%</code> <code>hcRow$valueMatrix</code>
<code>%*%</code> <code>t(hcCol$dataDummyHierarchy)</code>.
This is modified in cases with more than a single <code>valueVar</code>.
</p>


<h3>Value</h3>

<p>As specified by the parameter <code>output</code>
</p>


<h3>Note</h3>

<p>There is no need to call <code>HierarchyCompute2</code> directly.
The main function <code>HierarchyCompute</code>  can be used instead.
</p>


<h3>Author(s)</h3>

<p>Ã˜yvind Langsrud
</p>


<h3>See Also</h3>

<p><code>Hierarchies2ModelMatrix</code>, <code>AutoHierarchies</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- SSBtoolsData("sprt_emp")
geoHier &lt;- SSBtoolsData("sprt_emp_geoHier")
ageHier &lt;- SSBtoolsData("sprt_emp_ageHier")

HierarchyCompute(x, list(age = ageHier, geo = geoHier, year = "rowFactor"), "ths_per", 
                 colVar = c("age", "year"))
HierarchyCompute(x, list(age = ageHier, geo = geoHier, year = "rowFactor"), "ths_per",
                 colVar = c("age", "geo"))
HierarchyCompute(x, list(age = ageHier, geo = geoHier, year = "rowFactor"), "ths_per", 
                 colVar = c("age", "year"), output = "matrixComponents")
HierarchyCompute(x, list(age = ageHier, geo = geoHier, year = "rowFactor"), "ths_per", 
                 colVar = c("age", "geo"), output = "matrixComponents")

</code></pre>


</div>