<div class="container">

<table style="width: 100%;"><tr>
<td>stsplot_space</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Map of Disease Counts/Incidence accumulated over a Given Period
</h2>

<h3>Description</h3>

<p>This is the <code>plot</code> variant of <code>type=observed~unit</code> for
<code>"sts"</code> objects, i.e.,
<code>plot(stsObj, type=observed~unit, ...)</code> calls the function
documented below. It produces an <code>spplot</code>
where regions are color-coded according to disease incidence
(either absolute counts or relative to population) over a given
time period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stsplot_space(x, tps = NULL, map = x@map, population = NULL,
              main = NULL, labels = FALSE, ...,
              at = 10, col.regions = NULL,
              colorkey = list(space = "bottom", labels = list(at=at)),
              total.args = NULL,
              gpar.missing = list(col = "darkgrey", lty = 2, lwd = 2),
              sp.layout = NULL, 
              xlim = bbox(map)[1, ], ylim = bbox(map)[2, ])
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>"sts"</code> or a matrix of counts,
i.e., <code>observed(stsObj)</code>, where especially
<code>colnames(x)</code> have to be contained in <code>row.names(map)</code>.
If a matrix, the <code>map</code> object has to be provided explicitly.
The possibility of specifying a matrix is, e.g., useful to plot mean
counts of simulations from <code>simulate.hhh4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tps</code></td>
<td>

<p>a numeric vector of one or more time points.
The unit-specific <em>sum</em> over all time points <code>tps</code> is
plotted. The default <code>tps=NULL</code> means accumulation over the whole
time period <code>1:nrow(x)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>

<p>an object inheriting from <code>"SpatialPolygons"</code>
representing the <code>ncol(x)</code> regions. By default
the <code>map</code> slot of <code>x</code> is queried (which might be
empty and is not applicable if <code>x</code> is a matrix of counts).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>

<p>if <code>NULL</code> (default), the map shows the region-specific numbers
of cases accumulated over <code>tps</code>. For a disease incidence map,
<code>population</code> can be specified in three ways:
</p>

<ul>
<li>
<p> a numeric vector of population numbers in the
<code>ncol(x)</code> regions, used to divide the disease counts.
</p>
</li>
<li>
<p> a matrix of population counts of dimension <code>dim(x)</code>
(such as <code>population(x)</code> in an <code>"sts"</code> object).
This will produce the cumulative incidence over <code>tps</code>
relative to the population at the first time point, i.e., only
<code>population[tps[1],]</code> is used.
</p>
</li>
<li>
<p> [if <code>is(x, "sts")</code>]
a scalar specifying how <code>population(x)</code> should be scaled for
use as the population matrix, i.e.,
<code>population(x)/population</code> is used. For instance, if
<code>population(x)</code> contains raw population numbers,
<code>population=1000</code> would produce the incidence per 1000
inhabitants.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>a main title for the plot. If <code>NULL</code> and <code>x</code> is of
class <code>"sts"</code>, the time range of <code>tps</code> is put as
the main title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>determines if and how the regions of the <code>map</code> are labeled,
see <code>layout.labels</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments for <code>spplot</code>,
for example <code>col = "white"</code> for white polygon lines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>

<p>either a number of levels (default: 10) for the categorization
(color-coding) of counts/incidence,
or a numeric vector of specific break points,
or a named list of a number of levels (<code>"n"</code>), a transformer
(<code>"trafo"</code>) of class <code>"trans"</code> defined by
package <span class="pkg">scales</span>, and optional further arguments for
<code>pretty</code>. The default breaks are equally spaced
on the square-root scale (equivalent to
<code>sqrt_trans</code>).
Note that intervals given by <code>at</code> are closed on the left
and open to the right; if manually specified break points do not
cover the data range, further breaks are automatically added at 0
and the maximum (rounded up to 1 significant digit), respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.regions</code></td>
<td>

<p>a vector of fill colors, sufficiently long to serve all levels
(determined by <code>at</code>).
“Heat” colors are used by default (<code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorkey</code></td>
<td>

<p>a list describing the color key, see
<code>levelplot</code>. The default list elements will be
updated by the provided list using <code>modifyList</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.args</code></td>
<td>

<p>an optional list of arguments for <code>grid.text</code> to
have the overall number/incidence of cases printed at an edge of the
map. The default settings are
<code>list(label="Overall: ", x=1, y=0)</code>, and
<code>total.args=list()</code> will use all of them.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpar.missing</code></td>
<td>
<p>list of graphical parameters for
<code>sp.polygons</code> applied to the regions of <code>map</code>,
which are not part of <code>x</code>. Such extra regions won't be plotted
if <code>!is.list(gpar.missing)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.layout</code></td>
<td>

<p>optional list of additional layout items, see <code>spplot</code>.
</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>xlim,ylim</code></td>
<td>
<p>numeric vectors of length 2 specifying the axis limits.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a lattice plot of class
<code>"trellis"</code>, but see
<code>spplot</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>See Also</h3>

<p>the central <code>stsplot</code>-documentation for an overview of
plot types, and <code>animate.sts</code> for animations of
<code>"sts"</code> objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("measlesWeserEms")

# default plot: total region-specific counts over all weeks
plot(measlesWeserEms, type = observed ~ unit)
stsplot_space(measlesWeserEms)  # the same

# cumulative incidence (per 100'000 inhabitants),
# with region labels and white borders
plot(measlesWeserEms, observed ~ unit,
     population = measlesWeserEms@map$POPULATION / 100000,
     labels = list(labels = "GEN", cex = 0.7, font = 3),
     col = "white", lwd = 2,
     sub = "cumulative incidence (per 100'000 inhabitants)")

# incidence in a particular week, manual color breaks, display total
plot(measlesWeserEms, observed ~ unit, tps = 62,
     population = measlesWeserEms@map$POPULATION / 100000,
     at = c(0, 1, 5),
     total.args = list(x = 0, label = "Overall incidence: "))

# if we had only observed a subset of the regions
plot(measlesWeserEms[,5:11], observed ~ unit,
     gpar.missing = list(col = "gray", lty = 4))
</code></pre>


</div>