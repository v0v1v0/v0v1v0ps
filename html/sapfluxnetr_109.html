<div class="container">

<table style="width: 100%;"><tr>
<td>sfn_metrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metrics summary function</h2>

<h3>Description</h3>

<p>Generate metrics from a site/s data for the period indicated
</p>


<h3>Usage</h3>

<pre><code class="language-R">sfn_metrics(
  sfn_data,
  period,
  .funs,
  solar,
  interval = c("general", "predawn", "midday", "night", "daylight"),
  int_start = NULL,
  int_end = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sfn_data</code></td>
<td>
<p><code>sfn_data</code> or <code>sfn_data_multi</code> object
to obtain the metrics from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Time period to aggregate data by. See period section for an
explanation about the periods ('3 hours', '1 day', '1 month', '1 year', ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.funs</code></td>
<td>
<p>List of function calls to summarise the data by, see .funs
section for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solar</code></td>
<td>
<p>Logical indicating if the solarTIMESTAMP must be used instead of
the site local TIMESTAMP. Default to TRUE (use solarTIMESTAMP).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Character vector indicating if the metrics must be filtered
by an special hour interval. See Interval section in details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_start</code></td>
<td>
<p>Integer value indicating the starting hour of the special
interval in 24h format. See Interval section in details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_end</code></td>
<td>
<p>Integer value indicating the ending hour of the special
interval in 24h format. See Interval section in details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to pass to methods used
(i.e. .collapse_timestamp or summarise funs extra arguments)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>sfn_data</code> objects, a list of tbl_df objects
with the following structure:
</p>

<ul>
<li>
<p>$sapf: metrics for the sapflow data
</p>
</li>
<li>
<p>$env: metrics for the environmental data
</p>
</li>
</ul>
<p>For <code>sfn_data_multi</code> objects, a list of lists of tbl_df objects
with the metrics for each site:
</p>

<ul>
<li>
<p>$SITE_CODE
</p>

<ul>
<li>
<p>$sapf: metrics for the sapflow data
</p>
</li>
<li>
<p>$env: metrics for the environmental data
</p>
</li>
</ul>
</li>
<li>
<p>$NEXT_SITE_CODE...
</p>
</li>
</ul>
<h3>Period</h3>

<p><code>period</code> argument is used by internal function
<code>.collapse_timestamp</code> and it can be stated in two ways:
</p>

<ul>
<li>
<p><em>frequency period</em> format: "3 hours", "1 day", "7 days", "1 month"
</p>
</li>
<li>
<p>As a <em>custom function</em>. This will be the name of a function,
without quotes, that accepts as the first argument the timestamp to collapse.
The result of the function must be a vector of collapsed TIMESTAMPs of the
same length than the original TIMESTAMP which will be used to group by and
summarise the data. Additional arguments to this function, if needed, can
be passed in the <code>...</code> argument.
</p>
</li>
</ul>
<p><code>.collapse_timestamp</code> also accepts the <code>side</code> argument to
collapse by the starting timestamp or the ending timestamp of each group. This
can be supplied in the <code>...</code> argument.
</p>


<h3>.funs</h3>

<p><code>.funs</code> argument uses the same method as the <code>.funs</code> argument in the
<code>summarise_all</code> function of <code>dplyr</code> package. Basically
it accepts a list of function calls generated by list(). If you want to pass
on a custom function you can specify it here. See details in
<code>summarise_by_period</code> for more complex summarising functions
declaration.
</p>


<h3>Interval</h3>

<p>Previously to the metrics summary, data can be filtered by an special
interval (i.e. predawn or nightly). This filtering can be specified with the
<code>interval</code> argument as this:
</p>

<ul>
<li>
<p><code>"general"</code> (default). No special interval is used, and metrics
are performed with all the data.
</p>
</li>
<li>
<p><code>"predawn"</code>. Data is filtered for predawn interval. In this case
<code>int_start</code> and <code>int_end</code> must be specified as 24h value
</p>
</li>
<li>
<p><code>"midday"</code>. Data is filtered for midday interval. In this case
<code>int_start</code> and <code>int_end</code> must be specified as 24h value
</p>
</li>
<li>
<p><code>"night"</code>. Data is filtered for night interval. In this case
<code>int_start</code> and <code>int_end</code> must be specified as 24h value
</p>
</li>
<li>
<p><code>"daylight"</code>. Data is filtered for daylight interval. In this case
<code>int_start</code> and <code>int_end</code> must be specified as 24h value
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other metrics: 
<code>metrics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)

### general metrics
## sfn_data
data('ARG_TRE', package = 'sapfluxnetr')
ARG_TRE_metrics &lt;- sfn_metrics(
  ARG_TRE,
  period = '7 days',
  .funs = list(~ mean(., na.rm = TRUE), ~ sd(., na.rm = TRUE), ~ n()),
  solar = FALSE,
  interval = 'general'
)

str(ARG_TRE_metrics)
ARG_TRE_metrics[['sapf']]
ARG_TRE_metrics[['env']]

## sfn_data_multi

data('ARG_MAZ', package = 'sapfluxnetr')
data('AUS_CAN_ST2_MIX', package = 'sapfluxnetr')
multi_sfn &lt;- sfn_data_multi(ARG_TRE, ARG_MAZ, AUS_CAN_ST2_MIX)

multi_metrics &lt;- sfn_metrics(
  multi_sfn,
  period = '7 days',
  .funs = list(~ mean(., na.rm = TRUE), ~ sd(., na.rm = TRUE), ~ n()),
  solar = FALSE,
  interval = 'general'
)

str(multi_metrics)

multi_metrics[['ARG_TRE']][['sapf']]


### midday metrics
ARG_TRE_midday &lt;- sfn_metrics(
  ARG_TRE,
  period = '1 day',
  .funs = list(~ mean(., na.rm = TRUE), ~ sd(., na.rm = TRUE), ~ n()),
  solar = TRUE,
  interval = 'midday', int_start = 11, int_end = 13
)

str(ARG_TRE_midday)
ARG_TRE_midday[['sapf']]

</code></pre>


</div>