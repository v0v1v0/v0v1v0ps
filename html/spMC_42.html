<div class="container">

<table style="width: 100%;"><tr>
<td>sim_ck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Simulation Based on Indicator Cokriging</h2>

<h3>Description</h3>

<p>The function simulates a random field through the Indicator Cokriging technique.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_ck(x, data, coords, grid, knn = 12, ordinary = TRUE, entropy = FALSE)</code></pre>


<h3>Arguments</h3>











<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>multi_tpfit</code>, typically with the output of the function <code>multi_tpfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>an <code class="reqn">m \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates in the simulation grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>an integer value which specifies the number of k-nearest neighbours for each simulation point. An optimal number is between 4 and 12. If <code>NULL</code> all observations are considered (just for very small dataset!!). It is <code>12</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordinary</code></td>
<td>
<p>a logical value; if <code>FALSE</code>, the probabilities are computed through the Simple coKriging technique, otherwise the Ordinary coKriging method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entropy</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, the prediction uncertainties are computed through the entropy (and standardized entropy). The default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method computes an approximation of posterior probabilities
</p>
<p style="text-align: center;"><code class="reqn">\Pr\left(Z(\mathbf{s}_0) = z_k \left\vert \bigcap_{i = 1}^n Z(\mathbf{s}_i) = z(\mathbf{s}_i)\right.\right).</code>
</p>

<p><code class="reqn">\hspace{0cm}</code>
</p>
<p>The probability is calculated as the weighted sum of indicator variables which denote the presence of the <code class="reqn">k</code>-th category in observed points <code class="reqn">\mathbf{s}_i</code>. Weights involved in the sum are the solution of a system of equations.
</p>
<p>Probabilities approximated are usually truncated and normalized with respect to the probability constraints, because such probabilities might lie outside the interval <code class="reqn">[0, 1]</code>. The normalization procedure is designed such that it is not possible to obtain vectors such that the sum of their probabilities is always equal to one.
</p>
<p>When an initial configuration is simulated, it should be modified to reach a pattern similar to the sample by the use of the <code>quench</code> function.
</p>


<h3>Value</h3>

<p>A data frame containing the simulation grid, the simulated random field, predicted values and the approximated probabilities is returned. Two extra columns respectively denoting the entropy and standardized entorpy are bindend to the data frame when argument <code>entropy = TRUE</code>.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1996) Transition Probability-Based Indicator Geostatistics. <em>Mathematical Geosciences</em>, <b>28</b>(4), 453-476.
</p>
<p>Carle, S. F. (1999) T-PROGS: Transition Probability Geostatistical Software. University of California, Davis.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.
</p>

<p>Weise, T. (2009) <em>Global Optimization Algorithms - Theory and Application</em>. <a href="https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application">https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application</a>.</p>


<h3>See Also</h3>

<p><code>sim_ik</code>, <code>sim_mcs</code>, <code>sim_path</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Model parameters estimation for the
# multinomial categorical simulation
x &lt;- multi_tpfit(ACM$MAT5, ACM[, 1:3])

# Generate the simulation grid
mygrid &lt;- list()
mygrid$X &lt;- seq(min(ACM$X), max(ACM$X), length = 20)
mygrid$Y &lt;- seq(min(ACM$Y), max(ACM$Y), length = 20)
mygrid$Z &lt;- -40 * 0:9 - 1
mygrid &lt;- as.matrix(expand.grid(mygrid$X, mygrid$Y, mygrid$Z))

# Simulate the random field through
# Simple Indicator Cokriging algorithm
mySCKSim &lt;- sim_ck(x, ACM$MAT5, ACM[, 1:3], mygrid, ordinary = FALSE)

# Simulate the random field through
# Ordinary Indicator Cokriging algorithm
myOCKSim &lt;- sim_ck(x, ACM$MAT5, ACM[, 1:3], mygrid)
</code></pre>


</div>