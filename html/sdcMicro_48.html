<div class="container">

<table style="width: 100%;"><tr>
<td>mvTopCoding</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detection and winsorization of multivariate outliers</h2>

<h3>Description</h3>

<p>Imputation and detection of outliers
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvTopCoding(x, maha = NULL, center = NULL, cov = NULL, alpha = 0.025)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object coercible to a <code>data.table</code> containing numeric entries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maha</code></td>
<td>
<p>squared mahalanobis distance of each observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>center of data, needed for calculation of mahalanobis
distance (if not provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>covariance matrix of data, needed for calcualtion of mahalanobis
distance (if not provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level, determining the ellipsoide to which
outliers should be placed upon</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Winsorizes the potential outliers on the ellipsoid defined by
(robust) Mahalanobis distances in direction to the center of the data
</p>


<h3>Value</h3>

<p>the imputed winsorized data
</p>


<h3>Author(s)</h3>

<p>Johannes Gussenbauer, Matthias Templ
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x &lt;- MASS::mvrnorm(20, mu = c(5,5), Sigma = matrix(c(1,0.9,0.9,1), ncol = 2))
x[1, 1] &lt;- 3
x[1, 2] &lt;- 6
plot(x)
ximp &lt;- mvTopCoding(x)
points(ximp, col = "blue", pch = 4)

# more dimensions
Sigma &lt;- diag(5)
Sigma[upper.tri(Sigma)] &lt;- 0.9
Sigma[lower.tri(Sigma)] &lt;- 0.9
x &lt;- MASS::mvrnorm(20, mu = rep(5,5), Sigma = Sigma)
x[1, 1] &lt;- 3
x[1, 2] &lt;- 6
pairs(x)

ximp &lt;- mvTopCoding(x)
xnew &lt;- data.frame(rbind(x, ximp))
xnew$beforeafter &lt;- rep(c(0,1), each = nrow(x))
pairs(xnew, col = xnew$beforeafter, pch = 4)

# by hand (non-robust)
x[2,2] &lt;- NA
m &lt;- colMeans(x, na.rm = TRUE)
s &lt;- cov(x, use = "complete.obs")
md &lt;- stats::mahalanobis(x, m, s)
ximp &lt;- mvTopCoding(x, center = m, cov = s, maha = md)
plot(x)
points(ximp, col = "blue", pch = 4)

</code></pre>


</div>