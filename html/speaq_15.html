<div class="container">

<table style="width: 100%;"><tr>
<td>findShiftStepFFT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finding the shift-step by using Fast Fourier Transform cross- correlation</h2>

<h3>Description</h3>

<p>This function uses Fast Fourier Transform cross-correlation to find out the shift step between two spectra.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findShiftStepFFT(refSpec, tarSpec, maxShift = 0, scale = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>refSpec</code></td>
<td>
<p>The reference spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tarSpec</code></td>
<td>
<p>The target spectrum which needs to be aligned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxShift</code></td>
<td>
<p>The maximum number of points for a shift step. If this value is zero, the algorithm will check on the whole length of the spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Boolean value (TRUE/FALSE) for scaling data before Fast Fourier Transform cross-correlation step. If scale=NULL but mean/median of absolute data is too small (&lt;1), the scaling will be applied. This might happen for very low abundant spectra like chromatograms. For normal NMR spectra, the scaling is usually not applied.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of 2: corValue (The best correlation value) and stepAdj (The shift step found by the algorithm)
</p>


<h3>Author(s)</h3>

<p>Trung Nghia Vu
</p>


<h3>See Also</h3>

<p><code>hClustAlign</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">res=makeSimulatedData();
X=res$data;
groupLabel=res$label;
maxShift=50;
refSpec=X[1,];
tarSpec=X[2,];
adj=findShiftStepFFT(refSpec, tarSpec,maxShift=maxShift);
                       
</code></pre>


</div>