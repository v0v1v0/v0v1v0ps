<div class="container">

<table style="width: 100%;"><tr>
<td>profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method for profiling fitted max-stable objects</h2>

<h3>Description</h3>

<p>Computes profile traces for fitted max-stable models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'maxstab'
profile(fitted, param, range, n = 10, plot = TRUE,
conf = 0.90, method = "RJ", square = "chol", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class “maxstab”. Most often, it will be
the output of the function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A character string giving the model parameter that are to
be profiled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>The range for the profiled model parameter that must be
explored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of profiled model parameter that must be
considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the profile trace is
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Numeric giving the confidence interval level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string. Must be one of "CB", "RJ" or "none" for the
Chandler and Bate or the Rotnitzky and Jewell approaches
respectively. The "none" method simply plots the profile of the
log-composite likelihood. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>square</code></td>
<td>
<p>The choice for the matrix square root. This is only
useful for the 'CB' method. Must be one of 'chol' (Cholesky) or
'svd' (Singular Value Decomposition).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra options that must be passed to the
<code>plot</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Rotnitzky and Jewell approach consists in adjusting the
distribution of the likelihood ratio statistics - which under
misspecification is no longer <code class="reqn">\chi^2</code> distributed.
</p>
<p>The Chandler and Bate approach adjusts the composite likelihood itself
is such a way that the usual asymptotic <code class="reqn">\chi^2</code> null
distribution is preserved. Note that in the current code, we use the
singular value decomposition for the computation of matrix square
roots to preserve asymmetry in the profile composite likelihood.
</p>


<h3>Value</h3>

<p>A matrix. The first column corresponds to the values for which the
profiled model parameter is fixed. The second column gives the value
of the pairwise log-likelihood. The remaining columns contain the
constrained maximum likelihood estimates for the remaining model
parameters.
</p>


<h3>Warnings</h3>

<p>This function can be <b>really</b> time consuming!
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Chandler, R. E. and Bate, S. (2007) Inference for clustered data using
the independence loglikelihood <em>Biometrika</em>, <b>94</b>,
167–183.
</p>
<p>Rotnitzky, A. and Jewell, N. (1990) Hypothesis testing of regression
parameters in semiparametric generalized linear models for cluster
correlated data. <em>Biometrika</em> <b>77</b>, 485–97.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##Define the coordinates of each location
n.site &lt;- 30
locations &lt;- matrix(rnorm(2*n.site, sd = sqrt(.2)), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(50, locations, cov.mod = "gauss", cov11 = 100, cov12 =
25, cov22 = 220)

##Fit a max-stable process
##  1- using the Smith's model
fitted &lt;- fitmaxstab(data, locations, "gauss", fit.marge = FALSE)

##Plot the profile pairwise log-likelihood for the ''cov11'' parameter
profile(fitted, "cov11", range = c(20, 180))

## End(Not run)
</code></pre>


</div>