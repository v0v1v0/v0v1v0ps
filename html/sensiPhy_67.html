<div class="container">

<table style="width: 100%;"><tr>
<td>tree_phylm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic uncertainty - Phylogenetic Linear Regression</h2>

<h3>Description</h3>

<p>Performs Phylogenetic linear regression evaluating
uncertainty in trees topology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree_phylm(formula, data, phy, n.tree = 2, model = "lambda", track = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The model formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with species as row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'multiPhylo', see ?<code>ape</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tree</code></td>
<td>
<p>Number of times to repeat the analysis with n different trees picked 
randomly in the multiPhylo file.
If NULL, <code>n.tree</code> = 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The phylogenetic model to use (see Details). Default is <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>phylolm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a phylogenetic linear regression model using <code>phylolm</code>
to n trees, randomly picked in a multiPhylo file.
</p>
<p>All phylogenetic models from <code>phylolm</code> can be used, i.e. <code>BM</code>,
<code>OUfixedRoot</code>, <code>OUrandomRoot</code>, <code>lambda</code>, <code>kappa</code>,
<code>delta</code>, <code>EB</code> and <code>trend</code>. See ?<code>phylolm</code> for details.
</p>
<p>Currently, this function can only implement simple linear models (i.e. <code class="reqn">trait~
predictor</code>). In the future we will implement more complex models.
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_phylm</code> returns a list with the following
components:
</p>
<p><code>formula</code>: The formula
</p>
<p><code>data</code>: Original full dataset
</p>
<p><code>sensi.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (e.g. <code>lambda</code>) for each regression with a 
different phylogenetic tree.
</p>
<p><code>N.obs</code>: Size of the dataset after matching it with tree tips and removing NA's.
</p>
<p><code>stats</code>: Main statistics for model parameters.<code>CI_low</code> and <code>CI_high</code> are the lower 
and upper limits of the 95
</p>
<p><code>all.stats</code>: Complete statistics for model parameters. <code>sd_intra</code> is the standard deviation 
due to intraspecific variation. <code>CI_low</code> and <code>CI_high</code> are the lower and upper limits 
of the 95
</p>


<h3>Author(s)</h3>

<p>Caterina Penone &amp; Pablo Ariel Martinez
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Donoghue, M.J. &amp; Ackerly, D.D. (1996). Phylogenetic Uncertainties and 
Sensitivity Analyses in Comparative Biology. Philosophical Transactions:
Biological Sciences, pp. 1241-1249.
</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.
</p>


<h3>See Also</h3>

<p><code>phylolm</code>, <code>sensi_plot</code>, <code>tree_phyglm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data:
data(alien)
# This analysis needs a multiphylo file:
class(alien$phy)
alien$phy
# run PGLS accounting for phylogenetic uncertain:
tree &lt;- tree_phylm(log(gestaLen) ~ log(adultMass), phy = alien$phy, 
data = alien$data, n.tree = 30)
# To check summary results:
summary(tree)
# Visual diagnostics
sensi_plot(tree)
# You can specify which graph to print: 
sensi_plot(tree, graphs = 3)
</code></pre>


</div>