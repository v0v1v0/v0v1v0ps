<div class="container">

<table style="width: 100%;"><tr>
<td>plot_SpaCCI_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot SpaCCI Results on the heatmap
Visualize inferred significant cell-cell interactions using a heatmap</h2>

<h3>Description</h3>

<p>Plot SpaCCI Results on the heatmap
Visualize inferred significant cell-cell interactions using a heatmap
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_SpaCCI_heatmap(
  SpaCCI_Result_List,
  specific_celltypes = NULL,
  pathways = NULL,
  interaction = NULL,
  log1p_transform = FALSE,
  show_rownames = TRUE,
  show_colnames = TRUE,
  scale = "none",
  cluster_cols = TRUE,
  cluster_rows = TRUE,
  border_color = "white",
  fontsize_row = 11,
  fontsize_col = 11,
  family = "Arial",
  main = "",
  treeheight_col = 0,
  treeheight_row = 0,
  low_col = "dodgerblue4",
  mid_col = "peachpuff",
  high_col = "deeppink4",
  alpha = 0.05,
  return_tables = FALSE,
  symmetrical = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SpaCCI_Result_List</code></td>
<td>
<p>A list containing the results from a SpaCCI <code>"regional"</code> or <code>"global"</code> analysis. This list should include <code>pvalue_df</code>, which are the outputs from <code>run_SpaCCI(..., analysis_scale = "regional",...)</code> or  <code>run_SpaCCI(..., analysis_scale = "global",...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specific_celltypes</code></td>
<td>
<p>A vector of cell types to include in the heatmap, i.e c("Celltype_A","Celltype_B"). NOTE: the cell type names should match the names input in the SpaCCI analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathways</code></td>
<td>
<p>A vector of pathways to filter the interactions. Initially set to <code>NULL</code>, if not, then it will aggregate the results of the selected pathways.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction</code></td>
<td>
<p>A vector of interactions to filter. Initially set to <code>NULL</code>, if not, then it will aggregate the results of the selected interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log1p_transform</code></td>
<td>
<p>Logical; whether to apply a log(1 + x) transformation to the count matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_rownames</code></td>
<td>
<p>Logical; whether to show row names in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_colnames</code></td>
<td>
<p>Logical; whether to show column names in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Character; whether to scale the data ("row", "column", "none").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_cols</code></td>
<td>
<p>Logical; whether to cluster columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_rows</code></td>
<td>
<p>Logical; whether to cluster rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border_color</code></td>
<td>
<p>Character; color of the heatmap borders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_row</code></td>
<td>
<p>Numeric; font size for row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_col</code></td>
<td>
<p>Numeric; font size for column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Character; font family for text in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Character; title of the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeheight_col</code></td>
<td>
<p>Numeric; height of the column dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeheight_row</code></td>
<td>
<p>Numeric; height of the row dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low_col</code></td>
<td>
<p>Character; color for low values in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mid_col</code></td>
<td>
<p>Character; color for mid values in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high_col</code></td>
<td>
<p>Character; color for high values in the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric; significance threshold for p-values, initailly set to <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_tables</code></td>
<td>
<p>Logical; whether to return the count matrix and summary tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetrical</code></td>
<td>
<p>Logical; whether to make the heatmap symmetrical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to 'pheatmap'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If 'return_tables' is <code>FALSE</code> (default), the function returns a heatmap object created by <code>pheatmap</code>, showing the count of significant cell-cell interactions. If 'return_tables' is <code>TRUE</code>, the function returns a list containing:
</p>

<dl>
<dt><strong>heatmap</strong></dt>
<dd>
<p>The heatmap object showing the significant cell-cell interactions.</p>
</dd>
<dt><strong>heatmap_countmatrix</strong></dt>
<dd>
<p>The matrix used to generate the heatmap, with cell types as rows and columns, and counts of significant interactions as values.</p>
</dd>
<dt><strong>table</strong></dt>
<dd>
<p>A data frame summarizing the counts of significant interactions between each ligand and receptor cell type combination.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">library(SpaCCI)
library(dplyr)
library(reshape2)
library(grDevices)
library(pheatmap)
data(result_global)
celltypes &lt;- c("beta" , "delta" , "ductal","macrophage",
                "activated_stellate", "quiescent_stellate")
plot_SpaCCI_heatmap(SpaCCI_Result_List = result_global,
                    symmetrical = FALSE, cluster_cols = FALSE, return_tables = FALSE,
                    cluster_rows = FALSE, #cellheight = 10, cellwidth = 10,
                    specific_celltypes = c(celltypes),
                    main= "Cell-Cell Interaction Count")

</code></pre>


</div>