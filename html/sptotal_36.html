<div class="container">

<table style="width: 100%;"><tr>
<td>stratafit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a Separate Spatial Linear Model for Each Stratum</h2>

<h3>Description</h3>

<p>Estimates regression coefficients and spatial autocorrelation
parameters, given spatial coordinates, a model formula, and a
stratification variable. Arguments are the same here as they are
for <code>slmfit()</code>, with an extra argument for
<code>stratacol</code>, the name of the stratification column. Note that
stratum can either by incorporated as a covariate in
<code>slmfit()</code>, in which case the errors have the same
spatial covariance, or, models with differing spatial covariances
for the errors can be fit to each level of stratum, as is done here
in <code>stratafit()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stratafit(
  formula,
  data,
  xcoordcol,
  ycoordcol,
  stratacol = NULL,
  areacol = NULL,
  CorModel = "Exponential",
  estmethod = "REML"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>is an <code>R</code> linear model formula specifying the
response variable as well as covariates for predicting the response on the unsampled sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>is the data set with the response column, the covariates to
be used for the block kriging, and the spatial coordinates for all of the sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoordcol</code></td>
<td>
<p>is the name of the column in the data frame with x coordinates or longitudinal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoordcol</code></td>
<td>
<p>is the name of the column in the data frame with y coordinates or latitudinal coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratacol</code></td>
<td>
<p>is the name of the stratification column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>areacol</code></td>
<td>
<p>is the name of the column with the areas of the sites. By default, we assume that all sites have equal area, in which
case a vector of 1's is used as the areas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorModel</code></td>
<td>
<p>is the covariance structure. By default, <code>CorModel</code> is
Exponential but other options include the Spherical and Gaussian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estmethod</code></td>
<td>
<p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of class <code>slmfit</code> with </p>

<ul>
<li>
<p> the spatial covariance estimates
</p>
</li>
<li>
<p> the regression coefficient estimates
</p>
</li>
<li>
<p> the covariance matrix of the fixed effects
</p>
</li>
<li>
<p> minus two times the log-likelihood of the model
</p>
</li>
<li>
<p> the names of the predictors
</p>
</li>
<li>
<p> the sample size
</p>
</li>
<li>
<p> the name of the covariance model used
</p>
</li>
<li>
<p> a vector of residuals
</p>
</li>
<li>
<p> the design matrix
</p>
</li>
<li>
<p> a vector of the sampled densities
</p>
</li>
<li>
<p> a list containing </p>

<ol>
<li>
<p> formula, the model formula
</p>
</li>
<li>
<p> data, the data set input as the <code>data</code> argument
</p>
</li>
<li>
<p> xcoordcol, the name of the x-coordinate column
</p>
</li>
<li>
<p> ycoordcol, the name of the y-coordinate column
</p>
</li>
<li>
<p> estmethod, either REML or ML
</p>
</li>
<li>
<p> CorModel, the correlation model used
</p>
</li>
<li>
<p> estimated covariance matrix of all sites
</p>
</li>
<li>
<p> Inverted covariance matrix on the sampled sites
</p>
</li>
<li>
<p> the vector of areas.
</p>
</li>
</ol>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- stratafit(formula = counts ~ pred1 + pred2,
 data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(strataobj)
</code></pre>


</div>