<div class="container">

<table style="width: 100%;"><tr>
<td>scores_sample_univ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scoring Rules for Simulated Forecast Distributions</h2>

<h3>Description</h3>

<p>Calculate scores (CRPS, LogS, DSS) given observations and draws from the predictive distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crps_sample(
  y,
  dat,
  method = "edf",
  w = NULL,
  bw = NULL,
  num_int = FALSE,
  show_messages = TRUE
)

logs_sample(y, dat, bw = NULL, show_messages = FALSE)

dss_sample(y, dat, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of realized values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>vector or matrix (depending on <code>y</code>; see details)
of simulation draws from forecast distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string; approximation method. Options:
"edf" (empirical distribution function) and
"kde" (kernel density estimation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>optional; vector or matrix (matching <code>dat</code>) of weights for method <code>"edf"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>optional; vector (matching <code>y</code>) of bandwidths for kernel density
estimation; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_int</code></td>
<td>
<p>logical; if TRUE numerical integration is used for method <code>"kde"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_messages</code></td>
<td>
<p>logical; display of messages (does not affect
warnings and errors).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a vector <code>y</code> of length n &gt;= 2, <code>dat</code> should be given as a matrix
with n rows. If <code>y</code> has length 1, then <code>dat</code> may be a vector.
</p>
<p><code>crps_sample</code> employs an empirical version of the quantile
decomposition of the CRPS (Laio and Tamea, 2007) when using
<code>method = "edf"</code>. For <code>method = "kde"</code>, it uses kernel density
estimation using a Gaussian kernel. The logarithmic score always uses kernel density estimation.
</p>
<p>The bandwidth (<code>bw</code>) for kernel density estimation can be
specified manually, in which case it must be a vector (matching <code>y</code>) of positive numbers. If
<code>bw == NULL</code>, the bandwidth is selected using the core function
<code>bw.nrd</code>. Numerical integration may speed up computation for
<code>crps_sample</code> in case of large samples <code>dat</code>.
</p>


<h3>Value</h3>

<p>Value of the score. <em>A lower score indicates a better forecast.</em>
</p>


<h3>Author(s)</h3>

<p>Alexander Jordan, Fabian Krueger, Sebastian Lerch
</p>


<h3>References</h3>

<p><em>Evaluating simulation based forecast distributions:</em>
</p>
<p>Krueger, F., Lerch, S., Thorarinsdottir, T.L. and T. Gneiting (2021): ‘Predictive inference based on Markov chain Monte Carlo output’, <em>International Statistical Review</em> 89, 274-301. <a href="https://doi.org/10.1111/insr.12405">doi:10.1111/insr.12405</a>
</p>
<p><em>Empirical quantile decomposition of the CRPS:</em>
</p>
<p>Laio, F. and S. Tamea (2007):
'Verification tools for probabilistic forecasts of continuous
hydrological variables',
Hydrology and Earth System Sciences, 11, 1267-1277. <a href="https://doi.org/10.5194/hess-11-1267-2007">doi:10.5194/hess-11-1267-2007</a>
</p>


<h3>See Also</h3>

<p><code>scores_sample_univ_weighted</code> for weighted versions of the scoring rules documented here.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# y has length greater than 1
y &lt;- 1:2
sample &lt;- matrix(rnorm(20), nrow = 2)
crps_sample(y = y, dat = sample)
logs_sample(y = y, dat = sample)

y &lt;- 1:2
sample &lt;- rnorm(10)
crps_sample(y = y, dat = sample) # error

# y has length 1
y &lt;- 1
sample &lt;- rnorm(10)
crps_sample(y = y, dat = sample)

sample &lt;- matrix(rnorm(10), nrow = 1)
crps_sample(y = y, dat = sample)

sample &lt;- matrix(rnorm(20), nrow = 2)
crps_sample(y = y, dat = sample) # error

## End(Not run)

</code></pre>


</div>