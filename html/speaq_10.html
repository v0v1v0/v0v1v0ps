<div class="container">

<table style="width: 100%;"><tr>
<td>drawBW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BW and percentile ratios plot</h2>

<h3>Description</h3>

<p>This function is used to plot BW and percentile ratios
</p>


<h3>Usage</h3>

<pre><code class="language-R">drawBW(
  BW,
  perc,
  X,
  startP = -1,
  endP = -1,
  groupLabel = NULL,
  highBound = -1,
  lowBound = -1,
  nAxisPos = 4,
  offside = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BW</code></td>
<td>
<p>An array of the BW ratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>An array of the percentile ratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The spectral dataset in matrix format in which each row contains a single sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startP</code></td>
<td>
<p>The starting point of the segment. If it is -1, the starting point is from beginning of the spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endP</code></td>
<td>
<p>The ending point of the segment. If it is -1, the ending point is the last point of the spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupLabel</code></td>
<td>
<p>The default value is NULL, it means that a single spectrum has a distinct color. Otherwise, the spectra is colored by their label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highBound</code></td>
<td>
<p>Default value is -1, that means the plot covers also the highest intensity peaks in the figure. If the users want to limit the upper height of the figure, set this parameter by the limited value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowBound</code></td>
<td>
<p>Default value is -1, that means the plot covers also the lowest intensity peaks in the figure. If the users want to limit the under height of the figure, set this parameter by the limited value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAxisPos</code></td>
<td>
<p>The number of ticks that will be displayed in the horizontal axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offside</code></td>
<td>
<p>The offside of values in x-axis for display.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a plot containing both the BW and the spectra.
</p>


<h3>Author(s)</h3>

<p>Trung Nghia Vu
</p>


<h3>See Also</h3>

<p><code>drawSpec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">res=makeSimulatedData();
X=res$data;
groupLabel=res$label;
peakList &lt;- detectSpecPeaks(X,
                            nDivRange = c(128),
                            scales = seq(1, 16, 2),
                            baselineThresh = 50000,
                            SNR.Th = -1,
                            verbose=FALSE
);
resFindRef&lt;- findRef(peakList);
refInd &lt;- resFindRef$refInd;
maxShift = 50;
Y &lt;- dohCluster(X,
                peakList = peakList,
                refInd = refInd,
                maxShift  = maxShift,
                acceptLostPeak = TRUE, verbose=FALSE);
# find the BW-statistic
BW = BWR(Y, groupLabel);
N = 100;
alpha = 0.05;
# create sampled H0 and export to file
H0 = createNullSampling(Y, groupLabel, N = N,verbose=FALSE)
#compute percentile of alpha
perc = double(ncol(Y));
alpha_corr = alpha/sum(returnLocalMaxima(Y[2,])$pkMax&gt;50000);
for (i in seq_along(perc)) {
    perc[i] = quantile(H0[,i],1-alpha_corr, type = 3);
}
drawBW(BW, perc,Y, groupLabel = groupLabel)

</code></pre>


</div>