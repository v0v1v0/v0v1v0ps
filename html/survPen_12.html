<div class="container">

<table style="width: 100%;"><tr>
<td>grad_rho</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gradient vector of LCV and LAML wrt rho (log smoothing parameters)</h2>

<h3>Description</h3>

<p>Gradient vector of LCV and LAML wrt rho (log smoothing parameters)
</p>


<h3>Usage</h3>

<pre><code class="language-R">grad_rho(
  X_GL,
  GL_temp,
  haz_GL,
  deriv_rho_beta,
  weights,
  tm,
  nb_smooth,
  p,
  n_legendre,
  S_list,
  temp_LAML,
  Vp,
  S_beta,
  beta,
  inverse_new_S,
  X,
  temp_deriv3,
  event,
  expected,
  type,
  Ve,
  mat_temp,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_GL</code></td>
<td>
<p>list of matrices (<code>length(X.GL)=n.legendre</code>) for Gauss-Legendre quadrature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GL_temp</code></td>
<td>
<p>list of vectors used to make intermediate calculations and save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haz_GL</code></td>
<td>
<p>list of all the matrix-vector multiplications X.GL[[i]]%*%beta for Gauss Legendre integration in order to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_beta</code></td>
<td>
<p>firt derivative of beta wrt rho (implicit differentiation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of weights for Gauss-Legendre integration on [-1;1]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tm</code></td>
<td>
<p>vector of midpoints times for Gauss-Legendre integration; tm = 0.5*(t1 - t0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_smooth</code></td>
<td>
<p>number of smoothing parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_legendre</code></td>
<td>
<p>number of nodes for Gauss-Legendre quadrature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_list</code></td>
<td>
<p>List of all the rescaled penalty matrices multiplied by their associated smoothing parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_LAML</code></td>
<td>
<p>temporary matrix used when method="LAML" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vp</code></td>
<td>
<p>Bayesian covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_beta</code></td>
<td>
<p>List such that S_beta[[i]]=S_list[[i]]%*%beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of estimated regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_new_S</code></td>
<td>
<p>inverse of the penalty matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_deriv3</code></td>
<td>
<p>temporary matrix for third derivatives calculation when type="net" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>vector of right-censoring indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>vector of expected hazard rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>"net" or "overall"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ve</code></td>
<td>
<p>frequentist covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_temp</code></td>
<td>
<p>temporary matrix used when method="LCV" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>criterion used to select the smoothing parameters. Should be "LAML" or "LCV"; default is "LAML"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of objects with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>grad_rho</code></td>
<td>
<p>gradient vector of LCV or LAML</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_inv_Hess_beta</code></td>
<td>
<p>List of first derivatives of Vp wrt rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_Hess_unpen_beta</code></td>
<td>
<p>List of first derivatives of the Hessian of the unpenalized log-likelihood wrt rho</p>
</td>
</tr>
</table>
</div>