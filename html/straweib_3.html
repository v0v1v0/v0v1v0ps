<div class="container">

<table style="width: 100%;"><tr>
<td>icweib</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit stratified Weibull regression model</h2>

<h3>Description</h3>

<p>This function fits a stratified Weibull regression model using maximum
likelihood estimation. The function can incorporate right, left, interval
censored outcomes in addition to fully observed (i.e. uncensored) time to
event data. (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">icweib(L, R, data, strata = "ALL", covariates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>left endpoint of censoring interval. To indicate
left censoring, set L=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>right endpoint of censoring interval. To indicate right
censoring, set R=Inf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>variable for stratification. Set it to a character or
numeric constant for un-stratified model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>a formula to specify explanatory variables in the
proportional hazards model. The input is a right hand formula object,
such as ~x1 + x2. The default is NULL, corresponding to the no covariate case.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As in the stratified Cox proportional hazards model (Collett (2003)),
this model allows a baseline hazard function that is stratum-specific. However,
the model assumes that the regression coefficients for all other explanatory
variables (excluding the stratum indicator) are constant across strata.
Assuming a Weibull distribution for the random variable corresponding to the
time to event in conjunction with the Cox proportional hazards model, the survival
function can be expressed as S(t | Z) = exp(-lambda*exp(beta*Z)*t^(gamma)), where
Z denotes the vector of covariates, gamma denotes the shape parameter and lambda
the scale parameter.  To allow stratum-specific baseline hazard functions,
we generalize the model given above by  expressing the survival function as
S(t | Z, Stratum=i) = exp(-lambda_i*exp(beta*Z)*t^(gamma_i)), where i denotes
the stratum, Z denotes the vector of covariates, gamma_i and lambda_i denote
the shape and scale parameters for stratum i, respectively.  In particular,
the model assumes that the coefficients for explanatory covariates Z (denoted by beta)
are the same for all strata i.
</p>
<p>In the likelihood optimization, u_i=log(lambda_i) and v_i=log(gamma_i) are used as
parameters to remove the parameters' range constriction. The likelihood function is
optimized using optim() function. The maximum likelihood estimates are used to
estimate baseline hazard ratios between two subjects (see <code>HRatio</code>),
and survival function (see <code>plot.icweib</code>).
</p>
<p>This function can accommondate different types of censored time-to-event outcomes:
left censoring, right censoring, interval censoring, and non-censoring (event),
by appropriately setting L and R,
</p>

<table>
<tr>
<td style="text-align: left;">
L     </td>
<td style="text-align: left;"> R     </td>
<td style="text-align: left;"> INTERPRETATION </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
a   </td>
<td style="text-align: left;"> b   </td>
<td style="text-align: left;"> interval censoring, [a, b] </td>
</tr>
<tr>
<td style="text-align: left;">
0   </td>
<td style="text-align: left;"> b   </td>
<td style="text-align: left;"> left censoring, [0, b] </td>
</tr>
<tr>
<td style="text-align: left;">
a   </td>
<td style="text-align: left;"> Inf </td>
<td style="text-align: left;"> right censoring, [a, Inf] </td>
</tr>
<tr>
<td style="text-align: left;">
a   </td>
<td style="text-align: left;"> a   </td>
<td style="text-align: left;"> no censoring, event time = a </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns an object with class <em>icweib</em>. The items in the object are,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log-likelihood functions of the full, reduced, and null models. Reduced model refers to the model that all shape parameters are same. Null model refers to the model that there is no covariate in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>results for estimated coefficients for explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weib</code></td>
<td>
<p>estimated Weibull shape and scale parameters for each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratatest</code></td>
<td>
<p>results of likelihood ratio test and Wald test corresponding to the null hypothesis that all the strata specific shape parameters are equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>covariance matrix of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>information of different counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delete</code></td>
<td>
<p>observation numbers in the data that are deleted due to inappropriate input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxT</code></td>
<td>
<p>maximum observed time in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>returned object from the <em>optim</em> function for the full model.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Collett, D. (2003). <em>Modelling Survival Data in Medical Research,
Second Edition</em>, Texts in statistical science. Taylor &amp; Francis.
</p>


<h3>See Also</h3>

<p><code>HRatio</code>, <code>plot.icweib</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Analyze tooth data
data(tooth24)   ## load data
## Stratified on dmf, and sex as explanatory variable
fit &lt;- icweib(L = left, R = right, data = tooth24, strata = dmf, covariates = ~sex)

## Analyze hypernephroma data
data(hyper)

## Derive left and right endpoints from time and status
hyper$left &lt;- hyper$time
hyper$right &lt;- ifelse(hyper$status==1, hyper$time, Inf)

## Stratified on nephrectomy, and age group as explanatory variable
fit1 &lt;- icweib(L = left, R = right, data = hyper, strata = nephrectomy, covariates = ~factor(age))

</code></pre>


</div>