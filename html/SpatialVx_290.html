<div class="container">

<table style="width: 100%;"><tr>
<td>variographier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Variography Score
</h2>

<h3>Description</h3>

<p>Calculate the variography score between two spatial fields based on the fitted exponential variogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">variographier(x, init, zero.out = FALSE, ...)

## Default S3 method:
variographier( x, init, zero.out = FALSE, ..., y )

## S3 method for class 'SpatialVx'
variographier( x, init, zero.out = FALSE, ...,
    obs = 1, model = 1, time.point = 1 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>

<p>matrices giving the fields on which to calculate the variography or a “SpatialVx” class object (<code>x</code> only).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>list with components <code>px</code> and <code>py</code> that give initial values for parameter estimates (sill + nugget and range).  If missing, default will attempt to find reasonable starting values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.out</code></td>
<td>

<p>logical should the variogram be calculated over all grid points or just ones where one or both fields are non-zero?  See <code>variogram.matrix</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.point</code></td>
<td>

<p>numeric or character indicating which time point from the “SpatialVx” verification set to select for analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs, model</code></td>
<td>

<p>numeric indicating which observation/forecast model to select for the analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments to <code>vgram.matrix</code> or <code>variogram.matrix</code> (if zero.out is TRUE).  Can also have optional arguments to <code>nlminb</code> (but not <code>lower</code> or <code>upper</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variography score calculated here is that from Ekstrom (2016).  So far, only the exponential variogram is allowed.
</p>
<p>Note that in the fitting, the model g(h) = c * ( 1 - exp( -a * h ) ) is used, but the variography is calculated for theta = 3 / a.  Therefore, the values in the par component of the returned fitted variograms correspond to a, while the variography score corresponds to theta.  The score is given by:
</p>
<p>v = 1 / sqrt( c_0^2 + c_m^2 + ( theta_0 - theta_m )^2 )
</p>
<p>where c_0 and c_m are the sill + nugget terms for the observation and model, resp., and similarly for theta_0 and theta_m.
</p>
<p>The parameters are *not* currently normalized, here, to give equal weight between sill + nugget and range.  If several fields are analyzed (e.g., an ensemble), then the fitted parameters could be gathered, and one could use that information to calculate the score based on a normalized version.
</p>


<h3>Value</h3>

<p>A list object of class “variographied” is returned with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>obs.vg, mod.vg </code></td>
<td>
<p>Empirical variogram objects as returned by either vgram.matrix or variogram.matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.parvg, mod.parvg </code></td>
<td>
<p>objects returned by nlminb containing the fitted exponential variogram model parameters and some information about the optimization.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variography</code></td>
<td>
<p> single numeric giving the variography measure.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Ekstrom, M. (2016) Metrics to identify meaningful downscaling skill in WRF simulations of intense rainfall events.  <em>Environmental Modelling and Software</em>, <b>79</b>, 267–284, DOI: 10.1016/j.envsoft.2016.01.012.
</p>


<h3>See Also</h3>

<p><code>vgram.matrix</code>, <code>variogram.matrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( "UKobs6" )
data( "UKfcst6" )
data( "UKloc" )

hold &lt;- make.SpatialVx( UKobs6, UKfcst6, thresholds = c(0.01, 20.01),
    loc = UKloc, field.type = "Precipitation", units = "mm/h",
    data.name = "Nimrod", obs.name = "Observations 6", model.name = "Forecast 6",
    map = TRUE)

look &lt;- variographier( hold )
look
plot( look )
</code></pre>


</div>