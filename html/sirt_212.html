<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc.2pno.ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Random Item Response Model / Multilevel IRT Model
</h2>

<h3>Description</h3>

<p>This function enables the estimation of random item models and multilevel
(or hierarchical) IRT models (Chaimongkol, Huffer &amp; Kamata, 2007;
Fox &amp; Verhagen, 2010; van den Noortgate, de Boeck &amp; Meulders, 2003;
Asparouhov &amp; Muthen, 2012; Muthen &amp; Asparouhov, 2013, 2014).
Dichotomous response data is supported using a probit link. Normally
distributed responses can also be analyzed.
See Details for a description of the implemented item
response models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc.2pno.ml(dat, group, link="logit", est.b.M="h", est.b.Var="n",
    est.a.M="f", est.a.Var="n", burnin=500, iter=1000,
    N.sampvalues=1000, progress.iter=50, prior.sigma2=c(1, 0.4),
    prior.sigma.b=c(1, 1), prior.sigma.a=c(1, 1), prior.omega.b=c(1, 1),
    prior.omega.a=c(1, 0.4), sigma.b.init=.3 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Data frame with item responses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Vector of group identifiers (e.g. classes, schools or countries)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Link function. Choices are <code>"logit"</code> for dichotomous data
and <code>"normal"</code> for data under normal distribution assumptions
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.b.M</code></td>
<td>

<p>Estimation type of <code class="reqn">b_i</code> parameters: <br><code>n</code> - non-hierarchical prior
distribution, i.e. <code class="reqn">\omega_b</code> is set to a very high value and is not
estimated <br><code>h</code> - hierarchical prior distribution with estimated
distribution parameters <code class="reqn">\mu_b</code> and <code class="reqn">\omega_b</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.b.Var</code></td>
<td>

<p>Estimation type of standard deviations of item difficulties <code class="reqn">b_i</code>. <br><code>n</code> – no estimation of the item variance, i.e. <code class="reqn">\sigma_{b,i}</code> is
assumed to be zero <br><code>i</code> – item-specific standard deviation of item difficulties <br><code>j</code> – a joint standard deviation of all item difficulties is estimated,
i.e. <code class="reqn">\sigma_{b,1}=\ldots=\sigma_{b,I}=\sigma_b</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.a.M</code></td>
<td>

<p>Estimation type of <code class="reqn">a_i</code> parameters: <br><code>f</code> - no estimation of item slopes, i.e all item slopes <code class="reqn">a_i</code> are
fixed at one <br><code>n</code> - non-hierarchical prior distribution, i.e. <code class="reqn">\omega_a=0</code> <br><code>h</code> - hierarchical prior distribution with estimated
distribution parameter <code class="reqn">\omega_a</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.a.Var</code></td>
<td>

<p>Estimation type of standard deviations of item slopes <code class="reqn">a_i</code>. <br><code>n</code> – no estimation of the item variance <br><code>i</code> – item-specific standard deviation of item slopes <br><code>j</code> – a joint standard deviation of all item slopes is estimated,
i.e. <code class="reqn">\sigma_{a,1}=\ldots=\sigma_{a,I}=\sigma_a</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>

<p>Number of burnin iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>Total number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.sampvalues</code></td>
<td>

<p>Maximum number of sampled values to save
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress.iter</code></td>
<td>

<p>Display progress every <code>progress.iter</code>-th iteration. If no progress
display is wanted, then choose <code>progress.iter</code> larger than <code>iter</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sigma2</code></td>
<td>

<p>Prior for Level 2 standard deviation <code class="reqn">\sigma_{L2}</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sigma.b</code></td>
<td>

<p>Priors for item difficulty standard deviations <code class="reqn">\sigma_{b,i}</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sigma.a</code></td>
<td>

<p>Priors for item difficulty standard deviations <code class="reqn">\sigma_{a,i}</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.omega.b</code></td>
<td>

<p>Prior for <code class="reqn">\omega_b</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.omega.a</code></td>
<td>

<p>Prior for <code class="reqn">\omega_a</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.b.init</code></td>
<td>

<p>Initial standard deviation for <code class="reqn">\sigma_{b,i}</code> parameters
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For dichotomous item responses (<code>link="logit"</code>) of persons <code class="reqn">p</code> in
group <code class="reqn">j</code> on
item <code class="reqn">i</code>, the probability of a correct response is defined as
</p>
<p style="text-align: center;"><code class="reqn">P( X_{pji}=1 | \theta_{pj} )=\Phi ( a_{ij} \theta_{pj} - b_{ij} )</code>
</p>

<p>The ability <code class="reqn">\theta_{pj}</code> is decomposed into a Level 1 and a Level 2
effect </p>
<p style="text-align: center;"><code class="reqn">\theta_{pj}=u_j + e_{pj} \quad, \quad
    u_j \sim N ( 0, \sigma_{L2}^2 ) \quad, \quad
    e_{pj} \sim N ( 0, \sigma_{L1}^2 ) </code>
</p>

<p>In a multilevel IRT model (or a random item model), item parameters are
allowed to vary across groups:
</p>
<p style="text-align: center;"><code class="reqn"> b_{ij} \sim N( b_i, \sigma^2_{b,i} ) \quad, \quad
    a_{ij} \sim N( a_i, \sigma^2_{a,i} ) </code>
</p>

<p>In a hierarchical IRT model, a hierarchical distribution of the (main)
item parameters is assumed
</p>
<p style="text-align: center;"><code class="reqn"> b_{i} \sim N( \mu_b, \omega^2_{b} ) \quad, \quad
    a_{i} \sim N( 1, \omega^2_{a} ) </code>
</p>

<p>Note that for identification purposes, the mean of all item slopes <code class="reqn">a_i</code>
is set to one. Using the arguments <code>est.b.M</code>, <code>est.b.Var</code>,
<code>est.a.M</code> and <code>est.a.Var</code> defines which variance components
should be estimated.
</p>
<p>For normally distributed item responses (<code>link="normal"</code>), the model
equations remain the same except the item response model which is now written as
</p>
<p style="text-align: center;"><code class="reqn"> X_{pji}=a_{ij} \theta_{pj} - b_{ij} + \varepsilon_{pji} \quad,
\quad \varepsilon_{pji} \sim N( 0, \sigma^2_{res,i} ) </code>
</p>



<h3>Value</h3>

<p>A list of class <code>mcmc.sirt</code> with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mcmcobj</code></td>
<td>
<p>Object of class <code>mcmc.list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.mcmcobj</code></td>
<td>
<p>Summary of the <code>mcmcobj</code> object. In this
summary the Rhat statistic and the mode estimate MAP is included.
The variable <code>PercSEratio</code> indicates the proportion of the Monte Carlo
standard error in relation to the total standard deviation of the
posterior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>Information criteria (DIC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burnin iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Total number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">\theta_{pj}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.chain</code></td>
<td>
<p>Sampled values of <code class="reqn">u_{j}</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance.chain</code></td>
<td>
<p>Sampled values of Deviance values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EAP.rel</code></td>
<td>
<p>EAP reliability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person</code></td>
<td>
<p>Data frame with EAP person parameter estimates for
<code class="reqn">\theta_pj</code> and their corresponding posterior standard
deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Used data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further values</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Asparouhov, T. &amp; Muthen, B. (2012). General random effect latent variable
modeling: Random subjects, items, contexts, and parameters.
<em>http://www.statmodel.com/papers_date.shtml</em>.
</p>
<p>Chaimongkol, S., Huffer, F. W., &amp; Kamata, A. (2007).
An explanatory differential item functioning (DIF)
model by the WinBUGS 1.4.
<em>Songklanakarin Journal of Science and Technology, 29</em>, 449-458.
</p>
<p>Fox, J.-P., &amp; Verhagen, A.-J. (2010). Random item effects modeling for
cross-national survey data.
In E. Davidov, P. Schmidt, &amp; J. Billiet (Eds.),
<em>Cross-cultural Analysis: Methods and Applications</em>
(pp. 467-488), London: Routledge Academic.
</p>
<p>Muthen, B. &amp; Asparouhov, T. (2013). New methods for the study of measurement
invariance with many groups. <em>http://www.statmodel.com/papers_date.shtml</em>
</p>
<p>Muthen, B. &amp; Asparouhov, T. (2014).
Item response modeling in Mplus: A multi-dimensional, multi-level,
and multi-timepoint example. In W. Linden &amp; R. Hambleton (2014).
<em>Handbook of item response theory: Models, statistical tools, and
applications</em>. <em>http://www.statmodel.com/papers_date.shtml</em>
</p>
<p>van den Noortgate, W., De Boeck, P., &amp; Meulders, M. (2003).
Cross-classification multilevel logistic models in psychometrics.
<em>Journal of Educational and Behavioral Statistics, 28</em>, 369-386.
</p>


<h3>See Also</h3>

<p>S3 methods: <code>summary.mcmc.sirt</code>, <code>plot.mcmc.sirt</code>
</p>
<p>For MCMC estimation of three-parameter (testlet) models see
<code>mcmc.3pno.testlet</code>.
</p>
<p>See also the <span class="pkg">MLIRT</span> package (http://www.jean-paulfox.com).
</p>
<p>For more flexible estimation of multilevel IRT models see the
<span class="pkg">MCMCglmm</span> and <span class="pkg">lme4</span> packages.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Dataset Multilevel data.ml1 - dichotomous items
#############################################################################
data(data.ml1)
dat &lt;- data.ml1[,-1]
group &lt;- data.ml1$group
# just for a try use a very small number of iterations
burnin &lt;- 50 ; iter &lt;- 100

#***
# Model 1: 1PNO with no cluster item effects
mod1 &lt;- sirt::mcmc.2pno.ml( dat, group, est.b.Var="n", burnin=burnin, iter=iter )
summary(mod1)    # summary
plot(mod1,layout=2,ask=TRUE) # plot results
# write results to coda file
mcmclist2coda( mod1$mcmcobj, name="data.ml1_mod1" )

#***
# Model 2: 1PNO with cluster item effects of item difficulties
mod2 &lt;- sirt::mcmc.2pno.ml( dat, group, est.b.Var="i", burnin=burnin, iter=iter )
summary(mod2)
plot(mod2, ask=TRUE, layout=2 )

#***
# Model 3: 2PNO with cluster item effects of item difficulties but
#          joint item slopes
mod3 &lt;- sirt::mcmc.2pno.ml( dat, group, est.b.Var="i", est.a.M="h",
              burnin=burnin, iter=iter )
summary(mod3)

#***
# Model 4: 2PNO with cluster item effects of item difficulties and
#          cluster item effects with a jointly estimated SD
mod4 &lt;- sirt::mcmc.2pno.ml( dat, group, est.b.Var="i", est.a.M="h",
                est.a.Var="j", burnin=burnin, iter=iter )
summary(mod4)

#############################################################################
# EXAMPLE 2: Dataset Multilevel data.ml2 - polytomous items
#            assuming a normal distribution for polytomous items
#############################################################################
data(data.ml2)
dat &lt;- data.ml2[,-1]
group &lt;- data.ml2$group
# set iterations for all examples (too few!!)
burnin &lt;- 100 ; iter &lt;- 500

#***
# Model 1: no intercept variance, no slopes
mod1 &lt;- sirt::mcmc.2pno.ml( dat=dat, group=group, est.b.Var="n",
             burnin=burnin, iter=iter, link="normal",  progress.iter=20  )
summary(mod1)

#***
# Model 2a: itemwise intercept variance, no slopes
mod2a &lt;- sirt::mcmc.2pno.ml( dat=dat, group=group, est.b.Var="i",
            burnin=burnin, iter=iter,link="normal",  progress.iter=20  )
summary(mod2a)

#***
# Model 2b: homogeneous intercept variance, no slopes
mod2b &lt;- sirt::mcmc.2pno.ml( dat=dat, group=group, est.b.Var="j",
              burnin=burnin, iter=iter,link="normal",  progress.iter=20  )
summary(mod2b)

#***
# Model 3: intercept variance and slope variances
#          hierarchical item and slope parameters
mod3 &lt;- sirt::mcmc.2pno.ml( dat=dat, group=group,
               est.b.M="h", est.b.Var="i", est.a.M="h", est.a.Var="i",
               burnin=burnin, iter=iter,link="normal",  progress.iter=20  )
summary(mod3)

#############################################################################
# EXAMPLE 3: Simulated random effects model | dichotomous items
#############################################################################
set.seed(7698)

#*** model parameters
sig2.lev2 &lt;- .3^2   # theta level 2 variance
sig2.lev1 &lt;- .8^2   # theta level 1 variance
G &lt;- 100            # number of groups
n &lt;- 20             # number of persons within a group
I &lt;- 12             # number of items
#*** simuate theta
theta2 &lt;- stats::rnorm( G, sd=sqrt(sig2.lev2) )
theta1 &lt;- stats::rnorm( n*G, sd=sqrt(sig2.lev1) )
theta  &lt;- theta1 + rep( theta2, each=n )
#*** item difficulties
b &lt;- seq( -2, 2, len=I )
#*** define group identifier
group &lt;- 1000 + rep(1:G, each=n )
#*** SD of group specific difficulties for items 3 and 5
sigma.item &lt;- rep(0,I)
sigma.item[c(3,5)] &lt;- 1
#*** simulate group specific item difficulties
b.class &lt;- sapply( sigma.item, FUN=function(sii){ stats::rnorm( G, sd=sii ) } )
b.class &lt;- b.class[ rep( 1:G,each=n ), ]
b &lt;- matrix( b, n*G, I, byrow=TRUE ) + b.class
#*** simulate item responses
m1 &lt;- stats::pnorm( theta - b )
dat &lt;- 1 * ( m1 &gt; matrix( stats::runif( n*G*I ), n*G, I ) )

#*** estimate model
mod &lt;- sirt::mcmc.2pno.ml( dat, group=group, burnin=burnin, iter=iter,
            est.b.M="n", est.b.Var="i", progress.iter=20)
summary(mod)
plot(mod, layout=2, ask=TRUE )

## End(Not run)
</code></pre>


</div>