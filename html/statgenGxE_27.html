<div class="container">

<table style="width: 100%;"><tr>
<td>plot.AMMI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot function for class AMMI</h2>

<h3>Description</h3>

<p>Two types of biplot can be made. A plot of genotype and environment
means vs PC1 (AMMI1) or a biplot of genotypes and environment interaction
with PC1 and PC2 (AMMI2).<br><br>
If the AMMI analysis was done by year, a separate plot will be made for
every year in the data. For some years the number of principal components
may be lower than the number specified on the secondary axis. If this is the
case this year is skipped when plotting. If this happens for all years the
function returns an error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'AMMI'
plot(
  x,
  ...,
  plotType = c("AMMI1", "AMMI2", "GGE2"),
  scale = 1,
  plotGeno = TRUE,
  colorGenoBy = NULL,
  colGeno = NULL,
  sizeGeno = 0,
  plotConvHull = FALSE,
  plotEnv = TRUE,
  colorEnvBy = NULL,
  colEnv = NULL,
  sizeEnv = 3,
  envFactor = 1,
  primAxis = "PC1",
  secAxis = "PC2",
  rotatePC = NULL,
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class AMMI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>A character string indicating which plot should be made.
Either "AMMI1" for an AMMI1 plot (genotype and
environment means vs PC1) or "AMMI2" for an AMMI2 biplot (genotypes and
environment interaction with PC1 and PC2) respectively. For results of a
GGE analysis only an GGE2 biplot can be made and plotType may be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A numerical value. The variables are scaled by
<code>lambda ^ scale</code> and the observations by <code>lambda ^ (1 - scale)</code>
where <code>lambda</code> are the singular values computed by
<code>princomp</code> in <code>gxeAmmi</code>. Normally
<code>0 &lt;= scale &lt;= 1</code>, and a warning will be issued if the specified
scale is outside this range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotGeno</code></td>
<td>
<p>Should genotypes be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorGenoBy</code></td>
<td>
<p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the genotypes should be colored.
If <code>NULL</code> all genotypes will be colored in black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colGeno</code></td>
<td>
<p>A character vector with plot colors for the genotypes. A
single color when <code>colorGenoBy = NULL</code>, a vector of colors otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeGeno</code></td>
<td>
<p>An numerical value indicating the text size for plotting the
genotypes. Use <code>sizeGeno = 0</code> for plotting genotypes as points instead
of using their names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotConvHull</code></td>
<td>
<p>Should a convex hull be plotted around the genotypes. If
<code>TRUE</code> a convex hull is plotted. For GGE2 biplots lines from the origin
of the plot perpendicular to the edges of the hull are added. Only valid for
AMMI2 and GGE2 biplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotEnv</code></td>
<td>
<p>Should environments be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorEnvBy</code></td>
<td>
<p>A character string indicating a column in the <code>TD</code>
used as input for the AMMI analysis by which the environments should be
colored. If <code>NULL</code> all genotypes will be colored in red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colEnv</code></td>
<td>
<p>A character string with plot colors for the environments. A
single color when <code>colorEnvBy = NULL</code>, a vector of colors otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeEnv</code></td>
<td>
<p>An integer indicating the text size for plotting the
environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envFactor</code></td>
<td>
<p>A positive numerical value giving a factor by which to blow
up the environmental scores. Providing a value between 0 and 1 will
effectively blow up the genotypic scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primAxis</code></td>
<td>
<p>A character string indicating the principal component to be
plotted on the primary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>secAxis</code></td>
<td>
<p>A character string indicating the principal component to be
plotted on the secondary axis of the AMMI2 plot. Has to be given as
<code>"PCn"</code> where n is the number of the principal component. n Has to
differ from <code>primAxis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotatePC</code></td>
<td>
<p>A character string indicating a genotype or environment that
is to be aligned with the positive x-axis in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A character string used a title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A biplot depending on <code>plotType</code>. The ggplot object for the
biplot is returned invisibly.
</p>


<h3>See Also</h3>

<p>Other AMMI: 
<code>fitted.AMMI()</code>,
<code>gxeAmmi()</code>,
<code>report.AMMI()</code>,
<code>residuals.AMMI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Run AMMI analysis.
geAmmi &lt;- gxeAmmi(TD = TDMaize, trait = "yld")

## Create an AMMI1 biplot.
plot(geAmmi)

## Create an AMMI2 biplot.
plot(geAmmi, plotType = "AMMI2", scale = 0.5)

## Create an AMMI2 biplot, with HN96b along the positive x-axis.
plot(geAmmi, plotType = "AMMI2", scale = 0.5, rotatePC = "HN96b")

## Run GGE analysis.
geGGE &lt;- gxeGGE(TD = TDMaize, trait = "yld")

## Create an GGE2 biplot.
## Add a convex hull.
plot(geGGE, plotType = "GGE2", scale = 0.5, plotConvHull = TRUE)

</code></pre>


</div>