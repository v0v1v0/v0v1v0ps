<div class="container">

<table style="width: 100%;"><tr>
<td>cosinor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cosinor Regression Model for Detecting Seasonality in Yearly Data or
Circadian Patterns in Hourly Data</h2>

<h3>Description</h3>

<p>Fits a cosinor model as part of a generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cosinor(
  formula,
  date,
  data,
  family = gaussian(),
  alpha = 0.05,
  cycles = 1,
  rescheck = FALSE,
  type = "daily",
  offsetmonth = FALSE,
  offsetpop = NULL,
  text = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p>a date variable if type=“daily”, or an integer between 1
and 53 if type=“weekly”, or an integer between 1 and 12 if
type=“monthly”, or a POSIXct date if type=“hourly”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data set as a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. Available link functions: identity, log, logit,
cloglog. Note, it must have the parentheses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level, set to 0.05 (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycles</code></td>
<td>
<p>number of seasonal cycles per year if type=“daily”,
“weekly” or “monthly”; number of cycles per 24 hours if
type=“hourly”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescheck</code></td>
<td>
<p>plot the residual checks (TRUE/FALSE), see
<code>seasrescheck</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>“daily” for daily data (default), or “weekly” for
weekly data, or “monthly” for monthly data, or “hourly” for
hourly data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsetmonth</code></td>
<td>
<p>include an offset to account for the uneven number of
days in the month (TRUE/FALSE). Should be used for monthly counts
(type=“monthly”) (with <code>family=poisson()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsetpop</code></td>
<td>
<p>include an offset for the population (optional), this
should be a variable in the data frame. Do not log-transform this offset, as
the transform is applied by the code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>add explanatory text to the returned phase value (TRUE) or
return a number (FALSE). Passed to the <code>invyrfraction</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cosinor model captures a seasonal pattern using a sinusoid. It is
therefore suitable for relatively simple seasonal patterns that are
symmetric and stationary. The default is to fit an annual seasonal pattern
(<code>cycle</code>=1), but other higher frequencies are possible (e.g., twice per
year: <code>cycle</code>=2). The model is fitted using a sine and cosine term that
together describe the sinusoid. These parameters are added to a generalized
linear model, so the model can be fitted to a range of dependent data (e.g.,
Normal, Poisson, Binomial). Unlike the <code>nscosinor</code> model, the cosinor
model can be applied to unequally spaced data.
</p>


<h3>Value</h3>

<p>Returns an object of class “Cosinor” with the following
parts: </p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the original call to the cosinor function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm</code></td>
<td>
<p>an
object of class <code>glm</code> (see <code>glm</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>fitted
values for intercept and cosinor only (ignoring other independent
variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.plus</code></td>
<td>
<p>standard fitted values, including all other
independent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p>name of the
date variable (in Date format when type=‘daily’).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Adrian Barnett <a href="mailto:a.barnett@qut.edu.au">a.barnett@qut.edu.au</a>
</p>


<h3>References</h3>

<p>Barnett, A.G., Dobson, A.J. (2010) <em>Analysing Seasonal
Health Data</em>. Springer.
</p>


<h3>See Also</h3>

<p><code>summary.Cosinor</code>, <code>plot.Cosinor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## cardiovascular disease data (offset based on number of days in...
## ...the month scaled to an average month length)
data(CVD)
res = cosinor(cvd~1, date='month', data=CVD, type='monthly',
              family=poisson(), offsetmonth=TRUE)
summary(res)
seasrescheck(res$residuals) # check the residuals
## stillbirth data
data(stillbirth)
res = cosinor(stillborn~1, date='dob', data=stillbirth,
              family=binomial(link='cloglog'))
summary(res)
plot(res)
## hourly indoor temperature data
res = cosinor(bedroom~1, date='datetime', type='hourly', data=indoor)
summary(res)
# to get the p-values for the sine and cosine estimates
summary(res$glm)

</code></pre>


</div>