<div class="container">

<table style="width: 100%;"><tr>
<td>sparsemdc_gap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gap Statistic Calculator</h2>

<h3>Description</h3>

<p>This function calculates the gap statistic for SparseMDC. For use
when the number of clusters in the data is unknown. We recommend
using alternate methods to infer the number of clusters in the
data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparsemdc_gap(pdat, dim, min_clus, max_clus, nboots = 200, nitter = 20,
  nstarts = 10, l1_boot = 50, l2_boot = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdat</code></td>
<td>
<p>list with D entries, each entry contains data d, p * n matrix.
This data should be centered and log-transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>Total number of conditions, D.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_clus</code></td>
<td>
<p>The minimum number of clusters to try, minimum value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_clus</code></td>
<td>
<p>The maximum number of clusters to try.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboots</code></td>
<td>
<p>The number of bootstrap repetitions to use, default = 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitter</code></td>
<td>
<p>The max number of iterations for each of the start values, the
default value is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstarts</code></td>
<td>
<p>The number of start values to use for SparseDC. The default
value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_boot</code></td>
<td>
<p>The number of bootstrap repetitions used for estimating
lambda 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2_boot</code></td>
<td>
<p>The number of bootstrap repetitions used for estimating
lambda 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the optimal number of clusters, as well as gap
statistics and the calculated standard error for each number of clusters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)
# Select small dataset for example
data_test &lt;- data_biase[1:100,]
# Split data into condition A and B
data_A &lt;- data_test[ , which(condition_biase == "A")]
data_B &lt;- data_test[ , which(condition_biase == "B")]
data_C &lt;- data_test[ , which(condition_biase == "C")]
# Store data as list
dat_l &lt;- list(data_A, data_B, data_C)
# Pre-process the data
pdat &lt;- pre_proc_data(dat_l, dim=3, norm = FALSE, log = TRUE,
center = TRUE)
# Run with one bootstrap sample for example
gap_stat &lt;- sparsemdc_gap(pdat, dim=3, min_clus = 2, max_clus =3, nboots =2,
nitter = 2, nstarts = 1, l1_boot = 5, l2_boot = 5)

</code></pre>


</div>