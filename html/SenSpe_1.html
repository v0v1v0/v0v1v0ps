<div class="container">

<table style="width: 100%;"><tr>
<td>snsp1m</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating specificity (or sensitivity) at a controlled sensitivity
(or specificity) level</h2>

<h3>Description</h3>

<p>Point estimation and exact bootstrap-based inference</p>


<h3>Usage</h3>

<pre><code class="language-R">snsp1m(mk, n1, s0, covp=0.95, fixsens=TRUE, lbmdis=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mk</code></td>
<td>
<p>biomarker values of cases followed by controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>size of cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>controlled level of sensitivity or specificity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covp</code></td>
<td>
<p>norminal level of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixsens</code></td>
<td>
<p>fixing sensitivity if True, and specificity otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbmdis</code></td>
<td>
<p>larger biomarker value is more associated with cases if True,
and controls otherwise.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>estimated threshold, at and beyond which the empirical
sensitivity or specificity is the smallest no less than the controlled level
s0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hss</code></td>
<td>
<p>hss[1]: empirical point estimate of specificity at controlled
sensitivity, or vice versa; hss[2]: oscillating bias-corrected estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hvar1</code></td>
<td>
<p>estimated variance component from cases if specificity at
controlled sensitivity is estimated, or from controls otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hvar2</code></td>
<td>
<p>estimated variance component from controls if specificity at
controlled sensitivity is estimated, or from cases otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hvar</code></td>
<td>
<p>exact bootstrap variance estimate, =hvar1+hvar2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btpdf</code></td>
<td>
<p>exact bootstrap probability mass function at (0:n0)/n0 with n0
being the size of controls if sensitivity is controlled, or at (0:n1)/n1
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald_ci</code></td>
<td>
<p>wald_ci[1,]: Wald confidence interval using hss[1];
wald_ci[2,]: Wald confidence interval using hss[2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_ci</code></td>
<td>
<p>percentile confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scr_ci</code></td>
<td>
<p>scr_ci[1,]: score confidence interval using hss[1];
scr_ci[2,]: score confidence interval using hss[2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zq_ci</code></td>
<td>
<p>exact bootstrap version of the BTII in Zhou and Qin (2005,
Statistics in Medicine 24, pp 465–477).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y., Parakati, I., Patil, D. H.,and Sanda, M. G. (2023).
Interval estimation for operating characteristic of continuous biomarkers with
controlled sensitivity or specificity, <em>Statistica Sinica</em> 33, 193–214.</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate biomarkers of 100 cases and 100 controls
set.seed(1234)
mk &lt;- c(rnorm(100,1,1),rnorm(100,0,1))

## estimate specificity at controlled 0.95 sensitivity
est &lt;- snsp1m(mk, 100, 0.95)
</code></pre>


</div>