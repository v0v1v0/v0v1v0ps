<div class="container">

<table style="width: 100%;"><tr>
<td>sobolEff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimation of Sobol' Indices (formulas of Janon-Monod)</h2>

<h3>Description</h3>

 <p><code>sobolEff</code> implements the Monte Carlo estimation of the Sobol' sensitivity indices using the asymptotically efficient formulas in section 4.2.4.2 of Monod et al. (2006). Either all first-order indices or all total-effect indices are estimated at a cost of <code class="reqn">N \times (p+1)</code> model calls or all closed second-order indices are estimated at a cost of <code class="reqn">N \times p \choose 2)</code> model calls.</p>


<h3>Usage</h3>

<pre><code class="language-R">sobolEff(model = NULL, X1, X2, order=1, nboot = 0, conf = 0.95, ...)
## S3 method for class 'sobolEff'
tell(x, y = NULL, ...)
## S3 method for class 'sobolEff'
print(x, ...)
## S3 method for class 'sobolEff'
plot(x, ylim = c(0, 1), ...)
## S3 method for class 'sobolEff'
ggplot(data, mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>the first random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the second random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>an integer specifying the indices to estimate: 0 for total effect indices,1 for first-order indices and 2 for closed second-order indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates, or zero to use asymptotic 
standard deviation estimates given in Janon et al. (2012).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"sobolEff"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"sobolEff"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimator used by sobolEff is defined in Monod et al. (2006), 
Section 4.2.4.2 and studied under the name T_N in Janon et al. (2012). 
This estimator is good for large first-order indices.
</p>


<h3>Value</h3>

<p><code>sobolEff</code> returns a list of class <code>"sobolEff"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' sensitivity indices.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alexandre Janon, Laurent Gilquin
</p>


<h3>References</h3>

<p>Monod, H., Naud, C., Makowski, D. (2006), Uncertainty and sensitivity 
analysis for crop models in Working with Dynamic Crop Models: Evaluation, 
Analysis, Parameterization, and Applications, Elsevier.
</p>
<p>A. Janon, T. Klein, A. Lagnoux, M. Nodet, C. Prieur (2014), <em>Asymptotic normality and efficiency of two Sobol index estimators</em>, ESAIM: Probability and Statistics, 18:342-364.
</p>


<h3>See Also</h3>

<p><code>sobol, sobol2002, sobolSalt, sobol2007, soboljansen, sobolmartinez,
  sobolSmthSpl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case : the non-monotonic Sobol g-function

# The method of sobol requires 2 samples
# (there are 8 factors, all following the uniform distribution on [0,1])
n &lt;- 1000
X1 &lt;- data.frame(matrix(runif(8 * n), nrow = n))
X2 &lt;- data.frame(matrix(runif(8 * n), nrow = n))

# sensitivity analysis
x &lt;- sobolEff(model = sobol.fun, X1 = X1, X2 = X2, nboot = 0)
print(x)

library(ggplot2)
ggplot(x)
</code></pre>


</div>