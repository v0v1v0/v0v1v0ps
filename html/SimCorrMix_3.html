<div class="container">

<table style="width: 100%;"><tr>
<td>contmixvar1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of One Continuous Variable with a Mixture Distribution Using the Power Method Transformation</h2>

<h3>Description</h3>

<p>This function simulates one continuous mixture variable.  Mixture distributions describe random variables that
are drawn from more than one component distribution.  For a random variable <code class="reqn">Y_{mix}</code> from a finite continuous mixture
distribution with <code class="reqn">k</code> components, the probability density function (PDF) can be described by:
</p>
<p style="text-align: center;"><code class="reqn">h_Y(y) = \sum_{i=1}^{k} \pi_i f_{Yi}(y), \sum_{i=1}^{k} \pi_i = 1.</code>
</p>

<p>The <code class="reqn">\pi_i</code> are mixing parameters which determine the weight of each component distribution <code class="reqn">f_{Yi}(y)</code> in the overall
probability distribution.  As long as each component has a valid PDF, the overall distribution <code class="reqn">h_Y(y)</code> has a valid PDF.
The main assumption is statistical independence between the process of randomly selecting the component distribution and the
distributions themselves.  Each component <code class="reqn">Y_i</code> is generated using either Fleishman's third-order (<code>method</code> = "Fleishman",
doi: <a href="http://doi.org/10.1007/BF02293811">10.1007/BF02293811</a>) or Headrick's fifth-order (<code>method</code> = "Polynomial",
doi: <a href="http://doi.org/10.1016/S0167-9473(02)00072-5">10.1016/S0167-9473(02)00072-5</a>) power method transformation (PMT).  It works by matching standardized
cumulants â€“ the first four (mean, variance, skew, and standardized kurtosis) for Fleishman's method, or the first six (mean,
variance, skew, standardized kurtosis, and standardized fifth and sixth cumulants) for Headrick's method.  The transformation is
expressed as follows:
</p>
<p style="text-align: center;"><code class="reqn">Y = c_0 + c_1 * Z + c_2 * Z^2 + c_3 * Z^3 + c_4 * Z^4 + c_5 * Z^5,  Z \sim N(0,1),</code>
</p>

<p>where <code class="reqn">c_4</code> and <code class="reqn">c_5</code> both equal <code class="reqn">0</code> for Fleishman's method.  The real constants are calculated by <br><code>find_constants</code>.  These components are then transformed to the desired mixture variable using a
random multinomial variable generated based on the mixing probabilities.  There are no parameter input checks in order to decrease
simulation time.  All inputs should be checked prior to simulation with <code>validpar</code>.  Summaries for the
simulation results can be obtained with <code>summary_var</code>.
</p>
<p>Mixture distributions provide a useful way for describing heterogeneity in a population, especially when an outcome is a
composite response from multiple sources.  The vignette <b>Variable Types</b> provides more information about simulation of mixture
variables and the required parameters.  The vignette <b>Expected Cumulants and Correlations for Continuous Mixture Variables</b>
gives the equations for the expected cumulants of a mixture variable.  In addition, Headrick &amp; Kowalchuk (2007,
doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>) outlined a general method for comparing a simulated distribution <code class="reqn">Y</code> to a given theoretical
distribution <code class="reqn">Y^*</code>.  These steps can be found in the <b>Continuous Mixture Distributions</b> vignette.
</p>


<h3>Usage</h3>

<pre><code class="language-R">contmixvar1(n = 10000, method = c("Fleishman", "Polynomial"), means = 0,
  vars = 1, mix_pis = NULL, mix_mus = NULL, mix_sigmas = NULL,
  mix_skews = NULL, mix_skurts = NULL, mix_fifths = NULL,
  mix_sixths = NULL, mix_Six = list(), seed = 1234, cstart = list(),
  quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size (i.e. the length of the simulated variable; default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to generate the component variables.  "Fleishman" uses Fleishman's third-order polynomial transformation
and "Polynomial" uses Headrick's fifth-order transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>mean for the mixture variable (default = 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>variance for the mixture variable (default = 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_pis</code></td>
<td>
<p>a vector of mixing probabilities that sum to 1 for the component distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_mus</code></td>
<td>
<p>a vector of means for the component distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_sigmas</code></td>
<td>
<p>a vector of standard deviations for the component distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_skews</code></td>
<td>
<p>a vector of skew values for the component distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_skurts</code></td>
<td>
<p>a vector of standardized kurtoses for the component distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_fifths</code></td>
<td>
<p>a vector of standardized fifth cumulants for the component distributions; keep NULL if using <code>method</code> = "Fleishman"
to generate continuous variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_sixths</code></td>
<td>
<p>a vector of standardized sixth cumulants for the component distributions; keep NULL if using <code>method</code> = "Fleishman"
to generate continuous variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_Six</code></td>
<td>
<p>a list of vectors of sixth cumulant correction values for the component distributions of <code class="reqn">Y_{mix}</code>;
use <code>NULL</code> if no correction is desired for a given component; if no correction is desired for any component keep as
<code>mix_Six = list()</code> (not necessary for <code>method</code> = "Fleishman")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed value for random number generation (default = 1234)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstart</code></td>
<td>
<p>a list of length equal to the total number of mixture components containing initial values for root-solving
algorithm used in <code>find_constants</code>.  If user specified, each list element must be input as a matrix.
For <code>method</code> = "Fleishman", each should have 3 columns for <code class="reqn">c_1, c_2, c_3</code>;
for <code>method</code> = "Polynomial", each should have 5 columns for <code class="reqn">c_1, c_2, c_3, c_4, c_5</code>.  If no starting values are specified for
a given component, that list element should be <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if FALSE prints total simulation time</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<p><code>constants</code> a data.frame of the constants
</p>
<p><code>Y_comp</code> a data.frame of the components of the mixture variable
</p>
<p><code>Y_mix</code> a data.frame of the generated mixture variable
</p>
<p><code>sixth_correction</code> the sixth cumulant correction values for <code>Y_comp</code>
</p>
<p><code>valid.pdf</code> "TRUE" if constants generate a valid PDF, else "FALSE"
</p>
<p><code>Time</code> the total simulation time in minutes
</p>


<h3>Overview of Simulation Process</h3>

<p>1) A check is performed to see if any distributions are repeated within the parameter inputs, i.e. if the mixture variable
contains 2 components with the same standardized cumulants.  These are noted so that the constants are only calculated once.
</p>
<p>2) The constants are calculated for each component variable using <code>find_constants</code>.  If no
solutions are found that generate a valid power method PDF, the function will return constants that produce an invalid PDF
(or a stop error if no solutions can be found).  Possible solutions include: 1) changing the seed, or 2) using a <code>mix_Six</code>
list with vectors of sixth cumulant correction values (if <code>method</code> = "Polynomial").  Errors regarding constant
calculation are the most probable cause of function failure.
</p>
<p>3) A matrix <code>X_cont</code> of dim <code>n x length(mix_pis)</code> of standard normal variables is generated and singular-value decomposition is done to
remove any correlation.  The <code>constants</code> are applied to <code>X_cont</code> to create the component variables <code>Y</code> with the desired distributions.
</p>
<p>4) A random multinomial variable <code>M = rmultinom(n, size = 1, prob = mix_pis)</code> is generated using <code>stats::rmultinom</code>.
The continuous mixture variable <code>Y_mix</code> is created from the component variables <code>Y</code> based on this multinomial variable.
That is, if <code>M[i, k_i] = 1</code>, then <code>Y_mix[i] = Y[i, k_i]</code>.  A location-scale transformation is done on <code>Y_mix</code> to give it mean <code>means</code> and variance <code>vars</code>.
</p>


<h3>Reasons for Function Errors</h3>

<p>1) The most likely cause for function errors is that no solutions to <code>fleish</code> or
<code>poly</code> converged when using <code>find_constants</code>.  If this happens,
the simulation will stop.  It may help to first use <code>find_constants</code> for each component variable to
determine if a sixth cumulant correction value is needed.  The solutions can be used as starting values (see <code>cstart</code> below).
If the standardized cumulants are obtained from <code>calc_theory</code>, the user may need to use rounded values as inputs (i.e.
<code>skews = round(skews, 8)</code>).  For example, in order to ensure that skew is exactly 0 for symmetric distributions.
</p>
<p>2) The kurtosis may be outside the region of possible values.  There is an associated lower boundary for kurtosis associated
with a given skew (for Fleishman's method) or skew and fifth and sixth cumulants (for Headrick's method).  Use
<code>calc_lower_skurt</code> to determine the boundary for a given set of cumulants.
</p>


<h3>References</h3>

<p>See references for <code>SimCorrMix</code>.
</p>


<h3>See Also</h3>

<p><code>find_constants</code>, <code>validpar</code>, <code>summary_var</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Mixture of Normal(-2, 1) and Normal(2, 1)
Nmix &lt;- contmixvar1(n = 1000, "Polynomial", means = 0, vars = 1,
  mix_pis = c(0.4, 0.6), mix_mus = c(-2, 2), mix_sigmas = c(1, 1),
  mix_skews = c(0, 0), mix_skurts = c(0, 0), mix_fifths = c(0, 0),
  mix_sixths = c(0, 0))
## Not run: 
# Mixture of Beta(6, 3), Beta(4, 1.5), and Beta(10, 20)
Stcum1 &lt;- calc_theory("Beta", c(6, 3))
Stcum2 &lt;- calc_theory("Beta", c(4, 1.5))
Stcum3 &lt;- calc_theory("Beta", c(10, 20))
mix_pis &lt;- c(0.5, 0.2, 0.3)
mix_mus &lt;- c(Stcum1[1], Stcum2[1], Stcum3[1])
mix_sigmas &lt;- c(Stcum1[2], Stcum2[2], Stcum3[2])
mix_skews &lt;- c(Stcum1[3], Stcum2[3], Stcum3[3])
mix_skurts &lt;- c(Stcum1[4], Stcum2[4], Stcum3[4])
mix_fifths &lt;- c(Stcum1[5], Stcum2[5], Stcum3[5])
mix_sixths &lt;- c(Stcum1[6], Stcum2[6], Stcum3[6])
mix_Six &lt;- list(seq(0.01, 10, 0.01), c(0.01, 0.02, 0.03),
  seq(0.01, 10, 0.01))
Bstcum &lt;- calc_mixmoments(mix_pis, mix_mus, mix_sigmas, mix_skews,
  mix_skurts, mix_fifths, mix_sixths)
Bmix &lt;- contmixvar1(n = 10000, "Polynomial", Bstcum[1], Bstcum[2]^2,
  mix_pis, mix_mus, mix_sigmas, mix_skews, mix_skurts, mix_fifths,
  mix_sixths, mix_Six)
Bsum &lt;- summary_var(Y_comp = Bmix$Y_comp, Y_mix = Bmix$Y_mix, means = means,
  vars = vars, mix_pis = mix_pis, mix_mus = mix_mus,
  mix_sigmas = mix_sigmas, mix_skews = mix_skews, mix_skurts = mix_skurts,
  mix_fifths = mix_fifths, mix_sixths = mix_sixths)

## End(Not run)
</code></pre>


</div>