<div class="container">

<table style="width: 100%;"><tr>
<td>simTs2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a model on a regular grid of times, using a function (closure) for advancing the state of the model</h2>

<h3>Description</h3>

<p>This function simulates single realisation of a model on a 2D regular
spatial grid and regular grid of times using a function (closure) for advancing the state of the model, such as created by <code>StepGillespie2D</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simTs2D(x0,t0=0,tt=100,dt=0.1,stepFun,verb=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>The initial state of the process at time <code>t0</code>, a 3d array
with dimensions corresponding to reacting species and two spatial dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>The initial time to be associated with the initial state <code>x0</code>. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>The terminal time of the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>The time step of the output. Note that this time step
relates only to the recorded output, and has no bearing on the accuracy of the simulation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepFun</code></td>
<td>
<p>A function (closure) for advancing the state of the
process, such as produced by <code>StepGillespie2D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>Output progress to the console and graphics window (this function can be very slow).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments will be passed to <code>stepFun</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An R 4d array representing the simulated process. The dimensions are
species, 2 space, and time.</p>


<h3>See Also</h3>

<p><code>StepGillespie2D</code>, <code>simTs1D</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(spnModels)
m=20; n=30; T=15
x0=array(0,c(2,m,n))
dimnames(x0)[[1]]=c("x1","x2")
x0[,round(m/2),round(n/2)]=LV$M
stepLV2D = StepGillespie2D(LV,c(0.6,0.6))
xx = simTs2D(x0,0,T,0.2,stepLV2D,verb=TRUE)
N = dim(xx)[4]
op=par(mfrow=c(1,2))
image(xx[1,,,N],main="Prey",xlab="Space",ylab="Time")
image(xx[2,,,N],main="Predator",xlab="Space",ylab="Time")
par(op)
</code></pre>


</div>