<div class="container">

<table style="width: 100%;"><tr>
<td>bw.ppl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood Cross Validation Bandwidth Selection for Kernel Density
</h2>

<h3>Description</h3>

<p>Uses likelihood cross-validation to select a smoothing bandwidth
for the kernel estimation of point process intensity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   bw.ppl(X, ..., srange=NULL, ns=16, sigma=NULL, varcov1=NULL,
          weights=NULL, shortcut=FALSE, warn=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A point pattern (object of class <code>"ppp"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>srange</code></td>
<td>

<p>Optional numeric vector of length 2 giving the
range of values of bandwidth to be searched.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>

<p>Optional integer giving the number of values of
bandwidth to search.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Optional. Vector of values of the bandwidth to be searched.
Overrides the values of <code>ns</code> and <code>srange</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov1</code></td>
<td>

<p>Optional. Variance-covariance matrix matrix of the kernel with
bandwidth <code class="reqn">h=1</code>. See section on Anisotropic Smoothing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional. Numeric vector of weights for the points of <code>X</code>.
Argument passed to <code>density.ppp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to
<code>density.ppp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shortcut</code></td>
<td>

<p>Logical value indicating whether to speed up the calculation
by omitting the integral term in the cross-validation criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>

<p>Logical. If <code>TRUE</code>, issue a warning if the maximum of
the cross-validation criterion occurs at one of the ends of the
search interval.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function selects an appropriate bandwidth <code>sigma</code>
for the kernel estimator of point process intensity
computed by <code>density.ppp</code>.
</p>
<p>The bandwidth <code class="reqn">\sigma</code> is chosen to 
maximise the point process likelihood cross-validation criterion
</p>
<p style="text-align: center;"><code class="reqn">
    \mbox{LCV}(\sigma) =
    \sum_i \log\hat\lambda_{-i}(x_i) - \int_W \hat\lambda(u) \, {\rm d}u
  </code>
</p>

<p>where the sum is taken over all the data points <code class="reqn">x_i</code>,
where <code class="reqn">\hat\lambda_{-i}(x_i)</code> is the
leave-one-out kernel-smoothing estimate of the intensity at
<code class="reqn">x_i</code> with smoothing bandwidth <code class="reqn">\sigma</code>,
and <code class="reqn">\hat\lambda(u)</code> is the kernel-smoothing estimate
of the intensity at a spatial location <code class="reqn">u</code> with smoothing
bandwidth <code class="reqn">\sigma</code>.
See Loader(1999, Section 5.3).
</p>
<p>The value of <code class="reqn">\mbox{LCV}(\sigma)</code> is computed
directly, using <code>density.ppp</code>, 
for <code>ns</code> different values of <code class="reqn">\sigma</code>
between <code>srange[1]</code> and <code>srange[2]</code>.
</p>
<p>The result is a numerical value giving the selected bandwidth.
The result also belongs to the class <code>"bw.optim"</code>
which can be plotted to show the (rescaled) mean-square error
as a function of <code>sigma</code>.
</p>
<p>If <code>shortcut=TRUE</code>, the computation is accelerated by
omitting the integral term in the equation above. This is valid
because the integral is approximately constant.
</p>


<h3>Value</h3>

<p>A numerical value giving the selected bandwidth.
The result also belongs to the class <code>"bw.optim"</code>
which can be plotted.
</p>


<h3>Anisotropic Smoothing</h3>

<p>Anisotropic kernel smoothing is available in <code>density.ppp</code> using
the argument <code>varcov</code> to specify the variance-covariance
matrix of the anisotropic kernel. In order to choose the matrix
<code>varcov</code>, the user can call <code>bw.ppl</code> 
using the argument <code>varcov1</code> to specify a ‘template’
matrix. Scalar multiples of <code>varcov1</code> will be
considered and the optimal scale factor will be determined.
That is, <code>bw.ppl</code> will try 
smoothing the data using <code>varcov = h^2 * varcov1</code> for different
values of <code>h</code>.
The result of <code>bw.ppl</code> will be the optimal value of <code>h</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>References</h3>

<p>Loader, C. (1999)
<em>Local Regression and Likelihood</em>.
Springer, New York.
</p>


<h3>See Also</h3>

<p><code>density.ppp</code>,
<code>bw.diggle</code>,
<code>bw.scott</code>,
<code>bw.CvL</code>,
<code>bw.frac</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  if(interactive()) {
    b &lt;- bw.ppl(redwood)
    plot(b, main="Likelihood cross validation for redwoods")
    plot(density(redwood, b))
  }
  
</code></pre>


</div>