<div class="container">

<table style="width: 100%;"><tr>
<td>stratification-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Collection of Functions for Univariate Stratification of Survey Populations </h2>

<h3>Description</h3>

<p>This package contains various functions for univariate stratification of survey populations. The well known cumulative root frequency rule by Dalenius and Hodges (1959) and the geometric rule by Gunning and Horgan (2004) are implemented. However, the main function implements a generalized Lavallee-Hidiroglou (1988) method of strata construction. It can be used with Sethi's (1963) or Kozak's (2004) algorithm. The generalized method takes into account a discrepancy between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>. The method can consider a loglinear model with mortality between the variables (Baillargeon, Rivest and Ferland, 2007). When Kozak's algorithm is used, two additional models are available: a heteroscedastic linear model and a random replacement model as in Rivest (2002). The optimal boundaries determination also incorporates, if desired, an anticipated non-response, a take-all stratum for the large units and a take-none stratum for the small units. Moreover, units can be forced to be part of the sample by specifying a certainty stratum. 
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> stratification</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 2.2-7</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2022-04-06</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><b>OVERWIEW OF THE FUNCTIONS</b><br></p>
<p>To determine the stratum sample sizes given a set of stratum boundaries: <code>strata.bh</code> 
</p>
<p>To determine the stratum boundaries first and, in a second step, the stratum sample sizes:<br><code>strata.cumrootf</code>: cumulative root frequency method by Dalenius and Hodges (1959)<br><code>strata.geo</code>: geometric method by Gunning and Horgan (2004)
</p>
<p>To determine the optimal stratum boundaries and sample sizes in a single step:<br><code>strata.LH</code>: generalized Lavallee-Hidiroglou method with Sethi's (1963) or Kozak's (2004) algorithm<br></p>
<p>All these functions create an object of class "strata", which can be visualized with the S3 methods <code>print.strata</code> and <code>plot.strata</code>. One can also apply, with the function <code>var.strata</code>, a stratified design to a survey variable <code class="reqn">Y</code> different from the one used for the construction of the stratified design.<br></p>
<p><b>INFORMATION RELATIVE TO MANY FUNCTIONS</b><br></p>
<p>The functions <code>strata.bh</code>, <code>strata.cumrootf</code>, <code>strata.geo</code> and <code>strata.LH</code> need to be given:<br><code>x</code>, the values of the stratification variable <code class="reqn">X</code>,<br><code>Ls</code>, the desired number of sampled strata,<br><code>alloc</code>, an allocation rule, and<br>
a target sample size <code>n</code> or a target level of precision <code>CV</code> for the survey estimator.<br> 
However, for Sethi's (1963) algorithm, only a target <code>CV</code> can be given. To reach a target <code>n</code> using the generalized Lavallee-Hidiroglou method, Kozak's (2004) algorithm has to be used with the <code>strata.LH</code> function.<br></p>
<p>TYPE OF STRATUM<br>
In this package, four types of stratum exist: take-some, take-none, take-all and certainty. A take-some stratum is a stratum in which some units are sampled. A take-none stratum is a stratum for the smallest units in which no units are sampled. Its purpose is to ignore very small units. On the other hand, a take-all stratum is a stratum for the largest units in which every units are sampled. It allows to insure that the biggest units are in the sample. The following paragraph explains what the special stratum type called “certainty” is.<br></p>
<p>DEFINITION OF THE CERTAINTY STRATUM<br>
It is possible to insure that some specific units are included in the sample with the argument <code>certain</code>. This argument is a vector containing the positions in the vector <code>x</code> of the units to be included with certainty in the sample. We say that these units form the certainty stratum. They are excluded from the population prior to the determination of the stratum boundaries, but they are accounted for in the calculation of the anticipated mean, the RRMSE, the total sample size and the optimization criteria. Essentially, these units form their own separate take-all stratum that is not subject to stratification. They do not have to be consecutive units according to the stratification variable, therefore their variance is meaningless. Non-response is not possible in the certainty stratum. The functions return a value named <code>certain.info</code> containing the number of units in the certainty stratum and their anticipated mean.<br></p>
<p>NUMBER OF STRATA<br>
The <code>Ls</code> argument represents to the number of sampled strata. The term “sampled strata” refers to take-some and take-all strata only. Therefore, take-none and certain strata are not counted in <code>Ls</code>. If the stratified design does not have a take-none stratum then <code>Ls</code>=<code class="reqn">L</code> is the total number of strata, otherwise <code>Ls</code>=<code class="reqn">L-1</code>. In the total number of strata <code class="reqn">L</code>, the certainty stratum, if any, is not counted since we do not need to find its boundaries.<br></p>
<p>STRATUM NUMBERING<br>
Throughout the package, strata number 1 contains the smallest units and strata number <code class="reqn">L</code> the biggest ones. So every vector of boundaries contains numbers in ascending order. The function <code>strata.bh</code> must be given boundaries <code>bh</code> fulfilling this condition. This remark also applies to the argument <code>initbh</code> of <code>strata.LH</code> used to give initial boundaries for the optimization algorithm. If a take-none stratum is requested, it is always the first one. On the other hand, if a take-none stratum is requested, it is always the last one. <br></p>
<p>DEFINITION OF STRATUM BOUNDARIES<br>
Let's note <code class="reqn">b_0, b_1,\ldots, b_L</code> the stratum boundaries. Stratum <code class="reqn">h</code> contains all the
units with an <code class="reqn">X</code>-value in the interval <code class="reqn">[b_{h-1},b_h)</code> for <code class="reqn">h=1,\ldots,L</code> such that <code class="reqn">b_0=min(X)</code> and <code class="reqn">b_L=max(X)+1</code>, where
<code class="reqn">min(X)</code> and <code class="reqn">max(X)</code> are respectively the minimum and the maximum values of the stratification variable. The argument <code>bh</code> of <code>strata.bh</code>, the argument <code>initbh</code> of <code>strata.LH</code> and the output value <code>bh</code> of any function of the package <span class="pkg">stratification</span> with the prefix "strata" are length <code class="reqn">L-1</code> vectors of the boundaries <code class="reqn">b_1, b_2,\ldots, b_{L-1}</code>.<br></p>
<p>DETAILS ABOUT THE TAKE-NONE STRATUM<br>
A non empty take-none stratum induces a bias in the estimator of the mean of <code class="reqn">Y</code>, and the precision is measured by the relative root mean squared error (RRMSE), not by the coefficient of variation (CV). Regardless, in the functions the argument given to specify a target precision for the survey estimator is always named <code>CV</code>. However, in the output, the anticipated level of precision is named RRMSE for the functions accepting a <code>takenone</code> argument (<code>strata.bh</code> and <code>strata.LH</code>), and it is named CV for the other functions (<code>strata.cumrootf</code> and <code>strata.geo</code>).
</p>
<p>When a <code>takenone</code> stratum is requested, one can specify a <code>bias.penalty</code> argument. We define the mean squared error for the estimator of the mean of <code class="reqn">Y</code> by <code class="reqn">MSE = (bias.penalty \times bias)^2 + variance</code>. It is sometimes possible to estimate the bias using the sum of the <code class="reqn">Y</code> values in the take-none stratum from administrative data. In this situation, it might be appropriate to set <code>bias.penalty</code> to a value lower than 1. This will typically enlarge the take-none stratum. The value given to <code>bias.penalty</code> depends on the confidence level we have in the bias estimate. By default, it is assumed that no bias estimate is available and the whole bias contributes to the MSE (<code>bias.penalty</code>=1).<br></p>
<p>SPECIFICATION OF THE ALLOCATION RULE<br>
The <code>alloc</code> argument must be a list containing the numeric objects <code>q1</code>, <code>q2</code> and <code>q3</code> which specify the allocation rule according to the general allocation scheme presented in Hidiroglou and Srinath (1993) 
</p>
<p style="text-align: center;"><code class="reqn">a_h = \frac{\gamma_h}{\sum_{\mbox{take-some}} \gamma_h} \qquad \mbox{where} \qquad     
\gamma_h=N_h^{2q_1}\bar{Y}_h^{2q_2}S_{yh}^{2q_3}.</code>
</p>

<p>Stratum sample sizes are calculated as :
</p>
<p style="text-align: center;"><code class="reqn">
{n_h}_{\mbox{nonint}} = \left\{ \begin{array}{ll}
0 &amp; \mbox{for take-none strata}\\
n \times a_h &amp; \mbox{for take-some strata}\\
N_h &amp; \mbox{for take-all strata}\end{array} \right.
</code>
</p>

<p>A proportional allocation is obtained when <code>q1</code>=0.5 and <code>q2</code>=<code>q3</code>=0,<br>
a power allocation is obtained when <code>q1</code>=<code>q2</code>=<code class="reqn">p/2</code> and <code>q3</code>=0, and<br>
a Neyman allocation (the default) is obtained when <code>q1</code>=<code>q3</code>=0.5 and <code>q2</code>=0.<br></p>
<p>ROUNDING of the stratum sample sizes <br>
Applying the allocation rule above gives real (non-integer) values for the sample sizes. These are named <code>nhnonint</code> in the package. The <code>nhnonint</code> values have to be rounded to get the integer sample sizes, named <code>nh</code> in the package. Here is how the rounding is done. If a target <code>CV</code> is requested, the values are simply rounded to the largest integer. However, if a target <code>n</code> is requested, the rounding is a little more complicated because the <code>nh</code> should sum to the target <code>n</code> and we do not want positive nh inferior to 1 to be rounded to zero. Therefore, we first round to 1 the positive nh inferior to 1. Then we calculate how many values (say <code>nup</code>) must be rounded to the largest integer and how many must be rounded to the smallest integer in order to fulfill the condition <code>sum(nh)=n</code>. We choose the <code>nup</code> values with the largest decimal part for the ceiling rounding, the other <code>nh</code> are rounded down.<br></p>
<p>ADJUSTMENT FOR A TAKE-ALL STRATUM<br>
If, after applying the allocation rule, the stratified design contains at least one take-some stratum with <code class="reqn">{n_h}_{\mbox{nonint}} &gt; N_h</code>, the allocation is done again setting the take-some stratum with the largest units as a take-all stratum. This is done until <code class="reqn">{n_h}_{\mbox{nonint}} \leq N_h</code> for all the take-some strata or until there is only one take-some stratum left. This adjustment is done automatically throughout the package because the target n or CV might not be reached if one omits to do it. Only the function <code>strata.bh</code> allows not to do it (argument <code>takeall.adjust</code>).<br></p>
<p>Note: In special circumstances, the algorithm might result in more than one take-all stratum. If the non-response rate does not vary among the take-all strata, we can see them as forming one big take-all stratum. Otherwise, their boundaries influence the value of the optimization criteria (<code class="reqn">n</code> or <code class="reqn">CV</code>). So in the case of a varying non-response rate among the take-all strata, we cannot see them as forming one big take-all stratum.<br></p>
<p>SPECIFICATION OF A MODEL BETWEEN <code class="reqn">Y</code> AND <code class="reqn">X</code><br>
Every function can take into account a discrepancy between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>. The functions <code>strata.bh</code>, <code>strata.cumrootf</code> and <code>strata.geo</code> perform allocation on the basis of anticipated moments whereas the <code>strata.LH</code> function goes further; it determines the optimal boundaries considering the anticipated moments. The following models for the relationship between <code class="reqn">Y</code> and <code class="reqn">X</code> can be specified through the <code>model</code> and <code>model.control</code> arguments:<br></p>
<p><b>- loglinear model with mortality</b> (<code>model="loglinear"</code>):
</p>
<p style="text-align: center;"><code class="reqn">
 Y = \left\{ \begin{array}{ll}
\exp(\alpha + \mbox{\code{beta}} \ \log(X) + \mbox{\code{epsilon}}) &amp; \mbox{with probability } p_h\\
0 &amp; \mbox{with probability } 1-p_h \end{array} \right.
</code>
</p>

<p>where <code class="reqn">\mbox{\code{epsilon}} \sim N(0,\mbox{\code{sig2}})</code> is independent of <code class="reqn">X</code>. The parameter <code class="reqn">p_h</code>
is specified through <code>ph</code>, <code>ptakenone</code> and <code>pcertain</code> (elements of <code>model.control</code>). Note: The <code class="reqn">\alpha</code> parameter does not have to be specified because <code class="reqn">exp(\alpha)</code> is a multiplicative factor that has no impact on the outcome.<br></p>
<p><b>- heteroscedastic linear model</b> (<code>model="linear"</code>):
</p>
<p style="text-align: center;"><code class="reqn">
Y = \mbox{\code{beta}} X + \mbox{\code{epsilon}}
</code>
</p>

<p>where <code class="reqn">\mbox{\code{epsilon}} \sim N(0,\mbox{\code{sig2}} \ X^{\mbox{\code{gamma}}})</code>.<br></p>
<p><b>- random replacement model</b> (<code>model="random"</code>):
</p>
<p style="text-align: center;"><code class="reqn">
 Y = \left\{ \begin{array}{ll}
X &amp; \mbox{with probability } 1-\mbox{\code{epsilon}} \\
Xnew &amp; \mbox{with probability } \mbox{\code{epsilon}} \end{array} \right.
</code>
</p>

<p>where <code class="reqn">Xnew</code> is a random variable independent of <code class="reqn">X</code> having the same distribution than <code class="reqn">X</code>.<br></p>
<p>The <code>model.control</code> argument is a list that can supply any of the following model parameter:
</p>

<dl>
<dt><code>beta</code></dt>
<dd>
<p> A numeric: the slope of the "loglinear" or "linear" model. The default is 1. </p>
</dd>
<dt><code>sig2</code></dt>
<dd>
<p> A numeric: the variance parameter of the "loglinear" or "linear" model. The default is 0. </p>
</dd>
<dt><code>ph</code></dt>
<dd>
<p> A vector giving the survival rate in each of the <code>Ls</code> sampled strata for the "loglinear" model. A single number can be given if the rate doesn't vary among strata. The default is 1 in each stratum. </p>
</dd>
<dt><code>ptakenone</code></dt>
<dd>
<p> A numeric: the survival rate in the take-none stratum, if a take-none stratum is added to the stratified design. The default is 1. </p>
</dd>
<dt><code>pcertain</code></dt>
<dd>
<p> A numeric: the survival rate in the certainty stratum, if a certainty stratum is added to the stratified design. The default is 1. </p>
</dd>
<dt><code>gamma</code></dt>
<dd>
<p> A numeric: the exponent of <code class="reqn">X</code> in the residual variance of the "linear" model. The default is 0. </p>
</dd>
<dt><code>epsilon</code></dt>
<dd>
<p> A numeric: the probability that the <code class="reqn">Y</code>-value for a unit is equal to the <code class="reqn">X</code>-value for a randomly selected unit in the population. It concerns the "random" model only. The default is 0.<br></p>
</dd>
</dl>
<p>Note: The default values of the parameters simplify any model to <code class="reqn">Y=X</code>. Therefore, the default is always to consider that there is no discrepancy between the stratification and the survey variables. The <code>model</code> argument even has the default value <code>"none"</code>, which also means <code class="reqn">Y=X</code>.
</p>


<h3>Author(s)</h3>

<p> Sophie Baillargeon <a href="mailto:Sophie.Baillargeon@mat.ulaval.ca">Sophie.Baillargeon@mat.ulaval.ca</a> and<br>
Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> </p>


<h3>References</h3>

<p>Baillargeon, S., Rivest, L.-P., Ferland, M. (2007). Stratification en enquetes entreprises : Une revue et quelques avancees. <em>Proceedings of the Survey Methods Section, 2007 SSC Annual Meeting</em>.
</p>
<p>Baillargeon, S. and Rivest, L.-P. (2009). A general algorithm for univariate stratification. <em>International Stratification Review</em>, <b>77</b>(3), 331-344.
</p>
<p>Baillargeon, S. and  Rivest L.-P. (2011). The construction of stratified designs in R with the package stratification. <em>Survey Methodology</em>, <b>37</b>(1), 53-65.
</p>
<p>Dalenius, T. and Hodges, J.L., Jr. (1959). Minimum variance stratification. <em>Journal of the American Statistical Association</em>, <b>54</b>, 88-101.
</p>
<p>Gunning, P. and Horgan, J.M. (2004). A new algorithm for the construction of stratum boundaries in skewed populations. <em>Survey Methodology</em>, <b>30</b>(2), 159-166.
</p>
<p>Hidiroglou, M.A. and Srinath, K.P. (1993). Problems associated with designing subannual business surveys. <em>Journal of Business &amp; Economic Statistics</em>, <b>11</b>, 397-405.
</p>
<p>Kozak, M. (2004). Optimal stratification using random search method in agricultural surveys. <em>Statistics in Transition</em>, <b>6</b>(5), 797-806.
</p>
<p>Lavallee, P. and Hidiroglou, M.A. (1988). On the stratification of skewed populations. <em>Survey Methodology</em>, <b>14</b>, 33-43.
</p>
<p>Rivest, L.-P. (2002). A generalization of the Lavallee and Hidiroglou algorithm for stratification in business surveys. <em>Survey Methodology</em>, <b>28</b>(2), 191-198.
</p>
<p>Sethi, V. K. (1963). A note on optimum stratification of populations for estimating the population means. <em>The Australian Journal of Statistics</em>, <b>5</b>, 20-33.
</p>


</div>