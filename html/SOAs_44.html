<div class="container">

<table style="width: 100%;"><tr>
<td>OSOAs_LiuLiu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to create OSOAs of strengths 2, 3, or 4 from an OA</h2>

<h3>Description</h3>

<p>Creates OSOAs from an OA according to the construction by Liu and Liu (2015).
Strengths 2 to 4 are covered. Strengths 3 and 4 guarantee 3-orthogonality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OSOAs_LiuLiu(
  oa,
  t = NULL,
  m = NULL,
  noptim.rounds = 1,
  noptim.repeats = 1,
  optimize = TRUE,
  dmethod = "manhattan",
  p = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>oa</code></td>
<td>
<p>matrix or data.frame; a symmetric orthogonal array of strength at least <code>t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the requested strength of the OSOA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the requested number of columns of the OSOA (at most <code>mbound_LiuLiu(ncol(oa), t)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noptim.rounds</code></td>
<td>
<p>the number of optimization rounds for each independent restart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noptim.repeats</code></td>
<td>
<p>the number of independent restarts of optimizations with <code>noptim.rounds</code> rounds each</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>
<p>logical: should space filling be optimized by level permutations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmethod</code></td>
<td>
<p>distance method for <code>phi_p</code>, "manhattan" (default) or "euclidean"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>p for <code>phi_p</code> (the larger, the closer to maximin distance)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The number of columns goes down dramatically with the requested strength.
However, the strength 3 or 4 arrays may be worthwhile,
because they guarantee 3-orthogonality, which implies that (quantitative)
linear models with main effects and second order effects can be robustly estimated.
</p>
<p>Optimization is less successful for this construction of OSOAs; for small
arrays, the level permutations make (almost) no difference.
</p>
<p>Function <code>mbound_LiuLiu(moa, t)</code> calculates the number of columns that can be
obtained from a strength <code>t</code> OA with <code>moa</code> columns (if such an array
exists, the function does not check that).
</p>
<p>Ingoing arrays can be obtained
from oa-generating functions of R package <span class="pkg">lhs</span> like <code>createBoseBush</code>, or from OAs in
R package <span class="pkg">DoE.base</span>, or from 2-level designs created with R package <span class="pkg">FrF2</span> (see example section).
</p>


<h3>Value</h3>

<p>matrix of class <code>SOA</code> with the attributes that are listed below. All attributes can be accessed using function <code>attributes</code>, or individual attributes can be accessed using function <code>attr</code>. These are the attributes:
</p>

<dl>
<dt>type</dt>
<dd>
<p>the type of array (<code>SOA</code> or <code>OSOA</code>)</p>
</dd>
<dt>strength</dt>
<dd>
<p>character string that gives the strength</p>
</dd>
<dt>phi_p</dt>
<dd>
<p>the phi_p value (smaller=better)</p>
</dd>
<dt>optimized</dt>
<dd>
<p>logical indicating whether optimization was applied</p>
</dd>
<dt>permpick</dt>
<dd>
<p>matrix that lists the id numbers of the permutations used</p>
</dd>
<dt>perms2pickfrom</dt>
<dd>
<p>optional element, when optimization was conducted: the
overall permutation list to which the numbers in permlist refer</p>
</dd>
<dt>call</dt>
<dd>
<p>the call that created the object</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ulrike Groemping
</p>


<h3>References</h3>

<p>For full detail, see <code>SOAs-package</code>.
</p>
<p>Liu and Liu (2015)<br>
Weng (2014)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## strength 2, very small (four 9-level columns in 9 runs)
OSOA9 &lt;- OSOAs_LiuLiu(DoE.base::L9.3.4)

## strength 3, from a Plackett-Burman design of FrF2
## 10 8-level columns in 40 runs with OSOA strength 3
oa &lt;- suppressWarnings(FrF2::pb(40)[,c(1:19,39)])
### columns 1 to 19 and 39 together are the largest possible strength 3 set
OSOA40 &lt;- OSOAs_LiuLiu(oa, optimize=FALSE)  ## strength 3, 8 levels
### optimize would improve phi_p, but suppressed for saving run time

## 9 8-level columns in 40 runs with OSOA strength 3
oa &lt;- FrF2::pb(40,19)
### 9 columns would be obtained without the final column in oa
mbound_LiuLiu(19, t=3)     ## example for which q=3
mbound_LiuLiu(19, t=4)     ## t=3 has one more column than t=4
OSOA40_2 &lt;- OSOAs_LiuLiu(oa, optimize=FALSE)  ## strength 3, 8 levels
### optimize would improve phi_p, but suppressed for saving run time

## starting from a strength 4 OA
oa &lt;- FrF2::FrF2(64,8)
## four 16 level columns in 64 runs with OSOA strength 4
OSOA64 &lt;- OSOAs_LiuLiu(oa, optimize=FALSE)  ## strength 4, 16 levels

### reducing the strength to 3 does not increase the number of columns
mbound_LiuLiu(8, t=3)
### reducing the strength to 2 doubles the number of columns
mbound_LiuLiu(8, t=2)
## eight 4-level columns in 64 runs with OSOA strength 2
OSOA64_2 &lt;- OSOAs_LiuLiu(oa, t=2, optimize=FALSE)
## fulfills the 2D strength 2 property
soacheck2D(OSOA64_2, s=2, el=2, t=2)
### fulfills also the 3D strength 3 property
soacheck3D(OSOA64_2, s=2, el=2, t=3)
### fulfills also the 4D strength 4 property
DoE.base::GWLP(OSOA64/2)
### but not the 3D strength 4 property
soacheck3D(OSOA64_2, s=2, el=2, t=4)
### and not the 2D 4x2 and 2x4 stratification balance
soacheck2D(OSOA64_2, s=2, el=2, t=3)
## six 36-level columns in 72 runs with OSOA strength 2
oa &lt;- DoE.base::L72.2.5.3.3.4.1.6.7[,10:16]
OSOA72 &lt;- OSOAs_LiuLiu(oa, t=2, optimize=FALSE)
</code></pre>


</div>