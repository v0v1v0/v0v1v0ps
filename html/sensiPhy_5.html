<div class="container">

<table style="width: 100%;"><tr>
<td>clade_discrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Influential Clade Detection - Trait Evolution Discrete Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of discrete (binary) characters, 
detecting influential clades
</p>


<h3>Usage</h3>

<pre><code class="language-R">clade_discrete(
  data,
  phy,
  model,
  transform = "none",
  trait.col,
  clade.col,
  n.species = 5,
  n.sim = 20,
  bounds = list(),
  n.cores = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The Mkn model to use (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>The evolutionary model to transform the tree (see Details). Default is <code>none</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.col</code></td>
<td>
<p>The column in the provided data frame which specifies the
trait to analyse (which should be a factor with two level)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clade.col</code></td>
<td>
<p>The column in the provided data frame which specifies the
clades (a character vector with clade names).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.species</code></td>
<td>
<p>Minimum number of species in a clade for the clade to be
included in the leave-one-out deletion analysis. Default is <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>Number of simulations for the randomization test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitDiscrete</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitDiscrete</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function sequentially removes one clade at a time,
fits a model of discrete character evolution using <code>fitDiscrete</code>, 
repeats this this many times (controlled by <code>n.sim</code>), stores the results and calculates 
the effects on model parameters. Currently, only binary discrete traits are supported. 
</p>
<p>Additionally, to account for the influence of the number of species on each 
clade (clade sample size), this function also estimates a null distribution
expected for the number of species in a given clade. This is done by fitting
models without the same number of species as in the given clade.The number of 
simulations to be performed is set by 'n.sim'. To test if the 
clade influence differs from the null expectation for a clade of that size, 
a randomization test can be performed using 'summary(x)'. 
</p>
<p>Different character model from <code>fitDiscrete</code> can be used, including <code>ER</code> (equal-rates), 
<code>SYM</code> (symmetric), <code>ARD</code> (all-rates-different) and <code>meristic</code> (stepwise fashion). 
</p>
<p>All transformations to the phylogenetic tree from <code>fitDiscrete</code> can be used, i.e. <code>none</code>,
<code>EB</code>, <code>lambda</code>, <code>kappa</code> and<code>delta</code>.
</p>
<p>See <code>fitDiscrete</code> for more details on character models and tree transformations. 
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>tree_discrete</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>data</code>: The original full data frame.
</p>
<p><code>full.model.estimates</code>: Parameter estimates (transition rates q12 and q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for the full model without deleted clades.
</p>
<p><code>sensi.estimates</code>: Parameter estimates (transition rates q12 and q21),(percentual) difference 
in parameter estimate compared to the full model (DIFq12, sigsq.q12, DIFq21, optpar.q21), 
AICc and the optimised value of the phylogenetic transformation parameter (e.g. <code>lambda</code>) 
for each repeat with a clade removed.
</p>
<p><code>null.dist</code>: A data frame with estimates for the null distributions
for all clades analysed.
</p>
<p><code>errors</code>: Clades where deletion resulted in errors.
</p>
<p><code>clade.col</code>: Which column was used to specify the clades?
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Gustavo Paterno
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>


<h3>See Also</h3>

<p><code>fitDiscrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Load data:
data("primates")
#Create a binary trait factor 
primates$data$adultMass_binary&lt;-ifelse(primates$data$adultMass &gt; 7350, "big", "small")
clade_disc&lt;-clade_discrete(data=primates$data,phy = primates$phy[[1]],model="SYM",
trait.col = "adultMass_binary",clade.col="family",n.sim=30,n.species=10,n.cores = 2)
summary(clade_disc)
sensi_plot(clade_disc)
sensi_plot(clade_disc, clade = "Cebidae", graph = "q12")
#Change the evolutionary model, tree transformation or minimum number of species per clade
clade_disc_2&lt;-clade_discrete(data=primates$data,phy = primates$phy[[1]],
model="ARD",transform="kappa",
trait.col = "adultMass_binary",clade.col="family",n.sim=30,
n.species=8,n.cores = 2)
summary(clade_disc_2)
sensi_plot(clade_disc_2)
sensi_plot(clade_disc_2, graph = "q12")
sensi_plot(clade_disc_2, graph = "q21")

## End(Not run)
</code></pre>


</div>