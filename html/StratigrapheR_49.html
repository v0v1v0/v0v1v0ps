<div class="container">

<table style="width: 100%;"><tr>
<td>in.lim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finds the intervals encompassing values</h2>

<h3>Description</h3>

<p>This function returns the intervals encompassing x values. This
works only if the intervals (as lim objects) are non overlapping and
non-adjacent (if certain boundaries are neighbouring, the boundary rule
should exclude all, or all but one)
</p>


<h3>Usage</h3>

<pre><code class="language-R">in.lim(x, lim = NULL, l = NULL, r = NULL, id = 1L, b = "][", index = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>an object convertible into a lim object: either a vector
of length 2 or a list of n left (1st element) and n right (2ndt element)
interval limits. The intervals should be non-overlapping and non-adjacent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>a vector of n left interval limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a vector of n right interval limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector of n interval IDs (default is 1 for each interval)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a character vector for the interval boundaries rules: "[]"
(or "closed") to include both boundaries points, "][" (or "()" and "open") to
exclude both boundary points, "[[" (or "[)","right-open" and"left-closed") to
include only the left boundary point, and "]]" (or "(]", "left-open",
"right-closed") to include only the right boundary point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>whether the output should be a list of the initial vector
and of the corresponding intervals in which they lay (index = FALSE, is the
default), or simply the index of the intervals in the initial lim object
(index = TRUE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of the intervals where the x values lay or a vector of their
index
</p>


<h3>See Also</h3>

<p><code>as.lim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x   &lt;- c(99,1,3,5,2,4,5,6,9,4,8,20,26,52,42,24,25,12,40,10,16,17)

lim &lt;- as.lim(l = c(100,10,20,27), r = c(99,12,27,42), b = "]]")

in.lim(x, lim = lim)

in.lim(x, lim = lim, index = TRUE)

# Applications to Stratigraphy

proxy &lt;- proxy.example # This is a data.frame with (fake) magnetic
                       # susceptibility (ms) and depth (dt)

# Each sample was taken in a specific bed (not at the boundary between two,
# to make things easier). We will invoke the data of the beds (bed.example)
# and identify the lithology of each sample

res &lt;- in.lim(proxy.example$dt,  # Position of each sample
              l = bed.example$l, # Left boundary of the beds
              r = bed.example$r, # Right boundary of the beds
              id = bed.example$litho) # Lithology of each bed (if you wanted
                                      # to know the name of the bed each
                                      # sample is in you would have put
                                      # bed.example$id)

proxy$litho &lt;- res$id # The result provides the id (here the lithology) of
                      # each interval encompassing the measurement (x, here
                      # proxy.example$dt)

plot(proxy$ms, proxy$dt, type = "l", xlim = c(-2*10^-8, 8*10^-8))

shale &lt;- subset(proxy, proxy$litho == "S")
points(shale$ms, shale$dt, pch = 4)

limestone &lt;- subset(proxy, proxy$litho == "L")
points(limestone$ms, limestone$dt, pch = 19)

chert &lt;- subset(proxy, proxy$litho == "C")
points(chert$ms, chert$dt, pch = 21, bg = "white")

legend(6.2*10^-8, 25, legend = c("Shale", "Limestone", "Chert"),
       pch = c(4,19,21), bg = c(NA, NA, "white"))

</code></pre>


</div>