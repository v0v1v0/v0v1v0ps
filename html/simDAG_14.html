<div class="container">

<table style="width: 100%;"><tr>
<td>node_binomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a Node Using Logistic Regression
</h2>

<h3>Description</h3>

<p>Data from the parents is used to generate the node using logistic regression by predicting the covariate specific probability of 1 and sampling from a Bernoulli distribution accordingly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">node_binomial(data, parents, formula=NULL, betas, intercept,
              return_prob=FALSE, output="logical", labels=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A <code>data.table</code> (or something that can be coerced to a <code>data.table</code>) containing all columns specified by <code>parents</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>

<p>A character vector specifying the names of the parents that this particular child node has. If non-linear combinations or interaction effects should be included, the user may specify the <code>formula</code> argument instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An optional <code>formula</code> object to describe how the node should be generated or <code>NULL</code> (default). If supplied it should start with <code>~</code>, having nothing else on the left hand side. The right hand side may contain any valid formula syntax, such as <code>A + B</code> or <code>A + B + I(A^2)</code>, allowing non-linear effects. If this argument is defined, there is no need to define the <code>parents</code> argument. For example, using <code>parents=c("A", "B")</code> is equal to using <code>formula= ~ A + B</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>

<p>A numeric vector with length equal to <code>parents</code>, specifying the causal beta coefficients used to generate the node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>A single number specifying the intercept that should be used when generating the node.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_prob</code></td>
<td>

<p>Either <code>TRUE</code> or <code>FALSE</code> (default). If <code>TRUE</code>, the calculated probability is returned instead of the results of bernoulli trials.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>A single character string, must be either <code>"logical"</code> (default), <code>"numeric"</code>, <code>"character"</code> or <code>"factor"</code>. If <code>output="character"</code> or <code>output="factor"</code>, the labels (or levels in case of a factor) can be set using the <code>labels</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>A character vector of length 2 or <code>NULL</code> (default). If <code>NULL</code>, the resulting vector is returned as is. If a character vector is supplied and <code>output="character"</code> or <code>output="factor"</code> is used, all <code>TRUE</code> values are replaced by the first entry of this vector and all <code>FALSE</code> values are replaced by the second argument of this vector. The output will then be a character variable or factor variable, depending on the <code>output</code> argument. This argument is ignored if <code>output</code> is set to <code>"numeric"</code> or <code>"logical"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the normal form a logistic regression model, the observation specific event probability is generated for every observation in the dataset. Using the <code>rbernoulli</code> function, this probability is then used to take one bernoulli sample for each observation in the dataset. If only the probability should be returned <code>return_prob</code> should be set to <code>TRUE</code>.
</p>
<p><strong><em>Formal Description</em></strong>:
</p>
<p>Formally, the data generation can be described as:
</p>
<p style="text-align: center;"><code class="reqn">Y \sim Bernoulli(logit(\texttt{intercept} + \texttt{parents}_1 \cdot \texttt{betas}_1 + ... + \texttt{parents}_n \cdot \texttt{betas}_n)),</code>
</p>

<p>where <code class="reqn">Bernoulli(p)</code> denotes one Bernoulli trial with success probability <code class="reqn">p</code>, <code class="reqn">n</code> is the number of parents (<code>length(parents)</code>) and the <code class="reqn">logit(x)</code> function is defined as:
</p>
<p style="text-align: center;"><code class="reqn">logit(x) = ln(\frac{x}{1-x}).</code>
</p>

<p>For example, given <code>intercept=-15</code>, <code>parents=c("A", "B")</code> and <code>betas=c(0.2, 1.3)</code> the data generation process is defined as:
</p>
<p style="text-align: center;"><code class="reqn">Y \sim Bernoulli(logit(-15 + A \cdot 0.2 + B \cdot 1.3)).</code>
</p>

<p><strong><em>Output Format</em></strong>:
</p>
<p>By default this function returns a logical vector containing only <code>TRUE</code> and <code>FALSE</code> entries, where <code>TRUE</code> corresponds to an event and <code>FALSE</code> to no event. This may be changed by using the <code>output</code> and <code>labels</code> arguments. The last three arguments of this function are ignored if <code>return_prob</code> is set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>Returns a logical vector (or numeric vector if <code>return_prob=TRUE</code>) of length <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Robin Denz
</p>


<h3>See Also</h3>

<p><code>empty_dag</code>, <code>node</code>, <code>node_td</code>, <code>sim_from_dag</code>, <code>sim_discrete_time</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(simDAG)

set.seed(5425)

# define needed DAG
dag &lt;- empty_dag() +
  node("age", type="rnorm", mean=50, sd=4) +
  node("sex", type="rbernoulli", p=0.5) +
  node("smoking", type="binomial", parents=c("age", "sex"),
       betas=c(1.1, 0.4), intercept=-2)

# define the same DAG, but using a pretty formula
dag &lt;- empty_dag() +
  node("age", type="rnorm", mean=50, sd=4) +
  node("sex", type="rbernoulli", p=0.5) +
  node("smoking", type="binomial",
       formula= ~ -2 + age*1.1 + sexTRUE*0.4)

# simulate data from it
sim_dat &lt;- sim_from_dag(dag=dag, n_sim=100)

# returning only the estimated probability instead
dag &lt;- empty_dag() +
  node("age", type="rnorm", mean=50, sd=4) +
  node("sex", type="rbernoulli", p=0.5) +
  node("smoking", type="binomial", parents=c("age", "sex"),
       betas=c(1.1, 0.4), intercept=-2, return_prob=TRUE)

sim_dat &lt;- sim_from_dag(dag=dag, n_sim=100)
</code></pre>


</div>