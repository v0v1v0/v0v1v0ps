<div class="container">

<table style="width: 100%;"><tr>
<td>ssize.Fvary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size Calculations for Multi-Sample Microarray Experiments
with Differing Variances among Genes</h2>

<h3>Description</h3>

<p>Calculates appropriate sample sizes for multi-sample
microarray experiments in which standard deviations vary among genes.
Sample sizes are determined based on a desired power, a  controlled
false discovery rate, and user-specified proportions of
non-differentially expressed genes and design matrix. A graph of
power versus sample size is created.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssize.Fvary(X, beta, L = NULL, dn, a, b, fdr = 0.05, power = 0.8, pi0 = 0.95, maxN = 20,
  cex.title=1.15, cex.legend=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix of experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>coefficient matrix or vector for linear contrasts of
interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dn</code></td>
<td>
<p>a function of the degrees of freedom based on the design
of the experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>shape parameter of inverse gamma distribution followed by
variances of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>scale parameter of inverse gamma distribution followed by
variances of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>the false discovery rate to be controlled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the desired power to be achieved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>a vector (or scalar) of proportions of non-differentially
expressed genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxN</code></td>
<td>
<p>the maximum sample size used for power calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.title</code></td>
<td>
<p>controls size of chart titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>controls size of chart legend</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variances among genes are assumed to follow an Inverse Gamma
distribution with shape parameter <code>a</code> and scale parameter
<code>b</code>.
</p>
<p>If a vector is input for <code>pi0</code>, sample size calculations
are performed for each proportion.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ssize</code></td>
<td>
<p>sample sizes (for each treatment) at which desired power
is first reached</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power calculations with corresponding sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.vals</code></td>
<td>
<p>critical value calculations with corresponding sample
sizes</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Numerical integration used in calculations performed by the function
<code>integrate</code>, which uses adaptive quadrature of functions.
</p>
<p>Powers calculated to be 0 may be negligibly conservative.
</p>
<p>Critical values calculated as ‘NA’ are values &gt;100.
</p>


<h3>Author(s)</h3>

<p>Megan Orr <a href="mailto:megan.orr@ndsu.edu">megan.orr@ndsu.edu</a>, Peng Liu <a href="mailto:pliu@iastate.edu">pliu@iastate.edu</a></p>


<h3>References</h3>

<p> Liu, Peng and J. T. Gene Hwang. 2007. Quick calculation for
sample size while controlling false discovery rate with application
to microarray analysis. <em>Bioinformatics</em> 23(6): 739-746. </p>


<h3>See Also</h3>

<p><code>ssize.twoSamp</code>, <code>ssize.twoSampVary</code>,
<code>ssize.oneSamp</code>, <code>ssize.oneSampVary</code>,
<code>ssize.F</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> ##Sample size calculation for three-treatment loop design microarray experiment
 des&lt;-matrix(c(1,-1,0,0,1,-1),ncol=2,byrow=FALSE)	##design matrix of loop design experiment
 b&lt;-c(1,-0.5)			##difference between first two treatments is 1 and
  #second and third treatments is -0.5
 df&lt;-function(n){3*n-2}		##degrees of freedom for this design is 3n-2
 alph&lt;-3;beta&lt;-1	##variances among genes follow an Inverse Gamma(3,1)
 a1&lt;-0.05	##fdr to be fixed
 pwr&lt;-0.8	##desired power
 p0&lt;-c(0.9,0.95,0.995)		##proportions of non-differentially expressed genes
 N1&lt;-35		##maximum sample size to be used in calculations

 ftv&lt;-ssize.Fvary(X=des,beta=b,dn=df,a=alph,b=beta,fdr=a1,power=pwr,pi0=p0,maxN=N1)
 ftv$ssize	##first sample sizes to reach desired power
 ftv$power	##calculated power for each sample size
 ftv$crit.vals	##calculated critical value for each sample sizeft$ssize

</code></pre>


</div>