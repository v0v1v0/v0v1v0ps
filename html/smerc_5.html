<div class="container">

<table style="width: 100%;"><tr>
<td>bn.zones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine case windows (circles)</h2>

<h3>Description</h3>

<p><code>bn.zones</code> determines the case windows (circles) for
the Besag-Newell method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bn.zones(d, cases, cstar)

casewin(d, cases, cstar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>An <code class="reqn">n\times n</code> square distance matrix
containing the intercentroid distance between the
<code class="reqn">n</code> region centroids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> containing the
observed number of cases for the <code class="reqn">n</code> region
centroids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstar</code></td>
<td>
<p>A non-negative integer indicating the
minimum number of cases to include in each window.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the distances provided in <code>d</code>, for each
observation, the nearest neighbors are included in
increasingly larger windows until at least <code>cstar</code>
cases are included in the window.  Each row of <code>d</code>
is matched with the same position in <code>cases</code>.
</p>


<h3>Value</h3>

<p>Returns the indices of the regions in each case
window as a list.  For each element of the list, the
indices are ordered from nearest to farthest from each
centroid (and include the starting region).
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Besag, J. and Newell, J.  (1991). The
detection of clusters in rare diseases, Journal of the
Royal Statistical Society, Series A, 154, 327-333.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
coords &lt;- as.matrix(nydf[, c("longitude", "latitude")])
d &lt;- gedist(coords, longlat = FALSE)
cwins &lt;- bn.zones(d, cases = nydf$cases, cstar = 6)
</code></pre>


</div>