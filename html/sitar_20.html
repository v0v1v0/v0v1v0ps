<div class="container">

<table style="width: 100%;"><tr>
<td>getPeakTrough</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify peak or trough on curve</h2>

<h3>Description</h3>

<p>Given vectors <code>x</code> and <code>y</code>, returns their values at the peak or
trough of the smooth (e.g. cubic spline) curve <code>y ~ x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getPeakTrough(x, y = NULL, peak = TRUE, takeoff = FALSE)

getPeak(x, y = NULL, peak = TRUE, takeoff = FALSE)

getTrough(x, y = NULL, peak = FALSE, takeoff = FALSE)

getTakeoff(x, y = NULL, peak = FALSE, takeoff = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak</code></td>
<td>
<p>logical determining whether peak or trough is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>takeoff</code></td>
<td>
<p>logical determining whether, if <code>peak</code> is FALSE, the
trough is takeoff.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Optionally the trough can be specified as takeoff, which is defined
for a growth velocity curve as the lowest velocity before the pubertal peak,
and if there is no peak then there is by definition no takeoff.
</p>


<h3>Value</h3>

<p>A length-2 vector containing the values of <code>x</code> and <code>y</code> at
the peak or trough. If none are identified NA's are returned.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## create mean height velocity curve
data(heights)
m1 &lt;- sitar(age, height, id, heights, 4)
## plot velocity curve
plot(m1, 'v')
## mark peak, trough and takeoff
xy &lt;- plot_v(m1)
points(t(getPeak(xy)), pch=17)
points(t(getTrough(xy)), pch=25, col=2, bg=2)
points(t(getTakeoff(xy)), pch=25, col=3, bg=3)
</code></pre>


</div>