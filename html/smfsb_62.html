<div class="container">

<table style="width: 100%;"><tr>
<td>StepSDE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a function for advancing the state of an SDE model by using a simple Euler-Maruyama integration method</h2>

<h3>Description</h3>

<p>This function creates a function for advancing the state of an SDE model using a simple Euler-Maruyama integration method. The resulting function (closure) can be used in conjunction with other functions (such as <code>simTs</code>) for simulating realisations of SDE models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">StepSDE(drift,diffusion,dt=0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>drift</code></td>
<td>
<p>A function representing the drift vector of the SDE model
(corresponding roughly to the RHS of an ODE model). <code>drift</code>
should have prototype <code>drift(x,t,...)</code>, with
<code>x</code> representing current system state and
<code>t</code> representing current system time.
The value of the function should be a vector of the same dimension as <code>x</code>, representing the infinitesimal mean of the Ito SDE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffusion</code></td>
<td>
<p>A function representing the diffusion matrix of the SDE model (the square root of the infinitesimal variance matrix). <code>diffusion</code> should have prototype <code>diffusion(x,t,...)</code>, with <code>x</code> representing current system state and <code>t</code> representing current system time. The value of the function should be a square matrix with both dimensions the same as the length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Time step to be used by the simple Euler-Maruyama integration method. Defaults to 0.01.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An R function which can be used to advance the state of the SDE model with given drift vector and diffusion matrix, by using an Euler-Maruyama method with step size <code>dt</code>. The function closure has interface <code>function(x0,t0,deltat,...)</code>, where <code>x0</code> and <code>t0</code> represent the initial state and time, and <code>deltat</code> represents the amount of time by which the process should be advanced. The function closure returns a vector representing the simulated state of the system at the new time.</p>


<h3>See Also</h3>

<p><code>StepEuler</code>, <code>StepCLE</code>, <code>simTs</code>, <code>simSample</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Immigration-death diffusion approx with death rate a CIR process
myDrift &lt;- function(x,t,th=c(lambda=1,alpha=1,mu=0.1,sigma=0.1))
     {
             with(as.list(c(x,th)),{
                     c( lambda - x*y ,
                           alpha*(mu-y) )
             })
     }
myDiffusion &lt;- function(x,t,th=c(lambda=1,alpha=1,mu=0.1,sigma=0.1))
     {
             with(as.list(c(x,th)),{
                     matrix(c( sqrt(lambda + x*y) , 0,
                           0, sigma*sqrt(y) ),ncol=2,nrow=2,byrow=TRUE)
             })
     }
# create a stepping function
stepProc = StepSDE(myDrift,myDiffusion)
# integrate the process and plot it
out = simTs(c(x=5,y=0.1),0,20,0.1,stepProc)
plot(out)
</code></pre>


</div>