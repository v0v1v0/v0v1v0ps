<div class="container">

<table style="width: 100%;"><tr>
<td>waicOcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Widely Applicable Information Criterion for spOccupancy Model Objects</h2>

<h3>Description</h3>

<p>Function for computing the Widely Applicable Information Criterion 
(WAIC; Watanabe 2010) for <code>spOccupancy</code> model objects. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">waicOcc(object, by.sp = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>PGOcc</code>, <code>spPGOcc</code>, <code>msPGOcc</code>, 
<code>spMsPGOcc</code>, <code>intPGOcc</code>, <code>spIntPGOcc</code>, <code>lfJSDM</code>, 
<code>sfJSDM</code>, <code>lfMsPGOcc</code>, <code>sfMsPGOcc</code>, <code>tPGOcc</code>, <code>stPGOcc</code>, 
<code>svcPGBinom</code>, <code>svcPGOcc</code>, <code>svcTPGBinom</code>, <code>svcTPGOcc</code>, or 
<code>intMsPGOcc</code>, <code>svcMsPGOcc</code>, <code>tMsPGOcc</code>, <code>stMsPGOcc</code>, 
<code>svcTMsPGOcc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.sp</code></td>
<td>
<p>a logical value indicating whether to return a separate WAIC
value for each species in a multi-species occupancy model or 
a single value for all species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently no additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The effective number of parameters is calculated following the recommendations
of Gelman et al. (2014). Note that when fitting multi-species occupancy models with the 
<code>range.ind</code> tag, it is not valid to use WAIC to compare a model that 
uses <code>range.ind</code> (i.e., restricts certain species to a subset of the locations)
with a model that does not use <code>range.ind</code> (i.e., assumes all species can occur at
all locations in the data set) or that uses different <code>range.ind</code> values.
</p>


<h3>Value</h3>

<p>When <code>object</code> is of class <code>PGOcc</code>, <code>spPGOcc</code>, <code>msPGOcc</code>, <code>spMsPGOcc</code>, <code>lfJSDM</code>, <code>sfJSDM</code>, <code>lfMsPGOcc</code>, <code>sfMsPGOcc</code>, <code>tPGOcc</code>, <code>stPGOcc</code>, <code>svcPGBinom</code>, <code>svcPGOcc</code>, <code>svcTPGOcc</code>, <code>svcTPGBinom</code>, <code>svcMsPGOcc</code>, <code>tMsPGOcc</code>, <code>stMsPGOcc</code>, <code>svcTMsPGOcc</code> 
returns a vector with three elements corresponding to 
estimates of the expected log pointwise predictive density (elpd), the 
effective number of parameters (pD), and the WAIC. When <code>by.sp = TRUE</code> for multi-species models, object is a data frame with each row corresponding to a different species. When <code>object</code> is 
of class <code>intPGOcc</code> or <code>spIntPGOcc</code>, returns a data frame with 
columns elpd, pD, and WAIC, with each row corresponding to the estimated 
values for each data source in the integrated model.
</p>


<h3>Author(s)</h3>

<p>Jeffrey W. Doser <a href="mailto:doserjef@msu.edu">doserjef@msu.edu</a>, <br>
Andrew O. Finley <a href="mailto:finleya@msu.edu">finleya@msu.edu</a>
</p>


<h3>References</h3>

<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross
validation and widely applicable information criterion in 
singular learning theory. <em>Journal of Machine Learning Research</em>, 
11:3571-3594.
</p>
<p>Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, 
and D. B. Rubin. (2013). Bayesian Data Analysis. 3rd edition. 
CRC Press, Taylor and Francis Group
</p>
<p>Gelman, A., J. Hwang, and A. Vehtari (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>, 
24:997-1016.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(400)
# Simulate Data -----------------------------------------------------------
J.x &lt;- 8
J.y &lt;- 8
J &lt;- J.x * J.y
n.rep &lt;- sample(2:4, J, replace = TRUE)
beta &lt;- c(0.5, -0.15)
p.occ &lt;- length(beta)
alpha &lt;- c(0.7, 0.4)
p.det &lt;- length(alpha)
dat &lt;- simOcc(J.x = J.x, J.y = J.y, n.rep = n.rep, beta = beta, alpha = alpha,
              sp = FALSE)
occ.covs &lt;- dat$X[, 2, drop = FALSE]
colnames(occ.covs) &lt;- c('occ.cov')
det.covs &lt;- list(det.cov = dat$X.p[, , 2])
# Data bundle
data.list &lt;- list(y = dat$y,
                  occ.covs = occ.covs,
                  det.covs = det.covs)

# Priors
prior.list &lt;- list(beta.normal = list(mean = rep(0, p.occ),
                                      var = rep(2.72, p.occ)),
                   alpha.normal = list(mean = rep(0, p.det),
                                       var = rep(2.72, p.det)))
# Initial values
inits.list &lt;- list(alpha = rep(0, p.det),
                   beta = rep(0, p.occ),
                   z = apply(data.list$y, 1, max, na.rm = TRUE))

n.samples &lt;- 5000
n.report &lt;- 1000

out &lt;- PGOcc(occ.formula = ~ occ.cov,
             det.formula = ~ det.cov,
             data = data.list,
             inits = inits.list,
             n.samples = n.samples,
             priors = prior.list,
             n.omp.threads = 1,
             verbose = TRUE,
             n.report = n.report, 
             n.burn = 4000, 
             n.thin = 1)

# Calculate WAIC
waicOcc(out)
</code></pre>


</div>