<div class="container">

<table style="width: 100%;"><tr>
<td>PlotVsLTime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a score along the forecast time with its confidence interval</h2>

<h3>Description</h3>

<p>Plot the correlation (<code>Corr()</code>), the root mean square error 
(<code>RMS()</code>) between the forecast values and their observational 
counterpart, the slope of their trend (<code>Trend()</code>), the 
InterQuartile range, maximum-mininum, standard deviation or median absolute 
Deviation of the ensemble members (<code>Spread()</code>), or the ratio between 
the ensemble spread and the RMSE of the ensemble mean (<code>RatioSDRMS()</code>) 
along the forecast time for all the input experiments on the same figure 
with their confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotVsLTime(
  var,
  toptitle = "",
  ytitle = "",
  monini = 1,
  freq = 12,
  nticks = NULL,
  limits = NULL,
  listexp = c("exp1", "exp2", "exp3"),
  listobs = c("obs1", "obs2", "obs3"),
  biglab = FALSE,
  hlines = NULL,
  leg = TRUE,
  siglev = FALSE,
  sizetit = 1,
  show_conf = TRUE,
  fileout = NULL,
  width = 8,
  height = 5,
  size_units = "in",
  res = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Matrix containing any Prediction Score with dimensions:<br>
(nexp/nmod, 3/4 ,nltime)<br>
or (nexp/nmod, nobs, 3/4 ,nltime).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toptitle</code></td>
<td>
<p>Main title, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytitle</code></td>
<td>
<p>Title of Y-axis, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monini</code></td>
<td>
<p>Starting month between 1 and 12. Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>1 = yearly, 12 = monthly, 4 = seasonal, ... Default = 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nticks</code></td>
<td>
<p>Number of ticks and labels on the x-axis, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>c(lower limit, upper limit): limits of the Y-axis, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listexp</code></td>
<td>
<p>List of experiment names, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listobs</code></td>
<td>
<p>List of observation names, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biglab</code></td>
<td>
<p>TRUE/FALSE for presentation/paper plot. Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hlines</code></td>
<td>
<p>c(a,b, ..) Add horizontal black lines at Y-positions a,b, ...<br>
Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p>TRUE/FALSE if legend should be added or not to the plot. 
Default = TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglev</code></td>
<td>
<p>TRUE/FALSE if significance level should replace confidence 
interval.<br>
Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizetit</code></td>
<td>
<p>Multiplicative factor to change title size, optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_conf</code></td>
<td>
<p>TRUE/FALSE to show/not confidence intervals for input 
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileout</code></td>
<td>
<p>Name of output file. Extensions allowed: eps/ps, jpeg, png, 
pdf, bmp and tiff. The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>File width, in the units specified in the parameter size_units 
(inches by default). Takes 8 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>File height, in the units specified in the parameter 
size_units (inches by default). Takes 5 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_units</code></td>
<td>
<p>Units of the size of the device (file or window) to plot 
in. Inches ('in') by default. See ?Devices and the creator function of the 
corresponding device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Resolution of the device (file or window) to plot in. See 
?Devices and the creator function of the corresponding device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to the method. Only accepts the following
graphical parameters:<br>
adj ann ask bg bty cex.sub cin col.axis col.lab col.main col.sub cra crt 
csi cxy err family fg fig font font.axis font.lab font.main font.sub 
lheight ljoin lmitre mar mex mfcol mfrow mfg mkh oma omd omi page pch plt 
smo srt tck tcl usr xaxp xaxs xaxt xlog xpd yaxp yaxs yaxt ylbias ylog <br>
For more information about the parameters see 'par'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Examples of input:<br>
Model and observed output from <code>Load()</code> then <code>Clim()</code> then 
<code>Ano()</code> then <code>Smoothing()</code>:<br>
(nmod, nmemb, nsdate, nltime) and (nobs, nmemb, nsdate, nltime)<br>
then averaged over the members<br><code>Mean1Dim(var_exp/var_obs, posdim = 2)</code>:<br>
(nmod, nsdate, nltime) and (nobs, nsdate, nltime)<br>
then passed through<br><code>Corr(exp, obs, posloop = 1, poscor = 2)</code> or<br><code>RMS(exp, obs, posloop = 1, posRMS = 2)</code>:<br>
(nmod, nobs, 3, nltime)<br>
would plot the correlations or RMS between each exp &amp; each obs as a function 
of the forecast time.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load sample data as in Load() example:
example(Load)
clim &lt;- Clim(sampleData$mod, sampleData$obs)
ano_exp &lt;- Ano(sampleData$mod, clim$clim_exp)
ano_obs &lt;- Ano(sampleData$obs, clim$clim_obs)
runmean_months &lt;- 12
smooth_ano_exp &lt;- Smoothing(data = ano_exp, runmeanlen = runmean_months)
smooth_ano_obs &lt;- Smoothing(data = ano_obs, runmeanlen = runmean_months)
dim_to_mean &lt;- 'member'  # mean along members
required_complete_row &lt;- 'ftime'  # discard startdates for which there are NA leadtimes
leadtimes_per_startdate &lt;- 60
corr &lt;- Corr(MeanDims(smooth_ano_exp, dim_to_mean), 
            MeanDims(smooth_ano_obs, dim_to_mean), 
            comp_dim = required_complete_row, dat_dim = 'dataset', 
            limits = c(ceiling((runmean_months + 1) / 2), 
                       leadtimes_per_startdate - floor(runmean_months / 2)))
# Combine corr results for plotting
corr_combine &lt;- abind::abind(corr$conf.lower, corr$corr, corr$conf.upper, corr$p.val, 
                            along = 0)
corr_combine &lt;- Reorder(corr_combine, c(2, 3, 1, 4))

PlotVsLTime(corr_combine, toptitle = "correlations", ytitle = "correlation", 
           monini = 11, limits = c(-1, 2), listexp = c('CMIP5 IC3'), 
           listobs = c('ERSST'), biglab = FALSE, hlines = c(-1, 0, 1))
 

</code></pre>


</div>