<div class="container">

<table style="width: 100%;"><tr>
<td>avm.vcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Covariance Matrix of Ordinary Least Squares Estimators
Using Error Variance Estimates from an Auxiliary Variance Model</h2>

<h3>Description</h3>

<p>The function simply calculates
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Cov}{\hat{\beta}}=(X'X)^{-1}X'\hat{\Omega}X(X'X)^{-1}</code>
</p>
<p>,
where <code class="reqn">X</code> is the design matrix of a linear regression model and
<code class="reqn">\hat{\Omega}</code> is an estimate of the diagonal variance-covariance
matrix of the random errors, whose diagonal elements have been
obtained from an auxiliary variance model fit with <code>alvm.fit</code>
or <code>anlvm.fit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">avm.vcov(object, as_matrix = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Either an object of class <code>"alvm.fit"</code> or an object
of class <code>"anlvm.fit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_matrix</code></td>
<td>
<p>A logical. If <code>TRUE</code> (the default), a
<code class="reqn">p \times p</code> matrix is returned, where <code class="reqn">p</code> is the
number of columns in <code class="reqn">X</code>. Otherwise, a numeric vector of length
<code class="reqn">p</code> is returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either a numeric matrix or a numeric vector, whose (diagonal)
elements are <code class="reqn">\widehat{\mathrm{Var}}(\hat{\beta}_j)</code>,
<code class="reqn">j=1,2,\ldots,p</code>.
</p>


<h3>References</h3>

<p>There are no references for Rd macro <code style="white-space: pre;">⁠\insertAllCites⁠</code> on this help page.
</p>


<h3>See Also</h3>

<p><code>alvm.fit</code>, <code>anlvm.fit</code>,
<code>avm.fwls</code>. If a matrix is returned, it can be
passed to <code>coeftest</code> for implementation
of a quasi-<code class="reqn">t</code>-test of significance of the <code class="reqn">\beta</code> coefficients.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
myalvm &lt;- alvm.fit(mainlm = mtcars_lm, model = "linear",
   varselect = "qgcv.linear")
myvcov &lt;- avm.vcov(myalvm)
lmtest::coeftest(mtcars_lm, vcov. = myvcov)

</code></pre>


</div>