<div class="container">

<table style="width: 100%;"><tr>
<td>maxcount_support</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Maximum Support Value for Count Variables: Correlation Method 2</h2>

<h3>Description</h3>

<p>This function calculates the maximum support value for count variables by extending the method of Barbiero &amp;
Ferrari (2015, doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>) to include regular and zero-inflated Poisson and Negative Binomial variables.  In order for
count variables to be treated as ordinal in the calculation of the intermediate MVN correlation matrix, their infinite support must
be truncated (made finite).  This is done by setting the total cumulative probability equal to 1 - a small user-specified value
(<code>pois_eps</code> or <code>nb_eps</code>).  The maximum support value equals the inverse CDF applied to this result.  The truncation values
may differ for each variable.  The function is used in <code>intercorr2</code> and <code>corrvar2</code> and
would not ordinarily be called by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxcount_support(k_pois = 0, k_nb = 0, lam = NULL, p_zip = 0,
  size = NULL, prob = NULL, mu = NULL, p_zinb = 0, pois_eps = NULL,
  nb_eps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k_pois</code></td>
<td>
<p>the number of Poisson variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_nb</code></td>
<td>
<p>the number of Negative Binomial variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>a vector of lambda (mean &gt; 0) constants for the regular and zero-inflated Poisson variables (see <code>stats::dpois</code>);
the order should be 1st regular Poisson variables, 2nd zero-inflated Poisson variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_zip</code></td>
<td>
<p>a vector of probabilities of structural zeros (not including zeros from the Poisson distribution) for the
zero-inflated Poisson variables (see <code>VGAM::dzipois</code>); if <code>p_zip</code> = 0, <code class="reqn">Y_{pois}</code> has a regular Poisson
distribution; if <code>p_zip</code> is in (0, 1), <code class="reqn">Y_{pois}</code> has a zero-inflated Poisson distribution;
if <code>p_zip</code> is in <code>(-(exp(lam) - 1)^(-1), 0)</code>, <code class="reqn">Y_{pois}</code> has a zero-deflated Poisson distribution and <code>p_zip</code>
is not a probability; if <code>p_zip = -(exp(lam) - 1)^(-1)</code>, <code class="reqn">Y_{pois}</code> has a positive-Poisson distribution
(see <code>VGAM::dpospois</code>); if <code>length(p_zip) &lt; length(lam)</code>, the missing values are set to 0 (and ordered 1st)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector of size parameters for the Negative Binomial variables (see <code>stats::dnbinom</code>); the order should be
1st regular NB variables, 2nd zero-inflated NB variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of success probability parameters for the NB variables; order the same as in <code>size</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of mean parameters for the NB variables (*Note: either <code>prob</code> or <code>mu</code> should be supplied for all Negative Binomial variables,
not a mixture; default = NULL); order the same as in <code>size</code>; for zero-inflated NB this refers to
the mean of the NB distribution (see <code>VGAM::dzinegbin</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_zinb</code></td>
<td>
<p>a vector of probabilities of structural zeros (not including zeros from the NB distribution) for the zero-inflated NB variables
(see <code>VGAM::dzinegbin</code>); if <code>p_zinb</code> = 0, <code class="reqn">Y_{nb}</code> has a regular NB distribution;
if <code>p_zinb</code> is in <code>(-prob^size/(1 - prob^size),</code> <code>0)</code>, <code class="reqn">Y_{nb}</code> has a zero-deflated NB distribution and <code>p_zinb</code>
is not a probability; if <code>p_zinb = -prob^size/(1 - prob^size)</code>, <code class="reqn">Y_{nb}</code> has a positive-NB distribution (see
<code>VGAM::dposnegbin</code>); if <code>length(p_zinb) &lt; length(size)</code>, the missing values are set to 0 (and ordered 1st)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pois_eps</code></td>
<td>
<p>a vector of length <code>k_pois</code> containing total cumulative probability truncation values; if none are provided,
the default is 0.0001 for each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_eps</code></td>
<td>
<p>a vector of length <code>k_nb</code> containing total cumulative probability truncation values; if none are provided,
the default is 0.0001 for each variable</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data.frame with <code>k_pois + k_nb</code> rows; the column names are:
</p>
<p><code>Distribution</code> Poisson or Negative Binomial
</p>
<p><code>Number</code> the variable index
</p>
<p><code>Max</code> the maximum support value
</p>


<h3>References</h3>

<p>Barbiero A &amp; Ferrari PA (2015). Simulation of correlated Poisson variables. Applied Stochastic Models in
Business and Industry, 31:669-80. doi: <a href="http://doi.org/10.1002/asmb.2072">10.1002/asmb.2072</a>.
</p>


<h3>See Also</h3>

<p><code>intercorr2</code>, <code>corrvar2</code>
</p>


</div>