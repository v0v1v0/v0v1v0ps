<div class="container">

<table style="width: 100%;"><tr>
<td>trueLL-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>True likelihood for continuous variables</h2>

<h3>Description</h3>

<p>Calculates the corrected likelihood for independent observations of a
continuous variable that follows a given (truncated) density function,
given a measurement precision.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>vector or histogram of observed values, or an object of <code>fitsad-class</code> 
or <code>fitrad-class</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>character; root name of the continuous density distribution of the variable -
e.g., <kbd>lnorm</kbd> for the lognormal distribution; <kbd>gamma</kbd> for the gamma
distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>named list; values of the coefficients of the continuous
density distribution, in the same order and with the same names as in
the probability function defined by the argument <code>dist</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>real number <code>trunc &lt;= min(x)</code>; value from which the density distribution is
truncated. Currently only lower-tail truncation (or right-truncation)
is implemented. If this argument is omitted the whole
distribution is used (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec.places</code></td>
<td>

<p>positive integer; number of decimal places used in the measurement of
the observed values. Observed values will be rounded to this number of
decimals. This argument defines the measurement precision, see details. 
If neither <code>dec.places</code> nor <code>breaks</code> is given, this defaults to zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>A numeric vector giving the breakpoints between count classes. Either 
<code>dec.places</code> or <code>breaks</code> can be provided, but not both.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>named arguments to be passed to the probability function defined by the argument <code>dens</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The (log)likelihood function is often defined as any function
proportional to the (sum) product of (log) probability density of the
observations. In its original formulation, however, the likelihood is
proportional to the product of probabilities, not probabilities
densities (Fisher 1922, stressed by Lindsey 1999).  For continuous
variables, these probabilities are calculated through integration of
the probability density function in an interval. For observed values
of continuous variables, this interval is defined by the measurement
precision.  The likelihood function is thus any function proportional
to
</p>
<p>prod ( integral_(x-D)^(x+D) f(x) dx )
</p>
<p>where x is the observed value, f(x) the
density function and D is half the measurement precision:
</p>
<p>D = 10^(-'dec.places')/2
</p>
<p>For continuous variables aggregated in discrete classes, such as
frequency tables of histograms, the probability of a given observation
is
</p>
<p>prod ( integral_L^U f(x) dx )
</p>
<p>where L and U are the lower and upper limits of the classes, as
defined by argument <code>breaks</code>.
</p>
<p>Because products of probabilities quickly tends to
zero, probabilities are usually converted to their logs and then
summed to give the log-likelihood function.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "fitsad", dist = "missing", coef = "missing", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt>
<dd>
<p>log-likelihood value of an abundance distribution model <code>object</code> fitted with
function <code>fitsad</code>.
</p>
</dd>
<dt><code>signature(object = "fitrad", dist = "missing", coef = "missing", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt>
<dd>
<p>log-likelihood value of an abundance distribution model <code>object</code> fitted with
function <code>fitrad</code>.
</p>
</dd>
<dt><code>signature(x = "numeric", dist = "character", coef = "list",
	trunc = "ANY", dec.places = "ANY", breaks="ANY", ...)</code></dt>
<dd>
<p>log-likelihood value of a vector of abundances <code>object</code>, fitted to a
continuous distribution named by <code>dist</code> with parameters defined in <code>coef</code>.
</p>
</dd>
<dt><code>signature(object = "histogram", dist = "character", coef = "list", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt>
<dd>
<p>log-likelihood value of the abundances given by histogram <code>object</code>, fitted to a
continuous distribution named by <code>dist</code> with parameters defined in <code>coef</code>.
</p>
</dd>
</dl>
<h3>Note</h3>

<p>WARNING: this function is extremely sensitive to the interval breaks
provided (or to the decimal.places), which may result in surprising results.
Use with great caution.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom
</p>


<h3>References</h3>

<p>Fisher, R.A. 1922. On the mathematical foundations of theoretical
statistics. <em>Phil. Trans. R. Soc. Lond. A 222</em>: 309–368.
</p>
<p>Lindsey, J.K. 1999. Some statistical heresies. <em>The Statistician
48</em>(1): 1–40.
</p>


<h3>See Also</h3>

<p><code>logLik</code> in the package <span class="pkg">MASS</span> and <code>logLik-methods</code> in
package <span class="pkg">bbmle</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Random sample of a lognormal distribution with precision = 0.1
x &lt;- round(rlnorm(500, meanlog = 3, sdlog = 0.5), 1)
## Log-likelihood given by fitdistr
library(MASS)
logLik(fitdistr(x, "lognormal"))
## Which is the sum of log of densities
sum( dlnorm(x, meanlog=mean(log(x)), sdlog=sd(log(x)), log=TRUE) )
## Correct log-likelihood
trueLL(x, "lnorm", coef=list(meanlog=mean(log(x)), sdlog=sd(log(x))), dec.places=1)
# Alternative invocation
trueLL(fitlnorm(x))

## Data in classes
xoc &lt;- octav(x)
xc &lt;- as.numeric(as.character(xoc$octave))
xb &lt;- 2^(c(min(xc)-1, xc))
xh &lt;- hist(x, breaks=xb, plot=FALSE)
xll &lt;- trueLL(xh, dist="lnorm", coef = list(meanlog=mean(log(x)), sd=sd(log(x))))
xp &lt;- diff(plnorm(xh$breaks, mean(log(x)), sd(log(x))))
xll2 &lt;- sum( rep(log(xp), xh$counts))
all.equal(xll, xll2) # should be TRUE
</code></pre>


</div>