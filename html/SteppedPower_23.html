<div class="container">

<table style="width: 100%;"><tr>
<td>VarClosed_Kasza</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Closed formula for treatment variance in open cohort settings</h2>

<h3>Description</h3>

<p>From Kasza et al "Sample size and power calculations for open cohort
longitudinal cluster rondomized trials" 2020
</p>


<h3>Usage</h3>

<pre><code class="language-R">VarClosed_Kasza(trtMat, tau, gamma = 0, psi = 0, sigma, N, chi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trtMat</code></td>
<td>
<p>a matrix trtMat to define treatment allocation,
where rows and columns correspond to cluster and timepoints, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>numeric, standard deviation of random intercepts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>numeric, random time effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>numeric, random subject specific intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>numeric, residual error on subject level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>numeric, number of individuals per cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>Attrition factor</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric, variance of the estimator for treatment effect
</p>


<h3>Examples</h3>

<pre><code class="language-R">##  test setting, from Hussey&amp;Hughes 2007  ####
trtMat &lt;- construct_DesMat(c(6,6,6,6))$trtMat
tau &lt;- .025 ; sigma &lt;- sqrt(.041*.959) ; N &lt;- 100 ;
gamma &lt;- 0.01 ; psi &lt;- .1 ; chi &lt;- .7

tmp &lt;- VarClosed_Kasza(trtMat, tau=tau, sigma=sigma, gamma=0, psi=0, N=N, chi=0)
tTestPwr((.05-.032), sqrt(tmp), df = Inf)
glsPower(Cl = rep(6,4), N=N, mu0=.05, mu1=.032, verbose=0,
        sigma=sigma, gamma=0, tau=tau, psi=0)

tmp &lt;- VarClosed_Kasza(trtMat, tau=tau, sigma=sigma, gamma=gamma, psi=psi, N=N, chi=0)
tTestPwr((.05-.032), sqrt(tmp), df = Inf)
glsPower(Cl = rep(6,4), N=N, mu0=.05, mu1=.032, verbose=0,
        sigma=sigma, gamma=gamma, tau=tau, psi=psi)

tmp &lt;- VarClosed_Kasza(trtMat, tau=tau, sigma=sigma, gamma=gamma, psi=psi, N=N, chi=1)
tTestPwr((.05-.032), sqrt(tmp), df = Inf)
glsPower(Cl = rep(6,4), N=N, mu0=.05, mu1=.032, verbose=0,
         sigma=sigma, gamma=sqrt(gamma^2+psi^2/N), tau=tau, psi=0)

tmp &lt;- VarClosed_Kasza(trtMat, tau=tau, sigma=sigma, gamma=gamma, psi=psi, N=N, chi=chi)
tTestPwr((.05-.032), sqrt(tmp), df = Inf)
glsPower(Cl = rep(6,4), N=N, mu0=.05, mu1=.032, verbose=0,
         sigma=sigma, gamma=sqrt(gamma^2+chi*psi^2/N), tau=tau, psi=sqrt(1-chi)*psi)
</code></pre>


</div>