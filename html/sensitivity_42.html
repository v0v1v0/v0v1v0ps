<div class="container">

<table style="width: 100%;"><tr>
<td>sobolroauc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sobol' Indices estimation under inequality constraints</h2>

<h3>Description</h3>

<p><code>sobolroauc</code> deals with the estimation of Sobol' sensitivity indices when there exists one or multiple sets of constrained factors. Constraints within a set are expressed as inequality constraints (simplex constraint). This function generalizes the procedure of Tissot and Prieur (2015) to estimate either all first-order indices or all closed second-order indices at a total cost of <code class="reqn">2 \times N</code> model evaluations. For closed second-order indices <code class="reqn">N=q^{2}</code> where <code class="reqn">q \geq d-1</code> is a prime number denoting the number of levels of the orthogonal array, and where <code class="reqn">d</code> indicates the number of independent factors or sets of factors.</p>


<h3>Usage</h3>

<pre><code class="language-R">sobolroauc(model = NULL, factors, constraints = NULL, N, p = 1, order, 
            tail = TRUE, conf = 0.95, nboot = 0, ...)
## S3 method for class 'sobolroauc'
tell(x, y = NULL, ...)
## S3 method for class 'sobolroauc'
print(x, ...)
## S3 method for class 'sobolroauc'
plot(x, ylim = c(0,1), ...)
## S3 method for class 'sobolroauc'
ggplot(data, mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>an integer giving the number of factors, or a vector of character strings giving their names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>a list giving the sets of constrained factors (see "Details").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an integer giving the size of each replicated design (for a total of <code class="reqn">2 \times N</code> model evaluations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>an integer giving the number of model outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>an integer giving the order of the indices (1 or 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>a boolean specifying the method used to choose the number of levels of the orthogonal array (see "Warning messages").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"sobolroauc"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"sobolroauc"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>constraints</code> list the sets of factors depending on each other through inequality constraints (see "Examples"). A same factor is not allowed to appear in multiple sets. Factors not appearing in <code>constraints</code> are assumed to be independent and follow each a uniform distribution on [0,1]. One Sobol' index is estimated for each independent factor or set of factors.
</p>
<p>Missing values (i.e <code>NA</code> values) in the model responses are automatically handled by the function.
</p>
<p>This function also supports multidimensional outputs (matrices in <code>y</code> or as output of <code>model</code>).
In this case, aggregated Sobol' indices are returned (<code>see sobolMultOut</code>).
</p>


<h3>Value</h3>

<p><code>sobolroauc</code> returns a list of class <code>"sobolroauc"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments (concatenation of two replicated designs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the responses used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OA</code></td>
<td>
<p>the orthogonal array constructed (<code>NULL</code> if <code>order</code>=1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of Variances of the Conditional Expectations (VCE) with respect to each factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' indices.</p>
</td>
</tr>
</table>
<h3>Warning messages</h3>


<dl>
<dt>"The value entered for <code>N</code> is not the square of a prime number. It has been replaced by: "</dt>
<dd>
<p>when <code>order</code><code class="reqn">=2</code>, the number of levels of the orthogonal array must be a prime number. If <code>N</code> is not a square of a prime number, then this warning message indicates that it was replaced depending on the value of <code>tail</code>. If <code>tail=TRUE</code> (resp. <code>tail=FALSE</code>) the new value of <code>N</code> is equal to the square of the prime number preceding (resp. following) the square root of <code>N</code>.</p>
</dd>
<dt>"The value entered for <code>N</code> is not satisfying the constraint <code class="reqn">N \geq (d-1)^2</code>. It has been replaced by: "</dt>
<dd>
<p>when <code>order</code><code class="reqn">=2</code>, the following constraint must be satisfied <code class="reqn">N \geq (d-1)^{2}</code> where <code class="reqn">d</code> is the number of independent factors or sets of factors. This warning message indicates that <code>N</code> was replaced by the square of the prime number following (or equals to) <code class="reqn">d-1</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Laurent Gilquin
</p>


<h3>References</h3>

<p>L. Devroye, 1986, Non-Uniform Random Variate Generation. Springer-Verlag.
</p>
<p>J. Jacques, C. Lavergne and N. Devictor, 2006, Sensitivity Analysis in presence of model
uncertainty and correlated inputs. Reliability Engineering &amp; System Safety, 91:1126-1134.
</p>
<p>L. Gilquin, C. Prieur and E. Arnaud, 2015, <em>Replication procedure for grouped Sobol' indices estimation in dependent uncertainty spaces</em>, Information and Inference, 4:354-379.
</p>
<p>J.Y. Tissot and C. Prieur, 2015, <em>A randomized orthogonal orray-based procedure for the estimation of first- and second-order Sobol' indices</em>, J. Statist. Comput. Simulation, 85:1358-1381.
</p>


<h3>See Also</h3>

<p><code>sobolroalhs</code>, 
<code>sobolmara</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(boot)
library(numbers)

# Test case: the non-monotonic Sobol g-function
# (there are 8 factors, all following the uniform distribution on [0,1])

# Suppose we have the inequality constraints: X1 &lt;= X3 and X4 &lt;= X6.

# first-order sensitivity indices
x &lt;- sobolroauc(model = sobol.fun, factors = 8, constraints = list(c(1,3),c(4,6)), 
                N = 1000, order = 1, nboot=100)
print(x)
plot(x)

library(ggplot2)
ggplot(x)

# closed second-order sensitivity indices
x &lt;- sobolroauc(model = sobol.fun, factors = 8, constraints = list(c(1,3),c(4,6)), 
                N = 1000, order = 2, nboot=100)
print(x)
ggplot(x)

</code></pre>


</div>