<div class="container">

<table style="width: 100%;"><tr>
<td>rowCATTs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rowwise Cochran-Armitage Trend Test Based on Tables</h2>

<h3>Description</h3>

<p>Given two matrices, each representing one group of subjects (e.g.,
cases and controls in a case-control study), that summarize the numbers 
of subjects showing the different (ordered) levels of the ordinal variables 
represented by the rows of the matrices, the value of the Cochran-Armitage
Trend Test statistic is computed for each variable.
</p>
<p>Using this function instead of <code>rowTrendStats</code> is in particular recommended
when the total number of observations is very large.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rowCATTs(cases, controls, scores = NULL, add.pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>a numeric matrix in which each row represents one ordinal
variable and each column one of the ordered levels that the variables exhibit. The
entries of this matrix are the numbers of observations from one group (e.g.,
the cases in a case-control study) showing a particular
level at the different variables. Such a matrix can, e.g., be generated
by <code>rowTables</code>. The rowwise sums of <code>cases</code> are allowed to
differ between variables (which might happen when some of the observations
are missing for some of the variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controls</code></td>
<td>
<p>a numeric matrix of the same dimensions as <code>cases</code> comprising
the numbers of observations from the second group (e.g., the controls in a
case-control study) that show the respective level at the different ordinal variables.
The rows of <code>controls</code> must represent the same variables in the same
order as <code>cases</code>, and the columns must represent the same levels in the
same order. This matrix can also be generated by employing <code>rowTables</code>.
The rowwise sums of <code>controls</code> are allowed to
differ between variables (which might happen when some of the observations
are missing for some of the variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>a numeric vector of length <code>ncol(cases)</code> containing the scores
for the different levels. If not specified, i.e.\ <code>NULL</code>, the column names
of <code>cases</code> are interpreted as scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.pval</code></td>
<td>
<p>should p-values be added to the output? If <code>FALSE</code>, only the
rowwise values of the Cochran-Armitage trend test statistic will be returned. If <code>TRUE</code>,
additionally the (raw) p-values based on an approximation to the ChiSquare-distribution
with 1 degree of freedom are returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either a vector containing the rowwise values of the Cochran-Armitage trend test statistic
(if <code>add.pval = FALSE</code>), or a list containing these values (<code>stats</code>),
and the (raw) p-values (<code>rawp</code>) not adjusted for multiple comparisons (if <code>add.pval = TRUE</code>).
</p>


<h3>Note</h3>

<p>The usual contingency table for a variable can be obtained from the matrices
by forming a variable-specific matrix in which each row consists of the
row of one of these matrices.
</p>


<h3>Author(s)</h3>

<p>Holger Schwender, <a href="mailto:holger.schwender@udo.edu">holger.schwender@udo.edu</a></p>


<h3>References</h3>

 
<p>Agresti, A.\ (2002). <em>Categorical Data Analysis</em>. Wiley, Hoboken, NJ. 2nd Edition.
</p>
<p>Armitage, P.\ (1955). Tests for Linear Trends in Proportions and Frequencies. 
<em>Biometrics</em>, 11, 375-386.
</p>
<p>Cochran, W.~G.\ (1954). Some Methods for Strengthening the Common ChiSquare Tests.
<em>Biometrics</em>, 10, 417-451.
</p>


<h3>See Also</h3>

<p><code>rowTrendStats</code>, <code>rowMsquares</code>, <code>rowChisq2Class</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Generate a matrix containing data for 10 categorical 
# variables with levels 1, 2, 3.

mat &lt;- matrix(sample(3, 500, TRUE), 10)

# Now assume that the first 25 columns correspond to
# cases and the remaining 25 columns to cases. Then
# a vector containing the class labels is given by

cl &lt;- rep(1:2, e=25)

# and the matrices summarizing the numbers of subjects
# showing the respective levels at the different variables
# are computed by

cases &lt;- rowTables(mat[, cl==1])
controls &lt;- rowTables(mat[,cl==2])

# The values of the rowwise Cochran-Armitage trend test 
# are computed by

rowCATTs(cases, controls)

# which leads to the same results as

rowTrendStats(mat, cl)

# or as 

out &lt;- rowMsquares(cases, controls)
n &lt;- ncol(mat)
out$stats * n / (n-1)

 
## End(Not run)
</code></pre>


</div>