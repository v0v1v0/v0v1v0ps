<div class="container">

<table style="width: 100%;"><tr>
<td>standardize_gee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression standardization in conditional generalized estimating equations</h2>

<h3>Description</h3>

<p><code>standardize_gee</code> performs regression standardization in linear and log-linear
fixed effects models, at specified values of the exposure, over the sample
covariate distribution. Let <code class="reqn">Y</code>, <code class="reqn">X</code>, and <code class="reqn">Z</code> be the outcome,
the exposure, and a vector of covariates, respectively. It is assumed that
data are clustered with a cluster indicator <code class="reqn">i</code>. <code>standardize_gee</code> uses
fitted fixed effects model, with cluster-specific intercept <code class="reqn">a_i</code> (see
<code>details</code>), to estimate the standardized mean
<code class="reqn">\theta(x)=E\{E(Y|i,X=x,Z)\}</code>, where <code class="reqn">x</code> is a specific value of
<code class="reqn">X</code>, and the outer expectation is over the marginal distribution of
<code class="reqn">(a_i,Z)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardize_gee(
  formula,
  link = "identity",
  data,
  values,
  clusterid,
  case_control = FALSE,
  ci_level = 0.95,
  ci_type = "plain",
  contrasts = NULL,
  family = "gaussian",
  reference = NULL,
  transforms = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula to be used with <code>"gee"</code> in the <span class="pkg">drgee</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link function to be used with <code>"gee"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A named list or data.frame specifying the variables and values
at which marginal means of the outcome will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterid</code></td>
<td>
<p>An optional string containing the name of a cluster identification variable
when data are clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case_control</code></td>
<td>
<p>Whether the data comes from a case-control study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_level</code></td>
<td>
<p>Coverage probability of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_type</code></td>
<td>
<p>A string, indicating the type of confidence intervals.
Either "plain", which gives untransformed intervals, or "log", which gives
log-transformed intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>A vector of contrasts in the following format:
If set to <code>"difference"</code> or <code>"ratio"</code>, then <code class="reqn">\psi(x)-\psi(x_0)</code>
or <code class="reqn">\psi(x) / \psi(x_0)</code> are constructed, where <code class="reqn">x_0</code> is a reference
level specified by the <code>reference</code> argument. Has to be <code>NULL</code>
if no references are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The family argument which is used to fit the glm model for the outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>A vector of reference levels in the following format:
If <code>contrasts</code> is not <code>NULL</code>, the desired reference level(s). This
must be a vector or list the same length as <code>contrasts</code>, and if not named,
it is assumed that the order is as specified in contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transforms</code></td>
<td>
<p>A vector of transforms in the following format:
If set to <code>"log"</code>, <code>"logit"</code>, or <code>"odds"</code>, the standardized
mean <code class="reqn">\theta(x)</code> is transformed into <code class="reqn">\psi(x)=\log\{\theta(x)\}</code>,
<code class="reqn">\psi(x)=\log[\theta(x)/\{1-\theta(x)\}]</code>, or
<code class="reqn">\psi(x)=\theta(x)/\{1-\theta(x)\}</code>, respectively.
If the vector is <code>NULL</code>, then <code class="reqn">\psi(x)=\theta(x)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>standardize_gee</code> assumes that a fixed effects model
</p>
<p style="text-align: center;"><code class="reqn">\eta\{E(Y|i,X,Z)\}=a_i+h(X,Z;\beta)</code>
</p>
<p> has been fitted. The link
function <code class="reqn">\eta</code> is assumed to be the identity link or the log link. The
conditional generalized estimating equation (CGEE) estimate of <code class="reqn">\beta</code>
is used to obtain estimates of the cluster-specific means:
</p>
<p style="text-align: center;"><code class="reqn">\hat{a}_i=\sum_{j=1}^{n_i}r_{ij}/n_i,</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">r_{ij}=Y_{ij}-h(X_{ij},Z_{ij};\hat{\beta})</code>
</p>
<p> if <code class="reqn">\eta</code> is the
identity link, and </p>
<p style="text-align: center;"><code class="reqn">r_{ij}=Y_{ij}\exp\{-h(X_{ij},Z_{ij};\hat{\beta})\}</code>
</p>

<p>if <code class="reqn">\eta</code> is the log link, and <code class="reqn">(X_{ij},Z_{ij})</code> is the value of
<code class="reqn">(X,Z)</code> for subject <code class="reqn">j</code> in cluster <code class="reqn">i</code>, <code class="reqn">j=1,...,n_i</code>,
<code class="reqn">i=1,...,n</code>. The CGEE estimate of <code class="reqn">\beta</code> and the estimate of
<code class="reqn">a_i</code> are used to estimate the mean <code class="reqn">E(Y|i,X=x,Z)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\hat{E}(Y|i,X=x,Z)=\eta^{-1}\{\hat{a}_i+h(X=x,Z;\hat{\beta})\}.</code>
</p>
<p> For
each <code class="reqn">x</code> in the <code>x</code> argument, these estimates are averaged across
all subjects (i.e. all observed values of <code class="reqn">Z</code> and all estimated values
of <code class="reqn">a_i</code>) to produce estimates </p>
<p style="text-align: center;"><code class="reqn">\hat{\theta}(x)=\sum_{i=1}^n
\sum_{j=1}^{n_i} \hat{E}(Y|i,X=x,Z_i)/N,</code>
</p>
<p> where <code class="reqn">N=\sum_{i=1}^n n_i</code>.
The variance for <code class="reqn">\hat{\theta}(x)</code> is obtained by the sandwich formula.
</p>


<h3>Value</h3>

<p>An object of class <code>std_glm</code>.
This is basically a list with components estimates and covariance estimates in <code>res</code>.
Results for transformations, contrasts, references are stored in <code>res_contrasts</code>.
Obtain numeric results in a data frame with the tidy function.
</p>


<h3>Note</h3>

<p>The variance calculation performed by <code>standardize_gee</code> does not condition
on the observed covariates <code class="reqn">\bar{Z}=(Z_{11},...,Z_{nn_i})</code>. To see how
this matters, note that
</p>
<p style="text-align: center;"><code class="reqn">var\{\hat{\theta}(x)\}=E[var\{\hat{\theta}(x)|\bar{Z}\}]+var[E\{\hat{\theta}(x)|\bar{Z}\}].</code>
</p>

<p>The usual parameter <code class="reqn">\beta</code> in a generalized linear model does not
depend on <code class="reqn">\bar{Z}</code>. Thus, <code class="reqn">E(\hat{\beta}|\bar{Z})</code> is independent
of <code class="reqn">\bar{Z}</code> as well (since <code class="reqn">E(\hat{\beta}|\bar{Z})=\beta</code>), so that
the term <code class="reqn">var[E\{\hat{\beta}|\bar{Z}\}]</code> in the corresponding variance
decomposition for <code class="reqn">var(\hat{\beta})</code> becomes equal to 0. However,
<code class="reqn">\theta(x)</code> depends on <code class="reqn">\bar{Z}</code> through the average over the sample
distribution for <code class="reqn">Z</code>, and thus the term
<code class="reqn">var[E\{\hat{\theta}(x)|\bar{Z}\}]</code> is not 0, unless one conditions on
<code class="reqn">\bar{Z}</code>.
</p>


<h3>Author(s)</h3>

<p>Arvid Sjölander.
</p>


<h3>References</h3>

<p>Goetgeluk S. and Vansteelandt S. (2008). Conditional generalized
estimating equations for the analysis of clustered and longitudinal data.
<em>Biometrics</em> <b>64</b>(3), 772-780.
</p>
<p>Martin R.S. (2017). Estimation of average marginal effects in multiplicative
unobserved effects panel models. <em>Economics Letters</em> <b>160</b>, 16-19.
</p>
<p>Sjölander A. (2019). Estimation of marginal causal effects in the presence
of confounding by cluster. <em>Biostatistics</em> doi:
10.1093/biostatistics/kxz054
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(drgee)

set.seed(4)
n &lt;- 300
ni &lt;- 2
id &lt;- rep(1:n, each = ni)
ai &lt;- rep(rnorm(n), each = ni)
Z &lt;- rnorm(n * ni)
X &lt;- rnorm(n * ni, mean = ai + Z)
Y &lt;- rnorm(n * ni, mean = ai + X + Z + 0.1 * X^2)
dd &lt;- data.frame(id, Z, X, Y)
fit.std &lt;- standardize_gee(
  formula = Y ~ X + Z + I(X^2),
  link = "identity",
  data = dd,
  values = list(X = seq(-3, 3, 0.5)),
  clusterid = "id"
)
print(fit.std)
plot(fit.std)

</code></pre>


</div>