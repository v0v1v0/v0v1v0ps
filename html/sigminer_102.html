<div class="container">

<table style="width: 100%;"><tr>
<td>show_sig_bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Show Signature Bootstrap Analysis Results</h2>

<h3>Description</h3>

<p>See details for description.
</p>


<h3>Usage</h3>

<pre><code class="language-R">show_sig_bootstrap_exposure(
  bt_result,
  sample = NULL,
  signatures = NULL,
  methods = "QP",
  plot_fun = c("boxplot", "violin"),
  agg_fun = c("mean", "median", "min", "max"),
  highlight = "auto",
  highlight_size = 4,
  palette = "aaas",
  title = NULL,
  xlab = FALSE,
  ylab = "Signature exposure",
  width = 0.3,
  dodge_width = 0.8,
  outlier.shape = NA,
  add = "jitter",
  add.params = list(alpha = 0.3),
  ...
)

show_sig_bootstrap_error(
  bt_result,
  sample = NULL,
  methods = "QP",
  plot_fun = c("boxplot", "violin"),
  agg_fun = c("mean", "median"),
  highlight = "auto",
  highlight_size = 4,
  palette = "aaas",
  title = NULL,
  xlab = FALSE,
  ylab = "Reconstruction error (L2 norm)",
  width = 0.3,
  dodge_width = 0.8,
  outlier.shape = NA,
  add = "jitter",
  add.params = list(alpha = 0.3),
  legend = "none",
  ...
)

show_sig_bootstrap_stability(
  bt_result,
  signatures = NULL,
  measure = c("RMSE", "CV", "MAE", "AbsDiff"),
  methods = "QP",
  plot_fun = c("boxplot", "violin"),
  palette = "aaas",
  title = NULL,
  xlab = FALSE,
  ylab = "Signature instability",
  width = 0.3,
  outlier.shape = NA,
  add = "jitter",
  add.params = list(alpha = 0.3),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bt_result</code></td>
<td>
<p>result object from sig_fit_bootstrap_batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>a sample id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signatures</code></td>
<td>
<p>signatures to show.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>
<p>a subset of <code>c("NNLS", "QP", "SA")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_fun</code></td>
<td>
<p>set the plot function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg_fun</code></td>
<td>
<p>set the aggregation function when <code>sample</code> is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>
<p>set the color for optimal solution. Default is "auto", which use the same color as
bootstrap results, you can set it to color like "red", "gold", etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_size</code></td>
<td>
<p>size for highlighting triangle, default is <code>4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>the color palette to be used for coloring or filling by groups.
Allowed values include "grey" for grey color palettes; brewer palettes e.g.
"RdBu", "Blues", ...; or custom color palette e.g. c("blue", "red"); and
scientific journal palettes from ggsci R package, e.g.: "npg", "aaas",
"lancet", "jco", "ucscgb", "uchicago", "simpsons" and "rickandmorty".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>plot main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character vector specifying x axis labels. Use xlab = FALSE to
hide xlab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character vector specifying y axis labels. Use ylab = FALSE to
hide ylab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>numeric value between 0 and 1 specifying box width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dodge_width</code></td>
<td>
<p>dodge width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.shape</code></td>
<td>
<p>point shape of outlier. Default is 19. To hide outlier,
specify <code>outlier.shape = NA</code>. When jitter is added, then outliers will
be automatically hidden.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>character vector for adding another plot element (e.g.: dot plot or
error bars). Allowed values are one or the combination of: "none",
"dotplot", "jitter", "boxplot", "point", "mean", "mean_se", "mean_sd",
"mean_ci", "mean_range", "median", "median_iqr", "median_hilow",
"median_q1q3", "median_mad", "median_range"; see ?desc_statby for more
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.params</code></td>
<td>
<p>parameters (color, shape, size, fill, linetype) for the
argument 'add'; e.g.: add.params = list(color = "red").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passing to ggpubr::ggboxplot or ggpubr::ggviolin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>character specifying legend position. Allowed values are one of
c("top", "bottom", "left", "right", "none"). To remove the legend use
legend = "none". Legend position can be also specified using a numeric
vector c(x, y); see details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>measure to estimate the exposure instability, can be one of 'RMSE', 'CV', 'MAE' and 'AbsDiff'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions:
</p>

<ul>
<li> <p>show_sig_bootstrap_exposure - this function plots exposures from bootstrap samples with both dotted boxplot.
The optimal exposure (the exposure from original input) is shown as triangle point. <strong>Only one sample can be plotted</strong>.
</p>
</li>
<li> <p>show_sig_bootstrap_error - this function plots decomposition errors from bootstrap samples with both dotted boxplot.
The error from optimal solution (the decomposition error from original input) is shown as triangle point. <strong>Only one sample can be plotted</strong>.
</p>
</li>
<li> <p>show_sig_bootstrap_stability - this function plots the signature exposure instability for specified signatures. Currently,
the instability measure supports 3 types:
</p>

<ul>
<li>
<p> 'RMSE' for Mean Root Squared Error (default) of bootstrap exposures and original exposures for each sample.
</p>
</li>
<li>
<p> 'CV' for  Coefficient of Variation (CV) based on RMSE (i.e. <code>RMSE / btExposure_mean</code>).
</p>
</li>
<li>
<p> 'MAE' for Mean Absolute Error of bootstrap exposures and original exposures for each sample.
</p>
</li>
<li>
<p> 'AbsDiff' for Absolute Difference between mean bootstram exposure and original exposure.
</p>
</li>
</ul>
</li>
</ul>
<h3>Value</h3>

<p>a <code>ggplot</code> object
</p>


<h3>References</h3>

<p>Huang X, Wojtowicz D, Przytycka TM. Detecting presence of mutational signatures in cancer with confidence. Bioinformatics. 2018;34(2):330â€“337. doi:10.1093/bioinformatics/btx604
</p>


<h3>See Also</h3>

<p>sig_fit_bootstrap_batch, sig_fit, sig_fit_bootstrap
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (require("BSgenome.Hsapiens.UCSC.hg19")) {
  laml.maf &lt;- system.file("extdata", "tcga_laml.maf.gz", package = "maftools")
  laml &lt;- read_maf(maf = laml.maf)
  mt_tally &lt;- sig_tally(
    laml,
    ref_genome = "BSgenome.Hsapiens.UCSC.hg19",
    use_syn = TRUE
  )

  library(NMF)
  mt_sig &lt;- sig_extract(mt_tally$nmf_matrix,
    n_sig = 3,
    nrun = 2,
    cores = 1
  )

  mat &lt;- t(mt_tally$nmf_matrix)
  mat &lt;- mat[, colSums(mat) &gt; 0]
  bt_result &lt;- sig_fit_bootstrap_batch(mat, sig = mt_sig, n = 10)
  ## Parallel computation
  ## bt_result = sig_fit_bootstrap_batch(mat, sig = mt_sig, n = 10, use_parallel = TRUE)

  ## At default, mean bootstrap exposure for each sample has been calculated
  p &lt;- show_sig_bootstrap_exposure(bt_result, methods = c("QP"))
  ## Show bootstrap exposure (optimal exposure is shown as triangle)
  p1 &lt;- show_sig_bootstrap_exposure(bt_result, methods = c("QP"), sample = "TCGA-AB-2802")
  p1
  p2 &lt;- show_sig_bootstrap_exposure(bt_result,
    methods = c("QP"),
    sample = "TCGA-AB-3012",
    signatures = c("Sig1", "Sig2")
  )
  p2

  ## Show bootstrap error
  ## Similar to exposure above
  p &lt;- show_sig_bootstrap_error(bt_result, methods = c("QP"))
  p
  p3 &lt;- show_sig_bootstrap_error(bt_result, methods = c("QP"), sample = "TCGA-AB-2802")
  p3

  ## Show exposure (in)stability
  p4 &lt;- show_sig_bootstrap_stability(bt_result, methods = c("QP"))
  p4
  p5 &lt;- show_sig_bootstrap_stability(bt_result, methods = c("QP"), measure = "MAE")
  p5
  p6 &lt;- show_sig_bootstrap_stability(bt_result, methods = c("QP"), measure = "AbsDiff")
  p6
  p7 &lt;- show_sig_bootstrap_stability(bt_result, methods = c("QP"), measure = "CV")
  p7
} else {
  message("Please install package 'BSgenome.Hsapiens.UCSC.hg19' firstly!")
}

</code></pre>


</div>