<div class="container">

<table style="width: 100%;"><tr>
<td>clusterAnalysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>True Discovery Guarantee for Cluster Analysis</h2>

<h3>Description</h3>

<p>This function determines a true discovery guarantee for fMRI cluster analysis.
It computes confidence bounds for the number of true discoveries and the true discovery proportion
within each cluster. The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterAnalysis(sumBrain, clusters, nMax = 50, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sumBrain</code></td>
<td>
<p>an object of class sumBrain, as returned by the functions <code>brainScores</code> and <code>brainPvals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>3D numeric array of cluster indices, or character for a Nifti file name.
If NULL, the whole brain is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMax</code></td>
<td>
<p>maximum number of iterations per cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical, <code>FALSE</code> to print the summary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>clusterAnalysis</code> returns a list containing <code>summary</code> (matrix) and
<code>TDPmap</code> (3D numeric array of the true discovery proportions).
The matrix <code>summary</code> contains, for each cluster,
</p>

<ul>
<li> <p><code>size</code>: size
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>TDP</code>: lower (1-<code>alpha</code>)-confidence bound for the true discovery proportion
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TDP</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>dim1</code>, <code>dim2</code>, <code>dim3</code>: coordinates of the center of mass.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging: <code>brainScores</code>, <code>brainPvals</code>
</p>
<p>Suprathreshold clusters: <code>findClusters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain
res &lt;- brainScores(copes = copes, alpha = 0.2, seed = 42, truncFrom = thr)
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>


</div>