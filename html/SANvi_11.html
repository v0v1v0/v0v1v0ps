<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_atoms_weights_vi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Posterior Atoms and Weights of the Discrete Mixing Distributions</h2>

<h3>Description</h3>

<p>This function estimates the posterior atoms and weights characterizing the discrete 
mixing distributions using the variational estimates obtained from one of the model implemented in SANvi.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_atoms_weights_vi(output)

## S3 method for class 'vi_atoms_weights'
plot(x, DC_num = NULL, lim = 2, ...)

## S3 method for class 'vi_atoms_weights'
print(x, thr = 0.01, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>an object of class <code>SANvb</code>, which is the output of one of the variational functions <code>variational_CAM</code>, 
<code>variational_fiSAN</code>, <code>variational_fSAN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>variational_estimates</code>, which can be 
obtained from the function <code>estimate_atoms_weights_vi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DC_num</code></td>
<td>
<p>an integer or a vector of integers indicating which distributional clusters to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>optional value for <code>plot</code> method to adjust the limits of the x-axis. The atoms are plotted on a range
given by <code>min(posterior means)-2, max(posterior means)+2</code>. Default is set to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>argument for the <code>print()</code> method. It should be a small positive number, 
representing a threshold. If the posterior weight of a shared atom is below the threshold, the
atom is not reported.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>vi_atoms_weights</code>, which is matrix comprising posterior means, 
variances, and a columns for each estimated DC containing the posterior weights.
</p>


<h3>See Also</h3>

<p><code>variational_CAM</code>, <code>variational_fiSAN</code>, 
<code>variational_fSAN</code>, <code>extract_best</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate example data
set.seed(1232)
y &lt;- c(rnorm(100),rnorm(100,5))
g &lt;- rep(1:2,rep(100,2))

# Fitting fiSAN via variational inference
est &lt;- variational_fiSAN(y,g,verbose = FALSE)

# Estimate posterior atoms and weights
estimate_atoms_weights_vi(est)
</code></pre>


</div>