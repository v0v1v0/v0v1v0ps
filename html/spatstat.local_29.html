<div class="container">

<table style="width: 100%;"><tr>
<td>homtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Homogeneity Test for Local Poisson or Gibbs Model
</h2>

<h3>Description</h3>

<p>Conducts a Monte Carlo test of homogeneity for a locally-fitted
Poisson or Gibbs point process model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   homtest(X, ..., nsim = 19,
           test = c("residuals", "score", "taylor", "likelihood"),
           locations = c("coarse", "fine", "split"),
           ladjust = NULL,
           use.fft = NULL,
           simul = NULL,
           verbose = TRUE, Xname = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A point pattern (object of class <code>"ppp"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to <code>locppm</code> to determine the
locally fitted model, and passed to <code>ppm</code> to
determine the homogeneous model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations for the Monte Carlo test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>The local test statistic to be used:
either <code>"likelihood"</code> for the local likelihood ratio test
statistic, <code>"taylor"</code> for the Taylor approximation
to the local likelihood ratio test statistic,
<code>"score"</code> for the local score test statistic,
or <code>"residuals"</code> for the squared local residuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations,use.fft</code></td>
<td>

<p>Arguments passed to <code>locppm</code> to control the
calculation of variances (if <code>method="local"</code>). See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladjust</code></td>
<td>

<p>Optional argument passed to <code>homtestmap</code> specifying a
data-dependent adjustment of the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simul</code></td>
<td>

<p>Optional information that determines 
how to simulate the realisations from the null hypothesis.
An expression in the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> language (that will be evaluated
<code>nsim</code> times to obtain the simulated patterns), or a list
that contains the simulated point patterns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xname</code></td>
<td>

<p>Optional character string name for the dataset <code>X</code>,
to be printed in the test output.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a Monte Carlo test of the null hypothesis of
homogeneity (i.e.\ constant parameter values) for the locally-fitted
Poisson point process or Gibbs point process specified by the
arguments.
</p>
<p>The type of test is controlled by the argument <code>test</code>.
</p>

<ul>
<li>
<p><code>test="likelihood"</code>:
the locally fitted model is computed as <code>locppm(X, ...)</code>.
The local composite likelihood ratio test statistic of this model
is computed at each location,
and the mean of this statistic over the window is computed.
</p>
</li>
<li>
<p><code>test="taylor"</code>:
the locally fitted model is computed as <code>locppm(X, ...)</code>.
The Taylor approximation to the
local composite likelihood ratio test statistic of this model
is computed at each location,
and the mean of this statistic over the window is computed.
</p>
</li>
<li>
<p><code>test="score"</code>:
the locally fitted model is computed as <code>locppm(X, ...)</code>.
The local score test statistic of this model is computed at each location,
and the mean of this statistic over the window is computed.
</p>
</li>
<li>
<p><code>method="residuals"</code>:
the homogeneous model is fitted as <code>ppm(X, ...)</code>.
The smoothed score residuals of this model are computed at each
location, and the mean of the squared norm over the window
is computed.
</p>
</li>
</ul>
<p>The test statistic is computed for the data pattern <code>X</code>
and for each of <code>nsim</code> simulated realisations from the
homogeneous model. The Monte Carlo <code class="reqn">p</code>-value is computed.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code> containing the test outcome.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Baddeley, A. (2017) Local composite likelihood
  for spatial point patterns. <em>Spatial Statistics</em> <b>22</b>, 261â€“295. DOI: 10.1016/j.spasta.2017.03.001
</p>
<p>Baddeley, A., Rubak, E. and Turner, R. (2015) <em>Spatial Point Patterns: Methodology and Applications with R</em>. Chapman and Hall/CRC Press. 
</p>


<h3>See Also</h3>

<p>To compute the test statistic only, see
<code>homtestmap</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   ## Not run: 
   homtest(swedishpines)
   
## End(Not run)
   
</code></pre>


</div>