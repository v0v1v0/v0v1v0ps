<div class="container">

<table style="width: 100%;"><tr>
<td>precision_builder</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct a Precision Matrix</h2>

<h3>Description</h3>

<p>This function constructs the precision matrix for a Conditional 
Autoregression (CAR).
</p>


<h3>Usage</h3>

<pre><code class="language-R">precision_builder(
  im.res,
  tau = 1,
  alpha = 0.75,
  neighborhood = "ar1",
  weight = "binary",
  phi = 1,
  r = NULL,
  w = NULL,
  h = NULL,
  digits.Q = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>im.res</code></td>
<td>
<p>A vector defining the dimension of spatial data. The first 
entry is the number of rows and the second  entry is the number of columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A vector containing precision parameters. If of length 1, then 
all precisions are assumed equal. Otherwise the length of <code>tau</code> should 
equal the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A scalar value between 0 and 1 that defines the strength of 
correlations. Note that when <code>alpha = 0</code> the data are independent and
when <code>alpha = 1</code>, the joint distribution is the improper Intrinsic 
Autoregression (IAR), which cannot be used to generate data. Note also that
while <code>alpha</code> does control dependence it is not interpretable as a 
correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighborhood</code></td>
<td>
<p>Defines the neighborhood within which conditional 
correlations are non-zero. This differs from use in 
<code>correlation_builder</code>, where the neighborhood
defines non-zero marginal correlations. The default is <code>"ar1"</code>, which
creates a neighborhood where the spatial locations directly above, below,
left, and right of a location are included in the neighborhood. More 
complicated neighborhoods can be specified by <code>neighborhood = "round"</code>,
which defines a circular neighborhood about each location, and 
<code>neighborhood = "rectangle"</code>, which defines a rectangular neighborhood
about each location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Determines how weights are assigned. <code>"distance"</code> 
assigns weights as the inverse of Euclidean distance times a constant, 
<code>phi</code>. <code>"binary"</code> assigns weights to 1 for neighbors and 0 
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>When <code>weight = "distance"</code> a constant by which to multiply 
the inverse of Euclidean distance. Defaults to 1, and must exceed 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>If <code>neighborhood = "round"</code>, then locations i,j are 
separated by distance <code class="reqn">d \ge r</code> are conditionally independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w, h</code></td>
<td>
<p>If <code>neighborhood = "rectangle"</code> then <code>w</code> and <code>h</code>
are the number of locations to the left/right and above/below a location 
i that define its neighborhood. Any locations outside this neighborhood are
conditionally independent of the specified location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.Q</code></td>
<td>
<p>Determines the number of digits to round entries in the 
precision matrix. Default is 10.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This formulation of the CAR model is based on a formulation found 
in (Banerjee et al. 2015) where the joint distribution 
of the of the conditionally specified random variables are assumed to be
<code class="reqn">N(0, [diag(tau^2)(D - alpha W)] ^ {-1})</code> and all neighbors are 
weighted 1. When weights other than 1 are desired, the joint distribution
is <code class="reqn">N(0, [diag(tau^2) D (I - alpha D^{-1}W)] ^ {-1})</code>, e.g. as in
(Jin et al. 2005).
</p>


<h3>Value</h3>

<p>A (precision) matrix.
</p>


<h3>References</h3>

<p>Banerjee S, Carlin BP, Gelfand AE (2015).
<em>Hierarchical Modeling and Analysis for Spatial Data</em>, Second edition.
Chapman &amp; Hall/CRC, Boca Raton, Florida.
</p>
<p>Jin X, Carlin BP, Banerjee S (2005).
“Generalized Hierarchical Multivariate CAR Models for Areal Data.”
<em>Biometrics</em>, <b>61</b>(4), 950-961.
<a href="https://doi.org/10.1111/j.1541-0420.2005.00359.x">doi:10.1111/j.1541-0420.2005.00359.x</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
precision_builder(im.res = c(3, 3), tau = 1, alpha = 0.75,
                  neighborhood = "ar1")

## binary weights
precision_builder(im.res = c(3, 3), tau = 1, alpha = 0.75,
                  neighborhood = "round", r = 3)

## weights based on distance
precision_builder(im.res = c(3, 3), tau = 1, alpha = 0.75,
                  weight = "distance", phi = 1,
                  neighborhood = "round", r = 3)

precision_builder(im.res = c(3, 3), tau = 1, alpha = 0.75,
                  neighborhood = "rectangle", w = 2, h = 2)

## End(Not run)
</code></pre>


</div>