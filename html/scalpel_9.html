<div class="container">

<table style="width: 100%;"><tr>
<td>plotBrightest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the most active frames for a given neuron.</h2>

<h3>Description</h3>

<p>For a given neuron, we plot the frames with the highest estimated fluorescence, which
results from fitting the sparse group lasso in Step 3 of SCALPEL.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBrightest(
  scalpelOutput,
  AfilterIndex,
  videoType = "processed",
  neuronsToOutline = "all",
  brightIndex = 1,
  shrinkLargest = FALSE,
  shrinkCutoff = NULL,
  title = NULL,
  Y = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scalpelOutput</code></td>
<td>
<p>An object returned by one of the SCALPEL functions:
<code>scalpel</code> or <code>scalpelStep3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AfilterIndex</code></td>
<td>
<p>Scalar giving the neuron for which to plot the brightest frames. The index refers to which column
of <code>scalpelOutput$Afilter</code> is of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>videoType</code></td>
<td>
<p>Specify whether to plot the processed data from Step 0 (default; <code>videoType="processed"</code>) or raw data (<code>videoType="raw"</code>).
This is ignored if <code>Y</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neuronsToOutline</code></td>
<td>
<p>Specify whether to plot outlines of all neurons (default; <code>neuronsToOutline="all"</code>),
only the outline for <code>neuron</code> (<code>neuronsToOutline="main"</code>), outlines of only the neurons kept
using a previous call to <code>reviewNeurons</code> or <code>reviewNeuronsInteractive</code> (<code>neuronsToOutline="kept"</code>),
or none (<code>neuronsToOutline="none"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brightIndex</code></td>
<td>
<p>Scalar giving which of the ordered brightest frames to plot. The default is 1, i.e., the brightest frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkLargest</code></td>
<td>
<p>Logical value indicating whether the values above <code>shrinkCutoff</code> should be shrunk when plotting. Shrinking these values
allows us to better visualize the areas with the largest fluorescence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkCutoff</code></td>
<td>
<p>The value above which pixel values will be shrunk. By default, this will be chosen as
<code>min(scalpelOutput$thresholdVec)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Label for the title. The default is frame number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An object of class <code>scalpelY</code>, which results from running the <code>getY</code> function. When not specified, <code>Y</code>
is automatically read in, but specifying <code>Y</code> is recommended when the user
would like to call this function many times, as this avoids reading the video into memory repeatedly.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code>scalpel</code>, <code>scalpelStep3</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
### many of the functions in this package are interconnected so the
### easiest way to learn to use the package is by working through the vignette,
### which is available at ajpete.com/software

#assumes you have run the example for the "scalpel" function
#simplest example with default parameters:
plotBrightest(scalpelOutput = scalpelOutput, AfilterIndex = 2)

#example with optional parameters:
#only outline neuron corresponding to frame, plot 5th brightest with raw data
plotBrightest(scalpelOutput = scalpelOutput, AfilterIndex = 2, videoType = "raw",
             neuronsToOutline = "main", brightIndex = 5)

#same plot but if you have video data read in already
#using 'getY' function, you can provide it
rawY = getY(scalpelOutput = scalpelOutput, videoType = "raw")
plotBrightest(scalpelOutput = scalpelOutput, AfilterIndex = 2, Y = rawY,
             neuronsToOutline = "main", brightIndex = 5)

## End(Not run)
</code></pre>


</div>