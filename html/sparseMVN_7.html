<div class="container">

<table style="width: 100%;"><tr>
<td>dmvn.sparse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute density  from multivariate normal distribution</h2>

<h3>Description</h3>

<p>Compute density  from multivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmvn.sparse(x, mu, CH, prec = TRUE, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix, where each row is an MVN sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>mean (numeric vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CH</code></td>
<td>
<p>An object of class dCHMsimpl or dCHMsuper that represents
the Cholesky factorization of either the precision (default) or covariance
matrix.  See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>If TRUE, CH is the Cholesky decomposition of the precision
matrix.  If false, it is the decomposition for the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>If TRUE (default), returns the log density, else returns density.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A density or log density for each row of x
</p>


<h3>Details</h3>

<p>This function use sparse matrix operations to compute the
log density of a multivariate normal distribution.  The user must compute
the Cholesky decomposition first, using the Cholesky function in the Matrix
package.  This function operates on a sparse symmetric matrix, and returns
an object of class dCHMsimpl or dCHMsuper (this depends on the algorithm
that was used for the decomposition).  This object contains information about
any fill-reducing permutations that were used to preserve sparsity.  The
rmvn.sparse and dmvn.sparse functions use this permutation information, even
if pivoting was turned off.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   require(Matrix)
   m &lt;- 20
   p &lt;- 2
   k &lt;- 4

## build sample sparse covariance matrix
   Q1 &lt;- tril(kronecker(Matrix(seq(0.1,p,length=p*p),p,p),diag(m)))
   Q2 &lt;- cbind(Q1,Matrix(0,m*p,k))
   Q3 &lt;- rbind(Q2,cbind(Matrix(rnorm(k*m*p),k,m*p),Diagonal(k)))
   V &lt;- tcrossprod(Q3)
   CH &lt;- Cholesky(V)

   x &lt;- rmvn.sparse(10,rep(0,p*m+k),CH, FALSE)
   y &lt;- dmvn.sparse(x[1,],rep(0,p*m+k), CH, FALSE)

</code></pre>


</div>