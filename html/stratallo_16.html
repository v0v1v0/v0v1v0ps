<div class="container">

<table style="width: 100%;"><tr>
<td>rnabox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recursive Neyman Algorithm for Optimal Sample Allocation Under Box Constraints</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>An internal function that implements the <code>RNABOX</code> algorithm that solves the
following optimal allocation problem, formulated below in the language of
mathematical optimization.
</p>
<p>Minimize
</p>
<p style="text-align: center;"><code class="reqn">f(x_1,\ldots,x_H) = \sum_{h=1}^H \frac{A^2_h}{x_h}</code>
</p>

<p>subject to
</p>
<p style="text-align: center;"><code class="reqn">\sum_{h=1}^H x_h = n</code>
</p>

<p style="text-align: center;"><code class="reqn">m_h \leq x_h \leq M_h, \quad h = 1,\ldots,H,</code>
</p>

<p>where <code class="reqn">n &gt; 0,\, A_h &gt; 0,\, m_h &gt; 0,\, M_h &gt; 0</code>, such that
<code class="reqn">m_h &lt; M_h,\, h = 1,\ldots,H</code>, and
<code class="reqn">\sum_{h=1}^H m_h \leq n \leq \sum_{h=1}^H M_h</code>, are given numbers.
The minimization is on <code class="reqn">\mathbb R_+^H</code>.
Inequality constraints are optional and can be skipped.
</p>
<p><code>rnabox()</code> function should not be called directly by the user. Use <code>opt()</code>
instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnabox(
  n,
  A,
  bounds1 = NULL,
  bounds2 = NULL,
  check_violations1 = .Primitive("&gt;="),
  check_violations2 = .Primitive("&lt;=")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>(<code>number</code>)<br> total sample size. A strictly positive scalar.
If <code>bounds1</code> is not <code>NULL</code>, it is then required that <code>n &gt;= sum(bounds1)</code>
(given that <code>bounds1</code> are treated as lower bounds) or <code>n &lt;= sum(bounds1)</code>
(given that <code>bounds1</code> are treated as upper bounds).
If <code>bounds2</code> is not <code>NULL</code>, it is then required that <code>n &gt;= sum(bounds2)</code>
(given that <code>bounds2</code> are treated as lower bounds) or <code>n &lt;= sum(bounds2)</code>
(given that <code>bounds2</code> are treated as upper bounds).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>(<code>numeric</code>)<br> population constants <code class="reqn">A_1,\ldots,A_H</code>. Strictly
positive numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds1</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br> lower bounds <code class="reqn">m_1,\ldots,m_H</code>,
or upper bounds <code class="reqn">M_1,\ldots,M_H</code> optionally imposed on sample sizes in
strata. The interpretation of <code>bounds1</code> depends on the value of
<code>check_violations1</code>. If no one-sided bounds 1 should be imposed, then
<code>bounds1</code> must be set to <code>NULL</code>. If <code>bounds2</code> is not <code>NULL</code>, it is then
required that either <code>bounds1 &lt; bounds2</code> (in case when <code>bounds1</code> is treated
as lower bounds) or <code>bounds1 &gt; bounds2</code> (in the opposite case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds2</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br> lower bounds <code class="reqn">m_1,\ldots,m_H</code>,
or upper bounds <code class="reqn">M_1,\ldots,M_H</code> optionally imposed on sample sizes in
strata. The interpretation of <code>bounds2</code> depends on the value of
<code>check_violations2</code>. If no one-sided bounds 2 should be imposed, then
<code>bounds2</code> must be set to <code>NULL</code>. If <code>bounds2</code> is not <code>NULL</code>, it is then
required that either <code>bounds1 &lt; bounds2</code> (in case when <code>bounds1</code> is treated
as lower bounds) or <code>bounds1 &gt; bounds2</code> (in the opposite case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_violations1</code></td>
<td>
<p>(<code>function</code>) <br> 2-arguments binary operator function
that allows the comparison of values in atomic vectors. It must either be
set to <code>.Primitive("&lt;=")</code> or <code>.Primitive("&gt;=")</code>.
The first of these choices causes that <code>bounds1</code> are treated as lower
bounds and the <code>rnabox()</code> uses the <em>LRNA</em> algorithm as in interim
algorithm for the allocation problem with one-sided lower bounds <code>bounds1</code>.
The latter option causes that <code>bounds1</code> are treated as upper bounds and the
<code>rnabox()</code> uses the <em>RNA</em> algorithm as in interim algorithm for the
allocation problem with one-sided upper bounds <code>bounds1</code>.
This parameter is correlated with <code>check_violations2</code>. That is, these
arguments must be set against each other.
<code>check_violations1</code> is ignored when <code>bounds1</code> is set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_violations2</code></td>
<td>
<p>(<code>function</code>) <br> 2-arguments binary operator function
that allows the comparison of values in atomic vectors. It must either be
set to <code>.Primitive("&lt;=")</code> or <code>.Primitive("&gt;=")</code>.
The first of these choices causes that <code>bounds2</code> are treated as lower
bounds and the <code>rnabox()</code> uses the <em>LRNA</em> algorithm as in interim
algorithm for the allocation problem with one-sided lower bounds <code>bounds2</code>.
The latter option causes that <code>bounds2</code> are treated as upper bounds and the
<code>rnabox()</code> uses the <em>RNA</em> algorithm as in interim algorithm for the
allocation problem with one-sided upper bounds <code>bounds2</code>.
This parameter is correlated with <code>check_violations1</code>. That is, these
arguments must be set against each other.
<code>check_violations2</code> is ignored when <code>bounds2</code> is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric vector with optimal sample allocations in strata.
</p>


<h3>References</h3>

<p>To be added soon.
</p>


<h3>See Also</h3>

<p><code>opt()</code>, <code>optcost()</code>, <code>sga()</code>, <code>sgaplus()</code>, <code>coma()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- c(454, 10, 116, 2500, 2240, 260, 39, 3000, 2500, 400)
S &lt;- c(0.9, 5000, 32, 0.1, 3, 5, 300, 13, 20, 7)
A &lt;- N * S
m &lt;- c(322, 3, 57, 207, 715, 121, 9, 1246, 1095, 294) # lower bounds
M &lt;- N # upper bounds

# Regular allocation.
n &lt;- 6000
opt_regular &lt;- rnabox(n, A, M, m)

# Vertex allocation.
n &lt;- 4076
opt_vertex &lt;- rnabox(n, A, M, m)
</code></pre>


</div>