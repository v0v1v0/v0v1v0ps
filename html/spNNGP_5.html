<div class="container">

<table style="width: 100%;"><tr>
<td>PGLogit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for Fitting Logistic Models using Polya-Gamma Latent Variables</h2>

<h3>Description</h3>

<p>The function <code>PGLogit</code> fits logistic models to binomial data using Polya-Gamma latent variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PGLogit(formula, weights = 1, data = parent.frame(), n.samples,
        n.omp.threads = 1, fit.rep = FALSE, sub.sample, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the regression model to be
fit. See example below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>specifies the number of trials for each observation. The
default is 1 trial for each observation. Valid arguments are a
scalar value that specifies the number of trials used if all
observations have the same number of trials, and a vector of length <code class="reqn">n</code> that specifies the number of trials for
each observation when there are differences in the number of trials. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. If not found in data, the variables are taken from
<code>environment(formula)</code>, typically the environment from which <code>PGLogit</code> is called.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.samples</code></td>
<td>
<p>the number of posterior samples to collect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.omp.threads</code></td>
<td>
<p>a positive integer indicating
the number of threads to use for SMP parallel processing. The package must
be compiled for OpenMP support. For most Intel-based machines, we
recommend setting <code>n.omp.threads</code> up to the number of
hyperthreaded cores. Note, <code>n.omp.threads</code> &gt; 1 might not
work on all systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.rep</code></td>
<td>
<p>if <code>TRUE</code>, regression fitted and replicate data will be
returned. The argument <code>sub.sample</code> controls which MCMC samples
are used to generate the fitted and replicated data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.sample</code></td>
<td>
<p>an optional list that specifies the samples used
for <code>fit.rep</code>. Valid tags are <code>start</code>,
<code>end</code>, and <code>thin</code>. Given the value associated with the tags,
the sample subset is selected using <code>seq(as.integer(start),
      as.integer(end), by=as.integer(thin))</code>. The default values are
<code>start=floor(0.5*n.samples)</code>, <code>end=n.samples</code> and <code>thin=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, model specification and progress of the
sampler is printed to the screen. Otherwise, nothing is printed to
the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently no additional arguments.  </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>PGLogit</code> which is a list comprising:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.beta.samples</code></td>
<td>
<p>a <code>coda</code> object of posterior samples for
the regression coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.hat.samples</code></td>
<td>
<p>if <code>fit.rep=TRUE</code>, regression fitted values from posterior samples
specified using <code>sub.sample</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.hat.quants</code></td>
<td>
<p>if <code>fit.rep=TRUE</code>, 0.5, 0.025, and 0.975 quantiles of the <code>y.hat.samples</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.rep.samples</code></td>
<td>
<p>if <code>fit.rep=TRUE</code>, replicated outcome from posterior samples
specified using <code>sub.sample</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.rep.quants</code></td>
<td>
<p>if <code>fit.rep=TRUE</code>, 0.5, 0.025, and 0.975
quantiles of the <code>y.rep.samples</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.indx</code></td>
<td>
<p>if <code>fit.rep=TRUE</code>, the subset index specified with <code>sub.sample</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run.time</code></td>
<td>
<p>MCMC sampler execution time reported using <code>proc.time()</code>.</p>
</td>
</tr>
</table>
<p>The return object will include additional objects used for subsequent
prediction and/or model fit evaluation.
</p>


<h3>Note</h3>

<p>Some of the underlying code used for generating random number from the
Polya-Gamma distribution is taken from the <span class="pkg">pgdraw</span> package written
by Daniel F. Schmidt and Enes Makalic. Their code implements Algorithm
6 in PhD thesis of Jesse Bennett Windle (2013) <a href="https://repositories.lib.utexas.edu/handle/2152/21842">https://repositories.lib.utexas.edu/handle/2152/21842</a>.
</p>


<h3>Author(s)</h3>

<p>Andrew O. Finley <a href="mailto:finleya@msu.edu">finleya@msu.edu</a>, <br>
Abhirup Datta <a href="mailto:abhidatta@jhu.edu">abhidatta@jhu.edu</a>, <br>
Sudipto Banerjee <a href="mailto:sudipto@ucla.edu">sudipto@ucla.edu</a>
</p>


<h3>References</h3>

<p>Polson, N.G., J.G. Scott, and J. Windle. (2013) Bayesian Inference for
Logistic Models Using Polya-Gamma Latent Variables. Journal of the
American Statistical Association, 108:1339-1349.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##Generate binary data
set.seed(1)
n &lt;- 100

x &lt;- cbind(1, rnorm(n), runif(n,0,1))
beta &lt;- c(0.1,-5, 5)
p &lt;- 1/(1+exp(-(x%*%beta)))

##Assume 5 trials per outcome
weights &lt;- rep(5, n)

y &lt;- rbinom(n, size=weights, prob=p)

m &lt;- PGLogit(y~x-1, weights = rep(5, n), n.samples = 1000)

summary(m)

</code></pre>


</div>