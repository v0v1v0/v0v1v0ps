<div class="container">

<table style="width: 100%;"><tr>
<td>DESeq2_l2fc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating log2 fold change for HTS-SIP data.</h2>

<h3>Description</h3>

<p>The 'use_geo_mean' parameter uses geometric means on all non-zero abundances
for estimateSizeFactors instead of using the default log-tranformed geometric means.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DESeq2_l2fc(
  physeq,
  density_min,
  density_max,
  design,
  l2fc_threshold = 0.25,
  sparsity_threshold = 0.25,
  sparsity_apply = "all",
  size_factors = "geoMean"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>Phyloseq object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_min</code></td>
<td>
<p>Minimum buoyant density of the 'heavy' gradient fractions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_max</code></td>
<td>
<p>Maximum buoyant density of the 'heavy' gradient fractions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p><code>design</code> parameter used for DESeq2 analysis.
See <code>DESeq2::DESeq</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2fc_threshold</code></td>
<td>
<p>log2 fold change (l2fc) values must be significantly above this
threshold in order to reject the hypothesis of equal counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity_threshold</code></td>
<td>
<p>All OTUs observed in less than this portion (fraction: 0-1)
of gradient fraction samples are pruned. A a form of indepedent filtering,
The sparsity cutoff with the most rejected hypotheses is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity_apply</code></td>
<td>
<p>Apply sparsity threshold to all gradient fraction samples ('all')
or just heavy fraction samples ('heavy')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_factors</code></td>
<td>
<p>Method of estimating size factors.
'geoMean' is from (Pepe-Ranney et. al., 2016) and removes all zero-abundances from the calculation.
'default' is the default for estimateSizeFactors.
'iterate' is an alternative when every OTU has a zero in &gt;=1 sample.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>dataframe of HRSIP results
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(phylo.qSIP)


df_l2fc = DESeq2_l2fc(phylo.qSIP, density_min=1.71, density_max=1.75, design=~Isotope)


</code></pre>


</div>