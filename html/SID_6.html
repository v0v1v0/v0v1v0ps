<div class="container">

<table style="width: 100%;"><tr>
<td>structIntervDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Structural Intervention Distance (SID)
</h2>

<h3>Description</h3>

<p>computes the structural intervention distance (SID) between two graphs; it evaluates graphs from a causal inference point of view.
</p>


<h3>Usage</h3>

<pre><code class="language-R">structIntervDist(trueGraph, estGraph, output = FALSE, spars = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trueGraph</code></td>
<td>

<p>p x p adjacecncy matrix; it must be a directed acyclic graph (DAG)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estGraph</code></td>
<td>

<p>again a p x p adjacecncy matrix; it can be either a DAG or a completed partially directed graph (CPDAG) that represents a Markov equivalence class.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>boolean (TRUE/FALSE) that indicates whether output shall be shown
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spars</code></td>
<td>

<p>boolean (TRUE/FALSE) that indicates whether the input matrices trueGraph and estGraph are sparse. If matrices are indeed large and sparse this increases the speed of the algorithm.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The structural intervention distance (SID) considers each pair (i,j) and checks whether the parents of i in estGraph is a valid adjustment set in trueGraph for the causal effect from i to j. If it is, estimating the causal effect from i to j using parent adjustment in estGraph is a correct procedure, independently of the distribution. If it is not, the pair (i,j) contributes a mistake of one to the overall structural intervention distance. 
</p>
<p>The SID satisfies the properties of a pre-metric; we have SID(G,G) = 0 and 0 &lt;= SID(G1,G2) &lt;= p(p-1), where p is the number of nodes. The SID is not symmetric: in general, we have SID(G1, G2) != SID(G2,G1). Furthermore, the SID can be zero although the two graphs are not the same.
</p>
<p>If estGraph is a completed partially directed acyclic graph (CPDAG), that is it describes a Markov equivalence class, the SID outputs a lower and an upper bound of the SID, that correspond to the best and worst DAG in the equivalence class, respectively.
</p>


<h3>Value</h3>

<p>The main function is structIntervDist. It takes two DAGs (adjacency matrices) of the same dimension as input and provides a list with 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sid </code></td>
<td>
<p>the SID</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sidUpperBound </code></td>
<td>
<p>relevant if estGraph is a CPDAG: it is the highest SID that can be achieved by a graph within the Markov equivalence class ("worst DAG")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sidLowerBound </code></td>
<td>
<p>relevant if estGraph is a CPDAG: it is the lowest SID that can be achieved by a graph within the Markov equivalence class ("best DAG")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incorrectMat </code></td>
<td>
<p>the matrix of incorrect interventional distributions; its sum equals $sid</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonas Peters &lt;jonas.peters@tuebingen.mpg.de&gt;
</p>


<h3>References</h3>

<p>J. Peters, P. B\"uhlmann: Structural intervention distance (SID) for evaluating causal graphs, Neural Computation 27, pages 771-799, 2015
</p>


<h3>See Also</h3>

<p><code>hammingDist</code>
<code>randomDAG</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">G &lt;- rbind(c(0,1,1,1,1),
           c(0,0,1,1,1),
           c(0,0,0,0,0),
           c(0,0,0,0,0),
           c(0,0,0,0,0))

H1 &lt;- rbind(c(0,1,1,1,1),
            c(0,0,1,1,1),
            c(0,0,0,1,0),
            c(0,0,0,0,0),
            c(0,0,0,0,0))

H2 &lt;- rbind(c(0,0,1,1,1),
            c(1,0,1,1,1),
            c(0,0,0,0,0),
            c(0,0,0,0,0),
            c(0,0,0,0,0))

cat("true DAG G:\n")
show(G)
cat("\n")
cat("==============","\n")
cat("\n")
cat("estimated DAG H1:\n")
show(H1)
sid &lt;- structIntervDist(G,H1)
shd &lt;- hammingDist(G,H1)
cat("SHD between G and H1: ",shd,"\n")
cat("SID between G and H1: ",sid$sid,"\n")
#cat("The matrix of incorrect interventional distributions is: ","\n")
#show(sid$incorrectMat)
cat("\n")
cat("==============","\n")
cat("\n")
cat("estimated DAG H2:\n")
show(H2)
sid &lt;- structIntervDist(G,H2)
shd &lt;- hammingDist(G,H2)
cat("SHD between G and H2: ",shd,"\n")
cat("SID between G and H2: ",sid$sid,"\n")
cat("The matrix of incorrect interventional distributions is: ","\n")
show(sid$incorrectMat)

readline("The SID can also be applied to CPDAGs. Please press enter...")
cat("\n")
cat("==============","\n")
cat("\n")
cat("estimated CPDAG H1c:\n")
H1c &lt;- rbind(c(0,1,1,1,1),c(1,0,1,1,1),c(1,1,0,1,0),c(1,1,1,0,0),c(1,1,0,0,0)) 
show(H1c)
sid &lt;- structIntervDist(G,H1c)
cat("SID between G and H1: \n")
cat("lower bound: ",sid$sidLowerBound," upper bound: ", sid$sidUpperBound, "\n")
cat("\n")
</code></pre>


</div>