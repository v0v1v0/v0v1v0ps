<div class="container">

<table style="width: 100%;"><tr>
<td>SADISA_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates species abundance data</h2>

<h3>Description</h3>

<p>Simulates species abundance data using the independent-species approach
</p>


<h3>Usage</h3>

<pre><code class="language-R">SADISA_sim(parsmc, ii, jj, model = c("pm", "dl"), mult = "single",
  nsim = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parsmc</code></td>
<td>
<p>The model parameters. For the point mutation (pm) model this is theta and I. For the protracted
model (pr) this is theta, phi and I. For the density-dependent model (dd) - which can also be interpreted as
the per-species speciation model, this is theta and alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ii</code></td>
<td>
<p>The I parameter. When I is a vector, it is assumed that each value
describes a sample or a guild depending on whether mult == 'ms' or mult == 'mg'. When mult = 'both',
a list of lists must be specified, with each list element relates to a sample and contains a list of values across guilds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jj</code></td>
<td>
<p>the sample sizes for each sample and each guild. Must have the same structure as ii</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the chosen combination of metacommunity model and local community model
as a vector, e.g. c('pm','dl') for a model with point mutation in the metacommunity and
dispersal limitation.
The choices for the metacommunity model are: 'pm' (point mutation), 'rf' (random fission),
'pr' (protracted speciation), 'dd' (density-dependence).
The choices for the local community model are: 'dl' (dispersal limitation), 'dd' (density-dependence).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult</code></td>
<td>
<p>When set to 'single', the loglikelihood of a single abundance vector will be computed
When set to 'mg' the loglikelihood for multiple guilds is computed.
When set to 'ms' the loglikelihood for multiple samples from the same metacommunity is computed.
When set to 'both' the loglikelihood for multiple guilds within multiple samples is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations to perform</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Not all combinations of metacommunity model and local community model have been implemented yet.
because this requires checking for numerical stability of the integration. The currently available model combinations are c('pm','dl').
</p>


<h3>Value</h3>

<p>abund abundance vector, a list of abundance vectors, or a list of lists of abundance vectors,
or a list of lists of lists of abundance vectors
The first layer of the lists corresponds to different simulations
When mult = 'mg', each list contains a list of abundance vectors for different guilds.
When mult = 'ms', each list contains a list of abundance vectors for different samples
from the same metacommunity. In this case the vectors should have equal lengths and may contain
zeros because there may be species that occur in multiple samples and species that do not occur
in some of the samples.
When mult = 'both', each list will be a list of lists of multiple guilds within a sample
</p>


<h3>References</h3>

<p>Haegeman, B. &amp; R.S. Etienne (2017). A general sampling formula for community structure data. Methods in Ecology &amp; Evolution 8: 1506-1519. doi: 10.1111/2041-210X.12807
</p>


</div>