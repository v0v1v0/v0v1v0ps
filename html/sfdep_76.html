<div class="container">

<table style="width: 100%;"><tr>
<td>pairwise_colocation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise Colocation Quotient</h2>

<h3>Description</h3>

<p>Calculate the pairwise colocation quotient (CLQ) for two categorical variables using conditional permutation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pairwise_colocation(A, B, nb, nsim = 99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a character or factor vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a character or factor vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>a neighbors list e.g. created by <code>st_knn()</code> or <code>st_contiguity()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>default <code>99</code>. An integer representing how many simulations to run for calculating the simulated p-values.</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Intuition</h4>

<p>The pairwise CLQ is used to test if there is a spatial directional association between subcategories of two vectors <code>A</code> and <code>B</code>. Compared to the cross-K metric and the join count statistic, the pairwise CLQ can elucidate the presence of an asymmetric relationship between subcategories of A and B. A and B can either be separate categorical vectors or the same categorical vector.
</p>
<p>"The null hypothesis for a CLQ-based analysis is 'given the clustering of the joint population, there is no spatial association between pairs of categorical subsets.'"
</p>



<h4>Definition</h4>

<p>The pairwise colocation quotient is defined as "the ratio of observed to expected proportions of B among A's nearest neighbors. Formally this is given by
<code class="reqn">CLQ_{A \to B} = \frac{{C_{A \to B} / N_A}}{N^{'}_{B} / (N - 1)}</code>" where <code class="reqn">C_{A \to B} = \sum_{i = 1}^{N_A}\sum_{j = 1}^{v}\frac{B_{ij}(1,0)}{v}</code>.
</p>



<h4>Inference</h4>

<p>Inference is done using conditional permutation as suggested by Anselin 1995 where a number of replicates are created. The observed values are compared to the replicates and a the simulated p-value is the proportion of cases where the observed is more extreme as compared to replicate. The simulated p-value returns the lower p-value of either tail.
</p>



<h4>Interpretation</h4>

<p>Given that the CLQ is a ratio of the observed to expected, we interpret values larger than one to mean that there is more colocation than to be expected under the null hypothesis of no spatial association. When the value is smaller than 0, we interpret it to mean that there is less colocation than expected under the null.
</p>



<h3>Value</h3>

<p>A matrix where the rownames are the unique values of A and the column names are the unique values of B and their simulated p-values in the form of <code style="white-space: pre;">⁠p_sim_{B}⁠</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- guerry$main_city
B &lt;- guerry$region
nb &lt;- st_knn(sf::st_geometry(guerry), 5)
pairwise_colocation(B, A, nb)
pairwise_colocation(B, B, nb, 199)
</code></pre>


</div>