<div class="container">

<table style="width: 100%;"><tr>
<td>condmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produces a conditional 2D map from a fitted max-stable process</h2>

<h3>Description</h3>

<p>Produces a conditional 2D map from a fitted max-stable process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">condmap(fitted, fix.coord, x, y, covariates = NULL, ret.per1 = 100,
ret.per2 = ret.per1, col = terrain.colors(64), plot.contour = TRUE,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class <code>maxstab</code>. Most often, it will
be the output of the function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.coord</code></td>
<td>
<p>The spatial coordinates of the location from which
the conditional quantile is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>Numeric vector defining the grid at which the levels are
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>An array specifying the covariates at each grid
point defined by <code>x</code> and <code>y</code>. If <code>NULL</code>, no covariate
is needed. See <code>map</code> to see how to build it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.per1,ret.per2</code></td>
<td>
<p>Numerics giving the return period for which
the quantile map is plotted. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A list of colors such as that generated by 'rainbow',
'heat.colors', 'topo.colors', 'terrain.colors' or similar
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.contour</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), contour lines
are added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Several arguments to be passed to the <code>image</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function solves the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\Pr\left[Z(x_2) &gt; z_2 | Z(x_1) &gt; z_1 \right] =
    \frac{1}{T_2}</code>
</p>

<p>where <code class="reqn">z_1 = -1 / \log(1 - 1/T_1)</code>.
</p>
<p>In other words, it computes, given that at location <code class="reqn">x_1</code> we
exceed the level <code class="reqn">z_1</code>, the levels which is expected to be
exceeded in average every <code class="reqn">T_2</code> year.
</p>


<h3>Value</h3>

<p>A plot. Additionally, a list with the details for plotting the map is
returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>See Also</h3>

<p><code>map</code>, <code>filled.contour</code>,
<code>heatmap</code>, <code>heat.colors</code>,
<code>topo.colors</code>, <code>terrain.colors</code>,
<code>rainbow</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Define the coordinate of each location
n.site &lt;- 30
locations &lt;- matrix(runif(2*n.site, 0, 10), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(50, locations, cov.mod = "whitmat", nugget = 0, range =
2, smooth = 1)

##Now define the spatial model for the GEV parameters
param.loc &lt;- -10 - 4 * locations[,1] + locations[,2]^2
param.scale &lt;- 5 + locations[,2] + locations[,1]^2 / 10
param.shape &lt;- rep(.2, n.site)

##Transform the unit Frechet margins to GEV
for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], param.loc[i], param.scale[i],
param.shape[i])

##Define a model for the GEV margins to be fitted
##shape ~ 1 stands for the GEV shape parameter is constant
##over the region
loc.form &lt;- loc ~ lon + I(lat^2)
scale.form &lt;- scale ~ lat + I(lon^2)
shape.form &lt;- shape ~ 1

##  1- Fit a max-stable process
fitted &lt;- fitmaxstab(data, locations, "whitmat", loc.form, scale.form,
                     shape.form, nugget = 0)

cond.coord &lt;- c(5.1, 5.1)
condmap(fitted, cond.coord, seq(0, 10, length = 25), seq(0,10, length
 =25), ret.per1 = 100, ret.per2 = 1.5)
points(t(cond.coord), pch = "*", col = 2, cex = 2)
</code></pre>


</div>