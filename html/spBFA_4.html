<div class="container">

<table style="width: 100%;"><tr>
<td>predict.spBFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>predict.spBFA</h2>

<h3>Description</h3>

<p>Predicts future observations from the <code>spBFA</code> model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'spBFA'
predict(
  object,
  NewTimes,
  NewX = NULL,
  NewTrials = NULL,
  type = "temporal",
  Verbose = TRUE,
  seed = 54,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>spBFA</code> model object for which predictions
are desired from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NewTimes</code></td>
<td>
<p>A numeric vector including desired time(s) points for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NewX</code></td>
<td>
<p>A matrix including covariates at times <code>NewTimes</code> for prediction. 
<code>NewX</code> must have dimension <code>(M x O x NNewVistis) x P</code>. Where <code>NNewVisits</code> is the number of temporal 
locations being predicted. The default sets <code>NewX</code> to <code>NULL</code>, which assumes that the covariates for all predictions 
are the same as the final time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NewTrials</code></td>
<td>
<p>An array indicating the trials for categorical predictions. The array must have dimension <code>M x C x NNewVisits</code>
and contain only non-negative integers. The default sets <code>NewTrials</code> to <code>NULL</code>, which assumes the trials for all predictions
are the same as the final time point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of prediction, choices include "temporal" and "spatial". Spatial prediction has not been implemented yet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Verbose</code></td>
<td>
<p>A boolean logical indicating whether progress should be output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer value used to set the seed for the random number generator
(default = 54).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>predict.spBFA</code> uses Bayesian krigging to predict vectors at future
time points. The function returns the krigged factors (<code>Eta</code>) and also the observed outcomes (<code>Y</code>).
</p>


<h3>Value</h3>

<p><code>predict.spBFA</code> returns a list containing the following objects.
</p>

<dl>
<dt><code>Eta</code></dt>
<dd>
<p>A <code>list</code> containing <code>NNewVistis</code> matrices, one for each new time prediction. Each matrix is dimension <code>NKeep x K</code>, where
<code>K</code> is the number of latent factors Each matrix contains posterior samples obtained by Bayesian krigging.</p>
</dd>
<dt><code>Y</code></dt>
<dd>
<p>A <code>list</code> containing <code>NNewVistis</code> posterior predictive distribution
matrices. Each matrix is dimension <code>NKeep x (M * O)</code>, where <code>M</code> is the number of spatial locations and <code>O</code> the number of observation types.
Each matrix is obtained through Bayesian krigging.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Samuel I. Berchuck
</p>


<h3>Examples</h3>

<pre><code class="language-R">###Load pre-computed regression results
data(reg.bfa_sp)

###Compute predictions
pred &lt;- predict(reg.bfa_sp, NewTimes = 3)
pred.observations &lt;- pred$Y$Y10 # observed data predictions
pred.krig &lt;- pred$Eta$Eta10 # krigged parameters

</code></pre>


</div>