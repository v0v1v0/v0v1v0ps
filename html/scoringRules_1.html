<div class="container">

<table style="width: 100%;"><tr>
<td>ar_ms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian analysis of a Markov Switching autoregressive model</h2>

<h3>Description</h3>

<p>Bayesian analysis of a Markov Switching autoregressive model
</p>


<h3>Usage</h3>

<pre><code class="language-R">ar_ms(
  y,
  nlag = 1,
  beta_switch = FALSE,
  variance_switch = TRUE,
  identification_constraint = "variance",
  n_burn = 5000,
  n_rep = 20000,
  forecast_periods = 5,
  printout = FALSE,
  Hm1_delta = 25,
  mu_delta = 0,
  s_ = 0.3,
  nu_ = 3,
  R = matrix(c(8, 2, 2, 8), nrow = 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector (time series to be analyzed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag</code></td>
<td>
<p>integer, number of autoregressive lags (defaults to one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_switch, variance_switch</code></td>
<td>
<p>logicals, indicating whether there should be Markovian state 
dependence in regression parameters and residual variance, respectively. Defaults to 
<code>beta_switch = FALSE</code>, <code>variance_switch = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identification_constraint</code></td>
<td>
<p>character, indicating how to identify latent states. Possible values:
<code>"variance"</code>, <code>"mean"</code> and <code>"persistence"</code>. Defaults to <code>"variance"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_burn, n_rep</code></td>
<td>
<p>integers, number of MCMC iterations for burn-in and main analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecast_periods</code></td>
<td>
<p>number of future periods for which forecasts are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printout</code></td>
<td>
<p>logical, whether to print progress report during MCMC (defaults to <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hm1_delta, mu_delta, s_, nu_, R</code></td>
<td>
<p>prior parameters as described in KLTG (2021, Appendix E and Table 4).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default parameters are as set by KLTG (2021, Section 5). The output matrices <code>fcMeans</code> and <code>fcSds</code> can be used to construct 
the mixture-of-parameters estimator analyzed by KLTG. While many of the model features can be changed as described above, the number of Markov regimes is always fixed at two. 
</p>
<p>ar_ms is an R/C++ implementation of Matlab code kindly shared by Gianni Amisano via his website (<a href="https://sites.google.com/site/gianniamisanowebsite/">https://sites.google.com/site/gianniamisanowebsite/</a>). See Amisano and Giacomini (2007) who analyze a similar model.
</p>


<h3>Value</h3>

<p>List containing parameter estimates and forecasts, with the following elements:
</p>

<ul>
<li> <p><code>pars</code>, matrix of posterior draws for parameters (rows are MCMC iterations, columns are parameters)
</p>
</li>
<li> <p><code>fcMeans</code> and <code>fcSds</code>, matrices of forecast means and standard deviations (rows are MCMC iterations, columns are forecast horizons)
</p>
</li>
<li> <p><code>probs</code>, matrix of filtered probabilities for first latent state (rows are MCMC iterations, columns are time periods, excluding the first <code>nlag</code> values for initialization). 
</p>
</li>
<li> <p><code>count</code>, integer, counter for the number of states that were relabeled based on <code>identification_constraint</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Fabian Krueger, based on Matlab code by Gianni Amisano (see details section)
</p>


<h3>References</h3>

<p>Amisano, G. and R. Giacomini (2007), ‘Comparing density forecasts via weighted likelihood ratio tests’, Journal of Business and Economic Statistics 25, 177-190. <a href="https://doi.org/10.1198/073500106000000332">doi:10.1198/073500106000000332</a>
</p>
<p>Krueger, F., Lerch, S., Thorarinsdottir, T.L. and T. Gneiting (2021): ‘Predictive inference based on Markov chain Monte Carlo output’, <em>International Statistical Review</em> 89, 274-301. <a href="https://doi.org/10.1111/insr.12405">doi:10.1111/insr.12405</a>
</p>


<h3>See Also</h3>

<p>run_casestudy uses ar_ms to replicate the results of KLTG (2021, Section 5).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Use GDP data from 2014Q4 edition
data(gdp)
dat &lt;- subset(gdp, vint == "2014Q4")
y &lt;- dat$val[order(dat$dt)]

# Fit model, using the default settings 
set.seed(816)
fit &lt;- ar_ms(y)

# Histograms of parameter draws
par(mfrow = c(2, 2))
hist(fit$pars[,1], main = "Intercept (state-invariant)", xlab = "")
hist(fit$pars[,2], main = "AR(1) term (state-invariant)", xlab = "")
hist(1/fit$pars[,3], main = "Residual variance in 1st state", xlab = "")
hist(1/fit$pars[,4], main = "Residual variance in 2nd state", xlab = "")

# By construction, the residual variance is smaller in the 1st than in the 2nd state:
print(mean(1/fit$pars[,3] &lt; 1/fit$pars[,4]))

## End(Not run)
</code></pre>


</div>