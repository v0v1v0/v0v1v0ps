<div class="container">

<table style="width: 100%;"><tr>
<td>plot.simplexreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots for simplexreg Objects</h2>

<h3>Description</h3>

<p>Various types of plots could be produced for simplexreg Objects, including plots of correlation 
structure, plots of different types of residuals and plots of partial deviance. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'simplexreg'
plot(x, type = c("residuals", "corr", "GOF"), res = "adjvar", lag = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>fitted model object of class "simplexreg"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character specifying types of plots: the correlation (<code>corr</code>),
residuals (<code>residuals</code>), partial deviances (<code>GOF</code>). See 'Details'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>character specifying types of residuals:approximate Pearson residual (<code>appstdPerr</code>),
standard Pearson residual (<code>stdPerr</code>), adjusted dependent variable <code class="reqn">s_i</code> (<code>adjvar</code>).
See <code>residuals.simplexreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>when <code>type = corr</code>, this function examine the autocorrelation at lag <code>lag</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed through to the plot function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides graphical presentations for simplexreg objects. The plot of correlation aims
examine the correlation structure of the longitudinal data set. Let <code class="reqn">r_{ij}</code> be the standardised 
score residuals of the <code>i</code>th observation at time <code class="reqn">t_{ij}</code>, and <code>lag = k</code>, then <code class="reqn">r_{ij}</code> 
are plotted against <code class="reqn">r_{ik}</code> for all <code class="reqn">i</code> and <code class="reqn">j &lt; k</code>, if <code class="reqn">|t_{ij} - t_{ik}| = k</code>.
</p>
<p>Residuals can be plotted when specifying <code>type = "residuals"</code>, The upper and lower 95
(1.96) are also lined.
</p>
<p>Plots of partial deviance are for the goodness-of-fit test in the presence of within-subject dependence for 
longitudinal data. The partial deviances are defined as
</p>
<p style="text-align: center;"><code class="reqn">D_j^P=\sum_{i=1}^{m_j}d(y_{ij}-\hat{\mu}_{ij}) / \sigma_{ij}^2, j \in T</code>
</p>

<p>where T denotes a collection of all distinct times on which observation are made. Cross-sectionally, 
<code class="reqn">y_{ij}</code>'s are independent and hence <code class="reqn">D_j^P</code> follows approximately <code class="reqn">\chi^2</code>, with <code class="reqn">m_j</code> 
being the total number of <code class="reqn">y_{ij}</code>'s observed cross-sectionally at time <code class="reqn">t_j</code>. Both observed partial 
deviance <code class="reqn">D_j^P</code> statistics and the corresponding critical values are depicted and compared at each 
time point.
</p>


<h3>Author(s)</h3>

<p>Chengchun Shi
</p>


<h3>References</h3>

<p>Song, P. and Qiu, Z. and Tan, M. (2004) Modelling Heterogeneous Dispersion in 
Marginal Models for Longitudinal Proportional Data. <em> Biometrical Journal,</em> 
<b> 46:</b> 540–553
</p>
<p>Qiu Z. (2001) <em> Simplex Mixed Models for Longitudinal Proportional Data.</em> 
Ph.D. Dissertation, York University
</p>
<p>Zhang, P. and Qiu, Z. and Shi, C. (2016) simplexreg: An R Package for Regression
Analysis of Proportional Data Using the Simplex Distribution. <em> Journal of Statistical Software,</em>
<b> 71:</b> 1–21

</p>


<h3>See Also</h3>

<p><code>summary.simplexreg</code>, <code>residuals.simplexreg</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## fit the model
data("sdac", package="simplexreg")
sim.glm2 &lt;- simplexreg(rcd~ageadj+chemo|age, 
  link = "logit", data = sdac)
	
data("retinal", package = "simplexreg")
sim.gee2 &lt;- simplexreg(Gas~LogT+LogT2+Level|LogT+Level|Time, 
  link = "logit", corr = "AR1", id = ID, data = retinal)  

## produce the plots
plot(sim.glm2, type = "residuals", res = "stdPerr", ylim = c(-3, 3))
plot(sim.gee2, type = "corr", xlab = "", ylab = "")
plot(sim.gee2, type = "GOF", xlab = "", ylab = "")
</code></pre>


</div>