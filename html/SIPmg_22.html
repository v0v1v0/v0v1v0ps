<div class="container">

<table style="width: 100%;"><tr>
<td>scale_features_lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scale feature coverage values to estimate their absolute abundance</h2>

<h3>Description</h3>

<p>Calculates global scaling factors for features (contigs or bins),based on linear regression of sequin coverage. Options include log-transformations of coverage, as well as filtering features based on limit of detection. This function must be called first, before the feature abundance table, feature detection table, and plots are retrieved.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scale_features_lm(
  f_tibble,
  sequin_meta,
  seq_dilution,
  log_trans = TRUE,
  coe_of_variation = 250,
  lod_limit = 0,
  save_plots = TRUE,
  plot_dir = tempdir(),
  cook_filtering = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f_tibble</code></td>
<td>
<p>Can be either of
(1) a tibble with first column "Feature" that contains bin IDs, and the rest of the columns represent samples with bins' coverage values.
(2) a tibble as outputted by the program "checkm coverage" from the tool CheckM. Please check CheckM documentation - https://github.com/Ecogenomics/CheckM on the usage for "checkm coverage" program</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequin_meta</code></td>
<td>
<p>tibble containing sequin names ("Feature column") and concentrations in attamoles/uL ("Concentration") column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_dilution</code></td>
<td>
<p>tibble with first column "Sample" with <strong>same sample names as in f_tibble</strong>, and a second column "Dilution" showing ratio of sequins added to final sample volume (e.g. a value of 0.01 for a dilution of 1 volume sequin to 99 volumes sample)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_trans</code></td>
<td>
<p>Boolean (TRUE or FALSE), should coverages and sequin concentrations be log-scaled?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coe_of_variation</code></td>
<td>
<p>Acceptable coefficient of variation for coverage and detection (eg. 20 - for 20 % threshold of coefficient of variation). Coverages above the threshold value will be flagged in the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lod_limit</code></td>
<td>
<p>(Decimal range 0-1) Threshold for the percentage of minimum detected sequins per concentration group. Default = 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_plots</code></td>
<td>
<p>Boolean (TRUE or FALSE), should sequin scaling be saved? Default = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_dir</code></td>
<td>
<p>Directory where plots are to be saved. Will create a directory "sequin_scaling_plots_lm" if it does not exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cook_filtering</code></td>
<td>
<p>Boolean (TRUE or FALSE), should data points be filtered based on Cook's distance metric. Cooks distance can be useful in detecting influential outliers in an ordinary least squareâ€™s regression model, which can negatively influence the model. A threshold of Cooks distance of 4/n (where n is the sample size) is chosen, and any data point with Cooks distance &gt; 4/n is filtered out. It is typical to choose 4/n as the threshold in detecting the outliers in the data. Default = TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of tibbles containing
</p>

<ul>
<li>
<p> mag_tab: a tibble with first column "Feature" that contains bin (or contig IDs), and the rest of the columns represent samples with features' scaled abundances (attamoles/uL)
</p>
</li>
<li>
<p> mag_det: a tibble with first column "Feature" that contains bin (or contig IDs),
</p>
</li>
<li>
<p> plots: linear regression plots for scaling MAG coverage values to absolute abundance
</p>
</li>
<li>
<p> scale_fac: a master tibble with all of the intermediate values in above calculations
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data(f_tibble, sequins, seq_dil)



### scaling sequins from coverage values
scaled_features_lm = scale_features_lm(f_tibble,sequin_meta, seq_dil)


</code></pre>


</div>