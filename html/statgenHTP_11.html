<div class="container">

<table style="width: 100%;"><tr>
<td>fitSpline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Splines</h2>

<h3>Description</h3>

<p>Fit P-Splines on corrected or raw data. The number of
knots is chosen by the user. The function outputs are predicted P-Spline
values and their first and second derivatives on a dense grid. The
outputs can then be used for outlier detection for time series
(see <code>detectSerieOut</code>) and to estimate relevant parameters from
the curve for further analysis (see <code>estimateSplineParameters</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitSpline(
  inDat,
  trait,
  genotypes = NULL,
  plotIds = NULL,
  knots = 50,
  useTimeNumber = FALSE,
  timeNumber = NULL,
  minNoTP = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inDat</code></td>
<td>
<p>A data.frame with corrected spatial data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>A character string indicating the trait for which the spline
should be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which
splines should be fitted. If <code>NULL</code>, splines will be fitted for all
genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which splines
should be fitted. If <code>NULL</code>, splines will be fitted for all plotIds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>The number of knots to use when fitting the spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useTimeNumber</code></td>
<td>
<p>Should the timeNumber be used instead of the timePoint?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeNumber</code></td>
<td>
<p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNoTP</code></td>
<td>
<p>The minimum number of time points for which data should be
available for a plant. Defaults to 80% of all time points present in the
TP object. No splines are fitted for plants with less than the minimum number
of timepoints.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>HTPSpline</code>, a list with two
<code>data.frames</code>, <code>predDat</code> with predicted values and <code>coefDat</code>
with P-Spline coefficients on a dense grid.
</p>


<h3>See Also</h3>

<p>Other functions for fitting splines: 
<code>plot.HTPSpline()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-Splines on a subset of genotypes
subGeno &lt;- c("G070", "G160")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGeno,
                        knots = 50)

## Extract the data.frames with predicted values and P-Spline coefficients.
predDat &lt;- fit.spline$predDat
head(predDat)

coefDat &lt;- fit.spline$coefDat
head(coefDat)

## Visualize the P-Spline predictions for one genotype.
plot(fit.spline, genotypes = "G160")

## Visualize the P-Spline predictions and first derivatives for one plant.
plot(fit.spline, plotIds = "c10r29", plotType = "predictions")
plot(fit.spline, plotIds = "c10r29", plotType = "derivatives")

</code></pre>


</div>