<div class="container">

<table style="width: 100%;"><tr>
<td>sample_strat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratified sampling</h2>

<h3>Description</h3>

<p>Sampling based on a stratified raster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_strat(
  sraster,
  nSamp,
  allocation = "prop",
  method = "Queinnec",
  weights = NULL,
  force = FALSE,
  mraster = NULL,
  mindist = NULL,
  existing = NULL,
  include = FALSE,
  remove = FALSE,
  access = NULL,
  buff_inner = NULL,
  buff_outer = NULL,
  wrow = 3,
  wcol = 3,
  plot = FALSE,
  details = FALSE,
  filename = NULL,
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sraster</code></td>
<td>
<p>spatRaster. Stratification raster to be used for sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamp</code></td>
<td>
<p>Numeric. Number of desired samples. <code>existing</code>, <code>include</code> and <code>force</code> influence this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allocation</code></td>
<td>
<p>Character. Allocation algorithm to be used. Either <code>prop</code> (default) for proportional allocation,
<code>optim</code> for optimal allocation (equal sampling cost), <code>equal</code> for equal number of samples (defined by <code>nSamp</code>)
for each strata, or <code>"manual"</code> for user defined strata weights defined using <code>weights</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character. Sampling design approach <code>"Queinnec"</code> (default) or <code>"random"</code>. <code>"Queinnec"</code> method is
described in notes below. <code>"random"</code> performs traditional stratified random sampling where probability to sample each
cell within each stratum is equal assuming default parameters for <code>mindist</code>. <code>existing, include, remove</code> are ignored when <code>method = "random"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Numeric. Only applicable when <code>allocation = "manual"</code>. Vector of weights where <code>sum(weights) == 1</code>. Vector length
must be equal to the number of unique strata where the first numeric value corresponds to stratum 1, second stratum 2 etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>Logical. <code>Default = FALSE</code> - force <code>nSamp</code> to be exactly the user defined value
in cases where <code>nSamp</code> and <code>sraster</code> strata count are not equally divisible. Additional samples often need to be allocated or removed
based on rounding differences resulting from proportional differences between <code>nSamp</code> and strata coverages in <code>sraster</code>.
In these instances samples are either added to strata with the lowest number of samples or are removed from strata with the highest number of samples.
Has no effect when <code>existing</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mraster</code></td>
<td>
<p>spatRaster. ALS metric raster. Required when <code>allocation = optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindist</code></td>
<td>
<p>Numeric. Minimum allowable distance between selected
samples. <code>Default = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>existing</code></td>
<td>
<p>sf 'POINT' or data.frame.  Existing plot network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>Logical. If <code>TRUE</code> include <code>existing</code> plots in <code>nSamp</code> total.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove</code></td>
<td>
<p>Logical. If <code>TRUE</code> randomly remove samples from over represented strata to meet allocated sample numbers.
Used only when <code>existing</code> and <code>include</code> are both <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>access</code></td>
<td>
<p>sf 'LINESTRING' or 'MULTILINESTRING'. Access network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buff_inner</code></td>
<td>
<p>Numeric. Inner buffer boundary specifying distance
from access where plots cannot be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buff_outer</code></td>
<td>
<p>Numeric. Outer buffer boundary specifying distance
from access where plots can be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrow</code></td>
<td>
<p>Numeric. Number of row in the focal window (<code>default = 3</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcol</code></td>
<td>
<p>Numeric. Number of columns in the focal window (<code>default = 3</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. Plots samples of type 'existing' (if provided; croses) and 'new' (circles) along with <code>sraster</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>Logical. If <code>FALSE</code> (default) output is sf object of
stratified samples. If <code>TRUE</code> return a list
where <code>$details</code> additional sampling information and <code>$raster</code>
is an sf object of stratified samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Character. Path to write output samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Logical. Choice to overwrite existing <code>filename</code> if it exists.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An sf object with <code>nSamp</code> stratified samples.
</p>


<h3>Note</h3>

<p>The sampling is performed in 2 stages when <code>method = "Queinnec"</code>:
</p>

<ol>
<li> <p><code>Rule 1</code> - Sample within grouped stratum pixels defined within the
<code>wrow, wcol</code> parameters
</p>
</li>
<li> <p><code>Rule 2</code> - If no samples exist to satisfy Rule 1
individual stratum pixels are sampled.
</p>
<p>The rule applied to allocate each sample is defined in the <code>rule</code> attribute of output samples.
</p>
</li>
</ol>
<p><code>existing</code> may contain samples that fall in <code>sraster</code> cells that are 'NA'. If this occurs and <code>include = TRUE</code>, 'NA' samples
are separated during sampling and re-appended at the end of the sampling process.
</p>
<p>If the <code>sraster</code> provided contains factor values, the algorithm will automatically convert these into the numeric factor levels and
perform sampling using those values. The categories (factor values) will be extracted and appended to the algorithm output as the 'category' attribute.
</p>


<h3>Author(s)</h3>

<p>Tristan R.H. Goodbody &amp; Martin Queinnec
</p>


<h3>References</h3>

<p>Queinnec, M., White, J. C., &amp; Coops, N. C. (2021).
Comparing airborne and spaceborne photon-counting LiDAR canopy
structural estimates across different boreal forest types.
Remote Sensing of Environment, 262 (August 2020), 112510.
https://doi.org/10.1016/j.rse.2021.112510
</p>


<h3>See Also</h3>

<p>Other sample functions: 
<code>sample_ahels()</code>,
<code>sample_balanced()</code>,
<code>sample_clhs()</code>,
<code>sample_existing()</code>,
<code>sample_nc()</code>,
<code>sample_srs()</code>,
<code>sample_sys_strat()</code>,
<code>sample_systematic()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#--- Load raster and access files ---#
r &lt;- system.file("extdata", "sraster.tif", package = "sgsR")
sr &lt;- terra::rast(r)


#--- perform stratified sampling random sampling ---#
sraster &lt;- sample_strat(
  sraster = sr,
  nSamp = 50
)

</code></pre>


</div>