<div class="container">

<table style="width: 100%;"><tr>
<td>testDensRatioGOF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-Fit Test of the Validity of a Univariate or Multivariate Mark Density Ratio Model</h2>

<h3>Description</h3>

<p><code>testDensRatioGoF</code> implements the complete-case goodness-of-fit test of Qin and Zhang (1997) for evaluating the validity of the specified mark density ratio model used for modeling a component of
the mark-specific hazard ratio model in Juraska and Gilbert (2013). Multivariate marks are accommodated. Subjects who experienced the event of interest but their mark is missing are discarded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testDensRatioGOF(
  eventInd,
  mark,
  tx,
  DRcoef = NULL,
  DRlambda = NULL,
  iter = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eventInd</code></td>
<td>
<p>a numeric vector indicating the event of interest (1 if event, 0 if right-censored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>either a numeric vector specifying a univariate continuous mark or a data frame specifying a multivariate continuous mark.
For subjects with a right-censored time-to-event, the value(s) in <code>mark</code> should be set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tx</code></td>
<td>
<p>a numeric vector indicating the treatment group (1 if treatment, 0 if placebo)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DRcoef</code></td>
<td>
<p>a numeric vector of the coefficients <code class="reqn">\phi</code> in the weight function <code class="reqn">g(v, \phi) = \exp\{\phi^T (1, v)\}</code> in the density ratio model. If <code>NULL</code> (default), the maximum profile likelihood estimates (Qin, 1998)
of the coefficients are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DRlambda</code></td>
<td>
<p>the Lagrange multiplier in the profile score functions for <code class="reqn">\phi</code> (that arises by profiling out the nuisance parameter). If <code>NULL</code> (default), the maximum profile likelihood estimate (Qin, 1998)
of the Lagrange multiplier is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of bootstrap iterations (1000 by default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>testDensRatioGoF</code> performs a goodness-of-fit test for the exponential form of the weight function, i.e., <code class="reqn">g(v, \phi) = \exp\{\phi^T (1, v)\}</code>. Other weight functions are not considered.
</p>


<h3>Value</h3>

<p>Returns a list containing the following components:
</p>

<ul>
<li> <p><code>teststat</code>: the value of the Kolmogorov-Smirnov-type test statistic
</p>
</li>
<li> <p><code>pval</code>: the bootstrap p-value from the Kolmogorov-Smirnov-type test of validity of the mark density ratio model
</p>
</li>
<li> <p><code>DRcoef</code>: the input object if different from <code>NULL</code> or a numeric vector of estimates of coefficients <code class="reqn">\phi</code> in the weight function <code class="reqn">g(v, \phi)</code> in the density ratio model
</p>
</li>
<li> <p><code>DRlambda</code>: the input object if different from <code>NULL</code> or an estimate of the Lagrange multiplier in the profile score functions for <code class="reqn">\phi</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Qin, J., &amp; Zhang, B. (1997). A goodness-of-fit test for logistic regression models based on case-control data. <em>Biometrika</em>, 84(3), 609-618.
</p>
<p>Juraska, M. and Gilbert, P. B. (2013), Mark-specific hazard ratio model with multivariate continuous marks: an application to vaccine efficacy. <em>Biometrics</em> 69(2):328-337.
</p>
<p>Qin, J. (1998), Inferences for case-control and semiparametric two-sample density ratio models. <em>Biometrika</em> 85, 619-630.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
tx &lt;- rep(0:1, each=n/2)
tm &lt;- c(rexp(n/2, 0.2), rexp(n/2, 0.2 * exp(-0.4)))
cens &lt;- runif(n, 0, 15)
eventTime &lt;- pmin(tm, cens, 3)
eventInd &lt;- as.numeric(tm &lt;= pmin(cens, 3))
mark1 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 2, 5), rbeta(n/2, 2, 2)), NA)
mark2 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 1, 3), rbeta(n/2, 5, 1)), NA)

# test goodness-of-fit for a univariate mark
testDensRatioGOF(eventInd, mark1, tx, iter=15)

# test goodness-of-fit for a bivariate mark
testDensRatioGOF(eventInd, data.frame(mark1, mark2), tx, iter=15)

</code></pre>


</div>