<div class="container">

<table style="width: 100%;"><tr>
<td>create_geo_objects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create geographical objects to be used in Bayesian Cluster Detection Method</h2>

<h3>Description</h3>

<p>This internal function creates the geographical objects needed to run the Bayesian cluster detection method in <code>bayes_cluster()</code>.  Specifically it creates all single zones based data objects, where single zones are the <em>zones</em> defined by Kulldorff (1997).
</p>


<h3>Usage</h3>

<pre><code class="language-R">create_geo_objects(max.prop, population, centroids, sp.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>max.prop</code></td>
<td>
<p>maximum proportion of study region's population each single zone can contain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>vector of length <code>n</code> of the population of each area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centroids</code></td>
<td>
<p><code style="white-space: pre;">⁠n x 2⁠</code> table of the (x,y)-coordinates of the area centroids.  The coordinate system must be grid-based</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.obj</code></td>
<td>
<p>object of class SpatialPolygons (See SpatialPolygons-class) representing the study region</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>list with two elements: <code style="white-space: pre;">⁠1. presence⁠</code> which lists for each area all the single zones it is present in and <code style="white-space: pre;">⁠2. cluster.list⁠</code> for each single zone its component areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.coords</code></td>
<td>
<p><code style="white-space: pre;">⁠n.zones x 2⁠</code> matrix of the center and radial area of each single zone</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Albert Y. Kim
</p>


<h3>References</h3>

<p>Wakefield J. and Kim A.Y. (2013) A Bayesian model for cluster detection.<em>Biostatistics</em>, <strong>14</strong>, 752–765.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(pennLC)
max.prop &lt;- 0.15
population &lt;- tapply(pennLC$data$population, pennLC$data$county, sum)
centroids &lt;- latlong2grid(pennLC$geo[, 2:3])
sp.obj &lt;- pennLC$spatial.polygon
output &lt;- create_geo_objects(max.prop, population, centroids, sp.obj)
## number of single zones
nrow(output$cluster.coords)
</code></pre>


</div>