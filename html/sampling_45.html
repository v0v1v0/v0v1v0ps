<div class="container">

<table style="width: 100%;"><tr>
<td>UPmaxentropy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum entropy sampling</h2>

<h3>Description</h3>

<p>Maximum entropy sampling with fixed sample size and unequal probabilities (or Conditional Poisson sampling) 
is implemented by means of a sequential method (unequal probabilities, without replacement, fixed sample size).
</p>


<h3>Usage</h3>

<pre><code class="language-R">UPmaxentropy(pik) 
UPmaxentropypi2(pik)
UPMEqfromw(w,n)
UPMEpikfromq(q) 
UPMEpiktildefrompik(pik,eps=1e-6)
UPMEsfromq(q)
UPMEpik2frompikw(pik,w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik</code></td>
<td>
<p>vector of prescribed inclusion probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>tolerance in the Newton's method; by default is 1E-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>matrix of the conditional selection probabilities for the sequential algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>parameter vector of the maximum entropy design.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The maximum entropy sampling maximizes the entropy criterion:
</p>
<p style="text-align: center;"><code class="reqn">I(p) = - \sum_s p(s)\log[p(s)]</code>
</p>

<p>The main procedure is <code>UPmaxentropy</code> which selects a sample (a vector of 0 and 1)
from a given vector of inclusion probabilities. The procedure <code>UPmaxentropypi2</code>
returns the matrix of joint inclusion probabilities from the first-order inclusion probability vector.
The other procedures are intermediate steps. They can be useful to run simulations as shown
in the examples below. The procedure <code>UPMEpiktildefrompik</code> computes the vector
of the inclusion probabilities (denoted <code>pikt</code>) of a Poisson sampling from the vector
of the inclusion probabilities of the maximum entropy sampling.  
The maximum entropy sampling is the conditional
design given the fixed sample size. The vector <code>w</code> can be easily obtained by 
<code>w=pikt/(1-pikt)</code>. Once <code>piktilde</code> and <code>w</code> are deduced from <code>pik</code>,
a matrix of selection probabilities <code>q</code> can be derived from the sample size <code>n</code> 
and the vector <code>w</code> via <code>UPMEqfromw</code>. 
Next, a sample can be selected from <code>q</code> using <code>UPMEsfromq</code>.
In order to generate several samples, 
it is more efficient to compute the matrix <code>q</code> (which needs some calculation),
and then to use the procedure <code>UPMEsfromq</code>. The vector of the inclusion probabilities can
be recomputed from <code>q</code> using <code>UPMEpikfromq</code>, which also checks 
the numerical precision  of the algorithm. The procedure <code>UPMEpik2frompikw</code>
computes the matrix of the joint inclusion probabilities from <code>q</code> and <code>w</code>.
</p>


<h3>References</h3>

<p>Chen, S.X., Liu, J.S. (1997).
Statistical applications of the Poisson-binomial and conditional Bernoulli distributions,
<em>Statistica Sinica</em>, 7, 875-892;<br>
Deville, J.-C. (2000).
<em>Note sur l'algorithme de Chen, Dempster et Liu.</em>
Technical report, CREST-ENSAI, Rennes.<br>
Matei, A., Tillé, Y. (2005) Evaluation of variance approximations and estimators in maximum entropy sampling with unequal
probability and fixed sample size, 
<em>Journal of Official Statistics</em>, Vol. 21, No. 4, p. 543-570.<br>
Tillé, Y. (2006), <em>Sampling Algorithms</em>, Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# Simple example - sample selection 
pik=c(0.07,0.17,0.41,0.61,0.83,0.91)
# First method
UPmaxentropy(pik)
# Second method by using intermediate procedures
n=sum(pik)
pikt=UPMEpiktildefrompik(pik)
w=pikt/(1-pikt)
q=UPMEqfromw(w,n)
UPMEsfromq(q)
# Matrix of joint inclusion probabilities
# First method: direct computation from pik
UPmaxentropypi2(pik)
# Second method: computation from pik and w
UPMEpik2frompikw(pik,w)
############
## Example 2
############
# other examples in the 'UPexamples' vignette
# vignette("UPexamples", package="sampling")
</code></pre>


</div>