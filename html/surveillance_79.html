<div class="container">

<table style="width: 100%;"><tr>
<td>calibrationTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calibration Tests for Poisson or Negative Binomial Predictions
</h2>

<h3>Description</h3>

<p>The implemented calibration tests for Poisson or negative binomial
predictions of count data are based on proper scoring rules and
described in detail in Wei and Held (2014).
The following proper scoring rules are available:
Dawid-Sebastiani score (<code>"dss"</code>),
logarithmic score (<code>"logs"</code>),
ranked probability score (<code>"rps"</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">calibrationTest(x, ...)

## Default S3 method:
calibrationTest(x, mu, size = NULL,
                which = c("dss", "logs", "rps"),
                tolerance = 1e-4, method = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>the observed counts.
All involved functions are vectorized and also accept matrices or arrays.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>the means of the predictive distributions for the
observations <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>either <code>NULL</code> (default), indicating Poisson predictions with mean
<code>mu</code>, or dispersion parameters of
negative binomial forecasts for the observations <code>x</code>,
parametrized as in <code>dnbinom</code> with variance
<code>mu*(1+mu/size)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>a character string indicating which proper scoring rule to apply.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>

<p>absolute tolerance for the null expectation and variance of
<code>"logs"</code> and <code>"rps"</code>. For the latter, see the note below.
Unused for <code>which = "dss"</code> (closed form).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>selection of the <code class="reqn">z</code>-statistic: <code>method = 2</code> refers to
the alternative test statistic <code class="reqn">Z_s^*</code> of Wei and Held (2014,
Discussion), which has been recommended for low counts.
<code>method = 1</code> corresponds to Equation 5 in Wei and Held (2014).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>unused (argument of the generic).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"htest"</code>,
which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the type of test
performed (including <code>which</code> scoring rule).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string naming the supplied <code>x</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the <code class="reqn">z</code>-statistic of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the number of predictions underlying the test, i.e., <code>length(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If the <a href="https://CRAN.R-project.org/package=gsl"><span class="pkg">gsl</span></a> package is installed, its implementations of the
Bessel and hypergeometric functions are used when calculating the null
expectation and variance of the <code>rps</code>.
These functions are faster and yield more accurate results (especially
for larger <code>mu</code>).
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer and Wei Wei
</p>


<h3>References</h3>

<p>Wei, W. and Held, L. (2014):
Calibration tests for count data.
<em>Test</em>, <b>23</b>, 787-805.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu &lt;- c(0.1, 1, 3, 6, pi, 100)
size &lt;- 0.1
set.seed(1)
y &lt;- rnbinom(length(mu), mu = mu, size = size)
calibrationTest(y, mu = mu, size = size) # p = 0.99
calibrationTest(y, mu = mu, size = 1) # p = 4.3e-05
calibrationTest(y, mu = 1, size = size) # p = 0.6959
calibrationTest(y, mu = 1, size = size, which = "rps") # p = 0.1286
</code></pre>


</div>