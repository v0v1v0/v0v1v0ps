<div class="container">

<table style="width: 100%;"><tr>
<td>apportion_polygon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribute streamflow depletion within a stream network using web distance Thiessen polygons.</h2>

<h3>Description</h3>

<p>Distribute streamflow depletion within a stream network using web distance Thiessen polygons.
</p>


<h3>Usage</h3>

<pre><code class="language-R">apportion_polygon(
  reach_dist_lon_lat,
  wel_lon,
  wel_lat,
  coord_crs,
  max_dist = Inf,
  min_frac = 0,
  reach_name = NULL,
  dist_name = NULL,
  lon_name = NULL,
  lat_name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reach_dist_lon_lat</code></td>
<td>
<p>data frame with four columns: <code>reach</code>, which is a grouping variable with
the name of each stream reach; <code>dist</code> which is the distance of a point on that stream reach to
the well of interest; <code>lon</code> which is the longitude of that point on the stream; and
<code>lat</code> which is the latitude of that point on the stream. There can (and likely will) be multiple rows per <code>reach</code>.
Columns can either be named exactly as defined here, or set using <code>reach_name</code>, <code>dist_name</code>, <code>lon_name</code>, and <code>lat_name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wel_lon</code></td>
<td>
<p>longitude of well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wel_lat</code></td>
<td>
<p>latitude of well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord_crs</code></td>
<td>
<p>coordinate reference system for sf or sfc object (create with <code>sf::st_crs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_dist</code></td>
<td>
<p>the maximum distance of a stream to be depleted; defaults to <code>Inf</code>, which means all reaches will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_frac</code></td>
<td>
<p>the minimum <code>frac_depletion</code> to be returned; defaults to <code>0</code>, which means all reaches will be considered.
If <code>min_frac &gt; 0</code> and some reaches have an estimated <code>frac_depletion &lt; min_frac</code>, depletion in those reaches will be set to 0
and that depletion will be reallocated based on the proportional depletion in the remaining reaches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reach_name</code></td>
<td>
<p>The name of the column in <code>reach_dist</code> indicating your stream reach grouping variable. If set to <code>NULL</code> (default), it will assume that the column name is <code>reach</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_name</code></td>
<td>
<p>The name of the column in <code>reach_dist</code> indicating your distance variable. If set to <code>NULL</code> (default), it will assume that the column name is <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_name</code></td>
<td>
<p>The name of the column in <code>reach_dist</code> indicating your longitude variable. If set to <code>NULL</code> (default), it will assume that the column name is <code>lon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_name</code></td>
<td>
<p>The name of the column in <code>reach_dist</code> indicating your latitude variable. If set to <code>NULL</code> (default), it will assume that the column name is <code>lat</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since analytical models assume the presence of 1 (or sometimes 2) linear streams, the <code>apportion_*</code> functions
can be used to distribute that depletion to various reaches within a real stream network. These geometric functions are described
in Zipper et al (2018), which found that <code>apportion_web</code> a weighting factor (<code>w</code>) of 2 produced the best results.
</p>


<h3>Value</h3>

<p>A data frame with two columns:
</p>

<dl>
<dt>reach</dt>
<dd>
<p>the grouping variable input in <code>reach_dist</code></p>
</dd>
<dt>frac_depletion</dt>
<dd>
<p>the proportion of streamflow depletion from the well occurring in that reach.</p>
</dd>
</dl>
<h3>References</h3>

<p>Zipper, SC, T Dallemagne, T Gleeson, TC Boerman, A Hartmann (2018). Groundwater Pumping Impacts
on Real Stream Networks: Testing the Performance of Simple Management Tools. Water Resources Research.
doi:10.1029/2018WR022707.
</p>


<h3>Examples</h3>

<pre><code class="language-R">rdll &lt;- prep_reach_dist(wel_lon = 295500, wel_lat = 4783200,
   stream_sf = stream_lines, reach_id = "reach", stream_pt_spacing = 5)
apportion_polygon(reach_dist_lon_lat = rdll, wel_lon = 295500, wel_lat = 4783200,
   max_dist = 5000, coord_crs = sf::st_crs(stream_lines))
apportion_polygon(reach_dist_lon_lat = rdll, wel_lon = 295500, wel_lat = 4783200,
   max_dist = 5000, min_frac = 0.05, coord_crs = sf::st_crs(stream_lines))
</code></pre>


</div>