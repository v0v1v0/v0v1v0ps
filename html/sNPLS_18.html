<div class="container">

<table style="width: 100%;"><tr>
<td>sNPLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a sNPLS model</h2>

<h3>Description</h3>

<p>Fits a N-PLS regression model imposing sparsity on <code>wj</code> and <code>wk</code> matrices
</p>


<h3>Usage</h3>

<pre><code class="language-R">sNPLS(
  XN,
  Y,
  ncomp = 2,
  threshold_j = 0.5,
  threshold_k = 0.5,
  keepJ = NULL,
  keepK = NULL,
  scale.X = TRUE,
  center.X = TRUE,
  scale.Y = TRUE,
  center.Y = TRUE,
  conver = 1e-16,
  max.iteration = 10000,
  silent = F,
  method = "sNPLS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XN</code></td>
<td>
<p>A three-way array containing the predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A matrix containing the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>Number of components in the projection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_j</code></td>
<td>
<p>Threshold value on Wj. Scaled between [0, 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold_k</code></td>
<td>
<p>Threshold value on Wk. scaled between [0, 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepJ</code></td>
<td>
<p>Number of variables to keep for each component, ignored if threshold_j is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepK</code></td>
<td>
<p>Number of 'times' to keep for each component, ignored if threshold_k is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.X</code></td>
<td>
<p>Perform unit variance scaling on X?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.X</code></td>
<td>
<p>Perform mean centering on X?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.Y</code></td>
<td>
<p>Perform unit variance scaling on Y?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.Y</code></td>
<td>
<p>Perform mean centering on Y?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conver</code></td>
<td>
<p>Convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iteration</code></td>
<td>
<p>Maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Show output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Select between L1 penalization (sNPLS), variable selection with Selectivity Ratio (sNPLS-SR) or variable selection with VIP (sNPLS-VIP)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A fitted sNPLS model
</p>


<h3>References</h3>

<p>C. A. Andersson and R. Bro. The N-way Toolbox for MATLAB Chemometrics &amp; Intelligent Laboratory Systems. 52 (1):1-4, 2000.
</p>
<p>Hervas, D. Prats-Montalban, J. M., Garcia-Ca√±averas, J. C., Lahoz, A., &amp; Ferrer, A. (2019). Sparse N-way partial least squares by L1-penalization. Chemometrics and Intelligent Laboratory Systems, 185, 85-91.
</p>


<h3>Examples</h3>

<pre><code class="language-R">X_npls&lt;-array(rpois(7500, 10), dim=c(50, 50, 3))

Y_npls &lt;- matrix(2+0.4*X_npls[,5,1]+0.7*X_npls[,10,1]-0.9*X_npls[,15,1]+
0.6*X_npls[,20,1]- 0.5*X_npls[,25,1]+rnorm(50), ncol=1)
#Discrete thresholding
fit &lt;- sNPLS(X_npls, Y_npls, ncomp=3, keepJ = rep(2,3) , keepK = rep(1,3))
#Continuous thresholding
fit2 &lt;- sNPLS(X_npls, Y_npls, ncomp=3, threshold_j=0.5, threshold_k=0.5)
#USe sNPLS-SR method
fit3 &lt;- sNPLS(X_npls, Y_npls, ncomp=3, threshold_j=0.5, threshold_k=0.5, method="sNPLS-SR")
</code></pre>


</div>