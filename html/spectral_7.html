<div class="container">

<table style="width: 100%;"><tr>
<td>envelope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the envelope of a band limited signal</h2>

<h3>Description</h3>

<p>The envelope of an amplitude modulated signal can be calculated by using the
Hilbert transform <code class="reqn">H(y)</code> of the signal or the analytic signal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">envelope(y)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector of the signal</p>
</td>
</tr></table>
<h3>Details</h3>

<p>An amplitude modulated function <code class="reqn">y(x) = A(x) * cos(\omega * x)</code> can be
demodulated as follows:
</p>
<p style="text-align: center;"><code class="reqn">A(x)^2 = y(x)^2 + H(y(x))^2</code>
</p>

<p>If the signal is not band limited, strange things can happen. See the ripple
at the edges in the example below. Pay attention, that the envelope is always
the real part of the returned value.
</p>


<h3>Value</h3>

<p>real valued envelope function of the signal
</p>


<h3>Examples</h3>

<pre><code class="language-R">## noisy signal with amplitude modulation
x &lt;- seq(0,1, length.out=2e2)

# original data
y &lt;- (abs(x-0.5))*sin(20*2*pi*x)

ye &lt;- base::Re(envelope(y))

# plot results
plot(x,y,type="l",lwd=1,col="darkgrey",lty=2,ylab="y",main="Spectral filtering")
lines(x,ye)
legend("bottomright",c("modulated","envelope"),col=c("grey","black"),lty=c(2,1))
</code></pre>


</div>