<div class="container">

<table style="width: 100%;"><tr>
<td>EqualityConstr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Equality constraints for overall shape and/or regression parameters and jacobian
</h2>

<h3>Description</h3>

<p>Setting of equality constraints on parameters. <br><code>heqa.SGB</code> sets the overall shape parameter to <code>shape1</code>. <br><code>heqb.SGB</code> sets specified regression parameters to 0.  <br><code>heqab.SGB</code> is a combination of both.  <br><code>heqa.SGB.jac</code>, <code>heqb.SGB.jac</code>, <code>heqab.SGB.jac</code> compute the corresponding Jacobians.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heqa.SGB(x, d, u, bound, shape1, ...)
heqa.SGB.jac(x, ...)
heqb.SGB(x, d, u, bound, shape1, index, ...)
heqb.SGB.jac(x, d, u, bound, shape1, index, ...)
heqab.SGB(x, d, u, bound, shape1, index, ...)
heqab.SGB.jac(x, d, u, bound, shape1, index, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>current vector of parameters (<code>shape1</code>, <code>coefi</code>, <code>shape2</code>) where
<code>shape1</code> is the overall shape, <code>coefi</code> is the vector of regression coefficients (see <code>initpar.SGB</code>) and <code>shape2</code> the vector of <code class="reqn">D</code> Dirichlet shape parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>data matrix of explanatory variables (without constant vector) <code class="reqn">(N \times m)</code>; <code class="reqn">N</code>: sample size, <code class="reqn">m</code>: number of explanatory variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>data matrix of compositions (independent variables) <code class="reqn">(N \times D)</code>; <code class="reqn">D</code>: number of parts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>

<p>not used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>

<p>chosen fixed value of the overall shape parameter. <br> 
Default <code>shape1</code> = 1 for <code>heqa.SGB</code> and <code>heqab.SGB</code>. <br><code>shape1</code> is not fixed in <code>heqb.SGB</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>vector of length equal to the number of fixed parameters; specifies the indices of the fixed components in the vector of parameters <code>x</code>, such that for <br><code>heqa.SGB, heqa.SGB.jac</code>: <code>index</code>=1. The fixed value of the overall shape parameter is <code>shape1</code> (by default 1). <br><code>heqb.SGB, heqb.SGB.jac</code>: <code>index</code>= c(...) with ... the indices of regression parameters to be set to 0. <br><code>heqab.SGB, heqab.SGB.jac</code>: <code>index</code>=c(1,...); <code>shape1</code> is the fixed value of the overall shape parameter, and ... the indices of the regression parameters to be set to 0. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are invoked by <code>regSGB</code> through the specification of the function name, <code>shape1</code> and/or <code>index</code>.
</p>


<h3>Value</h3>

<p><code>heqa.SGB</code>, <code>heqb.SGB</code>, <code>heqab.SGB</code>: vector of the same length as <code>index</code> specifying the current value of <code>x[index]</code> or <code>x[1]-shape1</code>, where <code>x</code> is the current vector of parameters. It should be near zero at convergence of the regression algorithm. <br><code>heqa.SGB.jac</code>, <code> heqb.SGB.jac</code>, <code> heqab.SGB.jac</code>: the corresponding jacobian matrices of dimensions <code class="reqn">length(index) \times length(x)</code>.
</p>


<h3>See Also</h3>

<p><code>regSGB</code>, <code>summary.regSGB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## parameter vector for a 3 parts composition with one explanatory variable (+ intercept):
x &lt;- c(1,3.2,0.04,0.05,6,7:9)

## shape1 fixed to 1.5:
heqa.SGB(x,d,u,bound,1.5)
heqa.SGB.jac(x)

## Parameters 3 (first slope) and 4 (second intercept) fixed to 0:
heqb.SGB(x,d,u,bound,shape1,c(3,4))
heqb.SGB.jac(x,d,u,bound,shape1,c(3,4))

## Parameters 1, 3, 4 fixed to 1.5, 0, 0 respectively:
heqab.SGB(x,d,u,bound,1.5,c(1,3,4))
heqab.SGB.jac(x,d,u,bound,1.5,c(1,3,4))
</code></pre>


</div>