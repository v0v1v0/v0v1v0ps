<div class="container">

<table style="width: 100%;"><tr>
<td>santaR_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a SANTAObj for a variable</h2>

<h3>Description</h3>

<p>Generate a <em>SANTAObj</em> containing all the splines model for individual and group time evolutions. Once all the splines representing individual and group evolutions are fitted, all time-points are back-projected (projected) and employed in subsequent analysis in place of the input measurements (functional approach). A grouping can be provided to separate individuals and compare trajectories: any number of groups can be provided, but comparision of group trajectories can only be executed between 2 groups.
</p>

<ul>
<li>
<p> Individual trajectories with less than 4 time-points are rejected due to constraints on <code>smooth.spline</code> fitting <em>(number of time-points &lt; 4)</em>.
</p>
</li>
<li>
<p> Individual trajectories with less time-points than <em>df</em> are rejected due to constraints on <code>smooth.spline</code> fitting <em>(number of time-points &lt; df)</em>.
</p>
</li>
<li>
<p> Rejected individual trajectories are not taken into account for mean curves calculations.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">santaR_fit(inputMatrix, df, grouping = NA, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputMatrix</code></td>
<td>
<p><code>data.frame</code> of measurements for each IND x TIME as generated by <code>get_ind_time_matrix</code>. Rows are unique Individual IDs and columns unique measurement Time. Pairs of (IND,TIME) without a measurement are left as NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>(float) Degree of freedom to employ for fitting the <code>smooth.spline</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>NA or a <code>data.frame</code> with 2 columns (ind and group) listing as rows each unique Individual ID and the corresponding group membership, as generated by <code>get_grouping</code>. Default is NA for no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(bool) If TRUE output the progress of fitting. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <em>SANTAObj</em> containing all the spline models with individual and group time evolutions, for further analysis.
</p>


<h4>Details:</h4>

<p>The returned <em>SANTAObj</em> is structured as follow:
</p>

<table>
<tr>
<td style="text-align: left;">
    SANTAObj </td>
<td style="text-align: left;"> santaR object for futher analysis</td>
</tr>
<tr>
<td style="text-align: left;">
     </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$df </td>
<td style="text-align: left;"> input degree of freedom</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$CBand$status </td>
<td style="text-align: left;"> Confidence Bands for group mean curve calculated <em>(TRUE or FALSE)</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$CBand$nBoot </td>
<td style="text-align: left;"> parameter, number or bootstrap rounds for calculation of the group mean curve confidence bands</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$CBand$alpha </td>
<td style="text-align: left;"> parameter, confidence of the group mean curve band</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.dist$status </td>
<td style="text-align: left;"> <em>p</em>-value distance calculated <em>(TRUE or FALSE)</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.dist$nPerm </td>
<td style="text-align: left;"> parameter, number of permutations for calculation of distance <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.dist$alpha </td>
<td style="text-align: left;"> parameter, confidence on the bootstrapped <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.fit$status </td>
<td style="text-align: left;"> <em>p</em>-value fitting calculated <em>(TRUE or FALSE)</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.fit$nPerm </td>
<td style="text-align: left;"> parameter, number of permutations for calculation of fitting <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$properties$pval.fit$alpha </td>
<td style="text-align: left;"> parameter, confidence on the bootstrapped <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
     </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$inputData </td>
<td style="text-align: left;"> <em>inputMatrix</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$cleanData.in </td>
<td style="text-align: left;"> only kept individuals INPUT values <em>(equivalent to inputMatrix - rejected)</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$cleanData.pred </td>
<td style="text-align: left;"> only kept individuals PREDICTED values on Ind splines</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$grouping </td>
<td style="text-align: left;"> grouping vector given as input</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$meanCurve </td>
<td style="text-align: left;"> spline fit over all kept datapoint <em>(cleanData.pred)</em> | <code>smooth.spline</code> object</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.curveCorr </td>
<td style="text-align: left;"> Pearson correlation coefficient between the two group curves, to detect highly correlated group shapes if required.</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.dist </td>
<td style="text-align: left;"> <em>p</em>-value between groups based on distance between groupMeanCurves</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.dist.l </td>
<td style="text-align: left;"> lower bound confidence interval on <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.dist.u </td>
<td style="text-align: left;"> upper bound confidence interval on <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.fit </td>
<td style="text-align: left;"> <em>p</em>-value between groups based on groupMeanCurves fitting</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.fit.l </td>
<td style="text-align: left;"> lower bound confidence interval on <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$general$pval.fit.u </td>
<td style="text-align: left;"> upper bound confidence interval on <em>p</em>-value</td>
</tr>
<tr>
<td style="text-align: left;">
     </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups </td>
<td style="text-align: left;"> list of group information</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$rejectedInd </td>
<td style="text-align: left;"> list of rejected individual <em>(#tp &lt; 4 or df)</em> | data</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$curveInd </td>
<td style="text-align: left;"> list of spline fit | <code>smooth.spline</code> object</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$groupMeanCurve </td>
<td style="text-align: left;"> spline fit over groupData.pred | <code>smooth.spline</code> object</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$point.in </td>
<td style="text-align: left;"> all group points INPUT values (x,y) [kept individuals]</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$point.pred </td>
<td style="text-align: left;"> all group points PREDICTED values on Ind splines (x,y)</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$groupData.in </td>
<td style="text-align: left;"> only individuals from this group INPUT value (IND x TIME)</td>
</tr>
<tr>
<td style="text-align: left;">
    SANTAObj$groups$groupData.pred </td>
<td style="text-align: left;"> only individuals from this group PREDICTED values on Ind splines (x,y)
  </td>
</tr>
</table>
<h3>See Also</h3>

<p>Other Analysis: 
<code>get_grouping()</code>,
<code>get_ind_time_matrix()</code>,
<code>santaR_CBand()</code>,
<code>santaR_auto_fit()</code>,
<code>santaR_auto_summary()</code>,
<code>santaR_plot()</code>,
<code>santaR_pvalue_dist()</code>,
<code>santaR_pvalue_fit()</code>,
<code>santaR_start_GUI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 56 measurements, 8 subjects, 7 unique time-points
Yi             &lt;- acuteInflammation$data$var_1
ind            &lt;- acuteInflammation$meta$ind
time           &lt;- acuteInflammation$meta$time
group          &lt;- acuteInflammation$meta$group
grouping       &lt;- get_grouping(ind, group)
inputMatrix    &lt;- get_ind_time_matrix(Yi, ind, time)
resultSANTAObj &lt;- santaR_fit(inputMatrix, df=5, grouping=grouping, verbose=TRUE)

</code></pre>


</div>