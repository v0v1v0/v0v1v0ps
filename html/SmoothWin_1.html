<div class="container">

<table style="width: 100%;"><tr>
<td>expWeight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
This function computes the smooth windowing weights
</h2>

<h3>Description</h3>

<p>The symmetric weight generating function (SWGF). This function computes the exponential weights/kernel (soft windowing weights) for different shapes (k)  and bandwidth (l) and plots the weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  expWeight(
      t                        ,
      k                        ,
      l                        ,
      m = 0                    ,
      direction = c(1, 1)      ,
      plot = FALSE             ,
      zeroCompensation = 0     ,
      cdf   = plogis           ,
      progress         = FALSE ,
      ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>

<p>Vector of numeric time. A vector of positive continuous values for time 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>A single positive value for sharpness
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>

<p>A single non-negative value for bandwidth
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>Vector of indices. The index of the modes on 't' (modes are the peak of the windows)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>

<p>Vector of two numeric values. A vector of the form on (Left,right). The first element specifies the speed of expansion of the window(s) from the left and the second value for the right expansion. Setting to (0,1) and (1,0) lead to right and left expansions of the windows respectively. Default (1,1) that is the window(s) expand symmetrically from both sides. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Logical flag. Setting to TRUE shows a plot of the weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroCompensation</code></td>
<td>

<p>Single non-negative value. Setting to any non-negative value would replace all (weights =&lt; zeroCompensation) with zeroCompensation. Default 0 (zero)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf</code></td>
<td>

<p>A cdf function preferably symmetric. The cdf function is used for the (window) weight generating function. The function must have two parameters precisely a location such as mean and a scale. Standard cdf functions such as pnorm, pcauchy and plogis (default) can be used. For an example of custom made function we define uniform function as below:<br><br></p>
<p style="text-align: center;"><code class="reqn">
      punif0 = function(x,mean=0.5,sd=sqrt(1/12)){
             a = mean - sqrt(3) *sd;
             b = mean + sqrt(3) *sd;
             r =  punif(q = x,min = a,max = b) ;
             return(r)    
          }
    </code>
</p>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Logical flag. Setting to TRUE shows the progress of the function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters that can be passed to the 'plot()' function such as pch, colour etc.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of weights
</p>


<h3>Author(s)</h3>

<p>Hamed Haselimashhadi &lt;hamedhm@ebi.ac.uk&gt;
</p>


<h3>See Also</h3>

<p><code>SmoothWin</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  par(mfrow = c(4, 1))
  ##################################################
  # Example 1 - no merging happends between windows
  ##################################################
  weight = expWeight(
    t = 1:100                                       ,
    k = 5                                           ,
    l = 10                                          ,
    m = c(25, 50, 75)                               ,
    plot = TRUE                                     ,
    ### Passed parameters to the plot function
    type = 'l'                                      ,
    lty = 2                                         ,
    lwd = 3                                         ,
    main = '1. If windows do not intersect, then wont merge! (l=10, k=5)'
  )
  
  ##################################################
  # Example 2 - merging in windows
  ##################################################
  weight = expWeight(
    t = 1:100                                       ,
    k = 5                                           ,
    l = 15                                          ,
    m = c(25, 50, 75)                               ,
    plot = TRUE                                     ,
    ### Passed parameters to the plot function
    type = 'l'                                      ,
    lty = 2                                         ,
    lwd = 3                                         ,
    main = '2. If windows intersect, then merge! (l=15, k=5)'
  )
  
  ##################################################
  # Example 3.1  - partial merging in windows
  ##################################################
  weight = expWeight(
    t = 1:100                                       ,
    k = 1                                           ,
    l = 12                                          ,
    m = c(25, 50, 75)                               ,
    plot = TRUE                                     ,
    ### Passed parameters to the plot function
    type = 'l'                                      ,
    lty = 2                                         ,
    lwd = 3                                         ,
    main = '3.1 If windows intersect with small k, then partially merge! (l=12, k=1)'
  )
  
  ##################################################
  # Example 3.2  - partial merging in windows
  ##################################################
    weight = expWeight(
    t = 1:100                                       ,
    k = .1                                           ,
    l = 12                                          ,
    m = c(25, 50, 75)                               ,
    plot = TRUE                                     ,
    ### Passed parameters to the plot function
    type = 'l'                                      ,
    lty = 2                                         ,
    lwd = 3                                         ,
    main = '3.2 If windows intersect with small k, then partially merge! (l=12, k=0.1)'
  )
  
</code></pre>


</div>