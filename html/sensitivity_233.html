<div class="container">

<table style="width: 100%;"><tr>
<td>sobolowen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo Estimation of Sobol' Indices (improved formulas of Owen (2013)</h2>

<h3>Description</h3>

<p><code>sobolowen</code> implements the Monte Carlo estimation of
the Sobol' indices for both first-order and total indices at the same
time (alltogether <code class="reqn">2p</code> indices). Take as input 3 independent matrices.
These are called the Owen estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sobolowen(model = NULL, X1, X2, X3, nboot = 0, conf = 0.95, varest = 2, ...)
## S3 method for class 'sobolowen'
tell(x, y = NULL, return.var = NULL, varest = 2, ...)
## S3 method for class 'sobolowen'
print(x, ...)
## S3 method for class 'sobolowen'
plot(x, ylim = c(0, 1), ...)
## S3 method for class 'sobolowen'
ggplot(data, mapping = aes(), ylim = c(0, 1), ..., environment
                 = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a function, or a model with a <code>predict</code> method,
defining the model to analyze.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>the first random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>the second random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X3</code></td>
<td>
<p>the third random sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level for bootstrap confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>choice for the variance estimator for the denominator of
the Sobol' indices. varest=1 is for a classical estimator.
varest=2 (default) is for the estimator proposed in Janon et al. (2012).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of class <code>"sobolowen"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of class <code>"sobolowen"</code> storing the state of the
sensitivity study (parameters, data, estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of model responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.var</code></td>
<td>
<p>a vector of character strings giving further
internal variables names to store in  the output object <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-coordinate plotting limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not specified, 
must be supplied in each layer added to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>[Deprecated] Used prior to tidy evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments for <code>model</code> which are passed
unchanged each time it is called</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>sobolowen</code> returns a list of class <code>"sobolowen"</code>, containing all
the input arguments detailed before, plus the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>data.frame</code> containing the design of experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the estimations of Variances of the Conditional Expectations
(VCE) with respect to each factor and also with respect to the
complementary set of each factor ("all but <code class="reqn">X_i</code>").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the estimations of the Sobol' first-order indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the estimations of the Sobol' total sensitivity indices.</p>
</td>
</tr>
</table>
<p>Users can ask more ouput variables with the argument
<code>return.var</code> (for example, bootstrap outputs <code>V.boot</code>,
<code>S.boot</code> and <code>T.boot</code>).
</p>


<h3>Author(s)</h3>

<p>Taieb Touati and Bernardo Ramos
</p>


<h3>References</h3>

<p>A. Owen, 2013, <em>Better estimations of small Sobol' sensitivity indices</em>, 
ACM Transactions on Modeling and Computer Simulations (TOMACS), 23(2), 11.
</p>
<p>Janon, A., Klein T., Lagnoux A., Nodet M., Prieur C. (2012), Asymptotic 
normality and efficiency of two Sobol index estimators. Accepted in 
ESAIM: Probability and Statistics.
</p>


<h3>See Also</h3>

<p><code>sobol, sobol2002, sobolSalt, sobol2007, soboljansen, sobolmartinez, sobolEff</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Test case : the non-monotonic Sobol g-function

# The method of sobolowen requires 3 samples
# There are 8 factors, all following the uniform distribution
# on [0,1]

library(boot)
n &lt;- 1000
X1 &lt;- data.frame(matrix(runif(8 * n), nrow = n))
X2 &lt;- data.frame(matrix(runif(8 * n), nrow = n))
X3 &lt;- data.frame(matrix(runif(8 * n), nrow = n))

# sensitivity analysis


x &lt;- sobolowen(model = sobol.fun, X1, X2, X3, nboot = 10) # put nboot=100
print(x)
plot(x)

library(ggplot2)
ggplot(x)

</code></pre>


</div>