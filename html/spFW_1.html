<div class="container">

<table style="width: 100%;"><tr>
<td>HFWM_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation Function for Hierarchical Finlay-Wilkinson Model</h2>

<h3>Description</h3>

<p>This function ignores spatial effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HFWM_est(Y, VAR, ENV, kin_info = FALSE, A = NULL, env_info = FALSE,
  Z = NULL, inits = NULL, hyper_para = NULL, M_iter = 5000,
  burn_in = 3000, thin = 5, save_chain = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A length-N numerical response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR</code></td>
<td>
<p>A length-N factor/character vector indicating the genotype information of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENV</code></td>
<td>
<p>A length-N factor/character vector indicating the field information of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kin_info</code></td>
<td>
<p>A logical parameter controling if to use kinship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>kinship matrix, give value only if kin_info = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_info</code></td>
<td>
<p>A logical parameter controling whether to use environmental covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>environmental covariates matrix with rownames = field names, give value only if env_info = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>initial values, default is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper_para</code></td>
<td>
<p>hyper-parameter values, default is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_iter</code></td>
<td>
<p>Total iteration number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>Burn in number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_chain</code></td>
<td>
<p>A logical parameter controling whether to save MCMC chain: 'Chains.rds' in current working directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed value</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Mean estimates and RMSE value
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(spFW)

# load data
data(spFW_example_data)
Y &lt;- spFW_example_data$yield
VAR &lt;- spFW_example_data$geno
ENV &lt;- spFW_example_data$loc
COOR &lt;- spFW_example_data[,c(4,5)]

# run model
fit0 &lt;- HFWM_est(Y, VAR, ENV, M_iter = 1000, burn_in = 500, thin = 5)

# plot estimated Y
plot(Y, fit0$yhat)

</code></pre>


</div>