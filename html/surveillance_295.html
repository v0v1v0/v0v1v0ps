<div class="container">

<table style="width: 100%;"><tr>
<td>twinstim_profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Profile Likelihood Computation and Confidence Intervals for
<code>twinstim</code> objects
</h2>

<h3>Description</h3>

<p>Function to compute estimated and profile likelihood based confidence
intervals for <code>twinstim</code> objects. Computations might be cumbersome!
</p>
<p>WARNING: the implementation is not well tested, simply uses
<code>optim</code> (ignoring optimizer settings from the original fit),
and does not return the complete set of coefficients at each grid point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'twinstim'
profile(fitted, profile, alpha = 0.05,
        control = list(fnscale = -1, maxit = 100, trace = 1),
        do.ltildeprofile=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>

<p>an object of class <code>"twinstim"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>

<p>a list with elements being numeric vectors of length 4.  These vectors must
have the form <code>c(index, lower, upper, gridsize)</code>.
</p>

<dl>
<dt>
<code>index</code>:</dt>
<dd>
<p>index of the parameter to be profiled in the vector <code>coef(fitted)</code>.
</p>
</dd>
<dt>
<code>lower, upper</code>:</dt>
<dd>
<p>lower/upper limit of the grid on which the profile log-likelihood is
evaluated. Can also be <code>NA</code> in which case <code>lower/upper</code> equals 
the lower/upper bound of the respective 0.3 % Wald confidence interval
(+-3*se).
</p>
</dd>
<dt>
<code>gridsize</code>:</dt>
<dd>
<p>grid size of the equally spaced grid between lower and upper.  Can also
be 0 in which case the profile log-likelihood for this parameter is not 
evaluated on a grid.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p><code class="reqn">(1-\alpha)\%</code> profile likelihood based confidence
intervals are computed.  If alpha &lt;= 0, then no confidence intervals are
computed. This is currently not implemented.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>control object to use in <code>optim</code> for the profile log-likelihood
computations. It might be necessary to control <code>maxit</code> or
<code>reltol</code> in order to obtain results in finite time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.ltildeprofile</code></td>
<td>
<p>If <code>TRUE</code> calculate profile likelihood as
well. This might take a while, since an optimisation for all other
parameters has to be performed. Useful for likelihood based
confidence intervals. Default: <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>unused (argument of the generic).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with profile log-likelihood evaluations on the grid, and
– not implemented yet –
highest likelihood and Wald confidence intervals.
The argument <code>profile</code> is also returned.
</p>


<h3>Author(s)</h3>

<p>Michael Höhle
</p>


<h3>Examples</h3>

<pre><code class="language-R"># profiling takes a while
## Not run: 
#Load the twinstim model fitted to the IMD data
data("imdepi", "imdepifit")
# for profiling we need the model environment
imdepifit &lt;- update(imdepifit, model=TRUE)

#Generate profiling object for a list of parameters for the new model
names &lt;- c("h.(Intercept)","e.typeC")
coefList &lt;- lapply(names, function(name) {
  c(pmatch(name,names(coef(imdepifit))),NA,NA,11)
})

#Profile object (necessary to specify a more loose convergence
#criterion). Speed things up by using do.ltildeprofile=FALSE (the default)
prof &lt;- profile(imdepifit, coefList,
  control=list(reltol=0.1, REPORT=1), do.ltildeprofile=TRUE)

#Plot result for one variable
par(mfrow=c(1,2))
for (name in names) {
  with(as.data.frame(prof$lp[[name]]),
       matplot(grid,cbind(profile,estimated,wald),
               type="l",xlab=name,ylab="loglik"))
  legend(x="bottomleft",c("profile","estimated","wald"),lty=1:3,col=1:3)
}

## End(Not run)
</code></pre>


</div>