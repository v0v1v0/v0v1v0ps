<div class="container">

<table style="width: 100%;"><tr>
<td>sim.seqtest.cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of the sequential triangular test for Pearson's correlation coefficient</h2>

<h3>Description</h3>

<p>This function performs a statistical simulation for the sequential triangular test
for Pearson's correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.seqtest.cor(rho.sim, k, rho, alternative = c("two.sided", "less", "greater"),
                delta, alpha = 0.05, beta = 0.1, runs = 1000,
                m.x = 0, sd.x = 1, m.y = 0, sd.y = 1,
                digits = 3, output = TRUE, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho.sim</code></td>
<td>
<p>simulated population correlation coefficient, <code class="reqn">\rho</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>an integer or a numerical vector indicating the number of observations in each sub-sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a number indicating the correlation coefficient under the null hypothesis, <code class="reqn">\rho</code>.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>minimum difference to be detected, <code class="reqn">\delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>type-I-risk, <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>an integer or a numerical vector indicating the type-II-risk, <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>numer of simulation runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.x</code></td>
<td>
<p>population mean of simulated vector x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.x</code></td>
<td>
<p>population standard deviation of simulated vector x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.y</code></td>
<td>
<p>population mean of simulated vector y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.y</code></td>
<td>
<p>population standard deviation of simulated vector y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer indicating the number of decimal places to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>logical: if <code>TRUE</code>, output is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code>, plot is shown.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to determine the optimal k, simulation is conducted under the H0 condition, i.e., <code>rho.sim</code> = <code>rho</code>.
Simulation is carried out for a sequence of k values to seek for the optimal k where the empirical alpha is as close
as possible to the nominal alpha.
In order to determine optimal beta (with fixed k), simulation is conudcted under the H1 condition,
i.e., <code>rho.sim</code> = <code>rho</code> + <code>delta</code> or <code>rho.sim</code> = <code>rho</code> - <code>delta</code>.
Simulation is carried out for a sequencen of beta values to seek for the optimal beta where the empirical beta
is as close as possible to the nominal beta.
</p>
<p>In order to specify a one-sided test, argument <code>alternative</code> has to be used (i.e., two-sided tests are conducted by default).
Specifying argument <code>alternative = "less"</code> conducts the simulation for the null hypothesis, H0: <code class="reqn">\rho</code> &gt;= <code class="reqn">\rho</code>.0
with the alternative hypothesis, H1: <code class="reqn">\rho</code> &lt; <code class="reqn">\rho</code>.0; specifying argument <code>alternative = "greater"</code> conducts the simluation
for the null hypothesis, H0: <code class="reqn">\rho</code> &lt;= <code class="reqn">\rho</code>.0 with the alternative hypothesis, H1: <code class="reqn">\rho</code> &gt; <code class="reqn">\rho</code>.0.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>sim.seqtest.cor</code> with following entries:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>call</code>      </td>
<td style="text-align: left;"> function call </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>spec</code>      </td>
<td style="text-align: left;"> specification of function arguments </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>simres</code>    </td>
<td style="text-align: left;"> list with results (for each k or beta) for each run </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>res</code>       </td>
<td style="text-align: left;"> data.frame with results, i.e., k, alpha.nom (nominal alpha),
                        alpha.emp (estimated empirical alpha), beta.nom (nominal beta),
                        beta.emp (empirica beta), p.H0 (proportion decision = H0),
                        p.H1 (proportion decision = H1), AVN (average number of V),
                        ASN (average number of sample pairs) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takuya Yanagida <a href="mailto:takuya.yanagida@univie.ac.at">takuya.yanagida@univie.ac.at</a>,
</p>


<h3>References</h3>

<p>Schneider, B., Rasch, D., Kubinger, K. D., &amp; Yanagida, T. (2015).
A Sequential triangular test of a correlation coefficient's null-hypothesis: 0 <code class="reqn">&lt; \rho \le \rho</code>0.
<em>Statistical Papers, 56</em>, 689-699.
</p>


<h3>See Also</h3>

<p><code>seqtest.cor</code>, <code>plot.sim.seqtest.cor</code>, <code>print.sim.seqtest.cor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#---------------------------------------------
# Determine optimal k and nominal type-II-risk
# H0: rho &lt;= 0.3, H1: rho &gt; 0.3
# alpha = 0.01, beta = 0.05, delta = 0.25

# Step 1: Determine the optimal size of subsamples (k)

sim.seqtest.cor(rho.sim = 0.3, k = seq(4, 16, by = 1), rho = 0.3,
                alternative = "greater",
                delta = 0.25, alpha = 0.05, beta = 0.05,
                runs = 10000, plot = TRUE)

# Step 2: Determine the optimal nominal type-II-risk based on
#         the optimal size of subsamples (k) from step 1

sim.seqtest.cor(rho.sim = 0.55, k = 16, rho = 0.3,
                alternative = "greater",
                delta = 0.25, alpha = 0.05, beta = seq(0.05, 0.15, by = 0.01),
                runs = 10000, plot = TRUE)

## End(Not run)
</code></pre>


</div>