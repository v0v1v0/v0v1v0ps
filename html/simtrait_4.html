<div class="container">

<table style="width: 100%;"><tr>
<td>herit_loci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Per-locus heritability contribution from allele frequency and causal coefficient</h2>

<h3>Description</h3>

<p>Calculates the vector of per-locus heritability values, with each causal locus <code>i</code> calculated as
<code>h_i^2 = 2 * p_i * ( 1 - p_i ) * beta_i^2 / sigma_sq</code>,
where <code>p_i</code> is the ancestral allele frequency,
<code>beta_i</code> is the causal coefficient,
and <code>sigma_sq</code> is the trait variance scale.
These are all assumed to be true parameters (not estimated).
These per-locus heritabilities equal per-locus effect sizes divided by <code>sigma_sq</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">herit_loci(p_anc, causal_coeffs, causal_indexes = NULL, sigma_sq = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p_anc</code></td>
<td>
<p>The ancestral allele frequency vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causal_coeffs</code></td>
<td>
<p>The vector of causal coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causal_indexes</code></td>
<td>
<p>The optional vector of causal indexes.
If <code>NULL</code> (default), <code>p_anc</code> and <code>causal_coeffs</code> are assumed to be for causal loci only (must be the same length).
If non-<code>NULL</code>, <code>causal_loci</code> is used to subset both <code>p_anc</code> and <code>causal_coeffs</code> as needed: if each of these vectors is longer than <code>causal_loci</code>, then it is subset; otherwise they must have equal lengths as <code>causal_loci</code> or an error is thrown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_sq</code></td>
<td>
<p>The parametric variance factor of the trait (default 1).
This factor corresponds to the variance of an outbred individual.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The vector of per-locus heritability contributions.
The sum of these values gives the overall heritability.
This value can be greater than one (or wrong, more generally) if <code>sigma_sq</code> is misspecified.
</p>


<h3>See Also</h3>

<p><code>sim_trait()</code> generates random traits by drawing causal loci and their coefficients to fit a desired heritability.
<code>cov_trait()</code> calculates the covariance structure of the random traits.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create toy random data
m_loci &lt;- 10
# ancestral allele frequencies
p_anc &lt;- runif( m_loci )
# causal loci
causal_coeffs &lt;- rnorm( m_loci ) / m_loci
# resulting heritability contributions vector
herit_loci( p_anc, causal_coeffs )

</code></pre>


</div>