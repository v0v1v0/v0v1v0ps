<div class="container">

<table style="width: 100%;"><tr>
<td>shmulateTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate mutations in a lineage tree</h2>

<h3>Description</h3>

<p><code>shmulateTree</code> returns a set of simulated sequences generated from an input 
sequence and a lineage tree. The input sequence is used to replace the most recent 
common ancestor (MRCA) node of the <code>igraph</code> object defining the lineage tree. 
Sequences are then simulated with mutations corresponding to edge weights in the tree. 
Sequences will not be generated for groups of nodes that are specified to be excluded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shmulateTree(
  sequence,
  graph,
  targetingModel = HH_S5F,
  field = NULL,
  exclude = NULL,
  junctionWeight = NULL,
  start = 1,
  end = nchar(sequence)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>
<p>string defining the MRCA sequence to seed mutations from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p><code>igraph</code> object defining the seed lineage tree, with 
vertex annotations, whose edges are to be recreated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetingModel</code></td>
<td>
<p>5-mer TargetingModel object to be used for computing 
probabilities of mutations at each position. Defaults to
HH_S5F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>field</code></td>
<td>
<p>annotation to use for both unweighted path length exclusion 
and consideration as the MRCA node. If <code>NULL</code> do not 
exclude any nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>vector of annotation values in <code>field</code> to exclude from 
potential MRCA set. If <code>NULL</code> do not exclude any nodes.
Has no effect if <code>field=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>junctionWeight</code></td>
<td>
<p>fraction of the nucleotide sequence that is within the 
junction region. When specified this adds a proportional 
number of mutations to the immediate offspring nodes of the 
MRCA. Requires a value between 0 and 1. If <code>NULL</code> then 
edge weights are unmodified from the input <code>graph</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Initial position in <code>sequence</code> where mutations can 
be introduced. Default: 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>Last position in <code>sequence</code> where mutations can 
be introduced. Default: last position (sequence length).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> of simulated sequences with columns:
</p>

<ul>
<li> <p><code>name</code>:      name of the corresponding node in the input 
<code>graph</code>.  
</p>
</li>
<li> <p><code>sequence</code>:  mutated sequence.
</p>
</li>
<li> <p><code>distance</code>:  Hamming distance of the mutated sequence from 
the seed <code>sequence</code>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>See shmulateSeq for imposing mutations on a single sequence. 
See HH_S5F and MK_RS5NF for predefined 
TargetingModel objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example lineage and define example MRCA
data(ExampleTrees, package="alakazam")
graph &lt;- ExampleTrees[[17]]
sequence &lt;- "NGATCTGACGACACGGCCGTGTATTACTGTGCGAGAGATAGTTTA"

# Simulate using the default human 5-mer targeting model
shmulateTree(sequence, graph)

# Simulate using the mouse 5-mer targeting model
# Exclude nodes without a sample identifier
# Add 20% mutation rate to the immediate offsprings of the MRCA
shmulateTree(sequence, graph, targetingModel=MK_RS5NF,
             field="sample_id", exclude=NA, junctionWeight=0.2)
 
</code></pre>


</div>