<div class="container">

<table style="width: 100%;"><tr>
<td>Jest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the J-function</h2>

<h3>Description</h3>

<p>Estimates the summary function <code class="reqn">J(r)</code> for a point pattern in a 
window of arbitrary shape.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  Jest(X, ..., eps=NULL, r=NULL, breaks=NULL, correction=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The observed point pattern, 
from which an estimate of <code class="reqn">J(r)</code> will be computed.
An object of class <code>"ppp"</code>, or data
in any format acceptable to <code>as.ppp()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>the resolution of the discrete approximation to Euclidean distance
(see below). There is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>vector of values for the argument <code class="reqn">r</code> at which <code class="reqn">J(r)</code> 
should be evaluated. There is a sensible default.
First-time users are strongly advised not to specify this argument.
See below for important conditions on <code>r</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>This argument is for internal use only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>

<p>Optional. Character string specifying the choice of edge
correction(s) in <code>Fest</code> and <code>Gest</code>.
See Details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">J</code> function (Van Lieshout and Baddeley, 1996)
of a stationary point process is defined as 
</p>
<p style="text-align: center;"><code class="reqn">J(r) = \frac{1-G(r)}{1-F(r)} </code>
</p>

<p>where <code class="reqn">G(r)</code> is the nearest neighbour distance distribution
function of the point process (see <code>Gest</code>) 
and <code class="reqn">F(r)</code> is its empty space function (see <code>Fest</code>).
</p>
<p>For a completely random (uniform Poisson) point process,
the <code class="reqn">J</code>-function is identically equal to <code class="reqn">1</code>. 
Deviations <code class="reqn">J(r) &lt; 1</code> or <code class="reqn">J(r) &gt; 1</code>
typically indicate spatial clustering or spatial regularity, respectively.
The <code class="reqn">J</code>-function is one of the few characteristics that can be
computed explicitly for a wide range of point processes. 
See Van Lieshout and Baddeley (1996), Baddeley et al (2000),
Thonnes and Van Lieshout (1999)  for further information.
</p>
<p>An estimate of <code class="reqn">J</code> derived from a spatial point pattern dataset
can be used in exploratory data analysis and formal inference
about the pattern. The estimate of <code class="reqn">J(r)</code> is compared against the 
constant function <code class="reqn">1</code>.
Deviations <code class="reqn">J(r) &lt; 1</code> or <code class="reqn">J(r) &gt; 1</code>
may suggest spatial clustering or spatial regularity, respectively.
</p>
<p>This algorithm estimates the <code class="reqn">J</code>-function
from the point pattern <code>X</code>. It assumes that <code>X</code> can be treated
as a realisation of a stationary (spatially homogeneous) 
random spatial point process in the plane, observed through
a bounded window. 
The window (which is specified in <code>X</code> as <code>Window(X)</code>)
may have arbitrary shape. 
</p>
<p>The argument <code>X</code> is interpreted as a point pattern object 
(of class <code>"ppp"</code>, see <code>ppp.object</code>) and can
be supplied in any of the formats recognised by
<code>as.ppp()</code>. 
</p>
<p>The functions <code>Fest</code> and <code>Gest</code> are called to 
compute estimates of <code class="reqn">F(r)</code> and <code class="reqn">G(r)</code> respectively.
These estimates are then combined by simply taking the ratio
<code class="reqn">J(r) = (1-G(r))/(1-F(r))</code>.
</p>
<p>In fact several different estimates are computed
using different edge corrections (Baddeley, 1998).
</p>
<p>The Kaplan-Meier estimate (returned as <code>km</code>) is the ratio 
<code>J = (1-G)/(1-F)</code> of the Kaplan-Meier estimates of
<code class="reqn">1-F</code> and <code class="reqn">1-G</code> computed by
<code>Fest</code> and <code>Gest</code> respectively.
This is computed if <code>correction=NULL</code> or if <code>correction</code>
includes <code>"km"</code>.
</p>
<p>The Hanisch-style estimate (returned as <code>han</code>) is the ratio 
<code>J = (1-G)/(1-F)</code> where <code>F</code> is the Chiu-Stoyan estimate of
<code class="reqn">F</code> and <code>G</code> is the Hanisch estimate of <code class="reqn">G</code>.
This is computed if <code>correction=NULL</code> or if <code>correction</code>
includes <code>"cs"</code> or <code>"han"</code>.
</p>
<p>The reduced-sample or border corrected estimate
(returned as <code>rs</code>) is
the same ratio <code>J = (1-G)/(1-F)</code>
of the border corrected estimates. 
This is computed if <code>correction=NULL</code> or if <code>correction</code>
includes <code>"rs"</code> or <code>"border"</code>.
</p>
<p>These edge-corrected estimators are slightly biased for <code class="reqn">J</code>, 
since they are ratios
of approximately unbiased estimators.
The logarithm of the
Kaplan-Meier estimate is exactly unbiased for <code class="reqn">\log J</code>.
</p>
<p>The uncorrected estimate (returned as <code>un</code>
and computed only if <code>correction</code> includes <code>"none"</code>)
is the ratio <code>J = (1-G)/(1-F)</code>
of the uncorrected (“raw”) estimates of the survival functions
of <code class="reqn">F</code> and <code class="reqn">G</code>,
which are the empirical distribution functions of the 
empty space distances <code>Fest(X,...)$raw</code>
and of the nearest neighbour distances 
<code>Gest(X,...)$raw</code>. The uncorrected estimates
of <code class="reqn">F</code> and <code class="reqn">G</code> are severely biased.
However the uncorrected estimate of <code class="reqn">J</code>
is approximately unbiased (if the process is close to Poisson);
it is insensitive to edge effects, and should be used when
edge effects are severe (see Baddeley et al, 2000).
</p>
<p>The algorithm for <code>Fest</code>
uses two discrete approximations which are controlled
by the parameter <code>eps</code> and by the spacing of values of <code>r</code>
respectively. See <code>Fest</code> for details.
First-time users are strongly advised not to specify these arguments.
</p>
<p>Note that the value returned by <code>Jest</code> includes 
the output of <code>Fest</code> and <code>Gest</code>
as attributes (see the last example below).
If the user is intending to compute the <code>F,G</code> and <code>J</code>
functions for the point pattern, it is only necessary to
call <code>Jest</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"fv"</code>, see <code>fv.object</code>,
which can be plotted directly using <code>plot.fv</code>.
</p>
<p>Essentially a data frame containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>the vector of values of the argument <code class="reqn">r</code> 
at which the function <code class="reqn">J</code> has been  estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>the “reduced sample” or “border correction”
estimator of <code class="reqn">J(r)</code> computed from
the border-corrected estimates of <code class="reqn">F</code> and <code class="reqn">G</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km</code></td>
<td>
<p>the spatial Kaplan-Meier estimator of <code class="reqn">J(r)</code> computed from
the Kaplan-Meier estimates of <code class="reqn">F</code> and <code class="reqn">G</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>han</code></td>
<td>
<p>the Hanisch-style estimator of <code class="reqn">J(r)</code> computed from
the Hanisch estimate of <code class="reqn">G</code> and the Chiu-Stoyan estimate of
<code class="reqn">F</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>un</code></td>
<td>
<p>the uncorrected estimate of <code class="reqn">J(r)</code>
computed from the uncorrected estimates of <code class="reqn">F</code> and
<code class="reqn">G</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theo</code></td>
<td>
<p>the theoretical value of <code class="reqn">J(r)</code>
for a stationary Poisson process: identically equal to <code class="reqn">1</code>
</p>
</td>
</tr>
</table>
<p>The data frame also has <b>attributes</b>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>

<p>the output of <code>Fest</code> for this point pattern,
containing three estimates of the empty space function <code class="reqn">F(r)</code>
and an estimate of its hazard function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>

<p>the output of <code>Gest</code> for this point pattern,
containing three estimates of the nearest neighbour distance distribution
function <code class="reqn">G(r)</code> and an estimate of its hazard function
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Sizeable amounts of memory may be needed during the calculation.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>References</h3>

<p>Baddeley, A.J. Spatial sampling and censoring.
In O.E. Barndorff-Nielsen, W.S. Kendall and
M.N.M. van Lieshout (eds) 
<em>Stochastic Geometry: Likelihood and Computation</em>.
Chapman and Hall, 1998.
Chapter 2, pages 37–78.
</p>
<p>Baddeley, A.J. and Gill, R.D. 
The empty space hazard of a spatial pattern.
Research Report 1994/3, Department of Mathematics,
University of Western Australia, May 1994.
</p>
<p>Baddeley, A.J. and Gill, R.D.
Kaplan-Meier estimators of interpoint distance
distributions for spatial point processes.
<em>Annals of Statistics</em> <b>25</b> (1997) 263–292.
</p>
<p>Baddeley, A., Kerscher, M., Schladitz, K. and Scott, B.T.
Estimating the <em>J</em> function without edge correction.
<em>Statistica Neerlandica</em> <b>54</b> (2000) 315–328.
</p>
<p>Borgefors, G.
Distance transformations in digital images.
<em>Computer Vision, Graphics and Image Processing</em>
<b>34</b> (1986) 344–371.
</p>
<p>Cressie, N.A.C. <em>Statistics for spatial data</em>.
John Wiley and Sons, 1991.
</p>
<p>Diggle, P.J. <em>Statistical analysis of spatial point patterns</em>.
Academic Press, 1983.
</p>
<p>Ripley, B.D. <em>Statistical inference for spatial processes</em>.
Cambridge University Press, 1988.
</p>
<p>Stoyan, D, Kendall, W.S. and Mecke, J.
<em>Stochastic geometry and its applications</em>.
2nd edition. Springer Verlag, 1995.
</p>
<p>Thonnes, E. and Van Lieshout, M.N.M,
A comparative study on the power of Van Lieshout and Baddeley's J-function.
<em>Biometrical Journal</em> <b>41</b> (1999) 721–734.
</p>
<p>Van Lieshout, M.N.M. and Baddeley, A.J.
A nonparametric measure of spatial interaction in point patterns.
<em>Statistica Neerlandica</em> <b>50</b> (1996) 344–361.
</p>


<h3>See Also</h3>

<p><code>Jinhom</code>,
<code>Fest</code>,
<code>Gest</code>,
<code>Kest</code>,
<code>km.rs</code>,
<code>reduced.sample</code>,
<code>kaplan.meier</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   J &lt;- Jest(cells, 0.01)
   plot(J, main="cells data")
   # values are far above J = 1, indicating regular pattern

   data(redwood)
   J &lt;- Jest(redwood, 0.01, legendpos="center")
   plot(J, main="redwood data")
   # values are below J = 1, indicating clustered pattern
</code></pre>


</div>