<div class="container">

<table style="width: 100%;"><tr>
<td>bridgesde3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of 3-D Bridge SDE's</h2>

<h3>Description</h3>

<p>The (S3) generic function <code>bridgesde3d</code> for simulation of 3-dim bridge stochastic differential equations,Itô or Stratonovich type, with different methods.</p>


<h3>Usage</h3>

<pre><code class="language-R">bridgesde3d(N, ...)
## Default S3 method:
bridgesde3d(N=1000,M=1, x0=c(0,0,0), 
   y=c(0,0,0), t0 = 0, T = 1, Dt, drift, diffusion, corr = NULL, 
   alpha = 0.5, mu = 0.5,type = c("ito", "str"), method = 
   c("euler", "milstein","predcorr","smilstein", "taylor", 
	"heun","rk1", "rk2", "rk3"), ...)

## S3 method for class 'bridgesde3d'
summary(object, at,
     digits=NULL, ...)								  
## S3 method for class 'bridgesde3d'
time(x, ...)
## S3 method for class 'bridgesde3d'
mean(x, at, ...)
## S3 method for class 'bridgesde3d'
Median(x, at, ...)
## S3 method for class 'bridgesde3d'
Mode(x, at, ...)
## S3 method for class 'bridgesde3d'
quantile(x, at, ...)
## S3 method for class 'bridgesde3d'
kurtosis(x, at, ...)
## S3 method for class 'bridgesde3d'
skewness(x, at, ...)
## S3 method for class 'bridgesde3d'
min(x, at, ...)
## S3 method for class 'bridgesde3d'
max(x, at, ...)
## S3 method for class 'bridgesde3d'
moment(x, at, ...)
## S3 method for class 'bridgesde3d'
cv(x, at, ...)
## S3 method for class 'bridgesde3d'
bconfint(x, at, ...)

## S3 method for class 'bridgesde3d'
plot(x, ...)
## S3 method for class 'bridgesde3d'
lines(x, ...)
## S3 method for class 'bridgesde3d'
points(x, ...)	
## S3 method for class 'bridgesde3d'
plot3D(x, display = c("persp","rgl"), ...)						  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of simulation steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>initial value (numeric vector of length 3) of the process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code> at time <code class="reqn">t_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>terminal value (numeric vector of length 3) of the process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code> at time <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>initial time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>final time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code>missing</code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drift</code></td>
<td>
<p>drift coefficient: an <code>expression</code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffusion</code></td>
<td>
<p>diffusion coefficient: an <code>expression</code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>the correlation structure of three Brownian motions W1(t), W2(t) and W3(t); must be a real symmetric positive-definite square matrix of dimension 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>weight <code>alpha</code> of the predictor-corrector scheme; the default <code>alpha = 0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>weight <code>mu</code> of the predictor-corrector scheme; the default <code>mu = 0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>type="ito"</code> simulation diffusion bridge of Itô type, else <code>type="str"</code> simulation diffusion bridge of Stratonovich type; the default <code>type="ito"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>; see <code>snssde3d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>an object inheriting from class <code>"bridgesde3d"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solution <code class="reqn">(X_{t},Y_{t},Z_{t})</code> at time <code>at</code>. The default <code>at = T/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p><code>"persp"</code> perspective and <code>"rgl"</code> plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>bridgesde3d</code> returns a <code>mts</code> of the diffusion bridge starting at <code>x</code> at time <code>t0</code> and ending at <code>y</code> at time <code>T</code>. W1(t), W2(t) and W3(t) three standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code>browseVignettes('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>bridgesde3d</code> returns an object inheriting from <code>class</code> <code>"bridgesde3d"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X, Y, Z </code></td>
<td>
<p>an invisible <code>mts</code> (3-dim) object (X(t),Y(t),Z(t)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>driftx, drifty, driftz </code></td>
<td>
<p>drift coefficient of X(t), Y(t) and Z(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffx, diffy, diffz </code></td>
<td>
<p>diffusion coefficient of X(t), Y(t) and Z(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cx, Cy, Cz</code></td>
<td>
<p>indices of crossing realized of X(t), Y(t)) and Z(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>type of sde.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>the numerical method used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Bladt, M. and Sorensen, M. (2007).
Simple simulation of diffusion bridges with application to likelihood inference for diffusions.
<em>Working Paper, University of Copenhagen</em>. 
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York
</p>


<h3>See Also</h3>

<p><code>bridgesde1d</code> for simulation of 1-dim SDE. <code>DBridge</code> in package "sde".
</p>
<p><code>bridgesde2d</code> for simulation of 2-dim SDE.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## dX(t) = 4*(-1-X(t))*Y(t) dt + 0.2 * dW1(t) ; x01 = 0 and y01 = 0
## dY(t) = 4*(1-Y(t)) *X(t) dt + 0.2 * dW2(t) ; x02 = -1 and y02 = -2
## dZ(t) = 4*(1-Z(t)) *Y(t) dt + 0.2 * dW3(t) ; x03 = 0.5 and y03 = 0.5       
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma
set.seed(1234)

fx &lt;- expression(4*(-1-x)*y, 4*(1-y)*x, 4*(1-z)*y)
gx &lt;- rep(expression(0.2),3)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 

res &lt;- bridgesde3d(x0=c(0,-1,0.5),y=c(0,-2,0.5),drift=fx,diffusion=gx,corr=Sigma,M=200)
res
summary(res) ## Monte-Carlo statistics at time T/2=0.5
summary(res,at=0.25) ## Monte-Carlo statistics at time 0.25
summary(res,at=0.75) ## Monte-Carlo statistics at time 0.75
##
plot(res,type="n")
lines(time(res),apply(res$X,1,mean),col=3,lwd=2)
lines(time(res),apply(res$Y,1,mean),col=4,lwd=2)
lines(time(res),apply(res$Z,1,mean),col=5,lwd=2)
legend("topleft",c(expression(E(X[t])),expression(E(Y[t])),
       expression(E(Z[t]))),lty=1,inset = .01,col=c(3,4,5))
##
plot3D(res,display = "persp",main="3-dim bridge sde")
</code></pre>


</div>