<div class="container">

<table style="width: 100%;"><tr>
<td>supELtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The maximally selected EL test</h2>

<h3>Description</h3>

<p><code>supELtest</code> provides the maximally selected EL statistics that
is better adapted at detecting local differences:
</p>
<p style="text-align: center;"><code class="reqn">\sup_{i=1,\ldots,m}\{-2\log R(t_i)\},</code>
</p>

<p>where <code class="reqn">R(t)</code> is the EL ratio that compares the survival functions at each given time <code class="reqn">t</code>,
and <code class="reqn"> 0&lt;t_1&lt;\ldots&lt;t_m&lt;\infty</code> are the (ordered) observed uncensored times at which the
Kaplanâ€“Meier estimate is positive and less than 1 for each sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">supELtest(
  formula,
  data = NULL,
  group_order = NULL,
  t1 = 0,
  t2 = Inf,
  sided = 2,
  nboot = 1000,
  alpha = 0.05,
  seed = 1011,
  nlimit = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object with a <code>Surv</code> object as the response on the left of the <code>~</code> operator and 
the grouping variable as the term on the right. The <code>Surv</code> object involves two variables: the observed survival 
and censoring times, and the censoring indicator, which takes a value of <code class="reqn">1</code> if the observed time is uncensored 
and <code class="reqn">0</code> otherwise. The grouping variable takes different values for different groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the <code>formula</code>: the observed survival and censoring times,
the censoring indicator, and the grouping variable. If not found in <code>data</code>, the variables in the <code>formula</code> should 
be already defined by the user or in attached <code>R</code> objects. The default is the data frame with three columns of 
variables taken from the formula: column 1 contains the observed survival and censoring times, column 2 the censoring 
indicator, and column 3 the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_order</code></td>
<td>
<p>a <code class="reqn">k</code>-vector containing the values of the grouping variable, with the <code class="reqn">j</code>-th element being the group
hypothesized to have the <code class="reqn">j</code>-th highest survival rates, <code class="reqn">j=1,\ldots,k</code>. The default is the vector of sorted grouping variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>the first endpoint of a prespecified time interval, if any, to which the comparison of the survival functions is restricted. 
The default value is <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>the second endpoint of a prespecified time interval, if any, to which the comparison of the survival 
functions is restricted. The default value is <code class="reqn">\infty</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p><code class="reqn">2</code> if two-sided test, and <code class="reqn">1</code> if one-sided test. The default value is <code class="reqn">2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>the number of bootstrap replications in calculating critical values for the tests. 
The default value is <code class="reqn">1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the pre-specified significance level of the tests. The default value is <code class="reqn">0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed for the random number generator in <code>R</code>, for generating bootstrap samples needed 
to calculate the critical values for the tests. The default value is <code class="reqn">1011</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlimit</code></td>
<td>
<p>a number used to calculate <code>nsplit=</code> <code class="reqn">m</code><code>/nlimit</code>, the number of 
parts into which the calculation of the <code>nboot</code> bootstrap replications is split. 
The use of this variable can make computation faster when the number of time points <code class="reqn">m</code> is large. 
The default value for <code>nlimit</code> is 200.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>supELtest</code> returns a <code>supELtest</code> object, a list with 14 elements:
</p>

<ul>
<li> <p><code>call</code> the function call
</p>
</li>
<li> <p><code>teststat</code> the resulting integrated EL statistics
</p>
</li>
<li> <p><code>critval</code> the critical value based on bootstrap
</p>
</li>
<li> <p><code>pvalue</code> the p-value of the test
</p>
</li>
<li> <p><code>formula</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>data</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>group_order</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>t1</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>t2</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>sided</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>nboot</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>alpha</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>seed</code> the value of the input argument of supELtest
</p>
</li>
<li> <p><code>nlimit</code> the value of the input argument of supELtest
</p>
</li>
</ul>
<p>Methods defined for <code>supELtest</code> objects are provided for <code>print</code> and <code>summary</code>.
</p>


<h3>References</h3>


<ul>
<li>
<p> H. Chang, I.W. McKeague, "Empirical likelihood based tests
for stochastic ordering under right censorship," <em>Electronic Journal of Statistics</em>,
Vol. 10, No. 2, pp. 2511-2536 (2016).
</p>
</li>
<li>
<p> H. Chang, I.W. McKeague, "Nonparametric testing for multiple survival functions 
with non-inferiority margins," <em>Annals of Statistics</em>, Vol. 47, No. 1, pp. 205-232, (2019).
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>hepatitis</code>, <code>intELtest</code>, <code>ptwiseELtest</code>, <code>nocrossings</code>, <code>print.supELtest</code>, <code>summary.supELtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survELtest)
nocrossings(survival::Surv(hepatitis$time, hepatitis$censor)~
    hepatitis$group, sided = 1)

## OUTPUT:
## Call:
## nocrossings(formula = survival::Surv(hepatitis$time, hepatitis$censor) ~ 
##     hepatitis$group, sided = 1)
## 
## Decision = 1

## A decision value of 1 means the case of crossings or alternative orderings among the 
## survival functions is excluded. Thus, we can proceed to the one-sided test.

supELtest(survival::Surv(hepatitis$time, hepatitis$censor)~
    hepatitis$group, sided = 1)

## OUTPUT:
## Call:
## supELtest(formula = survival::Surv(hepatitis$time, hepatitis$censor) ~   
##     hepatitis$group, sided = 1)
## 
## One-sided maximally selected EL test statistic = 10.36, p = 0.006
</code></pre>


</div>