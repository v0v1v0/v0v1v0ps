<div class="container">

<table style="width: 100%;"><tr>
<td>gmcpic.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function implementing the Generalized Monte Carlo plug-in test with calibration (GMCPIC test)</h2>

<h3>Description</h3>

<p>The GMCPIC test is a procedure to test the equality of the
vectors of probabilities of two multinomial draws. The test
statistics that is used is the multinomial-density
statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gmcpic.test(x, B, M, weights, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>[2-column matrix] Column 1 (resp. 2) contains
the vector of observed frequencies in population 1 (resp.
2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>[Integer] Number of Monte Carlo simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>[Integer] Number of repetitions for the
calibration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>[Numeric] Vector of weights in [0,1] that
are tried for the calibration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>[Numeric] Targeted risk level of the
test; value in [0,1].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The GMCPIC test was developed to test the similarity of two
pathogen compositions based on small samples and sparse
data.
</p>


<h3>Value</h3>

<p>list with INPUT arguments (<code>x</code>, <code>B</code>, <code>M</code>,
<code>weights</code> and <code>threshold</code>) and the following
items: </p>
<table>
<tr style="vertical-align: top;">
<td><code>calibrated.weight</code></td>
<td>
<p>Weight selected by the
calibration procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>Test p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject.null.hypothesis</code></td>
<td>
<p>Logical indicating whether
the null hypothesis is rejected or not at the risk level
specified by <code>threshold</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Message</code></td>
<td>
<p>Details
about the p-value interpretation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Samuel Soubeyrand &lt;samuel.soubeyrand@inra.fr&gt;
</p>
<p>Vincent Garreta
</p>
<p>Maintainer: Jean-Francois Rey
</p>


<h3>References</h3>

<p>Soubeyrand S, Garreta V, Monteil C, Suffert F, Goyeau H,
Berder J, Moinard J, Fournier E, Tharreau D,
Morris C, Sache I (2017). Testing differences between
pathogen compositions with small samples and sparse data.
Phytopathology 107: 1199-1208. http://doi.org/10.1094/PHYTO-02-17-0070-FI
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Load Pathogen Compositions of M. oryzae collected in Madagascar
data(PathogenCompositionMoryzaeMadagascar)
x=t(PathogenCompositionMoryzaeMadagascar)

## Apply the GMCPIC test (use B=10^3, M=10^4 to get a robust result)
testMada=gmcpic.test(x, B=10^2, M=10^3, weights=seq(0.5,0.99,by=0.01),threshold=0.05)
testMada

## Apply the Chi-squared test
chisq.test(x, simulate.p.value = TRUE, B = 10000)
</code></pre>


</div>