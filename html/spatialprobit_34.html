<div class="container">

<table style="width: 100%;"><tr>
<td>sartobit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian estimation of the SAR Tobit model</h2>

<h3>Description</h3>

<p>Bayesian estimation of the spatial autoregressive Tobit model (SAR Tobit model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sartobit(formula, W, data, ...)

sar_tobit_mcmc(y, X, W, ndraw = 1000, burn.in = 100, thinning = 1, 
  prior=list(a1=1, a2=1, c=rep(0, ncol(X)), T=diag(ncol(X))*1e12, lflag = 0), 
  start = list(rho = 0.75, beta = rep(0, ncol(X)), sige = 1),
  m=10, computeMarginalEffects=FALSE, showProgress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>dependent variables. vector of zeros and ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraw</code></td>
<td>
<p>number of MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>number of MCMC burn-in to be discarded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>MCMC thinning factor, defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A list of prior settings for 
<code class="reqn">\rho \sim Beta(a1,a2)</code> 
and <code class="reqn">\beta \sim N(c,T)</code>. Defaults to diffuse prior for beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>list of start values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of burn-in samples in innermost Gibbs sampler. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeMarginalEffects</code></td>
<td>
<p>Flag if marginal effects are calculated. Defaults to FALSE. 
We recommend to enable it only when sample size is small.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showProgress</code></td>
<td>
<p>Flag if progress bar should be shown. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which sarprobit is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bayesian estimates of the spatial autoregressive Tobit model (SAR Tobit model)
</p>
<p style="text-align: center;"><code class="reqn">
  z = \rho W y + X \beta + \epsilon, \epsilon \sim N(0, \sigma^2_{e} I_n)
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  z = (I_n - \rho W)^{-1} X \beta + (I_n - \rho W)^{-1} \epsilon
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  y = max(z, 0)
</code>
</p>

<p>where <code class="reqn">y</code> <code class="reqn">(n \times 1)</code> is only observed for <code class="reqn">z \ge 0</code> and censored to 0 otherwise. 
<code class="reqn">\beta</code> is a <code class="reqn">(k \times 1)</code> 
vector of parameters associated with the <code class="reqn">(n \times k)</code> data matrix X.
</p>
<p>The prior distributions are 
<code class="reqn">\beta \sim N(c,T)</code> 
and  
<code class="reqn">\rho \sim Uni(rmin,rmax)</code> 
or 
<code class="reqn">\rho \sim Beta(a1,a2)</code>.
</p>


<h3>Value</h3>

<p>Returns a structure of class <code>sartobit</code>:

</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p> posterior mean of bhat based on draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p> posterior mean of rho based on draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdraw </code></td>
<td>
<p> beta draws (ndraw-nomit x nvar) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdraw </code></td>
<td>
<p> rho  draws (ndraw-nomit x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdraw </code></td>
<td>
<p> sige draws (ndraw-nomit x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total </code></td>
<td>
<p> a matrix (ndraw,nvars-1) total x-impacts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direct </code></td>
<td>
<p> a matrix (ndraw,nvars-1) direct x-impacts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indirect </code></td>
<td>
<p> a matrix (ndraw,nvars-1) indirect x-impacts </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>rdraw </code></td>
<td>
<p> r draws (ndraw-nomit x 1) (if m,k input) </p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>nobs </code></td>
<td>
<p> # of observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar </code></td>
<td>
<p> # of variables in x-matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraw </code></td>
<td>
<p> # of draws </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nomit </code></td>
<td>
<p> # of initial draws omitted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps </code></td>
<td>
<p> # of samples used by Gibbs sampler for TMVN </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p> y-vector from input (nobs x 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zip </code></td>
<td>
<p> # of zero y-values </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>a1 </code></td>
<td>
<p> a1 parameter for beta prior on rho from input, or default value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2 </code></td>
<td>
<p> a2 parameter for beta prior on rho from input, or default value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time </code></td>
<td>
<p> total time taken </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax </code></td>
<td>
<p> 1/max eigenvalue of W (or rmax if input) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmin </code></td>
<td>
<p> 1/min eigenvalue of W (or rmin if input) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tflag </code></td>
<td>
<p> 'plevel' (default) for printing p-levels; 
'tstat' for printing bogus t-statistics </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lflag </code></td>
<td>
<p> lflag from input </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cflag </code></td>
<td>
<p> 1 for intercept term, 0 for no intercept term </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>lndet </code></td>
<td>
<p> a matrix containing log-determinant information
(for use in later function calls to save time) </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>adapted to and optimized for R by Stefan Wilhelm &lt;wilhelm@financial.com&gt; 
based on Matlab code from James P. LeSage</p>


<h3>References</h3>

<p>LeSage, J. and Pace, R. K. (2009), <em>Introduction to Spatial Econometrics</em>, CRC Press, chapter 10,
section 10.3, 299â€“304 
</p>


<h3>See Also</h3>

<p><code>sarprobit</code>, <code>sarorderedprobit</code> or <code>semprobit</code> 
for SAR probit/SAR Ordered Probit/ SEM probit model fitting
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example from LeSage/Pace (2009), section 10.3.1, p. 302-304
# Value of "a" is not stated in book! 
# Assuming a=-1 which gives approx. 50% censoring
library(spatialprobit)

a &lt;- -1   # control degree of censored observation
n &lt;- 1000
rho &lt;- 0.7
beta &lt;- c(0, 2)
sige &lt;- 0.5
I_n &lt;- sparseMatrix(i=1:n, j=1:n, x=1)
x &lt;- runif(n, a, 1)
X &lt;- cbind(1, x)
eps &lt;- rnorm(n, sd=sqrt(sige))
param &lt;- c(beta, sige, rho)

# random locational coordinates and 6 nearest neighbors
lat &lt;- rnorm(n)
long &lt;- rnorm(n)
W &lt;- kNearestNeighbors(lat, long, k=6)

y &lt;- as.double(solve(I_n - rho * W) %*% (X %*% beta + eps))
table(y &gt; 0)

# full information
yfull &lt;- y

# set negative values to zero to reflect sample truncation
ind &lt;- which(y &lt;=0)
y[ind] &lt;- 0

# Fit SAR (with complete information)
fit_sar &lt;- sartobit(yfull ~ X-1, W,ndraw=1000,burn.in=200, showProgress=FALSE)
summary(fit_sar)

# Fit SAR Tobit (with approx. 50% censored observations)
fit_sartobit &lt;- sartobit(y ~ x,W,ndraw=1000,burn.in=200, showProgress=TRUE)

par(mfrow=c(2,2))
for (i in 1:4) {
 ylim1 &lt;- range(fit_sar$B[,i], fit_sartobit$B[,i])
 plot(fit_sar$B[,i], type="l", ylim=ylim1, main=fit_sartobit$names[i], col="red")
 lines(fit_sartobit$B[,i], col="green")
 legend("topleft", legend=c("SAR", "SAR Tobit"), col=c("red", "green"), 
   lty=1, bty="n")
}

# Fit SAR Tobit (with approx. 50% censored observations)
fit_sartobit &lt;- sartobit(y ~ x,W,ndraw=1000,burn.in=0, showProgress=TRUE, 
    computeMarginalEffects=TRUE)
# Print SAR Tobit marginal effects
impacts(fit_sartobit)
#--------Marginal Effects--------
#
#(a) Direct effects
#  lower_005 posterior_mean upper_095
#x     1.013          1.092     1.176
#
#(b) Indirect effects
#  lower_005 posterior_mean upper_095
#x     2.583          2.800     3.011
#
#(c) Total effects
#  lower_005 posterior_mean upper_095
#x     3.597          3.892     4.183
#mfx &lt;- marginal.effects(fit_sartobit)

</code></pre>


</div>