<div class="container">

<table style="width: 100%;"><tr>
<td>pl_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribution-fitting functions</h2>

<h3>Description</h3>

<p>These functions fit parametric distributions to a set of
discrete values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pl_fit(dat, xmin = 1)

exp_fit(dat, xmin = 1)

lnorm_fit(dat, xmin = 1)

tpl_fit(dat, xmin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>The set of values to which the distribution are fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>The minimum possible value to consider when fitting the
distribution</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions will fit distributions to a set of values using 
maximum-likelihood estimation. In the context of the 'spatialwarnings' 
package, they are most-often used to fit parametric distributions on patch
size distributions. As a result, these functions assume that the data 
contains only integer, strictly positive values. The type of distribution
depends on the prefix of the function: 'pl' for power-law, 'tpl' for
truncated power-law, 'lnorm' for lognormal and 'exp' for an exponential
distribution. 
</p>
<p>In the context of distribution-fitting, 'xmin' represents the minimum value 
that a distribution can take. It is often used to represent the minimum 
scale at which a power-law model is appropriate (Clauset et al. 2009), and 
can be estimated on an empirical distribution using
<code>xmin_estim</code>. Again, please note that the fitting procedure 
assumes here that xmin is equal or grater than one.
</p>
<p>Please note that a best effort is made to have the fit converge, but 
it may sometimes fail when the parameters are far from their usual 
range, and numerical issues may occur. It is good practice to make 
sure the fits are sensible when convergence warnings are reported.
</p>
<p>For reference, the shape of the distributions is as follow: 
</p>

<dl>
<dt>power-law</dt>
<dd>
<p><code class="reqn">x^{-a}</code> where a is the power-law exponent</p>
</dd>
<dt>exponential</dt>
<dd>
<p><code class="reqn">exp(-bx)</code> where b is the truncation rate
of the exponential</p>
</dd>
<dt>truncated power-law</dt>
<dd>
<p><code class="reqn">x^{-a}exp(-bx)</code> where a
and b are the exponent of the power law and the rate of truncation</p>
</dd>
</dl>
<p>The lognormal form follows the standard definition.
</p>
<p>The following global options can be used to change the behavior of fitting functions 
and/or produce more verbose output: 
</p>
 
<dl>
<dt>spatialwarnings.constants.reltol</dt>
<dd>
<p>the relative tolerance to use to compute 
the power-law normalizing constant
</p>
<p style="text-align: center;"><code class="reqn">sum_{k=1}^{\infty} x^{ak}e^{-bk}</code>
</p>
<p>. 
Increase to increase the precision of this constant, which can be useful in some 
cases, typically with large sample sizes. Default is 1e-8.</p>
</dd>
<dt>spatialwarnings.constants.maxit</dt>
<dd>
<p>the maximum number of iterations to compute 
the normalizing constant of a truncated power-law. Increase if you get a warning 
that the relative tolerance level (defined above) was not reached. Default is 1e8</p>
</dd>
<dt>spatialwarnings.debug.fit_warn_on_bound</dt>
<dd>
<p>logical value. Warn if the fit is 
at the boundary of the valid range for distribution parameter</p>
</dd>
<dt>spatialwarnings.debug.fit_warn_on_NA</dt>
<dd>
<p>logical value. Warn if the returned fit 
has <code>NA</code>/<code>NaN</code> parameters</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list containing at list the following components: 
</p>
 
<dl>
<dt><code>type</code></dt>
<dd>
<p>The type of distribution fitted (as a character string)</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>The method used for the fit - here, maximum likelihood, 'll'</p>
</dd>
<dt><code>ll</code></dt>
<dd>
<p>The log likelihood at the estimated parameter values</p>
</dd>
<dt><code>xmin</code></dt>
<dd>
<p>The value of xmin used for the fit</p>
</dd>
<dt><code>npars</code></dt>
<dd>
<p>The number of parameters of the distribution</p>
</dd>
</dl>
<p>Additionally, this list may have one or more of the following elements depending on 
the type of distribution that has been fitted: 
</p>
 
<dl>
<dt><code>plexpo</code></dt>
<dd>
<p>The exponent of the power-law</p>
</dd>
<dt><code>cutoff</code></dt>
<dd>
<p>The rate of truncation, for truncated power law and 
exponential fits</p>
</dd>
<dt><code>meanlog</code></dt>
<dd>
<p>The mean of the lognormal distribution</p>
</dd>
<dt><code>sdlog</code></dt>
<dd>
<p>The s.d. of the lognormal distribution</p>
</dd>
</dl>
<h3>References</h3>

<p>Clauset, Aaron, Cosma Rohilla Shalizi, and M. E. J. Newman. 2009. “Power-Law
Distributions in Empirical Data.” SIAM Review 51 (4): 661–703. 
https://doi.org/10.1137/070710111.
</p>


<h3>See Also</h3>

<p><code>patchdistr_sews</code>, <code>xmin_estim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Fit an exponential model to patch size distribution 
exp_fit(patchsizes(forestgap[[8]]))
 
# Use the estimated parameters as an indicator function


get_truncation &lt;- function(mat) { 
   c(exp_cutoff = exp_fit(patchsizes(mat))$cutoff)
}
trunc_indic &lt;- compute_indicator(forestgap, get_truncation)
plot(trunc_indic)
plot(indictest(trunc_indic, nulln = 19))



</code></pre>


</div>