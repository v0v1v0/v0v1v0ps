<div class="container">

<table style="width: 100%;"><tr>
<td>plot.serieOut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot outliers for series of observations</h2>

<h3>Description</h3>

<p>Plot the fitted spline, correlation matrix and PCA biplot for each of the
genotypes. Outlying series of observations are shown as filled dots in the
fitted spline plot, other observations are shown as open dots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'serieOut'
plot(
  x,
  ...,
  reason = c("mean corr", "angle", "slope"),
  genotypes = NULL,
  geno.decomp = NULL,
  useTimeNumber = FALSE,
  timeNumber = NULL,
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>serieOut</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reason</code></td>
<td>
<p>A character vector indicating which types of outliers should
be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>A character vector indicating which genotypes should be
plotted. If <code>NULL</code> all genotypes are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno.decomp</code></td>
<td>
<p>A character vector indicating which levels of
<code>geno.decomp</code> should be plotted. If <code>NULL</code> all levels are plotted.
Ignored if <code>geno.decomp</code> was not used when fitting models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useTimeNumber</code></td>
<td>
<p>Should the timeNumber be used instead of the timePoint
in the labels on the x-axis?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeNumber</code></td>
<td>
<p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of ggplot objects is invisibly returned.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for series of observations: 
<code>detectSerieOut()</code>,
<code>removeSerieOut()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-splines on a subset of genotypes
subGenoVator &lt;- c("G160", "G151")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGenoVator,
                        knots = 50)

## Extract the data.frames with predicted values and P-Spline coefficients.
predDat &lt;- fit.spline$predDat
coefDat &lt;- fit.spline$coefDat

## The coefficients are then used to tag suspect time courses.
outVator &lt;- detectSerieOut(corrDat = spatCorrectedVator,
                           predDat = predDat,
                           coefDat = coefDat,
                           trait = "EffpsII_corr",
                           genotypes = subGenoVator,
                           thrCor = 0.9,
                           thrPca = 30,
                           thrSlope = 0.7)

## The `outVator` can be visualized for selected genotypes.
plot(outVator, genotypes = "G151")

## Only visualize outliers tagged because of low correlation
## between slopes of the regression.
plot(outVator, genotypes = "G151", reason = "slope")


</code></pre>


</div>