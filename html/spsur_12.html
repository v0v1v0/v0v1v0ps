<div class="container">

<table style="width: 100%;"><tr>
<td>lmtestspsur</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing for the presence of spatial effects in Seemingly 
Unrelated Regressions</h2>

<h3>Description</h3>

<p>The function <code>spsurml</code>  reports a collection of 
Lagrange Multipliers designed to test  for the presence of different 
forms of spatial dependence in a <em>SUR</em> model of the "sim" type. 
That is, the approach of this function is from 
<em>'specific to general'</em>. As said, the model of the null hypothesis 
is the "sim" model whereas the model of the alternative depends on 
the effect whose omission we want to test.
</p>
<p>The collection of Lagrange Multipliers obtained by <code>lmtestspsur</code> 
are standard in the literature and take into account the multivariate 
nature of the <em>SUR</em> model. As a limitation, note that each 
Multiplier tests for the omission of the same spatial effects in all 
the cross-sections of the <em>G</em> equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmtestspsur(...)

## S3 method for class 'formula'
lmtestspsur(
  formula,
  data,
  listw,
  na.action,
  time = NULL,
  Tm = 1,
  zero.policy = NULL,
  R = NULL,
  b = NULL,
  ...
)

## Default S3 method:
lmtestspsur(Y, X, G, N, Tm = 1, listw, p, R = NULL, b = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object type <code>Formula</code> 
similar to objects created with the package <span class="pkg">Formula</span> 
describing the equations to be estimated in the model. 
This model may contain several responses (explained 
variables) and a varying number of regressors in each equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of class data.frame or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>A <code>listw</code> object created for example by 
<code>nb2listw</code> from <span class="pkg">spatialreg</span> package; if 
<code>nb2listw</code> not given, set to 
the same spatial weights as the <code>listw</code> argument. It can
also be a spatial weighting matrix of order <em>(NxN)</em> instead of
a <code>listw</code> object. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function (default <code>options("na.action")</code>),
can also be <code>na.omit</code> or <code>na.exclude</code> with consequences 
for residuals and fitted values. It may be necessary to set 
<code>zero.policy</code> to <code>TRUE</code> because this subsetting may 
create no-neighbour observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time index for the spatial panel SUR data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tm</code></td>
<td>
<p>Number of time periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>Similar to the corresponding parameter of 
<code>lagsarlm</code> function in <span class="pkg">spatialreg</span> package. 
If <code>TRUE</code> assign zero to the lagged value of zones without 
neighbours, if <code>FALSE</code> assign <code>NA</code> - causing 
<code>spsurml()</code> to terminate with an error. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A row vector of order <em>(1xpr)</em> with  the set of 
<em>r</em> linear constraints on the <em>beta</em> parameters. The 
<em>first</em> restriction appears in the first <em>p</em> terms,
the second restriction in the next <em>p</em> terms and so on. 
Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A column vector of order <em>(rx1)</em> with the values of 
the linear restrictions on the <em>beta</em> parameters. 
Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A column vector of order <em>(NTmGx1)</em>, with the 
observations of the explained variables. The ordering of the data 
must be (first) equation, (second) time dimension and (third) 
cross-sectional/spatial units. The specification of <em>Y</em> is 
only necessary if not available a <code>Formula</code>
and a data frame. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A data matrix of order <em>(NTmGxp)</em> with the observations
of the regressors. The number of covariates in the SUR model is 
<em>p</em> = <code class="reqn">sum(p_{g})</code> where <em><code class="reqn">p_{g}</code></em> is the number 
of regressors (including the intercept) in the g-th equation, 
<em>g = 1,...,G</em>). The specification of "X" is only 
necessary if not available a <code>Formula</code> and a 
data frame. Default = <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of cross-section or spatial units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of regressors by equation, including the intercept. 
<em>p</em> can be a row vector of order <em>(1xG)</em>, if the number 
of regressors is not the same for all the equations, or a scalar, 
if the <em>G</em> equations have the same number of regressors. The 
specification of <em>p</em> is only necessary if not available a 
<code>Formula</code> and a data frame.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lmtestspsur</code> tests for the omission of spatial 
effects in the "sim" version of the <em>SUR</em> model: <br></p>
<p style="text-align: center;"><code class="reqn">y_{tg} = X_{tg} \beta_{g} + u_{tg}</code>
</p>

<p style="text-align: center;"><code class="reqn">E[u_{tg}u_{th}']= \sigma_{gh}I_{N}  \quad E[u_{tg}u_{sh}']= 0 
          \mbox{ if } t ne s</code>
</p>

<p>where <code class="reqn">y_{tg}</code> and <code class="reqn">u_{tg}</code> are <em>(Nx1)</em> vectors, 
corresponding to the g-th equation and time period t;
<code class="reqn">X_{tg}</code> is the matrix of exogenous variables, of order 
<em><code class="reqn">(Nxp_{g})</code></em>. Moreover, <code class="reqn">\beta_{g}</code> is an unknown
<em><code class="reqn">(p_{g}x1)</code></em> vector of coefficients and <code class="reqn">\sigma_{gh}I_{N}</code> 
the covariance between equations <em>g</em> and <em>h</em>,
being <code class="reqn">\sigma_{gh}</code> and scalar and <code class="reqn">I_{N}</code> the identity 
matrix of orden N.
</p>
<p>The Lagrange Multipliers reported by this function are the followings:
</p>

<ul>
<li> <p><strong>LM-SUR-LAG</strong>: Tests for the omission of a spatial lag of 
the explained variable in the right hand side of the "sim" equation. 
The model of the alternative is: <br></p>
<p><code class="reqn">y_{tg} = \rho_{g}Wy_{tg} + X_{tg} \beta_{g} + u_{tg}</code>
</p>
<p>The null and alternative hypotheses are:
</p>
<p><code class="reqn">H_{0}: \rho_{g}=0 (forall g)</code> vs  
<code class="reqn">H_{A}: \rho_{g} ne 0 (exist g)</code>
</p>
</li>
<li> <p><strong>LM-SUR-ERR</strong>: Tests for the omission of spatial 
dependence in the equation of the errors of the "sim" model. The 
model of the alternative is:
</p>
<p><code class="reqn">y_{tg} = X_{tg} \beta_{g} + u_{tg}</code>; 
<code class="reqn">u_{tg}= \lambda_{g}Wu_{tg}+\epsilon_{tg}</code>
</p>
<p>The null and alternative hypotheses are:
</p>
<p><code class="reqn">H_{0}: \lambda_{g}=0 (forall g)</code> vs  
<code class="reqn">H_{A}: \lambda_{g}  ne 0 (exist g)</code>
</p>
</li>
<li> <p><strong>LM-SUR-SARAR</strong>: Tests for the simultaneous omission of 
a spatial lag of the explained variable in the right hand side of 
the "sim" equation and spatial dependence in the equation of the 
errors. The model of the alternative is:
</p>
<p><code class="reqn">y_{tg} = \rho_{g}Wy_{tg}+X_{tg} \beta_{g} + u_{tg}</code>; 
<code class="reqn">u_{tg}= \lambda_{g}Wu_{tg}+\epsilon_{tg}</code>
</p>
<p>The null and alternative hypotheses are:
</p>
<p><code class="reqn">H_{0}: \rho_{g}=\lambda_{g}=0 (forall g)</code> vs  
<code class="reqn">H_{A}: \rho_{g} ne 0 or \lambda_{g} ne 0 (exist g)</code>
</p>
</li>
<li>
<p><strong>LM*-SUR-SLM</strong> and <strong>LM*-SUR-SEM</strong>: These two test are 
the robustifyed version of the original, raw Multipliers, 
<strong>LM-SUR-SLM</strong> and <strong>LM-SUR-SEM</strong>, which can be severely 
oversized if the respective alternative hypothesis is misspeficied 
(this would be the case if, for example, we are testing for omitted 
lags of the explained variable whereas the problem is that there is 
spatial dependence in the errors, or viceversa). The null and 
alternative hypotheses of both test are totally analogous to their
twin non robust Multipliers.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of <code>htest</code> objects each one including the Wald
statistic, the corresponding p-value and the degrees of
freedom.
</p>


<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;">
  Fernando Lopez  </td>
<td style="text-align: left;"> <a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Roman Minguez  </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Jesus Mur  </td>
<td style="text-align: left;"> <a href="mailto:jmur@unizar.es">jmur@unizar.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Mur, J., Lopez, F., and Herrera, M. (2010). Testing for spatial
effects in seemingly unrelated regressions.
<em>Spatial Economic Analysis</em>, 5(4), 399-440.
&lt;doi:10.1080/17421772.2010.516443&gt;
</p>
</li>
<li>
<p> Lopez, F.A., Mur, J., and Angulo, A. (2014). Spatial model
selection strategies in a SUR framework. The case of regional
productivity in EU. <em>Annals of Regional Science</em>, 53(1),
197-220.
&lt;doi:10.1007/s00168-014-0624-2&gt;
</p>
</li>
<li>
<p> Minguez, R., Lopez, F.A. and Mur, J.  (2022).
spsur: An R Package for Dealing with Spatial 
Seemingly Unrelated Regression Models. 
<em>Journal of Statistical Software</em>, 
104(11), 1–43. &lt;doi:10.18637/jss.v104.i11&gt;#'        
</p>
</li>
<li>
<p> Anselin, L. (1988) A test for spatial autocorrelation in seemingly unrelated 
regressions <em>Economics Letters</em> 28(4), 335-341.
&lt;doi:10.1016/0165-1765(88)90009-2&gt; 
</p>
</li>
<li>
<p> Anselin, L. (1988) <em>Spatial econometrics: methods and models</em> 
Chap. 9 Dordrecht
</p>
</li>
<li>
<p> Anselin, L. (2016) Estimation and Testing in the Spatial Seemingly 
Unrelated Regression (SUR). <em>Geoda Center for Geospatial Analysis 
and Computation, Arizona State University</em>. Working Paper 2016-01.
&lt;doi:10.13140/RG.2.2.15925.40163&gt;
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>spsurml</code>, <code>anova</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#################################################
######## CROSS SECTION DATA (G&gt;1; Tm=1) # #######
#################################################

#### Example 1: Spatial Phillips-Curve. Anselin (1988, p. 203)
rm(list = ls()) # Clean memory
data("spc")
Tformula &lt;- WAGE83 | WAGE81 ~ UN83 + NMR83 + SMSA | UN80 + NMR80 + SMSA
lwspc &lt;- spdep::mat2listw(Wspc, style = "W")
lmtestspsur(formula = Tformula, data = spc, listw = lwspc)

## VIP: The output of the whole set of the examples can be examined 
## by executing demo(demo_lmtestspsur, package="spsur")


#################################################
######## PANEL DATA (G&gt;1; Tm&gt;1)          ########
#################################################

#### Example 2: Homicides &amp; Socio-Economics (1960-90)
# Homicides and selected socio-economic characteristics for
# continental U.S. counties.
# Data for four decennial census years: 1960, 1970, 1980 and 1990.
# https://geodacenter.github.io/data-and-lab/ncovr/
data(NCOVR, package="spsur")
nbncovr &lt;- spdep::poly2nb(NCOVR.sf, queen = TRUE)
### Some regions with no links...
lwncovr &lt;- spdep::nb2listw(nbncovr, style = "W", zero.policy = TRUE)
### With different number of exogenous variables in each equation
Tformula &lt;- HR70 | HR80  | HR90 ~ PS70 + UE70 | PS80 + UE80 +RD80 |
            PS90 + UE90 + RD90 + PO90
lmtestspsur(formula = Tformula, data = NCOVR.sf, 
            listw = lwncovr)

#################################################################
######### PANEL DATA: TEMPORAL CORRELATIONS (G=1; Tm&gt;1) ########
#################################################################

##### Example 3: NCOVR in panel data form
Year &lt;- as.numeric(kronecker(c(1960,1970,1980,1990), 
                   matrix(1,nrow = dim(NCOVR.sf)[1])))
HR &lt;- c(NCOVR.sf$HR60,NCOVR.sf$HR70,NCOVR.sf$HR80,NCOVR.sf$HR90)
PS &lt;- c(NCOVR.sf$PS60,NCOVR.sf$PS70,NCOVR.sf$PS80,NCOVR.sf$PS90)
UE &lt;- c(NCOVR.sf$UE60,NCOVR.sf$UE70,NCOVR.sf$UE80,NCOVR.sf$UE90)
NCOVRpanel &lt;- as.data.frame(cbind(Year,HR,PS,UE))
Tformula &lt;- HR ~ PS + UE
lmtestspsur(formula = Tformula, data = NCOVRpanel, time = Year, 
listw = lwncovr)


</code></pre>


</div>