<div class="container">

<table style="width: 100%;"><tr>
<td>fxTotal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Activity Centres of Detected and Undetected Animals</h2>

<h3>Description</h3>

<p>The summed probability densities of both observed and
unobserved individuals are computed for a fitted model and dataset.
</p>
<p>Function <code>fx.total</code> was replaced by method <code>fxTotal</code> in <span class="pkg">secr</span> 5.0.0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'secr'
fxTotal(object, sessnum = 1, mask = NULL, ncores = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> a fitted secr model </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sessnum</code></td>
<td>
<p> session number if <code>object$capthist</code> spans
multiple sessions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p> x- and y- coordinates of points at which density will be
computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p> integer number of threads to be used for parallel processing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> other arguments passed to <code>detectpar</code> and thence
to <code>predict.secr</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calls <code>fxi</code> for each detected animal and
overlays the results to obtain a summed probability density surface D.fx
for the locations of the home-range centres of detected individuals.
</p>
<p>A separate calculation using <code>pdot</code> provides the expected
spatial distribution of undetected animals, as another density
surface: crudely, D.nc(X) = D(X) * ( 1 – pdot(X)).
</p>
<p>The pointwise sum of the two surfaces is sometimes used to represent the
spatial distrbution of the population, but see Notes.
</p>
<p>Setting <code>ncores = NULL</code> uses the existing value from the environment variable 
RCPP_PARALLEL_NUM_THREADS (see <code>setNumThreads</code>).
</p>


<h3>Value</h3>

<p>An object of class ‘Dsurface’ (a variety of mask) with a ‘covariates’
attribute that is a dataframe with columns –
</p>
<table>
<tr style="vertical-align: top;">
<td><code>D.fx </code></td>
<td>
<p>sum of <code>fxi</code> over all detected individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.nc </code></td>
<td>
<p>expected density of undetected (‘not caught’) individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.sum </code></td>
<td>
<p>sum of D.fx and D.nc</p>
</td>
</tr>
</table>
<p>All densities are in animals per hectare (the ‘scale’ argument of
<code>plot.Dsurface</code> allows the units to be varied later).
</p>


<h3>Note</h3>

<p>The surface D.sum represents what is known from the data about a
specific realisation of the spatial point process for home range
centres: varying the intensity of sampling will change its shape. It is
not an unbiased estimate of a biologically meaningful density
surface. The surface will always tend to lack relief towards the edge of
a habitat mask where the main or only contribution is from D.nc.
</p>


<h3>References</h3>

<p>Borchers, D. L. and Efford, M. G. (2008) Spatially explicit maximum
likelihood methods for capture–recapture studies. <em>Biometrics</em>
<b>64</b>, 377–385.
</p>


<h3>See Also</h3>

<p><code>fxi</code>, <code>fxiContour</code>, <code>pdot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

tmp &lt;- fxTotal(secrdemo.0)

## to plot we must name one of the covariates:
## the Dsurface default 'D.0' causes an error 

plot(tmp, covariate = 'D.sum', col = terrain.colors(16),
   plottype = 'shaded')
plot(tmp, covariate = 'D.sum', col = 'white', add = TRUE,
   plottype = 'contour')
if (interactive()) {
    spotHeight(tmp, prefix = 'D.sum')
}

fxsurface &lt;- fxTotal(ovenbird.model.D, sessnum = 3)
plot(fxsurface, covariate = 'D.sum')


## End(Not run)


</code></pre>


</div>