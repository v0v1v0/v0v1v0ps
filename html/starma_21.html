<div class="container">

<table style="width: 100%;"><tr>
<td>stplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot for space-time series autocorrelation functions</h2>

<h3>Description</h3>

<p><code>stplot</code> renders a nice 2d plot for autocorrelation functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stplot(acf, ci, call, ggplot=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>acf</code></td>
<td>
<p> a matrix containing the autocorrelation functions of a given space-time series: row-wise should be the temporal observations, with each column corresponding to a space lag. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p> confidence intervals for the autocorrelation functions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> the name of the plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggplot</code></td>
<td>
<p> a boolean indicating whether to use ggplot2 functions (they are recommended). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots the calculated autocorrelation functions of a space-time series.
</p>
<p>In practice, the user should not use this function, as it is being called automatically when using <code>stacf</code> or <code>stpacf</code>.
The confidence intervals for the autocorrelation functions are approximated by 
</p>
<p style="text-align: center;"><code class="reqn">Var \left(\hat{\rho}_l(k)\right) \approx \frac{1}{N(T-k)}</code>
</p>

<p>where N is the number of sites, and T the number of temporal observations.
</p>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p>Felix Cheysson</p>


<h3>References</h3>

<p>- Pfeifer, P., &amp; Deutsch, S. (1981). Variance of the Sample Space-Time Autocorrelation Function. Journal of the Royal Statistical Society. Series B (Methodological), 43(1): 28-33.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nb_mat)	# Get neighbourhood matrices

# Simulate a STARMA model
eps &lt;- matrix(rnorm(94*200), 200, 94)
sim &lt;- eps
for (t in 3:200) {
	sim[t,] &lt;- (.4*diag(94) + .25*blist[[2]]) %*% sim[t-1,] +
		(.25*diag(94)                ) %*% sim[t-2,] +
		(            - .3*blist[[2]]) %*% eps[t-1,] +
		eps[t, ]
}

sim &lt;- sim[101:200,]
sim &lt;- stcenter(sim)	# Center and scale the dataset

# Autocorrelation functions
sim.stacf &lt;- stacf(sim, blist, plot=FALSE)

# Plot the autocorrelation function
stplot(sim.stacf, 2 / sqrt(nrow(sim) * ncol(sim)), "stacf(sim, blist)")
</code></pre>


</div>