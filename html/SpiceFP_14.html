<div class="container">

<table style="width: 100%;"><tr>
<td>SpiceFP-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Sparse and Structured Procedure to Identify Combined Effects of Functional Predictors</h2>

<h3>Description</h3>

<p>A set of functions allowing to implement the 'SpiceFP' approach which is iterative. It involves transformation of functional predictors into several candidate explanatory matrices (based on contingency tables), to which relative edge matrices with contiguity constraints are associated. Generalized Fused Lasso regression are performed in order to identify the best candidate matrix, the best class intervals and related coefficients at each iteration. The approach is stopped when the maximal number of iterations is reached or when retained coefficients are zeros. Supplementary functions allow to get coefficients of any candidate matrix or mean of coefficients of many candidates. The methods in this package are describing in Girault Gnanguenon Guesse, Patrice Loisel, BÃ©nedicte Fontez, Thierry Simonneau, Nadine Hilgert (2021) "An exploratory penalized regression to identify combined effects of functional variables -Application to agri-environmental issues" <a href="https://hal.archives-ouvertes.fr/hal-03298977">https://hal.archives-ouvertes.fr/hal-03298977</a>.
</p>


<h3>Details</h3>

<p>The main function of the package is the <code>spicefp</code> function. It directly
performs the three main steps of the SpiceFP approach, by using intermediate functions of the package. <br>
1) At he first step, contingency tables are constructed by
defining joint modalities using class intervals or bins. Several candidate
partitions are then defined.
For each statistical individual <code class="reqn">i</code> and each candidate partition (denoted <code class="reqn">u</code> here), the 2 (resp. 3)
functional predictors are transformed into frequency bi(resp. tri)-variate histograms (or contingency tables),
stored as row vectors. The combination of these row vectors for all individuals enables the construction of a
candidate explanatory matrix indexed by <code class="reqn">u</code> (denoted here <code class="reqn">X^u</code>).
The function <code>candidates</code> is designed to build these candidate matrices. <br>
2) At the second step, for each candidate explanatory matrix, an edge matrix is defined to
represent the contiguity constraints between modalities of the contingency table. <br>
3) Finally at the last step, the best class intervals and related
regression coefficients are defined by: i) performing a Generalized Fused Lasso
using each candidate explanatory matrix. The SpiceFP model is the following
</p>
<p style="text-align: center;"><code class="reqn">y_i  = X_i^u \beta^u + \varepsilon_i,</code>
</p>

<p>where <code class="reqn">\beta^u</code> is the coefficient to be estimated on the 2D (resp. 3D) intervals.
The estimator of <code class="reqn">\beta</code> is obtained as follows:
</p>
<p style="text-align: center;"><code class="reqn"> \hat{\beta}^{u,\gamma}(\lambda) = argmin \frac{1}{2} \|y - X^u \beta\|_2^2 + \lambda \|D ^{u,\gamma} \beta\|_1,</code>
</p>

<p>where <code class="reqn">\lambda</code> is a penalty parameter that controls the smoothness of the coefficients, and
<code class="reqn">\gamma</code> is the ratio between the regularization parameters of parsimony and fusion.
ii) choosing the best candidate matrix
and selecting its variables using an information criterion and checking the
shutdown conditions to stop the approach. Indeed, SpiceFP  may be used in an iterative way. It
therefore allows to identify up to K best candidate matrices and related coefficients.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Girault Gnanguenon Guesse <a href="mailto:girault.gnanguenon@gmail.com">girault.gnanguenon@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li>
<p> Patrice Loisel <a href="mailto:patrice.loisel@inrae.fr">patrice.loisel@inrae.fr</a>
</p>
</li>
<li>
<p> Benedicte Fontez <a href="mailto:benedicte.fontez@supagro.fr">benedicte.fontez@supagro.fr</a>
</p>
</li>
<li>
<p> Nadine Hilgert <a href="mailto:nadine.hilgert@inrae.fr">nadine.hilgert@inrae.fr</a>
</p>
</li>
</ul>
<p>Other contributors:
</p>

<ul>
<li>
<p> Thierry Simonneau <a href="mailto:thierry.simonneau@inrae.fr">thierry.simonneau@inrae.fr</a> [contractor]
</p>
</li>
<li>
<p> Isabelle Sanchez <a href="mailto:isabelle.sanchez@inrae.fr">isabelle.sanchez@inrae.fr</a> [contractor]
</p>
</li>
</ul>
</div>