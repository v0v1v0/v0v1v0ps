<div class="container">

<table style="width: 100%;"><tr>
<td>memento</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remembers and outputs the result of a slow function</h2>

<h3>Description</h3>

<p>Memento mori; you do not have time to lose on unnecessary
calculations. This function remembers the output of a slow function, for
given arguments and, if asked politely, given files and a given random seed.
If they match the previous arguments, files and seeds, the output is provided
without delay, otherwise the function runs, and all the parameters are saved
for next time. The trade-off is to assign a folder to store the data (see
also details). The function can also be forced to rerun.
</p>


<h3>Usage</h3>

<pre><code class="language-R">memento(
  what,
  args,
  name,
  dir = getwd(),
  subdir = "memento",
  rerun = F,
  check.files = list(),
  files.dir = getwd(),
  check.seed = F,
  speak = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a (slow) function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>a list of the the arguments to give to the function. If they
differ from saved values, the function will run again.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>the name of the folder where to store the info. THIS NEEDS TO BE
DIFFERENT FOR EACH IMPLEMENTATION OF THE FUNCTION IN IDENTICAL DIRECTORIES.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>the directory. You can set it as the working directory via
<code>getwd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdir</code></td>
<td>
<p>a name for a subdirectory (useful when the function is used
several time in a script)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rerun</code></td>
<td>
<p>if TRUE, the function is rerun no matter what. This is useful
to update information that is not present in the R environment, for instance
if you load data from external files that have been updated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.files</code></td>
<td>
<p>a list of files to check changes in (see details). If the
list is of length 0, no file is checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>files.dir</code></td>
<td>
<p>directory for teh files to be checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.seed</code></td>
<td>
<p>if TRUE, the value of the random seed in effect will be
taken into account; if it changes, the function will run again.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speak</code></td>
<td>
<p>whether to signify when the (slow) function is running</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>file data is summarized using MD5sum, which can have limitations in
data size (2^64 bits) and in cryptographic purposes.
</p>


<h3>Value</h3>

<p>the output of the function
</p>


<h3>Examples</h3>

<pre><code class="language-R">tf &lt;- tempdir()
if(exists("run.number")) run.number &lt;- run.number + 1 else run.number &lt;-  1
name &lt;- paste("T",run.number)

testfun &lt;- function(a = 1, time = 3){

  Sys.sleep(time)

  return(a  + 0.1 * abs(rnorm(1)))

}

# First time running; the function takes some time, memento needs the
# output to be generated, and will remember for later.
set.seed(43)
memento(testfun,  args = list(a = 7), name = name, dir = tf)

set.seed(43)
testfun(7, time = 0)

# Second time running: memento directly outputs the remembered results.
# In this case, the seed is ignored, so the result is different from what
# would be obtained with a different seed
set.seed(45)
memento(testfun,  args = list(a = 7), name = name, dir = tf)

set.seed(45)
testfun(7, time = 0)

# First time running while taking into account the random seed;
# the function takes some time to generate the result
set.seed(42)
memento(testfun,  args = list(a = 7), name = name, dir = tf, check.seed = TRUE)

# Second time running with an identical random seed;
# memento directly outputs the results
set.seed(42)
memento(testfun,  args = list(a = 7), name = name, dir = tf, check.seed = TRUE)

# The seed is changed: the result is computed anew
set.seed(47)
memento(testfun,  args = list(a = 7), name = name, dir = tf, check.seed = TRUE)

</code></pre>


</div>