<div class="container">

<table style="width: 100%;"><tr>
<td>wf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Waterfall display</h2>

<h3>Description</h3>

<p>This function returns a waterfall display of
a short-term Fourier transform or of any matrix.</p>


<h3>Usage</h3>

<pre><code class="language-R">wf(wave, f, channel = 1, wl = 512, zp = 0, ovlp = 0, fftw= FALSE, dB = "max0",
dBref = NULL, wn = "hanning", x = NULL,
hoff = 1, voff = 1, col = heat.colors,
xlab = "Frequency (kHz)", ylab = "Amplitude (dB)",
xaxis = TRUE, yaxis = TRUE,
density = NULL, border = NULL, lines = FALSE, lwd=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>window length for the analysis
(even number of points). (by default = 512)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zp</code></td>
<td>
<p>zero-padding (even number of points), see <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code>. See Notes of the <code>spectro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dB</code></td>
<td>
<p>a character string specifying the type dB to return: "max0" for a
maximum dB value at 0, "A", "B", "C", "D", and "ITU" for common dB weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBref</code></td>
<td>
<p>a dB reference value when <code>dB</code> is <code>TRUE</code>. <code>NULL</code> by default
but should be set to 2*10e-5 for a 20 microPa reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default <code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix if <code>wave</code> is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hoff</code></td>
<td>
<p>horizontal 'offset' which shifts actual x-values slightly
per row for visibility. Fractional parts will be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>voff</code></td>
<td>
<p>vertical 'offset' which separates traces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a color or a color palette function to be used to assign colors in
the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the frequency x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the amplitude y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>a logical, if <code>TRUE</code> adds the frequency x-axis
according to <code>f</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>a logical, if <code>TRUE</code> adds the amplitude y-axis
according.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>argument of <code>polygon</code>:
the density of shading lines, in lines per inch.  The default
value of 'NULL' means that no shading lines are drawn. A zero
value of 'density' means no shading nor filling whereas
negative values (and 'NA') suppress shading (and so allow
color filling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>argument of <code>polygon</code>:
the color to draw the border.  The default, 'NULL', means to
use 'par("fg")'.  Use 'border = NA' to omit borders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>a logical, if <code>TRUE</code> plots lines instead of surfaces
(polygons).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical arguments to passed to <code>plot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data input can be either a time wave (<code>wave</code>) or a matrix
(<code>x</code>). In that case, if <code>xaxis</code> is set to <code>TRUE</code> the
x-axis will follow the row index. To change it, turn <code>xaxis</code> to
<code>FALSE</code> and use <code>axis</code> afterwards. See examples.</p>


<h3>Note</h3>

<p>The function is well adapted to display short-term Fourier
transform. However, any matrix can be called using the argument
<code>x</code> instead of <code>wave</code>.</p>


<h3>Author(s)</h3>

<p>Carl G. Witthoft and Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>See Also</h3>

<p><code>spectro</code>, <code>spectro3D</code>, <code>dynspec</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico)
wf(tico,f=22050)
# changing the display parameters
jet.colors &lt;- colorRampPalette(c("blue", "green"))
wf(tico,f=22050, hoff=0, voff=2, col=jet.colors, border = NA)
# matrix input instead of a time wave and transparent lines display
m &lt;- numeric()
for(i in seq(-pi,pi,len=40)) {m &lt;- cbind(m,10*(sin(seq(0,2*pi,len=100)+i)))}
wf(x=m, lines=TRUE, col="#0000FF50",xlab="Time", ylab="Amplitude",
main="waterfall display")
</code></pre>


</div>