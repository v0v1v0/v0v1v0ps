<div class="container">

<table style="width: 100%;"><tr>
<td>scoreMatchWnBvm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score and moment matching of a univariate or bivariate wrapped normal
by a von Mises</h2>

<h3>Description</h3>

<p>Given a wrapped normal density, find the parameters of a von
Mises that matches it according to two characteristics: moments and scores.
Score matching estimators are available for univariate and bivariate cases
and moment matching only for the former.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scoreMatchWnBvm(Sigma = NULL, invSigma)

scoreMatchWnVm(sigma, sigma2 = NULL)

momentMatchWnVm(sigma, sigma2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Sigma, invSigma</code></td>
<td>
<p>covariance or precision matrix of the bivariate wrapped
normal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma, sigma2</code></td>
<td>
<p>standard deviation or variance of the wrapped normal.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the precision matrix is singular or if there are no solutions for
the score matching estimator, <code>c(0, 0, 0)</code> is returned.
</p>


<h3>Value</h3>

<p>Vector of parameters <code class="reqn">(\kappa_1,\kappa_2,\lambda)</code>, where
<code class="reqn">(\kappa_1,\kappa_2,2\lambda)</code> is a suitable input for <code>kappa</code> in
<code>dBvm</code>.
</p>


<h3>References</h3>

<p>Mardia, K. V., Kent, J. T., and Laha, A. K. (2016). Score matching estimators
for directional distributions. <em>arXiv:1604.0847</em>.
<a href="https://arxiv.org/abs/1604.08470">https://arxiv.org/abs/1604.08470</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Univariate WN approximation
sigma &lt;- 0.5
curve(dWn1D(x = x, mu = 0, sigma = sigma), from = -pi, to = pi,
      ylab = "Density", ylim = c(0, 1))
curve(dVm(x = x, mu = 0, kappa = momentMatchWnVm(sigma = sigma)), from = -pi,
      to = pi, col = "red", add = TRUE)
curve(dVm(x = x, mu = 0, kappa = scoreMatchWnVm(sigma = sigma)), from = -pi,
      to = pi, col = "green", add = TRUE)

# Bivariate WN approximation

# WN
alpha &lt;- c(2, 1, 1)
sigma &lt;- c(1, 1)
mu &lt;- c(pi / 2, pi / 2)
x &lt;- seq(-pi, pi, l = 101)[-101]
plotSurface2D(x, x, f = function(x) dStatWn2D(x = x, alpha = alpha, mu = mu,
                                              sigma = sigma), fVect = TRUE)
A &lt;- alphaToA(alpha = alpha, sigma = sigma)
S &lt;- 0.5 * solve(A) %*% diag(sigma)

# Score matching
kappa &lt;- scoreMatchWnBvm(Sigma = S)

# dBvm uses lambda / 2 in the exponent
plotSurface2D(x, x, f = function(x) dBvm(x = x, mu = mu,
                                        kappa = c(kappa[1:2], 2 * kappa[3])),
             fVect = TRUE)

# With singular Sigma
invSigma &lt;- matrix(c(1, sqrt(0.999), sqrt(0.999), 1), nrow = 2, ncol = 2)
scoreMatchWnBvm(invSigma = invSigma)
invSigma &lt;- matrix(1, nrow = 2, ncol = 2)
scoreMatchWnBvm(invSigma = invSigma)
</code></pre>


</div>