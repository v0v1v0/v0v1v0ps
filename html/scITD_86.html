<div class="container">

<table style="width: 100%;"><tr>
<td>run_gsea_one_factor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run gsea separately for all cell types of one specified factor and plot results</h2>

<h3>Description</h3>

<p>Run gsea separately for all cell types of one specified factor and plot results
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_gsea_one_factor(
  container,
  factor_select,
  method = "fgsea",
  thresh = 0.05,
  db_use = "GO",
  signed = TRUE,
  min_gs_size = 15,
  max_gs_size = 500,
  reset_other_factor_plots = FALSE,
  draw_plot = TRUE,
  ncores = container$experiment_params$ncores
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>container</code></td>
<td>
<p>environment Project container that stores sub-containers
for each cell type as well as results and plots from all analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_select</code></td>
<td>
<p>numeric The factor of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character The method of gsea to use. Can either be "fgsea",
"fgsea_special or "hypergeometric". (default="fgsea")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>numeric Pvalue significance threshold to use. Will include gene sets in
resulting heatmap if pvalue is below this threshold for at least one cell type. (default=0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db_use</code></td>
<td>
<p>character The database of gene sets to use. Database
options include "GO", "Reactome", "KEGG", and "BioCarta". More than
one database can be used. (default="GO")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signed</code></td>
<td>
<p>logical If TRUE, uses signed gsea. If FALSE, uses unsigned gsea.
Currently only works with fgsea method (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_gs_size</code></td>
<td>
<p>numeric Minimum gene set size (default=15)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_gs_size</code></td>
<td>
<p>numeric Maximum gene set size (default=500)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset_other_factor_plots</code></td>
<td>
<p>logical Set to TRUE to set all other gsea plots to NULL (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_plot</code></td>
<td>
<p>logical Set to TRUE to show the plot. Plot is stored regardless. (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>numeric The number of cores to use (default=container$experiment_params$ncores)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A stacked heatmap plot of the gsea results in the slot
container$plots$gsea$&lt;Factor#&gt;. The heatmaps show adjusted p-values for the
enrichment of each gene set in each cell type for the selected factor. The top
heatmap shows enriched gene sets among the positive loading genes and the bottom
heatmap shows enriched gene sets among the negative loading genes for the factor.
</p>


<h3>Examples</h3>

<pre><code class="language-R">test_container &lt;- run_gsea_one_factor(test_container, factor_select=1,
method="fgsea", thresh=0.05, db_use="Hallmark", signed=TRUE)
</code></pre>


</div>