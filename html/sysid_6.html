<div class="container">

<table style="width: 100%;"><tr>
<td>bj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Box-Jenkins Models</h2>

<h3>Description</h3>

<p>Fit a box-jenkins model of the specified order from input-output data
</p>


<h3>Usage</h3>

<pre><code class="language-R">bj(z, order = c(1, 1, 1, 1, 0), init_sys = NULL, options = optimOptions())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>an <code>idframe</code> object containing the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Specification of the orders: the five integer components 
(nb,nc,nd,nf,nk) are order of polynomial B + 1, order of the polynomial C,
order of the polynomial D, order of the polynomial F, and the 
input-output delay respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_sys</code></td>
<td>
<p>Linear polynomial model that configures the initial parameterization.
Must be a BJ model. Overrules the <code>order</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Estimation Options, setup using 
<code>optimOptions</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>SISO BJ models are of the form 
</p>
<p style="text-align: center;"><code class="reqn">
   y[k] = \frac{B(q^{-1})}{F(q^{-1})}u[k-nk] + 
   \frac{C(q^{-1})}{D(q^{-1})} e[k]
</code>
</p>

<p>The orders of Box-Jenkins model are defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">
   B(q^{-1}) = b_1 + b_2q^{-1} + \ldots + b_{nb} q^{-nb+1}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
   C(q^{-1}) = 1 + c_1q^{-1} + \ldots + c_{nc} q^{-nc}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
   D(q^{-1}) = 1 + d_1q^{-1} + \ldots + d_{nd} q^{-nd}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
   F(q^{-1}) = 1 + f_1q^{-1} + \ldots + f_{nf} q^{-nf}
</code>
</p>

<p>The function estimates the coefficients using non-linear least squares 
(Levenberg-Marquardt Algorithm)
<br>
The data is expected to have no offsets or trends. They can be removed 
using the <code>detrend</code> function.
</p>


<h3>Value</h3>

<p>An object of class <code>estpoly</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sys</code></td>
<td>
<p>an <code>idpoly</code> object containing the 
fitted BJ coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the predicted response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>the input data used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>A list containing the following fields: <br><code>vcov</code> - the covariance matrix of the fitted coefficients <br><code>sigma</code> - the standard deviation of the innovations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Option set used for estimation. If no 
custom options were configured, this is a set of default options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termination</code></td>
<td>
<p>Termination conditions for the iterative
search used for prediction error minimization:
<code>WhyStop</code> - Reason for termination <br><code>iter</code> - Number of Iterations <br><code>iter</code> - Number of Function Evaluations </p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Arun K. Tangirala (2015), <em>Principles of System Identification: 
Theory and Practice</em>, CRC Press, Boca Raton. Sections 14.4.1, 17.5.2, 
21.6.3
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bjsim)
z &lt;- dataSlice(bjsim,end=1500) # training set
mod_bj &lt;- bj(z,c(2,1,1,1,2))
mod_bj 
residplot(mod_bj) # residual plots

</code></pre>


</div>