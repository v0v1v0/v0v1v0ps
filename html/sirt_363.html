<div class="container">

<table style="width: 100%;"><tr>
<td>latent.regression.em.raschtype</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Latent Regression Model for the Generalized
Logistic Item Response Model and the Linear Model for Normal Responses
</h2>

<h3>Description</h3>

<p>This function estimates a unidimensional latent regression model if
a likelihood is specified, parameters from the generalized
item response model (Stukel, 1988) or a mean and a standard error
estimate for individual scores is provided as input.
Item parameters are treated as fixed in the estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">latent.regression.em.raschtype(data=NULL, f.yi.qk=NULL, X,
    weights=rep(1, nrow(X)), beta.init=rep(0,ncol(X)),
    sigma.init=1, b=rep(0,ncol(X)), a=rep(1,length(b)),
    c=rep(0, length(b)), d=rep(1, length(b)), alpha1=0, alpha2=0,
    max.parchange=1e-04, theta.list=seq(-5, 5, len=20),
    maxiter=300, progress=TRUE )

latent.regression.em.normal(y, X, sig.e, weights=rep(1, nrow(X)),
    beta.init=rep(0, ncol(X)), sigma.init=1, max.parchange=1e-04,
    maxiter=300, progress=TRUE)

## S3 method for class 'latent.regression'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> An <code class="reqn">N \times I</code> data frame of dichotomous item responses.
If no data frame is supplied, then a user can input the individual
likelihood <code>f.yi.qk</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.yi.qk</code></td>
<td>
<p>An optional matrix which contains the individual likelihood.
This matrix is produced by <code>rasch.mml2</code> or
<code>rasch.copula2</code>. The use of this argument allows the
estimation of the latent regression model independent of the
parameters of the used item response model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code class="reqn">N \times K</code> matrix of <code class="reqn">K</code> covariates in the latent
regression model. Note that the intercept (i.e. a vector of ones)
must be included in <code>X</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Student weights (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.init</code></td>
<td>

<p>Initial regression coefficients (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.init</code></td>
<td>

<p>Initial residual standard deviation (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Item difficulties (optional). They must only be provided
if the likelihood <code>f.yi.qk</code> is not given as an input.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>Item discriminations (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>

<p>Guessing parameter (lower asymptotes) (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>One minus slipping parameter (upper asymptotes) (optional).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>

<p>Upper tail parameter <code class="reqn">\alpha_1</code> in the generalized logistic item response model.
Default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>

<p>Lower tail parameter <code class="reqn">\alpha_2</code> parameter in the generalized
logistic item response model. Default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.parchange</code></td>
<td>

<p>Maximum change in regression parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.list</code></td>
<td>

<p>Grid of person ability where theta is evaluated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>An optional logical indicating whether computation
progress should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Individual scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.e</code></td>
<td>
<p>Standard errors for individual scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object of class <code>latent.regression</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the output <em>Regression Parameters</em>
the fraction of missing information (<code>fmi</code>) is reported
which is the increase of variance in regression
parameter estimates because ability is defined as
a latent variable. The effective sample size <code>pseudoN.latent</code>
corresponds to a sample size when the ability would be
available with a reliability of one.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximal number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.parchange</code></td>
<td>
<p>Maximum change in parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.coef</code></td>
<td>
<p>Summary of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Estimate of residual standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.simple</code></td>
<td>
<p>Covariance parameters of estimated parameters
(simplified version)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.latent</code></td>
<td>
<p>Covariance parameters of estimated parameters
which accounts for latent ability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>Individual posterior distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EAP</code></td>
<td>
<p>Individual EAP estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE.EAP</code></td>
<td>
<p>Standard error estimates of EAP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>explvar</code></td>
<td>
<p>Explained variance in latent regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totalvar</code></td>
<td>
<p>Total variance in latent regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsquared</code></td>
<td>
<p>Explained variance <code class="reqn">R^2</code> in latent regression</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Using the defaults in <code>a</code>, <code>c</code>, <code>d</code>,
<code>alpha1</code> and <code>alpha2</code> corresponds to the
Rasch model.
</p>


<h3>References</h3>

<p>Adams, R., &amp; Wu. M. (2007). The mixed-coefficients multinomial
logit model: A generalized form of the Rasch model.
In M. von Davier &amp; C. H. Carstensen (Eds.). <em>Multivariate and mixture
distribution Rasch models: Extensions and applications</em> (pp. 57-76).
New York: Springer.
<a href="https://doi.org/10.1007/978-0-387-49839-3_4">doi:10.1007/978-0-387-49839-3_4</a>
</p>
<p>Mislevy, R. J. (1991). Randomization-based inference about latent variables
from complex samples. <em>Psychometrika, 56</em>(2), 177-196.
<a href="https://doi.org/10.1007/BF02294457">doi:10.1007/BF02294457</a>
</p>
<p>Stukel, T. A. (1988). Generalized logistic models.
<em>Journal of the American Statistical Association, 83</em>(402), 426-431.
<a href="https://doi.org/10.1080/01621459.1988.10478613">doi:10.1080/01621459.1988.10478613</a>
</p>


<h3>See Also</h3>

<p>See also <code>plausible.value.imputation.raschtype</code>
for plausible value imputation of generalized logistic
item type models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
#  EXAMPLE 1: PISA Reading | Rasch model for dichotomous data
#############################################################################

data(data.pisaRead, package="sirt")
dat &lt;- data.pisaRead$data
items &lt;- grep("R", colnames(dat))
# define matrix of covariates
X &lt;- cbind( 1, dat[, c("female","hisei","migra" ) ] )

#***
# Model 1: Latent regression model in the Rasch model
# estimate Rasch model
mod1 &lt;- sirt::rasch.mml2( dat[,items] )
# latent regression model
lm1 &lt;- sirt::latent.regression.em.raschtype( data=dat[,items ], X=X, b=mod1$item$b )

## Not run: 
#***
# Model 2: Latent regression with generalized link function
# estimate alpha parameters for link function
mod2 &lt;- sirt::rasch.mml2( dat[,items], est.alpha=TRUE)
# use model estimated likelihood for latent regression model
lm2 &lt;- sirt::latent.regression.em.raschtype( f.yi.qk=mod2$f.yi.qk,
            X=X, theta.list=mod2$theta.k)

#***
# Model 3: Latent regression model based on Rasch copula model
testlets &lt;- paste( data.pisaRead$item$testlet)
itemclusters &lt;- match( testlets, unique(testlets) )
# estimate Rasch copula model
mod3 &lt;- sirt::rasch.copula2( dat[,items], itemcluster=itemclusters )
# use model estimated likelihood for latent regression model
lm3 &lt;- sirt::latent.regression.em.raschtype( f.yi.qk=mod3$f.yi.qk,
                X=X, theta.list=mod3$theta.k)

#############################################################################
# EXAMPLE 2: Simulated data according to the Rasch model
#############################################################################

set.seed(899)
I &lt;- 21     # number of items
b &lt;- seq(-2,2, len=I)   # item difficulties
n &lt;- 2000       # number of students

# simulate theta and covariates
theta &lt;- stats::rnorm( n )
x &lt;- .7 * theta + stats::rnorm( n, .5 )
y &lt;- .2 * x+ .3*theta + stats::rnorm( n, .4 )
dfr &lt;- data.frame( theta, 1, x, y )

# simulate Rasch model
dat1 &lt;- sirt::sim.raschtype( theta=theta, b=b )

# estimate latent regression
mod &lt;- sirt::latent.regression.em.raschtype( data=dat1, X=dfr[,-1], b=b )
  ## Regression Parameters
  ##
  ##        est se.simple     se        t p   beta    fmi N.simple pseudoN.latent
  ## X1 -0.2554    0.0208 0.0248 -10.2853 0 0.0000 0.2972     2000       1411.322
  ## x   0.4113    0.0161 0.0193  21.3037 0 0.4956 0.3052     2000       1411.322
  ## y   0.1715    0.0179 0.0213   8.0438 0 0.1860 0.2972     2000       1411.322
  ##
  ## Residual Variance=0.685
  ## Explained Variance=0.3639
  ## Total Variance=1.049
  ##                 R2=0.3469

# compare with linear model (based on true scores)
summary( stats::lm( theta  ~ x + y, data=dfr ) )
  ## Coefficients:
  ##             Estimate Std. Error t value Pr(&gt;|t|)
  ## (Intercept) -0.27821    0.01984  -14.02   &lt;2e-16 ***
  ## x            0.40747    0.01534   26.56   &lt;2e-16 ***
  ## y            0.18189    0.01704   10.67   &lt;2e-16 ***
  ## ---
  ##
  ## Residual standard error: 0.789 on 1997 degrees of freedom
  ## Multiple R-squared: 0.3713,     Adjusted R-squared: 0.3707

#***********
# define guessing parameters (lower asymptotes) and
# upper asymptotes ( 1 minus slipping parameters)
cI &lt;- rep(.2, I)        # all items get a guessing parameter of .2
cI[ c(7,9) ] &lt;- .25     # 7th and 9th get a guessing parameter of .25
dI &lt;- rep( .95, I )    # upper asymptote of .95
dI[ c(7,11) ] &lt;- 1        # 7th and 9th item have an asymptote of 1

# latent regression model
mod1 &lt;- sirt::latent.regression.em.raschtype( data=dat1, X=dfr[,-1],
           b=b, c=cI, d=dI    )
  ## Regression Parameters
  ##
  ##        est se.simple     se        t p   beta    fmi N.simple pseudoN.latent
  ## X1 -0.7929    0.0243 0.0315 -25.1818 0 0.0000 0.4044     2000       1247.306
  ## x   0.5025    0.0188 0.0241  20.8273 0 0.5093 0.3936     2000       1247.306
  ## y   0.2149    0.0209 0.0266   8.0850 0 0.1960 0.3831     2000       1247.306
  ##
  ## Residual Variance=0.9338
  ## Explained Variance=0.5487
  ## Total Variance=1.4825
  ##                 R2=0.3701

#############################################################################
# EXAMPLE 3: Measurement error in dependent variable
#############################################################################

set.seed(8766)
N &lt;- 4000       # number of persons
X &lt;- stats::rnorm(N)           # independent variable
Z &lt;- stats::rnorm(N)           # independent variable
y &lt;- .45 * X + .25 * Z + stats::rnorm(N)   # dependent variable true score
sig.e &lt;- stats::runif( N, .5, .6 )       # measurement error standard deviation
yast &lt;- y + stats::rnorm( N, sd=sig.e ) # dependent variable measured with error

#****
# Model 1: Estimation with latent.regression.em.raschtype using
#          individual likelihood
# define theta grid for evaluation of density
theta.list &lt;- mean(yast) + stats::sd(yast) * seq( - 5, 5, length=21)
# compute individual likelihood
f.yi.qk &lt;- stats::dnorm( outer( yast, theta.list, "-" ) / sig.e )
f.yi.qk &lt;- f.yi.qk / rowSums(f.yi.qk)
# define predictor matrix
X1 &lt;- as.matrix(data.frame( "intercept"=1, "X"=X, "Z"=Z ))

# latent regression model
res &lt;- sirt::latent.regression.em.raschtype( f.yi.qk=f.yi.qk,
                    X=X1, theta.list=theta.list)
  ##   Regression Parameters
  ##
  ##                est se.simple     se       t      p   beta    fmi N.simple pseudoN.latent
  ##   intercept 0.0112    0.0157 0.0180  0.6225 0.5336 0.0000 0.2345     4000       3061.998
  ##   X         0.4275    0.0157 0.0180 23.7926 0.0000 0.3868 0.2350     4000       3061.998
  ##   Z         0.2314    0.0156 0.0178 12.9868 0.0000 0.2111 0.2349     4000       3061.998
  ##
  ##   Residual Variance=0.9877
  ##   Explained Variance=0.2343
  ##   Total Variance=1.222
  ##                   R2=0.1917

#****
# Model 2: Estimation with latent.regression.em.normal
res2 &lt;- sirt::latent.regression.em.normal( y=yast, sig.e=sig.e, X=X1)
  ##   Regression Parameters
  ##
  ##                est se.simple     se       t      p   beta    fmi N.simple pseudoN.latent
  ##   intercept 0.0112    0.0157 0.0180  0.6225 0.5336 0.0000 0.2345     4000       3062.041
  ##   X         0.4275    0.0157 0.0180 23.7927 0.0000 0.3868 0.2350     4000       3062.041
  ##   Z         0.2314    0.0156 0.0178 12.9870 0.0000 0.2111 0.2349     4000       3062.041
  ##
  ##   Residual Variance=0.9877
  ##   Explained Variance=0.2343
  ##   Total Variance=1.222
  ##                   R2=0.1917

  ## -&gt; Results between Model 1 and Model 2 are identical because they use
  ##    the same input.

#***
# Model 3: Regression model based on true scores y
mod3 &lt;- stats::lm( y ~ X + Z )
summary(mod3)
  ##   Coefficients:
  ##               Estimate Std. Error t value Pr(&gt;|t|)
  ##   (Intercept)  0.02364    0.01569   1.506    0.132
  ##   X            0.42401    0.01570  27.016   &lt;2e-16 ***
  ##   Z            0.23804    0.01556  15.294   &lt;2e-16 ***
  ##   Residual standard error: 0.9925 on 3997 degrees of freedom
  ##   Multiple R-squared:  0.1923,    Adjusted R-squared:  0.1919
  ##   F-statistic: 475.9 on 2 and 3997 DF,  p-value: &lt; 2.2e-16

#***
# Model 4: Regression model based on observed scores yast
mod4 &lt;- stats::lm( yast ~ X + Z )
summary(mod4)
  ##   Coefficients:
  ##               Estimate Std. Error t value Pr(&gt;|t|)
  ##   (Intercept)  0.01101    0.01797   0.613     0.54
  ##   X            0.42716    0.01797  23.764   &lt;2e-16 ***
  ##   Z            0.23174    0.01783  13.001   &lt;2e-16 ***
  ##   Residual standard error: 1.137 on 3997 degrees of freedom
  ##   Multiple R-squared:  0.1535,    Adjusted R-squared:  0.1531
  ##   F-statistic: 362.4 on 2 and 3997 DF,  p-value: &lt; 2.2e-16

## End(Not run)
</code></pre>


</div>