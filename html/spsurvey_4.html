<div class="container">

<table style="width: 100%;"><tr>
<td>ash1_wgt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the average shifted histogram (ASH) for one-dimensional weighted data</h2>

<h3>Description</h3>

<p>Calculate the average shifted histogram estimate of a density based on one-dimensional data
from a survey design with weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ash1_wgt(
  x,
  wgt = rep(1, length(x)),
  m = 5,
  nbin = 50,
  ab = NULL,
  support = "Continuous"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector used to estimate the density. <code>NA</code> values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgt</code></td>
<td>
<p>Vector of weights for each observation from a
probability sample. The default assigns equal weights (equal probability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of empty bins to add to the ends when the range is not
completely specified.  The default is <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbin</code></td>
<td>
<p>Number of bins for density estimation.  The default is <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ab</code></td>
<td>
<p>Optional range for support associated with the density. Both
values may be equal to <code>NA</code>.  If equal to <code>NA</code>, then corresponding limit will
be based on <code>nicerange()</code>. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support</code></td>
<td>
<p>Type of support.  If equal to <code>"Continuous"</code>, then data are
from a continuous distribution.  If equal to <code>"Ordinal"</code>, then data are from
a discrete distribution defined for integers only.  The default is
<code>"Continuous"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the ASH density estimate.  List consists of
</p>

<dl>
<dt><code>tcen</code></dt>
<dd>
<p> x-coordinate for center of bin</p>
</dd>
<dt><code>f</code></dt>
<dd>
<p> y-coordinate for density estimate height</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Tony Olsen <a href="mailto:Olsen.tony@epa.gov">Olsen.tony@epa.gov</a>
</p>


<h3>References</h3>

<p>Scott, D. W. (1985). "Averaged shifted histograms: effective nonparametric
density estimators in several dimensions." <em>The Annals of Statistics</em> 13(3):
1024-1040.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(100, 10, sqrt(10))
wgt &lt;- runif(100, 10, 100)
rslt &lt;- ash1_wgt(x, wgt)
plot(rslt)
</code></pre>


</div>