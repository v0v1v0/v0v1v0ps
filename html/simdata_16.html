<div class="container">

<table style="width: 100%;"><tr>
<td>optimize_cor_mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find initial correlation matrix for NORTA from target correlation</h2>

<h3>Description</h3>

<p>This function can be used to find a suitable correlation matrix to be used
for simulating initial multivariate normal data in a NORTA based simulation
design (see <code>simdesign_norta</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">optimize_cor_mat(
  cor_target,
  dist,
  ensure_cor_mat = TRUE,
  conv_norm_type = "O",
  return_diagnostics = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cor_target</code></td>
<td>
<p>Target correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>List of functions of marginal distributions for simulated variables.
Must have the same length as the specified correlation matrix
(<code>cor_target</code>), and the order of the entries must correspond to the
variables in the correlation matrix. See <code>simdesign_norta</code> for
details of the specification of the marginal distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ensure_cor_mat</code></td>
<td>
<p>if TRUE, this function ensures that the optimized matrix is a proper
correlation matrix by ensuring positive definitiness. If FALSE, the
optimized matrix is returned as is.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv_norm_type</code></td>
<td>
<p>Metric to be used to find closest positive definite matrix to optimal matrix,
used if <code>ensure_cor_mat</code> is TRUE.
Passed to <code>Matrix::nearPD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_diagnostics</code></td>
<td>
<p>TRUE to return additional diagnostics of the optimization procedure, see
below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed to <code>optimize_cor_for_pair</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function first finds a suitable correlation matrix for the underlying
multivariate normal data used in the NORTA procedure. It does so by
solving k*(k-1) univariable optimisation problems (where k is the number
of variables). In case the result is not a positive-definite matrix, the
nearest positive-definite matrix is found according to the user specified
metric using <code>Matrix::nearPD</code>.
See e.g. Ghosh and Henderson (2003) for an overview of the procedure.
</p>


<h3>Value</h3>

<p>If <code>return_diagnostics</code> is FALSE, a correlation matrix to be used in the
definition of a <code>simdesign_norta</code> object. If TRUE, then a list
with two entries: <code>cor_mat</code> containing the correlation matrix, and
<code>convergence</code> containing a list of objects returned by the individual
optimisation problems from <code>stats::uniroot</code>.
</p>


<h3>References</h3>

<p>Ghosh, S. and Henderson, S. G. (2003) <em>Behavior of the
NORTA method for correlated random vector generation as the dimension
increases</em>. ACM Transactions on Modeling and Computer Simulation.
</p>


<h3>See Also</h3>

<p><code>simdesign_norta</code>
</p>


</div>