<div class="container">

<table style="width: 100%;"><tr>
<td>broken.line</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Fitted values for segmented relationships</h2>

<h3>Description</h3>

<p>Given a segmented model (typically returned by a <code>segmented</code> method), <code>broken.line</code>
computes the fitted values (and relevant standard errors) for the specified ‘segmented’ relationship.
</p>


<h3>Usage</h3>

<pre><code class="language-R">broken.line(ogg, term = NULL, link = TRUE, interc=TRUE, se.fit=TRUE, isV=FALSE, 
  .vcov=NULL, .coef=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ogg</code></td>
<td>
<p> A fitted object of class segmented (returned by any <code>segmented</code> method). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p> Three options. i) A named list (whose name should be one of the segmented covariates in the model <code>ogg</code>) 
including the covariate values for which segmented predictions should be computed; ii) a character meaning 
the name of any segmented covariate in the model (and predictions corresponding to the observed covariate values are returned); 
iii) It can be <code>NULL</code> if the model includes a single segmented covariate (and predictions corresponding to the observed covariate values are returned).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p> Should the predictions be computed on the scale of the link function if <code>ogg</code> is a segmented glm fit? Default to <code>TRUE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interc</code></td>
<td>
<p> Should the model intercept be added? (provided it exists).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p> If <code>TRUE</code> also standard errors for predictions are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isV</code></td>
<td>
<p> A couple of logicals indicating if the segmented terms <code class="reqn">(x-\psi)_+</code> and <code class="reqn">I(x&gt;\psi)</code> in the model matrix should be replaced by their smoothed counterparts when computing the standard errors. If a single logical is provided, it is applied to both terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.vcov</code></td>
<td>
<p> Optional. The <em>full</em> covariance matrix of estimates. If <code>NULL</code> (and <code>se.fit=TRUE</code>), the matrix is computed internally via <code>vcov.segmented()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.coef</code></td>
<td>
<p> The regression parameter estimates. If unspecified (i.e. <code>NULL</code>), it is computed internally by <code>coef(ogg)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments to be passed on to <code>vcov.segmented()</code> when computing the standard errors for the predictions, namely
<code>is</code>, <code>var.diff</code>, <code>p.df</code>. See <code>summary.segmented</code> and <code>vcov.segmented</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>term=NULL</code> or <code>term</code> is a valid segmented covariate name, 
predictions for that segmented variable are the relevant fitted values from the model. If <code>term</code> 
is a (correctly named) list with numerical values, predictions corresponding to such specified values 
are computed. If <code>link=FALSE</code> and <code>ogg</code> inherits from the class "glm", predictions and possible standard 
errors are returned on the response scale. The standard errors come from the Delta method.
Argument <code>link</code> is ignored whether <code>ogg</code> does not inherit from the class "glm".
</p>


<h3>Value</h3>

<p>A list having one component if (if <code>se.fit=FALSE</code>), and two components (if <code>se.fit=TRUE</code>) list representing predictions and standard errors for the segmented covariate values.
</p>


<h3>Note</h3>

 
<p>This function was written when there was not <code>predict.segmented</code> (which is more general).
</p>


<h3>Author(s)</h3>

<p> Vito M. R. Muggeo </p>


<h3>See Also</h3>

 <p><code>segmented</code>, <code>predict.segmented</code>, <code>plot.segmented</code>, <code>vcov.segmented</code></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
z&lt;-runif(100)
y&lt;-rpois(100,exp(2+1.8*pmax(z-.6,0)))
o&lt;-glm(y~z,family=poisson)
o.seg&lt;-segmented(o,seg.Z=~z)
## Not run: plot(z,y)
## Not run: points(z,broken.line(o.seg,link=FALSE)$fit,col=2) #ok, but use plot.segmented()!
    </code></pre>


</div>