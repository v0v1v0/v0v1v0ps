<div class="container">

<table style="width: 100%;"><tr>
<td>ceps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cepstrum or real cepstrum</h2>

<h3>Description</h3>

<p>This function returns the cepstrum of a time wave allowing fundamental
frequency detection.</p>


<h3>Usage</h3>

<pre><code class="language-R">ceps(wave, f, channel = 1, phase = FALSE, wl = 512, at = NULL, from = NULL, to = NULL,
tidentify = FALSE, fidentify = FALSE, col = "black", cex = 1, plot = TRUE,
qlab = "Quefrency (bottom: s, up: Hz)", alab = "Amplitude",
qlim = NULL, alim = NULL, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>if <code>TRUE</code> than the phase is taken into account in
the computation of the cepstrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>if <code>at</code> is not null, length of the window for the analysis
(even number of points, by defaults = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>position where to compute the cepstrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>start position where to compute the cepstrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>end position to compute the cepstrum (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tidentify</code></td>
<td>
<p>to identify time values on the plot with the help of a cursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fidentify</code></td>
<td>
<p>to identify frequency values on the plot with the help of a cursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of the cepstrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>pitch size of the cepstrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the cepstrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlab</code></td>
<td>
<p>title of the quefrency axis (in s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alab</code></td>
<td>
<p>title of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlim</code></td>
<td>
<p>range of quefrency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alim</code></td>
<td>
<p>range of amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cepstrum of a time wave is the inverse Fourier transform of the logarithm
of the Fourier transform. The cepstrum of a wave <em>s</em> is then calculated as follows:<br></p>
<p style="text-align: center;"><code class="reqn">C(s) = Re[FFT^{-1}(\log{(|FFT(s)|)]}</code>
</p>
<p><br></p>
<p>The independent variable of a cepstral graph is called the quefrency.
The quefrency is a measure of time, though not in the sense of a signal
in the time domain. A correspondence with the frequency domain is obtained
by simply computing the reverse of the temporal x coordinate. For instance if
a peak appears at 0.005 s, this reveals a frequency peak at 200 Hz (=1/0.005).
This explain the two scales plotted when <code>plot</code> is <code>TRUE</code>. <br>
If <code>at</code>, <code>from</code> or <code>to</code> are <code>FALSE</code> then <code>ceps</code> 
computes the cepstrum of the whole signal.<br>
When using <code>tidentify</code> or <code>tidentify</code>, press ‘stop’
tools bar button to return values in the console.
</p>


<h3>Value</h3>

<p>When <code>plot</code> is <code>FALSE</code>, <code>ceps</code> returns the cesptral profile as a two-column matrix, the first column corresponding to quefrency (<em>x</em>-axis) and the second
corresponding to amplitude (<em>y</em>-axis).
</p>


<h3>Warning</h3>

<p>The argument <code>peaks</code> is no more available
(version &gt; 1.5.6). See the function <code>fpeaks</code>
for peak(s) detection.</p>


<h3>Note</h3>

<p>Cepstral analysis is mainly used in speech processing.
This analysis allows to extract the fundamental frequency, see the examples.<br>
This function is based on <code>fft</code>.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>References</h3>

<p>Oppenheim, A.V. and Schafer, R.W. 2004. From frequency
to quefrency: a history of the cepstrum. <em>Signal Processing Magazine IEEE</em>,
21: 95-106.</p>


<h3>See Also</h3>

<p><code>cepstro</code>, <code>fund</code>, <code>autoc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(sheep)
par(mfrow=c(2,1))
# phase not taken into account
ceps(sheep,f=8000,at=0.4,wl=1024)
# phase taken into account
ceps(sheep,f=8000,at=0.4,wl=1024, phase=TRUE)
</code></pre>


</div>