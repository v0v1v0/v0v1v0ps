<div class="container">

<table style="width: 100%;"><tr>
<td>buildReferenceFromHarmonyObj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for building a Symphony reference from a Harmony object. Useful if you would like your
code to be more modular. Note that you must have saved vargenes_means_sds and PCA loadings.</h2>

<h3>Description</h3>

<p>Function for building a Symphony reference from a Harmony object. Useful if you would like your
code to be more modular. Note that you must have saved vargenes_means_sds and PCA loadings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildReferenceFromHarmonyObj(
  harmony_obj,
  metadata,
  vargenes_means_sds,
  pca_loadings,
  verbose = TRUE,
  do_umap = TRUE,
  save_uwot_path = NULL,
  umap_min_dist = 0.1,
  seed = 111
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>harmony_obj</code></td>
<td>
<p>Harmony object (output from HarmonyMatrix())</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>Reference cell metadata (cells by attributes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vargenes_means_sds</code></td>
<td>
<p>Variable genes in dataframe with columns named ('symbol', 'mean', 'stddev')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca_loadings</code></td>
<td>
<p>Gene loadings from PCA (e.g. irlba(ref_exp_scaled, nv = 20)$u)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_umap</code></td>
<td>
<p>Perform UMAP visualization on harmonized reference embedding</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_uwot_path</code></td>
<td>
<p>Absolute path to save the uwot model (if do_umap is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umap_min_dist</code></td>
<td>
<p>UMAP parameter (see uwot documentation for details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Symphony reference object. Integrated embedding is stored in the $Z_corr slot. Other slots include
cell-level metadata ($meta_data), variable genes means and standard deviations ($vargenes),
loadings from PCA or other dimensional reduction such as CCA ($loadings), original PCA embedding ($Z_orig),
reference compression terms ($cache), betas from Harmony integration ($betas), cosine-normalized soft cluster centroids ($centroids),
centroids in PC space ($centroids_pc), and optional umap coordinates ($umap$embedding).
</p>


</div>