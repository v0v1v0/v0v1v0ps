<div class="container">

<table style="width: 100%;"><tr>
<td>LocSig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Temporal Block Bootstrap Keeping Locations in Space Constant
</h2>

<h3>Description</h3>

<p>Temporal block bootstrap for data at spatial locations (holding locations constant at each iteration).  This is a wrapper function to the tsboot or boot functions for use with the field significance approach of Elmore et al. (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LocSig(Z, numrep = 1000, block.length = NULL, bootfun = "mean",
    alpha = 0.05, bca = FALSE, ...)

## S3 method for class 'LocSig'
plot(x, loc = NULL, nx = NULL, ny = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>n by m numeric matrix whose rows represent contiguous time points, and whose columns represent spatial locations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numrep</code></td>
<td>

<p>numeric/integer giving the number of bootstrap replications to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.length</code></td>
<td>

<p>positive numeric/integer giving the desired block lengths.  If NULL, <code>floor(sqrt(n))</code> is used.  If 1, then the IID bootstrap is performed, and the BCa method may be used to find CI's, if <code>bca</code> is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootfun</code></td>
<td>

<p>character naming an R function to be applied to each replicate sample.  Must return a single number, but is otherwise the <code>statistic</code> argument for function <code>tsboot</code> (or <code>boot</code> if <code>block.length</code> = 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric giving the value of <code>alpha</code> to obtain (1-<code>alpha</code>)*100 percent CI's for <code>bootfun</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bca</code></td>
<td>

<p>logical, should bias-corrected and adjusted (BCa) CI's be calculated?  Only used if <code>block.length</code> = 1.  Will give a warning if this argument is TRUE, and <code>block.length</code> &gt; 1, and will use the percentile method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data frame of class “LocSig” as returned by <code>LocSig</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p> m by 2 matrix of location coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx,ny</code></td>
<td>
<p> If <code>loc</code> is NULL, then <code>nx</code> and <code>ny</code> must be supplied.  These give the number of rows and columns of a grid to make an image (using <code>as.image</code>) for plotting.  If these are used, the data <code>Z</code> must be from a regular grid of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p><code>LocSig</code>: optional additional arguments to the <code>tsboot</code> (or <code>boot</code> if <code>block.length</code>=1) function.
<code>plot.LocSig</code>: optional additional arguments to <code>image.plot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs the circular block bootstrap algorithm over time at each of m locations (columns of <code>x</code>).  So, at each bootstrap iteration, entire blocks of rows of x are resampled with replacement.  If <code>Z</code> represents forecast errors at grid points, and <code>bootfun</code>=“mean”, then this finds the grid-point CI's in steps 1 (a) to 1 (c) of Elmore et al. (2006).
</p>


<h3>Value</h3>

<p>LocSig: A data frame with class attribute “LocSig” with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Estimate </code></td>
<td>
<p>numeric giving the estimated values of bootfun (the statistic for which CI's are computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lower, Upper </code></td>
<td>
<p>numeric giving the estimated lower (upper) (1-alpha)*100 percent CI's.</p>
</td>
</tr>
</table>
<p>plot.LocSig: invisibly returns a list containing the estimate as returned by LocSig, and the confidence range.
</p>


<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Elmore, K. L., Baldwin, M. E. and Schultz, D. M. (2006) Field significance revisited: Spatial bias errors in forecasts as applied to the Eta model.  <em>Mon. Wea. Rev.</em>, <b>134</b>, 519–531.
</p>


<h3>See Also</h3>

<p><code>spatbiasFS</code>, <code>tsboot</code>, <code>boot</code>, <code>boot.ci</code>, <code>MCdof</code>, <code>sig.cor.t</code>, <code>sig.cor.Z</code>, <code>cor.test</code>, <code>image.plot</code>, <code>as.image</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data( "GFSNAMfcstEx" )
data( "GFSNAMobsEx" )
data( "GFSNAMlocEx" )

id &lt;- GFSNAMlocEx[,"Lon"] &gt;=-90 &amp; GFSNAMlocEx[,"Lon"] &lt;= -75 &amp; GFSNAMlocEx[,"Lat"] &lt;= 40

look &lt;- LocSig(GFSNAMfcstEx[,id] - GFSNAMobsEx[,id], numrep=500)

stats(look)

plot(look, loc = GFSNAMlocEx[ id, ] )

## End(Not run)
</code></pre>


</div>