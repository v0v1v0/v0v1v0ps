<div class="container">

<table style="width: 100%;"><tr>
<td>boot2lme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Resampling variances for svy2lme
</h2>

<h3>Description</h3>

<p>Computes variance estimates for the weighted-pairwise-likelihood
linear mixed models fitted by <code>svy2lme</code> using replicate
weights.  The replicate weights for a pair are obtained by dividing by
the sampling weight and then multiplying by the replicate
weight. There will be a warning if the ratio of replicate weight to
sampling weight differs for observations in the same pair.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot2lme(model, rdesign,  verbose = FALSE)
## S3 method for class 'boot2lme'
vcov(object,
   parameter=c("beta", "theta","s2", "relSD" ,"SD","relVar","fullVar"),
   ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>A model returned by <code>svy2lme</code> with the <code>devfun=TRUE</code> option
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdesign</code></td>
<td>

<p>replicate-weights design corresponding to the design used to fit the model, see example
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>print progess information?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>returned by <code>boot2lme</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for method compatibility</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>Variance matrix for: regression parameters, relative variance
parameters on Cholesky square root scale, residual variance, relative
standard errors of random effects, standard errors of random effects,
entire relative variance matrix, entire variance matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variance is estimated from the replicates <code>thetastar</code> and original point estimate <code>theta</code> as <code>scale*sum(rscales* (thetastar-theta)^2)</code>. 
</p>


<h3>Value</h3>

<p>For <code>boot2lme</code>, an object of class <code>boot2lme</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>replicates of variance parameters (on Cholesky square
root scale)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>replicates of regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>replicates of relative variance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale,rscales</code></td>
<td>
<p>from the input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>model formula from the input</p>
</td>
</tr>
</table>
<p>For the <code>vcov</code> method, a variance matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(api, package="survey")

# two-stage cluster sample
dclus2&lt;-svydesign(id=~dnum+snum, fpc=~fpc1+fpc2, data=apiclus2)

m0&lt;-svy2lme(api00~(1|dnum)+ell+mobility, design=dclus2,return.devfun=TRUE)
jkdes&lt;-as.svrepdesign(dclus2, type="mrb")
jkvar&lt;-boot2lme(m0,jkdes)

SE(jkvar, "beta")
SE(jkvar, "SD")
SE(jkvar,"s2")


m1&lt;-svy2lme(api00~(1|dnum)+ell+mobility,
design=dclus2,return.devfun=TRUE, all.pairs=TRUE, subtract.margins=TRUE)
jk1var&lt;-boot2lme(m1,jkdes)

SE(jk1var, "beta")
SE(jk1var, "SD")



##takes a few minutes
data(pisa)

pisa$w_condstuwt&lt;-with(pisa, w_fstuwt/wnrschbw)
pisa$id_student&lt;-1:nrow(pisa)

dpisa&lt;-survey::svydesign(id=~id_school+id_student, weight=~wnrschbw+w_condstuwt, data=pisa)

m&lt;-svy2lme(isei~(1+female|id_school)+female+high_school+college+one_for+both_for+test_lang,
	design=dpisa, return.devfun=TRUE,method="nested")

bpisa&lt;-as.svrepdesign(dpisa, type="bootstrap", replicates=100)

b&lt;-boot2lme(m, bpisa, verbose=TRUE)
str(b)

vcov(b,"beta")
vcov(b,"s2")

## SE() inherits the parameter= argument
SE(b,"beta")
SE(b,"theta")
SE(b,"SD")


</code></pre>


</div>