<div class="container">

<table style="width: 100%;"><tr>
<td>swc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Soil water Retantion Curve and Unsaturated Hydraulic Conductivity</h2>

<h3>Description</h3>

<p>Soil Water Retention Curve 'swc', Hydraulic Conductivity 'khy' , Soil Water Capacity 'cap' , Soil Water (Hydraulic) Diffusivity 'diffusivity'
</p>


<h3>Usage</h3>

<pre><code class="language-R">swc(psi = 0.5, alpha = 1, n = 1.5, m = 1 - 1/n, theta_sat = 0.4,
  theta_res = 0.05, psi_s = -1/alpha, lambda = m * n,
  saturation_index = FALSE, type_swc = c("VanGenuchten", "BrooksAndCorey"),
  ...)

khy(psi = 0.5, v = 0.5, ksat = 0.01, alpha = 1, n = 1.5, m = 1 -
  1/n, theta_sat = 0.4, theta_res = 0.05, psi_s = -1/alpha, lambda = m *
  n, b = NA, type_swc = "VanGenuchten", type_khy = c("Mualem",
  "BrooksAndCorey"), ...)

cap(psi = 0.5, alpha = 1, n = 1.5, m = 1 - 1/n, theta_sat = 0.4,
  theta_res = 0.05, type_swc = "VanGenuchten", ...)

diffusivity(psi = 0.5, v = 0.5, ksat = 0.01, alpha = 1, n = 1.5,
  m = 1 - 1/n, theta_sat = 0.4, theta_res = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>soil wwater pressure head</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>inverse of a length - scale parameters in Van Genuchten Formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>shape parameter in Van Genuchten Formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>shape parameter in Van Genuchten Formula. Default is <code>1-1/n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_sat</code></td>
<td>
<p>saturated water content</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_res</code></td>
<td>
<p>residual water content</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi_s</code></td>
<td>
<p>psi_s value (capillary fringe) in Brook and Corey formula. It is used in case <code>type_swc</code> and/or <code>type_khy</code> are equal to <code>BrooksAndCorey</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda, b</code></td>
<td>
<p>lambda and b exponents in Brook and Corey formula. It is used in case <code>type_swc</code> and/or <code>type_khy</code> are equal to <code>BrooksAndCorey</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saturation_index</code></td>
<td>
<p>logical index, If <code>TRUE</code> (Default) the function <code>swc()</code> returns soil water content, otherwise a saturation index between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_swc</code></td>
<td>
<p>type of Soil Water Retention Curve. Default is <code>"VanGenuchten"</code> and actually the only implemented type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments which are passed to <code>swc()</code> and <code>khy()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>exponent in Mualem Formula for Hydraulic Conductivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksat</code></td>
<td>
<p>saturated hydraulic conductivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_khy</code></td>
<td>
<p>type of Soil Hydraulic Conductivity Curve. Default is <code>"Mualem"</code> and actually the only implemented type</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
library(soilwater)
soiltype &lt;- c("sand","silty-sand","loam","clay")
theta_sat &lt;- c(0.44,0.39,0.51,0.48)
theta_res &lt;- c(0.02,0.155,0.04,0.10)
alpha &lt;- c(13.8,6.88,9.0,2.7) # 1/meters
n &lt;- c(2.09,1.881,1.42,1.29) 
m &lt;- 1-1/n
v &lt;- array(0.5,length(soiltype))
ks &lt;- c(1.5e-1,1e-4*3600,3.3e-2,4.1e-4)/3600   # meters/seconds

psi &lt;- -(1:2000)/1000

D &lt;- as.data.frame(array(0.1,c(length(psi),length(soiltype))))
names(D) &lt;- soiltype
for (it in names(D)) {
  
  i=which(names(D)==it)
  D[,i] &lt;- diffusivity(psi=psi,
            v=v[i],ksat=ks[i],alpha=alpha[i],
            n=n[i],m=m[i],theta_sat=theta_sat[i],
            theta_res=theta_res[i])
 
}
# plot diffusivity on log scale 
lty &lt;- 1:length(names(D) )

plot(psi,D[,1],lty=lty[1],main="Diffusvity vs psi",xlab="psi [m]",
ylab="D [m^2/s]",type="l",ylim=range(D),ylog=TRUE)
for (i in 2:ncol(D)) {
  lines(psi,D[,i],lty=lty[i]) 
}
legend("topleft",lty=lty,legend=names(D))
Dinv &lt;- 1/D 

# pot diffusivity on log scale 
lty &lt;- 1:length(names(D) )

plot(psi,Dinv[,1],lty=lty[1],main="1/Diffusvity vs psi",
xlab="psi [m]",ylab="1/D [s/m^2]",type="l",ylim=range(Dinv),ylog=TRUE)
for (i in 2:ncol(Dinv)) {
  lines(psi,Dinv[,i],lty=lty[i]) 
}
legend("topright",lty=lty,legend=names(D))
</code></pre>


</div>