<div class="container">

<table style="width: 100%;"><tr>
<td>carapeto_holt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Carapeto-Holt Test for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the two methods (parametric and nonparametric) of
Carapeto and Holt (2003) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">carapeto_holt(
  mainlm,
  deflator = NA,
  prop_central = 1/3,
  group1prop = 1/2,
  qfmethod = "imhof",
  alternative = c("greater", "less", "two.sided"),
  twosidedmethod = c("doubled", "kulinskaya"),
  statonly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_central</code></td>
<td>
<p>A double specifying the proportion of central
observations to exclude when comparing the two subsets of observations.
<code>round</code> is used to ensure the number of central
observations is an integer. Defaults to <code class="reqn">\frac{1}{3}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group1prop</code></td>
<td>
<p>A double specifying the proportion of remaining
observations <em>(after excluding central observations)</em> to allocate
to the first group. The default value of <code>1 / 2</code> means that an
equal number of observations is assigned to the first and second groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qfmethod</code></td>
<td>
<p>A character, either <code>"imhof"</code>, <code>"davies"</code>, or
<code>"integrate"</code>, corresponding to the <code>algorithm</code> argument
of <code>pRQF</code>. The default is <code>"imhof"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character specifying the form of alternative
hypothesis. If it is suspected that the error variance is positively
associated with the deflator variable, <code>"greater"</code>. If it is
suspected that the error variance is negatively associated with deflator
variable, <code>"less"</code>. If no information is available on the suspected
direction of the association, <code>"two.sided"</code>. Defaults to
<code>"greater"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosidedmethod</code></td>
<td>
<p>A character indicating the method to be used to compute
two-sided <code class="reqn">p</code>-values for the parametric test when <code>alternative</code>
is <code>"two.sided"</code>. The argument is passed to
<code>twosidedpval</code> as its <code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is based on the methodology of
Goldfeld and Quandt (1965) but does not require any
auxiliary regression. It entails ordering the observations by some
suspected deflator (one of the explanatory variables) in such a way
that, under the alternative hypothesis, the observations would now
be arranged in decreasing order of error variance. A specified proportion
of the most central observations (under this ordering) is removed,
leaving a subset of lower observations and a subset of upper
observations. The test statistic is then computed as a ratio of quadratic
forms corresponding to the sums of squared residuals of the upper and
lower observations respectively. <code class="reqn">p</code>-values are computed by the
Imhof algorithm in <code>pRQF</code>.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Carapeto M, Holt W (2003).
“Testing for Heteroscedasticity in Regression Models.”
<em>Journal of Applied Statistics</em>, <b>30</b>(1), 13–20.<br><br> Goldfeld SM, Quandt RE (1965).
“Some Tests for Homoscedasticity.”
<em>Journal of the American Statistical Association</em>, <b>60</b>(310), 539–547.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
carapeto_holt(mtcars_lm, deflator = "qsec", prop_central = 0.25)
# Same as previous example
mtcars_list &lt;- list("y" = mtcars$mpg, "X" = cbind(1, mtcars$wt, mtcars$qsec, mtcars$am))
carapeto_holt(mtcars_list, deflator = 3, prop_central = 0.25)

</code></pre>


</div>