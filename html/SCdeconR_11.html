<div class="container">

<table style="width: 100%;"><tr>
<td>load_scdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load, filter and normalize scRNA-seq/snRNA-seq data</h2>

<h3>Description</h3>

<p>Load and preprocess scRNA-seq/snRNA-seq data using seurat SCTransform workflow.
</p>


<h3>Usage</h3>

<pre><code class="language-R">load_scdata(
  ref,
  data_type = c("cellranger", "h5", "matrix"),
  meta_info,
  nfeature_rna = 200,
  percent_mt = 40,
  cc.genes = NULL,
  vars_to_regress = c("percent_mt", "phase"),
  id,
  verbose,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>path to scRNA-seq/snRNA-seq data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_type</code></td>
<td>
<p>a character value specifying data type of the input scRNA-seq/snRNA-seq data, should be one of "cellranger", "h5", "matrix".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta_info</code></td>
<td>
<p>a data.frame with rows representing cells, columns representing cell attributes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfeature_rna</code></td>
<td>
<p>minimum # of features with non-zero UMIs. Cells with # of features lower than nfeature_rna will be removed. Default to 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_mt</code></td>
<td>
<p>maximum percentage of mitochondria (MT) mapped UMIs. Cells with MT percentage higher than percent_mt will be removed. Default to 40.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc.genes</code></td>
<td>
<p>cell-cycle genes curated by Seurat. Can be loaded via <code>data(cc.genes)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_to_regress</code></td>
<td>
<p>a list of character values indicating the variables to regress for SCTransform normalization step. Default is to regress
out MT percentage ("percent_mt") &amp; cell cycle effects ("phase")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a character value specifying project or sample id. Only used for printing purposes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical value indicating whether to print messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to <code>SCTransform</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For more details, refer to <code>construct_ref</code>
</p>


<h3>Value</h3>

<p>a <code>Seurat-class</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
samplepath1 &lt;- paste0(system.file("extdata", package = "SCdeconR"), "/refdata/sample1")
samplepath2 &lt;- paste0(system.file("extdata", package = "SCdeconR"), "/refdata/sample2")
ref_list &lt;- c(samplepath1, samplepath2)
phenopath1 &lt;- paste0(system.file("extdata", package = "SCdeconR"),
"/refdata/phenodata_sample1.txt")
phenopath2 &lt;- paste0(system.file("extdata", package = "SCdeconR"),
"/refdata/phenodata_sample2.txt")
phenodata_list &lt;- c(phenopath1,phenopath2)
tmp &lt;- load_scdata(
  ref = ref_list[[1]],
  data_type = c("cellranger"),
  meta_info = data.table::fread(file = phenodata_list[[1]], check.names = FALSE, header = TRUE),
  nfeature_rna = 50,
  vars_to_regress = c("percent_mt"),
  id = 1,
  verbose = TRUE)

</code></pre>


</div>