<div class="container">

<table style="width: 100%;"><tr>
<td>generate_subgroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Dataset with different treatment effect in subgroup</h2>

<h3>Description</h3>

<p>Generate Dataset with different treatment effect in subgroup
</p>
<p>Create an empty assumtions data.frame for generate_subgroup
</p>
<p>Calculate true summary statistics for scenarios with differential treatment effect in subgroup
</p>
<p>Calculate hazards in treatment arm in subgroup and compliment
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_subgroup(condition, fixed_objects = NULL)

assumptions_subgroup(print = interactive())

true_summary_statistics_subgroup(
  Design,
  cutoff_stats = NULL,
  milestones = NULL,
  fixed_objects = NULL
)

hazard_subgroup_from_PH_effect_size(
  design,
  target_power_ph = NA_real_,
  final_events = NA_real_,
  target_alpha = 0.025
)

cen_rate_from_cen_prop_subgroup(design)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>condition row of Design dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_objects</code></td>
<td>
<p>additional settings, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>print code to generate parameter set?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Design</code></td>
<td>
<p>Design data.frame for subgroup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff_stats</code></td>
<td>
<p>(optionally named) cutoff times, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>milestones</code></td>
<td>
<p>(optionally named) vector of times at which milestone survival should be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>design data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_power_ph</code></td>
<td>
<p>target power under proportional hazards</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_events</code></td>
<td>
<p>target events for inversion of Schönfeld Formula, defaults to <code>condition$final_events</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_alpha</code></td>
<td>
<p>target one-sided alpha level for the power calculation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Condidtion has to contain the following columns:
</p>

<ul>
<li>
<p> n_trt number of paitents in treatment arm
</p>
</li>
<li>
<p> n_ctrl number of patients in control arm
</p>
</li>
<li>
<p> hazard_ctrl hazard in the control arm
</p>
</li>
<li>
<p> hazard_trt hazard in the treatment arm for not cured patients
</p>
</li>
<li>
<p> hazard_subgroup hazard in the subgroup in the treatment arm
</p>
</li>
<li>
<p> prevalence proportion of cured patients
</p>
</li>
</ul>
<p>assumptions_subgroup generates a default design <code>data.frame</code> for use
with generate_subgroup If print is <code>TRUE</code> code to produce the template is
also printed for copying, pasting and editing by the user. (This is the
default when run in an interactive session.)
</p>
<p><code>cutoff_stats</code> are the times used to calculate the statistics like average
hazard ratios and RMST, that are only calculated up to a certain point.
</p>
<p><code>hazard_subgroup_from_PH_effect_size</code> calculates the hazard rate in
the subgroup and the compliment of the subgroup in the treatment arm as
follows: First, the hazard ratio needed to archive the desired power under
proportional hazards is calculated by inverting Schönfeld's sample size
formula. Second the median survival times for both arms under this hazard
ratio and proportional hazards are calculated. Finally the hazard rate of
the treatment arm in the subgroup and its complement are set such that the
median survival time is the same as the one calculated under proportional
hazards.
</p>
<p>This is a heuristic and to some extent arbitrary approach to calculate
hazard ratios that correspond to reasonable and realistic scenarios.
</p>
<p>cen_rate_from_cen_prop_subgroup takes the proportion of
censored patients from the column <code>censoring_prop</code>. This column describes
the proportion of patients who are censored randomly before experiencing an
event, without regard to administrative censoring.
</p>


<h3>Value</h3>

<p>For generate_subgroup: A dataset with the columns t (time) and trt
(1=treatment, 0=control), evt (event, currently TRUE for all observations)
</p>
<p>For assumptions_subgroup: a design tibble with default values invisibly
</p>
<p>For true_summary_statistics_subgroup: the design data.frame
passed as argument with the additional columns
</p>
<p>For hazard_subgroup_from_PH_effect_size: the design data.frame passed as
argument with the additional columns hazard_trt and hazard_subgroup.
</p>
<p>for cen_rate_from_cen_prop_subgroup: design data.frame with the
additional column random_withdrawal
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>generate_subgroup()</code>: simulates a dataset with a mixture of cured
patients
</p>
</li>
<li> <p><code>assumptions_subgroup()</code>: generate default assumptions <code>data.frame</code>
</p>
</li>
<li> <p><code>true_summary_statistics_subgroup()</code>: calculate true summary statistics for subgroup
</p>
</li>
<li> <p><code>hazard_subgroup_from_PH_effect_size()</code>: Calculate hazards in treatement arm
</p>
</li>
<li> <p><code>cen_rate_from_cen_prop_subgroup()</code>: calculate censoring rate from censoring proportion
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">one_simulation &lt;- merge(
    assumptions_subgroup(),
    design_fixed_followup(),
    by=NULL
  ) |&gt;
  head(1) |&gt;
  generate_subgroup()
head(one_simulation)
tail(one_simulation)
Design &lt;- assumptions_subgroup()
Design
my_design &lt;- merge(
    assumptions_subgroup(),
    design_fixed_followup(),
    by=NULL
  )
my_design &lt;- true_summary_statistics_subgroup(my_design)
my_design

my_design &lt;- merge(
  assumptions_subgroup(),
  design_fixed_followup(),
  by=NULL
)

my_design$hazard_trt &lt;- NA
my_design$hazard_subgroup &lt;- NA
my_design$hr_subgroup_relative &lt;- 0.9
my_design$final_events &lt;- ceiling((my_design$n_ctrl + my_design$n_trt) * 0.75)
my_design &lt;- hazard_subgroup_from_PH_effect_size(my_design, target_power_ph=0.9)
my_design
design &lt;- expand.grid(
  hazard_ctrl=0.2,                   # hazard under control and before treatment effect
  hazard_trt=0.02,                   # hazard after onset of treatment effect
  hazard_subgroup=0.01,              # hazard in the subgroup in treatment
  prevalence = c(0.2, 0.5),           # subgroup prevalence
  censoring_prop=c(0.1, 0.25, 0.01), # 10%, 25%, 1% random censoring
  followup=100,                      # followup of 100 days
  n_trt=50,                          # 50 patients treatment
  n_ctrl=50                          # 50 patients control
)
cen_rate_from_cen_prop_subgroup(design)
</code></pre>


</div>