<div class="container">

<table style="width: 100%;"><tr>
<td>logLikWouPairs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Loglikelihood of WN in 2D when only the initial and final points are observed</h2>

<h3>Description</h3>

<p>Computation of the loglikelihood for a WN diffusion (with diagonal diffusion matrix) from a sample of initial and final pairs of angles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logLikWouPairs(x, t, alpha, mu, sigma, rho = 0, maxK = 2L, expTrc = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of dimension <code>c(n, 4)</code> of initial and final pairs of angles. Each row is an observation containing <code class="reqn">(\phi_0, \psi_0, \phi_t, \psi_t)</code>.
They all must be in <code class="reqn">[\pi,\pi)</code> so that the truncated wrapping by <code>maxK</code> windings is able to capture periodicity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>either a scalar or a vector of length <code>n</code> containing the times the initial and final dihedrals. If <code>t</code> is a scalar, a common time is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>vector of length <code>3</code> parametrizing the <code>A</code> matrix as in <code>alphaToA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of length <code>2</code> giving the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of length <code>2</code> containing the <strong>square root</strong> of the diagonal of <code class="reqn">\Sigma</code>, the diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>maximum absolute value of the windings considered in the computation of the WN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expTrc</code></td>
<td>
<p>truncation for exponential: <code>exp(x)</code> with <code>x &lt;= -expTrc</code> is set to zero. Defaults to <code>30</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A negative penalty is added if positive definiteness is violated. If the output value is Inf, -100 * N is returned instead.
</p>


<h3>Value</h3>

<p>A scalar giving the final loglikelihood, defined as the sum of the loglikelihood of the initial angles according to the stationary density
and the loglikelihood of the transitions from initial to final angles.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(345567)
x &lt;- toPiInt(matrix(rnorm(200, mean = pi), ncol = 4, nrow = 50))
alpha &lt;- c(2, 1, -0.5)
mu &lt;- c(0, pi)
sigma &lt;- sqrt(c(2, 1))

# The same
logLikWouPairs(x = x, t = 0.5, alpha = alpha, mu = mu, sigma = sigma)
sum(
  log(dStatWn2D(x = x[, 1:2], alpha = alpha, mu = mu, sigma = sigma)) +
  log(dTpdWou2D(x = x[, 3:4], x0 = x[, 1:2], t = 0.5, alpha = alpha, mu = mu,
                 sigma = sigma))
)

# Different times
logLikWouPairs(x = x, t = (1:50) / 50, alpha = alpha, mu = mu, sigma = sigma)
</code></pre>


</div>