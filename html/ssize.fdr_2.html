<div class="container">

<table style="width: 100%;"><tr>
<td>ssize.F</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size Calculations for Multi-Sample Microarray Experiments</h2>

<h3>Description</h3>

<p>Calculates appropriate sample sizes for multi-sample
microarray experiments for a desired power.  Sample size
calculations are performed at controlled false discovery rates
and user-specified proportions of non-differentially expressed
genes, design matrix, and standard deviation. A graph of power
versus sample size is created.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssize.F(X, beta, L = NULL, dn, sigma, fdr = 0.05, power = 0.8, pi0 = 0.95, maxN = 20,
  cex.title=1.15, cex.legend=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix of experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>parameter vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>coefficient matrix or vector for linear contrasts of
interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dn</code></td>
<td>
<p>a function of the degrees of freedom based on the design
of the experiment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the standard deviation for all genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>the false discovery rate to be controlled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the desired power to be achieved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>a vector (or scalar) of proportions of non-differentially
expressed genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxN</code></td>
<td>
<p>the maximum sample size used for power calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.title</code></td>
<td>
<p>controls size of chart titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>controls size of chart legend</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Standard deviations are assumed to be identical for all genes.
See the function <code>ssize.Fvary</code> for sample size
calculations with varying standard deviations among genes.
</p>
<p>If a vector is input for <code>pi0</code>, sample size calculations
are performed for each proportion.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ssize</code></td>
<td>
<p>sample sizes (for each treatment) at which desired
power is first reached</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power calculations with corresponding sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.vals</code></td>
<td>
<p>critical value calculations with corresponding
sample sizes</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Powers calculated to be 0 may be negligibly conservative.
</p>
<p>Critical values calculated as ‘NA’ are values &gt;100.
</p>


<h3>Author(s)</h3>

<p>Megan Orr <a href="mailto:megan.orr@ndsu.edu">megan.orr@ndsu.edu</a>, Peng Liu <a href="mailto:pliu@iastate.edu">pliu@iastate.edu</a></p>


<h3>References</h3>

<p> Liu, Peng and J. T. Gene Hwang. 2007. Quick calculation
for sample size while controlling false discovery rate with
application to microarray analysis. <em>Bioinformatics</em> 23(6): 739-746. </p>


<h3>See Also</h3>

<p><code>ssize.twoSampVary</code>, <code>ssize.oneSamp</code>,
<code>ssize.oneSampVary</code>, <code>ssize.F</code>,
<code>ssize.Fvary</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> ##Sample size calculation for three-treatment loop design microarray experiment
 ##See Figure S2 of Liu &amp; Hwang (2007)
 des&lt;-matrix(c(1,-1,0,0,1,-1),ncol=2,byrow=FALSE)	##design matrix of loop design experiment
 b&lt;-c(1,-0.5)			##difference between first two treatments is 1 and
  #second and third treatments is -0.5
 df&lt;-function(n){3*n-2}		##degrees of freedom for this design is 3n-2
 s&lt;-1				##standard deviation
 a&lt;-0.05			##false discovery rate to be controlled
 pwr1&lt;-0.8			##desired power
 p0&lt;-c(0.5,0.9,0.95,0.995)	##proportions of non-differentially expressed genes
 N1&lt;-20				##maximum sample size for calculations

 ft&lt;-ssize.F(X=des,beta=b,dn=df,sigma=s,fdr=a,power=pwr1,pi0=p0,maxN=N1)
 ft$ssize	##first sample sizes to reach desired power for each proportion of
  #non-differentially expressed genes
 ft$power	##power for each sample size
 ft$crit.vals	##critical value for each sample size

</code></pre>


</div>