<div class="container">

<table style="width: 100%;"><tr>
<td>sm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a reparameterized P-spline base</h2>

<h3>Description</h3>

<p>The returned matrix is a low-rank approximation of the original P-spline
basis (unless <code>decomposition = "asIs"</code>), that is projected into the
complement of the nullspace of the associated penalty (unless
<code>centerBase = FALSE</code>), i.e. for the default second order difference
penalty, the resulting basis cannot reproduce linear or constant functions
and parameterizes the "wiggly" part of the influence of <code>x</code> only. This
means that it very rarely makes sense to run a model with <code>sm(x)</code>
without also using <code>lin(x)</code> or <code>u(x)</code>. The projection
improves the separability between the linear and smooth parts of the
influence of <code>x</code> and centers the resulting function estimates s.t
<code class="reqn">\sum_i f(x_i) = 0</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sm(
  x,
  K = min(length(unique(x)), 20),
  spline.degree = 3,
  diff.ord = 2,
  rankZ = 0.999,
  centerBase = T,
  centerx = x,
  decomposition = c("ortho", "MM", "asIs"),
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of basis functions in the original basis (defaults to 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline.degree</code></td>
<td>
<p>defaults to 3 for cubic B-plines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.ord</code></td>
<td>
<p>order of the difference penalty, defaults to 2 for penalizing
deviations from linearity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rankZ</code></td>
<td>
<p>how many eigenvectors to retain from the eigen decomposition:
either a number &gt; 3 or the proportion of the sum of eigenvalues the
retained eigenvectors must represent at least. Defaults to .999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerBase</code></td>
<td>
<p>project the basis of the penalized part into the complement
of the column space of the basis of the unpenalized part? defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerx</code></td>
<td>
<p>vector of x-values used for centering (defaults to <code>x</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomposition</code></td>
<td>
<p>use a truncated spectral decomposition of the implied
prior covariance of <code class="reqn">f(x)</code> for a low rank representation with
orthogonal basis functions and i.i.d. coefficients (<code>"ortho"</code>), or use
the mixed model reparameterization for non-orthogonal basis functions and
i.i.d. coefficients (<code>"MM"</code>) or use basis functions as they are with
i.i.d. coefficients (<code>"asIs"</code>). Defaults to <code>"ortho"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>count eigenvalues smaller than this as zero</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a basis for a smooth function in x
</p>


<h3>Author(s)</h3>

<p>Fabian Scheipl
</p>


<h3>References</h3>

<p>Kneib, T. (2006). Mixed model based inference in structured
additive regression. Dr. Hut.
<a href="https://edoc.ub.uni-muenchen.de/archive/00005011/">https://edoc.ub.uni-muenchen.de/archive/00005011/</a>
</p>


</div>