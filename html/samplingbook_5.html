<div class="container">

<table style="width: 100%;"><tr>
<td>mbes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model Based Estimation</h2>

<h3>Description</h3>

<p>mbes is used for model based estimation of population means using auxiliary variables. Difference, ratio and regression estimates are available. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mbes(formula, data, aux, N = Inf, method = 'all', level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>object of class <code>formula</code> (or one that can be coerced to that class): symbolic description for connection between primary and secondary information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing variables in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>known mean of auxiliary variable, which provides secondary information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>positive integer for population size. Default is <code>N=Inf</code>, which means that calculations are carried out without finite population correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>estimation method. Options are <code>'simple','diff','ratio','regr','all'</code>. Default is <code>method='all'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>coverage probability for confidence intervals. Default is <code>level=0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further options for linear regression model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The option <code>method='simple'</code> calculates the simple sample estimation without using the auxiliary variable. 
The option <code>method='diff'</code> calculates the difference estimate, <code>method='ratio'</code> the ratio estimate, and <code>method='regr'</code> the regression estimate which is based on the selected model. The option <code>method='all'</code> calculates the simple and all model based estimates. 
For methods <code>'diff'</code>, <code>'ratio'</code> and <code>'all'</code> the formula has to be <code>y~x</code> with <code>y</code> primary and <code>x</code> secondary information. 
For method <code>'regr'</code>, it is the symbolic description of the linear regression model. In this case, it can be used more than one auxiliary variable. Thus, <code>aux</code> has to be a vector of the same length as the number of auxiliary variables in order as specified in the formula.
</p>


<h3>Value</h3>

<p>The function <code>mbes</code> returns an object, which is a list consisting of the components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>is a list of call components: <code>formula</code> formula, <code>data</code> data frame, <code>aux</code> given value for mean of auxiliary variable, <code>N</code> population size, <code>type</code> type of model based estimation and <code>level</code> coverage probability for confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>is a list of further information components: <code>N</code> population size, <code>n</code> sample size, <code>p</code> number of auxiliary variables, <code>aux</code> true mean of auxiliary variables in population and <code>x.mean</code> sample means of auxiliary variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simple</code></td>
<td>
<p>is a list of result components, if <code>method='simple'</code> or <code>method='all'</code> is selected: <code>mean</code> mean estimate of population mean for primary information, <code>se</code> standard error of the mean estimate, and <code>ci</code> vector of confidence interval boundaries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>is a list of result components, if <code>method='diff'</code> or <code>method='all'</code> is selected: <code>mean</code> mean estimate of population mean for primary information, <code>se</code> standard error of the mean estimate, and <code>ci</code> vector of confidence interval boundaries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>is a list of result components, if <code>method='ratio'</code> or <code>method='all'</code> is selected: <code>mean</code> mean estimate of population mean for primary information, <code>se</code> standard error of the mean estimate, and <code>ci</code> vector of confidence interval boundaries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regr</code></td>
<td>
<p>is a list of result components, if <code>type='regr'</code> or <code>type='all'</code> is selected: <code>mean</code> mean estimate of population mean for primary information, <code>se</code> standard error of mean estimate, <code>ci</code> vector of confidence interval boundaries, and <code>model</code> underlying linear regression model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juliane Manitz</p>


<h3>References</h3>

<p>Kauermann, Goeran/Kuechenhoff, Helmut (2010): Stichproben. Methoden und praktische Umsetzung mit R. Springer.
</p>


<h3>See Also</h3>

<p><code>Smean</code>, <code>Sprop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## 1) simple suppositious example
data(pop)
# Draw a random sample of size=3
set.seed(802016)
data &lt;- pop[sample(1:5, size=3),]
names(data) &lt;- c('id','x','y')
# difference estimator
mbes(formula=y~x, data=data, aux=15, N=5, method='diff', level=0.95)
# ratio estimator
mbes(formula=y~x, data=data, aux=15, N=5, method='ratio', level=0.95)
# regression estimator
mbes(formula=y~x, data=data, aux=15, N=5, method='regr', level=0.95)

## 2) Bundestag election
data(election)
# draw sample of size n = 20
N &lt;- nrow(election)
set.seed(67396)
sample &lt;- election[sort(sample(1:N, size=20)),]
# secondary information SPD in 2002
X.mean &lt;- mean(election$SPD_02)
# forecast proportion of SPD in election of 2005
mbes(SPD_05 ~ SPD_02, data=sample, aux=X.mean, N=N, method='all')
# true value
Y.mean &lt;- mean(election$SPD_05)
Y.mean
# Use a second predictor variable
X.mean2 &lt;- c(mean(election$SPD_02),mean(election$GREEN_02))
# forecast proportion of SPD in election of 2005 with two predictors
mbes(SPD_05 ~ SPD_02+GREEN_02, data=sample, aux=X.mean2, N=N, method= 'regr')

## 3) money sample
data(money)
mu.X &lt;-  mean(money$X)
x &lt;- money$X[which(!is.na(money$y))]
y &lt;- na.omit(money$y)
# estimation
mbes(y~x, aux=mu.X, N=13, method='all')

## 4) model based two-phase sampling with mbes() 
id &lt;- 1:1000
x &lt;- rep(c(1,0,1,0),times=c(10,90,70,830))
y &lt;- rep(c(1,0,NA),times=c(15,85,900))
phase &lt;- rep(c(2,1), times=c(100,900))
data &lt;- data.frame(id,x,y,phase)
# mean of x out of first phase
mean.x &lt;- mean(data$x)
mean.x
N1 &lt;- length(data$x) 
# calculation of estimation for y 
est.y &lt;- mbes(y~x, data=data, aux=mean.x, N=N1, method='ratio')
est.y
# correction of standard error with uncertaincy in first phase
v.y &lt;- var(data$y, na.rm=TRUE)
se.y &lt;- sqrt(est.y$ratio$se^2 + v.y/N1)
se.y
# corrected confidence interval
lower &lt;- est.y$ratio$mean - qnorm(0.975)*se.y
upper &lt;- est.y$ratio$mean + qnorm(0.975)*se.y
c(lower, upper)
</code></pre>


</div>