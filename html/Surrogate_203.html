<div class="container">

<table style="width: 100%;"><tr>
<td>SurvSurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess surrogacy for two survival endpoints based on information theory and a two-stage approach</h2>

<h3>Description</h3>

<p>The function <code>SurvSurv</code> implements the information-theoretic approach to estimate individual-level surrogacy (i.e., <code class="reqn">R^2_{h.ind}</code>) and the two-stage approach to estimate trial-level surrogacy (<code class="reqn">R^2_{trial}</code>, <code class="reqn">R^2_{ht}</code>) when both endpoints are time-to-event variables (Alonso &amp; Molenberghs, 2008). See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">SurvSurv(Dataset, Surr, SurrCens, True, TrueCens, Treat,
Trial.ID, Weighted=TRUE, Alpha=.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value and censoring indicator, a true endpoint value and censoring indicator, a treatment indicator, and a trial ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SurrCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the surrogate endpoint values (1 = event, 0 = censored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TrueCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the true endpoint values (1 = event, 0 = censored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>Alonso &amp; Molenbergs (2008) proposed to redefine the surrogate endpoint <code class="reqn">S</code> as a time-dependent covariate <code class="reqn">S(t)</code>, taking value <code class="reqn">0</code> until the surrogate endpoint occurs and <code class="reqn">1</code> thereafter. Furthermore, these author considered the models
</p>
<p style="text-align: center;"><code class="reqn">\lambda [t \mid x_{ij}, \beta] = K_{ij}(t) \lambda_{0i}(t) exp(\beta x_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda [t \mid x_{ij}, s_{ij}, \beta, \phi] = K_{ij}(t) \lambda_{0i}(t) exp(\beta x_{ij} + \phi S_{ij}),</code>
</p>

<p>where <code class="reqn">K_{ij}(t)</code> is the risk function for patient <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">x_{ij}</code> is a p-dimensional vector of (possibly) time-dependent covariates, <code class="reqn">\beta</code> is a p-dimensional vector of unknown coefficients, <code class="reqn">\lambda_{0i}(t)</code> is a trial-specific baseline hazard function, <code class="reqn">S_{ij}</code> is a time-dependent covariate version of the surrogate endpoint, and <code class="reqn">\phi</code> its associated effect.
</p>
<p>The mutual information between <code class="reqn">S</code> and <code class="reqn">T</code> is estimated as <code class="reqn">I(T,S)=\frac{1}{n}G^2</code>, where <code class="reqn">n</code> is the number of patients and <code class="reqn">G^2</code> is the log likelihood test comparing the previous two models. Individual-level surrogacy can then be estimated as 
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind} = 1 - exp \left(-\frac{1}{n}G^2 \right).</code>
</p>

<p>O'Quigley and Flandre (2006) pointed out that the previous estimator depends upon the censoring mechanism, even when the censoring mechanism is non-informative. For low levels of censoring this may not be an issue of much concern but for high levels it could lead to biased results. To properly cope with the censoring mechanism in time-to-event outcomes, these authors proposed to estimate the mutual information as <code class="reqn">{I}(T,S)=\frac{1}{k}G^2</code>, where <code class="reqn">k</code> is the total number of events experienced. Individual-level surrogacy is then estimated as
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind} = 1 - exp \left(-\frac{1}{k}G^2 \right).</code>
</p>

<p><em>Trial-level surrogacy</em>
</p>
<p>A two-stage approach is used to estimate trial-level surrogacy, following a procedure proposed by Buyse et al. (2011). In stage 1, the following trial-specific Cox proportional hazard models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}(t)=S_{i0}(t) exp(\alpha_{i}Z_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}(t)=T_{i0}(t) exp(\beta_{i}Z_{ij}),</code>
</p>
 
<p>where <code class="reqn">S_{i0}(t)</code> and <code class="reqn">T_{i0}(t)</code> are the trial-specific baseline hazard functions, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">\alpha_{i}</code>, <code class="reqn">\beta_{i}</code> are the trial-specific treatment effects on S and T, respectively. 
</p>
<p>Next, the second stage of the analysis is conducted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_{i}}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on the full model that was fitted in stage 1. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>SurvSurv</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific log hazard ratio estimates of the treatment effects for the surrogate and the true endpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2.ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{ht}</code>), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2.hind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{hind}</code>), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2h.ind.QF</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination using the correction proposed by O'Quigley and Flandre (2006), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2.hInd.By.Trial.QF</code></td>
<td>
<p>A <code>data.frame</code> that contains individual-level surrogacy estimates using the correction proposed by O'Quigley and Flandre (2006), (cluster-based estimates) and their confidence interval for each of the trials seperately.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A. A., &amp; Molenberghs, G. (2008). Evaluating time-to-cancer recurrence as a surrogate marker for survival from an information theory perspective. <em>Statistical Methods in Medical Research, 17,</em> 497-504. 
</p>
<p>Buyse, M., Michiels, S., Squifflet, P., Lucchesi, K. J., Hellstrand, K., Brune, M. L., Castaigne, S., Rowe, J. M. (2011). Leukemia-free survival as a surrogate end point for overall survival in the evaluation of maintenance therapy for patients with acute myeloid leukemia in complete remission. <em>Haematologica, 96,</em> 1106-1112.
</p>
<p>O'Quigly, J., &amp; Flandre, P. (2006). Quantification of the Prentice criteria for surrogate endpoints. <em>Biometrics, 62,</em> 297-300.
</p>


<h3>See Also</h3>

<p>plot.SurvSurv
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Open Ovarian dataset
data(Ovarian)

# Conduct analysis
Fit &lt;- SurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd,
True = Surv, TrueCens = SurvInd, Treat = Treat, 
Trial.ID = Center)

# Examine results 
plot(Fit)
summary(Fit)
</code></pre>


</div>