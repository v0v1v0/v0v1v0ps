<div class="container">

<table style="width: 100%;"><tr>
<td>panellipse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence ellipses around products based on panelists descriptions</h2>

<h3>Description</h3>

<p>Virtual panels are generated using Boostrap techniques in order to display
confidence ellipses around products.</p>


<h3>Usage</h3>

<pre><code class="language-R">panellipse(donnee, col.p, col.j, firstvar, lastvar = ncol(donnee),
    alpha = 0.05, coord = c(1,2), scale.unit = TRUE, nbsimul = 300,
    nbchoix = NULL, group = NULL, name.group = NULL,
    level.search.desc = 0.2, centerbypanelist = TRUE,
    scalebypanelist = FALSE, name.panelist = FALSE,
    variability.variable = TRUE, cex = 1, color = NULL,
	graph.type = c("ggplot","classic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>donnee</code></td>
<td>
<p>a data frame made up of at least two qualitative variables 
(<em>product</em>, <em>panelist</em>) and a set of quantitative variables (sensory descriptors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.p</code></td>
<td>
<p>the position of the <em>product</em> variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.j</code></td>
<td>
<p>the position of the <em>panelist</em> variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstvar</code></td>
<td>
<p>the position of the first sensory descriptor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lastvar</code></td>
<td>
<p>the position of the last sensory descriptor (by default the last column of <code>donnee</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the confidence level of the ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>a length 2 vector specifying the components to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.unit</code></td>
<td>
<p>boolean, if T the descriptors are scaled to unit variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbsimul</code></td>
<td>
<p>the number of simulations (corresponding to the number of virtual panels) used to compute the ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbchoix</code></td>
<td>
<p>the number of panelists forming a virtual panel, by default the number of panelists in the original panel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>the number of variables in each group of variables when multiple factor analysis is performed (by default this parameter equals NULL and a PCA is performed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.group</code></td>
<td>
<p>the names of the groups of variables when mfa is performed (if <code>group</code> differs from NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level.search.desc</code></td>
<td>
<p>the threshold above which a descriptor is not considered as discriminant according to AOV model <code>"descriptor=Product+Panelist"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerbypanelist</code></td>
<td>
<p>boolean, if T center the data by panelist before the construction of the axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalebypanelist</code></td>
<td>
<p>boolean, if T scale the data by panelist before the construction of the axes (by default, FALSE
is assigned to that parameter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.panelist</code></td>
<td>
<p>boolean, if T then the name of each panelist is displayed on the <code>plotpanelist</code> graph (by default, FALSE
is assigned to that parameter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variability.variable</code></td>
<td>
<p>boolean, if T a plot with the variability of the variable is drawn and a confidence intervals of the correlations
between descriptors are calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>cf. function <code>par</code> in the <span class="pkg">graphics</span> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>a vector with the colors used; by default there are 35 colors defined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.type</code></td>
<td>
<p>a character that gives the type of graph used: "ggplot" or "classic"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Panellipse, step by step:<br>
Step 1 Performs a selection of discriminating descriptors with respect to a threshold set by users <br>
Step 2 Virtual panels are generated using Boostrap techniques; the number of panels as well as their size
are set by users with the <em>nbsimul</em> and <em>nbchoix</em> parameters <br>
Step 3 Coordinates of the products with respect to each virtual panels are computed <br>
Step 4 Each product is then circled by its confidence ellipse generated by virtual panels and
comprising (1-alpha)*100 percent of the virtual products <br>
Step 5 Variability of the variables is drawn and confidence interval of the correlation coefficient between descriptors are calculated by bootstrap <br></p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a matrix with the component of the factor analysis (in row) and the eigenvalues, the inertia and the cumulative inertia for each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordinates</code></td>
<td>
<p>a list with: the coordinates of the products with respect to the panel and to each panelists
and the coordinates of the <em>partial</em> products with respect to the panel and to each panelists</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hotelling</code></td>
<td>
<p>Returns a matrix with the P-values of the Hotelling's T2 tests for each pair of products: this matrix allows to find the
product which are significantly different for the 2-components sensory description; if an MFA is done, <em>hotelling</em> returns as many matrices 
as there are group, these matrices allows to find the product which are significantly different for the 2-components sensory description of the
group, and it returns also a <em>global</em> matrix corresponding to the P-values for the tests corresponding to the mean product.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correl</code></td>
<td>
<p>a list with: the matrix of the estimated correlation coefficients and two matrices corresponding to the confidence intervals, min and max, of the correlation coefficients calculated by bootstrap.</p>
</td>
</tr>
</table>
<p>Returns a graph of the products as well as a correlation circle of the descriptors.<br></p>
<p>Returns a graph where each product is displayed with respect to a panel and to each panelist composing
the panel; products described by the panel are displayed as square, they are displayed as circle when
they are described by each panelist.<br></p>
<p>Returns a graph where each product is circled by its confidence ellipse generated by virtual panels.
When a Multiple Factor Analysis is performed, returns a graph where each partial product is circled by its confidence ellipse generated by virtual panels.<br></p>
<p>Returns a graph where the variability of each variable is drawn on the correlation circle graph. <br></p>


<h3>Author(s)</h3>

<p>Francois Husson</p>


<h3>References</h3>

<p>Husson F., Le Dien S. &amp; Pages J.  (2005). Confidence ellipse for the sensory profiles obtained by Principal Components Analysis. <em>Food Quality and Preference</em>.  16 (3), 245-250. <br>
Pages J. &amp; Husson F. (2005). Multiple Factor Analysis with confidence ellipses: a methodology to study the relationships between sensory and instrumental data. To be published in <em>Journal of Chemometrics</em>. <br>
Husson F., Le S. &amp; Pages J.  Variability of the representation of the variables resulting from PCA in the case of a conventional sensory profile. <em>Food Quality and Preference</em>.  16 (3), 245-250. 
</p>


<h3>See Also</h3>

 <p><code>panellipse.session</code>, <code>panelmatch</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Example 1: PCA
data(chocolates)
res &lt;- panellipse(sensochoc, col.p = 4, col.j = 1, firstvar = 5)
coltable(res$hotelling, main.title = "P-values for the Hotelling's T2 tests")

## If we consider only 12 panelists in a virtual panel, 
## what would be the size of the ellipses
res2 &lt;- panellipse(sensochoc, col.p = 4, col.j = 1, nbchoix = 12, firstvar = 5)
coltable(res2$hotelling, main.title = "P-values for the Hotelling's T2 tests")

## If we want the confidence ellipses around the individual descriptions
panellipse(sensochoc, col.p = 4, col.j = 1, nbchoix = 1, firstvar = 5)


## Example 2: MFA
data(chocolates)
res &lt;- panellipse(sensochoc, col.p = 4, col.j = 1, firstvar = 5, 
    group = c(6,8), name.group = c("G1","G2"))
for (i in 1:dim(res$hotelling$bygroup)[3]) coltable(res$hotelling$bygroup[,,i], 
    main.title = paste("P-values for the Hotelling's T2 tests (",
    dimnames(res$hotelling$bygroup)[3][[1]][i],")",sep=""))

## End(Not run)
</code></pre>


</div>