<div class="container">

<table style="width: 100%;"><tr>
<td>fitStateMRH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of states at each time point with Moving-Resting-Handling Process</h2>

<h3>Description</h3>

<p>Estimate the state at each time point under the Moving-Resting-Handling
process with Embedded Brownian Motion with animal movement data at
discretely time points. See the difference between <code>fitStateMRH</code>
and <code>fitViterbiMRH</code> in detail part. Using <code>fitPartialViterbiMRH</code>
to estimate the state during a small piece of time interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitStateMRH(data, theta, integrControl = integr.control())

fitViterbiMRH(data, theta, integrControl = integr.control())

fitPartialViterbiMRH(
  data,
  theta,
  startpoint,
  pathlength,
  integrControl = integr.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> whose first column is the observation
time, and other columns are location coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the parameters for Moving-Resting-Handling model, in the
order of rate of moving, rate of resting, rate of handling, volatility
and switching probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrControl</code></td>
<td>
<p>Integration control vector includes rel.tol,
abs.tol, and subdivisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoint</code></td>
<td>
<p>Start time point of interested time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathlength</code></td>
<td>
<p>the length of interested time interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fitStateMRH</code> estimates the most likely state by maximizing
the probability of <code class="reqn">Pr(S(t = t_k) = s_k | X)</code>, where X is the whole
data and <code class="reqn">s_k</code> is the possible sates at <code class="reqn">t_k</code> (moving, resting
or handling).
</p>
<p><code>fitViterbiMRH</code> estimates the most likely state path by maximizing
<code class="reqn">Pr(S(t = t_0) = s_0, S(t = t_1) = s_1, ..., S(t = t_n) = s_n | X)</code>, where
X is the whole data and <code class="reqn">s_0, s_1, ..., s_n</code> is the possible
state path.
</p>
<p><code>fitPartialViterbiMRH</code> estimates the most likely state path of
a small peice of time interval, by maximizing the probability of
<code class="reqn">Pr(S(t = t_k) = s_k, ..., S(t = t_{k+q-1}) = s_{k+q-1} | X)</code>,
where <code class="reqn">k</code> is the start time point and <code class="reqn">q</code> is the length of interested
time interval.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> contains estimated results, with elements:
</p>

<ul>
<li>
<p> original data be estimated.
</p>
</li>
<li>
<p> conditional probability of moving, resting, handling (<code>p.m</code>,
<code>p.r</code>, <code>p.h</code>), which is <code class="reqn">Pr(S(t = t_k) = s_k | X)</code> for
<code>fitStateMRH</code>; <code class="reqn">log-Pr(s_0, ..., s_k | X_k)</code> for
<code>fitViterbiMRH</code>, where <code class="reqn">X_k</code> is <code class="reqn">(X_0, ..., X_k)</code>;
and <code class="reqn">log-Pr(s_k, ..., s_{k+q-1}|X)</code> for <code>fitPartialViterbiMRH</code>.
</p>
</li>
<li>
<p> estimated states with 0-moving, 1-resting, 2-handling.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Pozdnyakov, V., Elbroch, L.M., Hu, C., Meyer, T., and Yan, J. (2018+)
On estimation for Brownian motion governed by telegraph process with
multiple off states. &lt;arXiv:1806.00849&gt;
</p>


<h3>See Also</h3>

<p><code>rMRH</code> for simulation.
<code>fitMRH</code> for estimation of parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## time consuming example
set.seed(06269)
tgrid &lt;- seq(0, 400, by = 8)
dat &lt;- rMRH(tgrid, 4, 0.5, 0.1, 5, 0.8, 'm')
fitStateMRH(dat, c(4, 0.5, 0.1, 5, 0.8))
fitViterbiMRH(dat, c(4, 0.5, 0.1, 5, 0.8))
fitPartialViterbiMRH(dat, c(4, 0.5, 0.1, 5, 0.8), 20, 10)

## End(Not run)

</code></pre>


</div>