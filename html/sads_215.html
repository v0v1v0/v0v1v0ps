<div class="container">

<table style="width: 100%;"><tr>
<td>dvolkov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Neutral Biodiversity Theory distribution by Volkov <em>et al.</em> </h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for species abundances distribution in a neutral community with
immigration as deduced by Volkov et al. (2003).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dvolkov( x, theta, m, J, order=96, log = FALSE )
pvolkov( q, theta, m , J, lower.tail = TRUE, log.p = FALSE )
qvolkov( p, theta, m, J, lower.tail = TRUE, log.p = FALSE )
rvolkov( n, theta, m, J)
Svolkov( theta, m, J, order=96)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a
vector of abundance of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>positive real, theta &gt; 0; Hubbell's ‘fundamental biodiversity number’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>

<p>order of the approximation for the numerical integration. The default of 96
usually gives a rounding error of 1e-8 for moderate dataset; 
orders greater than 128 are probably overkill
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>positive real, 0 &lt;= m &lt;= 1; immigration rate (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>

<p>positive integer; sample size.  In the context of
species abundance distributions, usually the number of individuals in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Volkov <em>et al</em> (2003) proposed one of the analytic solutions for the
species abundance distributions (SADs)
for The Neutral Theory of Biodiversity (Hubbell 2001).
</p>
<p>Their solution is deduced from a model of stochastic dynamics of a
set of species where the following rules apply:
(1) replacement of a dead individual by local offspring – with probability 1-m,
individuals picked at random
are replaced by the offspring of other individuals picked at random;
(2) replacement of a dead individual by an immigrant –
with probability m individuals picked at random
are replaced by immigrants taken at random from a pool
of potential colonizers (the metacommunity).
</p>
<p>Volkov et al. (2003, eq.7) provide the stationary solution for
the expected number
of species with a given abundance.
A probability density function is easily calculated by taking
these expected values for abundances 1:J and dividing them
by the total number of
species.
<code>dvolkov</code> performs the numerical integration of the 
density function by means of Gaussian quadrature, using a
library by Pavel Holoborodko (http://www.holoborodko.com/pavel/?page_id=679).
The code is based on the <code>untb::volkov</code> function (Hankin 2007).
<code>pvolkov</code> provides CDF by
cumulative sum of density values, and <code>qvolkov</code> use
a numeric interpolation with a step function (<code>approxfun</code>)
to find quantiles.
Calculations can be slow for larger datasets.
</p>
<p>A special function Svolkov is provided to estimate the expected community size from a Volkov distribution with parameters theta, m and J, but this function is deprecated. A more comprehensive function to estimate community sizes will be developed in the future.
</p>


<h3>Value</h3>

<p><code>dvolkov</code> gives the (log) density of the density, <code>pvolkov</code> gives the (log)
distribution function, <code>qvolkov</code> gives the (log) the quantile function.
</p>
<p>Invalid values for parameters <code>J</code> or <code>theta</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Hankin, R.K.S. 2007. Introducing untb, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package For Simulating Ecological Drift
Under the Unified Neutral Theory of Biodiversity. <em>Journal of Statistical Software 22</em> (12). 
</p>
<p>Hubbell, S. P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press.
</p>
<p>Volkov, I.,  Banavar, J.R., Hubbell, S.P., Maritan, A. 2003.
Neutral theory and relative species abundance in ecology.
<em>Nature 424</em>:1035–1037
</p>


<h3>See Also</h3>

<p><code>fitvolkov</code> for maximum likelihood fit,
<code>dmzsm</code> for the distribution of abundances in the metacommunity,
<code>volkov</code> in package <span class="pkg">untb</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Volkov et al 2003 fig 1
## But without Preston correction to binning method
## and only the line of expected values by Volkov's model
data( bci )
bci.oct &lt;- octav( bci, preston = FALSE )
plot( bci.oct )
CDF &lt;- pvolkov( bci.oct$upper, theta = 47.226, m = 0.1, J = sum(bci) )
bci.exp &lt;- diff( c(0,CDF) ) * length(bci)
midpoints &lt;- as.numeric( as.character( bci.oct$octave ) ) - 0.5
lines( midpoints, bci.exp, type="b" )

## the same with Preston binning using octavpred
plot(octav( bci, preston = TRUE ))
bci.exp2 &lt;- octavpred( bci, sad = "volkov",
                      coef = list(theta = 47.226, m = 0.1, J=sum(bci)), preston=TRUE)
lines( bci.exp2 )

</code></pre>


</div>