<div class="container">

<table style="width: 100%;"><tr>
<td>hpwd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heuristic Product Within Distance (Spatially Balanced Sampling Design)</h2>

<h3>Description</h3>

<p>Selects spatially balanced samples through the use of
Heuristic Product Within Distance design (HPWD). To have constant inclusion
probabilities <code class="reqn">\pi_{i}=n/N</code>, where <code class="reqn">n</code> is sample size
and <code class="reqn">N</code> is population size, the distance matrix has to be standardized
with function <code>stprod</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hpwd(dis, n, beta = 10, nrepl = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>A distance matrix NxN that specifies how far all the pairs
of units in the population are.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Parameter <code class="reqn">\beta</code> for the algorithm. The higher
<code class="reqn">\beta</code> is, the more the sample is going to be spread (default = 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepl</code></td>
<td>
<p>Number of samples to draw (default = 1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The HPWD design generates samples approximately with the same
probabilities of the <code>pwd</code> but with a significantly smaller
number of steps. In fact, this algorithm randomly selects a sample of size
<code class="reqn">n</code> exactly with <code class="reqn">n</code> steps, updating at each step the selection
probability of not-selected units, depending on their distance from the
units that were already selected in the previous steps.
</p>


<h3>Value</h3>

<p>Returns a matrix <code>nrepl</code> x <code>n</code>, which contains the
<code>nrepl</code> selected samples, each of them stored in a row. In particular,
the i-th row contains all labels of units selected in the i-th sample.
</p>


<h3>References</h3>

<p>Benedetti R, Piersimoni F (2017). A spatially balanced design with
probability function proportional to the within sample distance.
<em>Biometrical Journal</em>, <strong>59</strong>(5), 1067-1084.
<a href="https://doi.org/10.1002/bimj.201600194">doi:10.1002/bimj.201600194</a>
</p>
<p>Benedetti R, Piersimoni F (2017). Fast Selection of Spatially Balanced Samples. <em>arXiv</em>.
<a href="https://arxiv.org/abs/1710.09116">https://arxiv.org/abs/1710.09116</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1
# Draw 1 sample of dimension 10 without constant inclusion probabilities
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
s &lt;- hpwd(dis = dis, n = 10) # drawn sample

# Example 2
# Draw 1 sample of dimension 15 with constant inclusion probabilities
# equal to n/N, with N = population size
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
con &lt;- rep(1, nrow(dis)) # vector of constraints
stand_dist &lt;- stprod(mat = dis, con = con) # standardized matrix
s &lt;- hpwd(dis = stand_dist$mat, n = 15) # drawn sample

# Example 3
# Draw 2 samples of dimension 15 with constant inclusion probabilities
# equal to n/N, with N = population size, and an increased level of spread, beta = 20
dis &lt;- as.matrix(dist(cbind(lucas_abruzzo$x, lucas_abruzzo$y))) # distance matrix
con &lt;- rep(0, nrow(dis)) # vector of constraints
stand_dist &lt;- stprod(mat = dis, con = con) # standardized matrix
s &lt;- hpwd(dis = stand_dist$mat, n = 15, beta = 20, nrepl = 2) # drawn samples

</code></pre>


</div>