<div class="container">

<table style="width: 100%;"><tr>
<td>2. Covariance matrix transformations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conversion of a covariance matrix to a distance/correlation matrix</h2>

<h3>Description</h3>

<p>Transformation into correlation matrix or distance matrix from a covariance matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">cov2dist(A, a = 1, inplace = FALSE)

cov2cor2(A, a = 1, inplace = FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>(numeric matrix) Variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inplace</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> to whether operate directly on the input matrix.
When <code>TRUE</code> no result is produced but the input <code>A</code> is modified. Default <code>inplace=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>(numeric) A number to multiply the whole resulting matrix by. Default <code>a = 1</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For any variables
X<sub>i</sub> and
X<sub>j</sub> with mean zero and with sample vectors
<b>x</b><sub>i</sub> = (x<sub>i1</sub>,...,x<sub>in</sub>)' and
<b>x</b><sub>j</sub> = (x<sub>j1</sub>,...,x<sub>jn</sub>)'
, their (sample) variances are equal (up-to a constant) to their cross-products, this is,
var(X<sub>i</sub>) = <b>x</b>'<sub>i</sub><b>x</b><sub>i</sub> and
var(X<sub>j</sub>) = <b>x</b>'<sub>j</sub><b>x</b><sub>j</sub>.
Likewise, the covariance is
cov(X<sub>i</sub>,X<sub>j</sub>) = <b>x</b>'<sub>i</sub><b>x</b><sub>j</sub>.
</p>
<b>Distance.</b>
<p>The Euclidean distance
d(X<sub>i</sub>,X<sub>j</sub>)
between the variables expressed in terms of cross-products is
</p>
<p style="text-align:center">d(X<sub>i</sub>,X<sub>j</sub>) = (<b>x</b>'<sub>i</sub><b>x</b><sub>i</sub> + <b>x</b>'<sub>j</sub><b>x</b><sub>j</sub> - 2<b>x</b>'<sub>i</sub><b>x</b><sub>j</sub>)<sup>1/2</sup></p>
<p>Therefore, the output distance matrix will contain as off-diagonal entries
</p>
<p style="text-align:center">d(X<sub>i</sub>,X<sub>j</sub>) = (var(X<sub>i</sub>) + var(X<sub>j</sub>) - 2cov(X<sub>i</sub>,X<sub>j</sub>))<sup>1/2</sup></p>
<p>while in the diagonal, the distance between one variable with itself is
d(X<sub>i</sub>,X<sub>i</sub>) = 0
</p>
<b>Correlation.</b>
<p>The correlation between the variables is obtained from variances and covariances as
</p>
<p style="text-align:center">cor(X<sub>i</sub>,X<sub>j</sub>) = cov(X<sub>i</sub>,X<sub>j</sub>)/(sd(X<sub>i</sub>)sd(X<sub>j</sub>))</p>
<p>where sd(X<sub>i</sub>)=sqrt(var(X<sub>i</sub>)); while in the diagonal, the correlation between one variable with itself is
cor(X<sub>i</sub>,X<sub>i</sub>) = 1
</p>
<p>Variances are obtained from the diagonal values while covariances are obtained from the out-diagonal.
</p>


<h3>Value</h3>

<p>Function 'cov2dist' returns a matrix containing the Euclidean distances. Function 'cov2cor2' returns a correlation matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">  require(SFSI)
  data(wheatHTP)
  
  X = scale(M)[1:100,]/sqrt(ncol(M))
  A = tcrossprod(X)        # A 100x100 covariance matrix 
  
  # Covariance matrix to distance matrix
  D = cov2dist(A)
  # (it must equal (but faster) to:)
  D0 = as.matrix(dist(X))
  max(D-D0)
  
  # Covariance to a correlation matrix
  R = cov2cor2(A)
  # (it must equal (but faster) to:)
  R0 = cov2cor(A)
  max(R-R0)
  
  # Inplace calculation
  A[1:5,1:5]
  cov2dist(A, inplace=TRUE)
  A[1:5,1:5]  # notice that A was modified
  
</code></pre>


</div>