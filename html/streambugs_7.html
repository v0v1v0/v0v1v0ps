<div class="container">

<table style="width: 100%;"><tr>
<td>run.streambugs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the streambugs ODE model</h2>

<h3>Description</h3>

<p>Numerically solve streambugs ODE model (in either R or C version) for given
parameters, inputs and time points, using the <code>ode</code>
routine.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run.streambugs(
  y.names,
  times,
  par,
  inp = NA,
  C = FALSE,
  file.def = NA,
  file.res = NA,
  file.add = NA,
  return.res.add = FALSE,
  tout.add = NA,
  verbose = TRUE,
  method = "lsoda",
  rtol = 1e-04,
  atol = 1e-04,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y.names</code></td>
<td>
<p>state variables names, either as a vector encoded in the form
<code>"Reach_Habitat_Taxon"</code> or <code>"Reach_Habitat_Taxon_Group"</code>, or
a list as returned by <code>decode.statevarnames</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>vector with time points for which output is wanted; the first</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector with constant parameters and model inputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inp</code></td>
<td>
<p>list with time-dependent parameters or model inputs with one list
element for each parameter or input that includes a matrix where first
column is the time and second the corresponding parameter or input value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>identifier for C- or R-Version</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.def</code></td>
<td>
<p>file name for writing system definition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.res</code></td>
<td>
<p>file name for results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.add</code></td>
<td>
<p>file name for additional output (e.g. process rates)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.res.add</code></td>
<td>
<p>returns <code>res.add</code> output additionally to res</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tout.add</code></td>
<td>
<p>optional identifier for specific output times for the
additional output, if <code>NA</code> all <code>res.add</code> is calculated for all
times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>prints some outputs to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method used by <code>ode</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtol</code></td>
<td>
<p>argument of <code>ode</code> function defining relative
error tolerance, either a scalar or an array of the same size as <code>y.names</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atol</code></td>
<td>
<p>argument of <code>ode</code> function defining absolute
error, either a scalar or an array of the same size as <code>y.names</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>ode</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with:</p>

<dl>
<dt><code>$res</code></dt>
<dd>
<p>matrix of class <code>streambugs</code> with up
to as many rows aselements in times and as many columns as elements in
<code>y.names</code>, plus an additional column for the time value.
There will be a row for each element in times unless the
FORTRAN routine <code>"lsoda"</code> returns with an unrecoverable error.</p>
</dd>
<dt><code>$res.add</code></dt>
<dd>
<p>optional additional output matrix with process
rates and taxon specific factors, present only if <code>return.res.add</code>
input parameter is set to <code>TRUE</code>.</p>
</dd>
</dl>
<h3>Model syntax</h3>

<p>See "docs/Streambugs_syntax.pdf" file in the package installation folder:
<code>system.file("docs", "Streambugs_syntax.pdf", package="streambugs")</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- streambugs.example.model.toy()
# Display inputs: list of perturbed variables with time points and new values
m$inp
# Simluate
res.C.default &lt;- run.streambugs(y.names = m$y.names, times = m$times,
   par = m$par, inp = m$inp, C = TRUE)
# Modify input (halve second perturbation size) and re-simulate
m$inp$Reach3_w[2,2] &lt;- m$inp$Reach3_w[2,2] / 2
m$inp
res.C.modified &lt;- run.streambugs(y.names = m$y.names, times = m$times,
   par = m$par, inp = m$inp, C = TRUE)
# Compare examplary trajectory of organic matter in one of the habitats
var.name &lt;- "Reach3_Hab1_POM1_POM"
plot(m$times,res.C.default$res[, var.name], type="l", col="red")
lines(m$times, res.C.modified$res[, var.name], col="green")

</code></pre>


</div>