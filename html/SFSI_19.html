<div class="container">

<table style="width: 100%;"><tr>
<td>R-squared pruning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R-squared pruning</h2>

<h3>Description</h3>

<p>Pruning features using an R-squared threshold and maximum distance 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Prune(X, alpha = 0.95, 
      pos = NULL, d.max = NULL, 
      centered = FALSE, scaled = FALSE,
      verbose = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(numeric matrix) A matrix with observations in rows and features (e.g., SNPs) in columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(numeric) R-squared threshold used to determine connected sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>(numeric vector) Optional vector with positions (e.g., bp) of features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.max</code></td>
<td>
<p>(numeric) Maximum distance that connected sets are apart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> whether columns in <code>X</code> are centered with mean zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> whether columns in <code>X</code> are scaled with unit standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> to whether show progress</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm identifies sets of connected features as those that share an 
R<sup>2</sup> &gt; Î± and retains
only one feature (first appearance) for each set.
</p>
<p>The sets can be limited to lie within a distance less or equal to a <code>d.max</code> value.
</p>


<h3>Value</h3>

<p>Returns a list object that contains the elements:
</p>

<ul>
<li> <p><code>prune.in</code>: (vector) indices of selected (unconnected) features.
</p>
</li>
<li> <p><code>prune.out</code>: (vector) indices of dropped out features.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">  require(SFSI)
  data(wheatHTP)
  
  index = c(154:156,201:205,306:312,381:387,540:544)
  X = M[,index]          # Subset markers
  colnames(X) = 1:ncol(X)
  
  # See connected sets using R^2=0.8
  R2thr = 0.8
  R2 = cor(X)^2
  nw1 = net(R2, delta=R2thr) 
  plot(nw1, show.names=TRUE)

  # Get pruned features
  res = Prune(X, alpha=R2thr)

  # See selected (unconnected) features
  nw2 = net(R2[res$prune.in,res$prune.in], delta=R2thr) 
  nw2$xy = nw1$xy[res$prune.in,]
  plot(nw2, show.names=TRUE)

</code></pre>


</div>