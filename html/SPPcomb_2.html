<div class="container">

<table style="width: 100%;"><tr>
<td>DA_AllEE5_inside</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal calculation of estimating equation for DA_AllEE5</h2>

<h3>Description</h3>

<p>This is the internal function to solve the estimating equation constructed by
pair (N1,M1), (N1,M2), (N2,M1) and (N2,M2) with selection bias probility <code class="reqn">\pi(s,\eta)</code>
included. Since it's a internal function for function DA_AllEE5, thus it's not a necessary
or important function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DA_AllEE5_inside(beta, CASEZ_1, CASEZ_2, CASEZhat_1, CASEZhat_2, CASEZhat_22,
  CONTZ_1, CONTZ_2, CONTZhat_1, CONTZhat_2, CONTZhat_22, prob_case_1,
  prob_case_11, prob_case_2, prob_case_22, prob_cont_1, prob_cont_2, p,
  pi_case_1, pi_case_1_t, pi_case_2, pi_case_2_t, pi_cont_1, pi_cont_1_t,
  pi_cont_2, Z_case_pi_1, Z_case_pi_1_t, Z_case_pi_2, Z_case_pi_2_t,
  Z_cont_pi_1, Z_cont_pi_1_t, Z_cont_pi_2, J_step3, V_step3, pwt_cont_2,
  subset_2, subset_3, subset_4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Parameter <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CASEZ_1, CASEZhat_1</code></td>
<td>
<p>case data(N1) from case-control study,
details please see definition in the help of realdata_covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CASEZ_2, CASEZhat_2, CASEZhat_22</code></td>
<td>
<p>CTR data(N2), details please see definition in the help of realdata_covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CONTZ_1, CONTZhat_1</code></td>
<td>
<p>control data(M1) from case-control study, details please
see definition in the help of realdata_covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CONTZ_2, CONTZhat_2, CONTZhat_22</code></td>
<td>
<p>BRFSS data(M2), details please see definition in the help of realdata_covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_cont_1, prob_cont_2, prob_case_1, prob_case_11, prob_case_2, prob_case_22, pwt_cont_2</code></td>
<td>
<p>please see definition in the help of realdata_alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of parameters, a constant value of 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_case_1, pi_case_1_t, pi_case_2, pi_case_2_t, pi_cont_1, pi_cont_1_t, pi_cont_2</code></td>
<td>
<p>selection bias</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_case_pi_1, Z_case_pi_1_t, Z_case_pi_2, Z_case_pi_2_t, Z_cont_pi_1, Z_cont_pi_1_t, Z_cont_pi_2</code></td>
<td>
<p>part
of variables from covariates, used for the estiamtion of variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J_step3</code></td>
<td>
<p>Derivative of the estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V_step3</code></td>
<td>
<p>Variance of the estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_2</code></td>
<td>
<p>A vector of 1:(p-2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_3</code></td>
<td>
<p>A vector of 1:p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_4</code></td>
<td>
<p>A vector of 1:(p-2).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function solves estimating equation based on GMM combined estimating equations
with handling selection bias.
It also accounts for the uncertainty due to the estimated value of eta. The function will
output the estimating equation at current input value beta. Hence it can be used in "nleqslv" to solve for
<code class="reqn">\beta</code>. Because the function also outputs J and V, the asymptotic variance of <code class="reqn">\beta</code>
can be calculated in a straightforward way. <code class="reqn">\hat{Z}_l</code> may be highly correlated with Z_d, so it is
removed in the estimation. And it has to be careful in constructing f, J and V.
</p>


<h3>Value</h3>

<p>A list of (f,J,V)
</p>

<ol>
<li>
<p> f The final form of the estimating equation after adjusting eta.
</p>
</li>
<li>
<p> J_step3 The derivative of the estimating equation.
</p>
</li>
<li>
<p> V_step3 The variance of the estimating equation.
</p>
</li>
</ol>
</div>