<div class="container">

<table style="width: 100%;"><tr>
<td>LSfitNonNeg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-negative regression fits with a sparse overparameterized model matrix</h2>

<h3>Description</h3>

<p>Assuming  <code>z = t(x) %*% y  + noise</code>, a non-negatively modified least squares estimate of <code>t(x) %*% y</code> is made.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LSfitNonNeg(x, z, limit = 1e-10, viaQR = FALSE, printInc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A single column matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>Lower limit for non-zero fits. Set to <code>NULL</code> or <code>-Inf</code> to avoid the non-zero restriction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viaQR</code></td>
<td>
<p>Least squares fits obtained using <code>qr</code> when <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printInc</code></td>
<td>
<p>Printing "..." to console when <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The problem is first reduced by elimination some rows of <code>x</code>  (elements of <code>y</code>) using <code>GaussIndependent</code>.
Thereafter least squares fits are obtained using <code>solve</code> or <code>qr</code>.
Possible negative fits will be forced to zero in the next estimation iteration(s).
</p>


<h3>Value</h3>

<p>A fitted version of <code>z</code>
</p>


<h3>Author(s)</h3>

<p>Ã˜yvind Langsrud
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
data2 &lt;- SSBtoolsData("z2")
x &lt;- ModelMatrix(data2, formula = ~fylke + kostragr * hovedint - 1)
z &lt;- t(x) %*% data2$ant + rnorm(ncol(x), sd = 3)
LSfitNonNeg(x, z)
LSfitNonNeg(x, z, limit = NULL)

## Not run: 
mf &lt;- ~region*mnd + hovedint*mnd + fylke*hovedint*mnd + kostragr*hovedint*mnd
data4 &lt;- SSBtoolsData("sosialFiktiv")
x &lt;- ModelMatrix(data4, formula = mf)
z &lt;- t(x) %*% data4$ant + rnorm(ncol(x), sd = 3)
zFit &lt;- LSfitNonNeg(x, z)

## End(Not run)
</code></pre>


</div>