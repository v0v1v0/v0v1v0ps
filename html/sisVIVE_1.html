<div class="container">

<table style="width: 100%;"><tr>
<td>cv.sisVIVE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes K-fold cross validation for selecting lambda</h2>

<h3>Description</h3>

<p>Computes a K-fold cross validation for </p>


<h3>Usage</h3>

<pre><code class="language-R">cv.sisVIVE(Y, D, Z, lambdaSeq, K = 10, intercept = TRUE, normalize = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A numeric vector of outcomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A numeric vector of exposures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A numeric matrix of instruments, with each column referring to one instrument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaSeq</code></td>
<td>
<p>A numeric vector of lambdas to cross-validate from. Cross-validation will be performed only on these sequence of lambdas. You can either supply lambdaSeq or nLambda. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of cross-validation folds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>A logical declaring whether the intercept be included. Default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>A logical declaring whether the columns of Z should be scaled with variance 1. Default is TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Performs K-fold cross validiation to select lambda and returns the "best" lambda based on this cross-validation. If lambdaSeq is unspecified, the algorithm defaults to using the sequence of lambdas selected by sisVIVE. If lambdaSeq is specified, the algorithm will only evaluate its cross-validation on the specified lambdaSeq.</p>


<h3>Value</h3>

<p>A list is returned, which contains the estimates of alpha, beta, and the set of invalid instruments for the "best" lambda chosen by cross validation
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>"best" lambda as chosen by cross validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estCVError</code></td>
<td>
<p>Estimated cross-validated error at this lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Estimate of alpha at the said lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimate of beta, the causal effect of exposure on outcome, at the said lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichInvalid</code></td>
<td>
<p>Estimate of set of invalid instruments at the said lambda</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hyunseung Kang</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
library(lars)

n = 1000; L = 10; s= 3;
Z &lt;- matrix(rnorm(n*L),n,L)
error &lt;- mvrnorm(n,rep(0,2),matrix(c(1,0.8,0.8,1),2,2))
intD = rnorm(1); ZtoD =   rnorm(L,0,1); ZtoY = c(rnorm(s),rep(0,L-s)); DtoY = 1; intY = rnorm(1)
D = intD + Z %*% ZtoD + error[,1]
Y = intY + Z %*% ZtoY + D * DtoY + error[,2]

result = cv.sisVIVE(Y,D,Z,K=10)

</code></pre>


</div>