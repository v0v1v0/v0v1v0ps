<div class="container">

<table style="width: 100%;"><tr>
<td>nacf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Sample Network Covariance and Correlation Functions </h2>

<h3>Description</h3>

<p><code>nacf</code> computes the sample network covariance/correlation function for a specified variable on a given input network.  Moran's <code class="reqn">I</code> and Geary's <code class="reqn">C</code> statistics at multiple orders may be computed as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nacf(net, y, lag.max = NULL, type = c("correlation", "covariance",
    "moran", "geary"), neighborhood.type = c("in", "out", "total"),
    partial.neighborhood = TRUE, mode = "digraph", diag = FALSE,
    thresh = 0, demean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>net</code></td>
<td>
<p> one or more graphs. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> a numerical vector, of length equal to the order of <code>net</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p> optionally, the maximum geodesic lag at which to compute dependence (defaults to order <code>net</code>-1). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> the type of dependence statistic to be computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighborhood.type</code></td>
<td>
<p> the type of neighborhood to be employed when assessing dependence (as per <code>neighborhood</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.neighborhood</code></td>
<td>
<p> logical; should partial (rather than cumulative) neighborhoods be employed at higher orders? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
 <p><code>"digraph"</code> for directed graphs, or <code>"graph"</code> if <code>net</code> is undirected. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p> logical; does the diagonal of <code>net</code> contain valid data?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p> threshold at which to dichotomize <code>net</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean</code></td>
<td>
<p> logical; demean <code>y</code> prior to analysis? </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>nacf</code> computes dependence statistics for the vector <code>y</code> on network <code>net</code>, for neighborhoods of various orders.  Specifically, let <code class="reqn">\mathbf{A}_i</code> be the <code class="reqn">i</code>th order adjacency matrix of <code>net</code>.  The sample network autocovariance of <code class="reqn">\mathbf{y}</code> on <code class="reqn">\mathbf{A}_i</code> is then given by
</p>
<p style="text-align: center;"><code class="reqn">
    \sigma_i = \frac{\mathbf{y}^T \mathbf{A}_i \mathbf{y}}{E},
  </code>
</p>

<p>where <code class="reqn">E=\sum_{(j,k)}A_{ijk}</code>.  Similarly, the sample network autocorrelation in the above case is <code class="reqn">\rho_i=\sigma_i/\sigma_0</code>, where <code class="reqn">\sigma_0</code> is the variance of <code class="reqn">y</code>.  Moran's <code class="reqn">I</code> and Geary's <code class="reqn">C</code> statistics are defined in the usual fashion as
</p>
<p style="text-align: center;"><code class="reqn">
  I_i = \frac{N \sum_{j=1}^N \sum_{k=1}^N (y_j-\bar{y}) (y_k-\bar{y}) A_{ijk}}{E \sum_{j=1}^N y_j^2},
  </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
  C_i = \frac{(N-1) \sum_{j=1}^N \sum_{k=1}^N (y_j-y_k)^2 A_{ijk}}{2 E \sum_{j=1}^N (y-\bar{y})^2}
  </code>
</p>

<p>respectively, where <code class="reqn">N</code> is the order of <code class="reqn">\mathbf{A}_i</code> and <code class="reqn">\bar{y}</code> is the mean of <code class="reqn">\mathbf{y}</code>.
</p>
<p>The adjacency matrix associated with the <code class="reqn">i</code>th order neighborhood is defined as the identity matrix for order 0, and otherwise depends on the type of neighborhood involved.  For input graph <code class="reqn">G=(V,E)</code>, let the <em>base relation</em>, <code class="reqn">R</code>, be given by the underlying graph of <code class="reqn">G</code> (i.e., <code class="reqn">G \cup G^T</code>) if total neighborhoods are sought, the transpose of <code class="reqn">G</code> if incoming neighborhoods are sought, or <code class="reqn">G</code> otherwise.  The partial neighborhood structure of order <code class="reqn">i&gt;0</code> on <code class="reqn">R</code> is then defined to be the digraph on <code class="reqn">V</code> whose edge set consists of the ordered pairs <code class="reqn">(j,k)</code> having geodesic distance <code class="reqn">i</code> in <code class="reqn">R</code>.  The corresponding cumulative neighborhood is formed by the ordered pairs having geodesic distance less than or equal to <code class="reqn">i</code> in <code class="reqn">R</code>.  For purposes of <code>nacf</code>, these neighborhoods are calculated using <code>neighborhood</code>, with the specified parameters (including dichotomization at <code>thresh</code>).
</p>
<p>The return value for <code>nacf</code> is the selected dependence statistic, calculated for each neighborhood structure from order 0 (the identity) through order <code>lag.max</code> (or <code class="reqn">N-1</code>, if <code>lag.max==NULL</code>).  This vector can be used much like the conventional autocorrelation function, to identify dependencies at various lags.  This may, in turn, suggest a starting point for modeling via routines such as <code>lnam</code>.
</p>


<h3>Value</h3>

<p>A vector containing the dependence statistics (ascending from order 0).
</p>


<h3>Author(s)</h3>

<p> Carter T. Butts <a href="mailto:buttsc@uci.edu">buttsc@uci.edu</a> </p>


<h3>References</h3>

<p>Geary, R.C. (1954). “The Contiguity Ratio and Statistical Mapping.” <em>The Incorporated Statistician,</em> 5: 115-145.
</p>
<p>Moran, P.A.P.  (1950).  “Notes on Continuous Stochastic Phenomena.”  <em>Biometrika,</em> 37: 17-23.
</p>


<h3>See Also</h3>

 <p><code>geodist</code>, <code>gapply</code>, <code>neighborhood</code>, <code>lnam</code>, <code>acf</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#Create a random graph, and an autocorrelated variable
g&lt;-rgraph(50,tp=4/49)
y&lt;-qr.solve(diag(50)-0.8*g,rnorm(50,0,0.05))

#Examine the network autocorrelation function
nacf(g,y)                             #Partial neighborhoods
nacf(g,y,partial.neighborhood=FALSE)  #Cumulative neighborhoods

#Repeat, using Moran's I on the underlying graph
nacf(g,y,type="moran") 
nacf(g,y,partial.neighborhood=FALSE,type="moran")

</code></pre>


</div>