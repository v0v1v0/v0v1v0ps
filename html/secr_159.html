<div class="container">

<table style="width: 100%;"><tr>
<td>logmultinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multinomial Coefficient of SECR Likelihood
</h2>

<h3>Description</h3>

<p>Compute the constant multinomial component of the SECR log likelihood
</p>


<h3>Usage</h3>

<pre><code class="language-R">logmultinom(capthist, grp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>capthist</code></td>
<td>
 <p><code>capthist</code> object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p> factor defining group membership, or a list (see Details) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a particular dataset and grouping, the multinomial coefficient is
a constant; it does not depend on the parameters and may be ignored
when maximizing the likelihood to obtain parameter
estimates. Nevertheless, the log likelihood reported by
<code>secr.fit</code> includes this component <em>unless</em> the
detector type is ‘signal’, ‘polygon’, ‘polygonX’, ‘transect’ or
‘transectX’ (from 2.0.0).
</p>
<p>If <code>grp</code> is NULL then all animals are assumed to belong to one
group. Otherwise, the length of <code>grp</code> should equal the number of rows of
<code>capthist</code>.
</p>
<p><code>grp</code> may also be any vector that can be coerced
to a factor. If <code>capthist</code> is a multi-session capthist object
then <code>grp</code> should be a list with one factor per session.
</p>
<p>If capture histories are not assigned to groups the value is the
logarithm of
</p>
<p style="text-align: center;"><code class="reqn">{{n}\choose{n_1, ..., n_C}} = {{n!} \over {n_1! n_2! ... n_C!}} </code>
</p>
<p> where <code class="reqn">n</code> is the total number of
capture histories and <code class="reqn">n_1</code> ... <code class="reqn">n_C</code> are the frequencies with
which each of the <code class="reqn">C</code> unique capture histories were observed.
</p>
<p>If capture histories are assigned to <code class="reqn">G</code> groups the value is the
logarithm of </p>
<p style="text-align: center;"><code class="reqn">{ \prod_{g=1}^{G} {{n_g!} \over {n_{g1}! n_{g2}! ... n_{gC_g}}!}}  </code>
</p>
<p> where <code class="reqn">n_g</code> is the number of capture histories of
group <code class="reqn">g</code> and <code class="reqn">n_{g1}</code> ... <code class="reqn">n_{gC_g}</code> are the frequencies with
which each of the <code class="reqn">C_g</code> unique capture histories were observed for
group <code class="reqn">g</code>.
</p>
<p>For multi-session data, the value is the sum of the single-session
values. Both session structure and group structure therefore affect
the value computed. Users will seldom need this function.
</p>


<h3>Value</h3>

<p>The numeric value of the log likelihood component.
</p>


<h3>References</h3>

<p>Borchers, D. L. and Efford, M. G. (2008) Spatially explicit maximum
likelihood methods for capture–recapture studies. <em>Biometrics</em>
<b>64</b>, 377–385.
</p>
<p>Efford, M. G., Borchers D. L. and Byrom, A. E. (2009) Density estimation
by spatially explicit capture–recapture: likelihood-based methods. In:
D. L. Thompson, E. G. Cooch and M. J. Conroy (eds) <em>Modeling
Demographic Processes in Marked Populations</em>. Springer. Pp. 255–269.
</p>


<h3>See Also</h3>

<p><code>stoatDNA</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## no groups
logmultinom(stoatCH)

</code></pre>


</div>