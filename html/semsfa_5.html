<div class="container">

<table style="width: 100%;"><tr>
<td>semsfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Estimation of Stochastic Frontier Models</h2>

<h3>Description</h3>

<p>Semiparametric Estimation of Stochastic Frontier Models following the two step procedure proposed by Fan et al (1996) and further developed by Vidoli and Ferrara (2015) and Ferrara and Vidoli (2017). In the first step semiparametric or nonparametric regression techniques are used to relax parametric restrictions regards the functional form of the frontier and in the second step variance parameters are obtained by pseudolikelihood or method of moments estimators. Monotonicity restrinctions can be imposed by means of P-splines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semsfa(formula, data = list(), sem.method = "gam", var.method = "fan",
       ineffDecrease=TRUE, tol = 1e-05, n.boot=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class "formula": a symbolic description of the model to be fitted. The details of model specification are given under 'Details' 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the variables in the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sem.method</code></td>
<td>

<p>a character string indicating the type of estimation method to be used in the first step for the semiparametric or nonparametric regression; possible values are "gam" (default), "gam.mono" for monotone gam, "kernel" or "loess"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.method</code></td>
<td>

<p>the type of estimation method to be used in the second step for the variance components: "fan" (default) for Fan et al. (1996) approach and "mm" for method of moments
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ineffDecrease</code></td>
<td>

<p>logical: TRUE (default) for estimating a production function, FALSE for estimating a cost function; this is done for usage compatibility with frontier package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>numeric. Convergence tolerance for pseudolikelihood estimators of variance parameters of the composed error term
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>

<p>numeric. Number of bootstrap replicates to calculate standard error for the variance components, by default bootstrap standard errors will not be calculated (n.boot=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments accepted by <code>mgcv::gam</code>, <code>gamlss::gamlss</code>, <code>np::npreg</code> or <code>loess</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parametric stochastic production frontier models, introduced by Aigner et al. (1977) and Meeusen and van den Broeck (1977), specify output in terms of a response function and a composite error term. The composite error term consists of a two-sided error representing random effects and a one-sided term representing technical inefficiency.
The production stochastic frontier model can be written, in general terms, as:
</p>
<p style="text-align: center;"><code class="reqn">y_i = f (x_i)+v_i - u_i,\quad \quad i = 1, ..., n,</code>
</p>

<p>where <code class="reqn">Y_i\in R^+</code> is the single output of unit <code class="reqn">i</code>, <code class="reqn">X_i\in R^{+}_{p}</code> is the vector of inputs, <code class="reqn">f(.)</code> defines a production frontier relationship between inputs X and the single output Y. In following common practice, we assume that <code class="reqn">v</code> and <code class="reqn">u</code> are each identically independently distributed (<code class="reqn">iid</code>) with  <code class="reqn">v~ N(0,\sigma_v)</code> and  <code class="reqn">u</code> distributed half-normally on the non-negative part of the real number line: <code class="reqn">u~ N^{+}(0,\sigma_u)</code>; furthermore, the probability density function of the composite disturbance can be rewritten in terms of <code class="reqn">\lambda = \sigma_u/\sigma_v</code> and <code class="reqn">\sigma^2 = \sigma_v^2+\sigma_u^2</code> for the estimation algorithm.
To overcome drawbacks due to the specification of a particular production function <code class="reqn">f(\cdot)</code> we consider the estimation of a Semiparametric Stochastic Production Frontier Models through a two step procedure originally proposed by Fan et al (1996): in the first step a semiparametric or nonparametric regression technique is used to estimate the conditional expectation, while in the second step <code class="reqn">\lambda</code> and <code class="reqn">\sigma</code> parameters are estimated by pseudolikelihood (via optimize) or by method of moments estimators (var.method argument). 
In the case of a cost function frontier (<code>ineffDecrease=FALSE</code>) the composite error term is <code class="reqn">\epsilon = v + u</code>.
Vidoli and Ferrara (2015) suggest a Generalized Additive Model (GAM) framework in the first step even if any semiparametric or nonparametric tecnique may be used (Fan et al., 1996). 
The avalaible methods for the first step are:
</p>
 
<ul>
<li>
<p> sem.method="gam" invokes gam() from mgcv;
</p>
</li>
<li>
<p> sem.method="gam.mono" invokes gamlss() from gamlss to impose monotonicity restrictions on inputs;
</p>
</li>
<li>
<p> sem.method="kernel" invokes npreg() from np;
</p>
</li>
<li>
<p> sem.method="loess" invokes loess() from stats.</p>
</li>
</ul>
<p>Since in the first step different estimation procedure may be invoked from different packages, the formula argument has to be compatible with the corresponding function.
The avalaible methods for the second step are:
</p>
 
<ul>
<li>
<p> var.method="fan" pseudolikelihood;
</p>
</li>
<li>
<p> var.method="mm" Method of Moments.</p>
</li>
</ul>
<h3>Value</h3>

<p><code>semsfa()</code> returns an object of class <code>semsfa</code>. 
An <code>semsfa</code> object is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response variable used as specified in <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sem.method</code></td>
<td>
<p>the type of semiparametric or nonparametric regression as given by sem.method ("gam", "gam.mono", "kernel", "loess")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.method</code></td>
<td>
<p>the type of error component estimator ("fan", "mm")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ineffDecrease</code></td>
<td>
<p>logical, as given by ineffDecrease</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>an object of class "gam", "gamlss" (monotone gam), "np"(kernel) or "loess" depending on sem.method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.fitted</code></td>
<td>
<p>fitted values on the "mean" frontier (semiparametric/non parametric regression)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regkewness</code></td>
<td>
<p>asymmetry index calculated on residuals obtained in the first step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p><code class="reqn">\lambda</code> estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p><code class="reqn">\sigma</code> estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>fitted values on the frontier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence tolerance for pseudolikelihood estimators used in optimize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.df</code></td>
<td>
<p>residual degree of freedom of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>'Bayesian Information Criterion' according to the formula <code>-2*log-likelihood</code><code>+ log(n)*npar</code> where <code>npar</code> represents the number of parameters in the fitted model and <code>n</code> the number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>number of bootstrap replicates used (default n.boot=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.mat</code></td>
<td>
<p>a matrix containing <code class="reqn">\lambda</code> and <code class="reqn">\sigma</code> values from each bootstrap replicate (if n.boot&gt;0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.se</code></td>
<td>
<p>boostrapped standard errors for <code class="reqn">\lambda</code> and <code class="reqn">\sigma</code> (if n.boot&gt;0)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function <code>summary</code> (i.e. <code>summary.semsfa</code>) can be used to obtain a summary of the results, <code>efficiencies.semsfa</code> to calculate efficiency scores and <code>plot</code> (i.e. <code>plot.semsfa</code>) to graph efficiency previsions and regression components (i.e. the first step).
</p>
<p>You must take the natural logarithm of the response variable before fitting a stochastic frontier production or cost model.
</p>


<h3>Author(s)</h3>

<p>Giancarlo Ferrara
</p>


<h3>References</h3>

<p>Aigner., D., Lovell, C.A.K., Schmidt, P., 1977. Formulation and estimation of stochastic frontier production function models. Journal of Econometrics 6:21-37
</p>
<p>Fan, Y., Li, Q., Weersink, A., 1996. Semiparametric estimation of stochastic production frontier models. Journal of Business &amp; Economic Statistics 14:460-468
</p>
<p>Ferrara, G., Vidoli, F., 2017. Semiparametric stochastic frontier models: A generalized additive model approach. European Journal of Operational Research, 258:761-777.
</p>
<p>Hastie, T., Tibshirani, R., 1990. Generalized additive models. Chapman &amp; Hall
</p>
<p>Kumbhakar, S.C., Lovell, C.A.K, 2000. Stochastic Frontier Analysis. Cambridge University
Press, U.K
</p>
<p>Meeusen, W., van den Broeck, J., 1977. Efficiency estimation from Cobb-Douglas production functions with composed error. International Economic Review, 18:435-444
</p>
<p>Vidoli, F., Ferrara, G., 2015. Analyzing Italian citrus sector by semi-nonparametric frontier efficiency models. Empirical Economics, 49:641-658
</p>


<h3>See Also</h3>

<p><code>summary.semsfa</code>, <code>efficiencies.semsfa</code>, <code>plot.semsfa</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
set.seed(0)
n&lt;-200

x&lt;- runif(n, 1, 2)
v&lt;- rnorm(n, 0, 1)
u&lt;- abs(rnorm(n,0,2.5))

#cost frontier
fy&lt;- 2+30*x+5*x^2
y &lt;- fy + v + u

dati&lt;-data.frame(y,x)
#first-step: gam, second-step: fan
o&lt;-semsfa(y~s(x),dati,sem.method="gam",ineffDecrease=FALSE)
#first-step: gam, second-step: mm
## Not run: o&lt;-semsfa(y~s(x),dati,sem.method="gam",ineffDecrease=FALSE,var.method="mm")
plot(x,y)
curve(2+30*x+5*x^2,add=TRUE)
points(sort(x),o$fitted[order(x)],col=3,type="l")

#production frontier
fy&lt;- 2+30*x-5*x^2
y &lt;- fy + v - u

dati&lt;-data.frame(y,x)
#first-step: gam, second-step: fan
o&lt;-semsfa(y~s(x),dati,sem.method="gam",ineffDecrease=TRUE)

plot(x,y)
curve(2+30*x-5*x^2,add=TRUE)
points(sort(x),o$fitted[order(x)],col=3,type="l")

#imposing monotonicity restrictions on inputs
set.seed(25)
n=150

x=runif(n,0,3)
u=abs(rnorm(n,0,1))
v=rnorm(n,0,.75*((pi-2)/pi))

#production frontier
fy&lt;-10-5*exp(-x)
y &lt;- fy+v-u

dati&lt;-data.frame(y,x)
#first-step: monotone gam, second-step: fan
o&lt;-semsfa(y~pbm(x,mono="up"),sem.method = "gam.mono",dati)
plot(x,y)
curve(10-5*exp(-x),add=TRUE)
points(sort(x),o$fitted[order(x)],col=3,type="l")

</code></pre>


</div>