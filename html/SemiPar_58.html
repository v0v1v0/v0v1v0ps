<div class="container">

<table style="width: 100%;"><tr>
<td>spm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a SemiParametric regression Model</h2>

<h3>Description</h3>

<p><code>spm</code> is used to fit semiparametric
regression models using the mixed model
representation of penalized splines
(per Ruppert, Wand and Carroll, 2003).
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm(form,random=NULL,group=NULL,family="gaussian",
                spar.method="REML",omit.missing=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a formula describing the model to be fit. 
Note, that an intercept is always included, whether 
given in the formula or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>"random=~1" specifies inclusion of a random intercept
according to the groups specified by the "group" argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector of labels for specifying groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>for specification of the type of likelihood
model assumed in the fitting.
May be "gaussian","binomial" or "poisson"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spar.method</code></td>
<td>
<p>method for automatic smoothing parameter
selection. May be "REML" (restricted maximum
likelihood) or "ML" (maximum likelihood).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit.missing</code></td>
<td>
<p>a logical value indicating whether
fields with missing values are to be
omitted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the SemiPar Users' Manual for details
and examples.
</p>


<h3>Value</h3>

<p>An list object of class <code>"spm"</code> containing the fitted model.
The components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>mimics fit object of lme() for
family="gaussian" and glmmPQL() for family="binomial" or
family="poisson".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>information about the inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>auxiliary information such as variability
estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M.P. Wand 
<a href="mailto:mwand@uow.edu.au">mwand@uow.edu.au</a>
(other contributors listed in SemiPar Users' Manual).
</p>


<h3>References</h3>

<p>Ruppert, D., Wand, M.P. and Carroll, R.J. (2003)<br><em>Semiparametric Regression</em> Cambridge University Press.<br><a href="http://stat.tamu.edu/~carroll/semiregbook/">http://stat.tamu.edu/~carroll/semiregbook/</a>
</p>
<p>Ganguli, B. and Wand, M.P. (2005)<br><em>SemiPar 1.0 Users' Manual</em>.<br><a href="http://matt-wand.utsacademics.info/SPmanu.pdf">http://matt-wand.utsacademics.info/SPmanu.pdf</a>
</p>


<h3>See Also</h3>

<p><code>gam</code> (in package ‘mgcv’)
<code>lme</code> (in package ‘nlme’)
<code>glmmPQL</code> (in package ‘MASS’)
<code>plot.spm</code>
<code>summary.spm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SemiPar)
data(fossil)
attach(fossil)
fit &lt;- spm(strontium.ratio~f(age))
plot(fit)
summary(fit)

data(calif.air.poll)
attach(calif.air.poll)
fit &lt;- spm(ozone.level ~ f(daggett.pressure.gradient)+
                         f(inversion.base.height) +
                         f(inversion.base.temp))
summary(fit)
par(mfrow=c(2,2))
plot(fit)

# The SemiPar User Manual contains several other examples
# and details of plotting parameters.
#
# The current version of the manual is posted on the web-site:
#
#     http://matt-wand.utsacademics.info/SPmanu.pdf
</code></pre>


</div>