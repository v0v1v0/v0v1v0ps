<div class="container">

<table style="width: 100%;"><tr>
<td>g_REML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates adjusted REML effect size</h2>

<h3>Description</h3>

<p>Estimates a design-comparable standardized mean difference effect size based on data 
from a multiple baseline design, using adjusted REML method as described in Pustejovsky, Hedges, 
&amp; Shadish (2014). Note that the data must contain one row per measurement occasion per case.
</p>


<h3>Usage</h3>

<pre><code class="language-R">g_REML(
  m_fit,
  p_const,
  r_const,
  X_design = model.matrix(m_fit, data = m_fit$data),
  Z_design = model.matrix(m_fit$modelStruct$reStruct, data = m_fit$data),
  block = nlme::getGroups(m_fit),
  times = attr(m_fit$modelStruct$corStruct, "covariate"),
  returnModel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m_fit</code></td>
<td>
<p>Fitted model of class lme, with AR(1) correlation structure at level 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_const</code></td>
<td>
<p>Vector of constants for calculating numerator of effect size. 
Must be the same length as fixed effects in <code>m_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_const</code></td>
<td>
<p>Vector of constants for calculating denominator of effect size. 
Must be the same length as the number of variance component parameters in <code>m_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_design</code></td>
<td>
<p>(Optional) Design matrix for fixed effects. Will be extracted from <code>m_fit</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_design</code></td>
<td>
<p>(Optional) Design matrix for random effects. Will be extracted from <code>m_fit</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>(Optional) Factor variable describing the blocking structure. Will be extracted from <code>m_fit</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>(Optional) list of times used to describe AR(1) structure. Will be extracted from <code>m_fit</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnModel</code></td>
<td>
<p>(Optional) If true, the fitted input model is included in the return.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components
</p>

<table>
<tr>
<td style="text-align: left;">
<code>p_beta</code> </td>
<td style="text-align: left;"> Numerator of effect size </td>
</tr>
<tr>
<td style="text-align: left;">
<code>r_theta</code> </td>
<td style="text-align: left;"> Squared denominator of effect size </td>
</tr>
<tr>
<td style="text-align: left;">
<code>delta_AB</code> </td>
<td style="text-align: left;"> Unadjusted (REML) effect size estimate </td>
</tr>
<tr>
<td style="text-align: left;">
<code>nu</code> </td>
<td style="text-align: left;"> Estimated denominator degrees of freedom </td>
</tr>
<tr>
<td style="text-align: left;">
<code>kappa</code> </td>
<td style="text-align: left;"> Scaled standard error of numerator </td>
</tr>
<tr>
<td style="text-align: left;">
<code>g_AB</code> </td>
<td style="text-align: left;"> Corrected effect size estimate </td>
</tr>
<tr>
<td style="text-align: left;">
<code>V_g_AB</code> </td>
<td style="text-align: left;"> Approximate variance estimate </td>
</tr>
<tr>
<td style="text-align: left;">
<code>cnvg_warn</code> </td>
<td style="text-align: left;"> Indicator that model did not converge </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sigma_sq</code> </td>
<td style="text-align: left;"> Estimated level-1 variance </td>
</tr>
<tr>
<td style="text-align: left;">
<code>phi</code> </td>
<td style="text-align: left;"> Estimated autocorrelation </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Tau</code> </td>
<td style="text-align: left;"> Vector of level-2 variance components </td>
</tr>
<tr>
<td style="text-align: left;">
<code>I_E_inv</code> </td>
<td style="text-align: left;"> Expected information matrix </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Pustejovsky, J. E., Hedges, L. V., &amp; Shadish, W. R. (2014). 
Design-comparable effect sizes in multiple baseline designs: A general modeling framework.
<em>Journal of Educational and Behavioral Statistics, 39</em>(4), 211-227. <a href="https://doi.org/10.3102/1076998614547577">doi:10.3102/1076998614547577</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Laski)
Laski_RML &lt;- lme(fixed = outcome ~ treatment, 
                 random = ~ 1 | case, 
                 correlation = corAR1(0, ~ time | case), 
                 data = Laski)
summary(Laski_RML)
g_REML(Laski_RML, p_const = c(0,1), r_const = c(1,0,1), returnModel=FALSE)

data(Schutte)
Schutte$trt.week &lt;- with(Schutte, unlist(tapply((treatment=="treatment") * week, 
         list(treatment,case), function(x) x - min(x))) + (treatment=="treatment"))
Schutte$week &lt;- Schutte$week - 9
Schutte_RML &lt;- lme(fixed = fatigue ~ week + treatment + trt.week, 
                   random = ~ week | case, 
                   correlation = corAR1(0, ~ week | case), 
                   data = subset(Schutte, case != 4))
summary(Schutte_RML)
Schutte_g &lt;- g_REML(Schutte_RML, p_const = c(0,0,1,7), r_const = c(1,0,1,0,0))
summary(Schutte_g)
</code></pre>


</div>