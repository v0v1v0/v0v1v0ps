<div class="container">

<table style="width: 100%;"><tr>
<td>utility.tables</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tables and plots of utility measures</h2>

<h3>Description</h3>

<p>Calculates and plots tables of utility measures. The calculations of 
utility measures are done by the function <code>utility.tab</code>.
Options are all one-way tables, all two-way tables or three-way tables 
for a specified third variable along with pairs of all other variables.
</p>
<p>This function can be also used with synthetic data NOT created by 
<code>syn()</code>, but then an additional parameters <code>not.synthesised</code> 
and <code>cont.na</code> might need to be provided.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'synds'
utility.tables(object, data,
               tables = "twoway", maxtables = 5e4,
               vars = NULL, third.var = NULL,
               useNA = TRUE, ngroups = 5,
               tab.stats = c("pMSE", "S_pMSE", "df"), 
               plot.stat = "S_pMSE", plot = TRUE, 
               print.tabs = FALSE, digits.tabs = 4,
               max.scale = NULL, min.scale = 0, plot.title = NULL,
               nworst = 5, ntabstoprint = 0, k.syn = FALSE, 
               low = "grey92", high = "#E41A1C",
               n.breaks = NULL, breaks = NULL, ...)
               
## S3 method for class 'data.frame'
utility.tables(object, data, 
               cont.na = NULL, not.synthesised = NULL, 
               tables = "twoway", maxtables = 5e4,
               vars = NULL, third.var = NULL, 
               useNA = TRUE, ngroups = 5, 
               tab.stats = c("pMSE", "S_pMSE", "df"), 
               plot.stat = "S_pMSE", plot = TRUE,  
               print.tabs = FALSE, digits.tabs = 4,
               max.scale = NULL, min.scale = 0, plot.title = NULL,  
               nworst = 5, ntabstoprint = 0, k.syn = FALSE,
               low = "grey92", high = "#E41A1C",
               n.breaks = NULL, breaks = NULL, ...)

## S3 method for class 'list'
utility.tables(object, data,
               cont.na = NULL, not.synthesised = NULL, 
               tables = "twoway", maxtables = 5e4, 
               vars = NULL, third.var = NULL, 
               useNA = TRUE, ngroups = 5, 
               tab.stats = c("pMSE", "S_pMSE", "df"), 
               plot.stat = "S_pMSE", plot = TRUE, 
               print.tabs = FALSE, digits.tabs = 4,
               max.scale = NULL, min.scale = 0, plot.title = NULL,  
               nworst = 5, ntabstoprint = 0, k.syn = FALSE,
               low = "grey92", high = "#E41A1C",
               n.breaks = NULL, breaks = NULL, ...)

## S3 method for class 'utility.tables'
print(x, print.tabs = NULL, digits.tabs = NULL, 
      plot = NULL, plot.title = NULL, max.scale = NULL, min.scale = NULL, 
      nworst = NULL, ntabstoprint = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>synds</code>, which stands for 'synthesised 
data set'. It is typically created by function <code>syn()</code> and it includes 
<code>object$m</code> synthesised data set(s) as <code>object$syn</code>. This a single 
data set when <code>object$m = 1</code> or a list of length <code>object$m</code> when 
<code>object$m &gt; 1</code>. Alternatively, when data are synthesised not using 
<code>syn()</code>, it can be a data frame with a synthetic data set or a list 
of data frames with synthetic data sets, all created from the same original 
data with the same variables and the same method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the original (observed) data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont.na</code></td>
<td>
<p>a named list of codes for missing values for continuous
variables if different from the <code>R</code> missing data code <code>NA</code>.
The names of the list elements must correspond to the variables names for 
which the missing data codes need to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>not.synthesised</code></td>
<td>
<p>a vector of variable names for any variables that has 
been left unchanged in the synthetic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>defines the type of tables to produce. Options are 
<code>"oneway"</code>, <code>"twoway"</code> (default) or <code>"threeway"</code>. 
If set to <code>"oneway"</code> or <code>"twoway"</code> all possible tables from 
<code>vars</code> are produced. For <code>"threeway"</code>, <code>third.var</code> may be 
specified and all three-way tables between this variable and other pairs of 
variables are produced. If a third variable is not specified the function
chooses the variable with the largest median utility measure for all three-way
tables it contributes to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtables</code></td>
<td>
<p>maximum number of tables that will be produced. If number of 
tables is larger, then utility is only measured for a sample of size 
<code>maxtables</code>. You cannot produce plots of twoway or three way tables from 
sampled tables</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>a vector of strings with the names of variables to be used to form 
the table, or a vector of variable numbers in the original data. Defaults to 
all variables in both original and synthetic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>third.var</code></td>
<td>
<p>when <code>tables</code> is <code>"threeway"</code> a variable 
to make the third variable with all other pairs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useNA</code></td>
<td>
<p>determines if <code>NA</code> values are to be included in tables. Only 
applies for method <code>"tab"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngroups</code></td>
<td>
<p>if numerical (non-factor) variables included with 
<code>method = "tab"</code> will be classified into this number of groups to form
tables. Classification is performed using <code>classIntervals()</code> function 
for <code>n = ngroups</code>. By default, <code>style = "quantile"</code>, to get 
appropriate groups for skewed data. Problems for variables with a small 
number of unique  values are handled by selecting only unique values of 
breaks. Arguments of <code>classIntervals()</code> may be, however, specified 
in the call to <code>utility.tables()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab.stats</code></td>
<td>
<p>statistics to include in the table of results. Must be 
a selection from: <code>"VW"</code>, <code>"FT"</code>,<code>"JSD"</code>, <code>"SPECKS"</code>, 
<code>"WMabsDD"</code>, <code>"U"</code>, <code>"G"</code>, <code>"pMSE"</code>, <code>"PO50"</code>, 
<code>"MabsDD"</code>, <code>"dBhatt"</code>,  <code>"S_VW"</code>, <code>"S_FT"</code>, 
<code>"S_JSD"</code>, <code>"S_WMabsDD"</code>, <code>"S_G"</code>, <code>"S_pMSE"</code>, 
<code>"df"</code>, <code>dfG</code>. If <code>tab.stats = "all"</code>, all of these will 
be included. See <code>utility.tab</code> for explanations of measures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.stat</code></td>
<td>
<p>statistics to plot. Choice  is <code>"VW"</code>, <code>"FT"</code>,
<code>"JSD"</code>, <code>"SPECKS"</code>,  <code>"WMabsDD"</code>, <code>"U"</code>, <code>"G"</code>, 
<code>"pMSE"</code>, <code>"PO50"</code>, <code>"MabsDD"</code>, <code>"dBhatt"</code>, 
<code>"S_VW"</code>, <code>"S_FT"</code>, <code>"S_JSD"</code>, <code>"S_WMabsDD"</code>, 
<code>"S_G"</code>, <code>"S_pMSE"</code>. See <code>utility.tab</code> for 
explanations of measures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>determines if plot will be produced when the result is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.tabs</code></td>
<td>
<p>logical value that determines if table of results is 
to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.tabs</code></td>
<td>
<p>number of digits to print for table, except for 
p-values that are always printed to 4 places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.scale</code></td>
<td>
<p>a numeric value for the maximum value used in calculating 
the shading of the plots. If it is <code>NULL</code> then the maximum value  
will be replaced by the maximum value in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.scale</code></td>
<td>
<p>a numeric value for the minimum value used in calculating 
the shading of the plots. If it is <code>NULL</code> then the minimum value  
will be replaced by zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nworst</code></td>
<td>
<p>a number of variable combinations with worst utility scores 
to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntabstoprint</code></td>
<td>
<p>a number of tables to print for observed and synthetic 
data with the worst utility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.syn</code></td>
<td>
<p>a logical indicator as to whether the sample size itself has 
been synthesised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>
<p>colour for low end of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high</code></td>
<td>
<p>colour for high end of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.breaks</code></td>
<td>
<p>a number of break points to create if breaks are not given 
directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>breaks for a two colour binned gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>utility.tables</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates tables of observed and synthesised values for the variables 
specified in <code>vars</code> with the function <code>utility.tab</code> and produces  
tables and plots of one-way, two-way or 
three-way utility measures formed from <code>vars</code>. Several options for utility 
measures can be selected for printing or plotting. Details are in help file 
for <code>utility.tab</code>. 
</p>
<p>The tables and variables with the worst utility scores are identified. 
Visualisations of the matrices of utility scores are plotted. For threeway
tables a third variable can be defined to select all tables involving that 
variable for plotting. If it is not specified the variable with tables 
giving the worst utility is selected as the third variable.
</p>


<h3>Value</h3>

<p>An object of class <code>utility.tab</code> which is a list with the following 
components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tabs</code></td>
<td>
<p>a table with all the selected measures for all combinations of 
variables defined by <code>tables</code>, <code>third.var</code>, and <code>vars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.stat</code></td>
<td>
<p>measure used in <code>mat</code> and <code>toplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>third.var</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>utility.plot</code></td>
<td>
<p>plot of the selected utility measure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.scores</code></td>
<td>
<p>an average of utility scores for all combinations with other
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.tabs</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.tabs</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.scale</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.scale</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntabstoprint</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nworst</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>worstn</code></td>
<td>
<p>variable combinations with <code>nworst</code> worst utility scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>worsttabs</code></td>
<td>
<p>observed and synthetic cross-tabulations for <code>worstn</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Read, T.R.C. and Cressie, N.A.C. (1988) <em>Goodness–of–Fit Statistics 
for Discrete Multivariate Data</em>, Springer–Verlag, New York.  
</p>
<p>Voas, D. and Williamson, P. (2001) Evaluating goodness-of-fit measures for 
synthetic microdata. <em>Geographical and Environmental Modelling</em>,
<b>5</b>(2), 177-200.
</p>


<h3>See Also</h3>

<p><code>utility.tab</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ods &lt;- SD2011[1:1000, c("sex", "age", "edu", "marital", "region", "income")]
s1 &lt;- syn(ods)

### synthetic data provided as a 'synds' object  
(t1 &lt;- utility.tables(s1, ods, tab.stats = "all", print.tabs = TRUE))
### synthetic data provided as a 'data.frame' object
(t1 &lt;- utility.tables(s1$syn, ods, tab.stats = "all", print.tabs = TRUE))

t2 &lt;- utility.tables(s1, ods, tables = "twoway")
print(t2, max.scale = 3)

(t3 &lt;- utility.tables(s1, ods, tab.stats = "all", tables = "threeway", 
                      third.var = "sex", print.tabs = TRUE))

(t4 &lt;- utility.tables(s1, ods, tab.stats = "all", tables = "threeway", 
                      third.var = "sex", useNA = FALSE, print.tabs = TRUE))

(t5 &lt;- utility.tables(s1, ods,  tab.stats = "all", 
                      print.tabs = TRUE))
</code></pre>


</div>