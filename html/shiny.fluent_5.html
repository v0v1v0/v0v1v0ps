<div class="container">

<table style="width: 100%;"><tr>
<td>BasePickerListBelow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pickers</h2>

<h3>Description</h3>

<p>For more details and examples visit the <a href="https://developer.microsoft.com/en-us/fluentui#/controls/web/Pickers">official docs</a>.
The R package cannot handle each and every case, so for advanced use cases
you need to work using the original docs to achieve the desired result.
</p>
<p>Pickers are used to select one or more items, such as tags or files, from a large list.
</p>
<p>For more details and examples visit the <a href="https://developer.microsoft.com/en-us/fluentui#/controls/web/pickers">official docs</a>.
The R package cannot handle each and every case, so for advanced use cases
you need to work using the original docs to achieve the desired result.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BasePickerListBelow(...)

TagPicker(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Props to pass to the component.
The allowed props are listed below in the <b>Details</b> section.</p>
</td>
</tr></table>
<h3>Details</h3>


<ul>
<li> <p><b> className </b> <code>string</code> <br> ClassName for the picker.
</p>
</li>
<li> <p><b> componentRef </b> <code style="white-space: pre;">⁠IRefObject&lt;IBasePicker&lt;T&gt;&gt;⁠</code> <br> Optional callback to access the IBasePicker interface. Use this instead of ref for accessing the public methods and properties of the component.
</p>
</li>
<li> <p><b> createGenericItem </b> <code style="white-space: pre;">⁠(input: string, ValidationState: ValidationState) =&gt; ISuggestionModel&lt;T&gt; | T⁠</code> <br> Function that specifies how arbitrary text entered into the well is handled.
</p>
</li>
<li> <p><b> defaultSelectedItems </b> <code>T[]</code> <br> Initial items that have already been selected and should appear in the people picker.
</p>
</li>
<li> <p><b> disabled </b> <code>boolean</code> <br> Flag for disabling the picker.
</p>
</li>
<li> <p><b> enableSelectedSuggestionAlert </b> <code>boolean</code> <br> Adds an additional alert for the currently selected suggestion. This prop should be set to true for IE11 and below, as it enables proper screen reader behavior for each suggestion (since aria-activedescendant does not work with IE11). It should not be set for modern browsers (Edge, Chrome).
</p>
</li>
<li> <p><b> getTextFromItem </b> <code style="white-space: pre;">⁠(item: T, currentValue?: string) =&gt; string⁠</code> <br> A callback to get text from an item. Used to autofill text in the pickers.
</p>
</li>
<li> <p><b> inputProps </b> <code>IInputProps</code> <br> AutoFill input native props
</p>
</li>
<li> <p><b> itemLimit </b> <code>number</code> <br> Restrict the amount of selectable items.
</p>
</li>
<li> <p><b> onBlur </b> <code style="white-space: pre;">⁠React.FocusEventHandler&lt;HTMLInputElement | Autofill&gt;⁠</code> <br> A callback for when the user moves the focus away from the picker
</p>
</li>
<li> <p><b> onChange </b> <code style="white-space: pre;">⁠(items?: T[]) =&gt; void⁠</code> <br> A callback for when the selected list of items changes.
</p>
</li>
<li> <p><b> onDismiss </b> <code style="white-space: pre;">⁠(ev?: any, selectedItem?: T) =&gt; boolean | void⁠</code> <br> A callback to override the default behavior of adding the selected suggestion on dismiss. If it returns true or nothing, the selected item will be added on dismiss. If false, the selected item will not be added on dismiss.
</p>
</li>
<li> <p><b> onEmptyInputFocus </b> <code style="white-space: pre;">⁠(selectedItems?: T[]) =&gt; T[] | PromiseLike&lt;T[]&gt;⁠</code> <br> A callback for what should happen when a user clicks within the input area.
</p>
</li>
<li> <p><b> onEmptyResolveSuggestions </b> <code style="white-space: pre;">⁠(selectedItems?: T[]) =&gt; T[] | PromiseLike&lt;T[]&gt;⁠</code> <br> A callback for what should happen when suggestions are shown without input provided. Returns the already selected items so the resolver can filter them out. If used in conjunction with resolveDelay this will only kick off after the delay throttle.
</p>
</li>
<li> <p><b> onFocus </b> <code style="white-space: pre;">⁠React.FocusEventHandler&lt;HTMLInputElement | Autofill&gt;⁠</code> <br> A callback for when the user put focus on the picker
</p>
</li>
<li> <p><b> onGetMoreResults </b> <code style="white-space: pre;">⁠(filter: string, selectedItems?: T[]) =&gt; T[] | PromiseLike&lt;T[]&gt;⁠</code> <br> A callback that gets the rest of the results when a user clicks get more results.
</p>
</li>
<li> <p><b> onInputChange </b> <code style="white-space: pre;">⁠(input: string) =&gt; string⁠</code> <br> A callback used to modify the input string.
</p>
</li>
<li> <p><b> onItemSelected </b> <code style="white-space: pre;">⁠(selectedItem?: T) =&gt; T | PromiseLike&lt;T&gt; | null⁠</code> <br> A callback to process a selection after the user selects something from the picker. If the callback returns null, the item will not be added to the picker.
</p>
</li>
<li> <p><b> onRemoveSuggestion </b> <code style="white-space: pre;">⁠(item: T) =&gt; void⁠</code> <br> A callback for when an item is removed from the suggestion list
</p>
</li>
<li> <p><b> onRenderItem </b> <code style="white-space: pre;">⁠(props: IPickerItemProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> Function that specifies how the selected item will appear.
</p>
</li>
<li> <p><b> onRenderSuggestionsItem </b> <code style="white-space: pre;">⁠(props: T, itemProps: ISuggestionItemProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> Function that specifies how an individual suggestion item will appear.
</p>
</li>
<li> <p><b> onResolveSuggestions </b> <code style="white-space: pre;">⁠(filter: string, selectedItems?: T[]) =&gt; T[] | PromiseLike&lt;T[]&gt;⁠</code> <br> A callback for what should happen when a person types text into the input. Returns the already selected items so the resolver can filter them out. If used in conjunction with resolveDelay this will only kick off after the delay throttle.
</p>
</li>
<li> <p><b> onValidateInput </b> <code style="white-space: pre;">⁠(input: string) =&gt; ValidationState⁠</code> <br> A function used to validate if raw text entered into the well can be added into the selected items list
</p>
</li>
<li> <p><b> pickerCalloutProps </b> <code>ICalloutProps</code> <br> The properties that will get passed to the Callout component.
</p>
</li>
<li> <p><b> pickerSuggestionsProps </b> <code>IBasePickerSuggestionsProps</code> <br> The properties that will get passed to the Suggestions component.
</p>
</li>
<li> <p><b> removeButtonAriaLabel </b> <code>string</code> <br> Aria label for the "X" button in the selected item component.
</p>
</li>
<li> <p><b> resolveDelay </b> <code>number</code> <br> The delay time in ms before resolving suggestions, which is kicked off when input has been changed. e.g. If a second input change happens within the resolveDelay time, the timer will start over. Only until after the timer completes will onResolveSuggestions be called.
</p>
</li>
<li> <p><b> searchingText </b> <code style="white-space: pre;">⁠((props: { input: string; }) =&gt; string) | string⁠</code> <br> The text to display while searching for more results in a limited suggestions list
</p>
</li>
<li> <p><b> selectedItems </b> <code>T[]</code> <br> The items that the base picker should currently display as selected. If this is provided then the picker will act as a controlled component.
</p>
</li>
<li> <p><b> styles </b> <code style="white-space: pre;">⁠IStyleFunctionOrObject&lt;IBasePickerStyleProps, IBasePickerStyles&gt;⁠</code> <br> Call to provide customized styling that will layer on top of the variant rules.
</p>
</li>
<li> <p><b> theme </b> <code>ITheme</code> <br> Theme provided by styled() function.
</p>
</li>
<li> <p><b> "aria-label" </b> <code>string</code> <br> Screen reader label to apply to an input element.
</p>
</li>
<li> <p><b> defaultVisibleValue </b> <code>string</code> <br> The default value to be visible when the autofill first created. This is different than placeholder text because the placeholder text will disappear and re-appear. This text persists until deleted or changed.
</p>
</li>
<li> <p><b> componentRef </b> <code style="white-space: pre;">⁠IRefObject&lt;IPickerItem&gt;⁠</code> <br> Optional callback to access the IPickerItem interface. Use this instead of ref for accessing the public methods and properties of the component.
</p>
</li>
<li> <p><b> index </b> <code>number</code> <br> Index number of the item in the array of picked items.
</p>
</li>
<li> <p><b> item </b> <code>T</code> <br> The item of Type T (Persona, Tag, or any other custom item provided).
</p>
</li>
<li> <p><b> key </b> <code>string | number</code> <br> Unique key for each picked item.
</p>
</li>
<li> <p><b> onItemChange </b> <code style="white-space: pre;">⁠(item: T, index: number) =&gt; void⁠</code> <br> Internal Use only, gives a callback to the renderer to call when an item has changed. This allows the base picker to keep track of changes in the items.
</p>
</li>
<li> <p><b> onRemoveItem </b> <code style="white-space: pre;">⁠() =&gt; void⁠</code> <br> Callback issued when the item is removed from the array of picked items.
</p>
</li>
<li> <p><b> removeButtonAriaLabel </b> <code>string</code> <br> Aria-label for the picked item remove button.
</p>
</li>
<li> <p><b> selected </b> <code>boolean</code> <br> Whether the picked item is selected or not.
</p>
</li>
<li> <p><b> className </b> <code>string</code> <br> Optional className for the root element of the suggestion item.
</p>
</li>
<li> <p><b> componentRef </b> <code style="white-space: pre;">⁠IRefObject&lt;ISuggestionsItem&gt;⁠</code> <br> Optional callback to access the ISuggestionItem interface. Use this instead of ref for accessing the public methods and properties of the component.
</p>
</li>
<li> <p><b> id </b> <code>string</code> <br> Unique id of the suggested item.
</p>
</li>
<li> <p><b> isSelectedOverride </b> <code>boolean</code> <br> An override for the 'selected' property of the SuggestionModel.
</p>
</li>
<li> <p><b> onClick </b> <code style="white-space: pre;">⁠(ev: React.MouseEvent&lt;HTMLButtonElement&gt;) =&gt; void⁠</code> <br> Callback for when the user clicks on the suggestion.
</p>
</li>
<li> <p><b> onRemoveItem </b> <code style="white-space: pre;">⁠(ev: React.MouseEvent&lt;HTMLButtonElement&gt;) =&gt; void⁠</code> <br> Callback for when the item is removed from the array of suggested items.
</p>
</li>
<li> <p><b> removeButtonAriaLabel </b> <code>string</code> <br> The ARIA label for the button to remove the suggestion from the list.
</p>
</li>
<li> <p><b> RenderSuggestion </b> <code style="white-space: pre;">⁠(item: T, suggestionItemProps: ISuggestionItemProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> Optional renderer to override the default one for each type of picker.
</p>
</li>
<li> <p><b> showRemoveButton </b> <code>boolean</code> <br> Whether the remove button should be rendered or not.
</p>
</li>
<li> <p><b> styles </b> <code style="white-space: pre;">⁠IStyleFunctionOrObject&lt;ISuggestionsItemStyleProps, ISuggestionsItemStyles&gt;⁠</code> <br> Call to provide customized styling that will layer on top of the variant rules.
</p>
</li>
<li> <p><b> suggestionModel </b> <code style="white-space: pre;">⁠ISuggestionModel&lt;T&gt;⁠</code> <br> Individual suggestion object containing its properties.
</p>
</li>
<li> <p><b> theme </b> <code>ITheme</code> <br> Theme provided by High-Order Component.
</p>
</li>
<li> <p><b> className </b> <code>string</code> <br> The CSS className of the suggestions root.
</p>
</li>
<li> <p><b> componentRef </b> <code style="white-space: pre;">⁠IRefObject&lt;ISuggestions&lt;T&gt;&gt;⁠</code> <br> Optional callback to access the ISuggestions interface. Use this instead of ref for accessing the public methods and properties of the component.
</p>
</li>
<li> <p><b> createGenericItem </b> <code style="white-space: pre;">⁠() =&gt; void⁠</code> <br> The callback that should be called when the user attempts to use the input text as as item
</p>
</li>
<li> <p><b> forceResolveText </b> <code>string</code> <br> The text that appears indicating to the use to force resolve the input
</p>
</li>
<li> <p><b> isLoading </b> <code>boolean</code> <br> Used to indicate whether or not the suggestions are loading.
</p>
</li>
<li> <p><b> isMostRecentlyUsedVisible </b> <code>boolean</code> <br> Indicates if a short list of recent suggestions should be shown.
</p>
</li>
<li> <p><b> isResultsFooterVisible </b> <code>boolean</code> <br> Indicates if the text in resultsFooter or resultsFooterFull should be shown at the end of the suggestion list.
</p>
</li>
<li> <p><b> isSearching </b> <code>boolean</code> <br> Used to indicate whether or not the component is searching for more results.
</p>
</li>
<li> <p><b> loadingText </b> <code>string</code> <br> The text to display while the results are loading.
</p>
</li>
<li> <p><b> moreSuggestionsAvailable </b> <code>boolean</code> <br> Used to indicate whether or not the user can request more suggestions. Dictates whether or not the searchForMore button is displayed.
</p>
</li>
<li> <p><b> mostRecentlyUsedHeaderText </b> <code>string</code> <br> The text that should appear at the top of the most recently used box.
</p>
</li>
<li> <p><b> noResultsFoundText </b> <code>string</code> <br> The text that should appear if no results are found when searching.
</p>
</li>
<li> <p><b> onGetMoreResults </b> <code style="white-space: pre;">⁠() =&gt; void⁠</code> <br> The callback that should be called when the user attempts to get more results
</p>
</li>
<li> <p><b> onRenderNoResultFound </b> <code style="white-space: pre;">⁠IRenderFunction&lt;void&gt;⁠</code> <br> How the "no result found" should look in the suggestion list.
</p>
</li>
<li> <p><b> onRenderSuggestion </b> <code style="white-space: pre;">⁠(props: T, suggestionItemProps: ISuggestionItemProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> How the suggestion should look in the suggestion list.
</p>
</li>
<li> <p><b> onSuggestionClick </b> <code style="white-space: pre;">⁠(ev?: React.MouseEvent&lt;HTMLElement&gt;, item?: any, index?: number) =&gt; void⁠</code> <br> What should occur when a suggestion is clicked
</p>
</li>
<li> <p><b> onSuggestionRemove </b> <code style="white-space: pre;">⁠(ev?: React.MouseEvent&lt;HTMLElement&gt;, item?: T | IPersonaProps, index?: number) =&gt; void⁠</code> <br> Function to fire when one of the optional remove buttons on a suggestion is clicked.
</p>
</li>
</ul>
<p>TODO (adjective-object) remove IPersonaprops before the next major version bump
</p>

<ul>
<li> <p><b> refocusSuggestions </b> <code style="white-space: pre;">⁠(keyCode: KeyCodes) =&gt; void⁠</code> <br> A function that resets focus to the expected item in the suggestion list
</p>
</li>
<li> <p><b> removeSuggestionAriaLabel </b> <code>string</code> <br> An ARIA label to use for the buttons to remove individual suggestions.
</p>
</li>
<li> <p><b> resultsFooter </b> <code style="white-space: pre;">⁠(props: ISuggestionsProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> A renderer that adds an element at the end of the suggestions list it has fewer items than resultsMaximumNumber.
</p>
</li>
<li> <p><b> resultsFooterFull </b> <code style="white-space: pre;">⁠(props: ISuggestionsProps&lt;T&gt;) =&gt; JSX.Element⁠</code> <br> A renderer that adds an element at the end of the suggestions list it has more items than resultsMaximumNumber.
</p>
</li>
<li> <p><b> resultsMaximumNumber </b> <code>number</code> <br> Maximum number of suggestions to show in the full suggestion list.
</p>
</li>
<li> <p><b> searchErrorText </b> <code>string</code> <br> The text that should appear if there is a search error.
</p>
</li>
<li> <p><b> searchForMoreText </b> <code>string</code> <br> The text that appears indicating to the user that they can search for more results.
</p>
</li>
<li> <p><b> searchingText </b> <code>string</code> <br> The text to display while searching for more results in a limited suggestions list.
</p>
</li>
<li> <p><b> showForceResolve </b> <code style="white-space: pre;">⁠() =&gt; boolean⁠</code> <br> The callback that should be called to see if the force resolve command should be shown
</p>
</li>
<li> <p><b> showRemoveButtons </b> <code>boolean</code> <br> Indicates whether to show a button with each suggestion to remove that suggestion.
</p>
</li>
<li> <p><b> styles </b> <code style="white-space: pre;">⁠IStyleFunctionOrObject&lt;any, any&gt;⁠</code> <br> Call to provide customized styling that will layer on top of the variant rules.
</p>
</li>
<li> <p><b> suggestions </b> <code style="white-space: pre;">⁠ISuggestionModel&lt;T&gt;[]⁠</code> <br> The list of Suggestions that will be displayed
</p>
</li>
<li> <p><b> suggestionsAvailableAlertText </b> <code>string</code> <br> Screen reader message to read when there are suggestions available.
</p>
</li>
<li> <p><b> suggestionsClassName </b> <code>string</code> <br> The CSS className of the suggestions list
</p>
</li>
<li> <p><b> suggestionsContainerAriaLabel </b> <code>string</code> <br> An ARIA label for the container that is the parent of the suggestions.
</p>
</li>
<li> <p><b> suggestionsHeaderText </b> <code>string</code> <br> The text that appears at the top of the suggestions list.
</p>
</li>
<li> <p><b> suggestionsItemClassName </b> <code>string</code> <br> The className of the suggestion item.
</p>
</li>
<li> <p><b> suggestionsListId </b> <code>string</code> <br> The string that will be used as the suggestionsListId. Will be used by the BasePicker to keep track of the list for aria.
</p>
</li>
<li> <p><b> theme </b> <code>ITheme</code> <br> Theme provided by High-Order Component.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Object with <code>shiny.tag</code> class suitable for use in the UI of a Shiny app.
</p>


<h3>Best practices</h3>



<h4>Layout</h4>


<ul>
<li>
<p> Use a picker to quickly search for a few tags or files.
</p>
</li>
<li>
<p> Use a picker to manage a group of tags or files.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(shiny)
library(shiny.fluent)

makeScript &lt;- function(js) {
  htmltools::htmlDependency(
    name = "TagPickerExample",
    version = "0", # Not used.
    src = c(href = ""), # Not used.
    head = paste0("&lt;script&gt;", js, "&lt;/script&gt;")
  )
}

ui &lt;- function(id) {
  ns &lt;- NS(id)
  tagList(
    makeScript("
      testTags = [
        'black',
        'blue',
        'brown',
        'cyan',
        'green',
        'magenta',
        'mauve',
        'orange',
        'pink',
        'purple',
        'red',
        'rose',
        'violet',
        'white',
        'yellow',
      ].map(item =&gt; ({ key: item, name: item }));

      function listContainsTagList(tag, tagList) {
        if (!tagList || !tagList.length || tagList.length === 0) {
          return false;
        }
        return tagList.some(compareTag =&gt; compareTag.key === tag.key);
      };

      function filterSuggestedTags(filterText, tagList) {
        return filterText
          ? testTags.filter(
              tag =&gt; tag.name.toLowerCase().indexOf(filterText.toLowerCase()) === 0 &amp;&amp;
               !listContainsTagList(tag, tagList),
            )
          : [];
      };
    "),
    textOutput(ns("selectedTags")),
    TagPicker(
      onResolveSuggestions = JS("filterSuggestedTags"),
      onEmptyInputFocus = JS(
        "function(tagList) { return testTags.filter(tag =&gt; !listContainsTagList(tag, tagList)); }"
      ),
      getTextFromItem = JS("function(item) { return item.text }"),
      pickerSuggestionsProps = list(
        suggestionsHeaderText = 'Suggested tags',
        noResultsFoundText = 'No color tags found'
      ),
      itemLimit = 2,
      onChange = JS(paste0(
        "function(selection) {",
        "  Shiny.setInputValue('", ns("selectedTags") ,"', JSON.stringify(selection));",
        "}"
      ))
    )
  )
}

server &lt;- function(id) {
  moduleServer(id, function(input, output, session) {
    output$selectedTags &lt;- renderText({
      if (is.null(input$selectedTags)) {
        "Select up to 2 colors below:"
      } else {
        paste(
          "You have selected:",
          paste(jsonlite::fromJSON(input$selectedTags)$name, collapse = ", ")
        )
      }
    })
  })
}

if (interactive()) {
  shinyApp(ui("app"), function(input, output) server("app"))
}
</code></pre>


</div>