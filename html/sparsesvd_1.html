<div class="container">

<table style="width: 100%;"><tr>
<td>sparsesvd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Singular Value Decomposition of a Sparse Matrix.</h2>

<h3>Description</h3>

<p>Compute the (usually truncated) singular value decomposition (SVD) of a sparse real matrix.
This function is a shallow wrapper around the SVDLIBC implementation of Berry's (1992) single Lanczos algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  sparsesvd(M, rank=0L, tol=1e-15, kappa=1e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a sparse real matrix in <b>Matrix</b> package format.
The preferred format is a <code>dgCMatrix</code> and other storage formats will automatically be converted if possible.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>an integer specifying the desired number of singular components, i.e. the rank of the truncated SVD.
Specify 0 to return all singular values of magnitude larger than <code>tol</code> (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>exclude singular values whose magnitude is smaller than <code>tol</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>accuracy parameter <code class="reqn">\kappa</code> of the SVD algorithm (with SVDLIBC default)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The truncated SVD decomposition
</p>
<p style="text-align: center;"><code class="reqn">
    M_r = U_r D V_r^T
  </code>
</p>

<p>where <code class="reqn">M_r</code> is the optimal rank <code class="reqn">r</code> approximation of <code class="reqn">M</code>.
Note that <code class="reqn">r</code> may be smaller than the requested number <code>rank</code> of singular components.
</p>
<p>The returned value is a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>a vector containing the first <code class="reqn">r</code> singular values of <code>M</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>a column matrix of the first <code class="reqn">r</code> left singular vectors of <code>M</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>a column matrix of the first <code class="reqn">r</code> right singular vectors of <code>M</code>
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>The SVDLIBC homepage <code>http://tedlab.mit.edu/~dr/SVDLIBC/</code> seems to be no longer available.
A copy of the source code can be obtained from <a href="https://github.com/lucasmaystre/svdlibc">https://github.com/lucasmaystre/svdlibc</a>.
</p>
<p>Berry, Michael~W. (1992). Large scale sparse singular value computations.
<em>International Journal of Supercomputer Applications</em>, <b>6</b>, 13â€“49.
</p>


<h3>See Also</h3>

<p><code>svd</code>, <code>sparseMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- rbind(
  c(20, 10, 15,  0,  2),
  c(10,  5,  8,  1,  0),
  c( 0,  1,  2,  6,  3),
  c( 1,  0,  0, 10,  5))
M &lt;- Matrix::Matrix(M, sparse=TRUE)
print(M)

res &lt;- sparsesvd(M, rank=2L) # compute first 2 singular components
print(res, digits=3)

M2 &lt;- res$u %*% diag(res$d) %*% t(res$v) # rank-2 approximation
print(M2, digits=1)

print(as.matrix(M) - M2, digits=2) # approximation error
</code></pre>


</div>