<div class="container">

<table style="width: 100%;"><tr>
<td>CreateMotifMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create motif matrix</h2>

<h3>Description</h3>

<p>Create a motif x feature matrix from a set of genomic ranges,
the genome, and a set of position weight matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CreateMotifMatrix(
  features,
  pwm,
  genome,
  score = FALSE,
  use.counts = FALSE,
  sep = c("-", "-"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A GRanges object containing a set of genomic features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwm</code></td>
<td>
<p>A <code>PFMatrixList</code> or
<code>PWMatrixList</code>
object containing position weight/frequency matrices to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genome</code></td>
<td>
<p>Any object compatible with the <code>genome</code> argument
in <code>matchMotifs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Record the motif match score, rather than presence/absence
(default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.counts</code></td>
<td>
<p>Record motif counts per region. If FALSE (default),
record presence/absence of motif. Only applicable if <code>score=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>A length-2 character vector containing the separators to be used
when constructing matrix rownames from the GRanges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to
<code>matchMotifs</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Requires that motifmatchr is installed
<a href="https://www.bioconductor.org/packages/motifmatchr/">https://www.bioconductor.org/packages/motifmatchr/</a>.
</p>


<h3>Value</h3>

<p>Returns a sparse matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(JASPAR2018)
library(TFBSTools)
library(BSgenome.Hsapiens.UCSC.hg19)

pwm &lt;- getMatrixSet(
  x = JASPAR2018,
  opts = list(species = 9606, all_versions = FALSE)
)
motif.matrix &lt;- CreateMotifMatrix(
  features = granges(atac_small),
  pwm = pwm,
  genome = BSgenome.Hsapiens.UCSC.hg19
)

## End(Not run)
</code></pre>


</div>