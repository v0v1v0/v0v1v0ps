<div class="container">

<table style="width: 100%;"><tr>
<td>evaporative-length</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaporative Characteristic Length</h2>

<h3>Description</h3>

<p>The functions <code>lc</code> and <code>lt</code> compute the <em>characteristic
length</em> <code class="reqn">L_\mathrm{c}</code> of <em>stage-I</em> evaporation from a soil
and its “target” (expected) value <code class="reqn">L_\mathrm{t}</code>, used to
constrain estimates of nonlinear parameters of the Van Genuchten-Mualem
(VGM) model for water retention curves and hydraulic conductivity
functions.</p>


<h3>Usage</h3>

<pre><code class="language-R">lc(alpha, n, tau, k0, e0, c0 = NULL, c3 = NULL, c4 = NULL)

lt(n, tau, e0, c0, c1, c2, c3, c4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>parameter <code class="reqn">\alpha</code> (inverse air entry pressure) of the
VGM model, see <code>wc_model</code> and <code>hc_model</code>.  For
consistency with other quantities, the unit of <code class="reqn">\alpha</code> should be
<b>1/meter</b> [<code class="reqn">\mathrm{m}^{-1}</code>].  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>parameter <code class="reqn">n</code> (shape parameter) of the VGM model, see
<code>wc_model</code> and <code>hc_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>parameter <code class="reqn">\tau</code> (tortuosity parameter) of the VGM model,
see <code>hc_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k0</code></td>
<td>
<p>saturated hydraulic conductivity <code class="reqn">K_0</code>, see
<code>hc_model</code>.  If <code>k0</code> is missing or equal to <code>NA</code>
in calls of <code>lc</code> then <code>k0</code> is approximated by the same relation
as used for <code>lt</code>, see <em>Details</em>.  For consistency with other
quantities, the unit of <code class="reqn">K_0</code> should be <b>meter/day</b>
[<code class="reqn">\mathrm{m}\,\mathrm{d}^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e0</code></td>
<td>
<p>a numeric scalar with the <em>stage-I</em> rate of evaporation
<code class="reqn">E_0</code> from a soil, see <em>Details</em> and
<code>soilhypfitIntro</code>.  For consistency with other quantities,
the unit of <code class="reqn">E_0</code> should be <b>meter/day</b>
[<code class="reqn">\mathrm{m}\,\mathrm{d}^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0, c1, c2, c3, c4</code></td>
<td>
<p>numeric constants to approximate the parameter
<code class="reqn">\alpha</code> and the saturated hydraulic conductivity <code class="reqn">K_0</code> when
computing <code class="reqn">L_\mathrm{t}</code>, see <em>Details</em> and
<code>control_fit_wrc_hcc</code>.  For consistency with other quantities,
the following units should be used for the constants: </p>
 <ul>
<li>
<p><code>c1</code>: <code class="reqn">\mathrm{m}^{-1}</code>, </p>
</li>
<li> <p><code>c3</code>:
<code class="reqn">\mathrm{m}\,\mathrm{d}^{-1}</code>.  </p>
</li>
</ul>
<p> The remaining constants are
dimensionless.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <em>characteristic length</em> of <em>stage-I evaporation</em>
<code class="reqn">L_\mathrm{c}</code> (<cite>Lehmann et al., 2008, 2020</cite>) is defined by

</p>
<p style="text-align: center;"><code class="reqn">
  L_\mathrm{c}(\boldsymbol{\nu}, K_0, E_0) = \frac{
    \frac{1}{\alpha \,§ n} \left(\frac{2n-1}{n-1}\right)^\frac{2n-1}{n}
  }{1 + \frac{E_0}{K_\mathrm{eff}}}
</code>
</p>


<p>where <code class="reqn">\boldsymbol{\nu}^\mathrm{T} = (\alpha, n, \tau)</code> are the nonlinear parameters of
the VGM model, <code class="reqn">K_0</code> is the saturated hydraulic conductivity,
<code class="reqn">E_0</code> the stage-I evaporation rate and
<code class="reqn">K_\mathrm{eff} = 4\, K_\mathrm{VGM}(h_\mathrm{crit}; K_0,
\boldsymbol{\nu})</code> is the
effective hydraulic conductivity at the critical pressure 
</p>
<p style="text-align: center;"><code class="reqn">
  h_\mathrm{crit} = \frac{1}{\alpha} \,
  \left(\frac{n-1}{n}\right)^\frac{1-2n}{n},
  </code>
</p>


<p>see <code>hc_model</code> for the definition of
<code class="reqn">K_\mathrm{VGM}(h; K_0,
\boldsymbol{\nu})</code>.
</p>
<p>The quantity <code class="reqn">L_\mathrm{t}</code> is the expected value (“target”) of
<code class="reqn">L_\mathrm{c}</code> for given shape (<code class="reqn">n</code>) and tortuosity
(<code class="reqn">\tau</code>) parameters.  To evaluate <code class="reqn">L_\mathrm{t}</code>, the
parameters <code class="reqn">\alpha</code> and <code class="reqn">K_0</code> are approximated by the following
relations

</p>
<p style="text-align: center;"><code class="reqn">
 \widehat{\alpha} = g_\alpha(n; c_0, c_1, c_2) =
    c_1 \, \frac{n - c_0}{1 + c_2 \, (n - c_0)},
</code>
</p>


<p style="text-align: center;"><code class="reqn">
 \widehat{K}_0 = g_{K_0}(n; c_0, c_3, c_4) =
    c_3 \, (n - c_0)^{c_4}.
</code>
</p>


<p>The default values for <code class="reqn">c_0</code> to <code class="reqn">c_4</code> (see argument
<code>approximation_alpha_k0</code> of
<code>control_fit_wrc_hcc</code>) were estimated with data on African
desert regions of the database <em>ROSETTA3</em> (<cite>Zhang and Schaap,
2017</cite>), see <cite>Lehmann et al. (2020)</cite> for details.
</p>


<h3>Value</h3>

<p>A numeric scalar with the characteristic evaporative length (<code>lc</code>) or
its expected value (<code>lt</code>).</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Lehmann, P., Assouline, S., Or, D. (2008) Characteristic lengths
affecting evaporative drying of porous media.  <em>Physical Review E</em>,
<b>77</b>, 056309, <a href="https://doi.org/10.1103/PhysRevE.77.056309">doi:10.1103/PhysRevE.77.056309</a>.
</p>
<p>Lehmann, P., Bickel, S., Wei, Z., Or, D. (2020) Physical Constraints for
Improved Soil Hydraulic Parameter Estimation by Pedotransfer Functions.
<em>Water Resources Research</em> <b>56</b>, e2019WR025963,
<a href="https://doi.org/10.1029/2019WR025963">doi:10.1029/2019WR025963</a>.
</p>
<p>Zhang, Y. , Schaap, M. G. 2017. Weighted recalibration of the Rosetta
pedotransfer model with improved estimates of hydraulic parameter
distributions and summary statistics (Rosetta3). <em>Journal of Hydrology</em>,
<b>547</b>, 39-53, <a href="https://doi.org/10.1016/j.jhydrol.2017.01.004">doi:10.1016/j.jhydrol.2017.01.004</a>.
</p>


<h3>See Also</h3>

<p><code>soilhypfitIntro</code> for a description of the models and a brief
summary of the parameter estimation approach;
</p>
<p><code>fit_wrc_hcc</code> for (constrained) estimation of parameters of
models for soil water retention and hydraulic conductivity data;
</p>
<p><code>control_fit_wrc_hcc</code> for options to control
<code>fit_wrc_hcc</code>;
</p>
<p><code>soilhypfitmethods</code> for common S3 methods for class
<code>fit_wrc_hcc</code>;
</p>
<p><code>vcov</code> for computing (co-)variances of the estimated
nonlinear parameters;
</p>
<p><code>prfloglik_sample</code> for profile loglikelihood
computations;
</p>
<p><code>wc_model</code> and <code>hc_model</code> for currently
implemented models for soil water retention curves and hydraulic
conductivity functions;



</p>


<h3>Examples</h3>

<pre><code class="language-R">
# use of \donttest{} because execution time exceeds 5 seconds

# estimate parameters of 4 samples of the Swiss forest soil dataset
# that have water retention (theta, all samples), saturated hydraulic conductivity
# (ksat) and optionally unsaturated hydraulic conductivity data
# (ku, samples "CH2_4" and "CH3_1")

data(swissforestsoils)

# select subset of data
sfs_subset &lt;- droplevels(
  subset(
    swissforestsoils,
    layer_id %in% c("CH2_3", "CH2_4", "CH2_6", "CH3_1")
  ))

# extract ksat measurements
ksat &lt;- sfs_subset[!duplicated(sfs_subset$layer_id), "ksat", drop = FALSE]
rownames(ksat) &lt;- levels(sfs_subset$layer_id)
colnames(ksat) &lt;- "k0"

# define number of cores for parallel computations
if(interactive()) ncpu &lt;- parallel::detectCores() - 1L else ncpu &lt;- 1L


# unconstrained estimation (global optimisation algorithm NLOPT_GN_MLSL)
# k0 fixed at measured ksat values
rsfs_uglob &lt;- fit_wrc_hcc(
  wrc_formula = theta ~ head | layer_id,
  hcc_formula = ku ~ head | layer_id,
  data = sfs_subset,
  param = ksat,
  fit_param = default_fit_param(k0 = FALSE),
  control = control_fit_wrc_hcc(
    settings = "uglobal", pcmp = control_pcmp(ncores = ncpu)))
summary(rsfs_uglob)
coef(rsfs_uglob, lc = TRUE, gof = TRUE)


# constrained estimation by restricting ratio Lc/Lt to [0.5, 2]
# (global constrained optimisation algorithm NLOPT_GN_MLSL)
# k0 fixed at measured ksat values
rsfs_cglob &lt;- update(
  rsfs_uglob,
  control = control_fit_wrc_hcc(
    settings = "cglobal", nloptr = control_nloptr(ranseed = 1),
    pcmp = control_pcmp(ncores = ncpu)))
summary(rsfs_cglob)
coef(rsfs_cglob, lc = TRUE, gof = TRUE)

# get initial parameter values from rsfs_cglob
ini_param &lt;- cbind(
  coef(rsfs_cglob)[, c("alpha", "n")],
  ksat
)
# constrained estimation by restricting ratio Lc/Lt to [0.5, 2]
# (local constrained optimisation algorithm NLOPT_LD_CCSAQ)
# k0 fixed at measured ksat values
rsfs_cloc &lt;- update(
  rsfs_uglob,
  param = ini_param,
  control = control_fit_wrc_hcc(
    settings = "clocal", nloptr = control_nloptr(ranseed = 1),
    pcmp = control_pcmp(ncores = ncpu)))
summary(rsfs_cloc)
coef(rsfs_cloc, lc = TRUE, gof = TRUE)

op &lt;- par(mfrow = c(4, 2))
plot(rsfs_uglob, y = rsfs_cglob)
on.exit(par(op))

op &lt;- par(mfrow = c(4, 2))
plot(rsfs_uglob, y = rsfs_cloc)
on.exit(par(op))

</code></pre>


</div>