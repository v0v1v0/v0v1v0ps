<div class="container">

<table style="width: 100%;"><tr>
<td>choisir.seuil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cut-off selection by simulations
</h2>

<h3>Description</h3>

<p>Obtaining the optimal p-value cut-off for individual tests to achieve a
given Type I error level of obtaining disjoint components of the graph
</p>


<h3>Usage</h3>

<pre><code class="language-R">choisir.seuil( n.genes,
               taille.groupes = c( 10, 10 ),
               alpha.cible = 0.05,
               seuil.p = (5:30)/100,
               B = 3000, conf.level = 0.95,
               f.p = student.fpc, frm = R ~ Groupe, v.X = 'Groupe',
               normaliser = FALSE, en.log = TRUE,
               n.quantifies = n.genes, masque,
               n.coeurs = 1,
               sigma = rep( 1, n.genes ),
               ... ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.genes</code></td>
<td>

<p>Number of genes to be quantified simultaneously
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taille.groupes</code></td>
<td>
<p> An integer vector containing the sample size
for each group. The number of groups is determined by the length of
this vector. Unused if <code>masque</code> is provided.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.cible</code></td>
<td>
<p> The target type I error level of obtaining
disjoint subnetworks under the null hypothesis that gene expressions
are the same in all groups.  Should be between 0 and 1.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seuil.p</code></td>
<td>
<p> A numeric vector of candidate cutoffs. Values outside
the [0,1] interval are automatically removed.  The default (from
0.05 to 0.30) is suited for a target type I error of 0.05 and less
than 30 genes, roughly.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>How many simulations to do.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>The confidence level of the interval given as a result (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.p</code></td>
<td>

<p>The function to use for individual tests of each ratio. See
<code>creer.Mp</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frm</code></td>
<td>
<p> The formula to use.  The default is suited for the 
structure of the simulated data, with R the ratio and Groupe the
variable with group membership.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.X</code></td>
<td>
<p> The name of the grouping variable.  The default is suited
for the structure of the simulated data, with R the ratio and Groupe
the variable with group membership.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normaliser</code></td>
<td>

<p>Should the simulated data by normalised, that is should their sum be
equal to 1? Since ratio are insensitive to the normalisation (by
contrast with individual quantities), it is a useless step for usual
designs, hence the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en.log</code></td>
<td>

<p>If <code>TRUE</code>, generated data are seen as log of quantities, hence the
normalisation step is performed after exponentiation of the data and
data are converted back in log.
</p>
<p>The option is also used in the call of <code>creer.Mp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.quantifies</code></td>
<td>
<p> The number of quantified genes amongst the
<code>n.genes</code> simulated. Must be at most equal to <code>n.genes</code>,
which is the default.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>masque</code></td>
<td>
<p>A data.frame containing the values of needed covariates
for all replicates. If missing, a one-column data.frame generated
using <code>taille.groupes</code>, the column (named ‘Groupe’)
containing values ‘G1’ repeated <code>taille.groupes[ 1 ]</code>
times, ‘G2’ repeated <code>taille.groupes[ 2 ]</code> times and so
on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.coeurs</code></td>
<td>
<p>The number of CPU cores to use in computation, with
parallelization using forks (does not work on Windows) with the help
of the parallel package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A vector of length <code>n.genes</code> giving the standard
deviation (in the log scale) to use for each gene. By default, all
genes have the same standard deviation. Note that only the ratio
between standard deviations brings information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, to be used by the analysis function
f.p</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The <code>choisir.seuil</code> function simulates <code>B</code> datasets
of <code>n.genes</code> “quantities” measured several times, under
the null hypothesis that there is only random variations between
samples. For each of these <code>B</code> datasets, <code>creer.Mp</code>
is called with the provided test function, then converted to a graph
using in turn all cut-offs given in  <code>seuil.p</code> and the number of
components of the graph is determined. Having more than one is a type
I error.
</p>
<p>For each cut-off in <code>seuil.p</code>, the proportion of false-positive
is then determined, along with its confidence interval (using the
exact, binomial formula). The optimal cut-off to achieve the target
type I error is then found by linear interpolation.
</p>
<p>Simulation is done assuming a log-normal distribution, with a
reduced, centered Gaussian on the log scale. Since under the null
hypothesis nothing changes between the groups, the only needed
informations is the total number of values for a given gene, which is
determined from the number of rows of <code>masque</code>.
All columns of <code>masque</code> are transfered to the analysis function,
so simulation under virtually any experimental design should be
possible, as far as a complete null hypothesis is wanted (not any
effect of any covariate).
</p>


<h3>Value</h3>

 <p><code>choisir.seuil</code> returns a data.frame with four columns,
corresponding to the candidate cut-offs, the corresponding estimated
type-I error and its lower and upper confidence bounds, and attributes
giving the estimated optimal cut-off, its confidence interval and
details on simulation condition. This data.frame has the additional
class <code>SARPcompo.H0</code>, allowing specific <code>print</code> and
<code>plot</code> methods to be used.
</p>


<h3>Warning</h3>

<p> The simulated ratios are stored in a column called R,
appended to the simulated data.frame. For this reason, do not use any
column of this name in the provided masque: it would be overwritten
during the simulation process.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>creer.Mp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # What would be the optimal cut-off for 10 genes quantified in two
   #  groups of 5 replicates?
   # For speed reason, only 50 simulations are done here,
   #  but obviously much more are needed to have a good estimate f the cut-off.

   seuil &lt;- choisir.seuil( 10, c( 5, 5 ), B = 50 )
   seuil

   # Get the cut-off and its confidence interval
   attr( seuil, "seuil" )

   # Plot the results
   plot( seuil )
</code></pre>


</div>