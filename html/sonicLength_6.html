<div class="container">

<table style="width: 100%;"><tr>
<td>maxEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> maximum likelihood estimates relative abundances</h2>

<h3>Description</h3>

<p>From information about the lengths of sonicants of integration sites,
infer the relative abundances of different clones and the distributon
of sonicant lengths
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxEM(slmat, theta.var=FALSE, phi.update=NULL,
                  phi.deriv=NULL, lframe = NULL, glm.frm = NULL, iter.control=NULL, ... ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>slmat</code></td>
<td>
    
<p>a matrix whose rows correspond to unique lengths with rownames
indicating those lengths
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.var</code></td>
<td>
<p>logical, return variance of theta estimates?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.update</code></td>
<td>

<p>a function of an object like <code>slmat</code> that returns estimtes of
phi - a default vesrion is invoked if none is provided
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> phi.deriv </code></td>
<td>
<p> function of theta and phi that returns derivatives
of phi wrt beta (its parameters) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> lframe </code></td>
<td>
<p> a <code>data.frame</code> which will be used to estimate
<code>phi</code>, the supplied function <code>phi.update</code> must know what to do with this
arg or it will be ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> glm.frm </code></td>
<td>
<p> a formula like <code>y ~ bs(x,knots=c(50,100))</code> to
fit <code>phi</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.control</code></td>
<td>

<p>a list of default values for iteration control - see <code>maxEM.iter.control</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> ... </code></td>
<td>
<p> possibly other args to pass to <code>phi.update</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The EM method is used to infer the relative abundances of different sites.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p> a vector of the abundance estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi </code></td>
<td>
<p> a vector of the probabilities of sonicant lengths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> the call used </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Charles C. Berry <a href="mailto:ccberry@users.r-forge.r-project.org">ccberry@users.r-forge.r-project.org</a>
</p>


<h3>See Also</h3>

<p><code>Ey.given.x</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mat0 &lt;- matrix(0,nr=48,nc=140)
vals &lt;- c(rep(1,100),2:40,100)
mat1 &lt;- sapply( vals, function(x) as.numeric(is.element(1:200 ,rgeom(x,.02))))
mat &lt;- rbind(mat0,mat1)
posVals &lt;- colSums(mat) &gt; 0
vals &lt;- vals[ posVals ]
mat &lt;- mat[, posVals ]
rownames(mat) &lt;- 1:nrow(mat)
res &lt;- maxEM(mat)
matplot( vals, cbind(res$theta, colSums(mat)), pch=1:2,
        xlab='original values', ylab='estimated values',
        main='Simulated Sonicants and Estimates')
legend( "bottomright", pch=1:2, col=1:2,
        legend=c(expression(hat(theta)[j]),expression(sum(y[ij],i))))
abline(a=0,b=1,col='gray')
</code></pre>


</div>