<div class="container">

<table style="width: 100%;"><tr>
<td>ictest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs Tests for Interval Censored Data</h2>

<h3>Description</h3>

<p>This function performs several different tests for
interval censored data. It has 3 different models
that generalize either the Wilcoxon rank sum test
(model = "PO") or the logrank test (model = "GPH" or
model = "Sun"). Each model may be one of 2 types,
either an asymptotic permutation test or a
score test.
</p>
<p>The censoring is such that if the i<em>th</em> observation fails at <code class="reqn">x</code>,
we only observe that <code class="reqn">L[i] &lt; x \le R[i]</code>. Data may be entered with
"exact" values, i.e., <code class="reqn">L[i] = x = R[i]</code>. In that case the <code class="reqn">L[i]</code> is
changed internally to <code class="reqn">L*[i]</code> which is the next lower of any of the
observed endpoints (unless <code class="reqn">R[i] = 0</code> then an error results).
</p>
<p>The function requires a previously calculated survival
curve (see <code>icfit</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ictest(L, R, S, group, model, type = "permutation", fuzz , output.scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p> a vector of left endpoints of the interval.
We assume each <code class="reqn">L[i] \ge 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> a vector of right endpoints of the interval. Exact
values may be entered as L[i] == R[i] they are changed
internally.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p> a vector of survival values calculated from
all the data (i.e., ignoring group membership)
(see time below), typically output from icfit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p> a vector denoting the group for which the test
is desired. If group is a factor or character
then a k-sample test is performed, where k is
the number of unique values of group. If group
is numeric then a "correlation" type test is
performed. If there are only two groups, both
methods give the same results. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> a character vector with three possible values
describing the model:
model = "GPH"  (default) gives the grouped proportional
hazards model. This generalizes a logrank test.
model = "Sun"  gives a Logistic model. This
generalizes another form of the logrank test.
model = "PO" gives a proportional odds model.
This generalizes the Wilcoxon rank sum test.
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character vector with two possible values,
"permutation" or "score" (see details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzz</code></td>
<td>
<p> a small numeric value. Because
we need to determine places in the survival
curve where there are no changes, and the machine
may have rounding error, we use this. (Default = 1e-12)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.scores</code></td>
<td>
<p> a logical value. <code>output.scores</code> = <code>TRUE</code>
outputs the scores in the output list. Default is <code>output.scores</code> = <code>FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 3 models are compared in depth in Fay (1999).
For censored data two common likelihoods are the
marginal likelihood or the ranks and the
likelihood with nuisance parameters for the
baseline survival. Here we use the latter
likelihood (as in Finkelstein, 1986, Fay, 1996,
and Sun, 1996).  It is difficult to create proper
score tests for this likelihood because the
number of nuisance parameters typically grows with
the sample size and often many of
the parameters are equal at the nonparametric
MLE, i.e., they are on the boundary of the
parameter space. One way around this is to
perform a permutation test on the scores
(Fay, 1996). A second way around (the boundary
problem at least) it is to redefine
the interval points so that  no boundary
problems exist (see Fay, 1996). These are the
two methods used here.
</p>
<p>We present two generalizations of the logrank
test. The method of Sun (1996) is more difficult to
calculate and has no theoretical advantages
of which I am aware. The grouped proportional
hazards model of Finkelstein (1996) is recommended.
Note that when <code>icfit</code> and <code>ictest</code> are used on right-censored
data, because the method of estimating
variance is different, even Sun's method does not
produce exactly the standard logrank test results.
</p>
<p>There are some typos in Appendix II of Fay (1999).
See the S code for the corrections.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>only returned if output.scores = T. This is a vector
the same length as L and R, containing the scores
used in the permutation test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The efficient score vector. When group is a factor
or character vector then each element of U has the
interpretation as the weighted sum of "observed" minus
"expected" deaths for the group element defined by the
label of U. Thus negative values indicate better than average
survival (see Fay, 1999).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.value</code></td>
<td>
<p>Chi-square value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom for the chi-square test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>p-value from the chi-square value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a character vector of length one, either
"2-sample","correlation" or "k-sample"
where k in the number of unique group values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>same as model input, either "GPH","Sun" or "PO"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>same as type input, either "permutation" or
"score"</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> The functions <code>icfit</code>, <code>icplot</code>,
and  <code>ictest</code> and documentation for these functions are from  Michael P. Fay.
You are free to distribute these functions to whomever is
interested. They come with no warranty however.</p>


<h3>Author(s)</h3>

<p>Michael P. Fay</p>


<h3>References</h3>

<p>Fay, M. P. (1996), "Rank Invariant Tests for Interval
Censored Data Under the Grouped Continuous Model,"
<em>Biometrics</em>, 52: 811-822.
</p>
<p>Fay, M. P. (1999), "Comparing Several Score Tests for
Interval Censored Data," <em>Statistics in Medicine</em>,
18: 273-285.
</p>
<p>Finkelstein, D. M. (1986), "A Proportional Hazards
Model for Interval Censored Failure Time Data,"
<em>Biometrics</em>, 42: 845-854.
</p>
<p>Sun, J. (1996), "A Non-parametric Test for Interval
Censored Failure Time Data With Applications to
AIDS Studies," <em>Statistics in Medicine</em>, 15: 1387-1395.
</p>


<h3>See Also</h3>

<p><code>icfit</code>,<code>icplot</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Perform a logrank-type test using the observed information variance.
## need data set for this example
#   out&lt;-icfit(left,right)
#  ictest(left,right,out$surv,group,out$time,model = "GPH",type = "score")
#
## Perform a Wilcoxon rank sum-type test using asymptotic permutation variance.
#
# ictest(left,right,out$surv,group,out$time, model = "PO",type = "permutation")
</code></pre>


</div>