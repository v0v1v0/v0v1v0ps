<div class="container">

<table style="width: 100%;"><tr>
<td>spm_time_dep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function for the model with time-dependent model parameters.</h2>

<h3>Description</h3>

<p>A function for the model with time-dependent model parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spm_time_dep(
  x,
  start = list(a = -0.05, f1 = 80, Q = 2e-08, f = 80, b = 5, mu0 = 0.001),
  frm = list(at = "a", f1t = "f1", Qt = "Q", ft = "f", bt = "b", mu0t = "mu0"),
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  opts = NULL,
  lrtest = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input data table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A list of starting parameters, default: 
<code>start=list(a=-0.5, f1=80, Q=2e-8, f=80, b=5, mu0=1e-5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frm</code></td>
<td>
<p>A list of formulas that define age (time) - dependency. 
Default: <code>frm=list(at="a", f1t="f1", Qt="Q", ft="f", bt="b", 
mu0t="mu0")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter 
achieves lower or upper boundaries. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>Upper bound of parameters under estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Turns on verbosing output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrtest</code></td>
<td>
<p>Indicates should Likelihood-Ratio test be performed.
Possible values: <code>TRUE</code>, <code>H01</code>, <code>H02</code>, <code>H03</code>,
<code>H04</code>, <code>H05</code> (see package Vignette for details)
Default value: <code>FALSE</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A set of estimates of <code>a</code>, <code>f1</code>, <code>Q</code>, 
<code>f</code>, <code>b</code>, <code>mu0</code>.
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by <code>nloptr</code> optimization function 
(see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Health decline, 
aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(stpm)
set.seed(123)
#Data preparation:
n &lt;- 5
data &lt;- simdata_time_dep(N=n)
# Estimation:
opt.par &lt;- spm_time_dep(data)
opt.par
</code></pre>


</div>