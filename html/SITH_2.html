<div class="container">

<table style="width: 100%;"><tr>
<td>bulkSample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate bulk sampling</h2>

<h3>Description</h3>

<p>Simulate bulk sequencing data by taking a local sample from the tumor
and computing the variant allele frequencies of the various mutations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bulkSample(tumor, pos, cube.length = 5, threshold = 0.05, coverage = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tumor</code></td>
<td>
<p>A list which is the output of <code>simulateTumor()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>The center point of the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cube.length</code></td>
<td>
<p>The side length of the cube of cells to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Only mutations with an allele frequency greater than the threshold will be included in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>If nonzero then deep sequencing with specified coverage is performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A local region of the tumor is sampled by constructing a cube with side length <code>cube.length</code> around
the center point <code>pos</code>. Each cell within the cube is sampled, and the reported quantity is variant (or mutation) 
allele frequency. Lattice sites without cells are assumed to be normal tissue, and thus the reported MAF may be less than
1.0 even if the mutation is present in all cancerous cells. 
</p>
<p>If <code>coverage</code> is non-zero then deep sequencing can be simulated. For a chosen coverage <code class="reqn">C</code>, it is known
that the number of times the base is read follows a <code class="reqn">Pois(C)</code> distribution (see Illumina's website). 
Let <code class="reqn">d</code> be the true coverage
sampled from this distribution. Then the estimated VAF is drawn from a <code class="reqn">Bin(d,p)/d</code> distribution. 
</p>
<p>Note that <code>cube.length</code> is required to be an odd integer (in order to have a well-defined center point).
</p>


<h3>Value</h3>

<p>A data frame with 1 row and columns corresponding to the mutations. The entries are the mutation allele frequency.
</p>


<h3>Author(s)</h3>

<p>Phillip B. Nicol
</p>


<h3>References</h3>

<p>K. Chkhaidze, T. Heide, B. Werner, M. Williams, W. Huang, G. Caravagna, T. Graham, and 
A. Sottoriva. Spatially con- strained tumour growth affects the 
patterns of clonal selection and neutral drift in cancer genomic data. PLOS Computational Biology, 2019.
https://doi.org/10.1371/journal.pcbi.1007243.
Lander ES, Waterman MS.(1988) Genomic mapping by fingerprinting random clones: 
a mathematical analysis, Genomics 2(3): 231-239.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(116776544, kind = "Mersenne-Twister", normal.kind = "Inversion")
out &lt;- simulateTumor(max_pop = 1000)
df &lt;- bulkSample(tumor = out, pos = c(0,0,0))

</code></pre>


</div>