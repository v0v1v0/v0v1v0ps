<div class="container">

<table style="width: 100%;"><tr>
<td>fdrOrd/kfweOrd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Controlling the False Discovery Rate and and the Generalized FWER in ordered Test</h2>

<h3>Description</h3>

<p>Ordinal procedure controlling the FDR and the Generalized FWER
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdrOrd(p, q = .01, ord = NULL, GD=FALSE)
kfweOrd(p, k = 1, alpha = 0.01, ord = NULL, alpha.prime = alpha,
        J = qnbinom(alpha, k, alpha.prime), GD = FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> vector of p-values

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p> Values on the basis of which the procedure select the hypotheses (following decreasing order). The vector have the same length of <code>p</code>. If <code>NULL</code> the natural ordering is considered.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p> average FDR level

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> global significance level

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> number of allowed errors in kFWE controls

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p> number of allowed jumps befor stopping

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.prime</code></td>
<td>
<p> univariate alpha for single step Guo and Romano procedure

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GD</code></td>
<td>
<p> Logic value. Should the correction for general dependence be applied?
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an object of class <code>someMTP.object</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>rej</code>:</td>
<td>
<p>a logical vector indicating whenever the related hypotesis have been rejected. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>p</code>:</td>
<td>
<p>the vector of p-values used in the call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>ord</code>:</td>
<td>
<p>The vector used to sort the p-values (decrasing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>MTP</code>:</td>
<td>
<p>"fdrOrd" or "kfweOrd"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>GD</code>:</td>
<td>
<p>A logical value incating if the correction for General Dependence have been used or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>q</code>:</td>
<td>
<p>The level of controlled FDR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>alpha</code>:</td>
<td>
<p>The level of controlled k-FWER</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>alphaprime</code>:</td>
<td>
<p>The significance level of individual tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>k</code>:</td>
<td>
<p>Number of allowed Errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>J</code>:</td>
<td>
<p>Number of allowed Jumps</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> L. Finos and A. Farcomeni

</p>


<h3>References</h3>

<p>L. Finos, A. Farcomeni (2011). k-FWER Control without p-value Adjustment, with Application to Detection of Genetic Determinants of Multiple Sclerosis in Italian Twins. Biometrics.
</p>
<p>A. Farcomeni, L. Finos (2013). FDR Control with Pseudo-Gatekeeping Based on a Possibly Data Driven Order of the Hypotheses. Biometrics.
</p>


<h3>See Also</h3>

<p>See also <code>draw</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

	set.seed(17)
	x=matrix(rnorm(60),3,20)
	x[,1:10]=x[,1:10]+2 ##variables 1:10 have tests under H1
	ts=apply(x,2,function(x) t.test(x)$statistic)
	ps=apply(x,2,function(x) t.test(x)$p.value) #compute p-values
	m2=apply(x^2,2,mean)           #compute ordering criterion

	pOrd &lt;- fdrOrd(ps,q=.05,ord=m2)   #ordinal Procedure
	pOrd
	draw(pOrd)	
	sum(p.adjust(ps,method="BH")&lt;=.05)  #rejections with BH
	
	kOrd &lt;- kfweOrd(ps,k=5,ord=m2)#ordinal procedure
	kOrd
	kOrdGD &lt;- kfweOrd(ps,k=5,ord=m2,GD=TRUE)#ord. proc. (any dependence)
	kOrdGD
</code></pre>


</div>