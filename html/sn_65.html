<div class="container">

<table style="width: 100%;"><tr>
<td>overview-sn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Package <span class="pkg">sn</span>: overview of the structure and main commands</h2>

<h3>Description</h3>

 
<p>The package provides facilities to build and manipulate probability 
distributions of the skew-normal (<abbr><span class="acronym">SN</span></abbr>)  and some related families, 
notably the skew-<code class="reqn">t</code> (<abbr><span class="acronym">ST</span></abbr>) and the ‘unified skew-normal’ 
(<abbr><span class="acronym">SUN</span></abbr>) families. 
For the <abbr><span class="acronym">SN</span></abbr>, <abbr><span class="acronym">ST</span></abbr> and skew-Cauchy (<abbr><span class="acronym">SC</span></abbr>) families,
statistical methods are made available for data fitting and model diagnostics,  
in the univariate and  the multivariate case.
</p>


<h3>Two main sides</h3>

 
<p>The package comprises two main sides: one side provides  facilities for the 
pertaining probability distributions; the other one deals with related
statistical methods.
Underlying formulation, parameterizations of distributions and terminology 
are in agreement with the monograph of Azzalini and Capitanio (2014).


</p>


<h3>Probability side</h3>


<p>There are two layers of support for the probability distributions of interest.
At the basic level, there exist functions which follow the classical <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>  
scheme for distributions.
In addition, there exists facilities to build an object which incapsulates 
a probability distribution and then certain operations can be be performed 
on such an object;
these probability objects operate according to the S4 protocol. 
The two schemes are described next.
</p>

<dl>
<dt>Classical <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> scheme</dt>
<dd>
<p>The following functions work similary to <code>{d,p,q,r}norm</code> and other <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
functions for probability distributions:
</p>

<ul>
<li>
<p> skew-normal (<abbr><span class="acronym">SN</span></abbr>): functions <code>{d,p,q,r}sn</code> for the 
univariate case, functions  <code>{d,p,r}msn</code> for the multivariate case, 
where in both cases the ‘Extended skew-normal’ (<abbr><span class="acronym">ESN</span></abbr>) 
variant form is included;
</p>
</li>
<li>
<p> skew-<code class="reqn">t</code> (<abbr><span class="acronym">ST</span></abbr>): functions <code>{d,p,q,r}st</code> for the
univariate case,  functions  <code>{d,p,r}mst</code> for the multivariate case;
</p>
</li>
<li>
<p> skew-Cauchy (<abbr><span class="acronym">SC</span></abbr>): functions <code>{d,p,q,r}sc</code> for the 
univariate case, functions <code>{d,p,r}msc</code> for the multivariate case.
</p>
</li>
</ul>
<p>In addition to the usual specification of their parameters as a sequence of
individual components, a parameter set can be specified as a single <code>dp</code>
entity, namely a vector in the univariate case, a list in the multivariate
case; <code>dp</code> stands for ‘Direct Parameters’ (<abbr><span class="acronym">DP</span></abbr>).
</p>
<p>Another set of parameters is in use, denoted Centred Parameters (<abbr><span class="acronym">CP</span></abbr>),
which are more convenient for interpretability, since they correspond to
familiar quantifies, such as the mean and the standard deviation. 
Conversion from the <code>dp</code> parameter set to the corresponding <abbr><span class="acronym">CP</span></abbr>
parameters can be accomplished using the function <code>dp2cp</code>,
while function <code>cp2dp</code> performs the inverse transformation.
</p>
<p>The <abbr><span class="acronym">SUN</span></abbr> family is mainly targeted to the multivariate context, 
and this is reflected in the organization of the pertaining functions, 
although univariate <abbr><span class="acronym">SUN</span></abbr> distributions are supported.
Density, distribution function and random numbers are handled by
<code>{d,p,r}sun</code>. Mean value, variance matrix and Mardia's measures
of multivariate skewness and kurtosis are computed by
<code>sun{Mean,Vcov,Mardia}</code>.
</p>
<p>In addition, one can introduce a user-specified density function using
<code>dSymmModulated</code> and <code>dmSymmModulated</code>, in the univariate and the
multivariate case, respectively. These densities are of the
‘symmetry-modulated’ type, also called ‘skew-symmetric’, where
one can specify the base density and the modulation factor with high degree of
flexibility.  Random numbers can be sampled using the corresponding functions
<code>rSymmModulated</code> and <code>rmSymmModulated</code>. In the bivariate case,
a dedicated plotting function exists.
</p>
</dd>
<dt>Probability distribution objects: <abbr><span class="acronym">SEC</span></abbr> families</dt>
<dd>
<p>Function <code>makeSECdistr</code> can be used to build a ‘<abbr><span class="acronym">SEC</span></abbr>
distribution’ object representing a member of a specified parametric family
(among the types <abbr><span class="acronym">SN, ESN, ST, SC</span></abbr>) with a given <code>dp</code> parameter
set. This object can be used for various operations such as plotting  or
extraction of moments and other summary quantities.  
Another way of constructing a <abbr><span class="acronym">SEC</span></abbr> distribution object is via
<code>extractSECdistr</code> which extracts suitable components of an object 
produced by function <code>selm</code> to be described below.
</p>
<p>Additional operations on these objects are possible in the multivariate case,
namely <code>marginalSECdistr</code> and <code>affineTransSECdistr</code>
for marginalization and affine trasformations. 
For the multivariate <abbr><span class="acronym">SN</span></abbr> family only (but including <abbr><span class="acronym">ESN</span></abbr>), 
<code>conditionalSECdistr</code> performs a conditioning on the values taken 
on by some components of the multivariate variable.</p>
</dd>
<dt>Probability distribution objects: the <abbr><span class="acronym">SUN</span></abbr> family</dt>
<dd>
<p>Function <code>makeSUNdistr</code> can be used to build a <abbr><span class="acronym">SUN</span></abbr>
distribution object representing a member of the <abbr><span class="acronym">SUN</span></abbr> 
parametric family.
This object can be used for various operations such as plotting  or
extraction of moments and other summary quantities.
</p>
<p>Moreover there are several trasformation operations which can be performed
on a <abbr><span class="acronym">SUN</span></abbr> distribution object, or two such objects in some cases:
computing a (multivariate) marginal distribution,  a conditional distribution
(on given values of some components or on one-sided intervals), an affine
trasformation, a convolution (that is, the distribution of the sum of two
independent variables), and joining two distributions under assumption of
independence.
</p>
</dd>
</dl>
<h3>Statistics side</h3>


<p>The main function for data fitting is represented by <code>selm</code>, which allows
to specify a linear regression model for the location parameter, similarly 
to function <code>lm</code>, but assuming a <dfn>skew-elliptical</dfn> distribution
of the random component;
this explains the name <dfn>selm=(se+lm)</dfn>. Allowed types of distributions
are  <abbr><span class="acronym">SN</span></abbr> (but not <abbr><span class="acronym">ESN</span></abbr>), <abbr><span class="acronym">ST</span></abbr> and <abbr><span class="acronym">SC</span></abbr>.
The fitted distribution is univariate or multivariate, depending on the nature
of the response variable of the posited regression model. The model fitting
method is either maximum likelihood or maximum penalized likelihood; 
the latter option effectively allows the introduction of a prior distribution 
on the slant parameter of the error distribution, hence leading to a 
‘maximum a posteriori’ estimate.
</p>
<p>Once the fitting process has been accomplished, an object of class either
<dfn>selm</dfn> (for univariate response) or <dfn>mselm</dfn> (for multivariate 
response) is produced.
A number of ‘methods’ are available for these objects: <code>show</code>, 
<code>plot</code>, <code>summary</code>, <code>coef</code>, <code>residuals</code>, <code>logLik</code> 
and others.
For univariate <dfn>selm</dfn>-class objects, univariate and bivariate profile
log-likelihood functions can be obtained; a <code>predict</code> method also exists.
These methods are built following the S4 protocol; however, the user must not
be concerned with the choice of the adopted protocol (unless this is wished).
</p>
<p>The actual fitting process invoked via <code>selm</code> is actually performed by a
set of lower-level procedures. These are accessible for direct call, 
if so wished, typically for improved efficiency, at the expense of a little 
additional programming effort. Similarly, functions to compute the Fisher 
information matrix are available, in the expected and the observed form 
(with some restrictions depending on the selected distribution).
</p>
<p>The <code>extractSECdistr</code> function extracts the fitted <abbr><span class="acronym">SEC</span></abbr> 
distribution from  <dfn>selm</dfn>-class and <dfn>mselm</dfn>-class objects, hence
providing a bridge with the probability side of the package.
</p>
<p>The facilities for statistical work do not support the <abbr><span class="acronym">SUN</span></abbr> family.
</p>


<h3>Additional material</h3>

<p>Additional material is available in the section 
‘User guides, package vignettes and other documentation’
accessible from the front page of the documentation. 
See especially the document <code>pkg_sn-intro.pdf</code>
</p>


<h3>Author</h3>

<p>Adelchi Azzalini.

Please send comments, error reports <em>et cetera</em> to the author, 
whose web page is <a href="http://azzalini.stat.unipd.it/">http://azzalini.stat.unipd.it/</a>.
</p>


<h3>References</h3>

<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>


</div>