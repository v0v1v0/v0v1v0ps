<div class="container">

<table style="width: 100%;"><tr>
<td>auxiliary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Implement Saturated Correlates with FIML</h2>

<h3>Description</h3>

<p>Automatically add auxiliary variables to a lavaan model when using full
information maximum likelihood (FIML) to handle missing data
</p>


<h3>Usage</h3>

<pre><code class="language-R">auxiliary(model, data, aux, fun, ...)

lavaan.auxiliary(model, data, aux, ...)

cfa.auxiliary(model, data, aux, ...)

sem.auxiliary(model, data, aux, ...)

growth.auxiliary(model, data, aux, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The analysis model can be specified with 1 of 2 objects:
</p>

<ol>
<li>
<p>  lavaan <code>model.syntax</code> specifying a hypothesized
model <em>without</em> mention of auxiliary variables in <code>aux</code>
</p>
</li>
<li>
<p>  a parameter table, as returned by <code>parTable</code>,
specifying the target model <em>without</em> auxiliary variables.
This option requires these columns (and silently ignores all others):
<code>c("lhs","op","rhs","user","group","free","label","plabel","start")</code>
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code> that includes auxiliary variables as well as
any observed variables in the <code>model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p><code>character</code>. Names of auxiliary variables to add to <code>model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p><code>character</code>. Name of a specific lavaan function used to fit
<code>model</code> to <code>data</code> (i.e., <code>"lavaan"</code>, <code>"cfa"</code>,
<code>"sem"</code>, or <code>"growth"</code>). Only required for <code>auxiliary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to <code>lavaan</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are wrappers around the corresponding lavaan functions.
You can use them the same way you use <code>lavaan</code>, but you
<em>must</em> pass your full <code>data.frame</code> to the <code>data</code> argument.
Because the saturated-correlates approaches (Enders, 2008) treates exogenous
variables as random, <code>fixed.x</code> must be set to <code>FALSE</code>. Because FIML
requires continuous data (although nonnormality corrections can still be
requested), no variables in the model nor auxiliary variables specified in
<code>aux</code> can be declared as <code>ordered</code>.
</p>


<h3>Value</h3>

<p>a fitted <code>lavaan</code> object.  Additional
information is stored as a <code>list</code> in the <code>@external</code> slot:
</p>

<ul>
<li> <p><code>baseline.model</code>. a fitted <code>lavaan</code>
object. Results of fitting an appropriate independence model for
the calculation of incremental fit indices (e.g., CFI, TLI) in
which the auxiliary variables remain saturated, so only the target
variables are constrained to be orthogonal. See Examples for how
to send this baseline model to <code>fitMeasures</code>.
</p>
</li>
<li> <p><code>aux</code>. The character vector of auxiliary variable names.
</p>
</li>
<li> <p><code>baseline.syntax</code>. A character vector generated within the
<code>auxiliary</code> function, specifying the <code>baseline.model</code>
syntax.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Terrence D. Jorgensen (University of Amsterdam; <a href="mailto:TJorgensen314@gmail.com">TJorgensen314@gmail.com</a>)
</p>


<h3>References</h3>

<p>Enders, C. K. (2008). A note on the use of missing auxiliary
variables in full information maximum likelihood-based structural equation
models. <em>Structural Equation Modeling, 15</em>(3), 434â€“448.
<a href="https://doi.org/10.1080/10705510802154307">doi:10.1080/10705510802154307</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat1 &lt;- lavaan::HolzingerSwineford1939
set.seed(12345)
dat1$z &lt;- rnorm(nrow(dat1))
dat1$x5 &lt;- ifelse(dat1$z &lt; quantile(dat1$z, .3), NA, dat1$x5)
dat1$x9 &lt;- ifelse(dat1$z &gt; quantile(dat1$z, .8), NA, dat1$x9)

targetModel &lt;- "
  visual  =~ x1 + x2 + x3
  textual =~ x4 + x5 + x6
  speed   =~ x7 + x8 + x9
"

## works just like cfa(), but with an extra "aux" argument
fitaux1 &lt;- cfa.auxiliary(targetModel, data = dat1, aux = "z",
                         missing = "fiml", estimator = "mlr")

## with multiple auxiliary variables and multiple groups
fitaux2 &lt;- cfa.auxiliary(targetModel, data = dat1, aux = c("z","ageyr","grade"),
                         group = "school", group.equal = "loadings")

## calculate correct incremental fit indices (e.g., CFI, TLI)
fitMeasures(fitaux2, fit.measures = c("cfi","tli"))
## NOTE: lavaan will use the internally stored baseline model, which
##       is the independence model plus saturated auxiliary parameters
lavInspect(fitaux2@external$baseline.model, "free")

</code></pre>


</div>