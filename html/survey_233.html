<div class="container">

<table style="width: 100%;"><tr>
<td>svycontrast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear and nonlinearconstrasts of survey statistics </h2>

<h3>Description</h3>

<p>Computes linear or nonlinear contrasts of estimates produced by survey
functions (or any object with <code>coef</code> and <code>vcov</code> methods).
</p>


<h3>Usage</h3>

<pre><code class="language-R">svycontrast(stat, contrasts, add=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>object of class <code>svrepstat</code> or <code>svystat</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>A vector or list of vectors of coefficients, or a
call or list of calls </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>keep all the coefficients of the input in the output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For future expansion</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>contrasts</code> is a list, the element names are used as
names for the returned statistics.
</p>
<p>If an element of <code>contrasts</code> is shorter than <code>coef(stat)</code> and has names, the
names are used to match up the vectors and the remaining elements of
<code>contrasts</code> are assumed to be zero. If the names are not legal
variable names (eg <code>0.1</code>) they must be quoted (eg <code>"0.1"</code>)
</p>
<p>If <code>contrasts</code> is a <code>"call"</code> or list of <code>"call"s</code>, and
<code>stat</code> is a <code>svrepstat</code> object including replicates, the
replicates are transformed and used to compute the variance. If
<code>stat</code> is a <code>svystat</code> object or a <code>svrepstat</code> object
without replicates, the delta-method is used to compute variances, and
the calls must use only functions that <code>deriv</code> knows how
to differentiate. If the names are not legal variable names they must
be quoted with backticks (eg <code>`0.1`</code>).
</p>
<p>If <code>stats</code> is a <code>svyvar</code> object, the estimates are elements of a matrix and the names are the row and column names pasted together with a colon. 
</p>


<h3>Value</h3>

<p>Object of class <code>svrepstat</code> or <code>svystat</code> or <code>svyvar</code>
</p>


<h3>See Also</h3>

<p><code>regTermTest</code>, <code>svyglm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(api)
dclus1&lt;-svydesign(id=~dnum, weights=~pw, data=apiclus1, fpc=~fpc)

a &lt;- svytotal(~api00+enroll+api99, dclus1)
svycontrast(a, list(avg=c(0.5,0,0.5), diff=c(1,0,-1)))
## if contrast vectors have names, zeroes may be omitted
svycontrast(a, list(avg=c(api00=0.5,api99=0.5), diff=c(api00=1,api99=-1)))

## nonlinear contrasts
svycontrast(a, quote(api00/api99))
svyratio(~api00, ~api99, dclus1)

## Example: standardised skewness coefficient
moments&lt;-svymean(~I(api00^3)+I(api00^2)+I(api00), dclus1)
svycontrast(moments, 
quote((`I(api00^3)`-3*`I(api00^2)`*`I(api00)`+ 3*`I(api00)`*`I(api00)`^2-`I(api00)`^3)/
      (`I(api00^2)`-`I(api00)`^2)^1.5))

## Example: geometric means
## using delta method
meanlogs &lt;- svymean(~log(api00)+log(api99), dclus1)
svycontrast(meanlogs,
    list(api00=quote(exp(`log(api00)`)), api99=quote(exp(`log(api99)`))))

## using delta method
rclus1&lt;-as.svrepdesign(dclus1)
meanlogs &lt;- svymean(~log(api00)+log(api99), rclus1)
svycontrast(meanlogs,
    list(api00=quote(exp(`log(api00)`)),
api99=quote(exp(`log(api99)`))))

## why is add=TRUE useful?

(totals&lt;-svyby(~enroll,~stype,design=dclus1,svytotal,covmat=TRUE))
totals1&lt;-svycontrast(totals, list(total=c(1,1,1)), add=TRUE)

svycontrast(totals1, list(quote(E/total), quote(H/total), quote(M/total)))


totals2&lt;-svycontrast(totals, list(total=quote(E+H+M)), add=TRUE)
all.equal(as.matrix(totals1),as.matrix(totals2))

## more complicated svyby
means &lt;- svyby(~api00+api99, ~stype+sch.wide, design=dclus1, svymean,covmat=TRUE)
svycontrast(means, quote(`E.No:api00`-`E.No:api99`))
svycontrast(means, quote(`E.No:api00`/`E.No:api99`))

## transforming replicates
meanlogs_r &lt;- svymean(~log(api00)+log(api99), rclus1, return.replicates=TRUE)
svycontrast(meanlogs_r,
    list(api00=quote(exp(`log(api00)`)), api99=quote(exp(`log(api99)`))))

## converting covariances to correlations
vmat &lt;-svyvar(~api00+ell,dclus1)
print(vmat,cov=TRUE)
cov2cor(as.matrix(vmat))[1,2]
svycontrast(vmat, quote(`api00:ell`/sqrt(`api00:api00`*`ell:ell`)))

</code></pre>


</div>