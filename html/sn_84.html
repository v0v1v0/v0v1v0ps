<div class="container">

<table style="width: 100%;"><tr>
<td>plot.selm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic plots for <code>selm</code> fits</h2>

<h3>Description</h3>

<p>Diagnostic plots for objects of class <code>selm</code>
and <code>mselm</code> generated by a call to function <code>selm</code></p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S4 method for signature 'selm'
plot(x, param.type="CP", which = c(1:4), caption, 
    panel = if (add.smooth) panel.smooth else points, main = "", 
    ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ..., 
    id.n = 3, labels.id = names(x@residuals.dp), 
    cex.id = 0.75, identline = TRUE, add.smooth = getOption("add.smooth"), 
    label.pos = c(4, 2), cex.caption = 1) 

 ## S4 method for signature 'mselm'
plot(x, param.type="CP",  which, caption, 
    panel = if (add.smooth) panel.smooth else points,  main = "", 
    ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ..., 
    id.n = 3, labels.id = names(x@residuals.dp), 
    cex.id = 0.75, identline = TRUE, add.smooth = getOption("add.smooth"), 
    label.pos = c(4, 2), cex.caption = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>selm</code> or <code>mselm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.type</code></td>
<td>
<p>a character string which selects the type of residuals
to be used for some of of the plots; 
possible values are: <code>"CP"</code> (default), <code>"DP"</code>, 
<code>"pseudo-CP"</code>. The various type of residuals only differ by an 
additive term; see ‘Details’ for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>if a subset of the plots is required, specify a subset of 
<code>1:4</code>; see ‘Details’ for a description of the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>a vector of character strings with captions to appear above 
the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>panel function.  The useful alternative to <code>points</code>,
<code>panel.smooth</code> can be chosen by <code>add.smooth = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title to each plot, in addition to the above caption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is asked before each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed through to plotting functions.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>number of points to be labelled in each plot, starting with the
most extreme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme points
will be chosen. <code>NULL</code> uses observation numbers..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>magnification of point labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identline</code></td>
<td>
<p>logical indicating if an identity line should be added to
QQ-plot and PP-plot (default: <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.smooth</code></td>
<td>
<p>logical indicating if a smoother should be added to most 
plots; see also <code>panel</code> above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p> positioning of labels, for the left half and right 
half of the graph respectively, for plots 1-3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.caption</code></td>
<td>
<p>controls the size of <code>caption</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The meaning of <code>param.type</code> is described in
<code>dp2cp</code>. However, for these plot only the first parameter
component is relevant, which affects the location of the residuals; the other
components are not computed. Moreover, for <abbr><span class="acronym">QQ</span></abbr>-plot and
<abbr><span class="acronym">PP</span></abbr>-plot, <abbr><span class="acronym">DP</span></abbr>-residuals are used irrespectively of
<code>param.type</code>; see Section ‘Background’.
</p>


<p>Values <code>which=1</code> and <code>which=2</code> have a
different effect for object of class <code>"selm"</code> and class <code>"mselm"</code>.
In the univariate case, <code>which=1</code> plots the residual values versus the
fitted values if <code>p&gt;1</code>, where <code>p</code> denotes the number of covariates
including the constant; if <code>p=1</code>, a boxplot of the response is produced.
Value <code>which=2</code> produces an histogram of the residuals with superimposed
the fitted curve, when <code>p&gt;1</code>; if <code>p=1</code>, a similar plot is generated
using the response variable instead of the residuals. Default value for
<code>which</code> is <code>1:4</code>.
</p>
<p>In the multivariate case, <code>which=1</code> is feasible only if <code>p=1</code> and it
displays the data scatter with superimposed the fitted distribution. Value
<code>which=2</code> produces a similar plot but for residuals instead of
data. Default value for codewhich is <code>2:4</code> if <code>p&gt;1</code>, otherwise
<code>c(1,3,4)</code>. 
</p>
<p>Value <code>which=3</code> produces a QQ-plot, both in the univariate and in the
multivariate case; the difference is that the squares of normalized residuals
and suitably defined Mahalanobis distances, respectively, are used in the two
cases. Similarly, <code>which=4</code> produces a PP-plot, working in a similar
fashion.</p>


<h3>Background</h3>

<p>Healy-type graphical diagnostics, in the form of QQ- and PP-plots, for the 
multivariate normal distribution have been extended to the skew-normal
distribution by Azzalini and Capitanio (1999, section 6.1), and subsequently 
to the skew-<code class="reqn">t</code> distribution in Azzalini and Capitanio (2003). 
A brief explanation in the univariate <abbr><span class="acronym">SN</span></abbr> case is provided 
in Section 3.1.1 of Azzalini and Capitanio (2014); see also Section 3.1.6.
For the univariate <abbr><span class="acronym">ST</span></abbr> case, see p.102 and p.111 of the monograph.
The multivariate case is discussed in Section 5.2.1 as for the <abbr><span class="acronym">SN</span></abbr>
distribution, in Section 6.2.6 as for the <abbr><span class="acronym">ST</span></abbr> distribution.
</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (1999).
Statistical applications of the multivariate skew normal distribution.
<em>J.Roy.Statist.Soc. B</em> <b>61</b>, 579-602. 
Full-length version available at <a href="https://arXiv.org/abs/0911.2093">https://arXiv.org/abs/0911.2093</a>
</p>
<p>Azzalini, A. and Capitanio, A. (2003).
Distributions generated by perturbation of symmetry with emphasis on
a multivariate skew <em>t</em> distribution.
<em>J.Roy. Statist. Soc. B</em> <b>65</b>, 367-389.
Full-length version available at <a href="https://arXiv.org/abs/0911.2342">https://arXiv.org/abs/0911.2342</a>
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>


<h3>See Also</h3>

<p><code>selm</code>, <code>dp2cp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(wines)
#
m10 &lt;- selm(flavanoids  ~ 1, family="SN", data=wines, subset=(wine=="Barolo"))
plot(m10)
plot(m10, which=c(1,3)) # fig 3.1 and 3.2(a) of Azzalini and Capitanio (2014)
#
m18 &lt;- selm(acidity ~ sugar + nonflavanoids + wine, family="SN", data=wines)
plot(m18)
plot(m18, param.type="DP")
#
m28 &lt;- selm(cbind(acidity, alcohol) ~ sugar + nonflavanoids + wine, 
            family="SN", data=wines)
plot(m28, col=4)            
# 
data(ais)
m30 &lt;-  selm(cbind(RCC, Hg, Fe) ~ 1, family="SN", data=ais)
plot(m30, col=2, which=2)

# multiple plots on the same sheet 
par(mfcol=c(2,2)) 
plot(m30, which=1:3)
par(mfcol=c(1,1)) 

</code></pre>


</div>