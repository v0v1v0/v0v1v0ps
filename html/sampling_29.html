<div class="container">

<table style="width: 100%;"><tr>
<td>regest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression estimator</h2>

<h3>Description</h3>

<p>Computes the regression estimator of the population total, using the 
design-based approach. The underling regression model is a model without intercept.</p>


<h3>Usage</h3>

<pre><code class="language-R">regest(formula,Tx,weights,pikl,n,sigma=rep(1,length(weights)))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula (y~x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tx</code></td>
<td>
<p>population total of x, the auxiliary variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of the weights; its length is equal to n, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikl</code></td>
<td>
<p>matrix of joint inclusion probabilities for the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of positive values accounting for heteroscedasticity.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>regest</code></td>
<td>
<p>value of the regression estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>vector of estimated beta coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_error</code></td>
<td>
<p>estimated standard error of the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_value</code></td>
<td>
<p>t-values associated to the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value</code></td>
<td>
<p>p-values associated to the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_mat</code></td>
<td>
<p>covariance matrix of the estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>specified weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>model matrix.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>ratioest</code>,<code>regest_strata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># uses the MU284 population to draw a systematic sample
data(MU284)
# there are 3 outliers which are deleted from the population
MU281=MU284[MU284$RMT85&lt;=3000,]
attach(MU281)
# computes the inclusion probabilities using the variable P85; sample size 40
pik=inclusionprobabilities(P85,40)
# joint inclusion probabilities for systematic sampling
pikl=UPsystematicpi2(pik)
# draws a systematic sample of size 40
s=UPsystematic(pik)
# defines the variable of interest for the selected sample
y=RMT85[s==1]
# defines the auxiliary information for the selected sample
x1=CS82[s==1]
x2=SS82[s==1]
# joint inclusion probabilities for the selected sample
pikls=pikl[s==1,s==1]
# first-order inclusion probabilities for the selected sample
piks=pik[s==1]
# computes the regression estimator with the model y~x1+x2-1 
r=regest(formula=y~x1+x2-1,Tx=c(sum(CS82),sum(SS82)),weights=1/piks,pikl=pikls,n=40)
# the regression estimator
r$regest
# the estimated beta coefficients 
r$coefficients
# the regression estimator is the same as the calibration estimator (method="linear") 
Xs=cbind(x1,x2)
total=c(sum(CS82),sum(SS82))
g1=calib(Xs,d=1/piks,total,method="linear")
checkcalibration(Xs,d=1/piks,total,g1)
calibev(y,Xs,total,pikls,d=1/piks,g1,with=TRUE,EPS=1e-6)
detach(MU281)
</code></pre>


</div>