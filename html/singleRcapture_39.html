<div class="container">

<table style="width: 100%;"><tr>
<td>stratifyPopsize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate size of sub populations.</h2>

<h3>Description</h3>

<p>A function that estimates sizes of specific sub populations
based on a capture-recapture model for the whole population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stratifyPopsize(object, stratas, alpha, ...)

## S3 method for class 'singleRStaticCountData'
stratifyPopsize(object, stratas, alpha, cov = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object on which the population size estimates should be based
in <code>singleRcapture</code> package this is a fitter <code>singleRStaticCountData</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratas</code></td>
<td>
<p>a specification of sub populations either by:
</p>

<ul>
<li>
<p> formula – a formula to be applied to <code>model.frame</code> extracted from
the object .
</p>
</li>
<li>
<p> Logical vector with number of entries equal to number of rows in the dataset.
</p>
</li>
<li>
<p> A (named) list where each element is a logical vector, names of the list
will be used to specify names variable in returned object.
</p>
</li>
<li>
<p> Vector of names of explanatory variables. For <code>singleRStaticCountData</code> method
for this function this specification of <code>stratas</code> parameter will
result in every level of explanatory variable having its own sub population
for each variable specified.
</p>
</li>
<li>
<p> If no value was provided the <code>singleRStaticCountData</code> method for this function
will itself create sub populations based on levels of factor variables
in <code>model.frame</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for confidence intervals –
Either a single numeric value or a vector of length equal to number of
sub populations specified in <code>stratas</code>.
If missing it is set to <code>.05</code> in <code>singleRStaticCountData</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a vector of arguments to be passed to other functions.
For <code>singleRStaticCountData</code> method for this functions arguments in <code>...</code> are
passed to either <code>cov</code> if argument provided was a function or
<code>vcov</code> if <code>cov</code> argument was missing at call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>for <code>singleRStaticCountData</code> method an estimate of variance-covariance matrix
for estimate of regression parameters. It is possible to pass a function
such as for example <code>sandwich::vcovHC</code> which will be called as:
<code>foo(object, ...)</code> and a user may specify additional arguments of a
function in <code>...</code> argument. If not provided an estimate for covariance
matrix will be set by calling appropriate <code>vcov</code> method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>In single source capture-recapture models the most frequently used
estimate for population size is Horvitz-Thompson type estimate:
</p>
\[\hat{N} = \sum_{k=1}^{N}\frac{I_{k}}{\mathbb{P}(Y_{k}&gt;0)} = 
\sum_{k=1}^{N_{obs}}\frac{1}{1-\mathbb{P}(Y_{k}=0)}\]
<p>where \(I_{k}=I_{Y_{k} &gt; 0}\) are
indicator variables, with value 1 if kth unit was observed at least once
and 0 otherwise and the inverse probabilistic weights weights for
units observed in the data \(\tfrac{1}{\mathbb{P}(Y_{k}&gt;0)}\)
are estimated using fitted linear predictors.
</p>
<p>The estimates for different sub populations are made by changing the
\(I_{k}=I_{Y_{k} &gt; 0}\) indicator variables to
refer not to the population as a whole but to the sub populations that are
being considered i.e. by changing values from 1 to 0 if kth unit is not a
member of sub population that is being considered at the moment.
</p>
<p>The estimation of variance for these estimates and estimation of variance for
estimate of population size for the whole population follow the same relation
as the one described above.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> object with row names being the names of specified
sub populations either provided or inferred.
</p>


<h3>See Also</h3>

<p><code>vcov.singleRStaticCountData()</code> <code>estimatePopsize()</code>
</p>


</div>