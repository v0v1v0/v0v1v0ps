<div class="container">

<table style="width: 100%;"><tr>
<td>findFeasibleMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finds a Nonnegative Matrix Satisfying Row and Column Sums</h2>

<h3>Description</h3>

<p>Given row and column sums and a matrix p which indicates which elements of the matrix can be present, this function computes a nonnegative matrix that match these row and column sums. If this is not possible then the function returns an error message.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findFeasibleMatrix(r, c, p, eps = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>vector of row sums (nonnegative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>vector of column sums (nonnegative)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>matrix of probabilities (must be in [0,1]), matching the dimensions of r and c. Values of p=0 are interpreted that the corresponding matrix elements have to be 0. Note: p=1 does not force the corresponding matrix element to exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>row and col sums can at most be different by eps.  Default 1e-9.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function transforms the problem into a Maximum Flow
problem of a graph and uses the Edmonds-Karps algorithm to solve it.
If the error message "Could not find feasible matrix." is produced then this could be
due to p imposing disconnected components in the graph implied
by row and column sums that are not compatible with the row and column sums..
</p>


<h3>Value</h3>

<p>A feasible matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p=matrix(c(1,0,0,1),nrow=2)
findFeasibleMatrix(c(1,1),c(1,1),p=p)

n &lt;- 4
M &lt;- matrix(nrow=n,ncol=n,rexp(n*n)*(runif(n*n)&gt;0.6))
M
r &lt;- rowSums(M)
c &lt;- colSums(M)
Mnew &lt;- findFeasibleMatrix(r=r,c=c,p=(M&gt;0)*0.5)
Mnew
rowSums(M);rowSums(Mnew)
colSums(M);colSums(Mnew)
</code></pre>


</div>