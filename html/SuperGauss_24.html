<div class="container">

<table style="width: 100%;"><tr>
<td>rnormtz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a stationary Gaussian time series.</h2>

<h3>Description</h3>

<p>Simulate a stationary Gaussian time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnormtz(n = 1, acf, Z, fft = TRUE, nkeep, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of time series to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acf</code></td>
<td>
<p>Length-<code>N</code> vector giving the autocorrelation of the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Optional size <code style="white-space: pre;">⁠(2N-2) x n⁠</code> or <code style="white-space: pre;">⁠N x n⁠</code> matrix of iid standard normals, to use in the FFT and Durbin-Levinson methods, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fft</code></td>
<td>
<p>Logical; whether or not to use the <code style="white-space: pre;">⁠O(N log N)⁠</code> FFT-based algorithm of Wood and Chan (1994) or the more stable <code>O(N^2)</code> Durbin-Levinson algorithm.  See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nkeep</code></td>
<td>
<p>Length of time series.  Defaults to <code>N = length(acf)</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Relative tolerance on negative eigenvalues.  See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The FFT method fails when the embedding circulant matrix is not positive definite.  This is typically due to one of two things:
</p>

<ol>
<li>
<p> Roundoff error can make tiny eigenvalues appear negative.  For this purpose, argument <code>tol</code> can be used to replace all negative eigenvalues by <code>tol * ev_max</code>, where <code>ev_max</code> is the largest eigenvalue.
</p>
</li>
<li>
<p> The autocorrelation is decaying too slowly on the given timescale.  To mitigate this, argument <code>nkeep</code> can be used to supply a longer <code>acf</code> than is required, and keep only the first <code>nkeep</code> time series observations.  For consistency, <code>nkeep</code> also applies to Durbin-Levinson method.
</p>
</li>
</ol>
<h3>Value</h3>

<p>Length-<code>nkeep</code> vector or size <code style="white-space: pre;">⁠nkeep x n⁠</code> matrix with time series as columns.
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 10
acf &lt;- exp(-(1:N - 1)/N)
rnormtz(n = 3, acf = acf)
</code></pre>


</div>