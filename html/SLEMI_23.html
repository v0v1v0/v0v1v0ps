<div class="container">

<table style="width: 100%;"><tr>
<td>prob_discr_pairwise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates Probability of pairwise discrimination</h2>

<h3>Description</h3>

<p>Estimates probabilities of correct discrimination (PCDs) between each pair of input/signal values using a logistic regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prob_discr_pairwise(
  dataRaw,
  signal = "input",
  response = NULL,
  side_variables = NULL,
  formula_string = NULL,
  output_path = NULL,
  scale = TRUE,
  lr_maxit = 1000,
  MaxNWts = 5000,
  diagnostics = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataRaw</code></td>
<td>
<p>must be a data.frame object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>is a character object with names of columns of dataRaw to be treated as channel's input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>is a character vector with names of columns of dataRaw  to be treated as channel's output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side_variables</code></td>
<td>
<p>(optional) is a character vector that indicates side variables' columns of data, if NULL no side variables are included</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula_string</code></td>
<td>
<p>(optional) is a character object that includes a formula syntax to use in logistic regression model. 
If NULL, a standard additive model of response variables is assumed. Only for advanced users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_path</code></td>
<td>
<p>is a directory where a pie chart with calculated probabilities will be saved. If NULL, the graph will not be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>is a logical indicating if the response variables should be scaled and centered before fitting logistic regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr_maxit</code></td>
<td>
<p>is a maximum number of iteration of fitting algorithm of logistic regression. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxNWts</code></td>
<td>
<p>is a maximum acceptable number of weights in logistic regression algorithm. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostics</code></td>
<td>
<p>is a logical indicating if details of logistic regression fitting should be included in output list</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to estimate PCDs, for a given pair of input values <code class="reqn">x_i</code> and <code class="reqn">x_j</code>, we propose to fit a logistic regression model
using response data corresponding to the two considered inputs, i.e. <code class="reqn">y^l_u</code>, for <code class="reqn">l\in\{i,j\}</code> and <code class="reqn">u</code> ranging from 
1 to <code class="reqn">n_l</code>. 
To ensure that both inputs have equal contribution to the calculated discriminability, equal probabilities should be assigned,
<code class="reqn">P(X) = (P(x_i),P(x_j))=(1/2,1/2)</code>. Once the regression model is fitted, probability of assigning a given cellular response, 
<code class="reqn">y</code>,
to the correct input value is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\max \{ \hat{P}_{lr}(x_i|Y=y;P(X)), \hat{P}_{lr}(x_j|Y=y;P(X))\}.</code>
</p>

<p>Note that <code class="reqn">P(x_j|Y=y)=1-P(x_i|Y=y)</code> as well as <code class="reqn">\hat{P}_{lr}(x_j|Y=y;P(X))=1-\hat{P}_{lr}(x_i|Y=y;P(X))</code>
The average of the above probabilities over all observations <code class="reqn">y^i_l</code> yields PCDs
</p>
<p style="text-align: center;"><code class="reqn">PCD_{x_i,x_j}=\frac{1}{2}\frac{1}{n_i}\sum_{l=1}^{n_i}\max\{ \hat{P}_{lr}(x_i|Y=y_i^l;P(X)),\hat{P}_{lr}(x_i^l|Y=y;P(X))\} + </code>
</p>

<p style="text-align: center;"><code class="reqn"> \frac{1}{2}  \frac{1}{n_j} \sum_{l=1}^{n_j} \max \{ \hat{P}_{lr}(x_i|Y=y_j^l;P(X)), \hat{P}_{lr}(x_j|Y=y_j^l;P(X))\}.</code>
</p>

<p>Additional parameters: lr_maxit and maxNWts are the same as in definition of multinom function from nnet package. An alternative
model formula (using formula_string arguments) should be provided if  data are not suitable for description by logistic regression
(recommended only for advanced users). Preliminary scaling of  data (argument scale) should be used similarly as in other 
data-driven approaches, e.g. if response variables are comparable, scaling (scale=FALSE) can be omitted, while if they represent 
different phenomenon (varying by units and/or magnitude) scaling is recommended.
</p>


<h3>Value</h3>

<p>a list with two elements:
</p>

<ul>
<li>
<p> output$prob_matr - a <code class="reqn">n\times n</code> matrix, where <code class="reqn">n</code> is the number of inputs, with probabilities of correct 
discrimination between pairs of input values. 
</p>
</li>
<li>
<p> output$diagnostics     - (if diagnostics=TRUE) a list corresponding to logistic regression models fitted for each 
pair of input values. Each element consists of three sub-elements: 1) nnet_model - nnet object summarising logistic regression model; 
2) prob_lr - probabilities of assignment obtained from logistic regression model; 
3) confusion_matrix - confusion matrix of classificator.
</p>
</li>
</ul>
<h3>References</h3>

<p>[1] Jetka T, Nienaltowski K, Winarski T, Blonski S, Komorowski M,  
Information-theoretic analysis of multivariate single-cell signaling responses using SLEMI,
<em>PLoS Comput Biol</em>, 15(7): e1007132, 2019, https://doi.org/10.1371/journal.pcbi.1007132.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Calculate probabilities of discrimination for nfkb dataset
 it=21 # choose from 0, 3, 6, ..., 120 for measurements at other time points
 output=prob_discr_pairwise(dataRaw=data_nfkb[data_nfkb$signal%in%c("0ng","1ng","100ng"),],
                            signal = "signal",
                           response = paste0("response_",it))

</code></pre>


</div>