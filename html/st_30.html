<div class="container">

<table style="width: 100%;"><tr>
<td>shrinkt.stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Shrinkage t Statistic</h2>

<h3>Description</h3>

<p><code>shrinkt.stat</code> and <code>shrinkt.fun</code> compute the “shrinkage t” statistic
of Opgen-Rhein and Strimmer (2007).
</p>


<h3>Usage</h3>

<pre><code class="language-R">shrinkt.stat(X, L, lambda.var, lambda.freqs, var.equal=TRUE, 
   paired=FALSE, verbose=TRUE)
shrinkt.fun(L, lambda.var, lambda.freqs, var.equal=TRUE, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>data matrix. Note that the <em>columns</em> correspond to variables (“genes”)
and the <em>rows</em> to samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>factor with class labels for the two groups. If only a single label is given then a one-sample t-score against 0 is computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.var</code></td>
<td>
<p>Shrinkage intensity for the variances. If not specified it is 
estimated from the data. <code>lambda.var=0</code> implies no shrinkage
and <code>lambda.var=1</code> complete shrinkage. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.freqs</code></td>
<td>
<p>Shrinkage intensity for the frequencies. If not specified it is 
estimated from the data. <code>lambda.freqs=0</code> implies no shrinkage (i.e. empirical frequencies).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p>assume equal (default) or unequal variances in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>compute paired t-score (default is to use unpaired t-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print out some (more or less useful) information during computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The “shrinkage t” statistic is similar to the usual t statistic, with the
replacement of the sample variances by corresponding shrinkage estimates.
These are derived in a distribution-free fashion and with little a priori
assumptions.   Using the “shrinkage t” statistic procduces highly accurate rankings -
see Opgen-Rhein and Strimmer (2007).  
</p>
<p>The“shrinkage t” statistic can be generalized to include gene-wise correlation,
see <code>shrinkcat.stat</code>.
</p>
<p>The scale factor in the ”shrinkage t” statistic is computed from the estimated frequencies
(to use the standard empirical scale factor set  <code>lambda.freqs=0</code>).
</p>


<h3>Value</h3>

<p><code>shrinkt.stat</code> returns a vector containing the “shrinkage t” 
statistic for each variable/gene.
</p>
<p>The corresponding <code>shrinkt.fun</code> functions return a function that
produces the “shrinkage t” statistics when applied to a data matrix
(this is very useful for simulations).
</p>


<h3>Author(s)</h3>

<p>Rainer Opgen-Rhein, Verena Zuber, 
and
Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Opgen-Rhein, R., and K. Strimmer. 2007. Accurate ranking of 
differentially expressed genes by a distribution-free shrinkage 
approach.  
Statist. Appl. Genet. Mol. Biol. <b>6</b>:9.
&lt;DOI:10.2202/1544-6115.1252&gt;  
</p>


<h3>See Also</h3>

<p><code>studentt.stat</code>,
<code>diffmean.stat</code>,
<code>shrinkcat.stat</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load st library 
library("st")

# load Choe et al. (2005) data
data(choedata)
X &lt;- choe2.mat
dim(X) # 6 11475  
L &lt;- choe2.L
L

# L may also contain some real labels
L = c("group 1", "group 1", "group 1", "group 2", "group 2", "group 2")

# shrinkage t statistic (equal variances)
score = shrinkt.stat(X, L)
order(score^2, decreasing=TRUE)[1:10]

# [1] 10979 11068    50  1022   724  5762    43  4790 10936  9939
#  lambda.var (variances):  0.3882
#  lambda.freqs (frequencies):  1

# shrinkage t statistic (unequal variances)
score = shrinkt.stat(X, L, var.equal=FALSE)
order(score^2, decreasing=TRUE)[1:10]

# [1] 11068    50 10979   724    43  1022  5762 10936  9939  9769
#  lambda.var class #1 and class #2 (variances):  0.3673   0.3362
#  lambda.freqs (frequencies): 1

# compute q-values and local false discovery rates
library("fdrtool")
fdr.out = fdrtool(score) 
sum( fdr.out$qval &lt; 0.05 )
sum( fdr.out$lfdr &lt; 0.2 )
fdr.out$param


# computation of paired t-score

# paired shrinkage t statistic
score = shrinkt.stat(X, L, paired=TRUE)
order(score^2, decreasing=TRUE)[1:10]
# [1] 50  4790  5393 11068  5762 10238  9939   708   728    68


# if there is no shrinkage the paired shrinkage t score reduces
# to the conventional paired student t statistic
score = studentt.stat(X, L, paired=TRUE)
score2 = shrinkt.stat(X, L, lambda.var=0, lambda.freqs=0, paired=TRUE, verbose=FALSE)
sum((score-score2)^2)

</code></pre>


</div>