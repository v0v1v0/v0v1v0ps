<div class="container">

<table style="width: 100%;"><tr>
<td>hot_spot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatically calculate Local G hot spot intensity</h2>

<h3>Description</h3>

<p>Function automatically calculates the Local G hot spot intensity measure for spatial points, spatial polygons, and single raster layers. Uses RANN for efficient nearest neighbor calculation (spatial points and single raster layers only); users can specify the number of neighbors (k). Users can specify the neighborhood style (see spdep::nb2listw) with default being standardized weight matrix (W).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hot_spot(
  insert,
  variable = NULL,
  style = "W",
  k = 9,
  remove_missing = TRUE,
  NA_Value = 0,
  include_Moran = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>insert</code></td>
<td>
<p>Spatial point, spatial polygon, or single raster layer object. Acceptable formats include <code>sf</code>, <code>SpatialPolygonsDataFrame</code>, <code>SpatialPointsDataFrame</code>, and <code>RasterLayer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Column name or numeric vector containing the variable from which the local G statistic will be calculated. Must possess a natural scale that orders small and large observations (i.e. number, percentage, ratio and not model residuals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>Style can take values <code>'W'</code>, <code>'B'</code>, <code>'C'</code>, <code>'U'</code>, <code>'mimax'</code>, <code>'S'</code> (see  <code>nb2listw</code>). Character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of neighbors. Default is 9. Numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_missing</code></td>
<td>
<p>Whether to calculate statistic without missing values. If <code>FALSE</code>, substitute value must be supplied to <code>NA_Value</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA_Value</code></td>
<td>
<p>Substitute for missing values. Default value is 0. Numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_Moran</code></td>
<td>
<p>Calculate local Moran's I statistics. Default is <code>FALSE</code>. Logical.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>input</code> is <code>sf</code>, <code>SpatialPolygonsDataFrame</code> or <code>SpatialPointsDataFrame</code> object, returns <code>sf</code> object with same geometries and columns as <code>input</code>, appended with additional column containing Local G estimates (<code>LocalG</code>). If <code>input</code> is <code>RasterLayer</code> object, returns <code>RasterBrick</code> object containing original values (<code>Original</code>) and Local G estimates (<code>LocalG</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate Local G for sf point layer

## Not run: 
data(clea_deu2009_pt)
out_1 &lt;- hot_spot(insert=clea_deu2009_pt, variable = clea_deu2009_pt$to1)
class(out_1)
plot(out_1["LocalG"])

## End(Not run)

# Calculate Local G for sf polygon layer (variable as numeric vector)

## Not run: 
data(clea_deu2009)
out_2 &lt;- hot_spot(insert=clea_deu2009, variable = clea_deu2009$to1)
summary(out_2$LocalG)
plot(out_2["LocalG"])

## End(Not run)

# Calculate Local G for sf polygon layer (variable as column name)

## Not run: 
out_3 &lt;- hot_spot(insert=clea_deu2009, variable = "to1")
summary(out_3$LocalG)
plot(out_3["LocalG"])

## End(Not run)

# Calculate Local G for sf polygon SpatialPolygonsDataFrame (variable as column name)

## Not run: 
out_4 &lt;- hot_spot(insert=as(clea_deu2009,"Spatial"), variable = "to1")
summary(out_4$LocalG)
plot(out_4["LocalG"])

## End(Not run)

# Calculate Local G for RasterLayer
## Not run: 
data(gpw4_deu2010)
out_5 &lt;- hot_spot(insert=gpw4_deu2010)
class(out_5)
terra::plot(out_5$LocalG)

## End(Not run)
</code></pre>


</div>