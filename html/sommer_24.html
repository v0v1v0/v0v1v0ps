<div class="container">

<table style="width: 100%;"><tr>
<td>corImputation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputing a matrix using correlations</h2>

<h3>Description</h3>

<p>corImputation imputes missing data based on the correlation that exists between row levels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  corImputation(wide, Gu=NULL, nearest=10, roundR=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wide</code></td>
<td>
<p>numeric matrix with individuals in rows and time variable in columns (e.g., environments, genetic markers, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gu</code></td>
<td>
<p>optional correlation matrix between the individuals or row levels. If NULL it will be computed as the correlation of t(wide).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nearest</code></td>
<td>
<p>integer value describing how many nearest neighbours (the ones showing the highest correlation) should be used to average and return the imputed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roundR</code></td>
<td>
<p>a TRUE/FALSE statement describing if the average result should be rounded or not. This may be specifically useful for categorical data in the form of numbers (e.g., -1,0,1).</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt>$res</dt>
<dd>
<p> a list with the imputed matrix and the original matrix.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Giovanny Covarrubias-Pazaran
</p>


<h3>References</h3>

<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744 
</p>


<h3>See Also</h3>

<p>The core functions of the package <code>mmer</code> and <code>mmec</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
####################################
### imputing genotype data example
####################################
# data(DT_cpdata)
# X &lt;- GT_cpdata
# # add missing data
# v &lt;- sample(1:length(X), 500)
# Xna &lt;- X
# Xna[v]&lt;- NA
# ## impute (can take some time)
# Y &lt;- corImputation(wide=Xna, Gu=NULL, nearest=20, roundR=TRUE) 
# cm &lt;- table(Y$imputed[v],X[v])
# ## calculate accuracy
# sum(diag(cm))/length(v)
####################################
### imputing phenotypic data example
####################################
# data(DT_h2)
# X &lt;- reshape(DT_h2[,c("Name","Env","y")], direction = "wide", idvar = "Name",
#                 timevar = "Env", v.names = "y", sep= "_")
# rownames(X) &lt;- X$Name
# X &lt;- as.matrix(X[,-1])
# head(X)
# # add missing data
# v &lt;- sample(1:length(X), 50)
# Xna &lt;- X
# Xna[v]&lt;- NA
# ## impute
# Y &lt;- corImputation(wide=Xna, Gu=NULL, nearest=20, roundR=TRUE)
# plot(y=Y$imputed[v],x=X[v], xlab="true",ylab="predicted")
# cor(Y$imputed[v],X[v], use = "complete.obs")


</code></pre>


</div>