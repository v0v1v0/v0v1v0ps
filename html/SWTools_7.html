<div class="container">

<table style="width: 100%;"><tr>
<td>SILOCorrectSite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correct a slope change in a rainfall data set based on another site</h2>

<h3>Description</h3>

<p>If the break point of a non-homogenous rainfall station has been identified (potentially using SILOCheckConsistency), correct the data on one side of the breakpoint
</p>


<h3>Usage</h3>

<pre><code class="language-R">SILOCorrectSite(
  X,
  s_correct,
  s_reference,
  year_break,
  year_start = NULL,
  year_end = NULL,
  after = TRUE,
  plot = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list of SILO station data, in the format created by <code>SILOLoad</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_correct</code></td>
<td>
<p>Station number that exists in <code>X</code> to correct</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_reference</code></td>
<td>
<p>Station number that exists in <code>X</code> to used for the correction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_break</code></td>
<td>
<p>year in the time series that the break points exists</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_start</code></td>
<td>
<p>first year of data (before <code>year_break</code>) to to develop the first linear regression between <code>s_correct</code> and <code>s_reference</code>. Defaults to the start of the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_end</code></td>
<td>
<p>last year of data (after <code>year_break</code>) to to develop the second linear regression between <code>s_correct</code> and <code>s_reference</code>. Defaults to the end of the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>after</code></td>
<td>
<p>TRUE/FALSE value, indicating if the homogeneous data to develop the relationship to correct the non-homogeneous data is after the breakpoint (<code>TRUE</code>) or before (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if specified, the file (including path if necessary) to save a scatter plot of the annual rainfall totals, including regression equations used to correct the non-homogeneous data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method of cumulative residuals outlined in <a href="https://www.fao.org/4/x0490e/x0490e0l.htm#annex%204.%20statistical%20analysis%20of%20weather%20data%20sets%201">Annex 4</a> of Allen et al. (1998) has been used.
That is, two linear regressions between the annual rainfall totals are calculated <code>P_s_correct~P_s_reference</code> over the periods year_start:year_break and year_break:year_end
For the period to correct (after the breakpoint if <code>after=TRUE</code>) an annual scaling factor is calculated from the ratio of the predicted rainfall total from the two regression equations, based on the rainfall total for each year at the reference site.
This scaling factor is then applied to the daily rainfall data for that year.
</p>


<h3>Value</h3>

<p>A list with the same structure as <code>X</code>, with the element for <code>s_correct</code> updated with the corrections on one side of the breakpoint year.
</p>


<h3>References</h3>

<p>Chang, M., and Lee, R. (1974) Objective double-mass analysis, Water Resour. Res., 10( 6), 1123â€“ 1126, doi:10.1029/WR010i006p01123.
</p>


<h3>See Also</h3>

<p>SILOLoad, SILOSiteSummary, SILOQualityCodes,SILOCorrectSite
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
stations&lt;-c("23313","23302","23300","23317","23725","23705")
SILODownload(stations)
X&lt;-SILOLoad(stations,startdate="1891-01-01",enddate="2020-12-31")
X&lt;-SILOCorrectSite(X,"23313","23705",1970,after=FALSE)

## End(Not run)

</code></pre>


</div>