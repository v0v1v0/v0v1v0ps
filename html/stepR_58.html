<div class="container">

<table style="width: 100%;"><tr>
<td>smuceR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Piecewise constant regression with SMUCE</h2>

<h3>Description</h3>

<p>Computes the SMUCE estimator for one-dimensional data.
</p>
<p><b>Deprecation warning:</b> This function is deprecated, but still working, however, may be defunct in a future version. Please use instead the function <code>stepFit</code>. At the moment some families are supported by this function that are not supported by the current version of <code>stepFit</code>. They will be added in a future version. An example how to reproduce results is given below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smuceR(y, x = 1:length(y), x0 = 2 * x[1] - x[2], q = thresh.smuceR(length(y)), alpha, r,
  lengths, family = c("gauss", "gaussvar", "poisson", "binomial"), param,
  jumpint = confband, confband = FALSE)
thresh.smuceR(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector containing the serial data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of the same length as <code>y</code> containing the corresponding sample points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>a single numeric giving the last unobserved sample point directly before sampling started</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>threshold value, by default chosen automatically according to Frick et al.~(2013)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level; if set to a value in (0,1), <code>q</code> is chosen as the corresponding quantile of the asymptotic (if <code>r</code> is not given) null distribution (and any value specified for <code>q</code> is silently ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>numer of simulations; if specified along <code>alpha</code>, <code>q</code> is chosen as the corresponding quantile of the simulated null distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengths</code></td>
<td>
<p>length of intervals considered; by default up to a sample size of 1000 all lengths, otherwise only dyadic lengths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family, param</code></td>
<td>
<p>specifies distribution of data, see family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpint</code></td>
<td>
<p><code>logical</code> (<code>FALSE</code> by default), indicates if confidence sets for change-points should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confband</code></td>
<td>
<p><code>logical</code>, indicates if a confidence band for the piecewise-continuous function should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>number of data points</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>smuceR</code>, an object of class <code>stepfit</code> that contains the fit; if <code>jumpint == TRUE</code> function <code>jumpint</code> allows to extract the <code>1 - alpha</code> confidence interval for the jumps, if <code>confband == TRUE</code> function <code>confband</code> allows to extract the <code>1 - alpha</code> confidence band.
</p>
<p>For <code>thresh.smuceR</code>, a precomputed threshhold value, see reference.
</p>


<h3>References</h3>

<p>Frick, K., Munk, A., and Sieling, H. (2014) Multiscale change-point inference. With discussion and rejoinder by the authors. <em>Journal of the Royal Statistical Society, Series B</em> <b>76</b>(3), 495–580.
</p>
<p>Futschik, A., Hotz, T., Munk, A. Sieling, H. (2014) Multiresolution DNA partitioning: statistical evidence for segments. <em>Bioinformatics</em>,  <b>30</b>(16), 2255–2262.
</p>


<h3>See Also</h3>

<p><code>stepFit</code>, <code>stepbound</code>, <code>bounds</code>, family, <code>MRC.asymptotic</code>, <code>sdrobnorm</code>, <code>stepfit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- rnorm(100, c(rep(0, 50), rep(1, 50)), 0.5)

# fitted function, confidence intervals, and confidence band by stepFit
all.equal(fitted(smuceR(y, q = 1)), fitted(stepFit(y, q = 1)))
all.equal(fitted(smuceR(y, alpha = 0.5)),
          fitted(stepFit(y, q = as.numeric(quantile(stepR::MRC.1000, 0.5)))))
all.equal(fitted(smuceR(y)), fitted(stepFit(y, q = thresh.smuceR(length(y)))))

all.equal(jumpint(smuceR(y, q = 1, jumpint = TRUE)),
          jumpint(stepFit(y, q = 1, jumpint = TRUE)))
all.equal(confband(smuceR(y, q = 1, confband = TRUE)),
          confband(stepFit(y, q = 1, confband = TRUE)),
          check.attributes = FALSE)
          

# simulate poisson data with two levels
y &lt;- rpois(100, c(rep(1, 50), rep(4, 50)))
# compute fit, q is chosen automatically
fit &lt;- smuceR(y, family="poisson", confband = TRUE)
# plot result
plot(y)
lines(fit)
# plot confidence intervals for jumps on axis
points(jumpint(fit), col="blue")
# confidence band
lines(confband(fit), lty=2, col="blue")

# simulate binomial data with two levels
y &lt;- rbinom(200,3,rep(c(0.1,0.7),c(110,90)))
# compute fit, q is the 0.9-quantile of the (asymptotic) null distribution
fit &lt;- smuceR(y, alpha=0.1, family="binomial", param=3, confband = TRUE)
# plot result
plot(y)
lines(fit)
# plot confidence intervals for jumps on axis
points(jumpint(fit), col="blue")
# confidence band
lines(confband(fit), lty=2, col="blue")
</code></pre>


</div>