<div class="container">

<table style="width: 100%;"><tr>
<td>CalcBYprobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Birth year probabilities</h2>

<h3>Description</h3>

<p>Estimate the probability that an individual with unknown birth
year is born in year <code>y</code>, based on <code>BirthYears</code> or <code>BY.min</code>
and/or <code>BY.max</code> of its parents, offspring, and siblings, combined with
<code>AgePrior</code> (the age distribution of other parent-offspring pairs),
and/or <code>Year.last</code> of its parents.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalcBYprobs(Pedigree = NULL, LifeHistData = NULL, AgePrior = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pedigree</code></td>
<td>
<p>dataframe with columns id-dam-sire.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LifeHistData</code></td>
<td>
<p>data.frame with up to 6 columns:
</p>

<dl>
<dt>ID</dt>
<dd>
<p>max. 30 characters long</p>
</dd>
<dt>Sex</dt>
<dd>
<p>1 = female, 2 = male, 3 = unknown, 4 = hermaphrodite,
other numbers or NA = unknown</p>
</dd>
<dt>BirthYear </dt>
<dd>
<p>birth or hatching year, integer, with missing values as NA
or any negative number.</p>
</dd>
<dt>BY.min</dt>
<dd>
<p>minimum birth year, only used if BirthYear is missing</p>
</dd>
<dt>BY.max</dt>
<dd>
<p>maximum birth year, only used if BirthYear is missing</p>
</dd>
<dt>Year.last</dt>
<dd>
<p>Last year in which individual could have had offspring. Can
e.g. in mammals be the year before death for females, and year after death
for males. </p>
</dd> </dl>
<p>"Birth year" may be in any arbitrary discrete time unit relevant to the
species (day, month, decade), as long as parents are never born in the same
time unit as their offspring, and only integers are used. Individuals do not
need to be in the same order as in ‘GenoM’, nor do all genotyped individuals
need to be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AgePrior</code></td>
<td>
<p>a matrix with probability ratios for individuals with age
difference A to have relationship R, as generated by
<code>MakeAgePrior</code>. If <code>NULL</code>, <code>MakeAgePrior</code> is
called using its default values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function assists in estimating birth years of individuals for
which these are unknown, provided they have at least one parent or one
offspring in the pedigree. It is not a substitute for field-based estimates
of age, only a method to summarise the pedigree + birth year based
information.
</p>


<h3>Value</h3>

<p>A matrix with for each individual (rows) in the pedigree that has a missing
birth year in <code>LifeHistData</code>, or that is not included in
<code>LifeHistData</code>, the probability that it is born in <code>y</code> (columns).
Probabilities are rounded to 3 decimal points and may therefore not sum
exactly to 1.
</p>


<h3>WARNING</h3>

<p>Any errors in the pedigree or lifehistory data will cause errors in the
birth year probabilities of their parents and offspring, and putatively also
of more distant ancestors and descendants. If the ageprior is based on the
same erroneous pedigree and lifehistory data, all birth year probabilities
will be affected.
</p>


<h3>See Also</h3>

<p><code>MakeAgePrior</code> to estimate effect of age on
relationships.
</p>


<h3>Examples</h3>

<pre><code class="language-R">BYprobs &lt;- CalcBYprobs(Pedigree = SeqOUT_griffin$Pedigree,
                       LifeHistData = SeqOUT_griffin$LifeHist)
## Not run: 
# heatmap
lattice::levelplot(t(BYprobs), aspect="fill", col.regions=hcl.colors)

## End(Not run)

</code></pre>


</div>