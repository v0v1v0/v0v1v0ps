<div class="container">

<table style="width: 100%;"><tr>
<td>SkewHyperbolicDistribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Skewed Hyperbolic Student t-Distribution
</h2>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and random number
generation for the skew hyperbolic Student <em>t</em>-distribution, with
parameters <code class="reqn">\beta</code> (skewness), <code class="reqn">\delta</code>
(scale), <code class="reqn">\mu</code> (location) and <code class="reqn">\nu</code> (shape). Also a
function for the derivative of the density function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dskewhyp(x, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta,beta,nu), log = FALSE,
         tolerance = .Machine$double.eps^0.5)
pskewhyp(q, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu, delta, beta, nu), log.p = FALSE,
         lower.tail = TRUE, subdivisions = 100,
         intTol = .Machine$double.eps^0.25, valueOnly = TRUE, ...)
qskewhyp(p, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta, beta, nu),
         lower.tail = TRUE, log.p = FALSE,
         method = c("spline","integrate"),
         nInterpol = 501, uniTol = .Machine$double.eps^0.25,
         subdivisions = 100, intTol = uniTol, ...)
rskewhyp(n, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta,beta,nu), log = FALSE)
ddskewhyp(x, mu = 0, delta = 1, beta = 1, nu = 1,
          param = c(mu,delta,beta,nu),log = FALSE,
          tolerance = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of random variates to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br><code>c(mu,delta,beta,nu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log,log.p</code></td>
<td>
<p>Logical; if <code>log = TRUE</code>, probabilities are given as
log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character. If <code>"spline"</code> quantiles are found from a
spline approximation to the distribution function. If
<code>"integrate"</code>, the distribution function used is always obtained
by integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical. If <code>lower.tail = TRUE</code>, the cumulative
density is taken from the lower tail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Specified level of tolerance when checking if
parameter <code>beta</code> is equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density and determine the accuracy of the distribution
function calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intTol</code></td>
<td>
<p>Value of <code>rel.tol</code> and hence <code>abs.tol</code> in
calls to <code>integrate</code>. See <code>integrate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valueOnly</code></td>
<td>
<p>Logical. If <code>valueOnly = TRUE</code> calls to
<code>pskewhyp</code> only return the value obtained for the
integral. If <code>valueOnly = FALSE</code> an estimate of the
accuracy of the numerical integration is also returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInterpol</code></td>
<td>
<p>Number of points used in <code>qskewhyp</code> for cubic
spline interpolation of the distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniTol</code></td>
<td>
<p>Value of <code>tol</code> in
calls to <code>uniroot</code>. See <code>uniroot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passes additional arguments to <code>integrate</code> in
<code>pskewhyp</code> and <code>qskewhyp</code>, and to <code>uniroot</code> in
<code>qskewhyp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones. In addition the
parameter values are examined by calling the function
<code>skewhypCheckPars</code> to see if they are valid.
</p>
<p>The density function is
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{2^{(1-\nu)/2}\delta^\nu%latex
      |\beta|^{(\nu+1)/2}%
      K_{(\nu+1)/2}\sqrt{(\beta^2(\delta^2+(x-\mu)^2))}%
      \exp(\beta(x-\mu))}{\Gamma(\nu/2)\sqrt{(\pi)}%
      \sqrt{(\delta^2+(x-\mu)^2)^{(\nu+1)/2}}}</code>
</p>

<p>when <code class="reqn">\beta \ne 0</code>, and
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{\Gamma((\nu+1)/2)}{\sqrt{\pi}\delta%
      \Gamma(\nu/2)}\left(1+\frac{(x-\mu)^2}{\delta^2}\right)^%
    {-(\nu+1)/2} </code>
</p>

<p>when <code class="reqn">\beta = 0</code>, where <code class="reqn">K_{\nu}(.)</code> is the
modified Bessel function of the third kind with order <code class="reqn">\nu</code>,
and <code class="reqn">\Gamma(.)</code> is the gamma function.
</p>
<p><code>pskewhyp</code> uses the function <code>integrate</code> to
numerically integrate the density function. The integration is from
<code>-Inf</code> to <code>x</code> if <code>x</code> is to the left of the mode, and
from <code>x</code> to <code>Inf</code> if <code>x</code> is to the right of the
mode. The probability calculated this way is subtracted from 1 if
required. Integration in this manner appears to make calculation of
the quantile function more stable in extreme cases.
</p>
<p>Calculation of quantiles using <code>qhyperb</code> permits the use of two
different methods. Both methods use <code>uniroot</code> to find the value
of <code class="reqn">x</code> for which a given <code class="reqn">q</code> is equal <code class="reqn">F(x)</code> where <code class="reqn">F</code>
denotes the cumulative distribution function. The difference is in how
the numerical approximation to <code class="reqn">F</code> is obtained. The obvious
and more accurate method is to calculate the value of <code class="reqn">F(x)</code>
whenever it is required using a call to <code>phyperb</code>. This is what
is done if the method is specified as <code>"integrate"</code>. It is clear
that the time required for this approach is roughly linear in the
number of quantiles being calculated. A Q-Q plot of a large data set
will clearly take some time. The alternative (and default) method is
that for the major part of the distribution a spline approximation to
<code class="reqn">F(x)</code> is calculated and quantiles found using <code>uniroot</code> with
this approximation. For extreme values (for which the tail probability
is less than <code class="reqn">10^{-7}</code>), the integration method is still
used even when the method specifed is <code>"spline"</code>.
</p>
<p>If accurate probabilities or quantiles are required, tolerances
(<code>intTol</code> and <code>uniTol</code>) should be set to small values, say
<code class="reqn">10^{-10}</code> or <code class="reqn">10^{-12}</code> with <code>method
  = "integrate"</code>. Generally then accuracy might be expected to be at
least <code class="reqn">10^{-9}</code>. If the default values of the functions
are used, accuracy can only be expected to be around
<code class="reqn">10^{-4}</code>. Note that on 32-bit systems
<code>.Machine$double.eps^0.25 = 0.0001220703</code> is a typical value.
</p>
<p>Note that when small values of <code class="reqn">\nu</code> are used, and the density
is skewed, there are often some extreme values generated by
<code>rskewhyp</code>. These look like outliers, but are caused by the
heaviness of the skewed tail, see <b>Examples</b>.
</p>
<p>The extreme skewness of the distribution when <code class="reqn">\beta</code> is
large in absolute value and <code class="reqn">\nu</code> is small make this
distribution very challenging numerically.
</p>


<h3>Value</h3>

<p><code>dskewhyp</code> gives the density function, <code>pskewhyp</code> gives the
distribution function, <code>qskewhyp</code> gives the quantile function and
<code>rskewhyp</code> generates random variates.
</p>
<p>An estimate of the accuracy of the approximation to the distribution
function can be found by setting <code>valueOnly = FALSE</code> in the call to
<code>pskewyhp</code> which returns a list with components <code>value</code> and
<code>error</code>.
</p>
<p><code>ddskewhyp</code> gives the derivative of <code>dskewhyp</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275â€“309.
</p>


<h3>See Also</h3>

<p><code>safeIntegrate</code>,
<code>integrate</code> for its shortfalls,
<code>skewhypCheckPars</code>,
<code>logHist</code>. Also
<code>skewhypMean</code> for information on moments and mode, and
<code>skewhypFit</code> for fitting to data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">param &lt;- c(0,1,40,10)
par(mfrow = c(1,2))
range &lt;- skewhypCalcRange(param = param, tol = 10^(-2))

### curves of density and distribution
curve(dskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Density of the \n Skew Hyperbolic Distribution")
curve(pskewhyp(x, param = param),
      range[1], range[2], n = 500)
title("Distribution Function of the \n Skew Hyperbolic Distribution")

### curves of density and log density
par(mfrow = c(1,2))
data &lt;- rskewhyp(1000, param = param)
curve(dskewhyp(x, param = param), range(data)[1], range(data)[2],
      n = 1000, col = 2)
hist(data, freq = FALSE, add = TRUE)
title("Density and Histogram of the\n Skew Hyperbolic Distribution")
DistributionUtils::logHist(data, main =
  "Log-Density and Log-Histogram of\n the Skew Hyperbolic Distribution")
curve(dskewhyp(x, param = param, log = TRUE),
      range(data)[1], range(data)[2],
      n = 500, add = TRUE, col = 2)

##plots of density and derivative
par(mfrow = c(2,1))
curve(dskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Density of the Skew\n Hyperbolic Distribution")
curve(ddskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Derivative of the Density\n of the Skew Hyperbolic Distribution")

##  example of density and random numbers for beta large and nu small
par(mfrow = c(1,2))
param1 &lt;- c(0,1,10,1)
data1 &lt;- rskewhyp(1000, param = param1)
curve(dskewhyp(x, param = param1), range(data1)[1], range(data1)[2],
      n = 1000, col = 2, main = "Density and Histogram -- when nu is small")
hist(data1, freq = FALSE, add = TRUE)

DistributionUtils::logHist(data1, main =
      "Log-Density and Log-Histogram -- when nu is small")
curve(dskewhyp(x, param = param1, log = TRUE),
      from = min(data1), to = max(data1), n = 500, add = TRUE, col = 2)
</code></pre>


</div>