<div class="container">

<table style="width: 100%;"><tr>
<td>scglrTheme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function that fits the theme model</h2>

<h3>Description</h3>

<p>Calculates the components to predict all the dependent variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scglrTheme(formula, data, H, family, size = NULL, weights = NULL,
  offset = NULL, subset = NULL, na.action = na.omit, crit = list(),
  method = methodSR(), st = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>MultivariateFormula</code>" (or one that can be coerced
to that class): a symbolic description of the model to be fitted. The details
of model specification are given under Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>vector of R integer. Number of components to keep for each theme</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a vector of character of the same length as the number of dependent variables:
"bernoulli", "binomial", "poisson" or "gaussian" is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>describes the number of trials for the binomial dependent variables.
A (number of statistical units * number of binomial dependent variables) matrix is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights on individuals (not available for now)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>used for the poisson dependent variables.
A vector or a matrix of size: number of observations * number of Poisson dependent variables is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default is set to <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>a list of two elements : maxit and tol, describing respectively the maximum number of iterations and
the tolerance convergence criterion for the Fisher scoring algorithm. Default is set to 50 and 10e-6 respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>structural relevance criterion. Object of class "method.SCGLR"
built by  <code>methodSR</code> for Structural Relevance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>logical (FALSE) theme build and fit order. TRUE means random, FALSE means sequential (T1, ..., Tr)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Models for theme are specified symbolically. A model as the form <code>response ~ terms</code> where <code>response</code>
is the numeric response vector and terms is a series of R themes composed of
predictors. Themes are separated by  "|" (pipe) and are composed. ... Y1+Y2+...
~ X11+X12+...+X1_  | X21+X22+... | ...+X1_+...  | A1+A2+... See <code>multivariateFormula</code>.
</p>


<h3>Value</h3>

<p>a list of SCGLRTHM class. Each element is a SCGLR object
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(SCGLR)

# load sample data
data(genus)

# get variable names from dataset
n &lt;- names(genus)
n &lt;-n[!n%in%c("geology","surface","lon","lat","forest","altitude")]
ny &lt;- n[grep("^gen",n)]    # Y &lt;- names that begins with "gen"
nx1 &lt;- n[grep("^evi",n)]   # X &lt;- remaining names
nx2 &lt;- n[-c(grep("^evi",n),grep("^gen",n))]


form &lt;- multivariateFormula(ny,nx1,nx2,A=c("geology"))
fam &lt;- rep("poisson",length(ny))
testthm &lt;-scglrTheme(form,data=genus,H=c(2,2),family=fam,offset = genus$surface)
plot(testthm)

## End(Not run)
</code></pre>


</div>