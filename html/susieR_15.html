<div class="container">

<table style="width: 100%;"><tr>
<td>single_effect_regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian single-effect linear regression</h2>

<h3>Description</h3>

<p>These methods fit the regression model <code class="reqn">y = Xb +
  e</code>, where elements of e are <em>i.i.d.</em>  <code class="reqn">N(0,s^2)</code>, and b is
a p-vector of effects to be estimated. The assumption is that b has
exactly one non-zero element, with all elements equally likely to
be non-zero. The prior on the coefficient of the non-zero element
is <code class="reqn">N(0,V)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">single_effect_regression(
  y,
  X,
  V,
  residual_variance = 1,
  prior_weights = NULL,
  optimize_V = c("none", "optim", "uniroot", "EM", "simple"),
  check_null_threshold = 0
)

single_effect_regression_rss(
  z,
  Sigma,
  V = 1,
  prior_weights = NULL,
  optimize_V = c("none", "optim", "uniroot", "EM", "simple"),
  check_null_threshold = 0
)

single_effect_regression_ss(
  Xty,
  dXtX,
  V = 1,
  residual_variance = 1,
  prior_weights = NULL,
  optimize_V = c("none", "optim", "uniroot", "EM", "simple"),
  check_null_threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An n-vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An n by p matrix of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>A scalar giving the (initial) prior variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual_variance</code></td>
<td>
<p>The residual variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_weights</code></td>
<td>
<p>A p-vector of prior weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize_V</code></td>
<td>
<p>The optimization method to use for fitting the
prior variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_null_threshold</code></td>
<td>
<p>Scalar specifying threshold on the
log-scale to compare likelihood between current estimate and zero
the null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A p-vector of z scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p><code>residual_var*R + lambda*I</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xty</code></td>
<td>
<p>A p-vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dXtX</code></td>
<td>
<p>A p-vector containing the diagonal elements of
<code>crossprod(X)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>single_effect_regression_ss</code> performs single-effect
linear regression with summary data, in which only the statistcs
<code class="reqn">X^Ty</code> and diagonal elements of <code class="reqn">X^TX</code> are provided to the
method.
</p>
<p><code>single_effect_regression_rss</code> performs single-effect linear
regression with z scores. That is, this function fits the
regression model <code class="reqn">z = R*b + e</code>, where e is <code class="reqn">N(0,Sigma)</code>,
<code class="reqn">Sigma = residual_var*R + lambda*I</code>, and the b is a p-vector of
effects to be estimated. The assumption is that b has exactly one
non-zero element, with all elements equally likely to be non-zero.
The prior on the non-zero element is <code class="reqn">N(0,V)</code>. The required
summary data are the p-vector <code>z</code> and the p by p matrix
<code>Sigma</code>. The summary statistics should come from the same
individuals.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Vector of posterior inclusion probabilities;
<code>alpha[i]</code> is posterior probability that the ith coefficient
is non-zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Vector of posterior means (conditional on inclusion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu2</code></td>
<td>
<p>Vector of posterior second moments (conditional on
inclusion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbf</code></td>
<td>
<p>Vector of log-Bayes factors for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbf_model</code></td>
<td>
<p>Log-Bayes factor for the single effect regression.</p>
</td>
</tr>
</table>
<p><code>single_effect_regression</code> and <code>single_effect_regression_ss</code>
additionally output:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Prior variance (after optimization if <code>optimize_V !=
  "none"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The log-likelihood, <code class="reqn">\log p(y | X, V)</code>.</p>
</td>
</tr>
</table>
</div>