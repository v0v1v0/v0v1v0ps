<div class="container">

<table style="width: 100%;"><tr>
<td>stepAheadWn2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple simulation of trajectory ends of the WN or MvM diffusion in 2D</h2>

<h3>Description</h3>

<p>Simulates <code>M</code> trajectories starting from different initial values <code>x0</code> of the WN or MvM diffusion in 2D, by the Euler method, and returns their ends.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepAheadWn2D(x0, mu, A, sigma, rho = 0, M = 100L, N = 100L,
  delta = 0.01, type = 1L, maxK = 2L, expTrc = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>matrix of size <code>c(nx0, 2)</code> giving the initial points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a vector of length <code>2</code> giving the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>drift matrix of size <code>c(2, 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of length <code>2</code> containing the <strong>square root</strong> of the diagonal of <code class="reqn">\Sigma</code>, the diffusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of <code class="reqn">\Sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of Monte Carlo replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of discretization steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>discretization step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>integer giving the type of diffusion. Currently, only <code>1</code> for WN and <code>2</code> for vM are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>maximum absolute value of the windings considered in the computation of the WN.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expTrc</code></td>
<td>
<p>truncation for exponential: <code>exp(x)</code> with <code>x &lt;= -expTrc</code> is set to zero. Defaults to <code>30</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An array of size <code>c(nx0, 2, M)</code> containing the <code>M</code> trajectory ends for each starting value <code>x0</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 100
nx0 &lt;- 3
x0 &lt;- seq(-pi, pi, l = nx0 + 1)[-(nx0 + 1)]
x0 &lt;- as.matrix(expand.grid(x0, x0))
nx0 &lt;- nx0^2
set.seed(12345678)
samp1 &lt;- euler2D(x0 = x0, mu = c(0, 0), A = rbind(c(3, 1), 1:2),
                 sigma = c(1, 1), N = N, delta = 0.01, type = 2)
plot(x0[, 1], x0[, 2], xlim = c(-pi, pi), ylim = c(-pi, pi), pch = 16,
     col = rainbow(nx0))
for (i in 1:nx0) linesTorus(samp1[i, 1, ], samp1[i, 2, ],
                           col = rainbow(nx0, alpha = 0.75)[i])
set.seed(12345678)
samp2 &lt;- stepAheadWn2D(x0 = x0, mu = c(0, 0), A = rbind(c(3, 1), 1:2),
                       sigma = c(1, 1), M = 2, N = N, delta = 0.01,
                       type = 2)
points(samp2[, 1, 1], samp2[, 2, 1], pch = 16, col = rainbow(nx0))
samp1[, , N + 1]
samp2[, , 1]
</code></pre>


</div>