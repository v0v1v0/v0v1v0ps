<div class="container">

<table style="width: 100%;"><tr>
<td>get_areas_near_coordinates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a tibble of census areas closest to a user-specified center</h2>

<h3>Description</h3>

<p>Returns a <code>tibble</code> containing the census areas whose
centers of population are closest to some user-specified center. To specify
the center, the user can manually enter longitude/latitude coordinates or use
the helper function <code>lon_lat_from_area()</code> to automatically grab the
longitude/latitude coordinates of the center of population of an area. The
cutoff point for how many areas will be return depends on the function used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">areas_in_radius(
  geography = c("state", "county", "tract", "block group"),
  center = lon_lat_from_area(state = "DC"),
  radius = 5,
  units = "miles",
  measure_from = "center of population",
  year = 2020,
  distance_fun = geosphere::distVincentyEllipsoid,
  batch_size = 50L
)

closest_n_areas(
  geography = c("state", "county", "tract", "block group"),
  center = lon_lat_from_area(state = "DC"),
  n = 50,
  measure_from = "center of population",
  year = 2020,
  distance_fun = geosphere::distVincentyEllipsoid,
  units = NULL,
  batch_size = 50L
)

closest_population(
  geography = c("state", "county", "tract", "block group"),
  center = lon_lat_from_area(state = "DC"),
  population = 1e+06,
  measure_from = "center of population",
  year = 2020,
  distance_fun = geosphere::distVincentyEllipsoid,
  units = NULL,
  batch_size = 50L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geography</code></td>
<td>
<p>The type of census areas that the resulting table will
contain. One of <code>c("state", "county", "tract", "block group")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>The longitude/latitude coordinates of the center of the circle.
A double vector of length 2 whose elements are finite numbers. Passed to
the <code>y</code> argument of <code>geosphere::distm()</code>.
</p>
<p>The first element is the longitude coordinate (positive for west, negative
for east). The second element is the latitude coordinate (positive for
north, negative for south).
</p>
<p>The convenience function <code>lon_lat_from_area()</code> can be used to obtain the
longitude/latitude coordinates of the center of population of a
user-specified census area.
</p>
<p>Defaults to the center of population of the District of Columbia according
to the 2020 decennial census.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>A single, non-negative number specifying the radius of the
circle. Defaults to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>A single string specifying the units of the resulting <code>distance</code>
column. If <code>NULL</code>, the <code>units</code> package does not need to be installed, and
units will be meters. Otherwise, this will be passed to the <code>value</code>
argument of <code>units::set_units</code><code>(mode = "standard")</code>.
</p>
<p>For <code>areas_in_radius()</code>, this also used for the units of <code>radius</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure_from</code></td>
<td>
<p>Currently can only be <code>"center of population"</code>, the
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Must be 2020, 2010, or 2000. Defaults to 2020.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_fun</code></td>
<td>
<p>Passed to the <code>fun</code> argument of <code>geosphere::distm()</code>.
Defaults to <code>geosphere::distVincentyEllipsoid</code>, which results in the most
accurate measurement but is also the slowest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>The number of distances calculated in each iterative call
to <code>geosphere::distm()</code>. When the request is satisfied, these functions
stop calculating distances in order to prevent potentially hundreds of
thousands of unnecessary calculations. Defaults to 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A single positive integer specifying how many of the areas closest
to <code>center</code> should be gathered. Defaults to 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>A single positive integer specifying the target total
population of the areas returned. See <strong>Details</strong>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>areas_in_radius()</code> returns all areas whose centers of population are within
the user-specified <code>radius</code> around <code>center</code>.
</p>
<p><code>closest_n_areas()</code> returns the top <code>n</code> areas whose centers of population are
closest areas to <code>center</code>.
</p>
<p>Conceptually, <code>closest_population()</code> sequentially gathers the next closest
area to <code>center</code> until the total population of the areas meets or exceeds
<code>population</code>.
</p>
<p>Distances are determined with <code>geosphere::distm()</code>.
</p>
<p>Requires the packages <code>USpopcenters</code> and <code>geosphere</code> to be installed.
Requires the <code>units</code> to be installed unless <code>units = NULL</code>.
</p>
<p>Centers of population are based on the decennial census data. Only states,
counties, tracts, and block groups are currently supported. See the
documentation of the <code>USpopcenters</code> package and
<a href="https://www.census.gov/geographies/reference-files/time-series/geo/centers-population.html">https://www.census.gov/geographies/reference-files/time-series/geo/centers-population.html</a>
for more information.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> with each of the columns found in the
corresponding <code>USpopcenters</code> table, with two columns appended:
</p>
<p><code>geoid</code> - all FIPS code columns combined with <code>paste0()</code>.
</p>
<p><code>distance</code> - the number of <code>units</code> the area's <code>LONGITUDE</code>/<code>LATITUDE</code> center
of population is away from the coordinates given in <code>center</code>.
</p>


<h3>See Also</h3>

<p><code>lon_lat_from_area()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("USpopcenters", quietly = TRUE) &amp;&amp;
  requireNamespace("geosphere", quietly = TRUE)) {

# All states whose centers of population are within 300 kilometers of the
# center of population of New York County, New York (i.e, Manhattan):
areas_in_radius(
  geography = "state",
  center = lon_lat_from_area(state = "NY", county = "New York"),
  radius = 300,
  units = "km"
)

# The four census tracts whose centers of population are closest to the
# Four Corners (distance column is in meters due to setting units = NULL):
closest_n_areas("tract", center = c(-109.0452, 36.9991), n = 4, units = NULL)

# The counties closest to center of population of Kauai County, Hawaii whose
# total population reaches 3 million people:
closest_population(
  geography = "county",
  center = lon_lat_from_area("15007"),
  population = 3e6,
  units = "barleycorns"
)

}
</code></pre>


</div>