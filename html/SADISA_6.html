<div class="container">

<table style="width: 100%;"><tr>
<td>SADISA_ML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs maximum likelihood parameter estimation for requested model</h2>

<h3>Description</h3>

<p>Computes maximum loglikelihood and corresponding parameters for the requested model using the independent-species approach.
For optimization it uses various auxiliary functions in the DDD package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SADISA_ML(abund, initpars, idpars, labelpars, model = c("pm", "dl"),
  mult = "single", tol = c(1e-06, 1e-06, 1e-06), maxiter = min(1000 *
  round((1.25)^sum(idpars)), 1e+05), optimmethod = "subplex",
  num_cycles = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abund</code></td>
<td>
<p>abundance vector or a list of abundance vectors.
When a list is provided and mult = 'mg' (the default), it is assumed that the different vectors
apply to different guilds. When mult = 'ms' then the different vectors apply to multiple samples.
from the same metacommunity. In this case the vectors should have equal lengths and may contain
zeros because there may be species that occur in multiple samples and species that do not occur
in some of the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initpars</code></td>
<td>
<p>a vector of initial values of the parameters to be optimized and fixed. See <code>labelpars</code>
for more explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idpars</code></td>
<td>
<p>a vector stating whether the parameters in <code>initpars</code> should be optimized (1) or
remain fixed (0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelpars</code></td>
<td>
<p>a vector, a list of vectors or a list of lists of vectors indicating the labels
integers (starting at 1) of the parameters to be optimized and fixed. These integers correspond to
the position in <code>initpars</code> and <code>idpars</code>. The order of the labels in
the vector/list is first the metacommunity parameters (theta, and phi (for protracted speciation) or alpha
(for density-dependence or abundance-dependent speciation)), then the dispersal parameters (I).
See the example and the vignette for more explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the chosen combination of metacommunity model and local community model
as a vector, e.g. c('pm','dl') for a model with point mutation in the metacommunity and
dispersal limitation.
The choices for the metacommunity model are: 'pm' (point mutation), 'rf' (random fission),
'pr' (protracted speciation), 'dd' (density-dependence).
The choices for the local community model are: 'dl' (dispersal limitation), 'dd' (density-dependence).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult</code></td>
<td>
<p>When set to 'single' (the default), the loglikelihood for a single sample and single guild
is computed. When set to 'mg', the loglikelihood for multiple guilds is computed.
When set to 'ms' the loglikelihood for multiple samples from the same metacommunity is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a vector containing three numbers for the relative tolerance in the parameters, the relative tolerance in the function, and the absolute tolerance in the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>sets the maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimmethod</code></td>
<td>
<p>sets the optimization method to be used, either subplex (default) or an alternative implementation of simplex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cycles</code></td>
<td>
<p>the number of cycles of opimization. If set at Inf, it will do as many cycles as needed to meet the tolerance set for the target function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Not all combinations of metacommunity model and local community model have been implemented yet.
because this requires checking for numerical stability of the integration. The currently available model combinations are, for a single sample, c('pm','dl'), c('pm','rf'), c('dd','dl'),
c('pr','dl'), c('pm','dd'), and for multiple samples, c('pm','dl').
</p>


<h3>References</h3>

<p>Haegeman, B. &amp; R.S. Etienne (2017). A general sampling formula for community structure data. Methods in Ecology &amp; Evolution 8: 1506-1519. doi: 10.1111/2041-210X.12807
</p>


<h3>Examples</h3>

<pre><code class="language-R">utils::data(datasets);
utils::data(fitresults);
result &lt;- SADISA_ML(
   abund = datasets$dset1.abunvec[[1]],
   initpars = fitresults$fit1a.parsopt[[1]],
   idpars = c(1,1),
   labelpars = c(1,2),
   model = c('pm','dl'),
   tol = c(1E-1, 1E-1, 1E-1)
   );
# Note that tolerances should be set much lower than 1E-1 to get the best results.
</code></pre>


</div>