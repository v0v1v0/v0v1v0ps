<div class="container">

<table style="width: 100%;"><tr>
<td>randomHabitat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Landscape</h2>

<h3>Description</h3>

<p>The Modified Random Cluster algorithm of Saura and Martinez-Millan
(2000) is used to generate a mask object representing patches of
contiguous ‘habitat’ cells (pixels) within a ‘non-habitat’
matrix (‘non-habitat’ cells are optionally dropped). Spatial autocorrelation
(fragmentation) of habitat patches is controlled via the parameter
‘p’. ‘A’ is the expected proportion of ‘habitat’ cells.
</p>
<p><code>randomDensity</code> is a wrapper for <code>randomHabitat</code> that may be used as input to <code>sim.popn</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
randomHabitat(mask, p = 0.5, A = 0.5, directions = 4, minpatch = 1,
drop = TRUE, covname = "habitat", plt = FALSE, seed = NULL)

randomDensity(mask, parm)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>secr mask object to use as template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>parameter to control fragmentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>parameter for expected proportion of habitat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directions</code></td>
<td>
<p>integer code for adjacency (rook's move 4 or queen's move 8)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpatch</code></td>
<td>
<p>integer minimum size of patch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical for whether to drop non-habitat cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covname</code></td>
<td>
<p>character name of covariate when <code>drop = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p>logical for whether intermediate stages should be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>either NULL or an integer that will be used in a call to <code>set.seed</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>list of arguments for <code>randomHabitat</code>, with added argument D</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Habitat is simulated within the region defined by the cells of
mask. The region may be non-rectangular.
</p>
<p>The algorithm comprises stages A-D:
</p>
<p>A. Randomly select proportion <code>p</code> of cells from the input mask
</p>
<p>B. Cluster selected cells with any immediate neighbours as defined by
<code>directions</code>
</p>
<p>C. Assign clusters to ‘non-habitat’ (probability 1–A) and ‘habitat’
(probability A)
</p>
<p>D. Cells not in any cluster from (B) receive the habitat class of the
majority of the &lt;=8 adjacent cells assigned in (C), if there are any;
otherwise they are assigned at random (with probabilities 1–A, A).
</p>
<p>Fragmentation declines, and cluster size increases, as p increases up to the
‘percolation threshold’ which is about 0.59 in the default case (Saura
and Martinez-Millan 2000 p.664).
</p>
<p>If <code>minpatch &gt; 1</code> then habitat patches of less than <code>minpatch</code>
cells are converted to non-habitat, and vice versa. This is likely to
cause the proportion of habitat to deviate from <code>A</code>.
</p>
<p>If <code>drop = FALSE</code> a binary-valued (0/1) covariate with the
requested name is included in the output mask, which has the same extent
as the input. Otherwise, non-habitat cells are dropped and no covariate
is added.
</p>
<p>The argument ‘parm’ for <code>randomDensity</code> is a list with average density D and an optional subset of named values to override the defaults (p = 0.5, A = 0.5, directions = 4, minpatch = 1, plt = FALSE, seed = NULL). ‘rescale’ is a further optional component of ‘parm’; if ‘rescale = TRUE’ then the pixel-specific densities are adjusted upwards by the factor 1/A to maintain the same expected number of activity centres as if the nominal density applied throughout. Arguments ‘mask’ and ‘drop’ of <code>randomHabitat</code> are substituted automatically.  
</p>


<h3>Value</h3>

<p>For randomHabitat –
</p>
<p>An object of class ‘mask’. By default (<code>drop = TRUE</code>) this
has fewer rows (points) than the input mask.
</p>
<p>The attribute “type” is a character string formed from <code>paste('MRC p=',p, ' A=',A, sep='')</code>.
</p>
<p>The RNG seed is stored as attribute ‘seed’ (see secrRNG).
</p>
<p>For randomDensity –
</p>
<p>A vector of cell-specific densities.
</p>


<h3>Note</h3>

<p>Single-linkage clustering and adjacency operations use functions
‘clump’ and ‘adjacency’ of the package <span class="pkg">raster</span>; ‘clump’ also
requires package <span class="pkg">igraph0</span> (<span class="pkg">raster</span> still uses this
deprecated version). Optional plotting
of intermediate stages (<code>plt = TRUE</code>) uses the plot method for
rasterLayers in <span class="pkg">raster</span>.
</p>
<p>A non-rectangular input mask is padded out to a rectangular rasterLayer
for operations in <span class="pkg">raster</span>; cells added as padding are ultimately
dropped.
</p>
<p>The procedure of Saura and Martinez-Millan (2000) has been followed as
far as possible, but this implementation may not match theirs in every
detail.
</p>
<p>This implementation allows only two habitat classes. The parameter A is
the <em>expected</em> value of the habitat proportion; the
<em>realised</em> habitat proportion may differ quite strongly from A,
especially for large p (e.g., p &gt; 0.5).
</p>
<p>Anisotropy is not implemented; it would require skewed adjacency
filters (i.e. other than rook- or queen-move filters) that are not
available in <span class="pkg">raster</span>.
</p>
<p>Gaussian random fields provide an alternative method for simulating 
random habitats (e.g., rLGCP option in <code>sim.popn</code>).
</p>


<h3>References</h3>

<p>Hijmans, R. J. and van Etten, J. (2011) raster: Geographic analysis and
modeling with raster data. R package version 1.9-33.
<a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>.
</p>
<p>Saura, S. and Martinez-Millan, J. (2000) Landscape patterns simulation
with a modified random clusters method. <em>Landscape Ecology</em>,
<b>15</b>, 661–678.
</p>


<h3>See Also</h3>

<p><code>mask</code>, <code>make.mask</code>, <code>sim.popn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

tempmask &lt;- make.mask(nx = 100, ny = 100, spacing = 20)
mrcmask &lt;- randomHabitat(tempmask, p = 0.4, A = 0.4)
plot(mrcmask, dots = FALSE, col = "green")
pop &lt;- sim.popn(10, mrcmask, model2D = "IHP")
plot(pop, add = TRUE)

# OR
plot(sim.popn(D = randomDensity, core = tempmask, model2D = "IHP",
    details = list(D = 10, p = 0.4, A = 0.4, plt = TRUE)), 
    add = TRUE, frame = FALSE)

## plot intermediate steps A, C, D
opar &lt;- par(mfrow = c(1,3))
mrcmask &lt;- randomHabitat(tempmask, p = 0.4, A = 0.4, plt = TRUE)
par(opar) 

## keep non-habitat cells
mrcmask &lt;- randomHabitat(tempmask, p = 0.4, A = 0.4, drop = FALSE)
plot(mrcmask, covariate = "habitat", dots = FALSE,
    col = c("grey","green"), breaks = 2)

## effect of purging small patches
opar &lt;- par(mfrow=c(1,2))
mrcmask &lt;- randomHabitat(tempmask, p = 0.4, A = 0.4, minpatch = 1)
plot(mrcmask, dots = FALSE, col  ="green")
mrcmask &lt;- randomHabitat(tempmask, p = 0.4, A = 0.4, minpatch = 5)
plot(mrcmask, dots = FALSE, col  ="green")
par(opar)

## End(Not run)

</code></pre>


</div>