<div class="container">

<table style="width: 100%;"><tr>
<td>squaredIntEstim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Squared integral estimate
</h2>

<h3>Description</h3>

<p>This function provides two estimators of a squared expectation. 
The first one, naive, is the square of the sample mean. It is positively biased.
The second one is a U-statistics, and unbiased. The two are equivalent for large sample sizes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">squaredIntEstim(x, method = "unbiased")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of observations supposed to be drawn independently from a square integrable random variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>If "unbiased", computes the U-statistics, otherwise the square of the sample mean is computed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let X1, ..., Xn be i.i.d. random variables. The aim is to estimate t = E(Xi)^2.
The naive estimator is the square of the sample mean: T1 = [(X1 + ... + Xn)/n]^2.
It is positively biased, and the bias is equal to s^2/n, where s^2 = var(X1).
The U-statistics estimator is the average of Xi * Xj over all unordered pairs (i,j).
Equivalently, it is equal to T1 minus the (unbiased) sample variance divided by n.
</p>


<h3>Value</h3>

<p>A real number, corresponding to the estimated value of the squared integral.
</p>


<h3>Author(s)</h3>

<p>O. Roustant
</p>


<h3>References</h3>

<p>O. Roustant, F. Gamboa and B. Iooss, <em>Parseval inequalities and lower bounds for 
variance-based sensitivity indices</em>, Electronic Journal of Statistics, 14:386-412, 2020
</p>
<p>Van der Vaart, A. W. Asymptotic statistics. Vol. 3. Cambridge university press, 2000.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 100  # sample size
nsim &lt;- 100 # number of simulations
mu &lt;- 0

T &lt;- Tunb &lt;- rep(NA, nsim)
theta &lt;- mu^2  # E(X)^2, with X following N(mu, 1)

for (i in 1:nsim){
  x &lt;- rnorm(n, mean = mu, sd = 1)
  T[i] &lt;- squaredIntEstim(x, method = "biased")
  Tunb[i] &lt;- squaredIntEstim(x, method = "unbiased")
}

par(mfrow = c(1, 1))
boxplot(cbind(T, Tunb))
abline(h = theta, col = "red")
abline(h = c(mean(T), mean(Tunb)), col = c("blue", "cyan"), lty = "dotted")
# look at the difference between median and mean
</code></pre>


</div>