<div class="container">

<table style="width: 100%;"><tr>
<td>peak.cell</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify local maxima or minima</h2>

<h3>Description</h3>

<p>Identify local maxima or minima on a raster surface.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peak.cell(attTbl, ngbList, rNumb = FALSE, p_col, p_fun = "max", p_edge = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>attTbl</code></td>
<td>
<p>data.frame, the attribute table returned by the function
<code>attTbl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngbList</code></td>
<td>
<p>list, the list of neighborhoods returned by the function
<code>ngbList</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rNumb</code></td>
<td>
<p>logic, the neighborhoods of the argument <code>ngbList</code> are
identified by cell numbers (<code>rNumb=FALSE</code>) or by row numbers
(<code>rNumb=TRUE</code>) (see <code>ngbList</code>). It is advised to use row
numbers for large rasters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_col</code></td>
<td>
<p>character, the column of the attribute table over which maxima
or minima are searched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_fun</code></td>
<td>
<p>character, if 'max' the function searches for local maxima; if
'min' the function searches for local minima.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_edge</code></td>
<td>
<p>logic, if false local maxima or minima are not searched on edge
cells. Edge cells are considered cells on the edge of the raster and cell
neighboring NA-cells.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 <ul>
<li>
<p> A cell constitutes a <em>local maximum</em> if its
elevation value is larger than the values of all the cells in its
neighborhood (see <code>ngbList</code>).
</p>
</li>
<li>
<p> A cell constitutes a <em>local minimum</em> if its elevation value is
smaller than the values of all the cells in its neighborhood (see
<code>ngbList</code>).</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>classVector</code> with peak cells identified by the numeric class
<code>1</code>. See <code>conditions</code> for more details about class
vectors.
</p>


<h3>See Also</h3>

<p><code>conditions()</code>, <code>attTbl()</code>, <code>ngbList()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># DUMMY DATA
################################################################################
# LOAD LIBRARIES
library(scapesClassification)
library(terra)

# LOAD THE DUMMY RASTER
r &lt;- list.files(system.file("extdata", package = "scapesClassification"),
                pattern = "dummy_raster\\.tif", full.names = TRUE)
r &lt;- terra::rast(r)

# COMPUTE THE ATTRIBUTE TABLE
at &lt;- attTbl(r, "dummy_var")

# COMPUTE THE LIST OF NEIGBORHOODS
nbs &lt;- ngbList(r)
################################################################################

# PEAK.CELL
################################################################################
# p_edge = FALSE
pc_a &lt;- peak.cell(attTbl = at, ngbList = nbs, rNumb = FALSE,
                  p_col = "dummy_var", p_fun = "max", p_edge = FALSE)

# p_edge = TRUE
pc_b &lt;- peak.cell(attTbl = at, ngbList = nbs, rNumb = FALSE,
                  p_col = "dummy_var", p_fun = "max", p_edge = TRUE)

# CONVERT THE CLASS VECTORS INTO RASTERS
r_pca &lt;- cv.2.rast(r, at$Cell, classVector = pc_a, plot = FALSE)
r_pcb &lt;- cv.2.rast(r, at$Cell, classVector = pc_b, plot = FALSE)
################################################################################

#PLOTS
###############################################################################
oldpar &lt;- par(mfrow = c(1,2))
m &lt;- c(4, 1, 4, 1)

# PLOT 1 - p_edge = FALSE
plot(r_pca, axes=FALSE, legend=FALSE, asp=NA, mar=m,
     colNA="#818792", col=c("#78b2c4", "#cfad89"))
text(r)
mtext(side=3, line=1, adj=0, cex=1, font=2, "PEAK.CELL")
mtext(side=3, line=0, adj=0, cex=0.9, "p_edge = FALSE")
legend("bottomright", bg = "white",
       legend = c("Peak cell", "Unclassified cells"),
       fill = c("#cfad89", "#818792"))

# PLOT 2 - p_edge = TRUE
plot(r_pcb, axes=FALSE, legend=FALSE, asp=NA, mar=m,
    colNA="#818792", col=c("#78b2c4", "#cfad89"))
text(r)
mtext(side=3, line=1, adj=0, cex=1, font=2, "PEAK.CELL")
mtext(side=3, line=0, adj=0, cex=0.9, "p_edge = TRUE")
legend("bottomright", bg = "white",
       legend = c("Peak cell", "Unclassified cells"),
       fill = c("#cfad89", "#818792"))
par(oldpar)
</code></pre>


</div>