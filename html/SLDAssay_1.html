<div class="container">

<table style="width: 100%;"><tr>
<td>get.mle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>IUPM, PGOF, and CI</h2>

<h3>Description</h3>

<p>Calculates the maximum likelihood estimate of concentration of infectious units
from a single serial limiting dilution (SLD) assay. Also calculates corresponding
exact and asymptotic confidence intervals, and a goodness-of-fit p-value. While
this package was developed with the purpose of estimating IUPM, it is applicable to SLD
assays in general.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.mle(pos, replicates, dilutions, monte = 15000, conf.level = 0.95,
  iupm = TRUE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>Vector of number of positive wells at each dilution level (outcome of SLD Assay)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>Vector of number of replicates at each dilution level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dilutions</code></td>
<td>
<p>Vector of number of cells per well at each dilution level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monte</code></td>
<td>
<p>Number of Monte Carlo samples. Default is exact (no MC sampling), unless
more than 15,000 possible positive well outcomes exist, in which case 15,000 MC samples are taken.
Use monte=F for exact computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iupm</code></td>
<td>
<p>Boolean variable, indicates whether to return MLE as IUPM (TRUE) or probability a cell is infected (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Boolean variable, indicates whether dilution levels valued NA should be stripped before the computation proceeds (FALSE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MLE</code></td>
<td>
<p>Maximum likelihood estimate for the given outcome vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BC_MLE</code></td>
<td>
<p>Bias corrected maximum likelihood estimate for the given outcome vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exact_PGOF</code></td>
<td>
<p>P value for goodness of fit. PGOF is the probability of an
experimental result as rare as or rarer than that obtained, assuming that the model is
correct. Low values of PGOF, (e.g. PGOF &lt; 0.01), indicate rare or implausible experimental
results. Samples with a very low PGOF might be considered for retesting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Asymp_PGOF</code></td>
<td>
<p>P value calculated using an asymptotic Chi-Squared distribution with D-1 degrees of freedom,
where D is the number of dilution levels in an SLD assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exact_CI</code></td>
<td>
<p>Exact confidence interval, computed from the likelihood ratio test (recommended)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Asymp_CI</code></td>
<td>
<p>Wald asymptotic confidence interval, based on the normal approximation to the binomial distribution.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Myers, L. E., McQuay, L. J., &amp; Hollinger, F. B. (1994). Dilution assay statistics.
Journal of Clinical Microbiology, 32(3), 732-739. DOI:10.1.1.116.1568
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Duplicates row 4 of Table 4 from Myers, et. al.
# Myers et. al. divides IUPM space into discrete values. This package searches
# entire parameter space, yielding a slightly different and more accurate MLE.
row4 &lt;- get.mle(pos=c(2,1,0,0,0,0),  # Number of positive wells per dilution level
                 replicates=rep(2,6), # Number of replicates per dilution level
                 dilutions=c(1e6,2e5,4e4,8e3,1600,320), # Cells per dilution level
                 conf.level=0.95,   # Significance level
                 iupm=TRUE,            # Display MLE in infected units per million
                 )

# Duplicates row 21 of Table 4 from Myers, et. al.
# Low PGOF example
# Myers et. al. divides IUPM space into discrete values. This package searches
# entire parameter space, yielding a slightly different and more accurate MLE.
row21 &lt;- get.mle(pos=c(2,2,2,0,1,0),
                 replicates=rep(2,6),
                 dilutions=c(1e6,2e5,4e4,8e3,1600,320),
                 conf.level=0.95,
                 iupm=TRUE)
                 
# Example calculating IUs per cell for an assay with 1 DL.
 iu.example &lt;- get.mle(pos=7, replicates=8, dilutions=25,
                       conf.level=0.95, iupm=FALSE)

# Monte Carlo example
# 67,081 total possible positive well outcomes, therefore
# Monte Carlo sampling is used to reduce computation time.
MC.example &lt;- get.mle(pos=c(30,9,1,0),
                       replicates=c(36,36,6,6),
                       dilutions=c(2.5e6,5e5,1e5,2.5e4),
                       conf.level=0.95,
                       monte = 5000,
                       iupm=TRUE )
</code></pre>


</div>