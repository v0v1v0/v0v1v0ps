<div class="container">

<table style="width: 100%;"><tr>
<td>sm.rm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric analysis of repeated measurements data
</h2>

<h3>Description</h3>

<p>This function estimates nonparametrically the mean profile from a matrix
<code>y</code> which is assumed to contain repeated measurements (i.e. longitudinal
data) from a set of individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sm.rm(Time, y, minh = 0.1, maxh = 2, optimize = FALSE,
      rice.display = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix containing the values of the response variable, with rows associated 
to individuals and columns associated to observation times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>

<p>a vector containing the observation times of the response variable, assumed 
to be the same for all individuals of matrix <code>y</code>. 
If <code>Time</code> is not given, this is assumed to be <code>1:ncol(y)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minh</code></td>
<td>

<p>the minimum value of the interval where the optimal value of the smoothing
parameter is searched according to the modified Rice criterion.
See reference below for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxh</code></td>
<td>

<p>the maximum value of the above interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>

<p>Logical value, default is <code>optimize=FALSE</code>. If
<code>optimize=TRUE</code>, then a full 
optimization is performed after searching the interval <code>(minh,maxh)</code>
using the optimizer <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rice.display</code></td>
<td>

<p>If this set to <code>TRUE</code> (default is <code>FALSE</code>), a plot is
produced of the curve 
representing the modified Rice criterion for bandwidth selection. 
See reference below for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code>
function, through a mechanism which limits their effect only to this
call of the function; those relevant for this function are the following:
</p>

<dl>
<dt>add</dt>
<dd>
<p>logical value, default is <code>add=FALSE</code>. If <code>add=TRUE</code> and
display is not set to <code>"none"</code>, then graphical output added
to the existing plot, rather than starting a new one.
</p>
</dd>
<dt>display</dt>
<dd>
<p>character value controlling the amount of graphical output of the estimated 
regression curve. It has the same meaning as in <code>sm.regression</code>. 
Default value is <code>display="lines"</code>.
</p>
</dd>
<dt>ngrid</dt>
<dd>
<p>the number of divisions of the above interval to be considered. 
Default: <code>ngrid=20</code>.
</p>
</dd>
<dt>poly.index</dt>
<dd>
<p>overall degree  of  locally-fitted  polynomial, as used by
<code>sm.regression</code>. Default: <code>ngrid=1</code>.
</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>see Section 7.4 of the reference below.
</p>


<h3>Value</h3>

<p>a list containing the returned value produced by <code>sm.regression</code> when 
smoothing the mean response value at each given observation time, 
with an extra component <code>$aux</code> added to the list.
This additional component  is a list itself containing the mean value at each 
observation time, the residual variance of the residuals from the estimated 
regression curve,  the autocorrelation function of the residuals, and 
the value <code>h</code> of the chosen smoothing parameter. 
</p>


<h3>Side Effects</h3>

<p>if the parameter display is not set to <code>"none"</code>, a plot of the estimated 
regression curve is produced; 
other aspects are controlled by the optional parameters (<code>...</code>). 
If <code>rice.display=TRUE</code>, a plot of the modified Rice criterion is shown.
</p>


<h3>References</h3>

<p>Bowman, A.W. and Azzalini, A. (1997). 
<em>Applied Smoothing Techniques for Data Analysis: </em>
<em>the Kernel Approach with S-Plus Illustrations.</em>
Oxford University Press, Oxford.
</p>


<h3>See Also</h3>

<p><code>sm.regression</code>, <code>sm.regression.autocor</code>, <code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sm.rm(y=as.matrix(citrate), display.rice=TRUE)
#
with(dogs, {
   Time &lt;- seq(1,13,by=2)
   gr1  &lt;- as.matrix(dogs[dogs$Group==1,2:8])
   plot(c(1,13), c(3,6),xlab="time", ylab="potassium", type="n") 
   sm1  &lt;- sm.rm(Time, gr1, display="se", add=TRUE)
})
</code></pre>


</div>