<div class="container">

<table style="width: 100%;"><tr>
<td>sievePH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Estimation of Coefficients in a Mark-Specific Proportional Hazards
Model with a Multivariate Continuous Mark, Fully Observed in All Failures</h2>

<h3>Description</h3>

<p><code>sievePH</code> implements the semiparametric estimation method of Juraska and Gilbert (2013) for the multivariate mark-
specific hazard ratio in the competing risks failure time analysis framework. It employs (i) the semiparametric
method of maximum profile likelihood estimation in the treatment-to-placebo mark density
ratio model (Qin, 1998) and (ii) the ordinary method of maximum partial likelihood estimation of the overall log hazard ratio in the Cox model.
<code>sievePH</code> requires that the multivariate mark data are fully observed in all failures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sievePH(eventTime, eventInd, mark, tx, strata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eventTime</code></td>
<td>
<p>a numeric vector specifying the observed right-censored time to the event of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eventInd</code></td>
<td>
<p>a numeric vector indicating the event of interest (1 if event, 0 if right-censored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>either a numeric vector specifying a univariate continuous mark or a data frame specifying a multivariate continuous mark.
No missing values are permitted for subjects with <code>eventInd = 1</code>. For subjects with <code>eventInd = 0</code>, the value(s) in <code>mark</code> should be set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tx</code></td>
<td>
<p>a numeric vector indicating the treatment group (1 if treatment, 0 if placebo)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a numeric vector specifying baseline strata (<code>NULL</code> by default). If specified, a stratified Cox model is fit for estimating the marginal hazard ratio (i.e., a separate baseline hazard is assumed for each stratum). No stratification is used in estimation of the mark density ratio.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sievePH</code> considers data from a randomized placebo-controlled treatment efficacy trial with a time-to-event endpoint.
The parameter of interest, the mark-specific hazard ratio, is the ratio (treatment/placebo) of the conditional mark-specific hazard functions.
It factors as the product of the mark density ratio (treatment/placebo) and the ordinary marginal hazard function ignoring mark data.
The mark density ratio is estimated using the method of Qin (1998), while the marginal hazard ratio is estimated using <code>coxph()</code> in the <code>survival</code> package.
Both estimators are consistent and asymptotically normal. The joint asymptotic distribution of the estimators is detailed in Juraska and Gilbert (2013).
</p>


<h3>Value</h3>

<p>An object of class <code>sievePH</code> which can be processed by
<code>summary.sievePH</code> to obtain or print a summary of the results. An object of class
<code>sievePH</code> is a list containing the following components:
</p>

<ul>
<li> <p><code>DRcoef</code>: a numeric vector of estimates of coefficients <code class="reqn">\phi</code> in the weight function <code class="reqn">g(v, \phi)</code> in the density ratio model
</p>
</li>
<li> <p><code>DRlambda</code>: an estimate of the Lagrange multiplier in the profile score functions for <code class="reqn">\phi</code> (that arises by profiling out the nuisance parameter)
</p>
</li>
<li> <p><code>DRconverged</code>: a logical value indicating whether the estimation procedure in the density ratio model converged
</p>
</li>
<li> <p><code>logHR</code>: an estimate of the marginal log hazard ratio from <code>coxph()</code> in the <code>survival</code> package
</p>
</li>
<li> <p><code>cov</code>: the estimated joint covariance matrix of <code>DRcoef</code> and <code>logHR</code>
</p>
</li>
<li> <p><code>coxphFit</code>: an object returned by the call of <code>coxph()</code>
</p>
</li>
<li> <p><code>nPlaEvents</code>: the number of events observed in the placebo group
</p>
</li>
<li> <p><code>nTxEvents</code>: the number of events observed in the treatment group
</p>
</li>
<li> <p><code>mark</code>: the input object
</p>
</li>
<li> <p><code>tx</code>: the input object
</p>
</li>
</ul>
<h3>References</h3>

<p>Juraska, M. and Gilbert, P. B. (2013), Mark-specific hazard ratio model with multivariate continuous marks: an application to vaccine efficacy. <em>Biometrics</em> 69(2):328–337.
</p>
<p>Qin, J. (1998), Inferences for case-control and semiparametric two-sample density ratio models. <em>Biometrika</em> 85, 619–630.
</p>


<h3>See Also</h3>

<p><code>summary.sievePH</code>, <code>plot.summary.sievePH</code>, <code>testIndepTimeMark</code> and <code>testDensRatioGOF</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
tx &lt;- rep(0:1, each=n/2)
tm &lt;- c(rexp(n/2, 0.2), rexp(n/2, 0.2 * exp(-0.4)))
cens &lt;- runif(n, 0, 15)
eventTime &lt;- pmin(tm, cens, 3)
eventInd &lt;- as.numeric(tm &lt;= pmin(cens, 3))
mark1 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 2, 5), rbeta(n/2, 2, 2)), NA)
mark2 &lt;- ifelse(eventInd==1, c(rbeta(n/2, 1, 3), rbeta(n/2, 5, 1)), NA)

# fit a model with a univariate mark
fit &lt;- sievePH(eventTime, eventInd, mark1, tx)

# fit a model with a bivariate mark
fit &lt;- sievePH(eventTime, eventInd, data.frame(mark1, mark2), tx)

</code></pre>


</div>