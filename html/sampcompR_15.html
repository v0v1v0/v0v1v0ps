<div class="container">

<table style="width: 100%;"><tr>
<td>uni_compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare data frames and Plot Differences</h2>

<h3>Description</h3>

<p>Returns data or a plot showing the difference of two or more
data frames The differences are calculated on the base of
differing metrics, chosen in the funct argument. All used data frames must
contain at least one column named equal in all data frames, that has equal
values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">uni_compare(
  dfs,
  benchmarks,
  variables = NULL,
  nboots = 2000,
  funct = "rel_mean",
  data = TRUE,
  type = "comparison",
  legendlabels = NULL,
  legendtitle = NULL,
  colors = NULL,
  shapes = NULL,
  summetric = "rmse2",
  label_x = NULL,
  label_y = NULL,
  plot_title = NULL,
  varlabels = NULL,
  name_dfs = NULL,
  name_benchmarks = NULL,
  summet_size = 4,
  silence = TRUE,
  conf_level = 0.95,
  conf_adjustment = NULL,
  weight = NULL,
  id = NULL,
  strata = NULL,
  weight_bench = NULL,
  id_bench = NULL,
  strata_bench = NULL,
  adjustment_weighting = "raking",
  adjustment_vars = NULL,
  raking_targets = NULL,
  post_targets = NULL,
  ndigits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfs</code></td>
<td>
<p>A character vector containing the names of data frames to compare against the benchmarks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>benchmarks</code></td>
<td>
<p>A character vector containing the names of benchmarks to compare the data frames against.
The vector must either be the same length as <code>dfs</code>, or length 1. If it has length 1 every
df will be compared against the same benchmark. Benchmarks can either be the name of data frames or
the name of a list of tables. The tables in the list need to be named as the respective variables
in the data frame of comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>A character vector containing the names of the variables for the comparison. If NULL,
all variables named similarly in both the <code>dfs</code> and the benchmarks will be compared. Variables missing
in one of the data frames or the benchmarks will be neglected for this comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboots</code></td>
<td>
<p>The number of bootstraps used to calculate standard errors. Must either be &gt;2 or 0.
If &gt;2 bootstrapping is used to calculate standard errors with <code>nboots</code> iterations. If 0, SE
is calculated analytically. We do not recommend using <code>nboots</code> =0 because this method is not
yet suitable for every <code>funct</code> used and every method. Depending on the size of the data and the
number of bootstraps, <code>uni_compare</code> can take a while.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funct</code></td>
<td>
<p>A character string, indicating the function to calculate the
difference between the data frames.
</p>
<p>Predefined functions are:
</p>

<ul>
<li> <p><code>"d_mean"</code>, <code>"ad_mean"</code> A function to calculate the (absolute) difference in mean of
the variables in <code>dfs</code> and benchmarks with the same name. Only applicable for
metric variables.
</p>
</li>
<li> <p><code>"d_prop"</code>, <code>"ad_prop"</code> A function to calculate the (absolute) difference in proportions of
the variables in <code>dfs</code> and benchmarks with the same name. Only applicable for dummy
variables.
</p>
</li>
<li> <p><code>"rel_mean"</code>, <code>"abs_rel_mean"</code> A function to calculate the (absolute)
relative difference in mean of the variables in <code>dfs</code> and benchmarks with the same name.
#' For more information on the formula for difference and analytic variance, see Felderer
et al. (2019). Only applicable for metric variables.
</p>
</li>
<li> <p><code>"rel_prop"</code>, <code>"abs_rel_prop"</code> A function to calculate the (absolute)
relative difference in proportions of the variables in <code>dfs</code> and benchmarks with
the same name. It is calculated similar to the relative difference in mean
(see Felderer et al., 2019), however the default label for the plot is different.
Only applicable for dummy variables.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If TRUE, a uni_compare_object is returned, containing results of the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Define the type of comparison. Can either be <code>"comparison"</code> or <code>"nonresponse"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendlabels</code></td>
<td>
<p>A character string or vector of strings containing a label for the
legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendtitle</code></td>
<td>
<p>A character string containing the title of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>A vector of colors, that is used in the plot for the
different comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes</code></td>
<td>
<p>A vector of shapes applicable in <code>ggplot2::ggplot2()</code>, that is
used in the plot for the different comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summetric</code></td>
<td>
<p>If <code>"avg1"</code>, <code>"mse1"</code>, <code>"rmse1"</code>, or <code>"R"</code>
the respective measure is calculated for the biases of each survey. The values
<code>"mse1"</code> and <code>"rmse1"</code> lead to similar results as in <code>"mse2"</code> and <code>"rmse2"</code>,
with slightly different visualization in the plot. If <code>summetric = NULL</code>, no summetric
will be displayed in the Plot. When <code>"R"</code> is chosen, also <code>response_identificator</code>
is needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_x, label_y</code></td>
<td>
<p>A character string or vector of character strings containing a label for
the x-axis and y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>A character string containing the title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varlabels</code></td>
<td>
<p>A character string or vector of character strings containing the new names of
variables, also used in plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_dfs, name_benchmarks</code></td>
<td>
<p>A character string or vector of character strings containing the
new names of the <code>dfs</code> and <code>benchmarks</code>, that is also used in plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summet_size</code></td>
<td>
<p>A number to determine the size of the displayed <code>summetric</code> in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silence</code></td>
<td>
<p>If <code>silence = FALSE</code> a warning will be displayed, if variables a
re excluded from either the data frame or benchmark, for not existing in both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>A numeric value between zero and one to determine the confidence level of the confidence
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_adjustment</code></td>
<td>
<p>If <code>conf_adjustment = TRUE</code> the confidence level of the confidence interval will be
adjusted with a Bonferroni adjustment, to account for the problem of multiple comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight, weight_bench</code></td>
<td>
<p>A character vector determining variables to weight the <code>dfs</code> or
<code>benchmarks</code>. They have to be part of the respective data frame. If only one character is provided,
the same variable is used to weigh every <code>df</code> or <code>benchmark</code>. If a
weight variable is provided also an <code>id</code> variable is needed.For
weighting, the <code>survey</code> package is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id, id_bench</code></td>
<td>
<p>A character vector determining <code>id</code> variables used
to weigh the <code>dfs</code> or <code>benchmarks</code> with the help of the
<code>survey</code> package. They have to be part of the respective data frame. If
only one character is provided, the same variable is used to weigh every
<code>df</code> or <code>benchmark</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata, strata_bench</code></td>
<td>
<p>A character vector determining strata variables
used to weigh the <code>dfs</code> or <code>benchmarks</code> with the help of the
<code>survey</code> package. They have to be part of the respective data frame.
If only one character is provided, the same variable is used to weight every
<code>df</code> or <code>benchmark</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment_weighting</code></td>
<td>
<p>A character vector indicating if adjustment
weighting should be used. It can either be <code>"raking"</code> or <code>"post_start"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment_vars</code></td>
<td>
<p>Variables used to adjust the survey when using raking
or post stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raking_targets</code></td>
<td>
<p>A list of raking targets that can be given to the rake
function of <code>rake</code>, to rake the <code>dfs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_targets</code></td>
<td>
<p>A list of post-stratification targets that can be given to the
<code>postStratify</code> function, to post-stratify the <code>dfs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigits</code></td>
<td>
<p>The number of digits to round the numbers in the plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot based on <code>ggplot2::ggplot2()</code> (or data frame if data==TRUE)
which shows the difference between two or more data frames on predetermined variables,
named identical in both data frames.
</p>


<h3>References</h3>

<p>Felderer, B., Kirchner, A., &amp; Kreuter, FALSE. (2019). The Effect of Survey Mode on Data
Quality: Disentangling Nonresponse and Measurement Error Bias. Journal of Official
Statistics, 35(1), 93–115. https://doi.org/10.2478/jos-2019-0005
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Get Data for comparison
require(wooldridge)
card&lt;-wooldridge::card

black&lt;-wooldridge::card[wooldridge::card$black==1,]
north&lt;-wooldridge::card[wooldridge::card$south==0,]
white&lt;-wooldridge::card[wooldridge::card$black==0,]
south&lt;-wooldridge::card[wooldridge::card$south==1,]

## use the function to plot the data 
univar_comp&lt;-sampcompR::uni_compare(dfs = c("north","white"),
                                    benchmarks = c("south","black"),
                                    variables= c("age","educ","fatheduc","motheduc","wage","IQ"),
                                    funct = "abs_rel_mean",
                                    nboots=200,
                                    summetric="rmse2",
                                    data=FALSE)

 univar_comp
 
</code></pre>


</div>