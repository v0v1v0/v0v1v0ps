<div class="container">

<table style="width: 100%;"><tr>
<td>mssplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interactive Stacked Plots of Multichannel Sequences and/or Most Probable
Paths for Mixture Hidden Markov Models</h2>

<h3>Description</h3>

<p>Function <code>mssplot</code> plots stacked sequence plots of observation sequences
and/or most probable hidden state paths for each model of the <code>mhmm</code>
object (model chosen according to the most probable path).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mssplot(
  x,
  ask = FALSE,
  which.plots = NULL,
  hidden.paths = NULL,
  plots = "obs",
  type = "d",
  tlim = 0,
  sortv = NULL,
  sort.channel = 1,
  dist.method = "OM",
  with.missing = FALSE,
  missing.color = NULL,
  title = NA,
  title.n = TRUE,
  cex.title = 1,
  title.pos = 1,
  with.legend = "auto",
  ncol.legend = "auto",
  with.missing.legend = "auto",
  legend.prop = 0.3,
  cex.legend = 1,
  hidden.states.colors = "auto",
  hidden.states.labels = "auto",
  xaxis = TRUE,
  xlab = NA,
  xtlab = NULL,
  xlab.pos = 1,
  ylab = "auto",
  hidden.states.title = "Hidden states",
  yaxis = FALSE,
  ylab.pos = "auto",
  cex.lab = 1,
  cex.axis = 1,
  respect_void = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Mixture hidden Markov model object of class <code>mhmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>If <code>TRUE</code> and <code>which.plots</code> is NULL, <code>plot.mhmm</code> operates in interactive mode, via <code>menu</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>The number(s) of the requested model(s) as an integer vector. The default <code>NULL</code> produces all plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden.paths</code></td>
<td>
<p>Output from the <code>hidden_paths</code> function. The
default value <code>NULL</code> computes hidden paths automatically, if needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>What to plot. One of <code>"obs"</code> for observations (the default),
<code>"hidden.paths"</code> for most probable paths of hidden states,
or <code>"both"</code> for observations and hidden paths together.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the plot. Available types are <code>"I"</code> for index
plots and <code>"d"</code> for state distribution plots (the default). See
<code>seqplot</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>Indexes of the subjects to be plotted (the default is 0,
i.e. all subjects are plotted). For example, <code>tlim = 1:10</code> plots
the first ten subjects in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortv</code></td>
<td>
<p>A sorting variable or a sort method (one of <code>"from.start"</code>,
<code>"from.end"</code>, <code>"mds.obs"</code>, or <code>"mds.hidden"</code>) for
<code>type = "I"</code>. The value <code>"mds.hidden"</code> is only available when
<code>which = "both"</code> and <code>which = "hidden.paths"</code>. Options <code>"mds.obs"</code> and
<code>"mds.hidden"</code> automatically arrange the sequences according to the
scores of multidimensional scaling (using <code>cmdscale</code>) for the
observed data or hidden states paths.
MDS scores are computed from distances/dissimilarities using a metric
defined in argument <code>dist.method</code>. See <code>plot.stslist</code> for
more details on <code>"from.start"</code> and <code>"from.end"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort.channel</code></td>
<td>
<p>The number of the channel according to which the
<code>"from.start"</code> or <code>"from.end"</code> sorting is done. Sorting according
to hidden states is called with value 0. The default value is 1 (the first
channel).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.method</code></td>
<td>
<p>The metric to be used for computing the distances of the
sequences if multidimensional scaling is used for sorting. One of "OM"
(optimal matching, the default), "LCP" (longest common prefix), "RLCP"
(reversed LCP, i.e. longest common suffix), "LCS" (longest common
subsequence), "HAM" (Hamming distance), and "DHD" (dynamic Hamming distance).
Transition rates are used for defining substitution costs if needed. See
<code>seqdef</code> for more information on the metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.missing</code></td>
<td>
<p>Controls whether missing states are included in state
distribution plots (<code>type = "d"</code>). The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.color</code></td>
<td>
<p>Alternative color for representing missing values
in the sequences. By default, this color is taken from the <code>missing.color</code>
attribute of the sequence object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A vector of main titles for the graphics. The default is <code>NA</code>: if
<code>title.n = TRUE</code>, the name of the cluster and the number of subjects is plotted.
<code>FALSE</code> prints no titles, even when <code>title.n = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.n</code></td>
<td>
<p>Controls whether the number of subjects is printed in the main
titles of the plots. The default is <code>TRUE</code>: n is plotted if <code>title</code>
is anything but <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.title</code></td>
<td>
<p>Expansion factor for setting the size of the font for the main
titles. The default value is 1. Values lesser than 1 will reduce the size of
the font, values greater than 1 will increase the size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.pos</code></td>
<td>
<p>Controls the position of the main titles of the plots. The
default value is 1. Values greater than 1 will place the title higher.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>Defines if and where the legend for the states is plotted.
The default value <code>"auto"</code> (equivalent to <code>TRUE</code> and
<code>"right"</code>) creates separate legends for each requested plot and
positiones them on the right-hand side of the plot. Other possible values
are <code>"bottom"</code>,
<code>"right.combined"</code>, and <code>"bottom.combined"</code>, of which the last
two create a combined legend in the selected position. <code>FALSE</code> prints no legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.legend</code></td>
<td>
<p>(A vector of) the number of columns for the legend(s). The
default <code>"auto"</code> creates one column for each legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.missing.legend</code></td>
<td>
<p>If set to <code>"auto"</code> (the default), a legend
for the missing state is added automatically if one or more of the
sequences in the data/channel contains missing states and <code>type = "I"</code>.
If <code>type = "d"</code> missing states are omitted from the legends unless
<code>with.missing = TRUE</code>. With the value <code>TRUE</code> a
legend for the missing state is added in any case; equivalently
<code>FALSE</code> omits the legend for the missing state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.prop</code></td>
<td>
<p>Sets the proportion of the graphic area used for plotting
the legend when <code>with.legend</code> is not <code>FALSE</code>. The default value is
0.3. Takes values from 0 to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>Expansion factor for setting the size of the font for the
labels in the legend. The default value is 1. Values lesser than 1 will
reduce the size of the font, values greater than 1 will increase the size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden.states.colors</code></td>
<td>
<p>A vector of colors assigned to hidden states. The default
value <code>"auto"</code> uses the colors assigned to the <code>stslist</code> object (created
with <code>seqdef</code>) if <code>hidden.paths</code> is given; otherwise colors from
<code>colorpalette</code> are automatically used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden.states.labels</code></td>
<td>
<p>Labels for the hidden states. The default value
<code>"auto"</code> uses the names provided in <code>x$state_names</code> if <code>x</code> is
an <code>hmm</code> object; otherwise the number of the hidden state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>Controls whether an x-axis is plotted below the plot at the
bottom. The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>An optional label for the x-axis. If set to <code>NA</code>, no label
is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtlab</code></td>
<td>
<p>Optional labels for the x-axis tick labels.  If unspecified, the
column names of the <code>seqdata</code> sequence object are used (see
<code>seqdef</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.pos</code></td>
<td>
<p>Controls the position of the x-axis label. The default value
is 1. Values greater than 1 will place the label further away from the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Labels for the channels shown as labels for y-axes.
A vector of names for each channel
(observations). The default value <code>"auto"</code> uses the names provided in
<code>x$channel_names</code> if <code>x</code> is an <code>hmm</code> object; otherwise the
names of the list in <code>x</code> if given, or the
number of the channel if names are not given. <code>FALSE</code> prints no labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden.states.title</code></td>
<td>
<p>Optional label for the hidden state plot (in the
y-axis). The default is <code>"Hidden states"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>Controls whether or not to plot the y-axis. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.pos</code></td>
<td>
<p>Controls the position of the y axis labels (labels for
channels and/or hidden states). Either <code>"auto"</code> or a numerical vector
indicating how far away from the plots the titles are positioned. The
default value <code>"auto"</code> positions all titles on line 1.
Shorter vectors are recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>Expansion factor for setting the size of the font for the axis
labels. The default value is 1. Values lesser than 1 will reduce the size
of the font, values greater than 1 will increase the size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Expansion factor for setting the size of the font for the x-axis
tick labels. The default value is 1. Values lesser than 1 will reduce the size of
the font, values greater than 1 will increase the size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>respect_void</code></td>
<td>
<p>If <code>TRUE</code> (default), states at the time points
corresponding to TraMineR's void in the observed sequences are set to void
in the hidden state sequences as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed on to
<code>seqplot</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>build_mhmm</code> and <code>fit_model</code> for building and
fitting mixture hidden Markov models, <code>hidden_paths</code> for
computing the most probable paths (Viterbi paths) of hidden states,
<code>plot.mhmm</code> for plotting <code>mhmm</code> objects as directed graphs, and
<code>colorpalette</code> for default colors.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Loading mixture hidden Markov model (mhmm object)
# of the biofam data
data("mhmm_biofam")

# Plotting the first cluster only
mssplot(mhmm_biofam, which.plots = 1)

if (interactive()) {
  # Interactive plot
  mssplot(mhmm_biofam)
}

</code></pre>


</div>