<div class="container">

<table style="width: 100%;"><tr>
<td>tsdiag.Sarima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic Plots for fitted seasonal ARIMA models</h2>

<h3>Description</h3>

<p>Produce diagnostics for fitted seasonal ARIMA models. The method
offers several portmanteau tests (including Ljung-Box, Li-McLeod and
Box-Pierce), plots of autocorrelations and partial autocorrelations of
the residuals, ability to control which graphs are produced (including
interactively), as well as their layout.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'Sarima'
tsdiag(object, gof.lag = NULL, ask = FALSE, ..., plot = 1:3, layout = NULL)

# if 'object' is produced by stats::arima(), forecast::auto.arima() and
# similar, use the full name, 'tsdiag.Sarima()', in the call. The
# arguments are the same.
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>fitted (seasonal) ARIMA model. currently the output of
<code>sarima</code>, <code>stats::arima</code> or compatible (e.g.,
<code>forecast::Arima</code> and <code>forecast::auto.arima</code>).  If
<code>object</code> is not from <code>sarima</code>, use the full name,
<code>tsdiag.Sarima</code>, of the method when calling it, see the
examples. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.lag</code></td>
<td>
<p>maximal lag for portmanteau tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>if <code>TRUE</code> present a menu of available plots, see section
‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if <code>TRUE</code> all available plots; a vector of positive integers
specifies a subset of the available plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>

<p>a list with arguments for <code>graphics::layout</code> for the plots. The
default is as for the ARIMA method of <code>stats::tsdiag</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute and graph diagnostics for seasonal ARIMA models. For objects
of class <code>"Sarima"</code> (produced by <code>sarima</code>) just call the
generic, <code>tsdiag</code>. The method can be called also directly on the output
from base R's <code>arima()</code> with <code>tsdiag.Sarima()</code> or
<code>sarima::tsdiag.Sarima()</code>.
</p>
<p>The method offers several portmanteau tests (including Ljung-Box,
Li-McLeod and Box-Pierce), plots of autocorrelations and partial
autocorrelations of the residuals, ability to control which graphs are
produced (including interactively), as well as their layout.
</p>
<p>The method always makes a correction of the degrees of freedom of the
portmanteau tests (roughly, subtracting the number of estimated ARMA
parameters). Note that <code>stats::tsdiag</code> doesn't do that.
</p>
<p><code>plot</code> can be <code>TRUE</code> to ask for all plots or a vector of
positive integers specifying which plots to consider. Currently the
following options are available:
</p>

<table>
<tr>
<td style="text-align: right;">1 </td>
<td style="text-align: left;"> residuals </td>
</tr>
<tr>
<td style="text-align: right;">
 2 </td>
<td style="text-align: left;"> acf of residuals </td>
</tr>
<tr>
<td style="text-align: right;">
 3 </td>
<td style="text-align: left;"> p values for Ljung-Box statistic </td>
</tr>
<tr>
<td style="text-align: right;">
 4 </td>
<td style="text-align: left;"> p values for Li-McLeod statistic </td>
</tr>
<tr>
<td style="text-align: right;">
 5 </td>
<td style="text-align: left;"> p values for Box-Pierce statistic </td>
</tr>
<tr>
<td style="text-align: right;">
 6 </td>
<td style="text-align: left;"> pacf of residuals</td>
</tr>
</table>
<p>The default is <code>plot = 1:3</code>, which produces a plot similar to the
one from <code>stats::tsdiag</code> (but with adjusted d.f., see above). 
If <code>plot</code> is <code>TRUE</code>, you probably need also <code>ask = TRUE</code>.
</p>
<p>If argument <code>plot</code> is of length two the graphics window is split
into 2 equal subwindows. Argument <code>layout</code> can still be used to
change this.  If argument <code>plot</code> is of length one the graphics
window is not split at all.
</p>
<p>In interactive sessions, if the number of requested graphs (as
specified by argument <code>plot</code>) is larger than the number of graphs
specified by the layout (by default 3), the function makes the first
graph and then presents a menu of the requested plots. 
</p>
<p>Argument <code>layout</code> can be used to change the layout of the plot,
for example to put two graphs per plot, see the examples. Currently it
should be a list of arguments for <code>layout</code>, see <code>?layout</code>.
Don't call <code>layout</code> youself, as that will change the graphics
device prematurely.
</p>
<p>The computed results are returned (invisibly). This is another
difference from <code>stats::tsdiag</code> which doesn't return them.
</p>


<h3>Value</h3>

<p>a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LjungBox</code></td>
<td>
<p>Ljung box test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LiMcLeod</code></td>
<td>
<p>LiMcLeod test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BoxPierce</code></td>
<td>
<p>BoxPierce test</p>
</td>
</tr>
</table>
<p>Only components that are actually computed are included, the rest are
NULL or absent.
</p>


<h3>Author(s)</h3>

<p>Georgi N. boshnakov</p>


<h3>See Also</h3>

<p><code>tsdiag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ap.baseA &lt;- sarima(log(AirPassengers) ~ 
    0 | ma(1, c(-0.3)) + sma(12,1, c(-0.1)) + i(1) + si(12,1), 
    ss.method = "base")
tsdiag(ap.baseA)

## apply the method on objects from arima()
ap.arima &lt;- arima(log(AirPassengers), order = c(0,1,1), seasonal = c(0,1,1))
tsdiag.Sarima(ap.arima)
## use Li-McLeod test instead of Ljung-Box
tsdiag.Sarima(ap.arima, plot = c(1:2,4))
## call R's tsdiag method, for comparison:
tsdiag(ap.arima, plot = c(1:2,4))

## plot only acf and p-values
tsd &lt;- tsdiag.Sarima(ap.arima, plot = c(2:3), layout = list(matrix(1:2, nrow = 2)))
## the results can be used for further calculations:
head(tsd$LjungBox$test, 4)


## plot resid, acf, and p-values, leaving half the space for residuals
tsdiag.Sarima(ap.arima, plot = c(1:3), layout = list(matrix(1:3, nrow = 3),
                                                     heights = c(1,2,2)))


## four plots arranged as a 2x2 matrix.
tsdiag.Sarima(ap.arima, plot = c(2:5), layout = list(matrix(1:4, nrow = 2)))
</code></pre>


</div>