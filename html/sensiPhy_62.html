<div class="container">

<table style="width: 100%;"><tr>
<td>tree_influ_phyglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interaction between phylogenetic uncertainty and influential species detection - Phylogenetic Logistic Regression</h2>

<h3>Description</h3>

<p>Performs leave-one-out deletion analysis for phylogenetic logistic regression,
and detects influential species while evaluating uncertainty in trees topology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tree_influ_phyglm(
  formula,
  data,
  phy,
  n.tree = 2,
  cutoff = 2,
  btol = 50,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The model formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing species traits with row names matching tips
in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tree</code></td>
<td>
<p>Number of times to repeat the analysis with n different trees picked 
randomly in the multiPhylo file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cutoff value used to identify for influential species
(see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btol</code></td>
<td>
<p>Bound on searching space. For details see <code>phyloglm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>phyloglm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function sequentially removes one species at a time, fits a phylogenetic
logistic regression model using <code>phyloglm</code>, stores the
results and detects influential species. It repeats this operation using n trees, 
randomly picked in a multiPhylo file.
</p>
<p>Currently only logistic regression using the "logistic_MPLE"-method from
<code>phyloglm</code> is implemented.
</p>
<p><code>influ_phyglm</code> detects influential species based on the standardised
difference in intercept and/or slope when removing a given species compared
to the full model including all species. Species with a standardised difference
above the value of <code>cutoff</code> are identified as influential. The default
value for the cutoff is 2 standardised differences change.
</p>
<p>Currently, this function can only implement simple logistic models (i.e. <code class="reqn">trait~
predictor</code>). In the future we will implement more complex models.
</p>
<p>Output can be visualised using <code>sensi_plot</code>.
</p>


<h3>Value</h3>

<p>The function <code>influ_phyglm</code> returns a list with the following
components:
</p>
<p><code>cutoff</code>: The value selected for <code>cutoff</code>
</p>
<p><code>formula</code>: The formula
</p>
<p><code>full.model.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (i.e. <code>alpha</code>) for the full model
without deleted species.
</p>
<p><code>influential_species</code>: List of influential species, both
based on standardised difference in interecept and in the slope of the
regression. Species are ordered from most influential to less influential and
only include species with a standardised difference &gt; <code>cutoff</code>.
</p>
<p><code>sensi.estimates</code>: A data frame with all simulation
estimates. Each row represents a deleted clade for a given random tree. Columns report the calculated
regression intercept (<code>intercept</code>), difference between simulation
intercept and full model intercept (<code>DIFintercept</code>), the standardised
difference (<code>sDIFintercept</code>), the percentage of change in intercept compared
to the full model (<code>intercept.perc</code>) and intercept p-value
(<code>pval.intercept</code>). All these parameters are also reported for the regression
slope (<code>DIFestimate</code> etc.). Additionally, model aic value (<code>AIC</code>) and
the optimised value (<code>optpar</code>) of the phylogenetic parameter
(i.e. <code>alpha</code>) are reported.
</p>
<p><code>data</code>: Original full dataset.
</p>
<p><code>errors</code>: Species where deletion resulted in errors.
</p>


<h3>Author(s)</h3>

<p>Gustavo Paterno, Caterina Penone &amp; Gijsbert D.A. Werner
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467
</p>
<p>Ho, L. S. T. and Ane, C. 2014. "A linear-time algorithm for 
Gaussian and non-Gaussian trait evolution models". Systematic Biology 63(3):397-408.
</p>


<h3>See Also</h3>

<p><code>phyloglm</code>, <code>tree_phyglm</code>,
<code>influ_phyglm</code>, <code>tree_influ_phyglm</code>, <code>sensi_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Simulate Data:
set.seed(6987)
mphy = rmtree(100, N = 30)
x = rTrait(n=1,phy=mphy[[1]])
X = cbind(rep(1,100),x)
y = rbinTrait(n=1,phy=mphy[[1]], beta=c(-1,0.5), alpha=.7 ,X=X)
dat = data.frame(y, x)
# Run sensitivity analysis:
tree_influ &lt;- tree_influ_phyglm(y ~ x, data = dat, phy = mphy, n.tree = 5)
summary(tree_influ)
sensi_plot(tree_influ)
sensi_plot(tree_influ, graphs = 1)
sensi_plot(tree_influ, graphs = 2)

## End(Not run)
</code></pre>


</div>