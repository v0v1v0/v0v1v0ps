<div class="container">

<table style="width: 100%;"><tr>
<td>detectSingleOut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect outliers for single observations</h2>

<h3>Description</h3>

<p>Detect outlying observations in a time series by modeling each plotId using
a local regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detectSingleOut(
  TP,
  trait,
  plotIds = NULL,
  checkEdges = TRUE,
  confIntSize = 5,
  nnLocfit = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>An object of class <code>TP</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>A character vector indicating the trait to model in <code>TP</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotIds</code></td>
<td>
<p>A character vector of plotIds for which the outliers should be
detected. If <code>NULL</code>, all plotIds in <code>TP</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkEdges</code></td>
<td>
<p>Before fitting the local regression should a check be done
if the first and last time point for a plot are outlying observations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confIntSize</code></td>
<td>
<p>A numeric value defining the confidence interval (see
Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnLocfit</code></td>
<td>
<p>A numeric value defining the constant component of the
smoothing parameter nn (see Details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See locfit() help function from the locfit R library. The user can act on:
</p>

<dl>
<dt>nnLocfit</dt>
<dd>
<p>the constant of the smoothing parameter. Increase nnLocfit
to have a very smooth curve</p>
</dd>
<dt>confIntSize</dt>
<dd>
<p>the level to calculate the confidence interval. Increase
confIntSize to exclude less outliers</p>
</dd>
</dl>
<h3>Value</h3>

<p>An object of class singleOut, a <code>data.frame</code> with the following
columns.
</p>

<dl>
<dt>plotId</dt>
<dd>
<p>plotId</p>
</dd>
<dt>timePoint</dt>
<dd>
<p>time point</p>
</dd>
<dt>trait</dt>
<dd>
<p>modeled trait</p>
</dd>
<dt>yPred</dt>
<dd>
<p>prediction from the local regression</p>
</dd>
<dt>sd_yPred</dt>
<dd>
<p>standard deviation of the prediction</p>
</dd>
<dt>lwr</dt>
<dd>
<p>lower bound of the confidence interval</p>
</dd>
<dt>upr</dt>
<dd>
<p>upper bound of the confidence interval</p>
</dd>
<dt>outlier</dt>
<dd>
<p>flag for detected outlier (a value of 1 indicates the
observation is an outlier)</p>
</dd>
</dl>
<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code>detectSingleOutMaize()</code>,
<code>plot.singleOut()</code>,
<code>removeSingleOut()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a TP object containing the data from the Phenovator.
PhenovatorDat1 &lt;- PhenovatorDat1[!PhenovatorDat1$pos %in%
                                 c("c24r41", "c7r18", "c7r49"), ]
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## First select a subset of plants, for example here 9 plants
plantSel &lt;- phenoTP[[1]]$plotId[1:9]
# Then run on the subset
resuVatorHTP &lt;- detectSingleOut(TP = phenoTP,
                                trait = "EffpsII",
                                plotIds = plantSel,
                                confIntSize = 3,
                                nnLocfit = 0.1)

</code></pre>


</div>