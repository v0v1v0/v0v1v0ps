<div class="container">

<table style="width: 100%;"><tr>
<td>scROSHI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Supervised Hierarchical Identification of Single Cells</h2>

<h3>Description</h3>

<p>Identifying cell types based on expression profiles is a pillar of single cell analysis.
</p>
<p>scROSHI identifies cell types based on expression profiles of single cell analysis by
utilizing previously obtained cell type specific gene sets. It takes into account the
hierarchical nature of cell type relationship and does not require training or
annotated data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scROSHI(
  sce_data,
  celltype_lists,
  type_config,
  count_data = "normcounts",
  gene_symbol = "SYMBOL",
  cell_scores = FALSE,
  min_genes = 5,
  min_var = 1.5,
  n_top_genes = 2000,
  n_nn = 5,
  thresh_unknown = 0.05,
  thresh_uncert = 0.1,
  thresh_uncert_second = 0.8,
  verbose = 0,
  output = "sce"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sce_data</code></td>
<td>
<p>A SingleCellExperiment object containing the expression
profiles of the single cell analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>celltype_lists</code></td>
<td>
<p>Marker gene list for all cell types. It can be provided
as a list of genes with cell types as names or as a path to a file containing the
marker genes. Supported file formats are .gmt or .gmx files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_config</code></td>
<td>
<p>Config file to define major cell types and hierarchical subtypes.
It should be provided as a two-column data.frame where the first column are the
major cell types and the second column are the subtypes. If several subtypes exists,
they should be separated by comma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count_data</code></td>
<td>
<p>Assay name in the SingleCellExperiment object containing the count data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_symbol</code></td>
<td>
<p>Variable name in the row data of the SingleCellExperiment object containing the gene names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_scores</code></td>
<td>
<p>Boolean value determining if the scores should be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_genes</code></td>
<td>
<p>scROSHI filters out non-unique genes as long as more than min_genes
are left. If there is a cell type that has less than min_genes genes, it will be
replaced with the cell type list BEFORE filtering for unique genes (default 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_var</code></td>
<td>
<p>Minimum variance for highly variable genes (default 1.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_top_genes</code></td>
<td>
<p>Maximum number of highly variable genes (default 2000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_nn</code></td>
<td>
<p>Number of nearest neighbors for umap for assignment of cell types
(default 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh_unknown</code></td>
<td>
<p>If none of the probabilities is above this threshold,
the cell type label is assigned to the class unknown (default 0.05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh_uncert</code></td>
<td>
<p>If the ratio between the largest and the second largest
probability is below this threshold, the cell type label is assigned to the
class uncertain for the major cell types (default 0.1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh_uncert_second</code></td>
<td>
<p>If the ratio between the largest and the second largest
probability is below this threshold, the cell type label is assigned to the
class uncertain for the subtypes (default 0.8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Level of verbosity. Zero means silent, one makes a verbose output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Defines the output. sce: The output is a SingleCellExperiment
object with the cell types appended to the meta data. df: The output id a
data.frame with two columns. The first column contains the barcode of the cell
and the second column contains the cell type labels.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
data("test_sce_data")
data("config")
data("marker_list")

results &lt;- scROSHI(sce_data = test_sce_data,
                   celltype_lists = marker_list,
                   type_config = config)
table(results$celltype_final)

</code></pre>


</div>