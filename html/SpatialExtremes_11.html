<div class="container">

<table style="width: 100%;"><tr>
<td>condrmaxlin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conditional simulation of max-linear random fields
</h2>

<h3>Description</h3>

<p>This function generates (approximate) conditional simulation of unit
Frechet max-linear random fields. It can be used to get approximate
conditional simulation for max-stable processes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">condrmaxlin(n, coord, data.coord, data, cov.mod = "gauss", ..., grid =
FALSE, p = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of conditional simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A numeric vector or matrix specifying the coordinates
where the process has to be generated. If <code>coord</code> is a matrix,
each row specifies one locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.coord</code></td>
<td>
<p>A numeric vector or matrix specifying the
coordinates where the process is conditioned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector giving the conditioning observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.mod</code></td>
<td>
<p>A character string specifying the max-stable model. See
section Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The parameters of the max-stable model. See section
Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical. Does <code>coord</code> defines a grid?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An integer. The number of unit Frechet random variables used
in the max-linear approximation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Any unit Frechet max-stable processes <code class="reqn">\{Z(x)\}</code> can be
approximated by a unit Frechet max-linear process, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">Z(x) \approx \max_{j=1, \ldots, p} f_j(x) Z_j,</code>
</p>

<p>where <code class="reqn">f_j</code> are non-negative deterministic functions,
<code class="reqn">p</code> is a sufficiently large integer and <code class="reqn">Z_j</code> are
independent unit Frechet random variables. Note that to ensure unit
Frechet margins, the following condition has to be satisfied
</p>
<p style="text-align: center;"><code class="reqn">\sum_{j=1, \ldots, p} f_j(x) = 1,</code>
</p>

<p>for all <code class="reqn">x</code>.
</p>
<p>Currently only the discretized Smith model is implemented for which
<code class="reqn">f_j(x) = c(p) \varphi(x - u_j ; \Sigma)</code> where <code class="reqn">\varphi(\cdot; \Sigma)</code>
is the zero mean (multivariate) normal density with covariance matrix
<code class="reqn">\Sigma</code>, <code class="reqn">u_j</code> is a sequence of deterministic
points appropriately chosen and <code class="reqn">c(p)</code> is a constant
ensuring unit Frechet margins.
</p>


<h3>Value</h3>

<p>A matrix containing observations from the required max-stable
model. Each column represents one stations. If <code>grid = TRUE</code>, the
function returns an array of dimension nrow(coord) x nrow(coord) x n.
</p>


<h3>Warnings</h3>

<p>It may happen that some conditional observations are not honored
because the approximation of a max-stable process by a max-linear one
isn't accurate enough! Sometimes taking a larger <code>p</code> solves the
issue.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet
</p>


<h3>References</h3>

<p>Wang, Y. and Stoev, S. A. (2011) Conditional Sampling for Max-Stable
Random Fields. <em>Advances in Applied Probability</em>.
</p>


<h3>See Also</h3>

<p><code>rmaxstab</code>, <code>condrmaxlin</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## One dimensional conditional simulations
n.cond.site &lt;- 10
cond.coord &lt;- runif(n.cond.site, -10, 10)
data &lt;- rmaxlin(1, cond.coord, var = 3, p = 10000)

x &lt;- seq(-10, 10, length = 250)
cond.sim &lt;- condrmaxlin(5, x, cond.coord, data, var = 3)

matplot(x, t(log(cond.sim)), type = "l", lty = 1, pch = 1)
points(cond.coord, log(data))

## Two dimensional conditional simulation
cond.coord &lt;- matrix(runif(2 * n.cond.site, -10, 10), ncol = 2)
data &lt;- rmaxstab(1, cond.coord, "gauss", cov11 = 4, cov12 = 0, cov22 = 4)

x &lt;- y &lt;- seq(-10, 10, length = 75)
cond.sim &lt;- condrmaxlin(4, cbind(x, y), cond.coord, data, cov11 = 4,
cov12 = 0, cov22 = 4, grid = TRUE, p = 2000)
## Note p is set to 2000 for CPU reasons but is likely to be too small

op &lt;- par(mfrow = c(2, 2), mar = rep(1, 4))
for (i in 1:4){
image(x, y, log(cond.sim[,,i]), col = heat.colors(64), xaxt = "n", yaxt
= "n", bty = "n")
contour(x, y, log(cond.sim[,,i]), add = TRUE)
text(cond.coord[,1], cond.coord[,2], round(log(data), 2), col = 3)
}
par(op)
</code></pre>


</div>