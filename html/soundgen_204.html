<div class="container">

<table style="width: 100%;"><tr>
<td>prosody</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prosody</h2>

<h3>Description</h3>

<p>Exaggerates or flattens the intonation by performing a dynamic pitch shift,
changing pitch excursion from its original median value without changing the
formants. This is a particular case of pitch shifting, which is performed
with <code>shiftPitch</code>. The result is likely to be improved if
manually corrected pitch contours are provided. Depending on the nature of
audio, the settings that control pitch shifting may also need to be
fine-tuned with the <code>shiftPitch_pars</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prosody(
  x,
  samplingRate = NULL,
  multProsody,
  analyze_pars = list(),
  shiftPitch_pars = list(),
  pitchManual = NULL,
  play = FALSE,
  saveAudio = NULL,
  reportEvery = NULL,
  cores = 1,
  plot = FALSE,
  savePlots = NULL,
  width = 900,
  height = 500,
  units = "px",
  res = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>path to a folder, one or more wav or mp3 files c('file1.wav',
'file2.mp3'), Wave object, numeric vector, or a list of Wave objects or
numeric vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingRate</code></td>
<td>
<p>sampling rate of <code>x</code> (only needed if <code>x</code> is a
numeric vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multProsody</code></td>
<td>
<p>multiplier of pitch excursion from median (on a
logarithmic or musical scale): &gt;1 = exaggerate intonation, 1 = no change, &lt;1
= flatten, 0 = completely flat at the original median pitch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analyze_pars</code></td>
<td>
<p>a list of parameters to pass to <code>analyze</code>
(only needed if <code>pitchManual</code> is NULL - that is, if we attempt to
track pitch automatically)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftPitch_pars</code></td>
<td>
<p>a list of parameters to pass to
<code>shiftPitch</code> to fine-tune the pitch-shifting algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pitchManual</code></td>
<td>
<p>manually corrected pitch contour. For a single sound,
provide a numeric vector of any length. For multiple sounds, provide a
dataframe with columns "file" and "pitch" (or path to a csv file) as
returned by <code>pitch_app</code>, ideally with the same windowLength and
step as in current call to analyze. A named list with pitch vectors per
file is also OK (eg as returned by pitch_app)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>play</code></td>
<td>
<p>if TRUE, plays the processed audio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveAudio</code></td>
<td>
<p>full (!) path to folder for saving the processed audio; NULL
= don't save, ” = same as input folder (NB: overwrites the originals!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reportEvery</code></td>
<td>
<p>when processing multiple inputs, report estimated time
left every ... iterations (NULL = default, NA = don't report)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>number of cores for parallel processing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>should a spectrogram be plotted? TRUE / FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savePlots</code></td>
<td>
<p>full path to the folder in which to save the plots (NULL =
don't save, ” = same folder as audio)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height, units, res</code></td>
<td>
<p>graphical parameters for saving plots passed to
<code>png</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the input is a single audio (file, Wave, or numeric vector),
returns the processed waveform as a numeric vector with the original
sampling rate and scale. If the input is a folder with several audio files,
returns a list of processed waveforms, one for each file.
</p>


<h3>See Also</h3>

<p><code>shiftPitch</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">s = soundgen(sylLen = 200, pitch = c(150, 220), addSilence = 50,
             plot = TRUE, yScale = 'log')
# playme(s)
s1 = prosody(s, 16000, multProsody = 2,
  analyze_pars = list(windowLength = 30, step = 15),
  shiftPitch_pars = list(windowLength = 20, step = 5, freqWindow = 300),
  plot = TRUE)
# playme(s1)
# spectrogram(s1, 16000, yScale = 'log')

## Not run: 
# Flat intonation - remove all frequency modulation
s2 = prosody(s, 16000, multProsody = 0,
  analyze_pars = list(windowLength = 30, step = 15),
  shiftPitch_pars = list(windowLength = 20, step = 5, freqWindow = 300),
  plot = TRUE)
playme(s2)
spectrogram(s2, 16000, yScale = 'log')

# Download an example - a bit of speech (sampled at 16000 Hz)
download.file('http://cogsci.se/soundgen/audio/speechEx.wav',
              destfile = '~/Downloads/temp1/speechEx.wav')
target = '~/Downloads/temp1/speechEx.wav'
samplingRate = tuneR::readWave(target)@samp.rate
spectrogram(target, yScale = 'log')
playme(target)

s3 = prosody(target, multProsody = 1.5,
  analyze_pars = list(windowLength = 30, step = 15),
  shiftPitch_pars = list(freqWindow = 400, propagation = 'adaptive'))
spectrogram(s3, tuneR::readWave(target)@samp.rate, yScale = 'log')
playme(s3)

# process all audio files in a folder
s4 = prosody('~/Downloads/temp', multProsody = 2, savePlots = '',
             saveAudio = '~/Downloads/temp/prosody')
str(s4)  # returns a list with audio (+ saves it to disk)

## End(Not run)
</code></pre>


</div>