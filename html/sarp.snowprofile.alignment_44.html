<div class="container">

<table style="width: 100%;"><tr>
<td>warpSP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Warp one snow profile onto another one</h2>

<h3>Description</h3>

<p>After the DTW alignment of two profiles, the maps between the two profiles can be used to
warp one profile onto the other profile. In other words, the layer thicknesses of the warped profile
are adjusted to optimally align with the corresponding layers of the other profile.
</p>


<h3>Usage</h3>

<pre><code class="language-R">warpSP(alignment, whom = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alignment</code></td>
<td>
<p>DTW alignment object from dtwSP containing the two profiles (i.e., called <code>dtwSP(..., keep.internals = TRUE)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whom</code></td>
<td>
<p>whom to warp? "query" (= "jmin"), "imin", "queryTopDown" (= "jminTopDown"), "iminTopDown", "ref";
if 'NA' the routine determines that itself from the structure of the alignment object. (see Details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After this procedure, the thickness of some layers can be zero, which leads to the layers disappearing.
</p>
<p>This function is automatically called in <code>dtwSP(..., keep.internals = TRUE)</code> to warp the query profile
onto the reference profile.
</p>
<p><em>Whom</em> to warp: There exist 8 different options, 4 for warping the query onto the ref and 4 for vice versa.
The 4 options for warping the query onto the ref are:
</p>

<ul>
<li>
<p> global alignment / partial alignment where entire query is matched to subsequence of ref ("jmin")
</p>
</li>
<li>
<p> partial alignment where entire ref is matched to subsequence of query ("imin")
</p>
</li>
<li>
<p> partial top down alignment where entire query is matched to subsequence of ref ("jminTopDown")
</p>
</li>
<li>
<p> partial top down alignment where entire ref is matched to subsequence of query ("iminTopDown")
</p>
</li>
</ul>
<p>For the other case, warping the ref onto the query, only the equivalent of the first option is implemented.
</p>
<p>For developers: Including new variables in the output of warped profiles can easily be done by inserting a respective command
at the end of this function. There are many example variables added already.
</p>


<h3>Value</h3>

<p>Returns the input alignment object including the element alignment$queryWarped (or $referenceWarped),
which are the warped snow profiles. The class of the alignment object is altered to "dtwSP", but still inherits "dtw".
</p>


<h3>Author(s)</h3>

<p>fherla
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## first align profiles
alignment &lt;- dtwSP(SPpairs$A_modeled, SPpairs$A_manual, open.end = FALSE)

## warp reference profile onto query profile:
refWarped &lt;- warpSP(alignment, whom = "ref")$referenceWarped
opar &lt;- par(no.readonly =TRUE)
par(mfrow = c(1, 2))
plot(alignment$query, main = "query")
plot(refWarped, main = "warped reference")
par(opar)

</code></pre>


</div>