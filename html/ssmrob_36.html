<div class="container">

<table style="width: 100%;"><tr>
<td>ssmrob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Sample Selection Model
</h2>

<h3>Description</h3>

<p>Compute robust two-stage estimates of truncated selection model (Tobit-2) and switching regression model (Tobit-5).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssmrob(selection, outcome, data, control = heckitrob.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>

<p>formula, the selection equation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>formula(s), the outcome equation(s)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>ssmrob</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Outcome equation may be a simple formula for the case of Heckman selection model, or a list of two formulas for the case of switching regressions.
</p>


<h3>Value</h3>

<p>Object of class "heckitrob" or object of class "heckit5rob".
</p>


<h3>Author(s)</h3>

<p>Mikhail Zhelonkin, Marc G. Genton, Elvezio Ronchetti
</p>


<h3>References</h3>

<p>Amemiya, T. (1984) Tobit Models: a Survey. <em>Journal of Econometrics</em>, 24, p. 3-61.
</p>
<p>Heckman, J.J. (1979) Sample Selection Bias as a Specification Error. <em>Econometrica</em>, 47, p. 153-161.
</p>
<p>Zhelonkin, M., Genton M.G., and Ronchetti, E. (2016) Robust Inference in Sample Selection Models. <em>Journal of the Royal Statistical Society, Series B</em>, 78, p. 805-827. doi: <a href="https://doi.org/10.1111/rssb.12136">10.1111/rssb.12136</a>
</p>
<p>Zhelonkin, M., Ronchetti, E. (2021) Robust Analysis of Sample Selection Models through the R Package ssmrob. <em>Journal of Statistical Software</em>, 99, 4, p. 1-35. doi: <a href="https://doi.org/10.18637/jss.v099.i04">10.18637/jss.v099.i04</a> 
</p>


<h3>See Also</h3>

<p><code>heckitrob</code>, <code>heckit5rob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sample selection model (Tobit-2)
# Zhelonkin, Genton, Ronchetti (2016): page 823
data(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
meps.fit &lt;- ssmrob(selectEq, outcomeEq, data = MEPS2001, control = heckitrob.control(tcc = 3.2))
summary(meps.fit)

# switching regressions example (Tobit-5)
## Not run: 
library(mvtnorm)
set.seed(2)
N &lt;- 5000
beta1 &lt;- c(0, 1.0, 1.0, 0.75)
beta21 &lt;- c(0, 1.5, 1.0, 0.5)
beta22 &lt;- c(1, -1.5, 1.0, 0.5)
covm &lt;- diag(3)
covm[lower.tri(covm)] &lt;- c(0.75, 0.5, 0.25)
covm[upper.tri(covm)] &lt;- covm[lower.tri(covm)]
eps &lt;- rmvnorm(N, rep(0, 3), covm)
x1 &lt;- rmvnorm(N, mean=c(0, -1, 1), sigma=diag(c(1, 0.5, 1)))
x21 &lt;- x1 
x22 &lt;- x1
x21[, 3] &lt;- rnorm(N, 1, 1)
x22[, 3] &lt;- rnorm(N, 1, 1)
x1beta1 &lt;- beta1[1] + x1[, 1]*beta1[2] + x1[, 2]*beta1[3] + x1[, 3]*beta1[4]
x21beta21 &lt;- beta21[1] + x21[, 1]*beta21[2] + x21[, 2]*beta21[3] + x21[, 3]*beta21[4]
x22beta22 &lt;- beta22[1] + x22[, 1]*beta22[2] + x22[, 2]*beta22[3] + x22[, 3]*beta22[4]
y1 &lt;- ifelse(x1beta1 + eps[, 1] &gt; 0, 1, 0)
y2 &lt;- ifelse(y1 &gt; 0.5, x21beta21 + eps[, 2],
x22beta22 + eps[, 3])
srsim.fit &lt;- ssmrob(y1 ~ x1, list(y2 ~ x21, y2 ~ x22), 
control = heckitrob.control(weights.x1 = "hat", weights.x2 = "covMcd"))
summary(srsim.fit)

## End(Not run)
</code></pre>


</div>