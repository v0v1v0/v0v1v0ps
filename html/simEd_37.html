<div class="container">

<table style="width: 100%;"><tr>
<td>vchisq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variate Generation for Chi-Squared Distribution</h2>

<h3>Description</h3>

<p>Variate Generation for Chi-Squared Distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">vchisq(n, df, ncp = 0, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code>stats::runif</code>
to generate uniform variates to invert via
<code>stats::qchisq</code>;
otherwise, an integer in 1:25 indicates the <code>rstream</code> stream
from which to generate uniform variates to invert via
<code>stats::qchisq</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code>stats::runif</code> or
<code>rstream::rstream.sample</code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates random variates from the chi-squared distribution.
</p>
<p>Chi-Squared variates are generated by inverting uniform(0,1) variates
produced either by <code>stats::runif</code> (if <code>stream</code> is
<code>NULL</code>) or by <code>rstream::rstream.sample</code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code>stats::qchisq</code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vchisq</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The chi-squared distribution with <code>df</code> = <code class="reqn">n \geq 0</code> degrees
of freedom has density
</p>
<div class="sourceCode"><pre>\deqn{f_n(x) = \frac{1}{2^{n/2} \ \Gamma(n/2)} x^{n/2-1} e^{-x/2}}{
          f_n(x) = 1 / (2^(n/2) \Gamma(n/2)) x^(n/2-1) e^(-x/2)}
</pre></div>
<p>for <code class="reqn">x &gt; 0</code>. The mean and variance are <code class="reqn">n</code> and <code class="reqn">2n</code>.
</p>
<p>The non-central chi-squared distribution with <code>df</code> = n degrees of
freedom and non-centrality parameter <code>ncp</code> <code class="reqn">= \lambda</code> has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = e^{-\lambda/2} \sum_{r=0}^\infty \frac{(\lambda/2)^r}{r!} f_{n + 2r}(x)}{
          f(x) = exp(-\lambda/2) SUM_{r=0}^\infty ((\lambda/2)^r / r!) dchisq(x, df + 2r)}
</pre></div>
<p>for <code class="reqn">x \geq 0</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>        A vector of chi-squared random variates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br>
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br>
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code>rstream</code>, <code>set.seed</code>,
<code>stats::runif</code>
</p>
<p><code>stats::rchisq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(3, df = 3, ncp = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(3, 3, stream = 1)
 vchisq(3, 3, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)

 set.seed(8675309)
 variates &lt;- vchisq(100, 3, stream = 1)
 set.seed(8675309)
 variates &lt;- vchisq(100, 3, stream = 1, antithetic = TRUE)

</code></pre>


</div>