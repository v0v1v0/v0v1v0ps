<div class="container">

<table style="width: 100%;"><tr>
<td>estimdep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Dependence estimation
</h2>

<h3>Description</h3>

<p>From a set of observations, builds a description of the multivariate distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimdep(dataframe,varnames,subsampsize,nbsafe=5,mixties=FALSE,nthreads=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataframe</code></td>
<td>

<p>a data frame containing the observations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>

<p>the name of the variables we want to estimate the multivariate distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsampsize</code></td>
<td>

<p>the sub-sample size
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbsafe</code></td>
<td>

<p>the ratio between the discretized copula size and the number of sub-samples
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixties</code></td>
<td>

<p>if <code>TRUE</code>, put equal weight on tied values, using random permutations 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthreads</code></td>
<td>

<p>number of number of threads, assumed to be strictly positive. For "full throttle" computations, consider using parallel::detectCores()</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the description of the dependence, it is an object with the following parts:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>the array representing the discretized copula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>the matrix representing the margins, estimated using kernel density estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>the names of the variables</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jerome Collet
</p>


<h3>Examples</h3>

<pre><code class="language-R">lon=3000
plon=3000
subsampsize=20

##############
x=(runif(lon)-1/2)*3
y=x^2+rnorm(lon)
z=rnorm(lon)
donori=as.data.frame(cbind(x,y,z))
depori=estimdep(donori,c("x","y","z"),subsampsize)

knownvalues=data.frame(z=rnorm(plon))
prev &lt;- predictdep(knownvalues,depori)
plot(prev$x,prev$y,xlim=c(-2,2),ylim=c(-2,5),pch=20,cex=0.5)
points(donori[,1:2],col='red',pch=20,cex=.5)

knownvalues=data.frame(x=(runif(lon)-1/2)*3)
prev &lt;- predictdep(knownvalues,depori)
plot(prev$x,prev$y,xlim=c(-2,2),ylim=c(-2,5),pch=20,cex=0.5)
points(donori[,1:2],col='red',pch=20,cex=.5)

knownvalues=data.frame(y=runif(plon,min=-2,max=4))
prev &lt;- predictdep(knownvalues,depori)
plot(prev$x,prev$y,xlim=c(-2,2),ylim=c(-2,5),pch=20,cex=0.5)
points(donori[,1:2],col='red',pch=20,cex=.5)
</code></pre>


</div>