<div class="container">

<table style="width: 100%;"><tr>
<td>sensitivity_intervals_Dvine</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Sensitivity Intervals</h2>

<h3>Description</h3>

<p><code>sensitivity_intervals_Dvine()</code> computes the estimated intervals of ignorance
and uncertainty within the information-theoretic causal inference framework
when the data are modeled with a D-vine copula model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sensitivity_intervals_Dvine(
  fitted_model,
  sens_results,
  measure = "ICA",
  B = 200,
  alpha = 0.05,
  n_prec = 5000,
  mutinfo_estimator = NULL,
  restr_time = +Inf,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted_model</code></td>
<td>
<p>Returned value from <code>fit_model_SurvSurv()</code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens_results</code></td>
<td>
<p>Dataframe returned by
<code>sensitivity_analysis_SurvSurv_copula()</code>. If additional assumptions need to
be incorporated, this dataframe can first be filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>Compute intervals for which measure of surrogacy? Defaults to
<code>"ICA"</code>. See first column names of <code>sens_results</code> for other possibilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap replications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(numeric) <code>1 - alpha</code> is the level of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_prec</code></td>
<td>
<p>Number of Monte-Carlo samples for the <em>numerical approximation</em>
of the ICA in each replication of the sensitivity analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores used in the sensitivity analysis. The
computations are computationally heavy, and this option can speed things up
considerably.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S3 object of the class <code>sensitivity_intervals_Dvine</code> which can be
printed.
</p>


<h3>Intervals of Ignorance and Uncertainty</h3>

<p>Vansteelandt et al. (2006) formalized sensitivity analysis for partly
identifiable parameters in the context of missing data and MNAR. These
concepts can be applied to the estimation of the ICA. Indeed, the ICA is also
partly identifiable because 50% if the potential outcomes are missing.
</p>
<p>Vansteelandt et al. (2006) replace a point estimate with a interval estimate:
the estimated interval of ignorance. In addition, they proposed several
extension of the classic confidence interval together with appropriate
definitions of coverage; these are termed intervals of uncertainty.
</p>
<p><code>sensitivity_intervals_Dvine()</code> implements the estimated interval of
ignorance and the pointwise and strong intervals of uncertainty. Let <code class="reqn">\boldsymbol{\nu}_l</code>
and <code class="reqn">\boldsymbol{\nu}_u</code> be the values for the sensitivity parameter that
lead to the lowest and largest ICA, respectively, while fixing the identifiable
parameter at its estimated value <code class="reqn">\hat{\boldsymbol{\beta}}</code>. See also
<code>summary_level_bootstrap_ICA()</code>. The following intervals are implemented:
</p>

<ol>
<li> <p><em>Estimated interval of ignorance</em>. This interval is defined as
<code class="reqn">[ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}_l), ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}_u)]</code>.
</p>
</li>
<li> <p><em>Pointiwse interval of uncertainty</em>. Let <code class="reqn">C_l</code> (and <code class="reqn">C_u</code>) be the
lower (and upper) limit of a one-sided <code class="reqn">1 - \alpha</code> CI for
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code> (and
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code>). This interval is then
defined as <code class="reqn">[C_l, C_u]</code> when the ignorance is much larger than the
statistical imprecision.
</p>
</li>
<li> <p><em>Strong interval of uncertainty</em>. Let <code class="reqn">C_l</code> (and <code class="reqn">C_u</code>) be the
lower (and upper) limit of a two-sided <code class="reqn">1 - \alpha</code> CI for
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code> (and
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code>). This interval is then
defined as <code class="reqn">[C_l, C_u]</code>.
</p>
</li>
</ol>
<p>The CIs, which are need for the intervals of uncertainty, are based on
percentile bootstrap confidence intervals, as documented in
<code>summary_level_bootstrap_ICA()</code>. In addition, <code class="reqn">\boldsymbol{\nu}_l</code> is not
known. Therefore, it is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\arg \min_{\boldsymbol{\nu} \in \Gamma} ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}),</code>
</p>

<p>and similarly for <code class="reqn">\boldsymbol{\nu}_u</code>.
</p>


<h3>References</h3>

<p>Vansteelandt, Stijn, et al. "Ignorance and uncertainty regions as inferential
tools in a sensitivity analysis." Statistica Sinica (2006): 953-979.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Illustration with small number of replications and low precision
sens_results = sensitivity_analysis_SurvSurv_copula(fitted_model,
                  n_sim = 5,
                  n_prec = 2000,
                  copula_family2 = "clayton",
                  eq_cond_association = TRUE)
# Compute intervals of ignorance and uncertainty. Again, the number of
# bootstrap replications should be larger in practice.
sensitivity_intervals_Dvine(fitted_model, sens_results, B = 10)

</code></pre>


</div>