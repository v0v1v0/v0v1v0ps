<div class="container">

<table style="width: 100%;"><tr>
<td>sievePHaipw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric Augmented Inverse Probability Weighted Complete-Case Estimation of Coefficients in a Mark-Specific Proportional Hazards Model
with a Multivariate Continuous Mark, Missing-at-Random in Some Failures</h2>

<h3>Description</h3>

<p><code>sievePHaipw</code> implements the semiparametric augmented inverse probability weighted (AIPW) complete-case estimation method of Juraska and Gilbert (2015) for the multivariate mark-
specific hazard ratio, with the mark subject to missingness at random. It extends Juraska and Gilbert (2013) by (i) weighting complete cases (i.e., subjects with complete marks) by the inverse of their estimated
probabilities given auxiliary covariates and/or treatment, and (ii) adding an augmentation term (the conditional expected profile score given auxiliary covariates and/or treatment) to the IPW estimating equations in the density
ratio model for increased efficiency and robustness to mis-specification of the missingness model (Robins et al., 1994). The probabilities of observing the mark are estimated by fitting a logistic regression model with a user-specified linear predictor.
The mean profile score vector (the augmentation term) in the density ratio model is estimated by fitting a linear regression model with a user-specified linear predictor. Coefficients in the treatment-to-placebo mark density ratio model
(Qin, 1998) are estimated by solving the AIPW estimating equations. The ordinary method of maximum partial likelihood estimation is employed for estimating the overall log hazard ratio in the Cox model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sievePHaipw(
  eventTime,
  eventInd,
  mark,
  tx,
  aux = NULL,
  strata = NULL,
  formulaMiss,
  formulaScore
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eventTime</code></td>
<td>
<p>a numeric vector specifying the observed right-censored event time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eventInd</code></td>
<td>
<p>a numeric vector indicating the event of interest (1 if event, 0 if right-censored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>either a numeric vector specifying a univariate continuous mark or a data frame specifying a multivariate continuous mark subject to missingness at random. Missing mark values should be set to <code>NA</code>.
For subjects with <code>eventInd = 0</code>, the value(s) in <code>mark</code> should also be set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tx</code></td>
<td>
<p>a numeric vector indicating the treatment group (1 if treatment, 0 if placebo)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>a data frame specifying auxiliary covariates predictive of the probability of observing the mark. The mark missingness model only requires that the auxiliary covariates be observed in subjects who experienced the event of interest. For subjects with <code>eventInd = 0</code>, the value(s) in <code>aux</code> may be set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a numeric vector specifying baseline strata (<code>NULL</code> by default). If specified, a stratified Cox model is fit for estimating the marginal hazard ratio (i.e., a separate baseline hazard is assumed for each stratum). No stratification is used in estimation of the mark density ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaMiss</code></td>
<td>
<p>a one-sided formula object specifying (on the right side of the <code>~</code> operator) the linear predictor in the logistic regression model used for predicting the probability of observing
the mark. All terms in the formula except <code>tx</code> must be evaluable in the data frame <code>aux</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaScore</code></td>
<td>
<p>a one-sided formula object specifying (on the right side of the <code>~</code> operator) the linear predictor in the linear regression model used for predicting the expected profile score
vector (the augmentation term) in the AIPW estimating equations in the density ratio model. All terms in the formula except <code>tx</code> must be evaluable in the data frame <code>aux</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sievePHaipw</code> considers data from a randomized placebo-controlled treatment efficacy trial with a time-to-event endpoint.
The parameter of interest, the mark-specific hazard ratio, is the ratio (treatment/placebo) of the conditional mark-specific hazard functions.
It factors as the product of the mark density ratio (treatment/placebo) and the ordinary marginal hazard function ignoring mark data.
The mark density ratio is estimated using the AIPW complete-case estimation method, following Robins et al. (1994) and extending Qin (1998), and
the marginal hazard ratio is estimated using <code>coxph()</code> in the <code>survival</code> package.
The asymptotic properties of the AIPW complete-case estimator are detailed in Juraska and Gilbert (2015).
</p>


<h3>Value</h3>

<p>An object of class <code>sievePH</code> which can be processed by
<code>summary.sievePH</code> to obtain or print a summary of the results. An object of class
<code>sievePH</code> is a list containing the following components:
</p>

<ul>
<li> <p><code>DRcoef</code>: a numeric vector of estimates of coefficients <code class="reqn">\phi</code> in the weight function <code class="reqn">g(v, \phi)</code> in the density ratio model
</p>
</li>
<li> <p><code>DRlambda</code>: an estimate of the Lagrange multiplier in the profile score functions for <code class="reqn">\phi</code> (that arises by profiling out the nuisance parameter)
</p>
</li>
<li> <p><code>DRconverged</code>: a logical value indicating whether the estimation procedure in the density ratio model converged
</p>
</li>
<li> <p><code>logHR</code>: an estimate of the marginal log hazard ratio from <code>coxph()</code> in the <code>survival</code> package
</p>
</li>
<li> <p><code>cov</code>: the estimated joint covariance matrix of <code>DRcoef</code> and <code>logHR</code>
</p>
</li>
<li> <p><code>coxphFit</code>: an object returned by the call of <code>coxph()</code>
</p>
</li>
<li> <p><code>nPlaEvents</code>: the number of events observed in the placebo group
</p>
</li>
<li> <p><code>nTxEvents</code>: the number of events observed in the treatment group
</p>
</li>
<li> <p><code>mark</code>: the input object
</p>
</li>
<li> <p><code>tx</code>: the input object
</p>
</li>
</ul>
<h3>References</h3>

<p>Juraska, M., and Gilbert, P. B. (2015), Mark-specific hazard ratio model with missing multivariate marks. <em>Lifetime Data Analysis</em> 22(4): 606-25.
</p>
<p>Juraska, M. and Gilbert, P. B. (2013), Mark-specific hazard ratio model with multivariate continuous marks: an application to vaccine efficacy. <em>Biometrics</em> 69(2):328-337.
</p>
<p>Qin, J. (1998), Inferences for case-control and semiparametric two-sample density ratio models. <em>Biometrika</em> 85, 619-630.
</p>
<p>Robins, J. M., Rotnitzky, A., and Zhao, L. P. (1994), Estimation of regression coefficients when some regressors are not always observed. <em>Journal of the American Statistical Association</em> 89(427): 846-866.
</p>


<h3>See Also</h3>

<p><code>summary.sievePH</code>, <code>plot.summary.sievePH</code>, <code>testIndepTimeMark</code> and <code>testDensRatioGOF</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
tx &lt;- rep(0:1, each=n / 2)
tm &lt;- c(rexp(n / 2, 0.2), rexp(n / 2, 0.2 * exp(-0.4)))
cens &lt;- runif(n, 0, 15)
eventTime &lt;- pmin(tm, cens, 3)
eventInd &lt;- as.numeric(tm &lt;= pmin(cens, 3))
mark1 &lt;- ifelse(eventInd==1, c(rbeta(n / 2, 2, 5), rbeta(n / 2, 2, 2)), NA)
mark2 &lt;- ifelse(eventInd==1, c(rbeta(n / 2, 1, 3), rbeta(n / 2, 5, 1)), NA)
# a continuous auxiliary covariate
A &lt;- (mark1 + 0.4 * runif(n)) / 1.4
linPred &lt;- -0.8 + 0.4 * tx + 0.8 * A
probs &lt;- exp(linPred) / (1 + exp(linPred))
R &lt;- rep(NA, length(probs))
while (sum(R, na.rm=TRUE) &lt; 10){
  R[eventInd==1] &lt;- sapply(probs[eventInd==1], function(p){ rbinom(1, 1, p) })
}
# produce missing-at-random marks
mark1[eventInd==1] &lt;- ifelse(R[eventInd==1]==1, mark1[eventInd==1], NA)
mark2[eventInd==1] &lt;- ifelse(R[eventInd==1]==1, mark2[eventInd==1], NA)

# fit a model with a bivariate mark
fit &lt;- sievePHaipw(eventTime, eventInd, mark=data.frame(mark1, mark2), tx,
                   aux=data.frame(A), formulaMiss= ~ tx * A, formulaScore= ~ tx * A + I(A^2))

</code></pre>


</div>