<div class="container">

<table style="width: 100%;"><tr>
<td>Gen_Data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data simulator for high-dimensional GLMs</h2>

<h3>Description</h3>

<p>This function generates synthetic datasets from GLMs with a user-specified correlation structure.
It permits both numerical and categorical features, whose quantity can be larger than the sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Gen_Data(
  n = 200,
  p = 1000,
  sigma = 1,
  num_ctgidx = NULL,
  pos_ctgidx = NULL,
  num_truecoef = NULL,
  pos_truecoef = NULL,
  level_ctgidx = NULL,
  effect_truecoef = NULL,
  correlation = c("ID", "AR", "MA", "CS"),
  rho = 0.2,
  family = c("gaussian", "binomial", "poisson")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size, number of rows for the feature matrix to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of columns for the feature matrix to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Parameter for noise level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_ctgidx</code></td>
<td>
<p>The number of features that are categorical. Set to <code>FALSE</code> for only numerical features. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_ctgidx</code></td>
<td>
<p>Vector of indices denoting which columns are categorical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_truecoef</code></td>
<td>
<p>The number of features (columns) that affect response. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_truecoef</code></td>
<td>
<p>Vector of indices denoting which features (columns) affect the response variable. 
If not specified, positions are randomly sampled. See Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level_ctgidx</code></td>
<td>
<p>Vector to indicate the number of levels for the categorical features in <code>pos_ctgidx</code>. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_truecoef</code></td>
<td>
<p>Effect size corresponding to the features in <code>pos_truecoef</code>. 
If not specified, effect size is sampled based on a uniform distribution and direction is randomly sampled. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>Correlation structure among features. <code>correlation = "ID"</code> for independent,
<code>correlation = 'MA'</code> for moving average, <code>correlation = "CS"</code> for compound symmetry, <code>correlation = "AR"</code> 
for auto regressive. Default is <code>"ID"</code>. For more information see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Parameter controlling the correlation strength, default is <code>0.2</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Model type for the response variable.
<code>"gaussian"</code> for normally distributed data, <code>poisson</code> for non-negative counts,
<code>"binomial"</code> for binary (0-1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulated data <code class="reqn">(y_i , x_i)</code> where <code class="reqn"> x_i = (x_{i1},x_{i2} , . . . , x_{ip})</code> are generated as follows:
First, we generate a <code class="reqn">p</code> by <code class="reqn">1</code> model coefficient vector beta with all 
entries being zero, except for the positions specified in <code>pos_truecoef</code>,
on which <code>effect_truecoef</code> is used. When <code>pos_truecoef</code> is not specified, 
we randomly choose <code>num_truecoef</code> positions from the coefficient
vector. When <code>effect_truecoef</code> is not specified, we randomly set the strength 
of the true model coefficients as follow:
</p>
<p style="text-align: center;"><code class="reqn">(0.5+U) Z,</code>
</p>

<p>where <code class="reqn">U</code> is sampled from a uniform distribution from 0 to 1,  
and <code class="reqn">Z</code> is sampled from a binomial distribution <code class="reqn">P(Z=1)=1/2,P(Z=-1)=1/2</code>.
</p>
<p>Next, we generate a <code class="reqn">n</code> by <code class="reqn">p</code> feature matrix <code class="reqn">X</code> according to the model selected with
<code>correlation</code> and specified as follows.
</p>
<p>Independent (ID):  all features are independently generated from <code class="reqn">N( 0, 1)</code>.
</p>
<p>Moving average (MA): candidate features <code class="reqn">x_1,..., x_p</code> are joint normal,
marginally <code class="reqn">N( 0, 1)</code>, with
</p>
<p><code class="reqn">cov(x_j, x_{j-1}) = \rho</code>, <code class="reqn">cov(x_j, x_{j-2}) = \rho/2</code> and <code class="reqn">cov(x_j, x_h) = 0</code> for <code class="reqn">|j-h|&gt;3</code>.
</p>
<p>Compound symmetry (CS): candidate features <code class="reqn">x_1,..., x_p</code> are joint normal,
marginally <code class="reqn">N( 0, 1)</code>, with <code class="reqn">cov(x_j, x_h) =\rho/2</code> if <code class="reqn">j</code>, <code class="reqn">h</code>
are both in the set of important features and <code class="reqn">cov(x_j, x_h)=\rho</code> when only
one of <code class="reqn">j</code> or <code class="reqn">h</code> are in the set of important features.
</p>
<p>Auto-regressive (AR): candidate features <code class="reqn">x_1,..., x_p</code> are joint normal, marginally <code class="reqn">N( 0, 1)</code>, with
</p>
<p><code class="reqn">cov(x_j, x_h) = \rho^{|j-h|}</code> for all <code class="reqn">j</code> and <code class="reqn">h</code>. The correlation strength <code class="reqn">\rho</code> is controlled by the argument <code>rho</code>. 
</p>
<p>Then, we generate the response variable <code class="reqn">Y</code> according to its response type, which is controlled by the argument <code>family</code>
For the Gaussian model, <code class="reqn">y_i =x_i\beta + \epsilon_i</code> where <code class="reqn">\epsilon_i</code> is <code class="reqn">N( 0, 1)</code> for <code class="reqn">i</code> from <code class="reqn">1</code> to <code class="reqn">n</code>. 
For the binary model let <code class="reqn">\pi_i = P(Y = 1|x_i)</code>. We sample <code class="reqn">y_i</code> from Bernoulli(<code class="reqn">\pi_i</code>) where logit<code class="reqn">(\pi_i) = x_i \beta</code>.
Finally, for the Poisson model, <code class="reqn">y_i</code> is generated from the Poisson distribution with the link <code class="reqn">\pi_i</code> = exp<code class="reqn">(x_i\beta )</code>.
For more details see the reference below.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Feature matrix or data.frame (matrix if <code>num_ctgidx =FALSE</code> and data.frame otherwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_true</code></td>
<td>
<p>Vector of column indices of X for the features that affect the response variables (relevant features).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_true</code></td>
<td>
<p>Vector of effects for the features that affect the response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>Logical flag whether the model contains categorical features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Indices of categorical features when <code>categorical = TRUE</code>.</p>
</td>
</tr>
</table>
<p>rho,family,correlation are return of arguments passed in the function call.
</p>


<h3>References</h3>

<p>Xu, C. and Chen, J. (2014). The Sparse MLE for Ultrahigh-Dimensional Feature
Screening, <em>Journal of the American Statistical Association</em>, <b>109</b>(507), 1257-1269
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Simulating data with binomial response and auto-regressive structure.
set.seed(1)
Data &lt;- Gen_Data(n = 500, p = 2000, family = "binomial", correlation = "AR")
cor(Data$X[,1:5])
print(Data)


</code></pre>


</div>