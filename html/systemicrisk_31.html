<div class="container">

<table style="width: 100%;"><tr>
<td>sample_HierarchicalModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample from Hierarchical Model with given Row and Column Sums</h2>

<h3>Description</h3>

<p>Sample from Hierarchical Model with given Row and Column Sums
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_HierarchicalModel(
  l,
  a,
  L_fixed = NA,
  model,
  nsamples = 10000,
  thin = choosethin(l = l, a = a, L_fixed = L_fixed, model = model, matrpertheta =
    matrpertheta, silent = silent),
  burnin = NA,
  matrpertheta = length(l)^2,
  silent = FALSE,
  tol = .Machine$double.eps^0.25
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>observed row sum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>observerd column sum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L_fixed</code></td>
<td>
<p>Matrix containing known values of L, where NA
signifies that an element is not known. If <code>L_fixed</code> equates
to <code>NA</code> (the default) then no values are assumed to be known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Underlying model for p and lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>number of samples to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>how many updates of theta to perform before outputting a sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of iterations for the burnin. Defaults to 5
of the steps in the sampling part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrpertheta</code></td>
<td>
<p>number of matrix updates per update of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(default FALSE) suppress all output (including progress bars).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance used in checks for equality. Defaults to <code>.Machine$double.eps^0.25</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The resulting samples. A list with the first element, L, giving the samples of matrices, and the second element, theta, giving the samples of the hyperparameter (if hyperparameters are present).
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 10
m &lt;- Model.Indep.p.lambda(Model.p.BetaPrior(n),
                          Model.lambda.GammaPrior(n,scale=1e-1))
x &lt;- genL(m)
l &lt;- rowSums(x$L)
a &lt;- colSums(x$L)

res &lt;- sample_HierarchicalModel(l,a,model=m)

# fixing one values
L_fixed &lt;- matrix(NA,ncol=n,nrow=n)
L_fixed[1,2:5] &lt;- x$L[1,2:5]

res &lt;- sample_HierarchicalModel(l,a,model=m,L_fixed=L_fixed,
                                nsamples=1e2)
sapply(res$L,function(x)x[1,2:5])


</code></pre>


</div>