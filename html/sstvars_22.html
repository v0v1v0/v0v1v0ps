<div class="container">

<table style="width: 100%;"><tr>
<td>diag_Omegas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simultaneously diagonalize two covariance matrices</h2>

<h3>Description</h3>

<p><code>diag_Omegas</code> Simultaneously diagonalizes two covariance matrices using
eigenvalue decomposition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diag_Omegas(Omega1, Omega2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Omega1</code></td>
<td>
<p>a positive definite <code class="reqn">(dxd)</code> covariance matrix <code class="reqn">(d&gt;1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega2</code></td>
<td>
<p>another positive definite <code class="reqn">(dxd)</code> covariance matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the return value and Muirhead (1982), Theorem A9.9 for details.
</p>


<h3>Value</h3>

<p>Returns a length <code class="reqn">d^2 + d</code> vector where the first <code class="reqn">d^2</code> elements
are <code class="reqn">vec(W)</code> with the columns of <code class="reqn">W</code> being (specific) eigenvectors of
the matrix <code class="reqn">\Omega_2\Omega_1^{-1}</code> and the rest <code class="reqn">d</code> elements are the
corresponding eigenvalues "lambdas". The result satisfies <code class="reqn">WW' = Omega1</code> and
<code class="reqn">Wdiag(lambdas)W' = Omega2</code>.
</p>
<p>If <code>Omega2</code> is not supplied, returns a vectorized symmetric (and pos. def.)
square root matrix of <code>Omega1</code>.
</p>


<h3>Warning</h3>

<p>No argument checks! Does not work with dimension <code class="reqn">d=1</code>!
</p>


<h3>References</h3>


<ul><li>
<p> Muirhead R.J. 1982. Aspects of Multivariate Statistical Theory, <em>Wiley</em>.
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R"># Create two (2x2) coviance matrices using the parameters W and lambdas:
d &lt;- 2 # The dimension
W0 &lt;- matrix(1:(d^2), nrow=2) # W
lambdas0 &lt;- 1:d # The eigenvalues
(Omg1 &lt;- W0%*%t(W0)) # The first covariance matrix
(Omg2 &lt;- W0%*%diag(lambdas0)%*%t(W0)) # The second covariance matrix

# Then simultaneously diagonalize the covariance matrices:
res &lt;- diag_Omegas(Omg1, Omg2)

# Recover W:
W &lt;- matrix(res[1:(d^2)], nrow=d, byrow=FALSE)
tcrossprod(W) # == Omg1, the first covariance matrix

# Recover lambdas:
lambdas &lt;- res[(d^2 + 1):(d^2 + d)]
W%*%diag(lambdas)%*%t(W) # == Omg2, the second covariance matrix
</code></pre>


</div>