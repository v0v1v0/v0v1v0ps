<div class="container">

<table style="width: 100%;"><tr>
<td>sda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse discriminant analysis</h2>

<h3>Description</h3>

<p>Performs sparse linear discriminant analysis. Using an alternating minimization algorithm to minimize the SDA
criterion.</p>


<h3>Usage</h3>

<pre><code class="language-R">sda(x, ...)

## Default S3 method:
sda(x, y, lambda = 1e-6, stop = -p, maxIte = 100,
    Q = K-1, trace = FALSE, tol = 1e-6, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of the training data with observations down the rows and variables in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix initializing the dummy variables
representing the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The weight on the L2-norm for elastic net
regression. Default: 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>If STOP is negative, its absolute value
corresponds to the desired number of variables. If STOP is
positive, it corresponds to an upper bound on the L1-norm of the b
coefficients. There is a one to one correspondence between stop
and t. The default is -p (-the number of variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIte</code></td>
<td>
<p>Maximum number of iterations. Default: 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Number of components. Maximum and default is K-1 (the number of classes less one).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If TRUE, prints out its progress. Default:
FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance for the stopping criterion (change in RSS). Default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function finds sparse directions for linear classification.
</p>


<h3>Value</h3>

<p>Returns a list with the following attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The loadings of the sparse discriminative
directions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The optimal scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss</code></td>
<td>
<p>A vector of the Residual Sum of Squares at
each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varNames</code></td>
<td>
<p>Names on included variables</p>
</td>
</tr>
</table>
<p>.
</p>


<h3>Author(s)</h3>

<p>Line Clemmensen, modified by Trevor Hastie</p>


<h3>References</h3>

<p>Clemmensen, L., Hastie, T. Witten, D. and Ersboell, K. (2011) "Sparse discriminant
analysis", Technometrics, To appear.
</p>


<h3>See Also</h3>

<p><code>normalize, normalizetest, smda</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data
data(penicilliumYES)

X &lt;- penicilliumYES$X
Y &lt;- penicilliumYES$Y
colnames(Y) &lt;- c("P. Melanoconidium",
                 "P. Polonicum",
                 "P. Venetum")

## test samples
Iout&lt;-c(3,6,9,12)
Iout&lt;-c(Iout,Iout+12,Iout+24)

## training data
Xtr&lt;-X[-Iout,]
k&lt;-3
n&lt;-dim(Xtr)[1]

## Normalize data
Xc&lt;-normalize(Xtr)
Xn&lt;-Xc$Xc
p&lt;-dim(Xn)[2]

## Perform SDA with one non-zero loading for each discriminative
## direction with Y as matrix input
out &lt;- sda(Xn, Y,
           lambda = 1e-6,
           stop = -1,
           maxIte = 25,
           trace = TRUE)

## predict training samples
train &lt;- predict(out, Xn)

## testing
Xtst&lt;-X[Iout,]
Xtst&lt;-normalizetest(Xtst,Xc)

test &lt;- predict(out, Xtst)
print(test$class)

## Factor Y as input
Yvec &lt;- factor(rep(colnames(Y), each = 8))
out2 &lt;- sda(Xn, Yvec,
            lambda = 1e-6,
            stop = -1,
            maxIte = 25,
            trace = TRUE)
</code></pre>


</div>