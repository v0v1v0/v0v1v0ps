<div class="container">

<table style="width: 100%;"><tr>
<td>semPower.genSigma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>semPower.genSigma</h2>

<h3>Description</h3>

<p>Generate a covariance matrix (and a mean vector) and associated <code>lavaan</code> model strings based on CFA or SEM model matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semPower.genSigma(
  Lambda = NULL,
  Phi = NULL,
  Beta = NULL,
  Psi = NULL,
  Theta = NULL,
  tau = NULL,
  Alpha = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>factor loading matrix. A list for multiple group models. Can also be specified using various shortcuts, see <code>genLambda()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>for CFA models, factor correlation (or covariance) matrix or single number giving the correlation between all factors or <code>NULL</code> for uncorrelated factors. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>for SEM models, matrix of regression slopes between latent variables (all-y notation). A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>for SEM models, variance-covariance matrix of latent residuals when <code>Beta</code> is specified. If <code>NULL</code>, a diagonal matrix is assumed. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>variance-covariance matrix between manifest residuals. If <code>NULL</code> and <code>Lambda</code> is not a square matrix, <code>Theta</code> is diagonal so that the manifest variances are 1. If <code>NULL</code> and <code>Lambda</code> is square, <code>Theta</code> is 0. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>vector of intercepts. If <code>NULL</code> and <code>Alpha</code> is set, these are assumed to be zero. If both <code>Alpha</code> and <code>tau</code> are <code>NULL</code>, no means are returned. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>vector of factor means. If <code>NULL</code> and <code>tau</code> is set, these are assumed to be zero. If both <code>Alpha</code> and <code>tau</code> are <code>NULL</code>, no means are returned. A list for multiple group models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates the variance-covariance matrix of the <code class="reqn">p</code> observed variables <code class="reqn">\Sigma</code> and their means <code class="reqn">\mu</code> via a confirmatory factor (CFA) model or a more general structural equation model.
</p>
<p>In the CFA model,
</p>
<p style="text-align: center;"><code class="reqn">\Sigma = \Lambda \Phi \Lambda' + \Theta</code>
</p>

<p>where <code class="reqn">\Lambda</code> is the <code class="reqn">p \cdot m</code> loading matrix, <code class="reqn">\Phi</code> is the variance-covariance matrix of the <code class="reqn">m</code> factors, and <code class="reqn">\Theta</code> is the residual variance-covariance matrix of the observed variables. The means are
</p>
<p style="text-align: center;"><code class="reqn">\mu = \tau + \Lambda \alpha</code>
</p>

<p>with the <code class="reqn">p</code> indicator intercepts <code class="reqn">\tau</code> and the <code class="reqn">m</code> factor means <code class="reqn">\alpha</code>.
</p>
<p>In the structural equation model,
</p>
<p style="text-align: center;"><code class="reqn">\Sigma = \Lambda (I - B)^{-1} \Psi [(I - B)^{-1}]'  \Lambda' + \Theta </code>
</p>

<p>where <code class="reqn">B</code> is the <code class="reqn">m \cdot m</code> matrix containing the regression slopes and <code class="reqn">\Psi</code> is the (residual) variance-covariance matrix of the <code class="reqn">m</code> factors. The means are
</p>
<p style="text-align: center;"><code class="reqn">\mu = \tau + \Lambda (I - B)^{-1} \alpha</code>
</p>

<p>In either model, the meanstructure can be omitted, leading to factors with zero means and zero intercepts.
</p>
<p>When <code class="reqn">\Lambda = I</code>, the models above do not contain any factors and reduce to ordinary regression or path models.
</p>
<p>If <code>Phi</code> is defined, a CFA model is used, if <code>Beta</code> is defined, a structural equation model.
When both <code>Phi</code> and <code>Beta</code> are <code>NULL</code>, a CFA model is used with <code class="reqn">\Phi = I</code>, i. e., uncorrelated factors.
When <code>Phi</code> is a single number, all factor correlations are equal to this number.
</p>
<p>When <code>Beta</code> is defined and <code>Psi</code> is <code>NULL</code>, <code class="reqn">\Psi = I</code>.
</p>
<p>When <code>Theta</code> is <code>NULL</code>, <code class="reqn">\Theta</code> is a diagonal matrix with all elements such that the variances of the observed variables are 1. When there is only a single observed indicator for a factor, the corresponding element in <code class="reqn">\Theta</code> is set to zero.
</p>
<p>Instead of providing the loading matrix <code class="reqn">\Lambda</code> via <code>Lambda</code>, there are several shortcuts (see <code>genLambda()</code>):
</p>

<ul>
<li> <p><code>loadings</code>: defines the primary loadings for each factor in a list structure, e. g. <code>loadings = list(c(.5, .4, .6), c(.8, .6, .6, .4))</code> defines a two factor model with three indicators loading on the first factor by .5, , 4., and .6, and four indicators loading in the second factor by .8, .6, .6, and .4.
</p>
</li>
<li> <p><code>nIndicator</code>: used in conjunction with <code>loadM</code> or <code>loadMinmax</code>, defines the number of indicators by factor, e. g., <code>nIndicator = c(3, 4)</code> defines a two factor model with three and four indicators for the first and second factor, respectively. <code>nIndicator</code> can also be a single number to define the same number of indicators for each factor.
</p>
</li>
<li> <p><code>loadM</code>: defines the mean loading either for all indicators (if a single number is provided) or separately for each factor (if a vector is provided), e. g. <code>loadM = c(.5, .6)</code> defines the mean loadings of the first factor to equal .5 and those of the second factor do equal .6
</p>
</li>
<li> <p><code>loadSD</code>: used in conjunction with <code>loadM</code>, defines the standard deviations of the loadings. If omitted or NULL, the standard deviations are zero. Otherwise, the loadings are sampled from a normal distribution with N(loadM, loadSD) for each factor.
</p>
</li>
<li> <p><code>loadMinMax</code>: defines the minimum and maximum loading either for all factors or separately for each factor (as a list). The loadings are then sampled from a uniform distribution. For example, <code>loadMinMax = list(c(.4, .6), c(.4, .8))</code> defines the loadings for the first factor lying between .4 and .6, and those for the second factor between .4 and .8.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Returns a list (or list of lists for multiple group models) containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>implied variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>implied means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>loading matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>covariance matrix of latent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>matrix of regression slopes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi</code></td>
<td>
<p>residual covariance matrix of latent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>residual covariance matrix of observed variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>intercepts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>factor means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelPop</code></td>
<td>
<p><code>lavaan</code> model string defining the population model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelTrue</code></td>
<td>
<p><code>lavaan</code> model string defining the "true" analysis model freely estimating all non-zero parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelTrueCFA</code></td>
<td>
<p><code>lavaan</code> model string defining a model similar to <code>modelTrue</code>, but purely CFA based and thus omitting any regression relationships.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# single factor model with five indicators each loading by .5
gen &lt;- semPower.genSigma(nIndicator = 5, loadM = .5)
gen$Sigma     # implied covariance matrix
gen$modelTrue # analysis model string
gen$modelPop  # population model string

# orthogonal two factor model with four and five indicators each loading by .5
gen &lt;- semPower.genSigma(nIndicator = c(4, 5), loadM = .5)

# correlated (r = .25) two factor model with 
# four indicators loading by .7 on the first factor 
# and five indicators loading by .6 on the second factor
gen &lt;- semPower.genSigma(Phi = .25, nIndicator = c(4, 5), loadM = c(.7, .6))

# correlated three factor model with variying indicators and loadings, 
# factor correlations according to Phi
Phi &lt;- matrix(c(
  c(1.0, 0.2, 0.5),
  c(0.2, 1.0, 0.3),
  c(0.5, 0.3, 1.0)
), byrow = TRUE, ncol = 3)
gen &lt;- semPower.genSigma(Phi = Phi, nIndicator = c(3, 4, 5), 
                         loadM = c(.7, .6, .5))

# same as above, but using a factor loadings matrix
Lambda &lt;- matrix(c(
  c(0.8, 0.0, 0.0),
  c(0.7, 0.0, 0.0),
  c(0.6, 0.0, 0.0),
  c(0.0, 0.7, 0.0),
  c(0.0, 0.8, 0.0),
  c(0.0, 0.5, 0.0),
  c(0.0, 0.4, 0.0),
  c(0.0, 0.0, 0.5),
  c(0.0, 0.0, 0.4),
  c(0.0, 0.0, 0.6),
  c(0.0, 0.0, 0.4),
  c(0.0, 0.0, 0.5)
), byrow = TRUE, ncol = 3)
gen &lt;- semPower.genSigma(Phi = Phi, Lambda = Lambda)

# same as above, but using a reduced loading matrix, i. e.
# only define the primary loadings for each factor
loadings &lt;- list(
  c(0.8, 0.7, 0.6),
  c(0.7, 0.8, 0.5, 0.4),
  c(0.5, 0.4, 0.6, 0.4, 0.5)
)
gen &lt;- semPower.genSigma(Phi = Phi, loadings = loadings)

# Provide Beta for a three factor model
# with 3, 4, and 5 indicators 
# loading by .6, 5, and .4, respectively.
Beta &lt;- matrix(c(
                c(0.0, 0.0, 0.0),
                c(0.3, 0.0, 0.0),  # f2 = .3*f1
                c(0.2, 0.4, 0.0)   # f3 = .2*f1 + .4*f2
               ), byrow = TRUE, ncol = 3)
gen &lt;- semPower.genSigma(Beta = Beta, nIndicator = c(3, 4, 5), 
                         loadM = c(.6, .5, .4))

# two group example: 
# correlated two factor model (r = .25 and .35 in the first and second group, 
# respectively)
# the first factor is indicated by four indicators loading by .7 in the first 
# and .5 in the second group,
# the second factor is indicated by five indicators loading by .6 in the first 
# and .8 in the second group,
# all item intercepts are zero in both groups, 
# the latent means are zero in the first group
# and .25 and .10 in the second group.
gen &lt;- semPower.genSigma(Phi = list(.25, .35), 
                         nIndicator = list(c(4, 5), c(4, 5)), 
                         loadM = list(c(.7, .6), c(.5, .8)), 
                         tau = list(rep(0, 9), rep(0, 9)), 
                         Alpha = list(c(0, 0), c(.25, .10))
                         )
gen[[1]]$Sigma  # implied covariance matrix group 1 
gen[[2]]$Sigma  # implied covariance matrix group 2
gen[[1]]$mu     # implied means group 1 
gen[[2]]$mu     # implied means group 2

## End(Not run)
</code></pre>


</div>