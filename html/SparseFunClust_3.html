<div class="container">

<table style="width: 100%;"><tr>
<td>SparseFunClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Sparse Functional Clustering &amp; Alignment</h2>

<h3>Description</h3>

<p>Compute Sparse Functional Clustering &amp; Alignment
</p>


<h3>Usage</h3>

<pre><code class="language-R">SparseFunClust(
  data,
  x,
  K,
  do.alignment,
  funct.measure = "L2",
  clust.method = "kmea",
  m.prop = 0.3,
  tuning.m = FALSE,
  tuning.par = list(mbound = NULL, nperm = 20),
  perc = 0.03,
  tol = 0.01,
  template.est = "raw",
  n.out = 500,
  iter.max = 50,
  vignette = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>matrix representing the functions (n x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix giving the domain of each function (n x p), or a
p-dimensional vector giving the common domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.alignment</code></td>
<td>
<p>boolean (should alignment be performed?)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funct.measure</code></td>
<td>
<p>the functional measure to be used to compare the
functions in both the clustering and alignment procedures;
can be 'L2' or 'H1' (default 'L2'); see Vitelli (2019) for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust.method</code></td>
<td>
<p>the clustering method to be used; can be:
'kmea' for k-means clustering,'pam','hier' for hierarchical clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.prop</code></td>
<td>
<p>the sparsity parameter (proportion of unrelevant domain
where w(x) = 0); default 30%</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.m</code></td>
<td>
<p>boolean (should the sparsity parameter be tuned via a
permutation-based approach?)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.par</code></td>
<td>
<p>list of settings for the tuning of the sparsity parameter
(defaults to <code>list(mbound = NULL, nperm = 20)</code>: mbound = max value of
the sparsity parameter to be tested, default 60%; nperm = number of
permutations to be performed in the tuning, default 20</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>alignment parameter (max proportion of shift / dilation at each iter
of the warping procedure) â€“&gt; (default 3%)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance criterion on the weighting function to exit the loop (default 1%)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template.est</code></td>
<td>
<p>text string giving choices for the template estimation method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.out</code></td>
<td>
<p>number of abscissa points on which w(x) is estimated (default 500)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>maximum number of iterations of the clustering loop (default 50)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vignette</code></td>
<td>
<p>boolean (should the algorithm progress be reported?)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list, with elements:
</p>

<dl>
<dt>template</dt>
<dd>
<p>matrix (dim=K x n.out) with the final cluster templates</p>
</dd>
<dt>temp.abscissa</dt>
<dd>
<p>vector (length=n.out) of the abscissa values on which the template is defined</p>
</dd>
<dt>labels</dt>
<dd>
<p>vector (length=n) of the cluster assignments</p>
</dd>
<dt>warping</dt>
<dd>
<p>matrix (dim=n x 2) with the intercept (1st column) and slope (2nd column)
of the estimated warping function for each of the n curves</p>
</dd>
<dt>reg.abscissa</dt>
<dd>
<p>matrix (dim=n x n.out) of each of the n curves registered abscissa</p>
</dd>
<dt>distance</dt>
<dd>
<p>vector (length=n) of each curve's final distance to the assigned cluster template</p>
</dd>
<dt>w</dt>
<dd>
<p>vector (length=n.out) of the estimated weighting function w(x)</p>
</dd>
<dt>x.bcss</dt>
<dd>
<p>vector (length=n.out) of the final point-wise between-cluster sum-of-squares</p>
</dd>
</dl>
<h3>Note</h3>

<p><code>data</code>:
</p>

<ol>
<li>
<p> assumed to be a vectorized version of the functional data AFTER smoothing
</p>
</li>
<li>
<p> when using the H1 functional measure, assumed to include the
functions FIRST DERIVATIVES
</p>
</li>
<li>
<p> when using the H1 functional measure, it supports multidimensional
functions R -&gt; R^d, then data can be an array (n x p x d)]
</p>
</li>
</ol>
<p><code>funct.measure</code>: 'H1' only supported with alignment
</p>
<p><code>clust.method</code>: 'pam' and 'hier' only supported for the case of
NO ALIGNMENT
</p>
<p><code>m.prop</code>: needs to be a proportion for compatibility with alignment,
values &gt; 1 not supported
</p>
<p><code>tuning.m</code>: tuning only supported for the case of NO ALIGNMENT
</p>
<p><code>tuning.par</code>:
</p>

<ul>
<li> <p><code>mbound</code> must be lower than 1; the minimal value tested is 0
</p>
</li>
<li> <p><code>nperm</code> &gt; 50 is unadvisable for computational reasons
</p>
</li>
</ul>
<p><code>perc</code>: 5% is already extreme; don't set this above 8-10%
</p>
<p><code>template.est</code>:
</p>

<ol>
<li>
<p> only supported with H1 measure + ALIGNMENT
</p>
</li>
<li>
<p> currently 2 choices are supported:'raw' or 'loess'. 'raw' just
computes the vector means across functions (default choice); 'loess'
estimates the template via the R loess function
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(8988327)
x &lt;- seq(0, 1, len = 500)
out &lt;- generate.data.FV17(50, x)
result &lt;- SparseFunClust(out$data, x, K = 2, do.alignment = FALSE)
str(result)
</code></pre>


</div>