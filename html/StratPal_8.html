<div class="container">

<table style="width: 100%;"><tr>
<td>p3_var_rate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>simulate variable rate Poisson point process</h2>

<h3>Description</h3>

<p>simulates events based on a variable rate Poisson point process. Rates can be either specified by a function passed to <code>x</code>, or by providing two vectors <code>x</code> and <code>y</code>. In this case the rate is specified by <code>approxfun(x, y, rule = 2)</code>, i.e. by linear interpolation between the values of x (abscissa) and y (ordinate). See <code>?approxfun</code> for details.
In the context of paleontology, these events can be interpreted as fossil occurrences or first/last occurrences of species. In this case, the rate is the average number of fossil occurrences (resp first/last occurrences) per unit
</p>


<h3>Usage</h3>

<pre><code class="language-R">p3_var_rate(x, y = NULL, from = 0, to = 1, f_max = 1, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector or function. If x is a function, it is used to specify the variable rate. If x is a vector, x and y together specify the variable rate using linear interpolation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector or NULL. If not NULL, determines the variable rate. This is done by using linear interpolation between the values of y. Here x specifies the ordinate and y the abscissa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>lower boundary of the observed interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>upper boundary of the observed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_max</code></td>
<td>
<p>maximum value of <code>x</code> in the interval from <code>x_min</code> to <code>x_max</code>. If x attains values larger than <code>f_max</code> a warning is throw, <code>f_max</code> is adjusted, and sampling is started again</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>NULL or an integer. Number of events drawn. If NULL, the number of events is determined by the rate (specified by x and y). If an integer is passed, n events are returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric vector, timing/location of events. Depending on the modeling framework, these events can represent location/age of fossils, or first/last occurrences of a group of taxa.
</p>


<h3>See Also</h3>

<p><code>p3()</code> for the constant rate implementation, <code>rej_samp()</code> for the underlying random number generation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# assuming events are fossil occurrences
# then rate is the avg rate of fossil occ. per unit
#linear decrease in rate from 50 at x = 0 to 0 at x = 1
x = c(0, 1)
y = c(50, 0)
s = p3_var_rate(x, y, f_max = 50)
hist(s, xlab = "Time (myr)", main = "Fossil Occurrences")
# conditioned to return 100 samples
s = p3_var_rate(x, y, f_max = 50, n = 100)
# hand over function
s = p3_var_rate(x = sin, from = 0 , to = 3 * pi, n = 50)
hist(s) # note that negative values of f (sin) are ignored in sampling

# see also
#vignette("event_data")
# for details on usage and applications to paleontology


</code></pre>


</div>