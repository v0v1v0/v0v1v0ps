<div class="container">

<table style="width: 100%;"><tr>
<td>sv_dependence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SHAP Dependence Plot</h2>

<h3>Description</h3>

<p>Scatterplot of the SHAP values of a feature against its feature values.
If SHAP interaction values are available, setting <code>interactions = TRUE</code> allows
to focus on pure interaction effects (multiplied by two) or on pure main effects.
By default, the feature on the color scale is selected via SHAP interactions
(if available) or an interaction heuristic, see <code>potential_interactions()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sv_dependence(object, ...)

## Default S3 method:
sv_dependence(object, ...)

## S3 method for class 'shapviz'
sv_dependence(
  object,
  v,
  color_var = "auto",
  color = "#3b528b",
  viridis_args = getOption("shapviz.viridis_args"),
  jitter_width = NULL,
  interactions = FALSE,
  ih_nbins = NULL,
  ih_color_num = TRUE,
  ih_scale = FALSE,
  ih_adjusted = FALSE,
  ...
)

## S3 method for class 'mshapviz'
sv_dependence(
  object,
  v,
  color_var = "auto",
  color = "#3b528b",
  viridis_args = getOption("shapviz.viridis_args"),
  jitter_width = NULL,
  interactions = FALSE,
  ih_nbins = NULL,
  ih_color_num = TRUE,
  ih_scale = FALSE,
  ih_adjusted = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class "(m)shapviz".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>ggplot2::geom_jitter()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Column name of feature to be plotted. Can be a vector/list if <code>object</code> is
of class "shapviz".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_var</code></td>
<td>
<p>Feature name to be used on the color scale to investigate
interactions. The default ("auto") uses SHAP interaction values (if available),
or a heuristic to select the strongest interacting feature. Set to <code>NULL</code> to not
use the color axis. Can be a vector/list if <code>object</code> is of class "shapviz".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Color to be used if <code>color_var = NULL</code>. Can be a vector/list if <code>v</code>
is a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis_args</code></td>
<td>
<p>List of viridis color scale arguments, see
<code>?ggplot2::scale_color_viridis_c</code>. The default points to the global option
<code>shapviz.viridis_args</code>, which corresponds to
<code>list(begin = 0.25, end = 0.85, option = "inferno")</code>.
These values are passed to <code style="white-space: pre;">⁠ggplot2::scale_color_viridis_*()⁠</code>.
For example, to switch to a standard viridis scale, you can either change the
default via <code>options(shapviz.viridis_args = list())</code>, or set
<code>viridis_args = list()</code>. Only relevant if <code>color_var</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter_width</code></td>
<td>
<p>The amount of horizontal jitter. The default (<code>NULL</code>) will
use a value of 0.2 in case <code>v</code> is discrete, and no jitter otherwise.
(Numeric variables are considered discrete if they have at most 7 unique values.)
Can be a vector/list if <code>v</code> is a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactions</code></td>
<td>
<p>Should SHAP interaction values be plotted? Default is <code>FALSE</code>.
Requires SHAP interaction values. If <code>color_var = NULL</code> (or it is equal to <code>v</code>),
the pure main effect of <code>v</code> is visualized. Otherwise, twice the SHAP interaction
values between <code>v</code> and the <code>color_var</code> are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ih_nbins, ih_color_num, ih_scale, ih_adjusted</code></td>
<td>
<p>Interaction heuristic (ih)
parameters used to select the color variable, see <code>potential_interactions()</code>.
Only used if <code>color_var = "auto"</code> and if there are no SHAP interaction values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "ggplot" (or "patchwork") representing a dependence plot.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>sv_dependence(default)</code>: Default method.
</p>
</li>
<li> <p><code>sv_dependence(shapviz)</code>: SHAP dependence plot for "shapviz" object.
</p>
</li>
<li> <p><code>sv_dependence(mshapviz)</code>: SHAP dependence plot for "mshapviz" object.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>potential_interactions()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dtrain &lt;- xgboost::xgb.DMatrix(
  data.matrix(iris[, -1]), label = iris[, 1], nthread = 1
)
fit &lt;- xgboost::xgb.train(data = dtrain, nrounds = 10, nthread = 1)
x &lt;- shapviz(fit, X_pred = dtrain, X = iris)
sv_dependence(x, "Petal.Length")
sv_dependence(x, "Petal.Length", color_var = "Species")
sv_dependence(x, "Petal.Length", color_var = NULL)
sv_dependence(x, c("Species", "Petal.Length"))
sv_dependence(x, "Petal.Width", color_var = c("Species", "Petal.Length"))

# SHAP interaction values/main effects
x2 &lt;- shapviz(fit, X_pred = dtrain, X = iris, interactions = TRUE)
sv_dependence(x2, "Petal.Length", interactions = TRUE)
sv_dependence(
  x2, c("Petal.Length", "Species"), color_var = NULL, interactions = TRUE
)
</code></pre>


</div>