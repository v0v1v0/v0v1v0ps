<div class="container">

<table style="width: 100%;"><tr>
<td>ploidy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer Ploidy from ATAC-seq Fragment Overlap</h2>

<h3>Description</h3>

<p>Infer Ploidy from ATAC-seq Fragment Overlap
</p>


<h3>Usage</h3>

<pre><code class="language-R">ploidy(
  fragmentoverlap,
  levels,
  s = 100,
  epsilon = 1e-08,
  subsamplesize = NULL,
  dobayes = FALSE,
  prop = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fragmentoverlap</code></td>
<td>
<p>Frequency of fragment overlap in each cell
computed by the function <code>fragmentoverlapcount</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Possible values of ploidy. For example,
<code>c(2, 4)</code> if the cells can be diploids or tetraploids.
The values must be larger than one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Seed for random numbers used in EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Convergence criterion for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsamplesize</code></td>
<td>
<p>EM algorithm becomes difficult to converge
when the number of cells is very large.
By setting the parameter (e.g. to 1e4),
we can run EM algorithm iteratively,
first for <code>subsamplesize</code> randomly sampled cells,
next for twice the number of cells in repetition.
The inferred lambda/theta parameters are used as the initial value
in the next repetition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dobayes</code></td>
<td>
<p>(experimental feature) Whether to perform Bayesian inference,
which takes long computation time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>Proportion of peaks that can be fitted with binomal
distribution in ploidy.bayes. The rest of peaks are allowed to
have depth larger than the ploidy.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame with each row corresponding to a cell.
For each cell, its barcode, ploidy inferred by 1) moment method,
2) the same with additional K-means clustering,
3) EM algorithm of mixture, and, optionally,
4) Bayesian inference are given.
I recommend using <code>ploidy.moment</code> or <code>ploidy.em</code>.
When <code>fragmentoverlapcount</code> was computed with <code>dobptonext=TRUE</code>,
we only use the chromosomal sites with chromatin accessibility in top 10
This requires longer computation time.
</p>


</div>