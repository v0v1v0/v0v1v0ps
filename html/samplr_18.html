<div class="container">

<table style="width: 100%;"><tr>
<td>sampler_rec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recycled-Momentum HMC Sampler (REC)</h2>

<h3>Description</h3>

<p>Recycled-Momentum HMC is a sampling algorithm that uses Hamiltonian Dynamics to approximate a posterior distribution. Unlike in standard HMC, proposals are autocorrelated, as the momentum of the current trajectory is not independent of the last trajectory, but is instead updated by a parameter alpha (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampler_rec(
  start,
  distr_name = NULL,
  distr_params = NULL,
  epsilon = 0.5,
  L = 10,
  alpha = 0.1,
  iterations = 1024L,
  weights = NULL,
  custom_density = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Vector. Starting position of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_name</code></td>
<td>
<p>Name of the distribution from which to sample from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_params</code></td>
<td>
<p>Distribution parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Size of the leapfrog step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of leapfrog steps per iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Recycling factor, from -1 to 1 (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If using a mixture distribution, the weights given to each constituent distribution. If none given, it defaults to equal weights for all distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_density</code></td>
<td>
<p>Instead of providing names, params and weights, the user may prefer to provide a custom density function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>While in HMC the momentum in each iteration is an independent draw,, here the momentum of the last utterance <code class="reqn">p^{n-1}</code> is also involved. In each iteration, the momentum <code class="reqn">p</code> is obtained as follows </p>
<p style="text-align: center;"><code class="reqn">p \gets \alpha \times p^{n-1} + (1 - \alpha^2)^{\frac{1}{2}} \times v</code>
</p>
<p>; where <code class="reqn">v \sim N(0, I)</code>.
</p>
<p>Recycled-Momentum HMC does not support discrete distributions.
</p>
<p>This algorithm has been used to model human data in Castillo et al. (2024)
</p>


<h3>Value</h3>

<p>A named list containing
</p>

<ol>
<li>
<p>Samples: the history of visited places (an n x d x c array, n = iterations; d = dimensions; c = chain index, with c==1 being the 'cold chain')
</p>
</li>
<li>
<p>Momentums: the history of momentum values (an n x d matrix, n = iterations; d = dimensions). Nothing is proposed in the first iteration (the first iteration is the start value) and so the first row is NA
</p>
</li>
<li>
<p>Acceptance Ratio: The proportion of proposals that were accepted (for each chain).
</p>
</li>
</ol>
<h3>References</h3>

<p>Castillo L, León-Villagrá P, Chater N, Sanborn A (2024).
“Explaining the Flaws in Human Random Generation as Local Sampling with Momentum.”
<em>PLOS Computational Biology</em>, <b>20</b>(1), 1–24.
<a href="https://doi.org/10.1371/journal.pcbi.1011739">doi:10.1371/journal.pcbi.1011739</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
result &lt;- sampler_rec(
    distr_name = "norm", distr_params = c(0,1), 
    start = 1, epsilon = .01, L = 100
)
cold_chain &lt;- result$Samples
</code></pre>


</div>