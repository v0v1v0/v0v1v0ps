<div class="container">

<table style="width: 100%;"><tr>
<td>separationplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a Separation Plot</h2>

<h3>Description</h3>

<p>This is the core function for the generation of a separation plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">separationplot(pred, actual, type = "line", line = T, lwd1 = 0.5, lwd2 = 0.5, 
heading = "",  xlab = "", shuffle = T, width = 9, height = 1.2, col0 = "#FEF0D9", 
col1 = "#E34A33", flag = NULL, flagcol = 1, file = NULL, newplot = T, locate = NULL, 
rectborder = NA, show.expected = F, zerosfirst = T, BW=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>

<p>Vector of predicted probabilities (on a continuous 0 to 1 scale).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actual</code></td>
<td>

<p>Vector of actual outcomes (each element must be either 0 or 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Should the individual lines on the separation plot be plotted as line segments (<code>type="line"</code>) or rectangles (<code>type="rect"</code>), or should the probabilities in different regions of the plot be grouped into distinct bands (<code>type="bands"</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>

<p>Should a trace line be added to the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd1</code></td>
<td>

<p>The width of the individual line segments (only when <code>type="line"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd2</code></td>
<td>

<p>The width of the trace line (only when <code>line=T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heading</code></td>
<td>

<p>An optional title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>An option x-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shuffle</code></td>
<td>

<p>If <code>shuffle=T</code>, the order of rows in the results data is randomized to break up any pre-existing patterns that may distort the appearance of the results in the special case where many of the observations share the same fitted values.  This happens, for example, when the original dataframe is organized in such a way that all the cases with the event of interest come before the cases without the event.  Note that when <code>shuffle=T</code>, the random number seed is reset to 1 each time this function is called.  This ensures that replicable results can be obtained even when the order of observations is randomized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>

<p>Width of the plot space (in inches).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>

<p>Height of the plot space (in inches).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col0</code></td>
<td>

<p>Color of the predicted probabilities corresponding to 0s in the <code>actual</code> vector.  The default color has been chosen from one of the palettes on <a href="https://colorbrewer2.org/">https://colorbrewer2.org/</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1</code></td>
<td>

<p>Color of the predicted probabilities corresponding to 1s in the <code>actual</code> vector.  The default color has been chosen from one of the palettes on <a href="https://colorbrewer2.org/">https://colorbrewer2.org/</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>

<p>A vector of row number(s) in the <code>actual</code> vector corresponding to the observations to flag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagcol</code></td>
<td>

<p>A vector of colors for the flags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>The name and file path of where the pdf output should be written, if desired. If <code>file=NULL</code> the output will be written to the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newplot</code></td>
<td>

<p>Should a new plotting space be opened up for the separation plot?  Select <code>newplot=F</code> if you want the separation plot to be added to currently open output device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locate</code></td>
<td>

<p>Number of lines (if any) on the separation plot that you want to identify with the mouse using the <code>locator</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rectborder</code></td>
<td>

<p>When <code>type="rect"</code>, the value of this argument is passed to the <code>border</code> argument of the <code>rect</code> function used to draw the line segments.  The default setting (<code>rectborder=NA</code>) suppresses the drawing of borders around the individual segments of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.expected</code></td>
<td>

<p>If <code>show.expected=T</code>, a marker is added to the plot showing the expected total number of events.  The expected number of events is calculated by simply summing (and rounding) the predicted probabilities over all observations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zerosfirst</code></td>
<td>

<p>When <code>type="line"</code>, should the 0s be plotted in the background, and the 1s in the foreground, or vice-versa?  This will affect the output when the number of observations is very large relative to the size of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BW</code></td>
<td>

<p>Should the Black and White color scheme be implemented?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please see the paper by Greenhill, Ward and Sacks (2011) for more information on the features of the separation plot.</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>resultsmatrix </code></td>
<td>
<p>The dataframe containing the data used to generate the separation plot.  The first column is the vector of predicted probabilities, the second is the vector of actual outcomes, the third indicates which observations have been flagged using the <code>flag</code> argument above, the fourth gives the position of each observation on the horizontal axis of the separation plot, and the fifth gives the color used to plot each observation. </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Brian Greenhill &lt;<a href="mailto:bgreenhill@albany.edu">bgreenhill@albany.edu</a>&gt;</p>


<h3>References</h3>

<p>Greenhill, Brian, Michael D. Ward, and Audrey Sacks. "The separation plot: A new visual method for evaluating the fit of binary models." American Journal of Political Science 55.4 (2011): 991-1002.</p>


<h3>See Also</h3>

<p>See <code>sp.categorical</code> for plotting separation plots for models with polytomous dependent variables.</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a separation plot for a simple logit model:

library(MASS)
set.seed(1)
Sigma &lt;- matrix(c(1,0.78,0.78,1),2,2)
a&lt;-(mvrnorm(n=500, rep(0, 2), Sigma))
a[,2][a[,2]&gt;0.75]&lt;-1
a[,2][a[,2]&lt;=0.75]&lt;-0
a[,1]&lt;-a[,1]-min(a[,1])
a[,1]&lt;-a[,1]/max(a[,1])

cor(a) # should be 0.55

model1&lt;-glm(a[,2]~a[,1], family=binomial(link = "logit"))

library(Hmisc)
somers2(model1$fitted.values, model1$y)

separationplot(pred=model1$fitted.values, actual=model1$y, type="rect", 
line=TRUE, show.expected=TRUE, heading="Example 1")


</code></pre>


</div>