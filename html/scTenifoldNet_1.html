<div class="container">

<table style="width: 100%;"><tr>
<td>cpDecomposition</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Canonical Polyadic Decomposition</h2>

<h3>Description</h3>

<p>Canonical Polyadic (CP) decomposition of a tensor, aka CANDECOMP/PARAFRAC. Approximate a K-Tensor using a sum of <code>num_components</code> rank-1 K-Tensors. A rank-1 K-Tensor can be written as an outer product of K vectors. There are a total of <code>num_compoents *tnsr@num_modes</code> vectors in the output, stored in <code>tnsr@num_modes</code> matrices, each with <code>num_components</code> columns. This is an iterative algorithm, with two possible stopping conditions: either relative error in Frobenius norm has gotten below <code>tol</code>, or the <code>max_iter</code> number of iterations has been reached. For more details on CP decomposition, consult Kolda and Bader (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpDecomposition(tnsr, num_components = NULL, max_iter = 25, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tnsr</code></td>
<td>
<p>Tensor with K modes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_components</code></td>
<td>
<p>the number of rank-1 K-Tensors to use in approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>maximum number of iterations if error stays above <code>tol</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative Frobenius norm error tolerance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses the Alternating Least Squares (ALS) estimation procedure. A progress bar is included to help monitor operations on large tensors.
</p>


<h3>Value</h3>

<p>a list containing the following </p>

<dl>
<dt><code>lambdas</code></dt>
<dd>
<p>a vector of normalizing constants, one for each component</p>
</dd>
<dt><code>U</code></dt>
<dd>
<p>a list of matrices - one for each mode - each matrix with <code>num_components</code> columns</p>
</dd>
<dt><code>conv</code></dt>
<dd>
<p>whether or not <code>resid</code> &lt; <code>tol</code> by the last iteration</p>
</dd>
<dt><code>norm_percent</code></dt>
<dd>
<p>the percent of Frobenius norm explained by the approximation</p>
</dd>
<dt><code>est</code></dt>
<dd>
<p>estimate of <code>tnsr</code> after compression</p>
</dd>
<dt><code>fnorm_resid</code></dt>
<dd>
<p>the Frobenius norm of the error <code>fnorm(est-tnsr)</code></p>
</dd>
<dt><code>all_resids</code></dt>
<dd>
<p>vector containing the Frobenius norm of error for all the iterations</p>
</dd>
</dl>
<h3>References</h3>

<p>T. Kolda, B. Bader, "Tensor decomposition and applications". SIAM Applied Mathematics and Applications 2009.
</p>


</div>