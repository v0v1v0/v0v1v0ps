<div class="container">

<table style="width: 100%;"><tr>
<td>pBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-Bayes estimates of cell probabilities</h2>

<h3>Description</h3>

<p>Estimation of cells counts in contingency tables by means of the pseudo-Bayes estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pBayes(x, method="m.ind", const=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A contingency table with observed cell counts. Typically the output of <code>table</code> or <code>xtabs</code>. More in general an R <code>array</code> with the counts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
 
<p>The method for estimating the final cell frequencies. The following options are available:
</p>
<p><code>method = "Jeffreys"</code>, consists in adding 0.5 to each cell before estimation of the relative frequencies. 
</p>
<p><code>method = "minimax"</code>, consists in adding <code class="reqn">\sqrt(n)/c</code> to each cell before estimation of the relative frequencies, being <code class="reqn">n</code> the sum of all the counts and <code class="reqn">c</code> the number of cells in the table.
</p>
<p><code>method = "invcat"</code>, consists in adding <code class="reqn">1/c</code> to each cell before estimation of the relative frequencies.
</p>
<p><code>method = "user"</code>, consists in adding a used defined constant <code class="reqn">a</code> (<code class="reqn">a&gt;0</code>) to each cell before estimation of the relative frequencies. The constant <code class="reqn">a</code> should be passed via the argument <code>const</code>.
</p>
<p><code>method = "m.ind"</code>, the prior guess for the unknown cell probabilities is obtained by considering estimated probabilities under the mutual independence hypothesis. This option is available when dealing with at least two-way contingency tables <br> (<code>length(dim(x))&gt;=2</code>).
</p>
<p><code>method = "h.assoc"</code>, the prior guess for the unknown cell probabilities is obtained by considering estimated probabilities under the homogeneous association hypothesis. This option is available when dealing with at least two-way contingency tables (<code>length(dim(x))&gt;=2</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>

<p>Numeric value, a user defined constant <code class="reqn">a</code> (<code class="reqn">a&gt;0</code>) to be added to each cell before estimation of the relative frequencies when <code>method = "user"</code>. As a general rule of thumb, it is preferable to avoid that the sum of constant over all the cells is greater than <code class="reqn">0.20 \times n</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the frequencies in a contingency table by using the pseudo-Bayes approach. In practice the estimator being considered is a weighted average of the input (observed) cells counts <code class="reqn">n_h</code> and a suitable prior guess, <code class="reqn">\gamma_h</code>, for cells probabilities :
</p>
<p style="text-align: center;"><code class="reqn">\tilde{p}_h = \frac{n}{n+K} \hat{p}_h + \frac{K}{n+K} \gamma_h </code>
</p>

<p><code class="reqn">K</code> depends on the parameters of Dirichlet prior distribution being considered (for major details see Chapter 12 in Bishop et al., 1974).
It is worth noting that with a constant prior guess <code class="reqn">\gamma_h=1/c</code> (<code class="reqn">h=1,2,\cdots, c</code>), then <code class="reqn">K=1</code> and in practice corresponds to adding <code class="reqn">1/c</code> to each cell before estimation of the relative frequencies (<code>method = "invcat"</code>); <code class="reqn">K=c/2</code> when the constant 0.5 is added to each cell (<code>method = "Jeffreys"</code>); finally <code class="reqn">K=\sqrt{n}</code> when the quantity <code class="reqn">\sqrt{n}/c</code> is added to each cell (<code>method = "minimax"</code>). All these cases corresponds to adding a flattening constant; the higher is the value of <code class="reqn">K</code> the more the estimates will be shrinked towards <code class="reqn">\gamma_h=1/c</code> (flattening).
</p>
<p>When <code>method = "m.ind"</code> the prior guess <code class="reqn">\gamma_h</code> is estimated under the hypothesis of mutual independence between the variables crossed in the initial contingency table <code>x</code>, supposed to be at least a two-way table.  In this case the value of <code class="reqn">K</code> is estimated via a data-driven approach by considering
</p>
<p style="text-align: center;"><code class="reqn"> \hat{K} = \frac{1 - \sum_{h} \hat{p}_h^2}{\sum_{h} \left( \hat{\gamma}_h - \hat{p}_h \right)^2 } </code>
</p>

<p>On the contrary, when <code>method = "h.assoc"</code> the prior guess <code class="reqn">\gamma_h</code> is estimated under the hypothesis of homogeneous association between the variables crossed in the initial contingency table <code>x</code>. 
</p>
<p>Please note that when the input table is estimated from sample data where a weight is assigned to each unit, the weights should be used in estimating the input table, but it is suggested to rescale them so that their sum is equal to <em>n</em>, the sample size.
</p>


<h3>Value</h3>

<p>A <code>list</code> object with three components. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>A vector with the sample size <code>"n"</code>, the number of cells (<code>"no.cells"</code>) in <code>x</code>, the average cell frequency (<code>"av.cfr"</code>), the number of cells showing frequencies equal to zero (<code>"no.0s"</code>), the <code>const</code> input argument, the chosen/estimated <code class="reqn">K</code> (<code>"K"</code>) and the relative size of <code class="reqn">K</code>, i.e. <code class="reqn">K/(n+K)</code> (<code>"rel.K"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p> A table having the same dimension as <code>x</code> with the considered prior values for the cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudoB</code></td>
<td>
<p> A table with having the same dimension as <code>x</code> providing the pseudo-Bayes estimates for the cell frequencies in <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a> 
</p>


<h3>References</h3>

<p>Bishop Y.M.M., Fienberg, S.E., Holland, P.W. (1974) <em>Discrete Multivariate Analysis: Theory and Practice.</em> The Massachusetts Institute of Technology
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(samp.A, package="StatMatch")
tab &lt;- xtabs(~ area5 + urb + c.age + sex + edu7, data = samp.A)
out.pb &lt;- pBayes(x=tab, method="m.ind")
out.pb$info

out.pb &lt;- pBayes(x=tab, method="h.assoc")
out.pb$info

out.pb &lt;- pBayes(x=tab, method="Jeffreys")
out.pb$info

# usage of weights in estimating the input table
n &lt;- nrow(samp.A)
r.w &lt;- samp.A$ww / sum(samp.A$ww) * n   # rescale weights to sum up to n 
tab.w &lt;- xtabs(r.w ~ area5 + urb + c.age + sex + edu7, data = samp.A)
out.pbw &lt;- pBayes(x=tab.w, method="m.ind")
out.pbw$info

</code></pre>


</div>