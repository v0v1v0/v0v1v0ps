<div class="container">

<table style="width: 100%;"><tr>
<td>hcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross-validatory choice of smoothing parameter
</h2>

<h3>Description</h3>

<p>This function uses the technique of cross-validation to select a smoothing 
parameter suitable for constructing a density estimate or nonparametric 
regression curve in one or two dimensions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hcv(x, y = NA, hstart = NA, hend = NA, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector, or two-column matrix of data.  If <code>y</code> is missing these are 
observations to be used in the construction of a density estimate.  If
<code>y</code> is present, these are the covariate values for a nonparametric regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of response values for nonparametric regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hstart</code></td>
<td>

<p>the smallest value of the grid points to be used in an initial grid search 
for the value of the smoothing parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hend</code></td>
<td>

<p>the largest value of the grid points to be used in an initial grid search 
for the value of the smoothing parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code> function,
through a mechanism which limits their effect only to this call of the
function. Those specifically relevant for this function are the following:
<code>h.weights</code>, <code>ngrid</code>, <code>display</code>, <code>add</code>;
see the documentation of  <code>sm.options</code> for their description.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Sections 2.4 and 4.5 of the reference below.
</p>
<p>The two-dimensional case uses a smoothing parameter derived from a single 
value, scaled by the standard deviation of each component.
</p>
<p>This function does not employ a sophisticated algorithm and some
adjustment of the search parameters may be required for different sets
of data.  An initial estimate of the value of h which minimises the
cross-validatory criterion is located from a grid search using values
which are equally spaced on a log scale between <code>hstart</code> and
<code>hend</code>.  A quadratic approximation is then used to refine this
initial estimate.
</p>


<h3>Value</h3>

<p>the value of the smoothing parameter which minimises the cross-validation
criterion over the selected grid.
</p>


<h3>Side Effects</h3>

<p>If the minimising value is located at the end of the grid of search positions,
or if some values of the cross-validatory criterion cannot be evaluated,
then a warning message is printed.  In these circumstances altering the
values of <code>hstart</code> and <code>hend</code> may improve performance.
</p>


<h3>Note</h3>

<p>As from version 2.1 of the package, a similar effect can be
obtained with the new function <code>h.select</code>, via
<code>h.select(x, method="cv")</code>. Users are encouraged to adopt
this route, since <code>hcv</code> might be not accessible directly
in future releases of the package.  When the
sample size is large <code>hcv</code> uses the raw data while
<code>h.select(x, method="cv")</code> uses binning.  The latter is 
likely to produce a more stable choice for <code>h</code>.
</p>


<h3>References</h3>

<p>Bowman, A.W. and Azzalini, A. (1997).
<em>Applied Smoothing Techniques for Data Analysis:</em> 
<em>the Kernel Approach with S-Plus Illustrations.</em>
Oxford University Press, Oxford.
</p>


<h3>See Also</h3>

<p><code>h.select</code>, <code>hsj</code>, <code>hnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  Density estimation

x &lt;- rnorm(50)
par(mfrow=c(1,2))
h.cv &lt;- hcv(x, display="lines", ngrid=32)
sm.density(x, h=hcv(x))
par(mfrow=c(1,1))

#  Nonparametric regression

x &lt;- seq(0, 1, length = 50)
y &lt;- rnorm(50, sin(2 * pi * x), 0.2)
par(mfrow=c(1,2))
h.cv &lt;- hcv(x, y, display="lines", ngrid=32)
sm.regression(x, y, h=hcv(x, y))
par(mfrow=c(1,1))
</code></pre>


</div>