<div class="container">

<table style="width: 100%;"><tr>
<td>MrBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calls MrBayes</h2>

<h3>Description</h3>

<p>A slight improvement of 'ips::mrbayes()'</p>


<h3>Usage</h3>

<pre><code class="language-R">MrBayes(x, file="", nst=6, rates="invgamma", ngammacat=4, nruns=2, ngen=1e+06,
 printfreq=100, samplefreq=10, nchains=4, savebrlens="yes", temp=0.2, burnin=10,
 contype="allcompat", run=FALSE, simple=TRUE, exec="mb-mpi", method="dna")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The object to process (must be 'DNAbin' class)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A character string, giving the name of the MrBayes input file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nst</code></td>
<td>
<p>An integer giving the number of rates in the model of sequence evolution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>A character string; allowed are "equal", "gamma", "propinv", "invgamma", and "adgamma"; the default is "equal"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngammacat</code></td>
<td>
<p>An integer; the number rate categories for the discretized Gamma distribution; the default is '4'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nruns</code></td>
<td>
<p>An integer; the number of runs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>An integer; the number of states of the MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printfreq</code></td>
<td>
<p>An integer; the interval between states of the MCMC to be printed on the screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplefreq</code></td>
<td>
<p>An integer; the interval between states of the MCMC to be sampled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nchains</code></td>
<td>
<p>An integer; number of Metropolis coupled MCMCs in each run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savebrlens</code></td>
<td>
<p>Logical; shall branch lengths be saved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp</code></td>
<td>
<p>Heating parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>An integer; the number of samples from the MCMC to be discarded prior to further analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contype</code></td>
<td>
<p>A character string; the type of consensus tree calculated from the posterior distribution of trees</p>
</td>
</tr>
</table>
<p>either "halfcompat" (majority-rule consensus tree) or "allcombat" (strict consensus tree)
</p>
<table>
<tr style="vertical-align: top;">
<td><code>run</code></td>
<td>
<p>Logical; 'run = FALSE' will only print the NEXUS file, 'run = TRUE' will also start the MCMC runs, if the 'path' argument is correctly specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simple</code></td>
<td>
<p>New option: if TRUE (default), then outputs tree in the format readable by functions from 'ape' package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exec</code></td>
<td>
<p>New option: name of UNIX executable (to allow multi-threaded version)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>New option: either "dna", or "mixed" to handle mixed or purely morphologic data (see below)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>MrBayes() is an improvement of ips::mrbayes() and ips::mrbayes.mixed(). Please see its documentation for clarity and other options.
</p>
<p>Comparing with 'ips' sources, MrBayes() has some code alterations and three more options. It also both views and saves output (works only on UNIX).
</p>
<p>If 'method="mixed"', the function requires character matrix as input where missing data are labeled with "N",
morphological columns encoded as 0/1 and placed after nucleotide columns (which might be absent).
</p>


<h3>Author(s)</h3>

<p>Alexey Shipunov</p>


<h3>See Also</h3>

<p>ips::<code>mrbayes</code></p>


<h3>Examples</h3>

<pre><code class="language-R">require(ips)
data(ips.cox1)
x &lt;- ips.cox1[, 100:140]

## Not run: 
## requires MrBayes program installation
MrBayes(x, file="cox1", ngen=100, run=TRUE)

str(plantago)
plantago[is.na(plantago)] &lt;- "N"
row.names(plantago) &lt;- gsub(" ", "_", row.names(plantago))
## requires MrBayes program installation
tr &lt;- MrBayes(plantago, file="plantago", method="mixed", burnin=5000, run=TRUE) # makes many files
tr &lt;- tr[[1]]
tr &lt;- root(tr, outgroup="Plantago_maritima", resolve.root=TRUE)
tr$node.label &lt;- suppressWarnings(round(as.numeric(tr$node.label)*100)) # warning is OK
tr$node.label[tr$node.label == "NA"] &lt;- ""
plot(tr)
nodelabels(tr$node.label, frame="none", bg="transparent", adj=-0.1)
add.scale.bar()

## End(Not run)
</code></pre>


</div>