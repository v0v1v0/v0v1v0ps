<div class="container">

<table style="width: 100%;"><tr>
<td>dufour_etal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dufour et al.'s Monte Carlo Test for Heteroskedasticity in a Linear
Regression Model</h2>

<h3>Description</h3>

<p>This function implements the method of
Dufour et al. (2004) for testing for
heteroskedasticity in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dufour_etal(
  mainlm,
  hettest,
  R = 1000L,
  alternative = c("greater", "less", "two.sided"),
  errorgen = stats::rnorm,
  errorparam = list(),
  seed = 1234,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hettest</code></td>
<td>
<p>A character specifying the name of a function
that implements a heteroskedasticity test on a linear regression model.
The function is called with the <code>statonly</code> argument set to
<code>TRUE</code> to improve computational efficiency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>An integer specifying the number of Monte Carlo replicates to
generate. Defaults to <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The tailedness of the test whose statistic is computed by
<code>hettest</code> function; one of <code>"greater"</code> (the default),
<code>"less"</code>, or <code>"two.sided"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorgen</code></td>
<td>
<p>A function, or a character specifying the name of a
function, from which the random errors are to be generated. The function
should correspond to a continuous probability distribution that has (or
at least can have) a mean of 0. Defaults to <code>rnorm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorparam</code></td>
<td>
<p>An optional list of parameters to pass to <code>errorgen</code>.
This argument is ignored if <code>errorgen</code> is
<code>rnorm</code>, since <code>mean</code> must be set to 0, and
<code>sd</code> is set to 1 because the heteroskedasticity test implemented by
<code>hettest</code> function is assumed to be scale invariant. If
<code>errorgen</code> is not <code>rnorm</code>, <code>errorparam</code> should be chosen
in such a way that the error distribution has a mean of 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer specifying a seed to pass to
<code>set.seed</code> for random number generation. This allows
reproducibility of Monte Carlo results. A value of <code>NA</code>
results in not setting a seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to function with name <code>hettest</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test implements a Monte Carlo procedure as follows. (1) The
observed value of the test statistic <code class="reqn">T_0</code> is computed using function
with name <code>hettest</code>. (2) <code>R</code> replications of the random error
vector are generated from the distribution specified using
<code>errorgen</code>. (3) <code>R</code> replications of the test statistic,
<code class="reqn">T_1,T_2,\ldots,T_R</code>, are computed from the generated error vectors.
(4) The empirical <code>p</code>-value is computed as
<code class="reqn">\frac{\hat{G}_R(T_0)+1}{R+1}</code>, where
<code class="reqn">\hat{G}_R(x)=\sum_{j=1}^{R} 1_{T_j \ge x}</code>, <code class="reqn">1_{\bullet}</code>
being the indicator function. The test is right-tailed, regardless of the
tailedness of <code>hettest</code>. Note that the heteroskedasticity
test implemented by <code>hettest</code> must have a test statistic that is
continuous and that is invariant with respect to nuisance parameters
(<code class="reqn">\omega</code> and <code class="reqn">\beta</code>). Note further that if <code>hettest</code>
is <code>goldfeld_quandt</code> with <code>method</code> argument
<code>"parametric"</code>, the replicated Goldfeld-Quandt <code class="reqn">F</code> statistics
are computed directly within this function rather than by calling
<code>goldfeld_quandt</code>, due to some idiosyncratic features of this test.
Note that, if <code>alternative</code> is set to <code>"two.sided"</code>, the
one-sided <code class="reqn">p</code>-value is doubled (<code>twosidedpval</code> cannot
be used in this case).
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object
is not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Dufour J, Khalaf L, Bernard J, Genest I (2004).
“Simulation-Based Finite-Sample Tests for Heteroskedasticity and ARCH Effects.”
<em>Journal of Econometrics</em>, <b>122</b>, 317–347.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
dufour_etal(mtcars_lm, hettest = "breusch_pagan")

</code></pre>


</div>