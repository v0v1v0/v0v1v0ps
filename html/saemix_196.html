<div class="container">

<table style="width: 100%;"><tr>
<td>saemixModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to create an SaemixModel object</h2>

<h3>Description</h3>

<p>This function creates an SaemixModel object. The two mandatory arguments are
the name of a R function computing the model in the SAEMIX format (see
details and examples) and a matrix psi0 giving the initial estimates of the
fixed parameters in the model, with one row for the population mean
parameters and one row for the covariate effects (see documentation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">saemixModel(
  model,
  psi0,
  description = "",
  modeltype = "structural",
  name.response = "",
  name.sigma = character(),
  error.model = character(),
  transform.par = numeric(),
  fixed.estim = numeric(),
  covariate.model = matrix(nrow = 0, ncol = 0),
  covariance.model = matrix(nrow = 0, ncol = 0),
  omega.init = matrix(nrow = 0, ncol = 0),
  error.init = numeric(),
  name.modpar = character(),
  simulate.function = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>name of the function used to compute the structural model. The
function should return a vector of predicted values given a matrix of
individual parameters, a vector of indices specifying which records belong
to a given individual, and a matrix of dependent variables (see example
below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi0</code></td>
<td>
<p>a matrix with a number of columns equal to the number of
parameters in the model, and one (when no covariates are available) or two
(when covariates enter the model) giving the initial estimates for the fixed
effects. The column names of the matrix should be the names of the
parameters in the model, and will be used in the plots and the summaries.
When only the estimates of the mean parameters are given, psi0 may be a
named vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>a character string, giving a brief description of the
model or the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeltype</code></td>
<td>
<p>a character string, giving model type (structural or likelihood)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.response</code></td>
<td>
<p>the name of the dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.sigma</code></td>
<td>
<p>a vector of character string giving the names of the residual error parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.model</code></td>
<td>
<p>type of residual error model (valid types are constant,
proportional, combined and exponential). Defaults to constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.par</code></td>
<td>
<p>the distribution for each parameter (0=normal,
1=log-normal, 2=probit, 3=logit). Defaults to a vector of 1s (all parameters
have a log-normal distribution)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.estim</code></td>
<td>
<p>whether parameters should be estimated (1) or fixed to
their initial estimate (0). Defaults to a vector of 1s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate.model</code></td>
<td>
<p>a matrix giving the covariate model. Defaults to no
covariate in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance.model</code></td>
<td>
<p>a square matrix of size equal to the number of
parameters in the model, giving the variance-covariance matrix of the model:
1s correspond to estimated variances (in the diagonal) or covariances
(off-diagonal elements). Defaults to the identity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega.init</code></td>
<td>
<p>a square matrix of size equal to the number of parameters
in the model, giving the initial estimate for the variance-covariance matrix
of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.init</code></td>
<td>
<p>a vector of size 2 giving the initial value of a and b in
the error model. Defaults to 1 for each estimated parameter in the error
model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.modpar</code></td>
<td>
<p>names of the model parameters, if they are not given as
the column names (or names) of psi0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.function</code></td>
<td>
<p>for non-Gaussian data models, defined as modeltype='likelihood',
the name of the function used to simulate from the structural model. The
function should have the same header as the model function, and should return
a vector of simulated values given a matrix of individual parameters,
a vector of indices specifying which records belong to a given individual,
and a matrix of dependent variables (see example in the documentation, section
discrete data examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a boolean, controlling whether information about the created should be printed out. Defaults to TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is the user-friendly constructor for the SaemixModel object
class.
</p>


<h3>Value</h3>

<p>An SaemixModel object (see <code>saemixModel</code>).
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixData</code>,<code>SaemixModel</code>,
<code>saemixControl</code>,<code>saemix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

</code></pre>


</div>