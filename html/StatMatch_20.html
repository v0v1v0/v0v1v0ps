<div class="container">

<table style="width: 100%;"><tr>
<td>pw.assoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise measures between categorical variables</h2>

<h3>Description</h3>

<p>This function computes some association and <em>Proportional Reduction in Error</em> (PRE) measures between a categorical nominal variable and each of the other available predictors (being also categorical variables).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pw.assoc(formula, data, weights=NULL, out.df=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>A formula of the type <code>y~x1+x2</code> where <code>y</code> denotes the name of the categorical variable (a <code>factor</code> in <span class="pkg">R</span>) which plays the role of the dependent variable, while <code>x1</code> and <code>x2</code> are the name of the predictors (both categorical variables).  Numeric variables are not allowed; eventual numerical variables should be categorized (see function <code>cut</code>) before being passed to <code>pw.assoc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
 
<p>The data frame which contains the variables called by <code>formula</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>The name of the variable in <code>data</code> which provides the units' weights.  Weights are used to estimate frequencies (a cell frequency is estimated by summing the weights of the units which present the given characteristic).  Default is <code>NULL</code> (no weights available) and each unit counts 1. When case weight are provided, then they are scales so that their sum equals <em>n</em>, the sample size (assumed to be <code>nrow(data)</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.df</code></td>
<td>

<p>Logical. If <code>NULL</code> measures will be organized in a data frame (a column for each measure).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes some association, PRE measures, AIC and BIC for each couple response-predictor that can be created  starting from argument <code>formula</code>. In particular, a two-way contingency table <code class="reqn">X \times Y</code> is built for each available X variable (X in rows and Y in columns); then the following measures are considered.
</p>
<p>Cramer's <em>V</em>: 
</p>
<p style="text-align: center;"><code class="reqn"> V=\sqrt{\frac{\chi^2}{n \times min\left[I-1,J-1\right]} } </code>
</p>

<p><em>n</em> is the sample size, <em>I</em> is the number of rows (categories of X) and <em>J</em> is the number of columns (categories of Y).  Cramer's <em>V</em> ranges from 0 to 1. 
</p>
<p>Bias-corrected Cramer's <em>V</em> (<code class="reqn">V_c</code>) proposed by Bergsma (2013).
</p>
<p>Mutual information:
</p>
<p style="text-align: center;"><code class="reqn"> I(X;Y) = \sum_{i,j} p_{ij} \, log \left( \frac{p_{ij}}{p_{i+} p_{+j}} \right) </code>
</p>
  
<p>equal to 0 in case of independence but with infinite upper bound, i.e.  <code class="reqn">0 \leq I(X;Y) &lt; \infty</code>. In it <code class="reqn">p_{ij}=n_{ij}/n </code>.
</p>





<p>A normalized version of <code class="reqn">I(X;Y)</code>, ranging from 0 (independence) to 1 and not affected by number of categories (<em>I</em> and <em>J</em>):
</p>
<p style="text-align: center;"><code class="reqn">I(X;Y)^* = \frac{I(X;Y)}{min(H_X, H_Y) } </code>
</p>

<p>being <code class="reqn">H_X</code> and <code class="reqn">H_Y</code> the entropy of the variable X and Y, respectively.
</p>
<p>Goodman-Kruskal <code class="reqn">\lambda(Y|X)</code> (i.e. response conditional on the given predictor):
</p>
<p style="text-align: center;"><code class="reqn"> \lambda(Y|X) = \frac{\sum_{i=1}^I max_{j}(p_{ij}) - max_{j}(p_{+j})}{1-max_{j}(p_{+j})} </code>
</p>

<p>It ranges from 0 to 1, and denotes how much the knowledge of the row variable X (predictor) helps in reducing the prediction error of the values of the column variable Y (response).
</p>
<p>Goodman-Kruskal <code class="reqn">\tau(Y|X)</code>:
</p>
<p style="text-align: center;"><code class="reqn"> \tau(Y|X) = \frac{ \sum_{i=1}^I \sum_{j=1}^J p^2_{ij}/p_{i+} - \sum_{j=1}^J p_{+j}^2}{1 -  \sum_{j=1}^J p_{+j}^2} </code>
</p>

<p>It takes values in the interval [0,1] and has the same PRE meaning of the lambda.
</p>
<p>Theil's uncertainty coefficient:
</p>
<p style="text-align: center;"><code class="reqn"> U(Y|X) = \frac{\sum_{i=1}^I \sum_{j=1}^J p_{ij} log(p_{ij}/p_{i+}) - \sum_{j=1}^J p_{+j} log p_{+j}}{- \sum_{j=1}^J p_{+j} log p_{+j}} </code>
</p>

<p>It takes values in the interval [0,1] and measures the reduction of uncertainty in the column variable Y due to knowing the row variable X. Note that the numerator of U(Y|X) is the mutual information I(X;Y)
</p>
<p>It is worth noting that <code class="reqn">\lambda</code>, <code class="reqn">\tau</code> and <em>U</em> can be viewed as measures of the proportional reduction of the variance of the Y variable when passing from its marginal distribution to its conditional distribution given the predictor X, derived from the general expression (cf. Agresti, 2002, p. 56):
</p>
<p style="text-align: center;"><code class="reqn"> \frac{V(Y) - E[V(Y|X)]}{V(Y)}</code>
</p>

<p>They differ in the way of measuring variance, in fact it does not exist a general accepted definition of the variance for a categorical variable.
</p>
<p>Finally, AIC (and BIC) is calculated, as suggested in Sakamoto and Akaike (1977). In particular:
</p>
<p style="text-align: center;"><code class="reqn"> AIC(Y|X) = -2 \sum_{i,j} n_{ij} \, log \left( \frac{n_{ij}}{n_{i+}} \right) + 2I(J - 1) </code>
</p>

<p style="text-align: center;"><code class="reqn"> BIC(Y|X) = -2 \sum_{i,j} n_{ij} \, log \left( \frac{n_{ij}}{n_{i+}} \right) +I(J-1) log(n)    </code>
</p>

<p>being <code class="reqn">I(J-1)</code> the parameters (conditional probabilities) to estimate. Note that the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package <span class="pkg">catdap</span> provides functions to identify the best subset of predictors based on AIC.
</p>
<p>Please note that the missing values are excluded from the tables and therefore excluded from the estimation of the various measures.
</p>


<h3>Value</h3>

<p>When <code>out.df=FALSE</code> (default) a <code>list</code> object with four components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>A vector with the estimated Cramer's V for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bcV</code></td>
<td>
<p>A vector with the estimated bias-corrected Cramer's V for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mi</code></td>
<td>
<p>A vector with the estimated mutual information I(X;Y) for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.mi</code></td>
<td>
<p>A vector with the normalized mutual information I(X;Y)* for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> A vector with the values of Goodman-Kruscal <code class="reqn">\lambda(Y|X)</code> for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p> A vector with the values of Goodman-Kruscal <code class="reqn">\tau(Y|X)</code> for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p> A vector with the values of Theil's uncertainty coefficient U(Y|X) for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p> A vector with the values of AIC(Y|X) for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p> A vector with the values of BIC(Y|X) for each couple response-predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p> A vector with the number of parameters (conditional probabilities) estimated to calculate AIC and BIC for each couple response-predictor.</p>
</td>
</tr>
</table>
<p>When <code>out.df=TRUE</code> the output will be a data.frame with a column for each measure. 
</p>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a> 
</p>


<h3>References</h3>

<p>Agresti A (2002) <em>Categorical Data Analysis. Second Edition</em>. Wiley, new York.
</p>
<p>Bergsma W (2013) A bias-correction for Cramer's V and Tschuprow's T. <em>Journal of the Korean Statistical Society</em>, 42, 323â€“328.
</p>
<p>The Institute of Statistical Mathematics (2018). catdap: Categorical Data  Analysis Program Package. R package version 1.3.4. <a href="https://CRAN.R-project.org/package=catdap">https://CRAN.R-project.org/package=catdap</a>
</p>
<p>Sakamoto Y and Akaike, H (1977) Analysis of Cross-Classified Data by AIC. <em>Ann. Inst. Statist. Math.</em>, 30, 185-197.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(quine, package="MASS") #loads quine from MASS
str(quine)

# how Lrn is response variable
pw.assoc(Lrn~Age+Sex+Eth, data=quine)

# usage of units' weights
quine$ww &lt;- runif(nrow(quine), 1,4) #random gen  1&lt;=weights&lt;=4
pw.assoc(Lrn~Age+Sex+Eth, data=quine, weights="ww")

</code></pre>


</div>