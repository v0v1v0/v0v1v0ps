<div class="container">

<table style="width: 100%;"><tr>
<td>gen_glob_outl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Contamination with Global Outliers
</h2>

<h3>Description</h3>

<p>Generates synthetic global outliers and contaminates a given p-variate random field
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_glob_outl(x, alpha = 0.05, h = 10, random_sign = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a numeric matrix of dimension <code>c(n, p)</code> where the <code>p</code> columns correspond to the entries of the random field and the <code>n</code> rows are the observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>a numerical value between 0 and 1 giving the proportion of observations to contaminate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>a numerical constant to determine how large the contaminated outliers are, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_sign</code></td>
<td>

<p>logical. If <code>TRUE</code>, the sign of each component of the outlier is randomly selected. Default is <code>FALSE</code>. See more in details.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>gen_glob_outl</code> generates outliers for a given field by selecting randomly <code>round(alpha * n)</code> observations <code class="reqn">x_i</code> to be the outliers and contaminating them by setting <code class="reqn">x^{out}_i = (c^i)'x_i</code>, where the elements <code class="reqn">c^i_j</code> of vector <code class="reqn">c^i</code> are determined by the parameter <code>random_sign</code>. If <code>random_sign = TRUE</code>, <code class="reqn">c^i_j</code> is either <code class="reqn">h</code> or <code class="reqn">-h</code> with <code class="reqn">P(c^i_j = h) = P(c^i_j = -h) = 0.5</code>. If <code>random_sign = FALSE</code>, <code class="reqn">c^i_j=h</code> for all <code class="reqn">j=1,...p</code>, <code class="reqn">i=1,...,n</code>. The parameter <code>alpha</code> determines the contamination rate <code class="reqn">\alpha</code> and the parameter <code>h</code> determines the size of the outliers.
</p>


<h3>Value</h3>

<p><code>gen_glob_outl</code> returns a <code>data.frame</code> containing the contaminated fields as <code class="reqn">p</code> first columns. The column <code class="reqn">p + 1</code> contains a logical indicator whether the observation is outlier or not.
</p>


<h3>See Also</h3>

<p><code>gen_loc_outl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate coordinates
coords &lt;- runif(1000 * 2) * 20
dim(coords) &lt;- c(1000, 2)
coords_df &lt;- as.data.frame(coords)
names(coords_df) &lt;- c("x", "y")
# simulate random field
if (!requireNamespace('gstat', quietly = TRUE)) {
  message('Please install the package gstat to run the example code.')
} else {
  library(gstat)
  model_1 &lt;- gstat(formula = z ~ 1, locations = ~ x + y, dummy = TRUE, beta = 0, 
                   model = vgm(psill = 0.025, range = 1, model = 'Exp'), nmax = 20)
  model_2 &lt;- gstat(formula = z ~ 1, locations = ~ x + y, dummy = TRUE, beta = 0, 
                   model = vgm(psill = 0.025, range = 1, kappa = 2, model = 'Mat'), 
                   nmax = 20)
  model_3 &lt;- gstat(formula = z ~ 1, locations = ~ x + y, dummy = TRUE, beta = 0, 
                   model = vgm(psill = 0.025, range = 1, model = 'Gau'), nmax = 20)
  field_1 &lt;- predict(model_1, newdata = coords_df, nsim = 1)$sim1
  field_2 &lt;- predict(model_2, newdata = coords_df, nsim = 1)$sim1
  field_3 &lt;- predict(model_3, newdata = coords_df, nsim = 1)$sim1
  field &lt;- cbind(field_1, field_2, field_3)
  # Generate 10 % global outliers to data, with size h=15.
  field_cont &lt;- gen_glob_outl(field, alpha = 0.1, h = 15)
  
  # Generate 5 % global outliers to data, with size h = 10 and random sign.
  field_cont2 &lt;- gen_glob_outl(field, alpha = 0.05, h = 10, random_sign = TRUE)
}
</code></pre>


</div>