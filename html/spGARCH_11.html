<div class="container">

<table style="width: 100%;"><tr>
<td>sim.spARCH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of spatial ARCH models</h2>

<h3>Description</h3>

<p>The function generates <code>n</code> random numbers of a spatial ARCH process for given parameters and weighting schemes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.spARCH(n = dim(W)[1], rho, alpha, W, b = 2, type = "spARCH", control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n)</code> <code class="reqn">&gt; 1</code>, the length is taken to be the number required. Default <code>dim(W)[1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>spatial dependence parameter rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>unconditional variance level alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>parameter <code>b</code> for logarithmic spatial ARCH (only needed if <code>type = "log-spARCH"</code>). Default 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of simulated spARCH process (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control arguments (see below)</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>The function simulates <code>n</code> observations <code class="reqn">Y = (Y_1, ..., Y_n)'</code> of a spatial ARCH process, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{Y} = diag(\boldsymbol{h})^{1/2} \boldsymbol{\varepsilon} \, ,
</code>
</p>

<p>where <code class="reqn">\boldsymbol{\varepsilon}</code> is a spatial White Noise process. The definition of <code class="reqn">\boldsymbol{h}</code> depends on the chosen <code>type</code>. The following types are available.
</p>

<ul>
<li> <p><code>type = "spARCH"</code> - simulates <code class="reqn">\boldsymbol{\varepsilon}</code> from a truncated normal distribution on the interval <code class="reqn">[-a, a]</code>, such that <code class="reqn">\boldsymbol{h} &gt; 0</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W} \boldsymbol{Y}^{(2)} \; \mbox{and} \; a = 1 / ||\rho^2\mathbf{W}^2||_1^{1/4}.
</code>
</p>

<p>Note that the normal distribution is not trunctated (<code class="reqn">a = \infty</code>), if <code class="reqn">\mathbf{W}</code> is a strictly triangular matrix, as it is ensured that <code class="reqn">\boldsymbol{h} &gt; \boldsymbol{0}</code>. Generally, it is sufficient that if there exists a permutation such that <code class="reqn">\mathbf{W}</code> is strictly triangular. In this case, the process is called oriented spARCH process.
</p>
</li>
<li> <p><code>type = "log-spARCH"</code> - simulates a logarithmic spARCH process (log-spARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W} g(\boldsymbol{\varepsilon}) \, .
</code>
</p>

<p>For the log-spARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g_b</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g_b(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})' \, .
</code>
</p>

</li>
<li> <p><code>type = "complex-spARCH"</code> - allows for complex solutions of <code class="reqn">\boldsymbol{h}^{1/2}</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W} \boldsymbol{Y}^{(2)}  \, .
</code>
</p>

<p>The errors follow a standard normal distribution.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The functions returns a vector <code class="reqn">\boldsymbol{y}</code>.
</p>


<h3>Control Arguments</h3>


<ul>
<li> <p><code>seed</code> - positive integer to initialize the random number generator (RNG), default value is a random integer in <code class="reqn">[1, 10^6]</code>
</p>
</li>
<li> <p><code>silent</code> - if <code>FALSE</code>, current random seed is reported
</p>
</li>
<li> <p><code>triangular</code> - if <code>TRUE</code>, <code class="reqn">\mathbf{W}</code> is a triangular matrix and there are no checks to verify this assumption (default <code>FALSE</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145. <em>arXiv:1609.00711</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("spdep")

# 1st example
##############

# parameters

rho &lt;- 0.5
alpha &lt;- 1
d &lt;- 2

nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)

# simulation

Y &lt;- sim.spARCH(rho = rho, alpha = alpha, W = W, type = "log-spARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

# 2nd example
##############

# two spatial weighting matrices W_1 and W_2
# h = alpha + rho_1 W_1 Y^2 + rho_2 W_2 Y^2

W_1 &lt;- W
nblist &lt;- cell2nb(d, d, type = "rook")
W_2 &lt;- nb2mat(nblist)

rho_1 &lt;- 0.3
rho_2 &lt;- 0.7

W &lt;- rho_1 * W_1 + rho_2 * W_2
rho &lt;- 1

Y &lt;- sim.spARCH(n = d^2, rho = rho, alpha = alpha, W = W, type = "log-spARCH")
image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))
</code></pre>


</div>