<div class="container">

<table style="width: 100%;"><tr>
<td>homerange</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Home Range Statistics </h2>

<h3>Description</h3>

<p>Some ad hoc measures of home range size may be calculated in <span class="pkg">secr</span>
from capture–recapture data:
</p>
<p><code>dbar</code> is the mean distance between consecutive capture locations,
pooled over individuals (e.g. Efford 2004). <code>moves</code> returns the
raw distances.
</p>
<p><code>MMDM</code> (for ‘Mean Maximum Distance Moved’) is the average maximum
distance between detections of each individual i.e. the observed range
length averaged over individuals (Otis et al. 1978).
</p>
<p><code>ARL</code> (or ‘Asymptotic Range Length’) is obtained by fitting an
exponential curve to the scatter of observed individual range length vs
the number of detections of each individual (Jett and Nichols 1987: 889).
</p>
<p><code>RPSV</code> (for ‘Root Pooled Spatial Variance’) is a measure of the 2-D
dispersion of the locations at which individual animals are detected,
pooled over individuals (cf Calhoun and Casby 1958, Slade and Swihart 1983).
</p>
<p><code>moves</code> reports the distance between successive detections of each animal.
</p>
<p><code>centroids</code> reports the averaged coordinates of each animal's detections
</p>
<p><code>ORL</code> reports the observed range length of each animal, the maximum 
distance between any two detections.
</p>
<p><code>trapsPerAnimal</code> tabulates the number of animals recorded at 1, 2, ..., K detectors
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbar(capthist, userdist = NULL, mask = NULL)
MMDM(capthist, min.recapt = 1, full = FALSE, userdist = NULL, mask = NULL)
ARL(capthist, min.recapt = 1, plt = FALSE, full = FALSE, userdist = NULL, mask = NULL)
moves(capthist, userdist = NULL, mask = NULL, names = FALSE)
RPSV(capthist, CC = FALSE)
ORL(capthist, userdist = NULL, mask = NULL)
centroids(capthist)
trapsPerAnimal(capthist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>capthist</code></td>
<td>
<p> object of class <code>capthist</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userdist</code></td>
<td>
<p> function or matrix with user-defined distances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p> habitat mask passed to userdist function, if required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p> logical; should results be ordered alphanumerically by row names? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.recapt</code></td>
<td>
<p> integer minimum number of recaptures for a
detection history to be used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p> logical; if TRUE observed range length is plotted against number
of recaptures </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p> logical; set to TRUE for detailed output </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CC</code></td>
<td>
<p> logical for whether to use Calhoun and Casby formula </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dbar</code> is defined as –
</p>
<p style="text-align: center;"><code class="reqn">
\overline{d}=\frac{\sum\limits _{i=1}^{n}
                          \sum\limits _{j=1}^{n_i - 1}
                              \sqrt{(x_{i,j}-x_{i,j+1})^2 + (y_{i,j}-y_{i,j+1})^2}}
                         {\sum\limits _{i=1}^{n} (n_i-1)}</code>
</p>

<p>When <code>CC = FALSE</code>, <code>RPSV</code> is defined as –
</p>
<p style="text-align: center;"><code class="reqn">
 RPSV = \sqrt{
    \frac {\sum\limits _{i=1}^{n} \sum\limits _{j=1}^{n_i} [
	    (x_{i,j} - \overline x_i)^2 + (y_{i,j} - \overline y_i)^2
		]}{\sum\limits _{i=1}^{n} (n_i-1) - 1}}
	  </code>
</p>
<p>.
</p>
<p>Otherwise (<code>CC = TRUE</code>), <code>RPSV</code> uses the formula of Calhoun
and Casby (1958) with a different denominator – 	  
</p>
<p style="text-align: center;"><code class="reqn">
 s = \sqrt{
    \frac {\sum\limits _{i=1}^{n} \sum\limits _{j=1}^{n_i} [
	    (x_{i,j} - \overline x_i)^2 + (y_{i,j} - \overline y_i)^2
		]}{2\sum\limits _{i=1}^{n} (n_i-1)}}
	  </code>
</p>
<p>.
</p>
<p>The Calhoun and Casby formula (offered from 2.9.1) correctly estimates <code class="reqn">\sigma</code>
when trapping is on an infinite, fine grid, and is preferred
for this reason. The original RPSV
(<code>CC = FALSE</code>) is retained as the default for compatibility with
previous versions of <span class="pkg">secr</span>.
</p>
<p><code>RPSV</code> has a specific role as a proxy for
detection scale in inverse-prediction estimation of density (Efford
2004, 2023).
</p>
<p><code>RPSV</code> is used in <code>autoini</code> to obtain plausible starting
values for maximum likelihood estimation.
</p>
<p><code>MMDM</code> and <code>ARL</code> discard data from detection histories
containing fewer than <code>min.recapt</code>+1 detections.
</p>
<p>The <code>userdist</code> option is included for exotic non-Euclidean cases
(see e.g. <code>secr.fit</code> details). RPSV is not defined for
non-Euclidean distances.
</p>
<p>If <code>capthist</code> comprises standalone telemetry data (all detector 'telemetry') 
then calculations are performed on the telemetry coordinates. If <code>capthist</code> 
combines telemetry data and conventional detections (‘multi’, ‘proximity’ etc.) 
then only the conventional data are summarised.
</p>
<p>Movements are reliably reported by <code>moves</code> only if there is a maximum of one detection per animal per occasion. The sequence of detections within any occasion is not known; where these occur the sequence used by <code>moves</code> is arbitrary (sequence follows detector index).
</p>


<h3>Value</h3>

<p>For <code>dbar</code>, <code>MMDM</code>, <code>ARL</code> and <code>RPSV</code> –
</p>
<p>Scalar distance in metres, or a list of such values if <code>capthist</code>
is a multi-session list.
</p>
<p>The <code>full</code> argument may be used with <code>MMDM</code> and <code>ARL</code> to
return more extensive output, particularly the observed range length for
each detection history.
</p>
<p>For <code>moves</code> –
</p>
<p>List with one component for each animal, a vector of distances, or numeric(0) if the animal is detected only once. A list of such lists if <code>capthist</code> is a multi-session list.
</p>
<p>For <code>centroids</code> –
</p>
<p>For a single-session capthist, a matrix of two columns, the x- and y-coordinates of the centroid of the detections of each animal. The number of detections is returned as the attribute ‘Ndetections’, a 1-column matrix.
</p>
<p>For a multi-session capthist, a 3-D array as before, but with a third dimension for the session. Centroid coordinates are missing (NA) if the animal was not detected in a session. The attribute ‘Ndetections’ with the number of detections per animal and session is a matrix.
</p>
<p>For <code>trapsPerAnimal</code> –
</p>
<p>A vector with the number of animals detected at k detectors.
</p>


<h3>Note</h3>

<p>All measures are affected by the arrangement of detectors. <code>dbar</code>
is also affected quite strongly by serial correlation in the sampled
locations. Using <code>dbar</code> with ‘proximity’ detectors raises a problem
of interpretation, as the original sequence of multiple detections
within an occasion is unknown. RPSV is a value analogous to the standard
deviation of locations about the home range centre.
</p>
<p>The value returned by <code>dbar</code> for ‘proximity’ or ‘count’ detectors
is of little use because multiple detections of an individual within an
occasion are in arbitrary order.
</p>
<p>Inclusion of these measures in the <span class="pkg">secr</span> package does not mean they are
recommended for general use! It is usually better to use a spatial
parameter from a fitted model (e.g., <code class="reqn">\sigma</code> of the
half-normal detection function). Even then, be careful that
<code class="reqn">\sigma</code> is not ‘contaminated’ with behavioural effects (e.g.
attraction of animal to detector) or ‘detection at a distance’.
</p>
<p>The argument 'names' was added in 3.0.1. The default <code>names = FALSE</code> 
causes a change in behaviour from that version onwards.
</p>


<h3>References</h3>

<p>Calhoun, J. B. and Casby, J. U. (1958) Calculation of home range and
density of small mammals. Public Health
Monograph. No. 55. U.S. Government Printing Office.
</p>
<p>Efford, M. G. (2004) Density estimation in live-trapping studies.
<em>Oikos</em> <b>106</b>, 598–610.
</p>
<p>Efford, M. G. (2023) ipsecr: An R package for awkward spatial capture–recapture data.
<em>Methods in Ecology and Evolution</em> In press.
</p>
<p>Jett, D. A. and Nichols, J. D. (1987) A field comparison of nested grid
and trapping web density estimators. <em>Journal of Mammalogy</em>
<b>68</b>, 888–892.
</p>
<p>Otis, D. L., Burnham, K. P., White, G. C. and Anderson, D. R. (1978)
Statistical inference from capture data on closed animal
populations. <em>Wildlife Monographs</em> <b>62</b>, 1–135.
</p>
<p>Slade, N. A. and Swihart, R. K. (1983) Home range indices for the hispid
cotton rat (<em>Sigmodon hispidus</em>) in Northeastern Kansas. <em>Journal of
Mammalogy</em> <b>64</b>, 580–590.
</p>


<h3>See Also</h3>

 <p><code>autoini</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
dbar(captdata)
RPSV(captdata)
RPSV(captdata, CC = TRUE)

centr &lt;- centroids(captdata)
plot(traps(captdata), border = 20 )
text(centr[,1], centr[,2], attr(centr, 'Ndetections'))
text(centr[,1]+2, centr[,2]+3, rownames(captdata), cex = 0.6,
    adj = 0)

</code></pre>


</div>