<div class="container">

<table style="width: 100%;"><tr>
<td>twostep_SurvSurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit survival-survival copula submodel with two-step estimator</h2>

<h3>Description</h3>

<p>The <code>twostep_SurvSurv()</code> function fits the copula (sub)model for a
time-to-event surrogate and true endpoint with a two-step estimator. In the
first step, the marginal distribution parameters are estimated through
maximum likelihood. In the second step, the copula parameter is estimate
while holding the marginal distribution parameters fixed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">twostep_SurvSurv(
  X,
  delta_X,
  Y,
  delta_Y,
  copula_family,
  n_knots,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(numeric) Possibly right-censored time-to-surrogate event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_X</code></td>
<td>
<p>(integer) Surrogate event indicator:
</p>

<ul>
<li> <p><code>1L</code> if surrogate event ocurred.
</p>
</li>
<li> <p><code>0L</code> if censored.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>(numeric) Possibly right-censored time-to-true endpoint event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_Y</code></td>
<td>
<p>(integer) True endpoint event indicator:
</p>

<ul>
<li> <p><code>1L</code> if true endpoint event ocurred.
</p>
</li>
<li> <p><code>0L</code> if censored.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_knots</code></td>
<td>
<p>Number of internal knots for the Royston-Parmar survival
models for <code class="reqn">\tilde{S}_0</code>, <code class="reqn">T_0</code>, <code class="reqn">\tilde{S}_1</code>, and <code class="reqn">T_1</code>.
If <code>length(n_knots) == 1</code>, the same number of knots are assumed for the
four marginal distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with three elements:
</p>

<ul>
<li>
<p> ml_fit: object of class <code>maxLik::maxLik</code> that contains the estimated copula
model.
</p>
</li>
<li>
<p> marginal_S_dist: object of class <code>fitdistrplus::fitdist</code> that represents the
marginal surrogate distribution.
</p>
</li>
<li>
<p> copula_family: string that indicates the copula family
</p>
</li>
</ul>
</div>