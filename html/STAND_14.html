<div class="container">

<table style="width: 100%;"><tr>
<td>lnorm.ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> ML Estimation for Lognormal Data with Non-detects </h2>

<h3>Description</h3>

 
<p>When an exposure measurement may be less than a detection limit closed
form and exact methods have not been developed for the lognormal
model.  The maximum likelihood (ML) principle is used to develop an
algorithm for parameter estimation, and to obtain large sample
equivalents of confidence limits for the mean exposure level, the
100p<em>th</em> percentile, and the exceedance fraction.  For a detailed
discussion of assumptions, properties, and computational issues
related to ML estimation see Cox and Hinkley (1979) and Cohen (1991).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lnorm.ml(dd)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>dd</code></td>
<td>
<p> An n by 2 matrix or data frame with <br>
x (exposure) variable in column 1, and <br>
det= 0 for non-detect or 1 for detect in Column 2  </p>
</td>
</tr></table>
<h3>Details</h3>

<p>For notational convenience the m detected values <code class="reqn">x[i]</code> are listed first 
followed by the <code class="reqn">nx[i]</code> indicating non-detects, so that the data are
<code class="reqn">x[i], i = 1, \ldots , m, nx[i] i = m + 1, \ldots ,n</code>. If <code class="reqn">nx[i]</code> is the same for each
non-detect, this is referred to as a left singly censored sample (Type I
censoring) and <code class="reqn">nx</code> is the limit of detection(LOD). If the <code class="reqn">nx[i]</code> are different,
this is known as randomly (or progressively) left-censored data[see
Cohen(1991) and Schmoyer et al (1996)]. In some situations a value of 0 is
recorded when the exposure measurement is less than the LOD. In this
situation, the value of <code class="reqn">nx[i]</code> is the LOD indicating that <code class="reqn">x</code> is in the interval
<code class="reqn">(0, nx[i])</code>. The probability density function for lognormal distribution is
</p>
<p style="text-align: center;"><code class="reqn">g(x;\mu,\sigma)= exp[-(log(x) - \mu)^2/(2\sigma^2)] /[\sigma x \sqrt(2\Pi )]</code>
</p>

<p>where <code class="reqn">y = log(x)</code> is normally distributed with mean <code class="reqn">\mu</code> and standard
deviation <code class="reqn">\sigma</code> [Atkinson and Brown (1969)]. The geometric mean of X is
<code class="reqn">GM = exp(\mu)</code> and the geometric standard deviation is <code class="reqn">GSD = exp(\sigma)</code>. 
Strom and Stansberry (2000) provide a summary of these and other
relationships for lognormal parameters. Assuming the data are a random
sample from a lognormal distribution, the log of the likelihood function for
the unknown parameters <code class="reqn">\mu</code>  and <code class="reqn">\sigma</code> given the data is
</p>
<p style="text-align: center;"><code class="reqn">L (\mu, \sigma )=\sum log[g(x; \mu, \sigma )] + \sum log[G (nx; \mu, \sigma )],</code>
</p>

<p>where <code class="reqn">G(x; \mu , \sigma)</code> is the lognormal distribution function, i.e., <code class="reqn">G(nx; \mu , \sigma)</code> is the probability that <code class="reqn">x \le nx</code>. 
The first summation is over <code class="reqn">i = 1, \ldots , m</code>, and the second is over <code class="reqn">i = m + 
1, \ldots ,n</code>.
</p>
<p>To test that the mean of <code class="reqn">X &gt; L</code>, <code class="reqn">Ho: E(X) &gt; L</code> at the
<code class="reqn">\alpha = 1- \gamma</code> significance level a one-sided upper <code class="reqn">100\gamma\%</code>
confidence limit can be used. One method for calculating this UCL is to use the
censored data equivalent of Cox's direct method; i.e., calculate the ML
estimate of <code class="reqn">\phi =\mu + [1/2] \sigma ^2</code>, and <code class="reqn">var(\phi) = var(\mu + [1/2] \sigma ^2)</code> where
</p>
<p style="text-align: center;"><code class="reqn">var(\phi )= var(\mu ) + [1/4] var(\sigma^2)+cov(\mu ,\sigma^2).</code>
</p>

<p>The ML estimator of E(X) is <code class="reqn">exp(\phi)</code>, the <code class="reqn">100\gamma {\%}</code> LCL for E(X)
is exp[<code class="reqn">\phi - t var(\phi )</code>], and the <code class="reqn">100\gamma\%</code> UCL for
E(x) is <code class="reqn">exp[\phi + t var(\phi )</code>], where <code class="reqn">t = t(\gamma , m-1)</code>. The
resulting confidence interval (LCL, UCL) has confidence level <code class="reqn">100(2\gamma
-1)\%</code>. An equivalent procedure is to estimate <code class="reqn">\phi = \mu + [1/2] \sigma^2</code>
and its standard error directly, i.e., by maximizing the log-likelihood with
parameters <code class="reqn">\mu + [1/2]\sigma^2</code> and <code class="reqn">\sigma^2</code>. ML estimates of <code class="reqn">\mu , \sigma , \phi , \sigma^2</code>,
estimates of their standard errors, and covariance terms are calculated.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> ML estimate of <code class="reqn">\mu</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> ML estimate of <code class="reqn">\sigma</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logEX</code></td>
<td>
<p> ML estimate of log of E(X)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaSq</code></td>
<td>
<p> ML estimate of <code class="reqn">\sigma^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.mu</code></td>
<td>
<p> ML estimate of standard error of <code class="reqn">\mu</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.sigma</code></td>
<td>
<p> ML estimate of standard error of <code class="reqn">\sigma</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.logEX</code></td>
<td>
<p> ML estimate of standard error of log of E(X)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.Sigmasq</code></td>
<td>
<p> ML estimate of standard error of <code class="reqn">\sigma^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.musig</code></td>
<td>
<p> ML estimate of cov(<code class="reqn">\mu</code>,<code class="reqn">\sigma)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of detects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations in the data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2log(L)</code></td>
<td>
<p> -2 times the log-likelihood function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> convergence indicator from <code>optim</code> </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Local function <code>ndln</code> is called by <code>optim</code> for <code>mu</code> and <code>sigma</code>
and local function <code>ndln2</code> is called by <code>optim</code> for <code>logEX</code> and <code>Sigmasq</code>.
</p>


<h3>Author(s)</h3>

<p>E. L. Frome</p>


<h3>References</h3>

<p>Cohen, A. C. (1991), <em>Truncated and Censored Samples</em>, Marcel Decker, New York
</p>
<p>Cox, D. R. and D. V. Hinkley (1979), <em>Theoretical Statistics</em>, Chapman and Hall, New York.
</p>
<p>Frome, E. L. and Wambach, P. F. (2005), "Statistical Methods and Software for 
the Analysis of Occupational Exposure Data with Non-Detectable Values," 
<em>ORNL/TM-2005/52,Oak Ridge National Laboratory</em>, Oak Ridge, TN 37830.
Available at: <a href="http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf">http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf</a>
</p>


<h3>See Also</h3>

 <p><code>optim</code>, <code>efraction.ml</code>, <code>percentile.ml</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate MLE for Example 2 in ORNLTM2005-52
data(beTWA)
mle.TWA&lt;- unlist(lnorm.ml(beTWA)) # ML for Be monitoring data
mle.TWA[1:4]  #  ML estimates of parameters
mle.TWA[5:8]  #  Standard errors of ML estimates
mle.TWA[9:13] #  additional results from lnorm.ml
</code></pre>


</div>