<div class="container">

<table style="width: 100%;"><tr>
<td>dpoilog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson-lognormal distribution
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
Poisson-lognormal distribution with parameters <code>mu</code> and <code>sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpoilog( x, mu, sig, log=FALSE)
ppoilog( q, mu, sig, lower.tail=TRUE, log.p=FALSE)
qpoilog( p, mu, sig, lower.tail = TRUE, log.p = FALSE)
rpoilog( n, mu, sig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. Usually a vector of abundances of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. Usually a vector of
abundances of species in a sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu,sig</code></td>
<td>

<p>parameters of the compounding lognormal distribution (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A compound Poisson-lognormal distribution is a Poisson probability distribution
where its single parameter lambda is a random variable with lognormal distribution. 
The density function is 
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{e^{x \mu + x^2 \sigma/2} (2 \pi \sigma)^{-1/2}}{x!}
  \, g(y)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">g(y) = \int_{-\infty}^\infty  \, e^{-e^y} \frac{e^{(-y-\mu-x
	  \sigma)^2}}{2 \sigma}  \, dy</code>
</p>

<p>(Bulmer 1974 eq.5). For x = 0, 1, 2, ... .
</p>
<p>In ecology, this distribution gives the probability that a species has
an abundance of x individuals in a random sample of a fraction 'f' of the
community. In the community, the species abundances are independent
random variables that follow a lognormal density function, with
parameters (mu + ln(f), sigma) (Engen et al. 2002).
</p>
<p>Hence, a Poisson-lognormal distribution is a model for species
abundances distributions (SAD) in a sample taken from a community
under the assumptions: (a) species
abundances in the community are independent identically distributed
lognormal variables, (b) sampling is a Poisson process with expected
value E[x]= f*n where n is the abundance in the community and f the
fraction of individuals sampled, (c) individuals are sampled with replacement, or the
fraction of total individuals sampled is small enough to approximate a
sample with replacement. See Engen (1977) and Alonso et al. (2008) for critical evaluations.
</p>


<h3>Value</h3>

<p>'dpoilog' gives the (log) density of the density, 'ppoilog' gives the (log)
distribution function, 'qpoilog' gives the quantile function.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda
</p>


<h3>Source</h3>

<p>These functions were built from <code>dpoilog</code> function from <span class="pkg">poilog</span>
package (Vidar Grøtan and Steinar Engen).
</p>
<p><code>dpoilog</code> is just a wrapper of <code>poilog::dpoilog</code> with an additional <code>log</code> argument.
</p>
<p><code>ppoilog</code> does the cumulative sum of <code>poilog::dpoilog</code>.
</p>
<p><code>qpoilog</code> uses modified bisection method to find numerically quantiles using
<code>ppoilog</code>.
</p>
<p><code>rpoilog</code> selects random values from a poilog distribution. It is unrelated to the 
function of the same name in <span class="pkg">poilog</span>.
</p>


<h3>References</h3>

<p>Alonso, D. and Ostling, A., and Etienne, R. S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. <em>Ecology Letters, 11</em>: 93-105.
</p>
<p>Bulmer,M. G. 1974. On Fitting the Poisson Lognormal Distribution to
Species-Abundance Data. <em>Biometrics, 30</em>: 101-110.
</p>
<p>Grøtan V. and Engen S. 2008. poilog: Poisson lognormal and
bivariate Poisson lognormal distribution. R package version 0.4.
</p>
<p>Engen, S. 1977. Comments on two different approaches to the analysis
of species frequency data. <em>Biometrics, 33</em>: 205-213.
</p>
<p>Engen, S., R. Lande, T. Walla &amp; P. J. DeVries. 2002. Analyzing spatial
structure of communities using the two-dimensional Poisson lognormal
species abundance model. <em>American Naturalist 160</em>: 60-73.
</p>


<h3>See Also</h3>

<p>dpois, dlnorm; dpoilog and rpoilog in <span class="pkg">poilog</span> package; <code>rsad</code> for random
generation, <code>fitpoilog</code> for maximum likelihood estimation.
</p>


</div>