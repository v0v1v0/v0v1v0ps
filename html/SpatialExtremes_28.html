<div class="container">

<table style="width: 100%;"><tr>
<td>fitextcoeff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non parametric estimators of the extremal coefficient function</h2>

<h3>Description</h3>

<p>Estimates non parametrically the extremal coefficient
function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitextcoeff(data, coord, ..., estim = "ST", marge = "emp", prob = 0,
plot = TRUE, loess = TRUE, method = "BFGS", std.err = TRUE, xlab,
ylab, angles = NULL, identify = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix representing the data. Each column corresponds to
one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A matrix that gives the coordinates of each
location. Each row corresponds to one location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options to be passed to the <code>plot</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estim</code></td>
<td>
<p>Character string specifying the estimator to be
used. Must be one of "ST" (Schlather and Tawn) or "Smith".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marge</code></td>
<td>
<p>Character string specifying how margins are transformed
to unit Frechet. Must be one of "emp", "mle" or "none" - see
Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>The probability related to the threshold. Only useful with
the <code>ST</code> estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the extremal
coefficient function is plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loess</code></td>
<td>
<p>If <code>TRUE</code> (default), a local polynomial curve is
plotted - see function <code>loess</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The optimizer used when fitting the GEV distribution to
data. See function <code>gevmle</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>Logical. If <code>TRUE</code>, standard errors are
computed. Note that standard errors are not available with the "ST"
estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>The x-axis and y-axis labels. May be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angles</code></td>
<td>
<p>A numeric vector. A partition of the interval
<code class="reqn">(-\pi, \pi)</code> to help detecting anisotropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>Logical. If <code>TRUE</code>, users can use the
<code>identify</code> function to identify pairs of stations on the
plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>During the estimation procedure, data need to be transformed to unit
Frechet margins firts. This can be done in two different ways ; by
using the empirical CDF or the GEV ML estimates.
</p>
<p>If <code>marge = "emp"</code>, then the data are transformed using the
following relation:  
</p>
<p style="text-align: center;"><code class="reqn">z_i = - \frac{1}{\log (F(y_i))}</code>
</p>

<p>where <code class="reqn">y_i</code> are the observations available at location
<code class="reqn">i</code>, <code class="reqn">F</code> is the empirical CDF and <code class="reqn">z_i</code> are the
observations transformed to unit Frechet scale.
</p>
<p>If <code>marge = "mle"</code>, then the data are transformed using the MLE
of the GEV distribution - see function <code>gev2frech</code>.
</p>
<p>Lastly, if data are already supposed to be unit Frechet, then no
transformation is performed if one passed the option <code>marge =
  "frech"</code>.
</p>
<p>If <code>data</code> are already componentwise maxima, <code>prob</code> should be
zero. Otherwise, users have to define a threshold <code class="reqn">z</code> (large
enough) where univariate extreme value arguments are relevant. We
define <code>prob</code> such that <code class="reqn">\Pr[Z \leq z] = prob</code>.
</p>


<h3>Value</h3>

<p>Plots the extremal coefficient function and returns the points used
for the plot. If <code>loess = TRUE</code>, the output is a list with
argument "ext.coeff" and "loess".
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Schlather, M. and Tawn, J. A. (2003) A dependence measure for
multivariate and spatial extreme values: Properties and
inference. Biometrika <b>90</b>(1):139â€“156.
</p>
<p>Smith, R. L. (1990) Max-stable processes and spatial
extremes. Unpublished manuscript.
</p>


<h3>See Also</h3>

<p><code>madogram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n.site &lt;- 30
locations &lt;- matrix(runif(2*n.site, 0, 10), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(50, locations, cov.mod = "gauss", cov11 = 10, cov12 =
40, cov22 = 220)

##Plot the extremal coefficient function
op &lt;- par(mfrow=c(1,2))
fitextcoeff(data, locations, estim = "Smith")
fitextcoeff(data, locations, angles = seq(-pi, pi, length = 4), estim = "Smith")
par(op)
</code></pre>


</div>