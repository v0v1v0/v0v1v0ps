<div class="container">

<table style="width: 100%;"><tr>
<td>PDEscatter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scatter Density Plot</h2>

<h3>Description</h3>

<p>Concept of Pareto density estimation (PDE) proposed for univsariate data by [Ultsch, 2005] and comparet to varius density estimation techniques by [Thrun et al., 2020] for univariate data is here applied for a scatter density plot. It was also applied in [Thrun and Ultsch, 2018] to bivariate data, but is not yet compared to other techniques.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PDEscatter(x,y,SampleSize,

na.rm=FALSE,PlotIt=TRUE,ParetoRadius,sampleParetoRadius,
                              
NrOfContourLines=20,Plotter='native', DrawTopView = TRUE,
                              
xlab="X", ylab="Y", main="PDEscatter",
                              
xlim, ylim, Legendlab_ggplot="value")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector [1:n], first feature (for x axis values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector [1:n], second feature (for y axis values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleSize</code></td>
<td>
<p>Numeric m, positiv scalar, maximum size of the sample used for calculation. High values increase runtime significantly. The default is that no sample is drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Function may not work with non finite values. If these cases should be automatically removed, set parameter TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParetoRadius</code></td>
<td>
<p>Numeric, positiv scalar, the Pareto Radius. If omitted (or 0), calculate by paretoRad.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleParetoRadius</code></td>
<td>
<p>Numeric, positiv scalar, maximum size of the sample used for estimation of "kernel", should be significantly lower than SampleSize because requires distance computations which is memory expensive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PlotIt</code></td>
<td>
<p><code>TRUE</code>: plots with function call
</p>
<p><code>FALSE</code>: Does not plot, plotting can be done using the list element <code>Handle</code>
</p>
<p><code>-1</code>: Computes density only, does not perfom any preperation for plotting meaning that <code>Handle=NULL</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NrOfContourLines</code></td>
<td>
<p>Numeric, number of contour lines to be drawn. 20 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plotter</code></td>
<td>
<p>String, name of the plotting backend to use. Possible values are: "<code>native</code>", "<code>ggplot</code>", "<code>plotly</code>"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DrawTopView</code></td>
<td>
<p>Boolean, True means contur is drawn, otherwise a 3D plot is drawn. Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>String, title of the x axis. Default: "X",   see <code>plot()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>String, title of the y axis. Default: "Y",   see <code>plot()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>string, the same as "main" in <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Legendlab_ggplot</code></td>
<td>
<p>String, in case of <code>Plotter="ggplot"</code> label for the legend. Default: "value"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>PDEscatter</code> function generates the density of the xy data as a z coordinate. Afterwards xyz will be plotted either as a contour plot or a 3d plot. It assumens that the cases of x and y are mapped to each other meaning that a <code>cbind(x,y)</code> operation is allowed.
This function plots the PDE on top of a scatterplot. Variances of x and y should not differ by extreme numbers, otherwise calculate the percentiles on both first. If <code>DrawTopView=FALSE</code> only the plotly option is currently available. If another option is chosen, the method switches automatically there.
</p>
<p>The method was succesfully used in [Thrun, 2018; Thrun/Ultsch 2018].
</p>
<p><code>PlotIt=FALSE</code> is usefull if one likes to perform adjustements like axis scaling prior to plotting with <span class="pkg">ggplot2</span> or  <span class="pkg">plotly</span>. In the case of "<code>native</code>"" the handle returns <code>NULL</code> because the basic R functon <code>plot</code>() is used
</p>


<h3>Value</h3>

<p>List of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric vector [1:m],m&lt;=n, first feature used in the plot or the kernels used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric vector [1:m],m&lt;=n, second feature used in the plot or the kernels used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Densities</code></td>
<td>
<p>Numeric vector [1:m],m&lt;=n, Number of points within the ParetoRadius of each point, i.e. density information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Matrix3D</code></td>
<td>
<p>1:n,1:3] marix of x,y and density information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParetoRadius</code></td>
<td>
<p>ParetoRadius used for PDEscatter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Handle</code></td>
<td>
<p>Handle of the plot object. Information-string if native R plot is used.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>MT contributed with several adjustments
</p>


<h3>Author(s)</h3>

<p>Felix Pape</p>


<h3>References</h3>

<p>[Thrun/Ultsch, 2018] Thrun, M. C., &amp; Ultsch, A. : Effects of the payout system of income taxes to municipalities in Germany, in Papiez, M. &amp; Smiech,, S. (eds.), Proc. 12th Professor Aleksander Zelias International Conference on Modelling and Forecasting of Socio-Economic Phenomena, pp. 533-542, Cracow: Foundation of the Cracow University of Economics, Cracow, Poland, 2018. 
</p>
<p>[Ultsch, 2005]  Ultsch, A.: Pareto density estimation: A density estimation for knowledge discovery, In Baier, D. &amp; Werrnecke, K. D. (Eds.), Innovations in classification, data science, and information systems, (Vol. 27, pp. 91-100), Berlin, Germany, Springer, 2005.
</p>
<p>[Thrun et al., 2020] Thrun, M. C., Gehlert, T. &amp; Ultsch, A.: Analyzing the Fine Structure of Distributions, PLoS ONE, Vol. 15(10), pp. 1-66, DOI <a href="https://doi.org/10.1371/journal.pone.0238835">doi:10.1371/journal.pone.0238835</a>, 2020. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">#taken from [Thrun/Ultsch, 2018]
if(requireNamespace("DataVisualizations")){
data("ITS",package = "DataVisualizations")
data("MTY",package = "DataVisualizations")
Inds=which(ITS&lt;900&amp;MTY&lt;8000)
plot(ITS[Inds],MTY[Inds],main='Bimodality is not visible in normal scatter plot')


PDEscatter(ITS[Inds],MTY[Inds],xlab = 'ITS in EUR',

ylab ='MTY in EUR' ,main='Pareto Density Estimation indicates Bimodality' )


}
</code></pre>


</div>