<div class="container">

<table style="width: 100%;"><tr>
<td>spte_decor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decorrelate the spatio-temporal data</h2>

<h3>Description</h3>

<p>The function <code>spte_decor</code> uses the estimated spatio-temporal mean and 
covariance to decorrelate the observed spatio-temporal data. After data 
decorrelation, each decorrelated observation should have asymptotic mean of 
0 and asymptotic variance of 1, and the decorrelated data should be 
asymptotically uncorrelated with each other.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spte_decor(y, st, y0, st0, T = 1, ht = NULL, hs = NULL, gt = NULL, gs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations to decorrelate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and observation 
times of the observations to decorrelate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>A vector of <code class="reqn">N_0</code> in-control (IC) spatio-temporal observations from 
which the IC spatio-temporal mean and covariance functions can be estimated
via <code>spte_meanest</code> and <code>spte_covest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st0</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code>, and it will 
be chosen by the modified cross-validation <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code>, and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.res</code></td>
<td>
<p>The decorrelated data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2020). Online Sequential Monitoring of Spatio-Temporal 
Disease Incidence Rates. <em>IISE Transactions</em>, <strong>52</strong>, 1218-1233.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
decor &lt;- spte_decor(y.sub,st.sub,y0=y.sub,st0=st.sub)
</code></pre>


</div>