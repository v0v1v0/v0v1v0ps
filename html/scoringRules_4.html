<div class="container">

<table style="width: 100%;"><tr>
<td>crps.numeric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Continuous Ranked Probability Score for Parametric Forecast Distributions</h2>

<h3>Description</h3>

<p>Calculate the Continuous Ranked Probability Score (CRPS) given observations
and parameters of a family of distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'numeric'
crps(y, family, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of realized values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>string which specifies the parametric family; current options:
<code>"2pexp", "2pnorm", "beta", "binom", "clogis", "cnorm", "ct", "exp", "expM",
"exponential", "gamma", "gev", "gpd", "gtclogis", "gtcnorm", "gtct", "hyper", "lapl",
"laplace", "llapl", "llogis", "lnorm", "log-laplace", "log-logistic",
"log-normal", "logis", "logistic", "mixnorm", "mixture-normal", "nbinom",
"negative-binomial", "norm", "normal", "pois", "poisson", "t", "tlogis",
"tnorm", "tt", "two-piece-exponential", "two-piece-normal", "unif", "uniform"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>vectors of parameter values; expected input depends on the chosen
<code>family</code>. See details below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mathematical details are available in Appendix A of the vignette
<em>Evaluating probabilistic forecasts with scoringRules</em> that
accompanies the package.
</p>
<p>The parameters supplied to each of the functions are numeric vectors:
</p>

<ol>
<li>
<p> Distributions defined on the real line:
</p>

<ul>
<li>
<p><code>"laplace"</code> or <code>"lapl"</code>:
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter);
see <code>crps_lapl</code>
</p>
</li>
<li>
<p><code>"logistic"</code> or <code>"logis"</code>:
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter);
see <code>crps_logis</code>
</p>
</li>
<li>
<p><code>"normal"</code> or <code>"norm"</code>:
<code>mean</code>, <code>sd</code> (mean and standard deviation);
see <code>crps_norm</code>
</p>
</li>
<li>
<p><code>"normal-mixture"</code> or <code>"mixture-normal"</code> or <code>"mixnorm"</code>:
<code>m</code> (mean parameters),
<code>s</code> (standard deviations),
<code>w</code> (weights);
see <code>crps_mixnorm</code>;
note: matrix-input for parameters
</p>
</li>
<li>
<p><code>"t"</code>:
<code>df</code> (degrees of freedom),
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter);
see <code>crps_t</code>
</p>
</li>
<li>
<p><code>"two-piece-exponential"</code> or <code>"2pexp"</code>:
<code>location</code> (real-valued location parameter),
<code>scale1</code>, <code>scale2</code> (positive scale parameters);
see <code>crps_2pexp</code>
</p>
</li>
<li>
<p><code>"two-piece-normal"</code> or <code>"2pnorm"</code>:
<code>location</code> (real-valued location parameter),
<code>scale1</code>, <code>scale2</code> (positive scale parameters);
see <code>crps_2pnorm</code>
</p>
</li>
</ul>
</li>
<li>
<p> Distributions for non-negative random variables:
</p>

<ul>
<li>
<p><code>"exponential"</code> or <code>"exp"</code>:
<code>rate</code> (positive rate parameter);
see <code>crps_exp</code>
</p>
</li>
<li>
<p><code>"gamma"</code>:
<code>shape</code> (positive shape parameter),
<code>rate</code> (positive rate parameter),
<code>scale</code> (alternative to <code>rate</code>);
see <code>crps_gamma</code>
</p>
</li>
<li>
<p><code>"log-laplace"</code> or <code>"llapl"</code>:
<code>locationlog</code> (real-valued location parameter),
<code>scalelog</code> (positive scale parameter);
see <code>crps_llapl</code>
</p>
</li>
<li>
<p><code>"log-logistic"</code> or <code>"llogis"</code>:
<code>locationlog</code> (real-valued location parameter),
<code>scalelog</code> (positive scale parameter);
see <code>crps_llogis</code>
</p>
</li>
<li>
<p><code>"log-normal"</code> or <code>"lnorm"</code>:
<code>locationlog</code> (real-valued location parameter),
<code>scalelog</code> (positive scale parameter);
see <code>crps_lnorm</code>
</p>
</li>
</ul>
</li>
<li>
<p> Distributions with flexible support and/or point masses:
</p>

<ul>
<li>
<p><code>"beta"</code>:
<code>shape1</code>, <code>shape2</code> (positive shape parameters),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_beta</code>
</p>
</li>
<li>
<p><code>"uniform"</code> or <code>"unif"</code>:
<code>min</code>, <code>max</code> (lower and upper limits),
<code>lmass</code>, <code>umass</code> (point mass in lower or upper limit);
see <code>crps_unif</code>
</p>
</li>
<li>
<p><code>"expM"</code>:
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter),
<code>mass</code> (point mass in <code>location</code>);
see <code>crps_expM</code>
</p>
</li>
<li>
<p><code>"gev"</code>:
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter),
<code>shape</code> (real-valued shape parameter);
see <code>crps_gev</code>
</p>
</li>
<li>
<p><code>"gpd"</code>:
<code>location</code> (real-valued location parameter),
<code>scale</code> (positive scale parameter),
<code>shape</code> (real-valued shape parameter),
<code>mass</code> (point mass in <code>location</code>);
see <code>crps_gpd</code>
</p>
</li>
<li>
<p><code>"tlogis"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_tlogis</code>
</p>
</li>
<li>
<p><code>"clogis"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_clogis</code>
</p>
</li>
<li>
<p><code>"gtclogis"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
<code>lmass</code>, <code>umass</code> (point mass in lower or upper limit);
see <code>crps_gtclogis</code>
</p>
</li>
<li>
<p><code>"tnorm"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_tnorm</code>
</p>
</li>
<li>
<p><code>"cnorm"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_cnorm</code>
</p>
</li>
<li>
<p><code>"gtcnorm"</code>:
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
<code>lmass</code>, <code>umass</code> (point mass in lower or upper limit);
see <code>crps_gtcnorm</code>
</p>
</li>
<li>
<p><code>"tt"</code>:
<code>df</code> (degrees of freedom),
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_tt</code>
</p>
</li>
<li>
<p><code>"ct"</code>:
<code>df</code> (degrees of freedom),
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
see <code>crps_ct</code>
</p>
</li>
<li>
<p><code>"gtct"</code>:
<code>df</code> (degrees of freedom),
<code>location</code> (location parameter),
<code>scale</code> (scale parameter),
<code>lower</code>, <code>upper</code> (lower and upper limits);
<code>lmass</code>, <code>umass</code> (point mass in lower or upper limit);
see <code>crps_gtct</code>
</p>
</li>
</ul>
</li>
<li>
<p> Distributions of discrete variables:
</p>

<ul>
<li> 
<p><code>"binom"</code>:
<code>size</code> (number of trials (zero or more)),
<code>prob</code> (probability of success on each trial);
see <code>crps_binom</code>
</p>
</li>
<li> 
<p><code>"hyper"</code>:
<code>m</code> (the number of white balls in the urn),
<code>n</code> (the number of black balls in the urn),
<code>k</code> (the number of balls drawn from the urn);
see <code>crps_hyper</code>
</p>
</li>
<li>
<p><code>"negative-binomial"</code> or <code>"nbinom"</code>:
<code>size</code> (positive dispersion parameter),
<code>prob</code> (success probability),
<code>mu</code> (mean, alternative to <code>prob</code>);
see <code>crps_nbinom</code>
</p>
</li>
<li>
<p><code>"poisson"</code> or <code>"pois"</code>:
<code>lambda</code> (positive mean);
see <code>crps_pois</code>
</p>
</li>
</ul>
</li>
</ol>
<p>All numerical arguments should be of the same length.
An exception are scalars of length 1, which will be recycled.
</p>


<h3>Value</h3>

<p>Vector of score values.
<em>A lower score indicates a better forecast.</em>
</p>


<h3>Author(s)</h3>

<p>Alexander Jordan, Fabian Krueger, Sebastian Lerch
</p>


<h3>References</h3>

<p><em>Closed form expressions of the CRPS for specific distributions:</em>
</p>
<p>Baran, S. and S. Lerch (2015):
'Log-normal distribution based Ensemble Model Output Statistics models for
probabilistic wind-speed forecasting',
Quarterly Journal of the Royal Meteorological Society 141, 2289-2299.
<a href="https://doi.org/10.1002/qj.2521">doi:10.1002/qj.2521</a>
<em>(Log-normal)</em>
</p>
<p>Friederichs, P. and T.L. Thorarinsdottir (2012):
'Forecast verification for extreme value distributions with an application
to probabilistic peak wind prediction',
Environmetrics 23, 579-594.
<a href="https://doi.org/10.1002/env.2176">doi:10.1002/env.2176</a>
<em>(Generalized Extreme Value, Generalized Pareto)</em>
</p>
<p>Gneiting, T., Larson, K., Westvelt III, A.H. and T. Goldman (2005):
'Calibrated probabilistic forecasting using ensemble model output statistics
and minimum CRPS estimation',
Monthly Weather Review 133, 1098-1118.
<a href="https://doi.org/10.1175/mwr2904.1">doi:10.1175/mwr2904.1</a>
<em>(Normal)</em>
</p>
<p>Gneiting, T., Larson, K., Westrick, K., Genton, M.G. and E. Aldrich (2006):
'Calibrated probabilistic forecasting at the stateline wind energy center:
The regime-switching space-time method',
Journal of the American Statistical Association 101, 968-979.
<a href="https://doi.org/10.1198/016214506000000456">doi:10.1198/016214506000000456</a>
<em>(Censored normal)</em>
</p>
<p>Gneiting, T. and T.L. Thorarinsdottir (2010):
‘Predicting inflation: Professional experts versus no-change forecasts’,
arXiv preprint arXiv:1010.2318.
<em>(Two-piece normal)</em>
</p>
<p>Grimit, E.P.,  Gneiting, T., Berrocal, V.J. and N.A. Johnson (2006):
'The continuous ranked probability score for circular variables and its
application to mesoscale forecast ensemble verification',
Quarterly Journal of the Royal Meteorological Society 132, 2925-2942.
<a href="https://doi.org/10.1256/qj.05.235">doi:10.1256/qj.05.235</a>
<em>(Mixture of normals)</em>
</p>
<p>Scheuerer, M. and D. Moeller (2015):
'Probabilistic wind speed forecasting on a grid based on ensemble model
output statistics', Annals of Applied Statistics 9, 1328-1349.
<a href="https://doi.org/10.1214/15-aoas843">doi:10.1214/15-aoas843</a>
<em>(Gamma)</em>
</p>
<p>Thorarinsdottir, T.L. and T. Gneiting (2010):
'Probabilistic forecasts of wind speed: ensemble model output statistics by
using heteroscedastic censored regression',
Journal of the Royal Statistical Society (Series A) 173, 371-388.
<a href="https://doi.org/10.1111/j.1467-985x.2009.00616.x">doi:10.1111/j.1467-985x.2009.00616.x</a>
<em>(Truncated normal)</em>
</p>
<p>Wei, W. and L. Held (2014):
‘Calibration tests for count data’,
TEST 23, 787-205.
<a href="https://doi.org/10.1007/s11749-014-0380-8">doi:10.1007/s11749-014-0380-8</a>
<em>(Poisson, Negative Binomial)</em>
</p>
<p><em>Independent listing of closed-form solutions for the CRPS:</em>
</p>
<p>Taillardat, M., Mestre, O., Zamo, M. and P. Naveau (2016):
'Calibrated ensemble forecasts using quantile regression forests and
ensemble model output statistics',
Monthly Weather Review 144, 2375-2393. 
<a href="https://doi.org/10.1175/mwr-d-15-0260.1">doi:10.1175/mwr-d-15-0260.1</a>
</p>


<h3>See Also</h3>

<p><code>logs.numeric</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">crps(y = 1, family = "normal", mean = 0, sd = 2)
crps(y = rnorm(20), family = "normal", mean = 1:20, sd = sqrt(1:20))

## Arguments can have different lengths:
crps(y = rnorm(20), family = "normal", mean = 0, sd = 2)
crps(y = 1, family = "normal", mean = 1:20, sd = sqrt(1:20))

## Mixture of normal distributions requires matrix input for parameters:
mval &lt;- matrix(rnorm(20*50), nrow = 20)
sdval &lt;- matrix(runif(20*50, min = 0, max = 2), nrow = 20)
weights &lt;- matrix(rep(1/50, 20*50), nrow = 20)
crps(y = rnorm(20), family = "mixnorm", m = mval, s = sdval, w = weights)


</code></pre>


</div>