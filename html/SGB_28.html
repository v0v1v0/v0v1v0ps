<div class="container">

<table style="width: 100%;"><tr>
<td>Imputation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Imputation of missing parts in compositions from a SGB model
</h2>

<h3>Description</h3>

<p>Applied to a completely missing composition, the function returns the Aitchison expectation. <br>
Applied to a partially missing composition, it returns the conditional Aitchison expectation, given the observed sub-composition. <br>
Applied to a complete case, it returns the complete case. <br></p>


<h3>Usage</h3>

<pre><code class="language-R">impute.regSGB(obj, dsup, usup)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>

<p>list, output of regSGB.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsup</code></td>
<td>

<p>data frame with explanatory variables for the incomplete compositions. Missing values not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usup</code></td>
<td>

<p>compositions corresponding to <code>dsup</code>. On each row, the non-missing parts sum to 1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data frame with imputed compositions instead of missing or partially missing compositions. Complete cases are also returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Arctic lake
data(arc)
arcmis &lt;- arc
arc[11:13,]

## Introduce NA alues

arcmis[11,2] &lt;- NA      # "core" observation
arcmis[12,3] &lt;- NA      # outlying clay value
arcmis[13,1:3] &lt;- NA    # totally missing observation
umis &lt;- arcmis[,1:3]
umis &lt;- umis/rowSums(umis,na.rm=TRUE)
umis[11:13,]

d &lt;- data.frame(depth=arc[["depth"]])

## original compositions
arc[11:13,1:3]

## unconditional predicted value                            
MeanA.SGB(oilr[["par"]][1],oilr[["scale"]],oilr[["par"]][4:6] )[11:13,]

## predicted value given the sub-composition (sand,clay) for 11, (sand,silt) for 12        
impute.regSGB(oilr,arcmis,umis)[11:13, ]

impute.regSGB(oilr,arcmis[11:13, ],umis[11:13, ])  # same result. 
</code></pre>


</div>