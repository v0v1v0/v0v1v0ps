<div class="container">

<table style="width: 100%;"><tr>
<td>tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Utility functions to obtain p-values from tests on individual ratios
</h2>

<h3>Description</h3>

<p>These functions can be used in the functions to perform analysis on
all pairwise ratios of a compositional dataset
</p>


<h3>Usage</h3>

<pre><code class="language-R">student.fpc( d, variable, v.X, var.equal = TRUE, ... )
anva1.fpc( d, variable, v.X, frm = NULL, ... )
anva1vi.fpc( d, variable, v.X, frm = NULL, ... )
rls.fpc( d, variable, v.X, frm = NULL, ... )
kw.fpc( d, variable, v.X, frm = NULL, ... )
anva_SC.fpc( d, variable, frm, SC = 1, type = 1, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>The data frame that contains the ratio to test, and all variables of
the original data frame that where not used as compositional data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>

<p>A length-one character vector containing the names of the variable
corresponding to the ratio (or log-ratio) to test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.X</code></td>
<td>

<p>The <strong>name</strong> of the explanatory (independant, predictor)
variable. This variable should be a factor for <code>anva1.fpc</code>,
<code>anva1vi.fpc</code> and <code>kw.fpc</code> and a numeric for
<code>rls.fpc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frm</code></td>
<td>

<p>The formula to use.
</p>
<p>Defaults to <code>as.formula( paste0( variable,
      "~", v.X ) )</code> for <code>anva1.fpc</code>, <code>anva1vi.fpc</code> and <code>kw.fpc</code>.
Providing the formula speeds up the computation, since it avoids
repeating the construction step for each ratio.
</p>
<p>For <code>anva_SC.fpc</code>, giving the formula is mandatory and
<code>variable</code> is unused. Beware of the term order to select the
right sum of squares to test!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SC</code></td>
<td>

<p>For <code>anva_SC.fpc</code>, the number of the line to use in the analysis
of variance table to get a p-value, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>For <code>anva_SC.fpc</code>, the kind of sums of square to be used when
constructing the analysis of variance table, see details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>

<p>For <code>student.fpc</code>, shall we assume that variance are equals in
the two groups (<code>TRUE</code>, the default) or not
(<code>FALSE</code>).  Same as in <code>t.test</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are only wrapper to some commonly used tests. The
correspondance is as follow
</p>

<table>
<tr>
<td style="text-align: right;">
    <code>student.fpc</code> </td>
<td style="text-align: left;"> Student's T-test </td>
<td style="text-align: left;"> <code>t.test()$p.value</code> </td>
</tr>
<tr>
<td style="text-align: right;">
    <code>anva1.fpc</code> </td>
<td style="text-align: left;"> One-way analysis of variance </td>
<td style="text-align: left;"> <code>anova(lm())[ 1, 5 ]</code> </td>
</tr>
<tr>
<td style="text-align: right;">
    <code>rls.fpc</code> </td>
<td style="text-align: left;"> Simple linear regression </td>
<td style="text-align: left;"> <code>anova(lm())[ 1, 5 ]</code> </td>
</tr>
<tr>
<td style="text-align: right;">
    <code>anva1vi.fpc</code> </td>
<td style="text-align: left;"> One-way analysis of variance, without equal
    variance assumption </td>
<td style="text-align: left;"> <code>oneway.test()$p.value</code> </td>
</tr>
<tr>
<td style="text-align: right;">
    <code>kw.fpc</code> </td>
<td style="text-align: left;"> Kruskal-Wallis test </td>
<td style="text-align: left;"> <code>kruskal.test()$p.value</code> </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<p><code>anva_SC.fpc</code> is a generic wrapper for <code>lm</code> using any
formula. It then extracts the <em>p</em>-value of the line given by
<code>SC</code> in the analysis of variance table. If <code>type = 1</code>, the
table is built using <code>anova</code> and corresponds to type 1
(sequential sum of square).  If <code>type = 2</code> or <code>type = 3</code>,
the table is built using <code>car::Anova</code> and corresponds either to
type 2 or type 3 sums of squares.
</p>
<p>For Student's test (either with equal or unequal variances), instead
of calling t.test, the computation is done internally, hopefully
speeding up (less controls are done and only useful computations are done)
</p>


<h3>Value</h3>

<p> These function returns the <em>p</em>-value from the corresponding test.
</p>


<h3>Note</h3>

<p><code>rls.fpc</code> is an exact synonym for <code>anva1.fpc</code>, since the
underlying theory is the same. Distinction is made to help users
without a formal statistical background to find the right test.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>kruskal.test</code>, <code>lm</code>, <code>anova</code>,
<code>Anova</code>, <code>oneway.test</code>, for corresponding tests.
</p>
<p><code>equiv.fpc</code> for an approach using equivalence tests.
</p>
<p><code>creer.Mp</code> to use these functions to create a matrix of
<em>p</em>-values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # load the potery data set
   data( poteries )

   # Compute one-way ANOVA p-values for all ratios in this data set   
   Mp &lt;- creer.Mp( poteries, c( 'Al', 'Na', 'Fe', 'Ca', 'Mg' ),
                   f.p = anva1.fpc, v.X = 'Site', frm = R ~ Site )
   Mp

   # Make a graphe from it and plot it
   plot( grf.Mp( Mp ) )
</code></pre>


</div>