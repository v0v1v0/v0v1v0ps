<div class="container">

<table style="width: 100%;"><tr>
<td>sbm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a size biased model</h2>

<h3>Description</h3>

<p>Fits a parametric or non-parametric size biased distribution model to a
positive response variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sbm(
  formula,
  data,
  pdf = c("none", "lnorm", "gamma", "weibull"),
  var.range = c(-4, 4),
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A two-sided formula of the form response ~ covariate + ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe containing the fields named in formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>
<p>A text value naming the probability density function to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.range</code></td>
<td>
<p>The range of log variance within which to search when
fitting parametric distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Logical defining whether to show diagnostic information when
fitting parametric distributions (passed to <code>mle2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>predict.sbm</code> (options:
<code>newdata</code>, <code>reps</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Response values must be strictly positive. To fit a distribution
without covariates use 1 on the right hand side of the formula. When
pdf = "none", the harmonic mean and it's standard error are calculated,
and no covariates can be used.
</p>
<p>The contents of the the <code>estimate</code> component of the result depends
on the type of model. When no covariates are used, it contains a single
overall average estimate. When covariates are used and <code>newdata = NULL</code>,
it contains one estimate per unique combination of factor covariate levels,
with any quantitative covariates held at their mean values. When covariates
are used and a dataframe with valid covariate fields is supplied to
<code>newdata</code>, it replicates <code>newdata</code> appending averages estimated at
the covariate values supplied.
</p>


<h3>Value</h3>

<p>A list of class <code>sbm</code> with methods <code>summary.sbm</code>,
<code>predict.sbm</code>, <code>hist.sbm</code>, and
<code>AIC.sbm</code>. The list has elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"estimate"</code></td>
<td>
<p>A dataframe of estimated averages, their standard
errors and 95% confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"data"</code></td>
<td>
<p>A dataframe containing the data used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"model"</code></td>
<td>
<p>A model object of class <code>mle2.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"formula"</code></td>
<td>
<p>The formula supplied to the function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"pdf"</code></td>
<td>
<p>Character string recording the probability density function
used to fit the model.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">  data(BCI_speed_data)
  agoutiData &lt;- subset(BCI_speed_data, species=="agouti")

  # harmonic mean estimate for agouti
  hmod &lt;- sbm(speed~1, agoutiData)

  # lognormal estimate with or without a covariates
  lmod &lt;- sbm(speed~1, agoutiData, pdf="lnorm")
  lmod_mass &lt;- sbm(speed~mass, BCI_speed_data, pdf="lnorm")
  lmod_spp &lt;- sbm(speed~species, BCI_speed_data, pdf="lnorm")

  # inspect estimates
  hmod$estimate
  lmod$estimate
  lmod_mass$estimate
  lmod_spp$estimate
</code></pre>


</div>