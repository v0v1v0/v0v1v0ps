<div class="container">

<table style="width: 100%;"><tr>
<td>MatchRegionStats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Match DNA sequence characteristics</h2>

<h3>Description</h3>

<p>Return a vector if genomic regions that match the distribution of a set of
query regions for any given set of characteristics, specified in the input
<code>meta.feature</code> dataframe.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MatchRegionStats(
  meta.feature,
  query.feature,
  features.match = c("GC.percent"),
  n = 10000,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>meta.feature</code></td>
<td>
<p>A dataframe containing DNA sequence information for
features to choose from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query.feature</code></td>
<td>
<p>A dataframe containing DNA sequence information for
features to match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features.match</code></td>
<td>
<p>Which features of the query to match when selecting a
set of regions. A vector of column names present in the feature metadata can
be supplied to match multiple characteristics at once. Default is GC content.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of regions to select, with characteristics matching the query</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each requested feature to match, a density
distribution is estimated using the <code>density</code> function,
and a set of weights for each feature in the dataset estimated based on the
density distribution. If multiple features are to be matched (for example,
GC content and overall accessibility), a joint density distribution is then
computed by multiplying the individual feature weights. A set of features
with characteristics matching the query regions is then selected using the
<code>sample</code> function, with the probability of randomly
selecting each feature equal to the joint density distribution weight.
</p>


<h3>Value</h3>

<p>Returns a character vector
</p>


<h3>Examples</h3>

<pre><code class="language-R">metafeatures &lt;- SeuratObject::GetAssayData(
  object = atac_small[['peaks']], layer = 'meta.features'
)
query.feature &lt;- metafeatures[1:10, ]
features.choose &lt;- metafeatures[11:nrow(metafeatures), ]
MatchRegionStats(
  meta.feature = features.choose,
  query.feature = query.feature,
  features.match = "percentile",
  n = 10
)
</code></pre>


</div>