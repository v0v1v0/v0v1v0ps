<div class="container">

<table style="width: 100%;"><tr>
<td>sklars.omega</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply Sklar's Omega.</h2>

<h3>Description</h3>

<p>Apply Sklar's Omega.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sklars.omega(
  data,
  level = c("nominal", "ordinal", "count", "percentage", "amount", "balance"),
  confint = c("none", "bootstrap", "asymptotic"),
  verbose = FALSE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix of scores. Each row corresponds to a unit, each column a coder. The columns must be named appropriately so that the correct copula correlation matrix can be constructed. See <code>build.R</code> for details regarding column naming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of measurement, one of <code>"nominal"</code>, <code>"ordinal"</code>, <code>"count"</code>, <code>"amount"</code>, <code>"balance"</code>, or <code>"percentage"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>the method for computing confidence intervals, one of <code>"none"</code>, <code>"bootstrap"</code>, or <code>"asymptotic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if TRUE, various messages may be printed to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters.
</p>

<dl>
<dt><code>bootit</code></dt>
<dd>
<p>the size of the (parametric) bootstrap sample. This applies when <code>confint = "bootstrap"</code> or when <code>confint = "asymptotic"</code> and <code>level = "count"</code>. Defaults to 1,000.</p>
</dd>
<dt>dist</dt>
<dd>
<p>when <code>level = "balance"</code>, one of <code>"gaussian"</code>, <code>"laplace"</code>, <code>"t"</code>, or <code>"empirical"</code>; when <code>level = "amount"</code>, one of <code>"gamma"</code> or <code>"empirical"</code>; when <code>level = "percentage"</code>, one of <code>"beta"</code> or <code>"kumaraswamy"</code>; when <code>level = "count"</code>, one of <code>"poisson"</code> or <code>"negbinomial"</code>.</p>
</dd>
<dt>nodes</dt>
<dd>
<p>the desired number of nodes in the cluster.</p>
</dd>
<dt>parallel</dt>
<dd>
<p>logical; if TRUE (the default is FALSE), bootstrapping is done in parallel.</p>
</dd>
<dt>type</dt>
<dd>
<p>one of the supported cluster types for <code>makeCluster</code>. Defaults to <code>"SOCK"</code>.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the package's flagship function. It applies the Sklar's Omega methodology to nominal, ordinal, count, amount, balance, or percentage outcomes, and, if desired, produces confidence intervals. Parallel computing is supported, when applicable, and other measures (e.g., sparse matrix operations) are taken in the interest of computational efficiency.
</p>
<p>If the level of measurement is nominal or ordinal, the scores (which must take values in <code class="reqn">1, \dots , K</code>) are assumed to share a common categorical marginal distribution. A composite marginal likelihood (CML) approach is used for categorical scores. Only parametric bootstrap intervals are supported for categorical outcomes since sandwich estimation tends to lead to inflated standard errors.
</p>
<p>If the scores are counts, control parameter <code>dist</code> must be used to select a marginal distribution of <code>"poisson"</code> or <code>"negbinomial"</code>. For counts a distributional transform (DT) approximation of the likelihood is employed. Either bootstrap or sandwich intervals are available: <code>confint = "bootstrap"</code> or <code>confint = "asymptotic"</code>.
</p>
<p>If the level of measurement is balance or amount or percentage, control parameter <code>dist</code> must be used to select a marginal distribution from among <code>"gaussian"</code>, <code>"laplace"</code>, <code>"t"</code>, and <code>"empirical"</code>; or from among <code>"gamma"</code> and <code>"empirical"</code>; or from among <code>"beta"</code> or <code>"kumaraswamy"</code>, respectively. The method of maximum likelihood (ML) is used unless <code>dist = "empirical"</code>, in which case conditional maximum likelihood is used, i.e., the copula parameters are estimated conditional on the sample distribution function of the scores. For the ML method, both bootstrap and asymptotic confidence intervals are available. When <code>dist = "empirical"</code>, only bootstrap intervals are available.
</p>
<p>When applicable, functions of appropriate sample quantities are used as starting values for marginal parameters, regardless of the level of measurement.
</p>


<h3>Value</h3>

<p>Function <code>sklars.omega</code> returns an object of class <code>"sklarsomega"</code>, which is a list comprising the following elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>the value of AIC for the fit, if <code>level = "amount"</code> or <code>level = "balance"</code> and <code>dist != "empirical"</code>, or if <code>level = "percentage"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>the value of BIC for the fit, if <code>level = "amount"</code> or <code>level = "balance"</code> and <code>dist != "empirical"</code>, or if <code>level = "percentage"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.sample</code></td>
<td>
<p>when applicable, the bootstrap sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>the value of argument <code>confint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>the list of control parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>unless optimization failed, the value of <code>convergence</code> returned by <code>optim</code> or <code>hjkb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.hat</code></td>
<td>
<p>if <code>confint = "asymptotic"</code>, the estimate of the covariance matrix of the parameter estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the matrix of scores, perhaps altered to remove rows (units) containing fewer than two scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>if optimization converged, the number of iterations required to optimize the objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of measurement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>if applicable, the value of <code>message</code> returned by <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the approach to inference, one of <code>"CML"</code>, <code>"DT"</code>, <code>"ML"</code>, or <code>"SMP"</code> (semiparametric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpar</code></td>
<td>
<p>the number of marginal parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>the total number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>the method used to optimize the objective function. The L-BFGS-B method is attempted first. If L-BFGS-B fails, a second attempt is made using the bounded Hooke-Jeeves algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the initial value of the copula correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.hat</code></td>
<td>
<p>the estimated value of the copula correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.R.hat</code></td>
<td>
<p>a square root of the estimated copula correlation matrix. This is used for simulation and to compute the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the minimum of the log objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>the value of argument <code>verbose</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the scores as a vector, perhaps altered to remove rows (units) containing only one score.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hughes, J. (2018). Sklar's Omega: A Gaussian copula-based framework for assessing agreement. <em>ArXiv e-prints</em>, March.
</p>
<p>Nissi, M. J., Mortazavi, S., Hughes, J., Morgan, P., and Ellermann, J. (2015). T2* relaxation time of acetabular and femoral cartilage with and without intra-articular Gd-DTPA2 in patients with femoroacetabular impingement. <em>American Journal of Roentgenology</em>, <b>204</b>(6), W695.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fit a subset of the cartilage data, assuming a Laplace marginal distribution. Compute
# confidence intervals in the usual ML way (observed information matrix).

data(cartilage)
data.cart = as.matrix(cartilage)[1:100, ]
colnames(data.cart) = c("c.1.1", "c.2.1")
fit.lap = sklars.omega(data.cart, level = "balance", confint = "asymptotic",
                       control = list(dist = "laplace"))
summary(fit.lap)

# Now assume a noncentral t marginal distribution.

fit.t = sklars.omega(data.cart, level = "balance", confint = "asymptotic",
                     control = list(dist = "t"))
summary(fit.t)
</code></pre>


</div>