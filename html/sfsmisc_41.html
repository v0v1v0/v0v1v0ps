<div class="container">

<table style="width: 100%;"><tr>
<td>integrate.xy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cheap Numerical Integration through Data Points</h2>

<h3>Description</h3>

<p>Given <code class="reqn">(x_i, f_i)</code> where <code class="reqn">f_i = f(x_i)</code>, compute a cheap
approximation of <code class="reqn">\int_a^b f(x) dx</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">integrate.xy(x, fx, a, b, use.spline=TRUE, xtol=2e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>abscissa values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>corresponding values of <code class="reqn">f(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a,b</code></td>
<td>
<p>the boundaries of integration; these default to min(x) and
max(x) respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.spline</code></td>
<td>
<p>logical; if TRUE use an interpolating spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol</code></td>
<td>
<p>tolerance factor, typically around
<code>sqrt(.Machine$double.eps)</code> ......(fixme)....</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that this is really not good for noisy <code>fx</code> values;
probably a smoothing spline should be used in that case.
</p>
<p>Also, we are not yet using Romberg in order to improve the trapezoid
rule.  This would be quite an improvement in equidistant cases.
</p>


<h3>Value</h3>

<p>the approximate integral.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, May 1994 (for S).</p>


<h3>See Also</h3>

<p><code>integrate</code> for numerical integration of
<em>functions</em>.</p>


<h3>Examples</h3>

<pre><code class="language-R"> x &lt;- 1:4
 integrate.xy(x, exp(x))
 print(exp(4) - exp(1), digits = 10) # the true integral

 for(n in c(10, 20,50,100, 200)) {
   x &lt;- seq(1,4, len = n)
   cat(formatC(n,wid=4), formatC(integrate.xy(x, exp(x)), dig = 9),"\n")
 }
</code></pre>


</div>