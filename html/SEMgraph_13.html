<div class="container">

<table style="width: 100%;"><tr>
<td>graph2dag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert directed graphs to directed acyclic graphs (DAGs)</h2>

<h3>Description</h3>

<p>Remove cycles and bidirected edges from a directed graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph2dag(graph, data, bap = FALSE, time.limit = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A directed graph as an igraph object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix with subjects as rows and variables as
columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bap</code></td>
<td>
<p>If TRUE, a bow-free acyclic path (BAP) is returned
(default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.limit</code></td>
<td>
<p>CPU time for the computation, in seconds
(default = Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The conversion is performed firstly by removing bidirected
edges and then the data matrix is used to compute edge P-values, through
marginal correlation testing (see <code>weightGraph</code>,
r-to-z method). When a cycle is detected, the edge with highest
P-value is removed, breaking the cycle. If the bap argument is TRUE,
a BAP is generated merging the output DAG and the bidirected edges
from the input graph.
</p>


<h3>Value</h3>

<p>A DAG as an igraph object.
</p>


<h3>Author(s)</h3>

<p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
dag &lt;- graph2dag(graph = sachs$graph, data = log(sachs$pkc))
old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,2), mar=rep(1, 4))
gplot(sachs$graph, main = "Input graph")
gplot(dag, main = "Output DAG")
par(old.par)

</code></pre>


</div>