<div class="container">

<table style="width: 100%;"><tr>
<td>sim.bdh.taxa.gsa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a Phylogenetic Network to a Specified Number of Taxa</h2>

<h3>Description</h3>

<p>Simulates a Phylogenetic Network under a birth-death-hybridization model. Simulates to a specified number of extant tips under the General Sampling Approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bdh.taxa.gsa(
  m,
  n,
  numbsim,
  lambda,
  mu,
  nu,
  hybprops,
  hyb.inher.fxn,
  frac = 1,
  twolineages = FALSE,
  complete = TRUE,
  stochsampling = FALSE,
  hyb.rate.fxn = NULL,
  trait.model = NULL,
  mrca = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of taxa to simulate under the SSA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbsim</code></td>
<td>
<p>Number of networks to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Speciation rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Extinction rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Hybridization rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hybprops</code></td>
<td>
<p>Vector that represents the proportion of Hybridizations that are lineage generative, lineage degenerative, and lineage neutral respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyb.inher.fxn</code></td>
<td>
<p>A function for drawing the hybrid inheritance probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Sampling fraction: The proportion of extant tips included in the phylogeny (incomplete sampling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twolineages</code></td>
<td>
<p>If <code>twolineages=TRUE</code>: The process originates with two lineages that share a common ancestor. If <code>twolineages=FALSE</code>: The process originates with two lineages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>If complete = TRUE, the tree with the extinct lineages is returned. If complete = FALSE, the extinct lineages are suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stochsampling</code></td>
<td>
<p>When <code>stochsampling=TRUE</code>: Each extant tip is included into the final tree with probability frac.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyb.rate.fxn</code></td>
<td>
<p>The probability of a successful hybridization as a function of genetic distance between taxa. The default value of 'NULLâ€œ assumes that hybridization success is independent of genetic distance between taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.model</code></td>
<td>
<p>A list that dictates how a trait affects the hybridization process. The default value of <code>NULL</code> doesn't take a trait into account for simulation. See Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mrca</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use the <code>twolineages</code> argument</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hyb.inher.fxn</code> should return values between 0 and 1 and shouldn't require any arguments. E.g. make.beta.draw and make.uniform.draw create functions that fit these specifications
</p>
<p><code>hyb.rate.fxn</code> should take one argument for the genetic distance. The function should be defined on the range <code class="reqn">[0,Inf)</code> and return values between <code class="reqn">[0,1]</code>
</p>
<p><code>trait.model</code> is a list with the following named elements:
</p>

<ul>
<li>
<p><code>initial</code> The initial trait state on the phylogeny
</p>
</li>
<li>
<p><code>hyb.event.fxn</code> A function that denotes the trait of a hybrid child after a hybridization event. The function should have the arguments <code>parent_states</code> and <code>inheritance</code>. <code>parent_states</code> is vector with the ploidy states of the hybrid parents while <code>inheritance</code> is the inheritance probability of the first lineage denoted in <code>parent_states</code>.
</p>
</li>
<li>
<p><code>hyb.compatibility.fxn</code> A function that describes when hybridization events can occur between two taxa based on their traits. The function should have the argument <code>parent_states</code>, a vector with the trait states of the two parents to the hybrid child. The function should return <code>TRUE</code> for when a hybridization event is allowed to proceed and <code>FALSE</code> otherwise.
</p>
</li>
<li>
<p><code>time.fxn</code> A function that describes how traits change over time. The function should have the arguments <code>trait_states</code> and <code>timestep</code> in that order. <code>trait_states</code> is a vector containing the ploidy of all taxa while <code>timestep</code> is the amount of time given for trait evolution. The function should return a vector with the updated ploidy states of all taxa.
</p>
</li>
<li>
<p><code>spec.fxn</code> A function that describes how the trait changes at speciation events.The function should have the argument <code>tip_state</code> which has the state of the lineage just before speciation. The function should return a vector with two values, one denoting the trait of each of the two new species after the event.
</p>
</li>
</ul>
<h3>Value</h3>

<p>out Returns a list of numbsim networks with the time since origin / most recent common ancestor being 'age.' If tree goes extinct or no tips are sampled, return value is '0'. If only one extant and no extinct tips are sampled, return value is '1'. Each network has an additional attribute "inheritance" that represents the inheritance probabilities on the edges in the "reticulation" attribute.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##smallest Quartan prime as seed for reproducibility
set.seed(17)
##Generate a tree with extinct leaves
net&lt;-sim.bdh.taxa.gsa(m=21,n=5,1,3,2,0.5,c(1/3,1/3,1/3),
hyb.inher.fxn = make.uniform.draw(),complete=TRUE)[[1]]
</code></pre>


</div>