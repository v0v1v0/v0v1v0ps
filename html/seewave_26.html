<div class="container">

<table style="width: 100%;"><tr>
<td>covspectro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance between two spectrograms</h2>

<h3>Description</h3>

<p>This function tests the similarity between two spectrograms by returning
their maximal covariance and the time shift related to it. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">covspectro(wave1, wave2, f, channel = c(1,1), wl = 512, wn = "hanning", n,
plot = TRUE, plotval = TRUE,
method = "spearman", col = "black", colval = "red", cexval = 1,
fontval = 1, xlab = "Time (s)",
ylab = "Normalised covariance (cov)", type = "l", pb = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave1</code></td>
<td>
<p>a first R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave2</code></td>
<td>
<p>a second R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R objects, by default left channel (1)
for each object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis
(even number of points, by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default <code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of covariances computed between <code>wave1</code> and <code>wave2</code>
when sliding <code>wave2</code> along <code>wave1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots r values against frequency shift
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotval</code></td>
<td>
<p>logical, if <code>TRUE</code> adds to the plot maximum R value
and frequency offset (by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which correlation coefficient is
to be computed ("pearson", "spearman", or "kendall")
(see <code>cor</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of r values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colval</code></td>
<td>
<p>colour of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexval</code></td>
<td>
<p>character size of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontval</code></td>
<td>
<p>font of r max and frequency offset values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the r axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>plot</code> is <code>TRUE</code>, type of plot that should be drawn.
See <code>plot</code> for details (by default "l" for lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>if <code>TRUE</code> returns a text progress bar in the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Successive covariances between the spectrogram of <code>wave1</code> and
the spectrogram of <code>wave2</code> are computed when regularly sliding
forward and backward <code>wave2</code> along <code>wave1</code>.<br>
The maximal covariance is obtained at a particular shift (time offset). 
This shift may be positive or negative.<br><code>n</code> sets in how many steps <code>wave2</code> will be slided along <code>wave1</code>.
Time process can be then decreased by setting low <code>n</code> value.<br>
Inverting <code>wave1</code> and <code>wave2</code> may give slight different results.
</p>


<h3>Value</h3>

<p>If <code>plot</code> is <code>FALSE</code>, <code>covspectro</code> returns a list containing
three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>the successive covariance values between <code>wave1</code> and <code>wave2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmax</code></td>
<td>
<p>the maximum covariance between <code>wave1</code> and <code>wave2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the time offset corresponding to <code>cov</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>References</h3>

<p>Hopp, S. L., Owren, M. J. and Evans, C. S. (Eds) 1998. <em>Animal acoustic 
communication</em>. Springer, Berlin, Heidelberg.</p>


<h3>See Also</h3>

<p><code>corspec</code>, <code>corenv</code>, <code>spectro</code>,
<code>cor</code>,</p>


<h3>Examples</h3>

<pre><code class="language-R"># covariance between two notes of a birdsong
## Not run: 
data(tico)
note1&lt;-cutw(tico, f=22050, from=0.5, to=0.9)
note2&lt;-cutw(tico, f=22050, from=0.9, to=1.3)
covspectro(note1,note2,f=22050,n=37)

## End(Not run)
</code></pre>


</div>