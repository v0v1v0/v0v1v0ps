<div class="container">

<table style="width: 100%;"><tr>
<td>santaR_pvalue_fit_within</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate difference between a group mean curve and a constant model using the comparison of model fit (F-test)</h2>

<h3>Description</h3>

<p>Execute a t-test based on the comparison of improvement of model fit from a single group mean curve to the fit of both a group mean curve and a constant linear model. This statistic identifies within-class differential evolution, and test whether the population average time curve is flat or not. <em>n</em> constant linear model are generated to match the <em>n</em> individual trajetories. The <em>Null</em> distribution is generated by permuting the <em>n</em> group individuals and the <em>n</em> constant trajectories. The real improvement in model fit for the real group membership versus flat trajectories is then compared to the <em>Null</em> distribution of model fit improvement, similarly to <code>santaR_pvalue_fit</code>. Adapted from <cite>Storey and al. 'Significance analysis of time course microarray experiments', PNAS, 2005 [1]</cite>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">santaR_pvalue_fit_within(SANTAGroup, nPerm = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SANTAGroup</code></td>
<td>
<p>A fitted group extracted from a <em>SANTAObj</em> generated by <code>santaR_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPerm</code></td>
<td>
<p>(int) Number of permutations. Default 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <em>p-value</em>
</p>


<h3>References</h3>

<p>[1] Storey, J. D., Xiao, W., Leek, J. T., Tompkins, R. G. &amp; Davis, R. W. Significance analysis of time course microarray experiments. <em>Proceedings of the National Academy of Sciences of the United States of America</em> <strong>102</strong>, 12837-42 (2005).
</p>


<h3>See Also</h3>

<p>Inter-group comparison with <code>santaR_pvalue_fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 56 measurements, 8 subjects, 7 unique time-points
## Default parameter values decreased to ensure an execution &lt; 2 seconds
Yi          &lt;- acuteInflammation$data$var_3
ind         &lt;- acuteInflammation$meta$ind
time        &lt;- acuteInflammation$meta$time
group       &lt;- acuteInflammation$meta$group
grouping    &lt;- get_grouping(ind, group)
inputMatrix &lt;- get_ind_time_matrix(Yi, ind, time)
SANTAObj    &lt;- santaR_fit(inputMatrix, df=5, grouping=grouping, verbose=TRUE)
SANTAGroup  &lt;- SANTAObj$groups[[1]]
#SANTAGroup &lt;- SANTAObj$groups$Group1
santaR_pvalue_fit_within(SANTAGroup, nPerm=500)
# ~0.6726747

</code></pre>


</div>