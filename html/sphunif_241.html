<div class="container">

<table style="width: 100%;"><tr>
<td>unif_stat_distr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Null distributions for circular and (hyper)spherical uniformity
statistics</h2>

<h3>Description</h3>

<p>Approximate computation of the null distributions of several
statistics for assessing uniformity on the (hyper)sphere
<code class="reqn">S^{p-1}:=\{{\bf x}\in R^p:||{\bf x}||=1\}</code>, <code class="reqn">p\ge 2</code>. The approximation is done either by
means of the asymptotic distribution or by Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unif_stat_distr(x, type, p, n, approx = "asymp", M = 10000,
  stats_MC = NULL, K_max = 10000, method = "I", Stephens = FALSE,
  CCF09_dirs = NULL, CJ12_beta = 0, CJ12_reg = 3, cov_a = 2 * pi,
  Cressie_t = 1/3, K_Ajne = 500, K_CCF09 = 25, K_Kuiper = 25,
  K_Watson = 25, K_Watson_1976 = 5, Poisson_rho = 0.5, Pycke_q = 0.5,
  Rayleigh_m = 1, Riesz_s = 1, Rothman_t = 1/3, Sobolev_vk2 = c(0, 0,
  1), Softmax_kappa = 1, Stereo_a = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>evaluation points for the null distribution(s). Either a vector of
size <code>nx</code>, if the evaluation points are common for the tests in
<code>type</code>, or a matrix of size <code>c(nx, length(type))</code> with columns
containing the evaluation points for each test. Must not contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of test to be applied. A character vector containing any of
the following types of tests, depending on the dimension <code class="reqn">p</code>:
</p>

<ul>
<li>
<p> Circular data: any of the names available at object
<code>avail_cir_tests</code>.
</p>
</li>
<li>
<p> (Hyper)spherical data: any of the names available at object
<code>avail_sph_tests</code>.
</p>
</li>
</ul>
<p>If <code>type = "all"</code> (default), then <code>type</code> is set as
<code>avail_cir_tests</code> or <code>avail_sph_tests</code>, depending on the value of
<code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer giving the dimension of the ambient space <code class="reqn">R^p</code> that
contains <code class="reqn">S^{p-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size employed for computing the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>type of approximation to the null distribution, either
<code>"asymp"</code> (default) for employing the asymptotic null distribution, if
available, or <code>"MC"</code>, for employing the Monte Carlo approximation of
the exact null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of Monte Carlo replications for approximating the null
distribution when <code>approx = "MC"</code>. Also, number of Monte Carlo samples
for approximating the asymptotic distributions based on weighted sums of chi
squared random variables. Defaults to <code>1e4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats_MC</code></td>
<td>
<p>a data frame of size <code>c(M, length(type))</code>, with column
names containing the character vector <code>type</code>, that results from
extracting <code>$stats_MC</code> from a call to <code>unif_stat_MC</code>. If
provided, the computation of Monte Carlo statistics when <code>approx = "MC"</code>
is skipped. <code>stats_MC</code> is checked internally to see if it is sorted.
Internally computed if <code>NULL</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_max</code></td>
<td>
<p>integer giving the truncation of the series that compute the
asymptotic p-value of a Sobolev test. Defaults to <code>1e4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for approximating the density, distribution, or
quantile function of the weighted sum of chi squared random variables. Must
be <code>"I"</code> (Imhof), <code>"SW"</code> (Satterthwaite–Welch), <code>"HBE"</code>
(Hall–Buckley–Eagleson), or <code>"MC"</code> (Monte Carlo; only for distribution
or quantile functions). Defaults to <code>"I"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Stephens</code></td>
<td>
<p>compute Stephens (1970) modification so that the null
distribution of the is less dependent on the sample size? The modification
does not alter the test decision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CCF09_dirs</code></td>
<td>
<p>a matrix of size <code>c(n_proj, p)</code> containing
<code>n_proj</code> random directions (in Cartesian coordinates) on <code class="reqn">S^{p-1}</code>
to perform the CCF09 test. If <code>NULL</code> (default), a sample of size
<code>n_proj = 50</code> directions is computed internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CJ12_beta</code></td>
<td>
<p><code class="reqn">\beta</code> parameter in the exponential regime of CJ12
test, a positive real.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CJ12_reg</code></td>
<td>
<p>type of asymptotic regime for CJ12 test, either <code>1</code>
(sub-exponential regime), <code>2</code> (exponential), or <code>3</code>
(super-exponential; default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_a</code></td>
<td>
<p><code class="reqn">a_n = a / n</code> parameter used in the length of the arcs
of the coverage-based tests. Must be positive. Defaults to <code>2 * pi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cressie_t</code></td>
<td>
<p><code class="reqn">t</code> parameter for the Cressie test, a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_CCF09</code></td>
<td>
<p>integer giving the truncation of the series present in the
asymptotic distribution of the Kolmogorov-Smirnov statistic. Defaults to
<code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_Kuiper, K_Watson, K_Watson_1976, K_Ajne</code></td>
<td>
<p>integer giving the truncation
of the series present in the null asymptotic distributions. For the
Kolmogorov-Smirnov-related series defaults to <code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Poisson_rho</code></td>
<td>
<p><code class="reqn">\rho</code> parameter for the Poisson test, a real in
<code class="reqn">[0, 1)</code>. Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pycke_q</code></td>
<td>
<p><code class="reqn">q</code> parameter for the Pycke "<code class="reqn">q</code>-test", a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rayleigh_m</code></td>
<td>
<p>integer <code class="reqn">m</code> for the <code class="reqn">m</code>-modal Rayleigh test.
Defaults to <code>m = 1</code> (the standard Rayleigh test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Riesz_s</code></td>
<td>
<p><code class="reqn">s</code> parameter for the <code class="reqn">s</code>-Riesz test, a real in
<code class="reqn">(0, 2)</code>. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rothman_t</code></td>
<td>
<p><code class="reqn">t</code> parameter for the Rothman test, a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sobolev_vk2</code></td>
<td>
<p>weights for the finite Sobolev test. A non-negative
vector or matrix. Defaults to <code>c(0, 0, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Softmax_kappa</code></td>
<td>
<p><code class="reqn">\kappa</code> parameter for the Softmax test, a
non-negative real. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Stereo_a</code></td>
<td>
<p><code class="reqn">a</code> parameter for the Stereo test, a real in
<code class="reqn">[-1, 1]</code>. Defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>if <code>approx = "MC"</code>, optional performance parameters to be
passed to <br><code>unif_stat_MC</code>: <code>chunks</code>, <code>cores</code>,
and <code>seed</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>approx = "asymp"</code>, statistics that do not have an implemented or
known asymptotic are omitted, and a warning is generated.
</p>
<p>For Sobolev tests, <code>K_max = 1e4</code> produces probabilities uniformly
accurate with three digits for the <code>"PCvM"</code>, <code>"PAD"</code>, and
<code>"PRt"</code> tests, for dimensions <code class="reqn">p \le 11</code>. With <code>K_max = 5e4</code>,
these probabilities are uniformly accurate in the fourth digit. With
<code>K_max = 1e3</code>, only two-digit uniform accuracy is obtained. Uniform
accuracy deteriorates when <code class="reqn">p</code> increases, e.g., a digit accuracy is lost
when <code class="reqn">p = 51</code>.
</p>
<p>Descriptions and references on most of the asymptotic distributions
are available in García-Portugués and Verdebout (2018).
</p>


<h3>Value</h3>

<p>A data frame of size <code>c(nx, length(type))</code>, with column names
given by <code>type</code>, that contains the values of the null distributions of
the statistics evaluated at <code>x</code>.
</p>


<h3>References</h3>

<p>García-Portugués, E. and Verdebout, T. (2018) An overview of uniformity
tests on the hypersphere. <em>arXiv:1804.00286</em>.
<a href="https://doi.org/10.48550/arXiv.1804.00286">doi:10.48550/arXiv.1804.00286</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Asymptotic distribution

# Circular statistics
x &lt;- seq(0, 1, l = 5)
unif_stat_distr(x = x, type = "Kuiper", p = 2, n = 10)
unif_stat_distr(x = x, type = c("Ajne", "Kuiper"), p = 2, n = 10)
unif_stat_distr(x = x, type = c("Ajne", "Kuiper"), p = 2, n = 10, K_Ajne = 5)

# All circular statistics
unif_stat_distr(x = x, type = avail_cir_tests, p = 2, n = 10, K_max = 1e3)

# Spherical statistics
unif_stat_distr(x = cbind(x, x + 1), type = c("Rayleigh", "Bingham"),
                p = 3, n = 10)
unif_stat_distr(x = cbind(x, x + 1), type = c("Rayleigh", "Bingham"),
                p = 3, n = 10, M = 100)

# All spherical statistics
unif_stat_distr(x = x, type = avail_sph_tests, p = 3, n = 10, K_max = 1e3)

## Monte Carlo distribution

# Circular statistics
x &lt;- seq(0, 5, l = 10)
unif_stat_distr(x = x, type = avail_cir_tests, p = 2, n = 10, approx = "MC")
unif_stat_distr(x = x, type = "Kuiper", p = 2, n = 10, approx = "MC")
unif_stat_distr(x = x, type = c("Ajne", "Kuiper"), p = 2, n = 10,
                approx = "MC")

# Spherical statistics
unif_stat_distr(x = x, type = avail_sph_tests, p = 3, n = 10,
                approx = "MC")
unif_stat_distr(x = cbind(x, x + 1), type = c("Rayleigh", "Bingham"),
                p = 3, n = 10, approx = "MC")
unif_stat_distr(x = cbind(x, x + 1), type = c("Rayleigh", "Bingham"),
                p = 3, n = 10, approx = "MC")

## Specific arguments

# Rothman
unif_stat_distr(x = x, type = "Rothman", p = 2, n = 10, Rothman_t = 0.5,
                approx = "MC")

# CCF09
dirs &lt;- r_unif_sph(n = 5, p = 3, M = 1)[, , 1]
x &lt;- seq(0, 1, l = 10)
unif_stat_distr(x = x, type = "CCF09", p = 3, n = 10, approx = "MC",
                CCF09_dirs = dirs)
unif_stat_distr(x = x, type = "CCF09", p = 3, n = 10, approx = "MC")

# CJ12
unif_stat_distr(x = x, type = "CJ12", p = 3, n = 100, CJ12_reg = 3)
unif_stat_distr(x = x, type = "CJ12", p = 3, n = 100, CJ12_reg = 2,
               CJ12_beta = 0.01)
unif_stat_distr(x = x, type = "CJ12", p = 3, n = 100, CJ12_reg = 1)

## Sobolev

x &lt;- seq(0, 1, l = 10)
vk2 &lt;- diag(1, nrow = 3)
unif_stat_distr(x = x, type = "Sobolev", approx = "asymp", p = 3, n = 100,
                Sobolev_vk2 = vk2)
sapply(1:3, function(i)
  unif_stat_distr(x = x, type = "Sobolev", approx = "asymp", p = 3, n = 100,
                  Sobolev_vk2 = vk2[i, ])$Sobolev)
sapply(1:3, function(i)
  unif_stat_distr(x = x, type = "Sobolev", approx = "MC", p = 3, n = 100,
                  Sobolev_vk2 = vk2[i, ], M = 1e3)$Sobolev)
unif_stat_distr(x = x, type = "Sobolev", approx = "MC", p = 3, n = 100,
                Sobolev_vk2 = vk2, M = 1e3)

</code></pre>


</div>