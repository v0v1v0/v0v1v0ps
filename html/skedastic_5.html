<div class="container">

<table style="width: 100%;"><tr>
<td>avm.fwls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply Feasible Weighted Least Squares to a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function applies feasible weighted least squares (FWLS) to a
linear regression model using error variance estimates obtained
from an auxiliary linear variance model fit using <code>alvm.fit</code>
or from an auxiliary nonlinear variance model fit using
<code>anlvm.fit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">avm.fwls(object, fastfit = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Either an object of class <code>"alvm.fit"</code> or an object
of class <code>"anlvm.fit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastfit</code></td>
<td>
<p>A logical. If <code>FALSE</code> (the default), the linear
regression model is fit using <code>lm</code>; otherwise,
using <code>lm.wfit</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function simply calculates
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}=(X'\hat{\Omega}^{-1}X)^{-1}X'\hat{\Omega}^{-1}y</code>
</p>
<p>,
where <code class="reqn">X</code> is the design matrix, <code class="reqn">y</code> is the response vector, and
<code class="reqn">\hat{\Omega}</code> is the diagonal variance-covariance matrix of the
random errors, whose diagonal elements have been estimated by an
auxiliary variance model.
</p>


<h3>Value</h3>

<p>Either an object of <code>class</code> <code>"lm"</code>
(if <code>fastfit</code> is <code>FALSE</code>) or otherwise a generic
list object
</p>


<h3>References</h3>

<p>There are no references for Rd macro <code style="white-space: pre;">⁠\insertAllCites⁠</code> on this help page.
</p>


<h3>See Also</h3>

<p><code>alvm.fit</code>, <code>anlvm.fit</code>,
<code>avm.vcov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
myalvm &lt;- alvm.fit(mainlm = mtcars_lm, model = "linear",
   varselect = "qgcv.linear")
myfwls &lt;- avm.fwls(myalvm)
cbind(coef(mtcars_lm), coef(myfwls))

</code></pre>


</div>