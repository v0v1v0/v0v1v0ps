<div class="container">

<table style="width: 100%;"><tr>
<td>sph_stat_Rayleigh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistics for testing (hyper)spherical uniformity</h2>

<h3>Description</h3>

<p>Low-level implementation of several statistics for assessing
uniformity on the (hyper)sphere
<code class="reqn">S^{p-1}:=\{{\bf x}\in R^p:||{\bf x}||=1\}</code>, <code class="reqn">p\ge 2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sph_stat_Rayleigh(X)

sph_stat_Bingham(X)

sph_stat_Ajne(X, Psi_in_X = FALSE)

sph_stat_Gine_Gn(X, Psi_in_X = FALSE, p = 0L)

sph_stat_Gine_Fn(X, Psi_in_X = FALSE, p = 0L)

sph_stat_Pycke(X, Psi_in_X = FALSE, p = 0L)

sph_stat_Bakshaev(X, Psi_in_X = FALSE, p = 0L)

sph_stat_Riesz(X, Psi_in_X = FALSE, p = 0L, s = 1)

sph_stat_PCvM(X, Psi_in_X = FALSE, p = 0L, N = 160L, L = 1000L)

sph_stat_PRt(X, Psi_in_X = FALSE, p = 0L, t = 1/3, N = 160L,
  L = 1000L)

sph_stat_PAD(X, Psi_in_X = FALSE, p = 0L, N = 160L, L = 1000L)

sph_stat_Poisson(X, Psi_in_X = FALSE, p = 0L, rho = 0.5)

sph_stat_Softmax(X, Psi_in_X = FALSE, p = 0L, kappa = 1)

sph_stat_Stereo(X, Psi_in_X = FALSE, p = 0L, a = 0)

sph_stat_CCF09(X, dirs, K_CCF09 = 25L, original = FALSE)

sph_stat_Rayleigh_HD(X)

sph_stat_CJ12(X, Psi_in_X = FALSE, p = 0L, regime = 3L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <b>array</b> of size <code>c(n, p, M)</code> containing the Cartesian
coordinates of <code>M</code> samples of size <code>n</code> of directions on
<code class="reqn">S^{p-1}</code>. Must not contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi_in_X</code></td>
<td>
<p>does <code>X</code> contain the shortest angles matrix
<code class="reqn">\boldsymbol\Psi</code> that is obtained with <code>Psi_mat(X)</code>?
If <code>FALSE</code> (default), <code class="reqn">\boldsymbol\Psi</code> is computed
internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer giving the dimension of the ambient space <code class="reqn">R^p</code> that
contains <code class="reqn">S^{p-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p><code class="reqn">s</code> parameter for the <code class="reqn">s</code>-Riesz test, a real in
<code class="reqn">(0, 2)</code>. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of points used in the
Gauss-Legendre quadrature. Defaults to
<code>160</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of discretization points to interpolate angular functions
that require evaluating an integral. Defaults to <code>1e3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p><code class="reqn">t</code> parameter for the Rothman and Cressie tests, a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p><code class="reqn">\rho</code> parameter for the Poisson test, a real in
<code class="reqn">[0, 1)</code>. Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p><code class="reqn">\kappa</code> parameter for the Softmax test, a
non-negative real. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>either: </p>

<ul>
<li> <p><code class="reqn">a_n = a / n</code> parameter used in the length of the arcs
of the coverage-based tests. Must be positive. Defaults to <code>2 * pi</code>.
</p>
</li>
<li> <p><code class="reqn">a</code> parameter for the Stereo test, a real in <code class="reqn">[-1, 1]</code>.
Defaults to <code>0</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirs</code></td>
<td>
<p>a matrix of size <code>c(n_proj, p)</code> containing <code>n_proj</code>
random directions (in Cartesian coordinates) on <code class="reqn">S^{p-1}</code> to perform
the CCF09 test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_CCF09</code></td>
<td>
<p>integer giving the truncation of the series present in the
asymptotic distribution of the Kolmogorov-Smirnov statistic. Defaults to
<code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original</code></td>
<td>
<p>return the CCF09 statistic as originally defined?
If <code>FALSE</code> (default), a faster and equivalent statistic is computed,
and rejection happens for <em>large</em> values of the statistic, which is
consistent with the rest of tests. Otherwise, rejection happens for
<em>low</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regime</code></td>
<td>
<p>type of asymptotic regime for the CJ12 test, either <code>1</code>
(sub-exponential regime), <code>2</code> (exponential), or <code>3</code>
(super-exponential; default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Detailed descriptions and references of the statistics are available
in García-Portugués and Verdebout (2018).
</p>
<p>The Pycke and CJ12 statistics employ the <em>scalar products</em> matrix,
rather than the shortest angles matrix, when <code>Psi_in_X = TRUE</code>. This
matrix is obtained by setting <code>scalar_prod = TRUE</code> in
<code>Psi_mat</code>.
</p>


<h3>Value</h3>

<p>A matrix of size <code>c(M, 1)</code> containing the statistics for each
of the <code>M</code> samples.
</p>


<h3>Warning</h3>

<p>Be careful on avoiding the next bad usages of the functions, which will
produce spurious results:
</p>

<ul>
<li>
<p> The directions in <code>X</code> do <em>not</em> have unit norm.
</p>
</li>
<li> <p><code>X</code> does <em>not</em> contain <code>Psi_mat(X)</code> when
<code>X_in_Theta = TRUE</code>.
</p>
</li>
<li>
<p> The parameter <code>p</code> does <em>not</em> match with the dimension of
<code class="reqn">R^p</code>.
</p>
</li>
<li> <p><em>Not</em> passing the scalar products matrix to <code>sph_stat_CJ12</code>
when <code>Psi_in_X = TRUE</code>.
</p>
</li>
<li>
<p> The directions in <code>dirs</code> do <em>not</em> have unit norm.
</p>
</li>
</ul>
<h3>References</h3>

<p>García-Portugués, E. and Verdebout, T. (2018) An overview of uniformity
tests on the hypersphere. <em>arXiv:1804.00286</em>.
<a href="https://doi.org/10.48550/arXiv.1804.00286">doi:10.48550/arXiv.1804.00286</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sample uniform spherical data

M &lt;- 2
n &lt;- 100
p &lt;- 3
set.seed(123456789)
X &lt;- r_unif_sph(n = n, p = p, M = M)

## Sobolev tests

# Rayleigh
sph_stat_Rayleigh(X)

# Bingham
sph_stat_Bingham(X)

# Ajne
Psi &lt;- Psi_mat(X)
dim(Psi) &lt;- c(dim(Psi), 1)
sph_stat_Ajne(X)
sph_stat_Ajne(Psi, Psi_in_X = TRUE)

# Gine Gn
sph_stat_Gine_Gn(X)
sph_stat_Gine_Gn(Psi, Psi_in_X = TRUE, p = p)

# Gine Fn
sph_stat_Gine_Fn(X)
sph_stat_Gine_Fn(Psi, Psi_in_X = TRUE, p = p)

# Pycke
sph_stat_Pycke(X)
sph_stat_Pycke(Psi, Psi_in_X = TRUE, p = p)

# Bakshaev
sph_stat_Bakshaev(X)
sph_stat_Bakshaev(Psi, Psi_in_X = TRUE, p = p)

# Riesz
sph_stat_Riesz(X, s = 1)
sph_stat_Riesz(Psi, Psi_in_X = TRUE, p = p, s = 1)

# Projected Cramér-von Mises
sph_stat_PCvM(X)
sph_stat_PCvM(Psi, Psi_in_X = TRUE, p = p)

# Projected Rothman
sph_stat_PRt(X)
sph_stat_PRt(Psi, Psi_in_X = TRUE, p = p)

# Projected Anderson-Darling
sph_stat_PAD(X)
sph_stat_PAD(Psi, Psi_in_X = TRUE, p = p)

## Other tests

# CCF09
dirs &lt;- r_unif_sph(n = 3, p = p, M = 1)[, , 1]
sph_stat_CCF09(X, dirs = dirs)

## High-dimensional tests

# Rayleigh HD-Standardized
sph_stat_Rayleigh_HD(X)

# CJ12
sph_stat_CJ12(X, regime = 1)
sph_stat_CJ12(Psi, regime = 1, Psi_in_X = TRUE, p = p)
sph_stat_CJ12(X, regime = 2)
sph_stat_CJ12(Psi, regime = 2, Psi_in_X = TRUE, p = p)
sph_stat_CJ12(X, regime = 3)
sph_stat_CJ12(Psi, regime = 3, Psi_in_X = TRUE, p = p)
</code></pre>


</div>