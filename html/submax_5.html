<div class="container">

<table style="width: 100%;"><tr>
<td>mscorev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes M-scores for Permuational M-tests.
</h2>

<h3>Description</h3>

<p>Of limited interest to most users, function mscorev() computes M-scores.
A similar function function is in the package sensitivitymv.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mscorev(ymat, inner = 0, trim = 3, lambda = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ymat</code></td>
<td>

<p>If there are I matched sets and the largest matched set contains J individuals,
then y is an I by J matrix with one row for each matched set.  If matched
set i contains one treated individual and k controls, where k is at least 1 and
at most J-1, then y[i,1] is the treated individual's response, y[i,2],...,y[i,k+1]
are the responses of the k controls, and y[i,k+2],...,y[i,J] are equal to NA.
</p>
<p>Although y can contain NA's, y[i,1] and y[i,2] must not be NA for every i.  That
is, every matched set must have at least one treated subject and one control.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner</code></td>
<td>

<p>inner and trim together define the <code class="reqn">\psi</code>-function for the M-statistic.
The default values yield a version of Huber's <code class="reqn">\psi</code>-function, while
setting inner = 0 and trim = Inf uses the mean within each matched set.
The <code class="reqn">\psi</code>-function is an odd function, so <code class="reqn">\psi(w) = -\psi(-w)</code>.  For
<code class="reqn">w \ge 0</code>, the <code class="reqn">\psi</code>-function is <code class="reqn">\psi(w)=0</code> for <code class="reqn">0 \le w \le </code> inner,
is <code class="reqn">\psi(w)= </code> trim for <code class="reqn">w \ge </code> trim, and rises linearly from 0 to trim
for inner &lt; w &lt; trim.
</p>
<p>If uncertain about inner, trim and lambda, then use the defaults.
</p>
<p>An error will result unless <code class="reqn">0 \le </code> inner <code class="reqn"> \le </code> trim.
</p>
<p>Taking trim &lt; Inf limits the influence of outliers; see Huber (1981).
Taking trim &lt; Inf and inner = 0 uses Huber's psi function.
Taking trim = Inf does no trimming and is similar to a weighted mean; see TonT.
Taking inner &gt; 0 often increases design sensitivity; see Rosenbaum (2013).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>

<p>inner and trim together define the <code class="reqn">\psi</code>-function for the M-statistic.
See inner.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Before applying the <code class="reqn">\psi</code>-function to treated-minus-control differences,
the differences are scaled by dividing by the lambda quantile of all
within set absolute differences.  Typically, lambda = 1/2 for the median.
The value of lambda has no effect if trim=Inf and inner=0.  See Maritz (1979)
for the paired case and Rosenbaum (2007) for matched sets.
</p>
<p>An error will result unless 0 &lt; lambda &lt; 1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Generally, a matrix with the same dimensions as ymat containing the M-scores.
</p>


<h3>Note</h3>

<p>The example reproduces Table 3 in Rosenbaum (2007).
</p>
<p>Matched sets of unequal size are weighted using weights that would
be efficient in a randomization test under a simple model with
additive set and treatment effects and errors with constant variance;
see Rosenbaum (2007).  Specifically, the total score in set (row) i is
divided by the number ni of individuals in row i,
as in expression (8) in Rosenbaum (2007).
</p>


<h3>Author(s)</h3>

<p>Paul R. Rosenbaum
</p>


<h3>References</h3>

<p>Huber, P. (1981) Robust Statistics.  New York: John Wiley.
(M-estimates based on M-statistics.)
</p>
<p>Maritz, J. S. (1979). A note on exact robust confidence
intervals for location. Biometrika 66 163â€“166. (Introduces
exact permutation tests based on M-statistics by redefining
the scaling parameter.)
</p>
<p>Rosenbaum, P. R. (2007) Sensitivity analysis for m-estimates,
tests and confidence intervals in matched observational studies.
Biometrics, 2007, 63, 456-464.  &lt;doi:10.1111/j.1541-0420.2006.00717.x&gt;
</p>
<p>Rosenbaum, P. R. (2013). Impact of multiple matched controls on
design sensitivity in observational studies. Biometrics 69 118-127.
(Introduces inner trimming.) &lt;doi:10.1111/j.1541-0420.2012.01821.x&gt;
</p>
<p>Rosenbaum, P. R. (2015).  Two R packages for sensitivity analysis
in observational studies.  Observational Studies, v. 1. (Free on-line.)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The example reproduces Table 3 in Rosenbaum (2007).
data(tbmetaphase)
mscorev(tbmetaphase,trim=1)
</code></pre>


</div>