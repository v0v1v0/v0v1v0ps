<div class="container">

<table style="width: 100%;"><tr>
<td>threeDspectro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>3D spectrogram plots from <code>"Wave"</code> objects</h2>

<h3>Description</h3>

<p>Create 3D spectrograms from a single object of class <code>"Wave"</code>.
</p>
<p>This function works similarly as <code>spectro</code> (<code>seewave</code> package), with spectrogram data internally computed by <code>spectro</code>. However, the 3D plot is generated by <code>persp3D</code> (<code>plot3D</code> package).
</p>


<h3>Usage</h3>

<pre><code class="language-R">threeDspectro(
  wave,
  tlim = NULL,
  flim = NULL,
  samp.grid = FALSE,
  plot.type = "surface",
  along = "x",
  skip.lines = 5,
  space.lines = 0.6,
  x.length = 100,
  y.length = 70,
  lwd = 0.1,
  plot.exp = FALSE,
  log.scale = FALSE,
  cex = 0.5,
  cex.axis = 0.5,
  cex.lab = 0.9,
  cex.main = 1,
  store.at = NULL,
  plot.as = "jpeg",
  color = seewave::spectro.colors(80),
  f = 44100,
  wl = 512,
  ovlp = 70,
  dBlevel = 30,
  resfac = 1,
  rotate.Xaxis = 60,
  rotate.Yaxis = 40,
  main = "Spectrogram 3D",
  scalelab = expression("Amplitude (dB)"),
  colkey = list(plot = TRUE, cex.clab = 0.8, cex.axis = 1, side = 4, length = 1, width =
    1, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an <code>R</code> object of the class <code>"Wave"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>modifications of the time limits (X-axis). Vector with two values in seconds. By default: <code>tlim = NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis). Vector with two values in kHz. By default: <code>flim = NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp.grid</code></td>
<td>
<p>a logical. If <code>TRUE</code>, a sampling grid with dimensions <code>x.length</code> and <code>y.length</code> is applied over the three-dimensional surface. An amplitude value is collected at each node in the grid and a new matrix of amplitude coordinates is used in the plot. Recommended for faster plots and as protocol for error verification in point acquisition. See also <code>plot.type</code>. By default: <code>samp.grid = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>allows the choice between <code>"lines"</code>, <code>"surface"</code> or <code>"points"</code>. Beware that <code>"points"</code> only applies when <code>samp.grid = TRUE</code>. <code>plot.type = "surface"</code> will produce a simplified 3D spectrogram surface using the amplitude values colected by the sampling grid (same output employed by MacLeod et al., 2013). <code>plot.type = "points"</code> will produce 3D graphs with semilandmarks as points. <code>plot.type = "lines"</code> will generate profile lines along X or Y-axis (see argument <code>along</code>). Number and space between lines are controled by arguments <code>skip.lines</code> and <code>space.lines</code>, respectively. By default: <code>plot.type = "surface"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>along</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. Lines along X or Y-axis (<code>"x"</code> or <code>"y"</code>). By default: <code>along = "x"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip.lines</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. How many lines to skip between each plotted line. Larger numbers imply on less lines plotted. By default: <code>skip.lines = 5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space.lines</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. Controls the space between lines, which makes lines wider or narrower. Has to be a number between 0.1 and 0.9. By default: <code>space.lines = 0.6</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.length</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the time (X-axis).  By default: <code>x.length = 100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.length</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the frequency (Y-axis). By default: <code>y.length = 70</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code> and <code>plot.type = "surface"</code>. Similarly as in <code>par</code>, intended line width for sampling grid. By default: <code>lwd = 0.1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.exp</code></td>
<td>
<p>a logical. If <code>TRUE</code>, 3D spectrogram plot from <code>wave</code> object is exported and stored on the folder indicated by <code>store.at</code>. By default: <code>plot.exp = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.scale</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. A logical. If <code>TRUE</code>, <code>threeDspectro</code> will use a logarithmic scale on the time (X-axis), which is recommeded when the analyzed sounds present great variation on this axis (e.g. emphasize short duration sounds). If <code>FALSE</code>, a linear scale is used instead (same as MacLeod et al., 2013). By default: <code>log.scale = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code> and <code>plot.type = "points"</code>. Similarly as in <code>par</code>, intended size for points. By default: <code>cex = 0.5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Similarly as in <code>par</code>, the magnification to be used for axis annotation. By default: <code>cex.axis = 0.5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>Similarly as in <code>par</code>, the magnification to be used for x and y labels. By default: <code>cex.lab = 0.9</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>Similarly as in <code>par</code>, the magnification to be used for main titles. By default: <code>cex.main = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store.at</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. Filepath to the folder where 3D plot will be stored. Should be presented between quotation marks. By default: <code>store.at = NULL</code> (i.e. user must specify the filepath where spectrogram plots will be stored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.as</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. <code>plot.as = "jpeg"</code> will generate compressed images for quick inspection; <code>plot.as = "tiff"</code> or <code>"tif"</code> will generate uncompressed high resolution images that can be edited and used for publication. By default: <code>plot.as = "jpeg"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Color palette to be used for the amplitude (Z-axis). Same default as <code>spectro</code>: <code>color=spectro.colors(80)</code>. See also <code>Details</code> section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>Wave</code> object (in Hz). By default: <code>f = 44100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for spectrogram calculation. By default: <code>wl = 512</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. By default: <code>ovlp = 70</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dBlevel</code></td>
<td>
<p>absolute amplitude value to be used as relative background on 3D plot. Same as <code>dBlevel</code> from <code>eigensound</code> and <code>align.wave</code>. By default: <code>dBlevel = 30</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resfac</code></td>
<td>
<p>resolution factor, in which an value &gt; 1 will increase the resolution. Can be one value or a vector of two numbers, for the x and y values, respectively. <strong>Note:</strong> Same as in <code>persp3D</code> (<code>plot3D</code> package). By default: <code>resfac = 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate.Xaxis</code></td>
<td>
<p>rotation of the X-axis. Same as <code>theta</code> from <code>persp3D</code> (<code>plot3D</code> package). By default: <code>rotate.Xaxis = 60</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate.Yaxis</code></td>
<td>
<p>rotation of the Y-axis. Same as <code>phi</code> from <code>persp3D</code> (<code>plot3D</code> package). By default: <code>rotate.Yaxis = 40</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title of output plot. Should be presented between quotation marks. By default: <code>main = "3D spectrogram"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalelab</code></td>
<td>
<p>Similarly as <code>plot3D</code>, the label to be written on top of the color key. Should be a character string wrapped by <code>expression()</code>. By default: <code>scalelab = expression("Amplitude (dB)")</code>. See also <code>colkey</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colkey</code></td>
<td>
<p>Similarly as <code>plot3D</code>, a list with parameters for the color key (legend). By default: <code>colkey = list(plot = TRUE, cex.clab = 0.8, cex.axis = 1, side = 4, length = 1, width = 1, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)</code>. See also <code>colkey</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Similarly as <code>spectro</code> (<code>seewave</code> package), any colour palette can be used to describe the amplitude (Z-axis). Some suggestions: <code>seewave::temp.colors, seewave::spectro.colors, seewave::reverse.heat.colors, seewave::reverse.cm.colors, seewave::reverse.topo.colors, grDevices::cm.colors, grDevices::grey.colors, grDevices::heat.colors, grDevices::topo.colors</code>.
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code>spectro</code>, <code>seewave</code>, <code>eigensound</code>, <code>align.wave</code>, <code>persp3D</code>, <code>plot3D</code>, <code>align.wave</code>
</p>
<p>Useful links:
</p>

<ul>
<li>
<p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li>
<p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">

# As simple as this
threeDspectro(centralis)
threeDspectro(cuvieri)
threeDspectro(kroyeri)

# Controling some arguments
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), dBlevel=50)

# As points
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              samp.grid=TRUE, plot.type="points")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              samp.grid=TRUE, plot.type="points", x.length = 20, y.length = 50)

# As lines
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), plot.type = "lines")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              plot.type = "lines", along="y")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              plot.type = "lines", along="y", skip.lines=18, space.lines=0.8)

# Try different colors
threeDspectro(cuvieri, color=seewave::reverse.terrain.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, color=seewave::reverse.cm.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, color=grDevices::heat.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))

# Rotation
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), rotate.Xaxis=40, rotate.Yaxis=50)

# Export your graph
threeDspectro(cuvieri, plot.exp=TRUE, store.at=tempdir(), tlim=c(0,0.5), flim=c(0,4))


</code></pre>


</div>