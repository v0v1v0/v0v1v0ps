<div class="container">

<table style="width: 100%;"><tr>
<td>sandwich2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Time Series with Negative Binomial Distribution and Autoregressive Correlation Structure of Order One: NB-INAR(1)</h2>

<h3>Description</h3>

<p><code>rnbinom.inar1</code> generates one or more independent time series following the NB-INAR(1) model. The generated data has negative binomial marginal distribution and an autoregressive covariance structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sandwich2(sigma, rho, theta, k, Time, dropout, Model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>assymptotic standard deviation for Full and subpupulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>correlation coefficient of the underlying autoregressive correlation structure. Must be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>correlation absorption coefficient if tinepoints are farther appart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>vector of measured timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropout</code></td>
<td>
<p>vector describing the percentage of dropout in every timepoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>either 1 or 2, describing if 4-regressor or 3-regressor model was used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generated marginal negative binomial distribution with mean <code>mu</code> = <code class="reqn">\mu</code> and <code>size</code> = <code class="reqn">\eta</code> has density
</p>
<p style="text-align: center;"><code class="reqn">(\mu/(\mu+\eta))^x \Gamma(x + \eta)/(\Gamma(x+1)\Gamma(\eta)) (\eta/(\mu+\eta))^\eta</code>
</p>

<p>for <code class="reqn">0 &lt; \mu</code>, <code class="reqn">0 &lt; \eta</code> and <code class="reqn">x=0, 1, 2, ...</code>.
</p>
<p>Within the NB-INAR(1) model, the correlation between two time points <code class="reqn">t</code> and <code class="reqn">s</code> for <code>rho</code> = <code class="reqn">\rho</code> is given through
</p>
<p style="text-align: center;"><code class="reqn">\rho^|t-s|</code>
</p>

<p>for <code class="reqn">0 \le \rho \le 1</code>.
</p>


<h3>Value</h3>

<p><code>rnbinom.inar1</code> returns a matrix of dimension <code>n</code> x <code>tp</code> with marginal negative binomial
distribution with mean <code>mu</code> and dispersion parameter <code>size</code>, and an autoregressive correlation structure
between time points.
</p>


<h3>Source</h3>

<p><code>rnbinom.inar1</code> computes a reparametrization of the NB-INAR(1) model by <em>McKenzie 1986</em> using code contributed by Thomas Asendorf.
</p>


<h3>References</h3>

<p>McKenzie Ed (1986), Autoregressive Moving-Average Processes with Negative-Binomial and Geometric Marginal Distributions. <em>Advances in Applied Probability</em> Vol. 18, No. 3, pp. 679-705.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(8)
random&lt;-rnbinom.inar1(n=1000, size=0.6, mu=2, rho=0.8, tp=6)
cor(random)

#Check the marginal distribution of time point 3
plot(table(random[,3])/1000, xlab="Probability", ylab="Observation")
lines(0:26, dnbinom(0:26, mu=2, size=0.6), col="red")
legend("topright",legend=c("Theoretical Marginal Distribution", "Observed Distribution"), 
col=c("red", "black"), lty=1, lwd=c(1,2))

</code></pre>


</div>