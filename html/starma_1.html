<div class="container">

<table style="width: 100%;"><tr>
<td>starma-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Space Time AutoRegressive Moving Average (STARMA) modelling for space-time series
</h2>

<h3>Description</h3>

<p>This package aims to provide all the tools needed to identify, estimate and diagnose STARMA models for space-time series. 
It follows the three-stage iterative model building procedure developed by (Box and Jenkins, 1970) and extended to space-time modelling by (Pfeifer and Deutsch, 1980).
Designed with large datasets in mind, the package has been optimized by integrating C++ code via Rcpp and RcppArmadillo (Eddelbuettel and Sanderson, 2014).
Furthermore, the parameter estimation, which is usually computationally very expensive when using common optimization routines, uses a Kalman filter (see Cipra and Motykova, 1987), making it extremely efficient when dealing with large datasets.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> starma</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2015-11-12</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The three stages of the iterative model building procedure are as follow, after centering the space-time series with <code>stcenter</code>:
</p>
<p>- Identification: Using <code>stacf</code> and <code>stpacf</code>, the user should try to identify which parameters should be estimated. 
</p>
<p>- Estimation: Use <code>starma</code> to estimate the parameters. 
</p>
<p>- Diagnostic: Use <code>stacf</code>, <code>stpacf</code> and <code>stcor.test</code> to check whether the residuals of the models are similar to white noise. 
</p>
<p>Refer to (Box and Jenkins, 1970) for details over the three-stage iterative model building procedure.
</p>


<h3>Author(s)</h3>

<p>Felix Cheysson
</p>
<p>Maintainer: Felix Cheysson &lt;felix@cheysson.fr&gt;
</p>


<h3>References</h3>

<p>- Box, G. E. P., &amp; Jenkins, G. M. (1970). Time Series Analysis: Forecasting and Control. Holden Day.
</p>
<p>- Pfeifer, P., &amp; Deutsch, S. (1980). A Three-Stage Iterative Procedure for Space-Time Modeling. Technometrics, 22(1), 35-47. doi:10.1080/00401706.1980.10486099
</p>
<p>- Pfeifer, P., &amp; Deutsch, S. (1981). Variance of the Sample Space-Time Autocorrelation Function. Journal of the Royal Statistical Society. Series B (Methodological), 43(1): 28-33.
</p>
<p>- Cipra, T., &amp; Motykova, I. (1987). Study on Kalman filter in time series analysis. Commentationes Mathematicae Universitatis Carolinae, 28(3).
</p>
<p>- Dirk Eddelbuettel, Conrad Sanderson (2014). RcppArmadillo: Accelerating R with high-performance C++ linear algebra. Computational Statistics and Data Analysis, Volume 71, March 2014, pages 1054-1063. URL http://dx.doi.org/10.1016/j.csda.2013.02.005
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load spdep library to easily create weight matrices
library(spdep)

# Create a 5x5 regular grid which will be our lattice
sites &lt;- matrix(0, 25, 2)
for (i in 1:5) {
	for (j in 1:5)
		sites[(i-1)*5 + j, ] &lt;- c(i, j) - .5
}
plot(sites)

# Create a uniform first order neighbourhood
knb &lt;- dnearneigh(sites, 0, 1)
plot(knb, sites)

# Lag the neighbourhood to create other order matrices
knb &lt;- nblag(knb, 4)
klist &lt;- list(order0=diag(25),
           order1=nb2mat(knb[[1]]),
           order2=nb2mat(knb[[2]]),
           order3=nb2mat(knb[[3]]),
           order4=nb2mat(knb[[4]]))
		   
# Simulate a STARMA(2;1) process
eps &lt;- matrix(rnorm(200*25), 200, 25)
star &lt;- eps
for (t in 3:200) {
	star[t,] &lt;- (.4*klist[[1]] + .25*klist[[2]]) %*% star[t-1,] +
		(.25*klist[[1]]                ) %*% star[t-2,] +
		(            - .3*klist[[2]]) %*% eps[t-1,] +
		eps[t, ]
}

star &lt;- star[101:200,]	# Remove first observations
star &lt;- stcenter(star)	# Center and scale the dataset
										   
# Identify the process
stacf(star, klist)
stpacf(star, klist)

# Estimate the process
ar &lt;- matrix(c(1, 1, 1, 0), 2, 2)
ma &lt;- matrix(c(0, 1), 1, 2)
model &lt;- starma(star, klist, ar, ma)
model
summary(model)

# Diagnose the process
stcor.test(model$residuals, klist, fitdf=4)
stacf(model$residuals, klist)
stpacf(model$residuals, klist)
</code></pre>


</div>