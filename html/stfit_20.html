<div class="container">

<table style="width: 100%;"><tr>
<td>seffEst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>STFIT Spatial Effect Estimation</h2>

<h3>Description</h3>

<p>STFIT Spatial Effect Estimation
</p>


<h3>Usage</h3>

<pre><code class="language-R">seffEst(
  rmat,
  img.nrow,
  img.ncol,
  h.cov = 2,
  h.sigma2 = 2,
  weight.cov = NULL,
  weight.sigma2 = NULL,
  nnr,
  method = c("lc", "emp"),
  partial.only = TRUE,
  pve = 0.99,
  msk = NULL,
  msk.tol = 0.95,
  var.est = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rmat</code></td>
<td>
<p>residual matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>img.nrow</code></td>
<td>
<p>image row dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>img.ncol</code></td>
<td>
<p>image column dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.cov</code></td>
<td>
<p>bandwidth for spatial covariance estimation; ignored if <code>weight.cov</code> is supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.sigma2</code></td>
<td>
<p>bandwidth for sigma2 estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.cov</code></td>
<td>
<p>weight matrix for spatial covariance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.sigma2</code></td>
<td>
<p>weight vector for spatial variance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnr</code></td>
<td>
<p>maximum number of nearest neighbor pixels to use for spatial covariance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"lc" for local constant covariance estimation and "emp" for empirical covariance estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.only</code></td>
<td>
<p>calculate the spatical effect for partially observed images only, default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pve</code></td>
<td>
<p>percent of variance explained of the selected eigen values. Default is 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msk</code></td>
<td>
<p>an optional logistic vector. TRUE represent the corresponding pixel is always missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msk.tol</code></td>
<td>
<p>if 'msk' is not given, the program will determine the mask using <code>getMask</code>
function. If the percentage of missing values for a pixel over time is greater than this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.est</code></td>
<td>
<p>Whether to estimate the variance of the temporal effect. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of length 3 with entries:
</p>

<ul>
<li>
<p> seff_mat: estimated spatial effect matrix of the same shape as <code>rmat</code>.
</p>
</li>
<li>
<p> seff_var_mat: estimated spatial effect variance matrix of the same shape as <code>rmat</code>.
</p>
</li>
<li>
<p> idx: a list of two entries:
</p>

<ul>
<li>
<p> idx.allmissing: index of the completely missing images.
</p>
</li>
<li>
<p> idx.imputed: index of the partially observed images, where spatial effects 
are estimated.
</p>
</li>
</ul>
</li>
</ul>
</div>