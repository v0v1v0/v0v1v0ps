<div class="container">

<table style="width: 100%;"><tr>
<td>smn.clmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ML estimation of scale mixture of normal linear mixed models with censored responses
</h2>

<h3>Description</h3>

<p>It fits left, right, or interval censored scale mixture of normal linear mixed model with possible within-subject dependence structure, using the EM algorithm.
It provides estimates and standard errors of parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smn.clmm(data, formFixed, groupVar, formRandom = ~1, depStruct = "UNC",
         ci, lcl, ucl, timeVar = NULL, distr = "norm",
         nufix = FALSE, pAR = 1, control = lmmControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables named in <code>formFixed</code>, <code>formRandom</code>, <code>groupVar</code>, <code>timeVar</code>, <code>ci</code>, <code>lcl</code>, and <code>ucl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formFixed</code></td>
<td>
<p>A two-sided linear formula object describing the fixed effects part of the model, with the response on the left of a <code>~</code> operator and the covariates, separated by <code>+</code> operators, on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupVar</code></td>
<td>
<p>A character containing the name of the variable which represents the subjects or groups in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formRandom</code></td>
<td>
<p>A one-sided linear formula object describing the random effects part of the model, with the covariates, separated by <code>+</code> operators, on the right of a <code>~</code> operator. By default, a model with random intercept is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure should be used. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) – p is <code>length(phi)</code>–, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, <code>"CAR1"</code> for continuous-time AR(1), and <code>"MA1"</code> for moving average of order 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>A character containing the name of the censoring indicator variable in <code>data</code>, which should be 1 if the respective observation is censored or missing, and 1 otherwise. If missing, it is assumed that none of the observations is censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcl</code></td>
<td>
<p>A character containing the name of the lower censoring limit in <code>data</code>. If missing, it is assumed <code>lcl=-Inf</code>, i.e., no left limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ucl</code></td>
<td>
<p>A character containing the name of the upper censoring limit in <code>data</code>. If missing, it is assumed <code>ucl=Inf</code>, i.e., no right limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>A character containing the name of the variable which represents the time in <code>data</code>. Meaningless if <code>depStruct="UNC"</code> or <code>depStruct="CS"</code>. For other structures, if <code>is.null(timeVar)</code> the observations are considered equally spaced and ordered. If <code>depStruct="ARp"</code>, timeVar must be an index, preferably starting at 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character indicating which distribution should be used. <code>"norm"</code> for normal and <code>"t"</code> for Student-t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nufix</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating if <code>nu</code> should be estimated for t distribution. If <code>nufix=TRUE</code>, nu must be especified through <code>lmmControl()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pAR</code></td>
<td>
<p>If <code>depStruct="ARp"</code>, <code>pAR</code> indicates the order of the autoregressive process that should be used (1 by default). Otherwise, it is meaningless.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object resulting from the function <code>lmmControl()</code>, containing additional options for the estimation algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It fits the model <code class="reqn">Y_i = X_i \beta + Z_i b_i + \epsilon_i</code>, for <code class="reqn">i=1,\dots,n</code>, where <code class="reqn">Y_i</code> is a vector with <code class="reqn">n_i</code> observed continuous responses, <code class="reqn">b_i ~ SMN(0, D; H)</code> and <code class="reqn">\epsilon_i ~ SMN(0, \Sigma_i; H)</code>, indexed by the same mixing distribution.
</p>
<p>For details see Matos et al. (2013) and Lachos et al. (2019).
</p>


<h3>Value</h3>

<p>An object of class "SMNclmm" representing the SMN-CLMM fit. Generic functions such as print and summary have methods to show the results of the fit. The functions fitted and ranef can be used to extract some of its components.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Named vector with parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations runned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>A named list containing parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yest</code></td>
<td>
<p>Imputed values in the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uhat</code></td>
<td>
<p>Estimated weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik.track</code></td>
<td>
<p>Vector containing the log-likelihood value from each iteration of the estimation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effects</code></td>
<td>
<p>Estimated random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.error</code></td>
<td>
<p>A vector with standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elapsedTime</code></td>
<td>
<p>Time elapsed in processing, in seconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Convergence criterion at last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>A list with AIC, BIC, and SIC criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The <code>smn.clmm</code> call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame used on <code>smn.clmm</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A list containing the formulas used on <code>smn.clmm</code> call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covRandom</code></td>
<td>
<p>A character indicating which structure was used for the random effects scale matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character indicating which distribution was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of observations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of individuals/groups used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupVar</code></td>
<td>
<p>A character indicating the name of the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>A character indicating the name of the time variable, if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>A vector of fitted values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Larissa A. Matos, Victor H. Lachos, Katherine L. Valeriano and Fernanda L. Schumacher
</p>


<h3>References</h3>

<p>Henderson, N. C. and R. Varadhan (2019). Damped anderson acceleration with restarts
and monotonicity control for accelerating EM and EM-like algorithms. Journal of
Computational and Graphical Statistics 28(4), 834-846.
</p>
<p>Matos, L. A., Prates, M. O., Chen, M. H., and Lachos, V. H. (2013). Likelihood-based inference for mixed-effects models with censored response using the multivariate-t distribution. Statistica Sinica 23(3), 1323-1345.
</p>
<p>Lachos, V. H., A. Matos, L., Castro, L. M., and Chen, M. H. (2019). Flexible longitudinal linear mixed models for multiple censored responses data. Statistics in medicine, 38(6), 1074-1102.
</p>


<h3>See Also</h3>

<p><code>lmmControl</code>, <code>update</code>, <code>predict.SMNclmm</code>, <code>residuals.SMNclmm</code>, <code>plot.SMNclmm</code>,
<code>smn.lmm</code>, <code>smsn.lmm</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generating a sample for m=30 individuals with 5 times
# Considering 10% of left censoring responses
# AR(1) and normal distribution
nj1 = 5
m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time = time, ind = groups, x = cbind(1,time), z = rep(1,m*nj1),
                  sigma2=0.6, D=0.5*diag(1), beta=c(1,2), depStruct="ARp",
                  phi=0.4, pcens = .1, type = "left")

# Estimation using UNC
fm0 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", ci="ci", ucl="ucl")
summary(fm0)

# Estimation using AR(1)
fm1 = update(fm0, depStruct="ARp")

# Estimation using AR(1) and t distribution
fm2 = update(fm1, distr="t")

# Comparing fitted models
criteria(list(fm0= fm0, fm1=fm1, fm2=fm2))

</code></pre>


</div>