<div class="container">

<table style="width: 100%;"><tr>
<td>make_summation_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct symmetry constraint matrix for bivariate symmetric smoothing.</h2>

<h3>Description</h3>

<p>This function can be used to construct a symmetry constraint matrix that imposes
a (skew-)symmetry constraint on (cyclic) spline coefficients in symmetric bivariate smoothing problems and is especially
designed for constructing objects of the class "symm.smooth", see <code>smooth.construct.symm.smooth.spec</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_summation_matrix(F, skew = FALSE, cyclic.degree = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>number of marginal basis functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>
<p>logical, should the basis be constraint to skew-symmetry instead
of symmetry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cyclic.degree</code></td>
<td>
<p>integer, specifying the number of basis functions identified
with each other at the boundaries in order to implement periodicity. Should
be specified to match the degree of the utilized B-spline basis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Imposing a symmetry constraint to the spline coefficients in order to obtain a reduced coefficient vector is
equivalent to right multiplication of the bivariate design matrix
with the symmetry constraint matrix obtained with function <code>make_summation_matrix</code>.
The penalty matrix of the bivariate smooth needs to be adjusted to the reduced coefficient vector
by left and right multiplication with the symmetry constraint matrix.
This function is used in the constructor function <code>smooth.construct.symm.smooth.spec</code>.
</p>


<h3>Value</h3>

<p>A basis transformation matrix of dimension <code class="reqn">F^2 \times G</code> with
<code class="reqn">G&lt;F^2</code> depending on the specified constraint.
</p>


<h3>Author(s)</h3>

<p>Jona Cederbaum, Almond Stoecker
</p>


<h3>References</h3>

<p>Cederbaum, Scheipl, Greven (2016): Fast symmetric additive covariance smoothing.
Submitted on arXiv.
</p>


<h3>See Also</h3>

<p><code>smooth.construct</code> and <code>smoothCon</code> for details on constructors
</p>


</div>