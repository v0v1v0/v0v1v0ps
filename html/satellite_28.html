<div class="container">

<table style="width: 100%;"><tr>
<td>calcTOAIrradRadRef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute top of atmosphere solar irradiance using radiation vs. reflection</h2>

<h3>Description</h3>

<p>Compute extraterrestrial solar irradiance (ESun) using the actual
maximum radiation and reflection values within each band.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Satellite'
calcTOAIrradRadRef(x, normalize = TRUE, esd)

## S4 method for signature 'numeric'
calcTOAIrradRadRef(x, ref_max, normalize = TRUE, esd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A Satellite object or the maximum radiance of satellite 
band(s) as numeric object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Logical; if <code>TRUE</code>, ESun is normalized to mean 
earth-sun distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esd</code></td>
<td>
<p>Earth-sun distance (AU, can be estimated using 
<code>calcEarthSunDist</code>). If x is a Satellite object and esd is not 
supplied and necessary for normalization, it is tried to take it from the 
metadata, otherwise it is estimated by the day of the year using 
<code>calcEarthSunDist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_max</code></td>
<td>
<p>Maximum reflextance of satellite band(s).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The actual solar irradiance is computed using the following formula 
taken from the GRASS GIS 
<a href="https://grass.osgeo.org/grass78/manuals/i.landsat.toar.html">i.landsat.toar</a> module
</p>
<p style="text-align: center;"><code class="reqn">ESun = (pi d^2) RADIANCE_MAXIMUM / REFLECTANCE_MAXIMUM</code>
</p>

<p>where d is the earth-sun distance (in AU) and RADIANCE_MAXIMUM
and REFLECTANCE_MAXIMUM are the maximum radiance and reflection values of the
respective band. All these parameters are taken from the scene's metadata
file if a Satellite object is passed to the function.
</p>
<p>By default, the resulting actual ESun will be normalized to a mean earth-sun 
distance to be compatible with other default results from 
<code>calcTOAIrradTable</code> or <code>calcTOAIrradModel</code>.
</p>


<h3>Value</h3>

<p>If x is a Satellite object, a Satellite object with ESun information 
added to the metadata; if x is numeric, a vector containing ESun for the 
respective band(s).
</p>


<h3>See Also</h3>

<p><code>calcTOAIrradTable</code> for tabulated solar irradiance
values from the literature or <code>calcTOAIrradModel</code> for the 
computation of the solar irradiance based on look-up tables for the sensor's 
relative spectral response and solar irradiation spectral data.
</p>
<p>See <code>calcEarthSunDist</code> for calculating the earth-sun
distance based on the day of the year which is called by this function if
ESun should be corrected for actual earth-sun distance.
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- system.file("extdata", package = "satellite")
files &lt;- list.files(path, pattern = glob2rx("LC08*.TIF"), full.names = TRUE)
sat &lt;- satellite(files)  
sat &lt;- calcTOAIrradModel(sat)
getSatESUN(sat)

calcTOAIrradRadRef(x = getSatRadMax(sat, getSatBCDESolar(sat)), 
                   ref_max = getSatRefMax(sat, getSatBCDESolar(sat)), 
                   normalize = FALSE, 
                   esd = calcEarthSunDist("2015-01-01"))
                   
</code></pre>


</div>