<div class="container">

<table style="width: 100%;"><tr>
<td>dpeak</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability mass function of number of peaks in an i.i.d. random sequence</h2>

<h3>Description</h3>

<p>This function computes <code class="reqn">P(n,k)</code> as defined by
Goldfeld and Quandt (1965), i.e. the probability that a
sequence of <code class="reqn">n</code> independent and identically distributed random variables
contains exactly <code class="reqn">k</code> peaks, with peaks also as defined by
Goldfeld and Quandt (1965). The function is used in
<code>ppeak</code> to compute <code class="reqn">p</code>-values for the Goldfeld-Quandt
nonparametric test for heteroskedasticity in a linear model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpeak(k, n, usedata = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer or a sequence of integers strictly incrementing by 1,
with all values between 0 and <code>n - 1</code> inclusive. Represents the number
of peaks in the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer representing the number of observations in the
sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usedata</code></td>
<td>
<p>A logical. Should probability mass function values be
read from <code>dpeakdat</code> rather than computing them? This option
will save significantly on computation time if <code class="reqn">n &lt; 170</code> but is
currently only available for <code class="reqn">n \leq 1000</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A double between 0 and 1 representing the probability of exactly
k peaks occurring in a sequence of <code class="reqn">n</code> independent and identically
distributed continuous random variables. The double has a <code>names</code>
attribute with the values corresponding to the probabilities.
Computation time is very slow for
<code class="reqn">n &gt; 170</code> (if <code>usedata</code> is <code>FALSE</code>) and for <code class="reqn">n &gt; 1000</code>
regardless of <code>usedata</code> value.
</p>


<h3>References</h3>

<p>Goldfeld SM, Quandt RE (1965).
“Some Tests for Homoscedasticity.”
<em>Journal of the American Statistical Association</em>, <b>60</b>(310), 539–547.
</p>


<h3>See Also</h3>

<p><code>ppeak</code>, <code>goldfeld_quandt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">dpeak(0:9, 10)
plot(0:9, dpeak(0:9, 10), type = "p", pch = 20, xlab = "Number of Peaks",
         ylab = "Probability")

# This would be extremely slow if usedata were set to FALSE:
prob &lt;- dpeak(0:199, 200, usedata = TRUE)
plot(0:199, prob, type = "l", xlab = "Number of Peaks", ylab = "Probability")

# `dpeakdat` is a dataset containing probabilities generated from `dpeak`
utils::data(dpeakdat)
expval &lt;- unlist(lapply(dpeakdat,
                 function(p) sum(p * 0:(length(p) - 1))))
plot(1:1000, expval[1:1000], type = "l", xlab = parse(text = "n"),
     ylab = "Expected Number of Peaks")
</code></pre>


</div>