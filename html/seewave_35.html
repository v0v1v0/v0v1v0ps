<div class="container">

<table style="width: 100%;"><tr>
<td>dfreq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dominant frequency of a time wave</h2>

<h3>Description</h3>

<p>This function gives the dominant frequency (i. e. the frequency of highest amplitude) of a time wave.</p>


<h3>Usage</h3>

<pre><code class="language-R">dfreq(wave, f, channel = 1, wl = 512, wn = "hanning", ovlp = 0, fftw=  FALSE, at =
NULL, tlim = NULL, threshold = NULL, bandpass = NULL, clip = NULL,
plot = TRUE, xlab = "Times (s)", ylab = "Frequency (kHz)",
ylim = c(0, f/2000), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R object, by default left channel (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>
<p>length of the window for the analysis
(even number of points, by default = 512).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wn</code></td>
<td>
<p>window name, see <code>ftwindow</code> (by default <code>"hanning"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ovlp</code></td>
<td>
<p>overlap between two successive analysis windows (in % ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftw</code></td>
<td>
<p>if <code>TRUE</code> calls the function <code>FFT</code> of the
library <code>fftw</code>. See Notes of the <code>spectro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>time position where the dominant frequency has to be
computed (in s.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>modifications of the time X-axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>amplitude threshold for signal detection (in % ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandpass</code></td>
<td>
<p>a numeric vector of length two, giving the lower and
upper limits of a frequency bandpass filter (in Hz).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clip</code></td>
<td>
<p>a numeric value to select dominant frequency values according to
their amplitude in reference to a maximal value of 1 for
the whole signal (has to be &gt;0 &amp; &lt; 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots the dominant frequency against time
(by default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the range of y values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>plot</code> is <code>FALSE</code>, <code>dfreq</code> returns a two-column matrix, the first column corresponding to time in seconds (<em>x</em>-axis) and the second column corresponding to 
to dominant frequency in kHz (<em>y</em>-axis).<br>
NA corresponds to pause sections in <code>wave</code> (see <code>threshold</code>). 
</p>


<h3>Note</h3>

<p>This function is based on <code>fft</code>.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a></p>


<h3>See Also</h3>

<p><code>spec</code>, <code>meanspec</code>,<code>spectro</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico)
f &lt;- 22050
# default
dfreq(tico,f)
# using the amplitude threshold and changing the graphical output
dfreq(tico, f, ovlp=50,threshold=5, type="l", col=2)
# using 'at' argument for specific positions along the time axis
dfreq(tico, f, at=c(0.25, 0.75, 1.2, 1.6))
dfreq(tico, f, at=seq(0.5, 1.4, by=0.005), threshold=5)
# a specific number of measures on a single note
dfreq(tico, f, at=seq(0.5, 0.9, len=100), threshold=5, xlim=c(0.5,0.9))
# overlap on spectrogram
# and use of 'clip' argument to better track the dominant frequency
# in noisy conditions
op &lt;- par()
ticon &lt;- tico@left/max(tico@left) + noisew(d=length(tico@left)/f, f)
spectro(ticon, f)
res &lt;- dfreq(ticon, f, clip=0.3, plot=FALSE)
points(res, col=2, pch =13)
par(op)
</code></pre>


</div>