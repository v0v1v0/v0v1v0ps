<div class="container">

<table style="width: 100%;"><tr>
<td>ev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes the null expectation and variance for one stratum.
</h2>

<h3>Description</h3>

<p>Of limited interest to most users, the ev function plays an internal role in 2-sample and stratified sensitivity analyses.  The expectation and variance returned by the ev function are defined in the third paragraph of section 4, page 495, of Rosenbaum and Krieger (1990).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ev(sc, z, m, g, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>

<p>A vector of scored outcomes for one stratum.  For instance, for Wilcoxon's rank sum test,
these would be the ranks of the outcomes in the current stratum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>Treatment indicators, with length(z)=length(sc).  Here, z[i]=1 if i is treated and z[i]=0 if i is control.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>The unobserved covariate u has length(z)-m 0's followed by m 1's.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>The sensitivity parameter <code class="reqn">\Gamma</code>, where <code class="reqn">\Gamma \ge 1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>If method="RK" or if method="BU", exact expectations and variances are used in a large sample approximation.  Methods "RK" and "BU" should give the same answer, but "RK" uses formulas from Rosenbaum and Krieger (1990), while "BU" obtains exact moments for the extended hypergeometric distribution using the BiasedUrn package and then applies Proposition 20, page 155, section 4.7.4 of Rosenbaum (2002).  In contrast, method="LS" does not use exact expectations and variances, but rather uses the large sample approximations in section 4.6.4 of Rosenbaum (2002).  Finally, method="AD" uses method="LS" for large strata and method="BU" for smaller strata.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function ev() is called by the function evall().
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expect </code></td>
<td>
<p>Null expectation of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vari </code></td>
<td>
<p>Null variance of the test statistic.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Paul R. Rosenbaum
</p>


<h3>References</h3>

<p>Rosenbaum, P. R. and Krieger, A. M. (1990). Sensitivity of two-sample permutation inferences in observational studies.  Journal of the American Statistical Association, 85, 493-498.
</p>
<p>Rosenbaum, P. R. (2002). Observational Studies (2nd edition). New York: Springer.  Section 4.6.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ev(1:5,c(0,1,0,1,0),3,2,"RK")
ev(1:5,c(0,1,0,1,0),3,2,"BU")
</code></pre>


</div>