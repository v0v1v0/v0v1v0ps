<div class="container">

<table style="width: 100%;"><tr>
<td>spte_covest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the spatio-temporal covariance function</h2>

<h3>Description</h3>

<p>The function <code>spte_covest</code> is developed to estimate the spatio-temporal 
covariance <code class="reqn">V(t,t';s,s')=\mbox{Cov}(y(t,s),y(t',s'))</code> by the weighted 
moment estimation procedure (cf., Yang and Qiu 2019). It should be noted that 
the estimated covariance from <code>spte_covest</code> may not be positive 
semidefinite and thus it may not be a legitimate covariance function. In such 
cases, the projection-based modification needs to be used to make it positive 
semidefinite (cf., Yang and Qiu 2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">spte_covest(y, st, gt = NULL, gs = NULL, stE1 = NULL, stE2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing data of the observed response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>An <code class="reqn">N \times 3</code> matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code>,  and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,
and it will be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stE1</code></td>
<td>
<p>An <code class="reqn">N_1 \times 3</code> matrix specifying the spatial locations 
<code class="reqn">s</code> and times <code class="reqn">t</code>. Default value is NULL, and <code>stE1=st</code> if 
<code>stE1=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stE2</code></td>
<td>
<p>An <code class="reqn">N_2 \times 3</code> matrix specifying the spatial locations <code class="reqn">s'</code>
and times <code class="reqn">t'</code>. Default value is NULL, and <code>stE2=st</code> if 
<code>stE2=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stE1</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stE2</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>The bandwidths <code>(gt, gs)</code> used in the weighted moment 
estimation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covhat</code></td>
<td>
<p>An <code class="reqn">N_1 \times N_2</code> covariance matrix estimate.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2019). Nonparametric Estimation of the Spatio-Temporal 
Covariance Structure. <em>Statistics in Medicine</em>, <strong>38</strong>, 4555-4565.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
cov.est &lt;- spte_covest(y.sub,st.sub)
</code></pre>


</div>