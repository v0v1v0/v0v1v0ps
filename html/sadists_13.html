<div class="container">

<table style="width: 100%;"><tr>
<td>proddnf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The product of multiple doubly non-central F's distribution.</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the product of multiple independent 
doubly non-central F variates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dproddnf(x, df1, df2, ncp1, ncp2, log = FALSE, order.max=4)

pproddnf(q, df1, df2, ncp1, ncp2, lower.tail = TRUE, log.p = FALSE, order.max=4)

qproddnf(p, df1, df2, ncp1, ncp2, lower.tail = TRUE, log.p = FALSE, order.max=4)

rproddnf(n, df1, df2, ncp1, ncp2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df1, df2</code></td>
<td>
<p>the vectors of the degrees of freedom for the numerator and denominator.
We do <em>not</em> recycle these versus the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp1, ncp2</code></td>
<td>
<p>the vectors of the non-centrality parameters for the numerator and denominator.
We do <em>not</em> recycle these versus the <code>x,q,p,n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, densities <code class="reqn">f</code> are given 
as <code class="reqn">\mbox{log}(f)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.max</code></td>
<td>
<p>the order to use in the approximate density,
distribution, and quantile computations, via the Gram-Charlier,
Edeworth, or Cornish-Fisher expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given 
as <code class="reqn">\mbox{log}(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let 
</p>
<p style="text-align: center;"><code class="reqn">x_j \sim F\left(\delta_{1,j},\delta_{2,j},\nu_{1,j},\nu_{2,j}\right)</code>
</p>

<p>be independent doubly non-central F variates with non-centrality parameters
<code class="reqn">\delta_{i,j}</code> and degrees of freedom
<code class="reqn">\nu_{i,j}</code> for <code class="reqn">i=1,2,\ldots,I</code> and 
<code class="reqn">j=1,2</code>.
Then 
</p>
<p style="text-align: center;"><code class="reqn">Y = \prod_j x_j</code>
</p>

<p>takes a product of doubly non-central F's distribution. We take the
parameters of this distribution as the four <code class="reqn">I</code> length vectors
of the two degrees of freedom and the two non-centrality parameters.
</p>


<h3>Value</h3>

<p><code>dproddnf</code> gives the density, <code>pproddnf</code> gives the 
distribution function, <code>qproddnf</code> gives the quantile function, 
and <code>rproddnf</code> generates random deviates.
</p>
<p>Invalid arguments will result in return value <code>NaN</code> with a warning.
</p>


<h3>Note</h3>

<p>The PDF, CDF, and quantile function are approximated, via
the Edgeworth or Cornish Fisher approximations, which may
not be terribly accurate in the tails of the distribution.
You are warned.
</p>
<p>The distribution parameters are <em>not</em> recycled
with respect to the <code>x, p, q</code> or <code>n</code> parameters,
for, respectively, the density, distribution, quantile
and generation functions. This is for simplicity of
implementation and performance. It is, however, in contrast
to the usual R idiom for dpqr functions.
</p>
<p>The PDQ functions are computed by translation of the 
sum of log chi-squares distribution functions.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Pav, Steven. Moments of the log non-central chi-square distribution.
<a href="https://arxiv.org/abs/1503.06266">https://arxiv.org/abs/1503.06266</a>
</p>


<h3>See Also</h3>

<p>The sum of log of chi-squares distribution,
<code>dsumlogchisq</code>,
<code>psumlogchisq</code>,
<code>qsumlogchisq</code>,
<code>rsumlogchisq</code>.
(doubly non-central) F distribution functions, 
<code>ddnf</code>,
<code>pdnf</code>, 
<code>qdnf</code>, 
<code>rdnf</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">df1 &lt;- c(10,20,5)
df2 &lt;- c(1000,500,150)
ncp1 &lt;- c(1,0,2.5)
ncp2 &lt;- c(0,1.5,5)

rv &lt;- rproddnf(500, df1=df1,df2=df2,ncp1=ncp1,ncp2=ncp2)
d1 &lt;- dproddnf(rv, df1=df1,df2=df2,ncp1=ncp1,ncp2=ncp2)

plot(rv,d1)

p1 &lt;- pproddnf(rv, df1=df1,df2=df2,ncp1=ncp1,ncp2=ncp2)
# should be nearly uniform:

plot(ecdf(p1))

q1 &lt;- qproddnf(ppoints(length(rv)), df1=df1,df2=df2,ncp1=ncp1,ncp2=ncp2)

qqplot(x=rv,y=q1)

</code></pre>


</div>