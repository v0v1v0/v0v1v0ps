<div class="container">

<table style="width: 100%;"><tr>
<td>glm_epidataCS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit an Endemic-Only <code>twinstim</code> as a Poisson-<code>glm</code>
</h2>

<h3>Description</h3>

<p>An endemic-only <code>twinstim</code> is equivalent to a Poisson
regression model for the aggregated number of events,
<code class="reqn">Y_{[t][\bm{s}],k}</code>, by time-space-type cell. The rate of the
corresponding Poisson distribution is
<code class="reqn">e_{[t][\bm{s}]} \cdot \lambda([t],[\bm{s}],k)</code>,
where <code class="reqn">e_{[t][\bm{s}]} = |[t]| |[\bm{s}]|</code> is a multiplicative
offset. Thus, the <code>glm</code> function can be used to fit
an endemic-only <code>twinstim</code>. However, wrapping in <code>glm</code> is
usually slower. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm_epidataCS(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an endemic model formula without response, comprising variables of
<code>data$stgrid</code> and possibly the variable <code>type</code> for a
type-specific model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an object of class <code>"epidataCS"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments passed to <code>glm</code>. Note that <code>family</code> and
<code>offset</code> are fixed internally.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>glm</code>
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("imdepi", "imdepifit")

## Fit an endemic-only twinstim() and an equivalent model wrapped in glm()
fit_twinstim &lt;- update(imdepifit, epidemic = ~0, siaf = NULL, subset = NULL,
                       optim.args=list(control=list(trace=0)), verbose=FALSE)
fit_glm &lt;- glm_epidataCS(formula(fit_twinstim)$endemic, data = imdepi)

## Compare the coefficients
cbind(twinstim = coef(fit_twinstim), glm = coef(fit_glm))


### also compare to an equivalent endemic-only hhh4() fit

## first need to aggregate imdepi into an "sts" object
load(system.file("shapes", "districtsD.RData", package="surveillance"))
imdsts &lt;- epidataCS2sts(imdepi, freq = 12, start = c(2002, 1),
                        neighbourhood = NULL, tiles = districtsD,
                        popcol.stgrid = "popdensity")

## determine the correct offset to get an equivalent model
offset &lt;- 2 * rep(with(subset(imdepi$stgrid, !duplicated(BLOCK)),
                  stop - start), ncol(imdsts)) *
          sum(districtsD$POPULATION) * population(imdsts)

## fit the model using hhh4()
fit_hhh4 &lt;- hhh4(imdsts, control = list(
    end = list(
        f = addSeason2formula(~I(start/365-3.5), period=365, timevar="start"),
        offset = offset
    ), family = "Poisson", subset = 1:nrow(imdsts),
    data = list(start=with(subset(imdepi$stgrid, !duplicated(BLOCK)), start))))

summary(fit_hhh4)
stopifnot(all.equal(coef(fit_hhh4), coef(fit_glm), check.attributes=FALSE))
</code></pre>


</div>