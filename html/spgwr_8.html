<div class="container">

<table style="width: 100%;"><tr>
<td>ggwr.sel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Crossvalidation of bandwidth for generalised GWR</h2>

<h3>Description</h3>

<p>The function finds a bandwidth for a given generalised geographically weighted regression
by optimzing a selected function. For cross-validation, this scores the root mean square
prediction error for the generalised geographically weighted regressions, choosing the
bandwidth minimizing this quantity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggwr.sel(formula, data = list(), coords, adapt = FALSE, gweight = gwr.Gauss,
 family = gaussian, verbose = TRUE, longlat = NULL, RMSE=FALSE,
 tol=.Machine$double.eps^0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula as in <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>model data frame as in <code>glm</code>, or may be a SpatialPointsDataFrame or SpatialPolygonsDataFrame object as defined in package <span class="pkg">sp</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>matrix of coordinates of points representing the spatial
positions of the observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>either TRUE: find the proportion between 0 and 1 of observations to include in weighting scheme (k-nearest neighbours), or FALSE â€” find global bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gweight</code></td>
<td>
<p>geographical weighting function, at present 
<code>gwr.Gauss()</code> default, or <code>gwr.gauss()</code>, the previous default or <code>gwr.bisquare()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model, see <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if TRUE (default), reports the progress of search for bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>TRUE if point coordinates are longitude-latitude decimal degrees, in which case distances are measured in kilometers; if x is a SpatialPoints object, the value is taken from the object itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSE</code></td>
<td>
<p>default FALSE to correspond with CV scores in newer references (sum of squared CV errors), if TRUE the previous behaviour of scoring by LOO CV RMSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the desired accuracy to be passed to <code>optimize</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns the cross-validation bandwidth.
</p>


<h3>Note</h3>

<p>The use of GWR on GLM is only at the initial proof of concept stage, nothing should be treated as an accepted method at this stage.
</p>


<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Fotheringham, A.S., Brunsdon, C., and Charlton, M.E., 2002,
Geographically Weighted Regression, Chichester: Wiley;
<a href="http://gwr.nuim.ie/">http://gwr.nuim.ie/</a></p>


<h3>See Also</h3>

<p><code>gwr.sel</code>, <code>ggwr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
if (require(sf)) {
xx &lt;- as(st_read(system.file("shapes/sids.gpkg", package="spData")[1]), "Spatial")
bw &lt;- ggwr.sel(SID74 ~ I(NWBIR74/BIR74) + offset(log(BIR74)), data=xx,
  family=poisson(), longlat=TRUE)
bw
}

</code></pre>


</div>