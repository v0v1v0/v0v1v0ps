<div class="container">

<table style="width: 100%;"><tr>
<td>moran_multithreshold</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran's I test on a numeric vector for different neighborhoods</h2>

<h3>Description</h3>

<p>Applies <code>moran()</code> to different distance thresholds at the same time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moran_multithreshold(
  x = NULL,
  distance.matrix = NULL,
  distance.thresholds = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector, generally model residuals, Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.matrix</code></td>
<td>
<p>Distance matrix among cases in <code>x</code>. The number of rows of this matrix must be equal to the length of <code>x</code>. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance.thresholds</code></td>
<td>
<p>Numeric vector, distances below each value are set to 0 on separated copies of the distance matrix for the computation of Moran's I at different neighborhood distances. If <code>NULL</code>, it defaults to <code>seq(0, max(distance.matrix)/4, length.out = 2)</code>. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, if <code>TRUE</code>, plots Moran's I values for each distance threshold. Default: <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using different distance thresholds helps to take into account the uncertainty about what "neighborhood" means in ecological systems (1000km in geological time means little, but 100m might be quite a long distance for a tree to disperse seeds over), and allows to explore spatial autocorrelation of model residuals for several minimum-distance criteria at once.
</p>


<h3>Value</h3>

<p>A named list with the slots:
</p>

<ul>
<li> <p><code>df</code>: Data frame with the results of moran per distance threshold.
</p>
</li>
<li> <p><code>plot</code>: A plot of Moran's I across distance thresholds.
</p>
</li>
<li> <p><code>max.moran</code>: Maximum value of Moran's I across thresholds.
</p>
</li>
<li> <p><code>max.moran.distance.threshold</code>: Distance threshold with the maximum Moran's I value.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>moran()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(interactive()){

 #loading example data
 data(distance_matrix)
 data(plant_richness)

 #computing Moran's I for the response variable at several reference distances
 out &lt;- moran_multithreshold(
   x = plant_richness$richness_species_vascular,
   distance.matrix = distance_matrix,
   distance.thresholds = c(0, 100, 1000, 10000),
   plot = TRUE
   )
 out

}
</code></pre>


</div>