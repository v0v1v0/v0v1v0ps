<div class="container">

<table style="width: 100%;"><tr>
<td>rspline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random splines</h2>

<h3>Description</h3>

<p>The function simulates a random <code>Splinets</code>-object that is made of random splines with the center 
at the input spline and the matrix of derivatives has the added error term of the form 
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol \Sigma^{1/2}\mathbf Z \boldsymbol \Theta^{1/2},
 </code>
</p>
 
<p>where  <code class="reqn">\mathbf Z</code> is a <code class="reqn">(n+2)\times (k+1)</code> matrix having iid standard normal variables
as its entries, while <code class="reqn">\boldsymbol \Sigma</code> and <code class="reqn">\boldsymbol \Theta</code> are matrix parameters. 
This matrix error term is then corrected by one of the methods and thus resulting in a matrix of derivatives at knots corresponding to a valid spline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rspline(S, N = 1, Sigma = NULL, Theta = NULL, mthd = "RRM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p><code>Splinets</code>-object with <code>n+2</code> knots and of the order of smoothness <code>k</code>, representing the center of randomly simulated splines; 
When the number of splines in the object is bigger than one, only the first spline in the object is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>positive integer, size of the sample;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>matrix; </p>

<ul>
<li>
<p> If <code>(n+2)x(n+2)</code> matrix, it controls correlations between derivatives of the same order at different knots.
</p>
</li>
<li>
<p> If a positive number, it represents a diagonal <code>(n+2)x(n+2)</code> matrix with this number on the diagonal.
</p>
</li>
<li>
<p> If a <code>n+2</code> vector, it 
represents a diagonal <code>(n+2)x(n+2)</code> matrix with the vector entries on the diagonal.
</p>
</li>
<li>
<p> If <code>NULL</code> (default) represents the identity matrix.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>matrix; 
</p>

<ul>
<li>
<p> If  <code>(k+1)x(k+1)</code>, this controls correlations between different derivatives at each knot.
</p>
</li>
<li>
<p> If a positive number, it represents a diagonal matrix with this number on the diagonal.
</p>
</li>
<li>
<p> If a <code>k+1</code> vector, it 
represents a diagonal matrix with the vector entries on the diagonal.
</p>
</li>
<li>
<p> If  <code>NULL</code> (default), it represents the <code>k+1</code> identity matrix;
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mthd</code></td>
<td>
<p>string, one of the three methods: RCC, CR-LC, CR-FC, to adjust random error matrix so it corresponds to a valid spline;</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>Splinets</code>-object that contains <code>N</code> generated splines constituting an iid sample of splines;
</p>


<h3>References</h3>

<p>Liu, X., Nassar, H., Podg<code class="reqn">\mbox{\'o}</code>rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.
</p>
<p>Podg<code class="reqn">\mbox{\'o}</code>rski, K. (2021) 
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.
</p>
<p>Nassar, H., Podg<code class="reqn">\mbox{\'o}</code>rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;
</p>


<h3>See Also</h3>

<p><code>is.splinets</code> for diagnostics of the <code>Splinets</code>-objects;
<code>construct</code> for constructing a <code>Splinets</code>-object;
<code>gather</code>  for combining <code>Splinets</code>-objects into a bigger object;
<code>subsample</code>  for subsampling <code>Splinets</code>-objects;
<code>plot,Splinets-method</code> for plotting <code>Splinets</code>-objects;
</p>


<h3>Examples</h3>

<pre><code class="language-R">#-----------------------------------------------------#
#-------Simulation of a standard random splinet-------#
#-----------------------------------------------------#
n=17; k=4; xi=sort(runif(n+2)); xi[1]=0; xi[n+2]=1 
S=matrix(rnorm((n+2)*(k+1)),ncol=(k+1))
spl=construct(xi,k,S) #Construction of the mean spline

RS=rspline(spl)
graphsp=evspline(RS) #Evaluating the random spline
meansp=evspline(spl)
RS=rspline(spl,5) #Five more samples
graphsp5=evspline(RS)

m=min(graphsp[,2],meansp[,2],graphsp5[,2:6])
M=max(graphsp[,2],meansp[,2],graphsp5[,2:6])

plot(graphsp,type='l',ylim=c(m,M))
lines(meansp,col='red',lwd=3,lty=2) #the mean spline
for(i in 1:5){lines(graphsp5[,1],graphsp5[,i+1],col=i)}

#-----------------------------------------------------#
#------------Different construction method------------#
#-----------------------------------------------------#
RS=rspline(spl,8,mthd='CRLC'); graphsp8=evspline(RS)

m=min(graphsp[,2],meansp[,2],graphsp8[,2:6])
M=max(graphsp[,2],meansp[,2],graphsp8[,2:6])

plot(meansp,col='red',type='l',lwd=3,lty=2,ylim=c(m,M)) #the mean spline
for(i in 1:8){lines(graphsp8[,1],graphsp8[,i+1],col=i)}

#-----------------------------------------------------#
#-------Simulation of with different variances--------#
#-----------------------------------------------------#
Sigma=seq(0.1,1,n+2);Theta=seq(0.1,1,k+1)
RS=rspline(spl,N=10,Sigma=Sigma) #Ten samples
RS2=rspline(spl,N=10,Sigma=Sigma,Theta=Theta) #Ten samples
graphsp10=evspline(RS); graphsp102=evspline(RS2)

m=min(graphsp[,2],meansp[,2],graphsp10[,2:10])
M=max(graphsp[,2],meansp[,2],graphsp10[,2:10])

plot(meansp,type='l',ylim=c(m,M),col='red',lwd=3,lty=2) 
for(i in 1:10){lines(graphsp10[,1],graphsp10[,i+1],col=i)}

m=min(graphsp[,2],meansp[,2],graphsp102[,2:10])
M=max(graphsp[,2],meansp[,2],graphsp102[,2:10])

plot(meansp,type='l',ylim=c(m,M),col='red',lwd=3,lty=2) 
for(i in 1:10){lines(graphsp102[,1],graphsp102[,i+1],col=i)}

#-----------------------------------------------------#
#-------Simulation for the mean spline to be----------#
#------=----defined on incomplete supports------------#
#-----------------------------------------------------#
n=43; xi=seq(0,1,by=1/(n+1)); k=3; xi=sort(runif(n+2)); xi[1]=0; xi[n+2]=1;
support=list(matrix(c(2,14,25,43),ncol=2,byrow = TRUE))
ssp=new("Splinets",knots=xi,supp=support) #with partial support
nssp=is.splinets(ssp)$robject
nssp@smorder=3 #changing the order of the 'Splinets' object
m=sum(nssp@supp[[1]][,2]-nssp@supp[[1]][,1]+1) #the number of knots in the support
nssp@der=list(matrix(rnorm(m*(k+1)),ncol=(k+1)))  #the derivative matrix at random
spl=is.splinets(nssp)$robject
RS=rspline(spl,Sigma=0.05,Theta=c(1,0.5,0.3,0.05))
graphsp=evspline(RS);
meansp=evspline(spl)

m=min(graphsp[,2],meansp[,2],graphsp5[,2:6])
M=max(graphsp[,2],meansp[,2],graphsp5[,2:6])

plot(graphsp,type='l',ylim=c(m,M))
lines(meansp,col='red',lwd=3,lty=2) #the mean spline

</code></pre>


</div>