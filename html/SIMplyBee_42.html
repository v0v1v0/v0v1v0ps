<div class="container">

<table style="width: 100%;"><tr>
<td>cross</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross (mate) virgin queen(s) as a population, of a colony, or
of all given colonies</h2>

<h3>Description</h3>

<p>Level 1 function that crosses (mates) a virgin queen to a group
of drones. The virgin queen(s) could be within a population (<code>Pop-class</code>),
in a colony (<code>Colony-class</code>), or multi-colony (<code>MultiColony-class</code>).
This function does not create any progeny, it only stores the mated drones
(fathers) so we can later create progeny as needed. When input is a
(<code>Colony-class</code>) or (<code>MultiColony-class</code>), one
virgin queens is selected at random, mated, and promoted to the queen of
the colony. Other virgin queens are destroyed. Mated drones (fathers) are
stored for producing progeny at a later stage. For a better understanding
of crossing and the functions have a look at the "Crossing" vignette.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cross(
  x,
  crossPlan = NULL,
  drones = NULL,
  droneColonies = NULL,
  nDrones = NULL,
  spatial = FALSE,
  radius = NULL,
  checkCross = "error",
  simParamBee = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>Pop-class</code> or <code>Colony-class</code> or <code>MultiColony-class</code>,
one or more virgin queens / colonies to be mated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossPlan, </code></td>
<td>
<p>named list with names being virgin queen or colony IDs with
each list element holding the IDs of either selected drones or selected
drone producing colonies, OR a string "create" if you want the cross plan to be created
internally. The function can create a random (<code>spatial = FALSE</code>)
or spatial (<code>spatial = TRUE</code>) cross plan internally. Also see
<code>createCrossPlan</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drones</code></td>
<td>
<p>a <code>Pop-class</code> or a list of <code>Pop-class</code>,
group(s) of drones that will be mated with virgin queen(s).
See <code>pullDroneGroupsFromDCA</code>) to create a list of drone "packages".
A single <code>Pop-class</code> is only allowed when mating
a single virgin queen or colony, or when mating according to a cross plan that
includes drones' IDs. When creating a spatial cross plan internally, males
can not be provided through the <code>drones</code> argument as a <code>Pop-class</code>,
but should be provided through the <code>droneColonies</code> argument as
or <code>MultiColony-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>droneColonies</code></td>
<td>
<p><code>MultiColony-class</code> with all available
drone producing colonies. Provided when <code>drones</code> is not provided (NULL). When
providing drone producing colonies, the cross function uses a cross plan, that can
either be provided by the user through (<code>crossPlan</code>) argument or created
internally (when <code>crossPlan</code> is "create")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nDrones</code></td>
<td>
<p>numeric of function, the number of drones to sample to mate with each
virgin queen when using a cross plan</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>logical, whether the drone producing colonies should be sampled according
to their distance from the virgin colony (that is, in a radius)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>numeric, the radius around the virgin colony in which to sample mating partners,
only needed when <code>spatial = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkCross</code></td>
<td>
<p>character, throw a warning (when <code>checkCross = "warning"</code>),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParamBee</code></td>
<td>
<p><code>SimParamBee</code>, global simulation parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments for <code>nDrones</code>, when <code>nDrones</code> is a function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function changes caste for the mated drones to fathers, and
mated virgin queens to queens. See examples. This means that you can not
use these individuals in matings any more!
</p>
<p>If the supplied drone population is empty (has 0 individuals), which
can happen in edge cases or when <code>nFathersPoisson</code> is used
instead of <code>nFathersTruncPoisson</code>, or when performing spatially-aware mating
and no drone producing colonies are found in the vicinity, then mating of a virgin
queen will fail and she will stay virgin. This can happen for just a few
of many virgin queens, which can be annoying to track down, but you can use
<code>isQueen</code> or <code>isVirginQueen</code> to find such virgin
queens. You can use <code>checkCross</code> to alert you about this situation.
</p>


<h3>Value</h3>

<p><code>Pop-class</code> with mated queen(s). The misc slot of the
queens contains additional information about the number of workers, drones,
and homozygous brood produced, and the expected percentage of csd homozygous
brood.
</p>


<h3>See Also</h3>

<p><code>Colony-class</code> on how we store the fathers along the
queen.  For more examples for mating with either externally or internally created cross plan,
please see <code>createCrossPlan</code>
</p>
<p>For crossing virgin queens according to a cross plan, see
<code>createCrossPlan</code>.
For crossing virgin queens on a mating stations, see
<code>createMatingStationDCA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">founderGenomes &lt;- quickHaplo(nInd = 30, nChr = 1, segSites = 100)
SP &lt;- SimParamBee$new(founderGenomes)

basePop &lt;- createVirginQueens(founderGenomes)

drones &lt;- createDrones(x = basePop[1], nInd = 1000)
droneGroups &lt;- pullDroneGroupsFromDCA(drones, n = 20, nDrones = nFathersPoisson)

# If input is a Pop class of virgin queen(s)
virginQueen &lt;- basePop[2]
isQueen(virginQueen)
(matedQueen &lt;- cross(
  x = virginQueen,
  drones = droneGroups[1]
))

isQueen(virginQueen)
isQueen(matedQueen)
nFathers(matedQueen)
isDrone(getFathers(matedQueen))
isFather(getFathers(matedQueen))

virginQueens &lt;- basePop[4:5]
matedQueens &lt;- cross(
  x = virginQueens,
  drones = droneGroups[c(3, 4)]
)

isQueen(matedQueens)
nFathers(matedQueens)
getFathers(matedQueens)

# Inbred mated queen (mated with her own sons)
matedQueen2 &lt;- cross(
  x = basePop[1],
  drones = droneGroups[5]
)
# Check the expected csd homozygosity
pHomBrood(matedQueen2)

# If input is a Colony or MultiColony class
# Create Colony and MultiColony class
colony &lt;- createColony(basePop[6])
isVirginQueen(getVirginQueens(colony))
apiary &lt;- createMultiColony(basePop[7:8])
all(isVirginQueen(mergePops(getVirginQueens(apiary))))

# Cross
colony &lt;- cross(colony, drones = droneGroups[[6]])
isQueenPresent(colony)
apiary &lt;- cross(apiary, drones = droneGroups[c(7, 8)])
all(isQueenPresent(apiary))
nFathers(apiary)

# Try mating with drones that were already used for mating
colony &lt;- createColony(basePop[9])
try((matedColony &lt;- cross(x = colony, drones = droneGroups[[1]])))
# Create new drones and mate the colony with them
drones &lt;- createDrones(x = basePop[1], nInd = 15)
all(isDrone(drones))
any(isFather(drones))
(matedColony &lt;- cross(x = colony, drones = drones))
isQueenPresent(matedColony)

# Mate with drone producing colonies and a given cross plan
droneColonies &lt;- createMultiColony(basePop[10:15])
droneColonies &lt;- cross(droneColonies, drones = droneGroups[10:15])
nFathers(droneColonies)
apiary2 &lt;- createMultiColony(basePop[16:20])
apiary3 &lt;- createMultiColony(basePop[21:25])
apiary4 &lt;- createMultiColony(basePop[26:30])

# Create a random cross plan
randomCrossPlan &lt;- createCrossPlan(x = apiary2,
                                   droneColonies = droneColonies,
                                   nDrones = nFathersPoisson,
                                   spatial = FALSE)
apiary2 &lt;- cross(x = apiary2,
                 droneColonies = droneColonies,
                 crossPlan = randomCrossPlan,
                 nDrones = 15)
nFathers(apiary2)

# Mate colonies according to a cross plan that is created internally within the cross function
apiary3 &lt;- cross(x = apiary3,
                 droneColonies = droneColonies,
                 crossPlan = "create",
                 nDrones = 15)
nFathers(apiary3)

# Mate colonies according to a cross plan that is created internally within the cross function
# For this, all the colonies have to have a set location
droneColonies &lt;- setLocation(droneColonies,
                             location = Map(c, runif(6, 0, 2*pi), runif(6, 0, 2*pi)))
apiary4 &lt;- setLocation(apiary4,
                       location = Map(c, runif(5, 0, 2*pi), runif(5, 0, 2*pi)))

apiary4 &lt;- cross(x = apiary4,
                 droneColonies = droneColonies,
                 crossPlan = "create",
                 nDrones = nFathersPoisson,
                 spatial = TRUE,
                 checkCross = "warning",
                 radius = 3)
nFathers(apiary4)

</code></pre>


</div>