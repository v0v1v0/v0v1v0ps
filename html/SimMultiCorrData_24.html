<div class="container">

<table style="width: 100%;"><tr>
<td>findintercorr_pois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Intermediate MVN Correlation for Poisson Variables: Correlation Method 1</h2>

<h3>Description</h3>

<p>This function calculates a <code>k_pois x k_pois</code> intermediate matrix of correlations for the
Poisson variables using the method of Yahav &amp; Shmueli (2012, doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>). The intermediate correlation between Z1 and Z2 (the
standard normal variables used to generate the Poisson variables Y1 and Y2 via the inverse cdf method) is
calculated using a logarithmic transformation of the target correlation.  First, the upper and lower Frechet-Hoeffding bounds
(mincor, maxcor) <code class="reqn">\rho_{y1,y2}</code> are simulated.  Then the intermediate correlation is found as follows:
</p>
<p style="text-align: center;"><code class="reqn">\rho_{z1,z2} = (1/b) * log((\rho_{y1,y2} - c)/a)</code>
</p>
<p>, where <code class="reqn">a = -(maxcor * mincor)/(maxcor + mincor)</code>,
<code class="reqn">b = log((maxcor + a)/a)</code>, and <code class="reqn">c = -a</code>.  The function adapts code from Amatya &amp; Demirtas' (2016) package
<code>PoisNor-package</code> by:
</p>
<p>1) allowing specifications for the number of random variates and the seed for reproducibility
</p>
<p>2) providing the following checks: if <code class="reqn">\rho_{z1,z2}</code> &gt;= 1, <code class="reqn">\rho_{z1,z2}</code> is set to 0.99; if <code class="reqn">\rho_{z1,z2}</code> &lt;= -1,
<code class="reqn">\rho_{z1,z2}</code> is set to -0.99.
</p>
<p>The function is used in <code>findintercorr</code> and <code>rcorrvar</code>.
This function would not ordinarily be called by the user.
</p>
<p>Note: The method used here is also used in the packages <code>PoisBinOrdNor-package</code> and
<code>PoisBinOrdNonNor-package</code> by Demirtas et al. (2017), but without my modifications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findintercorr_pois(rho_pois, lam, nrand = 100000, seed = 1234)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho_pois</code></td>
<td>
<p>a <code>k_pois x k_pois</code> matrix of target correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>a vector of lambda (&gt; 0) constants for the Poisson variables (see <code>Poisson</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>the number of random numbers to generate in calculating the bound (default = 10000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used in random number generation (default = 1234)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the <code>k_pois x k_pois</code> intermediate correlation matrix for the Poisson variables
</p>


<h3>References</h3>

<p>Amatya A &amp; Demirtas H (2015). Simultaneous generation of multivariate mixed data with Poisson and normal marginals.
Journal of Statistical Computation and Simulation, 85(15): 3129-39. doi: <a href="http://doi.org/10.1080/00949655.2014.953534">10.1080/00949655.2014.953534</a>.
</p>
<p>Amatya A &amp; Demirtas H (2016). PoisNor: Simultaneous Generation of Multivariate Data with Poisson and Normal Marginals.
R package version 1.1. <a href="https://CRAN.R-project.org/package=PoisNor">https://CRAN.R-project.org/package=PoisNor</a>
</p>
<p>Demirtas H &amp; Hedeker D (2011). A practical way for computing approximate lower and upper correlation bounds.
American Statistician, 65(2): 104-109.
</p>
<p>Demirtas H, Hu Y, &amp; Allozi R (2017). PoisBinOrdNor: Data Generation with Poisson, Binary, Ordinal and Normal
Components. R package version 1.4. <a href="https://CRAN.R-project.org/package=PoisBinOrdNor">https://CRAN.R-project.org/package=PoisBinOrdNor</a>
</p>
<p>Demirtas H, Nordgren R, &amp; Allozi R (2017). PoisBinOrdNonNor: Generation of Up to Four Different
Types of Variables. R package version 1.3. <a href="https://CRAN.R-project.org/package=PoisBinOrdNonNor">https://CRAN.R-project.org/package=PoisBinOrdNonNor</a>
</p>
<p>Frechet M.  Sur les tableaux de correlation dont les marges sont donnees.  Ann. l'Univ. Lyon SectA.  1951;14:53-77.
</p>
<p>Hoeffding W. Scale-invariant correlation theory. In: Fisher NI, Sen PK, editors. The collected works of Wassily Hoeffding.
New York: Springer-Verlag; 1994. p. 57-107.
</p>
<p>Yahav I &amp; Shmueli G (2012). On Generating Multivariate Poisson Data in Management Science Applications. Applied Stochastic
Models in Business and Industry, 28(1): 91-102. doi: <a href="http://doi.org/10.1002/asmb.901">10.1002/asmb.901</a>.
</p>


<h3>See Also</h3>

<p><code>PoisNor-package</code>, <code>findintercorr_nb</code>,
<code>findintercorr_pois_nb</code>,
<code>findintercorr</code>, <code>rcorrvar</code>
</p>


</div>