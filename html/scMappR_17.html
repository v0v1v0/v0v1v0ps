<div class="container">

<table style="width: 100%;"><tr>
<td>pathway_enrich_internal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal - Pathway enrichment for cellWeighted_Foldchanges and bulk gene list</h2>

<h3>Description</h3>

<p>This function completes pathway enrichment of cellWeighted_Foldchanges and bulk gene list.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pathway_enrich_internal(
  DEGs,
  theSpecies,
  scMappR_vals,
  background_genes,
  output_directory,
  plot_names,
  number_genes = -9,
  newGprofiler = FALSE,
  toSave = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DEGs</code></td>
<td>
<p>Differentially expressed genes (gene_name, padj, log2fc).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theSpecies</code></td>
<td>
<p>Human, mouse, or a character that is compatible with g:ProfileR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scMappR_vals</code></td>
<td>
<p>cell weighted Fold-changes of differentially expressed genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_genes</code></td>
<td>
<p>A list of background genes to test against.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_directory</code></td>
<td>
<p>Path to the directory where files will be saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_names</code></td>
<td>
<p>Names of output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_genes</code></td>
<td>
<p>Number of genes to if there are many, many DEGs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newGprofiler</code></td>
<td>
<p>Whether to use g:ProfileR or gprofiler2 (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Internal: Pathway analysis of differentially expressed genes (DEGs) and cell weighted Fold-changes (cellWeighted_Foldchanges) for each cell-type. Returns .RData objects of differential analysis as well as plots of the top bulk pathways.
It is a wrapper for making barplots, bulk pathway analysis, and gProfiler_cellWeighted_Foldchange.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>BPs</code></td>
<td>
<p>Enriched biological pathways for each cell-type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TFs</code></td>
<td>
<p>Enriched transcription factors for each cell-type.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">

data(PBMC_example)
bulk_DE_cors &lt;- PBMC_example$bulk_DE_cors
bulk_normalized &lt;- PBMC_example$bulk_normalized
odds_ratio_in &lt;- PBMC_example$odds_ratio_in
case_grep &lt;- "_female"
control_grep &lt;- "_male"
max_proportion_change &lt;- 10
print_plots &lt;- FALSE
theSpecies &lt;- "human"
toOut &lt;- scMappR_and_pathway_analysis(bulk_normalized, odds_ratio_in, 
                                      bulk_DE_cors, case_grep = case_grep,
                                      control_grep = control_grep, rda_path = "", 
                                      max_proportion_change = 10, print_plots = TRUE, 
                                       plot_names = "tst1", theSpecies = "human", 
                                       output_directory = "tester",
                                       sig_matrix_size = 3000, up_and_downregulated = FALSE, 
                                       internet = FALSE)


</code></pre>


</div>