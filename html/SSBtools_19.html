<div class="container">

<table style="width: 100%;"><tr>
<td>DummyApply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a function to subsets defined by a dummy matrix</h2>

<h3>Description</h3>

<p>For each column, <code>i</code>,  of the matrix <code>x</code> of zeros and ones, the output value is equivalent to <code>FUN(y[x[, i] != 0])</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DummyApply(x, y, FUN = sum, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A (sparse) dummy matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of input values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>A function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>Parameter to <code>aggregate</code>. When <code>FALSE</code>, list output is ensured.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With a dummy <code>x</code> and <code>FUN = sum</code>, output is equivalent to <code>z = t(x) %*% y</code>.
</p>


<h3>Value</h3>

<p>Vector of output values or a matrix when multiple outputs from <code>FUN</code>  (see examples).
List output is also possible (ensured when <code>simplify = FALSE</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
z &lt;- SSBtoolsData("sprt_emp_withEU")
z$age[z$age == "Y15-29"] &lt;- "young"
z$age[z$age == "Y30-64"] &lt;- "old"

a &lt;- ModelMatrix(z, formula = ~age + geo, crossTable = TRUE)

cbind(as.data.frame(a$crossTable), 
      sum1 = (t(a$modelMatrix) %*% z$ths_per)[,1],
      sum2 = DummyApply(a$modelMatrix, z$ths_per, sum),
       max = DummyApply(a$modelMatrix, z$ths_per, max))
       
DummyApply(a$modelMatrix, z$ths_per, range)
DummyApply(a$modelMatrix, z$ths_per, range, simplify = FALSE)  

a$modelMatrix[, c(3, 5)] &lt;- 0   # Introduce two empty columns. 
DummyApply(a$modelMatrix, z$ths_per, function(x){ 
  c(min = min(x), 
    max = max(x), 
    mean = mean(x), 
    median = median(x), 
    n = length(x))})   
    
DummyApply(a$modelMatrix, z$ths_per, function(x) x, simplify = FALSE)          

</code></pre>


</div>