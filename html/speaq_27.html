<div class="container">

<table style="width: 100%;"><tr>
<td>ROIplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot NMR spectra, together with raw and grouped peaks</h2>

<h3>Description</h3>

<p>This function plots NMR spectra, peak plots and grouped peak plots all in figure for easy comparison.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ROIplot(
  Y.spec,
  X.ppm,
  ungrouped.peaks,
  grouped.peaks,
  ROI = NULL,
  ROI.ppm = NULL,
  roiWidth = 100,
  roiWidth.ppm = NULL,
  groupLabels = NULL,
  output = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y.spec</code></td>
<td>
<p>(required) The raw spectra in matrix format (1 sample per row) or numeric vector (in case of 1 spectrum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.ppm</code></td>
<td>
<p>(required) The vector with the ppm values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ungrouped.peaks</code></td>
<td>
<p>(required) The data resulting from peak detection with wavelets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouped.peaks</code></td>
<td>
<p>(required) The data after grouping (with PeakGrouper)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROI</code></td>
<td>
<p>If provided (with an index value, not a ppm value) only this region of interest will be plotted. (supply no ROI or ROI.ppm values, for the full spectrum, or specify only 1, either ROI or ROI.ppm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROI.ppm</code></td>
<td>
<p>If provided (a ppm value, not an index value) only this region of interest will be plotted. (supply no ROI or ROI.ppm values, for the full spectrum, or specify only 1, either ROI or ROI.ppm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roiWidth</code></td>
<td>
<p>The width of the ROI (region of interest) plot in index points/measurement points. The plot will span from ROI/ROI.ppm - roiWidth to ROI/ROI.ppm + roiWidth. (only supply roiWidth or roiWidth.ppm if needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roiWidth.ppm</code></td>
<td>
<p>The width of the ROI (region of interest) plot in ppm. The plot will span from ROI/ROI.ppm - roiWidth.ppm to ROI/ROI.ppm + roiWidth.ppm. (only supply roiWidth or roiWidth.ppm if needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupLabels</code></td>
<td>
<p>The vector with group labels (as factors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Whether to return a plot (default), or the individual ggplot objects (output = "ggObjects")</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a plot
</p>


<h3>Author(s)</h3>

<p>Charlie Beirnaert, <a href="mailto:charlie.beirnaert@uantwerpen.be">charlie.beirnaert@uantwerpen.be</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">subset &lt;- GetWinedata.subset()
# to reduce the example time we only select spectra 1 &amp; 2
subset.spectra = as.matrix(subset$Spectra)[1:2,] 
subset.ppm = as.numeric(subset$PPM)

test.peaks &lt;- getWaveletPeaks(Y.spec=subset.spectra, 
                              X.ppm=subset.ppm,
                              nCPU = 1) # nCPU set to 2 for the vignette build

test.grouped &lt;- PeakGrouper(Y.peaks = test.peaks)
                           
ROI.ppm &lt;- 4.9
roiWidth.ppm &lt;- 0.15

plots &lt;- ROIplot(Y.spec = subset.spectra,
                 X.ppm =subset.ppm, 
                 ungrouped.peaks = test.peaks,
                 grouped.peaks = test.grouped ,
                 ROI.ppm = ROI.ppm,
                 roiWidth.ppm = roiWidth.ppm , 
                 output = "ggObjects"
                 )

</code></pre>


</div>