<div class="container">

<table style="width: 100%;"><tr>
<td>BrierScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Brier score, its decomposition, and Brier skill score</h2>

<h3>Description</h3>

<p>Compute the Brier score (BS) and the components of its standard decompostion
with the two within-bin components described in Stephenson et al., (2008). It
also returns the bias-corrected decomposition of the BS (Ferro and Fricker, 
2012). BSS has the climatology as the reference forecast.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BrierScore(
  exp,
  obs,
  thresholds = seq(0.1, 0.9, 0.1),
  time_dim = "sdate",
  dat_dim = NULL,
  memb_dim = NULL,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>A vector or a numeric array with named dimensions. It should be 
the predicted probabilities which are within the range [0, 1] if memb_dim
doesn't exist. If it has memb_dim, the value should be 0 or 1, and the 
predicted probabilities will be computed by ensemble mean. The dimensions 
must at least have 'time_dim'. 
range [0, 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A numeric array with named dimensions of the binary observations 
(0 or 1). The dimension must be the same as 'exp' except memb_dim, which is
optional. If it has 'memb_dim', then the length must be 1. The length of 
'dat_dim' can be different from 'exp' if it has.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>A numeric vector used to bin the forecasts. The default 
value is <code>seq(0.1, 0.9, 0.1)</code>, which means that the bins are 
<code>[0, 0.1), [0.1, 0.2), ... [0.9, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of dimension along
which Brier score is computed. The default value is 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat_dim</code></td>
<td>
<p>A character string indicating the name of dataset dimension in
'exp' and 'obs'. The length of this dimension can be different between 
'exp' and 'obs'. The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string of the name of the member dimension in 
'exp' (and 'obs', optional). The function will do the ensemble mean 
over this dimension. If there is no member dimension, set NULL. The default
value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$rel</code></td>
<td>
<p>standard reliability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$res</code></td>
<td>
<p>standard resolution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$unc</code></td>
<td>
<p>standard uncertainty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bs</code></td>
<td>
<p>Brier score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bs_check_res</code></td>
<td>
<p>rel - res + unc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bss_res</code></td>
<td>
<p>res - rel / unc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$gres</code></td>
<td>
<p>generalized resolution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bs_check_gres</code></td>
<td>
<p>rel - gres + unc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bss_gres</code></td>
<td>
<p>gres - rel / unc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$rel_bias_corrected</code></td>
<td>
<p>bias - corrected rel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$gres_bias_corrected</code></td>
<td>
<p>bias - corrected gres</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$unc_bias_corrected</code></td>
<td>
<p>bias - corrected unc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bss_bias_corrected</code></td>
<td>
<p>gres_bias_corrected - rel_bias_corrected / unc_bias_corrected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$nk</code></td>
<td>
<p>number of forecast in each bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$fkbar</code></td>
<td>
<p>average probability of each bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$okbar</code></td>
<td>
<p>relative frequency that the observed event occurred</p>
</td>
</tr>
</table>
<p>The data type and dimensions of the items depend on if the input 'exp' and 
'obs' are:<br>
(a) Vectors<br>
(b) Arrays with 'dat_dim' specified<br>
(c) Arrays with no 'dat_dim' specified<br>
Items 'rel', 'res', 'unc', 'bs', 'bs_check_res', 'bss_res', 'gres', 
'bs_check_gres', 'bss_gres', 'rel_bias_corrected', 'gres_bias_corrected', 
'unc_bias_corrected', and 'bss_bias_corrected' are (a) a number (b) an array
with dimensions c(nexp, nobs, all the rest dimensions in 'exp' and 'obs' 
except 'time_dim' and 'memb_dim') (c) an array with dimensions of
'exp' and 'obs' except 'time_dim' and 'memb_dim'<br>
Items 'nk', 'fkbar', and 'okbar' are (a) a vector of length of bin number 
determined by 'threshold' (b) an array with dimensions c(nexp, nobs, 
no. of bins, all the rest dimensions in 'exp' and 'obs' except 'time_dim' and
'memb_dim') (c) an array with dimensions c(no. of bin, all the rest dimensions
in 'exp' and 'obs' except 'time_dim' and 'memb_dim')
</p>


<h3>References</h3>

<p>Wilks (2006) Statistical Methods in the Atmospheric Sciences.<br>
Stephenson et al. (2008). Two extra components in the Brier score decomposition. 
Weather and Forecasting, 23: 752-757.<br>
Ferro and Fricker (2012). A bias-corrected decomposition of the BS. 
Quarterly Journal of the Royal Meteorological Society, DOI: 10.1002/qj.1924.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Inputs are vectors
exp &lt;- runif(10)
obs &lt;- round(exp)
x &lt;- BrierScore(exp, obs)

# Inputs are arrays
example(Load)
clim &lt;- Clim(sampleData$mod, sampleData$obs)
ano_exp &lt;- Ano(sampleData$mod, clim$clim_exp)
ano_obs &lt;- Ano(sampleData$obs, clim$clim_obs)
bins_ano_exp &lt;- ProbBins(ano_exp, thr = c(1/3, 2/3))
bins_ano_obs &lt;- ProbBins(ano_obs, thr = c(1/3, 2/3))
res &lt;- BrierScore(bins_ano_exp, MeanDims(bins_ano_obs, 'member'), memb_dim = 'member') 

</code></pre>


</div>