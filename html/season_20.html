<div class="container">

<table style="width: 100%;"><tr>
<td>nscosinor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-stationary Cosinor</h2>

<h3>Description</h3>

<p>Decompose a time series using a non-stationary cosinor for the seasonal
pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nscosinor(
  data,
  response,
  cycles,
  niters = 1000,
  burnin = 500,
  tau,
  lambda = 1/12,
  div = 50,
  monthly = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycles</code></td>
<td>
<p>vector of cycles in units of time, e.g., for a six and twelve
month pattern <code>cycles=c(6,12)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niters</code></td>
<td>
<p>total number of MCMC samples (default=1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of MCMC samples discarded as a burn-in (default=500).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>vector of smoothing parameters, tau[1] for trend, tau[2] for 1st
seasonal parameter, tau[3] for 2nd seasonal parameter, etc. Larger values of
tau allow more change between observations and hence a greater potential
flexibility in the trend and season.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>distance between observations (lambda=1/12 for monthly data,
default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>div</code></td>
<td>
<p>divisor at which MCMC sample progress is reported (default=50).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monthly</code></td>
<td>
<p>TRUE for monthly data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Statistical significance level used by the confidence
intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This model is designed to decompose an equally spaced time series into a
trend, season(s) and noise. A seasonal estimate is estimated as
<code class="reqn">s_t=A_t\cos(\omega_t-P_t)</code>, where <em>t</em> is time, <code class="reqn">A_t</code> is the
non-stationary amplitude, <code class="reqn">P_t</code> is the non-stationary phase and
<code class="reqn">\omega_t</code> is the frequency.
</p>
<p>A non-stationary seasonal pattern is one that changes over time, hence this
model gives potentially very flexible seasonal estimates.
</p>
<p>The frequency of the seasonal estimate(s) are controlled by <code>cycle</code>.
The cycles should be specified in units of time. If the data is monthly,
then setting <code>lambda=1/12</code> and <code>cycles=12</code> will fit an annual
seasonal pattern. If the data is daily, then setting <code>lambda=</code>
<code>1/365.25</code> and <code>cycles=365.25</code> will fit an annual seasonal
pattern. Specifying <code>cycles=</code> <code>c(182.6,365.25)</code> will fit two
seasonal patterns, one with a twice-annual cycle, and one with an annual
cycle.
</p>
<p>The estimates are made using a forward and backward sweep of the Kalman
filter. Repeated estimates are made using Markov chain Monte Carlo (MCMC).
For this reason the model can take a long time to run. To give stable
estimates a reasonably long sample should be used (<code>niters</code>), and the
possibly poor initial estimates should be discarded (<code>burnin</code>).
</p>


<h3>Value</h3>

<p>Returns an object of class “nsCosinor” with the following
parts: </p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the original call to the nscosinor function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>the year and month for monthly data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>mean trend
and 95% confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>season</code></td>
<td>
<p>mean season(s) and 95%
confidence interval(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oseason</code></td>
<td>
<p>overall season(s) and 95%
confidence interval(s). This will be the same as <code>season</code> if there is
only one seasonal cycle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>fitted values and 95% confidence
interval, based on trend + season(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals based on
mean trend and season(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the length of the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>MCMC chains (of class mcmc) of variance estimates: standard
error for overall noise (std.error), standard error for season(s)
(std.season), phase(s) and amplitude(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycles</code></td>
<td>
<p>vector of cycles in
units of time.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Adrian Barnett <a href="mailto:a.barnett@qut.edu.au">a.barnett@qut.edu.au</a>
</p>


<h3>References</h3>

<p>Barnett, A.G., Dobson, A.J. (2010) <em>Analysing Seasonal
Health Data</em>. Springer.
</p>
<p>Barnett, A.G., Dobson, A.J. (2004) Estimating trends and seasonality in
coronary heart disease <em>Statistics in Medicine</em>. 23(22) 3505–23.
</p>


<h3>See Also</h3>

<p><code>plot.nsCosinor</code>, <code>summary.nsCosinor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(CVD)
# model to fit an annual pattern to the monthly cardiovascular disease data
f = c(12)
tau = c(10,50)
## Not run: res12 = nscosinor(data=CVD, response='adj', cycles=f, niters=5000,
         burnin=1000, tau=tau)
summary(res12)
plot(res12)

## End(Not run)


</code></pre>


</div>