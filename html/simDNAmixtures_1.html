<div class="container">

<table style="width: 100%;"><tr>
<td>allele_specific_stutter_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stutter model where the expected stutter rate depends on the allele and locus</h2>

<h3>Description</h3>

<p>Stutter model where the expected stutter rate depends on the allele and locus
</p>


<h3>Usage</h3>

<pre><code class="language-R">allele_specific_stutter_model(stutter_types, size_regression)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stutter_types</code></td>
<td>
<p>List. See stutter_type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_regression</code></td>
<td>
<p>Function, see read_size_regression.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When a pg_model is constructed (see gamma_model), a stutter model can optionally be applied. The allele specific stutter model is commonly used with a log normal model. The expected stutter ratio for a parent allele at a locus is obtained from a linear regression of observed stutter ratios against allele length. For some loci or alleles the linear model may not be satisfactory. To override the expected stutter rates for specific alleles, a list of exceptions can be used. See stutter_type for more detail.
</p>


<h3>Value</h3>

<p>Object of class <code>stutter_model</code> to be used by e.g. log_normal_model.
</p>


<h3>See Also</h3>

<p>global_stutter_model for a stutter model where the expected stutter ratio does not depend on the locus or parent allele.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># we will define an allele specific stutter model for back stutter only

# prepare stutter regression
filename_bs_regression &lt;- system.file("extdata",
"GlobalFiler_Stutter_3500.txt",package = "simDNAmixtures")
bs_regression &lt;- read_stutter_regression(filename_bs_regression)

# prepare exceptions, i.e. where does the regression not apply?
filename_bs_exceptions &lt;- system.file("extdata",
"GlobalFiler_Stutter_Exceptions_3500.csv",package = "simDNAmixtures")
bs_exceptions &lt;- read_stutter_exceptions(filename_bs_exceptions)

# prepare a stutter type
backstutter &lt;- stutter_type(name = "BackStutter", delta = -1,
                            stutter_regression = bs_regression,
                            stutter_exceptions = bs_exceptions)

# assign stutter model
size_regression &lt;- read_size_regression(system.file("extdata",
"GlobalFiler_SizeRegression.csv",package = "simDNAmixtures"))
bs_model &lt;- allele_specific_stutter_model(list(backstutter), size_regression)
bs_model
</code></pre>


</div>