<div class="container">

<table style="width: 100%;"><tr>
<td>plot_loadings_annot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the gene by celltype loadings for a factor</h2>

<h3>Description</h3>

<p>Plot the gene by celltype loadings for a factor
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_loadings_annot(
  container,
  factor_select,
  use_sig_only = FALSE,
  nonsig_to_zero = FALSE,
  annot = "none",
  pathways = NULL,
  sim_de_donor_group = NULL,
  sig_thresh = 0.05,
  display_genes = FALSE,
  gene_callouts = FALSE,
  callout_n_gene_per_ctype = 5,
  callout_ctypes = NULL,
  specific_callouts = NULL,
  le_set_callouts = NULL,
  le_set_colormap = NULL,
  le_set_num_per = 5,
  show_le_legend = FALSE,
  show_xlab = TRUE,
  show_var_explained = TRUE,
  clust_method = "median",
  h_w = NULL,
  reset_other_factor_plots = FALSE,
  draw_plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>container</code></td>
<td>
<p>environment Project container that stores sub-containers
for each cell type as well as results and plots from all analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_select</code></td>
<td>
<p>numeric The factor to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_sig_only</code></td>
<td>
<p>logical If TRUE, includes only significant genes
from jackstraw in the heatmap. If FALSE, includes all the variable genes.
(default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonsig_to_zero</code></td>
<td>
<p>logical If TRUE, makes the loadings of all nonsignificant genes 0
(default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot</code></td>
<td>
<p>character If set to "pathways" then creates an adjacent heatmap
showing which genes are in which pathways. If set to "sig_genes" then creates
an adjacent heatmap showing which genes were significant from jackstraw. If
set to "none" no adjacent heatmap is plotted. (default="none")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathways</code></td>
<td>
<p>character Gene sets to plot if annot is set to "pathways"
(default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_de_donor_group</code></td>
<td>
<p>numeric To plot the ground truth significant genes from a
simulation next to the heatmap, put the number of the donor group that corresponds to
the factor being plotted (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_thresh</code></td>
<td>
<p>numeric Pvalue significance threshold to use. If use_sig_only is
TRUE the threshold is used as a cutoff for genes to include. If annot is "sig_genes"
this value is used in the gene significance colormap as a minimum threshold. (default=0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display_genes</code></td>
<td>
<p>logical If TRUE, displays the names of gene names (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_callouts</code></td>
<td>
<p>logical If TRUE, then adds gene callout annotations to the heatmap
(default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callout_n_gene_per_ctype</code></td>
<td>
<p>numeric To use if gene_callouts is TRUE. Sets the number
of largest magnitude significant genes from each cell type to include in gene callouts.
(default=5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callout_ctypes</code></td>
<td>
<p>character To use if gene_callouts is TRUE. Specifies which cell types
to get gene callouts for. If NULL, then gets gene callouts for largest magnitude significant
genes for all cell types. (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specific_callouts</code></td>
<td>
<p>character A vector of gene names to show callouts for (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>le_set_callouts</code></td>
<td>
<p>character Pass a vector of gene set names to show leading edge genes
for a select set of gene sets (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>le_set_colormap</code></td>
<td>
<p>character A named vector with names as gene sets and values as colors.
If NULL, then selects first n colors of Set3 color palette. (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>le_set_num_per</code></td>
<td>
<p>numeric The number of leading edge genes to show for each gene set (default=5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_le_legend</code></td>
<td>
<p>logical Set to TRUE to show the color map legend for leading edge genes (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_xlab</code></td>
<td>
<p>logical If TRUE, displays the xlabel 'genes' (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_var_explained</code></td>
<td>
<p>logical If TRUE then shows an anotation with the explained variance
for each cell type (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust_method</code></td>
<td>
<p>character The hclust method to use for clustering rows (default='median')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_w</code></td>
<td>
<p>numeric Vector specifying height and width (defualt=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset_other_factor_plots</code></td>
<td>
<p>logical Set to TRUE to set all other loadings plots to NULL.
Useful if run get_all_lds_factor_plots but then only want to show one or two plots. (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_plot</code></td>
<td>
<p>logical Set to TRUE to show the plot. Plot is stored regardless. (default=TRUE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The project container with a heatmap of loadings for one factor put in container$plots$all_lds_plots.
The legend for the heatmap is put in container$plots$all_legends. Use draw(&lt;hmap obj&gt;,annotation_legend_list = &lt;hmap legend obj&gt;)
to re-render the plot with legend.
</p>


<h3>Examples</h3>

<pre><code class="language-R">test_container &lt;- plot_loadings_annot(test_container, 1, display_genes=FALSE,
show_var_explained = TRUE)
</code></pre>


</div>