<div class="container">

<table style="width: 100%;"><tr>
<td>QM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile Mapping method</h2>

<h3>Description</h3>

<p>Perform an univariate bias correction of X0 with respect to Y0
</p>


<h3>Details</h3>

<p>Correction is applied margins by margins.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>distX0</code></dt>
<dd>
<p>[ROOPSD distribution or a list of them] Describe the law of
each margins. A list permit to use different laws for each
margins. Default is ROOPSD::rv_histogram.</p>
</dd>
<dt><code>distY0</code></dt>
<dd>
<p>[ROOPSD distribution or a list of them] Describe the law of
each margins. A list permit to use different laws for each
margins. Default is ROOPSD::rv_histogram.</p>
</dd>
<dt><code>n_features</code></dt>
<dd>
<p>[integer] Numbers of features</p>
</dd>
<dt><code>tol</code></dt>
<dd>
<p>[double] Floatting point tolerance</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-QM-new"><code>QM$new()</code></a>
</p>
</li>
<li> <p><a href="#method-QM-fit"><code>QM$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-QM-predict"><code>QM$predict()</code></a>
</p>
</li>
<li> <p><a href="#method-QM-clone"><code>QM$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-QM-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new QM object.
</p>


<h5>Usage</h5>

<div class="r"><pre>QM$new(distX0 = ROOPSD::rv_histogram, distY0 = ROOPSD::rv_histogram, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>distX0</code></dt>
<dd>
<p>[ROOPSD distribution or a list of them] Describe the law of
model</p>
</dd>
<dt><code>distY0</code></dt>
<dd>
<p>[ROOPSD distribution or a list of them] Describe the law of
observations</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>[] kwargsX0 or kwargsY0, arguments passed to distX0 and distY0</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'QM' object.
</p>


<hr>
<a id="method-QM-fit"></a>



<h4>Method <code>fit()</code>
</h4>

<p>Fit the bias correction method
</p>


<h5>Usage</h5>

<div class="r"><pre>QM$fit(Y0 = NULL, X0 = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Y0</code></dt>
<dd>
<p>[matrix: n_samples * n_features] Observations in calibration</p>
</dd>
<dt><code>X0</code></dt>
<dd>
<p>[matrix: n_samples * n_features] Model in calibration</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>NULL
</p>


<hr>
<a id="method-QM-predict"></a>



<h4>Method <code>predict()</code>
</h4>

<p>Predict the correction
</p>


<h5>Usage</h5>

<div class="r"><pre>QM$predict(X0)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X0</code></dt>
<dd>
<p>[matrix: n_samples * n_features or NULL] Model in calibration</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>[matrix] Return the corrections of X0
</p>


<hr>
<a id="method-QM-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>QM$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>References</h3>

<p>Panofsky, H. A. and Brier, G. W.: Some applications of statistics
to meteorology, Mineral Industries Extension Services, College of
Mineral Industries, Pennsylvania State University, 103 pp., 1958.
</p>
<p>Wood, A. W., Leung, L. R., Sridhar, V., and Lettenmaier, D. P.:
Hydrologic Implications of Dynamical and Statistical Approaches
to Downscaling Climate Model Outputs, Clim. Change, 62, 189–216,
https://doi.org/10.1023/B:CLIM.0000013685.99609.9e, 2004.
</p>
<p>Déqué, M.: Frequency of precipitation and temperature extremes
over France in an anthropogenic scenario: Model results and
statistical correction according to observed values, Global
Planet. Change, 57, 16–26,
https://doi.org/10.1016/j.gloplacha.2006.11.030, 2007.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Three bivariate random variables (rnorm and rexp are inverted between ref
## and bias)
XY = SBCK::dataset_gaussian_exp_2d(2000)
X0 = XY$X0 ## Biased in calibration period
Y0 = XY$Y0 ## Reference in calibration period

## Bias correction
## Step 1 : construction of the class QM 
qm = SBCK::QM$new() 
## Step 2 : Fit the bias correction model
qm$fit( Y0 , X0 )
## Step 3 : perform the bias correction, Z0 is the correction of
## X0 with respect to the estimation of Y0
Z0 = qm$predict(X0)

# ## But in fact the laws are known, we can fit parameters:
distY0 = list( ROOPSD::Exponential , ROOPSD::Normal )
distX0 = list( ROOPSD::Normal , ROOPSD::Exponential )
qm_fix = SBCK::QM$new( distY0 = distY0 , distX0 = distX0 )
qm_fix$fit( Y0 , X0 )
Z0 = qm_fix$predict(X0) 
</code></pre>


</div>