<div class="container">

<table style="width: 100%;"><tr>
<td>sr_equality_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Paired test for equality of Sharpe ratio</h2>

<h3>Description</h3>

<p>Performs a hypothesis test of equality of Sharpe ratios of p assets
given paired observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sr_equality_test(X,type=c("chisq","F","t"),
                 alternative=c("two.sided","less","greater"),
                 contrasts=NULL,
                 vcov.func=vcov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code class="reqn">n \times p</code> matrix of paired observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>which approximation to use. <code>"chisq"</code> is preferred when
the returns are non-normal, but the approximation is asymptotic.
the <code>"t"</code> test is only supported when <code class="reqn">k = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or
<code>"less"</code>. You can specify just the initial letter.
This is only relevant for the <code>"t"</code> test.
<code>"greater"</code> corresponds to <code class="reqn">H_a: E s &gt; 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an <code class="reqn">k \times p</code> matrix of the contrasts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.func</code></td>
<td>
<p>a function which takes a model of class lm (one of
the form x ~ 1), and produces a variance-covariance matrix.
The default is <code>vcov</code>, which produces a 'vanilla'
estimate of covariance. Other sensible options are
<code>vcovHAC</code> from the <code>sandwich</code> package.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given <code class="reqn">n</code> <em>i.i.d.</em> observations of the excess returns of
<code class="reqn">p</code> strategies, we test
</p>
<p style="text-align: center;"><code class="reqn">H_0: \frac{\mu_i}{\sigma_i} = \frac{\mu_j}{\sigma_j}, 1 \le i &lt; j \le p</code>
</p>

<p>using the method of Wright, et. al. 
</p>
<p>More generally, a matrix of constrasts, <code class="reqn">E</code> can be given, and we can
test
</p>
<p style="text-align: center;"><code class="reqn">H_0: E s = 0,</code>
</p>

<p>where <code class="reqn">s</code> is the vector of Sharpe ratios of the <code class="reqn">p</code> strategies.
</p>
<p>When <code class="reqn">E</code> consists of a single row (a single contrast), as is the
case when the default contrasts are used and only two strategies are
compared, then an approximate t-test can be performed against the
alternative hypothesis <code class="reqn">H_a: E s &gt; 0</code>
</p>
<p>Both chi-squared and F- approximations are supported; the former is
described by Wright. <em>et. al.</em>, the latter by Leung and Wong.
</p>
<p>See ‘The Sharpe Ratio: Statistics and Applications’,
section 3.3.1.
</p>


<h3>Value</h3>

<p>Object of class <code>htest</code>, a list of the test statistic,
the size of <code>X</code>, and the <code>method</code> noted.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Sharpe, William F. "Mutual fund performance." Journal of business (1966): 119-138.
<a href="https://ideas.repec.org/a/ucp/jnlbus/v39y1965p119.html">https://ideas.repec.org/a/ucp/jnlbus/v39y1965p119.html</a>
</p>
<p>Wright, J. A., Yam, S. C. P., and Yung, S. P. "A note on the test for the
equality of multiple Sharpe ratios and its application on the evaluation
of iShares." J. Risk. to appear. 
<a href="https://www.risk.net/journal-risk/2340067/test-equality-multiple-sharpe-ratios">https://www.risk.net/journal-risk/2340067/test-equality-multiple-sharpe-ratios</a>
</p>
<p>Leung, P.-L., and Wong, W.-K. "On testing the equality of multiple Sharpe ratios, with 
application on the evaluation of iShares." J. Risk 10, no. 3 (2008): 15–30.
<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=907270">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=907270</a>
</p>
<p>Memmel, C. "Performance hypothesis testing with the Sharpe ratio." Finance
Letters 1 (2003): 21–23.
</p>
<p>Ledoit, O., and Wolf, M. "Robust performance hypothesis testing with the 
Sharpe ratio." Journal of Empirical Finance 15, no. 5 (2008): 850-859.
doi: <a href="https://doi.org/10.1016/j.jempfin.2008.03.002">10.1016/j.jempfin.2008.03.002</a>
</p>
<p>Lo, Andrew W. "The statistics of Sharpe ratios." Financial Analysts Journal 58, no. 4 
(2002): 36-52. <a href="https://www.ssrn.com/paper=377260">https://www.ssrn.com/paper=377260</a>
</p>
<p>Pav, S. E. "The Sharpe Ratio: Statistics and Applications." CRC Press, 2021.
</p>


<h3>See Also</h3>

<p><code>sr_test</code>
</p>
<p>Other sr: 
<code>as.sr()</code>,
<code>confint.sr()</code>,
<code>dsr()</code>,
<code>is.sr()</code>,
<code>plambdap()</code>,
<code>power.sr_test()</code>,
<code>predint()</code>,
<code>print.sr()</code>,
<code>reannualize()</code>,
<code>se()</code>,
<code>sr_test()</code>,
<code>sr_unpaired_test()</code>,
<code>sr_vcov()</code>,
<code>sr</code>,
<code>summary.sr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># under the null 
set.seed(1234)
rv &lt;- sr_equality_test(matrix(rnorm(500*5),ncol=5))

# under the alternative (but with identity covariance)
ope &lt;- 253
nyr &lt;- 10
nco &lt;- 5
set.seed(909)
rets &lt;- 0.01 * sapply(seq(0,1.7/sqrt(ope),length.out=nco),
  function(mu) { rnorm(ope*nyr,mean=mu,sd=1) })
rv &lt;- sr_equality_test(rets)

# using real data
if (require(xts)) {
 data(stock_returns)
 pvs &lt;- sr_equality_test(stock_returns)
}

# test for uniformity
pvs &lt;- replicate(1024,{ x &lt;- sr_equality_test(matrix(rnorm(400*5),400,5),type="chisq")
                       x$p.value })
plot(ecdf(pvs))
abline(0,1,col='red') 


if (require(sandwich)) {
  set.seed(as.integer(charToRaw("0b2fd4e9-3bdf-4e3e-9c75-25c6d18c331f")))
  n.manifest &lt;- 10
  n.latent &lt;- 4
  n.day &lt;- 1024
  snr &lt;- 0.95
  la_A &lt;- matrix(rnorm(n.day*n.latent),ncol=n.latent)
  la_B &lt;- matrix(runif(n.latent*n.manifest),ncol=n.manifest)
  latent.rets &lt;- la_A %*% la_B
  noise.rets &lt;- matrix(rnorm(n.day*n.manifest),ncol=n.manifest)
  some.rets &lt;- snr * latent.rets + sqrt(1-snr^2) * noise.rets
  # naive vcov
  pvs0 &lt;- sr_equality_test(some.rets)
  # HAC vcov
  pvs1 &lt;- sr_equality_test(some.rets,vcov.func=vcovHAC)
  # more elaborately:
  pvs &lt;- sr_equality_test(some.rets,vcov.func=function(amod) {
	vcovHAC(amod,prewhite=TRUE) })
}


</code></pre>


</div>