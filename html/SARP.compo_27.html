<div class="container">

<table style="width: 100%;"><tr>
<td>equivalence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utility function to obtain p-value for equivalence tests on
individual ratios
</h2>

<h3>Description</h3>

<p>These functions can be used in the functions to perform analysis on
all pairwise ratios of a compositional dataset, using equivalence
tests to ensure edge existence  
</p>


<h3>Usage</h3>

<pre><code class="language-R">equiv.fpc( d, variable, v.X, var.equal = TRUE, Delta = 0.5,
           pred = FALSE, ... ) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>The data frame that contains the ratio to test, and all variables of
the original data frame that where not used as compositional data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>

<p>A length-one character vector containing the names of the variable
corresponding to the ratio (or log-ratio) to test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.X</code></td>
<td>

<p>The <strong>name</strong> of the explanatory (independant, predictor)
variable. This variable should be a factor for <code>equiv.fpc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>

<p>For <code>equiv.fpc</code>, shall we assume that variance are equals in
the two groups (<code>TRUE</code>, the default) or not
(<code>FALSE</code>).  Same as in <code>t.test</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>

<p>The value giving the positive limit of the equivalence region. For
symmetry reasons, the equivalence region will be [-Delta, Delta].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>

<p>If <code>FALSE</code>, a standard equivalence test of the mean difference
is done.
</p>
<p>If <code>TRUE</code>, the p-value is computed assuming the variance of the
difference, and not the difference of the means. This allows to take
into account the sampling variability in the interval width,
avoiding (with large sample sizes) too narrow intervals
to fit in the equivalence region when large inter-sample variability
does not allow to consider genes as reliable reference genes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are only wrapper to some commonly used equivalence
tests.
</p>
<p>The basic idea underlying equivalence tests is to try to reject the
null hypothesis that the difference between the two conditions is
higher (in absolute value) than a predefined, fixed, value, given by
<code>Delta</code>. Consequently, significant tests will mean that the edge
between the two tested nodes should be kept, whereas non-significant
tests will mean that the existence of the edge is uncertain.
</p>
<p>As a consequence, conversion of the p-value matrix to graphs should be
made using the complement of the graph, and the analysis of the graph
should be made in terms of cliques instead of disjoint subgraphs. See
example for an illustration.
</p>


<h3>Value</h3>

<p> These function returns the <em>p</em>-value from the corresponding test.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Curis (<a href="mailto:emmanuel.curis@parisdescartes.fr">emmanuel.curis@parisdescartes.fr</a>)
</p>


<h3>See Also</h3>

<p><code>student.fpc</code> for a, more usual, approach using difference
tests.
</p>
<p><code>creer.Mp</code> to use these functions to create a matrix of
<em>p</em>-values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">   # load the reference genes data set
   data( generef )

   # compute equivalence test of all ratios
   #  Genes are in column 3 to 35
   #  Only the first 10 genes are used here, for speed reasons
   #  Equivalence is defined as a change lower than 0.5 Cq (Ã— 1.41)
   #  Values are expressed as Cq : already in log
   Mp &lt;- creer.Mp( generef, names( generef )[ 3:13 ], log = TRUE,
                   f.p = equiv.fpc, Delta = 0.5, v.X = 'Group' )

   # Make the graph from it, and plot it
   #  Threshold is set at 0.15, for 10 nodes...
   #  (using the complement, to keep edges with p &lt; threshold only )
   plot( grf.Mp( Mp, p = 0.15, complement = TRUE ) )
   #  =&gt; there is a single clique, of 3 genes : HPRT1, B2M, HSP90AB1
   #     only these three genes are "proved" to have the same variation
</code></pre>


</div>