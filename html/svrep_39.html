<div class="container">

<table style="width: 100%;"><tr>
<td>stack_replicate_designs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stack replicate designs, combining data and weights into a single object</h2>

<h3>Description</h3>

<p>Stack replicate designs: combine rows of data, rows of replicate weights, and the respective full-sample weights.
This can be useful when comparing estimates before and after a set of adjustments made to the weights.
Another more delicate application is when combining sets of replicate weights from multiple years of data for a survey, although this must be done carefully based on guidance from a data provider.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stack_replicate_designs(..., .id = "Design_Name")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Replicate-weights survey design objects to combine. These can be supplied in one of two ways. <br></p>

<ul>
<li>
<p> Option 1 - A series of design objects, for example <code>'adjusted' = adjusted_design, 'orig' = orig_design</code>.
</p>
</li>
<li>
<p> Option 2 - A list object containing design objects, for example  <code>list('nr' = nr_adjusted_design, 'ue' = ue_adjusted_design)</code>.
</p>
</li>
</ul>
<p>All objects must have the same specifications for <code>type</code>, <code>rho</code>,
<code>mse</code>, <code>scales</code>, and <code>rscales</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.id</code></td>
<td>
<p>A single character value, which becomes the name of a new column of identifiers
created in the output data to link each row to the design from which it was taken. <br>
The labels used for the identifiers are taken from named arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A replicate-weights survey design object, with class <code>svyrep.design</code> and <code>svyrep.stacked</code>.
The resulting survey design object always has its value of <code>combined.weights</code> set to <code>TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load example data, creating a replicate design object
suppressPackageStartupMessages(library(survey))
data(api)

dclus1 &lt;- svydesign(id=~dnum, weights=~pw, data=apiclus1, fpc=~fpc)
dclus1$variables$response_status &lt;- sample(x = c("Respondent", "Nonrespondent",
                                                 "Ineligible", "Unknown eligibility"),
                                           size = nrow(dclus1),
                                           replace = TRUE)
orig_rep_design &lt;- as.svrepdesign(dclus1)

# Adjust weights for cases with unknown eligibility
ue_adjusted_design &lt;- redistribute_weights(
    design = orig_rep_design,
    reduce_if = response_status %in% c("Unknown eligibility"),
    increase_if = !response_status %in% c("Unknown eligibility"),
    by = c("stype")
)

# Adjust weights for nonresponse
nr_adjusted_design &lt;- redistribute_weights(
    design = ue_adjusted_design,
    reduce_if = response_status %in% c("Nonrespondent"),
    increase_if = response_status == "Respondent",
    by = c("stype")
)

# Stack the three designs, using any of the following syntax options
stacked_design &lt;- stack_replicate_designs(orig_rep_design, ue_adjusted_design, nr_adjusted_design,
                                          .id = "which_design")
stacked_design &lt;- stack_replicate_designs('original' = orig_rep_design,
                                          'unknown eligibility adjusted' = ue_adjusted_design,
                                          'nonresponse adjusted' = nr_adjusted_design,
                                          .id = "which_design")
list_of_designs &lt;- list('original' = orig_rep_design,
                        'unknown eligibility adjusted' = ue_adjusted_design,
                        'nonresponse adjusted' = nr_adjusted_design)
stacked_design &lt;- stack_replicate_designs(list_of_designs, .id = "which_design")
</code></pre>


</div>