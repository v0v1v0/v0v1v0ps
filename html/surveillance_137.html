<div class="container">

<table style="width: 100%;"><tr>
<td>fanplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fan Plot of Forecast Distributions</h2>

<h3>Description</h3>

<p>The <code>fanplot()</code> function in <span class="pkg">surveillance</span> wraps functionality of
the dedicated <a href="https://CRAN.R-project.org/package=fanplot"><span class="pkg">fanplot</span></a> package, employing a different default style
and optionally adding point predictions and observed values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fanplot(quantiles, probs, means = NULL, observed = NULL, start = 1,
        fan.args = list(), means.args = list(), observed.args = list(),
        key.args = NULL, xlim = NULL, ylim = NULL, log = "",
        xlab = "Time", ylab = "No. infected", add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>

<p>a time x <code>probs</code> matrix of forecast quantiles at each time point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>numeric vector of probabilities with values between 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>

<p>(optional) numeric vector of point forecasts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>

<p>(optional) numeric vector of observed values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>time index (x-coordinate) of the first prediction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fan.args</code></td>
<td>

<p>a list of graphical parameters for the <code>fan</code>,
e.g., to employ a different <code>colorRampPalette</code> as
<code>fan.col</code>, or to enable contour lines via <code>ln</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means.args</code></td>
<td>

<p>a list of graphical parameters for <code>lines</code>
to modify the plotting style of the <code>means</code>.
The default is a white line within the fan.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.args</code></td>
<td>

<p>a list of graphical parameters for <code>lines</code>
to modify the plotting style of the <code>observed</code> values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.args</code></td>
<td>

<p>if a list, a color key (in <code>fan()</code>'s
<code>"boxfan"</code>-style) is added to the fan chart. The list may
include positioning parameters <code>start</code> (the x-position) and
<code>ylim</code> (the y-range of the color key), <code>space</code> to modify
the width of the boxfan, and <code>rlab</code> to modify the labels.
An alternative way of labeling the quantiles is
via the argument <code>ln</code> in <code>fan.args</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim,ylim</code></td>
<td>

<p>axis ranges.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>a character string specifying which axes are to be logarithmic,
e.g., <code>log="y"</code> (see <code>plot.default</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>

<p>axis labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical indicating if the fan plot should be added to an existing plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments are passed to <code>plot.default</code>.
For instance, <code>panel.first</code> could be used to initialize the
plot with <code>grid(nx=NA, ny=NULL)</code> lines.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>NULL</code> (invisibly), with the side effect of drawing a fan chart.
</p>


<h3>Author(s)</h3>

<p>Sebastian Meyer
</p>


<h3>See Also</h3>

<p>the underlying <code>fan</code> function in package
<a href="https://CRAN.R-project.org/package=fanplot"><span class="pkg">fanplot</span></a>.
The function is used in <code>plot.oneStepAhead</code> and
<code>plot.hhh4sims</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## artificial data example to illustrate the graphical options
if (requireNamespace("fanplot")) {
    means &lt;- c(18, 19, 20, 25, 26, 35, 34, 25, 19)
    y &lt;- rlnorm(length(means), log(means), 0.5)
    quantiles &lt;- sapply(1:99/100, qlnorm, log(means), seq(.5,.8,length.out=length(means)))
    
    ## default style with point predictions, color key and log-scale
    fanplot(quantiles = quantiles, probs = 1:99/100, means = means,
            observed = y, key.args = list(start = 1, space = .3), log = "y")
    
    ## with contour lines instead of a key, and different colors
    pal &lt;- colorRampPalette(c("darkgreen", "gray93"))
    fanplot(quantiles = quantiles, probs = 1:99/100, observed = y,
            fan.args = list(fan.col = pal, ln = c(5,10,25,50,75,90,95)/100),
            observed.args = list(type = "b", pch = 19))
}
</code></pre>


</div>