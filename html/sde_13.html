<div class="container">

<table style="width: 100%;"><tr>
<td>dcSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pedersen's simulated transition density</h2>

<h3>Description</h3>

<p>Simulated transition density <code class="reqn">X(t) | X(t_0) = x_0</code>X(t) | X(t0) = x0 of a diffusion process based on
Pedersen's method.</p>


<h3>Usage</h3>

<pre><code class="language-R">dcSim(x0, x, t, d, s, theta, M=10000, N=10, log=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>the value of the  process at time <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>value in which to evaluate the conditional density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>lag or time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>parameter of the process; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, probabilities <code class="reqn">p</code> are given as <code class="reqn">\log(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>drift coefficient as a function; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>diffusion coefficient as a function; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of subintervals; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of Monte Carlo simulations, which should be an even number; see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns the value of the conditional density of
<code class="reqn">X(t) | X(0) = x_0</code> at point <code>x</code>. 
</p>
<p>The functions <code>d</code> and <code>s</code>, must be functions of <code>t</code>, 
<code>x</code>, and <code>theta</code>.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Stefano Maria Iacus</p>


<h3>References</h3>

<p>Pedersen, A. R. (1995) A new approach to maximum likelihood estimation for 
stochastic differential equations based on discrete observations,
<em>Scand. J. Statist.</em>, 22, 55-71.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
d1 &lt;- function(t,x,theta) theta[1]*(theta[2]-x)
s1 &lt;- function(t,x,theta) theta[3]*sqrt(x)

from &lt;- 0.08
x &lt;- seq(0,0.2, length=100)
sle10 &lt;- NULL
sle2 &lt;- NULL
sle5 &lt;- NULL
true &lt;- NULL
set.seed(123)
for(to in x){
 sle2 &lt;- c(sle2, dcSim(from, to, 0.5, d1, s1, 
    theta=c(2,0.02,0.15), M=50000,N=2))
 sle5 &lt;- c(sle5, dcSim(from, to, 0.5, d1, s1, 
    theta=c(2,0.02,0.15), M=50000,N=5))
 sle10 &lt;- c(sle10, dcSim(from, to, 0.5, d1, s1, 
    theta=c(2,0.02,0.15), M=50000,N=10))
 true &lt;- c(true, dcCIR(to, 0.5, from, c(2*0.02,2,0.15)))
}

par(mar=c(5,5,1,1))
plot(x, true, type="l", ylab="conditional density")
lines(x, sle2, lty=4)
lines(x, sle5, lty=2)
lines(x, sle10, lty=3)
legend(0.15,20, legend=c("exact","N=2", "N=5", "N=10"), 
   lty=c(1,2,4,3))

## End(Not run)</code></pre>


</div>