<div class="container">

<table style="width: 100%;"><tr>
<td>cdfDT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribution function estimation under double truncation</h2>

<h3>Description</h3>

<p>This function computes the NPMLE of the event time distribution and truncation time distribution, when the event times
are subject to double truncation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cdfDT(
  y,
  l,
  r,
  error = 1e-06,
  n.iter = 10000,
  boot = FALSE,
  B.boot = 200,
  joint = FALSE,
  plot.cdf = FALSE,
  plot.joint = FALSE,
  display = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>vector of left truncation times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>vector of right truncation times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>prespecified error for convergence (default = 1e-6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Logical. Default=FALSE. If TRUE, the simple bootstrap method is applied to estimate the standard error
and pointwise confidence intervals of the event time distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.boot</code></td>
<td>
<p>Numeric value for number of bootstrap resamples. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>Logical. Default=FALSE. If TRUE, computes joint and marginal distributions of the truncation times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cdf</code></td>
<td>
<p>Logical. Default is FALSE. If TRUE, the estimated cumulative distribution and survival functions
of the event times are plotted. If boot=TRUE, confidence intervals are also plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.joint</code></td>
<td>
<p>Logical. Default is FALSE. If TRUE, the estimated marginal distribution functions of the truncation times,
and the joint distribution of the truncation times, are plotted. Note: Plot will only be displayed if both plot.joint=TRUE
and joint=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>Logical. Default is TRUE. If FALSE, output will not be displayed upon execution of function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates the distribution function of the survival time in the presence
of left and right truncation. Also estimates the joint cumulative distribution function
and marginal cumulative distribution functions of the left and right truncation times.
The computation is performed using the algorithm introduced in Shen (2010).
This is an iterative algorithm that converges to the NPMLE after a number of iterations.
Note that the survival, left, and right truncation times must be the same length.
If either of these vectors have missing observations, the entire observation will be excluded.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Unique event times of the event time vector y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.event</code></td>
<td>
<p>Number of events that occurred at each timepoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>Estimated cumulative distribution function of Y at each distinct value of y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Survival</code></td>
<td>
<p>Estimated survival function of Y at each distinct value of y (equal to 1-F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.F</code></td>
<td>
<p>Bootstrapped standard error of F at each distinct value of y (displayed if boot=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.lower.F</code></td>
<td>
<p>Estimated lower limits of the Wald confidence intervals for F (displayed if boot=TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.upper.F</code></td>
<td>
<p>Estimated upper limits of the Wald confidence intervals for F (displayed if boot=TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.K</code></td>
<td>
<p>Probability of the observed vector y falling within a random truncation interval [L,R]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Joint.LR</code></td>
<td>
<p>Estimated joint distribution function of (l,r)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Marginal.L</code></td>
<td>
<p>Estimated marginal cumulative distribution function of L at each observed l</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Marginal.R</code></td>
<td>
<p>Estimated marginal cumulative distribution function of R at each observed r</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iterations</code></td>
<td>
<p>Number of iterations needed for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter_reached</code></td>
<td>
<p>0 indicates convergence, 1 indicates that number of iterations exceeded n.iter</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Shen P-S (2010). Nonparametric analysis of doubly truncated data. Ann Inst Stat Math 62(5):835-853
</p>


<h3>Examples</h3>

<pre><code class="language-R">#AIDS data set:
out=cdfDT(AIDS$Induction.time,AIDS$L.time,AIDS$R.time,plot.cdf=TRUE)
out
</code></pre>


</div>