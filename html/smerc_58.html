<div class="container">

<table style="width: 100%;"><tr>
<td>mst.all</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum spanning tree for all regions</h2>

<h3>Description</h3>

<p><code>mst.all</code> finds the set of connected regions that
maximize the spatial scan statistic (the likelihood ratio
test statistic) from each starting region, subject to
relevant constraints.  The function can be used to
construct candidate zones for the dynamic minimum
spanning tree (dmst), early stopping dynamic minimum
spanning tree (edmst), double connected spatial scan test
(dc), and maximum linkage (mlink) spatial scan test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mst.all(
  neighbors,
  cases,
  pop,
  w,
  ex,
  ty,
  max_pop,
  type = "maxonly",
  nlinks = "one",
  early = FALSE,
  cl = NULL,
  progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>neighbors</code></td>
<td>
<p>A list containing the vector of
neighbors for each region (in ascending order of
distance from the region).  The starting region itself
is included among the neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A binary spatial adjacency matrix for the
regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ty</code></td>
<td>
<p>The total number of cases in the study area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_pop</code></td>
<td>
<p>The population upperbound (in total
population) for a candidate zone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of <code>"maxonly"</code>, <code>"pruned"</code>, or
<code>"all"</code>.  See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlinks</code></td>
<td>
<p>A character vector.  The options are
<code>"one"</code>, <code>"two"</code>, or <code>"max"</code>.  See
Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early</code></td>
<td>
<p>A logical value indicating whether the
"early" stopping criterion should be used.  If
<code>TRUE</code>, each sequence is stopped when the next
potential zone doesn't produce a test statistic larger
than the current zone. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>A logical value indicating whether a
progress bar should be displayed.  The default is
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is not intended to be used by users
directly. Consequently, it prioritizes efficiency over
user friendliness.
</p>
<p><code>type</code> is a character vector indicating what should
be returned by the function.  If <code>type = "maxonly"</code>,
then the maximum test statistic from each starting region
is returned .  If <code>type = "pruned"</code>, the function
returns a list that includes the location ids, test
statistic, total cases, expected cases, and total
population for the zone with the maximum test statistic
for each starting region.  If <code>type = "all"</code>, the
function returns a list of lists that includes the
location ids, test statistic, total cases, expected
cases, and total population for the sequence of candidate
zones associated with each starting region.
</p>
<p>If <code>nlinks = "one"</code>, then a region only needs to be
connected to one other region in the current zone to be
considered for inclusion in the next zone.  If
<code>nlinks = "two"</code>, then the region must be connected
to at least two other regions in the current zone.  If
<code>nlinks = "max"</code>, then only regions with the maximum
number of connections to the current zone are considered
for inclusion in the next zone.
</p>


<h3>Value</h3>

<p>Returns a list of relevant information.  See
Details.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Assuncao, R.M., Costa, M.A., Tavares, A. and
Neto, S.J.F. (2006). Fast detection of arbitrarily
shaped disease clusters, Statistics in Medicine, 25,
723-742.  &lt;doi:10.1002/sim.2411&gt;
</p>
<p>Costa, M.A. and Assuncao, R.M. and Kulldorff, M. (2012)
Constrained spanning tree algorithms for
irregularly-shaped spatial clustering, Computational
Statistics &amp; Data Analysis, 56(6), 1771-1783.
&lt;doi:10.1016/j.csda.2011.11.001&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load data
data(nydf)
data(nyw)

# create relevant data
coords &lt;- nydf[, c("longitude", "latitude")]
cases &lt;- floor(nydf$cases)
pop &lt;- nydf$population
w &lt;- nyw
ex &lt;- sum(cases) / sum(pop) * pop
ubpop &lt;- 0.5
ubd &lt;- 0.5
ty &lt;- sum(cases) # total number of cases
# intercentroid distances
d &lt;- gedist(as.matrix(coords), longlat = TRUE)
# upperbound for population in zone
max_pop &lt;- ubpop * sum(pop)
# upperbound for distance between centroids in zone
max_dist &lt;- ubd * max(d)
# create list of neighbors for each region
# (inclusive of region itself)
all_neighbors &lt;- nndist(d, ubd)
# find the dmst max zone
## Not run: 
out &lt;- mst.all(all_neighbors, cases, pop, w, ex, ty, max_pop,
  type = "maxonly"
)
head(out)

out &lt;- mst.all(all_neighbors, cases, pop, w, ex, ty, max_pop,
  type = "pruned"
)
head(out)

## End(Not run)
</code></pre>


</div>