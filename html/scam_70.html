<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.construct.lmpi.smooth.spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Locally shape-constrained P-spline based constructor (LSCOP-spline): locally increasing splines up to a change point. 
</h2>

<h3>Description</h3>

<p><code>scam</code> can use locally shape-constrained smooths that are monotone increasing up to a specified change point and become unconstrained beyond that point. This smooth is specified via model terms like 
<code>s(x,bs="lmpi",xt=list(xc=xc))</code>, where <code>xc</code> sets a change point. The construction of the smooths uses B-spline bases with mildly non-linear re-parametrization of the basis coefficients over the shape-constrained interval. The 'wiggliness' of the smooths is controlled by discrete penalties applied directly to the basis coefficients, in particular, by penalizing the squared differences between adjacent spline coefficients.
</p>
<p>The method is build by the <code>mgcv</code> constructor function for smooth terms, <code>smooth.construct</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmpi.smooth.spec'
smooth.construct(object, data, knots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A smooth specification object, generated by an <code>s</code> term in a SCAM formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or list containing the data required by this term,
with names given by <code>object$term</code>. The <code>by</code> variable is the last element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing the knots supplied for basis setup.  
If it is <code>NULL</code> then the knot locations are generated automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A smooth term of the form  <code>s(x,k,bs="lmpi",xt=list(xc=xc),m=2)</code>, where  <code>xc</code> specifies a change point. <code>k</code> denotes the basis dimension and <code>m+1</code> is the order of the B-spline basis. The default is a cubic spline <code>m=2</code>. The smooth uses a first order difference penalty on the coefficients starting from the second coefficient over the constrained part, and a second order difference penalty (a second order P-spline penalty) over the unconstrained part. The first order difference penalty over the constrained part shares with a second order P-spline penalty the feature of 'smoothing towards a straight line'. 
</p>
<p>The default basis dimension is <code>k=10</code>. The basis dimensions for constrained and unconstrained parts are set
proportionally to the share of each part from the total range of the covariate value, but with a minimum of 5 basis functions on each side.
</p>
<p>The smooth currently does not support user-supplied knots. The knots are placed evenly throughout the constrained and unconstrained ranges of the covariate values (inner knots) and outside the covariate values range (outer knots). The change point <code>xc</code> is set as an inner knot <code>m</code> times. Having multiple knots at the change point guarantees the correct imposing of the shape constraints up to the change point, avoiding 'leakage' of the transformed basis functions of the constrained part into the unconstrained part.
</p>
<p>Sum-to-zero ('centering') constraint is applied to the LSCOP-splines after imposing the shape-constrained model matrix transformation.
Linear extrapolation is (only) used for prediction that requires extrapolation, i.e. prediction outside the
range of the interior knots. 
</p>


<h3>Value</h3>

<p> An object of class <code>"lmpi.smooth"</code>. 
</p>


<h3>Author(s)</h3>

 
<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>
<p>with contributions from Jens Lichter
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>


<h3>See Also</h3>

<p><code>smooth.construct.mpd.smooth.spec</code>,
<code>smooth.construct.cv.smooth.spec</code>,
</p>
<p><code>smooth.construct.cx.smooth.spec</code>,
<code>smooth.construct.mdcv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.mdcx.smooth.spec</code>, 
<code>smooth.construct.micv.smooth.spec</code>, 
</p>
<p><code>smooth.construct.micx.smooth.spec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Local monotone increasing LSCOP-spline example...
## simulating data...
require(scam)
set.seed(4)
n &lt;- 200
x &lt;- sort(runif(n)*6)
f &lt;- 4*tanh(2*x-5)-5*exp(-(x-4)^2) ## increasing up untill xt=2.978
xc &lt;- 2.978
y &lt;- f+rnorm(n)*.7
old.par &lt;- par(mfrow=c(1,2))
plot(x,y,cex=.5)
lines(x,f,lty=2); abline(v=xc,lty=2,col="red")
## fit model ...
b &lt;- scam(y~s(x,bs="lmpi",xt=list(xc=xc),k=15))
summary(b)
lines(x,fitted(b),col=2,lwd=2)
plot(b,shade=TRUE)
par(old.par)

## unconstrained model to compare with...
g &lt;- scam(y~s(x))
plot(x,y,cex=.5)
lines(x,f,lty=2); abline(v=xc,lty=2,col=2)
lines(x,fitted(g),col=4,lwd=2)
lines(x,fitted(b),col=2,lwd=1)

</code></pre>


</div>