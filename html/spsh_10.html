<div class="container">

<table style="width: 100%;"><tr>
<td>resFun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of the Objective Function Value</h2>

<h3>Description</h3>

<p>Contains the objective functions to calculate (weighted) sum of squared residuals or likelihoods.
The assumption made is that the residuals are identically, independantly and normally distributed.
The normal distribution of the model residuals is standardly given with mean = 0, and variance = 1.if weighting is not considered.
There are three methods to consider weights: a) fixed skalar values for each data type, b) a vector of weights for each 
data type. The vector has to have the same length as the vector of the data type.
c) It is possible to estimate the
</p>


<h3>Usage</h3>

<pre><code class="language-R">resFun(
  p,
  shpmodel = "01110",
  retdata = NULL,
  condata = NULL,
  pretrans = NULL,
  weight = NULL,
  method = "rss",
  trim.query = FALSE,
  ivap.query = NULL,
  hclip.query = FALSE,
  parL = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of model parameters handed used to calculate the soil hydraulic property model values in shypFun.
Depends on <code>shpmodel</code> and the pressure head values specified in <code>retdata</code> and <code>condata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shpmodel</code></td>
<td>
<p>Character identifying the soil hydraulic property model. See shypFun.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retdata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with volumetric water contents in [cm cm-3].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with hydraulic conductivity values in log10[cm d-1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pretrans</code></td>
<td>
<p>A vector to back transform the parameters before the soil hydraulic property function values calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Specification of weight method. See weightFun.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<table>
<tr>
<td style="text-align: left;">
    <code>rss</code>
</td>
<td style="text-align: left;">Default for the optimisation algortihm DEoptim. resFun returns skalar sum of squared (weighted) residuals. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>res</code>
</td>
<td style="text-align: left;">Weighted residuals are computed and returnd. Required for post hoc analyses. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>-2logLik</code>
</td>
<td style="text-align: left;">-2 * log-likelihood is returned. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim.query</code></td>
<td>
<p>Default <code>FALSE</code>. If a trimodal soil hydraulic property function is used, this has to be specified by setting the argument to (<em>TRUE</em>) which ensures the sum of modal <code>weights == 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ivap.query</code></td>
<td>
<p>Default is <code>FALSE</code>, and no <em>ivap</em> method is specified. See KvapFun</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclip.query</code></td>
<td>
<p>Implemented purely for future compatability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parL</code></td>
<td>
<p>Defaults to <code>NULL</code>, only inserted for compatbility with <code>modMCMC</code> used in shypEstFun. <code>modMCMC</code>, only
handled parameters which are estimated, other model parameters need to be passed through parL. See Details of shypEstFun.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model errors may be specified or estimated as nuisance parameters weighting the data classes. In case the model error !=1, the output statistics are weighted accordingly.
</p>


<h3>Value</h3>

<p>Returns scalar of sum of squared (weighted) residuals or vector of weighted residuals, as specified by 
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>user</code>
</td>
<td style="text-align: left;">user defined weights</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>none</code>
</td>
<td style="text-align: left;">no weights are considered, i.e. no measurement error assumed</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>range</code>
</td>
<td style="text-align: left;">rescaling (normalization of observations to the intervall [0,1]</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>fix1</code>
</td>
<td style="text-align: left;">fixed scalar weight for THETA is 1/0.05^2 and weight for log10K is 1 </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>est1</code>
</td>
<td style="text-align: left;">Two scalar model weights 1/sigma_i^2 are treated as free parameters to be estimated by inversion, one for <code>THETA</code> and one for <code>log10K</code>. Only simultaneously estimateable</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># load data
data("shpdata1")

# observations
retdata &lt;- shpdata1$LFH1$wrc[!is.na(shpdata1$LFH1$wrc[,1]),]
condata &lt;- shpdata1$LFH1$hcc

# 7 - resFun ------------------------------------------------------------
# soil hydraulic property model parameters, van Genuchten-Mualem
p &lt;- c("thr" = 0.16, "ths" = 0.46, "alf1" = 0.03, "n1" = 1.42, "Ks" = 26, "tau" = .5)

# calculate weighted residuals
wres &lt;- resFun(p, retdata = retdata, condata = condata, pretrans = NULL,
               weight = list("wth" = 0.0025, "wKh" = 1), method = "res", trim = FALSE)

## residuals of the soil water retention curve [-]
theta.wres &lt;- wres[1:dim(retdata)[1]]

## residuals of the log10 hydraulic conductivity curve [cm/d]
log10K.wres &lt;- wres[(dim(retdata)[1]+1) : length(wres)]

</code></pre>


</div>