<div class="container">

<table style="width: 100%;"><tr>
<td>get_groups</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get Sample Groups from Signature Decomposition Information</h2>

<h3>Description</h3>

<p>One of key results from signature analysis is to cluster samples into different
groups. This function takes <code>Signature</code> object as input
and return the membership in each cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_groups(
  Signature,
  method = c("consensus", "k-means", "exposure", "samples"),
  n_cluster = NULL,
  match_consensus = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Signature</code></td>
<td>
<p>a <code>Signature</code> object obtained either from sig_extract or sig_auto_extract.
Now it can be used to relative exposure result in <code>data.table</code> format from sig_fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>grouping method, more see details, could be one of the following:
</p>

<ul>
<li>
<p> 'consensus' - returns the cluster membership based on the hierarchical clustering of the consensus matrix,
it can only be used for the result obtained by <code>sig_extract()</code> with multiple runs using <strong>NMF</strong> package.
</p>
</li>
<li>
<p> 'k-means' -  returns the clusters by k-means.
</p>
</li>
<li>
<p> 'exposure' - assigns a sample into a group whose signature exposure
is dominant.
</p>
</li>
<li>
<p> 'samples' - returns the cluster membership based on the contribution of signature to each sample,
it can only be used for the result obtained by <code>sig_extract()</code> using <strong>NMF</strong> package.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cluster</code></td>
<td>
<p>only used when the <code>method</code> is 'k-means'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_consensus</code></td>
<td>
<p>only used when the <code>method</code> is 'consensus'.
If <code>TRUE</code>, the result will match order as shown in consensus map.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Users may find there are bigger differences between using method 'samples' and 'exposure' but
they use a similar idear to find dominant signature, here goes the reason:
</p>
<p>Method 'samples' using data directly from NMF decomposition, this means the two matrix
<code>W</code> (basis matrix or signature matrix) and <code>H</code> (coefficient matrix or exposure matrix) are
the results of NMF. For method 'exposure', it uses the signature exposure loading matrix.
In this situation, each signture represents a number of mutations (alterations)
about implementation please see source code of <code>sig_extract()</code> function.
</p>


<h3>Value</h3>

<p>a <code>data.table</code> object
</p>


<h3>See Also</h3>

<p><code>NMF::predict()</code>, show_groups.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load copy number prepare object
load(system.file("extdata", "toy_copynumber_tally_W.RData",
  package = "sigminer", mustWork = TRUE
))
# Extract copy number signatures
library(NMF)
sig &lt;- sig_extract(cn_tally_W$nmf_matrix, 2,
  nrun = 10
)

# Methods 'consensus' and 'samples' are from NMF::predict()
g1 &lt;- get_groups(sig, method = "consensus", match_consensus = TRUE)
g1
g2 &lt;- get_groups(sig, method = "samples")
g2

# Use k-means clustering
g3 &lt;- get_groups(sig, method = "k-means")
g3

</code></pre>


</div>