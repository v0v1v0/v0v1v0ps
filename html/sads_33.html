<div class="container">

<table style="width: 100%;"><tr>
<td>dtrunc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Left-truncation of density, probability and quantile of distributions</h2>

<h3>Description</h3>

<p>Returns density, probability, quantile values and random generation for
distribution functions left-truncated at a specified value.</p>


<h3>Usage</h3>

<pre><code class="language-R">dtrunc(f, x, trunc, coef, log = FALSE)
ptrunc(f, q, trunc, coef, lower.tail=TRUE, log.p=FALSE)
qtrunc(f, p, trunc, coef, lower.tail = TRUE, log.p = FALSE)
rtrunc(f, n, trunc, coef, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>character;
root name of the density or distribution function to be truncated
- e.g., <kbd>"lnorm"</kbd> for the lognormal distribution; <kbd>"geom"</kbd> for the geometric distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>numeric, <code>trunc &gt; min(x)</code>. Truncation value (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of random values to return.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>

<p>numeric named list; parameters values of the density or
distribution function, named accordingly (see details). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>in <code>rtrunc</code> further arguments to
be passed to <code>poweRlaw::rpldis</code> when argument argument
<code>f = "power"</code> and argument <code>bissection = FALSE</code>. The same for
<code>rpower</code> when and argument <code>bissection = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a distribution with probability distribution function (PDF) g
and cumulative distribution function (CDF) G, a random variable
<code>x</code> with these distributions left-truncated at <code>trunc</code> has
its PDF:
</p>
<p>g'(x) = g(x)/(1 - G(trunc)) for any x &lt;= trunc and zero otherwise 
</p>
<p>and CDF:
</p>
<p>G'(x) = (G(max(x,trunc)) - G(trunc)) / (1 - G(trunc))
</p>
<p><code>dtrunc</code> and <code>ptrunc</code> calculates the left-truncated
distributions functions
g'(x) and G'(x) defined above for
a vector of values <code>x</code> from any
standard distribution function available in R.
This means the 'upper tail' of a continuous distribution
is rescaled to integrate to one.
Accordingly, for discrete distributions, the probabilities
for all <code>x</code>&gt;trunc are rescaled to sum one.
<code>qtrunc</code> is the inverse function of <code>ptrunc</code>.
</p>
<p>Left-truncated distributions can be used to
describe the species abundance distributions (SADs),
specially for continuous distributions
(e.g., truncated lognormal distribution).
</p>


<h3>Value</h3>

<p><code>dtrunc</code> gives the (log) density defined by <code>f</code> left-truncated at <code>trunc</code>.
<code>ptrunc</code> gives the (log) distribution function defined by
<code>f</code> left-truncated at <code>trunc</code>.
<code>qtrunc</code> gives the quantile of the density defined by <code>f</code> left-truncated at <code>trunc</code>.
<code>rtrunc</code> generates a sample from the density defined by <code>f</code> left-truncated at <code>trunc</code>.
</p>


<h3>Source</h3>

<p>Codes from Nadarajah and Kotz (2006),
which provide a more generic solution
for left and right truncation.
</p>


<h3>References</h3>

<p>Nadarajah, S. and Kotz, S. 2006. R Programs for Computing Truncated
Distributions. <em>Journal of Statistical Software 16</em>:Code Snippet 2.
</p>


<h3>See Also</h3>

<p>Distributions for standard distributions in R;
many functions in package <span class="pkg">sads</span> have an argument <code>trunc</code> that
allows to simulate and fit truncated
distributions
for species abundance distributions (e.g., <code>fitsad</code>
<code>rsad</code>, <code>radpred</code>, <code>octavpred</code>.
Package 'VGAM' has truncated versions of many standard functions;
see <code>Truncate-methods</code> in package <span class="pkg">distr</span> for  general
methods to build R objects of truncated distributions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- dtrunc("lnorm", x = 1:5, trunc = 0.5,
       coef = list( meanlog=1, sdlog=1.5 ) )
## same as
B &lt;- dlnorm( 1:5 , meanlog = 1, sdlog = 1.5 ) /
  ( plnorm ( 0.5 , meanlog = 1, sdlog = 1.5, lower = FALSE))
## checking
identical( A, B )

A &lt;- ptrunc("pois", q = 1:5, trunc = 0,
       coef = list( lambda = 1.5 ) )
## same as
B &lt;- (ppois( 1:5 , lambda = 1.5 ) -
      ppois(0 , lambda = 1.5 ) ) /
  (ppois(0 , lambda = 1.5, lower = FALSE))
## checking
identical(A,B)

# Random generation
rtrunc("ls", 100, coef=list(N=1000, alpha=50), trunc=5)
</code></pre>


</div>