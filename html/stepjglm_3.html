<div class="container">

<table style="width: 100%;"><tr>
<td>stepjglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection in joint modeling of mean and dispersion</h2>

<h3>Description</h3>

<p>A Procedure for selecting variables in JMMD (including mixture models) based on hypothesis testing and the quality of the model's fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepjglm(model,alpha1,alpha2,datafram,family,lambda1=1,lambda2=1,startmod=1,
                 interations=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of class "formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted. if <code>datafram</code> is a mixture data, <code>datafram</code> doesn't contain the principal mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>
<p>significance level for testing add new terms on the mean models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>
<p>significance level for testing add new terms on the dispersion models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datafram</code></td>
<td>
<p>a data frame containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string naming a family function or the result of a call to a family function. For <code>glm.fit</code> only the third option is supported. (See <code>family</code> for details of family functions). Describe the family function for the mean model (families implemented by package <code>stats</code>). For the dispersion model, the Gamma family whit log link is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>some function of the sample size to calculate the <code class="reqn">\tilde{R}_m^{2}</code>  (See Pinto and Pereira (in press) and Zhang (2017) for more details). If equal to 1 (default), uses the standard correction for the <code class="reqn">\tilde{R}_m^{2}</code>. If equal to "EAIC", uses the <code class="reqn">EAIC</code> criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>some function of the sample size to calculate the <code class="reqn">\tilde{R}_d^{2}</code>  (See Pinto and Pereira (in press) and Zhang (2017) for more details). If equal to 1 (default), uses the standard correction for the <code class="reqn">\tilde{R}_d^{2}</code>. If equal to "AIC", uses the corrected <code class="reqn">AIC_c</code> criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startmod</code></td>
<td>
<p>if <code>datafram</code> is a mixture data, <code>startmod</code> is the principal mixture components, else, <code>startmod</code> must be equal to 1 (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interations</code></td>
<td>
<p>if <code>TRUE</code> shows the outputs of iterations procedure step by step. The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function implements a method for selection of variables for both the mean and dispersion models in the JMMD introduced by Nelder and Lee (1991)
considering the <em>Adjusted Quasi Extended Likelihood</em> introduced by Lee and Nelder (1998).
The method is a procedure for  selecting  variables,  based  on  hypothesis  testing  and  the  quality  of  the  model's  fit.
A criterion for checking the goodness of fit is used, in each iteration of the selection process,
as a filter for choosing the terms that will be evaluated by a hypothesis test. For more details on selection algorithms, see Pinto and Pereira (in press).
</p>


<h3>Value</h3>


<table>
<tr>
<td style="text-align: left;">
<code> model.mean</code>  </td>
<td style="text-align: left;">   a <code>glm</code> object with the adjustments for the mean model. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>model.disp</code>  </td>
<td style="text-align: left;">   a <code>glm</code> object with the adjustments for the dispersion model. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>EAIC</code> </td>
<td style="text-align: left;"> a numeric object containing the <em>Extended Akaike Information Criterion</em>.  </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;">  For details, see Wang and Zhang (2009). </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>EQD</code>  </td>
<td style="text-align: left;"> a numeric object containing the <em>Extended Quasi Deviance</em>. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;">  For details, see Nelder and Lee (1991). </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R2m</code>  </td>
<td style="text-align: left;"> a numeric object containing the standard correction for the <code class="reqn">\tilde{R}_m^{2}</code>.  </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> For details, see Pinto and Pereira (in press). </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R2d</code>  </td>
<td style="text-align: left;"> a numeric object containing the standard correction for the <code class="reqn">\tilde{R}_d^{2}</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> For details, see Pinto and Pereira (in press). </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Leandro Alves Pereira, Edmilson Rodrigues Pinto.
</p>


<h3>References</h3>

<p>Hu, B. and Shao, J. (2008). Generalized linear model selection using <code class="reqn">R^2</code>. <em>Journal of Statistical Planning and Inference</em>, 138, 3705-3712.
</p>
<p>Lee, Y., Nelder, J. A. (1998). Generalized linear models for analysis of quality improvement experiments. <em>The Canadian Journal of Statistics</em>, v. 26, n. 1, pp. 95-105.
</p>
<p>Nelder, J. A., Lee, Y. (1991). Generalized linear models for the analysis of Taguchi-type experiments. <em>Applied Stochastic Models and Data Analysis</em>, v. 7, pp. 107-120.
</p>
<p>Pinto, E. R., Pereira, L. A. (in press). On variable selection in joint modeling of mean and dispersion. <em>Brazilian Journal of Probability and Statistics</em>. Preprint at   <a href="https://arxiv.org/abs/2109.07978">https://arxiv.org/abs/2109.07978</a> (2021).
</p>
<p>Wang, D. and Zhang, Z. (2009). Variable selection in joint generalized linear models. <em>Chinese Journal of Applied Probability and Statistics</em>,  v. 25,  pp.245-256.
</p>
<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, v. 71, 310-316.
</p>


<h3>See Also</h3>

<p><code>glm</code>
</p>
<p><code>summary.glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Application to the bread-making problem:

data(bread_mixture)

Form =
as.formula(y~ x1:x2+x1:x3+x2:x3+x1:x2:(x1-x2)+x1:x3:(x1-x3)+
            + x1:z1+x2:z1+x3:z1+x1:x2:z1
            + x1:x3:z1+x1:x2:(x1-x2):z1
            + x1:x3:(x1-x3):z1
            + x1:z2+x2:z2+x3:z2+x1:x2:z2
            + x1:x3:z2+x1:x2:(x1-x2):z2
            +x1:x3:(x1-x3):z2)

object=stepjglm(Form,0.1,0.1,bread_mixture,gaussian,sqrt(90),"AIC","-1+x1+x2+x3")

summary(object$modelo.mean)
summary(object$modelo.disp)

object$EAIC  # Print the EAIC for the final model



# Application to the injection molding data:

form = as.formula(Y ~ A*M+A*N+A*O+B*M+B*N+B*O+C*M+C*N+C*O+D*M+D*N+D*O+
                      E*M+E*N+E*O+F*M+F*N+F*O+G*M+G*N+G*O)

data(injection_molding)

obj.dt = stepjglm(form, 0.05,0.05,injection_molding,gaussian,sqrt(nrow(injection_molding)),"AIC")

summary(obj.dt$modelo.mean)
summary(obj.dt$modelo.disp)

obj.dt$EAIC  # Print the EAIC for the final model
obj.dt$EQD   # Print the EQD for the final model
obj.dt$R2m   # Print the R2m for the final model
obj.dt$R2d   # Print the R2d for the final model

</code></pre>


</div>