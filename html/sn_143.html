<div class="container">

<table style="width: 100%;"><tr>
<td>selm.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting functions for <code>selm</code> models</h2>

<h3>Description</h3>

<p>A call to <code>selm</code> activates a call to <code>selm.fit</code> and
from here to some other function which actually performs the parameter
search, among those listed below. These lower-level functions can be 
called directly for increased efficiency, at the expense of some more 
programming effort and lack of methods for the returned object.</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
selm.fit(x, y, family = "SN", start = NULL, w, fixed.param = list(), 
   offset = NULL, selm.control=list())

sn.mple(x, y, cp = NULL, w, penalty = NULL, trace = FALSE, opt.method =
   c("nlminb",  "Nelder-Mead", "BFGS", "CG", "SANN"), control = list()) 

st.mple(x, y, dp = NULL, w, fixed.nu = NULL, symmetr = FALSE, penalty = NULL, 
   trace = FALSE, opt.method = c("nlminb", "Nelder-Mead", "BFGS", "CG", "SANN"), 
   control = list()) 

msn.mle(x, y, start = NULL, w, trace = FALSE, opt.method = c("nlminb", 
   "Nelder-Mead", "BFGS", "CG", "SANN"), control = list())

msn.mple(x, y, start = NULL, w, trace = FALSE, penalty = NULL, 
   opt.method = c("nlminb", "Nelder-Mead", "BFGS", "CG", "SANN"), 
   control = list()) 

mst.mple(x, y, start = NULL, w, fixed.nu = NULL, symmetr=FALSE, 
   penalty = NULL, trace = FALSE, 
   opt.method = c("nlminb", "Nelder-Mead", "BFGS", "CG", "SANN"), 
   control = list()) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a full-rank design matrix with the first column of all 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector or a matrix of response values such that
<code>NROW(y)=nrow(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string which selects the parametric family of
distributions assumed for the error term of the regression model. 
It must one of <code>"SN"</code> (default), <code>"ST"</code> or <code>"SC"</code>, which 
correspond to the skew-normal, the skew-<em>t</em> and the skew-Cauchy 
family, respectively.
See <code>makeSECdistr</code> for more information on these families and
the skew-elliptically contoured (<abbr><span class="acronym">SEC</span></abbr>) distributions; notice that
family <code>"ESN"</code> is not allowed here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, dp, cp</code></td>
<td>
<p>a vector or a list of initial parameter values,
depeding whether <code>y</code> is a vector or a matrix. It is assumed that 
<code>cp</code> is given in the <abbr><span class="acronym">CP</span></abbr> parameterization, <code>dp</code> and
<code>start</code> in the <abbr><span class="acronym">DP</span></abbr> parameterization. 
For <code>st.mple</code> and <code>mst.mple</code>, see also the paragraph about  
<code>start</code> in the documentation ‘Details’ of <code>selm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a vector of non-negative integer weights of length equal to 
<code>NROW(y)</code>; if missing, a vector of all 1's is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.param</code></td>
<td>
<p>a list of assignments of parameter values to be kept
fixed during the optimization process. Currently, there is only one such
option, namely <code>fixed.param=list(nu='value')</code>, to fix the degrees
of freedom at the named <code>'value'</code> when <code>family="ST"</code>, for instance
<code>list(nu=3)</code>. Setting <code>fixed.param=list(nu=1)</code> is equivalent to
select <code>family="SC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>an optional character string with the name of the penalty
function of the log-likelihood; 
default value <code>NULL</code> corresponds to no penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.  This
should be <code>NULL</code> or a numeric vector of length equal to the number of
cases.  One or more <code>offset</code> terms can be included in the
formula instead or as well, and if more than one are specified their sum is
used.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>a logical value which regulates printing of successive calls 
to the target function; default value is <code>FALSE</code> which suppresses 
printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.nu</code></td>
<td>
<p>a positive value to keep fixed the parameter <code>nu</code> 
of the <abbr><span class="acronym">ST</span></abbr> distribution in the optimization process; with default
value <code>NULL</code>, <code>nu</code> is estimated like the other parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetr</code></td>
<td>
<p>a logical flag indicating whether a contraint of symmetry is
imposed on the slant parameter; default is <code>symmetr=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.method</code></td>
<td>
<p>a character string which selects the optimization method
within the set <code>c("nlminb", "Nelder-Mead", "BFGS", "CG", "SANN")</code>;
the last four of these are <code>"methods"</code> of function <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selm.control</code></td>
<td>
<p>a list whose components regulate the working of 
<code>selm.fit</code>; see ‘Details’ for their description;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control items passed to the optimization function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A call to <code>selm</code> produces a call to <code>selm.fit</code> which
selects the appropriate function among <code>sn.mple</code>, <code>st.mple</code>,
<code>msn.mle</code>, <code>msn.mple</code>, <code>mst.mple</code>, depending on the
arguments of the calling statement. In the adopted scheme for function names, 
<code>msn</code> refers to a  multivariate skew-normal distribution and  
<code>mst</code> refers to a multivariate skew-<code class="reqn">t</code> distribution, while
<code>mle</code> and <code>mple</code> refers to maximum likelihood and maximum
penalized likelihood estimation, respectively.
Of these functions, <code>sn.mple</code> works in <abbr><span class="acronym">CP</span></abbr> space; the others
in the <abbr><span class="acronym">DP</span></abbr> space. In all cases, a correspondig mapping to the 
alternative parameter space is performed before exiting <code>selm.fit</code>,
in addition to the selected parameter set.
</p>
<p>The components of <code>selm.control</code> are as follows:
</p>

<ul>
<li> <p><code>method</code>: the estimation method, <code>"MLE"</code> or <code>"MPLE"</code>.
</p>
</li>
<li> <p><code>penalty</code>: a string with the name of the penalty function.
</p>
</li>
<li> <p><code>info.type</code>: a string with the name of the information matrix,
<code>"observed"</code> or <code>"expected"</code>; currently fixed at "observed".         
</p>
</li>
<li> <p><code>opt.method</code>: a character string which selects the optimization
method. 
</p>
</li>
<li> <p><code>opt.control</code>: a list of control parameters of <code>opt.method</code>.
</p>
</li>
</ul>
<p>Function <code>msn.mle</code>, for <abbr><span class="acronym">MLE</span></abbr> estimation of linear models with
<abbr><span class="acronym">SN</span></abbr> errors, is unchanged from version 0.4-x of the package. 
Function <code>msn.mple</code> is similar to <code>msn.mle</code> but allows to introduce
a penalization of the log-likelihood; when <code>penalty=NULL</code>, a call to 
<code>msn.mle</code> is more efficient.
Functions <code>sn.mple</code> and <code>mst.mple</code> work like <code>sn.mle</code> and
<code>mst.mle</code> in version 0.4-x if the argument <code>penalty</code> is not 
set or it is set to <code>NULL</code>, except that <code>mst.mple</code> does not
handle a univariate response (use <code>st.mple</code> for that).
</p>


<h3>Value</h3>

<p>A list whose specific components depend on the named function.
Typical components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the calling statement</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>vector or list of estimated <abbr><span class="acronym">DP</span></abbr> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp</code></td>
<td>
<p>vector or list of estimated <abbr><span class="acronym">CP</span></abbr> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>the maximized (penalized) log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>a list with auxiliary output values, depending on the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.method</code></td>
<td>
<p>a list produced by the numerical <code>opt.method</code></p>
</td>
</tr>
</table>
<h3>Background</h3>

<p>Computational aspects of maximum likelihood estimation for univariate 
<abbr><span class="acronym">SN</span></abbr> distributions are discussed in Section 3.1.7 of Azzalini and
Capitanio (2014). The working of <code>sn.mple</code> follows these lines; 
maximization is performed in the <abbr><span class="acronym">CP</span></abbr> space. All other functions
operate on the <abbr><span class="acronym">DP</span></abbr> space.
</p>
<p>The technique underlying <code>msn.mle</code> is based on a partial analytical 
maximization, leading  implicitly to a form of profile log-likelihood.
This scheme is formulated in detail in Section 6.1 of Azzalini and Capitanio 
(1999) and summarized in Section 5.2.1 of Azzalini and Capitanio (2014). 
The same procedure is not feasible when one adopts <abbr><span class="acronym">MPLE</span></abbr>; 
hence function <code>msn.mple</code> has to maximize over a larger parameter space.
</p>
<p>When the SN family is fitted with the constraint <kbd>alpha=0</kbd>, this amounts
to adopt a classical linear model with Gaussian distributional assumption.
The corresponding <abbr><span class="acronym">MLE</span></abbr>'s are the same as those produced by <code>lm</code>, 
except that the denominator the of the <abbr><span class="acronym">MLE</span></abbr> variance (matrix) has the 
‘uncorrected’ form.
In the multivariate case, the covariance matrix of <abbr><span class="acronym">MLE</span></abbr> is computed 
using expression (10) in Section 15.8 of Magnus and Neudecker (2007).
</p>
<p>Maximization of the univariate <abbr><span class="acronym">ST</span></abbr> log-likelihood is speeded-up 
by using the expressions of the gradient given by DiCiccio and Monti (2011),
reproduced with inessential variants in Section 4.3.3 of Azzalini and 
Capitanio (2014).
</p>
<p>The working of <code>mst.mple</code> is based on a re-parameterization described 
in Section 5.1 of Azzalini and Capitanio (2003). The expressions of the 
corresponding log-likelihood derivatives are given in Appendix B of the full 
version of the paper.
</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (1999).
Statistical applications of the multivariate skew normal distribution.
<em>J.Roy.Statist.Soc. B</em> <b>61</b>, 579–602. 
Full-length version available at <a href="https://arXiv.org/abs/0911.2093">https://arXiv.org/abs/0911.2093</a>
</p>
<p>Azzalini, A. and Capitanio, A. (2003).
Distributions generated by perturbation of symmetry with emphasis on
a multivariate skew <em>t</em> distribution.
<em>J.Roy. Statist. Soc. B</em> <b>65</b>, 367–389.
Full-length version available at <a href="https://arXiv.org/abs/0911.2342">https://arXiv.org/abs/0911.2342</a>
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>
<p>DiCiccio,  T. J. and Monti, A. C. (2011).  
Inferential aspects of the skew <code class="reqn">t</code>-distribution.
<em>Quaderni di Statistica</em> <b>13</b>, 1–21.
</p>
<p>Magnus, J. R. and Neudecker, H. (2007).
<em>Matrix Differential Calculus with Applications in Statistics and 
Econometrics</em>, third edition.  John Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code>selm</code> for a comprehensive higher level fitting function,   
<code>Qpenalty</code> for specification of a penalty function 
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data(wines, package="sn")
X &lt;- model.matrix(~ phenols + wine, data=wines)
fit &lt;- msn.mle(x=X, y=cbind(wines$acidity, wines$alcohol), opt.method="BFGS")
fit &lt;- st.mple(x=X, y = wines$acidity, fixed.nu=4, penalty="Qpenalty")
</code></pre>


</div>