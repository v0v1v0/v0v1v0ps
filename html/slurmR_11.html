<div class="container">

<table style="width: 100%;"><tr>
<td>opts_slurmR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get and set default options for <code>sbatch</code> and <code>slurmR</code> internals</h2>

<h3>Description</h3>

<p>Most of the functions in the <code>slurmR</code> package use <code>tmp_path</code> and <code>job-name</code>
options to write and submit jobs to <strong>Slurm</strong>. These options have global
defaults that are set and retrieved using <code>opts_slurmR</code>. These options
also include SBATCH options and things to do before calling RScript,
e.g., loading modules on an HPC cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opts_slurmR
</code></pre>


<h3>Format</h3>

<p>An object of class <code>opts_slurmR</code> of length 17.
</p>


<h3>Details</h3>

<p>Whatever the path specified on <code>tmp_path</code>, all nodes should have access to it.
Moreover, it is recommended to use a path located in a high-performing drive.
See for example <a href="https://en.wikipedia.org/w/index.php?title=Disk_staging&amp;oldid=908353920">disk staging</a>.
</p>
<p>The <code>tmp_path</code> directory is only created at the time that one of the functions
needs to I/O files. Job creation calls like Slurm_EvalQ and Slurm_lapply
do such.
</p>
<p>The "preamble" options can be specified if, for example, the current cluster
needs to load R, a compiler, or other programs via a <code>module</code> command.
</p>
<p>Current supported options are:
</p>
<p>Debugging mode
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠debug_on : function ()⁠</code> Activates the debugging mode. When active, jobs will be submitted using sh and not sbatch. Also, only a single chunk of the data will be processed.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠debug_off : function ()⁠</code> Deactivates the debugging mode.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_debug : function ()⁠</code> Returns TRUE of debug mode is on
</p>
</li>
</ul>
<p>Verbose mode
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠verbose_on : function ()⁠</code> Deactivates the verbose mode. When ON, sbatch prints the Rscript and batch files on screen so that the user knows what will be submitted to Slurm.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠verbose_off : function ()⁠</code> Deactivates the verbose mode.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_verbose : function ()⁠</code> Returns TRUE if verbose mode is on.
</p>
</li>
</ul>
<p>Slurm options
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠set_tmp_path : function (path, recursive = TRUE)⁠</code> Sets the tempfile path for I/O
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_tmp_path : function ()⁠</code> Retrieves tempfile path for I/O
</p>
</li>
<li> <p><code style="white-space: pre;">⁠set_job_name : function (path, check = TRUE, overwrite = TRUE)⁠</code> Changes the job-name. When changing the name of the job the function will check whether the folder chdir/job-name is empty or not. If empty/not created it will create it, otherwise it will delete its contents (if 'overwrite = TRUE“, else it will return with an Error)..
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_job_name : function (check = TRUE)⁠</code> Returns the current value of 'job-name'.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠set_preamble : function (...)⁠</code> Sets "preamble" to the RScript call. For example, it could be used for loading modules, setting env variables, etc., needed during the R session. Options are passed as characters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_preamble : function ()⁠</code> Returns the preamble, e.g., module loads, environment variable definitions, etc., that will be included in sbatch submissions.
</p>
</li>
</ul>
<p>Other options
</p>

<ul><li> <p><code style="white-space: pre;">⁠get_cmd : function ()⁠</code> If debug mode is active, then it returns 'sh', otherwise 'sbatch'
</p>
</li></ul>
<p>For general set/retrieve options
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠set_opts : function (...)⁠</code> A generic function to set options.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_opts_job : function (...)⁠</code> A generic function to retrieve options for the job (Slurm).
</p>
</li>
<li> <p><code style="white-space: pre;">⁠get_opts_r : function (...)⁠</code> A generic function to retrieve options in R.
</p>
</li>
</ul>
<p>Nuke
</p>

<ul><li>
<p> While reloading the package should reset all the options, if needed, the user
can also use the function <code>opts_slurmR$reset()</code>.
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Common setup
## Not run: 
opts_slurmR$set_tmp_path("/staging/pdt/vegayon")
opts_slurmR$set_job_name("simulations-1")
opts_slurm$set_opts(partition="thomas", account="lc_pdt")
opts_slurm$set_preamble("module load gcc")# if needed

## End(Not run)

</code></pre>


</div>