<div class="container">

<table style="width: 100%;"><tr>
<td>seg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Specifying a segmented/stepmented term in the segreg/stepreg formula
</h2>

<h3>Description</h3>

<p>Function used to define a segmented (stepmented) term within the segreg (stepreg) formula. The function simply passes relevant information to proper fitter functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seg(x, npsi = 1, psi = NA, est = NA, R = NA, fixed.psi = NULL, by = NULL, f.x = I)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The segmented/stepmented (numeric) covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npsi</code></td>
<td>

<p>The number of breakpoints/jumpoints to estimate. Default to <code>npsi=1</code>. If <code>by</code> has been specified, the same <code>npsi</code> applies to all categories of the factor <code>by</code>; otherwise it can be vector, wherein the entries represent  the number of breakpoints of the segmented relationships within the categories of <code>by</code>. If <code>npsi</code> is specified as a vector, the corresponding <code>est</code> should be a list. The <code>npsi</code> starting values are computed according the specification of <code>quant</code> in <code>seg.control</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>

<p>Numerical vector indicating possible starting value(s) for the breakpoint(s). When provided, <code>psi</code> overwrites <code>npsi</code>. If <code>by</code> has been specified, <code>psi</code> can be a list, wherein the components represent  the starting values of the segmented/stepmented relationships within the categories of <code>by</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>

<p>Possible vector (of length equal to <code>npsi+1</code>) of 0's and 1's to indicate whether the slopes have to be estimated or fixed to zero. <code>NA</code>, the default, means all ones, namely every slope is estimated. Consecutive zeroes are not allowed. If <code>by</code> has been specified, the same <code>est</code> applies to all categories of the factor <code>by</code>; otherwise <code>est</code> can be a list, wherein the components represent the slope constraints of the segmented relationships within the categories of <code>by</code>. Note that, when a grouping variable has been specified in <code>by</code>, <code>npsi</code> can be specified as a vector, and <code>est</code> should be a list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Matrix to constrain the slopes. If provided, it overwrites the matrix (which is built internally) coming from the specification of <code>est</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.psi</code></td>
<td>

<p>Possible <em>fixed</em> breakpoint values to be accounted for <em>in addition</em> to the estimated ones; <code>slope</code> and <code>plot.segmented</code> will account for them correctly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>

<p>A possible <em>factor</em> meaning an interaction with the segmented term <code>x</code>. Hence, if specified, a different segmented relationship is fitted within each category of <code>by</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.x</code></td>
<td>

<p>an optional function meaning a function to apply to the covariate before fitting
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is used within <code>segreg</code> and <code>stepreg</code> to 'build' information about the segmented relationships to fit. 
</p>


<h3>Value</h3>

<p>The function simply returns the covariate with added attributes relevant to segmented term
</p>


<h3>Note</h3>

<p>If any value is provided in <code>fix.psi</code>, the corresponding slope difference coefficient will be labelled by <code>*.fixed.*</code>. The <code>slope</code> function will compute the 'right' slopes also accounting for the fixed breakpoints.
</p>


<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>See Also</h3>

<p><code>segreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##see ?segreg
</code></pre>


</div>