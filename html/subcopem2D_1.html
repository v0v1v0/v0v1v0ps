<div class="container">

<table style="width: 100%;"><tr>
<td>Bcopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bernstein Copula Approximation
</h2>

<h3>Description</h3>

<p>Bernstein copula approximation from the empirical subcopula of given bivariate data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bcopula(mat.xy, m, both.cont = FALSE, tolimit = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat.xy</code></td>
<td>

<p>2-column matrix with bivariate observations of a random vector <code class="reqn">(X,Y)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>integer value of approximation order, where <code class="reqn">m = 2,...,n</code> with <code class="reqn">n</code> equal to sample size. A recommended value for <code class="reqn">m</code> would be the minimum between <code class="reqn">\sqrt{n}</code> and <code class="reqn">50</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>both.cont</code></td>
<td>

<p>logical value, if TRUE then (X,Y) are considered (both) as continuos random variables, and jittering will be applied to repeated values (if any).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolimit</code></td>
<td>

<p>tolerance limit in numerical approximation of the inverse of the first partial derivatives of the estimated Bernstein copula.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each of the random variables <code class="reqn">X</code> and <code class="reqn">Y</code> may be of any kind (discrete, continuous, or mixed). NA values are not allowed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>bivariate Bernstein Copula function (BC) of order <code class="reqn">m</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>du</code></td>
<td>
<p>bivariate function <code class="reqn">\partial BC(u,v)/\partial u</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dv</code></td>
<td>
<p>bivariate function <code class="reqn">\partial BC(u,v)/\partial v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>du.inv</code></td>
<td>
<p>inverse of <code>du</code> with respect to v, given u and alpha (numerical approx)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dv.inv</code></td>
<td>
<p>inverse of <code>dv</code> with respect to u, given v and alpha (numerical approx)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>bivariate Bernstein copula density function of order <code class="reqn">m</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bilinearCopula</code></td>
<td>
<p>bivariate function of bilinear approximation of copula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bilinearSubcopula</code></td>
<td>
<p><code class="reqn">(m+1)\times (m+1)</code> matrix with empirical subcopula values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>sample size of bivariate observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>approximation order <code class="reqn">m</code> used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>both.cont</code></td>
<td>
<p>logical value, TRUE if both variables considered as continuous</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolimit</code></td>
<td>
<p>tolerance limit in numerical approximation of <code>du.inv</code> and <code>dv.inv</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subcopemObject</code></td>
<td>
<p>list object with the output from <code>subcopem</code> if <code>both.cont = FALSE</code> or from <code>subcopemc</code> if <code>both.cont = TRUE</code></p>
</td>
</tr>
</table>
<h3>Acknowledgement</h3>

<p>Development of this code was partially supported by Programa UNAM DGAPA PAPIIT through project IN115817.</p>


<h3>Note</h3>

<p>If both <code class="reqn">X</code> and <code class="reqn">Y</code> are continuous random variables it is faster and better to set <code>both.cont = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Arturo Erdely <a href="https://sites.google.com/site/arturoerdely">https://sites.google.com/site/arturoerdely</a>
</p>


<h3>References</h3>

<p>Erdely, A. (2017) <em>A subcopula based dependence measure</em>. Kybernetika 53(2), 231-243. DOI: 10.14736/kyb-2017-2-0231
</p>
<p>Nelsen, R.B. (2006) <em>An Introduction to Copulas</em>. Springer, New York.
</p>
<p>Sancetta, A., Satchell, S. (2004) <em>The Bernstein copula and its applications to modeling and approximations of multivariate distributions.</em> Econometric Theory 20, 535-562. DOI: 10.1017/S026646660420305X
</p>


<h3>See Also</h3>

<p><code>subcopem</code>, <code>subcopemc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## (X,Y) continuous random variables with copula FGM(param = 1)

# Theoretical formulas
FGMcopula &lt;- function(u, v) u*v*(1 + (1 - u)*(1 - v))
dFGM.du &lt;- function(u, v) (2*u - 1)*(v^2) + 2*v*(1 - u)
dFGM.dv &lt;- function(u, v) (2*v - 1)*(u^2) + 2*u*(1 - v)
A1 &lt;- function(u) 2*(1 - u)
A2 &lt;- function(u, z) sqrt(A1(u)^2 - 4*(A1(u) - 1)*z)
dFGM.du.inv &lt;- function(u, z) 2*z/(A1(u) + A2(u, z))
FGMdensity &lt;- function(u, v) 2*(1 - u - v + 2*u*v)

# Simulating FGM observations
n &lt;- 3000
U &lt;- runif(n)
Z &lt;- runif(n)
V &lt;- mapply(dFGM.du.inv, U, Z)

# Applying Bcopula to FGM simulated values
B &lt;- Bcopula(cbind(U, V), 50, TRUE)
str(B)

# Comparing theoretical values versus Bernstein and Bilinear approximations
u &lt;- 0.70; v &lt;- 0.55
FGMcopula(u, v); B[["copula"]](u, v); B[["bilinearCopula"]](u, v)
dFGM.du(u, v); B[["du"]](u, v)
dFGM.dv(u, v); B[["dv"]](u, v)
dFGM.du.inv(u, 0.8); B[["du.inv"]](u, 0.8)
FGMdensity(u, v); B[["density"]](u, v)
</code></pre>


</div>