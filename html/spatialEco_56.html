<div class="container">

<table style="width: 100%;"><tr>
<td>logistic.regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logistic and Auto-logistic regression</h2>

<h3>Description</h3>

<p>Performs a logistic (binomial) or auto-logistic
(spatially lagged binomial) regression using maximum
likelihood or penalized maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logistic.regression(
  ldata,
  y,
  x,
  penalty = TRUE,
  autologistic = FALSE,
  coords = NULL,
  bw = NULL,
  type = "inverse",
  style = "W",
  longlat = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ldata</code></td>
<td>
<p>data.frame object containing variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Dependent variable (y) in ldata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Independent variable(s) (x) in ldata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Apply regression penalty (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autologistic</code></td>
<td>
<p>Add auto-logistic term (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Geographic coordinates for auto-logistic model matrix
or sp object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Distance bandwidth to calculate spatial lags (if empty neighbors
result, need to increase bandwidth). If not provided it will be
calculated automatically based on the minimum distance that includes
at least one neighbor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Neighbor weighting scheme (see autocov_dist)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>Type of neighbor matrix (Wij), default is mean of neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>Are coordinates (coords) in geographic, lat/long (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to lrm</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It should be noted that the auto-logistic model (Besag 1972) is intended for
exploratory analysis of spatial effects. Auto-logistic are know to underestimate
the effect of environmental variables and tend to be unreliable (Dormann 2007).
Wij matrix options under style argument - B is the basic binary coding, W is row
standardized (sums over all links to n), C is globally standardized (sums over
all links to n), U is equal to C divided by the number of neighbours (sums over
all links to unity) and S is variance-stabilizing. Spatially lagged y defined as:
W(y)ij=sumj_(Wij yj)/ sumj_(Wij) where; Wij=1/Euclidean(i,j)
If the object passed to the function is an sp class there is no need to call the data
slot directly via "object@data", just pass the object name.
</p>


<h3>Value</h3>

<p>A list class object with the following components:
</p>

<ul>
<li>
<p> model - lrm model object (rms class)
</p>
</li>
<li>
<p> bandwidth - If AutoCov = TRUE returns the distance bandwidth used for the
auto-covariance function
</p>
</li>
<li>
<p> diagTable - data.frame of regression diagnostics
</p>
</li>
<li>
<p> coefTable - data.frame of regression coefficients (log-odds)
</p>
</li>
<li>
<p> Residuals - data.frame of residuals and standardized residuals
</p>
</li>
<li>
<p> AutoCov - If an auto-logistic model, AutoCov represents lagged
auto-covariance term
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jeffrey S. Evans  <a href="mailto:jeffrey_evans@tnc.org">jeffrey_evans@tnc.org</a>
</p>


<h3>References</h3>

<p>Besag, J.E., (1972) Nearest-neighbour systems and the auto-logistic model for binary
data. Journal of the Royal Statistical Society, Series B Methodological 34:75-83
</p>
<p>Dormann, C.F., (2007) Assessing the validity of autologistic regression. Ecological
Modelling 207:234-242
</p>
<p>Le Cessie, S., Van Houwelingen, J.C., (1992) Ridge estimators in logistic regression.
Applied Statistics 41:191-201
</p>
<p>Shao, J., (1993) Linear model selection by cross-validation. JASA 88:486-494
</p>


<h3>See Also</h3>

<p><code>lrm</code>
</p>
<p><code>autocov_dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> p = c("sf", "sp", "spdep", "rms")
 if(any(!unlist(lapply(p, requireNamespace, quietly=TRUE)))) { 
   m = which(!unlist(lapply(p, requireNamespace, quietly=TRUE)))
   message("Can't run examples, please install ", paste(p[m], collapse = " "))
 } else {
   invisible(lapply(p, require, character.only=TRUE))
 
 data(meuse, package = "sp")
 meuse &lt;- st_as_sf(meuse, coords = c("x", "y"), crs = 28992, 
                   agr = "constant")
   meuse$DepVar &lt;- rbinom(nrow(meuse), 1, 0.5)
 
 #### Logistic model
 lmodel &lt;- logistic.regression(meuse, y='DepVar', 
                   x=c('dist','cadmium','copper')) 
   lmodel$model
     lmodel$diagTable
       lmodel$coefTable
 
 #### Logistic model with factorial variable
 lmodel &lt;- logistic.regression(meuse, y='DepVar', 
             x=c('dist','cadmium','copper', 'soil')) 
   lmodel$model
     lmodel$diagTable
       lmodel$coefTable
 
  ### Auto-logistic model using 'autocov_dist' in 'spdep' package
  lmodel &lt;- logistic.regression(meuse, y='DepVar', 
              x=c('dist','cadmium','copper'), autologistic=TRUE, 
              coords=st_coordinates(meuse), bw=5000) 
    lmodel$model
      lmodel$diagTable
        lmodel$coefTable
    est &lt;- predict(lmodel$model, type='fitted.ind')
  
  #### Add residuals, standardized residuals and estimated probabilities
  VarNames &lt;- rownames(lmodel$model$var)[-1]
    meuse$AutoCov &lt;- lmodel$AutoCov 
    meuse$Residual &lt;- lmodel$Residuals[,1]
    meuse$StdResid &lt;- lmodel$Residuals[,2]
    meuse$Probs &lt;- predict(lmodel$model, 
                          sf::st_drop_geometry(meuse[,VarNames]),
 	                     type='fitted')  
  
 #### Plot fit and probabilities
 
 resid(lmodel$model, "partial", pl="loess") 
 
 # plot residuals
 resid(lmodel$model, "partial", pl=TRUE) 
  
 # global test of goodness of fit 
 resid(lmodel$model, "gof")
  
 # Approx. leave-out linear predictors
 lp1 &lt;- resid(lmodel$model, "lp1")            
  
 # Approx leave-out-1 deviance            
 -2 * sum(meuse$DepVar * lp1 + log(1-plogis(lp1)))
  
 # plot estimated probabilities at points
 plot(meuse['Probs'], pch=20)
 
}
</code></pre>


</div>