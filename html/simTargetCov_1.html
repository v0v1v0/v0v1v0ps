<div class="container">

<table style="width: 100%;"><tr>
<td>simTargetCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data Transformation or Simulation with Target Empirical Covariance Matrix</h2>

<h3>Description</h3>

<p><code>simTargetCov</code> transforms or simulates data with a target empirical covariance matrix supplied by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simTargetCov(n, p, target, X = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations for data matrix output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of variables for data matrix output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Target empirical covariance for data matrix output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix for transformation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anthony-Alexander Christidis, <a href="mailto:anthony.christidis@stat.ubc.ca">anthony.christidis@stat.ubc.ca</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Function to create target covariance matrix with kernel set to r
target_cor &lt;- function(r, p){
  Gamma &lt;- diag(p)
  for(i in 1:(p-1)){
    for(j in (i+1):p){
      Gamma[i,j] &lt;- Gamma[j,i] &lt;- r^(abs(i-j))
    }
  }
  return(Gamma)
}

# Transformation of data to target empirical covariance
dat.target.cov &lt;- simTargetCov(X = MASS::mvrnorm(30, mu = rep(0,6),
                               Sigma = target_cor(0.5,6)),
                               target = target_cor(0.5,6))
round(cov(dat.target.cov), 2)

# Simulation of data with target empirical covariance
sim.target.cov &lt;- simTargetCov(n = 30, p = 6, target = target_cor(0.5,6))
round(cov(sim.target.cov), 2)

</code></pre>


</div>