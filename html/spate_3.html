<div class="container">

<table style="width: 100%;"><tr>
<td>ffbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Forward Filtering Backward Sampling algorithm.
</h2>

<h3>Description</h3>

<p>Forward Filtering Backward Sampling algorithm for sampling from the
joint full conditional of the hidden state of a linear, Gaussian state
space model. To be more specific, one samples from <code class="reqn">P[\alpha|.]</code> where
<code class="reqn">\alpha</code> is specified through
</p>
<p style="text-align: center;"><code class="reqn">y_t = lp_t + H xi_t + nu_t,  \nu_t ~ N(0,\Omega)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\alpha_t = G \alpha_{t-1} + \epsilon_t,  \epsilon_t ~
  N(0,\Sigma).</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">ffbs(y, lp, G, Sigma, H, Omega, N = dim(y)[2],T = dim(y)[1],
      NF = dim(G)[1], lglk = FALSE, BwSp = TRUE, filt = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observed data in an T x N matrix with columns and rows corresponding to time and space, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lp</code></td>
<td>

<p>Mean (linear predictor) in an T x N matrix with columns and rows corresponding to time and space, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>

<p>Propagator matrix of the latent process <code class="reqn">\alpha</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>Innovation covariance matrix of the latent process <code class="reqn">\alpha</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>Observation matrix relating y to <code class="reqn">\alpha</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>

<p>Covariance matrix of the observation error <code class="reqn">\nu</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>Number of points in space.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>

<p>Number of points in time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NF</code></td>
<td>

<p>Dimension of the latent process <code class="reqn">\alpha</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lglk</code></td>
<td>

<p>Logical; if 'TRUE' the value of the log-likelihood is returned as well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BwSp</code></td>
<td>

<p>Logical; if 'TRUE' a sample from the full conditional of <code class="reqn">\alpha</code> is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filt</code></td>
<td>

<p>Logical; if 'TRUE' the filtered values for <code class="reqn">\alpha</code> are returned.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the context of the SPDE, <code class="reqn">\alpha</code> are the Fourier coefficients.</p>


<h3>Value</h3>

<p>A list with entries (depending on whether 'lglk', 'BwSp', 'filt' are
'TRUE' or 'FALSE'):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>simAlpha</code></td>
<td>
<p>A T x N matrix with a sample from the full conditional
of latent process <code class="reqn">\alpha</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>The evaluated log-likelihood,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtt</code></td>
<td>
<p>A T x N matrix with the mean of the full conditional of latent process <code class="reqn">\alpha</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Fabio Sigrist
</p>


</div>