<div class="container">

<table style="width: 100%;"><tr>
<td>sits_cluster_dendro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find clusters in time series samples</h2>

<h3>Description</h3>

<p>These functions support hierarchical agglomerative clustering in
sits. They provide support from creating a dendrogram and using it for
cleaning samples.
</p>
<p><code>link[sits]{sits_cluster_dendro()}</code> takes a tibble with time series and
produces a sits tibble with an added "cluster" column. The function first
calculates a dendrogram and obtains a validity index for best clustering
using the adjusted Rand Index. After cutting the dendrogram using the chosen
validity index, it assigns a cluster to each sample.
</p>
<p><code>link[sits]{sits_cluster_frequency()}</code> computes the contingency
table between labels
and clusters and produces a matrix.
Its input is a tibble produced by <code>link[sits]{sits_cluster_dendro()}</code>.
</p>
<p><code>link[sits]{sits_cluster_clean()}</code> takes a tibble with time series
that has an additional 'cluster' produced by
<code>link[sits]{sits_cluster_dendro()}</code>
and removes labels that are minority in each cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sits_cluster_dendro(
  samples,
  bands = NULL,
  dist_method = "dtw_basic",
  linkage = "ward.D2",
  k = NULL,
  palette = "RdYlGn"
)

## S3 method for class 'sits'
sits_cluster_dendro(
  samples,
  bands = NULL,
  dist_method = "dtw_basic",
  linkage = "ward.D2",
  k = NULL,
  palette = "RdYlGn",
  ...
)

## Default S3 method:
sits_cluster_dendro(samples, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Tibble with input set of time series (class "sits").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bands</code></td>
<td>
<p>Bands to be used in the clustering
(character vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_method</code></td>
<td>
<p>One of the supported distances (single char vector)
"dtw": DTW with a Sakoe-Chiba constraint.
"dtw2": DTW with L2 norm and Sakoe-Chiba constraint.
"dtw_basic": A faster DTW with less functionality.
"lbk": Keogh's lower bound for DTW.
"lbi": Lemire's lower bound for DTW.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkage</code></td>
<td>
<p>Agglomeration method to be used (single char vector)
One of "ward.D", "ward.D2", "single", "complete",
"average", "mcquitty", "median" or "centroid".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Desired number of clusters (overrides default value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>Color palette as per 'grDevices::hcl.pals()' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed
to dtwclust::tsclust() function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Tibble with "cluster" column (class "sits_cluster").
</p>


<h3>Note</h3>

<p>Please refer to the sits documentation available in
&lt;https://e-sensing.github.io/sitsbook/&gt; for detailed examples.
</p>


<h3>Author(s)</h3>

<p>Rolf Simoes, <a href="mailto:rolf.simoes@inpe.br">rolf.simoes@inpe.br</a>
</p>


<h3>References</h3>

<p>"dtwclust" package (https://CRAN.R-project.org/package=dtwclust)
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (sits_run_examples()) {
    # default
    clusters &lt;- sits_cluster_dendro(cerrado_2classes)
    # with parameters
    clusters &lt;- sits_cluster_dendro(cerrado_2classes,
                bands = "NDVI", k = 5)
}

</code></pre>


</div>