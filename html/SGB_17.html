<div class="container">

<table style="width: 100%;"><tr>
<td>GoodnessFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness of fit tests on the marginal distributions of each part in a SGB model
</h2>

<h3>Description</h3>

<p>Kolmogorov-Smirnov goodness of fit tests <br>
Cramer-von-Mises goodness of fit tests. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ks.SGB(u,shape1,shape2,scale,alpha=0.05)
cvm.SGB(u,shape1,shape2,scale,alpha=0.05)

## S3 method for class 'testSGB'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>

<p>data matrix of compositions (independent variables) <code class="reqn">(N \times D)</code>; <code class="reqn">D</code>: number of parts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>

<p>positive number, overall shape parameter of the SGB distribution. See <code>SGBdistrib</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>

<p>vector of length <code class="reqn"> D</code>, Dirichlet shape parameters of the SGB distribution. See <code>SGBdistrib</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>matrix of the same dimensions as <code>u</code>, containing the shape compositions, or positive number if the scales of all parts are identical. See <code>SGBdistrib</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>overall level of the test, default 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class "testSGB".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ks.SGB</code> calls <code>ks.test</code> and <code>cvm.SGB</code> calls <code>cvm.test</code>. <br>  
Consider <code class="reqn">z=C[(u/scale)^{shape1}]</code>, where <code class="reqn">C[.]</code> is the closure operation. The scale compositions <code class="reqn">scale</code> may be modelled with auxiliary variables. Under the SGB hypothesis, the components of  <code class="reqn"> z</code> should be marginally beta-distributed. The functions provide <code class="reqn"> D</code> tests, one for each part. <br>
Theoretically, the parameters should be known and not estimated on the data. Thus the test using estimated parameters is conservative. <br>
The cutoff value is based on the false discovery rate for multiple comparisons  (Benjamini and Hochberg, 1995), which is simply <code>alpha*i/D</code> for the i-th ordered p-value, i=1,...,D (number of tests). Reject the null hypothesis if at least one p-value is smaller than the cutoff. The overall level is then <code>alpha</code>. The proof of the result does not use an independence assumption between the tests.
</p>


<h3>Value</h3>

<p>A list of class 'testSGB' with the following components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either "One-sample Kolmogorov-Smirnov test" or "Cramer-von Mises test of goodness-of-fit"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Compositions</code></td>
<td>
<p>name of the dataset <code>u</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tests</code></td>
<td>
<p>data frame with <code class="reqn">D</code> rows and 3 columns: test statistics for each part against the beta distribution and corresponding p-values and cutoff. Any  p-value smaller than the cutoff means that the assumption of the beta distribution for all the margins is rejected.
</p>
</td>
</tr>
</table>
<p>A print method exists for the class "testSGB".
</p>


<h3>References</h3>

<p>Benjamini, Y. and Y. Hochberg (1995). Controlling the false discovery rate: A practical and powerful approach to multiple testing. <em>Journal of the Royal Statistical Society.</em> Series B (Methodological) 57 (1), 289-300. <br><br>
Birnbaum, Z. W.  and Fred H. Tingey (1951), One-sided confidence contours for probability distribution functions. <em>The Annals of Mathematical Statistics</em>, <strong>22</strong>/4, 592-596. <br><br>
Conover, William J.  (1971), <em>Practical Nonparametric Statistics.</em> New York: John Wiley &amp; Sons. Pages 295-301 (one-sample Kolmogorov test), 309-314 (two-sample Smirnov test). <br><br>
Csorgo, S. and Faraway, J.J. (1996) The exact and asymptotic distributions of Cramer-von Mises statistics. <em>Journal of the Royal Statistical Society</em>, Series B <strong>58</strong>, 221-234. <br><br>
Durbin, J. (1973), <em>Distribution theory for tests based on the sample distribution function.</em> SIAM. <br><br>
Marsaglia, G., Wai Wan Tsang and Jingbo Wang (2003), Evaluating Kolmogorov's distribution. <em>Journal of Statistical Software</em>, <strong>8</strong>/18.  
</p>


<h3>See Also</h3>

<p><code>SGBdistrib</code> for the theoretical distribution,  <code>oilr</code> for the regression results.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate 1000 random variates according to SGB(shape1,rep(1/3,3),shape2)
shape1 &lt;- 0.6
shape2 &lt;- c(10,20, 30)
rnum &lt;- rSGB(1000,shape1,rep(1,3)/3,shape2)
ks.SGB(rnum,shape1=shape1, shape2=shape2,scale=1)
## same result as
ks.SGB(rnum,shape1=shape1,scale= matrix(rep(1/3,3000),ncol=3), shape2=shape2)
library(goftest)
cvm.SGB(rnum,shape1=shape1,scale= matrix(rep(1/3,3000),ncol=3), shape2=shape2)

## Arctic lake data

# oilr is a SGB regression object, see \code{\link{oilr}}.
data(oilr)       # regSGB object
data(arc)
ua &lt;- arc[1:3]   # compositions

## Kolmogorov-Smirnov goodness of fit test
ks.SGB(ua,shape1=oilr[["par"]][1],shape2=oilr[["par"]][4:6],scale=oilr[["scale"]])
## Rounding shape1 affects the results less than rounding shape2.
ks.SGB(ua,shape1=round(oilr[["par"]][1],3),shape2=round(oilr[["par"]][4:6],1),
	 scale=oilr[["scale"]])
ks.SGB(ua,shape1=round(oilr[["par"]][1],1),shape2=round(oilr[["par"]][4:6],3),
	 scale=oilr[["scale"]])

## Cramer-von-Mises goodness of fit test
library(goftest)
cvm.SGB(ua,shape1=oilr[["par"]][1],shape2=oilr[["par"]][4:6],scale=oilr[["scale"]])

</code></pre>


</div>