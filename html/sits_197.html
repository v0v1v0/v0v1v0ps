<div class="container">

<table style="width: 100%;"><tr>
<td>sits_som</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use SOM for quality analysis of time series samples</h2>

<h3>Description</h3>

<p>These function use self-organized maps to perform
quality analysis in satellite image time series
</p>
<p><code>sits_som_map()</code> creates a SOM map, where high-dimensional data
is mapped into a two dimensional map, keeping the topological relations
between data patterns. Each sample is assigned to a neuron,
and neurons are placed in the grid based on similarity.
</p>
<p><code>sits_som_evaluate_cluster()</code> analyses the neurons of the SOM map,
and builds clusters based on them. Each cluster is a neuron
or a set of neuron categorized with same label.
It produces a tibble with the percentage of mixture of classes
in each cluster.
</p>
<p><code>sits_som_clean_samples()</code> evaluates the quality of the samples
based on the results of the SOM map.  The algorithm identifies noisy samples,
using 'prior_threshold' for the prior probability
and 'posterior_threshold' for the posterior probability.
Each sample receives an evaluation tag, according to the following rule:
(a) If the prior probability is &lt; 'prior_threshold', the sample is tagged
as "remove";
(b) If the prior probability is &gt;= 'prior_threshold' and the posterior
probability is &gt;='posterior_threshold', the sample is tagged as "clean";
(c) If the prior probability is &gt;= 'posterior_threshold' and
the posterior probability is &lt; 'posterior_threshold', the sample is tagged as
"analyze" for further inspection.
The user can define which tagged samples will be returned using the "keep"
parameter, with the following options: "clean", "analyze", "remove".
</p>


<h3>Usage</h3>

<pre><code class="language-R">sits_som_map(
  data,
  grid_xdim = 10,
  grid_ydim = 10,
  alpha = 1,
  rlen = 100,
  distance = "dtw",
  som_radius = 2,
  mode = "online"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A tibble with samples to be clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_xdim</code></td>
<td>
<p>X dimension of the SOM grid (default = 25).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_ydim</code></td>
<td>
<p>Y dimension of the SOM grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Starting learning rate
(decreases according to number of iterations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlen</code></td>
<td>
<p>Number of iterations to produce the SOM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The type of similarity measure (distance). The
following similarity measurements are supported:
<code>"euclidean"</code> and <code>"dtw"</code>. The default
similarity measure is <code>"dtw"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>som_radius</code></td>
<td>
<p>Radius of SOM neighborhood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Type of learning algorithm. The
following learning algorithm are available:
<code>"online"</code>, <code>"batch"</code>, and <code>"pbatch"</code>.
The default learning algorithm is <code>"online"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>sits_som_map()</code> produces a list with three members:
(1) the samples tibble, with one additional column indicating
to which neuron each sample has been mapped;
(2) the Kohonen map, used for plotting and cluster quality measures;
(3) a tibble with the labelled neurons,
where each class of each neuron is associated to two values:
(a) the prior probability that this class belongs to a cluster
based on the frequency of samples of this class allocated to the neuron;
(b) the posterior probability that this class belongs to a cluster,
using data for the neighbours on the SOM map.
</p>


<h3>Note</h3>

<p>To learn more about the learning algorithms, check the
<code>kohonen::supersom</code> function.
</p>
<p>The <code>sits</code> package implements the <code>"dtw"</code> (Dynamic Time
Warping) similarity measure. The <code>"euclidean"</code> similarity
measurement come from the
<code>kohonen::supersom (dist.fcts)</code> function.
</p>


<h3>Author(s)</h3>

<p>Lorena Alves, <a href="mailto:lorena.santos@inpe.br">lorena.santos@inpe.br</a>
</p>
<p>Karine Ferreira. <a href="mailto:karine.ferreira@inpe.br">karine.ferreira@inpe.br</a>
</p>


<h3>References</h3>

<p>Lorena Santos, Karine Ferreira, Gilberto Camara, Michelle Picoli,
Rolf Simoes, “Quality control and class noise reduction of satellite
image time series”. ISPRS Journal of Photogrammetry and Remote Sensing,
vol. 177, pp 75-88, 2021. https://doi.org/10.1016/j.isprsjprs.2021.04.014.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (sits_run_examples()) {
    # create a som map
    som_map &lt;- sits_som_map(samples_modis_ndvi)
    # plot the som map
    plot(som_map)
    # evaluate the som map and create clusters
    clusters_som &lt;- sits_som_evaluate_cluster(som_map)
    # plot the cluster evaluation
    plot(clusters_som)
    # clean the samples
    new_samples &lt;- sits_som_clean_samples(som_map)
}

</code></pre>


</div>