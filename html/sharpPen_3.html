<div class="container">

<table style="width: 100%;"><tr>
<td>dpilc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Select a Bandwidth for Local Quadratic and Cubic Regression
</h2>

<h3>Description</h3>

<p>Use direct plug-in methodology to select the bandwidth
of a local quadratic and local cubic Gaussian kernel regression estimate, 
as an extension of Wand's <code>dpill</code> function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpilc(xx, yy, blockmax = 5, divisor = 20, trim = 0.01,
                 proptrun = 0.05, gridsize = 401L, range.x = range(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>

<p>numeric vector of x data.
Missing values are not accepted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yy</code></td>
<td>

<p>numeric vector of y data.
This must be same length as <code>x</code>, and
missing values are not accepted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockmax</code></td>
<td>

<p>the maximum number of blocks of the data for construction
of an initial parametric estimate. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divisor</code></td>
<td>

<p>the value that the sample size is divided by to determine
a lower limit on the number of blocks of the data for
construction of an initial parametric estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>

<p>the proportion of the sample trimmed from each end in the
<code>x</code> direction before application of the plug-in methodology.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proptrun</code></td>
<td>

<p>the proportion of the range of <code>x</code> at each end truncated in the
functional estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>

<p>number of equally-spaced grid points over which the
function is to be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.x</code></td>
<td>

<p>vector containing the minimum and maximum values of <code>x</code> at which to
compute the estimate.
For density estimation the default is the minimum and maximum data values
with 5% of the range added to each end.
For regression estimation the default is the minimum and maximum data values.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a local cubic (also quadratic) extension of
the <code>dpill</code> function of Wand's KernSmooth package.  
The kernel is the standard normal density.
Least squares octic fits over blocks of data are used to 
obtain an initial estimate. As in Wand's implementation
of the Ruppert, Sheather and Wand selector, 
Mallow's <code class="reqn">C_p</code> is used to select
the number of blocks.  An option is available to 
make use of a periodic penalty (with possible trend) 
relating the 4th derivative of the regression function
to a constant (gamma) times the 2nd derivative.  This
avoids the need to calculate the octic fits and reverts
back to the original quartic fits of <code>dpill</code> with
appropriate adjustments to the estimated functionals
needed in the direct-plug-in bandwidth calculation. This 
code is similar to <code>dpilq</code> but uses a 6th degree
polyomial approximation instead of an 8th degree polynomial
approximation.
</p>


<h3>Value</h3>

<p>the selected bandwidth.
</p>


<h3>Warning</h3>

<p>If there are severe irregularities (i.e. outliers, sparse regions)
in the <code>x</code> values then the local polynomial smooths required for the
bandwidth selection algorithm may become degenerate and the function
will crash. Outliers in the <code>y</code> direction may lead to deterioration
of the quality of the selected bandwidth.
</p>


<h3>Author(s)</h3>

<p>D.Wang and W.J.Braun</p>


<h3>References</h3>

<p>Ruppert, D., Sheather, S. J. and Wand, M. P. (1995).
An effective bandwidth selector for local least squares
regression.
<em>Journal of the American Statistical Association</em>,
<b>90</b>, 1257â€“1270.
</p>
<p>Wand, M. P. and Jones, M. C. (1995).
<em>Kernel Smoothing.</em>
Chapman and Hall, London.
</p>


<h3>See Also</h3>

<p><code>ksmooth</code>, <code>locpoly</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- faithful$eruptions
y &lt;- faithful$waiting
plot(x, y)
h &lt;- dpill(x, y)
fit &lt;- locpoly(x, y, bandwidth = h, degree=1)
lines(fit)
h &lt;- dpilc(x, y)
fit &lt;- locpoly(x, y, bandwidth = h, degree=2)
lines(fit, col=3, lwd=2)
fit &lt;- locpoly(x, y, bandwidth = h, degree=3)
lines(fit, col=2, lwd=2)
</code></pre>


</div>