<div class="container">

<table style="width: 100%;"><tr>
<td>VLSTARjoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Joint linearity test</h2>

<h3>Description</h3>

<p>This function allows the user to test linearity against a Vector Smooth Transition Autoregressive Model with a single transition variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VLSTARjoint(y, exo = NULL, st, st.choice = FALSE, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>data.frame</code> or <code>matrix</code> of dependent variables of dimension <code>(Txn)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exo</code></td>
<td>
<p>(optional) <code>data.frame</code> or <code>matrix</code> of exogenous variables of dimension <code>(Txk)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>single transition variable for all the equation of dimension <code>(Tx1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st.choice</code></td>
<td>
<p>boolean identifying whether the transition variable should be selected from a matrix of <code>R</code> potential variables of dimension <code>(TxR)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Confidence level</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a VLSTAR model with a unique transition variable, <code class="reqn">s_{1t} = s_{2t} = \dots = s_{\widetilde{n}t} = s_t</code>, a generalization of the
linearity test presented in Luukkonen, Saikkonen and Terasvirta (1988) may be implemented.
</p>
<p>Assuming a 2-state VLSTAR model, such that
</p>
<p style="text-align: center;"><code class="reqn">y_t = B_{1}z_t + G_tB_{2}z_t + \varepsilon_t.</code>
</p>

<p>Where the null <code class="reqn">H_{0} : \gamma_{j} = 0</code>, <code class="reqn">j = 1, \dots, \widetilde{n}</code>, is such that <code class="reqn">G_t \equiv (1/2)/\widetilde{n}</code> and the
previous Equation is linear. When the null cannot be rejected, an identification problem of the parameter <code class="reqn">c_{j}</code> in the transition function
emerges, that can be solved through a first-order Taylor expansion around <code class="reqn">\gamma_{j} = 0</code>.
</p>
<p>The approximation of the logistic function with a first-order Taylor expansion is given by
</p>
<p style="text-align: center;"><code class="reqn">G(s_t; \gamma_{j},c_{j}) = (1/2) + (1/4)\gamma_{j}(s_t-c_{j}) + r_{jt}</code>
</p>

<p style="text-align: center;"><code class="reqn">= a_{j}s_t + b_{j} + r_{jt}</code>
</p>

<p>where <code class="reqn">a_{j} = \gamma_{j}/4</code>, <code class="reqn">b_{j} = 1/2 - a_{j}c_{j}</code> and <code class="reqn">r_{j}</code> is the error of the approximation. If <code class="reqn">G_t</code> is specified as follows
</p>
<p style="text-align: center;"><code class="reqn">G_t = diag\big\{a_{1}s_t + b_{1} + r_{1t}, \dots, a_{\widetilde{n}}s_t+b_{\widetilde{n}} + r_{\widetilde{n}t}\big\}</code>
</p>

<p style="text-align: center;"><code class="reqn">= As_t + B + R_t</code>
</p>

<p>where <code class="reqn">A = diag(a_{1}, \dots, a_{\widetilde{n}})</code>, <code class="reqn">B = diag(b_{1},\dots, b_{\widetilde{n}})</code> e <code class="reqn">R_t = diag(r_{1t}, \dots,
                                                                                                                       r_{\widetilde{n}t})</code>, <code class="reqn">y_t</code> can be written as
</p>
<p style="text-align: center;"><code class="reqn">y_t = B_{1}z_t + (As_t + B + R_t)B_{2}z_t+\varepsilon_t</code>
</p>

<p style="text-align: center;"><code class="reqn">= (B_{1} + BB_{2})z_t+AB_{2}z_ts_t + R_tB_{2}z_t + \varepsilon_t</code>
</p>

<p style="text-align: center;"><code class="reqn">= \Theta_{0}z_t + \Theta_{1}z_ts_t+\varepsilon_t^{*}</code>
</p>

<p>where <code class="reqn">\Theta_{0} = B_{1} + B_{2}'B</code>, <code class="reqn">\Theta_{1} = B_{2}'A</code> and <code class="reqn">\varepsilon_t^{*} = R_tB_{2} + \varepsilon_t</code>. Under the null,
<code class="reqn">\Theta_{0} = B_{1}</code> and <code class="reqn">\Theta_{1} = 0</code>, while the previous model is linear, with <code class="reqn">\varepsilon_t^{*} = \varepsilon_t</code>. It
follows that the Lagrange multiplier test, under the null, is derived from the score
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial \log L(\widetilde{\theta})}{\partial \Theta_{1}} = \sum_{t=1}^{T}z_ts_t(y_t - \widetilde{B}_{1}z_t)'\widetilde{\Omega}^{-1} = S(Y - Z\widetilde{B}_{1})\widetilde{\Omega}^{-1},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">S = z_{1}'s_{1}\\\vdots\\ z_t's_t</code>
</p>

<p>and where <code class="reqn">\widetilde{B}_{1}</code> and <code class="reqn">\widetilde{\Omega}</code> are estimated from the model in <code class="reqn">H_{0}</code>. If <code class="reqn">P_{Z} = Z(Z'Z)^{-1}Z'</code> is the
projection matrix of Z, the LM test is specified as follows
</p>
<p style="text-align: center;"><code class="reqn">LM = tr\big\{\widetilde{\Omega}^{-1}(Y - Z\widetilde{B}_{1})'S\big[S'(I_t - P_{Z})S\big]^{-1}S'(Y-Z\widetilde{B}_{1})\big\}.</code>
</p>

<p>Under the null, the test statistics is distributed as a <code class="reqn">\chi^{2}</code> with <code class="reqn">\widetilde{n}(p\cdot\widetilde{n} + k)</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>An object of class <code>VLSTARjoint</code>.
</p>


<h3>Author(s)</h3>

<p>Andrea Bucci
</p>


<h3>References</h3>

<p>Luukkonen R., Saikkonen P. and Terasvirta T. (1988), Testing Linearity Against Smooth Transition Autoregressive Models. <em>Biometrika</em>, 75: 491-499
</p>
<p>Terasvirta T. and Yang Y. (2015), Linearity and Misspecification Tests for Vector Smooth Transition Regression Models. <em>CREATES Research Paper 2014-4</em>
</p>


</div>