<div class="container">

<table style="width: 100%;"><tr>
<td>estcovparm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Covariance Parameters</h2>

<h3>Description</h3>

<p>Used to estimate spatial covariance parameters for a few different spatial models.
Estimated parameters can then be used in <code>predict.slmfit()</code> to predict values at unobserved locations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estcovparm(
  response,
  designmatrix,
  xcoordsvec,
  ycoordsvec,
  CorModel = "Exponential",
  estmethod = "REML",
  covestimates = c(NA, NA, NA)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a vector of a response variable, possibly with
missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designmatrix</code></td>
<td>
<p>is the matrix of covariates used to regress
the response on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcoordsvec</code></td>
<td>
<p>is a vector of x coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycoordsvec</code></td>
<td>
<p>is a vector of y coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorModel</code></td>
<td>
<p>is the covariance structure. By default,
<code>CorModel</code> is <code>"Exponential"</code> but other options are
<code>"Spherical"</code> and <code>"Gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estmethod</code></td>
<td>
<p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covestimates</code></td>
<td>
<p>is an optional vector of covariance parameter estimates (nugget, partial sill, range). If these are given and <code>estmethod = "None"</code>, the the provided vector are treated as the estimators to create the covariance structure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is a helper function used internally in <code>predict.slmfit()</code>.
</p>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li> <p><code>parms.est</code>, a vector of estimated covariance parameters
</p>
</li>
<li> <p><code>Sigma</code>, the fitted covariance matrix for all of the sites
</p>
</li>
<li> <p><code>qrV</code>, the qr decomposition
</p>
</li>
<li> <p><code>b.hat</code>, the vector of estimated fixed effect coefficients
</p>
</li>
<li> <p><code>covbi</code>, the inverse of the covariance matrix for the fixed effects
</p>
</li>
<li> <p><code>covb</code>, the covariance matrix for the fixed effects
</p>
</li>
<li> <p><code>min2loglik</code>, minus two times the loglikelihood
</p>
</li>
</ul>
</div>