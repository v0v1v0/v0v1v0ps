<div class="container">

<table style="width: 100%;"><tr>
<td>blmpSDPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian log-marginal posterior probabilities for spatial panel models</h2>

<h3>Description</h3>

<p>Calculates log-marginal posterior probabilities for model comparison purposes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blmpSDPD(
  formula,
  data,
  W,
  index,
  model = list("ols", "slx", "sar", "sdm", "sem", "sdem"),
  effect = "individual",
  ldet = NULL,
  lndetspec = list(m = NULL, p = NULL, sd = NULL),
  dynamic = FALSE,
  tlaginfo = list(ind = NULL),
  LYtrans = FALSE,
  incr = NULL,
  rintrv = TRUE,
  prior = "uniform",
  bprarg = 1.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description for the model to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial weights matrix (row-normalized)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>the indexes (names of the variables for the spatial and time component)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a list of models for which the Bayesian log-marginal posterior probabilities need to be calculated, list("ols","slx","sar","sdm","sem","sdem")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>type of fixed effects, c("none","individual","time","twoways"), default ="individual"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ldet</code></td>
<td>
<p>Type of computation of log-determinant, c("full","mc"). Default "full" for smaller problems, "mc" for large problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lndetspec</code></td>
<td>
<p>specifications for the calculation of the log-determinant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dynamic</code></td>
<td>
<p>logical, if TRUE time lag of the dependent variable is included. Default = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlaginfo</code></td>
<td>
<p>specification for the time lag, default = list(ind=NULL), <em>ind</em> - i-th column in the data frame which represents the time lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LYtrans</code></td>
<td>
<p>logical, default FALSE. If Lee-Yu transformation should be used for demeaning of the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incr</code></td>
<td>
<p>increment for vector of values for rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rintrv</code></td>
<td>
<p>logical, default TRUE, calculates eigenvalues of W. If FALSE, the interval for rho is (-1,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>type of prior to be used c("uniform","beta"). Default "uniform"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bprarg</code></td>
<td>
<p>argument for the beta prior. Default = 1.01</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the Spatial Durbin Error Model (SDEM) the marginal distribution is:
</p>
<p style="text-align: center;"><code class="reqn">p(\lambda|y) = \frac{1}{p(y)} p(\lambda) \Gamma(a) (2\pi)^{-a} \frac{|P|^{T-1}}{|Z'Z|^{1/2}} (e'e)^{-a}</code>
</p>

<p>For the Spatial Durbin Model (SDM) the marginal distribution is:
</p>
<p style="text-align: center;"><code class="reqn">p(\rho|y) = \frac{1}{p(y)} p(\rho) \Gamma(a) (2\pi)^{-a} \frac{|P|}{|Z'Z|^{1/2}} (e'e)^{-a}</code>
</p>

<p>where <code class="reqn">p(\lambda)</code> is prior on <code class="reqn">\lambda</code> and <code class="reqn">p(\rho)</code> is prior on <code class="reqn">\rho</code>,
either uniform <code class="reqn">\frac{1}{D}</code>, <code class="reqn">D = 1/\omega_{max}-1/\omega_{min}</code> or beta prior;
No priors on beta and sige;
<code class="reqn">\omega_{max}</code> and <code class="reqn">\omega_{min}</code> are the maximum and minimum eigenvalues of
<em>W</em> - spatial weights matrix;
<code class="reqn">Z = X</code> for lag or error model and <code class="reqn">Z = [X WX]</code> for Durbin model;
X - matrix of <code class="reqn">k</code> covariates.
</p>
<p>For more details, see LeSage (2014).
</p>
<p>Based on MatLab function log_marginal_panelprob.m.
</p>
<p>In <em>tlaginfo = list(ind = NULL)</em>:
</p>
<p><em>ind</em> i-th column in <em>data</em> which represents the time lag,
if not specified then the lag from the dependent variable is created and the
panel is reduced from n<em>t to n</em>(t-1)
</p>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lmarginal</code></td>
<td>
<p>log-marginal posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>model probability</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rozeta Simonovska
</p>


<h3>References</h3>

<p>LeSage, J. P., &amp; Parent, O. (2007). Bayesian model averaging for spatial econometric models. <em>Geographical Analysis, 39(3)</em>, 241-267.
</p>
<p>LeSage, J. P. (2014). Spatial econometric panel data model specification: A Bayesian approach. <em>Spatial Statistics, 9</em>, 122-145.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## US States Production data
data(Produc, package = "plm")
## Spatial weights row-normalized matrix of 48 US states
data(usaww, package = "splm")
isrownor(usaww)
form1 &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
res1  &lt;- blmpSDPD(formula = form1, data=Produc, W = usaww,
                 index = c("state","year"),
                 model = list("sar","sdm","sem","sdem"),
                 effect = "twoways")
res1
res2  &lt;- blmpSDPD(formula = form1, data = Produc, W = usaww,
                 index = c("state","year"),
                 model = list("sar","sdm","sem","sdem"),
                 effect = "twoways", dynamic = TRUE)
res2

</code></pre>


</div>