<div class="container">

<table style="width: 100%;"><tr>
<td>direct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Direct estimators.</h2>

<h3>Description</h3>

<p>This function calculates direct estimators of domain means.</p>


<h3>Usage</h3>

<pre><code class="language-R">direct(y, dom, sweight, domsize, data, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> vector specifying the individual values of the variable for which we want to estimate the domain means. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dom</code></td>
<td>
<p> vector or factor (same size as <code>y</code>) with domain codes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sweight</code></td>
<td>
<p> optional vector (same size as <code>y</code>) with sampling weights. When this argument is not included, by default estimators 
are obtained under simple random sampling (SRS). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domsize</code></td>
<td>
 <p><code>D*2</code> data frame with domain codes in the first column and the corresponding domain population sizes in the second column. This argument is not required when <code>sweight</code> is not included and <code>replace=TRUE</code> (SRS with replacement).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> optional data frame containing the variables named in <code>y</code>, <code>dom</code> and <code>sweight</code>. By default the variables are taken from the environment from which <code>direct</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p> logical variable with default value <code>FALSE</code> for random sampling without replacement within each domain is considered 
and <code>TRUE</code> for random sampling with replacement within each domain.</p>
</td>
</tr>
</table>
<h3>Value</h3>

 
<p>The function returns a data frame of size <code>D*5</code> with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Domain</code></td>
<td>
<p> domain codes in ascending order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampSize</code></td>
<td>
<p> domain sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Direct</code></td>
<td>
<p> direct estimators of domain means of variable <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SD</code></td>
<td>
<p> estimated standard deviations of domain direct estimators. If sampling design is SRS or Poisson sampling, estimated variances are unbiased. Otherwise, estimated variances are obtained under the approximation that second order inclusion probabilities are the product of first order inclusion probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p> absolute value of percent coefficients of variation of domain direct estimators.</p>
</td>
</tr>
</table>
<p>Cases with NA values in <code>y</code>, <code>dom</code> or <code>sweight</code> are ignored.

</p>


<h3>References</h3>

<p>- Cochran, W.G. (1977). Sampling techniques. Wiley, New York.
</p>
<p>- Rao, J.N.K. (2003). Small Area Estimation. Wiley, London.
</p>
<p>- Sarndal, C.E., Swensson, B. and Wretman, J. (1992). Model Assisted Survey Sampling. Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code>pssynt</code> for post-stratified synthetic estimator, <code>ssd</code> for sample size dependent estimator. 
</p>
<p>In case that the sampling design is known, see packages <code>survey</code> or <code>sampling</code> for more exact variance estimation.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data set with synthetic income data for provinces (domains)
data(incomedata)

# Load population sizes of provinces
data(sizeprov)   

# Compute Horvitz-Thompson direct estimator of mean income for each 
# province under random sampling without replacement within each province.
result1 &lt;- direct(y=income, dom=prov, sweight=weight,
                   domsize=sizeprov[,2:3], data=incomedata)
result1

# The same but using province labels as domain codes
result2 &lt;- direct(y=incomedata$income, dom=incomedata$provlab,
                  sweight=incomedata$weight, domsize=sizeprov[,c(1,3)])
result2

# The same, under SRS without replacement within each province.
result3 &lt;- direct(y=income ,dom=provlab, domsize=sizeprov[,c(1,3)],
                  data=incomedata)
result3

# Compute direct estimator of mean income for each province
# under SRS with replacement within each province
result4 &lt;- direct(y=income, dom=provlab, data=incomedata, replace=TRUE)
result4
</code></pre>


</div>