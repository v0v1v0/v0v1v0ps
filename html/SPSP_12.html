<div class="container">

<table style="width: 100%;"><tr>
<td>SPSP_step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The selection step with the input of the solution paths.</h2>

<h3>Description</h3>

<p>A function to select the relevant predictors by partitioning the solution paths (the SPSP algorithm) 
based on the user provided solution paths <code>BETA</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SPSP_step(
  x,
  y,
  family = c("gaussian", "binomial"),
  BETA,
  standardize = TRUE,
  intercept = TRUE,
  init = 1,
  R = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>independent variables as a matrix, of dimension nobs x nvars; each row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable. Quantitative for <code>family="gaussian"</code> or <code>family="poisson"</code> (non-negative counts). 
For <code>family="binomial"</code> should be either a factor with two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>either a character string representing one of the built-in families, or else a glm() family object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BETA</code></td>
<td>
<p>the solution paths obtained from a prespecified fitting step <code>fitfun.SP = lasso.glmnet</code> etc. It must be 
a p by k matrix, should be thicker and thicker, each column corresponds to a lambda, and lambda gets smaller and smaller.
It is the returned coefficient matrix <code>beta</code> from a <code>glmnet</code> object, or a <code>ncvreg</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>whether need standardization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical. If x is a data.frame, this argument determines if the resulting model matrix should contain 
a separate intercept or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>initial coefficients, starting from init-th estimator of the solution paths. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>sorted adjacent distances, default is NULL. Will be calculated inside.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional optional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta_SPSP</code></td>
<td>
<p>the estimated coefficients of SPSP selected model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>the estimated relevant sets;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonzero</code></td>
<td>
<p>the selected covariates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero</code></td>
<td>
<p>the covariates that are not selected;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>the boundaries for abs(beta);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the sorted adjacent distances;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>the estimated intercept when <code>intercept == T</code>.</p>
</td>
</tr>
</table>
<p>This object has attribute contains: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mod.fit</code></td>
<td>
<p>the fitted penalized regression within the input function <code>fitfun.SP</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family of fitted object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfun.SP</code></td>
<td>
<p>the function to obtain the solution paths for the SPSP algorithm;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.fitfun.SP</code></td>
<td>
<p>a named list containing additional arguments for the function <code>fitfun.SP</code>.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(HighDim)
library(glmnet)

x &lt;- as.matrix(HighDim[,-1])
y &lt;- HighDim[,1]

lasso_fit &lt;- glmnet(x = x, y = y, alpha = 1, intercept = FALSE)

# SPSP+Lasso method
K &lt;- dim(lasso_fit$beta)[2]
LBETA &lt;- as.matrix(lasso_fit$beta)

spsp_lasso_1 &lt;- SPSP_step(x = x, y = y, BETA = LBETA, 
                          init = 1, standardize = FALSE, intercept = FALSE)
head(spsp_lasso_1$nonzero)
head(spsp_lasso_1$beta_SPSP)

</code></pre>


</div>