<div class="container">

<table style="width: 100%;"><tr>
<td>plot_simtheory</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Simulated Data and Target Distribution Data by Name or Function for Continuous or Count Variables</h2>

<h3>Description</h3>

<p>This plots simulated continuous or count (regular or zero-inflated, Poisson or Negative Binomial) data and overlays data
(if <code>overlay</code> = TRUE) generated from the target distribution.  The target is specified by name (plus up to 4 parameters) or
PDF function <code>fx</code> (plus support bounds).  Due to the integration involved in finding the CDF from the PDF supplied by
<code>fx</code>, only continuous <code>fx</code> may be supplied.  Both are plotted as histograms (using <code>geom_histogram</code>).
If a continuous target distribution is specified (<code>cont_var = TRUE</code>), the simulated data <code class="reqn">y</code> is
scaled and then transformed (i.e. <code class="reqn">y = sigma * scale(y) + mu</code>) so that it has the same mean (<code class="reqn">mu</code>) and variance
(<code class="reqn">sigma^2</code>) as the target distribution.  It works for valid or invalid power method PDF's.  It returns a
<code>ggplot2-package</code> object so the user can save it or
modify it as necessary.  The graph parameters (i.e. <code>title</code>, <code>sim_color</code>, <code>target_color</code>,
<code>legend.position</code>, <code>legend.justification</code>, <code>legend.text.size</code>, <code>title.text.size</code>,
<code>axis.text.size</code>, and <code>axis.title.size</code>) are inputs to the <code>ggplot2-package</code> functions so information about
valid inputs can be obtained from that package's documentation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_simtheory(sim_y, title = "Simulated Data Values", ylower = NULL,
  yupper = NULL, sim_color = "dark blue", overlay = TRUE,
  cont_var = TRUE, target_color = "dark green", binwidth = NULL,
  nbins = 100, Dist = c("Benini", "Beta", "Beta-Normal",
  "Birnbaum-Saunders", "Chisq", "Dagum", "Exponential", "Exp-Geometric",
  "Exp-Logarithmic", "Exp-Poisson", "F", "Fisk", "Frechet", "Gamma", "Gaussian",
  "Gompertz", "Gumbel", "Kumaraswamy", "Laplace", "Lindley", "Logistic",
  "Loggamma", "Lognormal", "Lomax", "Makeham", "Maxwell", "Nakagami",
  "Paralogistic", "Pareto", "Perks", "Rayleigh", "Rice", "Singh-Maddala",
  "Skewnormal", "t", "Topp-Leone", "Triangular", "Uniform", "Weibull",
  "Poisson", "Negative_Binomial"), params = NULL, fx = NULL, lower = NULL,
  upper = NULL, seed = 1234, sub = 1000, legend.position = c(0.975,
  0.9), legend.justification = c(1, 1), legend.text.size = 10,
  title.text.size = 15, axis.text.size = 10, axis.title.size = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim_y</code></td>
<td>
<p>a vector of simulated data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title for the graph (default = "Simulated Data Values")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylower</code></td>
<td>
<p>the lower y value to use in the plot (default = NULL, uses minimum simulated y value) on the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yupper</code></td>
<td>
<p>the upper y value (default = NULL, uses maximum simulated y value) on the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_color</code></td>
<td>
<p>the histogram fill color for the simulated variable (default = "dark blue")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay</code></td>
<td>
<p>if TRUE (default), the target distribution is also plotted given either a distribution name (and parameters)
or PDF function fx (with support bounds = lower, upper)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont_var</code></td>
<td>
<p>TRUE (default) for continuous variables, FALSE for count variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_color</code></td>
<td>
<p>the histogram fill color for the target distribution (default = "dark green")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>the width of bins to use when creating the histograms (default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>the number of bins to use when creating the histograms (default = 100); overridden by <code>binwidth</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dist</code></td>
<td>
<p>name of the distribution. The possible values are: "Benini", "Beta", "Beta-Normal", "Birnbaum-Saunders", "Chisq",
"Exponential", "Exp-Geometric", "Exp-Logarithmic", "Exp-Poisson", "F", "Fisk", "Frechet", "Gamma", "Gaussian", "Gompertz",
"Gumbel", "Kumaraswamy", "Laplace", "Lindley", "Logistic", <br>"Loggamma", "Lognormal", "Lomax", "Makeham", "Maxwell",
"Nakagami", "Paralogistic", "Pareto", "Perks", "Rayleigh", "Rice", "Singh-Maddala", <br>"Skewnormal", "t", "Topp-Leone", "Triangular",
"Uniform", "Weibull", "Poisson", and "Negative_Binomial".
Please refer to the documentation for each package (either <code>stats-package</code>, <code>VGAM-package</code>, or
<code>triangle</code>) for information on appropriate parameter inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>a vector of parameters (up to 4) for the desired distribution (keep NULL if <code>fx</code> supplied instead); for
Poisson variables, must be lambda (mean) and the probability of a structural zero (use 0 for regular Poisson variables); for
Negative Binomial variables, must be size, mean and the probability of a structural zero (use 0 for regular NB variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>a PDF input as a function of x only, i.e. <code>fx = function(x) 0.5 * (x - 1)^2</code>; must return a scalar
(keep NULL if <code>Dist</code> supplied instead)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower support bound for a supplied <code>fx</code>, else keep NULL (note: if an error is thrown from <code>uniroot</code>,
try a slightly higher lower bound; i.e., 0.0001 instead of 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the upper support bound for a supplied <code>fx</code>, else keep NULL (note: if an error is thrown from <code>uniroot</code>,
try a lower upper bound; i.e., 100000 instead of Inf)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed value for random number generation (default = 1234)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>the number of subdivisions to use in the integration to calculate the CDF from <code>fx</code>; if no result, try increasing
sub (requires longer computation time; default = 1000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>the position of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.justification</code></td>
<td>
<p>the justification of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>the size of the legend labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.text.size</code></td>
<td>
<p>the size of the plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.size</code></td>
<td>
<p>the size of the axes text (tick labels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.size</code></td>
<td>
<p>the size of the axes titles</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot2-package</code> object.
</p>


<h3>References</h3>

<p>Carnell R (2017). triangle: Provides the Standard Distribution Functions for the Triangle Distribution. R package version 0.11.
<a href="https://CRAN.R-project.org/package=triangle">https://CRAN.R-project.org/package=triangle</a>.
</p>
<p>Fialkowski AC (2018). SimMultiCorrData: Simulation of Correlated Data with Multiple Variable Types. R package version 0.2.2.
<a href="https://CRAN.R-project.org/package=SimMultiCorrData">https://CRAN.R-project.org/package=SimMultiCorrData</a>.
</p>
<p>Headrick TC, Sheng Y, &amp; Hodis FA (2007). Numerical Computing and Graphics for the Power Method Transformation Using
Mathematica. Journal of Statistical Software, 19(3):1-17. <br> doi: <a href="http://doi.org/10.18637/jss.v019.i03">10.18637/jss.v019.i03</a>.
</p>
<p>Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.
</p>
<p>Yee TW (2018). VGAM: Vector Generalized Linear and Additive Models. R package version 1.0-5. <a href="https://CRAN.R-project.org/package=VGAM">https://CRAN.R-project.org/package=VGAM</a>.
</p>


<h3>See Also</h3>

<p><code>calc_theory</code>,
<code>ggplot</code>, <code>geom_histogram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Using normal mixture variable from contmixvar1 example
Nmix &lt;- contmixvar1(n = 1000, "Polynomial", means = 0, vars = 1,
  mix_pis = c(0.4, 0.6), mix_mus = c(-2, 2), mix_sigmas = c(1, 1),
  mix_skews = c(0, 0), mix_skurts = c(0, 0), mix_fifths = c(0, 0),
  mix_sixths = c(0, 0))
plot_simtheory(Nmix$Y_mix[, 1], title = "Mixture of Normal Distributions",
  fx = function(x) 0.4 * dnorm(x, -2, 1) + 0.6 * dnorm(x, 2, 1),
  lower = -5, upper = 5)
## Not run: 
# Mixture of Beta(6, 3), Beta(4, 1.5), and Beta(10, 20)
Stcum1 &lt;- calc_theory("Beta", c(6, 3))
Stcum2 &lt;- calc_theory("Beta", c(4, 1.5))
Stcum3 &lt;- calc_theory("Beta", c(10, 20))
mix_pis &lt;- c(0.5, 0.2, 0.3)
mix_mus &lt;- c(Stcum1[1], Stcum2[1], Stcum3[1])
mix_sigmas &lt;- c(Stcum1[2], Stcum2[2], Stcum3[2])
mix_skews &lt;- c(Stcum1[3], Stcum2[3], Stcum3[3])
mix_skurts &lt;- c(Stcum1[4], Stcum2[4], Stcum3[4])
mix_fifths &lt;- c(Stcum1[5], Stcum2[5], Stcum3[5])
mix_sixths &lt;- c(Stcum1[6], Stcum2[6], Stcum3[6])
mix_Six &lt;- list(seq(0.01, 10, 0.01), c(0.01, 0.02, 0.03),
  seq(0.01, 10, 0.01))
Bstcum &lt;- calc_mixmoments(mix_pis, mix_mus, mix_sigmas, mix_skews,
  mix_skurts, mix_fifths, mix_sixths)
Bmix &lt;- contmixvar1(n = 10000, "Polynomial", Bstcum[1], Bstcum[2]^2,
  mix_pis, mix_mus, mix_sigmas, mix_skews, mix_skurts, mix_fifths,
  mix_sixths, mix_Six)
plot_simtheory(Bmix$Y_mix[, 1], title = "Mixture of Beta Distributions",
  fx = function(x) mix_pis[1] * dbeta(x, 6, 3) + mix_pis[2] *
    dbeta(x, 4, 1.5) + mix_pis[3] * dbeta(x, 10, 20), lower = 0, upper = 1)

## End(Not run)

</code></pre>


</div>