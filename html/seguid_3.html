<div class="container">

<table style="width: 100%;"><tr>
<td>seguid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SEGUID checksums for linear, circular, single- and double-stranded sequences</h2>

<h3>Description</h3>

<p>SEGUID checksums for linear, circular, single- and double-stranded sequences
</p>


<h3>Usage</h3>

<pre><code class="language-R">seguid(seq, alphabet = "{DNA}", form = c("long", "short", "both"))

lsseguid(seq, alphabet = "{DNA}", form = c("long", "short", "both"))

csseguid(seq, alphabet = "{DNA}", form = c("long", "short", "both"))

ldseguid(watson, crick, alphabet = "{DNA}", form = c("long", "short", "both"))

cdseguid(watson, crick, alphabet = "{DNA}", form = c("long", "short", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seq</code></td>
<td>
<p>(character string) The sequence for which the checksum
should be calculated.  The sequence may only comprise of symbols
in the alphabet specified by the <code>alphabet</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphabet</code></td>
<td>
<p>(character string) The type of sequence used.
If <code>"{DNA}"</code> (default), then the input is a DNA sequence.
If <code>"{RNA}"</code>, then the input is an RNA sequence.
If <code>"{protein}"</code>, then the input is an amino-acid sequence.
If <code>"{DNA-extended}"</code> or <code>"{RNA-extended}"</code>, then the input is a
DNA or RNA sequence specified an extended set of symbols, including
If <code>"{protein-extended}"</code>, then the input is an amino-acid sequence
with an extended set of symbols, including IUPAC symbols (4).
A custom alphabet may also be used.
A non-complementary alphabet is specified as a comma-separated
set of single symbols, e.g. <code>"X,Y,Z"</code>.
A complementary alphabet is specified as a comma-separated
set of paired symbols, e.g. <code>"AT,CG"</code>.
It is also possible to extend a pre-defined alphabet, e.g.
<code>"{DNA},XY"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>(character string) How the checksum is presented.
If <code>"long"</code> (default), the full-length checksum is outputted.
If <code>"short"</code>, the short, six-digit checksum is outputted.
If <code>"both"</code>, both the short and the long checksums are outputted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>watson, crick</code></td>
<td>
<p>(character strings) Two reverse-complementary DNA
sequences. Both sequences should be specified in the 5'-to-3' direction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The SEGUID functions return a single character string, if <code>form</code> is
either <code>"long"</code> or <code>"short"</code>. If <code>form</code> is <code>"both"</code>, then a character
vector of length two is return, where the first component holds the
"short" checksum and the second the "long" checksum.
The long checksum, without the prefix, is string with 27 characters.
The short checksum, without the prefix, is the first six characters
of the long checksum.
All checksums are prefixed with a label indicating which SEGUID
method was used.
Except for <code>seguid()</code>, which uses <em>base64</em> encoding, all functions
produce checksums using the <em>base64url</em> encoding ("Base 64 Encoding
with URL and Filename Safe Alphabet").
</p>
<p><code>seguid()</code> calculates the SEGUID v1 checksum for a linear,
single-stranded sequence.
</p>
<p><code>lsseguid()</code> calculates the SEGUID v2 checksum for a linear,
single-stranded sequence.
</p>
<p><code>csseguid()</code> calculates the SEGUID v2 checksum for a circular,
single-stranded sequence.
</p>
<p><code>ldseguid()</code> calculates the SEGUID v2 checksum for a linear,
double-stranded sequence.
</p>
<p><code>cdseguid()</code> calculates the SEGUID v2 checksum for a circular,
double-stranded sequence.
</p>


<h3>Base64 and Base64url encodings</h3>

<p>The base64url encoding is the base64 encoding with non-URL-safe characters
substituted with URL-safe ones. Specifically, the plus symbol (<code>+</code>) is
replaced by the minus symbol (<code>-</code>), and the forward slash (<code>/</code>) is
replaced by the underscore symbol (<code style="white-space: pre;">⁠_⁠</code>).
</p>
<p>The Base64 checksum, which is used for the original SEGUID checksum,
is not guaranteed to comprise symbols that can
safely be used as-is in Uniform Resource Locator (URL). Specifically,
it may consist of forward slashes (<code>/</code>) and plus symbols (<code>+</code>), which
are characters that carry special meaning in a URL.
For the same reason, a Base64 checksum cannot safely be used
as a file or directory name, because it may have a forward slash.
</p>
<p>The checksum returned is always 27-character long. This is because the
representation always end with a padding character (<code>=</code>) so that the
length is a multiple of four character. We relax this requirement, by
dropping the padding character.
</p>


<h3>References</h3>


<ol>
<li>
<p> Babnigg, G., Giometti, CS. A database of unique protein sequence
identifiers for proteome studies. Proteomics.
2006 Aug;6(16):4514-22. <a href="https://doi.org/10.1002/pmic.200600032">doi:10.1002/pmic.200600032</a>.
</p>
</li>
<li>
<p> Josefsson, S., The Base16, Base32, and Base64 Data Encodings,
RFC 4648, <a href="https://doi.org/10.17487/RFC4648">doi:10.17487/RFC4648</a>, October 2006,
<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>.
</p>
</li>
<li>
<p> Wikpedia article 'Nucleic acid notation', February 2024.
<a href="https://en.wikipedia.org/wiki/Nucleic_acid_notation">https://en.wikipedia.org/wiki/Nucleic_acid_notation</a>.
</p>
</li>
<li>
<p> Wikpedia article 'Nucleic acid notation', February 2024,
<a href="https://en.wikipedia.org/wiki/Amino_acid">https://en.wikipedia.org/wiki/Amino_acid</a>.
</p>
</li>
<li>
<p> Wikipedia article 'SHA-1' (Secure Hash Algorithm 1), December 2023.
<a href="https://en.wikipedia.org/wiki/SHA-1">https://en.wikipedia.org/wiki/SHA-1</a>.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">## SEGUID v1 on linear single-stranded DNA
seguid("GATTACA")
#&gt; seguid=tp2jzeCM2e3W4yxtrrx09CMKa/8

## SEGUID v2 on linear single-stranded DNA
lsseguid("GATTACA")
#&gt; lsseguid=tp2jzeCM2e3W4yxtrrx09CMKa_8

## SEGUID v2 on cicular single-stranded DNA
## GATTACA = ATTACAG = ... = AGATTAC
csseguid("GATTACA")
#&gt; csseguid=mtrvbtuwr6_MoBxvtm4BEpv-jKQ

## SEGUID v2 on blunt, linear double-stranded DNA
##   GATTACA
##   CTAATGT
ldseguid("GATTACA", "TGTAATC")
#&gt; ldseguid=AcRsEcNFrui5wCxI7xxo6wnDYPY

## SEGUID v2 on staggered, linear double-stranded DNA
##   -ATTACA
##   CTAAT--
ldseguid("-ATTACA", "--TAATC")
#&gt; ldseguid=98Klwxd3ZQPGHqnH3BheIuZVHQQ

## SEGUID v2 on circular double-stranded DNA
## GATTACA = ATTACAG = ... = AGATTAC
## CTAATGT = TAATGTC = ... = TCTAATG
cdseguid("GATTACA", "TGTAATC")
#&gt; cdseguid=zCuq031K3_-40pArbl-Y4N9RLnA

## SEGUID v2 on linear single-stranded expanded
## epigenetic sequence (Viner et al., 2024)
viner_DNA &lt;- "{DNA},m1,h2,f3,c4"
lsseguid("AmT2C", alphabet = viner_DNA)
#&gt; lsseguid=MW4Rh3lGY2mhwteaSKh1-Kn2fGA

## SEGUID v2 on linear double-stranded expanded
## epigenetic sequence (Viner et al., 2024)
ldseguid("AmT2C", "GhA1T", alphabet = viner_DNA)
#&gt; ldseguid=rsPDjP4SWr3-ploCeXTdTA80u0Y
</code></pre>


</div>