<div class="container">

<table style="width: 100%;"><tr>
<td>profile2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method for profiling (in 2d) fitted max-stable objects</h2>

<h3>Description</h3>

<p>Computes profile surfaces for fitted max-stable models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'maxstab'
profile2d(fitted, params, ranges, n = 10, plot = TRUE,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>An object of class “maxstab”. Most often, it will be
the output of the function <code>fitmaxstab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A character vector giving the two model parameters that
are to be profiled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranges</code></td>
<td>
<p>A matrix corresponding to the ranges for the profiled
model parameters that must be explored. Each row corresponds to
one model parameter range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of profiled model parameter that must be
considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the profile surface is
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra options that must be passed to the
<code>plot</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two arguments: <code>coord</code> and <code>llik</code>. <code>coord</code>
is a matrix representing the grid where the profiled model parameters
are fixed. <code>llik</code> the corresponding pairwise log-likelihood.
</p>


<h3>Warnings</h3>

<p>This function can be <b>really</b> time consuming!
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##Define the coordinates of each location
n.site &lt;- 30
locations &lt;- matrix(rnorm(2*n.site, sd = sqrt(.2)), ncol = 2)
colnames(locations) &lt;- c("lon", "lat")

##Simulate a max-stable process - with unit Frechet margins
data &lt;- rmaxstab(30, locations, cov.mod = "whitmat", nugget = 0, range = 30,
smooth = 0.5)

##Now define the spatial model for the GEV parameters
param.loc &lt;- -10 + 2 * locations[,2]
param.scale &lt;- 5 + 2 * locations[,1] + locations[,2]^2
param.shape &lt;- rep(0.2, n.site)

##Transform the unit Frechet margins to GEV
for (i in 1:n.site)
  data[,i] &lt;- frech2gev(data[,i], param.loc[i], param.scale[i],
param.shape[i]) 

##Define a model for the GEV margins to be fitted
##shape ~ 1 stands for the GEV shape parameter is constant
##over the region
loc.form &lt;- loc ~ lat
scale.form &lt;- scale ~ lon + (lat^2)
shape.form &lt;- shape ~ 1

##Fit a max-stable process
##  1- using the Schlather representation
fitted &lt;- fitmaxstab(data, locations, "whitmat", loc.form, scale.form,
                     shape.form)

##Plot the profile pairwise log-likelihood for the smooth parameter
ranges &lt;- rbind(c(9,11), c(.3, .8))
profile2d(fitted, c("range", "smooth"), ranges = ranges)

## End(Not run)
</code></pre>


</div>