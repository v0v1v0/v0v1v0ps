<div class="container">

<table style="width: 100%;"><tr>
<td>cfa_meas_inv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of a Unidimensional Factor Model under Full and Partial
Measurement Invariance
</h2>

<h3>Description</h3>

<p>Estimates a unidimensional factor model based on the normal distribution fitting
function under full and partial measurement invariance.
Item loadings and item intercepts are successively freed based on the largest
modification index and a chosen significance level <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cfa_meas_inv(dat, group, weights=NULL, alpha=0.01, verbose=FALSE, op=c("~1","=~"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Data frame containing items
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Vector of group identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional vector of sampling weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical indicating whether progress should be shown
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>Operators (intercepts or loadings) for which estimation should be freed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with several entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pars_mi</code></td>
<td>
<p>Model parameters under full invariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_pi</code></td>
<td>
<p>Model parameters under partial invariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_mi</code></td>
<td>
<p>Fitted model under full invariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_pi</code></td>
<td>
<p>Fitted model under partial invariance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>More output</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>See also <code>sirt::invariance.alignment</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Factor model under full and partial invariance
#############################################################################

#--- data simulation

set.seed(65)
G &lt;- 3  # number of groups
I &lt;- 5  # number of items
# define lambda and nu parameters
lambda &lt;- matrix(1, nrow=G, ncol=I)
nu &lt;- matrix(0, nrow=G, ncol=I)
err_var &lt;- matrix(1, nrow=G, ncol=I)

# define size of noninvariance
dif &lt;- 1
#- 1st group: N(0,1)
lambda[1,3] &lt;- 1+dif*.4; nu[1,5] &lt;- dif*.5
#- 2nd group: N(0.3,1.5)
gg &lt;- 2 ;
lambda[gg,5] &lt;- 1-.5*dif; nu[gg,1] &lt;- -.5*dif
#- 3nd group: N(.8,1.2)
gg &lt;- 3
lambda[gg,4] &lt;- 1-.7*dif; nu[gg,2] &lt;- -.5*dif
#- define distributions of groups
mu &lt;- c(0,.3,.8)
sigma &lt;- sqrt(c(1,1.5,1.2))
N &lt;- rep(1000,3) # sample sizes per group

#* use simulation function
dat &lt;- sirt::invariance_alignment_simulate(nu, lambda, err_var, mu, sigma, N,
                exact=TRUE)

#--- estimate CFA
mod &lt;- sirt::cfa_meas_inv(dat=dat[,-1], group=dat$group, verbose=TRUE, alpha=0.05)
mod$pars_mi
mod$pars_pi

## End(Not run)
</code></pre>


</div>