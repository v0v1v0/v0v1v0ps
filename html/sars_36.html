<div class="container">

<table style="width: 100%;"><tr>
<td>sar_p1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the Persistence function 1 model</h2>

<h3>Description</h3>

<p>Fit the Persistence function 1 model to SAR data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sar_p1(data, start = NULL, grid_start = 'partial',
  grid_n = NULL, normaTest = 'none',
  homoTest = 'none', homoCor = 'spearman', verb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataset in the form of a dataframe with two columns: 
the first with island/site areas, and the second with the species richness
of each island/site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>NULL or custom parameter start values for the optimisation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_start</code></td>
<td>
<p>Should a grid search procedure be implemented to test multiple starting parameter values. Can be one of 'none', 'partial' or 'exhaustive' The default is set to 'partial'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_n</code></td>
<td>
<p>If <code>grid_start = exhaustive</code>, the number of points sampled in the starting parameter space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normaTest</code></td>
<td>
<p>The test used to test the normality of the residuals of the
model. Can be any of 'lillie' (Lilliefors test
, 'shapiro' (Shapiro-Wilk test of normality), 'kolmo'
(Kolmogorov-Smirnov test), or 'none' (no residuals normality test is undertaken; the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homoTest</code></td>
<td>
<p>The test used to check for homogeneity of the residuals of
the model. Can be any of 'cor.fitted' (a correlation of the residuals with
the model fitted values), 'cor.area' (a correlation of the
residuals with the area values), or 'none' (no residuals homogeneity test is undertaken; the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homoCor</code></td>
<td>
<p>The correlation test to be used when <code>homoTest !='none'</code>. Can be any of 'spearman'
(the default), 'pearson', or 'kendall'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>Whether or not to print certain warnings (default = TRUE)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is fitted using non-linear regression. The model parameters are estimated
by minimizing the residual sum of squares with an unconstrained Nelder-Mead optimization algorithm
and the <code>optim</code> function. To avoid numerical problems and speed up the convergence process,
the starting values used to run the optimization algorithm are carefully chosen. However, if this does
not work, custom values can be provided (using the <code>start</code> argument), or a more comprehensive search
can be undertaken using the <code>grid_start</code> argument. See the vignette for more information.
The fitting process also determines the observed shape of the model fit,
and whether or not the observed fit is asymptotic (see Triantis et al. 2012 for further details).
Model validation can be undertaken by assessing the normality (<code>normaTest</code>) and homogeneity (<code>homoTest</code>)
of the residuals and a warning is provided in <code>summary.sars</code> if either test is chosen and fails.
A selection of information criteria (e.g. AIC, BIC) are returned and can be used to compare models
(see also <code>sar_average</code>).
</p>
<p>As grid_start has a random component, when <code>grid_start != 'none'</code> in your model fitting, you can
get slightly different results each time you fit a model
</p>
<p>The parameter confidence intervals returned in sigConf are just simple confidence intervals, calculated as 2 * standard error.
</p>


<h3>Value</h3>

<p>A list of class 'sars' with the following components: 
</p>

<ul>
<li> <p><strong>par</strong>  The model parameters
</p>
</li>
<li> <p><strong>value</strong>  Residual sum of squares
</p>
</li>
<li> <p><strong>counts</strong>   The number of iterations for the convergence of the fitting algorithm
</p>
</li>
<li> <p><strong>convergence</strong>  Numeric code returned from optim indicating model convergence (0 = converged)
</p>
</li>
<li> <p><strong>message</strong>  Any message from the model fit algorithm
</p>
</li>
<li> <p><strong>hessian</strong>  A symmetric matrix giving an estimate of the Hessian at the solution found
</p>
</li>
<li> <p><strong>verge</strong>  Logical code indicating that optim model convergence value is zero
</p>
</li>
<li> <p><strong>startValues</strong>  The start values for the model parameters used in the optimisation
</p>
</li>
<li> <p><strong>data</strong>  Observed data
</p>
</li>
<li> <p><strong>model</strong>  A list of model information (e.g. the model name and formula)
</p>
</li>
<li> <p><strong>calculated</strong>   The fitted values of the model
</p>
</li>
<li> <p><strong>residuals</strong>  The model residuals
</p>
</li>
<li> <p><strong>AIC</strong>  The AIC value of the model
</p>
</li>
<li> <p><strong>AICc</strong>  The AICc value of the model
</p>
</li>
<li> <p><strong>BIC</strong>  The BIC value of the model
</p>
</li>
<li> <p><strong>R2</strong>  The R2 value of the model
</p>
</li>
<li> <p><strong>R2a</strong>  The adjusted R2 value of the model
</p>
</li>
<li> <p><strong>sigConf</strong>  The model coefficients table
</p>
</li>
<li> <p><strong>normaTest</strong>  The results of the residuals normality test
</p>
</li>
<li> <p><strong>homoTest</strong>  The results of the residuals homogeneity test
</p>
</li>
<li> <p><strong>observed_shape</strong>  The observed shape of the model fit
</p>
</li>
<li> <p><strong>asymptote</strong>  A logical value indicating whether the observed fit is asymptotic
</p>
</li>
<li> <p><strong>neg_check</strong>  A logical value indicating whether negative fitted values have been returned</p>
</li>
</ul>
<p>The <code>summary.sars</code> function returns a more useful summary of
the model fit results, and the <code>plot.sars</code> plots the model fit.
</p>


<h3>References</h3>

<p>Triantis, K.A., Guilhaumon, F. &amp; Whittaker, R.J. (2012) The island species-area
relationship: biology and statistics. Journal of Biogeography, 39, 215-231.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(galap)
fit &lt;- sar_p1(galap)
summary(fit)
plot(fit)
</code></pre>


</div>