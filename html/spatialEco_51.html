<div class="container">

<table style="width: 100%;"><tr>
<td>knn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial K nearest neighbor</h2>

<h3>Description</h3>

<p>Find K nearest neighbors for two spatial objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">knn(
  y,
  x,
  k = 1,
  d = NULL,
  ids = NULL,
  weights.y = NULL,
  weights.x = NULL,
  indexes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Spatial sf object or coordinates matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Spatial points or polygons object or coordinates matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Optional search radius</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>Optional column of ID's in x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.y</code></td>
<td>
<p>A vector or matrix representing covariates of y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.x</code></td>
<td>
<p>A vector or matrix representing covariates of x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexes</code></td>
<td>
<p>(FALSE/TRUE) Return row indexes of x neighbors</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Finds nearest neighbor in x based on y and returns rownames, index and distance,
If ids is NULL, rownames of x are returned. If coordinate matrix provided, 
columns need to be ordered [X,Y]. If a radius for d is specified than a maximum 
search radius is imposed. If no neighbor is found, a neighbor is not returned  
</p>
<p>You can specify weights to act as covariates for x and y. The vectors or matrices
must match row dimensions with x and y as well as columns matching between weights.
In other words, the covariates must match and be numeric.
</p>


<h3>Value</h3>

<p>A data.frame with row indexes (optional), rownames, ids (optional) and 
distance of k
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt;
</p>


<h3>See Also</h3>

<p><code>nn2</code> for details on search algorithm
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(sp, quietly = TRUE)) {
library(sf)
  data(meuse, package = "sp")
  meuse &lt;- st_as_sf(meuse, coords = c("x", "y"), crs = 28992, 
                    agr = "constant")
 
# create reference and target obs
idx &lt;- sample(1:nrow(meuse), 10) 
  pts &lt;- meuse[idx,]
    meuse &lt;- meuse[-idx,]
    meuse$IDS &lt;- 1:nrow(meuse)
 
# Find 2 neighbors in meuse
( nn &lt;- knn(pts, meuse, k=2, ids = "IDS", indexes = TRUE) )
  plot( st_geometry(pts), pch=19, main="KNN")
    plot(st_geometry(meuse[nn[,1],]), pch=19, col="red", add=TRUE)

# Using covariates (weights)
wx = as.matrix(st_drop_geometry(meuse[,1:3]))
wy = as.matrix(st_drop_geometry(pts[,1:3]))

( nn &lt;- knn(pts, meuse, k=2, ids = "IDS", indexes = TRUE,
            weights.y=wy, weights.x=wx) )
  plot(st_geometry(pts), pch=19, main="KNN")
    plot(st_geometry(meuse[nn[,1],]), pch=19, col="red")
	  
# Using coordinate matrices
y &lt;- st_coordinates(pts)[,1:2]
x &lt;- st_coordinates(meuse)[,1:2]
knn(y, x, k=2)

} else { 
  cat("Please install sp package to run example", "\n")
}

  
</code></pre>


</div>