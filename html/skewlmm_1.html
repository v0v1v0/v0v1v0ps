<div class="container">

<table style="width: 100%;"><tr>
<td>acfresid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Autocorrelation function for smn.lmm or smsn.lmm residuals

</h2>

<h3>Description</h3>

<p>This function calculates the empirical autocorrelation function for the within-subject residuals from a smn.lmm or smsn.lmm fit. The autocorrelation values are calculated using pairs of residuals within-subjects. The autocorrelation function is useful for investigating serial correlation models for discrete-time data, preferably equally spaced.</p>


<h3>Usage</h3>

<pre><code class="language-R">acfresid(object, maxLag, resLevel = "marginal", resType = "normalized",
    calcCI = FALSE, levelCI, MCiter, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLag</code></td>
<td>
<p>An optional integer giving the maximum lag for which the autocorrelation should be calculated. Defaults to maximum lag in the within-subject residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resLevel</code></td>
<td>
<p><code>"marginal"</code> (default) or <code>"conditional"</code>. An optional character string specifying which residual should be used. For details see <code>residuals.SMN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resType</code></td>
<td>
<p><code>"response"</code>, <code>"normalized"</code> (default), or <code>"modified"</code>. An optional character string specifying which type of residual should be used. For details see <code>residuals.SMN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcCI</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default). A logical value indicating if Monte Carlo confidence intervals should be computed for the conditionally independent model, which can be used for testing if the autocorrelations are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levelCI</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the confidence level that should be used in the Monte Carlo confidence intervals. Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCiter</code></td>
<td>
<p>An optional discrete value indicating the number of Monte Carlo samples that should be used to compute the confidence intervals. Default is <code>300</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional value used to specify seeds inside the function. Default is to use a random seed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns lag, ACF, and n.used representing, respectively, the lag between residuals within a pair, the corresponding empirical autocorrelation, and the number of pairs used. If <code>calcCI=TRUE</code>, the data frame has two extra columns containing the confidence intervals for the conditionally independent model. The returned value inherits from class acfresid.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Pinheiro, J. C. &amp; Bates, D. M. (2000). Mixed-Effects Models in S and S-PLUS. Springer, New York, NY.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code>smn.lmm</code>, <code>smsn.lmm</code>, <code>plot.acfresid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
acf1 = acfresid(fm1)
acf1
plot(acf1)

## computing simulated bands
acfCI = acfresid(fm1, calcCI=TRUE)
plot(acfCI)
  
</code></pre>


</div>