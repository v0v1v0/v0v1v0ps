<div class="container">

<table style="width: 100%;"><tr>
<td>Signac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classification of cellular phenotypes in single cell data</h2>

<h3>Description</h3>

<p><code>Signac</code> trains and then uses an ensemble of neural networks to classify cellular phenotypes using an expression matrix or Seurat object.
The neural networks are trained with the HPCA training data using only features that are present
in both the single cell and HPCA training data set. <code>Signac</code> returns annotations at each level of the classification
hierarchy, which are then converted into cell type labels using <code>GenerateLabels</code>. For a faster alternative,
try <code>SignacFast</code>, which uses pre-computed neural network models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Signac(
  E,
  R = "default",
  spring.dir = NULL,
  N = 100,
  num.cores = 1,
  threshold = 0,
  smooth = TRUE,
  impute = TRUE,
  verbose = TRUE,
  do.normalize = TRUE,
  return.probability = FALSE,
  hidden = 1,
  set.seed = TRUE,
  seed = "42",
  graph.used = "nn"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>a sparse gene (rows) by cell (column) matrix, or a Seurat object. Rows are HUGO symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Reference data. If 'default', R is set to GetTrainingData_HPCA().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spring.dir</code></td>
<td>
<p>If using SPRING, directory to categorical_coloring_data.json. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of machine learning models to train (for nn and svm). Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.cores</code></td>
<td>
<p>Number of cores to use. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Probability threshold for assigning cells to "Unclassified." Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>if TRUE, smooths the cell type classifications. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute</code></td>
<td>
<p>if TRUE, gene expression values are imputed prior to cell type classification (see <code>KSoftImpute</code>). Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if TRUE, code will report outputs. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.normalize</code></td>
<td>
<p>if TRUE, cells are normalized to the mean library size. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.probability</code></td>
<td>
<p>if TRUE, returns the probability associated with each cell type label. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidden</code></td>
<td>
<p>Number of hidden layers in the neural network. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.seed</code></td>
<td>
<p>If true, seed is set to ensure reproducibility of these results. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>if set.seed is TRUE, seed is set to 42.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.used</code></td>
<td>
<p>If using Seurat object by default, Signac uses the nearest neighbor graph in the graphs field of the Seurat object. Other options are "wnn" to use weighted nearest neighbors, as well as "snn" to use shared nearest neighbors.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of character vectors: cell type annotations (L1, L2, ...) at each level of the hierarchy
as well as 'clusters' for the Louvain clustering results.
</p>


<h3>See Also</h3>

<p><code>SignacFast</code>, a faster alternative that only differs from <code>Signac</code> in nuanced T cell phenotypes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# download single cell data for classification
file.dir = "https://cf.10xgenomics.com/samples/cell-exp/3.0.0/pbmc_1k_v3/"
file = "pbmc_1k_v3_filtered_feature_bc_matrix.h5"
download.file(paste0(file.dir, file), "Ex.h5")

# load data, process with Seurat
library(Seurat)
E = Read10X_h5(filename = "Ex.h5")
pbmc &lt;- CreateSeuratObject(counts = E, project = "pbmc")

# run Seurat pipeline
pbmc &lt;- SCTransform(pbmc, verbose = FALSE)
pbmc &lt;- RunPCA(pbmc, verbose = FALSE)
pbmc &lt;- RunUMAP(pbmc, dims = 1:30, verbose = FALSE)
pbmc &lt;- FindNeighbors(pbmc, dims = 1:30, verbose = FALSE)

# classify cells
labels = Signac(E = pbmc)
celltypes = GenerateLabels(labels, E = pbmc)

# add labels to Seurat object, visualize
pbmc &lt;- Seurat::AddMetaData(pbmc, metadata=celltypes$CellTypes_novel, col.name = "immmune")
pbmc &lt;- Seurat::SetIdent(pbmc, value='immmune')
DimPlot(pbmc)

# save results
saveRDS(pbmc, "example_pbmcs.rds")

## End(Not run)
</code></pre>


</div>