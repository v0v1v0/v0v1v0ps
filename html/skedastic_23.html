<div class="container">

<table style="width: 100%;"><tr>
<td>goldfeld_quandt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goldfeld-Quandt Tests for Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function implements the two methods (parametric and nonparametric) of
Goldfeld and Quandt (1965) for testing for heteroskedasticity
in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">goldfeld_quandt(
  mainlm,
  method = c("parametric", "nonparametric"),
  deflator = NA,
  prop_central = 1/3,
  group1prop = 1/2,
  alternative = c("greater", "less", "two.sided"),
  prob = NA,
  twosidedmethod = c("doubled", "kulinskaya"),
  restype = c("ols", "blus"),
  statonly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character indicating which of the two tests derived in
Goldfeld and Quandt (1965) should be implemented.
Possible values are "parametric" and "nonparametric". Default is
"parametric". It is acceptable to specify only the first letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deflator</code></td>
<td>
<p>Either a character specifying a column name from the
design matrix of <code>mainlm</code> or an integer giving the index of a
column of the design matrix. This variable is suspected to be
related to the error variance under the alternative hypothesis.
<code>deflator</code> may not correspond to a column of 1's (intercept).
Default <code>NA</code> means the data will be left in its current order
(e.g. in case the existing index is believed to be associated with
error variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_central</code></td>
<td>
<p>A double specifying the proportion of central
observations to exclude from the F test (when <code>method</code> is
<code>"parametric"</code> only). <code>round</code> is
used to ensure the number of central observations is an integer. The
value must be small enough to allow the two auxiliary regressions to
be fit; otherwise an error is thrown. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group1prop</code></td>
<td>
<p>A double specifying the proportion of remaining
observations <em>(after excluding central observations)</em> to allocate
to the first group. The default value of <code>1 / 2</code> means that an
equal number of observations is assigned to the first and second groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character specifying the form of alternative
hypothesis. If it is suspected that the
error variance is positively associated with the deflator variable,
<code>"greater"</code>. If it is suspected that the error variance is
negatively associated with deflator variable, <code>"less"</code>. If no
information is available on the suspected direction of the association,
<code>"two.sided"</code>. Defaults to <code>"greater"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>A vector of probabilities corresponding to values of the test
statistic (number of peaks) from 0 to <code class="reqn">n-1</code> inclusive (used
only when <code>method</code> is <code>"nonparametric"</code>). If
<code>NA</code> (the default), probabilities are calculated within the
function by calling <code>ppeak</code>. The user can improve computational
performance of the test (for instance, when the test is being used
repeatedly in a simulation) by pre-specifying the exact probability
distribution of the number of peaks using this argument, e.g. by
calling the <code class="reqn">n</code>th element of <code>dpeakdat</code> (or <code class="reqn">(n-p)</code>th
element, if BLUS residuals are used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosidedmethod</code></td>
<td>
<p>A character indicating the method to be used to compute
two-sided <code class="reqn">p</code>-values for the parametric test when <code>alternative</code>
is <code>"two.sided"</code>. The argument is passed to
<code>twosidedpval</code> as its <code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restype</code></td>
<td>
<p>A character specifying which residuals to use: <code>"ols"</code>
for OLS residuals (the default) or the <code>"blus"</code> for
BLUS residuals. The advantage of using BLUS residuals is
that, under the null hypothesis, the assumption that the random series
is independent and identically distributed is met (whereas with OLS
residuals it is not). The disadvantage of using BLUS residuals is that
only <code class="reqn">n-p</code> residuals are used rather than the full <code class="reqn">n</code>. This
argument is ignored if <code>method</code> is <code>"parametric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statonly</code></td>
<td>
<p>A logical. If <code>TRUE</code>, only the test statistic value
is returned, instead of an object of <code>class</code>
<code>"htest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional further arguments to pass to <code>blus</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parametric test entails putting the data rows in increasing
order of some specified deflator (one of the explanatory variables). A
specified proportion of the most central observations (under this
ordering) is removed, leaving a subset of lower observations and a subset
of upper observations. Separate OLS regressions are fit to these two
subsets of observations (using all variables from the original model).
The test statistic is the ratio of the sum of squared residuals from the
'upper' model to the sum of squared residuals from the 'lower' model.
Under the null hypothesis, the test statistic is exactly F-distributed
with numerator and denominator degrees of freedom equal to
<code class="reqn">(n-c)/2 - p</code> where <code class="reqn">n</code> is the number of observations in the
original regression model, <code class="reqn">c</code> is the number of central observations
removed, and <code class="reqn">p</code> is the number of columns in the design matrix (number of
parameters to be estimated, including intercept).
</p>
<p>The nonparametric test entails putting the residuals of the linear model in
increasing order of some specified deflator (one of the explanatory
variables). The test statistic is the number of peaks, with the <code class="reqn">j</code>th
absolute residual <code class="reqn">|e_j|</code> defined as a peak if <code class="reqn">|e_j|\ge|e_i|</code>
for all <code class="reqn">i&lt;j</code>. The first observation does not constitute a peak. If
the number of peaks is large relative to the distribution of peaks under
the null hypothesis, this constitutes evidence for heteroskedasticity.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"htest"</code>. If object is
not assigned, its attributes are displayed in the console as a
<code>tibble</code> using <code>tidy</code>.
</p>


<h3>References</h3>

<p>Goldfeld SM, Quandt RE (1965).
“Some Tests for Homoscedasticity.”
<em>Journal of the American Statistical Association</em>, <b>60</b>(310), 539–547.
</p>


<h3>See Also</h3>

<p><code>lmtest::gqtest</code>, another implementation
of the Goldfeld-Quandt Test (parametric method only).
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
goldfeld_quandt(mtcars_lm, deflator = "qsec", prop_central = 0.25)
# This is equivalent to lmtest::gqtest(mtcars_lm, fraction = 0.25, order.by = mtcars$qsec)
goldfeld_quandt(mtcars_lm, deflator = "qsec", method = "nonparametric",
 restype = "blus")
goldfeld_quandt(mtcars_lm, deflator = "qsec", prop_central = 0.25, alternative = "two.sided")
goldfeld_quandt(mtcars_lm, deflator = "qsec", method = "nonparametric",
 restype = "blus", alternative = "two.sided")
</code></pre>


</div>