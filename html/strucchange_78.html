<div class="container">

<table style="width: 100%;"><tr>
<td>recresid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recursive Residuals</h2>

<h3>Description</h3>

<p>A generic function for computing the recursive residuals
(standardized one step prediction errors) of a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
recresid(x, y, start = ncol(x) + 1, end = nrow(x),
  tol = sqrt(.Machine$double.eps)/ncol(x), qr.tol = 1e-7,
  engine = c("R", "C"), ...)
## S3 method for class 'formula'
recresid(formula, data = list(), ...)
## S3 method for class 'lm'
recresid(x, data = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y, formula</code></td>
<td>
<p>specification of the linear regression model:
either by a regressor matrix <code>x</code> and a response variable <code>y</code>,
or by a <code>formula</code> or by a fitted object <code>x</code> of class <code>"lm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start, end</code></td>
<td>
<p>integer. Index of the first and last observation, respectively,
for which recursive residuals should be computed. By default, the maximal
range is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric. A relative tolerance for precision of recursive
coefficient estimates, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qr.tol</code></td>
<td>
<p>numeric. The <code>tol</code>erance passed to <code>lm.fit</code>
for detecting linear dependencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>character. In addition to the R implementation of the default method,
there is also a faster C implementation (see below for further details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model. By
default the variables are taken from the environment which <code>recresid</code> is
called from. Specifying <code>data</code> might also be necessary when applying
<code>recresid</code> to a fitted model of class <code>"lm"</code> if this does not
contain the regressor matrix and the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><em>currently not used.</em></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Recursive residuals are standardized one-step-ahead prediction errors.
Under the usual assumptions for the linear regression model they
are (asymptotically) normal and i.i.d. (see Brown, Durbin, Evans, 1975,
for details).
</p>
<p>The default method computes the initial coefficient estimates via QR
decomposition, using <code>lm.fit</code>. In subsequent steps, the
updating formula provided by Brown, Durbin, Evans (1975) is employed.
To avoid numerical instabilities in the first steps (with typically
small sample sizes), the QR solution is computed for comparison.
When the relative difference (assessed bey <code>all.equal</code>)
between the two solutions falls below <code>tol</code>, only the updating
formula is used in subsequent steps.
</p>
<p>In large data sets, the R implementation can become rather slow. Hence, a
C implementation is also available. This is not the default, yet, because
it should receive more testing in numerically challenging cases. In addition
to the R and C implementation, there is also an Armadillo-based C++ implementation
available on R-Forge in package strucchangeArmadillo. For models with about
10 parameters, the C and C++ version perform similarly. For larger models, the
C++ implementation seems to scale better.
</p>


<h3>Value</h3>

<p>A vector containing the recursive residuals.
</p>


<h3>References</h3>

<p>Brown R.L., Durbin J., Evans J.M. (1975), Techniques for
testing constancy of regression relationships over time, <em>Journal of the
Royal Statistical Society</em>, B, <b>37</b>, 149-163.
</p>


<h3>See Also</h3>

<p><code>efp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(100) + rep(c(0, 2), each = 50)
rr &lt;- recresid(x ~ 1)
plot(cumsum(rr), type = "l")

plot(efp(x ~ 1, type = "Rec-CUSUM"))
</code></pre>


</div>