<div class="container">

<table style="width: 100%;"><tr>
<td>sbinaryLGMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of SAR for binary models using Linearized GMM.</h2>

<h3>Description</h3>

<p>Estimation of SAR model for binary dependent variables (either Probit or Logit), using Linearized GMM estimator suggested by Klier and McMillen (2008). The model is: 
</p>
<p style="text-align: center;"><code class="reqn">
y^*= X\beta + WX\gamma + \lambda W y^* + \epsilon = Z\delta + \lambda Wy^{*} + \epsilon
</code>
</p>

<p>where  <code class="reqn">y = 1</code> if <code class="reqn">y^*&gt;0</code> and 0 otherwise; <code class="reqn">\epsilon \sim N(0, 1)</code> if <code>link = "probit"</code> or <code class="reqn">\epsilon \sim L(0, \pi^2/3)</code> <code>link = "logit"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sbinaryLGMM(
  formula,
  data,
  listw = NULL,
  nins = 2,
  link = c("logit", "probit"),
  ...
)

## S3 method for class 'binlgmm'
coef(object, ...)

## S3 method for class 'binlgmm'
vcov(object, ...)

## S3 method for class 'binlgmm'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'binlgmm'
summary(object, ...)

## S3 method for class 'summary.binlgmm'
print(x, digits = max(3, getOption("digits") - 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model of the form <code>y ~ x | wx</code> where <code>y</code> is the binary dependent variable, <code>x</code> are the independent variables. The variables after <code>|</code> are those variables that enter spatially lagged: <code class="reqn">WX</code>. The variables in the second part of <code>formula</code> must also appear in the first part.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>object. An object of class <code>listw</code>, <code>matrix</code>, or <code>Matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nins</code></td>
<td>
<p>numerical. Order of instrumental-variable approximation; as default <code>nins = 2</code>, such that <code class="reqn">H = (Z, WZ, W^2Z)</code> are used as instruments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>string. The assumption of the distribution of the error term; it can be either <code>link = "probit"</code> (the default) or <code>link = "logit"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object, </code></td>
<td>
<p>an object of class <code>binlgmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The steps for the linearized spatial Probit/Logit model are the following:
</p>
<p>1. Estimate the model by standard Probit/Logit model, in which spatial autocorrelation and heteroskedasticity are ignored. The estimated values are <code class="reqn">\beta_0</code>. Calculate the generalized residuals assuming that <code class="reqn">\lambda = 0</code> and the gradient terms <code class="reqn">G_{\beta}</code> and <code class="reqn">G_{\lambda}</code>.
</p>
<p>2. The second step is a two-stage least squares estimator of the linearized model. Thus regress <code class="reqn">G_{\beta}</code> and <code class="reqn">G_{\lambda}</code> on <code class="reqn">H = (Z, WZ, W^2Z, ...., W^qZ)</code> and obtain the predicted values <code class="reqn">\hat{G}</code>. Then regress <code class="reqn">u_0 + G_{\beta}'\hat{\beta}_0</code> on <code class="reqn">\hat{G}</code>. The coefficients are the estimated values of <code class="reqn">\beta</code> and <code class="reqn">\lambda</code>.  
</p>
<p>The variance-covariance matrix can be computed using the traditional White-corrected coefficient covariance matrix from the last two-stage least squares estimator of the linearlized model.
</p>


<h3>Value</h3>

<p>An object of class “<code>bingmm</code>”, a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the estimated coefficients,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the X matrix, which contains also WX if the second part of the <code>formula</code> is used, </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>the H matrix of instruments used,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the dependent variable,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>the spatial weight matrix,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the string indicating the distribution of the error term,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>an object of <code>lm</code> representing the T2SLS,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mauricio Sarrias and Gianfranco Piras.
</p>


<h3>References</h3>

<p>Klier, T., &amp; McMillen, D. P. (2008). Clustering of auto supplier plants in the United States: generalized method of moments spatial logit for large samples. Journal of Business &amp; Economic Statistics, 26(4), 460-471.
</p>
<p>Piras, G., &amp; Sarrias, M. (2023). One or Two-Step? Evaluating GMM Efficiency for Spatial Binary Probit Models. Journal of choice modelling, 48, 100432. 
</p>
<p>Piras, G,. &amp; Sarrias, M. (2023). GMM Estimators for Binary Spatial Models in R. Journal of Statistical Software, 107(8), 1-33.
</p>


<h3>See Also</h3>

<p><code>sbinaryGMM</code>, <code>impacts.bingmm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data set
data(oldcol, package = "spdep")

# Create dependent (dummy) variable
COL.OLD$CRIMED &lt;- as.numeric(COL.OLD$CRIME &gt; 35)

# LGMM for probit using q = 3 for instruments
lgmm &lt;- sbinaryLGMM(CRIMED ~ INC + HOVAL | INC,
                link  = "probit", 
                listw = spdep::nb2listw(COL.nb, style = "W"),
                nins  = 3, 
                data  = COL.OLD)
summary(lgmm)
</code></pre>


</div>