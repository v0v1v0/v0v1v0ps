<div class="container">

<table style="width: 100%;"><tr>
<td>sbdecomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Selection Bias Decomposition
</h2>

<h3>Description</h3>

<p>This function decomposes the estimated selection bias to quantify what proportion of the estimated selection bias is explained by each observed confounder used in the propensity score model when estimating propensity score weighted treatment effects. The function offers two approaches - confounder inclusion or removal, and offers two estimation approaches - parametric or nonparametric.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sbdecomp(outcome, treatment, confounders, data=NULL, type = "inclusion", estimation 
= "parametric", Bonly = T, balance = T, n.trees = 20000, interaction.depth = 4, 
shrinkage = 0.005, verbose = FALSE, stop.method = c("es.max"), cv.folds = 0,
standard.error = F, boot.rep=500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>Continuous outcome; numeric vector or name of the variable in supplied data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>

<p>Binary treatment indicator, 0 or 1; numeric vector or name of the variable in supplied data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confounders</code></td>
<td>

<p>a data frame of confounders with names or a vector containing the names of the confounders in supplied data (each confounder must be either numeric or factor)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data containing all variables; required if names provided in outcome, treatment, and/or confounders arguments above
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The type of method for selection bias deocomposition; options are inclusion or removal, default is inclusion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>

<p>The type of estimation that should be used; options are parametric (based on logistic regression) or nonparametric (based on generalized boosted models [GBM]), default is parametric
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bonly</code></td>
<td>

<p>TRUE or FALSE; whether the user only wants the quantities B which are the proportions of the selection bias explained by each confounder, default is TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance</code></td>
<td>


<p>TRUE or FALSE; whether the user wants balance information, default is TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees</code></td>
<td>


<p>The n.trees for the nonparametric GBM approach, if using nonparametric estimation; default is 20000
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction.depth</code></td>
<td>


<p>The interaction depth for the nonparametric GBM approach, if using nonparametric estimation; default is 4
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>


<p>The shrinkage for the nonparametric GBM approach, if using nonparametric estimation; default is 0.005
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>


<p>TRUE or FALSE  for the nonparametric GBM approach, if using nonparametric estimation; default is FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.method</code></td>
<td>


<p>The stopping method  for the nonparametric GBM approach, if using nonparametric estimation; default is "es.max"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.folds</code></td>
<td>


<p>The cross-validation folds for the nonparametric GBM approach, if using nonparametric estimation; default is 0
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard.error</code></td>
<td>

<p>TRUE or FALSE; whether the user wants standard error estimates for the resulting estimates, obtained using boostrapping; default is FALSE; note that if using nonparametric estimation, obtaining the standard error estimates will be very time-intensive
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.rep</code></td>
<td>

<p>The number of bootstrap replications to be used when calculating the standard error; default is 500
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>Details can be found in: Parast, L and Griffin, BA (2020). "Quantifying the Bias due to Observed Individual Confounders in Causal Treatment Effect Estimates". Statistics in Medicine, In press.  Please email parast@rand.org for a current version. 
</p>


<h3>Value</h3>

<p>A list is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>delta.naive</code></td>
<td>
<p>Estimated naive treatment effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.delta.naive</code></td>
<td>
<p>P-value for estimated naive treatment effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int.delta.naive</code></td>
<td>
<p>95% confidence interval for estimated naive treatment effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.fully.adjusted</code></td>
<td>
<p>Estimated treatment effect after adjusting for all variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.delta.fully.adjusted</code></td>
<td>
<p>P-value for estimated treatment effect after adjusting for all variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int.delta.fully.adjusted</code></td>
<td>
<p>95% confidence interval for estimated treatment effect after adjusting for all variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The proportion of the selection bias explained by each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated.selection.bias</code></td>
<td>
<p>The estimated selection bias, only if Bonly = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The defined selection bias movement when including/removing a variable, only if Bonly = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.each</code></td>
<td>
<p>The adjusted delta including only each variable or dropping each variable (depending on type), only if Bonly = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.naive.mean</code></td>
<td>
<p>mean of the standardized effect size differences across all variables between the two groups;  only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.naive.max</code></td>
<td>
<p>max of the standardized effect size differences across all variables between the two groups;  only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.fully.adjusted.mean</code></td>
<td>
<p>mean of the standardized effect size differences across all variables between the two groups, after weighting with propensity score weights calculated using all variables;  only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.fully.adjusted.max</code></td>
<td>
<p>max of the standardized effect size differences across all variables between the two groups, after weighting with propensity score weights calculated using all variables;  only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.mean</code></td>
<td>
<p>mean of the standardized effect size differences across all variables in the relevant propensity score model between the two groups, after weighting with relevant propensity score weights; if using type = "inclusion" and variable included is a factor, output will be the mean effect size difference across all levels;  only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance.max</code></td>
<td>
<p>max of the standardized effect size differences across all variables in the relevant propensity score model between the two groups, after weighting with relevant propensity score weights;  if using type = "inclusion" and variable included is a factor, output will be the max effect size difference across all levels; only if balance = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.standard.error</code></td>
<td>
<p>The estimated standard error for the estimated proportion of the selection bias explained by each variable; only if standard.error = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.standard.error</code></td>
<td>
<p>The estimated standard error for the estimated selection bias movement when including/removing a variable; only if standard.error = TRUE </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>


<p>Parast, L and Griffin, BA (2020). "Quantifying the Bias due to Observed Individual Confounders in Causal Treatment Effect Estimates". Statistics in Medicine, 39(18): 2447- 2476.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(petsdata)
sbdecomp(outcome = petsdata$genhealth, treatment = petsdata$gotdog, confounders = 
as.data.frame(petsdata[,c(2:13)]), type = "inclusion", estimation = "parametric",
balance = FALSE)

sbdecomp(outcome = petsdata$genhealth, treatment = petsdata$gotdog, confounders = 
as.data.frame(petsdata[,c(2:13)]), type = "inclusion", estimation = "parametric", 
Bonly =FALSE, balance = TRUE) 

sbdecomp(outcome = "genhealth", treatment = "gotdog", confounders = c("age",
"ismale", "race_coll","hhsize","ownhome", "married",  "ontanf", "hhincome",
"fulltime","spouse_fulltime" ,"liveinhouse", "ruralurban"), data = petsdata, 
type = "inclusion", estimation = "parametric", Bonly =FALSE, balance = TRUE)

</code></pre>


</div>