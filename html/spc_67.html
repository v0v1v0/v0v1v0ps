<div class="container">

<table style="width: 100%;"><tr>
<td>xewma.arl.prerun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ARLs of EWMA control charts in case of estimated parameters</h2>

<h3>Description</h3>

<p>Computation of the (zero-state) Average Run Length (ARL)
for different types of EWMA control charts monitoring normal mean
if the in-control mean, standard deviation, or both are estimated by a pre run.</p>


<h3>Usage</h3>

<pre><code class="language-R">xewma.arl.prerun(l, c, mu, zr=0, hs=0, sided="two", limits="fix", q=1,
size=100, df=NULL, estimated="mu", qm.mu=30, qm.sigma=30, truncate=1e-10)

xewma.crit.prerun(l, L0, mu, zr=0, hs=0, sided="two", limits="fix", size=100,
df=NULL, estimated="mu", qm.mu=30, qm.sigma=30, truncate=1e-10,
c.error=1e-12, L.error=1e-9, OUTPUT=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>critical value (similar to alarm limit) of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>true mean shift.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>reflection border for the one-sided chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (give fast initial response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguish between one- and two-sided EWMA control chart 
by choosing <code>"one"</code> and <code>"two"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>distinguish between different control limits behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>change point position. For <code class="reqn">q=1</code> and
<code class="reqn">\mu=\mu_0</code> and <code class="reqn">\mu=\mu_1</code>, the usual
zero-state ARLs for the in-control and out-of-control case, respectively,
are calculated. For <code class="reqn">q&gt;1</code> and <code class="reqn">\mu!=0</code> conditional delays, that is,
<code class="reqn">E_q(L-q+1|L\ge q)</code>, will be determined.
Note that mu0=0 is implicitely fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>pre run sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom of the pre run variance estimator. Typically it is simply <code>size</code> - 1.
If the pre run is collected in batches, then also other values are needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated</code></td>
<td>
<p>name the parameter to be estimated within
the <code>"mu"</code>, <code>"sigma"</code>, <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qm.mu</code></td>
<td>
<p>number of quadrature nodes for convoluting the mean uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qm.sigma</code></td>
<td>
<p>number of quadrature nodes for convoluting the standard deviation uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>size of truncated tail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L0</code></td>
<td>
<p>in-control ARL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.error</code></td>
<td>
<p>error bound for two succeeding values of the critical value
during applying the secant rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.error</code></td>
<td>
<p>error bound for the ARL level <code>L0</code> during applying the secant rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OUTPUT</code></td>
<td>
<p>activate or deactivate additional output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Essentially, the ARL function <code>xewma.arl</code> is convoluted with the
distribution of the sample mean, standard deviation or both.
For details see Jones/Champ/Rigdon (2001) and Knoth (2014?).
</p>


<h3>Value</h3>

<p>Returns a single value which resembles the ARL.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>L. A. Jones, C. W. Champ, S. E. Rigdon (2001),
The performance of exponentially weighted moving average charts
with estimated parameters,
<em>Technometrics 43</em>, 156-167.
</p>
<p>S. Knoth (2003),
EWMA schemes with non-homogeneous transition kernels,
<em>Sequential Analysis 22</em>, 241-255.
</p>
<p>S. Knoth (2004),
Fast initial response features for EWMA Control Charts,
<em>Statistical Papers 46</em>, 47-64.
</p>
<p>S. Knoth (2014?),
tbd,
<em>tbd</em>, tbd-tbd.
</p>


<h3>See Also</h3>

<p><code>xewma.arl</code> for the usual zero-state ARL computation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Jones/Champ/Rigdon (2001)

c4m &lt;- function(m, n) sqrt(2)*gamma( (m*(n-1)+1)/2 )/sqrt( m*(n-1) )/gamma( m*(n-1)/2 )

n &lt;- 5 # sample size
m &lt;- 20 # pre run with 20 samples of size n = 5
C4m &lt;- c4m(m, n) # needed for bias correction

# Table 1, 3rd column
lambda &lt;- 0.2
L &lt;- 2.636

xewma.ARL &lt;- Vectorize("xewma.arl", "mu")
xewma.ARL.prerun &lt;- Vectorize("xewma.arl.prerun", "mu")

mu &lt;- c(0, .25, .5, 1, 1.5, 2)
ARL &lt;- round(xewma.ARL(lambda, L, mu, sided="two"), digits=2)
p.ARL &lt;- round(xewma.ARL.prerun(lambda, L/C4m, mu, sided="two",
size=m, df=m*(n-1), estimated="both", qm.mu=70), digits=2)

# Monte-Carlo with 10^8 repetitions: 200.325 (0.020) and 144.458 (0.022)
cbind(mu, ARL, p.ARL)

## Not run: 
# Figure 5, subfigure r = 0.2
mu_ &lt;- (0:85)/40
ARL_ &lt;- round(xewma.ARL(lambda, L, mu_, sided="two"), digits=2)
p.ARL_ &lt;- round(xewma.ARL.prerun(lambda, L/C4m, mu_, sided="two",
size=m, df=m*(n-1), estimated="both"), digits=2)

plot(mu_, ARL_, type="l", xlab=expression(delta), ylab="ARL", xlim=c(0,2))
abline(v=0, h=0, col="grey", lwd=.7)
points(mu, ARL, pch=5)
lines(mu_, p.ARL_, col="blue")
points(mu, p.ARL, pch=18, col ="blue")
legend("topright", c("Known", "Estimated"), col=c("black", "blue"),
lty=1, pch=c(5, 18))

## End(Not run)
</code></pre>


</div>