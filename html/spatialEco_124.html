<div class="container">

<table style="width: 100%;"><tr>
<td>spherical.sd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spherical Variance or Standard Deviation of Surface</h2>

<h3>Description</h3>

<p>Derives the spherical standard deviation of a raster surface
</p>


<h3>Usage</h3>

<pre><code class="language-R">spherical.sd(r, d, variance = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A terra SpatRaster class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Size of focal window or a matrix to use in focal function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>(FALSE|TRUE) Output spherical variance rather than standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to terra:app (can write raster to disk here)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Surface variability using spherical variance/standard deviation. 
The variation can be assessed using the spherical standard deviation of the normal 
direction within a local neighborhood. This is found by expressing the normal 
directions on the surfaces cells in terms of their displacements in a Cartesian (x,y,z) 
coordinate system. Averaging the x-coordinates, y-coordinates, and z-coordinates 
separately gives a vector (xb, yb, zb) pointing in the direction of the average 
normal. This vector will be shorter when there is more variation of the normals and 
it will be longest–equal to unity–when there is no variation. Its squared length 
is (by the Pythagorean theorem) given by: R^2 = xb^2 + yb^2 + zb^2
where; x = cos(aspect) * sin(slope) and xb = nXn focal mean of x 
y = sin(aspect) * sin(slope) and  yb = nXn focal mean of y
z = cos(slope) and zb = nXn focal mean of z 	   
</p>
<p>The slope and aspect values are expected to be in radians. 
The value of (1 - R^2), which will lie between 0 and 1, is the spherical variance. 
and it's square root can be considered the spherical standard deviation.
</p>


<h3>Value</h3>

<p>A terra SpatRaster class object of the spherical standard deviation
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans &lt;jeffrey_evans&lt;at&gt;tnc.org&gt;
</p>


<h3>See Also</h3>

<p><code>app</code> for details on ... arguments
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 library(terra)
 elev &lt;- rast(system.file("extdata/elev.tif", package="spatialEco"))
 
 ssd &lt;- spherical.sd(elev, d=5)
 
 slope &lt;- terrain(elev, v='slope')
 aspect &lt;- terrain(elev, v='aspect')
 hill &lt;- shade(slope, aspect, 40, 270)
 plot(hill, col=grey(0:100/100), legend=FALSE, 
      main='terrain spherical standard deviation')
   plot(ssd, col=rainbow(25, alpha=0.35), add=TRUE)

 
</code></pre>


</div>