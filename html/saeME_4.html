<div class="container">

<table style="width: 100%;"><tr>
<td>FHme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fay-Herriot Model with Measurement Error</h2>

<h3>Description</h3>

<p>This function gives the EBLUP estimator based on Fay-Herriot model with measurement error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FHme(
  formula,
  vardir,
  var.x,
  type.x = "witherror",
  MAXITER = 1000,
  PRECISION = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted. The variables included <code>formula</code> must have a length equal to the number of domains <code>m</code>. This formula can provide auxiliary variable either measured with error or without error or combination between them. If the auxiliary variable are combination between <code>noerror</code> and <code>witherror</code> variable, input all <code>witherror</code> variable first then <code>noerror</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>vector containing the <code>m</code> sampling variances of direct estimators for each domain. The values must be sorted as the <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.x</code></td>
<td>
<p>vector containing mean squared error of <code>X</code> . The values must be sorted as the <code>X</code>. if you use optional <code>data</code>, input this parameter use <code>c("")</code>, example: <code>var.x = c("c1") or var.x = c("c1","c2")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.x</code></td>
<td>
<p>type of auxiliary variable used in the model. Either source measured with <code>noerror</code>, <code>witherror</code> and <code>mix</code>. Default value is <code>witherror</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAXITER</code></td>
<td>
<p>maximum number of iterations allowed. Default value is <code>1000</code> iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRECISION</code></td>
<td>
<p>convergence tolerance limit. Default value is <code>0.0001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame containing the variables named in formula, vardir, and var.x.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A formula has an implied intercept term. To remove this use either y ~ x - 1 or y ~ 0 + x. See <code>formula</code>  for more details of allowed formulae.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt><code>eblup</code></dt>
<dd>
<p>vector with the values of the estimators for the domains.</p>
</dd>
<dt><code>fit</code></dt>
<dd>
<p>a list containing the following objects:</p>
</dd>
</dl>
<ul>
<li> <p><code>method</code> : type of fitting method.
</p>
</li>
<li> <p><code>convergence</code> : a logical value of convergence when calculating estimated beta and estimated random effects.
</p>
</li>
<li> <p><code>iterations</code> : number of iterations when calculating estimated beta and estimated random effects.
</p>
</li>
<li> <p><code>estcoef</code> : a data frame with the estimated model coefficient (<code>beta</code>) in the first column, their standard error (<code>std.error</code>) in the second column, the t-statistics (<code>t.statistics</code>) in the third column, and the p-values of the significance of each coefficient (<code>pvalue</code>) in the last column.
</p>
</li>
<li> <p><code>refvar</code> : a value of estimated random effects.
</p>
</li>
<li> <p><code>gamma</code> : vector with values of the estimated gamma for each domains.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>mse_FHme</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dataME)
data(datamix)
sae.me &lt;- FHme(formula = y ~ x.hat, vardir = vardir, var.x = c("var.x"), data = dataME)
sae.mix &lt;- FHme(formula = y ~ x.hat1 + x.hat2 + x3 + x4,
            vardir = vardir, var.x = c("var.x1", "var.x2"), type.x = "mix", data = datamix)

</code></pre>


</div>