<div class="container">

<table style="width: 100%;"><tr>
<td>blm_bc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian linear model with a Box-Cox transformation</h2>

<h3>Description</h3>

<p>MCMC sampling for Bayesian linear regression with a
(known or unknown) Box-Cox transformation. A g-prior is assumed
for the regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blm_bc(
  y,
  X,
  X_test = X,
  psi = length(y),
  lambda = NULL,
  sample_lambda = TRUE,
  nsave = 1000,
  nburn = 1000,
  nskip = 0,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>n x 1</code> vector of observed counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>n x p</code> matrix of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_test</code></td>
<td>
<p><code>n_test x p</code> matrix of predictors for test data;
default is the observed covariates <code>X</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>prior variance (g-prior)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Box-Cox transformation; if NULL, estimate this parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_lambda</code></td>
<td>
<p>logical; if TRUE, sample lambda, otherwise
use the fixed value of lambda above or the MLE (if lambda unspecified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsave</code></td>
<td>
<p>number of MCMC iterations to save</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>number of MCMC iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nskip</code></td>
<td>
<p>number of MCMC iterations to skip between saving iterations,
i.e., save every (nskip + 1)th draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if TRUE, print time remaining</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides fully Bayesian inference for a
transformed linear model via MCMC sampling. The transformation is
parametric from the Box-Cox family, which has one parameter <code>lambda</code>.
That parameter may be fixed in advanced or learned from the data.
</p>


<h3>Value</h3>

<p>a list with the following elements:
</p>

<ul>
<li> <p><code>coefficients</code> the posterior mean of the regression coefficients
</p>
</li>
<li> <p><code>fitted.values</code> the posterior predictive mean at the test points <code>X_test</code>
</p>
</li>
<li> <p><code>post_theta</code>: <code>nsave x p</code> samples from the posterior distribution
of the regression coefficients
</p>
</li>
<li> <p><code>post_ypred</code>: <code>nsave x n_test</code> samples
from the posterior predictive distribution at test points <code>X_test</code>
</p>
</li>
<li> <p><code>post_g</code>: <code>nsave</code> posterior samples of the transformation
evaluated at the unique <code>y</code> values
</p>
</li>
<li> <p><code>post_lambda</code> <code>nsave</code> posterior samples of lambda
</p>
</li>
<li> <p><code>post_sigma</code> <code>nsave</code> posterior samples of sigma
</p>
</li>
<li> <p><code>model</code>: the model fit (here, <code>blm_bc</code>)
</p>
</li>
</ul>
<p>as well as the arguments passed in.
</p>


<h3>Note</h3>

<p>Box-Cox transformations may be useful in some cases, but
in general we recommend the nonparametric transformation (with
Monte Carlo, not MCMC sampling) in <code>sblm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate some data:
dat = simulate_tlm(n = 100, p = 5, g_type = 'step')
y = dat$y; X = dat$X # training data
y_test = dat$y_test; X_test = dat$X_test # testing data

hist(y, breaks = 25) # marginal distribution

# Fit the Bayesian linear model with a Box-Cox transformation:
fit = blm_bc(y = y, X = X, X_test = X_test)
names(fit) # what is returned
round(quantile(fit$post_lambda), 3) # summary of unknown Box-Cox parameter

</code></pre>


</div>