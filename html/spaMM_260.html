<div class="container">

<table style="width: 100%;"><tr>
<td>as_LMLT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Conversion to input for procedures from lmerTest package
</h2>

<h3>Description</h3>

<p>The <code>lmerTest::contest</code> function, <code>drop1</code> and <code>anova</code> methods implement a number of tests for linear mixed models, e.g. using effective degrees of freeedom based on (a generalization of) Satterthwaite's method. These tests can be performed using <span class="pkg">spaMM</span> fits through the conversion of the fit object, by the <code>as_LMLT</code> function, to an ad-hoc format acceptable as input to <span class="pkg">lmerTest</span>'s internal procedures. The separately documented <code>drop1.HLfit</code> and (optionally) <code>anova.HLfit</code> methods, when called on a single LMM fit object, perform the conversion by <code>as_LMLT</code> and call <code>drop1</code> or <code>anova</code> methods defined by <span class="pkg">lmerTest</span>.
</p>
<p>Only the tests using <span class="pkg">lmerTest</span>'s default method <code>ddf="Satterthwaite"</code> are formally supported, as the converted object do not have the required format for the other methods. Only LMMs are handled by <span class="pkg">lmerTest</span>, and residual-dispersion models are not yet handled by the conversion. However, the conversion extends <span class="pkg">lmerTest</span>'s functionality by handling all random-effect parameters handled by <code>numInfo</code>, therefore including (e.g.) spatial-correlation parameters not handled by <span class="pkg">lme4</span>.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">as_LMLT(fitobject, nuisance=NULL, verbose=TRUE, transf=TRUE, check_deriv=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitobject</code></td>
<td>

<p>Object of class <code>HLfit</code> resulting from the fit of a linear mixed model (LMM).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuisance</code></td>
<td>

<p>A list of fitted values of parameters that affect the distribution of the test of fixed effects, in the format of the <code>fixed</code> argument of the <code>fitme</code> function. If NULL (default), then the list is constructed from the fitted values of the random-effect parameters and of <code>phi</code> (residual dispersion parameter). 
The <code>nuisance</code> argument is better ingored unless the extractor he construct the default value fails in some way.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>boolean: controls printing of the message that shows the <code>unlist</code>ed value of the <code>nuisance</code> list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transf</code></td>
<td>

<p>boolean: whether to evaluate numerical derivatives on a transformed parameter scale, or not (may affect numerical precision).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_deriv</code></td>
<td>
<p>See same-named argument of <code>numInfo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that may be needed by some method (currently ignored).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value is returned invisibly. It is an S4 object of class <code>"LMLT"</code> with slots matching those required in objects of S4 class <code>"lmerModLmerTest"</code> when used by package <span class="pkg">lmerTest</span> with <code>ddf="Satterthwaite"</code> (many additional slots of a formal <code>"lmerModLmerTest"</code> object are missing). The additional <code>nuisance</code> slot contains the <code>nuisance</code> list.
</p>


<h3>References</h3>

<p>Alexandra Kuznetsova, Per B. Brockhoff and Rune H. B. Christensen (2017) lmerTest Package: Tests in Linear Mixed Effects Models. Journal of Statistical Software, 82(13), 1â€“26. doi:10.18637/jss.v082.i13
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Reproducing an example from the doc of lmerTest::contest.lmerModLmerTest,
#    using a spaMM fit as input.
## Not run: 
  data("sleepstudy", package="lme4")
  
  ## The fit:
  spfit &lt;- fitme(Reaction ~ Days + I(Days^2) + (1|Subject) + (0+Days|Subject),
             sleepstudy, method="REML")
  
  ## Conversion:           
  spfit_lmlt &lt;-  as_LMLT(spfit) 

  ## Functions from package lmerTest can then be called on this object:
  lmerTest::contest(spfit_lmlt, L=diag(3)[2:3, ])   # Test of 'Days + I(Days^2)'.
  #
  anova(spfit_lmlt, type="1")         # : using lmerTest:::anova.lmerModLmerTest()
  drop1(spfit_lmlt)                   # : using lmerTest:::drop1.lmerModLmerTest()


## End(Not run)
</code></pre>


</div>