<div class="container">

<table style="width: 100%;"><tr>
<td>sdeDiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phi-Divergences test for diffusion processes</h2>

<h3>Description</h3>

<p>Phi-Divergences test for diffusion processes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sdeDiv(X, theta1, theta0, phi= expression( -log(x) ), C.phi, K.phi, 
       b, s, b.x, s.x, s.xx, B, B.x, H, S, guess, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a ts object containing a sample path of an sde.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>
<p>a vector parameters for the hypothesis H1. If not given, <code>theta1</code> is estimated from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>a vector parameters for the hypothesis H0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>an expression containing the phi function of the phi-divergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C.phi</code></td>
<td>
<p>the value of first derivtive of <code>phi</code> at point 1. If not given, it is calculated within this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.phi</code></td>
<td>
<p>the value of second derivative of <code>phi</code> at point 1. If not given, it is calculated within this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>drift coefficient of the model as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>diffusion coefficient of the model as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.x</code></td>
<td>
<p>partial derivative of <code>b</code> as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.x</code></td>
<td>
<p>partial derivative of <code>s</code> as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.xx</code></td>
<td>
<p>second-order partial derivative of <code>s</code> as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>initial value of the parameters; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.x</code></td>
<td>
<p>partial derivative of <code>B</code> as a function of <code>x</code> and <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>function of <code>(x,y)</code>,  the integral of <code>B/s</code>; optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>function of <code>(x,y)</code>, the integral of <code>1/s</code>; optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess</code></td>
<td>
<p>initial value for the parameters to be estimated; optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to the <code>optim</code> function; optional.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>sdeDiv</code> estimate the phi-divergence for diffusion processes defined as
<code>D(theta1, theta0) = phi( f(theta1)/f(theta0) )</code> where <code>f</code> is the
likelihood function of the process. This function uses the Dacunha-Castelle 
and Florens-Zmirou approximation of the likelihood for <code>f</code>.
</p>
<p>The parameter <code>theta1</code> is supposed to be the value of the true MLE estimator 
or the minimum contrast estimator of the parameters in the model. If missing
or <code>NULL</code> and <code>guess</code> is specified, <code>theta1</code> is estimated using the 
minimum contrast estimator derived from the locally Gaussian approximation
of the density. If both <code>theta1</code> and <code>guess</code> are missing, nothing can
be calculated.
</p>
<p>The function always calculates the likelihood ratio test and the p-value of the
test statistics.
In some cases, the p-value of the phi-divergence test statistics is obtained by simulation. In such
a case, the <code>out$est.pval</code> is set to <code>TRUE</code>
</p>
<p>Dy default <code>phi</code> is set to <code>-log(x)</code>. In this case the phi-divergence and the
likelihood ratio test are equivalent (e.g. phi-Div = LRT/2)
</p>
<p>For more informations on phi-divergences for discretely observed diffusion processes
see the references.
</p>
<p>If missing, <code>B</code> is calculated as <code>b/s - 0.5*s.x</code> provided that <code>s.x</code>
is not missing.
</p>
<p>If missing, <code>B.x</code> is calculated as <code>b.x/s - b*s.x/(s^2)-0.5*s.xx</code>, provided
that <code>b.x</code>, <code>s.x</code>, and <code>s.xx</code> are not missing.
</p>
<p>If missing, both <code>H</code> and <code>S</code> are evaluated numerically.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list containing the value of the divergence, its pvalue, the likelihood ratio test
statistics and its p-value</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Stefano Maria Iacus</p>


<h3>References</h3>

<p>Dacunha-Castelle, D., Florens-Zmirou, D. (1986) Estimation of the coefficients 
of a diffusion from discrete observations,  <em>Stochastics</em>, 19, 263-284.
</p>
<p>De Gregorio, A., Iacus, S.M. (2008) Divergences Test Statistics for 
Discretely Observed Diffusion Processes, Journal of Statistical Planning and Inference, 140(7), 1744-1753, <a href="https://doi.org/10.1016/j.jspi.2009.12.029">doi:10.1016/j.jspi.2009.12.029</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(123)
theta0 &lt;- c(0.89218*0.09045,0.89218,sqrt(0.032742))
theta1 &lt;- c(0.89218*0.09045/2,0.89218,sqrt(0.032742/2))

# we test the true model against two competing models
b &lt;- function(x,theta) theta[1]-theta[2]*x
b.x &lt;- function(x,theta)  -theta[2]

s &lt;- function(x,theta) theta[3]*sqrt(x)
s.x &lt;- function(x,theta) theta[3]/(2*sqrt(x))
s.xx &lt;- function(x,theta) -theta[3]/(4*x^1.5)


X &lt;- sde.sim(X0=rsCIR(1, theta1), N=1000, delta=1e-3, model="CIR", 
 theta=theta1)

sdeDiv(X=X, theta0 = theta0,   b=b, s=s, b.x=b.x, s.x=s.x, 
 s.xx=s.xx, method="L-BFGS-B", 
 lower=rep(1e-3,3), guess=c(1,1,1))

sdeDiv(X=X, theta0 = theta1,   b=b, s=s, b.x=b.x, s.x=s.x, 
 s.xx=s.xx, method="L-BFGS-B", 
 lower=rep(1e-3,3), guess=c(1,1,1))

lambda &lt;- -1.75
myphi &lt;-  expression( (x^(lambda+1) -x - lambda*(x-1))/(lambda*(lambda+1)) )

sdeDiv(X=X, theta0 = theta0,   phi = myphi, b=b, s=s, b.x=b.x, 
 s.x=s.x, s.xx=s.xx, method="L-BFGS-B", 
 lower=rep(1e-3,3), guess=c(1,1,1))

sdeDiv(X=X, theta0 = theta1,   phi = myphi, b=b, s=s, b.x=b.x, 
 s.x=s.x, s.xx=s.xx, method="L-BFGS-B", 
 lower=rep(1e-3,3), guess=c(1,1,1))

## End(Not run)
</code></pre>


</div>