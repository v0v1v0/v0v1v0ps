<div class="container">

<table style="width: 100%;"><tr>
<td>relsharpen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ridge/Enet/LASSO Sharpening via the penalty matrix.</h2>

<h3>Description</h3>

<p>This is a data sharpening function to remove roughness, 
prior to use in local polynomial regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relsharpen(x, y, h, alpha, p=2, M=51)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of equally spaced x data. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of y data. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the kernel bandwidth smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the elasticnet mixing parameter vector, with alpha in [0,1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the order of the polynomial regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the length of the constraint points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the predictor values are assumed to be equally
spaced.  
</p>


<h3>Value</h3>

<p>numeric matrix of sharpened responses, with each column
corresponding to different values of alpha
</p>


<h3>Author(s)</h3>

<p>D.Wang</p>


<h3>Examples</h3>

<pre><code class="language-R">x&lt;-seq(0,10,length=100)
g &lt;- function(x) sin(x)
y&lt;-g(x)+rnorm(100)
ys&lt;-relsharpen(x, y, dpill(x,y), alpha=c(0.2,0.8), p=2, M=51)
y.lp2&lt;-locpoly(x,ys[,1],bandwidth=dpill(x,y),degree=1,gridsize=100)
y.lp8&lt;-locpoly(x,ys[,2],bandwidth=dpill(x,y),degree=1,gridsize=100)
y.lp&lt;-locpoly(x,y,bandwidth=dpill(x,y),degree=1,gridsize=100)
curve(g,x,xlim=c(0,10))
lines(y.lp2,col=2)
lines(y.lp8,col=3)
lines(y.lp,col=5)
norm(as.matrix(g(x) - y.lp2$y),type="2")
norm(as.matrix(g(x) - y.lp8$y),type="2")
norm(as.matrix(g(x) - y.lp$y),type="2")
</code></pre>


</div>