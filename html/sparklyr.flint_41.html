<div class="container">

<table style="width: 100%;"><tr>
<td>summarize_weighted_avg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted average summarizer</h2>

<h3>Description</h3>

<p>Compute moving weighted average, weighted standard deviation, weighted t-
stat, and observation count with the column and weight column specified and
store results in new columns named '&lt;column&gt;_&lt;weighted_column&gt;_mean',
'&lt;column&gt;_&lt;weighted_column&gt;_weightedStandardDeviation',
'&lt;column&gt;_&lt;weighted_column&gt;_weightedTStat', and
'&lt;column&gt;_&lt;weighted_column&gt;_observationCount',
</p>


<h3>Usage</h3>

<pre><code class="language-R">summarize_weighted_avg(
  ts_rdd,
  column,
  weight_column,
  window = NULL,
  key_columns = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts_rdd</code></td>
<td>
<p>Timeseries RDD being summarized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>
<p>Column to be summarized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_column</code></td>
<td>
<p>Column specifying relative weight of each data point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>Either an R expression specifying time windows to be summarized
(e.g., 'in_past("1h")' to summarize data from looking behind 1 hour at
each time point, 'in_future("5s")' to summarize data from looking forward
5 seconds at each time point), or 'NULL' to compute aggregate statistics
on records grouped by timestamps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key_columns</code></td>
<td>
<p>Optional list of columns that will form an equivalence
relation associating each record with the time series it belongs to (i.e.,
any 2 records having equal values in those columns will be associated with
the same time series, and any 2 records having differing values in those
columns are considered to be from 2 separate time series and will therefore
be summarized separately)
By default, 'key_colums' is empty and all records are considered to be part
of a single time series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A TimeSeriesRDD containing the summarized result
</p>


<h3>See Also</h3>

<p>Other summarizers: 
<code>ols_regression()</code>,
<code>summarize_avg()</code>,
<code>summarize_corr2()</code>,
<code>summarize_corr()</code>,
<code>summarize_count()</code>,
<code>summarize_covar()</code>,
<code>summarize_dot_product()</code>,
<code>summarize_ema_half_life()</code>,
<code>summarize_ewma()</code>,
<code>summarize_geometric_mean()</code>,
<code>summarize_kurtosis()</code>,
<code>summarize_max()</code>,
<code>summarize_min()</code>,
<code>summarize_nth_central_moment()</code>,
<code>summarize_nth_moment()</code>,
<code>summarize_product()</code>,
<code>summarize_quantile()</code>,
<code>summarize_skewness()</code>,
<code>summarize_stddev()</code>,
<code>summarize_sum()</code>,
<code>summarize_var()</code>,
<code>summarize_weighted_corr()</code>,
<code>summarize_weighted_covar()</code>,
<code>summarize_z_score()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(sparklyr)
library(sparklyr.flint)

sc &lt;- try_spark_connect(master = "local")

if (!is.null(sc)) {
  sdf &lt;- copy_to(sc, tibble::tibble(t = seq(10), v = seq(10), w = seq(1, 0.1, -0.1)))
  ts &lt;- fromSDF(sdf, is_sorted = TRUE, time_unit = "SECONDS", time_column = "t")
  ts_weighted_avg &lt;- summarize_weighted_avg(
    ts,
    column = "v", weight_column = "w", window = in_past("3s")
  )
} else {
  message("Unable to establish a Spark connection!")
}

</code></pre>


</div>