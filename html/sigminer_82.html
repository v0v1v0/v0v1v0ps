<div class="container">

<table style="width: 100%;"><tr>
<td>scoring</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Score Copy Number Profile</h2>

<h3>Description</h3>

<p>Returns quantification of copy number profile and events including
tandem duplication and Chromothripisis etc.
Only copy number data from autosome is used here.
<strong>Some of the quantification methods are rough,
you use at your risk</strong>. You should do some extra work to check the
result scores.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scoring(object, TD_size_cutoff = c(1000, 1e+05, 2e+06), TD_cn_cutoff = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a object of CopyNumber.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TD_size_cutoff</code></td>
<td>
<p>a length-3 numeric vector used to specify the start, midpoint, end
segment size for determining tandem duplication size range, midpoint is used to split
TD into short TD and long TD. Default is 1Kb to 100Kb for short TD, 100Kb to 2Mb for long
TD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TD_cn_cutoff</code></td>
<td>
<p>a number defining the maximum copy number of TD,
default is <code>Inf</code>, i.e. no cutoff.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>data.table</code> with following scores:
</p>

<ul>
<li>
<p> cnaBurden: CNA burden representing the altered genomic fraction as previously reported.
</p>
</li>
<li>
<p> cnaLoad: CNA load representing the quantity of copy number alteration.
</p>
</li>
<li>
<p> MACN: mean altered copy number (MACN) reflecting the property of altered copy number segments,
calculated as
</p>
<p style="text-align: center;"><code class="reqn">MACN = \frac{\sum_{i} CN_i}{N_{cnv}}</code>
</p>

<p>where <code class="reqn">CN_i</code> is the copy number of altered segment <code class="reqn">i</code>, <code class="reqn">N_{cnv}</code> is
the number of CNV.
</p>
</li>
<li>
<p> weightedMACN: same as MACN but weighted with segment length.
</p>
<p style="text-align: center;"><code class="reqn">MACN_{weighted} = \frac{\sum_{i} (CN_i \times L_{i})}{ \sum_{i} L_{i} }</code>
</p>

<p>where <code class="reqn">L_{i}</code> is the length of altered copy number segment <code class="reqn">i</code>.
</p>
</li>
<li>
<p> Ploidy: ploidy, the formula is same as <code>weightedMACN</code> but using all copy number segments instead of
altered copy number segments.
</p>
</li>
<li>
<p> TDP_pnas: tandem duplication phenotype score from <code style="white-space: pre;">⁠https://www.pnas.org/doi/10.1073/pnas.1520010113⁠</code>,
the threshold <code>k</code> in reference is omitted.
</p>
<p style="text-align: center;"><code class="reqn">TDP = - \frac{\sum_{chr} |TD_{obs}-TD_{exp}|}{TD_{total}}</code>
</p>

<p>where <code class="reqn">TD_{total}</code> is the number of TD, <code class="reqn">TD_{obs}</code> and
<code class="reqn">TD_exp</code> are observed number of TD and expected number of TD for each chromosome.
</p>
</li>
<li>
<p> TDP: tandem duplication score used defined by our group work,
TD represents segment with copy number greater than 2.
</p>
<p style="text-align: center;"><code class="reqn">TD = \frac{TD_{total}}{\sum_{chr} |TD_{obs}-TD_{exp}|+1}</code>
</p>

</li>
<li>
<p> sTDP: TDP score for short TD.
</p>
</li>
<li>
<p> lTDP: TDP score for long TD.
</p>
</li>
<li>
<p> TDP_size : TDP region size (Mb).
</p>
</li>
<li>
<p> sTDP_size: sTDP region size (Mb).
</p>
</li>
<li>
<p> lTDP_size: lTDP region size(Mb).
</p>
</li>
<li>
<p> Chromoth_state: chromothripsis state score,
according to reference <a href="https://doi.org/10.1016/j.cell.2013.02.023">doi:10.1016/j.cell.2013.02.023</a>,
chromothripsis frequently leads to massive loss of segments on
the affected chromosome with segmental losses being interspersed with regions displaying
normal (disomic) copy-number (e.g., copy-number states oscillating between
copy-number = 1 and copy-number = 2), form tens to hundreds of locally clustered DNA rearrangements.
Most of methods use both SV and CNV to infer chromothripsis, here we roughly quantify it with
</p>
<p style="text-align: center;"><code class="reqn">\sum_{chr}{N_{OsCN}^2}</code>
</p>

<p>where <code class="reqn">N_{OsCN}</code> is the number of oscillating copy number pattern "2-1-2" for each chromosome.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Load copy number object
load(system.file("extdata", "toy_copynumber.RData",
  package = "sigminer", mustWork = TRUE
))

d &lt;- scoring(cn)
d

d2 &lt;- scoring(cn, TD_cn_cutoff = 4L)
d2
</code></pre>


</div>