<div class="container">

<table style="width: 100%;"><tr>
<td>influ_continuous</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Influential Species Detection - Trait Evolution Continuous Characters</h2>

<h3>Description</h3>

<p>Fits models for trait evolution of continuous characters, 
detecting influential species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">influ_continuous(
  data,
  phy,
  model,
  bounds = list(),
  cutoff = 2,
  n.cores = NULL,
  track = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data vector for a single continuous trait, with names matching tips in <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A phylogeny (class 'phylo') matching <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The evolutionary model (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>settings to constrain parameter estimates. See <code>fitContinuous</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>The cut-off parameter for influential species (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores to use. If 'NULL', number of cores is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>Print a report tracking function progress (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fitContinuous</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function sequentially removes one species at a time,  
fits different models of continuous character evolution using <code>fitContinuous</code>, 
stores the results and calculates the effects on model parameters.
</p>
<p><code>influ_continuous</code> detects influential species based on the standardised
difference in the rate parameter <code>sigsq</code> and the optimisation parameter <code>optpar</code> 
(e.g. lamda, kappa, alpha, depending on which <code>model</code> is set), when removing 
a given species compared to the full model including all species. 
Species with a standardised difference above the value of 
<code>cutoff</code> are identified as influential. 
</p>
<p>Different evolutionary models from <code>fitContinuous</code> can be used, i.e. <code>BM</code>,<code>OU</code>,
<code>EB</code>, <code>trend</code>, <code>lambda</code>, <code>kappa</code>, <code>delta</code> and <code>drift</code>.
</p>
<p>See <code>fitContinuous</code> for more details on evolutionary models.
</p>


<h3>Value</h3>

<p>The function <code>tree_discrete</code> returns a list with the following
components:
</p>
<p><code>call</code>: The function call
</p>
<p><code>cutoff</code>: The value selected for <code>cutoff</code>
</p>
<p><code>data</code>: The original full data vector
</p>
<p><code>optpar</code>: Transformation parameter used (e.g. <code>lambda</code>, <code>kappa</code> etc.)
</p>
<p><code>full.model.estimates</code>: Parameter estimates (rate of evolution <code>sigsq</code>
and where applicable <code>optpar</code>), root state <code>z0</code>, 
AICc for the full model without deleted species.
</p>
<p><code>influential_species</code>: List of influential species, based on standardised 
difference in estimates for sigsq and optpar. Species are ordered from most influential to 
less influential and only include species with a standardised difference &gt; <code>cutoff</code>.
</p>
<p><code>sensi.estimates</code>: Parameter estimates (sigsq and optpar),(percentual) difference 
in parameter estimate compared to the full model (DIFsigsq, sigsq.perc,sDIFsigsq, 
DIFoptpar, optpar.perc,sDIFoptpar), 
AICc and z0 for each repeat with a species removed.
</p>


<h3>Author(s)</h3>

<p>Gijsbert Werner &amp; Gustavo Paterno
</p>


<h3>References</h3>

<p>Paterno, G. B., Penone, C. Werner, G. D. A. 
<a href="http://doi.wiley.com/10.1111/2041-210X.12990">sensiPhy: 
An r-package for sensitivity analysis in phylogenetic 
comparative methods.</a> Methods in Ecology and Evolution 
2018, 9(6):1461-1467.  
</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford University Press: Oxford. 
</p>
<p>Harmon Luke J, Jason T Weir, Chad D Brock, Richard E Glor, and Wendell Challenger. 2008.
GEIGER: investigating evolutionary radiations. Bioinformatics 24:129-131.
</p>


<h3>See Also</h3>

<p><code>fitContinuous</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Load data:
data("primates")
#Model trait evolution accounting for influential species
adultMass&lt;-primates$data$adultMass
names(adultMass)&lt;-rownames(primates$data)
influ_cont&lt;-influ_continuous(data = adultMass,phy = primates$phy[[1]],
model = "OU",cutoff = 2,n.cores = 2,track = TRUE)
#Print summary statistics
summary(influ_cont)
sensi_plot(influ_cont)
sensi_plot(influ_cont,graphs="sigsq")
#' sensi_plot(influ_cont,graphs="optpar")
#Use a different evolutionary model or cutoff 
influ_cont2&lt;-influ_continuous(data = adultMass,phy = primates$phy[[1]],
model = "lambda",cutoff = 1.2,n.cores = 2,track = TRUE)
summary(influ_cont2)
sensi_plot(influ_cont2)
influ_cont3&lt;-influ_continuous(data = adultMass,phy = primates$phy[[1]],
model = "BM",cutoff = 2,n.cores = 2,track = TRUE)
summary(influ_cont3)

## End(Not run)
</code></pre>


</div>