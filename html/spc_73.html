<div class="container">

<table style="width: 100%;"><tr>
<td>xewma.sf.prerun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the survival function of EWMA run length in case of estimated parameters</h2>

<h3>Description</h3>

<p>Computation of the survival function of the Run Length (RL) for EWMA
control charts monitoring normal mean
if the in-control mean, standard deviation, or both are estimated by a pre run.</p>


<h3>Usage</h3>

<pre><code class="language-R">xewma.sf.prerun(l, c, mu, n, zr=0, hs=0, sided="one", limits="fix", q=1,
size=100, df=NULL, estimated="mu", qm.mu=30, qm.sigma=30,
truncate=1e-10, tail_approx=TRUE, bound=1e-10)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>critical value (similar to alarm limit) of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>true mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>calculate sf up to value <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>reflection border for the one-sided chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (give fast initial response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguish between one- and two-sided EWMA control chart 
by choosing <code>"one"</code> and <code>"two"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>distinguish between different control limits behavior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>change point position. For <code class="reqn">q=1</code> and
<code class="reqn">\mu=\mu_0</code> and <code class="reqn">\mu=\mu_1</code>, the usual
zero-state situation for the in-control and out-of-control case, respectively,
are calculated. Note that mu0=0 is implicitely fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>pre run sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom of the pre run variance estimator. Typically it is simply <code>size</code> - 1.
If the pre run is collected in batches, then also other
values are needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated</code></td>
<td>
<p>name the parameter to be estimated within the <code>"mu"</code>,
<code>"sigma"</code>, <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qm.mu</code></td>
<td>
<p>number of quadrature nodes for convoluting the mean uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qm.sigma</code></td>
<td>
<p>number of quadrature nodes for convoluting the standard deviation uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>size of truncated tail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail_approx</code></td>
<td>
<p>Controls whether the geometric tail approximation is used (is faster) or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>control when the geometric tail kicks in; the larger the quicker and less accurate; <code>bound</code> should be larger than 0 and less than 0.001.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The survival function P(L&gt;n) and derived from it also the cdf P(L&lt;=n) and
the pmf P(L=n) illustrate the distribution of the EWMA run length...
</p>


<h3>Value</h3>

<p>Returns a vector which resembles the survival function up to a certain point.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>F. F. Gan (1993),
An optimal design of EWMA control charts based on the median run length,
<em>J. Stat. Comput. Simulation 45</em>, 169-184.
</p>
<p>S. Knoth (2003),
EWMA schemes with non-homogeneous transition kernels,
<em>Sequential Analysis 22</em>, 241-255.
</p>
<p>S. Knoth (2004),
Fast initial response features for EWMA Control Charts,
<em>Statistical Papers 46</em>, 47-64.
</p>
<p>L. A. Jones, C. W. Champ, S. E. Rigdon (2001),
The performance of exponentially weighted moving average charts
with estimated parameters,
<em>Technometrics 43</em>, 156-167.
</p>
<p>K.-H. Waldmann (1986),
Bounds for the distribution of the run length of geometric moving 
average charts, <em>Appl. Statist. 35</em>, 151-158.
</p>


<h3>See Also</h3>

<p><code>xewma.sf</code> for the RL survival function of EWMA control charts
w/o pre run uncertainty.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Jones/Champ/Rigdon (2001)

c4m &lt;- function(m, n) sqrt(2)*gamma( (m*(n-1)+1)/2 )/sqrt( m*(n-1) )/gamma( m*(n-1)/2 )

n &lt;- 5 # sample size

# Figure 6, subfigure r=0.1
lambda &lt;- 0.1
L &lt;- 2.454

CDF0 &lt;- 1 - xewma.sf(lambda, L, 0, 600, sided="two")
m &lt;- 10 # pre run size
CDF1 &lt;- 1 - xewma.sf.prerun(lambda, L/c4m(m,n), 0, 600, sided="two",
size=m, df=m*(n-1), estimated="both")
m &lt;- 20
CDF2 &lt;- 1 - xewma.sf.prerun(lambda, L/c4m(m,n), 0, 600, sided="two",
size=m, df=m*(n-1), estimated="both")
m &lt;- 50
CDF3 &lt;- 1 - xewma.sf.prerun(lambda, L/c4m(m,n), 0, 600, sided="two",
size=m, df=m*(n-1), estimated="both")

plot(CDF0, type="l", xlab="t", ylab=expression(P(T&lt;=t)), xlim=c(0,500), ylim=c(0,1))
abline(v=0, h=c(0,1), col="grey", lwd=.7)
points((1:5)*100, CDF0[(1:5)*100], pch=18)
lines(CDF1, col="blue")
points((1:5)*100, CDF1[(1:5)*100], pch=2, col="blue")
lines(CDF2, col="red")
points((1:5)*100, CDF2[(1:5)*100], pch=16, col="red")
lines(CDF3, col="green")
points((1:5)*100, CDF3[(1:5)*100], pch=5, col="green")

legend("bottomright", c("Known", "m=10, n=5", "m=20, n=5", "m=50, n=5"),
       col=c("black", "blue", "red", "green"), pch=c(18, 2, 16, 5), lty=1)
</code></pre>


</div>