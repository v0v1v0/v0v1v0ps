<div class="container">

<table style="width: 100%;"><tr>
<td>residVar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Residual variance extractor
</h2>

<h3>Description</h3>

<p>Extracts from a fit object the residual variance or, depending on the <code>which</code> argument, a family dispersion parameter phi (which is generally not the residual variance itself except for gaussian-response models without prior weights), or a vector of values of the dispersion parameter, or further information about the residual variance model. 
</p>
<p>For gaussian and Gamma response families, the return values  for <code>which = "var"</code> and <code>"phi"</code> include prior weights, if any. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">residVar(object, which = "var", submodel = NULL, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>HLfit</code>, as returned by the fitting functions in <code>spaMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Character: <code>"var"</code> for the fitted residual variances, <code>"phi"</code> for the fitted phi values, <code>"fam_parm"</code> for the dispersion parameter of <code>COMPoisson</code>, <code>negbin1</code>, <code>negbin2</code>, <code>beta_resp</code> or <code>betabin</code> families, <code>"fit"</code> for the fitted residual model (a GLM or a mixed model for residual variances, if not a simpler object),  and <code>"family"</code> or <code>"formula"</code> for such properties of the residual model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submodel</code></td>
<td>
<p>integer: the index of a submodel, if <code>object</code> is a multivariate-response model fitted by <code>fitmv</code>. This argument is mandatory for all <code>which</code> values except <code>"var"</code> and <code>"phi"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p><b>Either</b> NULL, a matrix or data frame, or a numeric vector. See <code>predict.HLfit</code> for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>which="var"</code> (default) and <code>"phi"</code> always return a vector of residual variances (or, alternatively, phi values) of length determined by the <code>newdata</code> and <code>submodel</code> arguments. <br><code>which="fit"</code> returns an object of class <code>HLfit</code>, <code>glm</code>, or a single scalar depending on the residual dispersion model (<code>which="fit"</code> is the option to be used to extract the scalar phi value).<br><code>which="fam_parm"</code> returns either NULL (for families without such a parameter), a vector (if a <code>resid.model</code> was specified for relevant families), a single scalar (relevant families, without <code>resid.model</code>), or a list of such objects (for multivariate-response models).<br>
Other <code>which</code> values return an object of class <code>family</code> or <code>formula</code> as expected. 
</p>


<h3>See Also</h3>

<p><code>get_residVar</code> is a alternative extractor of residual variances with different features inherited from <code>get_predVar</code>. In particular, it is more suited for computing the residual variances of new realizations of a fitted model, not accounting for prior weights used in fitting the model (basic examples of using the <span class="pkg">IsoriX</span> package provide a context where this is the appropriate design decision). By contrast, <code>residVar</code> aims to account for prior weights.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data preparation: simulated trivial life-history data
set.seed(123)
nind &lt;- 20L
u &lt;- rnorm(nind)
lfh &lt;- data.frame(
  id=seq_len(nind), id2=seq_len(nind), 
  feco= rpois(nind, lambda = exp(1+u)), 
  growth=rgamma(nind,shape=1/0.2, scale=0.2*exp(1+u)) # mean=exp(1+u), var= 0.2*mean^2
)
# multivariate-response fit                  
fitlfh &lt;- fitmv(submodels=list(list(feco ~ 1+(1|id), family=poisson()),
                               list(growth ~ 1+(1|id), family=Gamma(log))),
                data=lfh)
#
residVar(fitlfh)
residVar(fitlfh, which="phi") # shows fixed phi=1 for Poisson responses
residVar(fitlfh, submodel=2)
residVar(fitlfh, which="family", submodel=2)
residVar(fitlfh, which="formula", submodel=2)
residVar(fitlfh, which="fit", submodel=2) # Fit here characterized by a single scalar
</code></pre>


</div>