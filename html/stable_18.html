<div class="container">

<table style="width: 100%;"><tr>
<td>dstable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stable Distribution</h2>

<h3>Description</h3>

<p>These functions provide information about the stable distribution
with the location, the dispersion, the skewness and the tail thickness
respectively modelled by the parameters <code>loc</code>, <code>disp</code>,
<code>skew</code> and  <code>tail</code>. These differ from those of 'stabledist' (i.e., Nolan's 0-parameterization and 
1-parameterization as detailed in Nolan (2020)). See the README for how to make equivalent calls
to those of 'stabledist' (i.e., Nolan's 0-parameterization and 
1-parameterization as detailed in Nolan (2020)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dstable(
  x,
  loc = 0,
  disp = 1/sqrt(2),
  skew = 0,
  tail = 2,
  npt = 501,
  up = 10,
  eps = 1e-06,
  integration = "Romberg"
)

pstable(q, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

qstable(p, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

rstable(n = 1, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

hstable(x, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>vector of (real) location parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>vector of (positive) dispersion parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew</code></td>
<td>
<p>vector of skewness parameters (in [-1,1]).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>vector of parameters (in [0,2]) related to the tail thickness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npt, up, integration</code></td>
<td>
<p>As detailed herein – only available when using <code>dstable</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>scalar giving the required precision in computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dstable</code>, <code>pstable</code>, <code>qstable</code> and <code>hstable</code>
compute the density, the distribution, the quantile and the hazard functions
of a stable variate. <code>rstable</code> generates random deviates with
the prescribed stable distribution.
</p>
<p><code>loc</code> is a location parameter in the same way as the mean
in the normal distribution: it can take any real value.
</p>
<p><code>disp</code> is a dispersion parameter in the same way as the standard
deviation in the normal distribution: it can take any positive value.
</p>
<p><code>skew</code> is a skewness parameter: it can take any value in <code class="reqn">(-1,1)</code>.
The distribution is right-skewed, symmetric and left-skewed
when <code>skew</code> is negative, null or positive respectively.
</p>
<p><code>tail</code> is a tail parameter (often named the characteristic exponent):
it can take any value in <code class="reqn">(0,2)</code> (with <code>tail=1</code> and <code>tail=2</code>
yielding the Cauchy and the normal distributions respectively
when symmetry holds).
</p>
<p>If <code>loc</code>, <code>disp</code>, <code>skew</code>, or <code>tail</code> are not
specified they assume the default values of <code class="reqn">0</code>, <code class="reqn">1/sqrt(2)</code>,
<code class="reqn">0</code> and <code class="reqn">2</code> respectively. This corresponds to a normal
variate with mean<code class="reqn">=0</code> and variance<code class="reqn">=1/2 disp^2</code>.
</p>
<p>The stable characteristic function is given by
</p>
<p style="text-align: center;"><code class="reqn">greekphi(t) = i loca t - disp {|t|}^{tail}  [1+i skew sign(t) greekomega(t,tail)]</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">greekomega(t,tail) = \frac{2}{\pi} LOG(ABS(t))</code>
</p>

<p>when <code>tail=1</code>, and
</p>
<p style="text-align: center;"><code class="reqn">greekomega(t,tail) = tan(\frac{\pi tail}{2})</code>
</p>

<p>otherwise.
</p>
<p>The characteristic function is inverted using Fourier's transform
to obtain the corresponding stable density. This inversion requires the
numerical evaluation of an integral from <code class="reqn">0</code> to <code class="reqn">\infty</code>.
Two algorithms
are proposed for this. The default is Romberg's method
(<code>integration</code>="Romberg") which is used to evaluate the integral
with an error bounded by <code>eps</code>.
The alternative method is Simpson's integration
(<code>integration</code>="Simpson"): it approximates the
integral from <code class="reqn">0</code> to <code class="reqn">\infty</code> by an integral
from <code class="reqn">0</code> to <code>up</code>
with <code>npt</code> points subdividing <code class="reqn">(O, up)</code>.
These three extra arguments – <code>integration</code>, <code>up</code> and
<code>npt</code> – are only available when using <code>dstable</code>.
The other functions are all based on Romberg's algorithm.
</p>
<p>[Swihart 2022 update:] 
</p>
<p>See the README for how to make equivalent calls
to those of 'stabledist' (i.e., Nolan's 0-parameterization and 1-parameterization 
as detailed in Nolan (2020)). 
See github for Lambert and Lindsey 1999 JRSS-C journal article, 
which details the parameterization of the Buck (1995) stable distribution which allowed
a Fourier inversion to arrive at a form similar to but not exactly the $g_d$ 
function as detailed in Nolan (2020),
Abdul-Hamid and Nolan (1998) and Nolan (1997).  
The Nolan (2020) reference is a textbook that provides
an accessible and comprehensive summary of stable distributions in the 25 years or so
since the core of this R package was made and put on CRAN.  
The Buck (1995) parameterization most closely resembles the Zolotarev B parameterization
outlined in Definition 3.6 on page 93 of Nolan (2020) – except that Buck (1995) did
not allow the scale parameter to multiply with the location parameter.  
This explains why the 'Zolotarev B' entry in Table 3.1 on page 97 of Nolan (2020) has
the location parameter being multiplied by the scale parameter whereas in converting the Lindsey and Lambert (1999)
to Nolan 1-parameterization the location parameter stays the same.  
</p>
<p>To be clear, <code>stable::dstable</code> and <code>stable::pstable</code> are evaluated 
by numerically integrating the inverse Fourier transform.  The code works 
reasonably for small and moderate values of x, but will have numerical issues 
in some cases (such as values from <code>stable::pstable</code> being greater than 
1 or or not being monotonic).  The arguments <code>npt</code>, <code>up</code>, 
<code>integration</code>, and <code>eps</code> can be adjusted 
to improve accuracy at the cost of speed, but will still have limitations.
Functions that better handle these problems are available in other packages
(such as <code>stabledist</code> and <code>stable</code>) that use an alternative method
(as detailed in Nolan 1997)  
distinct from directly numerically integrating the Fourier inverse transform. 
See last example in the README.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dstable</code>: density
</p>
</li>
<li> <p><code>pstable</code>: cdf
</p>
</li>
<li> <p><code>qstable</code>: quantiles
</p>
</li>
<li> <p><code>rstable</code>: random deviates
</p>
</li>
<li> <p><code>hstable</code>: hazard
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philippe Lambert (Catholic University of Louvain, Belgium, <a href="mailto:phlambert@stat.ucl.ac.be">phlambert@stat.ucl.ac.be</a>)
</p>
<p>Jim Lindsey
</p>


<h3>References</h3>

<p>Lambert, P. and Lindsey, J.K. (1999) Analysing financial returns using
regression models based on non-symmetric stable distributions. Applied
Statistics, 48, 409-424.
</p>
<p>Nolan, John P. Univariate stable distributions. Berlin/Heidelberg, Germany: Springer, 2020.
</p>
<p>Nolan, John P. "Numerical calculation of stable densities and distribution functions." Communications in statistics. Stochastic models 13.4 (1997): 759-774.
</p>
<p>Abdul-Hamid, Husein, and John P. Nolan. "Multivariate stable densities as functions of one dimensional projections." Journal of multivariate analysis 67.1 (1998): 80-89.
</p>


<h3>See Also</h3>

<p><code>stablereg</code> to fit generalized nonlinear regression models
for the stable distribution parameters. 
R packages <code>stabledist</code> and <code>libstableR</code> provide [dpqr] functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">par(mfrow=c(2,2))
x &lt;- seq(-5,5,by=0.1)

# Influence of loc (location)
plot(x,dstable(x,loc=-2,disp=1/sqrt(2),skew=-0.8,tail=1.5),
  type="l",ylab="",main="Varying LOCation")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=-0.8,tail=1.5))
lines(x,dstable(x,loc=2,disp=1/sqrt(2),skew=-0.8,tail=1.5))

# Influence of disp (dispersion)
plot(x,dstable(x,loc=0,disp=0.5,skew=0,tail=1.5),
  type="l",ylab="",main="Varying DISPersion")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=0.9,skew=0,tail=1.5))

# Influence of skew (skewness)
plot(x,dstable(x,loc=0,disp=1/sqrt(2),skew=-0.8,tail=1.5),
  type="l",ylab="",main="Varying SKEWness")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0.8,tail=1.5))

# Influence of tail (tail)
plot(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=0.8),
  type="l",ylab="",main="Varying TAIL thickness")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=2))

</code></pre>


</div>