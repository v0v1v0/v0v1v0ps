<div class="container">

<table style="width: 100%;"><tr>
<td>saemix.plot.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions implementing each type of plot in SAEM</h2>

<h3>Description</h3>

<p>Several plots (selectable by the type argument) are currently available:
convergence plot, individual plots, predictions versus observations,
distribution plots, VPC, residual plots, and mirror plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">saemix.plot.data(saemixObject, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>saemixObject</code></td>
<td>
<p>an object returned by the <code>saemix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to the plots</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions implement plots different graphs related to the algorithm
(convergence plots, likelihood estimation) as well as diagnostic graphs. A
description is provided in the PDF documentation.
</p>
<p>saemix.plot.parcov.aux, compute.sres and compute.eta.map are helper
functions, not intended to be called by the user directly.
</p>
<p>By default, the following plots are produced:
</p>

<dl>
<dt>saemix.plot.data:</dt>
<dd>
<p>A spaghetti plot of the data, displaying the
observed data y as a function of the regression variable (time for a PK
application)</p>
</dd>
<dt>saemix.plot.convergence:</dt>
<dd>
<p>For each parameter in the
model, this plot shows the evolution of the parameter estimate versus the
iteration number</p>
</dd>
<dt>saemix.plot.llis:</dt>
<dd>
<p>Graph showing the evolution of
the log-likelihood during the estimation by importance sampling</p>
</dd>
<dt>saemix.plot.obsvspred:</dt>
<dd>
<p>Plot of the predictions computed with the
population parameters versus the observations (left), and plot of the
predictions computed with the individual parameters versus the observations
(right)</p>
</dd>
<dt>saemix.plot.scatterresiduals:</dt>
<dd>
<p>Scatterplot of the residuals
versus the predictor (top) and versus predictions (bottom), for weighted
residuals (population residuals, left), individual weighted residuals
(middle) and npde (right).</p>
</dd>
<dt>saemix.plot.distribresiduals:</dt>
<dd>
<p>Distribution of the residuals, plotted
as histogram (top) and as a QQ-plot (bottom), for weighted residuals
(population residuals, left), individual weighted residuals (middle) and
npde (right).</p>
</dd>
<dt>saemix.plot.fits:</dt>
<dd>
<p>Model fits. Individual fits are
obtained using the individual parameters with the individual covariates.
Population fits are obtained using the population parameters with the
individual covariates (red) and the individual parameters with the
individual covariates (green). By default the individual plots are
displayed.</p>
</dd>
<dt>saemix.plot.distpsi:</dt>
<dd>
<p>Distribution of the parameters
(conditional on covariates when some are included in the model). A histogram
of individual parameter estimates can be overlayed on the plot, but it
should be noted that the histogram does not make sense when there are
covariates influencing the parameters and a warning will be displayed</p>
</dd>
<dt>saemix.plot.randeff:</dt>
<dd>
<p>Boxplot of the random effects</p>
</dd>
<dt>saemix.plot.correlations:</dt>
<dd>
<p>Correlation between the random effects</p>
</dd>
<dt>saemix.plot.parcov:</dt>
<dd>
<p>Plots of the estimates of the individual
parameters versus the covariates, using scatterplot for continuous
covariates, boxplot for categorical covariates</p>
</dd>
<dt>saemix.plot.randeffcov:</dt>
<dd>
<p>Plots of the estimates of the random effects
versus the covariates, using scatterplot for continuous covariates, boxplot
for categorical covariates</p>
</dd>
<dt>saemix.plot.npde:</dt>
<dd>
<p>Plots 4 graphs to
evaluate the shape of the distribution of the normalised prediction
distribution errors (npde)</p>
</dd>
<dt>saemix.plot.vpc:</dt>
<dd>
<p>Visual Predictive Check,
with options to include the prediction intervals around the boundaries of
the selected interval as well as around the median (50th percentile of the
simulated data). Several methods are available to define binning on the
X-axis (see methods in the PDF guide).</p>
</dd>
<dt>saemix.plot.mirror:</dt>
<dd>
<p>When simulated data is available in the object (component
sim.dat, which can be filled by a call to <code>simulate</code>), this function
plots the original data as spaghetti plot and compares it to several simulated
datasets under the fitted model.</p>
</dd>
</dl>
<p>Each plot can be customised by modifying options, either through a list of
options set by the <code>saemix.plot.setoptions</code> function, or on the
fly by passing an option in the call to the plot (see examples).
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixObject</code>,<code>saemix</code>,
<code>saemix.plot.setoptions</code>, <code>saemix.plot.select</code>,
<code>plot.saemix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA, 
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

saemix.options&lt;-list(seed=632545,save=FALSE,save.graphs=FALSE)

# Not run (strict time constraints for CRAN)
saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)

# Simulate data and compute weighted residuals and npde
saemix.fit&lt;-compute.sres(saemix.fit)

# Data
saemix.plot.data(saemix.fit)

# Convergence
saemix.plot.convergence(saemix.fit)

# Individual plot for subject 1, smoothed
saemix.plot.fits(saemix.fit,ilist=1,smooth=TRUE)

# Individual plot for subject 1 to 12, with ask set to TRUE 
# (the system will pause before a new graph is produced)
saemix.plot.fits(saemix.fit,ilist=c(1:12),ask=TRUE)

# Mirror plots (plots of simulated data compared to the original)
saemix.plot.mirror(saemix.fit)

# Diagnostic plot: observations versus population predictions
par(mfrow=c(1,1))
saemix.plot.obsvspred(saemix.fit,level=0,new=FALSE)

# LL by Importance Sampling
saemix.plot.llis(saemix.fit)

# Boxplot of random effects
saemix.plot.randeff(saemix.fit)

# Relationships between parameters and covariates
saemix.plot.parcov(saemix.fit)

# Relationships between parameters and covariates, on the same page
par(mfrow=c(3,2))
saemix.plot.parcov(saemix.fit,new=FALSE)

# Scatter plot of residuals
# Not run
# Works interactively but not in the contained environment of CRAN (it looks for a datafile 
# instesad of finding the dataset in the environment)
# saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)
# npde.obj&lt;-npdeSaemix(saemix.fit)
# plot(npde.obj)
# VPC, default options (10 bins, equal number of observations in each bin)
# plot(npde.obj, plot.type="vpc")
# plot(npde.obj, plot.type="covariates")
# plot(npde.obj, plot.type="cov.x.scatter")
# plot(npde.obj, plot.type="cov.ecdf")
# VPC, user-defined breaks for binning
# plot(npde.obj, plot.type="vpc", bin.method="user", bin.breaks=c(0.4,0.8,1.5,2.5,4,5.5,8,10,13))


</code></pre>


</div>