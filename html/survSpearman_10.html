<div class="container">

<table style="width: 100%;"><tr>
<td>survRestricted</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes conditional marginal and joint survival probability in a restricted region.</h2>

<h3>Description</h3>

<p>The function computes marginal and joint survival probabilities conditionally on surviving in a restricted region. This region is defined by the user as <code>[0,tauX)x[0,tauY)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">survRestricted(bivarSurf, tauX = Inf, tauY = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bivarSurf</code></td>
<td>
<p>A matrix containing marginal and joint survival probabilities.  The first column is the marginal survival probability corresponding to variable <code>X</code>. The first row is the marginal survival probability corresponding to variable <code>Y</code>. The rest of the matrix contains the joint survival probabilities. The row names of <code>bivarSurf</code> are ordered <code>X</code> values. The column names of <code>bivarSurf</code> are ordered <code>Y</code> values. Element <code>bivarSurf[1,1]</code> equals 1. Its row and column name is <code>'0'</code> (see the documentation for the return value <code>DabrowskaEst</code> in function <code>survDabrowska</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauX</code></td>
<td>
<p>The <code>X</code> value that defines the restricted region for the <code>X</code> variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauY</code></td>
<td>
<p>The <code>Y</code> value that defines the restricted region for the <code>Y</code> variable.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method of Dabrowska can result in negative probability mass for some points, which may result in zero or negative probability of failure in the restricted region. This only happens when the sample size is small and censoring is heavy. If the probability of survival in the restricted region is zero or less, <code>NA</code> value is returned. Otherwise, the function returns a list of survival probabilities and their differentials conditionally on being in the restricted region defined by <code>tauX</code> and <code>tauY</code>. Element <code>Sxy</code> of this list is the conditional marginal and joint survival probabilities with row/column names in the same format as argument <code>bivarSurf</code>. The rest of the returned list elements are matrices in the same format as <code>bivarSurf</code> except that they do not contain marginal values and row/column names.
</p>


<h3>Value</h3>

<p>The function returns the following list of survival surfaces and their differentials: <code>Sxy</code> is the conditional marginal and joint survival probabilities in the same format as <code>bivarSurf</code>; <code>SxMyM</code> is <code>Sxy</code> at point <code>(x-, y-)</code>, where <code>x-</code> is the left limit of <code>x</code>; <code>Sx</code> is the conditional marginal survival probability function for variable X; <code>Sy</code> is the conditional marginal survival probability function for variable Y; <code>Sdx</code> is the conditional marginal probability mass function for variable X; <code>Sdy</code> is the conditional marginal probability mass function for variable Y; <code>SxM</code> is the conditional marginal survival probability function for X at point <code>x-</code>; <code>SyM</code> is the conditional marginal survival probability function for Y at point <code>y-</code>; <code>SxM_y</code> is the conditional joint survival probability function at point <code>(x-, y)</code>; <code>Sx_yM</code> is the conditional joint survival probability function at point <code>(x, y-)</code>; <code>Sdx_y</code> is <code>SxM_y - Sxy</code>; <code>Sx_dy</code> is <code>Sx_yM - Sxy</code>; <code>Sdx_yM</code> is <code>SxMyM - Sx_yM</code>; <code>SxM_dy</code> is <code>SxMyM - SxM_y</code>; <code>Sdxdy</code> is the conditional joint probability mass function.
</p>


<h3>Author(s)</h3>

<p>Svetlana K Eden, <a href="mailto:svetlanaeden@gmail.com">svetlanaeden@gmail.com</a>
</p>


<h3>References</h3>

<p>Eden, S.K., Li, C., Shepherd B.E. (2021). Non-parametric Estimation of Spearman's Rank Correlation with Bivariate Survival Data, Biometrics (under revision).
</p>


<h3>Examples</h3>

<pre><code class="language-R">X = c(0.5, 0.6, 0.8)
Y = c(0.44, 0.77, 0.99)
deltaX = c(1, 0, 1)
deltaY = c(1, 1, 1)
bivarSurf = survDabrowska(X, Y, deltaX, deltaY)$DabrowskaEst
bivarSurf

condSurf = survRestricted(bivarSurf, tauX = Inf, tauY = 0.88)$Sxy
condSurf

</code></pre>


</div>