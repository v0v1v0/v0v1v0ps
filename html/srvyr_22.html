<div class="container">

<table style="width: 100%;"><tr>
<td>as_survey_rep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a tbl_svy survey object using replicate weights</h2>

<h3>Description</h3>

<p>Create a survey object with replicate weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as_survey_rep(.data, ...)

## S3 method for class 'data.frame'
as_survey_rep(
  .data,
  variables = NULL,
  repweights = NULL,
  weights = NULL,
  type = c("BRR", "Fay", "JK1", "JKn", "bootstrap", "successive-difference", "ACS",
    "other"),
  combined_weights = TRUE,
  rho = NULL,
  bootstrap_average = NULL,
  scale = NULL,
  rscales = NULL,
  fpc = NULL,
  fpctype = c("fraction", "correction"),
  mse = getOption("survey.replicates.mse"),
  degf = NULL,
  ...
)

## S3 method for class 'tbl_lazy'
as_survey_rep(
  .data,
  variables = NULL,
  repweights = NULL,
  weights = NULL,
  type = c("BRR", "Fay", "JK1", "JKn", "bootstrap", "successive-difference", "ACS",
    "other"),
  combined_weights = TRUE,
  rho = NULL,
  bootstrap_average = NULL,
  scale = NULL,
  rscales = NULL,
  fpc = NULL,
  fpctype = c("fraction", "correction"),
  mse = getOption("survey.replicates.mse"),
  degf = NULL,
  ...
)

## S3 method for class 'svyrep.design'
as_survey_rep(.data, ...)

## S3 method for class 'survey.design2'
as_survey_rep(
  .data,
  type = c("auto", "JK1", "JKn", "BRR", "bootstrap", "subbootstrap", "mrbbootstrap",
    "Fay"),
  rho = 0,
  fpc = NULL,
  fpctype = NULL,
  ...,
  compress = TRUE,
  mse = getOption("survey.replicates.mse")
)

## S3 method for class 'tbl_svy'
as_survey_rep(
  .data,
  type = c("auto", "JK1", "JKn", "BRR", "bootstrap", "subbootstrap", "mrbbootstrap",
    "Fay"),
  rho = 0,
  fpc = NULL,
  fpctype = NULL,
  ...,
  compress = TRUE,
  mse = getOption("survey.replicates.mse")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame (which contains the variables specified below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>Variables to include in the design (default is all)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repweights</code></td>
<td>
<p>Variables specifying the replication weight variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Variables specifying sampling weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of replication weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combined_weights</code></td>
<td>
<p><code>TRUE</code> if the <code>repweights</code> already
include the sampling weights. This is usually the case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Shrinkage factor for weights in Fay's method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap_average</code></td>
<td>
<p>For <code>type = "bootstrap"</code>, if the bootstrap
weights have been averaged, gives the number of iterations averaged over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale, rscales</code></td>
<td>
<p>Scaling constant for variance, see
<code>svrepdesign</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpc</code></td>
<td>
<p>Variables specifying a finite population correction, see
<code>svrepdesign</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpctype</code></td>
<td>
<p>Finite population correction information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>if <code>TRUE</code>, compute variances based on sum of squares
around the point estimate, rather than the mean of the replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degf</code></td>
<td>
<p>Design degrees of freedom: a single number, or <code>NULL</code>,
in which case a value will be computed automatically, which can be slow
for very large data sets. See <code>svrepdesign</code>
for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compress</code></td>
<td>
<p>if <code>TRUE</code>, store replicate weights in compressed form
(if converting from design)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If provided a data.frame, it is a wrapper around <code>svrepdesign</code>.
All survey variables must be included in the data.frame itself. Variables are
selected by using bare column names, or convenience functions described in
<code>select</code>.
</p>
<p>If provided a <code>svyrep.design</code> object from the survey package,
it will turn it into a srvyr object, so that srvyr functions will work with it
</p>
<p>If provided a survey design (<code>survey.design2</code> or <code>tbl_svy</code>), it is a wrapper
around <code>as.svrepdesign</code>, and will convert from a survey design to
replicate weights.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_svy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Examples from ?survey::svrepdesign()
library(survey)
library(dplyr)
data(scd)
# use BRR replicate weights from Levy and Lemeshow
scd &lt;- scd %&gt;%
  mutate(rep1 = 2 * c(1, 0, 1, 0, 1, 0),
         rep2 = 2 * c(1, 0, 0, 1, 0, 1),
         rep3 = 2 * c(0, 1, 1, 0, 0, 1),
         rep4 = 2 * c(0, 1, 0, 1, 1, 0))

scdrep &lt;- scd %&gt;%
  as_survey_rep(type = "BRR", repweights = starts_with("rep"),
                combined_weights = FALSE)

# dplyr 0.7 introduced new style of NSE called quosures
# See `vignette("programming", package = "dplyr")` for details
repwts &lt;- quo(starts_with("rep"))
scdrep &lt;- scd %&gt;%
  as_survey_rep(type = "BRR", repweights = !!repwts,
                combined_weights = FALSE)

</code></pre>


</div>