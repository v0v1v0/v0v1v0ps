<div class="container">

<table style="width: 100%;"><tr>
<td>n.gee.1subgroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size estimation for longitudinal GEE models</h2>

<h3>Description</h3>

<p><code>n.gee.1subgroup</code> calculates the required sample size for proving a desired alternative when testing a regression coefficients in a full and/or a subpopulation. See 'Details' for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">n.gee.1subgroup(
  alpha,
  tail = "both",
  beta = NULL,
  delta,
  sigma,
  tau = 0.5,
  k = 1,
  npow = NULL,
  nmax = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>which type of test is used, e.g. which quartile und H0 is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>type II error (power=1-beta) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>vector of estimated treatment effect in overall and sub population, c(overall population, only subpopulation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of estimated standard deviations, c(full population, subpopulation). See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>subgroup prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between control and treatment: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npow</code></td>
<td>
<p>calculates power of a test if <code>npow</code> is a sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum total sample size.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a sample size estimation in a design with a nested subgroup within an overall population. To calculate the required sample only the value of tested regressor needs to inserted as <code>delta</code>. <code>sigma</code> is the variance of that regressor.
The power for the global null hypothesis is given by 1-<code>beta</code> and <code>alpha</code> specifies the false positve level for rejecting <code class="reqn">H_0: \Delta_F=\Delta_S=0</code> to level <code>alpha</code>.
</p>
<p>Here argument <code>k</code> denotes the
sample size allocation factor between treatment groups, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>


<h3>Value</h3>

<p><code>n.gee.1subgroup</code> returns the required sample size within the control group and treatment group.
</p>


<h3>Source</h3>

<p><code>n.gee.1subgroup</code> uses code contributed by Roland Gerard Gera.
</p>


<h3>See Also</h3>

<p><code>bssr.1subgroup</code> for blinded sample size re-estimation within a running trial and <code>sandwich</code> for estimating asymptotic covarianc mtrices in GEE models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Calculate required sample size to correctly reject Null with
#80% probability when testing global Nullhypothesis H_0: Delta_F=Delta_S = 0, while
#assuming the coefficient in and outside of the subgroup is Delta=c(0.1,0,1) with a
#subgroup-prevalence of tau=0.4.
#The variances of regressors in delta when variances are unequal sigma=c(0.8,0.4).

estimate&lt;-n.gee.1subgroup(alpha=0.05,beta=0.2,delta=c(0.1,0.1),sigma=c(0.8,0.4),tau=0.4, k=1)
summary(estimate)

#Alternatively we can estimate the power our study would have
#if we know the effect in and outside our subgroup as
#well as the variance of the regressors. Here we
#estimate that only 300 Patiens total can be recruited and we are interested
#in the power that would give us.

n.gee.1subgroup(alpha=0.05,delta=c(0.1,0.1),sigma=c(0.8,0.4),tau=0.4, k=1, npow=300)

</code></pre>


</div>