<div class="container">

<table style="width: 100%;"><tr>
<td>sklars.omega.bayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Do Bayesian inference for Sklar's Omega.</h2>

<h3>Description</h3>

<p>Do Bayesian inference for Sklar's Omega.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sklars.omega.bayes(
  data,
  level = c("amount", "balance", "percentage"),
  verbose = FALSE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix of scores. Each row corresponds to a unit, each column a coder. The columns must be named appropriately so that the correct copula correlation matrix can be constructed. See <code>build.R</code> for details regarding column naming.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of measurement, either <code>"amount"</code> or <code>"balance"</code> or <code>"percentage"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if TRUE, various messages are printed to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters.
</p>

<dl>
<dt>dist</dt>
<dd>
<p>when <code>level = "balance"</code>, one of <code>"gaussian"</code>, <code>"laplace"</code>, <code>"t"</code>; when <code>level = "amount"</code>, <code>"gamma"</code>; when <code>level = "percentage"</code>, one of <code>"beta"</code> or <code>"kumaraswamy"</code>.</p>
</dd>
<dt>minit</dt>
<dd>
<p>the minimum sample size. This should be large enough to permit accurate estimation of Monte Carlo standard errors. The default is 1,000.</p>
</dd>
<dt>maxit</dt>
<dd>
<p>the maximum sample size. Sampling from the posterior terminates when all estimated coefficients of variation are smaller than <code>tol</code> or when <code>maxit</code> samples have been drawn, whichever happens first. The default is 10,000.</p>
</dd>
<dt>sigma.1</dt>
<dd>
<p>the proposal standard deviation for the first marginal parameter. Defaults to 0.1.</p>
</dd>
<dt>sigma.2</dt>
<dd>
<p>the proposal standard deviation for the second marginal parameter. Defaults to 0.1.</p>
</dd>
<dt>sigma.omega</dt>
<dd>
<p>a vector of proposal standard deviations for the parameters of the copula correlation matrix. These default to 0.1.</p>
</dd>
<dt>tol</dt>
<dd>
<p>a tolerance. If all estimated coefficients of variation are smaller than <code>tol</code>, no more samples are drawn from the posterior. The default value is 0.1.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function does MCMC for Bayesian inference for continuous scores.
</p>
<p>Control parameter <code>dist</code> must be used to select a marginal distribution from among <code>"gaussian"</code>, <code>"laplace"</code>, <code>"t"</code>, and <code>"gamma"</code> (for balances or amounts), or from among <code>"beta"</code> or <code>"kumaraswamy"</code> (for percentages).
</p>
<p>Details regarding prior distributions and sampling are provided in the package vignette.
</p>


<h3>Value</h3>

<p>Function <code>sklars.omega.bayes</code> returns an object of class <code>"sklarsomega"</code>, which is a list comprising the following elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>accept</code></td>
<td>
<p>a vector of acceptance rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>
<p>the value of DIC for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>the list of control parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the matrix of scores, perhaps altered to remove rows (units) containing fewer than two scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of posterior samples that were drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level of measurement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcse</code></td>
<td>
<p>a vector of Monte Carlo standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>always equal to <code>"Bayesian"</code> for this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mpar</code></td>
<td>
<p>the number of marginal parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>the total number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the initial value of the copula correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.hat</code></td>
<td>
<p>the estimated value of the copula correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.R.hat</code></td>
<td>
<p>a square root of the estimated copula correlation matrix. This is used for simulation and to compute the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>the posterior samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>the value of argument <code>verbose</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the scores as a vector, perhaps altered to remove rows (units) containing fewer than two scores.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hughes, J. (2018). Sklar's Omega: A Gaussian copula-based framework for assessing agreement. <em>ArXiv e-prints</em>, March.
</p>
<p>Nissi, M. J., Mortazavi, S., Hughes, J., Morgan, P., and Ellermann, J. (2015). T2* relaxation time of acetabular and femoral cartilage with and without intra-articular Gd-DTPA2 in patients with femoroacetabular impingement. <em>American Journal of Roentgenology</em>, <b>204</b>(6), W695.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Fit a subset of the cartilage data, assuming a Laplace marginal distribution. Compute
# 95% HPD intervals. Show the acceptance rates for the three parameters.

data(cartilage)
data = as.matrix(cartilage)[1:100, ]
colnames(data) = c("c.1.1", "c.2.1")
set.seed(111111)
fit1 = sklars.omega.bayes(data, level = "balance", verbose = FALSE,
                          control = list(dist = "laplace", minit = 1000, maxit = 5000, tol = 0.01,
                                         sigma.1 = 1, sigma.2 = 0.1, sigma.omega = 0.2))
summary(fit1)
fit1$accept

# Now assume a noncentral t marginal distribution.

set.seed(4565)
fit2 = sklars.omega.bayes(data, level = "balance", verbose = FALSE,
                          control = list(dist = "t", minit = 1000, maxit = 5000, tol = 0.01,
                                         sigma.1 = 0.2, sigma.2 = 2, sigma.omega = 0.2))
summary(fit2)
fit2$accept

</code></pre>


</div>