<div class="container">

<table style="width: 100%;"><tr>
<td>sim_dat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A simulated spatio-temporal dataset</h2>

<h3>Description</h3>

<p>This simulated dataset is saved as a list, and it contains the following 
three elements:
</p>

<dl>
<dt>y</dt>
<dd>
<p>A vector of length <code class="reqn">N</code>; it contains the data of the observed 
response variable <code class="reqn">y</code>.</p>
</dd>
<dt>x</dt>
<dd>
<p>A vector of length <code class="reqn">N</code>; it contains the data of the covariate 
<code class="reqn">x</code>. </p>
</dd>
<dt>st</dt>
<dd>
<p>An <code class="reqn">N\times 3</code> matrix containing the spatial locations and 
times for all the observations in the dataset.</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">data(sim_dat)
</code></pre>


<h3>Format</h3>

<p>A list containing <code class="reqn">N=10,000</code> observations.
</p>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
set.seed(100)
n &lt;- 100; m &lt;- 100; N &lt;- n*m
t &lt;- rep(seq(0.01,1,0.01),each=m)
su &lt;- sv &lt;- seq(0.1,1,0.1)
su &lt;- rep(su,each=10); sv &lt;- rep(sv,10)
su &lt;- rep(su,n); sv &lt;- rep(sv,n)
st &lt;- matrix(0,N,3)
st[,1] &lt;- su; st[,2] &lt;- sv; st[,3] &lt;- t
mu &lt;- rep(0,N)
for(i in 1:N) {
  mu[i] &lt;- 2+sin(pi*su[i])*sin(pi*sv[i])+sin(2*pi*t[i]) 
}
dist &lt;- matrix(0,m,m) # distance matrix
for(i in 1:m) {
  for(j in 1:m) {
    dist[i,j] &lt;- sqrt((su[i]-su[j])^2+(sv[i]-sv[j])^2)
  }
}
cov.s &lt;- matrix(0,m,m) # spatial correlation
for(i in 1:m) {
  for(j in 1:m) {
    cov.s[i,j] &lt;- 0.3^2*exp(-30*dist[i,j]) 
  }
}
noise &lt;- matrix(0,n,m)
noise[1,] &lt;- MASS::mvrnorm(1,mu=rep(0,m),Sigma=cov.s) 
for(i in 2:n) {
  noise[i,] &lt;- 0.1*noise[i-1,]+sqrt(1-0.1^2)*
    MASS::mvrnorm(1,mu=rep(0,m),Sigma=cov.s)
}
noise &lt;- c(t(noise)); x &lt;- rnorm(N,0,0.3) 
beta &lt;- 0.5; y &lt;- mu+x*beta+noise
sim_dat &lt;- list(); sim_dat$y &lt;- y
sim_dat$x &lt;- x; sim_dat$st &lt;- st
</code></pre>


</div>