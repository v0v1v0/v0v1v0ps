<div class="container">

<table style="width: 100%;"><tr>
<td>sampler_mh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Metropolis-Hastings (MH) Sampler</h2>

<h3>Description</h3>

<p>This sampler navigates the proposal distribution following a random walk. At each step, it generates a new proposal from a proposal distribution (in this case a Gaussian centered at the current position) and chooses to accept it or reject it following the Metropolis-Hastings rule: it accepts it if the density of the posterior distribution at the proposed point is higher than at the current point. If the current position is denser, it still may accept the proposal with probability <code>proposal_density / current_density</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampler_mh(
  start,
  distr_name = NULL,
  distr_params = NULL,
  sigma_prop = NULL,
  iterations = 1024L,
  weights = NULL,
  custom_density = NULL,
  alpha = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Vector. Starting position of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_name</code></td>
<td>
<p>Name of the distribution from which to sample from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr_params</code></td>
<td>
<p>Distribution parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_prop</code></td>
<td>
<p>Covariance matrix of the proposal distribution. If sampling in 1D space, it can be instead a number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations of the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If using a mixture distribution, the weights given to each constituent distribution. If none given, it defaults to equal weights for all distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_density</code></td>
<td>
<p>Instead of providing names, params and weights, the user may prefer to provide a custom density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>autocorrelation of proposals parameter, from -1 to 1, with 0 being independent proposals</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As mentioned, the proposal distribution is a Normal distribution. Its mean is the current position, and its variance is equal to the <code>sigma_prop</code> parameter, which defaults to the identity matrix if not specified.
</p>
<p>This algorithm has been used to model human data in many places (e.g. Castillo et al. 2024; Dasgupta et al. 2017; Lieder et al. 2018; Zhu et al. 2022).
</p>


<h3>Value</h3>

<p>A named list containing
</p>

<ol>
<li>
<p>Samples: the history of visited places (an n x d matrix, n = iterations; d = dimensions)
</p>
</li>
<li>
<p>Proposals: the history of proposed places (an n x d matrix, n = iterations; d = dimensions). Nothing is proposed in the first iteration (the first iteration is the start value) and so the first row is NA
</p>
</li>
<li>
<p>Acceptance Ratio: The proportion of proposals that were accepted.
</p>
</li>
</ol>
<h3>References</h3>

<p>Castillo L, León-Villagrá P, Chater N, Sanborn A (2024).
“Explaining the Flaws in Human Random Generation as Local Sampling with Momentum.”
<em>PLOS Computational Biology</em>, <b>20</b>(1), 1–24.
<a href="https://doi.org/10.1371/journal.pcbi.1011739">doi:10.1371/journal.pcbi.1011739</a>.<br><br> Dasgupta I, Schulz E, Gershman SJ (2017).
“Where Do Hypotheses Come From?”
<em>Cognitive Psychology</em>, <b>96</b>, 1–25.
<a href="https://doi.org/10.1016/j.cogpsych.2017.05.001">doi:10.1016/j.cogpsych.2017.05.001</a>.<br><br> Lieder F, Griffiths TL, M. Huys QJ, Goodman ND (2018).
“The Anchoring Bias Reflects Rational Use of Cognitive Resources.”
<em>Psychonomic Bulletin &amp; Review</em>, <b>25</b>(1), 322–349.
<a href="https://doi.org/10.3758/s13423-017-1286-8">doi:10.3758/s13423-017-1286-8</a>.<br><br> Zhu J, León-Villagrá P, Chater N, Sanborn AN (2022).
“Understanding the Structure of Cognitive Noise.”
<em>PLoS Computational Biology</em>, <b>18</b>(8), e1010312.
<a href="https://doi.org/10.1371/journal.pcbi.1010312">doi:10.1371/journal.pcbi.1010312</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Sample from a normal distribution
result &lt;- sampler_mh(
         distr_name = "norm", distr_params = c(0,1),
         start = 1, sigma_prop = diag(1)
         )
cold_chain &lt;- result$Samples
</code></pre>


</div>