<div class="container">

<table style="width: 100%;"><tr>
<td>pointsInPolygon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Points Inside Polygon</h2>

<h3>Description</h3>

<p>Determines which of a set of  points lie inside a closed polygon or at
least one of a set of polygons
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointsInPolygon(xy, poly, logical = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>2-column matrix or dataframe of x-y coordinates for points to assess</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly</code></td>
<td>
<p>2-column matrix or dataframe containing perimeter points of polygon, or
a SpatialPolygonsDataFrame object from package <span class="pkg">sp</span>, or a ‘mask’
object (see Warning)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logical</code></td>
<td>
<p>logical to control the output when ‘poly’ is a mask
(see Details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>poly</code> is a SpatialPolygonsDataFrame object then the method
<code>over</code> is used from <span class="pkg">sp</span>. This allows multiple polygons and
polygons with holes.
</p>
<p>If <code>poly</code> is an secr ‘mask’ object then <code>xy</code> is discretized
and matched to the cells in <code>poly</code>. If <code>logical = FALSE</code>
then the returned value is a vector of integer indices to the row in
‘poly’ corresponding to each row of ‘xy’; otherwise the result is a
vector of logical values.
</p>
<p>Otherwise, the algorithm is adapted from some code posted on the S-news list
by Peter Perkins (23/7/1996). The polygon should be closed (last point
same as first).
</p>


<h3>Value</h3>

<p>Vector of logical or integer values, one for each row in <code>xy</code>
</p>


<h3>Warning</h3>

<p>If <code>poly</code> is a mask object then its cells must be
aligned to the x- and y- axes</p>


<h3>See Also</h3>

<p><code>over</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## 100 random points in unit square
xy &lt;- matrix(runif(200), ncol = 2)
## triangle centred on (0.5, 0.5)
poly &lt;- data.frame(x = c(0.2,0.5,0.8,0.2), y = c(0.2,0.8,0.2,0.2))
plot(xy, pch = 1 + pointsInPolygon(xy, poly))
lines(poly)

</code></pre>


</div>