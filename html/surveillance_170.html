<div class="container">

<table style="width: 100%;"><tr>
<td>imdepi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Occurrence of Invasive Meningococcal Disease in Germany
</h2>

<h3>Description</h3>

<p><code>imdepi</code> contains data on the spatio-temporal location of 636
cases of invasive meningococcal disease (IMD) caused by the two most
common meningococcal finetypes in Germany, ‘<span class="samp">⁠B:P1.7-2,4:F1-5⁠</span>’ (of
serogroup B) and ‘<span class="samp">⁠C:P1.5,2:F3-3⁠</span>’ (of serogroup C).
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("imdepi")
</code></pre>


<h3>Format</h3>

<p><code>imdepi</code> is an object of class
<code>"epidataCS"</code> (a list with components <code>events</code>,
<code>stgrid</code>, <code>W</code> and <code>qmatrix</code>).
</p>


<h3>Details</h3>

<p>The <code>imdepi</code> data is a simplified version of what has been
analyzed by Meyer et al. (2012). Simplification is with respect to the
temporal resolution of the <code>stgrid</code> (see below) to be used in
<code>twinstim</code>'s endemic model component.
In what follows, we describe the elements <code>events</code>,
<code>stgrid</code>, <code>W</code>, and <code>qmatrix</code> of <code>imdepi</code> in
greater detail.
</p>
<p><code>imdepi$events</code> is a <code>"SpatialPointsDataFrame"</code>
object (ETRS89 projection, i.e. EPSG code 3035, with unit ‘km’)
containing 636 events, each with the following entries:
</p>

<dl>
<dt>time:</dt>
<dd>
<p>Time of the case occurrence measured in number of days
since origin. Note that a U(0,1)-distributed random number has
been subtracted from each of the original event times (days) to
break ties (using
<code>untie(imdepi_tied, amount=list(t=1))</code>).</p>
</dd>
<dt>tile:</dt>
<dd>
<p>Tile ID in the spatio-temporal grid (<code>stgrid</code>) of
endemic covariates, where the event is contained in.
This corresponds to one of the 413 districts of Germany.
</p>
</dd>
<dt>type:</dt>
<dd>
<p>Event type, a factor with levels <code>"B"</code> and <code>"C"</code>.</p>
</dd>
<dt>eps.t:</dt>
<dd>
<p>Maximum temporal interaction range for the event.
Here set to 30 days.</p>
</dd>
<dt>eps.s:</dt>
<dd>
<p>Maximum spatial interaction range for the event.
Here set to 200 km.</p>
</dd>
<dt>sex:</dt>
<dd>
<p>Sex of the case, i.e. a factor with levels <code>"female"</code>
and <code>"male"</code>. Note: for some cases this
information is not available (<code>NA</code>).</p>
</dd> 
<dt>agegrp:</dt>
<dd>
<p>Factor giving the age group of the case,
i.e. 0-2, 3-18 or &gt;=19. Note: for one case this
information is not available (<code>NA</code>).</p>
</dd>
<dt>BLOCK, start:</dt>
<dd>
<p>Block ID and start time (in days since origin) of
the cell in the spatio-temporal endemic covariate grid, which the
event belongs to.</p>
</dd> 
<dt>popdensity:</dt>
<dd>
<p>Population density (per square km) at the
location of the event (corresponds to population density of the
district where the event is located).</p>
</dd>
</dl>
<p>There are further auxiliary columns attached to the events' data
the names of which begin with a . (dot): These are created during
conversion to the <code>"epidataCS"</code> class and are necessary for
fitting the data with <code>twinstim</code>, see the description of the
<code>"epidataCS"</code>-class.
With <code>coordinates(imdepi$events)</code> one obtains the (x,y) locations
of the events.
</p>
<p>The district identifier in <code>tile</code> is indexed according to
the German official municipality key (
“Amtlicher Gemeindeschlüssel”). See
<a href="https://de.wikipedia.org/wiki/Amtlicher_Gemeindeschl%C3%BCssel">https://de.wikipedia.org/wiki/Amtlicher_Gemeindeschl%C3%BCssel</a>
for details.
</p>
<p>The data component <code>stgrid</code> contains the spatio-temporal grid of 
endemic covariate information. In addition to the usual bookkeeping
variables this includes:
</p>

<dl>
<dt>area:</dt>
<dd>
<p>Area of the district <code>tile</code> in square kilometers.</p>
</dd>
<dt>popdensity:</dt>
<dd>
<p>Population density (inhabitants per square
kilometer) computed from DESTATIS (Federal Statistical Office)
information (Date: 31.12.2008) on communities level (LAU2)
aggregated to district level (NUTS3).</p>
</dd> 
</dl>
<p>We have actually not included any time-dependent covariates here, we
just established this grid with a (reduced -&gt; fast) temporal
resolution of <em>monthly</em> intervals so that we can model endemic
time trends and seasonality (in this discretized time).
</p>
<p>The entry <code>W</code> contains the observation window as a
<code>"SpatialPolygons"</code> object, in this case the
boundaries of Germany (<code>stateD</code>). It was obtained as the
“UnaryUnion” of Germany's districts (<code>districtsD</code>) as at
2009-01-01, simplified by the “modified Visvalingam” algorithm
(level 6.6%) available at <a href="https://MapShaper.org">https://MapShaper.org</a> (v. 0.1.17).
The objects <code>districtsD</code> and <code>stateD</code> are contained in
<code>system.file("shapes", "districtsD.RData", package="surveillance")</code>.
</p>
<p>The entry <code>qmatrix</code> is a <code class="reqn">2\times 2</code> identity matrix
indicating that no transmission between the two finetypes can occur.
</p>


<h3>Source</h3>

<p>IMD case reports: German Reference Centre for Meningococci
at the Department of Hygiene and Microbiology,
Julius-Maximilians-Universität Würzburg, Germany
(<a href="https://www.hygiene.uni-wuerzburg.de/meningococcus/">https://www.hygiene.uni-wuerzburg.de/meningococcus/</a>).
Thanks to Dr. Johannes Elias and Prof. Dr. Ulrich Vogel for providing
the data.
</p>
<p>Shapefile of Germany's districts as at 2009-01-01:
German Federal Agency for Cartography and Geodesy, Frankfurt
am Main, Germany, <a href="https://gdz.bkg.bund.de/">https://gdz.bkg.bund.de/</a>.


</p>


<h3>References</h3>

<p>Meyer, S., Elias, J. and Höhle, M. (2012):
A space-time conditional intensity model for invasive meningococcal
disease occurrence. <em>Biometrics</em>, <b>68</b>, 607-616.
<a href="https://doi.org/10.1111/j.1541-0420.2011.01684.x">doi:10.1111/j.1541-0420.2011.01684.x</a>
</p>


<h3>See Also</h3>

<p>the data class <code>"epidataCS"</code>, and function
<code>twinstim</code> for model fitting. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("imdepi")

# Basic information
print(imdepi, n=5, digits=2)

# What is an epidataCS-object?
str(imdepi, max.level=4)
names(imdepi$events@data)
# =&gt; events data.frame has hidden columns
sapply(imdepi$events@data, class)
# marks and print methods ignore these auxiliary columns

# look at the B type only
imdepiB &lt;- subset(imdepi, type == "B")
#&lt;- subsetting applies to the 'events' component
imdepiB

# select only the last 10 events
tail(imdepi, n=10)   # there is also a corresponding 'head' method

# Access event marks
str(marks(imdepi))

# there is an update-method which assures that the object remains valid
# when changing parameters like eps.s, eps.t or qmatrix
update(imdepi, eps.t = 20)

# Summary
s &lt;- summary(imdepi)
s
str(s)

# Step function of number of infectives
plot(s$counter, xlab = "Time [days]",
     ylab = "Number of infectious individuals",
     main = "Time series of IMD assuming 30 days infectious period")

# distribution of number of potential sources of infection
opar &lt;- par(mfrow=c(1,2), las=1)
for (type in c("B","C")) {
  plot(100*prop.table(table(s$nSources[s$eventTypes==type])),
  xlim=range(s$nSources), xlab = "Number of potential epidemic sources",
  ylab = "Proportion of events [%]")
}
par(opar)

# a histogram of the number of events along time (using the
# plot-method for the epidataCS-class, see ?plot.epidataCS)
opar &lt;- par(mfrow = c(2,1))
plot(imdepi, "time", subset = type == "B", main = "Finetype B")
plot(imdepi, "time", subset = type == "C", main = "Finetype C")
par(opar)

# Plot the spatial distribution of the events in W
plot(imdepi, "space", points.args = list(col=c("indianred", "darkblue")))

# or manually (no legends, no account for tied locations)
plot(imdepi$W, lwd=2, asp=1) 
plot(imdepi$events, pch=c(3,4)[imdepi$events$type], cex=0.8,
     col=c("indianred", "darkblue")[imdepi$events$type], add=TRUE)

## Not run: 
  # Show a dynamic illustration of the spatio-temporal dynamics of the 
  # spread during the first year of type B with a step size of 7 days
  animate(imdepiB, interval=c(0,365), time.spacing=7, sleep=0.1)

## End(Not run)
</code></pre>


</div>