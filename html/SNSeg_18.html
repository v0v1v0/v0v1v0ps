<div class="container">

<table style="width: 100%;"><tr>
<td>SNSeg_Uni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Self-normalization (SN) based change point estimates for univariate time
series</h2>

<h3>Description</h3>

<p>The function <code>SNSeg_Uni</code> is a SN change point estimation procedure for a
univariate time series based on the change in a single or multiple parameters
. It also detect changes in correlation between two univariate time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SNSeg_Uni(
  ts,
  paras_to_test,
  confidence = 0.9,
  grid_size_scale = 0.05,
  grid_size = NULL,
  plot_SN = TRUE,
  est_cp_loc = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>A univariate time series expressed as a numeric vector. when the
argument paras_to_test is specified as "bivcor", the correlation between
bivariate time series, the input ts must be an n by 2 matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paras_to_test</code></td>
<td>
<p>The parameters that SN algorithm aim to examine, which
are presented as a string, a number, or a combination of both. Available
choices of paras_to_test include "mean", "variance", "acf", "bivcor"
and a numeric value of quantile between 0 and 1. In the scenario where the
input ts is a univariate time series, users are allowed to enter a
combination of parameters for paras_to_test except "bivcor".
</p>
<p>Users can also set up their own function as the input of "paras_to_test". If so,
the user-fined function should use the univariate time series as the input and
return a numeric value as the output. Please see the help vignette for more details
by running <code>vignette("SNSeg", package = "SNSeg")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>Confidence level of SN tests as a numeric value. Available
choices of confidence levels contain 0.9, 0.95, 0.99, 0.995 and 0.999. The
default is set to 0.9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size_scale</code></td>
<td>
<p>A numeric value of the trimming parameter and only in
use if grid_size = NULL. Users are allowed to choose any grid_size_scale
between 0.05 and 0.5. A warning will be given if it is outside the
range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size</code></td>
<td>
<p>Local window size h to compute the critical value for SN
test. Since grid_size = n*grid_size_scale, where n is the length of time
series, this function will compute the grid_size_scale by dividing n from
grid_size when it is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_SN</code></td>
<td>
<p>Boolean value to plot the time series or not.
The default setting is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_cp_loc</code></td>
<td>
<p>Boolean value to plot a red solid vertical line for
estimated change-point locations if est_cp_loc = TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>SNSeg_Uni</code> returns an S3 object of class "SNSeg_Uni" including
the time series, the type of parameter to be tested, the local window size to
cover a change point, the estimated change-point locations, the confidence level
and the critical value of the SN test. It also generates a time series segmentation
plot when <code>plot_SN = TRUE</code>.
</p>

<dl>
<dt><code>ts</code></dt>
<dd>
<p>A numeric vector or two-dimensional matrix of the input
time series.</p>
</dd>
<dt><code>paras_to_test</code></dt>
<dd>
<p>A character, numeric value, a function or vector of the
parameter(s) used for the SN test. If it is a function defined by the user, please refer to
the section "test in a general functional" in the help vignette for more details on
how to write the function correctly.</p>
</dd>
<dt><code>grid_size</code></dt>
<dd>
<p>A numeric value of the window size.</p>
</dd>
<dt><code>SN_sweep_result</code></dt>
<dd>
<p>A list of matrices where each matrix
consists of four columns: (1) SN-based test statistic for each change-point
location (2) Change-point location  (3) Lower bound of the local window and
(4) Upper bound of the local window.</p>
</dd>
<dt><code>est_cp</code></dt>
<dd>
<p>A vector containing the locations of the estimated
change-points.</p>
</dd>
<dt><code>confidence</code></dt>
<dd>
<p>Confidence level of SN test as a numeric value.</p>
</dd>
<dt><code>critical_value</code></dt>
<dd>
<p>Critical value of the SN-based test statistic.</p>
</dd>
</dl>
<p>Users can apply the functions <code>summary.SN</code> to compute the parameter estimate
of each segment separated by the detected change-points. An additional function
<code>plot.SN</code> can be used to plot the time series with estimated change-points.
Users can set the option <code>plot_SN = TRUE</code> or use the function <code>plot.SN</code>
to plot the time series.
</p>
<p>It deserves to note that some change-points could be missing due to the constraint
on <code>grid_size_scale</code> or related <code>grid_size</code> that <code>grid_size_scale</code>
has a minimum value of 0.05. Therefore, SNCP claims no change-points within the
first n<em><code>grid_size_scale</code> or the last n</em><code>grid_size_scale</code> time points.
This is a limitation of the function <code>SNSeg_Uni</code>.
</p>
<p>For more examples of <code>SNSeg_Uni</code> see the help vignette:
<code>vignette("SNSeg", package = "SNSeg")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# code to simulate a univariate time series
set.seed(7)
ts &lt;- MAR_Variance(2, "V1")
ts &lt;- ts[,2]
# test the change in a single parameter (variance)
# grid_size defined
result &lt;- SNSeg_Uni(ts, paras_to_test = "variance", confidence = 0.9,
                    grid_size_scale = 0.05, grid_size = 67,
                    plot_SN = TRUE, est_cp_loc = TRUE)
# estimated change-point locations
result$est_cp
# For more examples of change in a single or multiple parameters, please run
# the command: vignette("SNSeg", package = "SNSeg")


</code></pre>


</div>