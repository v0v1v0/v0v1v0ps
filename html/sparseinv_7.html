<div class="container">

<table style="width: 100%;"><tr>
<td>Takahashi_Davis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Takahashi equations</h2>

<h3>Description</h3>

<p>Computes the sparse inverse subset of a sparse matrix <code>Q</code> using the Takahashi equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Takahashi_Davis(Q = NULL, cholQp = NULL, return_perm_chol = 0, P = 0,
  gc = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>precision matrix of class <code>matrix</code>, <code>Matrix</code> (column-compressed, i.e., <code>dgCMatrix</code> or <code>dsCMatrix</code>), or <code>spam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cholQp</code></td>
<td>
<p>the Cholesky factor of class <code>dtCMatrix</code> of the permuted <code>Q</code> (if known already). If both <code>Q</code> and <code>cholQp</code> are specified, <code>Q</code> is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_perm_chol</code></td>
<td>
<p>if 1, the Cholesky factor of the permuted <code>Q</code> is returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>the permutation matrix of class <code>dgCMatrix</code> (if known already)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gc</code></td>
<td>
<p>do garbage collection throughout (may increase computational time but useful for small memory machines)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function first computes the Cholesky factor of <code>Q</code>. The fill-in reduction permutation is the approximate minimum degree permutation (amd) of Timothy Davis' SuiteSparse package configured to be slightly more aggressive than that in the <code>Matrix</code> package. The function then uses the Takahashi equations to compute the variances at the non-zero locations in the Cholesky factor from the factor itself. The equations themselves are implemented in C using the SparseSuite package of Timothy Davis.
</p>


<h3>Value</h3>

<p>if return_perm_chol == 0, the sparse inverse subset of Q is returned, where the non-zero elements correspond to those in the Cholesky factor of its permutation.
If !(return_perm_chol  == 0), a list with three elements is returned: <code>S</code> (the sparse inverse subset), Lp (the Cholesky factor of the permuted matrix) and P (the
permutation matrix)
</p>


<h3>Note</h3>

<p>This package is a wrapper for C functions implemented by Timothy Davis in SuiteSparse. The author of this package has done no work on the sparse inverse routines themselves and any acknowledgment should include one to SuiteSparse (see below for reference). The author of this package was made aware of this methodology by Botond Cseke.
</p>


<h3>References</h3>

<p>Takahashi, K., Fagan, J., Chin, M.-S., 1973. Formation of a sparse bus impedance matrix and its application to short circuit study. 8th PICA Conf. Proc. June 4–6, Minneapolis, Minn.
</p>
<p>Davis, T. A., 2014. sparseinv: Sparse Inverse Subset. URL https://au.mathworks.com/matlabcentral/fileexchange/33966-sparseinv–sparse-inverse-subset
Davis, T. A., 2006. Direct Methods for Sparse Linear Systems. SIAM, Philadelphia, PA.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(Matrix)
Q = sparseMatrix(i = c(1, 1, 2, 2),
                 j = c(1, 2, 1, 2),
                 x = c(0.1, 0.2, 0.2, 1))
X &lt;- cholPermute(Q)
S_partial = Takahashi_Davis(Q, cholQp = X$Qpermchol, P = X$P)
</code></pre>


</div>