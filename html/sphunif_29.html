<div class="container">

<table style="width: 100%;"><tr>
<td>cir_stat_Kuiper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistics for testing circular uniformity</h2>

<h3>Description</h3>

<p>Low-level implementation of several statistics for assessing
circular uniformity on <code class="reqn">[0, 2\pi)</code> or, equivalently,
<code class="reqn">S^1:=\{{\bf x}\in R^2:||{\bf x}||=1\}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cir_stat_Kuiper(Theta, sorted = FALSE, KS = FALSE, Stephens = FALSE)

cir_stat_Watson(Theta, sorted = FALSE, CvM = FALSE, Stephens = FALSE)

cir_stat_Watson_1976(Theta, sorted = FALSE, minus = FALSE)

cir_stat_Range(Theta, sorted = FALSE, gaps_in_Theta = FALSE,
  max_gap = TRUE)

cir_stat_Rao(Theta, sorted = FALSE, gaps_in_Theta = FALSE)

cir_stat_Greenwood(Theta, sorted = FALSE, gaps_in_Theta = FALSE)

cir_stat_Log_gaps(Theta, sorted = FALSE, gaps_in_Theta = FALSE,
  abs_val = TRUE)

cir_stat_Vacancy(Theta, a = 2 * pi, sorted = FALSE,
  gaps_in_Theta = FALSE)

cir_stat_Max_uncover(Theta, a = 2 * pi, sorted = FALSE,
  gaps_in_Theta = FALSE)

cir_stat_Num_uncover(Theta, a = 2 * pi, sorted = FALSE,
  gaps_in_Theta = FALSE, minus_val = TRUE)

cir_stat_Gini(Theta, sorted = FALSE, gaps_in_Theta = FALSE)

cir_stat_Gini_squared(Theta, sorted = FALSE, gaps_in_Theta = FALSE)

cir_stat_Ajne(Theta, Psi_in_Theta = FALSE)

cir_stat_Rothman(Theta, Psi_in_Theta = FALSE, t = 1/3)

cir_stat_Hodges_Ajne(Theta, asymp_std = FALSE, sorted = FALSE,
  use_Cressie = TRUE)

cir_stat_Cressie(Theta, t = 1/3, sorted = FALSE)

cir_stat_FG01(Theta, sorted = FALSE)

cir_stat_Rayleigh(Theta, m = 1L)

cir_stat_Bingham(Theta)

cir_stat_Hermans_Rasson(Theta, Psi_in_Theta = FALSE)

cir_stat_Gine_Gn(Theta, Psi_in_Theta = FALSE)

cir_stat_Gine_Fn(Theta, Psi_in_Theta = FALSE)

cir_stat_Pycke(Theta, Psi_in_Theta = FALSE)

cir_stat_Pycke_q(Theta, Psi_in_Theta = FALSE, q = 0.5)

cir_stat_Bakshaev(Theta, Psi_in_Theta = FALSE)

cir_stat_Riesz(Theta, Psi_in_Theta = FALSE, s = 1)

cir_stat_PCvM(Theta, Psi_in_Theta = FALSE)

cir_stat_PRt(Theta, Psi_in_Theta = FALSE, t = 1/3)

cir_stat_PAD(Theta, Psi_in_Theta = FALSE, AD = FALSE, sorted = FALSE)

cir_stat_Poisson(Theta, Psi_in_Theta = FALSE, rho = 0.5)

cir_stat_Softmax(Theta, Psi_in_Theta = FALSE, kappa = 1)

cir_stat_CCF09(Theta, dirs, K_CCF09 = 25L, original = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>a <b>matrix</b> of size <code>c(n, M)</code> with <code>M</code> samples
of size <code>n</code> of circular data on <code class="reqn">[0, 2\pi)</code>. Must not contain
<code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>
<p>are the columns of <code>Theta</code> sorted increasingly? If
<code>TRUE</code>, performance is improved. If <code>FALSE</code> (default), each
column of <code>Theta</code> is sorted internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KS</code></td>
<td>
<p>compute the Kolmogorov-Smirnov statistic (which is
<em>not</em> invariant under origin shifts) instead of the Kuiper statistic?
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Stephens</code></td>
<td>
<p>compute Stephens (1970) modification so that the null
distribution of the is less dependent on the sample size? The modification
does not alter the test decision.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CvM</code></td>
<td>
<p>compute the Cramér-von Mises statistic (which is <em>not</em>
invariant under origin shifts) instead of the Watson statistic? Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus</code></td>
<td>
<p>compute the invariant <code class="reqn">D_n^-</code> instead of <code class="reqn">D_n^+</code>?
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaps_in_Theta</code></td>
<td>
<p>does <code>Theta</code> contain the matrix of
<em>circular gaps</em> that is obtained with <br><code>cir_gaps(Theta)</code>?
If <code>FALSE</code> (default), the circular gaps are computed internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_gap</code></td>
<td>
<p>compute the maximum gap for the range statistic? If
<code>TRUE</code> (default), rejection happens for <em>large</em> values of
the statistic, which is consistent with the rest of tests. Otherwise,
the minimum gap is computed and rejection happens for <em>low</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs_val</code></td>
<td>
<p>return the absolute value of the Darling's log gaps
statistic? If <code>TRUE</code> (default), rejection happens for <em>large</em>
values of the statistic, which is consistent with the rest of tests.
Otherwise, the signed statistic is computed and rejection happens for
large <em>absolute</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>either: </p>

<ul>
<li> <p><code class="reqn">a_n = a / n</code> parameter used in the length of the arcs
of the coverage-based tests. Must be positive. Defaults to <code>2 * pi</code>.
</p>
</li>
<li> <p><code class="reqn">a</code> parameter for the Stereo test, a real in <code class="reqn">[-1, 1]</code>.
Defaults to <code>0</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus_val</code></td>
<td>
<p>return the negative value of the (standardized) number of
uncovered spacings? If <code>TRUE</code> (default), rejection happens for
<em>large</em> values of the statistic, which is consistent with the rest of
tests. Otherwise, rejection happens for <em>low</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Psi_in_Theta</code></td>
<td>
<p>does <code>Theta</code> contain the shortest angles matrix
<code class="reqn">\boldsymbol\Psi</code> that is obtained with
<br><code>Psi_mat(array(Theta, dim = c(n, 1, M)))</code>? If <code>FALSE</code>
(default), <code class="reqn">\boldsymbol\Psi</code> is computed internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p><code class="reqn">t</code> parameter for the Rothman and Cressie tests, a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asymp_std</code></td>
<td>
<p>normalize the Hodges-Ajne statistic in terms of its
asymptotic distribution? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_Cressie</code></td>
<td>
<p>compute the Hodges-Ajne statistic as a particular case
of the Cressie statistic? Defaults to <code>TRUE</code> as it is more efficient.
If <code>FALSE</code>, the geometric construction in Ajne (1968) is employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>integer <code class="reqn">m</code> for the <code class="reqn">m</code>-modal Rayleigh test. Defaults to
<code>m = 1</code> (the standard Rayleigh test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p><code class="reqn">q</code> parameter for the Pycke "<code class="reqn">q</code>-test", a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p><code class="reqn">s</code> parameter for the <code class="reqn">s</code>-Riesz test, a real in
<code class="reqn">(0, 2)</code>. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AD</code></td>
<td>
<p>compute the Anderson-Darling statistic (which is <em>not</em>
invariant under origin shifts) instead of the Projected Anderson-Darling
statistic? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p><code class="reqn">\rho</code> parameter for the Poisson test, a real in
<code class="reqn">[0, 1)</code>. Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p><code class="reqn">\kappa</code> parameter for the Softmax test, a
non-negative real. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dirs</code></td>
<td>
<p>a matrix of size <code>c(n_proj, 2)</code> containing <code>n_proj</code>
random directions (in Cartesian coordinates) on <code class="reqn">S^1</code> to perform the
CCF09 test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_CCF09</code></td>
<td>
<p>integer giving the truncation of the series present in the
asymptotic distribution of the Kolmogorov-Smirnov statistic. Defaults to
<code>25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original</code></td>
<td>
<p>return the CCF09 statistic as originally defined?
If <code>FALSE</code> (default), a faster and equivalent statistic is computed,
and rejection happens for <em>large</em> values of the statistic, which is
consistent with the rest of tests. Otherwise, rejection happens for
<em>low</em> values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Descriptions and references for most of the statistics are available
in García-Portugués and Verdebout (2018).
</p>
<p>The statistics <code>cir_stat_PCvM</code> and <code>cir_stat_PRt</code> are provided
for the sake of completion, but they equal the more efficiently-implemented
statistics <code>2 * cir_stat_Watson</code> and <code>cir_stat_Rothman</code>,
respectively.
</p>


<h3>Value</h3>

<p>A matrix of size <code>c(M, 1)</code> containing the statistics for each
of the <code>M</code> samples.
</p>


<h3>Warning</h3>

<p>Be careful on avoiding the next bad usages of the functions, which will
produce spurious results:
</p>

<ul>
<li>
<p> The entries of <code>Theta</code> are <em>not</em> in <code class="reqn">[0, 2\pi)</code>.
</p>
</li>
<li> <p><code>Theta</code> does <em>not</em> contain the circular gaps when
<code>gaps_in_Theta = TRUE</code>.
</p>
</li>
<li> <p><code>Theta</code> is <em>not</em> sorted increasingly when
<code>data_sorted = TRUE</code>.
</p>
</li>
<li> <p><code>Theta</code> does <em>not</em> contain
<code>Psi_mat(array(Theta, dim = c(n, 1, M)))</code> when
<br><code>Psi_in_Theta = TRUE</code>.
</p>
</li>
<li>
<p> The directions in <code>dirs</code> do <em>not</em> have unit norm.
</p>
</li>
</ul>
<h3>References</h3>

<p>García-Portugués, E. and Verdebout, T. (2018) An overview of uniformity
tests on the hypersphere. <em>arXiv:1804.00286</em>.
<a href="https://doi.org/10.48550/arXiv.1804.00286">doi:10.48550/arXiv.1804.00286</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sample uniform circular data

M &lt;- 2
n &lt;- 100
set.seed(987202226)
Theta &lt;- r_unif_cir(n = n, M = M)

## Tests based on the empirical cumulative distribution function

# Kuiper
cir_stat_Kuiper(Theta)
cir_stat_Kuiper(Theta, Stephens = TRUE)

# Watson
cir_stat_Watson(Theta)
cir_stat_Watson(Theta, Stephens = TRUE)

# Watson (1976)
cir_stat_Watson_1976(Theta)

## Partition-based tests

# Ajne
Theta_array &lt;- Theta
dim(Theta_array) &lt;- c(nrow(Theta), 1, ncol(Theta))
Psi &lt;- Psi_mat(Theta_array)
cir_stat_Ajne(Theta)
cir_stat_Ajne(Psi, Psi_in_Theta = TRUE)

# Rothman
cir_stat_Rothman(Theta, t = 0.5)
cir_stat_Rothman(Theta)
cir_stat_Rothman(Psi, Psi_in_Theta = TRUE)

# Hodges-Ajne
cir_stat_Hodges_Ajne(Theta)
cir_stat_Hodges_Ajne(Theta, use_Cressie = FALSE)

# Cressie
cir_stat_Cressie(Theta, t = 0.5)
cir_stat_Cressie(Theta)

# FG01
cir_stat_FG01(Theta)

## Spacings-based tests

# Range
cir_stat_Range(Theta)

# Rao
cir_stat_Rao(Theta)

# Greenwood
cir_stat_Greenwood(Theta)

# Log gaps
cir_stat_Log_gaps(Theta)

# Vacancy
cir_stat_Vacancy(Theta)

# Maximum uncovered spacing
cir_stat_Max_uncover(Theta)

# Number of uncovered spacings
cir_stat_Num_uncover(Theta)

# Gini mean difference
cir_stat_Gini(Theta)

# Gini mean squared difference
cir_stat_Gini_squared(Theta)

## Sobolev tests

# Rayleigh
cir_stat_Rayleigh(Theta)
cir_stat_Rayleigh(Theta, m = 2)

# Bingham
cir_stat_Bingham(Theta)

# Hermans-Rasson
cir_stat_Hermans_Rasson(Theta)
cir_stat_Hermans_Rasson(Psi, Psi_in_Theta = TRUE)

# Gine Fn
cir_stat_Gine_Fn(Theta)
cir_stat_Gine_Fn(Psi, Psi_in_Theta = TRUE)

# Gine Gn
cir_stat_Gine_Gn(Theta)
cir_stat_Gine_Gn(Psi, Psi_in_Theta = TRUE)

# Pycke
cir_stat_Pycke(Theta)
cir_stat_Pycke(Psi, Psi_in_Theta = TRUE)

# Pycke q
cir_stat_Pycke_q(Theta)
cir_stat_Pycke_q(Psi, Psi_in_Theta = TRUE)

# Bakshaev
cir_stat_Bakshaev(Theta)
cir_stat_Bakshaev(Psi, Psi_in_Theta = TRUE)

# Riesz
cir_stat_Riesz(Theta, s = 1)
cir_stat_Riesz(Psi, Psi_in_Theta = TRUE, s = 1)

# Projected Cramér-von Mises
cir_stat_PCvM(Theta)
cir_stat_PCvM(Psi, Psi_in_Theta = TRUE)

# Projected Rothman
cir_stat_PRt(Theta, t = 0.5)
cir_stat_PRt(Theta)
cir_stat_PRt(Psi, Psi_in_Theta = TRUE)

# Projected Anderson-Darling
cir_stat_PAD(Theta)
cir_stat_PAD(Psi, Psi_in_Theta = TRUE)

## Other tests

# CCF09
dirs &lt;- r_unif_sph(n = 3, p = 2, M = 1)[, , 1]
cir_stat_CCF09(Theta, dirs = dirs)

## Connection of Kuiper and Watson statistics with KS and CvM, respectively

# Rotate sample for KS and CvM
alpha &lt;- seq(0, 2 * pi, l = 1e4)
KS_alpha &lt;- sapply(alpha, function(a) {
  cir_stat_Kuiper((Theta[, 2, drop = FALSE] + a) %% (2 * pi), KS = TRUE)
})
CvM_alpha &lt;- sapply(alpha, function(a) {
  cir_stat_Watson((Theta[, 2, drop = FALSE] + a) %% (2 * pi), CvM = TRUE)
})
AD_alpha &lt;- sapply(alpha, function(a) {
  cir_stat_PAD((Theta[, 2, drop = FALSE] + a) %% (2 * pi), AD = TRUE)
})

# Kuiper is the maximum rotated KS
plot(alpha, KS_alpha, type = "l")
abline(h = cir_stat_Kuiper(Theta[, 2, drop = FALSE]), col = 2)
points(alpha[which.max(KS_alpha)], max(KS_alpha), col = 2, pch = 16)

# Watson is the minimum rotated CvM
plot(alpha, CvM_alpha, type = "l")
abline(h = cir_stat_Watson(Theta[, 2, drop = FALSE]), col = 2)
points(alpha[which.min(CvM_alpha)], min(CvM_alpha), col = 2, pch = 16)

# Anderson-Darling is the average rotated AD?
plot(alpha, AD_alpha, type = "l")
abline(h = cir_stat_PAD(Theta[, 2, drop = FALSE]), col = 2)
abline(h = mean(AD_alpha), col = 3)
</code></pre>


</div>