<div class="container">

<table style="width: 100%;"><tr>
<td>soilhypfitS3methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Common S3 Methods for Class <code>fit_wrc_hcc</code>
</h2>

<h3>Description</h3>

<p>This page documents the methods <code>coef</code>,
<code>summary</code>, <code>print</code>, <code>plot</code> and <code>lines</code> for the class
<code>fit_wrc_hcc</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'fit_wrc_hcc'
coef(object, what = c("all", "nonlinear", "linear"),
    subset = NULL, residual_se = FALSE, se = FALSE, gof = FALSE, lc = FALSE,
    e0 = FALSE, bound = lc, ...)

## S3 method for class 'fit_wrc_hcc'
summary(object, what = c("all", "nonlinear", "linear"),
    subset = NULL, gof = TRUE, lc = TRUE, ...)

## S3 method for class 'fit_wrc_hcc'
print(x, ...)

## S3 method for class 'fit_wrc_hcc'
plot(x, what = c("wrc", "hcc"), y = NULL,
    subset = NULL, ylim_wc = NULL, ylim_hc = NULL,
    head_saturation = 0.01,
    beside = identical(sum(par("mfrow")), 2L), pch = 1, col_points = "black",
    col_line_x = "blue", lty_x = "solid",
    col_line_y = "orange", lty_y = "dashed",
    xlab_wc = "head [m]", ylab_wc = "water content [-]",
    xlab_hc = "head [m]", ylab_hc = "hyd. conductivity [m/d]",
    draw_legend = TRUE, draw_parameter = FALSE, cex_legend = 0.7, ...)

## S3 method for class 'fit_wrc_hcc'
lines(x, what = c("wrc", "hcc"), id = 1,
    head_saturation = 0.01, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, x, y</code></td>
<td>
<p>an object of class <code>fit_wrc_hcc</code>, see
<code>fit_wrc_hcc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>character keyword indicating the type of parameters to return
(<code>coef</code>) or the type of data to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an integer, character or logical vector to the choose the
soil samples for which data and model curves are displayed or extracted.
Defaults to <code>NULL</code> which displays results for all soil samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual_se</code></td>
<td>
<p>a logical scalar to control whether residual standard
errors (= standard deviations of residuals) should be returned, see
<em>Details</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a logical scalar to control whether standard errors of the
nonlinear parameters <code class="reqn">\boldsymbol{\nu}^\mathrm{} </code> should be returned, see
<em>Details</em> and <code>vcov.fit_wrc_hcc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof</code></td>
<td>
<p>a logical scalar to control whether goodness-of-fit statistic
should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lc</code></td>
<td>
<p>a logical scalar to control whether the characteristic evaporative
length should be returned, see <code>evaporative-length</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e0</code></td>
<td>
<p>a logical scalar to control whether the evaporation rate should
be returned.  This is only effective for constrained estimation, see
<code>evaporative-length</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>a logical scalar to control whether the lower and upper
bounds of the ratio <code class="reqn">L_\mathrm{c}/L_\mathrm{t}</code> should be
returned. This is only effective for constrained estimation, see
<code>evaporative-length</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim_wc</code></td>
<td>
<p>optional numeric vector of length 2 to set the range of
water content values displayed on the y-axis (default <code>NULL</code> for
automatic axis scales).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim_hc</code></td>
<td>
<p>optional numeric vector of length 2 to set the range of
hydraulic conductivity values displayed on the y-axis (default
<code>NULL</code> for automatic axis scales).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>head_saturation</code></td>
<td>
<p>head value (unit m) assigned to zero head values in
plots with logarithmic head scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beside</code></td>
<td>
<p>a logical scalar controlling whether water retention curves
and hydraulic conductivity functions of a sample should be plotted side
by side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plotting ‘character’, i.e., symbol to use for the
measurements, see <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_points</code></td>
<td>
<p>color code or name for symbol colors for the
measurements, see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_line_x</code></td>
<td>
<p>color code or name for the line representing the
fitted model <code>x</code>, see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty_x</code></td>
<td>
<p>type of line representing the fitted model <code>x</code>, see
<code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_line_y</code></td>
<td>
<p>color code or name for the line representing the
fitted model <code>y</code>, see <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty_y</code></td>
<td>
<p>type of line representing the fitted model <code>y</code>, see
<code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_wc</code></td>
<td>
<p>a character string with the annotation for the
<var>x</var>-axis of a water retention curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_wc</code></td>
<td>
<p>a character string with the annotation for the
<var>y</var>-axis of a water retention curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_hc</code></td>
<td>
<p>a character string with the annotation for the
<var>x</var>-axis of a hydraulic conductivity function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_hc</code></td>
<td>
<p>a character string with the annotation for the
<var>y</var>-axis of a hydraulic conductivity function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_legend</code></td>
<td>
<p>a logical scalar controlling whether a legend with the
values of the arguments <code>x</code> and <code>y</code> and the residual sums of
squares is drawn if <code>y</code> is non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_parameter</code></td>
<td>
<p>a logical scalar controlling whether the
parameters are drawn (default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex_legend</code></td>
<td>
<p>a character expansion factor for annotations by
<code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a character string or integer scalar to select the sample for
which to plot the modelled water retention curve or hydraulic
conductivity function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Residual standard errors, standard errors of the nonlinear parameters and
confidence intervals based on the asymptotic normal distribution are
computed only for mpd and ml estimates, see <br><code>soilhypfitIntro</code>, <code>control_fit_wrc_hcc</code> and
<code>vcov</code>.
</p>
<p>The <code>plot</code> method for class <code>fit_wrc_hcc</code> displays for each
sample the measurements of the water retention curve and/or the hydraulic
conductivity function, along with the fitted model curve(s).  Optionally,
the curves of a second model fit (specified by the
argument <code>y</code>) can be plotted for each sample.
</p>
<p>The <code>lines</code> method adds the curve of a fitted model to an existing
plot.
</p>


<h3>Value</h3>

<p>The method <code>coef</code> returns a dataframe with the estimated parameters
(and optionally standard errors), optionally the value of the
objective function along with convergence code and/or information on the
characteristic evaporative length.
</p>
<p>The method <code>summary</code> generates a list (of class
<code>summary.fit_wrc_hcc</code>) with the following components:

</p>

<dl>
<dt><code>data</code></dt>
<dd>
<p>a named integer vector with the total number of
samples (<code>nsamp</code>) and the number of samples with only water
retention (<code>nwrc</code>), only hydraulic conductivity (<code>nhcc</code>) and
both type of measurements (<code>nwrchcc</code>).</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list with a subset (<code>settings</code>,
<code>nloptr</code>, <code>sce</code>, <code>approximation_alpha_k0</code>,
<code>param_bound</code>, <code>param_tf</code>) of the components of
<code>object[["control"]]</code>, see <code>fit_wrc_hcc</code> and
<code>control_fit_wrc_hcc</code>.</p>
</dd>
<dt><code>result</code></dt>
<dd>
<p>a dataframe with the estimated parameters and
optionally the residual sum of squares along with convergence code
and/or information on the characteristic evaporative length.</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>the <code>call</code> component of <code>object</code>.</p>
</dd>
</dl>
<p>Note that only a <code>print</code> method is available for class
<code>summary.fit_wrc_hcc</code>.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>See Also</h3>

<p><code>soilhypfitIntro</code> for a description of the models and a brief
summary of the parameter estimation approach;
</p>
<p><code>fit_wrc_hcc</code> for (constrained) estimation of parameters of
models for soil water retention and hydraulic conductivity data;
</p>
<p><code>control_fit_wrc_hcc</code> for options to control
<code>fit_wrc_hcc</code>;
</p>



<p><code>vcov</code> for computing (co-)variances of the estimated
nonlinear parameters;
</p>
<p><code>prfloglik_sample</code> for profile loglikelihood
computations;
</p>
<p><code>wc_model</code> and <code>hc_model</code> for currently
implemented models for soil water retention curves and hydraulic
conductivity functions;
</p>
<p><code>evaporative-length</code> for physically constraining parameter
estimates of soil hydraulic material functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# use of \donttest{} because execution time exceeds 5 seconds

data(sim_wrc_hcc)

# define number of cores for parallel computations
if(interactive()) ncpu &lt;- parallel::detectCores() - 1L else ncpu &lt;- 1L

# estimate parameters for 3 samples by unconstrained, global optimisation
# algorithm NLOPT_GN_MLSL
# sample 1: use only conductivity data
# sample 2: use only water content data
# sample 3: use both types of data
rfit_uglob &lt;- fit_wrc_hcc(
  wrc_formula = wc ~ head | id, hcc_formula = hc ~ head | id,
  wrc_subset = id != 1, hcc_subset = id != 2,
  data = sim_wrc_hcc, fit_param = default_fit_param(tau = TRUE),
  control = control_fit_wrc_hcc(param_bound = param_boundf(
      alpha = c(0.00001, 50), n = c(1.0001, 7), tau = c(-1, 5)
    ), pcmp = control_pcmp(ncores = ncpu)))
print(rfit_uglob)
summary(rfit_uglob)
coef(rfit_uglob, what = "nonlinear")
coef(rfit_uglob, what = "linear", gof = TRUE)
coef(vcov(rfit_uglob), status = TRUE, se = FALSE)
op &lt;- par(mfrow = c(3, 2))
plot(rfit_uglob)
on.exit(par(op))


</code></pre>


</div>