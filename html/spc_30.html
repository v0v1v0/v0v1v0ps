<div class="container">

<table style="width: 100%;"><tr>
<td>dphat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Percent defective for normal samples</h2>

<h3>Description</h3>

<p>Density, distribution function and quantile function
for the sample percent defective calculated on normal samples
with mean equal to <code>mu</code> and standard deviation equal to <code>sigma</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">dphat(x, n, mu=0, sigma=1, type="known", LSL=-3, USL=3, nodes=30)

pphat(q, n, mu=0, sigma=1, type="known", LSL=-3, USL=3, nodes=30)

qphat(p, n, mu=0, sigma=1, type="known", LSL=-3, USL=3, nodes=30)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu, sigma</code></td>
<td>
<p>parameters of the underlying normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>choose whether the standard deviation is given and fixed (<code>"known"</code>) or estimated and potententially monitored (<code>"estimated"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LSL,USL</code></td>
<td>
<p>lower and upper specification limit, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>number of quadrature nodes needed for <code>type="estimated"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bruhn-Suhr/Krumbholz (1990) derived the cumulative distribution function
of the sample percent defective calculated on normal samples to applying them for a new variables sampling plan.
These results were heavily used in Krumbholz/Zöller (1995) for Shewhart and in Knoth/Steinmetz (2013) for EWMA control charts.
For algorithmic details see, essentially, Bruhn-Suhr/Krumbholz (1990).
Two design variants are treated: The simple case, <code>type="known"</code>, with known normal variance and the presumably much
more relevant and considerably intricate case, <code>type="estimated"</code>, where both parameters of
the normal distribution are unknown. Basically, given lower and upper specification limits and the normal distribution,
one estimates the expected yield based on a normal sample of size <code>n</code>.
</p>


<h3>Value</h3>

<p>Returns vector of pdf, cdf or qf values for the statistic phat.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>M. Bruhn-Suhr and W. Krumbholz (1990),
A new variables sampling plan for normally distributed lots with unknown standard deviation and double specification limits,
<em>Statistical Papers</em> 31(1), 195-207.
</p>
<p>W. Krumbholz and A. Zöller (1995),
<code>p</code>-Karten vom Shewhartschen Typ für die messende Prüfung,
<em>Allgemeines Statistisches Archiv</em> 79, 347-360.
</p>
<p>S. Knoth and S. Steinmetz (2013),
EWMA <code>p</code> charts  under sampling by variables,
<em>International Journal of Production Research</em> 51(13), 3795-3807.
</p>


<h3>See Also</h3>

<p><code>phat.ewma.arl</code> for routines using the herewith considered phat statistic.</p>


<h3>Examples</h3>

<pre><code class="language-R"># Figures 1 (c) and (d) from Knoth/Steinmetz (2013)
n      &lt;-  5
LSL    &lt;- -3
USL    &lt;-  3

par(mar=c(5, 5, 1, 1) + 0.1)

p.star &lt;- 2*pnorm( (LSL-USL)/2 ) # for p &lt;= p.star pdf and cdf vanish

p_ &lt;- seq(p.star+1e-10, 0.07, 0.0001) # define support of Figure 1

# Figure 1 (c)
pp_ &lt;- pphat(p_, n)
plot(p_, pp_, type="l", xlab="p", ylab=expression(P( hat(p) &lt;= p )),
     xlim=c(0, 0.06), ylim=c(0,1), lwd=2)
abline(h=0:1, v=p.star, col="grey")

# Figure 1 (d)
dp_ &lt;- dphat(p_, n)
plot(p_, dp_, type="l", xlab="p", ylab="f(p)", xlim=c(0, 0.06),
     ylim=c(0,50), lwd=2)
abline(h=0, v=p.star, col="grey")
</code></pre>


</div>