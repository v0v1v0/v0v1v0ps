<div class="container">

<table style="width: 100%;"><tr>
<td>sample_mixtures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample mixtures with random genotypes and random parameters according to priors</h2>

<h3>Description</h3>

<p>Sample mixtures with random genotypes and random parameters according to priors
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_mixtures(
  n,
  contributors,
  freqs,
  sampling_parameters,
  model_settings,
  sample_model,
  pedigree,
  results_directory,
  seed,
  write_non_contributors = FALSE,
  tag = "simulation"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. Number of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contributors</code></td>
<td>
<p>Character vector with unique names of contributors. Valid names are "U1", "U2", ... for unrelated contributors or the names of pedigree members for related contributors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>Allele frequencies (see read_allele_freqs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling_parameters</code></td>
<td>
<p>List. Passed to the sample_model function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_settings</code></td>
<td>
<p>List. Passed to the sample_model function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_model</code></td>
<td>
<p>Function such as sample_log_normal_model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pedigree</code></td>
<td>
<p>(optionally) ped object. Contributors can be named pedigree members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results_directory</code></td>
<td>
<p>(optionally) Character with path to directory where results are written to disk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>(optionally) Integer seed value that can be used to get reproducible runs. If results are written to disk, the 'Run details.txt' file will contain a seed that can be used for reproducing the result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_non_contributors</code></td>
<td>
<p>Logical. If TRUE, sampled genotypes for non-contributing pedigree members will also be written to disk. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag</code></td>
<td>
<p>Character. Used for sub directory name when results_directory is provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>results_directory</code> is provided, this function has the side effect of writing results to disk.
</p>
<p>Return value is a list with simulation results:</p>

<ul>
<li> <p><code>call</code> matched call
</p>
</li>
<li> <p><code>smash</code> DataFrame with all samples in SMASH format (see SMASH_to_wide_table)
</p>
</li>
<li> <p><code>samples</code> Detailed results for each sample
</p>
</li>
<li> <p><code>parameter_summary</code> DataFrame with parameters for each sample
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                           package = "simDNAmixtures"))
data(gf)

sampling_parameters &lt;- list(min_mu = 50., max_mu = 5e3,
                           min_cv = 0.05, max_cv = 0.35,
                           degradation_shape1 = 10, degradation_shape2 = 1)

mixtures &lt;- sample_mixtures(n = 2, contributors = c("U1", "U2"), freqs = freqs,
                            sampling_parameters = sampling_parameters,
                            model_settings = gf$gamma_settings_no_stutter,
                            sample_model = sample_gamma_model)

</code></pre>


</div>