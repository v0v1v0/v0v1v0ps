<div class="container">

<table style="width: 100%;"><tr>
<td>Sobolev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic distributions of Sobolev statistics of spherical uniformity</h2>

<h3>Description</h3>

<p>Approximated density, distribution, and quantile functions for
the asymptotic null distributions of Sobolev statistics of uniformity
on <code class="reqn">S^{p-1}:=\{{\bf x}\in R^p:||{\bf x}||=1\}</code>. These asymptotic distributions are infinite
weighted sums of (central) chi squared random variables:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k = 1}^\infty v_k^2 \chi^2_{d_{p, k}},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">d_{p, k} := {{p + k - 3}\choose{p - 2}} + {{p + k - 2}\choose{p - 2}}</code>
</p>

<p>is the dimension of the space of eigenfunctions of the Laplacian on
<code class="reqn">S^{p-1}</code>, <code class="reqn">p\ge 2</code>, associated to the <code class="reqn">k</code>-th
eigenvalue, <code class="reqn">k\ge 1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_p_k(p, k, log = FALSE)

weights_dfs_Sobolev(p, K_max = 1000, thre = 0.001, type, Rothman_t = 1/3,
  Pycke_q = 0.5, Riesz_s = 1, Poisson_rho = 0.5, Softmax_kappa = 1,
  Stereo_a = 0, Sobolev_vk2 = c(0, 0, 1), log = FALSE, verbose = TRUE,
  Gauss = TRUE, N = 320, tol = 1e-06, force_positive = TRUE,
  x_tail = NULL)

d_Sobolev(x, p, type, method = c("I", "SW", "HBE")[1], K_max = 1000,
  thre = 0.001, Rothman_t = 1/3, Pycke_q = 0.5, Riesz_s = 1,
  Poisson_rho = 0.5, Softmax_kappa = 1, Stereo_a = 0,
  Sobolev_vk2 = c(0, 0, 1), ncps = 0, verbose = TRUE, N = 320,
  x_tail = NULL, ...)

p_Sobolev(x, p, type, method = c("I", "SW", "HBE", "MC")[1], K_max = 1000,
  thre = 0.001, Rothman_t = 1/3, Pycke_q = 0.5, Riesz_s = 1,
  Poisson_rho = 0.5, Softmax_kappa = 1, Stereo_a = 0,
  Sobolev_vk2 = c(0, 0, 1), ncps = 0, verbose = TRUE, N = 320,
  x_tail = NULL, ...)

q_Sobolev(u, p, type, method = c("I", "SW", "HBE", "MC")[1], K_max = 1000,
  thre = 0.001, Rothman_t = 1/3, Pycke_q = 0.5, Riesz_s = 1,
  Poisson_rho = 0.5, Softmax_kappa = 1, Stereo_a = 0,
  Sobolev_vk2 = c(0, 0, 1), ncps = 0, verbose = TRUE, N = 320,
  x_tail = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer giving the dimension of the ambient space <code class="reqn">R^p</code> that
contains <code class="reqn">S^{p-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sequence of integer indexes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>compute the logarithm of <code class="reqn">d_{p,k}</code>? Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_max</code></td>
<td>
<p>integer giving the truncation of the series that compute the
asymptotic p-value of a Sobolev test. Defaults to <code>1e3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thre</code></td>
<td>
<p>error threshold for the tail probability given by the
the first terms of the truncated series of a Sobolev test. Defaults to
<code>1e-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>name of the Sobolev statistic, using the naming from
<code>avail_cir_tests</code> and <code>avail_sph_tests</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rothman_t</code></td>
<td>
<p><code class="reqn">t</code> parameter for the Rothman test, a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pycke_q</code></td>
<td>
<p><code class="reqn">q</code> parameter for the Pycke "<code class="reqn">q</code>-test", a real in
<code class="reqn">(0, 1)</code>. Defaults to <code>1 / 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Riesz_s</code></td>
<td>
<p><code class="reqn">s</code> parameter for the <code class="reqn">s</code>-Riesz test, a real in
<code class="reqn">(0, 2)</code>. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Poisson_rho</code></td>
<td>
<p><code class="reqn">\rho</code> parameter for the Poisson test, a real in
<code class="reqn">[0, 1)</code>. Defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Softmax_kappa</code></td>
<td>
<p><code class="reqn">\kappa</code> parameter for the Softmax test, a
non-negative real. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Stereo_a</code></td>
<td>
<p><code class="reqn">a</code> parameter for the Stereo test, a real in
<code class="reqn">[-1, 1]</code>. Defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sobolev_vk2</code></td>
<td>
<p>weights for the finite Sobolev test. A non-negative
vector or matrix. Defaults to <code>c(0, 0, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>output information about the truncation? Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gauss</code></td>
<td>
<p>use a Gauss–Legendre quadrature rule of <code>N</code> nodes
in the computation of the Gegenbauer coefficients? Otherwise, call
<code>integrate</code>. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of points used in the 
Gauss–Legendre quadrature for computing the Gegenbauer coefficients.
Defaults to <code>320</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance passed to <code>integrate</code>'s <code>rel.tol</code> and
<code>abs.tol</code> if <code>Gauss = FALSE</code>. Defaults to <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_positive</code></td>
<td>
<p>set negative weights to zero? Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_tail</code></td>
<td>
<p>scalar evaluation point for determining the upper tail
probability. If <code>NULL</code>, set to the <code>0.90</code> quantile of the whole
series, computed by the <code>"HBE"</code> approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for approximating the density, distribution, or
quantile function of the weighted sum of chi squared random variables. Must
be <code>"I"</code> (Imhof), <code>"SW"</code> (Satterthwaite–Welch), <code>"HBE"</code>
(Hall–Buckley–Eagleson), or <code>"MC"</code> (Monte Carlo; only for distribution
or quantile functions). Defaults to <code>"I"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncps</code></td>
<td>
<p>non-centrality parameters. Either <code>0</code> (default) or a
vector with the same length as <code>weights</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to <code>*_wschisq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The truncation of <code class="reqn">\sum_{k = 1}^\infty v_k^2 \chi^2_{d_{p, k}}</code> is
done to the first <code>K_max</code> terms and then up to the index such that
the first terms explain the tail probability at the <code>x_tail</code> with
an absolute error smaller than <code>thre</code> (see details in
<code>cutoff_wschisq</code>). This automatic truncation takes place when
calling <code>*_Sobolev</code>. Setting <code>thre = 0</code> truncates to <code>K_max</code>
terms exactly. If the series only contains odd or even non-zero terms, then
only <code>K_max / 2</code> addends are <em>effectively</em> taken into account
in the first truncation.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>d_p_k</code>: a vector of size <code>length(k)</code> with the
evaluation of <code class="reqn">d_{p,k}</code>.
</p>
</li>
<li> <p><code>weights_dfs_Sobolev</code>: a list with entries <code>weights</code> and
<code>dfs</code>, automatically truncated according to <code>K_max</code> and
<code>thre</code> (see details).
</p>
</li>
<li> <p><code>d_Sobolev</code>: density function evaluated at <code>x</code>, a vector.
</p>
</li>
<li> <p><code>p_Sobolev</code>: distribution function evaluated at <code>x</code>,
a vector.
</p>
</li>
<li> <p><code>q_Sobolev</code>: quantile function evaluated at <code>u</code>, a vector.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Eduardo García-Portugués and Paula Navarro-Esteban.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Circular-specific statistics
curve(p_Sobolev(x = x, p = 2, type = "Watson", method = "HBE"),
      n = 2e2, ylab = "Distribution", main = "Watson")
curve(p_Sobolev(x = x, p = 2, type = "Rothman", method = "HBE"),
      n = 2e2, ylab = "Distribution", main = "Rothman")
curve(p_Sobolev(x = x, p = 2, type = "Pycke_q", method = "HBE"), to = 10,
      n = 2e2, ylab = "Distribution", main = "Pycke_q")
curve(p_Sobolev(x = x, p = 2, type = "Hermans_Rasson", method = "HBE"),
      to = 10, n = 2e2, ylab = "Distribution", main = "Hermans_Rasson")

# Statistics for arbitrary dimensions
test_statistic &lt;- function(type, to = 1, pmax = 5, M = 1e3, ...) {

  col &lt;- viridisLite::viridis(pmax - 1)
  curve(p_Sobolev(x = x, p = 2, type = type, method = "MC", M = M,
                  ...), to = to, n = 2e2, col = col[pmax - 1],
                  ylab = "Distribution", main = type, ylim = c(0, 1))
  for (p in 3:pmax) {
    curve(p_Sobolev(x = x, p = p, type = type, method = "MC", M = M,
                    ...), add = TRUE, n = 2e2, col = col[pmax - p + 1])
  }
  legend("bottomright", legend = paste("p =", 2:pmax), col = rev(col),
         lwd = 2)

}

# Ajne
test_statistic(type = "Ajne")

# Gine_Gn
test_statistic(type = "Gine_Gn", to = 1.5)

# Gine_Fn
test_statistic(type = "Gine_Fn", to = 2)

# Bakshaev
test_statistic(type = "Bakshaev", to = 3)

# Riesz
test_statistic(type = "Riesz", Riesz_s = 0.5, to = 3)

# PCvM
test_statistic(type = "PCvM", to = 0.6)

# PAD
test_statistic(type = "PAD", to = 3)

# PRt
test_statistic(type = "PRt", Rothman_t = 0.5)

# Quantiles
p &lt;- c(2, 3, 4, 11)
t(sapply(p, function(p) q_Sobolev(u = c(0.10, 0.05, 0.01), p = p,
                                  type = "PCvM")))
t(sapply(p, function(p) q_Sobolev(u = c(0.10, 0.05, 0.01), p = p,
                                  type = "PAD")))
t(sapply(p, function(p) q_Sobolev(u = c(0.10, 0.05, 0.01), p = p,
                                  type = "PRt")))

# Series truncation for thre = 1e-5
sapply(p, function(p) length(weights_dfs_Sobolev(p = p, type = "PCvM")$dfs))
sapply(p, function(p) length(weights_dfs_Sobolev(p = p, type = "PRt")$dfs))
sapply(p, function(p) length(weights_dfs_Sobolev(p = p, type = "PAD")$dfs))

</code></pre>


</div>