<div class="container">

<table style="width: 100%;"><tr>
<td>A1_calcSol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Apparent movement of the Sun from the Earth
</h2>

<h3>Description</h3>

<p>Compute the apparent movement of the Sun from the Earth with the
functions <code>fSolD</code> and <code>fSolI</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcSol(lat, BTd, sample = 'hour', BTi,
        EoT = TRUE, keep.night = TRUE,
        method = 'michalsky')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Latitude (degrees) of the point of the Earth where
calculations are needed. 
It is positive for locations above the Equator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BTd</code></td>
<td>
<p>Daily time base, a <code>POSIXct</code> object which  may be
the result of <code>fBTd</code>. It is not considered if <code>BTi</code>
is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>Increment of the intradaily sequence. It is a character
string, containing one of ‘"sec"’, ‘"min"’, ‘"hour"’.
This can optionally be preceded by a (positive or
negative) integer and a space, or followed by ‘"s"’. It is
used by <code>seq.POSIXt</code>.
</p>
<p>It is not considered if <code>BTi</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BTi</code></td>
<td>
<p>Intradaily time base, a <code>POSIXct</code> object to be used by
<code>fSolI</code>. It may be the result of <code>fBTi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EoT</code></td>
<td>
<p>logical, if <code>TRUE</code> the Equation of Time is
used. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.night</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) the night is
included in the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>character</code>, method for the sun geometry
calculations to be chosen from 'cooper', 'spencer', 'michalsky' and
'strous'. See references for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>Sol-class</code> object.</p>


<h3>Author(s)</h3>

<p>Oscar Perpiñán Lamigueiro,
Francisco Delgado López.</p>


<h3>References</h3>

 <ul>
<li>
<p>Cooper, P.I., Solar Energy, 12, 3
(1969). "The Absorption of Solar Radiation in Solar Stills"
</p>
</li>
<li>
<p>Spencer, Search 2 (5), 172,
<a href="https://www.mail-archive.com/sundial@uni-koeln.de/msg01050.html">https://www.mail-archive.com/sundial@uni-koeln.de/msg01050.html</a>
</p>
</li>
<li>
<p>Strous:
<a href="https://www.aa.quae.nl/en/reken/zonpositie.html">https://www.aa.quae.nl/en/reken/zonpositie.html</a>
</p>
</li>
<li>
<p>Michalsky, J., 1988: The Astronomical Almanac's algorithm for
approximate solar position (1950-2050), Solar Energy 40, 227-235
</p>
</li>
<li>
<p> Perpiñán, O, Energía Solar Fotovoltaica, 2015.
(<a href="https://oscarperpinan.github.io/esf/">https://oscarperpinan.github.io/esf/</a>)
</p>
</li>
<li>
<p> Perpiñán, O. (2012), "solaR: Solar Radiation and Photovoltaic
Systems with R", Journal of Statistical Software, 50(9), 1-32,
<a href="https://doi.org/10.18637/jss.v050.i09">doi:10.18637/jss.v050.i09</a> </p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">BTd = fBTd(mode = 'serie')

lat = 37.2
sol = calcSol(lat, BTd[100])
print(as.data.tableD(sol))

library(lattice)
xyplot(as.data.tableI(sol))

solStrous = calcSol(lat, BTd[100], method = 'strous')
print(as.data.tableD(solStrous))

solSpencer = calcSol(lat, BTd[100], method = 'spencer')
print(as.data.tableD(solSpencer))

solCooper = calcSol(lat, BTd[100], method = 'cooper')
print(as.data.tableD(solCooper))
</code></pre>


</div>