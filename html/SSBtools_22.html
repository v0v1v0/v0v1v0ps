<div class="container">

<table style="width: 100%;"><tr>
<td>DummyHierarchy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converting hierarchy specifications to a (signed) dummy matrix</h2>

<h3>Description</h3>

<p>A matrix for mapping input codes (columns) to output codes (rows) are created.
The elements of the matrix specify how columns contribute to rows.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DummyHierarchy(
  mapsFrom,
  mapsTo,
  sign,
  level,
  mapsInput = NULL,
  inputInOutput = FALSE,
  keepCodes = mapsFrom[integer(0)],
  unionComplement = FALSE,
  reOrder = FALSE
)

DummyHierarchies(
  hierarchies,
  data = NULL,
  inputInOutput = FALSE,
  unionComplement = FALSE,
  reOrder = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapsFrom</code></td>
<td>
<p>Character vector from hierarchy table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapsTo</code></td>
<td>
<p>Character vector from hierarchy table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign</code></td>
<td>
<p>Numeric vector of either 1 or -1 from hierarchy table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Numeric vector from hierarchy table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapsInput</code></td>
<td>
<p>All codes in mapsFrom not in mapsTo (created automatically when NULL) and possibly other codes in input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputInOutput</code></td>
<td>
<p>When FALSE all output rows represent codes in mapsTo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepCodes</code></td>
<td>
<p>To prevent some codes to be removed when inputInOutput = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unionComplement</code></td>
<td>
<p>When TRUE, sign means union and complement instead of addition or subtraction (see note)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reOrder</code></td>
<td>
<p>When TRUE (FALSE is default) output codes are ordered differently, more similar to a usual model matrix ordering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierarchies</code></td>
<td>
<p>List of hierarchies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>DummyHierarchies</code> is a user-friendly wrapper for the original function <code>DummyHierarchy</code>.
Then, the logical input parameters are vectors (possibly recycled).
<code>mapsInput</code> and <code>keepCodes</code> can be supplied as attributes.
<code>mapsInput</code> will be generated when <code>data</code> is non-NULL.
</p>


<h3>Value</h3>

<p>A sparse matrix with row and column and names
</p>


<h3>Note</h3>

<p>With unionComplement = FALSE (default), the sign of each mapping specifies the contribution as addition or subtraction.
Thus, values above one and negative values in output can occur.
With unionComplement = TRUE,  positive is treated as union and negative as complement. Then 0 and 1 are the only possible elements in the output matrix.
</p>


<h3>Author(s)</h3>

<p>Ã˜yvind Langsrud
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A hierarchy table
h &lt;- SSBtoolsData("FIFA2018ABCD")

DummyHierarchy(h$mapsFrom, h$mapsTo, h$sign, h$level)
DummyHierarchy(h$mapsFrom, h$mapsTo, h$sign, h$level, inputInOutput = TRUE)
DummyHierarchy(h$mapsFrom, h$mapsTo, h$sign, h$level, keepCodes = c("Portugal", "Spain"))

# Extend the hierarchy table to illustrate the effect of unionComplement
h2 &lt;- rbind(data.frame(mapsFrom = c("EU", "Schengen"), mapsTo = "EUandSchengen", 
                       sign = 1, level = 3), h)

DummyHierarchy(h2$mapsFrom, h2$mapsTo, h2$sign, h2$level)
DummyHierarchy(h2$mapsFrom, h2$mapsTo, h2$sign, h2$level, unionComplement = TRUE)

# Extend mapsInput - leading to zero columns.
DummyHierarchy(h$mapsFrom, h$mapsTo, h$sign, h$level,
               mapsInput = c(h$mapsFrom[!(h$mapsFrom %in% h$mapsTo)], "Norway", "Finland"))

# DummyHierarchies
DummyHierarchies(FindHierarchies(SSBtoolsData("sprt_emp_withEU")[, c("geo", "eu", "age")]), 
                 inputInOutput = c(FALSE, TRUE))
</code></pre>


</div>