<div class="container">

<table style="width: 100%;"><tr>
<td>vcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>vcov</code> Method for Class <code>fit_wrc_hcc</code>
</h2>

<h3>Description</h3>

<p>This page documents the method <code>vcov</code> for the class
<code>fit_wrc_hcc</code> and its <code>coef</code> method.  <code>vcov</code> extracts the
covariance matrices of the nonlinear parameters
<code class="reqn">\widehat{\boldsymbol{\nu}}</code> estimated by
maximum likelihood or maximum posterior density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'fit_wrc_hcc'
vcov(object, subset = NULL, grad_eps,
    bound_eps = sqrt(.Machine$double.eps), ...)

## S3 method for class 'vcov_fit_wrc_hcc'
coef(object, se = TRUE, correlation = se,
    status = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>either an object of class <code>fit_wrc_hcc</code> for
<code>vcov</code> or an object of class <code>vcov_fit_wrc_hcc</code> for
<code>coef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an integer, character or logical vector to the choose the
soil samples for which covariance matrices should be extracted.
Defaults to <code>NULL</code>, which extracts the covariances for all soil samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad_eps</code></td>
<td>
<p>a numeric scalar defining a critical magnitude of the
moduli of scaled gradient components so that they are considered to be
approximately equal to zero, see <em>Details</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound_eps</code></td>
<td>
<p>a numeric scalar defining the critical difference
between parameter estimates and the boundaries of the parameter space so
that the estimates are considered to be identical to the boundary values,
see <em>Details</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a logical scalar to control whether standard errors of the
estimated nonlinear parameters
<code class="reqn">\widehat{\boldsymbol{\nu}}</code> should be
returned (<code>TRUE</code>, default) or variances (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a logical scalar to control whether correlations
(<code>TRUE</code>, default) or covariances (<code>FALSE</code>) of the esitmated
nonlinear parameters
<code class="reqn">\widehat{\boldsymbol{\nu}}</code> should be
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>a logical scalar to control whether diagnostics should be
returned along with the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to methods, currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>vcov</code> extracts (co-)variances of the nonlinear
parameters from the inverse Hessian matrix of the objective function at
the solution <code class="reqn">\widehat{\boldsymbol{\nu}}</code> for
mpd and ml estimates, see <code>soilhypfitIntro</code> and <cite>Stewart
and Sørensen (1981)</cite>.
</p>
<p><code>vcov</code> checks whether the gradient at the solution is approximately
equal to zero and issues a warning if this is not the case.  This is
controlled by the argument <code>grad_eps</code> which is the tolerable largest
modulus of the scaled gradient (= gradient divided by the absolute value
of objective function) at the solution.  The function
<code>control_fit_wrc_hcc</code> selects a default value for
<code>grad_eps</code> in the dependence of the chosen optimisation approach
(argument <code>settings</code> of <code>control_fit_wrc_hcc</code>).
</p>
<p><code>vcov</code> sets covariances equal to <code>NA</code> if the parameter
estimates differ less than <code>bound_eps</code> from the boundaries of the
parameter space as defined by <code>param_boundf</code>.
</p>


<h3>Value</h3>

<p>The method <code>vcov</code> returns an object of of class
<code>vcov_fit_wrc_hcc</code>, which is a list of covariance matrices of the
estimated nonlinear parameters for the soil samples.  The attribute
<code>status</code> of the matrices qualifies the covariances.
</p>
<p>The <code>coef</code> method for class <code>vcov_fit_wrc_hcc</code> extracts the
entries of the covariances matrices, optionally computes standard errors
and correlation coefficients and returns the results in a dataframe.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Stewart, W.E. and Sørensen, J.P. (1981)
Bayesian estimation of common
parameters from multiresponse data with missing observations.
<em>Technometrics</em>, <b>23</b>, 131–141, <br><a href="https://doi.org/10.1080/00401706.1981.10486255">doi:10.1080/00401706.1981.10486255</a>.
</p>


<h3>See Also</h3>

<p><code>soilhypfitIntro</code> for a description of the models and a brief
summary of the parameter estimation approach;
</p>
<p><code>fit_wrc_hcc</code> for (constrained) estimation of parameters of
models for soil water retention and hydraulic conductivity data;
</p>
<p><code>control_fit_wrc_hcc</code> for options to control
<code>fit_wrc_hcc</code>;
</p>
<p><code>soilhypfitmethods</code> for common S3 methods for class
<code>fit_wrc_hcc</code>;
</p>


<p><code>prfloglik_sample</code> for profile loglikelihood
computations;
</p>
<p><code>wc_model</code> and <code>hc_model</code> for currently
implemented models for soil water retention curves and hydraulic
conductivity functions;
</p>
<p><code>evaporative-length</code> for physically constraining parameter
estimates of soil hydraulic material functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# use of \donttest{} because execution time exceeds 5 seconds

data(sim_wrc_hcc)

# define number of cores for parallel computations
if(interactive()) ncpu &lt;- parallel::detectCores() - 1L else ncpu &lt;- 1L

# estimate parameters for 3 samples by unconstrained, global optimisation
# algorithm NLOPT_GN_MLSL
# sample 1: use only conductivity data
# sample 2: use only water content data
# sample 3: use both types of data
rfit_uglob &lt;- fit_wrc_hcc(
  wrc_formula = wc ~ head | id,
  hcc_formula = hc ~ head | id,
  wrc_subset = id != 1,
  hcc_subset = id != 2,
  data = sim_wrc_hcc,
  control = control_fit_wrc_hcc(pcmp = control_pcmp(ncores = ncpu)))
print(rfit_uglob)
summary(rfit_uglob)
coef(rfit_uglob, what = "nonlinear")
coef(rfit_uglob, what = "linear", gof = TRUE)
coef(vcov(rfit_uglob), status = TRUE, se = FALSE)
op &lt;- par(mfrow = c(3, 2))
plot(rfit_uglob)
on.exit(par(op))

</code></pre>


</div>