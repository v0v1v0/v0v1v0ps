<div class="container">

<table style="width: 100%;"><tr>
<td>npdeSaemix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an npdeObject from an saemixObject</h2>

<h3>Description</h3>

<p>This function uses the npde library to compute normalised prediction distribution errors (npde)
and normalised prediction discrepancies  (npd). The simulations can also be used to plot VPCs.
As of version 3.0, the plot functions for diagnostics involving VPC, npde or npd are deprecated and
the user will be redirected to the current proposed method (creating an NpdeObject and using the
plot functions from the library npde).
</p>


<h3>Usage</h3>

<pre><code class="language-R">npdeSaemix(saemixObject, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>saemixObject</code></td>
<td>
<p>a fitted object resulting from a call to saemix()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulations used to compute npde (1000 by default, we suggest increasing
it for large datasets)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since version 3.0, the saemix package depends on the npde package, which computes the npd/npde and
produces graphs. See the documentation for <code>npde</code> for details on the computation methods
See the PDF documentation and the bookdown <a href="https://iame-researchcenter.github.io/npde_bookdown/">https://iame-researchcenter.github.io/npde_bookdown/</a>
for details on the different plots available.
</p>


<h3>Value</h3>

<p>An object of class <code>NpdeObject</code>
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@bichat.inserm.fr">emmanuelle.comets@bichat.inserm.fr</a>
</p>


<h3>References</h3>

<p>E Comets, K Brendel, F Mentre (2008). Computing normalised prediction distribution errors
to evaluate nonlinear mixed-effect models: the npde add-on package for R.
Computer Methods and Programs in Biomedicine, 90:154-66.
</p>
<p>K Brendel, E Comets, C Laffont, C Laveille, F Mentre (2006). Metrics for external model evaluation
with an application to the population pharmacokinetics of gliclazide. Pharmaceutical Research,
23:2036â€“49
</p>
<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.1.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.1.pdf</a>
</p>


<h3>See Also</h3>

<p><code>npde.graphs</code>, <code>gof.test</code>
</p>
<p><code>NpdeObject</code> <code>npde.plot.select</code>  <code>autonpde</code>
</p>
<p><code>npde.plot.scatterplot</code> <code>npde.plot.dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA, 
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

saemix.options&lt;-list(algorithm=c(1,0,0),seed=632545,save=FALSE,save.graphs=FALSE, 
displayProgress=FALSE)
# Not run
# Works interactively but not in the contained environment of CRAN (it looks for a datafile 
# instesad of finding the dataset in the environment)
# saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)
# npde.obj&lt;-npdeSaemix(saemix.fit)
# plot(npde.obj)
# plot(npde.obj, plot.type="vpc")
# plot(npde.obj, plot.type="covariates")
# plot(npde.obj, plot.type="cov.x.scatter")
# plot(npde.obj, plot.type="cov.ecdf")

</code></pre>


</div>