<div class="container">

<table style="width: 100%;"><tr>
<td>Awsreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial clusterwise regression by an iterated spatially weighted regression algorithm</h2>

<h3>Description</h3>

<p>This function implements a spatial clusterwise regression based on the procedure suggested by Andreano <em>et al.</em> (2017) and Bille' <em>et al.</em> (2017).</p>


<h3>Usage</h3>

<pre><code class="language-R">Awsreg(data, coly,colx,kernel,kernel2,coords,bw,tau,niter,conv,eta,numout,sout)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coly</code></td>
<td>
<p>The dependent variable in the c("y_ols") form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colx</code></td>
<td>
<p>The covariates in the c("x1","x2") form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>Kernel function used to calculate distances between units (default is "bisquare", other values: "exponential", "gaussian","tricube").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel2</code></td>
<td>
<p>Kernel function used to calculate distances between units in the second step (default is "gaussian", other values: "exponential").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>The coordinates in terms of longitude and latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>The bandwidth parameter of the initial weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The confidence test parameter of the difference between regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>The smallest accepted difference between the weights in two successive iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The parameter that regulates which is the weight of the weights of the previous iteration in the moving average that updates the new weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numout</code></td>
<td>
<p>The minimum number of areal units accepted for each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sout</code></td>
<td>
<p>Minimum value of weights such as to be considered equal to zero. Parameter used essentially to control clusters consisting of too few areal units.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Author really thanks Bille' A.G. for her contribution to revising the original code.</p>


<h3>Value</h3>

<p>A object of Awsreg class with:
</p>
<table><tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Estimated clusters.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>R. Benedetti</p>


<h3>References</h3>

<p>Andreano, M.S., Benedetti, R., and Postiglione, P. (2017). "<em>Spatial regimes in regional European growth: an iterated spatially weighted regression approach</em>", Quality &amp; Quantity. 51, 6, 2665-2684.
</p>
<p>Bille', A.G., Benedetti, R., and Postiglione, P. (2017). "<em>A two-step approach to account for unobserved spatial heterogeneity</em>", Spatial Economic Analysis, 12, 4, 452-471. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SimData)
SimData = SimData[1:50,]
coords = cbind(SimData$long, SimData$lat)

#######################

dmat&lt;-gw.dist(coords,focus=0,p=2,theta=0,longlat=FALSE)
bw&lt;-bw.gwr(y_ols~A+L+K,
           data=SpatialPointsDataFrame(coords,SimData),
           approach="AIC",kernel="bisquare",
           adaptive=TRUE,p=2,theta=0,longlat=FALSE,dMat=dmat)

#######################

aws&lt;-Awsreg(data=SimData,
           coly=c("y_ols"),
           colx=c("A","L","K"),
           kernel="bisquare",
           kernel2="gaussian",
           coords=coords,
           bw=bw,
           tau=0.001,
           niter=200,
           conv=0.001,
           eta=0.5,
           numout=15,
           sout=1e-05)

SimData$regimes = aws$groups
plot(lat~long,SimData,col=regimes,pch=16)
</code></pre>


</div>