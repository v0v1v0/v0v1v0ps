<div class="container">

<table style="width: 100%;"><tr>
<td>BimixedCbCContCont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fits a bivariate mixed-effects model using the cluster-by-cluster (CbC) estimator to assess surrogacy in the meta-analytic multiple-trial setting  (Continuous-continuous case)</h2>

<h3>Description</h3>

<p>The function <code>BimixedCbCContCont</code> uses the cluster-by-cluster (CbC) estimator of the bivariate mixed-effects to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. See the <b>Details</b> section below.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">BimixedCbCContCont(Dataset, Surr, True, Treat, Trial.ID,Min.Treat.Size=2,Alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, and a trial ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Min.Treat.Size</code></td>
<td>
<p>The minimum number of patients in each group (control or experimental) that a trial should contain to be included in the analysis. If the number of patients in a group of a trial is smaller than the value specified by <code>Min.Treat.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>BimixedContCont</code> fits a bivariate mixed-effects model using the CbC estimator (for details, see Florez et al., 2019) to assess surrogacy (for details, see Buyse et al., 2000). In particular, the following mixed-effects model is fitted: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects for S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random treatment effects, respectively. 
</p>
<p>The vector of the random effects (i.e., <code class="reqn">m_{Si}</code>, <code class="reqn">m_{Ti}</code>, <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code>) is assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{D}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bold{D}=\left(\begin{array}{cccc}
d_{SS}\\
d_{ST} &amp; d_{TT}\\
d_{Sa} &amp; d_{Ta} &amp; d_{aa}\\
d_{Sb} &amp; d_{Tb} &amp; d_{ab} &amp; d_{bb}
\end{array}\right).</code>
</p>

<p>The trial-level coefficient of determination (i.e., <code class="reqn">R^2_{trial}</code>) is quantified as:
</p>
<p style="text-align: center;"><code class="reqn">R_{trial}^{2}=\frac{\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)^{'}\left(\begin{array}{cc}
d_{SS} &amp; d_{Sa}\\
d_{Sa} &amp; d_{aa}
\end{array}\right)^{-1}\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)}{d_{bb}}.</code>
</p>

<p>The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>: 
</p>
<p style="text-align: center;"><code class="reqn">\bold{\Sigma}=\left(\begin{array}{cc}\sigma_{SS}\\\sigma_{ST} &amp; \sigma_{TT}\end{array}\right).</code>
</p>
 
<p>Based on <code class="reqn">\bold{\Sigma}</code>, individual-level surrogacy is quantified as: 
</p>
<p style="text-align: center;"><code class="reqn">R_{indiv}^{2}=\frac{\sigma_{ST}^{2}}{\sigma_{SS}\sigma_{TT}}.</code>
</p>
 
<p><b><em>Note</em></b>
The CbC estimator for the full bivariate mixed-effects model is closed-form (for details, see Florez et al., 2019). Therefore, it is fast. Furthermore, it is recommended when computational issues occur with the full maximum likelihood estimator (implemented in function <code>BimixedContCont</code>). 
</p>
<p>The CbC estimator is performed in two stages: (1) a linear model is fitted in each trial. Evidently, it is require that the design matrix (<code class="reqn">X_i</code>) is full column rank within each trial, allowing estimation of the fixed effects. When <code class="reqn">X_i</code> is not full rank, trial i is excluded from the analysis. (2) a global estimator of the fixed effects (<code class="reqn">\beta</code>) is obtained by weighted averaging the sets of estimates of each trial, and <code class="reqn">\bold{D}</code> is estimated using a method-of-moments estimator. Optimal weights (for details, see Molenberghs et al., 2018) are used as a weighting scheme. 
</p>
<p>The estimator of <code class="reqn">\bold{D}</code> might lead to a non-positive-definite solution. Therefore, the eigenvalue method (for details, see Rousseeuw and Molenberghs, 1993) is used for non-positive-definiteness adjustment. 
</p>


<h3>Value</h3>

<p>An object of class <code>BimixedContCont</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (after excluding clusters). Clusters are excluded for two reasons: (i) the number of patients is smaller than the value especified by <code>Min.Trial.Size</code>, and (ii) the design matrix (<code class="reqn">X_i</code>) is not full rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.removed</code></td>
<td>
<p>Number of trials excluded from the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fixed.Effects</code></td>
<td>
<p>A <code>data.frame</code> that contains the fixed intercept and treatment effects for the true and the surrogate endpoints (i.e., <code class="reqn">\mu_{S}</code>, <code class="reqn">\mu_{T}</code>, <code class="reqn">\alpha</code>, and <code class="reqn">\beta</code>) and their corresponding standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The variance-covariance matrix of the random effects (the <code class="reqn">\bold{D}</code> matrix), i.e., a <code class="reqn">4</code> by <code class="reqn">4</code> variance-covariance matrix of the random intercept and treatment effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DH.pd</code></td>
<td>
 <p><code>DH.pd=TRUE</code> if an adjustment for non-positive definiteness was not needed to estimate <code class="reqn">\bold{D}</code>. <code>DH.pd=FALSE</code> if this adjustment was required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>The <code class="reqn">2</code> by <code class="reqn">2</code> variance-covariance matrix of the residuals (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alvaro J. Florez, Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Florez, A. J., Molenberghs G, Verbeke G, Alonso, A. (2019). A closed-form estimator for meta-analysis
and surrogate markers evaluation. <em>Journal of Biopharmaceutical Statistics, 29(2)</em> 318-332.
</p>
<p>Molenberghs, G., Hermans, L., Nassiri, V., Kenward, M., Van der Elst, W., Aerts, M. and Verbeke, G. (2018). Clusters with random size: maximum likelihood versus weighted estimation. <em>Statistica Sinica,
28</em>, 1107-1132.
</p>
<p>Rousseeuw, P. J. and Molenberghs, G. (1993) Transformation of non positive semidefinite correlation
matrices. <em>Communications in Statistics, Theory and Methods, 22</em>, 965-984.
</p>


<h3>See Also</h3>

<p><code>BimixedContCont</code>, <code>UnifixedContCont</code>, <code>BifixedContCont</code>, 
<code>UnimixedContCont</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Open the Schizo dataset (clinial trial in schizophrenic patients)
data(Schizo)

# Fit a full bivariate random-effects model by the cluster-by-cluster (CbC) estimator
# a minimum of 2 subjects per group are allowed in each trial
  fit &lt;- BimixedCbCContCont(Dataset=Schizo, Surr=BPRS, True=PANSS, Treat=Treat,Trial.ID=InvestId,
                              Alpha=0.05, Min.Treat.Size = 10)
# Note that an adjustment for non-positive definiteness was requiered and 113 trials were removed.

# Obtain a summary of the results
summary(fit)
                         
</code></pre>


</div>