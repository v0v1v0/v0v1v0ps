<div class="container">

<table style="width: 100%;"><tr>
<td>sfaendog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic frontier analysis with technical inefficiency effects <br>
and endogeneity of one input</h2>

<h3>Description</h3>

<p>It implements a Method of Moments (MM) estimation of stochastic production 
frontier with explanatory variables influencing technical inefficiency (<em>i.e.</em> the 
technical inefficiency effects) and accounting for one single endogenous input.</p>


<h3>Usage</h3>

<pre><code class="language-R">sfaendog(y, x.exo, x.endo, c.var, ineff, inst, data, nls.algo = c("GN", "LM"), 
      gmm.kernel = c("Bartlett", "Quadratic Spectral", "Truncated", "Parzen", 
      "Tukey-Hanning"), gmm.optim = c("BFGS", "Nelder-Mead", "CG", "SANN"), 
      maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A character string specifying the name of the dependent variable of the 
production function (output). Values of the <code>y</code> variable will be internally 
coerced to their <em>logged</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.exo</code></td>
<td>
<p>A vector of strings containing the names of the exogenous inputs 
of the production function. Values of the <code>x.exo</code> variables will be internally 
coerced to their <em>logged</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.endo</code></td>
<td>
<p>A character string specifying the name of the input of the 
production function considered as endogenous. Values of the the <code>x.endo</code> 
variable will be internally coerced to their <em>logged</em> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.var</code></td>
<td>
<p>A vector of strings containing the names of non-input variables 
influencing the output (production environment conditions, time trend, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ineff</code></td>
<td>
<p>A vector of strings containing the names of the variables influencing
technical inefficiency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inst</code></td>
<td>
<p>A vector of strings containing the names of the external instrumental
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables called in <code>y</code>, <code>x.exo</code>,
<code>x.endo</code>, <code>c.var</code>, <code>ineff</code> and <code>inst</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nls.algo</code></td>
<td>
<p>A character string specifying the algorithm used in the Non-linear Least 
Squares (NLS) estimation (see <code>Estimation 'recipe'</code>). The default algorithm is the Gauss-Newton 
algorithm (<code>"GN"</code>). The other possible value is <code>"LM"</code> for the Levenberg-Marquardt 
algorithm. <br>
Levenberg-Marquardt being a more robust variation of Gauss-Newton algorithm, 
specifiying <code>nls.algo = "LM"</code> may help in case of non convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmm.kernel</code></td>
<td>
<p>A character string specifying the type of kernel used to compute 
the covariance matrix of the vector of sample moment conditions in the Generalised Method of 
Moments (GMM) estimations (see <code>Estimation 'recipe'</code>). The default value is <code>"Bartlett"</code> 
kernel. Other possible options are <code>"Quadratic Spectral"</code>, <code>"Truncated"</code>, 
<code>"Parzen"</code>, or <code>"Tukey-Hanning"</code> (see <code>gmm</code> for more details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmm.optim</code></td>
<td>
<p>A character string specifying the optimisation method to be applied
in the GMM estimations (see <code>Estimation 'recipe'</code>). The default value (<code>"BFGS"</code>) 
is the quasi-Newton method. Other possibles methods are <code>"Nelder-Mead"</code>, <code>"CG"</code>, 
<code>"SANN"</code> (see <code>optim</code> for more details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>A positive integer specifying the maximum number of iterations 
allowed for the NLS and GMM estimations. The <code>default</code> value is <code>100</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>sfaendog()</code> implements the 4-step ‘recipe’ detailed 
in Latruffe <em>et al</em>. (2017, p.788).
<br><br>
The use of basic formula operators generally involved in model formulae, such as 
<code>":"</code>, <code>"*"</code>, or <code>"^"</code>, are allowed in <code>x.exo</code>, <code>x.endo</code>, 
<code>c.var</code>, <code>ineff</code> and <code>inst</code>. <br>
As in function <code>formula</code>, the function <code>I()</code> 
can also be used to inhibit the interpretation of operators such as <code>"+"</code>, 
<code>"-"</code>, <code>"*"</code> and <code>"^"</code> as formula operators, so that they are used as 
arithmetical operators.
<br></p>


<h4>- Stochastic production frontier model with a single endogenous input</h4>

<p><code>sfaendog()</code> assumes a Cobb-Douglas functional form for the production frontier.
</p>
<p>In this case, the stochastic frontier production model is written as: 
</p>
<p style="text-align: center;"><code class="reqn">
\ln\textrm{y}=\boldsymbol{\alpha'}_0\ln\textbf{x}-\eta\exp(\boldsymbol{\theta'}_0
\textbf{z})+\textrm{v}</code>
</p>

<p>where <code class="reqn">\textrm{ln}</code> is the log; <code class="reqn">\textrm{y}</code> is the observed output; 
<code class="reqn">\boldsymbol{\alpha}_0</code> and <code class="reqn">\boldsymbol{\theta}_0</code> are 
vectors of parameters to be estimated; <code class="reqn">\textbf{x}</code> is a vector containing 
the inputs as well as a constant term one; <code class="reqn">\textrm{v}</code> is a random term 
which accounts for the effects of unobserved heterogeneity across observations and 
for stochastic events affecting the production process; 
<code class="reqn">\eta\exp(\boldsymbol{\theta'}_0\textbf{z})</code> is a non-negative 
term accounting for the presence of technical inefficiency; <code class="reqn">\textbf{z}</code> 
is a vector of variables influencing technical inefficiency (the inefficiency effects), 
including a constant term one; and <code class="reqn">\eta</code> is a positive random term with mean one. 
</p>
<p>If all inputs are exogenous, the above equation can be estimated by NLS. 
<br><br><code>sfaendog()</code> accounts for the endogeneity of one input, with a MM estimator based 
on Chamberlain's (1987) ‘efficient instruments’.
In the case of endogeneity of one input, the stochastic frontier production model 
defined above can  be rewritten as: 
</p>
<p style="text-align: center;"><code class="reqn">
\ln\textrm{y}=\boldsymbol{\alpha}_{\textup{x},0}\ln\mathbf{x}_x+\alpha_{e,0}\ln{x_e}-
\eta\exp(\boldsymbol{\theta'}_0\textbf{z})+\textrm{v}</code>
</p>

<p>where <code class="reqn">\mathbf{x}_x</code> is the vector containing the exogenous inputs and the 
constant term one; <code class="reqn">x_e</code> is the endogenous input; and the subscript <code class="reqn">0</code> 
denotes the ‘true’ parameters value. The vector of exogenous variables is 
denoted by <code class="reqn">\textbf{w}=(\ln\textbf{x}_x,\textbf{q},\textbf{z})</code> 
where <code class="reqn">\textbf{q}</code> is the vector of external instrumental variables. 
</p>
<p>Assuming that <code class="reqn">E[\textrm{v}|\textbf{w}]=0</code>, and that <code class="reqn">\eta</code> and 
<code class="reqn">(\textrm{v},\textbf{w})</code> are independent, the stochastic frontier 
production model can be rewritten as: 
</p>
<p style="text-align: center;"><code class="reqn">\ln\textrm{y}=\boldsymbol{\alpha}_{\textup{x},0}\ln\mathbf{x}_x+\alpha_{e,0}\ln{x_e}-
\exp(\boldsymbol{\theta'}_0\textbf{z})+e\;\;\textrm{with}\;\;E[e|\textbf{w}]=0</code>
</p>

<p>where the error term <code class="reqn">e</code> is defined as <code class="reqn">e\equiv 
e(\boldsymbol{\delta}_0)=\ln\textrm{y}-\boldsymbol{\alpha}_{\textup{x},0}\ln\textbf{x}_x 
-\alpha_{e,0}\ln{x_e}+\exp(\boldsymbol{\theta'}_0\textbf{z})</code>
<br></p>



<h4>- Estimation 'recipe'</h4>

<p>The estimation 'recipe' detailed in Latruffe <em>et al</em>. (2017, p.788) and implemented 
through <code>sfaendog()</code> consists in the following four steps: <br></p>

<ul>
<li>
<p><strong>Step1:</strong> Ordinary Least Squares (OLS) estimation of <code class="reqn">\ln{x_e}</code> 
on a set of external instrumental variables (<code class="reqn">\textbf{q}</code>) and all exogenous 
variables included in the stochastic frontier production model. This generates the 
predicted values of <code class="reqn">\ln{x_e}</code> to be used as instruments in <code>Step3</code>. <br>
The strength of the external instrumental variables (<code class="reqn">\textbf{q}</code>) is measured by 
testing, with a Fisher test, the nullity of the parameters related to these external 
instrumental variables. <br>
This <code>Step1</code> corresponds to <em>Step 1</em> of the estimation 'recipe' presented in 
Latruffe <em>et al</em>. (2017, p.788).
<br></p>
</li>
<li>
<p><strong>Step2:</strong> NLS estimation of the stochastic frontier production model, 
to compute a <b>non consistent and non efficient</b> estimator to be used in <code>Step3</code>. <br><code>Step2</code> consists in three sub-steps (not detailed as such in 
Latruffe <em>et al</em>.'s (2017, p.788) recipe):
</p>

<ul>
<li>
<p><b><em>Step2a.i</em>:</b> OLS estimation of a production model with the output 
as the dependent variable, and the explanatory variables being the inputs and the 
non-input variables influencing the output. <br>
This provides predicted residuals to be used in <code>Step2a.ii</code>, and parameters to be 
used as starting values for the variables in the production part of the stochastic frontier 
production model in <code>Step2b</code>.
</p>
</li>
<li>
<p><b><em>Step2a.ii</em>:</b> OLS estimation of the predicted residuals of <code>Step2a.i</code> 
on the variables influencing technical inefficiency. <br>
This provides parameters to be used as starting values for the variables in the inefficiency 
effect part of the stochastic frontier production model in <code>Step2b</code>.
</p>
</li>
<li>
<p><b><em>Step2b</em>:</b> NLS estimation of the stochastic frontier production model, 
using starting values obtained from <code>Step2a.i</code> and <code>Step2a.ii</code>. <br>
This sub-step corresponds to <em>Step 2</em> of the estimation 'recipe' presented in 
Latruffe <em>et al</em>. (2017, p.788).
<br></p>
</li>
</ul>
</li>
<li>
<p><strong>Step3:</strong> Estimation of the stochastic frontier production model, using the 
predicted values of the endogenous input obtained from <code>Step1</code> and using the parameters 
obtained from <code>Step2b</code> as starting values. The estimation is done with GMM. <br><code>Step3</code> computes a <b>consistent but non efficient</b> estimator to be used in <code>Step4</code>. <br>
This <code>Step3</code> corresponds to <em>Step 3</em> of the estimation 'recipe' presented in 
Latruffe <em>et al</em>. (2017, p.788).
<br></p>
</li>
<li>
<p><strong>Step4:</strong> Estimation of the stochastic frontier production model, using the 
predicted values of the endogenous input obtained from <code>Step1</code> the parameters 
obtained from <code>Step3</code> as starting values. This estimation is done with GMM. <br><code>Step4</code> computes a <strong>consistent and efficient</strong> estimator, and returns 
the final results of the estimation of the stochastic frontier production model. <br>
This <code>Step4</code> corresponds to <em>Step 4</em> of the estimation 'recipe' presented in 
Latruffe <em>et al</em>. (2017, p.788).<br></p>
</li>
</ul>
<p>Please note that, the applicability of default options in <code>nls.algo</code>, <code>gmm.kernel</code>, and <code>gmm.optim</code> 
is highly data-dependent and the user may have to play around with different options.
</p>


<h3>Value</h3>

<p><code>sfaendog</code> returns a list of class <code style="white-space: pre;">⁠'sfaendog'⁠</code>.
</p>
<p>The object of class <code style="white-space: pre;">⁠'sfaendog'⁠</code> is a list containing at least the following 
components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Step1</code></td>
<td>
<p>Results of <code>Step1</code> (see <code>Estimation 'recipe'</code>), inheriting from 
class <code style="white-space: pre;">⁠'lm'⁠</code> for which details on components are given in <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FishTest</code></td>
<td>
<p>The list of external instrumental variables (<code>inst</code>) used in 
the specification, as well as Fisher test results showing the strength of these 
external instrumental variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Step2</code></td>
<td>
<p>Results of <code>Step2b</code> (see <code>Estimation 'recipe'</code>), inheriting from 
class <code style="white-space: pre;">⁠'nls'⁠</code> for which details on components are given in <code>nls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Step3</code></td>
<td>
<p>Results of <code>Step3</code> (see <code>Estimation 'recipe'</code>), inheriting from 
class <code style="white-space: pre;">⁠'gmm'⁠</code> for which details on components are given in <code>gmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Step4</code></td>
<td>
<p>Results of <code>Step4</code> (see <code>Estimation 'recipe'</code>), inheriting from 
class <code style="white-space: pre;">⁠'gmm'⁠</code> for which details on components are given in <code>gmm</code>.</p>
</td>
</tr>
</table>
<p>The function <code>summary</code> is used to obtain and print 
a summary of the results.
</p>


<h3>Author(s)</h3>

<p>Yann Desjeux, Laure Latruffe</p>


<h3>References</h3>

<p>Chamberlain G. (1987). Asymptotic Efficiency in Estimation with Conditional Moment
Restrictions. <em>Journal of Econometrics</em>, <b>34</b>(3), 305–334. 
<a href="https://doi.org/10.1016/0304-4076(87)90015-7">https://doi.org/10.1016/0304-4076(87)90015-7</a>
</p>
<p>Latruffe L., Bravo-Ureta B.E., Carpentier A., Desjeux Y., and Moreira V.H. (2017). 
Subsidies and Technical Efficiency in Agriculture: Evidence from European Dairy Farms. 
<em>American Journal of Agricultural Economics</em>, <b>99</b>(3), 783–799. 
<a href="https://doi.org/10.1093/ajae/aaw077">https://doi.org/10.1093/ajae/aaw077</a>
</p>


<h3>See Also</h3>

<p><code>summary</code> for creating and printing summary results.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  y &lt;- "farm_output"
  x.exo &lt;- c("agri_land", "tot_lab", "tot_asset")
  x.endo &lt;-  "costs"
  c.var &lt;- c("LFA", "T", "I(T^2)")
  ineff &lt;- c("hired_lab", "rented_land", "debt_asset", "subs", "region", "region:T")
  inst &lt;- c("milkprice", "I(milkprice^2)", "price_ind", "milkprice:region")
  
  RES &lt;- sfaendog(y, x.exo, x.endo, c.var, ineff, inst, data=Farms)
  
  summary(RES)
## End(Not run)
</code></pre>


</div>