<div class="container">

<table style="width: 100%;"><tr>
<td>KSSL_VG_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Develop a Water Retention Curve from KSSL Data</h2>

<h3>Description</h3>

<p>Water retention curve modeling via van Genuchten model and KSSL data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KSSL_VG_model(VG_params, phi_min = 10^-6, phi_max = 10^8, pts = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VG_params</code></td>
<td>
<p><code>data.frame</code> or <code>list</code> object with the parameters of the van Genuchten model, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_min</code></td>
<td>
<p>lower limit for water potential in kPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_max</code></td>
<td>
<p>upper limit for water potential in kPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>number of points to include in estimated water retention curve</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function was developed to work with measured or estimated parameters of the <a href="https://en.wikipedia.org/wiki/Water_retention_curve">van Genuchten model</a>, as generated by the <a href="https://www.ars.usda.gov/pacific-west-area/riverside-ca/agricultural-water-efficiency-and-salinity-research-unit/docs/model/rosetta-model/">Rosetta model</a>. As such, <code>VG_params</code> should have the following format and conventions:
</p>

<dl>
<dt>theta_r</dt>
<dd>
<p>saturated water content, values should be in the range of {0, 1}</p>
</dd>
<dt>theta_s</dt>
<dd>
<p>residual water content, values should be in the range of {0, 1}</p>
</dd>
<dt>alpha</dt>
<dd>
<p>related to the inverse of the air entry suction, function expects log10-transformed values with units of 1/cm</p>
</dd>
<dt>npar</dt>
<dd>
<p>index of pore size distribution, function expects log10-transformed values (dimensionless)</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>VG_curve</dt>
<dd>
<p>estimated water retention curve: paired estimates of water potential (phi) and water content (theta)</p>
</dd>
<dt>VG_function</dt>
<dd>
<p>spline function for converting water potential (phi, units of kPa) to estimated volumetric water content (theta, units of percent, range: {0, 1})</p>
</dd>
<dt>VG_inverse_function</dt>
<dd>
<p>spline function for converting volumetric water content (theta, units of percent, range: {0, 1}) to estimated water potential (phi, units of kPa)</p>
</dd>
</dl>
<h3>Note</h3>

<p>A practical example is given in the <a href="http://ncss-tech.github.io/AQP/soilDB/fetchSCAN-demo.html">fetchSCAN tutorial</a>.
</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Water_retention_curve">water retention curve estimation</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# basic example
d &lt;- data.frame(
  theta_r = 0.0337216, 
  theta_s = 0.4864061, 
  alpha = -1.581517, 
  npar = 0.1227247
)

vg &lt;- KSSL_VG_model(d)

str(vg)

</code></pre>


</div>