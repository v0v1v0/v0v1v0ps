<div class="container">

<table style="width: 100%;"><tr>
<td>get_theta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Scale Parameter for (Scale Dependent) Hyperprior</h2>

<h3>Description</h3>

<p>This function implements a optimisation routine that computes the scale parameter <code class="reqn">\theta</code>
of the scale dependent hyperprior for a given design matrix and prior precision matrix
such that approximately <code class="reqn">P(|f(x_{k}|\le c,k=1,\ldots,p)\ge 1-\alpha</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_theta(alpha = 0.01, method = "integrate", Z, c = 3,
  eps = .Machine$double.eps, Kinv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>denotes the 1-<code class="reqn">\alpha</code> level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either <code>integrate</code> or <code>trapezoid</code> with <code>integrate</code> as default.
<code>trapezoid</code> is a self-implemented version of the trapezoid rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>denotes the expected range of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>denotes the error tolerance of the result, default is <code>.Machine$double.eps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kinv</code></td>
<td>
<p>the generalised inverse of K.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>list</code> with values from <code>uniroot</code>.
</p>


<h3>Author(s)</h3>

<p>Nadja Klein
</p>


<h3>References</h3>

<p>Nadja Klein and Thomas Kneib (2015). Scale-Dependent Priors for Variance Parameters in Structured Additive Distributional Regression. 
<em>Working Paper</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

set.seed(91179)
library(BayesX)
library(MASS)
# prior precision matrix to zambia data set
K &lt;- read.gra(system.file("examples/zambia.gra", package="sdPrior"))
# generalised inverse of K
Kinv &lt;- ginv(K)

# read data
dat &lt;- read.table(system.file("examples/zambia_height92.raw", package="sdPrior"), header = TRUE)

# design matrix for spatial component
Z &lt;- t(sapply(dat$district, FUN=function(x){1*(x==rownames(K))}))

# get scale parameter
theta &lt;- get_theta(alpha = 0.01, method = "integrate", Z = Z, 
                            c = 3, eps = .Machine$double.eps, Kinv = Kinv)$root

## End(Not run) 

</code></pre>


</div>