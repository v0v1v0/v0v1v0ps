<div class="container">

<table style="width: 100%;"><tr>
<td>unif_cap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Uniform spherical cap distribution</h2>

<h3>Description</h3>

<p>Density, simulation, and associated functions for a uniform
distribution within a spherical cap of angle <code class="reqn">0\leq \alpha\leq \pi</code> about
a direction <code class="reqn">\boldsymbol{\mu}</code> on <code class="reqn">S^{p-1}:=\{\mathbf{x} \in
R^p:||\mathbf{x}||=1\}</code>, <code class="reqn">p \geq 2</code>. The
density at <code class="reqn">\mathbf{x} \in S^{p-1}</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">c_{p,r} 1_{[1 - r, 1]}(\mathbf{x}' \boldsymbol{\mu}) \quad
\mathrm{with}\quad c_{p,r} := \omega_{p}\left[1 - F_p(1 - r)\right],</code>
</p>
<p> where
<code class="reqn">r=\cos(\alpha)</code> is the projected radius of the spherical cap about
<code class="reqn">\boldsymbol{\mu}</code>, <code class="reqn">\omega_p</code> is the surface area of
<code class="reqn">S^{p-1}</code>, and <code class="reqn">F_p</code> is the projected uniform distribution (see
<code>p_proj_unif</code>).
</p>
<p>The angular function of the uniform cap distribution is
<code class="reqn">g(t):=1_{[1 - r, 1]}(t)</code>. The associated
projected density is <code class="reqn">\tilde{g}(t):=\omega_{p-1} c_{p,r}
(1 - t^2)^{(p - 3) / 2} 1_{[1 - r, 1]}(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d_unif_cap(x, mu, angle = pi/10)

c_unif_cap(p, angle = pi/10)

r_unif_cap(n, mu, angle = pi/10)

p_proj_unif_cap(x, p, angle = pi/10)

q_proj_unif_cap(u, p, angle = pi/10)

d_proj_unif_cap(x, p, angle = pi/10, scaled = TRUE)

r_proj_unif_cap(n, p, angle = pi/10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>locations to evaluate the density or distribution. For
<code>d_unif_cap</code>, positions on <code class="reqn">S^{p - 1}</code> given either as a matrix of
size <code>c(nx, p)</code> or a vector of length <code>p</code>. Normalized internally if
required (with a <code>warning</code> message). For <code>d_unif_proj_cap</code> and
<code>p_unif_proj_cap</code>, a vector with values in <code class="reqn">[-1, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the directional mean <code class="reqn">\boldsymbol{\mu}</code> of the
distribution. A unit-norm vector of length <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle <code class="reqn">\alpha</code> defining the spherical cap about
<code class="reqn">\boldsymbol{\mu}</code>. A scalar in <code class="reqn">[0, \pi]</code>. Defaults to
<code class="reqn">\pi / 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer giving the dimension of the ambient space <code class="reqn">R^p</code> that
contains <code class="reqn">S^{p-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>whether to scale the angular function by the normalizing
constant. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Depending on the function:
</p>

<ul>
<li> <p><code>d_unif_cap</code>: a vector of length <code>nx</code> or <code>1</code> with the
evaluated density at <code>x</code>.
</p>
</li>
<li> <p><code>r_unif_cap</code>: a matrix of size <code>c(n, p)</code> with the random
sample.
</p>
</li>
<li> <p><code>c_unif_cap</code>: the normalizing constant.
</p>
</li>
<li> <p><code>p_proj_unif_cap</code>: a vector of length <code>x</code> with the
evaluated distribution function at <code>x</code>.
</p>
</li>
<li> <p><code>q_proj_unif_cap</code>: a vector of length <code>u</code> with the
evaluated quantile function at <code>u</code>.
</p>
</li>
<li> <p><code>d_proj_unif_cap</code>: a vector of size <code>nx</code> with the
evaluated angular function.
</p>
</li>
<li> <p><code>r_proj_unif_cap</code>: a vector of length <code>n</code> containing
simulated values from the cosines density associated to the angular
function.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Alberto Fernández-de-Marcos and Eduardo García-Portugués.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulation and density evaluation for p = 2
mu &lt;- c(0, 1)
angle &lt;- pi / 5
n &lt;- 1e2
x &lt;- r_unif_cap(n = n, mu = mu, angle = angle)
col &lt;- viridisLite::viridis(n)
r_noise &lt;- runif(n, 0.95, 1.05) # Perturbation to improve visualization
color &lt;- col[rank(d_unif_cap(x = x, mu = mu, angle = angle))]
plot(r_noise * x, pch = 16, col = color, xlim = c(-1, 1), ylim = c(-1, 1))

# Simulation and density evaluation for p = 3
mu &lt;- c(0, 0, 1)
angle &lt;- pi / 5
x &lt;- r_unif_cap(n = n, mu = mu, angle = angle)
color &lt;- col[rank(d_unif_cap(x = x, mu = mu, angle = angle))]
scatterplot3d::scatterplot3d(x, size = 5, xlim = c(-1, 1), ylim = c(-1, 1),
                             zlim = c(-1, 1), color = color)

# Simulated data from the cosines density
n &lt;- 1e3
p &lt;- 3
angle &lt;- pi / 3
hist(r_proj_unif_cap(n = n, p = p, angle = angle),
     breaks = seq(cos(angle), 1, l = 10), probability = TRUE,
     main = "Simulated data from proj_unif_cap", xlab = "t", xlim = c(-1, 1))
t &lt;- seq(-1, 1, by = 0.01)
lines(t, d_proj_unif_cap(x = t, p = p, angle = angle), col = "red")
</code></pre>


</div>