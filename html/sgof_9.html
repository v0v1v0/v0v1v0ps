<div class="container">

<table style="width: 100%;"><tr>
<td>Discrete.SGoF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discrete SGoF multiple testing procedure</h2>

<h3>Description</h3>

<p>Performs the Discrete SGoF method (<cite>Castro-Conde, Döhler et al., 2015</cite>) for multiple hypothesis testing.</p>


<h3>Usage</h3>

<pre><code class="language-R">Discrete.SGoF(u,pCDFlist=NA, K=NA, alpha = 0.05, gamma = 0.05, method=NA, 
              Discrete=TRUE, Sides=1,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A (non-empty) numeric vector of p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pCDFlist</code></td>
<td>
<p>A (non-empty) list with the empirical cumulative function of each discrete p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Numeric value. The number of continuous tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value. The significance level of the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Numeric value. The p-value threshold, so Discrete SGoF looks for significance in the amount of p-values below gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used in the computation of the Poisson binomial quantile.  "DFT-CF" for the exact method and "RNA" for the refined normal approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Discrete</code></td>
<td>
<p>Logical. Default is TRUE. A variable indicating if the tests are discrete or continuous in order to estimate the FDR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sides</code></td>
<td>
<p>Numeric value indicating if the tests are one-sided (default), <code>Sides=1</code>, or two-sided, <code>Sides=2</code> in order to estimate the FDR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed through to <code>robust.fdr</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Discrete SGoF is an extension of Binomial SGoF, based on the generalized or Poisson binomial distribution (Hong, 2013),  which takes into account the discreteness of the p-values. If all the tests are continuous Discrete SGoF reduces to Binomial SGoF method. 
In particular, if the p-values are continuous, the number of rejections given by Discrete.SGoF will be the number of effects declared by Binomial SGoF.  For computing the Poisson Binomial quantile, the <code>poibin</code> package (Hong, 2019) is used. The exact method ("DFT-CF") and the "RNA" approximation are used by default to compute the quantile depending on whether the number of tests is smaller than 2000  or not, respectively (see Hong 2013a for more information). However, the user can specified which of the two methods to use.
Discrete SGoF works the same like Binomial SGoF but it uses the quantiles of the generalized binomial distribution, as mentioned, instead of the binomial quantiles.
Discrete SGoF maintains the theoretical properties of Binomial SGoF, e.g. weak control of FDR(FWER) and increasing power when the number of tests increases (de Uña Álvarez, 2011).
The FDR is estimated by using the method proposed by: <cite>Pounds and Cheng (2006)</cite> using the <code>robust.fdr</code> function provided by the authors.
</p>


<h3>Value</h3>

<p>A list containing the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Rejections </code></td>
<td>
<p>The number of effects declared by Discrete SGoF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR </code></td>
<td>
<p>The estimated false discovery rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues </code></td>
<td>
<p>The original p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>The specified significance level for the metatest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p>The specified p-value threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K </code></td>
<td>
<p>The specified number of continuous tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Method</code></td>
<td>
<p>The specified method used in the computation of the Poisson binomial quantile. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Discrete</code></td>
<td>
<p>The specified type of tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sides</code></td>
<td>
<p>Numeric value indicating if the tests are one-sided (default), <code>Sides=1</code>, or two-sided, <code>Sides=2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Irene Castro Conde and Sebastian Döhler</p>


<h3>References</h3>

<p>Carvajal Rodríguez A, de Uña Álvarez J and Rolán Álvarez E (2009). A new
multitest correction (SGoF) that increases its statistical power when increasing the number of tests. <em>BMC Bioinformatics</em> 10:209.
</p>
<p>Castro Conde I, Döhler S and de Uña Álvarez J (2015). An extended sequential goodness-of-fit multiple testing method for discrete data. <em>Statistical Methods in Medical Research</em>, doi: 10.1177/0962280215597580.
</p>
<p>de Uña Álvarez J (2011). On the statistical properties of SGoF multitesting method. 
<em>Statistical Applications in Genetics and Molecular Biology</em>, Vol. 10, Iss. 1, Article 18.
</p>
<p>Kihn C, Döhler S, Junge F (2024). DiscreteDatasets: Example Data Sets for Use with Discrete Statistical Tests. R package version 0.1.1
</p>
<p>Hong Y. (2013). On computing the distribution functions for the Poisson binomial
distribution. <em>Computational Statistics and Data Analysis</em> 59, 41-51.
</p>
<p>Hong Y. (2019). poibin: The Poisson Binomial Distribution. R package version 1.4
</p>
<p>Pounds, S. and C. Cheng (2006). Robust estimation of the false discovery rate.
<em>Bioinformatics</em> 22 (16), 1979-1987.
</p>


<h3>See Also</h3>

<p><code>Binomial.SGoF</code></p>


<h3>Examples</h3>

<pre><code class="language-R">

require(DiscreteDatasets)

data(amnesia) #discrete data

AllAdverseCases&lt;-amnesia$OtherAdverseCases + amnesia$AmnesiaCases
A11 &lt;- amnesia$AmnesiaCases
A21 &lt;- sum(AllAdverseCases) - A11
A12 &lt;- AllAdverseCases - A11
A22 &lt;- sum(AllAdverseCases) - sum(amnesia$AmnesiaCases) - A12

A1. &lt;- sum(amnesia$AmnesiaCases)
A2. &lt;- sum(AllAdverseCases) - A1.
  
n &lt;- A11 + A12
k &lt;- pmin(n,A1.)

pCDFlist &lt;- list()
pvec &lt;- numeric(nrow(amnesia))

## Calculation of the p-values and the p-values CDFs: 

for (i in 1:nrow(amnesia))
{
  x &lt;- 0:k[i]
  pCDFlist[[i]] &lt;- dhyper(x ,A1., A2. ,n[i]) + phyper(x ,A1. ,A2. ,n[i] ,lower.tail = FALSE)
  pCDFlist[[i]] &lt;- rev(pCDFlist[[i]])
  pvec[i] &lt;- dhyper(A11[i] ,A1. ,A2. ,n[i]) + phyper(A11[i] ,A1. ,A2. ,n[i] ,lower.tail = FALSE)
}

res&lt;-Discrete.SGoF(u=pvec,pCDFlist=pCDFlist,alpha=0.05,gamma=0.05,Discrete=TRUE,Sides=1)
res


#continuous p-values

res2&lt;-Discrete.SGoF(u=Hedenfalk$x,K=3170,Discrete=FALSE, method="DFT-CF",Sides=2)
res2

</code></pre>


</div>