<div class="container">

<table style="width: 100%;"><tr>
<td>pand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Percentage of all non-overlapping data</h2>

<h3>Description</h3>

<p>The <code>pand()</code> function calculates the percentage of all non-overlapping data
(PAND; Parker, Hagan-Burke, &amp; Vannest, 2007), an index to quantify a level
increase (or decrease) in performance after the onset of an intervention.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pand(
  data,
  dvar,
  pvar,
  decreasing = FALSE,
  phases = c(1, 2),
  method = c("sort", "minimum")
)

## S3 method for class 'sc_pand'
print(x, ...)

## S3 method for class 'sc_pand'
export(
  object,
  caption = NA,
  footnote = NA,
  filename = NA,
  kable_styling_options = list(),
  kable_options = list(),
  round = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A single-case data frame. See <code>scdf()</code> to learn about this
format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dvar</code></td>
<td>
<p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvar</code></td>
<td>
<p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>If you expect data to be lower in the B phase, set
<code>decreasing = TRUE</code>. Default is <code>decreasing = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phases</code></td>
<td>
<p>A vector of two characters or numbers indicating the two phases
that should be compared. E.g., <code>phases = c("A","C")</code> or <code>phases = c(2,4)</code>
for comparing the second to the fourth phase. Phases could be combined by
providing a list with two elements. E.g., <code>phases = list(A = c(1,3), B = c(2,4))</code> will compare phases 1 and 3 (as A) against 2 and 4 (as B). Default
is <code>phases = c(1,2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either <code>"sort"</code>" or <code>"minimum"</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object returned by <code>pand()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An scdf or an object exported from a scan function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>Character string with table caption. If left NA (default) a
caption will be created based on the exported object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote</code></td>
<td>
<p>Character string with table footnote. If left NA (default) a
footnote will be created based on the exported object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>String containing the file name. If a filename is given the
output will be written to that file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kable_styling_options</code></td>
<td>
<p>list with arguments passed to the kable_styling
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kable_options</code></td>
<td>
<p>list with arguments passed to the kable function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>Integer passed to the digits argument internally used to round
values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>PAND was proposed by Parker, Hagan-Burke, and Vannest in 2007. The authors
emphasize that PAND is designed for application in a multiple case design with
a substantial number of measurements, technically at least 20 to 25, but
preferably 60 or more. PAND is defined as 100% minus the percentage of data
points that need to be removed from either phase in order to ensure nonoverlap
between the phases. Several approaches have been suggested to calculate PAND,
leading to potentially different outcomes. In their 2007 paper, Parker and
colleagues present an algorithm for computing PAND. The algorithm involves
sorting the scores of a time series, including the associated phases, and
comparing the resulting phase order with the original phase order using a
contingency table. To account for ties, the algorithm includes a randomization
process where ties are randomly assigned to one of the two phases.
Consequently, executing the algorithm multiple times could yield different
results. It is important to note that this algorithm does not produce the same
results as the PAND definition provided earlier in the same paper. However, it
offers the advantage of allowing the calculation of an effect size measure
<code>phi</code>, and the application of statistical tests for frequency distributions.
Pustejovsky (2019) presented a mathematical formulation of Parker's original
definition for comparing two phases of a single case: </p>
<p style="text-align: center;"><code class="reqn">PAND =
\frac{1}{m+n}max\{(i+j)I(y^A_{i}&lt;y^B_{n+1-j}\}</code>
</p>
<p> This formulation provides
accurate results for PAND, but the original definition has the drawback of an
unknown distribution under the null hypothesis, making a statistical test
difficult. The <code>pand()</code> function enables the calculation of PAND using both
methods. The first approach (<code>method = "sort"</code>) follows the algorithm
described above, with the exclusion of randomization before sorting to avoid
ambiguity. It calculates a phi measure and provides the results of a
chi-squared test and a Fisher exact test. The second approach (<code>method = "minimum"</code>) applies the aforementioned formula. The code of this function is
based on the code of the <code>SingleCaseES</code> package (function <code>calc_PAND</code>). For a
multiple case design, overlaps are calculated for each case, summed, and then
divided by the total number of measurements. No statistical test is conducted
for this method.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pand</code></td>
<td>
<p>Percentage of all non-overlapping data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Effect
size Phi based on expected and observed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc_overlap</code></td>
<td>
<p>Percentage of overlapping data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlaps</code></td>
<td>
<p>Number of
overlapping data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number
of cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_a</code></td>
<td>
<p>Number of data points in phase A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_b</code></td>
<td>
<p>Number of
data points in phase B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>2x2 frequency
matrix of phase A and B comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix_counts</code></td>
<td>
<p>2x2 counts matrix
of phase A and B comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi_test</code></td>
<td>
<p>A Chi-squared analysis of expected and observed data
(<code>chisq.test()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher_test</code></td>
<td>
<p>A Fisher exact test analysis of expected and observed data
(<code>fisher.test()</code>).</p>
</td>
</tr>
</table>
<h3>Functions</h3>


<ul>
<li> <p><code>print(sc_pand)</code>: Print results
</p>
</li>
<li> <p><code>export(sc_pand)</code>: Export results as html table (see <code>export()</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Juergen Wilbert
</p>


<h3>References</h3>

<p>Parker, R. I., Hagan-Burke, S., &amp; Vannest, K. (2007). Percentage
of All Non-Overlapping Data (PAND): An Alternative to PND. <em>The Journal of
Special Education, 40</em>, 194-204.
</p>
<p>Parker, R. I., &amp; Vannest, K. (2009). An Improved Effect Size for Single-Case
Research: Nonoverlap of All Pairs. <em>Behavior Therapy, 40</em>, 357-367.
</p>
<p>Pustejovsky, J. E. (2019). Procedural sensitivities of effect sizes for
single-case designs with directly observed behavioral outcome measures.
<em>Psychological Methods</em>, <em>24(2)</em>, 217-235.
https://doi.org/10.1037/met0000179
</p>
<p>Pustejovsky JE, Chen M, Swan DM (2023). SingleCaseES: A Calculator for
Single-Case Effect Sizes. R package version 0.7.1.9999,
https://jepusto.github.io/SingleCaseES/.
</p>


<h3>See Also</h3>

<p>Other overlap functions: 
<code>cdc()</code>,
<code>nap()</code>,
<code>overlap()</code>,
<code>pem()</code>,
<code>pet()</code>,
<code>pnd()</code>,
<code>tau_u()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## REplication of the Parker et al. 2007 example
pand(Parker2007)

## Calculate the PAND with an expected decrease of phase B scores
cubs &lt;- scdf(c(20,22,24,17,21,13,10,9,20,9,18), B_start = 5)
pand(cubs, decreasing = TRUE)

</code></pre>


</div>