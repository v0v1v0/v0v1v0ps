<div class="container">

<table style="width: 100%;"><tr>
<td>w8margin_matched</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check if w8margin Matches Observed Data</h2>

<h3>Description</h3>

<p>Checks whether specified <code>w8margin</code> object and variable in observed
data are compatible, and are expected to produce valid call to
<code>rake</code>. Returns a logical true/false, and generates
warning messages to specify likely issues. Intended to help quickly
diagnose incompatibilities between w8margins and observed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">w8margin_matched(w8margin, observed, refactor = FALSE, 
  na.targets.allow = FALSE, zero.targets.allow = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w8margin</code></td>
<td>
<p>w8margin object, or other object type that can be coerced to
w8margin with a temporary variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>factor vector (or, if <code>refactor = TRUE</code>, a vector that can
be coerced to factor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refactor</code></td>
<td>
<p>logical, specifying whether to factor observed variable before checking
match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.targets.allow</code></td>
<td>
<p>logical, indicating whether NA values in target should produce error (<code>FALSE</code>, the default)
or be allowed. NA values are never allowed in observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.targets.allow</code></td>
<td>
<p>logical, indicating whether zero values in target should produce error (<code>FALSE</code>, the default)
or be allowed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With default parameters (<code>na.targets.allow = FALSE</code>, <code>zero.targets.allow = FALSE</code>,
and <code>refactor = FALSE</code>), the function checks whether a <code>w8margin</code>
object is in the strict format required by <code>rake</code>; this format
will also be accepted by <code>rakesvy()</code> and <code>rakew8()</code>. Changing
the default parameters relaxes some checks. With the parameters
altered, the function will only assess whether <code>w8margin</code> objects are
usable by <code>rakesvy()</code> and <code>rakew8()</code>, which
accept a more flexible range of target formats.
</p>
<p>It should not generally be necessary to call <code>w8margin_matched()</code> manually when
using <code>rakesvy()</code> and <code>rakew8()</code> to compute weights.
However,  may be useful to call directly, when manually calling underlying
weighting functions from the <code>survey</code> package, or for diagnostic purposes.
</p>


<h3>Value</h3>

<p>A logical, indicating whether w8margin is compatible with observed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">gender_w8margin &lt;- as.w8margin(
    c(Male = .49, Female = .51),
    varname = "gender", 
    samplesize = 2179)
# Returns TRUE
w8margin_matched(gender_w8margin, gles17$gender)

gender_w8margin_alt &lt;- as.w8margin(
    c(man = .49, woman = .51), 
    varname = "gender", 
    samplesize = 2179)
# Returns FALSE - level names in gles17$gender do not match level names in gender_w8margin_alt
w8margin_matched(gender_w8margin_alt, gles17$gender)

agecat_50plus_w8margin &lt;- as.w8margin(
    c("50-59" = .35, "60-69" = .27, "&gt;=70" = .38),
    varname = "educ",
    samplesize = 2179
)
gles17_50plus &lt;- gles17[gles17$agecat %in% c("50-59", "60-69", "&gt;=70"),]
# Returns FALSE - gles17$agecat has empty factor levels for &lt;=29, 30-39, 40-49
w8margin_matched(agecat_50plus_w8margin, gles17_50plus$agecat)
# Returns TRUE - gles17$agecat is refactored to drop empty levels
w8margin_matched(agecat_50plus_w8margin, gles17_50plus$agecat, refactor = TRUE)
</code></pre>


</div>