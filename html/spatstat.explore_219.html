<div class="container">

<table style="width: 100%;"><tr>
<td>Jmulti.inhom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Inhomogeneous Marked J-Function
</h2>

<h3>Description</h3>

<p>For a marked point pattern, 
estimate the inhomogeneous version of the multitype <code class="reqn">J</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Jmulti.inhom(X, I, J,
             lambda = NULL, lambdaI = NULL, lambdaJ = NULL,
             lambdamin = NULL,
             ...,
             r = NULL,
             ReferenceMeasureMarkSetI = NULL,
             ratio = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The observed point pattern, 
from which an estimate of the inhomogeneous multitype <code class="reqn">J</code> function
<code class="reqn">J_{IJ}(r)</code> will be computed.
It must be a marked point pattern.
See under Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Subset index specifying the points of <code>X</code>
from which distances are measured, for the inhomogeneous <code class="reqn">G</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Subset index specifying the points in <code>X</code> to which
distances are measured, for the inhomogeneous <code class="reqn">G</code> and <code class="reqn">F</code> functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Optional.
Values of the estimated intensity function.
Either a vector giving the intensity values
at the points of the pattern <code>X</code>,
a pixel image (object of class <code>"im"</code>) giving the
intensity values at all locations, a fitted point process model
(object of class <code>"ppm"</code>) or a <code>function(x,y)</code> which
can be evaluated to give the intensity value at any location.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaI</code></td>
<td>

<p>Optional.
Values of the estimated intensity of the sub-process <code>X[I]</code>.
Either a pixel image (object of class <code>"im"</code>),
a numeric vector containing the intensity values
at each of the points in <code>X[I]</code>,
a fitted point process model
(object of class <code>"ppm"</code> or <code>"kppm"</code> or <code>"dppm"</code>),
or a <code>function(x,y)</code> which
can be evaluated to give the intensity value at any location,
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaJ</code></td>
<td>

<p>Optional.
Values of the estimated intensity of the sub-process <code>X[J]</code>.
Either a pixel image (object of class <code>"im"</code>),
a numeric vector containing the intensity values
at each of the points in <code>X[J]</code>,
a fitted point process model
(object of class <code>"ppm"</code> or <code>"kppm"</code> or <code>"dppm"</code>),
or a <code>function(x,y)</code> which
can be evaluated to give the intensity value at any location.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdamin</code></td>
<td>

<p>Optional. The minimum possible value of the intensity
over the spatial domain. A positive numerical value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Extra arguments passed to <code>as.mask</code> to control
the pixel resolution for the computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>vector of values for the argument <code class="reqn">r</code> at which
the inhomogeneous <code class="reqn">K</code> function
should be evaluated. Not normally given by the user;
there is a sensible default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ReferenceMeasureMarkSetI</code></td>
<td>

<p>Optional. The total measure of the mark set. A positive number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>

<p>Logical value indicating whether to save ratio information.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is the counterpart of <code>Jmulti</code>
for inhomogeneous patterns. It is computed by evaluating the
inhomogeneous <code class="reqn">G</code> function <code>GmultiInhom</code> 
and the inhomogeneous <code class="reqn">F</code> function <code>FmultiInhom</code>
and computing the ratio <code class="reqn">J = (1-G)/(1-F)</code>.
</p>


<h3>Value</h3>

<p>Object of class <code>"fv"</code> containing the estimate of the
inhomogeneous multitype <code class="reqn">J</code> function.
</p>


<h3>Author(s)</h3>

<p>Jonatan Gonzalez and Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Cronie, O. and Van Lieshout, M.N.M. (2015)
Summary statistics for inhomogeneous marked point processes.
<em>Annals of the Institute of Statistical Mathematics</em>
DOI: 10.1007/s10463-015-0515-z
</p>


<h3>See Also</h3>

<p><code>Jcross.inhom</code>, <code>Jdot.inhom</code>
for special cases.
</p>
<p><code>GmultiInhom</code>, <code>FmultiInhom</code>,
<code>Jmulti</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  X &lt;- rescale(amacrine)
  I &lt;- (marks(X) == "on")
  J &lt;- (marks(X) == "off")
  if(interactive() &amp;&amp; require(spatstat.model)) {
    ## how to do it normally
    mod &lt;- ppm(X ~ marks * x)
    lam &lt;- fitted(mod, dataonly=TRUE)
    lmin &lt;- min(predict(mod)[["off"]]) * 0.9
    dd &lt;- NULL
  } else {
    ## for package testing
    lam &lt;- intensity(X)[as.integer(marks(X))]
    lmin &lt;- intensity(X)[2] * 0.9
    dd &lt;- 32
  }
  JM &lt;- Jmulti.inhom(X, I, J, lambda=lam, lambdamin=lmin, dimyx=dd)
</code></pre>


</div>