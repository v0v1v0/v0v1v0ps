<div class="container">

<table style="width: 100%;"><tr>
<td>nearNeighbour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Measures of identification accuracy</h2>

<h3>Description</h3>

<p>Tests of barcoding efficacy using distance-based methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nearNeighbour(distobj, sppVector, names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distobj</code></td>
<td>
<p>A distance object (usually from <code>dist.dna</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sppVector</code></td>
<td>
<p>Vector of species names. See <code>sppVector</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>Logical. Should the names of the nearest match be shown?
Default of FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions test barcoding efficacy. All sequences must be identified
prior to testing. Each sequence is considered an unknown while the remaining
sequences in the dataset constitute the DNA barcoding database that is used
for identification. If the identification from the test is the same as the
pre-considered identification, a correct result is returned.
</p>
<p><code>bestCloseMatch</code> conducts the "best close match" analysis of Meier et
al. (2006), considering the closest individual unless it is further than the
given threshold, which results in no identification. More than one species
tied for closest match results in an assignment of "ambiguous". When the
threshold is large, this analysis will return essentially the same result as
<code>nearNeighbour</code>. If <code>names = TRUE</code>, a list is returned containing
the names of all species represented by specimens within the threshold.
</p>
<p><code>nearNeighbour</code> finds the closest individual and returns if their names
are the same (TRUE) or different (FALSE). If <code>names = TRUE</code>, the name
of the closest individual is returned. Ties are decided by majority rule.
</p>
<p><code>threshID</code> conducts a threshold-based analysis, similar to that
conducted by the "Identify Specimen" tool provided by the Barcode of Life
Database (<a href="http://www.boldsystems.org/index.php/IDS_OpenIdEngine">http://www.boldsystems.org/index.php/IDS_OpenIdEngine</a>). It
is more inclusive than <code>bestCloseMatch</code>, considering ALL sequences
within the given threshold. If <code>names = TRUE</code>, a list is returned
containing the names of all species represented by specimens within the
threshold.
</p>
<p>These functions are not recommended as identification tools, though they can
be used as such when <code>names = TRUE</code>.
</p>


<h3>Value</h3>

<p><code>bestCloseMatch</code> and <code>threshID</code> return a character vector
giving the identification status of each individual.  </p>
<table>
<tr style="vertical-align: top;">
<td><code>"correct"</code></td>
<td>
<p>The
name of the closest match is the same</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"incorrect"</code></td>
<td>
<p>The name of the
closest match is different</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"ambiguous"</code></td>
<td>
<p>More than one species is the
closest match (<code>bestCloseMatch</code>), or is within the given threshold
(<code>threshID</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"no id"</code></td>
<td>
<p>No species are within the threshold
distance</p>
</td>
</tr>
</table>
<p><code>nearNeighbour</code> returns a logical vector or (if <code>names = TRUE</code>)
the name for the nearest individual.
</p>


<h3>Author(s)</h3>

<p>Samuel Brown &lt;s_d_j_brown@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Meier, R., Shiyang, K., Vaidya, G., &amp; Ng, P. (2006). DNA
barcoding and taxonomy in Diptera: a tale of high intraspecific variability
and low identification success. _Systematic Biology_ *55* (5) 715-728.
</p>


<h3>See Also</h3>

<p><code>nearNeighbour</code>, <code>threshID</code>, <code>dist.dna</code>, <code>sppVector</code> 
Also as <code>help</code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(anoteropsis)
anoDist &lt;- ape::dist.dna(anoteropsis)
anoSpp &lt;- sapply(strsplit(dimnames(anoteropsis)[[1]], split = "_"), 
    function(x) paste(x[1], x[2], sep = "_"))

bestCloseMatch(anoDist, anoSpp)
bestCloseMatch(anoDist, anoSpp, threshold = 0.005)
nearNeighbour(anoDist, anoSpp)
nearNeighbour(anoDist, anoSpp, names = TRUE)
threshID(anoDist, anoSpp)
threshID(anoDist, anoSpp, threshold = 0.003)

data(dolomedes)
doloDist &lt;- ape::dist.dna(dolomedes)
doloSpp &lt;- substr(dimnames(dolomedes)[[1]], 1, 5)

bestCloseMatch(doloDist, doloSpp)
bestCloseMatch(doloDist, doloSpp, threshold = 0.005)
nearNeighbour(doloDist, doloSpp)
nearNeighbour(doloDist, doloSpp, names=TRUE)
threshID(doloDist, doloSpp)
threshID(doloDist, doloSpp, threshold = 0.003)

</code></pre>


</div>