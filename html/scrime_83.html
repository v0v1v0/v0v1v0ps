<div class="container">

<table style="width: 100%;"><tr>
<td>simulateSNPglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of SNP data</h2>

<h3>Description</h3>

<p>Simulates SNP data. Interactions of some of the simulated SNPs
are then used to specify either a binary or a
quantitative response by a logistic or linear regression model, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulateSNPglm(n.obs = 1000, n.snp = 50, list.ia = NULL, list.snp = NULL, 
   beta0 = -0.5, beta = 1.5, maf = 0.25, sample.y = TRUE, p.cutoff = 0.5, 
   err.fun = NULL, rand = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>number of observations that should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.snp</code></td>
<td>
<p>number of SNPs that should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list.ia</code></td>
<td>
<p>a list consisting of numeric vectors (or values) specifying the genotypes
of the SNPs that should be explanatory for the response. Each of these vectors
must be composed of some of the numbers -3, -2, -1, 1, 2, 3, where 1 denotes
the homozygous reference genotype, 2 the heterozygous genotype, and 3 the
homozygous variant genotype, and a minus before these numbers means that
the corresponding SNP should be not of this genotype. If, e.g., one of the
vectors is given by <code>c(1, -1, -3)</code> and the corresponding vector in
<code>list.snp</code> is <code>c(5, 7, 8)</code>, then the corresponding interaction
used in the regression model to specify the response is
</p>
<p><code>(SNP5 == 1) &amp; (SNP7 != 1) &amp; (SNP8 != 3)</code>. 
</p>
<p>For more details, see Details. Must be specified if <code>list.snp</code> is specified. 
If both <code>list.ia</code> and <code>list.snp</code> are <code>NULL</code>, then the interactions
shown in the Details section are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list.snp</code></td>
<td>
<p>a list consisting of numeric vectors specifying the SNPs that compose
the interactions used in the regression model. Each of these vectors must have the
same length as the corresponding vector in <code>list.ia</code>, and  must consist
of integers between 1 and <code>n.snp</code>, where the integer <code class="reqn">i</code> corresponds to
the <code class="reqn">i</code>th column of the simulated SNP matrix. If <code>list.ia</code> is specified but
not <code>list.snp</code>, then the first <code class="reqn">n</code> SNPs are used to generate the interactions,
where <code class="reqn">n</code> is the total number of values in <code>list.ia</code>. For the case that both
<code>list.ia</code> and <code>list.snp</code> are not specified, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>a numeric value specifying the intercept of the regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a non-negative numeric value or vector of the same length as <code>list.ia</code>
(i.e.\ one numeric value for each interaction) specifying the parameters in the
regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maf</code></td>
<td>
<p>either an integer, or a vector of length 2 or <code>n.snp</code> specifying the
minor allele frequency. If an integer, all the SNPs will have the same
minor allele frequency. If a vector of length <code>n.snp</code>, each SNP will have the minor
allele frequency specified in the corresponding entry of <code>maf</code>. If length 2, then
<code>maf</code> is interpreted as the range of the minor allele frequencies, and for each SNP,
a minor allele frequency will be randomly drawn from a uniform distribution with
the range given by <code>maf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.y</code></td>
<td>
<p>should the values of the response in the logistic regression model be randomly drawn
using the probabilities of the respective observations for being a case? If <code>FALSE</code>,
then the response value of an observation is 1 if its probability for being a case is larger
than <code>p.cutoff</code>, and otherwise the observation is classified as a control (i.e.\ the value
of the response is 0). Ignored if <code>err.fun</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.cutoff</code></td>
<td>
<p>a probability, i.e.\ a numeric value between 0 and 1, naming the cutoff for an
observation to be called a case if <code>sample.y = FALSE</code>. For details, see <code>sample.y</code>.
Ignored if <code>sample.y = TRUE</code> or <code>err.fun</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.fun</code></td>
<td>
<p>a function for generating the error that is added to the linear model to determine
the value of the (quantitative) response. If <code>NULL</code>, a logistic regression model is fitted.
If specified, a linear model is fitted. Therefore, this argument is used to differ between the
two types of models. The specified function must have as first argument the number of values
that should be generated and as output a vector consisting of these values. Further arguments
can also be specified because of <code>...</code> in <code>simulateSNPglm</code>.
If, e.g., <code>err.fun = rnorm</code>, then <code>rnorm(n.obs)</code> will be called to generate
<code>n.obs</code> observations from a standard normal function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>a numeric value for setting the random number generator in a reproducible state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments of the function specified by <code>err.fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>simulateSNPglm</code> first simulates a matrix consisting of <code>n.obs</code> observations and <code>n.snp</code>
SNPs, where the minor allele frequencies of these SNPs are given by <code>maf</code>.
</p>
<p>Note that all SNPs are currently simulated independently of each other such that they are unlinked.
</p>
<p>Afterwards, the response is determined by a regression model using the specifications of <code>list.ia</code>,
<code>list.snp</code>, <code>beta0</code> and <code>beta</code>. Depending on whether <code>err.fun</code> is specified or not,
a linear or a logistic regression model is used, respectively, i.e.\ the response <code class="reqn">Y</code> is continuous or binary.
</p>
<p>By default, a logistic regression model
</p>
<p>logit(Prob(<code class="reqn">Y = 1</code>)) = <code>beta0</code> + <code>beta[1]</code> * <code class="reqn">L_1</code> + <code>beta[2]</code> * <code class="reqn">L_2</code> + ...
</p>
<p>is fitted, since <code>err.fun = NULL</code>. 
</p>
<p>If both <code>list.ia</code> and <code>list.snp</code> are <code>NULL</code>, then interactions similar to the one
considered, e.g., in Nunkesser et al.\ (2007) or Schwender et al.\ (2007) are used, i.e.\
</p>
<p><code class="reqn">L_1</code> = <code>(SNP6 != 1) &amp; (SNP7 == 1)</code>\ \ \ and 
</p>
<p><code class="reqn">L_2</code> = <code>(SNP3 == 1) &amp; (SNP9 == 1) &amp; (SNP10 == 1)</code>,
</p>
<p>by setting <code>list.ia = list(c(-1, 1), c(1, 1, 1))</code> and
<code>list.snp = list(c(6, 7), c(3, 9, 10))</code>. 
</p>
<p>Using the above model Prob(<code class="reqn">Y = 1</code>) is computed for each observation, and its value of the response is
determined either by a random draw from a Bernoulli distribution using this probability (if <code>sample.y = TRUE</code>),
or by evaluating if Prob(<code class="reqn">Y = 1</code>) <code class="reqn">&gt;</code> <code>p.cutoff</code> (if <code>sample.y = FALSE</code>).
</p>
<p>If <code>err.fun</code> is specified, then the linear model
</p>
<p><code class="reqn">Y</code> = <code>beta0</code> + <code>beta[1]</code> * <code class="reqn">L_1</code> + <code>beta[2]</code> * <code class="reqn">L_2</code> + ... + error
</p>
<p>is used to determine the values of the response <code class="reqn">Y</code>, where the values for error are given
by the output of a call of <code>err.fun</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>simSNPglm</code> consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix with <code>n.obs</code> rows and <code>n.snp</code> columns containing the simulated SNP values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of length <code>n.obs</code> composed of the values of the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>the value of the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the vector of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ia</code></td>
<td>
<p>a character vector naming the explanatory interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maf</code></td>
<td>
<p>a vector of length <code>n.snp</code> composed of the minor allele frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of length <code>n.obs</code> consisting of the values of Prob(<code class="reqn">Y = 1</code>) (if <code>err.fun = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>a vector of length <code>n.obs</code> composed of the values of the error (if <code>err.fun</code> is specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.cutoff</code></td>
<td>
<p>the value of <code>p.cutoff</code> (if <code>err.fun = NULL</code> and <code>sample.y = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.call</code></td>
<td>
<p>a character string naming the call of the error function (if <code>err.fun</code> is specified).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Holger Schwender, <a href="mailto:holger.schwender@udo.edu">holger.schwender@udo.edu</a></p>


<h3>References</h3>

<p>Nunkesser, R., Bernholt, T., Schwender, H., Ickstadt, K. and Wegener, I.\ (2007).
Detecting High-Order Interactions of Single Nucleotide Polymorphisms Using Genetic Programming.
<em>Bioinformatics</em>, 23, 3280-3288.
</p>
<p>Schwender, H.\ (2007). Statistical Analysis of Genotype and Gene Expression Data. <em>Dissertation</em>,
Department of Statistics, University of Dortmund. 
</p>


<h3>See Also</h3>

<p><code>simulateSNPs</code>, <code>summary.simSNPglm</code>, <code>simulateSNPcatResponse</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# The simulated data set described in Details.

sim1 &lt;- simulateSNPglm()
sim1

# A bit more information: Table of probabilities of being a case
# vs. numbers of cases and controls.

summary(sim1)

# Calling an observation a case if its probability of being
# a case is larger than 0.5 (the default for p.cutoff).

sim2 &lt;- simulateSNPglm(sample.y = FALSE)
summary(sim2)

# If ((SNP4 != 2) &amp; (SNP3 == 1)), (SNP5 ==3) and
# ((SNP12 !=1) &amp; (SNP9 == 3)) should be the three interactions
# (or variables) that are explanatory for the response,
# list.ia and list.snp are specified as follows.

list.ia &lt;- list(c(-2, 1), 3, c(-1,3))
list.snp &lt;- list(c(4, 3), 5, c(12,9))

# The binary response and the data set consisting of 
# 600 observations and 25 SNPs, where the minor allele
# frequency of each SNP is randomly drawn from a
# uniform distribution with minimum 0.1 and maximum 0.4,
# is then generated by

sim3 &lt;- simulateSNPglm(n.obs = 600, n.snp = 25,
  list.ia = list.ia, list.snp = list.snp, maf = c(0.1, 0.4))
sim3

summary(sim3)
  
# If the response should be quantitative, err.fun has
# to be specified. To use a normal distribution with mean 0
# (default in rnorm) and a standard deviation of 2 
# as the distribution of the error, call

simulateSNPglm(err.fun = rnorm, sd = 2)
 


## End(Not run)</code></pre>


</div>