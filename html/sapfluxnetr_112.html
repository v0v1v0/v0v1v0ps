<div class="container">

<table style="width: 100%;"><tr>
<td>sfn_mutate_at</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mutate selected columns by function</h2>

<h3>Description</h3>

<p>Port of <code>mutate_at</code> for <code>sfn_data</code> and
<code>sfn_data_multi</code> objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">sfn_mutate_at(sfn_data, .vars, .funs, ..., solar = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sfn_data</code></td>
<td>
<p><code>sfn_data</code> or <code>sfn_data_multi</code> object to subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.vars</code></td>
<td>
<p>Variables to mutate. Passed to <code>mutate_at</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.funs</code></td>
<td>
<p>Function/s for mutate, passed to <code>mutate_at</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments to pass to the functions in <code>.funs</code>, passed
to <code>mutate_at</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solar</code></td>
<td>
<p>Logical indicating if solar timestamp must used to subset</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'sfn_mutate_at' function will maintain the same number of rows before and
after the modification, so it is well suited to modify variables without
creating TIMESTAMP gaps (i.e. to change variable units). For mutating
individual variables see <code>sfn_mutate</code>.
</p>


<h3>Value</h3>

<p>For <code>sfn_data</code> objects, a mutated <code>sfn_data</code>. For
<code>sfn_data_multi</code> another <code>sfn_data_multi</code> with the sites mutated
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(lubridate)

# data
data('ARG_TRE', package = 'sapfluxnetr')

# transform to NAs any sapflow value occured with wind speed above 25
ws_threshold &lt;- 25
# get the names of the variables to mutate (tree names)
vars_to_mutate &lt;- names(get_sapf_data(ARG_TRE)[,-1]) # no TIMESTAMP

sfn_mutate_at(
  ARG_TRE,
  .vars = vars(one_of(vars_to_mutate)),
  .funs = list(
    ~ case_when(
      ws &gt; ws_threshold ~ NA_real_,
      TRUE ~ .
    )
  )
)

## multi
data(ARG_MAZ, package = 'sapfluxnetr')
data(AUS_CAN_ST2_MIX, package = 'sapfluxnetr')
multi_sfn &lt;- sfn_data_multi(ARG_TRE, ARG_MAZ, AUS_CAN_ST2_MIX)

## in multi it's better to discard the variables to not mutate:
vars_to_not_mutate &lt;- names(get_env_data(ARG_TRE)) # all the environmental

multi_sfn_mutated &lt;- sfn_mutate_at(
  multi_sfn,
  .vars = vars(-one_of(vars_to_not_mutate)), # we use -
  .funs = list(
    ~ case_when(
      ws &gt; ws_threshold ~ NA_real_,
      TRUE ~ .
    )
  )
)

multi_sfn_mutated[['ARG_TRE']]

</code></pre>


</div>