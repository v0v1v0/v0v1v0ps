<div class="container">

<table style="width: 100%;"><tr>
<td>de_mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute group-meaned and de-meaned variables</h2>

<h3>Description</h3>

<p><code>de_mean()</code> computes group- and de-meaned versions of a
variable that can be used in regression analysis to model the between-
and within-subject effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">de_mean(x, ..., grp, append = TRUE, suffix.dm = "_dm", suffix.gm = "_gm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Names of variables that should be group- and de-meaned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>Quoted or unquoted name of the variable that indicates the
group- or cluster-ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>Logical, if <code>TRUE</code> (the default) and <code>x</code> is a data frame,
<code>x</code> including the new variables as additional columns is returned;
if <code>FALSE</code>, only the new variables are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix.dm, suffix.gm</code></td>
<td>
<p>String value, will be appended to the names of the
group-meaned and de-meaned variables of <code>x</code>. By default, de-meaned
variables will be suffixed with <code>"_dm"</code> and grouped-meaned variables
with <code>"_gm"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>de_mean()</code> is intended to create group- and de-meaned variables
for complex random-effect-within-between models (see <cite>Bell et al. 2018</cite>),
where group-effects (random effects) and fixed effects correlate (see
<cite>Bafumi and Gelman 2006)</cite>). This violation of one of the
<em>Gauss-Markov-assumptions</em> can happen, for instance, when analysing panel
data. To control for correlating predictors and group effects, it is
recommended to include the group-meaned and de-meaned version of
<em>time-varying covariates</em> in the model. By this, one can fit
complex multilevel models for panel data, including time-varying,
time-invariant predictors and random effects. This approach is superior to
simple fixed-effects models, which lack information of variation in the
group-effects or between-subject effects.
<br><br>
A description of how to translate the
formulas described in <em>Bell et al. 2018</em> into R using <code>lmer()</code>
from <span class="pkg">lme4</span> or <code>glmmTMB()</code> from <span class="pkg">glmmTMB</span> can be found here:
<a href="https://strengejacke.github.io/mixed-models-snippets/random-effects-within-between-effects-model.html">for lmer()</a>
and <a href="https://strengejacke.github.io/mixed-models-snippets/random-effects-within-between-effects-model-glmmtmb.html">for glmmTMB()</a>.
</p>


<h3>Value</h3>

<p>For <code>append = TRUE</code>, <code>x</code> including the group-/de-meaned
variables as new columns is returned; if <code>append = FALSE</code>, only the
group-/de-meaned variables will be returned.
</p>


<h3>References</h3>

<p>Bafumi J, Gelman A. 2006. Fitting Multilevel Models When Predictors and Group Effects Correlate. In. Philadelphia, PA: Annual meeting of the American Political Science Association.
<br><br>
Bell A, Fairbrother M, Jones K. 2018. Fixed and Random Effects Models: Making an Informed Choice. Quality &amp; Quantity. <a href="https://doi.org/10.1007/s11135-018-0802-x">doi:10.1007/s11135-018-0802-x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(efc)
efc$ID &lt;- sample(1:4, nrow(efc), replace = TRUE) # fake-ID
de_mean(efc, c12hour, barthtot, grp = ID, append = FALSE)
</code></pre>


</div>