<div class="container">

<table style="width: 100%;"><tr>
<td>ss2s4m</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Sizes in Two-Stage sampling Designs for Estimating Signle Means</h2>

<h3>Description</h3>

<p>This function computes a grid of possible sample sizes for estimating single means under two-stage sampling designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ss2s4m(N, mu, sigma, conf = 0.95, delta = 0.03, M, to = 20, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The population size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The value of the estimated mean of a variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The value of the estimated standard deviation of a variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of clusters in the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>(integer) maximum number of final units to be selected per cluster. By default <code>to = 20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The Intraclass Correlation Coefficient.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In two-stage (2S) sampling, the design effect is defined by
</p>
<p style="text-align: center;"><code class="reqn">DEFF = 1 + (m-1)\rho</code>
</p>
 
<p>Where <code class="reqn">\rho</code> is defined as the intraclass correlation coefficient,  
m is the average sample size of units selected inside each cluster. 
The relationship of the full sample size of the two stage design (2S) with the 
simple random sample (SI) design is given by
</p>
<p style="text-align: center;"><code class="reqn"> n_{2S} =  n_{SI}*DEFF</code>
</p>



<h3>Value</h3>

<p>This function returns a grid of possible sample sizes. 
The first column represent the design effect,
the second column is the number of clusters to be selected, 
the third column is the number of units to be selected inside the clusters, 
and finally, the last column indicates the full sample size induced by this particular strategy.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code>ICC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, rho=0.01)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, to=40, rho=0.1)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, to=40, rho=0.2)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.05, M=50, to=40, rho=0.3)

##########################################
# Almost same mean in each cluster       #
#                                        #
# - Heterogeneity within clusters        #
# - Homogeinity between clusters         #
#                                        #
#  Decision rule:                        #
#    * Select a lot of units per cluster #
#    * Select a few of clusters          #
##########################################

# Population size
N &lt;- 1000000
# Number of clusters in the population
M &lt;- 1000
# Number of elements per cluster
N/M

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- rep(1:M, length.out=N)

rho = ICC(y,cl)$ICC
rho

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)


##########################################
# Very different means per cluster       #
#                                        #
# - Heterogeneity between clusters       #
# - Homogeinity within clusters          #
#                                        #
#  Decision rule:                        #
#    * Select a few of units per cluster #
#    * Select a lot of clusters          #
##########################################

# Population size
N &lt;- 1000000
# Number of clusters in the population
M &lt;- 1000
# Number of elements per cluster
N/M

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- kronecker(c(1:M),rep(1,N/M))

rho = ICC(y,cl)$ICC
rho

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)

##########################
# Example with Lucy data #
##########################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
P &lt;- prop.table(table(SPAM))[1]
y &lt;- Income
cl &lt;- Segments

rho &lt;- ICC(y,cl)$ICC
M &lt;- length(levels(Segments))

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)

##########################
# Example with Lucy data #
##########################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
P &lt;- prop.table(table(SPAM))[1]
y &lt;- Years
cl &lt;- Segments

rho &lt;- ICC(y,cl)$ICC
M &lt;- length(levels(Segments))

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)
</code></pre>


</div>