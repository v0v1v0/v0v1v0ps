<div class="container">

<table style="width: 100%;"><tr>
<td>scam.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Newton-Raphson method to fit SCAM</h2>

<h3>Description</h3>

<p>This routine estimates SCAM coefficients given log smoothing parameters using the Newton-Raphson method.
The estimation of the smoothing parameters by the GCV/UBRE score optimization is outer to the model fitting. Routine 
<code>gcv.ubre_grad</code> evaluates the first derivatives of the smoothness selection scores with respect to the 
log smoothing parameters. Routine <code>bfgs_gcv.ubre</code> estimates the smoothing parameters using the BFGS method. 
</p>
<p>The function is not normally called directly, but rather service routines for <code>scam</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">scam.fit(G,sp, etastart=NULL, mustart=NULL, env=env, 
              null.coef=rep(0,ncol(G$X)), control=scam.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A list of items needed to fit a SCAM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>The vector of smoothing parameters.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>
<p>Initial values for the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>
<p>Initial values for the expected values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Get the enviroment for the model coefficients, their derivatives and the smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.coef</code></td>
<td>
<p>coefficients for a null model, needed for an ability to check for immediate divergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of fit control parameters returned by <code>scam.control</code>. It includes: <code>maxit</code>, a positive scalar which gives the maximum number of iterations for Newton's method; <code>devtol.fit</code>, a scalar giving the tolerance at which the relative penalized deviance is considered to be close enougth to 0 to terminate the algorithm;
<code>steptol.fit</code>, a scalar giving the tolerance at which the scaled distance between two successive iterates is considered close enough to zero to terminate the algorithm; 
<code>trace</code> turns on or off some de-bugging information;
<code>print.warn</code>, when set to <code>FALSE</code> turns off printing warning messages for step halving under non-finite exponentiated coefficients,  non-finite deviance and/or if <code>mu</code> or <code>eta</code> are out of bounds.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The routine applies step halving to any step that increases the
penalized deviance substantially.
</p>


<h3>Author(s)</h3>

<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>
<p>Wood, S.N. (2008) Fast stable direct fitting and smoothness selection for
generalized additive models. Journal of the Royal Statistical Society (B) 70(3):495-518
</p>
<p>Wood, S.N. (2011) Fast stable restricted maximum likelihood 
and marginal likelihood estimation of semiparametric generalized linear 
models. Journal of the Royal Statistical Society (B) 73(1):3-36
</p>


<h3>See Also</h3>

<p><code>scam</code></p>


</div>