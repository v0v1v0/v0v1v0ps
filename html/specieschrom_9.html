<div class="container">

<table style="width: 100%;"><tr>
<td>opti_eury_niche2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimums and amplitudes estimations along each niche dimension.</h2>

<h3>Description</h3>

<p>Function that estimates niche optimums and amplitudes along each environmental variable and for each species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opti_eury_niche2(sp_chr, Thres_T, z, y, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sp_chr</code></td>
<td>
<p>a matrix with the species chromatograms (categories by environmental variables by species). Outputs of 'chromato_env16.R'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Thres_T</code></td>
<td>
<p>an integer corresponding to the min abundance threshold for niche amplitudes estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a matrix with n samples by p environmental variables (i.e. the value of each environmental variable in each sample). Same matrix as in 'chromato_env16.R'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a matrix with the species abundance in the n samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>an integer corresponding to the percentage of samples with the highest abundance values to use to estimate the mean abundance in a given category. Should have the same value as in 'chromato_env16.R'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Three matrices are returned:
</p>
<p>amplitudes, a matrix with the degree of euryoecie (niche breadth) of each species (in column) along each environmental dimension (in line)
</p>
<p>mean_amplitudes, a matrix with the mean degree of euryoecie of each species
</p>
<p>optimums, a matrix with the niche optimum values of each species (in column) along each environmental dimension (in line)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the example datasets
data("data_abundance")
data("environment")
# Characterise and display the ecological niche of 2 pseudo-species
# `alpha`=50 categories, `m`=1 sample, `k`=5 and `order_smth`=2
sp_chrom_PS3&lt;-chromato_env16(environment,data_abundance[,3],50,1,5,2)
sp_chrom_PS8&lt;-chromato_env16(environment,data_abundance[,8],50,1,5,2)
# Combine the species chromatograms along a third dimension with `abind`
library(abind)
test_PS&lt;-abind::abind(sp_chrom_PS3,sp_chrom_PS8,along=3)
# `opti_eury_niche2.R` can then be applied, with `Thres_T`=0 and `k`=5
opti_ampli_niche&lt;-opti_eury_niche2(test_PS,0,environment,data_abundance[,c(3,8)],5)
</code></pre>


</div>