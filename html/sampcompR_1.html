<div class="container">

<table style="width: 100%;"><tr>
<td>biv_compare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare Multiple Data Frames on a Bivariate Level</h2>

<h3>Description</h3>

<p>Compare multiple data frames on a bivariate level and plot them together.
</p>


<h3>Usage</h3>

<pre><code class="language-R">biv_compare(
  dfs,
  benchmarks,
  variables = NULL,
  corrtype = "r",
  data = TRUE,
  id = NULL,
  weight = NULL,
  strata = NULL,
  id_bench = NULL,
  weight_bench = NULL,
  strata_bench = NULL,
  p_value = NULL,
  p_adjust = NULL,
  varlabels = NULL,
  plot_title = NULL,
  plots_label = NULL,
  diff_perc = TRUE,
  diff_perc_size = 4.5,
  perc_diff_transparance = 0,
  note = FALSE,
  order = NULL,
  breaks = NULL,
  colors = NULL,
  mar = c(0, 0, 0, 0),
  grid = "white",
  gradient = FALSE,
  sum_weights = NULL,
  missings_x = TRUE,
  remove_nas = "pairwise",
  ncol_facet = 3,
  nboots = 0,
  parallel = FALSE,
  adjustment_weighting = "raking",
  adjustment_vars = NULL,
  raking_targets = NULL,
  post_targets = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfs</code></td>
<td>
<p>A character vector containing the names of data frames to compare
against the <code>benchmarks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>benchmarks</code></td>
<td>
<p>A character vector containing the names of benchmarks to
compare the <code>dfs</code> against, or the names of a list. If it is a list, it
has to be of the form, as the output of rcorr, with a
Pearson's r matrix in the first position, a n-matrix (matrix of n for every
correlation) in the second position and a p-matrix in the third position.
The vector must either be the same length as <code>dfs</code>, or length 1. If it
has length one every survey will be compared against the same benchmark.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>A character vector that containes the names of the variables for
the comparison. If it is <code>NULL</code>, all variables that are named similarly
in both the <code>dfs</code> and the benchmarks will be compared. Variables missing
in one of the <code>dfs</code> or the <code>benchmarks</code> will be neglected for this
comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrtype</code></td>
<td>
<p>A character string, indicating the type of the bivariate correlation.
It can either be "r" for Pearson's r or "rho" for Spearman's "rho". At the moment,
rho is only applicable to unweighted data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If <code>TRUE</code>, a biv_compare object is returned, containing the results
of the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata, strata_bench</code></td>
<td>
<p>A character vector that determines strata variables
that are used to weigh the <code>dfs</code> or <code>benchmarks</code> with the help of
the <code>survey</code> package. It has to be part of the respective data frame.
If fewer characters strings are provided, than in <code>dfs</code>, the first input
is used to weigh every df or benchmark, where no input is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_bench, id</code></td>
<td>
<p>A character vector determining id variables used to weigh
the <code>dfs</code> or <code>benchmarks</code> with the help of the <code>survey</code> package. They have
to be part of the respective data frame. If less characters strings are provided,
than in <code>dfs</code>, the first input is used to weigh every <code>df</code> or
<code>benchmark</code>, where no input is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_bench, weight</code></td>
<td>
<p>A character vector that determines variables to weigh
the <code>dfs</code> of <code>benchmarks</code>. They have to be part of the respective
data frame. If fewer characters strings are provided, than in <code>dfs</code>,
the first input is used to weigh every df or benchmark, where no input is
provided. If a weight variable is provided also an id variable is needed.
For weighting, the <code>survey</code> package is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value</code></td>
<td>
<p>A number between zero and one to determine the maximum significance niveau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_adjust</code></td>
<td>
<p>Can be either <code>TRUE</code> or a character string indicating an
adjustment method. If <code>p_adjust = TRUE</code> the p_values will be adjusted with the
Bonferroni adjustment method, by default, to account for the problem of
multiple comparisons. All adjustment methods available in
<code>p.adjust</code> can be used here, with the same character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varlabels</code></td>
<td>
<p>A character string or vector of character strings containing
the new names of variables that is used in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>A character string containing the title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots_label</code></td>
<td>
<p>A character string or vector of character strings
containing the new names of the data frames that are used in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff_perc</code></td>
<td>
<p>If <code>TRUE</code> a percental difference between surveys and benchmarks is
displayed in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff_perc_size</code></td>
<td>
<p>A number to determine the size of the displayed percental
difference between surveys in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc_diff_transparance</code></td>
<td>
<p>A number to determine the transparency of the displayed
percental difference between surveys in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>note</code></td>
<td>
<p>If <code>note = TRUE</code>, a note will be displayed to describe the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A character vector to determine in which order the variables should be
displayed in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A vector to label the color scheme in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>A vector to determine the colors in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>A vector that determines the margins of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>A color string, that determines the color of the lines between
the tiles of the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>If <code>gradient = TRUE</code>, colors in the heatmap will be more
or less transparent, depending on the difference in Pearson's r of the data
frames of comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_weights</code></td>
<td>
<p>A vector containing information for every variable to
weigh them in the displayed percental-difference calculation. It can be used
if some variables are over- or underrepresented in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missings_x</code></td>
<td>
<p>If <code>TRUE</code>, missing pairs in the plot will be marked with an X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_nas</code></td>
<td>
<p>A character string, that indicates how missing values should be
removed, can either be <code>"all"</code>, to remove all cases that contain NA in any
of the variables, or <code>"pairwise"</code>, to remove NAs separately for every variable
pair when calculating Pearson's r.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol_facet</code></td>
<td>
<p>The number of columns used in faced_wrap() for the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboots</code></td>
<td>
<p>A numeric value indicating the number of bootstrap replications.
If <code>nboots = 0</code> no bootstrapping will be performed. Else <code>nboots</code>
must be &gt;2. Note, that bootstrapping can be very computationally heavy and can
therefore take a while.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Can be either <code>FALSE</code> or a number of cores that should
be used in the function. If it is <code>FALSE</code>, only one core will be used and
otherwise the given number of cores will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment_weighting</code></td>
<td>
<p>A character vector indicating if adjustment
weighting should be used. It can either be <code>"raking"</code> or <code>"post_start"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment_vars</code></td>
<td>
<p>Variables used to adjust the survey when using raking
or post-stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raking_targets</code></td>
<td>
<p>A list of raking targets that can be given to the rake
function of <code>rake</code>, to rake the <code>dfs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_targets</code></td>
<td>
<p>A list of post_stratification targets that can be given to
the <code>postStratify</code> function, to post-stratify the <code>dfs</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot shows a heatmap of a correlation matrix, where the colors are determined by
the similarity of the Pearson's r values in both sets of respondents. Leaving
default breaks and colors,
</p>

<ul>
<li> <p><code>Same</code> (green) indicates, that the Pearson's r correlation is not significant &gt; 0 in
the related data frame or benchmark or the Pearson's r correlations are not significantly
different, between data frame and benchmark.
</p>
</li>
<li> <p><code>Small Diff</code> (yellow) indicates that the Pearson's r
correlation is significant &gt; 0 in the related data frame or benchmark and the Pearson's r
correlations are significantly different, between data frame and benchmark.
</p>
</li>
<li> <p><code>Large Diff</code> (red) indicates, that the same conditions of yellow are fulfilled, and
the correlations are either in opposite directions,or one is double the size of the other.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A object generated with the help of <code>ggplot2::ggplot2()</code> visualizes
the differences between the data frames and benchmarks. If <code>data = TRUE</code>
instead of the plot a list will be returned containing information of the
analyses. This <code>biv_compare</code> object can be used in
<code>plot_biv_compare</code> to build a plot, or in <code>biv_compare_table</code>,
to get a table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Get Data for comparison
require(wooldridge)
card&lt;-wooldridge::card

south &lt;- card[card$south==1,]
north &lt;- card[card$south==0,]
black &lt;- card[card$black==1,]
white &lt;- card[card$black==0,]

## use the function to plot the data 
bivar_comp&lt;-sampcompR::biv_compare(dfs = c("north","white"),
                                   benchmarks = c("south","black"),
                                   variables= c("age","educ","fatheduc","motheduc","wage","IQ"),
                                   data=FALSE)
bivar_comp


</code></pre>


</div>