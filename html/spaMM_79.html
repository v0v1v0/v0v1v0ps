<div class="container">

<table style="width: 100%;"><tr>
<td>confint.HLfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence intervals
</h2>

<h3>Description</h3>

<p>This function interfaces two procedures: a profile confidence interval procedure implemented for fixed-effects coefficients only; and a parametric bootstrap procedure that can be used to provide confidence interval for any parameter, whether a canonical parameter of the model or any function of one or several such parameters. 
The bootstrap is performed if the <code>parm</code> argument is a function or a quoted expression or if the <code>boot_args</code> argument is a list. The profile confidence interval is computed if neither of these conditions is true. In that case <code>parm</code> must be the name(s) of some <b>fixed-effect</b> coefficient, and the (<code>p_v</code> approximation of the) profile likelihood ratio for the given parameter is used to define the interval, where the profiling is over all other fitted parameters, including other fixed-effects coefficients, as well as variances of random effects and spatial correlations if these were fitted. 
</p>
<p>Of related interest, see <code>numInfo</code> which evaluates numerically the information matrix for given sets of canonical model parameters, from which asymptotic confidence intervals can be deduced.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'HLfit'
confint(object, parm, level=0.95, verbose=TRUE, 
                          boot_args=NULL, format="default", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>HLfit</code>, as returned by the fitting functions in <code>spaMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>character vector, integer vector, or function, or a quoted expression. If <b>character</b>, the name(s) of parameter(s) to be fitted; if <b>integer</b>, their position in the <code>fixef(object)</code> vector. Valid names are those of this vector. If a <b>function</b>, it must return a (vector of) parameter estimate(s) from a fit object. If a <b>quoted expression</b>, it must likewise extract parameter estimate(s) from a fit object; this expression must refer to the fitted object as ‘hlfit’ (see Examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The coverage of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether to print the interval or not. As the function returns its more extensive results invisibly, 
this printing is the only visible output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot_args</code></td>
<td>
<p>NULL or a list of arguments passed to functions <code>spaMM_boot</code> and <code>boot.ci</code>. It must contain element <code>nsim</code> (for <code>spaMM_boot</code>). The <code>type</code> argument of <code>boot.ci</code> can only be given as element <code>ci_type</code>, to avoid conflict with the <code>type</code> argument of <code>spaMM_boot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>Only effective non-default value is <code>"stats"</code> to return results in the format of the <code>stats::confint</code> result (see Value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (maybe not used, but conforming to the generic definition of <code>confint</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The format of the value varies, but in all cases distinguished below, one or more tables are included, as a <code>table</code> attribute, in the format of the <code>stats::confint</code> result, to facilitate consistent extraction of results. By default <code>confint</code> returns invisibly the full values described below, but if <code>format="stats"</code>, only the <code>table</code> attribute is returned. 
</p>
<p>If a profile CI has been computed for a single parameter, a list is returned including the confidence <code>interval</code> as shown by <code>verbose=TRUE</code>, and the fits <code>lowerfit</code> and <code>upperfit</code> giving the profile fits at the confidence bounds. This list bears the <code>table</code> attribute. 
</p>
<p>If a profile CI has been computed for several parameters, a structured list, named according to the parameter names, of such single-parameter results is returned, and a single <code>table</code> attribute for all parameters is attached to the upper level of the list. 
</p>
<p>If a bootstrap was performed, for a single parameter the result of the <code>boot.ci</code> call is returned, to which a <code>table</code> attribute is added. This <code>table</code> is now a list of tables for the different bootstrap CI types (default being <code>normal</code>, <code>percent</code>, and <code>basic</code>), each such table in the format of the <code>stats::confint</code> results. For several parameters, a named list of <code>boot.ci</code> results is returned, its names being the parameter names, and the <code>table</code> attribute is attached to the upper level of the list. 
</p>
<p>The <code>boot.ci</code> return value for each parameter includes the call to <code>boot.ci</code>. This call is typically shown including a long <code>t</code> vector, which makes a bulky display. spaMM hacks the printing to abbreviate long <code>t</code>s.
</p>


<h3>See Also</h3>

<p><code>numInfo</code> for information matrix.</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("wafers")
wfit &lt;- HLfit(y ~X1+(1|batch), family=Gamma(log), data=wafers, method="ML")
confint(wfit,"X1")  # profile CI
if (spaMM.getOption("example_maxtime")&gt;30) {
   
   # bootstrap CI induced by 'boot_args':
   confint(wfit,names(fixef(wfit)), boot_args=list(nsim=99, seed=123)) 
   
   # bootstrap CI induced by 'parm' being a function:
   confint(wfit,parm=function(v) fixef(v), 
           boot_args=list(nb_cores=10, nsim=199, seed=123))
   
   # Same effect if 'parm' is a quoted expression in terms of 'hlfit':
   confint(wfit,parm=quote(fixef(hlfit)), 
           boot_args=list(nb_cores=10, nsim=199, seed=123))
           
   # CI for the variance of the random effect:          
   ci &lt;- confint(wfit,parm=function(fit){get_ranPars(fit)$lambda[1]}, 
        boot_args=list(nb_cores=10, nsim=199, seed=123))
   # The distribution of bootstrap replicates:
   plot(ecdf(ci$call$t))
   # We may be far from ideal condition for accuracy of bootstrap intervals;
   # for variances, a log transformation may sometimes help, but not here.
   
   # Passing arguments to child processes, as documented in help("spaMM_boot"):
   set.seed(123)
   rvar &lt;- runif(nrow(wafers))
   wrfit &lt;- fitme(y ~X1+(1|batch), family=Gamma(log), data=wafers, fixed=list(phi=rvar))
   confint(wrfit, parm = "(Intercept)", boot_args = list(nsim = 100, nb_cores = 2,
           fit_env = list(rvar=rvar)))
   
}
</code></pre>


</div>