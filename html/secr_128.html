<div class="container">

<table style="width: 100%;"><tr>
<td>fxi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Probability Density of Activity Centre </h2>

<h3>Description</h3>

<p>Display contours of the probability density function for the estimated
location of one or more activity centres (AC), compute values for
particular points X, or compute mode of pdf. The pdf is given by
<code class="reqn">f(X_j|\omega_i) = \mbox{Pr}(\omega_i|X_j)\pi(X_j)</code>, where <code class="reqn">\pi(X)</code> is the probability density
of range centres across the mask (Borchers and Efford 2008).
</p>
<p>These functions were previously named <code>fxi.secr</code>, <code>fxi.contour</code> and <code>fxi.mode</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'secr'
fxi(object, i = NULL, sessnum = 1, X = NULL, ncores = NULL, ...)

fxiContour (object, i = 1, sessnum = 1, border = 100, nx = 64,
    levels = NULL, p = seq(0.1,0.9,0.1), plt = TRUE, add = FALSE,
    fitmode = FALSE, plotmode = FALSE, fill = NULL,
    output = c('list','sf','SPDF'), ncores = NULL, ...)

fxiMode(object, i = 1, sessnum = 1, start = NULL, ncores = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> a fitted secr model </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p> integer or character vector of individuals (defaults to all in <code>fxi</code>),
or a single individual as input to fxiMode </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sessnum</code></td>
<td>
<p> session number if <code>object$capthist</code> spans
multiple sessions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p> width of blank margin around the outermost detectors </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p> dimension of interpolation grid in x-direction </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p> numeric vector of confidence levels for Pr(X|wi)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> numeric vector of contour levels as probabilities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p>logical to plot contours</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical to add contour(s) to an existing plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitmode</code></td>
<td>
<p>logical to refine estimate of mode of each pdf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotmode</code></td>
<td>
<p>logical to plot mode of each pdf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>2-column matrix of x- and y- coordinates (defaults to mask)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p> vector of colours to fill contours (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p> character; format of output (list, sf or SpatialPolygonsDataFrame)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p> integer number of threadss to be used for parallel processing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p> vector of x-y coordinates for maximization </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>contour</code> or <code>nlm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fxiContour</code> computes contours of AC probability density for one
or more detection histories. Increase <code>nx</code> for smoother
contours. If <code>levels</code> is not set, contour levels are set
to approximate the confidence levels in <code>p</code>.
</p>
<p><code>fxi</code> computes the AC probability density for one or more
detection histories; <code>X</code> may contain coordinates for one or
several points; a dataframe or vector (x then y) will be coerced to a
matrix.
</p>
<p><code>fxiMode</code> attempts to find the x- and y-coordinates
corresponding to the maximum of the AC pdf for a single detection history
(i.e. <code>i</code> is of length 1). <code>fxiMode</code> calls
<code>nlm</code>.
</p>
<p><code>fxiContour</code> with <code>fitmode = TRUE</code> calls <code>fxiMode</code>
for each individual. Otherwise, the reported mode is an approximation
(mean of coordinates of highest contour).
</p>
<p>If <code>i</code> is character it will be matched to row names of
object$capthist (restricted to the relevant session in the case of a
multi-session fit); otherwise it will be interpreted as a row number.
</p>
<p>Values of the pdf are normalised by dividing by the
integral of <code class="reqn">\mbox{Pr}(\omega_i|X)\pi(X)</code>
over the habitat mask in <code>object</code>. (In secr &gt;= 4.0 may differ from previous versions).
</p>
<p>Setting <code>ncores = NULL</code> uses the existing value from the environment variable 
RCPP_PARALLEL_NUM_THREADS (see <code>setNumThreads</code>).
</p>
<p>If <code>start</code> is not provided to <code>fit.mode</code> then (from 2.9.4) the weighted mean of 
all detector sites is used (see Warning below).
</p>
<p>The ... argument gives additional control over a contour plot; for
example, set <code>drawlabels = FALSE</code> to suppress contour labels.
</p>


<h3>Value</h3>

<p><code>fxi</code> –
</p>
<p>Vector of probability densities
</p>
<p><code>fxiContour</code> (output = 'list') –
</p>
<p>Coordinates of the plotted contours are returned as a list with one
component per polygon. The list is returned invisibly if plt = TRUE.
</p>
<p>An additional component ‘mode’ reports the x-y coordinates of the
highest point of each pdf (see Details).
</p>
<p><code>fxiContour</code> (output = 'SPDF') –
</p>
<p>Contours are returned as a SpatialPolygonsDataFrame (see package
<span class="pkg">sp</span>) with one component per animal. The attributes dataframe has two columns, the x-
and y-coordinates of the mode. The SpatialPolygonsDataFrame is returned
invisibly if plt = TRUE.
</p>
<p><code>fxiContour</code> (output = 'sf') – simple features 'sf' object, as for SPDF.
</p>
<p><code>fxiMode</code> –
</p>
<p>List with components ‘x’ and ‘y’
</p>


<h3>Warnings</h3>

<p><code>fxiMode</code> may fail to find the true mode unless a good starting
point is provided. Note that the distribution may have multiple modes and 
only one is reported. The default value of <code>start</code> before <span class="pkg">secr</span> 2.9.4 
was the first detected location of the animal. 
</p>


<h3>Note</h3>

<p>From <span class="pkg">secr</span> 2.8.3, these functions work with both homogeneous
and inhomogeneous Poisson density models, and <code>fxi</code> accepts
vector-valued <code>i</code>.
</p>
<p>See <code>fxTotal</code> for a surface summed across individuals.
</p>


<h3>References</h3>

<p>Borchers, D. L. and Efford, M. G. (2008) Spatially explicit maximum
likelihood methods for capture–recapture studies. <em>Biometrics</em>
<b>64</b>, 377–385.
</p>


<h3>See Also</h3>

<p><code>pdotContour</code>, <code>contour</code>, <code>fxTotal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

fxi(secrdemo.0, i = 1, X = c(365,605))

## contour first 5 detection histories
plot(secrdemo.0$capthist)
fxiContour (secrdemo.0, i = 1:5, add = TRUE,
    plotmode = TRUE, drawlabels = FALSE)

## extract modes only
## these are more reliable than those from fit.mode called directly as
## they use a contour-based approximation for the starting point
fxiout &lt;- fxiContour (secrdemo.0, i = 1:5, plt = FALSE, fitmode = TRUE)
t(sapply(fxiout, "[[", "mode"))

## using fill colours
## lty = 0 suppresses contour lines
## nx = 256 ensures smooth outline
plot(traps(captdata))
fxiContour(secrdemo.0, i = 1:5, add = TRUE, p = c(0.5,0.95), drawlabels
    = FALSE, nx = 256, fill = topo.colors(4), lty = 0)

## output as simple features
sf &lt;- fxiContour(secrdemo.0, i = 1:3, plt = FALSE, p = c(0.5,0.95),
    nx = 256, output = 'sf', fitmode = TRUE)

## save as ESRI shapefile testsf.shp etc.
library(sf)
st_write(sf, 'testsf.shp')
## plot contours and modes
plot(st_as_sfc(sf))    # outline only
points(sf$modex, sf$modey)

## output as SpatialPolygonsDataFrame
spdf &lt;- fxiContour(secrdemo.0, i = 1:3, plt = FALSE, p = c(0.5,0.95),
    nx = 256, output = 'SPDF', fitmode = TRUE)
sp::plot(spdf)
points(data.frame(spdf))


## End(Not run)

</code></pre>


</div>