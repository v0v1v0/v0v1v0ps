<div class="container">

<table style="width: 100%;"><tr>
<td>pval_srmsd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Signed RMSD measure of null p-value uniformity</h2>

<h3>Description</h3>

<p>Quantifies null p-value uniformity by computing the RMSD (root mean square deviation) between the sorted observed null (truly non-causal) p-values and their expected quantiles under a uniform distribution.
Meant as a more robust alternative to the "inflation factor" common in the GWAS literature, which compares median values only and uses all p-values (not just null p-values).
Our signed RMSD, to correspond with the inflation factor, includes a sign that depends on the median null p-value:
positive if this median is <code style="white-space: pre;">⁠&lt;= 0.5⁠</code> (corresponds with test statistic inflation), negative otherwise (test statistic deflation).
Zero corresponds to uniform null p-values, which arises in expectation only if test statistics have their assumed null distribution (there is no misspecification, including inflation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pval_srmsd(pvals, causal_indexes, detailed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>The vector of association p-values to analyze.
This function assumes all p-values are provided (a mix of null and alternative tests).
<code>NA</code> values are allowed in input and removed.
Non-<code>NA</code> values outside of [0, 1] will trigger an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causal_indexes</code></td>
<td>
<p>The vector of causal indexes, whose p-values will be omitted.
Values of <code>causal_indexes</code> as returned by <code>sim_trait</code> work.
This parameter is required to prevent use of this function except when the true status of every test (null vs alternative) is known.
Set to <code>NULL</code> if all loci are truly null (non-causal).
Otherwise, <code>causal_indexes</code> must have at least one causal index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detailed</code></td>
<td>
<p>If <code>FALSE</code> (default) only SRMSD is returned.
If <code>TRUE</code>, sorted null p-values without NAs and their expectations are returned (useful for plots).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>detailed</code> is <code>FALSE</code>, returns the signed RMSD between the observed p-value order statistics and their expectation under true uniformity.
If <code>detailed</code> is <code>TRUE</code>, returns data useful for plots, a named list containing:
</p>

<ul>
<li> <p><code>srmsd</code>: The signed RMSD between the observed p-value order statistics and their expectation under true uniformity.
</p>
</li>
<li> <p><code>pvals_null</code>: Sorted null p-values (observed order statistics).  If any input null p-values were <code>NA</code>, these have been removed here (removed by <code>sort()</code>).
</p>
</li>
<li> <p><code>pvals_unif</code>: Expected order statistics assuming uniform distribution, same length as <code>pvals_null</code>.
</p>
</li>
</ul>
<p>If the input <code>pvals</code> is <code>NULL</code> (taken for case of singular association test, which is rare but may happen), then the returned value is <code>NA</code> if <code>detailed</code> was <code>FALSE</code>, or otherwise the list contains <code>NA</code>, <code>NULL</code> and <code>NULL</code> for the above three items.
</p>


<h3>See Also</h3>

<p><code>rmsd()</code> for the generic root-mean-square deviation function.
</p>
<p><code>pval_infl()</code> for the more traditional inflation factor, which focuses on the median of the full distribution (combination of causal and null cases).
</p>
<p><code>pval_type_1_err()</code> for classical type I error rate estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate truly null p-values, which should be uniform
pvals &lt;- runif(10)
# for toy example, take the first p-value to be truly causal (will be ignored below)
causal_indexes &lt;- 1
# calculate desired measure
pval_srmsd( pvals, causal_indexes )

</code></pre>


</div>