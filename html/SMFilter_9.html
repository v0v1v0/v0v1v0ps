<div class="container">

<table style="width: 100%;"><tr>
<td>SimModel2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate from the type two state-space Model on Stiefel manifold.</h2>

<h3>Description</h3>

<p>This function simulates from the type two model on Stiefel manifold.
See Details part below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimModel2(iT, mX = NULL, mZ = NULL, mY = NULL, beta_0, alpha,
  mB = NULL, Omega = NULL, vD, burnin = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iT</code></td>
<td>
<p>the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mX</code></td>
<td>
<p>the matrix containing X_t with dimension <code class="reqn">T \times q_1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mZ</code></td>
<td>
<p>the matrix containing Z_t with dimension <code class="reqn">T \times q_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mY</code></td>
<td>
<p>initial values of the dependent variable for <code>ik-1</code> up to 0. If <code>mY = NULL</code>, then no lagged dependent variables in regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_0</code></td>
<td>
<p>the initial beta, iqx+ip*ik, y_1,t-1,y_1,t-2,...,y_2,t-1,y_2,t-2,....</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the <code class="reqn">\alpha</code> matrix, <code class="reqn">p \times r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mB</code></td>
<td>
<p>the coefficient matrix <code class="reqn">\boldsymbol{B}</code> before <code>mZ</code> with dimension <code class="reqn">p \times q_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>covariance matrix of the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vD</code></td>
<td>
<p>vector of the diagonals of <code class="reqn">D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>burn-in sample size (matrix Langevin).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The type two model on Stiefel manifold takes the form:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_t \quad = \quad \boldsymbol{\alpha} \boldsymbol{\beta}_t ' \boldsymbol{x}_t + \boldsymbol{B}' \boldsymbol{z}_t + \boldsymbol{\varepsilon}_t</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{\beta}_{t+1} | \boldsymbol{\beta}_{t} \quad \sim \quad ML (q_1, r, \boldsymbol{\beta}_{t} \boldsymbol{D})</code>
</p>

<p>where <code class="reqn">\boldsymbol{y}_t</code> is a <code class="reqn">p</code>-vector of the dependent variable,
<code class="reqn">\boldsymbol{x}_t</code> and <code class="reqn">\boldsymbol{z}_t</code> are explanatory variables wit dimension <code class="reqn">q_1</code> and <code class="reqn">q_2</code>,
<code class="reqn">\boldsymbol{x}_t</code> and <code class="reqn">\boldsymbol{z}_t</code> have no overlap,
matrix <code class="reqn">\boldsymbol{B}</code> is the coefficients for <code class="reqn">\boldsymbol{z}_t</code>,
<code class="reqn">\boldsymbol{\varepsilon}_t</code> is the error vector.
</p>
<p>The matrices <code class="reqn">\boldsymbol{\alpha}</code> and <code class="reqn">\boldsymbol{\beta}_t</code> have dimensions <code class="reqn">p \times r</code> and <code class="reqn">q_1 \times r</code>, respectively.
Note that <code class="reqn">r</code> is strictly smaller than both <code class="reqn">p</code> and <code class="reqn">q_1</code>.
<code class="reqn">\boldsymbol{\alpha}</code> and <code class="reqn">\boldsymbol{\beta}_t</code> are both non-singular matrices.
<code class="reqn">\boldsymbol{\beta}_t</code> is time-varying while <code class="reqn">\boldsymbol{\alpha}</code> is time-invariant.
</p>
<p>Furthermore, <code class="reqn">\boldsymbol{\beta}_t</code> fulfills the condition <code class="reqn">\boldsymbol{\beta}_t' \boldsymbol{\beta}_t = \boldsymbol{I}_r</code>,
and therefor it evolves on the Stiefel manifold.
</p>
<p><code class="reqn">ML (p, r, \boldsymbol{\beta}_t \boldsymbol{D})</code> denotes the Matrix Langevin distribution or matrix von Mises-Fisher distribution on the Stiefel manifold.
Its density function takes the form
</p>
<p style="text-align: center;"><code class="reqn">f(\boldsymbol{\beta_{t+1}} ) = \frac{ \mathrm{etr} \left\{ \boldsymbol{D} \boldsymbol{\beta}_{t}' \boldsymbol{\beta_{t+1}} \right\} }{ _{0}F_1 (\frac{p}{2}; \frac{1}{4}\boldsymbol{D}^2 ) }</code>
</p>

<p>where <code class="reqn">\mathrm{etr}</code> denotes <code class="reqn">\mathrm{exp}(\mathrm{tr}())</code>,
and <code class="reqn">_{0}F_1 (\frac{p}{2}; \frac{1}{4}\boldsymbol{D}^2 )</code> is the (0,1)-type hypergeometric function for matrix.
</p>
<p>Note that the function does not add intercept automatically.
</p>


<h3>Value</h3>

<p>A list containing the sampled data and the dynamics of beta.
</p>
<p>The object is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dData</code></td>
<td>
<p>a data.frame of the sampled data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aBeta</code></td>
<td>
<p>an array of the <code class="reqn">\boldsymbol{\beta}_t</code> with the dimension <code class="reqn">T \times q_1 \times r</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yukai Yang, <a href="mailto:yukai.yang@statistik.uu.se">yukai.yang@statistik.uu.se</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
iT = 50
ip = 2
ir = 1
iqx =3
iqz=2
ik = 1

if(iqx==0) mX=NULL else mX = matrix(rnorm(iT*iqx),iT, iqx)
if(iqz==0) mZ=NULL else mZ = matrix(rnorm(iT*iqz),iT, iqz)
if(ik==0) mY=NULL else mY = matrix(0, ik, ip)

alpha = matrix(c(runif_sm(num=1,ip=ip,ir=ir)), ip, ir)
beta_0 = matrix(c(runif_sm(num=1,ip=ip*ik+iqx,ir=ir)), ip*ik+iqx, ir)
if(ip*ik+iqz==0) mB=NULL else mB = matrix(c(runif_sm(num=1,ip=(ip*ik+iqz)*ip,ir=1)), ip, ip*ik+iqz)
vD = 50

ret = SimModel2(iT=iT, mX=mX, mZ=mZ, mY=mY, alpha=alpha, beta_0=beta_0, mB=mB, vD=vD)

</code></pre>


</div>