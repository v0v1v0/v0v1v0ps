<div class="container">

<table style="width: 100%;"><tr>
<td>linearHypothesis.systemfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test Linear Hypothesis</h2>

<h3>Description</h3>

<p>Testing linear hypothesis on the coefficients of a system of equations
by an F-test or Wald-test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">   ## S3 method for class 'systemfit'
linearHypothesis( model,
      hypothesis.matrix, rhs = NULL, test = c( "FT", "F", "Chisq" ),
      vcov. = NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted object of type <code>systemfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis.matrix</code></td>
<td>
<p>matrix (or vector) giving linear combinations
of coefficients by rows,
or a character vector giving the hypothesis in symbolic form
(see documentation of <code>linearHypothesis</code>
in package "car" for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>optional right-hand-side vector for hypothesis,
with as many entries as rows in the hypothesis matrix;
if omitted, it defaults to a vector of zeroes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>character string, "<code>FT</code>", "<code>F</code>", or "<code>Chisq</code>",
specifying whether to compute
Theil's finite-sample F test (with approximate F distribution),
the finite-sample Wald test (with approximate F distribution),
or the large-sample Wald test
(with asymptotic Chi-squared distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.</code></td>
<td>
<p>a function for estimating the covariance matrix
of the regression coefficients or an estimated covariance matrix
(function <code>vcov</code> is used by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to
<code>linearHypothesis.default</code> (package "car").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Theil's <code class="reqn">F</code> statistic for sytems of equations is
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{
      ( R \hat{b} - q )'
      ( R ( X' ( \Sigma \otimes I )^{-1} X )^{-1} R' )^{-1}
      ( R \hat{b} - q ) /
      j
   }{
      \hat{e}' ( \Sigma \otimes I )^{-1} \hat{e} /
      ( M \cdot T - K )
   } </code>
</p>

<p>where <code class="reqn">j</code> is the number of restrictions,
<code class="reqn">M</code> is the number of equations,
<code class="reqn">T</code> is the number of observations per equation,
<code class="reqn">K</code> is the total number of estimated coefficients, and
<code class="reqn">\Sigma</code> is the estimated residual covariance matrix.
Under the null hypothesis, <code class="reqn">F</code> has an approximate <code class="reqn">F</code> distribution
with <code class="reqn">j</code> and <code class="reqn">M \cdot T - K</code> degrees of freedom
(Theil, 1971, p. 314).
</p>
<p>The <code class="reqn">F</code> statistic for a Wald test is
</p>
<p style="text-align: center;"><code class="reqn"> F = \frac{
      ( R \hat{b} - q )'
      ( R \, \widehat{Cov} [ \hat{b} ] R' )^{-1}
      ( R \hat{b} - q )
   }{
      j
   } </code>
</p>

<p>Under the null hypothesis, <code class="reqn">F</code> has an approximate <code class="reqn">F</code> distribution
with <code class="reqn">j</code> and <code class="reqn">M \cdot T - K</code> degrees of freedom
(Greene, 2003, p. 346).
</p>
<p>The <code class="reqn">\chi^2</code> statistic for a Wald test is
</p>
<p style="text-align: center;"><code class="reqn"> W =
      ( R \hat{b} - q )'
      ( R \widehat{Cov} [ \hat{b} ] R' )^{-1}
      ( R \hat{b} - q )
   </code>
</p>

<p>Asymptotically, <code class="reqn">W</code> has a <code class="reqn">\chi^2</code>
distribution with <code class="reqn">j</code> degrees of freedom
under the null hypothesis
(Greene, 2003, p. 347).
</p>


<h3>Value</h3>

<p>An object of class <code>anova</code>,
which contains the residual degrees of freedom in the model,
the difference in degrees of freedom,
the test statistic (either F or Wald/Chisq)
and the corresponding p value.
See documentation of <code>linearHypothesis</code>
in package "car".
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>References</h3>

<p>Greene, W. H. (2003)
<em>Econometric Analysis, Fifth Edition</em>, Prentice Hall.
</p>
<p>Theil, Henri (1971)
<em>Principles of Econometrics</em>, John Wiley &amp; Sons, New York.
</p>


<h3>See Also</h3>

<p><code>systemfit</code>, <code>linearHypothesis</code>
(package "car"),
<code>lrtest.systemfit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## unconstrained SUR estimation
fitsur &lt;- systemfit( system, method = "SUR", data=Kmenta )

# create hypothesis matrix to test whether beta_2 = \beta_6
R1 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R1[ 1, 2 ] &lt;- 1
R1[ 1, 6 ] &lt;- -1
# the same hypothesis in symbolic form
restrict1 &lt;- "demand_price - supply_farmPrice = 0"

## perform Theil's F test
linearHypothesis( fitsur, R1 )  # rejected
linearHypothesis( fitsur, restrict1 )

## perform Wald test with F statistic
linearHypothesis( fitsur, R1, test = "F" )  # rejected
linearHypothesis( fitsur, restrict1 )

## perform Wald-test with chi^2 statistic
linearHypothesis( fitsur, R1, test = "Chisq" )  # rejected
linearHypothesis( fitsur, restrict1, test = "Chisq" )

# create hypothesis matrix to test whether beta_2 = - \beta_6
R2 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R2[ 1, 2 ] &lt;- 1
R2[ 1, 6 ] &lt;- 1
# the same hypothesis in symbolic form
restrict2 &lt;- "demand_price + supply_farmPrice = 0"

## perform Theil's F test
linearHypothesis( fitsur, R2 )  # accepted
linearHypothesis( fitsur, restrict2 )

## perform Wald test with F statistic
linearHypothesis( fitsur, R2, test = "F" )  # accepted
linearHypothesis( fitsur, restrict2 )

## perform Wald-test with chi^2 statistic
linearHypothesis( fitsur, R2, test = "Chisq" )  # accepted
linearHypothesis( fitsur, restrict2, test = "Chisq" )
</code></pre>


</div>