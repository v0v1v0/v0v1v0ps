<div class="container">

<table style="width: 100%;"><tr>
<td>retrospective_AM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>retrospective_AM (retrospective of Assessment model in MSE)</h2>

<h3>Description</h3>

<p>Plots the true retrospective of an assessment model during the closed-loop simulation. A series of time series estimates of SSB, F, and VB
are plotted over the course of the MSE are plotted against the operating model (true) values (in black).
</p>


<h3>Usage</h3>

<pre><code class="language-R">retrospective_AM(MSE, MP, sim = 1, plot_legend = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>An object of class MSEtool::MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MP</code></td>
<td>
<p>Character. The name of the management procedure created by <code>make_MP()</code> containing the assessment model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>Integer between 1 and MSE@nsim. The simulation number for which the retrospectives will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_legend</code></td>
<td>
<p>Logical. Whether to plot legend to reference year of assessment in the MSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For assessment models that utilize annual exploitation rates (u), the instantaneous fishing mortality rates
are obtained as F = -log(1 - u).
</p>


<h3>Value</h3>

<p>A series of figures for SSB, depletion, fishing mortality, and vulnerable biomass (VB) estimated in the MP
over the course of the closed-loop simulation against the values generated in the operating model (both historical
and projected).
</p>


<h3>Note</h3>

<p>This function only plots retrospectives from a single simulation in the MSE. Results from one figure
may not be indicative of general assessment behavior and performance overall.
</p>


<h3>Author(s)</h3>

<p>Q. Huynh
</p>


<h3>See Also</h3>

<p>diagnostic
</p>


<h3>Examples</h3>

<pre><code class="language-R">
SP_40_10 &lt;- make_MP(SP, HCR_MSY, diagnostic = "full")
OM &lt;- MSEtool::testOM; OM@proyears &lt;- 20
myMSE &lt;- MSEtool::runMSE(OM = OM, MPs = "SP_40_10")
retrospective_AM(myMSE, MP = "SP_40_10", sim = 1)

# How to get all the estimates
library(dplyr)
assess_estimates &lt;- lapply(1:myMSE@nMPs, function(m) {
  lapply(1:myMSE@nsim, function(x) {
    myMSE@PPD[[m]]@Misc[[x]]$Assessment_report %&gt;% 
      mutate(MP = myMSE@MPs[m], Simulation = x)
  }) %&gt;% bind_rows()
}) %&gt;% bind_rows()

</code></pre>


</div>