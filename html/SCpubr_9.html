<div class="container">

<table style="width: 100%;"><tr>
<td>do_CopyNumberVariantPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display CNV scores from inferCNV as Feature Plots.</h2>

<h3>Description</h3>

<p>Display CNV scores from inferCNV as Feature Plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_CopyNumberVariantPlot(
  sample,
  infercnv_object,
  chromosome_locations,
  group.by = NULL,
  using_metacells = FALSE,
  metacell_mapping = NULL,
  legend.type = "colorbar",
  legend.position = "bottom",
  legend.length = 20,
  legend.width = 1,
  legend.framewidth = 0.5,
  legend.tickwidth = 0.5,
  legend.framecolor = "grey50",
  legend.tickcolor = "white",
  font.size = 14,
  pt.size = 1,
  font.type = "sans",
  axis.text.x.angle = 45,
  enforce_symmetry = TRUE,
  legend.title = NULL,
  na.value = "grey75",
  viridis.palette = "G",
  viridis.direction = 1,
  verbose = FALSE,
  min.cutoff = NA,
  max.cutoff = NA,
  number.breaks = 5,
  diverging.palette = "RdBu",
  diverging.direction = -1,
  sequential.palette = "YlGnBu",
  sequential.direction = -1,
  use_viridis = TRUE,
  return_object = FALSE,
  grid.color = "white",
  border.color = "black",
  flip = FALSE,
  plot.title.face = "bold",
  plot.subtitle.face = "plain",
  plot.caption.face = "italic",
  axis.title.face = "bold",
  axis.text.face = "plain",
  legend.title.face = "bold",
  legend.text.face = "plain"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p><strong><code>Seurat</code></strong> | A Seurat object, generated by CreateSeuratObject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infercnv_object</code></td>
<td>
<p><strong><code>infercnv</code></strong> | Output inferCNV object run on the same Seurat object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chromosome_locations</code></td>
<td>
<p><strong><code>tibble</code></strong> | Tibble containing the chromosome regions to use. Can be obtained using <strong><code>utils::data("human_chr_locations", package = "SCpubr")</code></strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p><strong><code>character</code></strong> | Metadata variable to group the output by. Has to be a character of factor column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>using_metacells</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether inferCNV was run using metacells or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metacell_mapping</code></td>
<td>
<p><strong><code>named_vector</code></strong> | Vector or cell - metacell mapping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.type</code></td>
<td>
<p><strong><code>character</code></strong> | Type of legend to display. One of:
</p>

<ul>
<li> <p><em><code>normal</code></em>: Default legend displayed by <span class="pkg">ggplot2</span>.
</p>
</li>
<li> <p><em><code>colorbar</code></em>: Redefined colorbar legend, using guide_colorbar.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p><strong><code>character</code></strong> | Position of the legend in the plot. One of:
</p>

<ul>
<li> <p><em><code>top</code></em>: Top of the figure.
</p>
</li>
<li> <p><em><code>bottom</code></em>: Bottom of the figure.
</p>
</li>
<li> <p><em><code>left</code></em>: Left of the figure.
</p>
</li>
<li> <p><em><code>right</code></em>: Right of the figure.
</p>
</li>
<li> <p><em><code>none</code></em>: No legend is displayed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.length, legend.width</code></td>
<td>
<p><strong><code>numeric</code></strong> | Length and width of the legend. Will adjust automatically depending on legend side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.framewidth, legend.tickwidth</code></td>
<td>
<p><strong><code>numeric</code></strong> | Width of the lines of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.framecolor</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the lines of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.tickcolor</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the ticks of the box in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.size</code></td>
<td>
<p><strong><code>numeric</code></strong> | Overall font size of the plot. All plot elements will have a size relationship with this font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.size</code></td>
<td>
<p><strong><code>numeric</code></strong> | Size of the dots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.type</code></td>
<td>
<p><strong><code>character</code></strong> | Base font family for the plot. One of:
</p>

<ul>
<li> <p><em><code>mono</code></em>: Mono spaced font.
</p>
</li>
<li> <p><em><code>serif</code></em>: Serif font family.
</p>
</li>
<li> <p><em><code>sans</code></em>: Default font family.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.x.angle</code></td>
<td>
<p><strong><code>numeric</code></strong> | Degree to rotate the X labels. One of: 0, 45, 90.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enforce_symmetry</code></td>
<td>
<p><strong><code>logical</code></strong> | Return a symmetrical plot axes-wise or continuous color scale-wise, when applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>
<p><strong><code>character</code></strong> | Title for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.value</code></td>
<td>
<p><strong><code>character</code></strong> | Color value for NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis.palette</code></td>
<td>
<p><strong><code>character</code></strong> | A capital letter from A to H or the scale name as in scale_fill_viridis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis.direction</code></td>
<td>
<p><strong><code>numeric</code></strong> | Either 1 or -1. Controls how the gradient of viridis scale is formed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to show extra comments, warnings,etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cutoff, max.cutoff</code></td>
<td>
<p><strong><code>numeric</code></strong> | Set the min/max ends of the color scale. Any cell/group with a value lower than min.cutoff will turn into min.cutoff and any cell with a value higher than max.cutoff will turn into max.cutoff. In FeaturePlots, provide as many values as features. Use NAs to skip a feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number.breaks</code></td>
<td>
<p><strong><code>numeric</code></strong> | Controls the number of breaks in continuous color scales of ggplot2-based plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diverging.palette</code></td>
<td>
<p><strong><code>character</code></strong> | Type of symmetrical color palette to use. Out of the diverging palettes defined in <strong><code>brewer.pal</code></strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diverging.direction</code></td>
<td>
<p><strong><code>numeric</code></strong> | Either 1 or -1. Direction of the divering palette. This basically flips the two ends.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential.palette</code></td>
<td>
<p><strong><code>character</code></strong> | Type of sequential color palette to use. Out of the sequential palettes defined in <strong><code>brewer.pal</code></strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequential.direction</code></td>
<td>
<p><strong><code>numeric</code></strong> | Direction of the sequential color scale. Either 1 or -1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_viridis</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to use viridis color scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_object</code></td>
<td>
<p><strong><code>logical</code></strong> | Returns the Seurat object with the modifications performed in the function. Nomally, this contains a new assay with the data that can then be used for any other visualization desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color of the grid in the plot. In heatmaps, color of the border of the cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border.color</code></td>
<td>
<p><strong><code>character</code></strong> | Color for the border of the heatmap body.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p><strong><code>logical</code></strong> | Whether to invert the axis of the displayed plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.face, plot.subtitle.face, plot.caption.face, axis.title.face, axis.text.face, legend.title.face, legend.text.face</code></td>
<td>
<p><strong><code>character</code></strong> | Controls the style of the font for the corresponding theme element.  One of:
</p>

<ul>
<li> <p><em><code>plain</code></em>: For normal text.
</p>
</li>
<li> <p><em><code>italic</code></em>: For text in itallic.
</p>
</li>
<li> <p><em><code>bold</code></em>: For text in bold.
</p>
</li>
<li> <p><em><code>bold.italic</code></em>: For text both in itallic and bold.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing Feature Plots for different chromosome regions and corresponding dot plots by groups..
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # Check Suggests.
  value &lt;- SCpubr:::check_suggests(function_name = "do_CopyNumberVariantPlot", passive = TRUE)

  if (isTRUE(value)){
    # Consult the full documentation in https://enblacar.github.io/SCpubr-book/

    # This function expects that you have run inferCNV on your
    # own and you have access to the output object.

    # Define your Seurat object.
    sample &lt;- readRDS(system.file("extdata/seurat_dataset_example.rds",
                                  package = "SCpubr"))

    # Define your inferCNV object.
    infercnv_object &lt;- readRDS(system.file("extdata/infercnv_object_example.rds",
                                           package = "SCpubr"))

    # Get human chromosome locations.
    chromosome_locations = SCpubr::human_chr_locations

    # Compute for a all chromosomes.
    p &lt;- SCpubr::do_CopyNumberVariantPlot(sample = sample,
                                          infercnv_object = infercnv_object,
                                          using_metacells = FALSE,
                                          chromosome_locations = chromosome_locations)

  } else if (base::isFALSE(value)){
    message("This function can not be used without its suggested packages.")
    message("Check out which ones are needed using `SCpubr::state_dependencies()`.")
  }

</code></pre>


</div>