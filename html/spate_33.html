<div class="container">

<table style="width: 100%;"><tr>
<td>sample.four.coef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample from the full conditional of the Fourier coefficients.
</h2>

<h3>Description</h3>

<p>Sample from the full conditional of the Fourier coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample.four.coef(w=NULL,wFT=NULL,spec=NULL,Gvec=NULL,tau2=NULL,par=NULL,n,T,
                 NF=n*n,indCos=(1:((n*n-4)/2)*2+3),ns=4,nu=1,dt=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Observed data or latent process w (depending on which data
model is used) in an T x n*n matrix with columns and rows (points on a
grid stacked into a vector) corresponding to time and space, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFT</code></td>
<td>

<p>Vector of length T*n*n containing the real Fourier transform of 'w'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>

<p>Spectrum of the innovations <code class="reqn">\hat{\epsilon}</code> in a vector of length
n*n. If 'spec' is not given, it is constructed based on 'par'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gvec</code></td>
<td>

<p>The propagator matrix G in vector format obtained from 'get.G.vec'. If 'Gvec' is not given, it is constructed based on 'par'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2</code></td>
<td>

<p>Measurement error variance tau2. If 'NULL'; tau2=par[9].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p> Vector of parameters for the SPDE in the following order: rho_0, sigma^2, zeta,
rho_1, gamma, alpha, mu_x, mu_y, tau^2. If 'spec' and 'Gvec' are
given, 'par' will not be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of grid points on each axis. n*n is the total number of spatial points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>

<p>Number of points in time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NF</code></td>
<td>

<p>Number of Fourier functions used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indCos</code></td>
<td>
<p>Vector of integers indicating the position cosine terms in
the 1:NF real Fourier functions. The first 'ns' cosine wavenumbers in 'wave' are not included in 'indCos'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>

<p>Number of real Fourier functions that have only a cosine and no sine
term. 'ns' is maximal 4.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> Smoothness parameter of the Matern covariance function for the innovations. By
default this equals 1 corresponding to the Whittle covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p> Temporal lag between two time points. By default, this equals 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A T x n*n matrix with a sample from the full conditional
of latent process <code class="reqn">\alpha</code>.
</p>


<h3>Author(s)</h3>

<p>Fabio Sigrist
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Specifications for simulated example
n &lt;- 50
T &lt;- 4
par &lt;- c(rho0=0.1,sigma2=0.2,zeta=0.5,rho1=0.1,gamma=2,alpha=pi/4,muX=0.2,muY=-0.2,tau2=0.01)
spateSim &lt;- spate.sim(par=par,n=n,T=T,seed=4)
w &lt;- spateSim$w
##Sample from full conditional
Nmc &lt;- 50
alphaS &lt;- array(0,c(T,n*n,Nmc))
wFT &lt;- real.fft.TS(w,n=n,T=T)
for(i in 1:Nmc){
  alphaS[,,i] &lt;- sample.four.coef(wFT=wFT,par=par,n=n,T=T,NF=n*n)
}
##Mean from full conditional
alphaMean &lt;- apply(alphaS,c(1,2),mean)
xiMean &lt;- real.fft.TS(alphaMean,n=n,T=T,inv=FALSE)

opar &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,4),mar=c(1,1,1,1))
for(t in 1:4) image(1:n,1:n,matrix(w[t,],nrow=n),xlab="",ylab="",col=cols(),
                    main=paste("w(",t,")",sep=""),xaxt='n',yaxt='n')
for(t in 1:4) image(1:n,1:n,matrix(xiMean[t,],nrow=n),xlab="",ylab="",col=cols(),
                    main=paste("xiPost(",t,")",sep=""),xaxt='n',yaxt='n')
par(opar) # Reset par() settings
</code></pre>


</div>