<div class="container">

<table style="width: 100%;"><tr>
<td>make_one_dataset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate time-varying covariates</h2>

<h3>Description</h3>

<p>Simulates a dataset with correlated time-varying covariates with an exchangeable correlation
structure. Covariates can be normal or binary
and can be static within a cluster or time-varying. Time-varying normal variables can optionally 
have linear trajectories within each cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_one_dataset(n, obs, n.TBins, pcor, wcor, parameters, cat.parameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>The number of observations per cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.TBins</code></td>
<td>
<p>Number of time-varying binary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcor</code></td>
<td>
<p>The across-subject correlation matrix. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcor</code></td>
<td>
<p>The within-subject correlation matrix. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A dataframe containing the general simulation parameters. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat.parameters</code></td>
<td>
<p>A dataframe containing parameters for the categorical variables. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>SPECIFYING THE PARAMETERS MATRIX</strong>
</p>
<p>The matrix <code>parameters</code> contains parameters required to generate all non-categorical variables.
It must contain column names <code>name, type, across.mean, across.SD, across.var, within.var, prop</code>,
and <code>error.SD</code>. (To see an example, use <code>data(params)</code>.) Each variable to be generated requires
either one or two rows in <code>parameters</code>, depending on the variable type. 
</p>
<p>The possible variable types and their corresponding specifications are:
</p>

<ul>
<li> <p><strong>Static binary variables</strong> do not change over time within a cluster. For example, if clusters
are subjects, sex would be a static binary variable. Generating such a variable requires a single row
of type <code>static.binary</code> with <code>prop</code> corresponding to the proportion of clusters for which the
variable equals 1 and all other columns set to <code>NA</code>. (The correct standard deviation will automatically
be computed later.) For example, if the variable is an indicator for a subject's being male, then <code>prop</code>
specifies the proportion of males to be generated. 
</p>
</li>
<li> <p><strong>Time-varying binary variables</strong> can change within a cluster over time, as for
an indicator for whether a subject is currently taking the study drug. These variables require two rows in
<code>parameters</code>. The first row should be of type <code>static.binary</code> with <code>prop</code> representing 
the proportion of clusters for which the time-varying binary variable is 1 at least once
(and all other columns set to <code>NA</code>). For example, this row in <code>parameters</code> could represent the
proportion of subjects who ever take the study drug ("ever-users").
</p>
<p>The second row should be of type <code>subject.prop</code> with <code>across.mean</code> representing, for clusters
that ever have a 1 for the binary variable, the proportion of observations within the cluster for which
the variable is equal to 1. (All other columns should be set to <code>NA</code>.) For example, this this row in
<code>parameters</code> could 
represent the proportion of observations for which an ever-user is currently taking the drug. To indicate
which pair of variables go together, the <code>subject.prop</code> should have the same name as the <code>static.binary</code>
variable, but with the suffix <code>_s</code> appended (for example, the former could be named <code>drug_s</code> and
the latter <code>drug</code>).
</p>
</li>
<li> <p><strong>Normal variables</strong> are normally distributed within a cluster such that the within-cluster
means are themselves also normally distributed in the population of clusters. Generating a normal variable requires
specification of the population mean (<code>across.mean</code>) and standard deviation (<code>across.SD</code>) as well as of
the within-cluster standard deviation (<code>within.SD</code>). To generate a static continuous variable, simply set
<code>within.SD</code> to be extremely small (e.g., $1 * 10^-7$) and all corresponding correlations in matrix
<code>wcor</code> to 0. 
</p>
</li>
<li> <p><strong>Time-function variables</strong> are linear functions of time (with normal error) within each cluster such 
that the within-cluster baseline values are normally distributed in the population of clusters. Generating a
time-function variable requires two entries. The first entry should be of type <code>time.function</code> and
specifies the population mean (<code>across.mean</code>) and standard deviation (<code>across.SD</code>) of the within-cluster
baseline values as well as the error standard deviation (<code>error.SD</code>). The second entry should be of
type <code>normal</code> and should have the same name as the <code>time.function</code> entry, but with the "_s" suffix.
This entry specifies the mean (<code>across.mean</code>) and standard deviation (<code>across.SD</code>) of the within-cluster
slopes. 
</p>
</li>
</ul>
<p><strong>SPECIFYING THE CATEGORICAL PARAMETERS MATRIX</strong>
</p>
<p>The matrix <code>cat.parameters</code> contains parameters required to generate the single categorical variable, 
if any.
It must contain column names <code>level, parameter</code>,
and <code>beta</code>. (To see an example, use <code>data(cat.params)</code>.)
</p>

<ul>
<li> <p><strong>The reference level:</strong> Each categorical variable must have exactly one "reference" level. The reference level should have one
row in <code>cat.parameters</code> for which <code>parameters</code> is set to <code>NA</code> and <code>beta</code> is set
to <code>ref</code>. For example, in the example file <code>cat.params</code> specifying parameters to generate a
subject's race, the reference level is <code>white</code>. 
</p>
</li>
<li> <p><strong> Other levels: </strong> Other levels of the categorical variable will have one or more rows. One row with parameter set to <code>intercept</code>
and <code>beta</code> set to a numeric value
represents the intercept term in the corresponding multinomial model. Any subsequent rows, with parameters set to 
names of other variables in the dataset and <code>beta</code> set to numeric values, 
represents other coefficients in the corresponding multinomial models. 
</p>
</li>
</ul>
<p><strong>SPECIFYING THE POPULATION CORRELATION MATRIX</strong>
</p>
<p>Matrix <code>pcor</code> specifies the population (i.e., across-cluster) correlation matrix. It should have the same
number of rows and columns as <code>parameters</code> as well as the same variable names and ordering of variables.  
</p>
<p><strong>SPECIFYING THE WITHIN-CLUSTER CORRELATION MATRIX</strong>
</p>
<p>Matrix <code>wcor</code> specifies the within-cluster correlation matrix. The order of the variables listed in this file should be
consistent with the order in <code>params</code> and <code>pcor</code>. However, <code>static.binary</code> and <code>subject.prop</code> variables
should not be included in <code>wcor</code> since they are static within a cluster. Static continuous variables should be included,
but all the correlations should be set to zero.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data = make_one_dataset(n=10, obs=10, n.TBins=2, pcor=pcor, wcor=wcor, 
parameters=complete_parameters(params, n=10), cat.parameters=cat.params)$data
</code></pre>


</div>