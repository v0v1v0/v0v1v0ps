<div class="container">

<table style="width: 100%;"><tr>
<td>patchdistr_sews</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Early-warning signals based on patch size distributions</h2>

<h3>Description</h3>

<p>Compute early-warning signals based on patch size distributions
</p>


<h3>Usage</h3>

<pre><code class="language-R">patchdistr_sews(
  mat,
  merge = FALSE,
  fit_lnorm = FALSE,
  best_by = "BIC",
  xmin = 1,
  xmin_bounds = NULL,
  wrap = FALSE,
  nbmask = "von_neumann"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A logical matrix (<code>TRUE</code>/<code>FALSE</code> values) or a list of these</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>The default behavior is to produce indicators values for each 
matrix. If this parameter is set to TRUE then the patch size distributions 
are pooled together before fitting, yielding only one final indicator 
value for the set of input matrices (argument <code>mat</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_lnorm</code></td>
<td>
<p>When patch size distributions are compared, should we 
consider lognormal type ? (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best_by</code></td>
<td>
<p>The criterion to use to select the best fit (one of "AIC", 
"BIC" or "AICc")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>The <code class="reqn">x_{min}</code> to be used to fit the patch size distributions. Use 
the special value "estimate" to compute first the <code class="reqn">x_{min}</code> that produces 
the best power-law fit, then use this estimated value to fit all 
distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin_bounds</code></td>
<td>
<p>Bounds when estimating <code class="reqn">x_{min}</code> for power-law distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrap</code></td>
<td>
<p>Determines whether patches are considered to wrap around the 
matrix when reaching the side</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbmask</code></td>
<td>
<p>Either "moore" for 8-way neighborhood, "von_neumann" for four-way 
neighborhood (default), or a 3x3 matrix describing which neighbors to 
consider around a cell. See <code>patchsizes</code> for details on how to specify 
such neighborhoods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Patterned ecosystems can exhibit a change in their spatial structure as they 
become more and more stressed. It has been suggested that this should be 
reflected in changes in the observed patch size distributions (PSD). 
The following sequence is expected to occur (Kefi et al. 2011) as patterned 
ecosystems become more and more degraded:
</p>
<p>- Percolation of vegetation patches occurs (a patch has a width or height 
equal to the size of the system)
</p>
<p>- The patch-size distribution follows a power-law
</p>
<p>- The patch-size distribution deviates from a power-law as larger patches 
break down
</p>
<p>- The patch-size distribution is closer to an exponential 
distribution
</p>
<p>Additionally, it has been suggested that these changes in patch size 
distribution shape should be reflected in the power-law range (PLR). This 
function carries out all the required computations and helps display 
the results in a convenient form. 
</p>
<p>The fitting of PSDs is based on maximum-likelihood following Clauset et al.'s 
procedure. The best discrete distribution is estimated among these 
candidates: a power-law <code class="reqn">x^\lambda</code>, an exponential 
<code class="reqn">exp(\alpha x)</code>, a truncated power-law and <code class="reqn">x^\lambda exp(\alpha x)</code>,
and optionally, a log-normal. Each distribution parameter is estimated 
using maximum-likelihood, with a minimum patch size (xmin) fixed to one. 
The best distribution is selected based on BIC by default. In raw results, 
<code>plexpo</code> refers to the power-law exponent (<code class="reqn">\lambda</code> in the previous 
equations) and <code>cutoff</code> referes to the exponential decay rate
<code class="reqn">\alpha</code>. 
</p>
<p>To compute the Power-law range (PLR), power-laws are fitted with a variable 
minimum patch size (xmin) and the one with the lowest Kolmogorov-Smirnov
distance to the empirical distribution is retained. PLR is then computed 
using this best-fitting xmin: 
</p>
<p style="text-align: center;"><code class="reqn">\frac{log(x_{max}) - log(x_{min})}{log(x_{max}) - log(x_{smallest})}</code>
</p>

<p>Results can be displayed using the text-based <code>summary</code> and <code>print</code>, 
but graphical options are also available to plot the trends (<code>plot</code>) and 
the fitted distributions (<code>plot_distr</code>). Plotting functions are 
documented in a separate page. Observed and 
fitted distributions can be produced using the <code>predict</code> function, 
as documented on this page.
</p>


<h3>Value</h3>

<p>A list object of class 'psdfit' containing among other things 
- the observed patch size distribution data
- the model outputs for the candidate distribution fits
- the power-law range values 
- the percolation values (if several matrices were provided and 
'merge' was TRUE, then the average percolation value is returned)
</p>


<h3>References</h3>

<p>Kefi, S., Rietkerk, M., Alados, C. L., Pueyo, Y., Papanastasis, 
V. P., ElAich, A., &amp; De Ruiter, P. C. (2007). Spatial vegetation patterns 
and imminent desertification in Mediterranean arid ecosystems. 
Nature, 449(7159), 213-217.
</p>
<p>Kefi, S., Rietkerk, M., Roy, M., Franc, A., de Ruiter, P.C. &amp; Pascual, M. 
(2011). Robust scaling in ecosystems and the meltdown of patch size 
distributions before extinction: Patch size distributions towards 
extinction. Ecology Letters, 14, 29-35.
</p>
<p>Berdugo, M, Sonia Kefi, Santiago Soliveres, and Fernando T. Maestre. (2017) 
Plant Spatial Patterns Identify Alternative Ecosystem Multifunctionality 
States in Global Drylands. Nature in Ecology and Evolution, no. 1.
</p>
<p>Clauset, A., Shalizi, C. R., &amp; Newman, M. E. (2009). 
Power-law distributions in empirical data. SIAM review, 51(4), 661-703.
</p>


<h3>See Also</h3>

<p><code>patchsizes</code>, <code>plot_distr</code>, 
<code>predict</code>, 
<code>plot</code>,
</p>
<p><code>indictest</code>, to test the significance of indicator values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(forestgap)


psd_indic &lt;- patchdistr_sews(forestgap)

summary(psd_indic)
plot(psd_indic)

# Plots can be modified using ggplot2 directives 
if ( require(ggplot2) ) { 
  plot(psd_indic) + 
    theme_minimal()
}

# Export results to a data.frame
psd_indic_export &lt;- as.data.frame(psd_indic) 
head(psd_indic_export)


</code></pre>


</div>