<div class="container">

<table style="width: 100%;"><tr>
<td>ci_bound_ur</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find a Likelihood-Based
Confidence Bound By Root Finding</h2>

<h3>Description</h3>

<p>Find the lower or upper
bound of the likelihood-based
confidence interval (LBCI) for one
parameter in a structural equation
model fitted in <code>lavaan::lavaan()</code>
using <code>uniroot()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci_bound_ur(
  sem_out,
  func,
  ...,
  level = 0.95,
  which = c("lbound", "ubound"),
  interval = NULL,
  progress = FALSE,
  method = "uniroot",
  lrt_method = "default",
  tol = 5e-04,
  root_target = c("chisq", "pvalue"),
  d = 5,
  uniroot_extendInt = switch(which, lbound = "downX", ubound = "upX"),
  uniroot_trace = 0,
  uniroot_maxiter = 1000,
  use_callr = TRUE,
  rs = NULL
)

gen_est_i(i, sem_out, standardized = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sem_out</code></td>
<td>
<p>The fit object.
Currently supports
lavaan::lavaan objects only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>A function that receives
a lavaan object and returns a scalar.
This function is to be used by
<code>gen_userp()</code> and so there are
special requirements on it.
Alternatively, it can be the output
of <code>gen_est_i()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to be
passed to <code>func</code>. Usually not used
but included in case the function
has such arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The level of confidence
of the confidence interval. Default
is .95, or 95%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Whether the lower bound
or the upper bound is to be found.
Must be <code>"lbound"</code> or <code>"ubound"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>A numeric vector of
two values, which is the initial
interval to be searched. If <code>NULL</code>,
the default, it will be determined
internally using Wald or delta
method confidence interval, if
available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Whether progress will
be reported on screen during the
search. Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The actual function to
be used in the search. which can only
be <code>"uniroot"</code>, the default, for now.
May include other function in the
future.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrt_method</code></td>
<td>
<p>The method used in
<code>lavaan::lavTestLRT()</code>. Default is
<code>"default"</code>. It is automatically set
to <code>"satorra.2000"</code> and cannot be
overridden if a scaled test statistic
is requested in <code>sem_out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance used in
<code>uniroot()</code>, default is .005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root_target</code></td>
<td>
<p>Whether the
chi-square difference (<code>"chisq"</code>),
the default, or its <em>p</em>-value
(<code>"pvalue"</code>) is used as the function
value in finding the root. Should have
little impact on the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>A value used to determine
the width of the interval in the
initial search. Larger this value,
<em>narrow</em> the interval. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniroot_extendInt</code></td>
<td>
<p>To be passed
to the argument <code>extendInt</code> of
<code>uniroot()</code>. Whether the interval
should be extended if the root is not
found. Default value depends on
the bound to be searched. Refer to
the help page of <code>uniroot()</code> for
possible values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniroot_trace</code></td>
<td>
<p>To be passed to
the argument <code>trace</code> of <code>uniroot()</code>.
How much information is printed
during the search. Default is 0, and
no information is printed during the
search. Refer to the help page of
<code>uniroot()</code> for possible values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniroot_maxiter</code></td>
<td>
<p>The maximum
number of iteration in the search.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_callr</code></td>
<td>
<p>Whether the
<code>callr</code> package will be used to
do the search in a separate R
process. Default is <code>TRUE</code>. Should
not set to <code>FALSE</code> if used in an
interactive environment unless this is
intentional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>Optional. If set to
a persistent R process created by
<code>callr</code>, it will be used instead of
starting a new one, and it will not
be terminated on exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>The position of the target
parameter as appeared in the
parameter table of an lavaan object,
generated by
<code>lavaan::parameterTable()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>If <code>TRUE</code>, the
standardized estimate is to be
retrieved. Default is <code>FALSE</code>.
Only support <code>"std.all"</code> for now.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is called xby
<code>ci_bound_ur_i()</code>. This function is
exported because it is a
stand-alone function that can be used
directly for any function that
receives a lavaan object and returns
a scalar.
</p>
<p>The function <code>ci_bound_ur_i()</code> is a
wrapper of this function, with an
interface similar to that of
<code>ci_bound_wn_i()</code> and returns a
<code>cibound</code>-class object. The
user-parameter function is generated
internally by <code>ci_bound_wn_i()</code>.
</p>
<p>This function, on the other hand,
requires users to supply the function
directly through the <code>func</code> argument.
This provides the flexibility to find
the bound for any function of the
model parameter, even one that cannot
be easily coded in <code>lavaan</code> model
syntax.
</p>


<h3>Value</h3>

<p>The function <code>ci_bound_ur()</code> returns
a list with the following elements:
</p>

<ul>
<li> <p><code>bound</code>: The bound found.
</p>
</li>
<li> <p><code>optimize_out</code>: THe output of the
root finding function, <code>uniroot()</code>
for now. (Called <code>optimize_out</code>
because an earlier version of this
function also uses <code>optimize()</code>).
</p>
</li>
<li> <p><code>sem_out_bound</code>: The <code>lavaan</code> model
with the user-defined parameter fixed
to the bound.
</p>
</li>
<li> <p><code>lrt</code>: The output of
<code>lavaan::lavTestLRT()</code> comparing
<code>sem_out</code> and <code>sem_out_bound</code>.
</p>
</li>
<li> <p><code>bound_start</code>: The Wald or delta
method confidence bound returned when
determining the interval internally.
</p>
</li>
<li> <p><code>user_est</code>: The estimate of the
user-defined parameter when
determining the interval internally.
</p>
</li>
</ul>
<p>The function <code>gen_est_i()</code> returns
a special function can inspects the
<code>Model</code> slot (and <code>implied</code> slot
if necessary) of a modified <code>lavaan</code>
object and return the parameter
estimate. This function is to be used
by <code>ci_bound_ur()</code> or
<code>gen_sem_out_userp()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lavaan)
data(simple_med)
dat &lt;- simple_med
mod &lt;-
"
m ~ x
y ~ m
"
fit_med &lt;- lavaan::sem(mod, simple_med, fixed.x = FALSE)
parameterTable(fit_med)
# Create a function to get the second parameter
est_i &lt;- gen_est_i(i = 2, sem_out = fit_med)
# Find the lower bound of the likelihood-based confidence interval
# of the second parameter.
# user_callr should be TRUE or omitted in read research.
# Remove interval in read research. It is added to speed up the example.
out1l &lt;- ci_bound_ur(sem_out = fit_med,
                     func = est_i,
                     which = "lbound",
                     use_callr = FALSE,
                     interval = c(.39070, .39075))
out1l

</code></pre>


</div>