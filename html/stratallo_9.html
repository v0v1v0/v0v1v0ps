<div class="container">

<table style="width: 100%;"><tr>
<td>optcost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum Cost Allocation in Stratified Sampling</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Function that determines fixed strata sample sizes that minimize total cost
of the survey, under assumed level of the variance of the stratified
estimator and under optional one-sided upper bounds imposed on strata sample
sizes. Namely, the following optimization problem, formulated below in the
language of mathematical optimization, is solved by <code>optcost()</code> function.
</p>
<p>Minimize
</p>
<p style="text-align: center;"><code class="reqn">c(x_1,\ldots,x_H) = \sum_{h=1}^H c_h x_h</code>
</p>

<p>subject to
</p>
<p style="text-align: center;"><code class="reqn">\sum_{h=1}^H \frac{A^2_h}{x_h} - A_0 = V</code>
</p>

<p style="text-align: center;"><code class="reqn">x_h \leq M_h, \quad h = 1,\ldots,H,</code>
</p>

<p>where <code class="reqn">A_0,\, A_h &gt; 0,\, c_h &gt; 0,\, M_h &gt; 0,\, h = 1,\ldots,H</code>,
and <code class="reqn">V &gt; \sum_{h=1}^H \frac{A^2_h}{M_h} - A_0</code> are given numbers. The
minimization is on <code class="reqn">\mathbb R_+^H</code>.
The upper-bounds constraints <code class="reqn">x_h \leq M_h,\, h = 1,\ldots,H</code>, are
optional and can be skipped. In such a case, it is only required that
<code class="reqn">V &gt; 0</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optcost(V, A, A0, M = NULL, unit_costs = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>(<code>number</code>)<br> parameter <code class="reqn">V</code> of the equality constraint. A
strictly positive scalar. If <code>M</code> is not <code>NULL</code>, it is then required that
<code>V &gt;= sum(A^2/M) - A0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>(<code>numeric</code>)<br> population constants <code class="reqn">A_1,\ldots,A_H</code>. Strictly
positive numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0</code></td>
<td>
<p>(<code>number</code>)<br> population constant <code class="reqn">A_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br> upper bounds <code class="reqn">M_1,\ldots,M_H</code>,
optionally imposed on sample sizes in strata. If no upper bounds should be
imposed, then <code>M</code> must be set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit_costs</code></td>
<td>
<p>(<code>numeric</code>)<br> costs <code class="reqn">c_1,\ldots,c_H</code>, of surveying one
element in stratum. A strictly positive numbers. Can be also of length 1,
if all unit costs are the same for all strata. In this case, the elements
will be recycled to the length of <code>bounds</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm that is used by <code>optcost()</code> is the <code>LRNA</code> and it is
described in Wójciak (2023). The allocation computed is valid for all
stratified sampling schemes for which the variance of the stratified
estimator is of the form:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{h=1}^H \frac{A^2_h}{x_h} - A_0,</code>
</p>

<p>where <code class="reqn">H</code> denotes total number of strata, <code class="reqn">x_1,\ldots,x_H</code> are
strata sample sizes and <code class="reqn">A_0,\, A_h &gt; 0,\, h = 1,\ldots,H</code>, do not
depend on <code class="reqn">x_h,\, h = 1,\ldots,H</code>.
</p>


<h3>Value</h3>

<p>Numeric vector with optimal sample allocations in strata.
</p>


<h3>Note</h3>

<p>For <em>stratified <code class="reqn">\pi</code> estimator</em> of the population total and
for <em>stratified simple random sampling without replacement</em> design,
the population parameters are as follows:
</p>
<p style="text-align: center;"><code class="reqn">A_h = N_h S_h, \quad h = 1,\ldots,H,</code>
</p>

<p style="text-align: center;"><code class="reqn">A_0 = \sum_{h=1}^H N_h S_h^2,</code>
</p>

<p>where <code class="reqn">N_h</code> is the size of stratum <code class="reqn">h</code> and <code class="reqn">S_h</code> denotes
standard deviation of a given study variable in stratum <code class="reqn">h</code>.
</p>


<h3>References</h3>

<p>Wójciak, W. (2023).
Another Solution of Some Optimum Allocation Problem.
<em>Statistics in Transition new series</em>, 24(5) (in press).
<a href="https://arxiv.org/abs/2204.04035">https://arxiv.org/abs/2204.04035</a>
</p>


<h3>See Also</h3>

<p><code>rna()</code>, <code>opt()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- c(3000, 4000, 5000, 2000)
M &lt;- c(100, 90, 70, 80)
xopt &lt;- optcost(1017579, A = A, A0 = 579, M = M)
xopt
</code></pre>


</div>