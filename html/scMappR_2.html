<div class="container">

<table style="width: 100%;"><tr>
<td>coEnrich</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify co-expressed cell-types</h2>

<h3>Description</h3>

<p>This function identifies genes with similar cell-type markers and if those markers are driving enrichment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coEnrich(
  sig,
  gene_list_heatmap,
  background_heatmap,
  study_name,
  outDir,
  toSave = FALSE,
  path = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>A The number of combinations of significant cell-types to enrich.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_list_heatmap</code></td>
<td>
<p>Signature matrix of inputted genes in heatmap and the cell-type preferences – output of heatmap generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background_heatmap</code></td>
<td>
<p>Signature matrix of background matrix in heatmap and cell-type preferences – output of heatmap generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study_name</code></td>
<td>
<p>Name of the outputted table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outDir</code></td>
<td>
<p>Name of the directory this table will be printed in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toSave</code></td>
<td>
<p>Allow scMappR to write files in the current directory (T/F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>If toSave == TRUE, path to the directory where files will be saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes significantly enriched cell-types from the single CT_enrich before testing to see if the genes driving their enrichment are overlapping to a significant proportion using Fisher's exact test.
To save computational time and to not complete this with an incredible number of permutations, scMappR stops at overlapping 5 cell-types.
</p>


<h3>Value</h3>

<p><code>coEnrich</code> Enrichment of cell-types that are expressed by the same genes, up to 4 sets of cell-types. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">
# load in signature matrices
data(POA_example)
POA_generes &lt;- POA_example$POA_generes
POA_OR_signature &lt;- POA_example$POA_OR_signature
POA_Rank_signature &lt;- POA_example$POA_Rank_signature
sig &lt;- get_gene_symbol(POA_Rank_signature)
Signature &lt;- POA_Rank_signature
rownames(Signature) &lt;- sig$rowname
genes &lt;- rownames(Signature)[1:60]
heatmap_test &lt;- tissue_scMappR_custom(gene_list = genes, signature_matrix = Signature,
output_directory =  "scMappR_test", toSave = FALSE)
group_preferences &lt;- heatmap_test$group_celltype_preferences

</code></pre>


</div>