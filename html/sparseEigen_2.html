<div class="container">

<table style="width: 100%;"><tr>
<td>spEigenCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariance Matrix Estimation with Sparse Eigenvectors</h2>

<h3>Description</h3>

<p>Estimates the covariance matrix with sparse (orthogonal) eigenvectors (in other words, it jointly estimates the sparse eigenvectors and the eigenvalues).
</p>


<h3>Usage</h3>

<pre><code class="language-R">spEigenCov(S, q = 1, rho = 0.5, thres = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>m-by-m sample covariance matrix. It is required that <code>S</code> is full-rank. Both real and complex matrices are accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>number of sparse eigenvectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>sparsity weight factor. Any nonnegative number (suggested range [0,1]).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>threshold value. All the entries of the sparse eigenvectors less or equal to <code>thres</code> are set to 0. The default value is <code>1e-9</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>vectors</code>  </td>
<td>
<p>m-by-m matrix, columns corresponding to eigenvectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>values</code>  </td>
<td>
<p>m-by-1 vector corresponding to eigenvalues.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Konstantinos Benidis and Daniel P. Palomar
</p>


<h3>References</h3>

<p>K. Benidis, Y. Sun, P. Babu, D. P. Palomar, "Orthogonal Sparse PCA and Covariance Estimation via Procrustes Reformulation,"
<em>IEEE Transactions on Signal Processing</em>, vol. 64, no. 23, pp. 6211-6226, Dec. 2016.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(sparseEigen)
n &lt;- 600  # samples
m &lt;- 500  # dimension
q &lt;- 3  # number of sparse eigenvectors to be estimated
sp_card &lt;- 0.1*m  # sparsity of each eigenvector

# generate covariance matrix with sparse eigenvectors
V &lt;- matrix(0, m, q)
V[cbind(seq(1, q*sp_card), rep(1:q, each = sp_card))] &lt;- 1/sqrt(sp_card)
V &lt;- cbind(V, matrix(rnorm(m*(m-q)), m, m-q))
V &lt;- qr.Q(qr(V))  # orthogonalize eigenvectors
lmd &lt;- c(100*seq(from = q, to = 1), rep(1, m-q))  # generate eigenvalues
R &lt;- V %*% diag(lmd) %*% t(V)  # covariance matrix

# generate data
X &lt;- MASS::mvrnorm(n, rep(0, m), R)  # random data with underlying sparse structure

# standard and sparse estimation
res_standard &lt;- eigen(cov(X))
res_sparse &lt;- spEigenCov(cov(X), q)

# show inner product between estimated eigenvectors and originals (the closer to 1 the better)
abs(diag(t(res_standard$vectors) %*% V[, 1:q]))  #for standard estimated eigenvectors
abs(diag(t(res_sparse$vectors) %*% V[, 1:q]))    #for sparse estimated eigenvectors

# show error between estimated and true covariance
norm(cov(X) - R, type = 'F') #for sample covariance matrix
norm(res_sparse$cov - R, type = 'F') #for covariance with sparse eigenvectors

## End(Not run)
</code></pre>


</div>