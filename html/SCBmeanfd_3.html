<div class="container">

<table style="width: 100%;"><tr>
<td>cv.select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross-Validation Bandwidth Selection for Local Polynomial Estimation</h2>

<h3>Description</h3>

<p>Select the cross-validation bandwidth described in Rice and Silverman (1991) for the local polynomial estimation of a mean function based on functional data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R"> cv.select(x, y, degree = 1, interval = NULL, gridsize = length(x), ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>observation points. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix or data frame with functional observations (= curves) stored in rows. The number of columns of <code>y</code> must match the length of <code>x</code>. Missing values are not accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of the local polynomial fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>lower and upper bounds of the search interval (numeric vector of length 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>size of evaluation grid for the smoothed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to  pass to the optimization function <code>optimize</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cross-validation score is obtained by leaving in turn each curve out and computing the prediction error of the local polynomial smoother based on all other curves. For a bandwith value <code class="reqn">h</code>, this score is 
</p>
<p style="text-align: center;"><code class="reqn"> CV(h) = \frac{1}{np} \sum_{i=1}^n \sum_{j=1}^p \left( Y_{ij} - \hat{\mu}^{-(i)}(x_j;h) \right)^2, </code>
</p>

<p>where <code class="reqn">Y_{ij}</code> is the measurement of the <code class="reqn">i</code>-th curve at location <code class="reqn">x_j</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,p</code>, and <code class="reqn">\hat{\mu}^{-(i)}(x_j;h)</code> is the local polynomial estimator with bandwidth <code class="reqn">h</code> based on all curves except the <code class="reqn">i</code>-th.
</p>
<p>If the <code>x</code> values are not equally spaced, the data are first smoothed and evaluated on a grid of length <code>gridsize</code> spanning the range of <code>x</code>. The smoothed data are then interpolated back to <code>x</code>. 
</p>
<p><code>cv.select</code> uses the standard R function <code>optimize</code> to optimize <code>cv.score</code>. If the argument <code>interval</code> is not specified, the lower bound of the search interval is by default <code class="reqn">(x_2-x_1)/2</code> if <code class="reqn">degree &lt; 2</code> and <code class="reqn">x_2-x_1</code> if <code class="reqn">degree &gt;= 2</code>. The default value of the upper bound is <code class="reqn">(\max(x)-\min(x))/2</code>. These values guarantee in most cases that the local polynomial estimator is well defined. It is often useful to plot the function to be optimized for a range of argument values (grid search) before applying a numerical optimizer. In this way, the search interval can be narrowed down and the optimizer is more likely to find a global solution.  
</p>


<h3>Value</h3>

<p>a bandwidth that minimizes the cross-validation score. 
</p>


<h3>References</h3>

<p>Rice, J. A. and Silverman, B. W. (1991). Estimating the mean and covariance structure nonparametrically when the data are curves. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <b>53</b>, 233â€“243.
</p>


<h3>See Also</h3>

<p><code>cv.score</code>, <code>plugin.select</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Plasma citrate data
## Compare cross-validation scores and bandwidths  
## for local linear and local quadratic smoothing

data(plasma)
time &lt;- 8:21   				
## Local linear smoothing						
cv.select(time, plasma, 1)	# local solution h = 3.76, S(h) = 463.08			
cv.select(time, plasma, 1, interval = c(.5, 1))	# global solution = .75, S(h) = 439.54

## Local quadratic smoothing						
cv.select(time, plasma, 2)	# global solution h = 1.15, S(h) = 432.75			
cv.select(time, plasma, 2, interval = c(1, 1.5))	# same

## End(Not run)
</code></pre>


</div>