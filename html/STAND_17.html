<div class="container">

<table style="width: 100%;"><tr>
<td>percentile.exact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate of Xp and Exact Confidence Limits for Normal/Lognormal </h2>

<h3>Description</h3>

<p>Calculate estimate of Xp the 100*p percentile of the
normal/lognormal distribution, and the lower and upper 100*<code class="reqn">\gamma</code>% exact
confidence limits. The resulting interval (Xp.LCL,Xp.UCL) is an
approximate <code class="reqn">100*(2\gamma - 1)</code> percent confidence interval for
Xp the 100*p percentile. This function should only be used for complete samples.</p>


<h3>Usage</h3>

<pre><code class="language-R">percentile.exact(x, p = 0.95, gam = 0.95,logx=TRUE,wpnt=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of positive data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>probability for Xp the 100p<em>th</em> percentile. Default is 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>one-sided confidence level <code class="reqn">\gamma</code>. Default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logx</code></td>
<td>
<p>If <code>TRUE</code>, sample is from lognormal, else normal. Default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wpnt</code></td>
<td>
<p>if <code>TRUE</code>, show warning from pnt. Default is <code class="reqn">FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A point estimate of Xp, the 100p<em>th</em> percentile of a normal/lognormal
distribution is calculated.  Exact confidence limits for Xp are
calculated using the quantile function of the non-central t
distribution.  The exact UCL is <code class="reqn">m + K*s</code>, where <code class="reqn">m</code> is the sample mean, <code class="reqn">s</code>
is the sample standard deviation, and the <code class="reqn">K factor</code> depends on <code class="reqn">n, p,</code> and
<code class="reqn">\gamma</code>.  The exact LCL is <code class="reqn">m + K'*s</code>.  The local function
<code>kf</code> calculates <code class="reqn">K</code> and <code class="reqn">K'</code> using the quantile
function of the non-central t distribution <code>qt</code>.
</p>
<p>The null hypothesis <code class="reqn">Ho: Xp \ge Lp</code> is rejected at the <code class="reqn">\alpha = (1- \gamma )</code> 
significance level if the <code class="reqn">100\gamma\%</code> UCL for Xp
is less than the specified limit Lp (indicating the exposure profile is acceptable).
</p>


<h3>Value</h3>

<p>A LIST with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Xp</code></td>
<td>
<p> estimate of the p<em>th</em> percentile of the distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xpe.LCL</code></td>
<td>
 <p><code class="reqn">100*\gamma</code>% exact lower confidence limit for Xp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xpe.UCL</code></td>
<td>
 <p><code class="reqn">100*\gamma</code>% exact upper confidence limit for Xp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>probability for Xp the 100p<em>th</em> percentile. Default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>one-sided confidence level <code class="reqn">\gamma</code>. Default is 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Logx</code></td>
<td>
<p>If <code>TRUE</code>, sample is from lognormal, else normal. Default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ku</code></td>
<td>
<p>the K factor used to calculate the exact UCL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kl</code></td>
<td>
<p>the K' factor used to calculate the exact LCL</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The UCL is also referred to as an upper tolerance limit,
i.e., if <code>p</code> = 0.95 and <code class="reqn">\gamma</code> = 0.99 then Xpe.UCL is the exact UTL 95% - 99%.
</p>


<h3>Author(s)</h3>

<p>E. L. Frome </p>


<h3>References</h3>

<p>Burrows, G. L. (1963), "Statistical Tolerance Limits - What are They,"
<em>Applied Statistics</em>, 12, 133-144.
</p>
<p>Johnson, N. L. and B. L. Welch (1940), "Application of the Non-Central
t-Distribution," <em>Biometrika</em>, 31(3/4), 362-389.
</p>
<p>Lyles R. H. and L. L. Kupper (1996), "On Strategies for Comparing Occupational
Exposure Data to Limits,"  <em>American Industrial Hygiene Association
Journal</em>, 57:6-15.
</p>
<p>Tuggle, R. M. (1982), "Assessment of Occupational Exposure Using
One-Sided Tolerance Limits," <em>American Industrial Hygiene Association
Journal</em>, 43, 338-346.
</p>
<p>Frome, E. L. and Wambach, P. F. (2005), "Statistical Methods and Software for 
the Analysis of Occupational Exposure Data with Non-Detectable Values," 
<em>ORNL/TM-2005/52,Oak Ridge National Laboratory</em>, Oak Ridge, TN 37830.
Available at: <a href="http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf">http://www.csm.ornl.gov/esh/aoed/ORNLTM2005-52.pdf</a>
</p>
<p>Ignacio, J. S. and W. H. Bullock (2006), <em>A Strategy for Assesing
and Managing Occupational Exposures</em>, Third Edition, AIHA Press,
Fairfax, VA.
</p>
<p>Mulhausen, J. R. and J. Damiano (1998), <em> A Strategy for Assessing
and Managing Occupational Exposures</em>, Second Edition, AIHA Press, Fairfax, VA.
</p>


<h3>See Also</h3>

<p> Help files for <code>percentile.ml</code>,
<code>efraction.exact</code>, <code>aihand</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">#                      EXAMPLE 1
# calculate 95th percentile and exact CLs for Example data
# Appendix  Mulhausen and Damiano (1998)
data(aihand)
x &lt;- aihand$x ;  det &lt;- rep(1,length(x))
aiha &lt;- data.frame(x,det) #  complete data
unlist(percentile.exact(x,gam=0.95,p=0.95) )[1:5]  #  exact CLs
unlist(percentile.ml(aiha,gam=0.95,p=0.95))   #  ML CLs
#                      EXAMPLE 2
#  Ignacio and Bullock (2006) Mulhausen and Damiano (1998)
#  Calculate TABLE VII.3 (page 272) Factor for One-Sided Tolerance
#  Limits for Normal Distribution (Abridged Version)
#  Same as Table III Burrows(1963) Panel 3 Page 138
nn &lt;- c(seq(3,25),seq(30,50,5))
pv &lt;-c(0.75,0.9,0.95,0.99,0.999)
tab &lt;- matrix(0,length(nn),length(pv))
  for( k in (1:length(nn) ) ){
  xx &lt;- seq(1,nn[k])
  for(j in (1:length(pv))) {
  tab[k,j ]&lt;- percentile.exact(xx,pv[j],gam=0.95,FALSE)$Ku
}}
dimnames(tab)&lt;-(list(nn,pv)) ; rm(nn,pv,xx)
round(tab,3)
#
#                      EXAMPLE 3
#  Calculate TABLE I One Sided Tolerance Factor K'
#  Tuggle(1982) Page 339 (Abridged Version)
nn &lt;- c(seq(3,20),50,50000000)
pv &lt;-c(0.9,0.95,0.99)
tab &lt;- matrix(0,length(nn),length(pv))
  for( k in (1:length(nn) ) ){
  xx &lt;- seq(1,nn[k])
  for(j in (1:length(pv))) {
  tab[k,j ]&lt;- percentile.exact(xx,pv[j],gam=0.95,FALSE)$Kl
}}
dimnames(tab)&lt;-(list(nn,pv)) ; rm(nn,pv,xx)
round(tab,3)
</code></pre>


</div>