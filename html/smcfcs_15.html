<div class="container">

<table style="width: 100%;"><tr>
<td>smcfcs.finegray</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Substantive model compatible fully conditional specification imputation of
covariates for a Fine-Gray model</h2>

<h3>Description</h3>

<p>Multiply imputes missing covariate values using substantive model compatible
fully conditional specification for competing risks outcomes, when the
substantive model is a Fine-Gray model for the subdistribution hazard of one event.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smcfcs.finegray(
  originaldata,
  smformula,
  method,
  cause = 1,
  m = 5,
  numit = 10,
  rjlimit = 5000,
  kmi_args = list(formula = ~1, bootstrap = FALSE, nboot = 10),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>originaldata</code></td>
<td>
<p>The original data frame with missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smformula</code></td>
<td>
<p>The formula of the substantive model, given as a string. Needs to
be of the form "Surv(t, d) ~ x1 + x2", where t is a vector of competing event
times, and d is a (numeric) competing event indicator, where 0 must designate
a censored observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A required vector of strings specifying for each variable either
that it does not need to be imputed (""), the type of regression model to be
be used to impute. Possible values are <code>"norm"</code> (normal linear regression),
<code>"logreg"</code> (logistic regression), <code>"brlogreg"</code> (bias reduced logistic regression),
<code>"poisson"</code> (Poisson regression),
<code>"podds"</code> (proportional odds regression for ordered categorical variables),
<code>"mlogit"</code> (multinomial logistic regression for unordered categorical variables),
or a custom expression which defines a passively imputed variable, e.g.
<code>"x^2"</code> or <code>"x1*x2"</code>. <code>"latnorm"</code> indicates the variable is a latent
normal variable which is measured with error. If this is specified for a variable,
the <code>"errorProneMatrix"</code> argument should also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cause</code></td>
<td>
<p>Numeric, designating the competing event of interest (default is
'cause = 1').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of imputed datasets to generate. The default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numit</code></td>
<td>
<p>The number of iterations to run when generating each imputation.
In a (limited) range of simulations good performance was obtained with the
default of 10 iterations. However, particularly when the proportion of missingness
is large, more iterations may be required for convergence to stationarity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rjlimit</code></td>
<td>
<p>Specifies the maximum number of attempts which should be made
when using rejection sampling to draw from imputation models. If the limit is reached
when running a warning will be issued. In this case it is probably advisable to
increase the <code>rjlimit</code> until the warning does not appear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmi_args</code></td>
<td>
<p>List, containing arguments to be passed on to kmi.
The "formula" element is a formula where the right-hand side specifies the
covariates used for multiply imputing the potential censoring times for
individual's failing from competing events. The default is 'formula = ~ 1',
which uses marginal Kaplan-Meier estimator of the censoring distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass on to smcfcs</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the presence of random right censoring, the function first multiply imputes
the potential censoring times for those failing from competing events using
kmi, and thereafter uses smcfcs to impute the missing
covariates. See Bonneville <em>et al.</em> 2024 for further details on the methodology.
</p>
<p>The function does not (yet) support parallel computation.
</p>


<h3>Value</h3>

<p>An object of type "smcfcs", as would usually be returned from
smcfcs.
</p>


<h3>Author(s)</h3>

<p>Edouard F. Bonneville <a href="mailto:e.f.bonneville@lumc.nl">e.f.bonneville@lumc.nl</a>
</p>


<h3>References</h3>

<p>Bonneville EF, Beyersmann J, Keogh RH, Bartlett JW, Morris TP,
Polverelli N, de Wreede LC, Putter H. Multiple imputation of missing covariates
when using the Fineâ€“Gray model. 2024. Submitted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(survival)
library(kmi)

imps &lt;- smcfcs.finegray(
  originaldata = ex_finegray,
  smformula = "Surv(times, d) ~ x1 + x2",
  method = c("", "", "logreg", "norm"),
  cause = 1,
  kmi_args = list("formula" = ~ 1)
)

if (requireNamespace("mitools", quietly = TRUE)) {
  library(mitools)
  impobj &lt;- imputationList(imps$impDatasets)
  # Important: use Surv(newtimes, newevent) ~ ... when pooling
  # (respectively: subdistribution time and indicator for cause of interest)
  models &lt;- with(impobj, coxph(Surv(newtimes, newevent) ~ x1 + x2))
  summary(MIcombine(models))
}

## End(Not run)

</code></pre>


</div>