<div class="container">

<table style="width: 100%;"><tr>
<td>smfishHmrf.generate.centroid.it</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate cluster centroids, where input is a file.</h2>

<h3>Description</h3>

<p>This function generates cluster centroids from applying kmeans. It accepts an expression matrix file as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smfishHmrf.generate.centroid.it(
  expr_file,
  par_k,
  par_seed = -1,
  nstart,
  name = "test",
  output_dir = "."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr_file</code></td>
<td>
<p>expression matrix file. The expression file should be a space-separated file. The rows are genes. The columns are cells. There is no header row. The first column is a gene index (ranges from 1 to the number of genes). Note the first column is not gene name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_k</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_seed</code></td>
<td>
<p>random generator seed (-1 if no fixing). Change the par_seed to vary the initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>number of starts (kmeans). It is recommended to set nstart to at least 100 (preferrably 1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name of this run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_dir</code></td>
<td>
<p>output directory; where to store the kmeans results</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that after running kmeans step, the function also automatically saves the kmeans results to the <code>output_dir</code> directory. The results will be found in two files:
</p>

<ol>
<li> <p><code>{output_dir}</code>/k_<code>{par_k}</code>/f<code>{name}</code>.gene.ALL.centroid.txt
</p>
</li>
<li> <p><code>{output_dir}</code>/k_<code>{par_k}</code>/f<code>{name}</code>.gene.ALL.kmeans.txt
</p>
</li>
</ol>
<p>where <code>{}</code> refers to the value of parameters.
</p>


<h3>Value</h3>

<p>A kmeans object which is a list with centers and cluster fields
</p>


<h3>Examples</h3>

<pre><code class="language-R">mem_file = system.file("extdata", "ftest.expression.txt", package="smfishHmrf")
kk = smfishHmrf.generate.centroid.it(mem_file, par_k=9, par_seed=100, 
    nstart=100, name="test", output_dir=tempdir())
</code></pre>


</div>