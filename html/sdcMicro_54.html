<div class="container">

<table style="width: 100%;"><tr>
<td>pram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Post Randomization</h2>

<h3>Description</h3>

<p>To be used on categorical data stored as factors. The algorithm randomly
changes the values of variables in selected records (usually the risky ones)
according to an invariant probability transition matrix or a custom-defined
transition matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pram(obj, variables = NULL, strata_variables = NULL, pd = 0.8, alpha = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Input data. Allowed input data are objects of class
<code>data.frame</code>, <code>factor</code> or sdcMicroObj.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>Names of variables in <code>obj</code> on which post-randomization
should be applied. If <code>obj</code> is a factor, this argument is ignored. Please note that
pram can only be applied to factor-variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata_variables</code></td>
<td>
<p>names of variables for stratification (will be set
automatically for an object of class sdcMicroObj. One can also specify
an integer vector or factor that specifies that desired groups. This vector must match the dimension
of the input data set, however. For a possible use case, have a look at the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>minimum diagonal entries for the generated transition matrix P.
Either a vector of length 1 (which is recycled) or a vector of the same length as
the number of variables that should be postrandomized. It is also possible to set <code>pd</code>
to a numeric matrix. This matrix will be used directly as the transition matrix. The matrix must
be constructed as follows:
</p>

<ul>
<li>
<p> the matrix must be a square matrix
</p>
</li>
<li>
<p> the rownames and colnames of the matrix must match the levels (in the same order) of the factor-variable that should be
postrandomized.
</p>
</li>
<li>
<p> the rowSums and colSums of the matrix need to equal 1
</p>
</li>
</ul>
<p>It is also possible to combine the different ways. For details have a look at the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>amount of perturbation for the invariant Pram method. This is a numeric vector
of length 1 (that will be recycled if necessary) or a vector of the same length as the number
of variables. If one specified as transition matrix directly, <code>alpha</code> is ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a modified sdcMicroObj object or a new object containing
original and post-randomized variables (with suffix "_pram").
</p>


<h3>Note</h3>

<p>Deprecated method 'pram_strata' is no longer available
in sdcMicro &gt; 4.5.0
</p>


<h3>Author(s)</h3>

<p>Alexander Kowarik, Matthias Templ, Bernhard Meindl
</p>


<h3>References</h3>

<p><a href="https://www.gnu.org/software/glpk/">https://www.gnu.org/software/glpk/</a>
</p>
<p>Kowarik, A. and Templ, M. and Meindl, B. and Fonteneau, F. and Prantner, B.:
<em>Testing of IHSN Cpp Code and Inclusion of New Methods into sdcMicro</em>,
in: Lecture Notes in Computer Science, J. Domingo-Ferrer, I. Tinnirello
(editors.); Springer, Berlin, 2012, ISBN: 978-3-642-33626-3, pp. 63-77.
<a href="https://doi.org/10.1007/978-3-642-33627-0_6">doi:10.1007/978-3-642-33627-0_6</a>
</p>
<p>Templ, M. and Kowarik, A. and Meindl, B.: <em>Statistical Disclosure Control for
Micro-Data Using the R Package sdcMicro.</em> in: Journal of Statistical Software, <strong>67</strong> (4), 1â€“36, 2015. <a href="https://doi.org/10.18637/jss.v067.i04">doi:10.18637/jss.v067.i04</a>
</p>
<p>Templ, M.: <em>Statistical Disclosure Control for Microdata: Methods and Applications in R.</em>
in: Springer International Publishing, 287 pages, 2017. ISBN 978-3-319-50272-4.
<a href="https://doi.org/10.1007/978-3-319-50272-4">doi:10.1007/978-3-319-50272-4</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(testdata)

## donttest is necessary because of 
## Examples with CPU time &gt; 2.5 times elapsed time
## caused by using C++ code and/or data.table
## using a factor variable as input
res &lt;- pram(as.factor(testdata$roof))
print(res)
summary(res)

## using a data.frame as input
## pram can only be applied to factors
## -- &gt; we have to recode to factors beforehand
testdata$roof &lt;- factor(testdata$roof)
testdata$walls &lt;- factor(testdata$walls)
testdata$water &lt;- factor(testdata$water)

## pram() is applied within subgroups defined by
## variables "urbrur" and "sex"
res &lt;- pram(
  obj = testdata,
  variables = "roof",
 strata_variables = c("urbrur", "sex"))
print(res)
summary(res)

## default parameters (pd = 0.8 and alpha = 0.5) for the generation
## of the invariant transition matrix will be used for all variables
res1 &lt;- pram(
  obj = testdata,
  variables = c("roof", "walls", "water"))
print(res1)

## specific parameter settings for each variable
res2 &lt;- pram(
   obj = testdata,
   variables = c("roof", "walls", "water"),
   pd = c(0.95, 0.8, 0.9),
   alpha = 0.5)
print(res2)

## detailed information on pram-parameters (such as the transition matrix 'Rs')
## is stored in the output, eg. for variable 'roof'
#attr(res2, "pram_params")$roof
## we can also specify a custom transition-matrix directly
mat &lt;- diag(length(levels(testdata$roof)))
rownames(mat) &lt;- colnames(mat) &lt;- levels(testdata$roof)
res3 &lt;- pram(
   obj = testdata,
   variables = "roof",
  pd = mat)
print(res3) # of course, nothing has changed!
## it is possible use a transition matrix for a variable and use the 'traditional' way
## of specifying a number for the minimal diagonal entries of the transision matrix
## for other variables. In this case we must supply `pd` as list.
res4 &lt;- pram(
  obj = testdata,
  variables = c("roof", "walls"),
  pd = list(mat, 0.5),
  alpha = c(NA, 0.5))
print(res4)
summary(res4)
attr(res4, "pram_params")

## application to objects of class sdcMicro with default parameters
data(testdata2)
testdata2$urbrur &lt;- factor(testdata2$urbrur)
sdc &lt;- createSdcObj(
  dat = testdata2,
  keyVars = c("roof", "walls", "water", "electcon", "relat", "sex"),
  numVars = c("expend", "income", "savings"),
  w = "sampling_weight")
sdc &lt;- pram(
  obj = sdc,
  variables = "urbrur")
print(sdc, type = "pram")

## this is equal to the previous application. If argument 'variables' is NULL,
## all variables from slot 'pramVars' will be used if possible.
sdc &lt;- createSdcObj(
   dat = testdata2,
  keyVars = c("roof", "walls", "water", "electcon", "relat", "sex"),
  numVars = c("expend", "income", "savings"),
  w = "sampling_weight",
  pramVars = "urbrur")
sdc &lt;- pram(sdc)
print(sdc, type="pram")

## we can specify transition matrices for sdcMicroObj-objects too
#testdata2$roof &lt;- factor(testdata2$roof)
sdc &lt;- createSdcObj(
  dat = testdata2,
  keyVars = c("roof", "walls", "water", "electcon", "relat", "sex"),
  numVars = c("expend", "income", "savings"),
  w = "sampling_weight")
mat &lt;- diag(length(levels(testdata2$roof)))

rownames(mat) &lt;- colnames(mat) &lt;- levels(testdata2$roof)
mat[1,] &lt;- c(0.9, 0, 0, 0.05, 0.05)
sdc &lt;- pram(
   obj = sdc,
   variables = "roof",
   pd = mat)
print(sdc, type = "pram")

## we can also have a look at the transitions
get.sdcMicroObj(sdc, "pram")$transitions

</code></pre>


</div>