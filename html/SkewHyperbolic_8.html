<div class="container">

<table style="width: 100%;"><tr>
<td>skewhypFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit the Skew Hyperbolic Student t-Distribution to Data
</h2>

<h3>Description</h3>

<p>Fits a skew hyperbolic <em>t</em>-distribution to given data.
Displays the histogram, log-histogram (both with fitted densities),
Q-Q plot and P-P plot for the fit which has maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">skewhypFit(x, freq = NULL, breaks = NULL, startValues = "LA",
           paramStart = NULL, method = "Nelder-Mead", hessian = TRUE,
           plots = FALSE, printOut = TRUE, controlBFGS = list(maxit = 200),
           controlNM = list(maxit = 1000), maxitNLM = 1500, ...)
## S3 method for class 'skewhypFit'
plot(x, which = 1:4,
     plotTitles = paste(c("Histogram of ", "Log-Histogram of ",
     "Q-Q Plot of ", "P-P Plot of "), x$obsName, sep = ""),
     ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ...)
## S3 method for class 'skewhypFit'
print(x,digits = max(3, getOption("digits") - 3),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data vector for <code>skewhypFit</code>. Object of class
<code>"skewhypFit"</code> for <code>print.skewhypFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>Vector of weights with length equal to length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Breaks for histogram, defaults to those generated by
<code>hist(x, plot = FALSE, right = FALSE).</code>If <code>startValues = "LA"</code>
then 30 breaks are used by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValues</code></td>
<td>
<p>Code giving the method of determining starting
values for finding the maximum likelihood estimates of the
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramStart</code></td>
<td>
<p>If <code>startValues = "US"</code> the
user must specify a vector of starting parameter values in the form
<code>c(mu,delta,beta,nu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Different optimisation methods to consider, see
<b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Logical; if <code>hessian = TRUE</code> the value of the
hessian is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>Logical; if <code>plots = TRUE</code> the histogram,
log-histogram, Q-Q and P-P plots are printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printOut</code></td>
<td>
<p>Logical; if <code>printOut = TRUE</code> results of the
fitting are printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlBFGS</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"BFGS"</code> optimisation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlNM</code></td>
<td>
<p>A list of control parameters for <code>optim</code>
when using the <code>"Nelder-Mead"</code> optimisation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitNLM</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations when using the <code>"nlm"</code> optimisation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If a subset of plots is required, specify a subset of the
numbers <code>1:4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotTitles</code></td>
<td>
<p>Titles to appear above the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Logical; if <code>TRUE</code> the user is asked before plot
change, see <code>par(ask = .)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Desired number of digits when the object is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passes arguments to <code>optim</code>, <code>nlm</code>,
<code>hist</code>, <code>logHist</code>,
<code>qqskewhyp</code> and <code>ppskewhyp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>startValues</code> can be either <code>"US"</code>(User-supplied) or
<code>"LA"</code> (Linear approximation)
If <code>startValues = "US"</code> then a value for <code>paramStart</code> must be
supplied. For the details concerning the use of <code>startValues</code>
and <code>paramStart</code> see <code>skewhypFitStart</code>.
</p>
<p>The three optimisation methods currently available are:
</p>

<dl>
<dt><code>"BFGS"</code></dt>
<dd>
<p>Uses the quasi-Newton method <code>"BFGS"</code> as
documented in <code>optim</code>.</p>
</dd>
<dt><code>"Nelder-Mead"</code></dt>
<dd>
<p>Uses an implementation of the Nelder and
Mead method as documented in <code>optim</code>.</p>
</dd>
<dt><code>"nlm"</code></dt>
<dd>
<p>Uses the <code>nlm</code> function in R.</p>
</dd>
</dl>
<p>For the details of how to pass control information using
<code>optim</code> and <code>nlm</code>, see <code>optim</code> and
<code>nlm.</code>
</p>


<h3>Value</h3>

<p><code>skewhypFit</code> returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A vector giving the maximum likelihood estimates of the
parameters in the form <code>c(mu,delta,beta,nu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLik</code></td>
<td>
<p>The value of the maximised log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>If <code>hessian</code> was set to <code>TRUE</code>, the value of
the hessian, not present otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimisation method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>Convergence code. See <code>optim</code> or
<code>nlm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations of optimisation routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data used to fit the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xName</code></td>
<td>
<p>Character string with the actual <code>x</code> argument name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramStart</code></td>
<td>
<p>Starting values of the parameters returned by
<code>skewhypFitStart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svName</code></td>
<td>
<p>Name of the method used to find starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValues</code></td>
<td>
<p>Acronym of method used to find starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Cell boundaries found by a call to <code>hist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code>hist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code>hist</code> if <code>startValues = "US"</code>, or
<code>density</code> if <code>startValues = "LA"</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275â€“309.
</p>


<h3>See Also</h3>

<p><code>optim</code>, <code>nlm</code>, <code>par</code>,
<code>hist</code>, <code>density,</code>
<code>logHist</code>,
<code>qqskewhyp</code>, <code>ppskewhyp</code>,
<code>dskewhyp</code> and <code>skewhypFitStart</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See how well skewhypFit works
param &lt;- c(0, 1, 4, 10)
data &lt;- rskewhyp(500, param = param)
fit &lt;- skewhypFit(data)
## Use data set NOK/EUR as per Aas&amp;Haff
data(lrnokeur)
nkfit &lt;- skewhypFit(lrnokeur, method = "nlm")
## Use data set DJI
data(lrdji)
djfit &lt;- skewhypFit(lrdji)
</code></pre>


</div>