<div class="container">

<table style="width: 100%;"><tr>
<td>spreml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial Panel Model with Random Effects by Maximum Likelihood</h2>

<h3>Description</h3>

<p>Maximum likelihood (ML) estimation of spatial panel models
with random effects and serial error correlation.</p>


<h3>Usage</h3>

<pre><code class="language-R">spreml(formula, data, index = NULL, w, w2=w, lag = FALSE,
          errors = c("semsrre", "semsr", "srre", "semre",
                     "re", "sr", "sem","ols", "sem2srre",
                     "sem2re", "semgre"),
          pvar = FALSE, hess = FALSE, quiet = TRUE,
          initval = c("zeros", "estimate"),
          x.tol = 1.5e-18, rel.tol = 1e-15, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. A data frame containing the variables
in the model. When the object is a <code>data.frame</code>, the first two columns shall contain the indexes, unless otherwise specified. See <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an object of class <code>listw</code> or a <code>matrix</code>. It represents the spatial weights to be used in estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w2</code></td>
<td>
<p>an object of class <code>listw</code> or a
<code>matrix</code>. Second set of spatial weights for estimation, if
different from the first (e.g., in a 'sarar' model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code>, a spatial lag of the dependent variable is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>Specifies the error covariance structure. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvar</code></td>
<td>
<p>legacy parameter here only for compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code> estimate the
covariance for beta_hat by numerical Hessian instead of GLS at optimal
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>default=<code>TRUE</code>. If <code>FALSE</code>, report function and
parameters values during optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initval</code></td>
<td>
<p>one of <code>c("zeros", "estimate")</code>, the initial values for
the parameters. If <code>"zeros"</code> a vector of zeros is used. if
<code>"estimate"</code> the initial values are retreived from the estimation
of the nested specifications. Alternatively, a numeric vector can be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.tol</code></td>
<td>
<p>control parameter for tolerance. See <code>nlminb</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>control parameter for relative tolerance. See <code>nlminb</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass over to other functions, e.g. <code>method</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Second-level wrapper for estimation of random effects models
with serial and spatial correlation. The specifications without serial
correlation (no "sr" in <code>errors</code>) can be called through
<code>spml</code>, the extended ones only through <code>spreml</code>. 
The models are estimated by two-step Maximum Likelihood.
Abbreviations in <code>errors</code> correspond to: <code>"sem"</code>
Anselin-Baltagi type spatial autoregressive error: if
present, random effects are not spatially correlated;  <code>"sem2"</code>
Kapoor, Kelejian and Prucha-type spatial autoregressive error model
with spatially correlated random effects; <code>"sr"</code> serially
correlated remainder errors; <code>"re"</code> random effects; <code>"ols"</code>
spherical errors (usually combined with <code>lag=T</code>).
The optimization <code>method</code> can be passed on as optional
parameter. Default is <code>"nlminb"</code>; all constrained optimization
methods from <code>maxLik</code> are allowed (<code>"BFGS", "NM", "SANN"</code>)
but the latter two are still experimental.
</p>


<h3>Value</h3>

<p>An object of class <code>"splm"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>coefficients estimate of the model parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arcoef</code></td>
<td>
<p>the coefficient for the spatial lag on <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errcomp</code></td>
<td>
<p>the estimates of the error variance components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>the asymptotic variance covariance matrix of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.arcoef</code></td>
<td>
<p>the asymptotic variance of the
estimated spatial lag parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.errcomp</code></td>
<td>
<p>the asymptotic variance covariance matrix of the
estimated error covariance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>'random effects ML'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the model residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted values, calculated as <code class="reqn">\hat{y}=X \hat{\beta}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>GLS residuals variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the matrix of the data used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call used to create the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the value of the log likelihood function at the optimum </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>the value of the <code>errors</code> argument</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Millo, G. (2014)
Maximum likelihood estimation of spatially and serially correlated
panels with random effects. <em>Computational Statistics and Data
Analysis</em>, <b>71</b>, 914â€“933.
</p>


<h3>See Also</h3>

<p><code>spml</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## random effects panel with spatial lag and serial error correlation
## optimization method set to "BFGS"
sarsrmod &lt;- spreml(fm, data = Produc, w = usaww, errors="sr", lag=TRUE,
                    method="BFGS")
summary(sarsrmod)
</code></pre>


</div>