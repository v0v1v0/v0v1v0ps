<div class="container">

<table style="width: 100%;"><tr>
<td>stratified.random</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratified random sample</h2>

<h3>Description</h3>

<p>Creates a stratified random sample of an sp class object
</p>


<h3>Usage</h3>

<pre><code class="language-R">stratified.random(x, strata, n = 10, reps = 1, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An sf class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Column in x with stratification factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of random samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Number of replicates per strata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace</code></td>
<td>
<p>(TRUE/FALSE) Sampling with replacement</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If replace=FALSE features are removed from consideration in subsequent replicates.
Conversely, if replace=TRUE, a feature can be selected multiple times across 
replicates. Not applicable if rep=1.
</p>


<h3>Value</h3>

<p>An sf class object containing random samples
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt;
</p>


<h3>References</h3>

<p>Hudak, A.T., N.L. Crookston, J.S. Evans, M.J. Falkowski, A.M.S. Smith, P. Gessler 
and P. Morgan. (2006) Regression modelling and mapping of coniferous forest basal 
area and tree density from discrete-return lidar and multispectral satellite data. 
Canadian Journal of Remote Sensing 32: 126-138.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require(sp, quietly = TRUE)) {
library(sf)
  data(meuse, package = "sp")
  meuse &lt;- st_as_sf(meuse, coords = c("x", "y"), crs = 28992, 
                    agr = "constant")

# Create stratified variable using quartile breaks
x1 &lt;- cut(meuse$cadmium, summary(meuse$cadmium)[-4], 
          include.lowest=TRUE)
  levels(x1) &lt;- seq(1,nlevels(x1),1)
x2 &lt;- cut(meuse$lead, summary(meuse$lead)[-4], 
          include.lowest=TRUE)
  levels(x2) &lt;- seq(1,nlevels(x2),1) 
meuse$STRAT &lt;- paste(x1, x2, sep='.')

# Counts for each full strata (note; 2 strata have only 1 observation)
tapply(meuse$STRAT, meuse$STRAT, length)
   
# 2 replicates, 2 samples with replacement
ssample &lt;- stratified.random(meuse, strata='STRAT', n=2, reps=2, 
                             replace=TRUE)
  tapply(ssample$STRAT, ssample$STRAT, length)

# 2 replicates, 2 samples no replacement
ssample.nr &lt;- stratified.random(meuse, strata='STRAT', n=2, reps=2)
  tapply(ssample.nr$STRAT, ssample.nr$STRAT, length)

# n=1 and reps=10 for sequential numbering of samples 
ssample.ct &lt;- stratified.random(meuse, strata='STRAT', n=1, reps=10, 
                                replace=TRUE)
  tapply(ssample.ct$STRAT, ssample.ct$STRAT, length)

# Plot random samples colored by replacement
ssample$REP &lt;- factor(ssample$REP)
  plot(ssample['REP'], pch=20)

} else { 
  cat("Please install sp package to run example", "\n")
}

</code></pre>


</div>