<div class="container">

<table style="width: 100%;"><tr>
<td>scBSP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Granularity-Based Approach to identify Spatially Variable Genes</h2>

<h3>Description</h3>

<p>This function is designed to identify spatially variable genes through a granularity-based approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scBSP(Coords, ExpMat_Sp, D_1 = 1.0, D_2 = 3.0, 
Exp_Norm = TRUE, Coords_Norm_Method = c("Sliced", "Overall", "None"), 
K_NN = 100, treetype = "kd")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Coords</code></td>
<td>
<p>A M x D matrix representing D-dimensional coordinates for M spots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ExpMat_Sp</code></td>
<td>
<p>A sparse, N x M expression matrix in dgCMatrix class with N genes and M spots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_1</code></td>
<td>
<p>Size of the small patch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D_2</code></td>
<td>
<p>Size of the big patch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Exp_Norm</code></td>
<td>
<p>A Boolean value indicating whether the expression matrix should be normalized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Coords_Norm_Method</code></td>
<td>
<p>Normalization method for the coordinates matrix, which can be "None", "Sliced", or "Overall".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_NN</code></td>
<td>
<p>The maximum number of nearest neighbours to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treetype</code></td>
<td>
<p>Character vector specifying the standard 'kd' tree or a 'bd' (box-decomposition, AMNSW98) tree which may perform better for larger point sets.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function utilizes a MxD matrix (Coords) representing D-dimensional coordinates with M spots and a sparse, NxM expression matrix (ExpMat_Sp) with N genes and M spots.
</p>


<h3>Value</h3>

<p>A data frame with the name of genes and corresponding p-values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Coords &lt;- expand.grid(1:100,1:100, 1:3)
RandFunc &lt;- function(n) floor(10 * stats::rbeta(n, 1, 5))
Raw_Exp &lt;- Matrix::rsparsematrix(nrow = 10^4, ncol = 3*10^4, density = 0.0001, rand.x = RandFunc)
Filtered_ExpMat &lt;- SpFilter(Raw_Exp)
rownames(Filtered_ExpMat) &lt;- paste0("Gene_", 1:nrow(Filtered_ExpMat))
P_values &lt;- scBSP(Coords, Filtered_ExpMat)
</code></pre>


</div>