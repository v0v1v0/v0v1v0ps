<div class="container">

<table style="width: 100%;"><tr>
<td>lns2ewma.arl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute ARLs of EWMA ln <code class="reqn">S^2</code> control charts (variance charts)</h2>

<h3>Description</h3>

<p>Computation of the (zero-state) Average Run Length (ARL)
for different types of EWMA control charts 
(based on the log of the sample variance <code class="reqn">S^2</code>) monitoring normal variance.</p>


<h3>Usage</h3>

<pre><code class="language-R">lns2ewma.arl(l,cl,cu,sigma,df,hs=NULL,sided="upper",r=40)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>smoothing parameter lambda of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>lower control limit of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cu</code></td>
<td>
<p>upper control limit of the EWMA control chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>true standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>actual degrees of freedom, corresponds to subsample size (for known mean it is equal to the subsample size,
for unknown mean it is equal to subsample size minus one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>so-called headstart (enables fast initial response) â€“ the default value (hs=NULL) corresponds to the in-control
mean of ln <code class="reqn">S^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sided</code></td>
<td>
<p>distinguishes between one- and two-sided two-sided EWMA-<code class="reqn">S^2</code> control charts 
by choosing <code>"upper"</code> (upper chart with reflection at <code>cl</code>), <code>"lower"</code> (lower chart with reflection at <code>cu</code>),
and <code>"two"</code> (two-sided chart), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>dimension of the resulting linear equation system: the larger the better.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lns2ewma.arl</code> determines the Average Run Length (ARL) by numerically
solving the related ARL integral equation by means of the Nystroem method
based on Gauss-Legendre quadrature.</p>


<h3>Value</h3>

<p>Returns a single value which resembles the ARL.</p>


<h3>Author(s)</h3>

<p>Sven Knoth</p>


<h3>References</h3>

<p>S. V. Crowder and M. D. Hamilton (1992),
An EWMA for monitoring a process standard deviation,
<em>Journal of Quality Technology 24</em>, 12-21.
</p>
<p>S. Knoth (2005),
Accurate ARL computation for EWMA-<code class="reqn">S^2</code> control charts,
<em>Statistics and Computing 15</em>, 341-352.
</p>


<h3>See Also</h3>

<p><code>xewma.arl</code> for zero-state ARL computation of EWMA control charts for monitoring normal mean.
</p>


<h3>Examples</h3>

<pre><code class="language-R">lns2ewma.ARL &lt;- Vectorize("lns2ewma.arl", "sigma")

## Crowder/Hamilton (1992)
## moments of ln S^2
E_log_gamma &lt;- function(df) log(2/df) + digamma(df/2)
V_log_gamma &lt;- function(df) trigamma(df/2)
E_log_gamma_approx &lt;- function(df) -1/df - 1/3/df^2 + 2/15/df^4
V_log_gamma_approx &lt;- function(df) 2/df + 2/df^2 + 4/3/df^3 - 16/15/df^5

## results from Table 3 ( upper chart with reflection at 0 = log(sigma0=1) )
## original entries are (lambda = 0.05, K = 1.06, df=n-1=4)
# sigma   ARL
# 1       200
# 1.1      43
# 1.2      18
# 1.3      11
# 1.4       7.6
# 1.5       6.0
# 2         3.2

df &lt;- 4
lambda &lt;- .05
K &lt;- 1.06
cu &lt;- K * sqrt( lambda/(2-lambda) * V_log_gamma_approx(df) )

sigmas &lt;- c(1 + (0:5)/10, 2)
arls &lt;- round(lns2ewma.ARL(lambda, 0, cu, sigmas, df, hs=0, sided="upper"), digits=1)
data.frame(sigmas, arls)

## Knoth (2005)
## compare with Table 3 (p. 351)
lambda &lt;- .05
df &lt;- 4
K &lt;- 1.05521
cu &lt;- 1.05521 * sqrt( lambda/(2-lambda) * V_log_gamma_approx(df) )

## upper chart with reflection at sigma0=1 in Table 4
## original entries are
# sigma   ARL_0    ARL_-.267
# 1       200.0    200.0
# 1.1      43.04    41.55
# 1.2      18.10    19.92
# 1.3      10.75    13.11
# 1.4       7.63     9.93
# 1.5       5.97     8.11
# 2         3.17     4.67

M &lt;- -0.267
cuM &lt;- lns2ewma.crit(lambda, 200, df, cl=M, hs=M, r=60)[2]
arls1 &lt;- round(lns2ewma.ARL(lambda, 0, cu, sigmas, df, hs=0, sided="upper"), digits=2)
arls2 &lt;- round(lns2ewma.ARL(lambda, M, cuM, sigmas, df, hs=M, sided="upper", r=60), digits=2)
data.frame(sigmas, arls1, arls2)
</code></pre>


</div>