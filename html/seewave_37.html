<div class="container">

<table style="width: 100%;"><tr>
<td>diffenv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Difference between two amplitude envelopes</h2>

<h3>Description</h3>

<p>This function estimates the surface difference between
two amplitude envelopes.</p>


<h3>Usage</h3>

<pre><code class="language-R">diffenv(wave1, wave2, f, channel = c(1,1), envt = "hil", msmooth = NULL, ksmooth = NULL,
plot = FALSE, lty1 = 1, lty2 = 2, col1 = 2, col2 = 4, cold = 8,
xlab = "Time (s)", ylab = "Amplitude", ylim = NULL, legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave1</code></td>
<td>
<p>a first R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave2</code></td>
<td>
<p>a second R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>wave</code> (in Hz). Does not need to
be specified if embedded in <code>wave</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>channel of the R objects, by default left channel (1)
for each object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envt</code></td>
<td>
<p>the type of envelope to be used: either "abs" for absolute
amplitude envelope or "hil" for Hilbert amplitude envelope. See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msmooth</code></td>
<td>
<p>a vector of length 2 to smooth the amplitude envelope with a 
mean sliding window. The first component is the window length
(in number of points). The second component is the overlap between
successive windows (in %). See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksmooth</code></td>
<td>
<p>kernel smooth via <code>kernel</code>. See <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code> plots both envelopes and their surface
difference (by default <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty1</code></td>
<td>
<p>line type of the first envelope (envelope of <code>wave1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty2</code></td>
<td>
<p>line type of the second envelope (envelope of <code>wave2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1</code></td>
<td>
<p>colour of the first envelope (envelope of <code>wave1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>
<p>colour of the second envelope (envelope of <code>wave2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cold</code></td>
<td>
<p>colour of the surface difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>title of the time axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>title of the amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>range of amplitude axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>logical, if <code>TRUE</code> adds a legend to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>D is a Manhattan distance (l1 norm). <br>
Envelopes of both waves are first transformed as probability mass functions (PMF).<br>
Envelope difference is then computed according to:<br></p>
<p style="text-align: center;"><code class="reqn">D = \frac{\sum{|env1-env2|}}{2}, with D \in [0,1].</code>
</p>



<h3>Value</h3>

<p>The difference is returned. This value is without unit.
When <code>plot</code> is <code>TRUE</code>, both envelopes and their difference surface are
plotted on the same graph.
</p>


<h3>Note</h3>

<p>This method can be used as a relative distance estimation
between different envelopes.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur <a href="mailto:sueur@mnhn.fr">sueur@mnhn.fr</a>.</p>


<h3>References</h3>

<p>Sueur, J., Pavoine, S., Hamerlynck, O. &amp; Duvail, S. (2008) -
Rapid acoustic survey for biodiversity appraisal. <em>PLoS ONE</em>,
3(12): e4065.</p>


<h3>See Also</h3>

<p><code>env</code>, <code>corenv</code>, <code>diffspec</code>,
<code>diffwave</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(tico) ; tico &lt;- tico@left
data(orni) ; orni &lt;- orni@left
# selection in tico of two waves with similar duration
tico2&lt;-tico[1:length(orni)]
diffenv(tico2,orni,f=22050,plot=TRUE)
# smoothing the envelope gives a better graph but slightly changes the result
diffenv(tico2,orni,f=22050,msmooth=c(20,0),plot=TRUE)
</code></pre>


</div>