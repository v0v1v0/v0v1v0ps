<div class="container">

<table style="width: 100%;"><tr>
<td>elliptic.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Elliptical Spatial Scan Test</h2>

<h3>Description</h3>

<p><code>elliptic.test</code> performs the elliptical scan test of
Kulldorf et al. (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">elliptic.test(
  coords,
  cases,
  pop,
  ex = sum(cases)/sum(pop) * pop,
  nsim = 499,
  alpha = 0.1,
  ubpop = 0.5,
  shape = c(1, 1.5, 2, 3, 4, 5),
  nangle = c(1, 4, 6, 9, 12, 15),
  a = 0.5,
  cl = NULL,
  type = "poisson",
  min.cases = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>An <code class="reqn">n \times 2</code> matrix of centroid
coordinates for the regions in the form (x, y) or
(longitude, latitude) is using great circle distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases</code></td>
<td>
<p>The number of cases observed in each region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>The population size associated with each
region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>The expected number of cases for each region.
The default is calculated under the constant risk
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of simulations from which to
compute the p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level to determine whether
a cluster is signficant.  Default is 0.10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ubpop</code></td>
<td>
<p>The upperbound of the proportion of the
total population to consider for a cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>The ratios of the major and minor axes of
the desired ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nangle</code></td>
<td>
<p>The number of angles (between 0 and 180) to
consider for each shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The penalty for the spatial scan statistic.  The
default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>A cluster object created by <code>makeCluster</code>,
or an integer to indicate number of child-processes
(integer values are ignored on Windows) for parallel evaluations
(see Details on performance).
It can also be <code>"future"</code> to use a future backend (see Details),
<code>NULL</code> (default) refers to sequential evaluation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of scan statistic to compute. The
default is <code>"poisson"</code>. The other choice
is <code>"binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cases</code></td>
<td>
<p>The minimum number of cases required for
a cluster.  The default is 2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is performed using the spatial scan test based
on the Poisson test statistic and a fixed number of
cases.  Candidate zones are elliptical and extend from the
observed data locations.  The clusters returned are
non-overlapping, ordered from most significant to least
significant.  The first cluster is the most likely to
be a cluster.  If no significant clusters are found, then
the most likely cluster is returned (along with a
warning).
</p>


<h3>Value</h3>

<p>Returns a <code>smerc_cluster</code> object.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>References</h3>

<p>Kulldorff, M. (1997) A spatial scan
statistic. Communications in Statistics - Theory and
Methods, 26(6): 1481-1496,
&lt;doi:10.1080/03610929708831995&gt;
</p>
<p>Kulldorff, M., Huang, L., Pickle,
L. and Duczmal, L. (2006) An elliptic spatial scan
statistic. Statististics in Medicine, 25:3929-3943.
&lt;doi:10.1002/sim.2490&gt;
</p>


<h3>See Also</h3>

<p><code>print.smerc_cluster</code>,
<code>summary.smerc_cluster</code>,
<code>plot.smerc_cluster</code>,
<code>scan.stat</code>, <code>scan.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nydf)
coords &lt;- nydf[, c("x", "y")]
## Not run: 
# run only a small number of sims to make example fast
out &lt;- elliptic.test(
  coords = coords,
  cases = floor(nydf$cases),
  pop = nydf$pop, ubpop = 0.1,
  nsim = 19,
  alpha = 0.12)

## End(Not run)
</code></pre>


</div>