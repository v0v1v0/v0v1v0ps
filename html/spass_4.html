<div class="container">

<table style="width: 100%;"><tr>
<td>bssr.nb.inar1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Blinded Sample Size Reestimation for Longitudinal Count Data using the NB-INAR(1) Model</h2>

<h3>Description</h3>

<p><code>bssr.nb.inar1</code> fits blinded observations and recalculates the sample size required for proving a desired alternative when testing for
a rate ratio between two groups unequal to one. See 'Details' for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bssr.nb.inar1(alpha, power, delta, x, n, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power (1 - type II error) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the rate ratio which is to be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame containing count data which is to be fitted. Columns correspond to time points, rows to observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector giving the sample size within the control group and the treatment group, respecitvely.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>planned sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When testing for differences between rates <code class="reqn">\mu_C</code> and <code class="reqn">\mu_T</code> of two groups, a control and a treatment group respectively, we usually
test for the ratio between the two rates, i.e. <code class="reqn">\mu_T/\mu_C = 1</code>. The ratio of the two rates is refered to as <code class="reqn">\delta</code>, i.e.
<code class="reqn">\delta = \mu_T/\mu_C</code>.
</p>
<p><code>bssr.nb.inar1</code> gives back the required sample size for the control and treatment group required to prove an existing
alternative <code>theta</code> with a specified power <code>power</code> when testing the null hypothesis <code class="reqn">H_0: \mu_T/\mu_C \ge 1</code> to level <code>alpha</code>.
Nuisance parameters are estimated through the blinded observations <code>x</code>, thus not further required.
</p>
<p>for sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the desired
sample size allocation factor at the end of the study, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>


<h3>Value</h3>

<p><code>rnbinom.inar1</code> returns the required sample size within the control group and treatment group.
</p>


<h3>Source</h3>

<p><code>rnbinom.inar1</code> uses code contributed by Thomas Asendorf.
</p>


<h3>See Also</h3>

<p><code>rnbinom.inar1</code> for information on the NB-INAR(1) model, <code>n.nb.inar1</code> for calculating
initial sample size required when performing inference, <code>fit.nb.inar1</code> for calculating
initial parameters required when performing sample size estimation
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Calculate required sample size to find significant difference with
#80% probability when testing the Nullhypothesis H_0: mu_T/mu_C &gt;= 1
#assuming the true effect delta is 0.8 and rate, size and correlation
#parameter in the control group are 2, 1 and 0.5, respectively.

estimate&lt;-n.nb.inar1(alpha=0.025, power=0.8, delta=0.8, muC=2, size=1, rho=0.5, tp=7, k=1)

#Simulate data
placebo&lt;-rnbinom.inar1(n=50, size=1, mu=2, rho=0.5, tp=7)
treatment&lt;-rnbinom.inar1(n=50, size=1, mu=1.6, rho=0.5, tp=7)

#Blinded sample size reestimation
blinded.data&lt;-rbind(placebo, treatment)[sample(1:100),]
estimate&lt;-bssr.nb.inar1(alpha=0.025, power=0.8, delta=0.8, x=blinded.data, n=c(50,50), k=1)
summary(estimate)
</code></pre>


</div>