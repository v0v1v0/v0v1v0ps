<div class="container">

<table style="width: 100%;"><tr>
<td>construct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construction of a <code>Splinets</code> object</h2>

<h3>Description</h3>

<p>The function constructs a <code>Splinets</code> object correspond to a single spline (size=1)
from a vector of knots and a matrix of proposed derivatives.
The matrix is tested for its correctness like in <code>is.splinets</code> and adjusted using one of the implemented methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">construct(knots, smorder, matder, supp = vector(), mthd = "RRM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p><code>n+2</code> vector, the knots over which the spline is built; 
There should be at least <code>2*smorder+4</code> of knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smorder</code></td>
<td>
<p>integer, the order of smoothness;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matder</code></td>
<td>
<p><code>(n+2)x(smorder+1)</code> matrix, the matrix of derivatives; 
This matrix will be corrected if does not correspond to a proper spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supp</code></td>
<td>
<p>vector, either empty or two integers representing the single interval support;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mthd</code></td>
<td>
<p>string, one of the three methods for correction of the matrix of derivative:
</p>

<dl>
<dt><code>'CRLC'</code></dt>
<dd>
<p>matching mostly the highest derivative,</p>
</dd>
<dt><code>'CRFC'</code></dt>
<dd>
<p>matching mostly the function values at the knots,</p>
</dd>
<dt><code>'RRM'</code></dt>
<dd>
<p>balanced matching between all derivatives;</p>
</dd>
</dl>
<p>The default method is <code>'RRM'</code>, see the paper on the package for further details about the methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function constructs a <code>Splinet</code>-object only over a single interval support. 
Combining with the function <code>lincom</code> allows to introduce a multi-component support.
</p>


<h3>Value</h3>

<p>A <code>Splinets</code>-object corresponding to a single spline.
</p>


<h3>References</h3>

<p>Liu, X., Nassar, H., Podg<code class="reqn">\mbox{\'o}</code>rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.
</p>
<p>Podg<code class="reqn">\mbox{\'o}</code>rski, K. (2021) 
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.
</p>
<p>Nassar, H., Podg<code class="reqn">\mbox{\'o}</code>rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;
</p>


<h3>See Also</h3>

<p><code>is.splinets</code> for diagnostic of <code>Splinets</code>-objects;
<code>gather</code> and <code>subsample</code>  for combining and subsampling <code>Splinets</code>-objects, respectively,
<code>plot,Splinets-method</code> for a plotting method for <code>Splinets</code>-objects;
<code>lincomb</code> for combining splines with more complex than a single interval support sets;
</p>


<h3>Examples</h3>

<pre><code class="language-R">#-------------------------------------------------------------#
#---Building 'Splinets' using different derviative matching---#
#-------------------------------------------------------------#
n=17; k=4
set.seed(5)
xi=sort(runif(n+2)); xi[1]=0; xi[n+1]=1 

#Random matrix of derivatives -- the noise (wild) case to be corrected
S=matrix(rnorm((n+2)*(k+1)),ncol=(k+1))

spl=construct(xi,k,S) #construction of an object, the order of knots is corrected
is.splinets(spl)[[1]] #validation

spl=construct(xi,k,S,mthd='CRFC') #another method of the derivative matching
is.splinets(spl)[[1]]

spl=construct(xi,k,S,mthd='CRLC') #one more method
is.splinets(spl)[[1]]             

#-----------------------------------------------------#
#---------Building not over the full support----------#
#-----------------------------------------------------#
set.seed(5)
n=20; xi=sort(runif(n+2));xi[1]=0;xi[n+2]=1

spl=construct(xi,k,S) #construction of a spline as the 'Splinets' object over the entire range
is.splinets(spl)[[1]] #verification of the conditions

supp=c(3,17) #definition of the single interval support
SS=matrix(rnorm((supp[2]-supp[1]+1)*(k+1)),ncol=(k+1)) #The matrix of derivatives 
                                                       #over the support range
sspl=construct(xi,k,SS,supp=supp) #construction of a spline as the 'Splinets' object 
                                  #with the given support range
is.splinets(sspl)[[1]] #Verification 
sspl@knots
sspl@supp
sspl@der
</code></pre>


</div>