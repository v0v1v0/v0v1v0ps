<div class="container">

<table style="width: 100%;"><tr>
<td>FitBNR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Bivariate Normal Regression Model</h2>

<h3>Description</h3>

<p>Estimation procedure for bivariate normal regression models. The EM algorithm
is applied if <code>s</code> contains missing values, or if <code>X</code> differs from
<code>Z</code>. Otherwise, an accelerated least squares procedure is applied.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitBNR(t, s, X, Z = NULL, sig = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Target outcome vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Target model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Surrogate model matrix. Defaults to <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments accepted if fitting via EM. See
<code>FitBNEM</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The target and surrogate model matrices are expected in numeric format.
Include an intercept if required. Expand factors and interactions in advance.
</p>


<h3>Value</h3>

<p>An object of class 'mnr' with slots containing the estimated regression
coefficients, the target-surrogate covariance matrix, the information matrices
for regression parameters, and the residuals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Case 1: No surrogate missingness.
set.seed(100)
n &lt;- 1e3
X &lt;- stats::rnorm(n)
data &lt;- rBNR(
  X = X,
  Z = X,
  b = 1,
  a = -1,
  t_miss = 0.1,
  s_miss = 0.0
)
t &lt;- data[, 1]
s &lt;- data[, 2]

# Model fit.
fit_bnls &lt;- FitBNR(
  t = t,
  s = s,
  X = X
)

# Case 2: Target and surrogate missingness.
set.seed(100)
n &lt;- 1e3
X &lt;- stats::rnorm(n)
Z &lt;- stats::rnorm(n)
data &lt;- rBNR(
  X = X,
  Z = Z,
  b = 1,
  a = -1,
  t_miss = 0.1,
  s_miss = 0.1
)

# Log likelihood.
fit_bnem &lt;- FitBNR(
  t = data[, 1],
  s = data[, 2],
  X = X,
  Z = Z
)

</code></pre>


</div>