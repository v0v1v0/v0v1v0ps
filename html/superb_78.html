<div class="container">

<table style="width: 100%;"><tr>
<td>superbPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>summary plot of any statistics with adjusted error bars.</h2>

<h3>Description</h3>

<p>The function <code>suberbPlot()</code> plots standard error or confidence interval for various
descriptive statistics under various designs, sampling schemes, population size and purposes,
according to the <code>suberb</code> framework. See (Cousineau et al. 2021) for more.
</p>


<h3>Usage</h3>

<pre><code class="language-R">superbPlot(
  data,
  BSFactors = NULL,
  WSFactors = NULL,
  WSDesign = "fullfactorial",
  factorOrder = NULL,
  variables,
  statistic = "mean",
  errorbar = "CI",
  gamma = 0.95,
  adjustments = list(purpose = "single", popSize = Inf, decorrelation = "none",
    samplingDesign = "SRS"),
  showPlot = TRUE,
  plotStyle = "bar",
  preprocessfct = NULL,
  postprocessfct = NULL,
  clusterColumn = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataframe in wide format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BSFactors</code></td>
<td>
<p>The name of the columns containing the between-subject factor(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WSFactors</code></td>
<td>
<p>The name of the within-subject factor(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WSDesign</code></td>
<td>
<p>the within-subject design if not a full factorial design (default "fullfactorial")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factorOrder</code></td>
<td>
<p>Order of factors as shown in the graph (in that order: x axis,
groups, horizontal panels, vertical panels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>The dependent variable(s) as strings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The summary statistic function to use as a string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorbar</code></td>
<td>
<p>The function that computes the error bar. Should be "CI" or "SE" or
any function name if you defined a custom function. Default to "CI"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The coverage factor; necessary when <code>errorbar == "CI"</code>. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustments</code></td>
<td>
<p>List of adjustments as described below.
Default is <code>adjustments = list(purpose = "single", popSize = Inf, decorrelation = "none", samplingDesign = "SRS")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlot</code></td>
<td>
<p>Defaults to TRUE. Set to FALSE if you want the output to be the summary
statistics and intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotStyle</code></td>
<td>
<p>The type of object to plot on the graph. See full list below.
Defaults to "bar".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preprocessfct</code></td>
<td>
<p>is a transform (or vector of) to be performed first on data matrix of each group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postprocessfct</code></td>
<td>
<p>is a transform (or vector of)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterColumn</code></td>
<td>
<p>used in conjunction with samplingDesign = "CRS", indicates which column
contains the cluster membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>In addition to the parameters above, superbPlot also accept a number of
optional arguments that will be transmitted to the plotting function, such as
pointParams (a list of ggplot2 parameters to input inside geoms; see ?geom_bar2) and
errorbarParams (a list of ggplot2 parameters for geom_errorbar; see ?geom_errorbar)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The possible adjustements are the following
</p>

<ul>
<li>
<p> popsize: Size of the population under study. Defaults to Inf
</p>
</li>
<li>
<p> purpose: The purpose of the comparisons. Defaults to "single".
Can be "single", "difference", or "tryon".
</p>
</li>
<li>
<p> decorrelation: Decorrelation method for repeated measure designs.
Chooses among the methods "CM", "LM", "CA", "UA", "LDr" (with r an integer) or "none". Defaults to
"none". "CA" is correlation-adjusted (Cousineau 2019);
"UA" is based on the unitary Alpha method (derived from the Cronbach alpha;
see (Laurencelle and Cousineau 2023)).
"LDr" is local decorrelation (useful for long time series with autoregressive
correlation structures; see (Cousineau et al. in preparation));
.
</p>
</li>
<li>
<p> samplingDesign: Sampling method to obtain the sample. implemented
sampling is "SRS" (Simple Randomize Sampling) and "CRS" (Cluster-Randomized Sampling).
</p>
</li>
</ul>
<p>In version 0.97.5, the layouts for plots are the following:
</p>

<ul>
<li>
<p> "bar" Shows the summary statistics with bars and error bars;
</p>
</li>
<li>
<p> "line" Shows the summary statistics with lines connecting the conditions over the first factor;
</p>
</li>
<li>
<p> "point" Shows the summary statistics with isolated points
</p>
</li>
<li>
<p> "pointjitter" Shows the summary statistics along with jittered points depicting the raw data;
</p>
</li>
<li>
<p> "pointjitterviolin" Also adds violin plots to the previous layout
</p>
</li>
<li>
<p> "pointindividualline" Connects the raw data with line along the first factor (which should be a repeated-measure factor)
</p>
</li>
<li>
<p> "raincloud" Illustrates the distribution with a cloud (half_violin_plot) and jittered dots next to it. Looks better when coordinates are flipped <code>+coord_flip()</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>a plot with the correct error bars or a table of those summary statistics.
The plot is a ggplot2 object with can be modified with additional declarations.
</p>


<h3>References</h3>

<p>Cousineau D (2019).
“Correlation-adjusted standard errors and confidence intervals for within-subject designs: A simple multiplicative approach.”
<em>The Quantitative Methods for Psychology</em>, <b>15</b>, 226 – 241.
<a href="https://doi.org/10.20982/tqmp.15.3.p226">doi:10.20982/tqmp.15.3.p226</a>.<br><br> Cousineau D, Goulet M, Harding B (2021).
“Summary plots with adjusted error bars: The superb framework with an implementation in R.”
<em>Advances in Methods and Practices in Psychological Science</em>, <b>4</b>, 1–18.
<a href="https://doi.org/10.1177/25152459211035109">doi:10.1177/25152459211035109</a>.<br><br> Cousineau D, Proulx A, Potvin-Pilon A, Fiset D (in preparation).
“Local decorrelation for error bars in time series.”
<em>tbd</em>.<br><br> Laurencelle L, Cousineau D (2023).
“Analysis of proportions using arcsine transform with any experimental design.”
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">######################################################################

# Basic example using a built-in dataframe as data. 
# By default, the mean is computed and the error bar are 95% confidence intervals
superbPlot(ToothGrowth, BSFactors = c("dose", "supp"), 
  variables = "len") 

# Example changing the summary statistics to the median and
# the error bar to 80% confidence intervals
superbPlot(ToothGrowth, BSFactors = c("dose", "supp"), 
  variables = "len", statistic = "median", errorbar = "CI", gamma = .80) 

# Example introducing adjustments for pairwise comparisons 
# and assuming that the whole population is limited to 200 persons
superbPlot(ToothGrowth, BSFactors = c("dose", "supp"), 
  variables = "len",  
  adjustments = list( purpose = "difference", popSize = 200) )

# This example adds ggplot directives to the plot produced
library(ggplot2)
superbPlot(ToothGrowth, BSFactors = c("dose", "supp"), 
  variables = "len") + 
xlab("Dose") + ylab("Tooth Growth") +
theme_bw()

######################################################################

# The following examples are based on repeated measures
library(gridExtra)
options(superb.feedback = 'none') # shut down 'warnings' and 'design' interpretation messages

# A simple example: The sleep data
# The sleep data are paired data showing the additional time of sleep with 
# the soporific drugn #1 (("group = 1") and with the soporific drug #2 ("group = 2"). 
# There is 10 participants with two measurements.

# sleep is available in long format so we transform it to the in wide format:
sleep2 &lt;- reshape(sleep, direction = "wide", idvar = "ID", timevar = "group")
sleep2

# Makes the plots first without decorrelation:
superbPlot(sleep2, 
  WSFactors = "Times(2)", 
  variables = c("extra.1", "extra.2")
)
# As seen the error bar are very long. Lets take into consideration correlation...
# ...  with decorrelation (technique Correlation-adjusted CA):
superbPlot(sleep2, 
  WSFactors = "Times(2)", 
  variables = c("extra.1", "extra.2"), 
  # only difference:
  adjustments = list(purpose = "difference", decorrelation = "CA")
)
# The error bars shortened as the correlation is substantial (r = .795).


######################################################################

# Another example: The Orange data
# Use the Orange example, but let's define shorter column names...
names(Orange) &lt;- c("Tree","age","circ")
# ... and turn the data into a wide format using superbToWide:
Orange.wide &lt;- superbToWide(Orange, id = "Tree", WSFactors = "age", variable = "circ") 

# This example contains 5 trees whose diameter (in mm) has been measured at various age (in days):
Orange.wide

# Makes the plots first without decorrelation:
p1 &lt;- superbPlot( Orange.wide, WSFactors = "age(7)",
  variables = c("circ_118","circ_484","circ_664","circ_1004","circ_1231","circ_1372","circ_1582"),
  adjustments = list(purpose = "difference", decorrelation = "none")
) + 
  xlab("Age level") + ylab("Trunk diameter (mm)") +
  coord_cartesian( ylim = c(0,250) ) + labs(title="''Standalone'' confidence intervals")
# ... and then with decorrelation (technique Correlation-adjusted CA):
p2 &lt;- superbPlot( Orange.wide, WSFactors = "age(7)",
  variables = c("circ_118","circ_484","circ_664","circ_1004","circ_1231","circ_1372","circ_1582"),
  adjustments = list(purpose = "difference", decorrelation = "CA")
) + 
  xlab("Age level") + ylab("Trunk diameter (mm)") +
  coord_cartesian( ylim = c(0,250) ) + labs(title="Decorrelated confidence intervals")

# You can present both plots side-by-side
grid.arrange(p1, p2, ncol=2)

######################################################################


</code></pre>


</div>