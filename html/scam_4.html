<div class="container">

<table style="width: 100%;"><tr>
<td>bfgs_gcv.ubre</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multiple Smoothing Parameter Estimation by GCV/UBRE</h2>

<h3>Description</h3>

<p>Function to efficiently estimate smoothing parameters of SCAM by GCV/UBRE score optimization.
The procedure is outer to the model fitting by the Newton-Raphson method. 
The function uses the BFGS method where the Hessian matrix is updated iteratively at each step.
Backtracking is included to satisfy the sufficient decrease condition.
</p>
<p>The function is not normally called directly, but rather service routines for <code>scam</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfgs_gcv.ubre(fn=gcv.ubre_grad, rho, ini.fd=TRUE, G, env,
            n.pen=length(rho), typx=rep(1,n.pen), typf=1, control) 


</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>GCV/UBRE Function which returs the GCV/UBRE value and its derivative wrt log smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>log of the initial values of the smoothing parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini.fd</code></td>
<td>
<p>If TRUE, a finite difference to the Hessian is used to find the initial 
inverse Hessian, otherwise the initial 
inverse Hessian is a diagonal matrix ‘100*I’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A list of items needed to fit a SCAM.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Get the enviroment for the model coefficients, their derivatives and the smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.pen</code></td>
<td>
<p>Smoothing parameter dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typx</code></td>
<td>
<p>A vector whose component is a positive scalar specifying the typical magnitude of sp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typf</code></td>
<td>
<p>A positive scalar estimating the magnitude of the gcv near the minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control option list as returned by <code>scam.control</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gcv.ubre</code></td>
<td>
<p>The optimal value of GCV/UBRE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The best value of the log smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgcv.ubre</code></td>
<td>
<p>The gradient of the GCV/UBRE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iterations taken until convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv.bfgs</code></td>
<td>
<p>Convergence information indicating why the BFGS terminated (given below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termcode</code></td>
<td>
<p> An integer code indicating why the optimization process
terminated.
</p>
<p>1: relative gradient is close to zero, current iterate 
probably is a solution.
</p>
<p>2: scaled distance between last two steps less than ‘steptol’, current iterate 
probably is a local minimizer, but it's possible that the algorithm is making very slow progress, 
or ‘steptol’ is too large.
</p>
<p>3: last global step failed to locate a point lower than
estimate.  Either estimate is an approximate
local minimum of the function or <code>steptol</code> is too
small.
</p>
<p>4: iteration limit exceeded.
</p>
<p>5: five consecutive steps of length <code>maxNstep</code> have been taken, it's possible that ‘maxstep’ is too small.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A list of elements returned by the fitting procedure <code>scam.fit</code> for an optimal value of the smoothing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgcv.ubre.check</code></td>
<td>
<p>If <code>check.analytical=TRUE</code> this is the finite-difference approximation of the gradient calculated by
<code>gcv.ubre_grad</code>, otherwise <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.grad</code></td>
<td>
<p>If <code>check.analytical=TRUE</code> this is the relative difference (in 
and finite differenced derivatives calculated by <code>gcv.ubre_grad</code>, otherwise <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Natalya Pya &lt;nat.pya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>
<p>Wood, S.N. (2011) Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized 
linear models. Journal of the Royal Statistical Society: Series B. 73(1): 1–34
</p>


<h3>See Also</h3>

<p><code>scam</code>
</p>


</div>