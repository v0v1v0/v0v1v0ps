<div class="container">

<table style="width: 100%;"><tr>
<td>localpeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local maximum frequency peak detection</h2>

<h3>Description</h3>

<p>This functions searches for local peaks of a frequency spectrum</p>


<h3>Usage</h3>

<pre><code class="language-R">localpeaks(spec, f = NULL, bands = 10, mel = FALSE, plot = TRUE,
xlab = NULL, ylab = "Amplitude", labels = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>a data set resulting of a spectral analysis obtained
with <code>spec</code> or <code>meanspec</code>. Can be in dB.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>sampling frequency of <code>spec</code> (in Hz). Not requested if
the first column of <code>spec</code> contains the frequency axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bands</code></td>
<td>
<p>a numeric vector. If vector of length 1, then sets the
number of bands dividing in equal parts the spectrum. If of length &gt; 1,
then takes the values as kHz limits of the bands dividing the spectrum. These
bands can be of different size. See details and examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mel</code></td>
<td>
<p>a logical, if <code>TRUE</code> the (htk-)mel scale is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if <code>TRUE</code>, a plot showing the peaks is
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>logical, if <code>TRUE</code> peak labels are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other <code>plot</code> graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function proceed as follows
</p>

<ul>
<li>
<p> divides the spectrum in bands. The limits of the bands are set
with the argument <code>bands</code>. There are two options:
</p>

<ul>
<li>
<p> you set a number of bands with equal size by giving a single
value to <code>bands</code>. For instance, setting <code>bands</code> to a value
of 10 will slice the spectrum in 10 equal parts and return 10 local
peaks.
</p>
</li>
<li>
<p> you set the limits of the bands. This is achieve by giving a
numeric vector to <code>bands</code>. The limits can follow a regular or
irregular series. For instance attributing the vector c(0,2,4,8) will
generate the following bands [0,2[, [2,4[, [4,8] kHz. Be aware that
the last value should not exceed half the sampling frequency used to
obtain the spectrum <code>spec</code>.
</p>
</li>
</ul>
</li>
<li>
<p> uses the function <code>fpeaks</code> with the argument
<code>nmax</code> set to 1.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A two-column matrix, the first column corresponding to the
frequency values (x-axis) and the second column corresponding to the
amplitude values (y-axis) of the peaks.</p>


<h3>Author(s)</h3>

<p>Jerome Sueur</p>


<h3>See Also</h3>

<p><code>fpeaks</code>, <code>meanspec</code>, <code>spec</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(sheep)
spec &lt;- meanspec(sheep, f=8000)
# a specific number of bands with all the same size
localpeaks(spec, bands=5)
# bands directly specified  with a regular sequence
localpeaks(spec, bands=seq(0,8/2,by=0.5))
# bands directly specified  with an irregular sequence
localpeaks(spec, bands=c(0,0.5,1,1.5,3,4))
# Amaj octave bands, note that there is no peak detection
# in the higher part of the spectrum as sequence stops at 3520 Hz
localpeaks(spec, bands=octaves(440, below=3, above=3)/1000)
# melscale
require(tuneR)
mel &lt;- melfcc(sheep, nbands = 256, dcttype = "t3", fbtype = "htkmel", spec_out=TRUE)
melspec.mean &lt;- apply(mel$aspectrum, MARGIN=2, FUN=mean)
melspec.mean &lt;- melspec.mean/max(melspec.mean) # [0,1] scaling 
localpeaks(melspec.mean, f=8000, bands=8)
</code></pre>


</div>