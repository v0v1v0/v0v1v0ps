<div class="container">

<table style="width: 100%;"><tr>
<td>fit.nb.gf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Longitudinal Data from a Gamma Frailty Model with Frailty of Autoregressive Correlation Structure of Order One</h2>

<h3>Description</h3>

<p><code>fit.nb.gf</code> fits data using the pseudo maximum likelihood of a Gamma frailty model
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.nb.gf(
  dataC,
  dataE,
  trend = c("constant", "exponential"),
  lower,
  upper,
  method = "L-BFGS-B",
  start,
  approx = 20,
  rho = FALSE,
  H0 = FALSE,
  h0 = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataC</code></td>
<td>
<p>a matrix containing count data from the control group, which is to be fitted. Columns correspond to time points, rows to observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataE</code></td>
<td>
<p>a matrix containing count data from the experiment group, which is to be fitted. Columns correspond to time points, rows to observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>the trend which assumed to underlying in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>vector of lower bounds for estimated parameters <code>lambda</code>, <code>size</code> and <code>rho</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>vector of upper bounds for estimated parameters <code>lambda</code>, <code>size</code> and <code>rho</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>algorithm used for minimization of the likelihood, see <code>optim</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>vector of starting values for estimated parameters <code>mu</code>, <code>size</code> and <code>rho</code>, respectively, used for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>numer of iterations in numerical calculation of the sandwich estimator, see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>indicates whether or not to calculate the correlation coefficient of Gamma frailties. Must be TRUE or FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>indicates whether or not to calculate the hessian and outer gradient matrix under the null hypothesis, see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>the value against which is tested under the null</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the function <code>fit.nb.gf</code> fits a Gamma frailty model as found in Fiocco (2009). The fitting function allows for incomplete follow up,
but not for intermittent missingness.
</p>
<p>When calculating the expected sandwich estimator required for the sample size, certain terms can not be computed analytically and have
to be approximated numerically. The value <code>approx</code> defines how close the approximation is to the true expected sandwich estimator.
High values of <code>approx</code> provide better approximations but are compuationally more expensive.
</p>
<p>If parameter H0 is set to TRUE, the hessian and outer gradient are calculated under the assumption that <code>lambda[2]</code> <code class="reqn">\geq</code> <code>h0</code> if
<code>trend = "constant"</code> or <code>lambda[3]</code> <code class="reqn">\geq</code> <code>h0</code> if <code>trend = "exponential"</code>.
</p>


<h3>Value</h3>

<p><code>fit.nb.gf</code> returns estimates of the trend parameters <code>lambda</code>, dispersion parameter <code>size</code>,
Hessian matrix <code>hessian</code>, outer gradient product matrix <code>ogradient</code> and, if inquired, correlation coefficient <code>rho</code>.
</p>


<h3>Source</h3>

<p><code>fit.nb.gf</code> uses code contributed by Thomas Asendorf.
</p>


<h3>References</h3>

<p>Fiocco M, Putter H, Van Houwelingen JC, (2009), A new serially correlated gamma-frailty process for longitudinal count data <em>Biostatistics</em> Vol. 10, No. 2, pp. 245-257.
</p>


<h3>See Also</h3>

<p><code>rnbinom.gf</code> for information on the Gamma frailty model, <code>n.nb.gf</code> for calculating
initial sample size required when performing inference, <code>bssr.nb.gf</code> for blinded
sample size reestimation within a running trial, <code>optim</code> for more information on the used minimization algorithms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Generate data from the Gamma frailty model
random&lt;-get.groups(n=c(1000,1000), size=c(0.7, 0.7), lambda=c(0.8, -0.5), rho=c(0.6, 0.6),
  tp=7, trend="constant")
fit.nb.gf(dataC=random[1001:2000,], dataE=random[1:1000,], trend="constant")
</code></pre>


</div>