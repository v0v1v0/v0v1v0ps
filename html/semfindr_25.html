<div class="container">

<table style="width: 100%;"><tr>
<td>mahalanobis_rerun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mahalanobis Distance on All Observed Variables</h2>

<h3>Description</h3>

<p>Computes the Mahalanobis distance for each case on all
observed variables in a model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mahalanobis_rerun(
  fit,
  emNorm_arg = list(estimate.worst = FALSE, criterion = 1e-06)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>It can be the output from <code>lavaan</code>, such as
<code>lavaan::cfa()</code> and <code>lavaan::sem()</code>, or the output from
<code>lavaan_rerun()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emNorm_arg</code></td>
<td>
<p>No longer used. Kept for backward
compatibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mahalanobis_rerun()</code> gets a <code>lavaan_rerun()</code> or
<code>lavaan::lavaan()</code> output and computes the Mahalanobis distance for
each case on all observed variables.
</p>
<p>If there are no missing values, <code>stats::mahalanobis()</code> will be used
to compute the Mahalanobis distance.
</p>
<p>If there are missing values on the observed predictors, the means
and variance-covariance matrices will be estimated by maximum
likelihood using <code>lavaan::lavCor()</code>. The estimates will be passed
to <code>modi::MDmiss()</code> to compute the Mahalanobis distance.
</p>
<p>Supports both single-group and multiple-group models.
For multiple-group models, the Mahalanobis distance for
each case is computed using the means and covariance matrix
of the group this case belongs to.
(Support for multiple-group models available in 0.1.4.8 and later version).
</p>


<h3>Value</h3>

<p>A <code>md_semfindr</code>-class object, which is
a one-column matrix (a column vector) of the Mahalanobis
distance for each case. The row names are the case identification
values used in <code>lavaan_rerun()</code>.
A print method is available for user-friendly output.
</p>


<h3>Author(s)</h3>

<p>Shu Fai Cheung <a href="https://orcid.org/0000-0002-9871-9448">https://orcid.org/0000-0002-9871-9448</a>.
</p>


<h3>References</h3>

<p>Mahalanobis, P. C. (1936). On the generalized distance
in statistics. <em>Proceedings of the National Institute of Science
of India, 2</em>, 49-55.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(lavaan)
dat &lt;- pa_dat
# The model
mod &lt;-
"
m1 ~ a1 * iv1 + a2 * iv2
dv ~ b * m1
a1b := a1 * b
a2b := a2 * b
"
# Fit the model
fit &lt;- lavaan::sem(mod, dat)
summary(fit)
# Fit the model n times. Each time with one case removed.
# For illustration, do this only for selected cases.
fit_rerun &lt;- lavaan_rerun(fit, parallel = FALSE,
                          to_rerun = 1:10)
# Compute the Mahalanobis distance for each case
out &lt;- mahalanobis_rerun(fit_rerun)
# Results excluding a case, for the first few cases
head(out)
# Compute the Mahalanobis distance using stats::mahalanobis()
md1 &lt;- stats::mahalanobis(dat, colMeans(dat), stats::cov(dat))
# Compare the results
head(md1)

# A CFA model

dat &lt;- cfa_dat
mod &lt;-
"
f1 =~  x1 + x2 + x3
f2 =~  x4 + x5 + x6
f1 ~~ f2
"
# Fit the model
fit &lt;- lavaan::cfa(mod, dat)

fit_rerun &lt;- lavaan_rerun(fit, parallel = FALSE,
                          to_rerun = 1:10)
mahalanobis_rerun(fit_rerun)

# A latent variable model

dat &lt;- sem_dat
mod &lt;-
"
f1 =~  x1 + x2 + x3
f2 =~  x4 + x5 + x6
f3 =~  x7 + x8 + x9
f2 ~   a * f1
f3 ~   b * f2
ab := a * b
"
# Fit the model
fit &lt;- lavaan::cfa(mod, dat)

fit_rerun &lt;- lavaan_rerun(fit, parallel = FALSE,
                          to_rerun = 1:10)
mahalanobis_rerun(fit_rerun)


</code></pre>


</div>