<div class="container">

<table style="width: 100%;"><tr>
<td>CallPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Call peaks</h2>

<h3>Description</h3>

<p>Call peaks using MACS. Fragment files linked to the specified assay will be
used to call peaks. If multiple fragment files are present, all will be used
in a single MACS invocation. Returns the <code>.narrowPeak</code> MACS output as a
<code>GRanges</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CallPeaks(object, ...)

## S3 method for class 'Seurat'
CallPeaks(
  object,
  assay = NULL,
  group.by = NULL,
  idents = NULL,
  macs2.path = NULL,
  broad = FALSE,
  format = "BED",
  outdir = tempdir(),
  fragment.tempdir = tempdir(),
  combine.peaks = TRUE,
  effective.genome.size = 2.7e+09,
  extsize = 200,
  shift = -extsize/2,
  additional.args = NULL,
  name = Project(object),
  cleanup = TRUE,
  verbose = TRUE,
  ...
)

## S3 method for class 'ChromatinAssay'
CallPeaks(
  object,
  macs2.path = NULL,
  outdir = tempdir(),
  broad = FALSE,
  format = "BED",
  effective.genome.size = 2.7e+09,
  extsize = 200,
  shift = -extsize/2,
  additional.args = NULL,
  name = "macs2",
  cleanup = TRUE,
  verbose = TRUE,
  ...
)

## S3 method for class 'Fragment'
CallPeaks(
  object,
  macs2.path = NULL,
  outdir = tempdir(),
  broad = FALSE,
  format = "BED",
  effective.genome.size = 2.7e+09,
  extsize = 200,
  shift = -extsize/2,
  additional.args = NULL,
  name = "macs2",
  cleanup = TRUE,
  verbose = TRUE,
  ...
)

## Default S3 method:
CallPeaks(
  object,
  macs2.path = NULL,
  outdir = tempdir(),
  broad = FALSE,
  format = "BED",
  effective.genome.size = 2.7e+09,
  extsize = 200,
  shift = -extsize/2,
  additional.args = NULL,
  name = "macs2",
  cleanup = TRUE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A Seurat object, ChromatinAssay object, Fragment object, or the
path to fragment file/s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Name of assay to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>Grouping variable to use. If set, peaks will be called
independently on each group of cells and then combined. Note that to call
peaks using subsets of cells we first split the fragment file/s used, so
using a grouping variable will require extra time to split the files and
perform multiple MACS peak calls, and will store additional files on-disk
that may be large. Note that we store split fragment files in the temp
directory (<code>tempdir</code>) by default, and if the program is
interrupted before completing these temporary files will not be removed. If
NULL, peaks are called using all cells together (pseudobulk).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idents</code></td>
<td>
<p>List of identities to include if grouping cells (only valid if
also setting the <code>group.by</code> parameter). If NULL, peaks will be called
for all cell identities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>macs2.path</code></td>
<td>
<p>Path to MACS program. If NULL, try to find MACS
automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>broad</code></td>
<td>
<p>Call broad peaks (<code>--broad</code> parameter for MACS)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>File format to use. Should be either "BED" or "BEDPE" (see 
MACS documentation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>Path for output files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fragment.tempdir</code></td>
<td>
<p>Path to write temporary fragment files. Only used if
<code>group.by</code> is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine.peaks</code></td>
<td>
<p>Controls whether peak calls from different groups of
cells are combined using <code>GenomicRanges::reduce</code> when calling peaks for
different groups of cells (<code>group.by</code> parameter). If FALSE, a list of
<code>GRanges</code> object will be returned. Note that metadata fields such as the
p-value, q-value, and fold-change information for each peak will be lost if
combining peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effective.genome.size</code></td>
<td>
<p>Effective genome size parameter for MACS
(<code>-g</code>). Default is the human effective genome size (2.7e9).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extsize</code></td>
<td>
<p><code>extsize</code> parameter for MACS. Only relevant if 
format="BED"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p><code>shift</code> parameter for MACS. Only relevant if format="BED"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.args</code></td>
<td>
<p>Additional arguments passed to MACS. This should be a
single character string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name for output MACS files. This will also be placed in the
<code>name</code> field in the GRanges output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cleanup</code></td>
<td>
<p>Remove MACS output files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Display messages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <a href="https://macs3-project.github.io/MACS/">https://macs3-project.github.io/MACS/</a> for MACS documentation.
</p>
<p>If you call peaks using MACS2 please cite:
<a href="https://doi.org/10.1186/gb-2008-9-9-r137">doi:10.1186/gb-2008-9-9-r137</a>
</p>


<h3>Value</h3>

<p>Returns a <code>GRanges</code> object
</p>


</div>