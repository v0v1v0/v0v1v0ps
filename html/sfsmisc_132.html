<div class="container">

<table style="width: 100%;"><tr>
<td>TA.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tukey-Anscombe Plot (Residual vs. Fitted) of a Linear Model</h2>

<h3>Description</h3>

<p>From a linear (or glm) model fitted, produce the so-called Tukey-Anscombe
plot.  Useful (optional) additions include:   0-line, lowess smooth,
2sigma lines,  and automatic labeling of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TA.plot(lm.res,
        fit= fitted(lm.res), res= residuals(lm.res, type="pearson"),
        labels= NULL, main= mk.main(), xlab = "Fitted values",
        draw.smooth= n &gt;= 10, show.call = TRUE, show.2sigma= TRUE,
        lo.iter = NULL, lo.cex= NULL,
        par0line  = list(lty = 2, col = "gray"),
        parSmooth = list(lwd = 1.5, lty = 4, col = 2),
        parSigma  = list(lwd = 1.2, lty = 3, col = 4),
        verbose = FALSE,
        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lm.res</code></td>
<td>
<p>Result of <code>lm(..)</code>, <code>aov(..)</code>,
<code>glm(..)</code> or a similar object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>fitted values; you probably want the default here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>residuals to use. Default: <b>Weighted</b> ("Pearson") residuals if
weights have been used for the model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>strings to use as plotting symbols for each point.
Default(<code>NULL</code>): extract observations' names or use its sequence number.
Use, e.g., "*" to get simple <code>*</code> symbols.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>main title to plot. Default: sophisticated, resulting in
something like "Tukey-Anscombe Plot of :   y ~ x"  constructed from
<code>lm.res $ call</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.smooth</code></td>
<td>
<p>logical; if <code>TRUE</code>, draw a <code>lowess</code> smoother
(with automatic smoothing fraction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.call</code></td>
<td>
<p>logical; if <code>TRUE</code>, write the "call"ing syntax with
which the fit was done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.2sigma</code></td>
<td>
<p>logical; if <code>TRUE</code>, draw horizontal lines at
<code class="reqn">\pm 2\sigma</code> where <code class="reqn">\sigma</code> is <code>mad(resid)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lo.iter</code></td>
<td>
<p>positive integer, giving the number of lowess
robustness iterations. The default depends on the model and
is <code>0</code> for non Gaussian <code>glm</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lo.cex</code></td>
<td>
<p>character expansion ("cex") for lowess and other
marginal texts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par0line</code></td>
<td>
<p>a list of arguments (with reasonable defaults) to be passed to
<code>abline(.)</code> when drawing the x-axis, i.e.,
the <code class="reqn">y = 0</code> line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parSmooth, parSigma</code></td>
<td>
<p>each a list of arguments (with reasonable
default) for drawing the smooth curve (if <code>draw.smooth</code> is
true), or the horizontal sigma boundaries (if <code>show.2sigma</code> is
true) respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating if some construction details should
be reported (<code>print()</code>ed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical parameters are passed to
<code>n.plot(.)</code>.</p>
</td>
</tr>
</table>
<h3>Side Effects</h3>

<p>The above mentioned plot is produced on the current graphic device.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, Seminar fuer Statistik, ETH Zurich, Switzerland;
<a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>
</p>


<h3>See Also</h3>

<p><code>plot.lm</code> which also does a QQ normal plot and more.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(stackloss)
TA.plot(lm(stack.loss ~ stack.x))

example(airquality)
summary(lmO &lt;- lm(Ozone ~ ., data= airquality))
TA.plot(lmO)
TA.plot(lmO, label = "O") # instead of case numbers

if(FALSE) { 
 TA.plot(lm(cost ~ age+type+car.age, claims, weights=number, na.action=na.omit))
}

##--- for  aov(.) : -------------
data(Gun, package = "nlme")
TA.plot( aov(rounds ~ Method + Physique/Team, data = Gun))

##--- Not so clear what it means for GLM, but: ------
if(require(rpart)) { # for the two datasets only
 data(solder, package = "rpart")
 TA.plot(glm(skips ~ ., data = solder, family = poisson), cex= .6)

 data(kyphosis, package = "rpart")
 TA.plot(glm(Kyphosis ~ poly(Age,2) + Start, data=kyphosis, family = binomial),
	 cex=.75) # smaller title and plotting characters
}
</code></pre>


</div>