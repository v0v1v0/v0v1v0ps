<div class="container">

<table style="width: 100%;"><tr>
<td>mahalanobis_predictors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mahalanobis Distance On Observed Predictors</h2>

<h3>Description</h3>

<p>Gets a <code>lavaan_rerun()</code> or <code>lavaan::lavaan()</code> output
and computes the Mahalanobis distance for each case using only the
observed predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mahalanobis_predictors(
  fit,
  emNorm_arg = list(estimate.worst = FALSE, criterion = 1e-06)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>It can be the output from <code>lavaan</code>, such as
<code>lavaan::cfa()</code> and <code>lavaan::sem()</code>, or the output from
<code>lavaan_rerun()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emNorm_arg</code></td>
<td>
<p>No longer used. Kept for backward
compatibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each case, <code>mahalanobis_predictors()</code> computes the
Mahalanobis distance of each case on the observed predictors.
</p>
<p>If there are no missing values, <code>stats::mahalanobis()</code> will be used
to compute the Mahalanobis distance.
</p>
<p>If there are missing values on the observed predictors, the means
and variance-covariance matrices will be estimated by maximum
likelihood using <code>lavaan::lavCor()</code>. The estimates will be passed
to <code>modi::MDmiss()</code> to compute the Mahalanobis distance.
</p>
<p>Supports both single-group and multiple-group models.
For multiple-group models, the Mahalanobis distance for
each case is computed using the means and covariance matrix
of the group this case belongs to.
(Support for multiple-group models available in 0.1.4.8 and later version).
</p>


<h3>Value</h3>

<p>A <code>md_semfindr</code>-class object, which is
a one-column matrix (a column vector) of the Mahalanobis
distance for each case. The number of rows equals to the number of
cases in the data stored in the fit object.
A print method is available for user-friendly output.
</p>


<h3>Author(s)</h3>

<p>Shu Fai Cheung <a href="https://orcid.org/0000-0002-9871-9448">https://orcid.org/0000-0002-9871-9448</a>.
</p>


<h3>References</h3>

<p>BÃ©guin, C., &amp; Hulliger, B. (2004). Multivariate outlier detection in
incomplete survey data: The epidemic algorithm and transformed rank
correlations. <em>Journal of the Royal Statistical Society: Series A
(Statistics in Society)</em>, 167(2), 275-294.
</p>
<p>Mahalanobis, P. C. (1936). On the generalized distance in statistics.
<em>Proceedings of the National Institute of Science of India, 2</em>, 49-55.
</p>
<p>Schafer, J.L. (1997) <em>Analysis of incomplete multivariate data</em>.
Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(lavaan)
dat &lt;- pa_dat
# For illustration, select only the first 50 cases.
dat &lt;- dat[1:50, ]
# The model
mod &lt;-
"
m1 ~ a1 * iv1 +  a2 * iv2
dv ~ b * m1
a1b := a1 * b
a2b := a2 * b
"
# Fit the model
fit &lt;- lavaan::sem(mod, dat)
summary(fit)

md_predictors &lt;- mahalanobis_predictors(fit)
md_predictors

</code></pre>


</div>