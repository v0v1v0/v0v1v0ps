<div class="container">

<table style="width: 100%;"><tr>
<td>MODERATED_REGRESSION</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moderated multiple regression</h2>

<h3>Description</h3>

<p>Conducts moderated regression analyses for two-way interactions with
extensive options for interaction plots, including Johnson-Neyman
regions of significance. The output includes the
Anova Table (Type III tests), standardized coefficients, 
partial and semi-partial correlations, collinearity statistics,
casewise regression diagnostics, plots of residuals and regression diagnostics, 
and detailed information about simple slopes.</p>


<h3>Usage</h3>

<pre><code class="language-R">MODERATED_REGRESSION(data, DV, IV, MOD,
                     IV_type = 'numeric', IV_range = 'tumble',
                     MOD_type='numeric', MOD_levels='quantiles', MOD_range=NULL,
                     quantiles_IV = c(.1, .9), quantiles_MOD = c(.25, .5, .75),
                     COVARS = NULL,
                     center = TRUE, 
                     plot_type = 'residuals', plot_title = NULL, DV_range = NULL,
                     Xaxis_label = NULL, Yaxis_label = NULL, legend_label = NULL,
                     JN_type = 'Huitema', 
                     verbose = TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A dataframe where the rows are cases and the columns are the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV</code></td>
<td>

<p>The name of the dependent variable. 
<br> Example: DV = 'outcomeVar'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IV</code></td>
<td>

<p>The name of the independent variable.
<br> Example: IV = 'varA'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOD</code></td>
<td>

<p>The name of the moderator variable
<br> Example: MOD = 'varB'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IV_type</code></td>
<td>

<p>(optional) The type of independent variable. The
options are 'numeric' (the default) or 'factor'. 
<br> Example: IV_type = 'factor'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IV_range</code></td>
<td>

<p>(optional) The independent variable range for a moderated regression plot.
The options are:
</p>

<ul>
<li>
<p>'tumble' (the default), for tumble graphs following Bodner (2016)
</p>
</li>
<li>
<p>'quantiles', in which case the 10th and 90th quantiles of the IV will be used
(alternative values can be specified using the quantiles_IV argument);
</p>
</li>
<li>
<p>'AikenWest', in which case the IV mean - one SD, and the IV mean + one SD, will be used;
</p>
</li>
<li>
<p>a vector of two user-provided values (e.g., c(1, 10)); and
</p>
</li>
<li>
<p>NULL, in which case the minimum and maximum IV values will be used.
</p>
</li>
</ul>
<p>Example: IV_range = 'AikenWest'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOD_type</code></td>
<td>

<p>(optional) The type of moderator variable. The
options are 'numeric' (the default) or 'factor'. 
<br> Example: MOD_type = 'factor'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOD_levels</code></td>
<td>

<p>(optional) The levels of the moderator variable to be used if MOD is continuous.
The options are:
</p>

<ul>
<li>
<p>'quantiles', in which case the .25, .5, and .75 quantiles of the MOD variable will be used
(alternative values can be specified using the quantiles_MOD argument);
</p>
</li>
<li>
<p>'AikenWest', in which case the mean of MOD, the mean of MOD - one SD, and the 
mean of MOD + one SD, will be used; and
</p>
</li>
<li>
<p>a vector of two user-provided values.
</p>
</li>
</ul>
<p>Example: MOD_levels = c(1, 10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOD_range</code></td>
<td>

<p>(optional) The range of the MOD values to be used in the Johnson-Neyman regions 
of significance analyses. The options are:
NULL (the default), in which case the minimum and maximum MOD values will be used; and
a vector of two user-provided values. 
<br> Example: MOD_range = c(1, 10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles_IV</code></td>
<td>

<p>(optional) The quantiles of the independent variable to be used as the IV range for 
a moderated regression plot.
<br> Example: quantiles_IV = c(.10, .90)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles_MOD</code></td>
<td>

<p>(optional) The quantiles the moderator variable to be used as the MOD simple slope  
values in the moderated regression analyses.
<br> Example: quantiles_MOD = c(.25, .5, .75)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COVARS</code></td>
<td>

<p>(optional) The name(s) of possible covariates.
<br> Example: COVARS = c('CovarA', 'CovarB', 'CovarC')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>(optional) Logical, indicating whether the IV and MOD variables should be centered
(default = TRUE).
<br> Example: center = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>

<p>(optional)  The kind of plot, if any. The options are:
</p>

<ul>
<li>
<p>'residuals' (the default)
</p>
</li>
<li>
<p>'diagnostics' (for regression diagnostics)
</p>
</li>
<li>
<p>'interaction' (for a traditional moderated regression interaction plot)
</p>
</li>
<li>
<p>'regions' (for a moderated regression Johnson-Neyman regions of significance plot), and
</p>
</li>
<li>
<p>'none' (for no plots).
</p>
</li>
</ul>
<p>Example: plot_type = 'diagnostics'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>

<p>(optional) The plot title.
<br> Example: plot_title = 'Interaction Plot'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV_range</code></td>
<td>

<p>(optional) The range of Y-axis values for the plot. 
<br> Example: DV_range = c(1,10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xaxis_label</code></td>
<td>

<p>(optional) A label for the X axis to be used in the requested plot.
<br> Example: Xaxis_label = 'IV name'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yaxis_label</code></td>
<td>

<p>(optional) A label for the Y axis to be used in the requested plot.
<br> Example: Yaxis_label = 'DV name'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_label</code></td>
<td>

<p>(optional) A legend label for the plot.
<br> Example: legend_label = 'MOD name'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JN_type</code></td>
<td>

<p>(optional) The formula to be used in computing the critical F value for the
Johnson-Neyman regions of significance analyses. The options are 'Huitema' (the default),
or 'Pedhazur'.
<br> Example: JN_type = 'Pedhazur'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Should detailed results be displayed in console? The options are: 
TRUE (default) or FALSE. If TRUE, plots of residuals are also produced.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "MODERATED_REGRESSION". The object is a list containing the
following possible components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>modelMAINsum</code></td>
<td>
<p>All of the summary.lm function output for the regression model 
without interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anova_table</code></td>
<td>
<p>Anova Table (Type III tests).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainRcoefs</code></td>
<td>
<p>Predictor coefficients for the model without interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeldata</code></td>
<td>
<p>All of the predictor and outcome raw data that were used in the model,
along with regression diagnostic statistics for each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collin_diags</code></td>
<td>
<p>Collinearity diagnostic coefficients for models without interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelXNsum</code></td>
<td>
<p>Regression model statistics with interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RsqchXn</code></td>
<td>
<p>Rsquared change for the interaction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsquaredXN</code></td>
<td>
<p>fsquared change for the interaction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnRcoefs</code></td>
<td>
<p>Predictor coefficients for the model with interaction terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simslop</code></td>
<td>
<p>The simple slopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simslopZ</code></td>
<td>
<p>The standardized simple slopes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotdon</code></td>
<td>
<p>The plot data for a moderated regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JN.data</code></td>
<td>
<p>The Johnson-Neyman results for a moderated regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ros</code></td>
<td>
<p>The Johnson-Neyman regions of significance for a moderated regression.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Brian P. O'Connor</p>


<h3>References</h3>

<p>Bodner, T. E. (2016). Tumble graphs: Avoiding misleading end point extrapolation when  
graphing interactions from a moderated multiple regression analysis. 
<em>Journal of Educational and Behavioral Statistics, 41,</em> 593-604.
<br><br> Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S. (2003). <em>Applied 
multiple regression/correlation analysis for the behavioral sciences</em> (3rd ed.). 
Lawrence Erlbaum Associates.
<br><br> Darlington, R. B., &amp; Hayes, A. F. (2017). <em>Regression analysis and linear models: 
Concepts, applications, and implementation.</em> Guilford Press.
<br><br> Hayes, A. F. (2018a). <em>Introduction to mediation, moderation, and conditional process 
analysis: A regression-based approach</em> (2nd ed.). Guilford Press.
<br><br> Hayes, A. F., &amp; Montoya, A. K. (2016). A tutorial on testing, visualizing, and probing 
an interaction involving a multicategorical variable in linear regression analysis. 
<em>Communication Methods and Measures, 11,</em> 1-30.
<br><br> O'Connor, B. P. (1998). All-in-one programs for exploring interactions in moderated 
multiple regression. <em>Educational and Psychological Measurement, 58,</em> 833-837.
<br><br> Pedhazur, E. J. (1997). <em>Multiple regression in behavioral research: Explanation 
and prediction.</em> (3rd ed.). Wadsworth Thomson Learning.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># moderated regression	-- with IV_range = 'AikenWest'
MODERATED_REGRESSION(data=data_Lorah_Wong_2018, DV='suicidal', IV='burden',  MOD='belong_thwarted', 
                     IV_range='AikenWest',
                     MOD_levels='quantiles',
                     quantiles_IV=c(.1, .9), quantiles_MOD=c(.25, .5, .75),
                     center = TRUE, COVARS='depression', 
                     plot_type = 'interaction', plot_title=NULL, DV_range = c(1,1.25))

# moderated regression	-- with  IV_range = 'tumble'
MODERATED_REGRESSION(data=data_Lorah_Wong_2018, DV='suicidal', IV='burden', MOD='belong_thwarted', 
                     IV_range='tumble',
                     MOD_levels='quantiles',
                     quantiles_IV=c(.1, .9), quantiles_MOD=c(.25, .5, .75),
                     center = TRUE, COVARS='depression', 
                     plot_type = 'interaction', plot_title=NULL, DV_range = c(1,1.25)) 

# moderated regression	-- with numeric values for IV_range &amp; MOD_levels='AikenWest'       
MODERATED_REGRESSION(data=data_OConnor_Dvorak_2001, DV='Aggressive_Behavior', 
                     IV='Maternal_Harshness', MOD='Resiliency', 
                     IV_range=c(1,7.7), 
                     MOD_levels='AikenWest', MOD_range=NULL,
                     quantiles_IV=c(.1, .9), quantiles_MOD=c(.25, .5, .75),
                     center = FALSE, 
                     plot_type = 'interaction', 
                     DV_range = c(1,6), 
                     Xaxis_label='Maternal Harshness', 
                     Yaxis_label='Adolescent Aggressive Behavior', 
                     legend_label='Resiliency')

</code></pre>


</div>