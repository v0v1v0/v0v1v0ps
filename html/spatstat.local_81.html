<div class="container">

<table style="width: 100%;"><tr>
<td>homtestmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Test Statistic for Homogeneity Test
</h2>

<h3>Description</h3>

<p>Compute the test statistic for the test of homogeneity
of a locally-fitted Poisson or Gibbs point process model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">homteststat(object, ..., verbose = FALSE)

homtestmap(object, ...,
           what=c("components", "statistic", "pvalue"),
           test = c("score", "taylor", "likelihood"),
           ladjust=c("none", "moment", "PSS"),
           calibrate=c("chisq", "Satterthwaite", "firstmoment"),
           simple = !is.null(theta0),
           theta0 = NULL,
           poolmoments=NULL,
           sigma = NULL, 
           saveall = FALSE, 
           use.fft = TRUE,
           verbose = TRUE)

## S3 method for class 'homtestmap'
update(object, ..., 
           what=NULL, test=NULL, ladjust=NULL,
           calibrate=NULL, saveall=FALSE, poolmoments=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Locally-fitted point process (object of class <code>"locppm"</code>)
or an object previously computed by <code>homtestmap</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For <code>homteststat</code>, arguments passed to <code>homtestmap</code>.
For <code>homtestmap</code>, additional unmatched arguments are ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>

<p>Character string (partially matched)
indicating whether to return the vector components
of the local test statistic, or the value of the local test statistic, or
the local <code class="reqn">p</code>-values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>Character string (partially matched)
indicating whether to perform
the local score test (<code>test="score"</code>),
or the local composite likelihood ratio test
approximately (<code>test="taylor"</code>) or exactly 
(<code>test="likelihood"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladjust</code></td>
<td>

<p>Character string (partially matched)
specifying an adjustment to the composite likelihood ratio test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibrate</code></td>
<td>

<p>Character string (partially matched)
specifying how to calculate <code class="reqn">p</code>-values
from the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simple</code></td>
<td>

<p>Logical value indicating whether to treat the fitted model
as a simple null hypothesis (<code>simple=TRUE</code>) or as an estimate
of the parameters in a composite null hypothesis
(<code>simple=FALSE</code>, the default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Coefficient vector specifying a simple null hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poolmoments</code></td>
<td>

<p>Logical value indicating how to calculate the reference distribution
for the likelihood ratio test statistic (and thus how to
calculate <code class="reqn">p</code>-values). See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Smoothing bandwidth.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveall</code></td>
<td>

<p>Logical value indicating whether to compute a complete set of
sufficient statistics and save them as an attribute of the result.
See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.fft</code></td>
<td>

<p>For software testing purposes only.
Logical value indicating whether to use
data computed by the Fast Fourier Transform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical value indicating whether to print progress reports.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are used by <code>homtest</code> to
perform a Monte Carlo test of the null hypothesis of
homogeneity (i.e.\ constant parameter values) for the locally-fitted
Poisson point process or Gibbs point process <code>object</code>.
</p>
<p>The function <code>homtestmap</code> computes
either the local likelihood ratio test statistic
or the local score test statistic.
If <code>what="statistic"</code>, then the result is a scalar-valued
function giving the local values of the test statistic.
If <code>what="pvalue"</code>, the result is a scalar-valued function <code class="reqn">p(v)</code>
giving the local <code class="reqn">p</code>-value at each location <code class="reqn">v</code>.
If <code>what="components"</code>, the result is a vector-valued
function <code class="reqn">T(v)</code> containing the components of the quadratic form;
the squared norm of <code class="reqn">T(v)</code> is
equal to the desired test statistic at each location <code class="reqn">v</code>.
</p>
<p>If <code>saveall=TRUE</code>, then a complete set of sufficient statistics is
calculated and stored as an attribute of the result. This makes it
possible to compute all of the statistics and <code class="reqn">p</code> values
described above. 
</p>
<p>The function <code>update.homtestmap</code>, a method for the
generic function <code>update</code>, converts
an object of class <code>"homtestmap"</code> from one of these formats to
another, where possible. Except in trivial cases, this requires that
the <code>"homtestmap"</code> object was computed with <code>saveall=TRUE</code>.
</p>
<p>The function <code>homteststat</code> computes the mean of
the local test statistic or the mean
of the local <code class="reqn">p</code>-values over the
observation window.
</p>
<p>To compute the <code class="reqn">p</code>-values when <code>test="likelihood"</code>
or <code>test="taylor"</code>, the values of the local likelihood ratio
test statistic are referred to a gamma distribution whose first two
moments are estimated from the data. If <code>poolmoments=FALSE</code>,
the local estimates of the moments are used; if
<code>poolmoments=TRUE</code>, the spatial average of these estimates
is used. The default is to use pooling whenever it is
theoretically justified, namely when the template
model is a stationary point process.
</p>
<p>Finer control over the computation is possible
using the arguments <code>...</code> passed to <code>locppm</code>.
</p>


<h3>Value</h3>

<p>For <code>homteststat</code>, a numeric value giving the test statistic.
</p>
<p>For <code>homtestmap</code> and <code>update.homtestmap</code>,
a spatially-sampled function object (class <code>"ssf"</code>; see
<code>ssf</code>).
This object also belongs to the special class
<code>"homtestmap"</code> which has a print method.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Baddeley, A. (2017) Local composite likelihood
  for spatial point patterns. <em>Spatial Statistics</em> <b>22</b>, 261â€“295. DOI: 10.1016/j.spasta.2017.03.001
</p>
<p>Baddeley, A., Rubak, E. and Turner, R. (2015) <em>Spatial Point Patterns: Methodology and Applications with R</em>. Chapman and Hall/CRC Press. 
</p>


<h3>See Also</h3>

<p><code>homtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   example(locppm)
   plot(H &lt;- homtestmap(fit))
   H
</code></pre>


</div>