<div class="container">

<table style="width: 100%;"><tr>
<td>sm.density</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric density estimation in one, two or three dimensions.
</h2>

<h3>Description</h3>

<p>This function creates a density estimate from data in one, two or three
dimensions.  In two dimensions a variety of
graphical displays can be selected, and in three dimensions a contour
surface can be plotted.  A number of other features of the construction
of the estimate, and of its display, can be controlled.
</p>
<p>If the <code>rpanel</code> package is available, an interactive panel can be 
activated to control various features of the plot.
</p>
<p>If the <code>rgl</code> package is also available, rotatable plots are
available for the two- and three-dimensional cases.  (For 
three-dimensional data, the <code>misc3d</code> package is also required.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">sm.density(x, h, model = "none", weights = NA, group=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector, or a matrix with two or three columns, containing the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a vector of length one, two or three, defining the smoothing parameter.
A normal kernel function is used and <code>h</code> is its standard deviation.
If this parameter is omitted, a normal optimal smoothing parameter is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>This argument applies only with one-dimensional data.  Its default value
is <code>"none"</code>.  If it is set to <code>"Normal"</code> (or indeed any value
other than <code>"none"</code>) then a reference band, indicating where a
density estimate is  likely to lie when the data are normally
distributed, will be superimposed  on any plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of integers representing frequencies of individual observations.
Use of this parameter is incompatible with binning; hence <code>nbins</code> must 
then be set to 0 or left at its default value <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p> a vector of groups indicators (numeric or character values) or
a factor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code> function,
through a mechanism which limits their effect only to this call of the
function. Those specifically relevant for this function are the following:
<code>hmult</code>, 
<code>h.weights</code>, 
<code>band</code>, 
<code>add</code>, 
<code>lty</code>, 
<code>display</code>, 
<code>props</code>, 
<code>xlab</code>, 
<code>ylab</code>, 
<code>zlab</code>, 
<code>xlim</code>, 
<code>ylim</code>, 
<code>yht</code>,        
<code>nbins</code>, 
<code>ngrid</code>, 
<code>eval.points</code>, 
<code>panel</code>, 
<code>positive</code>, 
<code>delta</code>, 
<code>theta</code>, 
<code>phi</code>;
see the documentation of  <code>sm.options</code> for their description.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>see Chapters 1, 2 and 6 of the reference below.
In the three-dimensional case, the contours of the density estimate are
constructed by the <code>contour3d</code> function in the <code>misc3d</code>
package of Feng &amp; Tierney.
</p>


<h3>Value</h3>

<p>a list containing the values of the density estimate at the evaluation points,
the smoothing parameter, the smoothing parameter weights and the kernel 
weights.  For one- and two-dimensional data, the standard error of the estimate
(on the square root scale, where the standard error is approximately constant)
and the upper and lower ends of a variability band are also supplied.  Less 
information is supplied when the smoothing parameter weights
or kernel weights are not all 1, or when <code>positive</code> is set to <code>TRUE</code>.
</p>


<h3>Side Effects</h3>

<p>a plot is produced, unless the option <code>display="none"</code> is set.
</p>


<h3>References</h3>

<p>Bowman, A.W. and Azzalini, A. (1997). 
<em>Applied Smoothing Techniques for Data Analysis: </em>
<em>the Kernel Approach with S-Plus Illustrations.</em>
Oxford University Press, Oxford.
</p>


<h3>See Also</h3>

<p><code>h.select</code>, <code>hnorm</code>, <code>hsj</code>, <code>hcv</code>,
<code>nise</code>, <code>nmise</code>, <code>sm</code>,
<code>sm.sphere</code>, <code>sm.regression</code>,
<code>sm.options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  A one-dimensional example
y &lt;- rnorm(50)
sm.density(y, model = "Normal")
# sm.density(y, panel = TRUE)

#  A two-dimensional example
y &lt;- cbind(rnorm(50), rnorm(50))
sm.density(y, display = "image")
# sm.density(y, panel = TRUE)


#  A three-dimensional example
# y &lt;- cbind(rnorm(50), rnorm(50), rnorm(50))
# sm.density(y)
</code></pre>


</div>