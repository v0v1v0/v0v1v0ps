<div class="container">

<table style="width: 100%;"><tr>
<td>sim.bssr.gee.1subgroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a longitudinal one subgroup design with internal pilot Study</h2>

<h3>Description</h3>

<p>Given estimates of the treatment effects to be proven, the variances, and the prevalence,
<code>sim.bssr.gee.1subgroup</code> calculates an initial sample size and performs a blinded sample size recalculation
after a pre-specified number of subjects have been enrolled. Each observation is simulated and a final analysis executed.
Several variations are included, such as different approximations or sample size allocation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bssr.gee.1subgroup(
  nsim = 1000,
  alpha = 0.05,
  tail = "both",
  beta = 0.2,
  delta = c(0.1, 0.1),
  vdelta = c(0.1, 0.1),
  sigma_pop = c(3, 3),
  vsigma_pop = c(3, 3),
  tau = 0.5,
  rho = 0.25,
  vrho = 0.25,
  theta = 1,
  vtheta = 1,
  Time = 0:5,
  rec.at = 0.5,
  k = 1,
  model = 1,
  V = diag(rep(1, length(Time))),
  OD = 0,
  vdropout = rep(0, length(Time)),
  missingtype = "none",
  vmissingtype = "none",
  seed = 2015
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulation runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level (type I error) to which the hypothesis is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>which type of test is used, e.g. which quartile und H0 is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>type II error (power=1-beta) to which an alternative should be proven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>vector of true treatment effects, c(overall population, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdelta</code></td>
<td>
<p>vector of treatment effects to be proven, c(overall population, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_pop</code></td>
<td>
<p>vector of true standard deviations of the treatment effects, c(overall population, subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsigma_pop</code></td>
<td>
<p>vector of assumed standard deviations, c(overall population, inside subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>subgroup prevalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>true correlation coefficient between two adjacent timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vrho</code></td>
<td>
<p>initial expectation of the correlation coefficient between two adjacent timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>true correlation absorption coefficient if timepoints are farther apart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vtheta</code></td>
<td>
<p>expected correlation absorption coefficient if timepoints are farther apart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>vector of measured timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rec.at</code></td>
<td>
<p>blinded sample size review is performed after <code>rec.at</code>*<code class="reqn">100\%</code> subjects of the initial sample size calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>sample size allocation factor between groups: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>which of the two often revered statistical models should be used?: see 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>working covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OD</code></td>
<td>
<p>overall dropout measured at last timepoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdropout</code></td>
<td>
<p>vector of expected dropouts per timepoint if missingness is to be expected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingtype</code></td>
<td>
<p>true missingtype underlying the missingness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmissingtype</code></td>
<td>
<p>initial assumptions about the missingtype underlying the missingness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set seed value for the simulations to compare results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function combines sample size estimation, blinded sample size re-estimation and analysis in a design with a subgroup within a full population where we want to test for treatment effects between a control and a treatment group.
The required sample size for the control and treatment group to prove an existing
alternative <code>delta</code> with a specified power 1-<code>beta</code> when testing the global null hypothesis <code class="reqn">H_0: \Delta_F=\Delta_S=0</code> to level <code>alpha</code> is calculated prior to the study and then recalculated in an internal pilot study.
</p>
<p>For sample sizes <code class="reqn">n_C</code> and <code class="reqn">n_T</code> of the control and treatment group, respectively, the argument <code>k</code> is the
sample size allocation factor, i.e. <code class="reqn">k = n_T/n_C</code>.
</p>


<h3>Value</h3>

<p><code>sim.bssr.1subgroup</code> returns a data.frame containing the mean and variance of recalculated sample sizes within the control group and treatment group respectively and the achieved simulated power along with all relevant parameters.
</p>


<h3>Source</h3>

<p><code>sim.bssr.gee.1subgroup</code> uses code contributed by Roland Gerard Gera.
</p>


<h3>See Also</h3>

<p><code>sim.bssr.gee.1subgroup</code> makes use of <code>n.gee.1subgroup</code>, <code>bssr.gee.1subgroup</code>, and <code>r.gee.1subgroup</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim.bssr.gee.1subgroup(nsim = 5,missingtype = "intermittened")

</code></pre>


</div>