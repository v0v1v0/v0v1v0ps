<div class="container">

<table style="width: 100%;"><tr>
<td>gendata_spacoap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate simulated data</h2>

<h3>Description</h3>

<p>Generate simulated data from spaital covariate-augmented Poisson factor models
</p>


<h3>Usage</h3>

<pre><code class="language-R">gendata_spacoap(
  seed = 1,
  width = 20,
  height = 30,
  p = 500,
  d = 40,
  k = 3,
  q = 5,
  rank0 = 3,
  eta0 = 0.5,
  bandwidth = 1,
  rho = c(10, 1),
  sigma2_eps = 1,
  seed.beta = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a postive integer, specify the width of the spatial grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>a postive integer, specify the height of the spatial grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a postive integer, specify the dimension of count variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a postive integer,  specify the dimension of covariate matrix with low-rank regression coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a postive integer,  specify the dimension of  covariate matrix as control variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a postive integer,  specify the number of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank0</code></td>
<td>
<p>a postive integer, specify the rank of the coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta0</code></td>
<td>
<p>a real between 0 and 1, specify the spatial autocorrelation parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>a real positive value, specify the bandwidth in calculating the weighted adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a numeric vector with length 2 and positive elements, specify the signal strength of loading matrix and regression coefficient, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2_eps</code></td>
<td>
<p>a positive real, the variance of overdispersion error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.beta</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process by fixing the regression coefficient matrix beta.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components:
</p>

<ul>
<li> <p><code>X</code> - the high-dimensional count matrix; 
</p>
</li>
<li> <p><code>Z</code> - the low-dimensional covariate matrix with control variables.
</p>
</li>
<li> <p><code>H</code> - the high-dimensional covariate matrix;
</p>
</li>
<li> <p><code>Adj_sp</code> - the weighted adjacence matrix;
</p>
</li>
<li> <p><code>alpha0</code> - the regression coefficient matrix corresponing to Z;
</p>
</li>
<li> <p><code>bbeta0</code> - the low-rank large regression coefficient matrix corresponing to H; 
</p>
</li>
<li> <p><code>B0</code> - the loading matrix;
</p>
</li>
<li> <p><code>F0</code> -  the laten factor matrix;
</p>
</li>
<li> <p><code>rank0</code> - the true rank of bbeta0;
</p>
</li>
<li> <p><code>q</code> - the true number of factors;
</p>
</li>
<li> <p><code>eta0</code> - spatial autocorrelation parameter;
</p>
</li>
<li> <p><code>pos</code> - spatial coordinates for each observation.
</p>
</li>
</ul>
<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code>SpaCOAP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">width &lt;- 20; height &lt;- 15; p &lt;- 100
d &lt;- 20; k &lt;- 3; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_spacoap(width=width, height=height, p=p, d=20, k=k, q=q, rank0=r)
str(datlist)
</code></pre>


</div>