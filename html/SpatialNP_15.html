<div class="container">

<table style="width: 100%;"><tr>
<td>Spatial signs, symmetrized signs, ranks and signed ranks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial signs, symmetrized signs, ranks and signed ranks</h2>

<h3>Description</h3>

<p>Functions to compute spatial signs, symmetrized signs, ranks and
signed ranks.</p>


<h3>Usage</h3>

<pre><code class="language-R">spatial.signs(X, center = TRUE, shape = TRUE, 
na.action = na.fail,...)
spatial.symmsign(X, shape = TRUE, na.action = na.fail, ...)
spatial.rank(X, shape = TRUE, na.action = na.fail, ...)
spatial.signrank(X, center = TRUE, shape = TRUE, 
na.action = na.fail,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix or a data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a vector or a logical, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a matrix or a logical, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments that can be passed on to function used for the
estimation of shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain 'NA's.  Default is to fail.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The spatial signs of an observed vector is simply the
vector, possibly affinely transformed first, multiplied by its
Euclidian length. See <code>spatial.sign</code> for a precise
definition. Symmetrized spatial signs are the spatial signs of the pairwise
differences of the data 
</p>
<p style="text-align: center;"><code class="reqn">||x_i-x_j||^{-1}(x_i-x_j)</code>
</p>

<p>(there are <code>n</code> over 2 of these). Spatial
rank of an observation is the average of the signs of the differences
of that observation and the others:
</p>
<p style="text-align: center;"><code class="reqn">R(x_i)=ave_j\{||x_i-x_j||^{-1}(x_i-x_j)\}</code>
</p>

<p>Spatial signed rank of an observation is defined as
</p>
<p style="text-align: center;"><code class="reqn">Q(x_i)=(R(x_i)+ave_j\{||x_i+x_j||^{-1}(x_i+x_j)\})/2</code>
</p>

<p>If a numerical value is given for <code>shape</code> and/or <code>center</code>
these are used to transform the data before the computation of signs
or ranks. A logical <code>TRUE</code> indicates that the shape or center should be
estimated. In this case an affine transformation that makes the
resulting signs or ranks have a covariance matrix equal or
proportional to the identity matrix and centerd on the origin is
found. A logical <code>FALSE</code> indicates that the null value, that is, the
identity matrix or the origin, should be used. Note that only signed
ranks depend on a center.
</p>
<p>The value of shape and/or location used are returned as attributes.
</p>


<h3>Author(s)</h3>

<p>Seija Sirkia, <a href="mailto:seija.sirkia@iki.fi">seija.sirkia@iki.fi</a></p>


<h3>References</h3>

<p><cite>Visuri, S., Koivunen, V. and Oja, H. (2000). Sign and rank covariance matrices. <em>J. Statistical Planning and Inference</em>, 91, 557-575.</cite></p>


<h3>See Also</h3>

<p><code>spatial.sign</code> for the signs, spatial sign and rank covariance matrices and <code>spatial.shape</code> for the standardizing transformations</p>


<h3>Examples</h3>

<pre><code class="language-R">A&lt;-matrix(c(1,2,-3,4),ncol=2)
X&lt;-matrix(rnorm(100),ncol=2)%*%t(A)
def.par&lt;-par(no.readonly=TRUE) # for resetting
layout(matrix(1:4,ncol=2,nrow=2,byrow=TRUE))
plot(X,col=c(2,rep(1,19)))
plot(spatial.symmsign(X),col=c(2,rep(1,19)),xlim=c(-1,1),ylim=c(-1,1))
theta&lt;-seq(0,2*pi,length=1000)
lines(sin(theta),cos(theta))
plot(spatial.rank(X),col=c(2,rep(1,19)),xlim=c(-1,1),ylim=c(-1,1))
lines(sin(theta),cos(theta))
plot(spatial.signrank(X),col=c(2,rep(1,19)),xlim=c(-1,1),ylim=c(-1,1))
lines(sin(theta),cos(theta))
par(def.par)
</code></pre>


</div>