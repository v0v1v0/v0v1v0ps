<div class="container">

<table style="width: 100%;"><tr>
<td>sf.kde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial kernel density estimate</h2>

<h3>Description</h3>

<p>A weighted or unweighted Gaussian Kernel Density estimate 
for point spatial data
</p>


<h3>Usage</h3>

<pre><code class="language-R">sf.kde(
  x,
  y = NULL,
  bw = NULL,
  ref = NULL,
  res = NULL,
  standardize = FALSE,
  scale.factor = 10000,
  mask = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sf POINT object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Optional values, associated with x coordinates, 
to be used as weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Distance bandwidth of Gaussian Kernel, must be units 
of projection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>A terra SpatRaster, sf class object or c[xmin,xmax,ymin,ymax] 
vector to estimate the kde extent</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Resolution of raster when ref not SpatRaster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Standardize results to 0-1 (FALSE/TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.factor</code></td>
<td>
<p>Numeric scaling factor for the KDE (defaults to 10000),
to account for very small estimate values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>(TRUE/FALSE) mask resulting raster if ref is provided
as a SpatRaster</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please note that ks methods for estimation has been reverted to the Gussian method proposed
in Venables &amp; Ripley (2002). There was not enought evendence that the Chacon &amp; Duong (2018)
multivariate method(s) for bandwidth selection and kernal estimation were suitable for 
spatial random fields.
</p>


<h3>Value</h3>

<p>a terra SpatRaster class object containing kernel density estimate
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt;
</p>


<h3>References</h3>

<p>Duong, T. &amp; Hazelton, M.L. (2005) Cross-validation bandwidth matrices for multivariate 
kernel density estimation. Scandinavian Journal of Statistics, 32, 485-506. 
</p>
<p>Wand, M.P. &amp; Jones, M.C. (1994) Multivariate plug-in bandwidth selection. Computational 
Statistics, 9, 97-116. 
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S. 
Fourth edition. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
library(sf) 
library(terra) 
  
data(meuse, package = "sp")
meuse &lt;- st_as_sf(meuse, coords = c("x", "y"), crs = 28992, 
                  agr = "constant") 
  			
# Unweighted KDE (spatial locations only) with 40m resoultion  				
pt.kde &lt;- sf.kde(x = meuse, bw = 1000, standardize = TRUE, res=40)
  plot(pt.kde, main="Unweighted kde")
    plot(st_geometry(meuse), pch=20, col="red", add=TRUE) 

# cadmium weighted KDE usign extent with 40m resoultion and 500m and 1000m bw 
cadmium.kde.500 &lt;- sf.kde(x = meuse, y = meuse$cadmium, res=40, 
                          bw = 500, standardize = TRUE)
cadmium.kde.1000 &lt;- sf.kde(x = meuse, y = meuse$cadmium, res=40, 
                          bw = 1000, standardize = TRUE)						  
  plot(c(cadmium.kde.500, cadmium.kde.1000))
  			  			


</code></pre>


</div>