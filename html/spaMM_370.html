<div class="container">

<table style="width: 100%;"><tr>
<td>negbin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Family function for negative binomial “2” response (including truncated variant).
</h2>

<h3>Description</h3>

<p>Returns a GLM <code>family</code> object for negative-binomial model with variance quadratically related to the mean <code class="reqn">\mu</code>: variance=<code class="reqn">\mu+\mu^2</code>/shape, where the shape parameter need or need not be specified, depending on usage. The zero-truncated variant can be specified as <code>negbin2(., trunc = 0L)</code>. See <code>negbin1</code> for the alternative negative-binomial model with variance “linearly” related to the mean. 
</p>
<p>A <b>fixed-effect</b> residual-dispersion model can be fitted, using the <code>resid.model</code> argument, which is used to specify the form of the logarithm of the shape parameter. Thus the variance of the response become <code class="reqn">\mu+\mu^2</code>/<code>exp(&lt;specified linear expression&gt;)</code>.
</p>
<p><code>negbin(.)</code> is an alias for <code>negbin2(.)</code> (truncated or not), and <code>Tnegbin(.)</code> is an alias for <code>negbin2(., trunc = 0L)</code>.  
</p>


<h3>Usage</h3>

<pre><code class="language-R"># (the shape parameter is actually not requested unless this is used in a glm() call)
#
negbin2(shape = stop("negbin2's 'shape' must be specified"), link = "log", trunc = -1L, 
        LLgeneric = TRUE)

# For use with glm(), both negbin2's 'shape' and glm's method="llm.fit" are needed.  

# alias with distinct arguments:
Tnegbin(shape = stop("Tnegbin's 'shape' must be specified"), link = "log")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>

<p>Shape parameter of the underlying Gamma distribution: the present negative binomial distribution can be represented as a Poisson-Gamma mixture, where the conditional Poisson mean is <code class="reqn">\mu</code> times a Gamma random variable with mean 1 and variance  <code>1/shape</code> (as produced by <code>rgamma(., shape=shape,scale=1/shape)</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>log, sqrt or identity link, specified by any of the available ways for GLM links (name, character string, one-element character vector, or object of class <code>link-glm</code> as returned by <code>make.link</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>

<p>Either <code>0L</code> for zero-truncated distribution, or <code>-1L</code> for default untruncated distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLgeneric</code></td>
<td>

<p>For development purposes, not documented. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>shape</code> is the <code class="reqn">k</code> parameter of McCullagh and Nelder (1989, p.373) and the <code>theta</code> parameter of Venables and Ripley (2002, section 7.4). The latent Gamma variable has mean 1 and variance 1/shape. 
</p>
<p>The name <code>NB_shape</code> should be used to set values of shape in optimization control arguments of the fitting functions (e.g., <code>fitme(.,init=list(NB_shape=1))</code>); but fixed values are set by the <code>shape</code> argument.
</p>
<p>The returned family object is formally suitable for usage with <code>glm</code> if the <code>shape</code> argument is specified, but such usage is <em>not</em> recommended as it will lead to incorrect results for the zero-truncated case.
</p>


<h3>Value</h3>

<p>A family object with structure similar to <code>stats::</code> family object but with additional member functions for usage with <span class="pkg">spaMM</span> fitting functions.
</p>


<h3>References</h3>

<p>McCullagh, P. and Nelder, J.A. (1989) Generalized Linear Models, 2nd edition. London: Chapman &amp; Hall.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S-PLUS. Fourth Edition. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fitting negative binomial model with estimated scale parameter:
data("scotlip")
fitme(cases~I(prop.ag/10)+offset(log(expec)),family=negbin(), data=scotlip)
negfit &lt;- fitme(I(1+cases)~I(prop.ag/10)+offset(log(expec)),family=Tnegbin(), data=scotlip)
simulate(negfit,nsim=3)
</code></pre>


</div>