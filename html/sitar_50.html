<div class="container">

<table style="width: 100%;"><tr>
<td>sitar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit SITAR growth curve model</h2>

<h3>Description</h3>

<p>SITAR is a method of growth curve analysis, based on <span class="pkg">nlme</span>, that
summarises a set of growth curves with a mean growth curve as a regression
spline, plus a set of up to four fixed and random effects (a, b, c and d)
defining how individual growth curves differ from the mean curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sitar(
  x,
  y,
  id,
  data,
  df,
  knots,
  fixed = NULL,
  random = "a + b + c",
  pdDiag = FALSE,
  a.formula = ~1,
  b.formula = ~1,
  c.formula = ~1,
  d.formula = ~1,
  bounds = 0.04,
  start,
  xoffset = "mean",
  bstart = xoffset,
  returndata = FALSE,
  verbose = FALSE,
  correlation = NULL,
  weights = NULL,
  subset = NULL,
  method = "ML",
  na.action = na.fail,
  control = nlmeControl(msMaxIter = 100, returnObject = TRUE),
  keep.data = TRUE
)

## S3 method for class 'sitar'
update(object, ..., evaluate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of ages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>factor of subject identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing variables <code>x</code>, <code>y</code> and
<code>id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for cubic regression spline (0 or more, see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>vector of values for knots (default <code>df</code> quantiles of
<code>x</code> distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>character string specifying a, b, c, d fixed effects (default
<code>random</code> or the subset of "a + b + c + d" within <code>random</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>character string specifying a, b, c, d random effects (default
<code>"a+b+c"</code>). Alternatively <code>nlme</code> formula e.g.
<code>"list(id = pdDiag(a + b + c ~ 1))"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdDiag</code></td>
<td>
<p>logical which if TRUE fits a diagonal random effects
covariance matrix, or if FALSE (default) a general covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.formula</code></td>
<td>
<p>formula for fixed effect a (default <code>~ 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.formula</code></td>
<td>
<p>formula for fixed effect b (default <code>~ 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.formula</code></td>
<td>
<p>formula for fixed effect c (default <code>~ 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.formula</code></td>
<td>
<p>formula for fixed effect d (default <code>~ 1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>span of <code>x</code> for regression spline, or fractional
extension of range (default 0.04).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>optional numeric vector of initial estimates for the fixed
effects, or list of initial estimates for the fixed and random effects (see
<code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xoffset</code></td>
<td>
<p>optional value of offset for <code>x</code> (either "mean"
(default), "apv" or value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bstart</code></td>
<td>
<p>optional starting value for fixed effect <code>b</code> (either
"mean", "apv" or value (default <code>xoffset</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returndata</code></td>
<td>
<p>logical which if TRUE causes the model matrix to be
returned, or if FALSE (default) the fitted model. Setting returndata TRUE is
useful in conjunction with <code>subset</code> and <code>subsample</code> for
simulation purposes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>optional logical value to print information on the evolution
of the iterative algorithm (see <code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>optional <code>corStruct</code> object describing the
within-group correlation structure (see <code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure (see
<code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>optional expression indicating the subset of the rows of data
that should be used in the fit (see <code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string, either "REML" or "ML" (default) (see
<code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function for when the data contain NAs (see
<code>nlme</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control values for the estimation algorithm (see
<code>nlme</code>) (default nlmeControl(returnObject = TRUE)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.data</code></td>
<td>
<p>logical to control saving <code>data</code> as part of the model
object (default TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>sitar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters for <code>update</code> consisting of any of the
above <code>sitar</code> parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate</code></td>
<td>
<p>logical to control evaluation.  If TRUE (default) the
expanded <code>update</code> call is passed to <code>sitar</code> for evaluation, while
if FALSE the expanded call itself is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The SITAR model usually has up to three random effects (a, b and c), termed
size, timing and intensity respectively. <code>df</code> sets the degrees of freedom
for the mean spline curve, taking values from 1 (i.e. linear) upwards. In
addition there is a random effect for the slope, d, which is fitted when
<code>df = 0</code>, and combined with a, it provides the classic random intercept random
slope model, which is similar to the 1 df spline model. In addition d can be
fitted, along with a, b and c, to extend
SITAR to model variability in the adult slope of the growth curve.
</p>
<p><code>xoffset</code> allows the origin of <code>x</code> to be varied, while
<code>bstart</code> specifies the starting value for <code>b</code>, both of which can
affect the model fit and particularly <code>b</code>. The values of <code>bstart</code>,
<code>knots</code> and <code>bounds</code> are offset by <code>xoffset</code> for fitting
purposes, and similarly for fixed effect <code>b</code>.
</p>
<p>The formulae <code>a.formula</code>, <code>b.formula</code>, <code>c.formula</code> and <code>d.formula</code>
allow for cov.names and
can include functions and interactions. <code>make.names</code> is used to
ensure that the names of the corresponding model terms are valid. The
modified not the original names need to be specified in <code>predict.sitar</code>.
</p>
<p><code>update</code> updates the model by taking the <code>object</code> call, adding any
new parameters and replacing changed ones. Where feasible the fixed and
random effects of the model being updated are suitably modified and passed
via the <code>start</code> argument.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>sitar</code> representing the
nonlinear mixed-effects model fit, with all the components returned by
<code>nlme</code> (see <code>nlmeObject</code> for a full description) plus the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitnlme</code></td>
<td>
<p>the function returning the predicted value of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>copy of <code>data</code> (if <code>keep.data</code> true).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>data frame of mean a-b-c-d values for unique combinations
of covariates (excluding <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call.sitar</code></td>
<td>
<p>the internal <code>sitar</code> call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xoffset</code></td>
<td>
<p>the value of <code>xoffset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>the <code>lm</code> object providing starting values for the B-spline curve.</p>
</td>
</tr>
</table>
<p>Generic functions such as <code>print</code>, <code>plot</code>, <code>anova</code> and
<code>summary</code> have methods to show the results of the fit. The functions
<code>residuals</code>, <code>coef</code>, <code>fitted</code>, <code>fixed.effects</code>,
<code>random.effects</code>, <code>predict</code>, <code>getData</code>, <code>getGroups</code>,
<code>getCovariate</code> and <code>getVarCov</code> can be used to extract some of its
components.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(heights)
##  fit simple model
(m1 &lt;- sitar(x=age, y=height, id=id, data=heights, df=5))

##  relate random effects to age at menarche (with censored values +ve)
##  both a (size) and b (timing) are positively associated with age at menarche
(m2 &lt;- update(m1, a.formula = ~abs(men), b.formula = ~abs(men), c.formula = ~abs(men)))
</code></pre>


</div>