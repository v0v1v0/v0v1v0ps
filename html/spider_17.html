<div class="container">

<table style="width: 100%;"><tr>
<td>monophylyBoot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Species monophyly over a tree</h2>

<h3>Description</h3>

<p>Determines if the species given in <code>sppVector</code> form monophyletic groups
on a given tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">monophylyBoot(phy, sppVector, DNAbin, thresh = 0.7, reroot = TRUE,
  pp = NA, singletonsMono = TRUE, reps = 1000, block = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A tree of class ‘phylo’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sppVector</code></td>
<td>
<p>Species vector. See <code>sppVector</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DNAbin</code></td>
<td>
<p>An object of class 'DNAbin'. Required for calculating
bootstrap values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Numeric between 0 and 1. Bootstrap threshold under which
potentially monophyletic species are negated. Default of 0.7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reroot</code></td>
<td>
<p>Logical. Should the bootstrap replicates be rerooted on the
longest edge? Default of TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>Object of class ‘prop.part’. Assists in speeding up the function,
if it has been called already. Default of NA, calling
<code>prop.part</code> internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singletonsMono</code></td>
<td>
<p>Logical. Should singletons (i.e. only a single
specimen representing that species) be treated as monophyletic? Default of
TRUE. Possible values of FALSE and NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Numeric. Number of bootstrap replications. Default of 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>The number of nucleotides that will be resampled together.
Default of 3 to resample on the codon level.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>monophyly</code> determines if each species is monophyletic.
<code>monophylyBoot</code> incorporates a bootstrap test to determine the support
for this monophyly. Species with a bootstrap support lower than
<code>"thresh"</code> are recorded as FALSE.
</p>
<p>Rerooting is done on the longest internal edge in the tree returned by
<code>nj(dist.dna(DNAbin))</code>.
</p>


<h3>Value</h3>

<p><code>monophyly</code> returns a logical vector, stating if each species
is monophyletic. Values correspond to the species order given by
<code>unique(sppVector)</code>.
</p>
<p><code>monophylyBoot</code> returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>A logical vector, stating if each species is monophyletic
with a bootstrap support higher than the given threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BSvalues</code></td>
<td>
<p>A
numeric vector giving the bootstrap proportions for each node of
<code>phy</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Samuel Brown &lt;s_d_j_brown@hotmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>prop.part</code>, <code>root</code>,
<code>boot.phylo</code>, <code>monophyly</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Random trees
set.seed(16)
tr &lt;- ape::rtree(15)
spp &lt;- rep(LETTERS[1:5], rep(3,5))
monophyly(tr, spp)

tr2 &lt;- tr
spp2 &lt;- c(rep(LETTERS[1:4], rep(3,4)), LETTERS[5:7])
monophyly(tr2, spp2)

#Empirical data
## Not run: 
data(anoteropsis)
anoTree &lt;- ape::nj(ape::dist.dna(anoteropsis))
anoSpp &lt;- sapply(strsplit(dimnames(anoteropsis)[[1]], split="_"), 
    function(x) paste(x[1], x[2], sep="_"))

monophyly(anoTree, anoSpp)
monophyly(anoTree, anoSpp, singletonsMono=FALSE)
unique(anoSpp)

#To get score for each individual
anoMono &lt;- monophyly(anoTree, anoSpp)
anoMono[match(anoSpp, unique(anoSpp))]

data(woodmouse)
woodTree &lt;- ape::nj(ape::dist.dna(woodmouse))
woodSpp &lt;- c("D", "C", "C", "A", "A", "E", "A", "F", "C", "F", "E", "D", "A", "A", "E")
unique(woodSpp)
monophyly(woodTree, woodSpp)
woodMono &lt;- monophylyBoot(woodTree, woodSpp, woodmouse)
woodMono$results
woodMono$BSvalues

monophylyBoot(woodTree, woodSpp, woodmouse, reroot = FALSE)
monophylyBoot(woodTree, woodSpp, woodmouse, thresh = 0.9, reroot = FALSE)

## End(Not run)

</code></pre>


</div>