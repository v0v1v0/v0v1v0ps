<div class="container">

<table style="width: 100%;"><tr>
<td>summarize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summarize simulation results</h2>

<h3>Description</h3>

<p>This function calculates summary statistics for simulation
results, including descriptive statistics (e.g. measures of center or
spread) and inferential statistics (e.g. bias or confidence interval
coverage). All summary statistics are calculated over simulation
replicates within a single simulation level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">summarize(sim, ..., mc_se = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>A simulation object of class <code>sim_obj</code>, usually created by
<code>new_sim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One or more lists, separated by commas, specifying desired
summaries of the <code>sim</code> simulation object. See examples. Each list
must have a <code>stat</code> item, which specifies the type of summary
statistic to be calculated. The <code>na.rm</code> item indicates whether to
exclude <code>NA</code> values when performing the calculation (with default
being <code>FALSE</code>). For <code>stat</code> options where the <code>name</code> item
is optional, if it is not provided, a name will be formed from the type
of summary and the column on which the summary is performed. Additional
required items are detailed below for each <code>stat</code> type.
</p>

<ul>
<li>
<p><code>list(stat="mean", x="col_1", name="mean_col", na.rm=F)</code>
computes the mean of column <code>sim$results$col_1</code> for each level
combination and creates a summary column named <code>"mean_col"</code>. Other
single-column summary statistics (see the next few items) work
analogously. <code>name</code> is optional.
</p>
</li>
<li>
<p><code>list(stat="median", ...)</code> computes the median.
</p>
</li>
<li>
<p><code>list(stat="var", ...)</code> computes the variance.
</p>
</li>
<li>
<p><code>list(stat="sd", ...)</code> computes the standard deviation.
</p>
</li>
<li>
<p><code>list(stat="mad", ...)</code> computes the mean absolute deviation.
</p>
</li>
<li>
<p><code>list(stat="iqr", ...)</code> computes the interquartile range.
</p>
</li>
<li>
<p><code>list(stat="min", ...)</code> computes the minimum.
</p>
</li>
<li>
<p><code>list(stat="max", ...)</code> computes the maximum.
</p>
</li>
<li>
<p><code>list(stat="is_na", ...)</code> computes the number of NA values.
</p>
</li>
<li>
<p><code>list(stat="correlation", x="col_1", y="col_2",
    name="cor_12")</code> computes the (Pearson's) correlation coefficient between
<code>sim$results$col_1</code> and <code>sim$results$col_2</code> for each level
combination and creates a summary column named <code>"cor_12"</code>.
</p>
</li>
<li>
<p><code>list(stat="covariance", x="col_1", y="col_2",
    name="cov_12")</code> computes the covariance between <code>sim$results$col_1</code>
and <code>sim$results$col_2</code> for each level combination and creates a
summary column named <code>"cov_12"</code>.
</p>
</li>
<li>
<p><code>list(stat="quantile", x="col_1", prob=0.8, name="q_col_1")</code>
computes the 0.8 quantile of column <code>sim$results$col_1</code> and creates
a summary column named <code>"q_col_1"</code>. <code>prob</code> can be any number in
[0,1].
</p>
</li>
<li>
<p><code>list(stat="bias", estimate="est", truth=5,
    name="bias_est")</code> computes the absolute bias of the estimator
corresponding to column <code>"sim$results$est"</code>, relative to the true
value given in <code>truth</code>, and creates a summary column named
<code>"bias_est"</code>. <code>name</code> is optional. See <em>Details</em>.
</p>
</li>
<li>
<p><code>list(stat="bias_pct", estimate="est", truth=5,
    name="bias_est")</code> computes the percent bias of the estimator
corresponding to column <code>"sim$results$est"</code>, relative to the true
value given in <code>truth</code>, and creates a summary column named
<code>"bias_pct_est"</code>. <code>name</code> is optional. See <em>Details</em>.
</p>
</li>
<li>
<p><code>list(stat="mse", estimate="est", truth=5,
    name="mse_est")</code> computes the mean squared error of the estimator
corresponding to column <code>"sim$results$est"</code>, relative to the true
value given in <code>truth</code>, and creates a summary column named
<code>"mse_est"</code>. <code>name</code> is optional. See <em>Details</em>.
</p>
</li>
<li>
<p><code>list(stat="mae", estimate="est", truth=5,
    name="mae_est")</code> computes the mean absolute error of the estimator
corresponding to column <code>"sim$results$est"</code>, relative to the true
value given in <code>truth</code>, and creates a summary column named
<code>"mae_est"</code>. <code>name</code> is optional. See <em>Details</em>.
</p>
</li>
<li>
<p><code>list(stat="coverage", estimate="est", se="se_est",
    truth=5, name="cov_est")</code> or
<code>list(stat="coverage", lower="est_l", upper="est_u",
    truth=5, name="cov_est")</code> computes confidence interval coverage. With the
first form, <code>estimate</code> gives the name of the variable in
<code>sim$results</code> corresponding to the estimator of interest and
<code>se</code> gives the name of the variable containing the standard error of
the estimator of interest. With the second form, <code>lower</code> gives the
name of the variable containing the confidence interval lower bound and
<code>upper</code> gives the name of the confidence interval upper bound. In
both cases, <code>truth</code> is the true value (see <em>Details</em>), and a
summary column named <code>"cov_est"</code> is created.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc_se</code></td>
<td>
<p>A logical argument indicating whether to compute Monte Carlo
standard error and associated confidence interval for inferential summary
statistics.  This applies only to the <code>bias</code>, <code>bias_pct</code>,
<code>mse</code>, <code>mae</code>, and <code>coverage</code> summary statistics.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p>For all inferential summaries there are three ways to specify
<code>truth</code>: (1) a single number, meaning the estimand is the same
across all simulation replicates and levels, (2) a numeric vector of the
same length as the number of rows in <code>sim$results</code>, or (3) the name
of a variable in <code>sim$results</code> containing the estimand of interest.
</p>
</li>
<li>
<p>There are two ways to specify the confidence interval bounds for
<code>coverage</code>. The first is to provide an <code>estimate</code> and its
associated <code>se</code> (standard error). These should both be variables in
<code>sim$results</code>. The function constructs a 95% Wald-type confidence
interval of the form <code>(estimate-1.96*se, estimate+1.96*se)</code>. The
alternative is to provide <code>lower</code> and <code>upper</code> bounds, which
should also be variables in <code>sim$results</code>. In this case, the
confidence interval is (<code>lower</code>, <code>upper</code>). The coverage is the
proportion of simulation replicates for a given level combination in
which <code>truth</code> lies within the interval.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A data frame containing the result of each specified summary function
as a column, for each of the simulation levels. The column <code>n_reps</code>
returns the number of successful simulation replicates within each level.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sim &lt;- new_sim()
create_data &lt;- function(n) { rpois(n, lambda=5) }
est_mean &lt;- function(dat, type) {
  if (type=="M") { return(mean(dat)) }
  if (type=="V") { return(var(dat)) }
}
sim %&lt;&gt;% set_levels(n=c(10,100,1000), est=c("M","V"))
sim %&lt;&gt;% set_config(num_sim=5)
sim %&lt;&gt;% set_script(function() {
  dat &lt;- create_data(L$n)
  lambda_hat &lt;- est_mean(dat=dat, type=L$est)
  return (list("lambda_hat"=lambda_hat))
})
sim %&lt;&gt;% run()
sim %&gt;% summarize(
  list(stat = "mean", name="mean_lambda_hat", x="lambda_hat"),
  list(stat = "mse", name="lambda_mse", estimate="lambda_hat", truth=5)
)
</code></pre>


</div>