<div class="container">

<table style="width: 100%;"><tr>
<td>surrogate.ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create surrogate time series via Markov process
</h2>

<h3>Description</h3>

<p>Create surrogate time series with the same short-term time correlation and overall
temporal pattern as the original time series using the Markov process described by
Cazelles and Stones (2003)
</p>


<h3>Usage</h3>

<pre><code class="language-R">surrogate.ts (ts, distr.ts = NULL, trans.ts = NULL, nbreaks = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>time series in matrix format (<code>n</code> rows x 2 columns). The first column should contain the time 
steps and the second column should contain the values. If <code>ts</code> is a column vector 
instead of a matrix, then it will be automatically converted to a matrix with 
column 1 corresponding to a time index ranging from 1 to the length of <code>ts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr.ts</code></td>
<td>

<p>binning of time series values. This parameter must be specified 
if <code>trans.ts</code> is not set to <code>NULL</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans.ts</code></td>
<td>

<p>transition matrix from bin <code class="reqn">i</code> to bin <code class="reqn">j</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreaks</code></td>
<td>

<p>number of bins to use to group the time series values. Default is <code>10</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values of the time series <code class="reqn">x_n</code> are grouped into <code>nbreak</code> equally-sized bins. 
The transition matrix <code class="reqn">M_{ij}</code> describing the probability of <code class="reqn">x_{n+1}</code> belonging to 
bin <code class="reqn">j</code> based on <code class="reqn">x_n</code> belonging to bin <code class="reqn">i</code> is defined using the relative
frequencies of the data such that: 
<code class="reqn">M_{ij}=Pr(x_{n+1} \in b_{j} | x_{n} \in b_{i})</code>. The surrogate time series is then constructed
by randomly selecting a starting value and randomly selecting the next value from the proper bin
based on the transition matrix. This process is repeated until the surrogate time series has 
the same length as the original time series.
</p>


<h3>Value</h3>

<p>Returns a named list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>surr.ts </code></td>
<td>
<p>surrogate time series in matrix format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans </code></td>
<td>
<p>transition matrix <code class="reqn">M_{ij}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr </code></td>
<td>
<p>binning of time series values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tarik C. Gouhier (tarik.gouhier@gmail.com)
</p>


<h3>References</h3>

<p>Cazelles, B., and L. Stone. 2003. Detection of imperfect population synchrony 
in an uncertain world. <em>Journal of Animal Ecology</em> 72:953-968.
</p>


<h3>See Also</h3>

<p><code>phase.sync</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">t1=runif(100)
surr.t1=surrogate.ts(ts=t1)
plot(t1, t="l")
lines(surr.t1$surr.ts, col="red")
</code></pre>


</div>