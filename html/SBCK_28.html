<div class="container">

<table style="width: 100%;"><tr>
<td>MVQuantilesShuffle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MVQuantilesShuffle</h2>

<h3>Description</h3>

<p>Multivariate Schaake shuffle using the quantiles.
</p>


<h3>Details</h3>

<p>Used to reproduce the dependence structure of a dataset to another dataset
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>col_cond</code></dt>
<dd>
<p>[vector] Conditionning columns</p>
</dd>
<dt><code>col_ucond</code></dt>
<dd>
<p>[vector] Un-conditionning columns</p>
</dd>
<dt><code>lag_search</code></dt>
<dd>
<p>[integer] Number of lags to transform the dependence structure</p>
</dd>
<dt><code>lag_keep</code></dt>
<dd>
<p>[integer] Number of lags to keep</p>
</dd>
<dt><code>n_features</code></dt>
<dd>
<p>[integer] Number of features (dimensions), internal</p>
</dd>
<dt><code>qY</code></dt>
<dd>
<p>[matrix] Quantile structure fitted, internal</p>
</dd>
<dt><code>bsYc</code></dt>
<dd>
<p>[matrix] Block search fitted, internal</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-MVQuantilesShuffle-new"><code>MVQuantilesShuffle$new()</code></a>
</p>
</li>
<li> <p><a href="#method-MVQuantilesShuffle-fit"><code>MVQuantilesShuffle$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-MVQuantilesShuffle-transform"><code>MVQuantilesShuffle$transform()</code></a>
</p>
</li>
<li> <p><a href="#method-MVQuantilesShuffle-clone"><code>MVQuantilesShuffle$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-MVQuantilesShuffle-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new MVQuantilesShuffle object.
</p>


<h5>Usage</h5>

<div class="r"><pre>MVQuantilesShuffle$new(col_cond = base::c(1), lag_search = 1, lag_keep = 1)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>col_cond</code></dt>
<dd>
<p>Conditionning colum</p>
</dd>
<dt><code>lag_search</code></dt>
<dd>
<p>Number of lags to transform the dependence structure</p>
</dd>
<dt><code>lag_keep</code></dt>
<dd>
<p>Number of lags to keep</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'MVQuantilesShuffle' object.
</p>


<hr>
<a id="method-MVQuantilesShuffle-fit"></a>



<h4>Method <code>fit()</code>
</h4>

<p>Fit method
</p>


<h5>Usage</h5>

<div class="r"><pre>MVQuantilesShuffle$fit(Y)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Y</code></dt>
<dd>
<p>[vector] Dataset to infer the dependance structure</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>NULL
</p>


<hr>
<a id="method-MVQuantilesShuffle-transform"></a>



<h4>Method <code>transform()</code>
</h4>

<p>Transform method
</p>


<h5>Usage</h5>

<div class="r"><pre>MVQuantilesShuffle$transform(X)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X</code></dt>
<dd>
<p>[vector] Dataset to match the dependance structure with the Y fitted</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Z The X with the quantiles structure of Y
</p>


<hr>
<a id="method-MVQuantilesShuffle-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>MVQuantilesShuffle$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>References</h3>

<p>Vrac, M. et S. Thao (2020). “R2 D2 v2.0 : accounting for temporal
dependences in multivariate bias correction via analogue rank
resampling”. In : Geosci. Model Dev. 13.11, p. 5367-5387.
doi :10.5194/gmd-13-5367-2020.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate sample
X = matrix( stats::rnorm( n = 100 ) , ncol = 4 )
Y = matrix( stats::rnorm( n = 100 ) , ncol = 4 )

## Fit dependence structure
## Assume that the link beween column 2 and 4 is correct, and change also
## the auto-correlation structure until lag 3 = lag_keep - 1
mvq = MVQuantilesShuffle$new( base::c(2,4) , lag_search = 6 , lag_keep = 4 )
mvq$fit(Y)
Z = mvq$transform(X)

</code></pre>


</div>