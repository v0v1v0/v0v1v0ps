<div class="container">

<table style="width: 100%;"><tr>
<td>gen_GEE_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate the datasets with clusters</h2>

<h3>Description</h3>

<p><code>gen_GEE_data</code> generates the clustered data used for the generalized
estimating equations with sequential method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_GEE_data(numClusters, clusterSize, clusterRho, clusterCorstr, beta,
  family, intercept = TRUE, xCorstr = "ar1", xCorRho = 0.5,
  xVariance = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numClusters</code></td>
<td>
<p>A numeric number represents the number of clusters we will
generated. Note that each cluster has several similar subjects. It should
be a integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterSize</code></td>
<td>
<p>A numeric number specifying the number of subjects in
each cluster. The subject in the same cluster is highly correlated to each
other which can be regarded as the longitudinal data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterRho</code></td>
<td>
<p>A numeric parameter in correlation structure for the
clusters. It will be ignored when responseCorstr is independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterCorstr</code></td>
<td>
<p>A character string specifying the correlation structure
for the clusters. Allowed structures are: "independence", "exchangeable"
and "ar1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A nummeric vector denotes the true parameter in GEE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The type of response data, matching one of 'gaussian()' or
'binomial()'. The 'gaussian()' corresponds to the continuous case and
'binomial' corresponds to the discrete case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>A logical value indicating whether to add intercept term.
The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xCorstr</code></td>
<td>
<p>A character string specifying the correlation structure for
the covariate. The default value is 'ar1'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xCorRho</code></td>
<td>
<p>A numeric parameter indicating the correlation coefficient in
covariables. It does something similar to what the argument clusterRho
does. The default value is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xVariance</code></td>
<td>
<p>A numeric number specifying the marginal variance in the
correlation matrix in one clusters. The default value is 0.2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The gen_GEE_data function is used to generate data. We can get data from two
different distributions, corresponding to continuous and discrete cases. In
the continuous case, the covariates vector x is created from a multivariate
normal distribution with mean 0 and an AR(1) correlation matrix with
autocorrelation coefficient and marginal variance. The value of
autocorrelation coefficient and marginal variance are two arguments which we
need specified. Then, the response y is generated by the equation: y = wx + e
where the random error vector e follows a normal distribution with mean 0 and
three different covariance structures with corresponding dimensional numbers.
These three covariance matrices are the identity matrix, the exchangeable,
and the AR(1) autoregressive correlation structure. In the discrete case, we
use a logistic model. The covariates vectors x is the same as the continuous
case. The binary response vector for each cluster has  an AR(1) correlation
structure with correlation coefficient alpha, and the marginal expectation u
satisfies the following equation: logit(u) = wx
</p>


<h3>Value</h3>

<p>a list containing the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the covariate matrices. Note that the number of rows is numClusters
*  clusterSize and the number of columns is the length of beta + 1 if
intercept is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response data which has the same number of rows to x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterID</code></td>
<td>
<p>the id for each sample. Note that the subjects in the same
cluster will have identical id. </p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Chen, Z., Wang, Z., &amp; Chang, Y. I. (2019). Sequential adaptive variables and
subject selection for GEE methods. <em>Biometrics</em>. doi:10.1111/biom.13160

</p>


<h3>See Also</h3>


<p><code>gen_multi_data</code> for categorical and ordinal case
</p>
<p><code>gen_bin_data</code> for binary classification case.

</p>


<h3>Examples</h3>

<pre><code class="language-R">initialSampleSize &lt;-  75
clusterSize &lt;-  5
responseCorstr &lt;-  "ar1"
responseCorRho &lt;-  0.3
response &lt;-  gaussian()
beta0 &lt;-  c(1, -1.1, 1.5, -2, rep(0, 50))
xVariance &lt;-  0.2
xCorRho &lt;-  0.5
xCorstr &lt;-  "ar1"
data &lt;- gen_GEE_data(numClusters = initialSampleSize,
                     clusterSize = clusterSize,
                     clusterCorstr = responseCorstr,
                     clusterRho = responseCorRho,
                     beta = beta0,
                     family = response,
                     intercept = TRUE,
                     xVariance = xVariance,
                     xCorstr = xCorstr,
                     xCorRho = xCorRho)
</code></pre>


</div>