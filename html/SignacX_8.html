<div class="container">

<table style="width: 100%;"><tr>
<td>CID.smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smoothing function</h2>

<h3>Description</h3>

<p><code>CID.smooth</code> uses k-nearest neighbors to identify cells which
correspond to a different label than the majority of their first-degree neighbors. If so,
those annotations are "smoothed."
</p>


<h3>Usage</h3>

<pre><code class="language-R">CID.smooth(ac, dM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ac</code></td>
<td>
<p>list containing a character vector where each element is a cell type or cell state assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dM</code></td>
<td>
<p>distance matrix (see ?CID.GetDistMat).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A character vector with smoothed labels
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load data classified previously (see SignacFast)
P &lt;- readRDS("celltypes.rds")
S &lt;- readRDS("pbmcs.rds")

# get edges from default assay from Seurat object
default.assay &lt;- Seurat::DefaultAssay(S)
edges = S@graphs[[which(grepl(paste0(default.assay, "_nn"), names(S@graphs)))]]

# get distance matrix
D = CID.GetDistMat(edges)

# smooth labels
smoothed = CID.smooth(ac = P$CellTypes, dM = D[[1]])

## End(Not run)
</code></pre>


</div>