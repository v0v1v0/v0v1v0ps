<div class="container">

<table style="width: 100%;"><tr>
<td>SVCMvData.dat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Synthetic data from a space-varying coefficients model</h2>

<h3>Description</h3>

<p>Data simulated from a space-varying coefficients model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(SVCMvData.dat)
</code></pre>


<h3>Format</h3>

<p>The data frame generated from the code in the example section below.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
##The dataset was generated with the code below.

library(Matrix)

rmvn &lt;- function(n, mu=0, V = matrix(1)){
  p &lt;- length(mu)
  if(any(is.na(match(dim(V),p))))
    stop("Dimension problem!")
  D &lt;- chol(V)
  t(matrix(rnorm(n*p), ncol=p)%*%D + rep(mu,rep(n,p)))
}

set.seed(1)
n &lt;- 200

coords &lt;- cbind(runif(n,0,1), runif(n,0,1))
colnames(coords) &lt;- c("x.coords","y.coords")

X &lt;- as.matrix(cbind(1, rnorm(n), rnorm(n)))
colnames(X) &lt;- c("intercept","a","b")

Z &lt;- t(bdiag(as.list(as.data.frame(t(X)))))

beta &lt;- c(1, 10, -10)
p &lt;- length(beta)

q &lt;- 3
A &lt;- matrix(0, q, q)
A[lower.tri(A, T)] &lt;- c(1, -1, 0, 1, 1, 0.1)
K &lt;- A
K
cov2cor(K)

phi &lt;- c(3/0.75, 3/0.5, 3/0.5)

Psi &lt;- diag(0,q)
C &lt;- mkSpCov(coords, K, Psi, phi, cov.model="exponential")

tau.sq &lt;- 0.1

w &lt;- rmvn(1, rep(0,q*n), C)

y &lt;- rnorm(n, as.vector(X%*%beta + Z%*%w), sqrt(tau.sq))

w.0 &lt;- w[seq(1, length(w), by=q)]
w.a &lt;- w[seq(2, length(w), by=q)]
w.b &lt;- w[seq(3, length(w), by=q)]

SVCMvData &lt;- data.frame(cbind(coords, y, X[,2:3], w.0, w.a, w.b))


## End(Not run)
</code></pre>


</div>