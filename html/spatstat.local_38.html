<div class="container">

<table style="width: 100%;"><tr>
<td>loccit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Locally Fitted Cluster or Cox Point Process Model
</h2>

<h3>Description</h3>

<p>Fits a Neyman-Scott cluster process or Cox point process model
using a locally-weighted composite likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loccit(X, trend = ~1,
       clusters = c("Thomas", "MatClust", "Cauchy", "VarGamma", "LGCP"),
       covariates = NULL,
       ...,
       diagnostics = FALSE,
       taylor = FALSE,
       sigma = NULL, f = 1/4,
       clustargs = list(), control = list(), 
       rmax,
       covfunargs=NULL, use.gam=FALSE, nd=NULL, eps=NULL,
       niter=3,
       fftopt = list(),
       verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Point pattern.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>

<p>Formula (without a left hand side) specifying the form of the
logarithm of the intensity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>

<p>Character string determining the cluster model.
Partially matched.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>The values of any spatial covariates (other than the Cartesian
coordinates) required by the model.
A named list of pixel images, functions, windows or numeric constants.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostics</code></td>
<td>

<p>Whether to perform auxiliary calculations
in addition to the local estimates of the model parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to
<code>as.mask</code> to control the spatial resolution
in the Fast Fourier Transform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taylor</code></td>
<td>

<p>Logical value indicating whether to fit the model
exactly at each spatial location (<code>taylor=FALSE</code>, the default)
or to compute a first-order Taylor approximation to the
fitted parameters (<code>taylor=TRUE</code>). The Taylor approximation
is much faster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Standard deviation of Gaussian kernel for local likelihood.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>Argument passed to <code>bw.frac</code> to
compute a value for <code>sigma</code> if it is missing or <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustargs</code></td>
<td>

<p>List of additional parameters for the cluster model,
passed to the function <code>RFcov</code> in the
<code>RandomFields</code> package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>List of control arguments passed to the generic optimisation
function <code>optim</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmax</code></td>
<td>

<p>Maximum distance between pairs of points that will contribute
to the composite likelihood.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covfunargs,use.gam,nd,eps</code></td>
<td>

<p>Arguments passed to <code>ppm</code>
to control the intensity model and intensity fitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>

<p>Number of iterations in algorithm if <code>taylor=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftopt</code></td>
<td>
<p>Developer use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical. If <code>TRUE</code>, print progress reports. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a Cox or cluster process model to point pattern
data locally, using the local Palm likelihood technique
(Baddeley, 2016, section 8).
</p>
<p>It can be used in the same way as <code>kppm</code>
and effectively performs local fitting of the same model.
</p>


<h3>Value</h3>

<p>An object of class <code>"loccit"</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>References</h3>

<p>Baddeley, A. (2017) Local composite likelihood
  for spatial point patterns. <em>Spatial Statistics</em> <b>22</b>, 261â€“295. DOI: 10.1016/j.spasta.2017.03.001
</p>
<p>Baddeley, A., Rubak, E. and Turner, R. (2015) <em>Spatial Point Patterns: Methodology and Applications with R</em>. Chapman and Hall/CRC Press. 
</p>


<h3>See Also</h3>

<p><code>locppm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   X &lt;- redwood[owin(c(0,1), c(-1,-1/2))]
   fit &lt;- loccit(X, ~1, "Thomas", nd=5, control=list(maxit=20))
   fit
</code></pre>


</div>