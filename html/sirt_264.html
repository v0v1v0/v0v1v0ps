<div class="container">

<table style="width: 100%;"><tr>
<td>btm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Extended Bradley-Terry Model
</h2>

<h3>Description</h3>

<p>The function <code>btm</code> estimates an extended Bradley-Terry model (Hunter, 2004; see Details).
Parameter estimation uses a bias corrected joint maximum likelihood
estimation method based on <code class="reqn">\varepsilon</code>-adjustment (see Bertoli-Barsotti, Lando &amp; Punzo, 2014).
See Details for the algorithm.
</p>
<p>The function <code>btm_sim</code> simulated data from the extended Bradley-Terry model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">btm(data, judge=NULL, ignore.ties=FALSE, fix.eta=NULL, fix.delta=NULL, fix.theta=NULL,
       maxiter=100, conv=1e-04, eps=0.3, wgt.ties=.5)

## S3 method for class 'btm'
summary(object, file=NULL, digits=4,...)

## S3 method for class 'btm'
predict(object, data=NULL, ...)

btm_sim(theta, eta=0, delta=-99, repeated=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame with three columns. The first two columns contain labels
from the units in the pair comparison. The third column contains the
result of the comparison. "1" means that the first units wins, "0" means
that the second unit wins and "0.5" means a draw (a tie).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>judge</code></td>
<td>
<p>Optional vector of judge identifiers (if multiple
judges are available)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.ties</code></td>
<td>

<p>Logical indicating whether ties should be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.eta</code></td>
<td>

<p>Numeric value for a fixed <code class="reqn">\eta</code> value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.delta</code></td>
<td>

<p>Numeric value for a fixed <code class="reqn">\delta</code> value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.theta</code></td>
<td>

<p>A vector with entries for fixed theta values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>The <code class="reqn">\varepsilon</code> parameter for the <code class="reqn">\varepsilon</code>-adjustment
method (see Bertoli-Barsotti, Lando &amp; Punzo, 2014) which reduces bias
in ability estimates. In case of <code class="reqn">\varepsilon=0</code>, persons with
extreme scores are removed from the pairwise comparison.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgt.ties</code></td>
<td>
<p>Weighting parameter for ties, see formula in Details.
The default is .5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>btm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name for sinking the summary into</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimal to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Vector of abilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Value of <code class="reqn">\eta</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Value of <code class="reqn">\delta</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeated</code></td>
<td>
<p>Logical indicating whether repeated ratings of dyads (for home advantage
effect) should be simulated</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The extended Bradley-Terry model for the comparison of individuals
<code class="reqn">i</code> and <code class="reqn">j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P(X_{ij}=1 ) \propto \exp( \eta + \theta_i ) </code>
</p>

<p style="text-align: center;"><code class="reqn">P(X_{ij}=0 ) \propto \exp(  \theta_j ) </code>
</p>

<p style="text-align: center;"><code class="reqn">P(X_{ij}=0.5) \propto \exp( \delta + w_T ( \eta  + \theta_i +\theta_j ) ) </code>
</p>

<p>The parameters <code class="reqn">\theta_i</code> denote the abilities, <code class="reqn">\delta</code> is the
tendency of the occurrence of ties and <code class="reqn">\eta</code> is the home-advantage
effect. The weighting parameter <code class="reqn">w_T</code> governs the importance of ties and can be
chosen in the argument <code>wgt.ties</code>.
</p>
<p>A joint maximum likelihood (JML) estimation is applied for simulataneous
estimation of <code class="reqn">\eta</code>, <code class="reqn">\delta</code> and all <code class="reqn">\theta_i</code> parameters.
In the Rasch model, it was shown that JML can result in biased parameter
estimates. The <code class="reqn">\varepsilon</code>-adjustment approach has been proposed
to reduce the bias in parameter estimates (Bertoli-Bersotti, Lando &amp; Punzo, 2014).
This estimation approach is adapted to the Bradley-Terry model in
the <code>btm</code> function. To this end, the likelihood function is
modified for the purpose of bias reduction. It can be easily shown that there
exist sufficient statistics for <code class="reqn">\eta</code>, <code class="reqn">\delta</code> and all <code class="reqn">\theta_i</code>
parameters. In the <code class="reqn">\varepsilon</code>-adjustment approach, the sufficient
statistic for the <code class="reqn">\theta_i</code> parameter is modified. In JML estimation
of the Bradley-Terry model, <code class="reqn">S_i=\sum_{j \ne i} ( x_{ij} + x_{ji} )</code> is
a sufficient statistic for <code class="reqn">\theta_i</code>. Let <code class="reqn">M_i</code> the maximum score
for person <code class="reqn">i</code> which is the number of <code class="reqn">x_{ij}</code> terms appearing in
<code class="reqn">S_i</code>. In the <code class="reqn">\varepsilon</code>-adjustment approach, the sufficient statistic
<code class="reqn">S_i</code> is modified to
</p>
<p style="text-align: center;"><code class="reqn">S_{i, \varepsilon}=\varepsilon +
\frac{M_i - 2 \varepsilon}{M_i} S_i </code>
</p>
<p> and <code class="reqn">S_{i, \varepsilon}</code> instead of
<code class="reqn">S_{i}</code> is used in JML estimation. Hence, original scores <code class="reqn">S_i</code> are
linearly transformed for all persons <code class="reqn">i</code>.
</p>


<h3>Value</h3>

<p>List with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>Parameter summary for <code class="reqn">\eta</code> and <code class="reqn">\delta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>Parameter estimates for <code class="reqn">\theta</code> and
outfit and infit statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.effects</code></td>
<td>
<p>Summary of <code class="reqn">\theta</code> parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle.rel</code></td>
<td>
<p>MLE reliability, also known as separation reliability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepG</code></td>
<td>
<p>Separation index <code class="reqn">G</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Estimated probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Used dataset with integer identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_judges</code></td>
<td>
<p>Fit statistics (outfit and infit) for judges if <code>judge</code>
is provided. In addition, average agreement of the rating with the mode of
the ratings is calculated for each judge (at least three ratings per dyad has
to be available for computing the agreement).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Unstandardized and standardized residuals for each observation</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bertoli-Barsotti, L., Lando, T., &amp; Punzo, A. (2014). Estimating a Rasch Model
via fuzzy empirical probability functions. In D. Vicari, A. Okada, G. Ragozini
&amp; C. Weihs (Eds.). <em>Analysis and Modeling of Complex Data in Behavioral
and Social Sciences</em>. Springer.
<a href="https://doi.org/10.1007/978-3-319-06692-9_4">doi:10.1007/978-3-319-06692-9_4</a>
</p>
<p>Hunter, D. R. (2004). MM algorithms for generalized Bradley-Terry models.
<em>Annals of Statistics, 32</em>, 384-406. doi: 10.1214/aos/1079120141
</p>


<h3>See Also</h3>

<p>See also the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> packages <span class="pkg">BradleyTerry2</span>, <span class="pkg">psychotools</span>,
<span class="pkg">psychomix</span> and <span class="pkg">prefmod</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Bradley-Terry model | data.pw01
#############################################################################

data(data.pw01)

dat &lt;- data.pw01
dat &lt;- dat[, c("home_team", "away_team", "result") ]

# recode results according to needed input
dat$result[ dat$result==0 ] &lt;- 1/2   # code for ties
dat$result[ dat$result==2 ] &lt;- 0     # code for victory of away team

#********************
# Model 1: Estimation with ties and home advantage
mod1 &lt;- sirt::btm( dat)
summary(mod1)

## Not run: 
#*** Model 2: Estimation with ties, no epsilon adjustment
mod2 &lt;- sirt::btm( dat, eps=0)
summary(mod2)

#*** Model 3: Estimation with ties, no epsilon adjustment, weight for ties of .333 which
#    corresponds to the rule of 3 points for a victory and 1 point of a draw in football
mod3 &lt;- sirt::btm( dat, eps=0, wgt.ties=1/3)
summary(mod3)

#*** Model 4: Some fixed abilities
fix.theta &lt;- c("Anhalt Dessau"=-1 )
mod4 &lt;- sirt::btm( dat, eps=0, fix.theta=fix.theta)
summary(mod4)

#*** Model 5: Ignoring ties, no home advantage effect
mod5 &lt;- sirt::btm( dat, ignore.ties=TRUE, fix.eta=0)
summary(mod5)

#*** Model 6: Ignoring ties, no home advantage effect (JML approach and eps=0)
mod6 &lt;- sirt::btm( dat, ignore.ties=TRUE, fix.eta=0, eps=0)
summary(mod5)

#############################################################################
# EXAMPLE 2: Venice chess data
#############################################################################

# See http://www.rasch.org/rmt/rmt113o.htm
# Linacre, J. M. (1997). Paired Comparisons with Standard Rasch Software.
# Rasch Measurement Transactions, 11:3, 584-585.

# dataset with chess games -&gt; "D" denotes a draw (tie)
chessdata &lt;- scan( what="character")
    1D.0..1...1....1.....1......D.......D........1.........1.......... Browne
    0.1.D..0...1....1.....1......D.......1........D.........1......... Mariotti
    .D0..0..1...D....D.....1......1.......1........1.........D........ Tatai
    ...1D1...D...D....1.....D......D.......D........1.........0....... Hort
    ......010D....D....D.....1......D.......1........1.........D...... Kavalek
    ..........00DDD.....D.....D......D.......1........D.........1..... Damjanovic
    ...............00D0DD......D......1.......1........1.........0.... Gligoric
    .....................000D0DD.......D.......1........D.........1... Radulov
    ............................DD0DDD0D........0........0.........1.. Bobotsov
    ....................................D00D00001.........1.........1. Cosulich
    .............................................0D000D0D10..........1 Westerinen
    .......................................................00D1D010000 Zichichi

L &lt;- length(chessdata) / 2
games &lt;- matrix( chessdata, nrow=L, ncol=2, byrow=TRUE )
G &lt;- nchar(games[1,1])
# create matrix with results
results &lt;- matrix( NA, nrow=G, ncol=3 )
for (gg in 1:G){
    games.gg &lt;- substring( games[,1], gg, gg )
    ind.gg &lt;- which( games.gg !="." )
    results[gg, 1:2 ] &lt;- games[ ind.gg, 2]
    results[gg, 3 ] &lt;- games.gg[ ind.gg[1] ]
}
results &lt;- as.data.frame(results)
results[,3] &lt;- paste(results[,3] )
results[ results[,3]=="D", 3] &lt;- 1/2
results[,3] &lt;- as.numeric( results[,3] )

# fit model ignoring draws
mod1 &lt;- sirt::btm( results, ignore.ties=TRUE, fix.eta=0, eps=0 )
summary(mod1)

# fit model with draws
mod2 &lt;- sirt::btm( results, fix.eta=0, eps=0 )
summary(mod2)

#############################################################################
# EXAMPLE 3: Simulated data from the Bradley-Terry model
#############################################################################

set.seed(9098)
N &lt;- 22
theta &lt;- seq(2,-2, len=N)

#** simulate and estimate data without repeated dyads
dat1 &lt;- sirt::btm_sim(theta=theta)
mod1 &lt;- sirt::btm( dat1, ignore.ties=TRUE, fix.delta=-99, fix.eta=0)
summary(mod1)

#*** simulate data with home advantage effect and ties
dat2 &lt;- sirt::btm_sim(theta=theta, eta=.8, delta=-.6, repeated=TRUE)
mod2 &lt;- sirt::btm(dat2)
summary(mod2)

#############################################################################
# EXAMPLE 4: Estimating the Bradley-Terry model with multiple judges
#############################################################################

#*** simulating data with multiple judges
set.seed(987)
N &lt;- 26  # number of objects to be rated
theta &lt;- seq(2,-2, len=N)
s1 &lt;- stats::sd(theta)
dat &lt;- NULL
# judge discriminations which define tendency to provide reliable ratings
discrim &lt;- c( rep(.9,10), rep(.5,2), rep(0,2) )
#=&gt; last four raters provide less reliable ratings

RR &lt;- length(discrim)
for (rr in 1:RR){
    theta1 &lt;- discrim[rr]*theta + stats::rnorm(N, mean=0, sd=s1*sqrt(1-discrim[rr]))
    dat1 &lt;- sirt::btm_sim(theta1)
    dat1$judge &lt;- rr
    dat &lt;- rbind(dat, dat1)
}

#** estimate the Bradley-Terry model and compute judge-specific fit statistics
mod &lt;- sirt::btm( dat[,1:3], judge=paste0("J",100+dat[,4]), fix.eta=0, ignore.ties=TRUE)
summary(mod)

## End(Not run)
</code></pre>


</div>