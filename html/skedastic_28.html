<div class="container">

<table style="width: 100%;"><tr>
<td>hetplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical Methods for Detecting Heteroskedasticity in a Linear Regression Model</h2>

<h3>Description</h3>

<p>This function creates various two-dimensional scatter plots that can aid in
detecting heteroskedasticity in a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hetplot(
  mainlm,
  horzvar = "index",
  vertvar = "res",
  vertfun = "identity",
  filetype = NA,
  values = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mainlm</code></td>
<td>
<p>Either an object of <code>class</code> <code>"lm"</code>
(e.g., generated by <code>lm</code>), or
a list of two objects: a response vector and a design matrix. The objects
are assumed to be in that order, unless they are given the names
<code>"X"</code>  and <code>"y"</code> to distinguish them. The design matrix passed
in a list must begin with a column of ones if an intercept is to be
included in the linear model. The design matrix passed in a list should
not contain factors, as all columns are treated 'as is'. For tests that
use ordinary least squares residuals, one can also pass a vector of
residuals in the list, which should either be the third object or be
named <code>"e"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horzvar</code></td>
<td>
<p>A character vector describing the variable(s) to plot on
horizontal axes (<code>"index"</code> for the data index <code class="reqn">i</code>,
<code>"fitted.values"</code> for the OLS predicted values <code class="reqn">\hat{y}_i</code>,
<code>"fitted.values2"</code> for transformed OLS predicted values
<code class="reqn">m_{ii}\hat{y}_i</code>, and/or <code>names</code> of explanatory variable columns).
<code>"explanatory"</code> passes all explanatory variable columns. <code>"log_"</code>
concatenated with <code>names</code> of explanatory variable columns passes logs
of those explanatory variables. <code>"log_explanatory"</code> passes logs of
all explanatory variables. If more than one variable is specified,
a separate plot is created for each.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertvar</code></td>
<td>
<p>A character vector describing the variable to plot on the
vertical axis (<code>"res"</code> for OLS residuals [the default],
<code>"res_blus"</code> for <code>BLUS</code> residuals,
<code>"res_stand"</code> for standardised OLS residuals:
<code class="reqn">e_i/\sqrt{\hat{\omega}}</code>, <code>"res_constvar"</code> for OLS residuals
transformed to have constant variance: <code class="reqn">e_i/\sqrt{m_{ii}}</code>,
<code>"res_stud"</code> for studentised OLS residuals:
<code class="reqn">e_i/(s\sqrt{m_{ii}})</code>. If more than one value is specified,
a separate plot is created for each.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertfun</code></td>
<td>
<p>A character vector giving the name of a function to apply to
the <code>vertvar</code> variable. Values that can be coerced to numeric such
as <code>"2"</code> are taken to be powers to which <code>vertvar</code> should be
set. If multiple values are specified, they are all applied to each
element of <code>vertvar</code>. Common choices might be <code>"identity"</code> (the
default), <code>"abs"</code> (absolute value), and <code>"2"</code> (squaring).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filetype</code></td>
<td>
<p>A character giving the type of image file to which the
plot(s) should be written. Values can be <code>"png"</code>,
<code>"bmp"</code>, <code>"jpeg"</code>, or <code>"tiff"</code>. Image files are written
to a subdirectory called "hetplot" within the R session's temporary
directory, which can be located using <code>tempdir()</code>. The files should
be moved or copied to another location if they are needed after the R
session is ended. Default filenames contain timestamps for uniqueness.
If <code>NA</code> (the default), no image files are written, and in this
case, if there are multiple plots, they are plotted on a single device
using the <code>"mfrow"</code> graphical parameter. If many plots are requested
at once, it is advisable to write them to image files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>A logical. Should the sequences corresponding to the
horizontal and vertical variable(s) be returned in a <code>list</code> object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters
(see <code>par</code>), parameters for <code>plot</code>,
for <code>graphics devices</code>,
and/or the <code>omit</code> argument for function <code>blus</code>,
if BLUS residuals are being plotted. If it is desired to pass the
<code>type</code> argument to a graphics device, use <code>gtype = </code>, since
a <code>type</code> argument will be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variable plotted on the horizontal axis could be the original
data indices, one of the explanatory variables, the OLS predicted
(fitted) values, or any other numeric vector specified by the user. The
variable plotted on the vertical axis is some function of the OLS
residuals or transformed version thereof such as the BLUS residuals
Theil (1968) or standardised or studentised
residuals as discussed in Cook and Weisberg (1983). A
separate plot is created for each (<code>horzvar</code>, <code>vertvar</code>,
<code>vertfun</code>) combination.
</p>


<h3>Value</h3>

<p>A list containing two <code>data frames</code>, one
for vectors plotted on horizontal axes and one for vectors plotted
on vertical axes.
</p>


<h3>References</h3>

<p>Cook RD, Weisberg S (1983).
“Diagnostics for Heteroscedasticity in Regression.”
<em>Biometrika</em>, <b>70</b>(1), 1–10.<br><br> Theil H (1968).
“A Simplification of the BLUS Procedure for Analyzing Regression Disturbances.”
<em>Journal of the American Statistical Association</em>, <b>63</b>(321), 242–251.
</p>


<h3>See Also</h3>

<p><code>plot.lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mtcars_lm &lt;- lm(mpg ~ wt + qsec + am, data = mtcars)
# Generates 2 x 2 matrix of plots in console
hetplot(mtcars_lm, horzvar = c("index", "fitted.values"),
vertvar = c("res_blus"), vertfun = c("2", "abs"), filetype = NA)

# Generates 84 png files in tempdir() folder
## Not run: hetplot(mainlm = mtcars_lm, horzvar = c("explanatory", "log_explanatory",
"fitted.values2"), vertvar = c("res", "res_stand", "res_stud",
"res_constvar"), vertfun = c("identity", "abs", "2"), filetype = "png")
## End(Not run)

</code></pre>


</div>