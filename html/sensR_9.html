<div class="container">

<table style="width: 100%;"><tr>
<td>AnotA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analysis of A-not-A tests</h2>

<h3>Description</h3>

<p>Computation of dprime and it's uncertainty for the monadic A-not-A test
together with the one-tailed P-value of the difference test
(Fisher's Exact test).
</p>


<h3>Usage</h3>

<pre><code class="language-R">AnotA(x1, n1, x2, n2, ...)

## S3 method for class 'anota'
confint(object, parm, level = 0.95, ...)

## S3 method for class 'anota'
plot(x, main = TRUE, length = 1000, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>the number of (correct) A-answers on A-samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>the total number of A-samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>the number of A-answers on not-A-samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>the number of not-A-samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>anota</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>currently not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the desired confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>anota</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>should the plot have a main title?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>the discretization of the curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>glm</code> for <code>AnotA</code>;
not used for <code>confint</code> and <code>plot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>AnotA</code> function uses the <code>glm</code> and <code>fisher.test</code>
functions of the <code>stats</code> package. Note that all arguments have
to be positive integers.
</p>


<h3>Value</h3>

<p>For <code>AnotA</code> an object of class <code>anota</code> (which has a print
method). This is a list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> named vector of coefficients (d-prime)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.glm</code></td>
<td>
<p>the glm-object from the fitting process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance-covariance matrix of the coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>named vector with standard error of the coefficients
(standard error of d-prime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a named vector with the data supplied to the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>one-sided p-value from Fisher's exact test
(<code>fisher.test</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a string with the name of the test (<code>A-Not A</code>) for
the print method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
</table>
<p>For <code>plot</code> a figure of the distributions of sensory intensity is
produced, and for <code>confint</code> a 2-by-2 matrix of confidence
intervals is returned.
</p>


<h3>Author(s)</h3>

<p>Rune Haubo B Christensen and Per Bruun Brockhoff</p>


<h3>References</h3>

<p>Brockhoff, P.B. and Christensen, R.H.B. (2010). Thurstonian
models for sensory discrimination tests as generalized linear models.
Food Quality and Preference, 21, pp. 330-338.</p>


<h3>See Also</h3>

<p><code>print.discrim</code>, <code>discrim</code>,
<code>discrimPwr</code>, <code>discrimSim</code>,
<code>discrimSS</code>, <code>findcr</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># data: 10 of the A-samples were judged to be A
#       20 A-samples in total
#       3 of the not-A samples were judged to be A
#       20 not-A-samples in total

AnotA(10, 20, 3, 20)
(m1 &lt;- AnotA(10, 20, 3, 20))

## plot distributions of sensory intensity:
plot(m1)

## likelihood based confidence intervals:
confint(m1)


## Extended example plotting the profile likelihood
xt &lt;- cbind(c(3, 10), c(20 - 3, 20 - 10))
lev &lt;- gl(2, 1)
summary(res &lt;- glm(xt ~ lev,
                   family = binomial(link = probit)))
N &lt;- 100
dev &lt;- double(N)
level &lt;- c(0.95, 0.99)
delta &lt;- seq(1e-4, 5, length = N)
for(i in 1:N)
  dev[i] &lt;- glm(xt ~ 1 + offset(c(0, delta[i])),
                family = binomial(probit))$deviance
plot(delta, exp(-dev/2), type = "l",
     xlab = expression(delta),
     ylab = "Normalized Profile Likelihood")
## Add Normal approximation:
lines(delta, exp(-(delta - coef(res)[2])^2 /
                 (2 * vcov(res)[2,2])), lty = 2)
## Add confidence limits:
lim &lt;- sapply(level, function(x)
              exp(-qchisq(x, df=1)/2) )
abline(h = lim, col = "grey")

</code></pre>


</div>