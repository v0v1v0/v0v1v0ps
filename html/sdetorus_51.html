<div class="container">

<table style="width: 100%;"><tr>
<td>logBesselI0Scaled</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Efficient computation of Bessel related functions</h2>

<h3>Description</h3>

<p>Computation of <code class="reqn">\log(I_0(x))-x</code> and the
inverse of <code class="reqn">A_1(k)=\frac{I_0(k)}{I_1(k)}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logBesselI0Scaled(x, splineApprox = TRUE)

a1Inv(x, splineApprox = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>evaluation vector. For <code>logBesselI0Scaled</code>, <code>x</code> must
contain non-negative values. For <code>a1Inv</code>, <code>x</code> must be in
<code class="reqn">[0, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splineApprox</code></td>
<td>
<p>whether to use a pre-computed spline approximation
(faster) or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both functions may rely on pre-computed spline interpolations
(<code>logBesselI0ScaledSpline</code> and <code>a1InvSpline</code>). Otherwise, a call
to <code>besselI</code> is done for <code class="reqn">\log(I_0(x))-x</code> and
<code class="reqn">A_1(k)=x</code> is solved numerically. The data in which the
interpolation is based is given in the examples.
</p>
<p>For <code>x</code> larger than <code>5e4</code>, the asymptotic expansion of
<code>besselIasym</code> is employed.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Data employed for log besselI0 scaled
x1 &lt;- c(seq(0, 1, by = 1e-4), seq(1 + 1e-2, 10, by = 1e-3),
        seq(10 + 1e-1, 100, by = 1e-2), seq(100 + 1e0, 1e3, by = 1e0),
        seq(1000 + 1e1, 5e4, by = 2e1))
logBesselI0ScaledEvalGrid &lt;- log(besselI(x = x1, nu = 0,
                                         expon.scaled = TRUE))
# save(list = "logBesselI0ScaledEvalGrid",
#      file = "logBesselI0ScaledEvalGrid.rda", compress = TRUE)

# Data employed for A1 inverse
x2 &lt;- rev(c(seq(1e-04, 0.9 - 1e-4, by = 1e-4),
            seq(0.9, 1 - 1e-05, by = 1e-5)))
a1InvEvalGrid &lt;- sapply(x2, function(k) {
  uniroot(f = function(x) k - besselI(x, nu = 1, expon.scaled = TRUE) /
          besselI(x, nu = 0, expon.scaled = TRUE),
          lower = 1e-06, upper = 1e+05, tol = 1e-15)$root
})
# save(list = "a1InvEvalGrid", file = "a1InvEvalGrid.rda", compress = TRUE)

# Accuracy logBesselI0Scaled
x &lt;- seq(0, 1e3, l = 1e3)
summary(logBesselI0Scaled(x = x, splineApprox = TRUE) -
        logBesselI0Scaled(x = x, splineApprox = FALSE))

# Accuracy a1Inv
y &lt;- seq(0, 1 - 1e-4, l = 1e3)
summary(a1Inv(x = y, splineApprox = TRUE) -
        a1Inv(x = y, splineApprox = FALSE))
</code></pre>


</div>