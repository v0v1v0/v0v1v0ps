<div class="container">

<table style="width: 100%;"><tr>
<td>plot_pdf_ext</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Theoretical Power Method Probability Density Function and Target PDF of External Data for Continuous Variables</h2>

<h3>Description</h3>

<p>This plots the theoretical power method probability density function: </p>
<p style="text-align: center;"><code class="reqn">f_p(Z)(p(z)) = f_p(Z)(p(z), f_Z(z)/p'(z)),</code>
</p>
<p> as given in
Headrick &amp; Kowalchuk (2007, doi: <a href="http://doi.org/10.1080/10629360600605065">10.1080/10629360600605065</a>), and target
pdf.  It is a parametric plot with <code class="reqn">sigma * y + mu</code>, where <code class="reqn">y = p(z)</code>, on the x-axis and
<code class="reqn">f_Z(z)/p'(z)</code> on the y-axis, where <code class="reqn">z</code> is vector of <code class="reqn">n</code> random standard normal numbers (generated with a seed set
by user; length equal to length of external data vector).  <code>sigma</code> is the standard deviation and <code>mu</code> is the mean of the external data set.
Given a vector of polynomial transformation constants, the function generates <code class="reqn">sigma * y + mu</code> and calculates the theoretical
probabilities using <code class="reqn">f_p(Z)(p(z), f_Z(z)/p'(z))</code>.  The target distribution is also plotted given a vector
of external data.  This external data is required.  The <code class="reqn">y</code> values are centered and scaled to have the same mean and standard
deviation as the external data.  If the user wants to only plot the power method pdf,
<code>plot_pdf_theory</code> should be used instead with <code>overlay = FALSE</code>.  It returns a <code>ggplot2-package</code> object so the user can modify as necessary.  The graph parameters (i.e. <code>title</code>,
<code>power_color</code>, <code>target_color</code>, <code>nbins</code>) are <code>ggplot2-package</code> parameters.  It works for valid or invalid power method pdfs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_pdf_ext(c = NULL, method = c("Fleishman", "Polynomial"),
  title = "Probability Density Function", ylower = NULL, yupper = NULL,
  power_color = "dark blue", ext_y = NULL, target_color = "dark green",
  target_lty = 2, seed = 1234, legend.position = c(0.975, 0.9),
  legend.justification = c(1, 1), legend.text.size = 10,
  title.text.size = 15, axis.text.size = 10, axis.title.size = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>a vector of constants c0, c1, c2, c3 (if <code>method</code> = "Fleishman") or c0, c1, c2, c3, c4, c5 (if <code>method</code> =
"Polynomial"), like that returned by <code>find_constants</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to generate the continuous variable y = p(z).  "Fleishman" uses Fleishman's third-order polynomial
transformation and "Polynomial" uses Headrick's fifth-order transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title for the graph (default = "Probability Density Function")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylower</code></td>
<td>
<p>the lower y value to use in the plot (default = NULL, uses minimum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yupper</code></td>
<td>
<p>the upper y value (default = NULL, uses maximum simulated y value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_color</code></td>
<td>
<p>the line color for the power method pdf (default = "dark blue")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext_y</code></td>
<td>
<p>a vector of external data (required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_color</code></td>
<td>
<p>the histogram color for the target pdf (default = "dark green")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_lty</code></td>
<td>
<p>the line type for the target pdf (default = 2, dashed line)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed value for random number generation (default = 1234)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>the position of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.justification</code></td>
<td>
<p>the justification of the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text.size</code></td>
<td>
<p>the size of the legend labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.text.size</code></td>
<td>
<p>the size of the plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.text.size</code></td>
<td>
<p>the size of the axes text (tick labels)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.title.size</code></td>
<td>
<p>the size of the axes titles</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot2-package</code> object.
</p>


<h3>References</h3>

<p>Please see the references for <code>plot_cdf</code>.
</p>
<p>Wickham H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.
</p>


<h3>See Also</h3>

<p><code>find_constants</code>, <code>calc_theory</code>,
<code>ggplot2-package</code>, <code>geom_path</code>, <code>geom_density</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Logistic Distribution

seed = 1234

# Simulate "external" data set
set.seed(seed)
ext_y &lt;- rlogis(10000)

# Find standardized cumulants
stcum &lt;- calc_theory(Dist = "Logistic", params = c(0, 1))

# Find constants without the sixth cumulant correction
# (invalid power method pdf)
con1 &lt;- find_constants(method = "Polynomial", skews = stcum[3],
                      skurts = stcum[4], fifths = stcum[5],
                      sixths = stcum[6])

# Plot invalid power method pdf with external data
plot_pdf_ext(c = con1$constants, method = "Polynomial",
             title = "Invalid Logistic PDF", ext_y = ext_y,
             seed = seed)

# Find constants with the sixth cumulant correction
# (valid power method pdf)
con2 &lt;- find_constants(method = "Polynomial", skews = stcum[3],
                      skurts = stcum[4], fifths = stcum[5],
                      sixths = stcum[6], Six = seq(1.5, 2, 0.05))

# Plot invalid power method pdf with external data
plot_pdf_ext(c = con2$constants, method = "Polynomial",
             title = "Valid Logistic PDF", ext_y = ext_y,
             seed = seed)

## End(Not run)

</code></pre>


</div>