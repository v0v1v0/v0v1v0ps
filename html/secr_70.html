<div class="container">

<table style="width: 100%;"><tr>
<td>pdot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Net Detection Probability </h2>

<h3>Description</h3>

<p>Compute spatially explicit net probability of detection for individual(s) 
at given coordinates (pdot).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdot(X, traps, detectfn = 0, detectpar = list(g0 = 0.2,
    sigma = 25, z = 1), noccasions = NULL, binomN = NULL,
    userdist = NULL, ncores = NULL) 

CVpdot(..., conditional = FALSE)    

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> vector or 2-column matrix of coordinates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traps</code></td>
<td>
 <p><code>traps</code> object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectfn</code></td>
<td>
<p> integer code for detection function q.v. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectpar</code></td>
<td>
<p> a named list giving a value for each parameter of detection function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noccasions</code></td>
<td>
<p> number of sampling intervals (occasions) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binomN</code></td>
<td>
<p> integer code for discrete distribution (see
<code>secr.fit</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userdist</code></td>
<td>
<p>user-defined distance function or matrix (see userdist)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>integer number of threads</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>pdot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditional</code></td>
<td>
<p>logical; if TRUE then computed mean and CV are conditional on detection</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>traps</code> has a usage attribute then <code>noccasions</code> is
set accordingly; otherwise it must be provided.
</p>
<p>The probability computed is <code class="reqn">p.(\mathbf{X}) = 1 - \prod\limits _{k}
\{1 - p_s(\mathbf{X},k)\}^{S}</code> where
the product is over the detectors in <code>traps</code>, excluding any not
used on a particular occasion. The per-occasion detection function
<code class="reqn">p_s</code> is halfnormal (0) by default, and is assumed not to vary
over the <code class="reqn">S</code> occasions.
</p>
<p>From 4.6.11, the detection parameters g0, lambda0 and sigma for point detectors 
may be detector- and occasion-specific. This is achieved by providing a vector 
of values that is replicated internally to fill a matrix with dimensions 
ntraps x noccasions (i.e. in trap order for occasion 1, then occasion 2 etc.)
</p>
<p>For detection functions (10) and (11) the signal threshold ‘cutval’ should be
included in <code>detectpar</code>, e.g., <code>detectpar = list(beta0 = 103, beta1
= -0.11, sdS = 2, cutval = 52.5)</code>.
</p>
<p>The calculation is not valid for single-catch traps because
<code class="reqn">p.(\mathbf{X})</code> is reduced by competition between animals.
</p>
<p><code>userdist</code> cannot be set if ‘traps’ is any of polygon, polygonX,
transect or transectX. if <code>userdist</code> is a function requiring
covariates or values of parameters ‘D’ or ‘noneuc’ then <code>X</code> must
have a covariates attribute with the required columns.
</p>
<p>Setting <code>ncores = NULL</code> uses the existing value from the environment variable 
RCPP_PARALLEL_NUM_THREADS (see <code>setNumThreads</code>).
</p>
<p><code>CVpdot</code> returns the expected mean and CV of pdot across the points listed in <code>X</code>, assuming uniform population density. <code>X</code> is usually a habitat mask. See Notes for details.
</p>


<h3>Value</h3>

<p>For <code>pdot</code>, a vector of probabilities, one for each row in X.
</p>
<p>For <code>CVpdot</code>, a named vector with elements ‘meanpdot’ and ‘CVpdot’.
</p>


<h3>Note</h3>

<p><code>CVpdot</code> computes the mean <code class="reqn">\mu</code> and variance <code class="reqn">V</code> of the location-specific overall detection probability <code class="reqn">p.(\mathbf{X})</code> as follows.
</p>
<p style="text-align: center;"><code class="reqn">\mu = \int p.(\mathbf{X}) f(\mathbf{X}) d\mathbf{X},</code>
</p>

<p style="text-align: center;"><code class="reqn">V = \int p.(\mathbf{X})^2 f(\mathbf{X}) d\mathbf{X} - \mu^2.</code>
</p>

<p>For uniform density and <code>conditional = FALSE</code>, <code class="reqn">f(\mathbf{X})</code> is merely a scaling factor independent of <code class="reqn">\mathbf{X}</code>. 
</p>
<p>If <code>conditional = TRUE</code> then <code class="reqn">f(\mathbf{X}) = p.(\mathbf{X}) / \int p.(\mathbf{X}) d\mathbf{X}</code>. 
</p>
<p>The coefficient of variation is CV = <code class="reqn">\sqrt{V}/\mu</code>.
</p>


<h3>See Also</h3>

 
<p><code>secr</code>, 
<code>make.mask</code>,
<code>Detection functions</code>, 
<code>pdotContour</code>,
<code>CV</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

  temptrap &lt;- make.grid()
  ## per-session detection probability for an individual centred
  ## at a corner trap. By default, noccasions = 5.
  pdot (c(0,0), temptrap, detectpar = list(g0 = 0.2, sigma = 25),
    noccasions = 5)
    
  msk &lt;- make.mask(temptrap, buffer = 100)
  CVpdot(msk, temptrap, detectpar = list(g0 = 0.2, sigma = 25),
    noccasions = 5)

## End(Not run)

</code></pre>


</div>