<div class="container">

<table style="width: 100%;"><tr>
<td>Stream ciphers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stream Ciphers</h2>

<h3>Description</h3>

<p>Generate deterministic streams of random data based off a secret key and random nonce.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chacha20(size, key, nonce)

xchacha20(size, key, nonce)

salsa20(size, key, nonce)

xsalsa20(size, key, nonce)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>length of cipher stream in bytes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>secret key used by the cipher</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonce</code></td>
<td>
<p>non-secret unique data to randomize the cipher</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You usually don't need to call these methods directly. For local encryption
use data_encrypt. For secure communication use simple_encrypt or
auth_encrypt.
</p>
<p>Random streams form the basis for most cryptographic methods. Based a shared secret
(the key) we generate a predictable random data stream of equal length as the message
we need to encrypt. Then we xor the message data with this random stream,
which effectively inverts each byte in the message with probabiliy 0.5. The message
can be decrypted by re-generating exactly the same random data stream and xor'ing
it back. See the examples.
</p>
<p>Each stream generator requires a <code>key</code> and a <code>nonce</code>. Both are required to re-generate
the same stream for decryption. The key forms the shared secret and should only known to
the trusted parties. The <code>nonce</code> is not secret and should be stored or sent along
with the ciphertext. The purpose of the <code>nonce</code> is to make a random stream unique
to protect gainst re-use attacks. This way you can re-use a your key to encrypt multiple
messages, as long as you never re-use the same nonce.
</p>


<h3>References</h3>

<p><a href="https://libsodium.gitbook.io/doc/advanced/stream_ciphers/xsalsa20">https://libsodium.gitbook.io/doc/advanced/stream_ciphers/xsalsa20</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Very basic encryption
myfile &lt;- file.path(R.home(), "COPYING")
message &lt;- readBin(myfile, raw(), file.info(myfile)$size)
passwd &lt;- charToRaw("My secret passphrase")

# Encrypt:
key &lt;- hash(passwd)
nonce8 &lt;- random(8)
stream &lt;- chacha20(length(message), key, nonce8)
ciphertext &lt;- base::xor(stream, message)

# Decrypt:
stream &lt;- chacha20(length(ciphertext), key, nonce8)
out &lt;- base::xor(ciphertext, stream)
stopifnot(identical(out, message))

# Other stream ciphers
stream &lt;- salsa20(10000, key, nonce8)
stream &lt;- xsalsa20(10000, key, random(24))
stream &lt;- xchacha20(10000, key, random(24))

</code></pre>


</div>