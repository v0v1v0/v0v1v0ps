<div class="container">

<table style="width: 100%;"><tr>
<td>predict.sitar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict SITAR model</h2>

<h3>Description</h3>

<p>Predict method for <code>sitar</code> objects, based on <code>predict.lme</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sitar'
predict(
  object,
  newdata = getData(object),
  level = 1L,
  ...,
  deriv = 0L,
  abc = NULL,
  xfun = identity,
  yfun = identity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>sitar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame to be used for obtaining the
predictions, defaulting to the data used to fit <code>object</code>.
It requires named columns for <code>x</code>, and for <code>id</code> if
<code>level = 1</code>, matching the names in <code>object</code>. Variables with the
reserved names <code>x=.x</code> or <code>id=.id</code> take precedence over the model
<code>x</code> and <code>id</code> variables. Any covariates in
<code>a.formula</code>, <code>b.formula</code>, <code>c.formula</code> or <code>d.formula</code> can also be included.
By default their values are set to the mean, so when <code>level = 0</code> the
prediction represents the mean curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer vector giving the level(s) of grouping to be used
in obtaining the predictions, level 0 corresponding to the population
predictions. Defaults to level 1, and <code>level = 0:1</code> fits both levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional arguments: <code>asList</code>, <code>na.action</code> and
<code>naPattern</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>an optional integer specifying predictions corresponding to
either the fitted curve or its derivative. <code>deriv = 0</code> (default)
specifies the distance curve, <code>deriv = 1</code> the velocity curve and
<code>deriv = 2</code> the acceleration curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abc</code></td>
<td>
<p>an optional named vector containing values of a subset of
<code>a</code>, <code>b</code>, <code>c</code> and <code>d</code>, default <code>NULL</code>. Ignored if
<code>level = 0</code>. It gives predictions for a single subject with the
specified values of <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code>, where missing values
are set to 0. Alternatively <code>abc</code> can contain the value for a single id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xfun</code></td>
<td>
<p>an optional function to apply to <code>x</code> to convert it back to
the original scale, e.g. if x = log(age) then xfun = exp. Only relevant if
<code>deriv &gt; 0</code> - see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yfun</code></td>
<td>
<p>an optional function to apply to <code>y</code> to convert it back to
the original scale, e.g. if y = sqrt(height) then yfun = function(z) z^2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>deriv = 1</code> the returned velocity is in units of <code>yfun(y)</code>
per <code>xfun(x)</code>. So if <code>x</code> and/or <code>y</code> are transformed, velocity
in units of <code>y</code> per <code>x</code> can be obtained by specifying <code>xfun</code>
and/or <code>yfun</code> to back-transform them appropriately.
</p>


<h3>Value</h3>

<p>A vector of the predictions, or a list of vectors if <code>asList =
TRUE</code> and <code>level == 1</code>, or a data frame if <code>length(level) &gt; 1</code>.
</p>


<h3>Author(s)</h3>

<p>Tim Cole <a href="mailto:tim.cole@ucl.ac.uk">tim.cole@ucl.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>ifun</code> for a way to generate the functions <code>xfun</code>
and <code>yfun</code> automatically from the <code>sitar</code> model call.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(heights)
## fit model
m1 &lt;- sitar(x=age, y=height, id=id, data=heights, df=5)

## predictions at level 0
predict(m1, newdata=data.frame(age=9:16), level=0)

## predictions at level 1 for subject 5
predict(m1, newdata=data.frame(age=9:16, id=5), level=1)

## velocity predictions for subjects with early and late puberty
vel1 &lt;- predict(m1, deriv=1, abc=c(b=-1))
mplot(age, vel1, id, heights, col=id)
vel1 &lt;- predict(m1, deriv=1, abc=c(b=1))
mplot(age, vel1, id, heights, col=id, add=TRUE)

</code></pre>


</div>