<div class="container">

<table style="width: 100%;"><tr>
<td>kde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel Density Estimation</h2>

<h3>Description</h3>

<p>KDE for spatial data. The algorithm is heavily inspired by
<a href="https://github.com/qgis/QGIS/blob/b3d2619976a69d7fb67b884492da491dfaba287c/src/analysis/raster/qgskde.cpp">Heatmap tool</a>
in QGIS. The help for QGIS tools is provided <a href="https://docs.qgis.org/testing/en/docs/user_manual/processing_algs/qgis/interpolation.html#heatmap-kernel-density-estimation">at the QGIS website</a>.
The a tutorial is provided <a href="https://grindgis.com/software/heat-map-using-qgis">here</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kde(
  points,
  band_width,
  decay = 1,
  kernel = c("quartic", "uniform", "triweight", "epanechnikov", "triangular"),
  scaled = FALSE,
  weights = c(),
  grid,
  cell_size,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p><code>sf</code> <code>data.frame</code> containing only POINTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band_width</code></td>
<td>
<p><code>numeric</code> specifying the band width for KDE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decay</code></td>
<td>
<p><code>numeric</code> specifying the decay parameter for <code>"triangular"</code> kernel. For
other kernels besides <code>"triangular"</code> the parameter is not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p><code>character</code> specifying type of kernel to use. Available implemented kernels are
<code>"uniform", "quartic", "triweight", "epanechnikov", "triangular"</code>. Default is <code>"quartic"</code> and if
unknown kernel name is used it falls back to the default value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p><code>logical</code> specifying if the output values should be scaled. Default value is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p><code>numeric</code> vector of weights for individual <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>either <code>sf</code> <code>data.frame</code> (outcome of function
<code>create_grid_rectangular</code> or <code>create_grid_hexagonal</code>) or
<code>Raster-class</code> (outcome of function <code>create_raster</code>).
Does not have to be specified if <code>cell_size</code> is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_size</code></td>
<td>
<p><code>numeric</code> specifying the distance for equal spaced points. Must be
higher than 0. Can be left out if <code>grid</code> is provided as <code>grid</code> is used instead.
The code used to generate grid is <code>create_grid_rectangular(points, cell_size, band_width)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Should printing of progress bar be suppressed? Default 'FALSE'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>grid</code> parameter specifies output of the function. KDE is calculated on the specified <code>grid</code>.
If grid is <code>Raster-class</code> then outcome is also <code>Raster-class</code>.
If grid is <code>sf</code> <code>data.frame</code> then outcome is also <code>sf</code> <code>data.frame</code>.
</p>


<h3>Value</h3>

<p>either <code>sf</code> <code>data.frame</code> or <code>Raster-class</code>
depending on class of <code>grid</code> parameter.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sf)
nc &lt;- st_read(system.file("shape/nc.shp", package = "sf")) %&gt;% st_transform(32031)
grid &lt;- create_grid_hexagonal(nc, cell_size = 100000)
points &lt;- st_sample(nc, 500) %&gt;% st_as_sf()
kde_estimate_grid &lt;- kde(points, band_width = 150000, grid = grid)
raster &lt;- create_raster(nc, cell_size = 100000)
kde_estimate_raster &lt;- kde(points, band_width = 150000, grid = raster)

</code></pre>


</div>