<div class="container">

<table style="width: 100%;"><tr>
<td>trainSOM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the SOM algorithm</h2>

<h3>Description</h3>

<p>The <code>trainSOM</code> function returns a <code>somRes</code> class 
object which contains the outputs of the algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trainSOM(x.data, ...)

## S3 method for class 'somRes'
print(x, ...)

## S3 method for class 'somRes'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.data</code></td>
<td>
<p>a data frame or matrix containing the observations to be mapped
on the grid by the SOM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the function 
<code>initSOM</code> for specifying the parameters of the algorithm. The 
default values of the arguments <code>maxit</code> and <code>dimension</code> are 
calculated according to the SOM type if the user does not set them:
</p>

<ul>
<li> <p><code>maxit</code> is equal to (number of rows+number of columns)*5 if the 
SOM type is <code>korresp</code>. It is equal to number of rows*5 in all other 
SOM types
</p>
</li>
<li> <p><code>dimension</code>: for a <code>korresp</code> SOM, is approximately equal to
the square root of the number of observations to be classified divided by
10 but it is never smaller than 5 or larger than 10.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>somRes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>somRes</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The version of the SOM algorithm implemented in this package is the
stochastic version.
</p>
<p>Several variants able to handle non-vectorial data are also implemented in 
their stochastic versions: <code>type="korresp"</code> for contingency tables, as
described in Cottrell et al. (2004) (with weights as in Cottrell and Letrémy, 
2005a); <code>type = "relational"</code> for dissimilarity matrices, as described 
in Olteanu et al. (2015), with the fast implementation introduced in Mariette
<em>et al.</em> (2017).
</p>
<p>Missing values are handled as described in Cottrell et al. (2005b), not using
missing entries of the selected observation during winner computation or 
prototype updates. This allows to proceed with the imputation of missing
entries with the corresponding entries of the cluster prototype (with 
<code>impute</code>).
</p>
<p><code>summary</code> produces a complete summary of the results that 
displays the parameters of the SOM, quality criteria and ANOVA. For 
<code>type = "numeric"</code> the ANOVA is performed for each input variable and 
test the difference of this variable across the clusters of the map. For 
<code>type = "relational"</code> a dissimilarity ANOVA is performed (Anderson, 
2001), except that in the present version, a crude estimate of the p-value is
used which is based on the Fisher distribution and not on a permutation test.
</p>


<h3>Value</h3>

<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code>
which contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p> the final classification of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prototypes</code></td>
<td>
<p> the final coordinates of the prototypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>energy</code></td>
<td>
<p> the final energy of the map. For the numeric case, energy 
with data having missing entries is based on data imputation as described
in Cottrell and Letrémy (2005b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backup</code></td>
<td>
<p> a list containing some intermediate backups of the 
prototypes coordinates, clustering, energy and the indexes of the recorded 
backups, if <code>nb.save</code> is set to a value larger than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> the original dataset used to train the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p> a list of the map's parameters, which is an object of 
class <code>paramSOM</code> as produced by the function <code>initSOM</code>.</p>
</td>
</tr>
</table>
<p>The function <code>summary.somRes</code> also provides an ANOVA (ANalysis Of 
VAriance) of each input numeric variables in function of the map's clusters. 
This is helpful to see which variables participate to the clustering.
</p>


<h3>Note</h3>

<p>Warning! Recording intermediate backups with the argument 
<code>nb.save</code> can strongly increase the computational time since calculating
the entire clustering and the energy is time consuming. Use this option with
care and only when it is strictly necessary.
</p>


<h3>Author(s)</h3>

<p>Élise Maigné <a href="mailto:elise.maigne@inrae.fr">elise.maigne@inrae.fr</a><br>
Jérome Mariette <a href="mailto:jerome.mariette@inrae.fr">jerome.mariette@inrae.fr</a><br>
Madalina Olteanu <a href="mailto:olteanu@ceremade.dauphine.fr">olteanu@ceremade.dauphine.fr</a><br>
Fabrice Rossi <a href="mailto:fabrice.rossi@apiacoa.org">fabrice.rossi@apiacoa.org</a><br>
Nathalie Vialaneix <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Anderson M.J. (2001). A new method for non-parametric multivariate analysis 
of variance. <em>Austral Ecology</em>, <strong>26</strong>, 32-46. 
</p>
<p>Kohonen T. (2001) <em>Self-Organizing Maps</em>. Berlin/Heidelberg: 
Springer-Verlag, 3rd edition.
</p>
<p>Cottrell M., Ibbou S., Letrémy P. (2004) SOM-based algorithms for qualitative
variables. <em>Neural Networks</em>, <strong>17</strong>, 1149-1167.
</p>
<p>Cottrell M., Letrémy P. (2005a) How to use the Kohonen algorithm to 
simultaneously analyse individuals in a survey. <em>Neurocomputing</em>, 
<strong>21</strong>, 119-138.
</p>
<p>Cottrell M., Letrémy P. (2005b) Missing values: processing with the Kohonen 
algorithm. <em>Proceedings of Applied Stochastic Models and Data Analysis
(ASMDA 2005)</em>, 489-496.
</p>
<p>Olteanu M., Villa-Vialaneix N. (2015) On-line relational and multiple
relational SOM. <em>Neurocomputing</em>, <strong>147</strong>, 15-30. 
</p>
<p>Mariette J., Rossi F., Olteanu M., Mariette J. (2017) Accelerating stochastic 
kernel SOM. In: M. Verleysen, <em>XXVth European Symposium on Artificial 
Neural Networks, Computational Intelligence and Machine Learning (ESANN 
2017)</em>, i6doc, Bruges, Belgium, 269-274.
</p>


<h3>See Also</h3>

<p>See <code>initSOM</code> for a description of the parameters to 
pass to the trainSOM function to change its behavior and 
<code>plot.somRes</code> to plot the outputs of the algorithm.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Run trainSOM algorithm on the iris data with 500 iterations
iris.som &lt;- trainSOM(x.data=iris[,1:4])
iris.som
summary(iris.som)
</code></pre>


</div>