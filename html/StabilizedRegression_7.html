<div class="container">

<table style="width: 100%;"><tr>
<td>StabilizedRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>StabilizedRegression</h2>

<h3>Description</h3>

<p>StabilizedRegression based on linear OLS
</p>


<h3>Usage</h3>

<pre><code class="language-R">StabilizedRegression(
  X,
  Y,
  A,
  pars = list(m = ncol(X), B = 100, alpha_stab = 0.05, alpha_pred = 0.05, size_weight =
    "linear", compute_predictive_model = TRUE, use_resampling = FALSE, prescreen_size =
    NA, prescreen_type = "correlation", stab_test = "exact", pred_score = "mse", topk =
    1, variable_importance = "scaled_coefficient"),
  verbose = 0,
  seed = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix. Numeric matrix of size n times d, where
columns correspond to individual predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response variable. Numeric vector of length n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>stabilizing variable. Numeric vector of length n which
can be interpreted as a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>list of additional parameters. <code>m</code> (default
ncol(X)) integer specifying the largest possible subset
size. <code>B</code> (default 100) integer specifying the number of
random subsets to sample, if NA all subsets will be
used. <code>alpha_stab</code> (default 0.05) value between 0 and 1
specifiying the stability cutoff. <code>alpha_pred</code> (default
0.05) value between 0 and 1 specifiying the predictive
cutoff. <code>size_weight</code> (default "linear") one of the strings
"linear", "constant", "quadratic", "rbf" or numeric weight
vector specifying a probablity for each potential set size from
1 to <code>m</code>. <code>compute_predictive_model</code> (default TRUE)
boolean specifying whether to additionally compute SR (pred) and
SR (diff) as well. <code>prescreen_size</code> (default NA) integer
specifying the number of variables to screen down to before
applying SR, if NA then no screening is
applied. <code>prescreen_type</code> (default "correlation") one of
the strings "correlation", "ols", "lasso", "deconfounding",
"correlation_env", "deconfounding_env" specifying the type of
screening. <code>stab_test</code> (default "exact") specifies which
stability test to use. Either "exact" for a Bonferroni-corrected
version of Chow's test, "mean_sres" a mean test based on
resampling of the scaled residuals or "meanvar_sres" a mean and
variance test based on resampling of the scaled
residuals. <code>pred_score</code> (default "mse") specifies the
prediction score. Either "mse" for the mean squared error,
"mse_env" for the environment-wise best mean squared error,
"aic" for the Akaike information criterion or "bic" for the
Bayesian information criterion. <code>topk</code> (default 1) is a
tuning parameter that can be used to increase the number of
predictive sets. It should be an integer value, where higher
values lead to more accepted sets based on the predictive
cutoff. <code>variable_importance</code> (default
"scaled_coefficient") specifies the type of variable
ranking. Either "weighted" for a weighted average of all
selected subsets, "scaled_coefficient" for a ranking based on
the scaled average regression parameter or "permutation" for a
permutation based ranking.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>0 for no output, 1 for text output and 2 for text
and diagnostic plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>fix the seed value at the beginning of the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Performs a linear regression of a response <code>Y</code> on a set of
predictors <code>X</code> while ensuring stability across different
values of a stabilizing variable <code>A</code>.
</p>


<h3>Value</h3>

<p>Object of class 'StabilizedRegression' consisting of the following
elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>learner_list</code></td>
<td>
<p>List of all fitted linear OLS regressions (fitted R6 'linear_regression' objects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting</code></td>
<td>
<p>Weighting of the individual regressions in SR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighting_pred</code></td>
<td>
<p>Weighting of the individual regressions in SR (pred). Only computed if compute_predictive_model is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_importance</code></td>
<td>
<p>Variable importance measure for all predictors based on SR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_importance_pred</code></td>
<td>
<p>Variable importance measure for all predictors based on SR (pred). Only computed if compute_predictive_model is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_importance_diff</code></td>
<td>
<p>Variable importance measure for all predictors based on difference between SR and SR (pred). Only computed if compute_predictive_model is TRUE.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Niklas Pfister
</p>


<h3>References</h3>

<p>Pfister, N., E. Williams, R. Aebersold, J. Peters and
P. B\"uhlmann (2019). Stabilizing Variable Selection and
Regression. arXiv preprint arXiv:1911.01850.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example
set.seed(1)
X1 &lt;- rnorm(200)
Y &lt;- X1 + rnorm(200)
X2 &lt;- 0.5 * X1 + Y + 0.2 * c(rnorm(100), rnorm(100)+2)

X &lt;- cbind(X1, X2)
A &lt;- as.factor(rep(c(0, 1), each=100))

fit_sr &lt;- StabilizedRegression(X, Y, A, pars=list(B=NA))
fit_lm &lt;- lm(Y ~ X)

print(paste("Coefficients of SR:", toString(coefficients(fit_sr))))
print(paste("Coefficients of SR (pred):", toString(coefficients(fit_sr, predictive_model=TRUE))))
print(paste("Coefficients of OLS:", toString(coefficients(fit_lm))))
</code></pre>


</div>