<div class="container">

<table style="width: 100%;"><tr>
<td>data.long</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Longitudinal Dataset
</h2>

<h3>Description</h3>

<p>This dataset contains 200 observations on
12 items. 6 items (<code>I1T1</code>, ...,<code>I6T1</code>)
were administered at measurement occasion T1
and 6 items at T2 (<code>I3T2</code>, ..., <code>I8T2</code>). There were 4 anchor items
which were presented at both time points.
The first column in the dataset contains the student identifier.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(data.long)
</code></pre>


<h3>Format</h3>

<p>The format of the dataset is
</p>
<p><code>'data.frame':   200 obs. of  13 variables:</code> <br><code> $ idstud: int  1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 ...</code> <br><code> $ I1T1  : int  1 1 1 1 1 1 1 0 1 1 ...</code> <br><code> $ I2T1  : int  0 0 1 1 1 1 0 1 1 1 ...</code> <br><code> $ I3T1  : int  1 0 1 1 0 1 0 0 0 0 ...</code> <br><code> $ I4T1  : int  1 0 0 1 0 0 0 0 1 1 ...</code> <br><code> $ I5T1  : int  1 0 0 1 0 0 0 0 1 0 ...</code> <br><code> $ I6T1  : int  1 0 0 0 0 0 0 0 0 0 ...</code> <br><code> $ I3T2  : int  1 1 0 0 1 1 1 1 0 1 ...</code> <br><code> $ I4T2  : int  1 1 0 0 1 1 0 0 0 1 ...</code> <br><code> $ I5T2  : int  1 0 1 1 1 1 1 0 1 1 ...</code> <br><code> $ I6T2  : int  1 1 0 0 0 0 0 0 0 1 ...</code> <br><code> $ I7T2  : int  1 0 0 0 0 0 0 0 0 1 ...</code> <br><code> $ I8T2  : int  0 0 0 0 1 0 0 0 0 0 ...</code> <br></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(data.long)
dat &lt;- data.long
dat &lt;- dat[,-1]
I &lt;- ncol(dat)

#*************************************************
# Model 1: 2-dimensional Rasch model
#*************************************************
# define Q-matrix
Q &lt;- matrix(0,I,2)
Q[1:6,1] &lt;- 1
Q[7:12,2] &lt;- 1
rownames(Q) &lt;- colnames(dat)
colnames(Q) &lt;- c("T1","T2")

# vector with same items
itemnr &lt;- as.numeric( substring( colnames(dat),2,2) )
# fix mean at T2 to zero
mu.fixed &lt;- cbind( 2,0 )

#--- M1a: rasch.mml2 (in sirt)
mod1a &lt;- sirt::rasch.mml2(dat, Q=Q, est.b=itemnr, mu.fixed=mu.fixed)
summary(mod1a)

#--- M1b: smirt (in sirt)
mod1b &lt;- sirt::smirt(dat, Qmatrix=Q, irtmodel="comp", est.b=itemnr,
                  mu.fixed=mu.fixed )

#--- M1c: tam.mml (in TAM)

# assume equal item difficulty of I3T1 and I3T2, I4T1 and I4T2, ...
# create draft design matrix and modify it
A &lt;- TAM::designMatrices(resp=dat)$A
dimnames(A)[[1]] &lt;- colnames(dat)
  ##   &gt; str(A)
  ##    num [1:12, 1:2, 1:12] 0 0 0 0 0 0 0 0 0 0 ...
  ##    - attr(*, "dimnames")=List of 3
  ##     ..$ : chr [1:12] "Item01" "Item02" "Item03" "Item04" ...
  ##     ..$ : chr [1:2] "Category0" "Category1"
  ##     ..$ : chr [1:12] "I1T1" "I2T1" "I3T1" "I4T1" ...
A1 &lt;- A[,, c(1:6, 11:12 ) ]
A1[7,2,3] &lt;- -1     # difficulty(I3T1)=difficulty(I3T2)
A1[8,2,4] &lt;- -1     # I4T1=I4T2
A1[9,2,5] &lt;- A1[10,2,6] &lt;- -1
dimnames(A1)[[3]] &lt;- substring( dimnames(A1)[[3]],1,2)
  ##   &gt; A1[,2,]
  ##        I1 I2 I3 I4 I5 I6 I7 I8
  ##   I1T1 -1  0  0  0  0  0  0  0
  ##   I2T1  0 -1  0  0  0  0  0  0
  ##   I3T1  0  0 -1  0  0  0  0  0
  ##   I4T1  0  0  0 -1  0  0  0  0
  ##   I5T1  0  0  0  0 -1  0  0  0
  ##   I6T1  0  0  0  0  0 -1  0  0
  ##   I3T2  0  0 -1  0  0  0  0  0
  ##   I4T2  0  0  0 -1  0  0  0  0
  ##   I5T2  0  0  0  0 -1  0  0  0
  ##   I6T2  0  0  0  0  0 -1  0  0
  ##   I7T2  0  0  0  0  0  0 -1  0
  ##   I8T2  0  0  0  0  0  0  0 -1

# estimate model
# set intercept of second dimension (T2) to zero
beta.fixed &lt;- cbind( 1, 2, 0 )
mod1c &lt;- TAM::tam.mml( resp=dat, Q=Q, A=A1, beta.fixed=beta.fixed)
summary(mod1c)

#*************************************************
# Model 2: 2-dimensional 2PL model
#*************************************************

# set variance at T2 to 1
variance.fixed &lt;- cbind(2,2,1)

# M2a: rasch.mml2 (in sirt)
mod2a &lt;- sirt::rasch.mml2(dat, Q=Q, est.b=itemnr, est.a=itemnr, mu.fixed=mu.fixed,
             variance.fixed=variance.fixed, mmliter=100)
summary(mod2a)

#*************************************************
# Model 3: Concurrent calibration by assuming invariant item parameters
#*************************************************

library(mirt)   # use mirt for concurrent calibration
data(data.long)
dat &lt;- data.long[,-1]
I &lt;- ncol(dat)

# create user defined function for between item dimensionality 4PL model
name &lt;- "4PLbw"
par &lt;- c("low"=0,"upp"=1,"a"=1,"d"=0,"dimItem"=1)
est &lt;- c(TRUE, TRUE,TRUE,TRUE,FALSE)
# item response function
irf &lt;- function(par,Theta,ncat){
     low &lt;- par[1]
     upp &lt;- par[2]
     a &lt;- par[3]
     d &lt;- par[4]
     dimItem &lt;- par[5]
     P1 &lt;- low + ( upp - low ) * plogis( a*Theta[,dimItem] + d )
     cbind(1-P1, P1)
}

# create item response function
fourPLbetw &lt;- mirt::createItem(name, par=par, est=est, P=irf)
head(dat)

# create mirt model (use variable names in mirt.model)
mirtsyn &lt;- "
     T1=I1T1,I2T1,I3T1,I4T1,I5T1,I6T1
     T2=I3T2,I4T2,I5T2,I6T2,I7T2,I8T2
     COV=T1*T2,,T2*T2
     MEAN=T1
     CONSTRAIN=(I3T1,I3T2,d),(I4T1,I4T2,d),(I5T1,I5T2,d),(I6T1,I6T2,d),
                 (I3T1,I3T2,a),(I4T1,I4T2,a),(I5T1,I5T2,a),(I6T1,I6T2,a)
        "
# create mirt model
mirtmodel &lt;- mirt::mirt.model( mirtsyn, itemnames=colnames(dat) )
# define parameters to be estimated
mod3.pars &lt;- mirt::mirt(dat, mirtmodel$model, rep( "4PLbw",I),
                   customItems=list("4PLbw"=fourPLbetw), pars="values")
# select dimensions
ind &lt;- intersect( grep("T2",mod3.pars$item), which( mod3.pars$name=="dimItem" ) )
mod3.pars[ind,"value"] &lt;- 2
# set item parameters low and upp to non-estimated
ind &lt;- which( mod3.pars$name %in% c("low","upp") )
mod3.pars[ind,"est"] &lt;- FALSE

# estimate 2PL model
mod3 &lt;- mirt::mirt(dat, mirtmodel$model, itemtype=rep( "4PLbw",I),
                customItems=list("4PLbw"=fourPLbetw), pars=mod3.pars, verbose=TRUE,
                technical=list(NCYCLES=50)  )
mirt.wrapper.coef(mod3)

#****** estimate model in lavaan
library(lavaan)

# specify syntax
lavmodel &lt;- "
             #**** T1
             F1=~ a1*I1T1+a2*I2T1+a3*I3T1+a4*I4T1+a5*I5T1+a6*I6T1
             I1T1 | b1*t1 ; I2T1 | b2*t1 ; I3T1 | b3*t1 ; I4T1 | b4*t1
             I5T1 | b5*t1 ; I6T1 | b6*t1
             F1 ~~ 1*F1
             #**** T2
             F2=~ a3*I3T2+a4*I4T2+a5*I5T2+a6*I6T2+a7*I7T2+a8*I8T2
             I3T2 | b3*t1 ; I4T2 | b4*t1 ; I5T2 | b5*t1 ; I6T2 | b6*t1
             I7T2 | b7*t1 ; I8T2 | b8*t1
             F2 ~~ NA*F2
             F2 ~ 1
             #*** covariance
             F1 ~~ F2
                "
# estimate model using theta parameterization
mod3lav &lt;- lavaan::cfa( data=dat, model=lavmodel,
            std.lv=TRUE, ordered=colnames(dat), parameterization="theta")
summary(mod3lav, standardized=TRUE, fit.measures=TRUE, rsquare=TRUE)

#*************************************************
# Model 4: Linking with items of different item slope groups
#*************************************************

data(data.long)
dat &lt;- data.long
# dataset for T1
dat1 &lt;- dat[, grep( "T1", colnames(dat) ) ]
colnames(dat1) &lt;- gsub("T1","", colnames(dat1) )
# dataset for T2
dat2 &lt;- dat[, grep( "T2", colnames(dat) ) ]
colnames(dat2) &lt;- gsub("T2","", colnames(dat2) )

# 2PL model with slope groups T1
mod1 &lt;- sirt::rasch.mml2( dat1, est.a=c( rep(1,2), rep(2,4) ) )
summary(mod1)

# 2PL model with slope groups T2
mod2 &lt;- sirt::rasch.mml2( dat2, est.a=c( rep(1,4), rep(2,2) ) )
summary(mod2)

#------- Link 1: Haberman Linking
# collect item parameters
dfr1 &lt;- data.frame( "study1", mod1$item$item, mod1$item$a, mod1$item$b )
dfr2 &lt;- data.frame( "study2", mod2$item$item, mod2$item$a, mod2$item$b )
colnames(dfr2) &lt;- colnames(dfr1) &lt;- c("study", "item", "a", "b" )
itempars &lt;- rbind( dfr1, dfr2 )
# Linking
link1 &lt;- sirt::linking.haberman(itempars=itempars)

#------- Link 2: Invariance alignment method
# create objects for invariance.alignment
nu &lt;- rbind( c(mod1$item$thresh,NA,NA), c(NA,NA,mod2$item$thresh) )
lambda &lt;- rbind( c(mod1$item$a,NA,NA), c(NA,NA,mod2$item$a ) )
colnames(lambda) &lt;- colnames(nu) &lt;- paste0("I",1:8)
rownames(lambda) &lt;- rownames(nu) &lt;- c("T1", "T2")
# Linking
link2a &lt;- sirt::invariance.alignment( lambda, nu )
summary(link2a)

## End(Not run)
</code></pre>


</div>