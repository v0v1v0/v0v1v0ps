<div class="container">

<table style="width: 100%;"><tr>
<td>rbpspline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a penalized spline with radial basis functions to data</h2>

<h3>Description</h3>

<p>Fits a penalized spline with radial basis functions to data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbpspline(y, x, knots, degree, penalty = "gcv", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector/matrix giving the values of the predictor
variable(s). If <code>x</code> is a matrix, each row corresponds to one
observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>A vector givint the coordinates of the knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The degree of the penalized smoothing spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>A numeric giving the penalty coefficient for the
penalization term. Alternatively, it could be either 'cv' or 'gcv'
to choose the <code>penalty</code> using the (generalized)
cross-validation criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options to be passed to the <code>cv</code>
or <code>gcv</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The penalized spline with radial basis is defined by:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \beta_0 + \beta_1 x + \ldots + \beta_{m-1} x^{m-1} +
    \sum_{k=0}^{K-1} \beta_{m+k} || x - \kappa_k ||^{2m - 1}</code>
</p>

<p>where <code class="reqn">\beta_i</code> are the coefficients to be estimated,
<code class="reqn">\kappa_i</code> are the coordinates of the i-th knot and
<code class="reqn">m = \frac{d+1}{2}</code> where <code class="reqn">d</code> corresponds to
the <code>degree</code> of the spline.
</p>
<p>The fitting criterion is to minimize
</p>
<p style="text-align: center;"><code class="reqn">||y - X\beta||^2 + \lambda^{2m-1} \beta^T K \beta</code>
</p>

<p>where <code class="reqn">\lambda</code> is the penalty coefficient and
<code class="reqn">K</code> the penalty matrix.  
</p>


<h3>Value</h3>

<p>An object of class <code>pspline</code>. 
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Ruppert, D. Wand, M.P. and Carrol, R.J. (2003) <em>Semiparametric
Regression</em> Cambridge Series in Statistical and Probabilistic
Mathematics.
</p>


<h3>See Also</h3>

<p><code>cv</code>, <code>gcv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 200
x &lt;- runif(n)
fun &lt;- function(x) sin(3 * pi * x)
y &lt;- fun(x) + rnorm(n, 0, sqrt(0.4))
knots &lt;- quantile(x, prob = 1:(n/4) / (n/4 + 1))
fitted &lt;- rbpspline(y, x, knots = knots, degree = 3)
fitted

plot(x, y)
lines(fitted, col = 2)
</code></pre>


</div>