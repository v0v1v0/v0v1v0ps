<div class="container">

<table style="width: 100%;"><tr>
<td>pseudo.absence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-absence random samples</h2>

<h3>Description</h3>

<p>Generates pseudo-absence samples based on density estimate
of known locations
</p>


<h3>Usage</h3>

<pre><code class="language-R">pseudo.absence(
  x,
  n,
  window = "hull",
  ref = NULL,
  s = NULL,
  sigma = "Scott",
  wts = NULL,
  KDE = FALSE,
  gradient = 1,
  p = NULL,
  edge = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An sf POINT geometry object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of random samples to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>Type of window (hull OR extent), overridden if mask provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>Optional terra SpatRaster class raster. The resolution of the
density estimate will match mask.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Optional resolution passed to window argument. Caution should be
used due to long processing times associated with high
resolution. In contrast, coarse resolution can exclude
known points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Bandwidth selection method for KDE, default is 'Scott'.
Options are 'Scott', 'Stoyan', 'Diggle', 'likelihood',
and 'geometry'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>Optional vector of weights corresponding to point pattern</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KDE</code></td>
<td>
<p>Return KDE raster (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>A scaling factor applied to the sigma parameter used to
adjust the gradient decent of the density estimate. The
default is 1, for no adjustment (downweight &lt; 1 | upweight &gt; 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Minimum value for probability distribution (must be &gt;  0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>Apply Diggle edge correction (TRUE/FALSE)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The window type creates a convex hull by default or, optionally, uses the
maximum extent (envelope). If a mask is provided the kde will represent
areas defined by the mask and defines the area that pseudo absence data
will be generated.
</p>
<p>Available bandwidth selection methods are:
</p>

<ul>
<li>
<p> Scott (Scott 1992), Scott's Rule for Bandwidth Selection (1st order)
</p>
</li>
<li>
<p> Diggle (Berman &amp; Diggle 1989), Minimize the mean-square error via cross
</p>
</li>
<li>
<p> validation (2nd order)
</p>
</li>
<li>
<p> likelihood (Loader 1999), Maximum likelihood cross validation (2nd order)
</p>
</li>
<li>
<p> geometry, Bandwidth is based on simple window geometry (1st order)
</p>
</li>
<li>
<p> Stoyan (Stoyan &amp; Stoyan 1995), Based on pair-correlation function (strong 2nd order)
</p>
</li>
<li>
<p> User defined numeric distance bandwidth
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list class object with the following components:
</p>

<ul>
<li>
<p> sample  A sf POINT geometry object containing random samples
</p>
</li>
<li>
<p> kde     A terra SpatRaster class of inverted Isotropic KDE estimates
used as sample weights (IF KDE = TRUE)
</p>
</li>
<li>
<p> sigma   Selected bandwidth of KDE
</p>
</li>
</ul>
<h3>Note</h3>

<p>resulting bandwidth can vary widely by method. the 'diggle' method
is intended for selecting bandwidth representing 2nd order spatial variation
whereas the 'scott' method will represent 1st order trend. the 'geometry' approach
will also represent 1st order trend. For large datasets, caution should be used with
the 2nd order 'likelihood' approach, as it is slow and computationally expensive.
finally, the 'stoyan' method will produce very strong 2nd order results.
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  <a href="mailto:jeffrey_evans@tnc.org">jeffrey_evans@tnc.org</a>
</p>


<h3>References</h3>

<p>Berman, M. and Diggle, P. (1989) Estimating weighted integrals of the second-order
intensity of a spatial point process. Journal of the Royal Statistical Society,
series B 51, 81-92.
</p>
<p>Fithian, W &amp; T. Hastie (2013) Finite-sample equivalence in statistical models for
presence-only data. Annals of Applied Statistics 7(4): 1917-1939
</p>
<p>Hengl, T., H. Sierdsema, A. Radovic, and A. Dilo (2009) Spatial prediction of species
distributions from occurrence-only records: combining point pattern analysis,
ENFA and regression-kriging. Ecological Modelling, 220(24):3499-3511
</p>
<p>Loader, C. (1999) Local Regression and Likelihood. Springer, New York.
</p>
<p>Scott, D.W. (1992) Multivariate Density Estimation. Theory, Practice and Visualization.
New York, Wiley.
</p>
<p>Stoyan, D. and Stoyan, H. (1995) Fractals, random shapes and point fields: methods of
geometrical statistics. John Wiley and Sons.
</p>
<p>Warton, D.i., and L.C. Shepherd (2010) Poisson Point Process Models Solve the Pseudo-Absence
Problem for Presence-only Data in Ecology. The Annals of Applied Statistics, 4(3):1383-1402
</p>


<h3>Examples</h3>

<pre><code class="language-R"> p = c("sf", "sp", "terra", "spatstat.data")
 if(any(!unlist(lapply(p, requireNamespace, quietly=TRUE)))) { 
   m = which(!unlist(lapply(p, requireNamespace, quietly=TRUE)))
   message("Can't run examples, please install ", paste(p[m], collapse = " "))
 } else {
   invisible(lapply(p, require, character.only=TRUE))
  
data(meuse, package = "sp")
meuse &lt;- st_as_sf(meuse, coords = c("x", "y"), crs = 28992, 
                  agr = "constant") 

# Using a raster mask   
r &lt;- rast(ext(meuse), resolution=40, crs=crs(meuse))
  r[] &lt;- rep(1,ncell(r))
  
pa &lt;- pseudo.absence(meuse, n=100, window='hull', KDE=TRUE, ref = r, 
                     sigma='Diggle', s=50) 
  col.br &lt;- colorRampPalette(c('blue','yellow'))
    plot(pa$kde, col=col.br(10))
      plot(st_geometry(meuse), pch=20, cex=1, add=TRUE)
        plot(st_geometry(pa$sample), col='red', pch=20, cex=1, add=TRUE)
          legend('top', legend=c('Presence', 'Pseudo-absence'), 
                 pch=c(20,20),col=c('black','red'), bg="white")

# With clustered data
data(bei, package = "spatstat.data")
  trees &lt;- st_as_sf(bei)
    trees &lt;- trees[-1,]

trees.abs &lt;- pseudo.absence(trees, n=100, window='extent', KDE=TRUE)
  col.br &lt;- colorRampPalette(c('blue','yellow'))
    plot(trees.abs$kde, col=col.br(10))
     plot(st_geometry(trees), pch=20, cex=0.50, add=TRUE)
        plot(st_geometry(trees.abs$sample), col='red', pch=20, cex=1, add=TRUE)
          legend('top', legend=c('Presence', 'Pseudo-absence'), 
                 pch=c(20,20),col=c('black','red'),bg="white")
}     
</code></pre>


</div>