<div class="container">

<table style="width: 100%;"><tr>
<td>ci_bound_ur_i</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood-Based Confidence
Bound By Root Finding</h2>

<h3>Description</h3>

<p>Using root finding
to find the lower or
upper bound of the likelihood-based
confidence interval (LBCI) for one
parameter in a structural equation
model fitted in <code>lavaan::lavaan()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ci_bound_ur_i(
  i = NULL,
  npar = NULL,
  sem_out = NULL,
  f_constr = NULL,
  which = NULL,
  history = FALSE,
  perturbation_factor = 0.9,
  lb_var = -Inf,
  standardized = FALSE,
  wald_ci_start = !standardized,
  opts = list(),
  ciperc = 0.95,
  ci_limit_ratio_tol = 1.5,
  verbose = FALSE,
  sf = 1,
  sf2 = 0,
  p_tol = 5e-04,
  std_method = "internal",
  bounds = "none",
  xtol_rel_factor = 1,
  ftol_rel_factor = 1,
  lb_prop = 0.05,
  lb_se_k = 3,
  d = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>The position of the target
parameter as appeared in the
parameter table of a lavaan object,
generated by
<code>lavaan::parameterTable()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>Ignored by this function.
Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sem_out</code></td>
<td>
<p>The fit object.
Currently supports
lavaan::lavaan objects only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_constr</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Whether the lower bound
or the upper bound is to be found.
Must be <code>"lbound"</code> or <code>"ubound"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>history</code></td>
<td>
<p>Not used. Kept for
backward compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perturbation_factor</code></td>
<td>
<p>Ignored by
this function. Included consistency
in the interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_var</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>If <code>TRUE</code>, the
LBCI is for the requested estimate in
the standardized solution. Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald_ci_start</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>Options to be passed to
<code>stats::uniroot()</code>. Default is
<code>list()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciperc</code></td>
<td>
<p>The intended coverage
probability for the confidence
interval. Default is .95, and the
bound for a 95% confidence interval
will be sought.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_limit_ratio_tol</code></td>
<td>
<p>The
tolerance for the ratio of <code>a</code> to
<code>b</code>, where <code>a</code> is the distance
between an LBCI limit and the point
estimate, and the <code>b</code> is the distance
between the original confidence limit
(by default the Wald CI in
<code>lavaan::lavaan()</code>) and the point
estimate. If the ratio is larger than
this value or smaller than the
reciprocal of this value, a warning
is set in the status code. Default is
1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, the
function will store more diagnostic
information in the attribute <code>diag</code>.
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>Ignored by this function.
Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf2</code></td>
<td>
<p>Ignored by this function.
Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_tol</code></td>
<td>
<p>Tolerance for checking
the achieved level of confidence. If
the absolute difference between the
achieved level and <code>ciperc</code> is
greater than this amount, a warning
is set in the status code and the
bound is set to <code>NA</code>. Default is
5e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_method</code></td>
<td>
<p>The method used to
find the standardized solution. If
equal to <code>"lavaan"</code>,
<code>lavaan::standardizedSolution()</code> will
be used. If equal to <code>"internal"</code>, an
internal function will be used. The
<code>"lavaan"</code> method should work in all
situations, but the <code>"internal"</code>
method is usually much faster.
Default is <code>"internal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol_rel_factor</code></td>
<td>
<p>Ignored by
this function. Included consistency
in the interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol_rel_factor</code></td>
<td>
<p>Ignored by
this function. Included consistency
in the interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_prop</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb_se_k</code></td>
<td>
<p>Ignored by this
function. Included consistency in the
interface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>A value used to determine
the width of the interval in the
initial search. Larger this value,
<em>narrow</em> the interval. Default is 5.
Used by <code>ci_bound_ur()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments. Not
used.</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Important Notice</h4>

<p>This function is not supposed to be
used directly by users in typical
scenarios. Its interface is
user-<em>unfriendly</em> because it should
be used through <code>semlbci()</code>. It is
exported such that interested users
can examine how a confidence bound is
found, or use it for experiments or
simulations.
</p>



<h4>Usage</h4>

<p>This function is the lowest level
function used by <code>semlbci()</code>.
<code>semlbci()</code> calls this function once
for each bound of each parameter.
</p>
<p>For consistency in the interface,
most of the arguments in
<code>ci_bound_wn_i()</code> are also included
in this function, even those not used
internally.
</p>



<h4>Algorithm</h4>

<p>This function, unlike
<code>ci_bound_wn_i()</code>, use a simple root
finding algorithm. Basically, it tries
fixing the target parameter to
different values until the likelihood
ratio test <em>p</em>-value, or the
corresponding chi-square difference,
is equal to the
value corresponding to the desired
level of confidence. (Internally,
the difference between the <em>p</em>-value
and the target <em>p</em>-value, that for
the chi-square difference, is the
function value.)
</p>
<p>For finding the bound, this algorithm
can be inefficient compared to the
one proposed by Wu and Neale (2012).
The difference can be less than
one second versus 10 seconds.
It is included as a backup algorithm
for parameters which are difficult
for the method by Wu and Neale.
</p>
<p>Internally, it uses <code>uniroot()</code> to
find the root.
</p>



<h4>Limitation(s)</h4>

<p>This function does not handle an
estimate close to an attainable bound
using the method proposed by Wu and
Neale (2012). Use it for such
parameters with cautions.
</p>



<h3>Value</h3>

<p>A <code>cibound</code>-class object
which is a list with three elements:
</p>

<ul>
<li> <p><code>bound</code>: A single number. The value
of the bound located. <code>NA</code> is the
search failed for various reasons.
</p>
</li>
<li> <p><code>diag</code>: A list of diagnostic
information.
</p>
</li>
<li> <p><code>call</code>: The original call.
</p>
</li>
</ul>
<p>A detailed and organized output can
be printed by the default print
method (<code>print.cibound()</code>).
</p>


<h3>References</h3>

<p>Wu, H., &amp; Neale, M. C. (2012).
Adjusted confidence intervals for a
bounded parameter. <em>Behavior
Genetics, 42</em>(6), 886-898.
<a href="https://doi.org/10.1007/s10519-012-9560-z">doi:10.1007/s10519-012-9560-z</a>
</p>


<h3>See Also</h3>

<p><code>print.cibound()</code>,
<code>semlbci()</code>, <code>ci_i_one()</code>; see
<code>ci_bound_wn_i()</code> on the version
for the method by Wu and Neale
(2012).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(lavaan)
data(simple_med)
dat &lt;- simple_med
mod &lt;-
"
m ~ x
y ~ m
"
fit_med &lt;- sem(mod, simple_med, fixed.x = FALSE)
# Remove `opts` in real cases.
# The options are added just to speed up the example
out1l &lt;- ci_bound_ur_i(i = 1,
                       sem_out = fit_med,
                       which = "lbound",
                       opts = list(use_callr = FALSE,
                                   interval = c(0.8277, 0.8278)))
out1l
</code></pre>


</div>