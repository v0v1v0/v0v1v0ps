<div class="container">

<table style="width: 100%;"><tr>
<td>addMissing</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add missing values to a vector given a MCAR, MAR, or MNAR scheme</h2>

<h3>Description</h3>

<p>Given an input vector, replace elements of this vector with missing values according to some scheme.
Default method replaces input values with a MCAR scheme (where on average 10% of the values will be
replaced with <code>NA</code>s). MAR and MNAR are supported by replacing the default <code>FUN</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addMissing(y, fun = function(y, rate = 0.1, ...) rep(rate, length(y)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an input vector that should contain missing data in the form of <code>NA</code>'s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a user defined function indicating the missing data mechanism for each element in <code>y</code>.
Function must return a vector of probability values with the length equal to the length of <code>y</code>.
Each value in the returned vector indicates the probability that
the respective element in y will be replaced with <code>NA</code>.
Function must contain the argument <code>y</code>, representing the
input vector, however any number of additional arguments can be included</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>FUN</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given an input vector y, and other relevant variables
inside (X) and outside (Z) the data-set, the three types of missingness are:
</p>

<dl>
<dt>MCAR</dt>
<dd>
<p>Missing completely at random (MCAR). This is realized by randomly
sampling the values of the
input vector (y) irrespective of the possible values in X and Z.
Therefore missing values are randomly sampled and do not depend on any data characteristics and
are truly random</p>
</dd>
<dt>MAR</dt>
<dd>
<p>Missing at random (MAR). This is realized when values in the dataset (X)
predict the missing data  mechanism in y; conceptually this is equivalent to
<code class="reqn">P(y = NA | X)</code>. This requires the user to define a custom missing data function</p>
</dd>
<dt>MNAR</dt>
<dd>
<p>Missing not at random (MNAR). This is similar to MAR except
that the missing mechanism comes
from the value of y itself or from variables outside the working dataset;
conceptually this is equivalent to <code class="reqn">P(y = NA | X, Z, y)</code>. This requires
the user to define a custom missing data function</p>
</dd>
</dl>
<h3>Value</h3>

<p>the input vector <code>y</code> with the sampled <code>NA</code> values
(according to the <code>FUN</code> scheme)
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P., &amp; Adkins, M. C.  (2020). Writing Effective and Reliable Monte Carlo Simulations
with the SimDesign Package. <code>The Quantitative Methods for Psychology, 16</code>(4), 248-280.
<a href="https://doi.org/10.20982/tqmp.16.4.p248">doi:10.20982/tqmp.16.4.p248</a>
</p>
<p>Sigal, M. J., &amp; Chalmers, R. P. (2016). Play it again: Teaching statistics with Monte
Carlo simulation. <code>Journal of Statistics Education, 24</code>(3), 136-156.
<a href="https://doi.org/10.1080/10691898.2016.1246953">doi:10.1080/10691898.2016.1246953</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

set.seed(1)
y &lt;- rnorm(1000)

## 10% missing rate with default FUN
head(ymiss &lt;- addMissing(y), 10)

## 50% missing with default FUN
head(ymiss &lt;- addMissing(y, rate = .5), 10)

## missing values only when female and low
X &lt;- data.frame(group = sample(c('male', 'female'), 1000, replace=TRUE),
                level = sample(c('high', 'low'), 1000, replace=TRUE))
head(X)

fun &lt;- function(y, X, ...){
    p &lt;- rep(0, length(y))
    p[X$group == 'female' &amp; X$level == 'low'] &lt;- .2
    p
}

ymiss &lt;- addMissing(y, X, fun=fun)
tail(cbind(ymiss, X), 10)

## missingness as a function of elements in X (i.e., a type of MAR)
fun &lt;- function(y, X){
   # missingness with a logistic regression approach
   df &lt;- data.frame(y, X)
   mm &lt;- model.matrix(y ~ group + level, df)
   cfs &lt;- c(-5, 2, 3) #intercept, group, and level coefs
   z &lt;- cfs %*% t(mm)
   plogis(z)
}

ymiss &lt;- addMissing(y, X, fun=fun)
tail(cbind(ymiss, X), 10)

## missing values when y elements are large (i.e., a type of MNAR)
fun &lt;- function(y) ifelse(abs(y) &gt; 1, .4, 0)
ymiss &lt;- addMissing(y, fun=fun)
tail(cbind(y, ymiss), 10)


## End(Not run)

</code></pre>


</div>