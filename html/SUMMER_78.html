<div class="container">

<table style="width: 100%;"><tr>
<td>smoothDirect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smoothed direct estimates for mortality rates</h2>

<h3>Description</h3>

<p>The function <code>smoothDirect</code> replaces the previous function name <code>fitINLA</code> (before version 1.0.0).
</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothDirect(
  data,
  Amat,
  formula = NULL,
  time.model = c("rw1", "rw2", "ar1")[2],
  st.time.model = NULL,
  year_label,
  year_range = c(1980, 2014),
  is.yearly = TRUE,
  m = 5,
  type.st = 1,
  survey.effect = FALSE,
  hyper = c("pc", "gamma")[1],
  pc.u = 1,
  pc.alpha = 0.01,
  pc.u.phi = 0.5,
  pc.alpha.phi = 2/3,
  pc.u.cor = 0.7,
  pc.alpha.cor = 0.9,
  pc.st.u = NA,
  pc.st.alpha = NA,
  control.compute = list(dic = TRUE, mlik = TRUE, cpo = TRUE, openmp.strategy =
    "default", config = TRUE),
  control.inla = list(strategy = "adaptive", int.strategy = "auto"),
  control.fixed = list(),
  verbose = FALSE,
  geo = NULL,
  rw = NULL,
  ar = NULL,
  options = NULL
)

fitINLA(
  data,
  Amat,
  formula = NULL,
  time.model = c("rw1", "rw2", "ar1")[2],
  st.time.model = NULL,
  year_label,
  year_range = c(1980, 2014),
  is.yearly = TRUE,
  m = 5,
  type.st = 1,
  survey.effect = FALSE,
  hyper = c("pc", "gamma")[1],
  pc.u = 1,
  pc.alpha = 0.01,
  pc.u.phi = 0.5,
  pc.alpha.phi = 2/3,
  pc.u.cor = 0.7,
  pc.alpha.cor = 0.9,
  pc.st.u = NA,
  pc.st.alpha = NA,
  control.compute = list(dic = TRUE, mlik = TRUE, cpo = TRUE, openmp.strategy =
    "default", config = TRUE),
  control.inla = list(strategy = "adaptive", int.strategy = "auto"),
  control.fixed = list(),
  verbose = FALSE,
  geo = NULL,
  rw = NULL,
  ar = NULL,
  options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Combined dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amat</code></td>
<td>
<p>Adjacency matrix for the regions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>INLA formula. See vignette for example of using customized formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.model</code></td>
<td>
<p>Model for the main temporal trend, can be rw1, rw2, or ar1. ar1 is not implemented for yearly model with period data input. Default to be rw2. For ar1 main effect, a linear slope is also added with time scaled to be between -0.5 to 0.5, i.e., the slope coefficient represents the total change between the first year and the last year in the projection period on the logit scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st.time.model</code></td>
<td>
<p>Temporal component model for the interaction term, can be rw1, rw2, or ar1. ar1 is not implemented for yearly model with period data input. Default to be the same as time.model unless specified otherwise. For ar1 interaction model, region-specific random slopes are currently not implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_label</code></td>
<td>
<p>string vector of year names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year_range</code></td>
<td>
<p>Entire range of the years (inclusive) defined in year_label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.yearly</code></td>
<td>
<p>Logical indicator for fitting yearly or period model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of years in each period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.st</code></td>
<td>
<p>type for space-time interaction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survey.effect</code></td>
<td>
<p>logical indicator whether to include a survey iid random effect. If this is set to TRUE, there needs to be a column named 'survey' in the input data frame. In prediction, this random effect term will be set to 0. Notice this survey effect is implemented according to the Merter et al. (2015) model, and differently compared to the smoothCluster() function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>which hyperpriors to use. Default to be using the PC prior ("pc").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.u</code></td>
<td>
<p>hyperparameter U for the PC prior on precisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.alpha</code></td>
<td>
<p>hyperparameter alpha for the PC prior on precisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.u.phi</code></td>
<td>
<p>hyperparameter U for the PC prior on the mixture probability phi in BYM2 model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.alpha.phi</code></td>
<td>
<p>hyperparameter alpha for the PC prior on the mixture probability phi in BYM2 model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.u.cor</code></td>
<td>
<p>hyperparameter U for the PC prior on the autocorrelation parameter in the AR prior, i.e. Prob(cor &gt; pc.u.cor) = pc.alpha.cor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.alpha.cor</code></td>
<td>
<p>hyperparameter alpha for the PC prior on the autocorrelation parameter in the AR prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.st.u</code></td>
<td>
<p>hyperparameter U for the PC prior on precisions for the interaction term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc.st.alpha</code></td>
<td>
<p>hyperparameter alpha for the PC prior on precisions for the interaction term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.compute</code></td>
<td>
<p>list of options to be passed to control.compute() in the inla() function. The default argument saves the internal objects created by INLA for posterior sampling later. If the fitted object is too large in size and there is no need to perform joint posterior sampling from the model (only used in benchmarking), this argument can be set to <code>control.compute = list(config = FALSE)</code> to reduce the size of the fitted object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.inla</code></td>
<td>
<p>list of options to be passed to control.inla() in the inla() function. Default to the "adaptive" integration strategy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.fixed</code></td>
<td>
<p>list of options to be passed to control.fixed() in the inla() function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicator to print out detailed inla() intermediate steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geo</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Deprecated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of fitted object
</p>


<h3>Author(s)</h3>

<p>Zehang Richard Li
</p>


<h3>References</h3>

<p>Li, Z., Hsiao, Y., Godwin, J., Martin, B. D., Wakefield, J., Clark, S. J., &amp; with support from the United Nations Inter-agency Group for Child Mortality Estimation and its technical advisory group. (2019). <em>Changes in the spatial distribution of the under-five mortality rate: Small-area analysis of 122 DHS surveys in 262 subregions of 35 countries in Africa.</em> PloS one, 14(1), e0210645.
</p>
<p>Mercer, L. D., Wakefield, J., Pantazis, A., Lutambi, A. M., Masanja, H., &amp; Clark, S. (2015). <em>Space-time smoothing of complex survey data: small area estimation for child mortality.</em> The annals of applied statistics, 9(4), 1889.
</p>


<h3>See Also</h3>

<p><code>getDirect</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  years &lt;- levels(DemoData[[1]]$time)
  # obtain direct estimates
  data_multi &lt;- getDirectList(births = DemoData, years = years,
  regionVar = "region",  timeVar = "time", clusterVar = "~clustid+id",
  ageVar = "age", weightsVar = "weights", geo.recode = NULL)
  data &lt;- aggregateSurvey(data_multi)
  
  #  national model
  years.all &lt;- c(years, "15-19")
  fit1 &lt;- smoothDirect(data = data, Amat = NULL, 
  year_label = years.all, year_range = c(1985, 2019), 
  time.model = 'rw2', m = 5, control.compute = list(config =TRUE))
  out1 &lt;- getSmoothed(fit1)
  plot(out1)
  
  #  subnational model
  fit2 &lt;- smoothDirect(data = data, Amat = DemoMap$Amat, 
  year_label = years.all, year_range = c(1985, 2019), 
  time.model = 'rw2', m = 5, type.st = 4)
  out2 &lt;- getSmoothed(fit2)
  plot(out2)
  
  #  subnational space-only model for one period
  fit3 &lt;- smoothDirect(data = subset(data, years == "10-14"), 
           time.model = NULL, Amat = DemoMap$Amat)
  out3 &lt;- getSmoothed(fit3)
  plot(out3, plot.CI = TRUE)

## End(Not run)
</code></pre>


</div>