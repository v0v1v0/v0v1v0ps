<div class="container">

<table style="width: 100%;"><tr>
<td>SUNdistr-base</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Unified Skew-Normal (SUN) probability distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, random number generation, the mean value,
the variance-covariance matrix and the Mardia's measures  of multivariate
skewness and kurtosis of the <abbr><span class="acronym">SUN</span></abbr> probability distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dsun(x, xi, Omega, Delta, tau, Gamma, dp = NULL, log = FALSE, silent=FALSE, ...)
psun(x, xi, Omega, Delta, tau, Gamma, dp = NULL, log = FALSE, silent=FALSE, ...)
rsun(n=1, xi, Omega, Delta, tau, Gamma, dp = NULL, silent=FALSE)
sunMean(xi, Omega, Delta, tau, Gamma, dp = NULL, silent=FALSE, ...)
sunVcov(xi, Omega, Delta, tau, Gamma, dp = NULL, silent=FALSE, ...)
sunMardia(xi, Omega, Delta, tau, Gamma, dp = NULL, silent=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a vector of length <code>d</code>, where <code>d=ncol(Omega)</code>,
with the coordinates of the point where the density or the
distribution function must be evaluated, or alternatively
a <code>d</code>-column matrix whose rows represent a set of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>a numeric vector of length <code>d</code> representing the 
location parameter of the distribution; see ‘Background’.
In a call to <code>dsun</code> and <code>psun</code>, <code>xi</code> can be a matrix,
whose rows represent a set of location parameters;
in this case, its dimensions must match those of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>a symmetric positive definite matrix of dimension <code>(d,d)</code>;
see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>a matrix of size <code>(d,m)</code>, where <code>m=length(tau)</code>;
see ‘Details’ about its constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a vector of length <code>m</code>, say.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>a symmetric positive definite matrix of dimension <code>(m,m)</code>
with 1's on its main diagonal, that is, a correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p>a list with five elements, representing <code>xi</code> 
(which must be a vector in this case), 
<code>Omega</code>, <code>Delta</code>, <code>tau</code> and <code>Gamma</code>, 
with restrictions indicated in the ‘Details’.
Its default value is <code>NULL</code>;  if <code>dp</code> is assigned, 
the individual parameters must not be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a logical value (default value: <code>FALSE</code>); 
if <code>TRUE</code>, log-densities and log-probabilities are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>a logical value which indicates the action to take in the case
<code>m=1</code>, which could be more convenently handled by functions for the
<abbr><span class="acronym">SN/ESN</span></abbr> family. If <code>silent=FALSE</code> (default value), a warning
message is issued; otherwise this is suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional tuning arguments passed either to 
<code>pmnorm</code> (for <code>dsun</code>, 
<code>psun</code> and <code>sunMean</code>) or to <code>mom.mtruncnorm</code> 
(for <code>sunVcov</code> and <code>sunMardia</code>); see also ‘Details’. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A member of the <abbr><span class="acronym">SUN</span></abbr> family of distributions is identified by five 
parameters, which are described  in the ‘Background’ section.  
The five parameters can be supplied by combining them in a list, denoted
<code>dp</code>, in which case the individual parameters must <em>not</em> be
supplied. The elements of <code>dp</code> must appear in the above-indicated order
and must be named.
</p>
<p>The optional arguments in <code>...</code> passed to <code>pmnorm</code>,
which uses <code>ptriv.nt</code> when <code>d=3</code>, 
<code>biv.nt.prob</code> when <code>d=2</code> and 
and <code>sadmvn</code> when <code>d&gt;2</code>.
In practice these arguments are effective only if <code>d&gt;3</code>, 
since for lower dimensions the computations are made to full available 
precision anyway.
A similar fact applies to the <code>...</code> argument passed to 
<code>mom.mtruncnorm</code>. 
</p>
<p>Some numerical inaccuracy is inevitably involved in these computations.
In most cases,  they are of negligible extent, but they can possibly become
more relevant, especially in the computation of higher order moments
involved by <code>sunMardia</code>, depending on the dimension <code>d</code> and on 
the specific parameter values.
Consider the ‘Warning’ section in <code>recintab</code>
which is used by <code>mom.mtruncnorm</code>. 
</p>
<p>The above-described functions operate following the traditional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> scheme for 
probability distributions. Another scheme, coexisting with the classical one, 
works with <code>SUNdistr-class</code> objects, which represent <abbr><span class="acronym">SUN</span></abbr> 
distributions, by encapsulating their parameters and other characteristics. 
These objects are created by <code>makeSUNdistr</code>, and various methods 
exist for them; see <code>SUNdistr-class</code>. 
Moreover these objects can be manipulated by a number of tools, described 
in <code>SUNdistr-op</code>, leading to new objects of the same class.
</p>


<h3>Value</h3>

<p>The structure of the returned value depends on the called function, as follows:
</p>

<table>
<tr>
<td style="text-align: right;">
 <code>dsun, psun</code>  </td>
<td style="text-align: left;"> a vector of length <code>nrow(x)</code> representing 
                          density or probability values, </td>
</tr>
<tr>
<td style="text-align: right;">
             </td>
<td style="text-align: left;"> or their log-transformed values if <code>log=TRUE</code>,</td>
</tr>
<tr>
<td style="text-align: right;">
 <code>rsun</code> </td>
<td style="text-align: left;"> a matrix of size <code>(n,d)</code>, 
                  where each row represents a <abbr><span class="acronym">SUN</span></abbr> random vectors,</td>
</tr>
<tr>
<td style="text-align: right;">
 <code>sunMean</code> </td>
<td style="text-align: left;"> a vector of length <code>d</code> representing the mean value,</td>
</tr>
<tr>
<td style="text-align: right;">
 <code>sunVcov</code> </td>
<td style="text-align: left;"> a matrix of size <code>(d,d)</code>  representing the 
   variance-covariance matrix,</td>
</tr>
<tr>
<td style="text-align: right;">
 <code>sunMardia</code> </td>
<td style="text-align: left;"> a vector of length two with the Mardia's measures of
   multivariate skewness and kurtosis.
 </td>
</tr>
</table>
<h3>Background</h3>

<p>A member of the <abbr><span class="acronym">SUN</span></abbr> family is characterized by two
dimensionality indices, denoted <code class="reqn">d</code> and <code class="reqn">m</code>, and a set of five
parameters blocks (vector and matrices, as explained soon).  
The value <code class="reqn">d</code> represents the number of observable
components; the value <code class="reqn">m</code> represents the number of latent (or hidden)
variables notionally involved in the construction of the distribution.
The parameters and their corresponding <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> variables are as follows:
</p>

<table>
<tr>
<td style="text-align: right;">
 <code class="reqn">\xi</code>    </td>
<td style="text-align: center;"> <code>xi</code>    </td>
<td style="text-align: left;"> a vector of length <code class="reqn">d</code>, </td>
</tr>
<tr>
<td style="text-align: right;">
 <code class="reqn">\Omega</code> </td>
<td style="text-align: center;"> <code>Omega</code> </td>
<td style="text-align: left;"> a matrix of size <code class="reqn">(d,d)</code>, </td>
</tr>
<tr>
<td style="text-align: right;">
 <code class="reqn">\Delta</code> </td>
<td style="text-align: center;"> <code>Delta</code> </td>
<td style="text-align: left;"> a matrix of size <code class="reqn">(d,m)</code>, </td>
</tr>
<tr>
<td style="text-align: right;">
 <code class="reqn">\tau</code>   </td>
<td style="text-align: center;"> <code>tau</code>   </td>
<td style="text-align: left;"> a vector of length <code class="reqn">m</code>, </td>
</tr>
<tr>
<td style="text-align: right;">
 <code class="reqn">\Gamma</code> </td>
<td style="text-align: center;"> <code>Gamma</code> </td>
<td style="text-align: left;"> a matrix of size <code class="reqn">(m,m)</code>,  
 </td>
</tr>
</table>
<p>and must satisfy the following  conditions:  
</p>

<ol>
<li> <p><code class="reqn">\Omega</code> is a symmetric positive definite matrix;
</p>
</li>
<li> <p><code class="reqn">\Gamma</code> is a symmetric positive definite matrix with 1's 
on the main diagonal, hence a correlation matrix;
</p>
</li>
<li>
<p> if <code class="reqn">\bar\Omega</code>  
denotes the correlation matrix associated to <code class="reqn">\Omega</code>,  
the matrix of size <code class="reqn">(d+m)\times(d+m)</code>
formed by the <code class="reqn">2 x 2</code> blocks
 
</p>

<table>
<tr>
<td style="text-align: right;">
            </td>
<td style="text-align: right;">  </td>
<td style="text-align: center;"> <code class="reqn">\bar\Omega</code>  </td>
<td style="text-align: center;">  <code class="reqn">\Delta</code> </td>
</tr>
<tr>
<td style="text-align: right;">
            </td>
<td style="text-align: right;">  </td>
<td style="text-align: center;"> <code class="reqn">\Delta'</code>  </td>
<td style="text-align: center;">  <code class="reqn">\Gamma</code>  </td>
</tr>
</table>
<p>must be a positive definite correlation matrix.</p>
</li>
</ol>
<p>The formulation adopted here has arisen as the evolution of earlier 
constructions, which are recalled very briefly next.
A number of extensions of the multivariate skew-normal distributions, 
all involving a number <code>m</code> (with <code class="reqn">m\ge1</code>) of latent variables 
(instead of <code>m=1</code> like the skew-normal distribution), 
have been put-forward in close succession in the years 2003-2005. 
Special attention has been drawn by the ‘closed skew-normal (CSN)’
distribution  developed by González-Farías <em>et alii</em> (2004a, 2004b)
and the ‘fundamental skew-normal  (FUSN)’ distribution
developed by Arellano-Valle and Genton (2005),
but other formulations have been considered too.
</p>
<p>Arellano Valle and Azzalini (2006) have shown the essential equivalence
of these apparently alternative constructions, after appropriate
reparameterizations, and underlined the necessity of removing 
over-parameterizations in some cases, to avoid lack of identifiability. 
This elaboration has led to the <abbr><span class="acronym">SUN</span></abbr> formulation. 
A relatively less technical account of their development is provided 
in Section 7.1 of Azzalini and Capitanio (2014), using very slightly 
modified notation and parameterization, which are the ones adopted here.  
</p>
<p>Additional results have been presented by Arellano-Valle 
and Azzalini (2021), such as expressions for the variance matrix
and higher order moments, the Mardia's measures of multivariate  skewness
and kurtosis, which are implemented here. Another result is the
conditional distribution when the conditioning event is represented
by an orthant.
</p>


<h3>Note</h3>

<p>The present structure and user interface of this function, and of other ones 
related to the <abbr><span class="acronym">SUN</span></abbr> distribution, must be considered experimental, 
and they might possibly change in the future.</p>


<h3>Author(s)</h3>

<p>Adelchi Azzalini</p>


<h3>References</h3>

<p>Arellano-Valle, R. B., and Azzalini, A. (2006).
On the unification of families of skew-normal distributions.
<em>Scand. J. Stat.</em> <b>33</b>, 561-574. 
Corrigendum in  <b>49</b> (2022), 1418-1419.
</p>
<p>Arellano-Valle, R. B. and Azzalini, A. (2021).
Some properties of the unified skew-normal distribution.
<em>Statistical Papers</em> <b>63</b>, 461-487,
<a href="https://doi.org/10.1007/s00362-021-01235-2">doi:10.1007/s00362-021-01235-2</a>;
see also <a href="https://arxiv.org/abs/2011.06316">arXiv:2011.06316</a>
</p>
<p>Arellano-Valle, R. B. and Genton, M. G. (2005). 
On fundamental skew distributions. 
<em>J. Multivariate Anal.</em> <b>96</b>, 93–1116.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014). 
<em>The Skew-Normal and Related Families</em>. 
Cambridge University Press, IMS Monographs series.
</p>
<p>González-Farías, G., Domínguez-Molina, J. A., &amp; Gupta, A. K. (2004a). 
Additive properties of skew normal random vectors.
<em>J. Statist. Plann. Inference</em> <b>126</b>, 521-534.
</p>
<p>González-Farías, G., Domínguez-Molina, J. A., &amp; Gupta, A. K. (2004b). 
The closed skew-normal distribution. 
In M. G. Genton (Ed.), <em>Skew-elliptical Distributions and Their 
Applications: a Journey Beyond Normality</em>, Chapter 2, (pp. 25–42). 
Chapman &amp; Hall/<abbr><span class="acronym">CRC</span></abbr>. 
</p>


<h3>See Also</h3>

<p><code>makeSUNdistr</code> to build a <abbr><span class="acronym">SUN</span></abbr> distribution object, 
with related methods in <code>SUNdistr-class</code>,
and other facilities in <code>SUNdistr-op</code>
</p>
<p><code>convertCSN2SUNpar</code> to convert a parameter set of the Closed 
Skew-Normal formulation to the equivalent <abbr><span class="acronym">SUN</span></abbr> parameter set
</p>


<h3>Examples</h3>

<pre><code class="language-R">xi &lt;- c(1, 0, -1)
Omega &lt;- matrix(c(2,1,1, 1,3,1, 1,1,4), 3, 3)
Delta &lt;- matrix(c(0.72,0.20, 0.51,0.42, 0.88, 0.94), 3, 2, byrow=TRUE)
Gamma &lt;- matrix(c(1, 0.8, 0.8, 1), 2, 2)
dp3 &lt;- list(xi=xi, Omega=Omega, Delta=Delta, tau=c(-0.5, 0), Gamma=Gamma)
x &lt;- c(0.8, 0.5, -1.1)
f1 &lt;- dsun(x, xi, Omega, Delta, c(-0.5, 0), Gamma) # mode 1
f2 &lt;- dsun(x, dp=dp3)   # mode 2, equivalent to mode 1
set.seed(1)
xm &lt;- rsun(10, dp=dp3)
f3 &lt;- dsun(xm, dp=dp3) 
psun(xm, dp=dp3)
sunMean(dp=dp3)
sunVcov(dp=dp3)
sunMardia(dp=dp3)
</code></pre>


</div>