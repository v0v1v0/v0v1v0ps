<div class="container">

<table style="width: 100%;"><tr>
<td>psi-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions to extract the individual estimates of the parameters and random
effects</h2>

<h3>Description</h3>

<p>These three functions are used to access the estimates of individual
parameters and random effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psi(object, type = c("mode", "mean"))

phi(object, type = c("mode", "mean"))

eta(object, type = c("mode", "mean"))

## S4 method for signature 'SaemixObject'
psi(object, type = c("mode", "mean"))

## S4 method for signature 'SaemixObject'
phi(object, type = c("mode", "mean"))

## S4 method for signature 'SaemixObject'
eta(object, type = c("mode", "mean"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an SaemixObject object returned by the <code>saemix</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string specifying whether to use the MAP (type="mode") or the mean (type="mean")
of the conditional distribution of the individual parameters. Defaults to mode</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The psi_i represent the individual parameter estimates. In the SAEM
algorithm, these parameters are assumed to be a transformation of a Gaussian
random vector phi_i, where the phi_i can be written as a function of the
individual random effects (eta_i), the covariate matrix (C_i) and the vector
of fixed effects (mu):
</p>
<p>phi_i = C_i mu + eta_i
</p>
<p>More details can be found in the PDF documentation.
</p>


<h3>Value</h3>

<p>a matrix with the individual parameters (psi/phi) or the random effects (eta).
These functions are used to access and output the estimates of
parameters and random effects. When the object passed to the function does
not contain these estimates, they are automatically computed. The object is
then returned (invisibly) with these estimates added to the results.
</p>


<h3>Methods</h3>


<dl>
<dt>list("signature(object = \"SaemixObject\")")</dt>
<dd>
<p> please refer to the PDF
documentation for the models</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Emmanuelle Comets <a href="mailto:emmanuelle.comets@inserm.fr">emmanuelle.comets@inserm.fr</a>, Audrey Lavenu,
Marc Lavielle.
</p>


<h3>References</h3>

<p>E Comets, A Lavenu, M Lavielle M (2017). Parameter estimation in nonlinear mixed effect models using saemix,
an R implementation of the SAEM algorithm. Journal of Statistical Software, 80(3):1-41.
</p>
<p>E Kuhn, M Lavielle (2005). Maximum likelihood estimation in nonlinear mixed effects models.
Computational Statistics and Data Analysis, 49(4):1020-1038.
</p>
<p>E Comets, A Lavenu, M Lavielle (2011). SAEMIX, an R version of the SAEM algorithm. 20th meeting of the
Population Approach Group in Europe, Athens, Greece, Abstr 2173.
</p>


<h3>See Also</h3>

<p><code>SaemixData</code>,<code>SaemixModel</code>,
<code>SaemixObject</code>, <code>saemixControl</code>,
<code>plot.saemix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(theo.saemix)

saemix.data&lt;-saemixData(name.data=theo.saemix,header=TRUE,sep=" ",na=NA, 
  name.group=c("Id"),name.predictors=c("Dose","Time"),
  name.response=c("Concentration"),name.covariates=c("Weight","Sex"),
  units=list(x="hr",y="mg/L",covariates=c("kg","-")), name.X="Time")

model1cpt&lt;-function(psi,id,xidep) { 
	  dose&lt;-xidep[,1]
	  tim&lt;-xidep[,2]  
	  ka&lt;-psi[id,1]
	  V&lt;-psi[id,2]
	  CL&lt;-psi[id,3]
	  k&lt;-CL/V
	  ypred&lt;-dose*ka/(V*(ka-k))*(exp(-k*tim)-exp(-ka*tim))
	  return(ypred)
}

saemix.model&lt;-saemixModel(model=model1cpt,
  description="One-compartment model with first-order absorption", 
  psi0=matrix(c(1.,20,0.5,0.1,0,-0.01),ncol=3, byrow=TRUE,
  dimnames=list(NULL, c("ka","V","CL"))),transform.par=c(1,1,1),
  covariate.model=matrix(c(0,1,0,0,0,0),ncol=3,byrow=TRUE),fixed.estim=c(1,1,1),
  covariance.model=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),
  omega.init=matrix(c(1,0,0,0,1,0,0,0,1),ncol=3,byrow=TRUE),error.model="constant")

saemix.options&lt;-list(algorithm=c(1,0,0),seed=632545,save=FALSE,save.graphs=FALSE, 
displayProgress=FALSE)

# Not run (strict time constraints for CRAN)

saemix.fit&lt;-saemix(saemix.model,saemix.data,saemix.options)
psi(saemix.fit)
phi(saemix.fit)
eta(saemix.fit,type="mean")


</code></pre>


</div>