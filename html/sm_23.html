<div class="container">

<table style="width: 100%;"><tr>
<td>h.select</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Selection of the smoothing parameter
</h2>

<h3>Description</h3>

<p>This function selects a smoothing parameter for density estimation
in one or two dimensions and for nonparametric regression with one
or two covariates.  Several methods of selection are available.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> h.select(x, y = NA, weights = NA, group = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector, or two-column matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector of responses, in regression case.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>a vector of integers representing frequencies of individual
observations.  Use of this parameter is incompatible with
<code>binning</code>; hence <code>nbins</code> must then be set to <code>0</code>
or left at its default value <code>NA</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>a vector of groups indicators (numeric or character values) or
a factor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other optional parameters are passed to the <code>sm.options</code>
function, through a mechanism which limits their effect only to this
call of the function.  There are three which are relevant for this
function, namely <code>method</code>, which specifies the method of
smoothing parameter selection, <code>df</code>, which specifies the
approximate degrees of freedom associated with the selected
smoothing parameter, and <code>structure.2d</code> which determines
the form of the smoothing parameters in the two-dimensional case.
A full description of these arguments are given in the documentation
of <code>sm.options</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>see the two references below for discussion of the methods of
smoothing parameter selection.
</p>
<p>If the sample size is large, binning will be employed.  In the 
case of <code>method = "cv"</code> the answer will therefore be
different from that obtained through the function <code>hcv</code>
where binning is not used.
</p>
<p>When the <code>group</code> argument is set, the chosen method of
smoothing parameter selection is applied to each group and the
value returned is the geometric mean of these.  This is intended
for use in <code>sm.density.compare</code> and
<code>sm.ancova</code>, where
the same smoothing parameter is used for all groups so that
the principal bias terms cancel when the estimates are compared.
</p>


<h3>Value</h3>

<p>the value of the selected smoothing parameter.
</p>


<h3>Side Effects</h3>

<p>none
</p>


<h3>References</h3>

<p>Bowman, A.W. and Azzalini, A. (1997). 
<em>Applied Smoothing Techniques for Data Analysis:</em>
<em>the Kernel Approach with S-Plus Illustrations.</em>
Oxford University Press, Oxford.
</p>
<p>Hurvich, C.M., Simonoff, J.S. and Tsai, C.-L. (1998).
Smoothing parameter selection in nonparametric regression
using an improved Akaike information criterion.
<em>J. R. Statistic. Soc., Series B</em>, 60, 271-293.
</p>


<h3>See Also</h3>

 <p><code>sm</code>,
<code>hcv</code>, <code>hsj</code>, <code>hnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(50)
h.select(x)
h.select(x, method = "sj")

x &lt;- matrix(rnorm(100), ncol = 2)
h.select(x)
sm.density(x, method = "cv")

x &lt;- rnorm(50)
y &lt;- x^2 + rnorm(50)
h.select(x, y)
sm.regression(x, y, method = "aicc")

x &lt;- matrix(rnorm(100), ncol = 2)
y &lt;- x[,1]^2 + x[,2]^2 + rnorm(50)
h.select(x, y, method = "cv", structure.2d = "common")
sm.regression(x, y, df = 8)
</code></pre>


</div>