<div class="container">

<table style="width: 100%;"><tr>
<td>probit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binary choice models.</h2>

<h3>Description</h3>

<p>Binary Choice models.  These models are estimated by
<code>binaryChoice</code>, intended to be called by wrappers like
<code>probit</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">probit(formula, weights = NULL, ...)
binaryChoice(formula, subset, na.action, start = NULL, data = sys.frame(sys.parent()),
             x=FALSE, y = FALSE, model = FALSE, method="ML",
userLogLik=NULL,
             cdfLower, cdfUpper=function(x) 1 - cdfLower(x),
logCdfLower=NULL, logCdfUpper=NULL,
pdf, logPdf=NULL, gradPdf,
maxMethod="Newton-Raphson",
             ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit, in the
form <code>response ~ explanatory variables</code>
(see also details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of ‘prior weights’ 
to be used in the fitting process. Should be NULL or a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain 'NA's.  The default is set by the 'na.action' setting
of 'options', and is 'na.fail' if that is unset.  The
'factory-fresh' default is 'na.omit'.  Another possible value
is 'NULL', no action.  Value 'na.exclude' can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>inital value of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the
model. If not found in data, the
variables are taken from environment(formula), typically the
environment from which <code>probit</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y, model</code></td>
<td>
<p>logicals. If TRUE the corresponding components of
the fit (the
model matrix, the response, the model frame) are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to use; for fitting,
currently only method = "ML" (Maximum Likelihood) is supported;
method = "model.frame" returns the model frame (the same as
with model = TRUE, see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userLogLik</code></td>
<td>
<p>log-likelihood function.  A function of the
parameter to be estimated, which computes
the log likelihood.  If supplied, it will be used instead of
<code>cdfLower</code> and similar parameters.  This allows user to
fine-tune the likelihood function such as introducing robust
approximations.  It might return the corresponding gradient and
Hessian as approximations, see <code>maxNR</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdfLower, cdfUpper, pdf, gradPdf</code></td>
<td>
<p>function, lower and upper tail of the
cumulative distribution function of the disturbance term,
corresponding probability density function, and gradient of the
density function.  These
functions must take a numeric vector as the argument, and return
numeric vector of the probability/gradient values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logCdfLower, logCdfUpper, logPdf</code></td>
<td>
<p>logs of the corresponding
functions.  Providing these may improve precision in extreme tail.
If not provided, simply logs are takes of the corresponding non-log
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxMethod</code></td>
<td>
<p>character, a maximisation method supported by
<code>maxLik</code>.  This is only useful if using
a user-supplied likelihood function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments for <code>binaryChoice</code> and
<code>maxLik</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dependent variable for the binary choice models must have exactly
two levels (e.g. '0' and '1', 'FALSE' and 'TRUE', or 'no' and 'yes').
Internally, the first level is always coded '0' ('failure') and
the second level as '1' ('success'), no matter of the actual value.
However, by default the levels are ordered alphabetically and this
makes puts '1' after '0', 'TRUE' after 'FALSE' nad 'yes' after 'no'.
</p>
<p>Via the distribution function parameters, <code>binaryChoice</code>
supports generic latent linear index binary choice models with
additive disturbance terms.  It is intended to be called by wrappers
like <code>probit</code>.  However, it is also visible in the namespace as
the user may want to implement her own models using another
distribution of the disturbance term.
</p>
<p>The model is estimated using Maximum Likelihood and Newton-Raphson
optimizer.
</p>
<p><code>probit</code> implements an outlier-robust log-likelihood (Demidenko,
2001).  In case of large outliers the analytic Hessian is
singular while Fisher scoring approximation (used, for instance, by
<code>glm</code>) is invertible.  Those values are not
reliable in case of outliers.
</p>
<p>No attempt is made to establish the existence of the
estimator. 
</p>


<h3>Value</h3>

<p>An object of class "binaryChoice".  It is a list with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>LRT</code></td>
<td>
<p>Likelihood ration test.  The full model is tested against
H0: the parameters (besides constant) have no effect on the result.  This is a list
with components
</p>

<ul>
<li>
<p>LRTThe LRT value
</p>
</li>
<li>
<p>dfDegrees of freedom for LRT (= df of the model - 1)
</p>
</li>
</ul>
<p>LRT is distributed by chi2(df) under H0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A list with following background information:
</p>

<ul>
<li>
<p>nParamNumber of parameters of the model including constant
</p>
</li>
<li>
<p>nObsNumber of the observations
</p>
</li>
<li>
<p>N1Number of observations with non-zero (true) response
</p>
</li>
<li>
<p>N0Number of observations with zero (false) response
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>degrees of freedom of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if requested, the model matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if requested, the model response used.  The
response is represented internally as 0/1 integer vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the model frame, only if <code>model = TRUE</code> or
<code>method = "model.frame"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>information returned by <code>model.frame</code> on
the special handling of  NA s.</p>
</td>
</tr>
</table>
<p>Other components are inherited from <code>maxLik</code>.
</p>
<p><code>probit</code> adds class "probit" and following components to
the "binaryChoice" object:
</p>
<table><tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family object used (<code>binomial</code> with
<code>link="probit"</code>)</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Ott Toomet <a href="mailto:otoomet@ut.ee">otoomet@ut.ee</a>, Arne Henningsen</p>


<h3>References</h3>

<p>Demidenko, Eugene (2001) “Computational aspects of probit
model”, Mathematical Communications 6, 233-247
</p>


<h3>See Also</h3>

<p><code>maxLik</code> for ready-packaged likelihood maximisation
routines and methods, <code>glm</code> for generalised linear models,
including probit, <code>binomial</code>, and <code>probit-methods</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## A simple MC trial: note probit assumes normal errors
x &lt;- runif(100)
e &lt;- 0.5*rnorm(100)
y &lt;- x + e
summary(probit((y &gt; 0) ~ x))
## female labour force participation probability
data(Mroz87)
Mroz87$kids &lt;- Mroz87$kids5 &gt; 0 | Mroz87$kids618 &gt; 0
Mroz87$age30.39 &lt;- Mroz87$age &lt; 40
Mroz87$age50.60 &lt;- Mroz87$age &gt;= 50
summary(probit(lfp ~ kids + age30.39 + age50.60 + educ + hushrs +
               huseduc + huswage + mtr + motheduc, data=Mroz87))
</code></pre>


</div>