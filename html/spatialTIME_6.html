<div class="container">

<table style="width: 100%;"><tr>
<td>compute_metrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Count Based Measures and NN Measures of Spatial Clustering for IF data</h2>

<h3>Description</h3>

<p>This function calculates count based Measures (Ripley's K, Besag 
L, and Marcon's M) of IF data to characterize correlation of spatial point
process. For neareast neighbor calculations of a given cell type, this function 
computes proportion of cells that have nearest neighbor less than r for the 
observed and permuted point processes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_metrics(
  mif,
  mnames,
  r_range = seq(0, 100, 50),
  num_permutations = 50,
  edge_correction = c("translation"),
  method = c("K"),
  k_trans = "none",
  keep_perm_dis = FALSE,
  workers = 1,
  overwrite = FALSE,
  xloc = NULL,
  yloc = NULL,
  exhaustive = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mif</code></td>
<td>
<p>An MIF object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mnames</code></td>
<td>
<p>Character vector of marker names to estimate degree of 
spatial clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_range</code></td>
<td>
<p>Numeric vector of potential r values this range must include 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_permutations</code></td>
<td>
<p>Numeric value indicating the number of permutations used. 
Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_correction</code></td>
<td>
<p>Character vector indicating the type of edge correction 
to use. Options for count based include "translation" or "isotropic" and for 
nearest neighboroOptions include "rs" or "hans".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character vector indicating which count based measure (K, BiK, 
G, BiG) used to estimate the degree of spatial clustering. Description of the 
methods can be found in Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_trans</code></td>
<td>
<p>Character value of the transformation to apply to count based 
metrics (none, M, or L)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_perm_dis</code></td>
<td>
<p>Logical value determining whether or not to keep the full 
distribution of permuted K or G values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workers</code></td>
<td>
<p>Integer value for the number of workers to spawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Logical value determining if you want the results to replace the 
current output (TRUE) or be to be appended (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xloc</code></td>
<td>
<p>a string corresponding to the x coordinates. If null the average of 
XMin and XMax will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yloc</code></td>
<td>
<p>a string corresponding to the y coordinates. If null the average of 
YMin and YMax will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exhaustive</code></td>
<td>
<p>whether or not to compute all combinations of markers</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data.frame
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Theoretical CSR</code></td>
<td>
<p>Expected value assuming complete spatial randomnessn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Permuted CSR</code></td>
<td>
<p>Average observed K, L, or M for the permuted point 
process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Observed</code></td>
<td>
<p>Observed valuefor the observed point process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Degree of Clustering Permuted</code></td>
<td>
<p>Degree of spatial clustering where the
reference is the permutated estimate of CSR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Degree of Clustering Theoretical</code></td>
<td>
<p>Degree of spatial clustering where the
reference is the theoretical estimate of CSR</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#Create mif object
library(dplyr)
x &lt;- create_mif(clinical_data = example_clinical %&gt;% 
mutate(deidentified_id = as.character(deidentified_id)),
sample_data = example_summary %&gt;% 
mutate(deidentified_id = as.character(deidentified_id)),
spatial_list = example_spatial,
patient_id = "deidentified_id", 
sample_id = "deidentified_sample")

# Define the set of markers to study
mnames &lt;- c("CD3..Opal.570..Positive","CD8..Opal.520..Positive",
"FOXP3..Opal.620..Positive","CD3..CD8.","CD3..FOXP3.")

# Ripley's K and nearest neighbor G for all markers with a neighborhood size 
# of  10,20,...,100 (zero must be included in the input).


</code></pre>


</div>