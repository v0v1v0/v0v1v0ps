<div class="container">

<table style="width: 100%;"><tr>
<td>nVirginQueensPoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample a number of virgin queens</h2>

<h3>Description</h3>

<p>Sample a number of virgin queens - used when
<code>nFathers = NULL</code> (see <code>SimParamBee$nVirginQueens</code>).
</p>
<p>This is just an example. You can provide your own functions that satisfy
your needs!
</p>


<h3>Usage</h3>

<pre><code class="language-R">nVirginQueensPoisson(colony, n = 1, average = 10)

nVirginQueensTruncPoisson(colony, n = 1, average = 10, lowerLimit = 0)

nVirginQueensColonyPhenotype(
  colony,
  queenTrait = 1,
  workersTrait = 2,
  checkProduction = FALSE,
  lowerLimit = 0,
  simParamBee = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>colony</code></td>
<td>
<p><code>Colony-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, number of samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>numeric, average number of virgin queens</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerLimit</code></td>
<td>
<p>numeric, returned numbers will be above this value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queenTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents queen's effect on the colony phenotype (defined in
<code>SimParamBee</code> - see examples); if <code>NULL</code> then this effect is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workersTrait</code></td>
<td>
<p>numeric (column position) or character (column name), trait
that represents workers's effect on the colony phenotype (defined in
<code>SimParamBee</code> - see examples); if <code>NULL</code> then this effect is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkProduction</code></td>
<td>
<p>logical, does the phenotype depend on the production
status of colony; if yes and production is not <code>TRUE</code>, the result is
above <code>lowerLimit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParamBee</code></td>
<td>
<p><code>SimParamBee</code>, global simulation parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments of <code>mapCasteToColonyPheno</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>nVirginQueensPoisson</code> samples from a Poisson distribution,
which can return a value 0 (that would mean a colony will fail to raise a
single virgin queen after the queen swarms or dies).
</p>
<p><code>nVirginQueensTruncPoisson</code> samples from a truncated Poisson
distribution (truncated at zero) to avoid failure.
</p>
<p><code>nVirginQueensColonyPhenotype</code> returns a number (above
<code>lowerLimit</code>) as a function of colony phenotype, say swarming
tendency. Colony phenotype is provided by
<code>mapCasteToColonyPheno</code>. You need to set up traits
influencing the colony phenotype and their parameters (mean and variances)
via <code>SimParamBee</code> (see examples).
</p>


<h3>Value</h3>

<p>numeric, number of virgin queens
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>nVirginQueensTruncPoisson()</code>: Sample a non-zero number of virgin queens
</p>
</li>
<li> <p><code>nVirginQueensColonyPhenotype()</code>: Sample a non-zero number of virgin queens
based on colony's phenotype, say, swarming tendency
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>SimParamBee</code> field <code>nVirginQueens</code> and
<code>vignette(topic = "QuantitativeGenetics", package = "SIMplyBee")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">nVirginQueensPoisson()
nVirginQueensPoisson()
n &lt;- nVirginQueensPoisson(n = 1000)
hist(n, breaks = seq(from = min(n), to = max(n)), xlim = c(0, 30))
table(n)

nVirginQueensTruncPoisson()
nVirginQueensTruncPoisson()
n &lt;- nVirginQueensTruncPoisson(n = 1000)
hist(n, breaks = seq(from = min(n), to = max(n)), xlim = c(0, 30))
table(n)

# Example for nVirginQueensColonyPhenotype()
founderGenomes &lt;- quickHaplo(nInd = 3, nChr = 1, segSites = 100)
SP &lt;- SimParamBee$new(founderGenomes)

# Setting trait scale such that mean is 10 split into queen and workers effects
meanP &lt;- c(5, 5 / SP$nWorkers)
# setup variances such that the total phenotype variance will match the mean
varA &lt;- c(3 / 2, 3 / 2 / SP$nWorkers)
corA &lt;- matrix(data = c(
  1.0, -0.5,
  -0.5, 1.0
), nrow = 2, byrow = TRUE)
varE &lt;- c(7 / 2, 7 / 2 / SP$nWorkers)
varA / (varA + varE)
varP &lt;- varA + varE
varP[1] + varP[2] * SP$nWorkers
SP$addTraitA(nQtlPerChr = 100, mean = meanP, var = varA, corA = corA)
SP$setVarE(varE = varE)
basePop &lt;- createVirginQueens(founderGenomes)
drones &lt;- createDrones(x = basePop[1], nInd = 50)
droneGroups &lt;- pullDroneGroupsFromDCA(drones, n = 2, nDrones = 15)
colony1 &lt;- createColony(x = basePop[2])
colony2 &lt;- createColony(x = basePop[3])
colony1 &lt;- cross(colony1, drones = droneGroups[[1]])
colony2 &lt;- cross(colony2, drones = droneGroups[[2]])
colony1 &lt;- buildUp(colony1)
colony2 &lt;- buildUp(colony2)
nVirginQueensColonyPhenotype(colony1)
nVirginQueensColonyPhenotype(colony2)
</code></pre>


</div>