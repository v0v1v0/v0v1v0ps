<div class="container">

<table style="width: 100%;"><tr>
<td>validate_get_twcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check if color data are valid and get TWCV</h2>

<h3>Description</h3>

<p>Checks if passed color data are valid, i. e. are bountiful
and varied enough according to passed validation criteria. This function
is normally only used indirectly through
'Participant$check_valid_get_twcv()' or 'ParticipantGroup$get_valid_twcv()'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">validate_get_twcv(
  color_matrix,
  dbscan_eps = 20,
  dbscan_min_pts = 4,
  max_var_tight_cluster = 150,
  max_prop_single_tight_cluster = 0.6,
  safe_num_clusters = 3,
  safe_twcv = 250
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>color_matrix</code></td>
<td>
<p>An n-by-3 numerical matrix where each
row corresponds to a single point in 3D color space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbscan_eps</code></td>
<td>
<p>One-element numerical vector: radius of
‘epsilon neighborhood’ when applying DBSCAN clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbscan_min_pts</code></td>
<td>
<p>One-element numerical vector:
Minimum number of points required in the epsilon neighborhood
for core points (including the core point itself).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_var_tight_cluster</code></td>
<td>
<p>One-element numerical vector:
maximum variance for a cluster to be considered 'tight-knit'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_prop_single_tight_cluster</code></td>
<td>
<p>One-element numerical vector:
maximum proportion of points allowed to be within a 'tight-knit' cluster
(if this threshold is exceeded, the data are categorized as invalid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>safe_num_clusters</code></td>
<td>
<p>One-element numerical vector: minimum number of
clusters that guarantees validity if points are 'non-tight-knit'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>safe_twcv</code></td>
<td>
<p>One-element numerical vector: minimum total
within-cluster variance (TWCV) score that guarantees validity if
points are 'non-tight-knit'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>valid</code></td>
<td>
<p>One-element logical vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reason_invalid</code></td>
<td>
<p>One-element character vector, empty if valid is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twcv</code></td>
<td>
<p>One-element numeric (or NA if can't be calculated) vector,
indicating TWCV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_clusters</code></td>
<td>
<p>One-element numeric (or NA if can't be calculated)
vector, indicating the number of identified clusters counting toward the
tally compared with 'safe_num_clusters'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function relies heavily on the DBSCAN algorithm and its implementation
in the R package 'dbscan', for clustering color points. For further
information regarding the 'dbscan_eps' and
'dbscan_min_pts' parameters as well as DBSCAN itself, please see
the 'dbscan' documentation. Once clustering is done, passed validation
criteria are applied:
</p>

<ul>
<li>
<p> If too high a proportion of all color points (cut-off specified with
‘max_prop_single_tight_cluster') fall within a single ’tight-knit' cluster
(with a cluster variance less than or equal to 'max_var_tight_cluster'),
then the data are always classified as invalid.
</p>
</li>
<li>
<p> If the first criterion is cleared, <em>and</em> points form more than
'safe_num_cluster' clusters, data are always classified as valid.
</p>
</li>
<li>
<p> If the first criterion is cleared, <em>and</em> the Total Within-Cluster
Variance (TWCV) score is greater than or equal to 'safe_twcv', data are
always classified as valid.
</p>
</li>
</ul>
<p>Note that this means data can be classified as valid by either having
at least 'safe_num_cluster' clusters, <em>or</em> by having points composing
a smaller number of clusters but spaced relatively far apart
<em>within</em> these clusters.
</p>
<p>The DBSCAN 'noise' cluster only counts towards the 'cluster tally' 
(compared with 'safe_num_cluster') if it includes at least 'dbscan_min_pts' points.
Points in the noise cluster are however always included in
other calculations, e. g. total within-cluster variance (TWCV).
</p>


<h3>See Also</h3>

<p><code>point_3d_variance</code> for single-cluster variance,
<code>total_within_cluster_variance</code> for TWCV.
</p>


</div>