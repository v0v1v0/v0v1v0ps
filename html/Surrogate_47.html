<div class="container">

<table style="width: 100%;"><tr>
<td>ICA.ContCont.MultS.PC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, by simulating correlation matrices using an algorithm based on partial correlations</h2>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS</code> quantifies surrogacy in the single-trial causal-inference framework  where T is continuous and there are multiple continuous S. This function provides an alternative for <code>ICA.ContCont.MultS</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">ICA.ContCont.MultS.PC(M=1000,N,Sigma,Seed=123,Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code> (in this order, the <code class="reqn">T_0</code> and <code class="reqn">T_1</code> data should be in <code>Sigma[c(1,2), c(1,2)]</code>, the <code class="reqn">S_{10}</code> and <code class="reqn">S_{11}</code> data should be in <code>Sigma[c(3,4), c(3,4)]</code>, and so on). The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
                                       \sigma_{T_{0}T_{0}}\\
                                       \sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
                                       \sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
                                       \sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
                                       \sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
                                       \sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
                                       ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
                                       \sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
                                       \sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
                                       \end{array}\right)</code>
</p>

<p>The identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled using an algorithm based on partial correlations (PC). In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). The PC algorithm generate each correlation matrix progressively based on parameterization of terms of the correlations <code class="reqn">\rho_{i,i+1}</code>, for <code class="reqn">i=1,\ldots,d-1</code>, and the partial correlations <code class="reqn">\rho_{i,j|i+1,\ldots,j-1}</code>, for <code class="reqn">j-i&gt;2</code> (for details, see Joe, 2006 and Florez et al., 2018). Based on the identifiable variances, these correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated (for details, see Van der Elst et al., 2017).
</p>
<p>This approach to simulate the unidentifiable parameters of <code class="reqn">\boldsymbol{\Sigma}</code> is computationally more efficient than the one used in the function <code>ICA.ContCont.MultS</code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS.PC</code> with components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alvaro Florez
</p>


<h3>References</h3>

<p>Florez, A., Alonso, A. A., Molenberghs, G. &amp; Van der Elst, W. (2018). Simulation of random correlation matrices with fixed values: comparison of algorithms and application on multiple surrogates assessment.
</p>
<p>Joe, H. (2006). Generating random correlation matrices based on partial correlations. <em>Journal of Multivariate Analysis, 97(10)</em>:2177-2189.
</p>
<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code>MICA.ContCont</code>, <code>ICA.ContCont</code>, <code>Single.Trial.RE.AA</code>, 
<code>plot Causal-Inference ContCont</code>, <code>ICA.ContCont.MultS</code>, <code>ICA.ContCont.MultS_alt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:  
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like (NA indicates unidentified covariances):
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS.PC(M=1000, N=200, Show.Progress = TRUE,
Sigma=s, Seed=c(123))

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>


</div>