<div class="container">

<table style="width: 100%;"><tr>
<td>SimTestRat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simultaneous Tests for General Contrasts (Ratios) of Means of Multiple 
Endpoints </h2>

<h3>Description</h3>

<p>Simultaneous tests for general contrasts (linear functions) of normal means (e.g.,
"Dunnett", "Tukey", "Williams" ect.), and for single or multiple endpoints 
(primary response variables) simultaneously. The procedure of Hasler and Hothorn 
(2012) &lt;doi:10.1080/19466315.2011.633868&gt; is applied for ratios of means of 
normally distributed data. The variances/ covariance matrices of the treatment 
groups (containing the covariances between the endpoints) may be assumed to be 
equal or possibly unequal for the different groups (Hasler, 2014 
&lt;doi:10.1515/ijb-2012-0015&gt;). For the case of only a single endpoint and unequal 
covariance matrices (variances), the procedure coincides with the PI procedure of 
Hasler and Hothorn (2008) &lt;doi:10.1002/bimj.200710466&gt;.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
SimTestRat(data, grp, resp = NULL, na.action = "na.error", type = "Dunnett", 
  base = 1, Num.Contrast = NULL, Den.Contrast = NULL, alternative = "two.sided", 
  Margin = 1, covar.equal = FALSE, CorrMatDat = NULL, ...)
## S3 method for class 'formula'
SimTestRat(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data frame containing a grouping variable and the endpoints as
columns </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p> a character string with the name of the grouping variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p> a vector of character strings with the names of the endpoints; if
<code>resp=NULL</code> (default), all column names of the data frame
without the grouping variable are chosen automatically </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a formula specifying a numerical response and a grouping factor 
(e.g. <kbd>response ~ treatment</kbd>)  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> a character string indicating what should happen when the data 
contain <code>NAs</code>;
if <code>na.action="na.error"</code> (default) the procedure stops 
with an error message; if <code>na.action="multi.df"</code> a new 
experimental version is used (details will follow soon) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character string, defining the type of contrast, with the following
options:
</p>

<ul>
<li>
<p> "Dunnett": many-to-one comparisons
</p>
</li>
<li>
<p> "Tukey": all-pair comparisons
</p>
</li>
<li>
<p> "Sequen": comparisons of consecutive groups
</p>
</li>
<li>
<p> "AVE": comparison of each group with average of all others
</p>
</li>
<li>
<p> "GrandMean": comparison of each group with grand mean of all
groups
</p>
</li>
<li>
<p> "Changepoint": differences of averages of groups of higher
order to averages of groups of lower order
</p>
</li>
<li>
<p> "Marcus": Marcus contrasts
</p>
</li>
<li>
<p> "McDermott": McDermott contrasts
</p>
</li>
<li>
<p> "Williams": Williams trend tests
</p>
</li>
<li>
<p> "UmbrellaWilliams": Umbrella-protected Williams trend tests
</p>
</li>
</ul>
<p>note that <code>type</code> is ignored if <code>Num.Contrast</code> or 
<code>Den.Contrast</code> is specified by the user (see below) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p> a single integer specifying the control group for Dunnett contrasts,
ignored otherwise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Num.Contrast</code></td>
<td>
<p> a numerator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Den.Contrast</code></td>
<td>
<p> a denominator contrast matrix, where columns correspond to
groups and rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
or <code>"less"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Margin</code></td>
<td>
<p> a single numeric value, or a numeric vector corresponding to
endpoints, or a matrix where columns correspond to endpoints and
rows correspond to contrasts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.equal</code></td>
<td>
<p> a logical variable indicating whether to treat the variances/ 
covariance matrices of the treatment groups (containing the 
covariances between the endpoints) as being equal;
if <code>TRUE</code> then the pooled variance/ covariance matrix is 
used, otherwise the Satterthwaite approximation to the degrees 
of freedom is used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatDat</code></td>
<td>
<p> a correlation matrix of the endpoints, if <code>NULL</code> (default) 
it is estimated from the data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments to be passed to SimTestRat.default </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The interest is in simultaneous tests for several linear combinations (contrasts) of
treatment means in a one-way ANOVA model, and for single or multiple endpoints 
simultaneously. For example, the all-pair comparison of Tukey (1953) and the many-
to-one comparison of Dunnett (1955) are implemented, but allowing for 
heteroscedasticity and multiple endpoints, and in terms of ratios of means. The user 
is also free to create other interesting problem-specific contrasts. Approximate 
multivariate <em>t</em>-distributions are used to calculate (adjusted) <em>p</em>-values 
(Hasler and Hothorn, 2012 &lt;doi:10.1080/19466315.2011.633868&gt;). This approach 
controls the familywise error rate in admissible ranges and in the strong sense. The 
variances/ covariance matrices of the treatment groups (containing the covariances 
between the endpoints) can be assumed to be equal (<code>covar.equal=TRUE</code>) or 
unequal (<code>covar.equal=FALSE</code>). If being equal, the pooled variance/ covariance 
matrix is used, otherwise approximations to the degrees of freedom (Satterthwaite, 
1946) are used (Hasler, 2014 &lt;doi:10.1515/ijb-2012-0015&gt;; Hasler and Hothorn, 2008 
&lt;doi:10.1002/bimj.200710466&gt;). Unequal covariance matrices occure if variances or 
correlations of some endpoints differ depending on the treatment groups.
</p>


<h3>Value</h3>

<p>An object of class SimTest containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> a matrix of estimated differences </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p> a matrix of the calculated test statistics </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val.raw</code></td>
<td>
<p> a matrix of raw <em>p</em>-values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val.adj</code></td>
<td>
<p> a matrix of <em>p</em>-values adjusted for multiplicity </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatDat</code></td>
<td>
<p> if not prespecified by <code>CorrMatDat</code>, either the estimated 
common correlation matrix of the endpoints 
(<code>covar.equal=TRUE</code>) or a list of different (one for each 
treatment) estimated correlation matrices of the endpoints 
(<code>covar.equal=FALSE</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CorrMatComp</code></td>
<td>
<p> the estimated correlation matrix of the comparisons </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degr.fr</code></td>
<td>
<p> a matrix of degrees of freedom </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>By default (<code>na.action="na.error"</code>), the procedure stops if there are 
missing values. A new experimental version for missing values is used if 
<code>na.action="multi.df"</code>. If <code>covar.equal=TRUE</code>, the number of endpoints 
must not be greater than the total sample size minus the number of treatment 
groups. If <code>covar.equal=FALSE</code>, the number of endpoints must not be greater 
than the minimal sample size minus 1. Otherwise the procedure stops.
</p>
<p>All hypotheses are tested with the same test direction for all comparisons and
endpoints (<code>alternative="..."</code>). In case of doubt, use <code>"two.sided"</code>.
</p>
<p>If <code>Margin</code> is a single numeric value or a numeric vector, then the same
value(s) are used for the remaining comparisons or endpoints.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler </p>


<h3>References</h3>

<p>Hasler, M. (2014): Multiple contrast tests for multiple endpoints in the presence of 
heteroscedasticity. <em>The International Journal of Biostatistics</em> 10, 17–28, 
&lt;doi:10.1515/ijb-2012-0015&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2012): A multivariate Williams-type trend procedure.
<em>Statistics in Biopharmaceutical Research</em> 4, 57–65, &lt;doi:10.1080/19466315.2011.633868&gt;.
</p>
<p>Hasler, M. and Hothorn, L.A. (2008): Multiple contrast tests in the presence of
heteroscedasticity. <em>Biometrical Journal</em> 50, 793–800, &lt;doi:10.1002/bimj.200710466&gt;.
</p>
<p>Dilba, G. et al. (2006): Simultaneous confidence sets and confidence intervals for
multiple ratios. <em>Journal of Statistical Planning and Inference</em> 136, 2640–2658,
&lt;doi:10.1016/j.jspi.2004.11.009&gt;.
</p>


<h3>See Also</h3>

 <p><code>SimCiRat</code>, <code>SimTestDiff</code>, 
<code>SimCiDiff</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1:
# A comparison of the groups B and H against the standard S, for endpoint
# Thromb.count, assuming unequal variances for the groups. This is an
# extension of the well-known Dunnett-test to the case of heteroscedasticity 
# and in terms of ratios of means instead of differences.

data(coagulation)

comp1 &lt;- SimTestRat(data=coagulation, grp="Group", resp="Thromb.count",
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
comp1

# Example 2:
# A comparison of the groups B and H against the standard S, simultaneously
# for all endpoints, assuming unequal covariance matrices for the groups. This is
# an extension of the well-known Dunnett-test to the case of heteroscedasticity
# and multiple endpoints and in terms of ratios of means instead of differences.

data(coagulation)

comp2 &lt;- SimTestDiff(data=coagulation, grp="Group", resp=c("Thromb.count","ADP","TRAP"),
  type="Dunnett", base=3, alternative="greater", covar.equal=FALSE)
summary(comp2)
</code></pre>


</div>