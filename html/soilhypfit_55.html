<div class="container">

<table style="width: 100%;"><tr>
<td>wc_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Models for Soil Water Retention Curves
</h2>

<h3>Description</h3>

<p>The functions <code>sat_model</code> and <code>wc_model</code> compute, for given
capillary pressure head <code class="reqn">h</code>, the volumetric water saturation
<code class="reqn">S(h)</code> and the volumetric water content <code class="reqn">\theta(h)</code>,
respectively, of a soil by parametrical models.  </p>


<h3>Usage</h3>

<pre><code class="language-R">sat_model(h, nlp, precBits = NULL, wrc_model = "vg")

wc_model(h, nlp, lp, precBits = NULL, wrc_model = "vg")

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a mandatory numeric vector with values of capillary pressure
head for which to compute the volumetric water saturation or content.
For consistency with other quantities, the unit of pressure head
should be <b>meter</b> [m].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlp</code></td>
<td>
<p>a mandatory named numeric vector, currently with elements
named <code>"alpha"</code> and <code>"n"</code>, which are the <em>nonlinear</em>
parameters <code class="reqn">\boldsymbol{\nu}^\mathrm{T} = (\alpha, n)</code>, where <code class="reqn">\alpha</code> and <code class="reqn">n</code>
are the inverse air entry pressure and the shape parameter, see
<em>Details</em>.  For consistency with other quantities, the unit of
<code class="reqn">\alpha</code> should be <b>1/meter</b> [<code class="reqn">\mathrm{m}^{-1}</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lp</code></td>
<td>
<p>a mandatory named numeric vector, currently with elements named
<code>"thetar"</code> and <code>"thetas"</code>, which are the <em>linear</em>
parameters <code class="reqn">\boldsymbol{\mu}^\mathrm{T} = (\theta_r, \theta_s)</code> where
<code class="reqn">\theta_r</code> and <code class="reqn">\theta_s</code> are the residual and saturated water
content, respectively, see <em>Details</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precBits</code></td>
<td>
<p>an optional integer scalar defining the maximal precision
(in bits) to be used in high-precision computations by
<code>mpfr</code>.  If equal to <code>NULL</code> (default) then
<code>mpfr</code> is not used and the result of the function call
is of storage mode <code>double</code>, see <code>soilhypfitIntro</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrc_model</code></td>
<td>
<p>a keyword denoting the parametrical model for the
water retention curve.  Currently, only the <em>Van Genuchten model</em>
(<code>wrc_model = "vg"</code>) is implemented, see <em>Details</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions <code>sat_model</code> and <code>wc_model</code> currently model soil
water retention curves only by the simplified form of the model by
<cite>Van Genuchten (1980)</cite> with the restriction <code class="reqn">m = 1 - \frac{1}{n}</code>, i.e.

</p>
<p style="text-align: center;"><code class="reqn">
  S_\mathrm{VG}(h; \boldsymbol{\nu}) = (
  1 + (\alpha \ h)^n)^\frac{1-n}{n}
</code>
</p>


<p style="text-align: center;"><code class="reqn">
  \theta_\mathrm{VG}(h; \boldsymbol{\mu}, \boldsymbol{\nu}) =
	\theta_r + (\theta_s - \theta_r) \, S_\mathrm{VG}(h; \boldsymbol{\nu})
</code>
</p>


<p>where <code class="reqn">\boldsymbol{\mu}^\mathrm{T} = (\theta_r, \theta_s)</code> are the residual and
saturated water content (<code class="reqn">0 \le \theta_r \le \theta_s \le 1</code>),
respectively, and <code class="reqn">\boldsymbol{\nu}^\mathrm{T} = (\alpha, n)</code> are the inverse air
entry pressure (<code class="reqn">\alpha &gt; 0</code>) and the shape parameter (<code class="reqn">n &gt; 1</code>).
</p>
<p>Note that <code class="reqn">\boldsymbol{\mu}^\mathrm{} </code> and
<code class="reqn">\boldsymbol{\nu}^\mathrm{} </code> are passed to the functions by
the arguments <code>lp</code> and <code>nlp</code>, respectively.</p>


<h3>Value</h3>

<p>A numeric vector with values of volumetric water saturation
(<code>sat_model</code>) or water content (<code>wc_model</code>).
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Van Genuchten, M. Th.  (1980) A closed-form equation for predicting the
hydraulic conductivity of unsaturated soils. <em>Soil Science Society of
America Journal</em>, <b>44</b>, 892â€“898,
<a href="https://doi.org/10.2136/sssaj1980.03615995004400050002x">doi:10.2136/sssaj1980.03615995004400050002x</a>.
</p>


<h3>See Also</h3>

<p><code>soilhypfitIntro</code> for a description of the models and a brief
summary of the parameter estimation approach;
</p>
<p><code>fit_wrc_hcc</code> for (constrained) estimation of parameters of
models for soil water retention and hydraulic conductivity data;
</p>
<p><code>control_fit_wrc_hcc</code> for options to control
<code>fit_wrc_hcc</code>;
</p>
<p><code>soilhypfitmethods</code> for common S3 methods for class
<code>fit_wrc_hcc</code>;
</p>
<p><code>vcov</code> for computing (co-)variances of the estimated
nonlinear parameters;
</p>
<p><code>prfloglik_sample</code> for profile loglikelihood
computations;
</p>




<p><code>evaporative-length</code> for physically constraining parameter
estimates of soil hydraulic material functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## define capillary pressure head (unit meters)
h &lt;- c(0.01, 0.1, 0.2, 0.3, 0.5, 1., 2., 5.,10.)

## compute water saturation and water content
sat &lt;- sat_model(h, nlp = c(alpha = 1.5, n = 2))
theta &lt;- wc_model(
  h ,nlp = c(alpha = 1.5, n = 2), lp = c(thetar = 0.1, thetas = 0.5))

## display water retention curve
op &lt;- par(mfrow = c(1, 2))
plot(sat ~ h, log = "x", type = "l")
plot(theta ~ h, log = "x", type = "l")
on.exit(par(op))
</code></pre>


</div>