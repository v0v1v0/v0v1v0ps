<div class="container">

<table style="width: 100%;"><tr>
<td>sp.mantel.mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mantel-Hubert spatial general cross product statistic</h2>

<h3>Description</h3>

<p>A permutation test for the spatial general cross product statistic with
Moran (<code class="reqn">C_{ij} = z_i z_j</code>), Geary 
(<code class="reqn">C_{ij} = (z_i - z_j)^2</code>), and Sokal 
(<code class="reqn">C_{ij} = |z_i - z_j|</code>) criteria, for
<code class="reqn">z_i = (x_i - \bar{x}) / \sigma_{x}</code>.
<code>plot.mc.sim</code> is a helper function to plot the outcomes of the
permutation test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sp.mantel.mc(var, listw, nsim, type = "moran", zero.policy = attr(listw, "zero.policy"),
 alternative = "greater", spChk=NULL, return_boot=FALSE)
## S3 method for class 'mc.sim'
plot(x, xlim, xlab, main, sub, ..., ptype="density")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>a numeric vector the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>"moran", "geary" or "sokal" criteria for similarity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, 
must be one of "greater" (default), "two.sided", or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_boot</code></td>
<td>
<p>return an object of class <code>boot</code> from the equivalent permutation bootstrap rather than an object of class <code>htest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the object to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the range of the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a title for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>an overall title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>a sub title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p>either "density" or "hist"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed through</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with class <code>htest</code> and <code>mc.sim</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the observed Geary's C.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the rank of the observed Geary's C.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string giving the method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data, and the 
number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the pseudo p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>nsim simulated values of statistic, final value is observed 
statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the mean and variance of the simulated distribution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 22-24,
Haining, R. 1990 <em>Spatial data analysis in the social
and environmental sciences</em>, Cambridge: Cambridge University Press, p. 230â€“1.
The function has been checked against general matrix code posted to the 
r-help list by Ben Bolker on 1 May 2001; another <code>mantel()</code> function
is in the vegan package.</p>


<h3>See Also</h3>

<p><code>moran.mc</code>, <code>joincount.mc</code>, 
<code>geary.mc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(oldcol)
sim1 &lt;- sp.mantel.mc(COL.OLD$CRIME, nb2listw(COL.nb),
 nsim=99, type="geary", alternative="two.sided")
sim1
plot(sim1)
sp.mantel.mc(COL.OLD$CRIME, nb2listw(COL.nb), nsim=99,
 type="sokal", alternative="two.sided")
sp.mantel.mc(COL.OLD$CRIME, nb2listw(COL.nb), nsim=99,
 type="moran")
</code></pre>


</div>