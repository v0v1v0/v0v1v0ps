<div class="container">

<table style="width: 100%;"><tr>
<td>scam.control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Setting SCAM fitting defaults</h2>

<h3>Description</h3>

<p> This is an internal function of package <code>scam</code> which allows 
control of the numerical options for fitting a SCAM. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">scam.control(maxit = 200, maxHalf=30, devtol.fit=1e-7, steptol.fit=1e-7,
            keepData=FALSE,efs.lspmax=15,efs.tol=.1, nlm=list(),optim=list(),
            bfgs=list(), trace =FALSE, print.warn=FALSE,b.notexp=1, threshold.notexp=20) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of IRLS iterations to perform used in <code>scam.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxHalf</code></td>
<td>
<p>If a step of  the BFGS optimization method leads 
to a worse penalized deviance, then the step length of the model coefficients is halved. This is
the number of halvings to try before giving up used in <code>bfgs_gcv.ubre</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>devtol.fit</code></td>
<td>
<p>A positive scalar giving the convergence control for the model fitting algorithm in <code>scam.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol.fit</code></td>
<td>
<p>A positive scalar giving the tolerance at which the scaled distance between
two successive iterates is considered close enough to zero to terminate the model fitting algorithm in <code>scam.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepData</code></td>
<td>
<p>Should a copy of the original <code>data</code> argument be kept in the <code>scam</code> 
object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efs.lspmax</code></td>
<td>
<p>maximum log smoothing parameters to allow under extended Fellner Schall
smoothing parameter optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efs.tol</code></td>
<td>
<p>change in GCV to count as negligible when testing for EFS convergence. If the
step is small and the last 3 steps led to a GCV change smaller than this, then stop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlm</code></td>
<td>
<p>list of control parameters to pass to <code>nlm</code> if this is
used for outer estimation of smoothing parameters (not default). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>list of control parameters to pass to <code>optim</code> if this
is used for outer estimation of smoothing parameters (not default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bfgs</code></td>
<td>
<p>list of control parameters to pass to default BFGS optimizer
used for outer estimation of log smoothing parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>turns on or off some de-bugging information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.warn</code></td>
<td>
<p> when set to <code>FALSE</code> turns off printing warning messages for step halving under non-finite exponentiated coefficients,  non-finite deviance and/or if <code>mu</code> or <code>eta</code> are out of bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.notexp</code></td>
<td>
<p>parameter <code>b</code> of the model coefficients re-parameterization <code>softPlus()</code> function used as the <code>notExp()</code> function in place of <code>exp()</code> to ensure positivity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.notexp</code></td>
<td>
<p>parameter <code>threshold</code> of the <code>softPlus()</code> function used as the <code>notExp()</code> function. The implementation reverts to the linear function when <code>coef*b &gt; threshold</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Outer iteration is used to estimate smoothing parameters of SCAM by GCV/UBRE score optimization. The default procedure is the built-in BFGS method which is controlled by the list <code>bfgs</code> with the following elements: <code>steptol.bfgs</code> (default 1e-7) is the relative convergence tolerance; 
<code>gradtol.bfgs</code> (default 6.0554*1e-6) is a tolerance at which the gradient is considered to be close enougth to 0 to terminate the BFGS algorithm; 
<code>maxNstep</code> is a positive scalar which gives the maximum allowable step length (default 5);
<code>maxHalf</code> gives the maximum number of step halving in "backtracking" to permit before giving up(default 30);
<code>check.analytical</code> is logical whether the analytical gradient of GCV/UBRE should be checked numerically (default <code>FALSE</code>);
<code>del</code> is an increment for finite differences when checking analytical gradients (default 1e-4). 
</p>
<p>If outer iteration using <code>nlm</code> is used for fitting, then the control list <code>nlm</code> stores control arguments
for calls to routine <code>nlm</code>. As in <code>gam.control</code> the list has the following named elements: <code>ndigit</code> is the number
of significant digits in the GCV/UBRE score; <code>gradtol</code> is the tolerance used to judge convergence of the gradient of the GCV/UBRE score to zero 
(default 1e-6); <code>stepmax</code> is the maximum allowable log smoothing parameter step (default 2);
<code>steptol</code> is the minimum allowable step length (default 1e-4); 
<code>iterlim</code> is the maximum number of optimization steps allowed (default 200);
<code>check.analyticals</code> indicates whether the built in exact derivative calculations should be checked numerically (default <code>FALSE</code>).
Any of these which are not supplied and named in the list are set to their default values.
</p>
<p>Outer iteration using <code>optim</code> is controlled using list <code>optim</code>, which currently has one element: <code>factr</code>
which takes default value 1e7.
</p>


<h3>Author(s)</h3>

<p> Natalya Pya Arnqvist <a href="mailto:nat.pya@gmail.com">nat.pya@gmail.com</a>  based partly on <code>gam.control</code> by Simon Wood</p>


<h3>References</h3>

<p>Pya, N. and Wood, S.N. (2015) Shape constrained additive models. Statistics and Computing, 25(3), 543-559
</p>
<p>Pya, N. (2010) Additive models with shape constraints. PhD thesis. University of Bath. Department of Mathematical Sciences
</p>
<p>Wood, S.N. (2011) Fast stable restricted maximum likelihood 
and marginal likelihood estimation of semiparametric generalized linear 
models. Journal of the Royal Statistical Society (B) 73(1):3-36
</p>


<h3>See Also</h3>

<p><code>scam</code>, <code>scam.fit</code>, <code>gam.control</code> </p>


</div>