<div class="container">

<table style="width: 100%;"><tr>
<td>lmFilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unsupervised Spatial Filtering with Eigenvectors in Linear Regression Models</h2>

<h3>Description</h3>

<p>This function implements the eigenvector-based semiparametric
spatial filtering approach in a linear regression framework using ordinary least
squares (OLS). Eigenvectors are selected by an unsupervised stepwise regression
technique. Supported selection criteria are the minimization of residual
autocorrelation, maximization of model fit, significance of residual autocorrelation,
and the statistical significance of eigenvectors. Alternatively, all eigenvectors in
the candidate set can be included as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmFilter(
  y,
  x = NULL,
  W,
  objfn = "MI",
  MX = NULL,
  sig = 0.05,
  bonferroni = TRUE,
  positive = TRUE,
  ideal.setsize = FALSE,
  alpha = 0.25,
  tol = 0.1,
  boot.MI = NULL,
  na.rm = TRUE
)

## S3 method for class 'spfilter'
summary(object, EV = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector/ matrix of regressors (default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>spatial connectivity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objfn</code></td>
<td>
<p>the objective function to be used for eigenvector selection.
Possible criteria are: the maximization of the adjusted R-squared ('R2'),
minimization of residual autocorrelation ('MI'), significance level of
candidate eigenvectors ('p'), significance of residual spatial
autocorrelation ('pMI') or all eigenvectors in the candidate set ('all')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MX</code></td>
<td>
<p>covariates used to construct the projection matrix (default = NULL) - see
Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>significance level to be used for eigenvector selection
if <code>objfn = 'p'</code> or <code>objfn = 'pMI'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bonferroni</code></td>
<td>
<p>Bonferroni adjustment for the significance level
(TRUE/ FALSE) if <code>objfn = 'p'</code>. Set to FALSE if <code>objfn = 'pMI'</code> -
see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>
<p>restrict search to eigenvectors associated with positive
levels of spatial autocorrelation (TRUE/ FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ideal.setsize</code></td>
<td>
<p>if <code>positive = TRUE</code>, uses the formula proposed by
Chun et al. (2016) to determine the ideal size of the candidate set
(TRUE/ FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a value in (0,1] indicating the range of candidate eigenvectors
according to their associated level of spatial autocorrelation, see e.g.,
Griffith (2003)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>if <code>objfn = 'MI'</code>, determines the amount of remaining residual
autocorrelation at which the eigenvector selection terminates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.MI</code></td>
<td>
<p>number of iterations used to estimate the variance of Moran's I.
If <code>boot.MI = NULL</code> (default), analytical results will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>remove observations with missing values (TRUE/ FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>spfilter</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EV</code></td>
<td>
<p>display summary statistics for selected eigenvectors (TRUE/ FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <strong>W</strong> is not symmetric, it gets symmetrized by
1/2 * (<strong>W</strong> + <strong>W</strong>') before the decomposition.
</p>
<p>If covariates are supplied to <code>MX</code>, the function uses these regressors
to construct the following projection matrix:
</p>
<p><strong>M</strong> = <strong>I</strong> - <strong>X</strong> (<strong>X</strong>'<strong>X</strong>)^-1<strong>X</strong>'
</p>
<p>Eigenvectors from <strong>MWM</strong> using this specification of
<strong>M</strong> are not only mutually uncorrelated but also orthogonal
to the regressors specified in <code>MX</code>. Alternatively, if <code>MX = NULL</code>, the
projection matrix becomes <strong>M</strong> = <strong>I</strong> - <strong>11</strong>'/*n*,
where <strong>1</strong> is a vector of ones and *n* represents the number of
observations. Griffith and Tiefelsdorf (2007) show how the choice of the appropriate
<strong>M</strong> depends on the underlying process that generates the spatial
dependence.
</p>
<p>The Bonferroni correction is only possible if eigenvector selection is based on
the significance level of the eigenvectors (<code>objfn = 'p'</code>). It is set to
FALSE if eigenvectors are added to the model until the residuals exhibit no
significant level of spatial autocorrelation (<code>objfn = 'pMI'</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>spfilter</code> containing the following
information:
</p>

<dl>
<dt><code>estimates</code></dt>
<dd>
<p>summary statistics of the parameter estimates</p>
</dd>
<dt><code>varcovar</code></dt>
<dd>
<p>estimated variance-covariance matrix</p>
</dd>
<dt><code>EV</code></dt>
<dd>
<p>a matrix containing the summary statistics of selected eigenvectors</p>
</dd>
<dt><code>selvecs</code></dt>
<dd>
<p>vector/ matrix of selected eigenvectors</p>
</dd>
<dt><code>evMI</code></dt>
<dd>
<p>Moran coefficient of all eigenvectors</p>
</dd>
<dt><code>moran</code></dt>
<dd>
<p>residual autocorrelation in the initial and the
filtered model</p>
</dd>
<dt><code>fit</code></dt>
<dd>
<p>adjusted R-squared of the initial and the filtered model</p>
</dd>
<dt><code>residuals</code></dt>
<dd>
<p>initial and filtered model residuals</p>
</dd>
<dt><code>other</code></dt>
<dd>
<p>a list providing supplementary information:
</p>

<dl>
<dt><code>ncandidates</code></dt>
<dd>
<p>number of candidate eigenvectors considered</p>
</dd>
<dt><code>nev</code></dt>
<dd>
<p>number of selected eigenvectors</p>
</dd>
<dt><code>sel_id</code></dt>
<dd>
<p>ID of selected eigenvectors</p>
</dd>
<dt><code>sf</code></dt>
<dd>
<p>vector representing the spatial filter</p>
</dd>
<dt><code>sfMI</code></dt>
<dd>
<p>Moran coefficient of the spatial filter</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>type of the fitted regression model</p>
</dd>
<dt><code>dependence</code></dt>
<dd>
<p>filtered for positive or negative spatial dependence</p>
</dd>
<dt><code>objfn</code></dt>
<dd>
<p>selection criterion specified in the objective function of
the stepwise regression procedure</p>
</dd>
<dt><code>bonferroni</code></dt>
<dd>
<p>TRUE/ FALSE: Bonferroni-adjusted significance level
(if <code>objfn = 'p'</code>)</p>
</dd>
<dt><code>siglevel</code></dt>
<dd>
<p>if <code>objfn = 'p'</code> or <code>objfn = 'pMI'</code>: actual
(unadjusted/ adjusted) significance level</p>
</dd>
</dl>
</dd>
</dl>
<h3>References</h3>

<p>Tiefelsdorf, Michael and Daniel A. Griffith (2007):
Semiparametric filtering of spatial autocorrelation: the eigenvector
approach. Environment and Planning A: Economy and Space, 39 (5):
pp. 1193 - 1221.
</p>
<p>Griffith, Daniel A. (2003): Spatial Autocorrelation and Spatial Filtering:
Gaining Understanding Through Theory and Scientific Visualization.
Berlin/ Heidelberg, Springer.
</p>
<p>Chun, Yongwan, Daniel A. Griffith, Monghyeon Lee, Parmanand
Sinha (2016): Eigenvector selection with stepwise regression techniques
to construct eigenvector spatial filters. Journal of Geographical
Systems, 18, pp. 67 – 85.
</p>
<p>Le Gallo, Julie and Antonio Páez (2013): Using synthetic
variables in instrumental variable estimation of spatial series models.
Environment and Planning A: Economy and Space, 45 (9): pp. 2227 - 2242.
</p>
<p>Tiefelsdorf, Michael and Barry Boots (1995): The Exact Distribution
of Moran's I. Environment and Planning A: Economy and Space, 27 (6):
pp. 985 - 999.
</p>


<h3>See Also</h3>

<p><code>glmFilter</code>, <code>getEVs</code>, <code>MI.resid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(fakedata)
y &lt;- fakedataset$x1
X &lt;- cbind(fakedataset$x2, fakedataset$x3, fakedataset$x4)

res &lt;- lmFilter(y = y, x = X, W = W, objfn = 'MI', positive = FALSE)
print(res)
summary(res, EV = TRUE)

E &lt;- res$selvecs
(ols &lt;- coef(lm(y ~ X + E)))
coef(res)

</code></pre>


</div>