<div class="container">

<table style="width: 100%;"><tr>
<td>remap.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>map data to existing SOM</h2>

<h3>Description</h3>

<p>Assign new data to a pre-trained SOM
</p>


<h3>Usage</h3>

<pre><code class="language-R">remap.data(SOM, X, add = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SOM</code></td>
<td>
<p>a trained SOM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data set with the same number of features of the dataset used to train the SOM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>whether to append the new data to the ones used to train the SOM</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "kohonen" with the new data mapped
</p>


<h3>Author(s)</h3>

<p>Stefano Motta <a href="mailto:stefano.motta@unimib.it">stefano.motta@unimib.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Read example SOM data
som_model &lt;- readRDS(system.file("extdata", "SOM_HIFa.rds", package = "SOMMD"))
#Read a trajectory that was not used to train the som
trj_2 &lt;- read.trj(trjfile = system.file("extdata", "HIF2a-MD-2.xtc", package = "SOMMD"),
  topfile = system.file("extdata", "HIF2a.gro", package = "SOMMD"))
#Read reference structure file
gro &lt;- read.struct(system.file("extdata", "HIF2a.gro", package = "SOMMD"))
#Selection of the same intermolecular distances used to train the SOM
protein.sele &lt;- which(gro$atom$resid!="020")
ligand.sele &lt;- which(gro$atom$resid=="020")
heavy.atoms &lt;- which(startsWith(gro$atom$elety, "H")==FALSE)
sele.dists &lt;- native.cont(struct=gro, distance=0.6, mol.2=ligand.sele, atoms=heavy.atoms)
# Compute distances on new simulations (the same used for SOM training)
dist_2 &lt;- calc.distances(trj_2, mol.2=ligand.sele, sele=sele.dists, atoms=heavy.atoms)
# Map new data on the existing SOM
som_model_2 &lt;- remap.data(SOM=som_model, X=dist_2)
</code></pre>


</div>