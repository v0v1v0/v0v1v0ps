<div class="container">

<table style="width: 100%;"><tr>
<td>testSmallScales</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test Small Scales</h2>

<h3>Description</h3>

<p>For developers only; users should look at the function <code>improveSmallScales</code> in the CRAN package <code>clampSeg</code>. Implements the second step of <abbr><span class="acronym">HILDE</span></abbr> (<cite>Pein et al.</cite>, 2020, Section III-B) in which an initial fit is tested for missed short events.</p>


<h3>Usage</h3>

<pre><code class="language-R">.testSmallScales(data, family, lengths = NULL, q, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a numeric vector containing the observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a string specifying the assumed parametric family, currently <code>"LR"</code> and <code>"2Param"</code> are supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengths</code></td>
<td>
<p>an integer vector giving the set of lengths, i.e. only intervals of these lengths will be considered. By default (<code>NULL</code>) <code>1:20</code> will be used for parametric family <code>"LR"</code> and <code>1:65</code> will be used for parametric family <code>"2Param"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>either <code>NULL</code>, then the vector of critical values at level <code>alpha</code> will be computed from a Monte-Carlo simulation or a numeric vector giving the vector of critical values. Either <code>q</code> or <code>alpha</code> must be given. Otherwise, <code>alpha == 0.5</code> is chosen with a <code>warning</code>. This argument will be passed to <code>critVal</code> to obtain the needed critical values. Additional parameters for the computation of <code>q</code> can be specified in <code>...</code>, for more details see the documentation of <code>critVal</code>. Please note that by default the Monte-Carlo simulation will be saved in the workspace and on the file system, for more details see Section <cite>Storing of Monte-Carlo simulations</cite> below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a probability, i.e. a single numeric between 0 and 1, giving the significance level. Its choice is a trade-off between data fit and parsimony of the estimator. In other words, this argument balances the risks of missing change-points and detecting additional artefacts. For more details on this choice see (Frick et al., 2014, section 4) and (Pein et al., 2017, section 3.4). Either <code>q</code> or <code>alpha</code> must be given. Otherwise, <code>alpha == 0.5</code> is chosen with a <code>warning</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>there are two groups of further arguments:
</p>

<ol>
<li>
<p> further parameters of the parametric family,
</p>
</li>
<li>
<p> further parameters that will be passed to <code>critVal</code>. <code>critVal</code> will be called automatically with the number of observations <code>n = length(y)</code>, the arguments <code>family</code>, <code>intervalSystem</code>, <code>lengths</code>, <code>q</code> and <code>output</code> set. For these arguments no user interaction is required and possible, all other arguments of <code>critVal</code> can be passed additionally
</p>
</li>
</ol>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>list</code> with entries <code>jumps, addLeft, addRight, noDeconvolution, data, q</code>
</p>


<h3>References</h3>

<p>Pein, F., Bartsch, A., Steinem, C., and Munk, A. (2020) Heterogeneous idealization of ion channel recordings - Open channel noise. Submitted.
</p>


</div>