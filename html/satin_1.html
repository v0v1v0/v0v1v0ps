<div class="container">

<table style="width: 100%;"><tr>
<td>anomaly</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Anomalies of a satin object
</h2>

<h3>Description</h3>

<p>This function returns ocean data anomalies of a satin object.  Anomalies are calculated subtracting a conforming average satin object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anomaly(X, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a satin object obtained with <code>satinMean</code> for which anomalies are to be calculated. It must have identifying <code>labels</code> in the slot <code>attribs</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>also a satin object returned by <code>satinMean</code> with the means to be subtracted from <code>X</code>. It must have the same <code>labels</code> as <code>X</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The anomalies of a satin object represent, for every pixel, the values above and below a reference average.  A typical example can be monthly sea surface temperature anomalies for various years.  These are calculated subtracting the corresponding average month for the whole period (see example below).
</p>
<p>In principle, anomalies can be calculated for other ocean variables and time periods, but is up to the user to determine if that makes sense.  For example, let say that <code>Z</code> is a satin object with daily chlorophyll-a concentration data for several years.  In order to calculate quarterly anomalies, we will need first to obtain <code>X &lt;- satinMean(Z, "%Y-%qtr")</code> and <code>Y &lt;- satinMean(Z, "%qtr")</code>.
</p>


<h3>Value</h3>

<p>An object of  class <code>"satin"</code> (see <code>satin-class</code> for details) where the third dimension in the data array accomodates the calculated anomalies.  An extra element (<code>labels</code>) is included in the slot <code>attribs</code> to identify the time period of the anomalies.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>See Also</h3>

<p><code>satinMean</code> for calculating ocean data averages needed, and <code>climatology</code> for climatologies.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(interactive()){
# Calculate monthly sea surface temperature from weekly data.
# sst contains 240 weekly images for five years.

# This will produce the 12 average months for the five years
sst.m &lt;- satinMean(sst, by="%m") 

# and here we have 60 monthly periods, 12 for each one of the five years
sst.ym &lt;- satinMean(sst, by="%Y-%m") 

# monthly sea surface temperature anomalies
anom &lt;- anomaly(X = sst.ym, Y = sst.m)

# the dimensions of the data slots in sst.ym and anom are the same.
dim(sst.ym@data); dim(anom@data)

# plots of the first 24 months
lab &lt;- paste(month.name, rep(2014:2018, each=12))
for (m in 1:24){
  plot(anom, period = m, zlim=c(-10, 10), col.sep = 0.2, main = lab[m],
       scheme = c("blue", "cyan", "white", "yellow", "red"))
}
}
</code></pre>


</div>