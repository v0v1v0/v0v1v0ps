<div class="container">

<table style="width: 100%;"><tr>
<td>base_line</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Baseline correction using the baseline package#'</h2>

<h3>Description</h3>

<p>Estimates baselines for the spectra in the <code>obj</code> object, using the
algorithm named in 'method'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Spectra'
base_line(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object inheriting from class <code>Spectra</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the <code>baseline</code> function
in the baseline package. The main option would be <code>'method'</code>, to switch
between the several baseline methods presented in teh details section.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The baseline package implements various algorithms for the baseline
correction. The following methods are available:
</p>
 <ul>
<li>
<p> 'als': Baseline correction by 2nd derivative constrained
weighted regression </p>
</li>
<li>
<p> 'fillPeaks': An iterative algorithm using
suppression of baseline by means in local windows </p>
</li>
<li>
<p> 'irls' (default): An
algorithm with primary smoothing and repeated baseline suppressions and
regressions with 2nd derivative constraint </p>
</li>
<li>
<p> 'lowpass': An algorithm for
removing baselines based on Fast Fourier Transform filtering </p>
</li>
<li>
<p>'medianWindow': An implementation and extention of Mark S. Friedrichs'
model-free algorithm </p>
</li>
<li>
<p> 'modpolyfit': An implementation of Chad A. Lieber
and Anita Mahadevan-Jansen's algorithm for polynomial fiting </p>
</li>
<li>
<p>'peakDetection': A translation from Kevin R. Coombes et al.'s MATLAB code
for detecting peaks and removing baselines </p>
</li>
<li>
<p> 'rfbaseline': Wrapper for
Andreas F. Ruckstuhl, Matthew P. Jacobson, Robert W. Field, James A. Dodd's
algorithm based on LOWESS and weighted regression </p>
</li>
<li>
<p> 'rollingBall': Ideas
from Rolling Ball algorithm for X-ray spectra by M.A.Kneen and H.J.
Annegarn. Variable window width has been left out </p>
</li>
</ul>
<p>See baseline package documentation for more information and references.
</p>
<p>Additionally, the baseline package provides a nice GUI that helps choosing
the good baseline method and the good parametrisation. This GUI can be used
with the <code>inspectr</code> package. This is demonstrate in the Examples
section.
</p>


<h3>Value</h3>

<p>An object of the same class as <code>obj</code> with the continuum removed
from its spectra.
</p>


<h3>Author(s)</h3>

<p>Interface to the baseline package by Pierre Roudier
<a href="mailto:pierre.roudier@gmail.com">pierre.roudier@gmail.com</a>, baseline package authored by Kristian Hovde
Liland and Bjorn-Helge Mevik
</p>


<h3>References</h3>

<p>Kristian Hovde Liland and Bjorn-Helge Mevik (2011). baseline:
Baseline Correction of Spectra. R package version 1.0-1.
http://CRAN.R-project.org/package=baseline
</p>


<h3>See Also</h3>

<p><code>continuum_removal</code>, <code>snv</code>,
<code>rnv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Loading example data
data(australia)
spectra(australia) &lt;- sr_no ~ ... ~ 350:2500

# Subsample for demo purposes
australia &lt;- australia[1:10,]

# Correction using the default method (irls)
bl &lt;- base_line(australia)
plot(bl)

# Specifying another method for baseline calculation
bl2 &lt;- base_line(australia, method = "modpolyfit")
plot(bl2)

# Using the baseline package independently
# (useful to plot the corrections)
## Not run: 
library(baseline)
bl3 &lt;- baseline(spectra(australia), method = 'irls')
class(bl3) # this is a baseline object
plot(bl3)
# Affecting the baseline-corrected spectra back
# to the SpectraDataFrame object
spectra(australia) &lt;- getCorrected(bl3)
plot(australia)

# Using the baselineGUI with inspectr
baselineGUI(spectra(australia))
## When happy with a configuration, clik "Apply to all" and 
## save the results under a name, e.g. "corrected.spectra"
spectra(australia) &lt;- getCorrected(corrected.spectra)
plot(australia)

## End(Not run)

</code></pre>


</div>