<div class="container">

<table style="width: 100%;"><tr>
<td>soda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
SODA algorithm for variable and interaction selection
</h2>

<h3>Description</h3>

<p>SODA is a forward-backward variable and interaction selection algorithm under logistic regression model with second-order terms.  In the forward stage, a stepwise procedure is conducted to screen for important predictors with both main and interaction effects, and in the backward stage SODA remove insignificant terms so as to optimize the extended BIC (EBIC) criterion.  SODA is applicable for variable selection for logistic regression, linear/quadratic discriminant analysis and other discriminant analysis with generative model being in exponential family.
</p>


<h3>Usage</h3>

<pre><code class="language-R">soda(xx, yy, norm = F, debug = F, gam = 0, minF = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>

<p>The design matrix, of dimensions n * p, without an intercept. Each row is an observation vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yy</code></td>
<td>

<p>The response vector of dimension n * 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>

<p>Logical flag for xx variable quantile normalization to standard normal, prior to performing
SODA algorithm.  Default is norm=FALSE.  Quantile-normalization is suggested if the data contains
obvious outliers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>

<p>Logical flag for printing debug information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>

<p>Tuning paramter gamma in extended BIC criterion.
</p>
<p>EBIC for selected set S:
</p>
<p>EBIC = -2 * log-likelihood + |S| * log(n) + 2 * |S| * gamma * log(p)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minF</code></td>
<td>

<p>Minimum number of steps in forward interaction screening. Default is minF=3.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>EBIC</code></td>
<td>

<p>Trace of extended Bayesian information criterion (EBIC) score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>

<p>Trace of step type ("Forward (Main)", "Forward (Int)", "Backward").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var</code></td>
<td>

<p>Trace of selected variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Term</code></td>
<td>

<p>Trace of selected main and interaction terms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_EBIC</code></td>
<td>

<p>Final selected term set EBIC score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_Var</code></td>
<td>

<p>Final selected variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_Term</code></td>
<td>

<p>Final selected main and interaction terms.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yang Li, Jun S. Liu
</p>


<h3>References</h3>

<p>Li Y, Liu JS. (2017). Robust Variable and Interaction Selection for Logistic Regression and Multiple Index Models. <em>Technical Report</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># # (uncomment the code to run)
# # simulation study with 1 main effect and 2 interactions
# N = 250;
# p = 1000;
# r = 0.5;
# s = 1;
# H = abs(outer(1:p, 1:p, "-"))
# S = s * r^H;
# S[cbind(1:p, 1:p)] = S[cbind(1:p, 1:p)] * s

# xx = as.matrix(data.frame(mvrnorm(N, rep(0,p), S)));
# zz = 1 + xx[,1] - xx[,10]^2 + xx[,10]*xx[,20];
# yy = as.numeric(runif(N) &lt; exp(zz) / (1+exp(zz)))

# res_SODA = soda(xx, yy, gam=0.5);
# cv_SODA  = soda_trace_CV(xx, yy, res_SODA)
# cv_SODA

# # Michigan lung cancer dataset
# data(mich_lung);
# res_SODA = soda(mich_lung_xx, mich_lung_yy, gam=0.5);
# cv_SODA  = soda_trace_CV(mich_lung_xx, mich_lung_yy, res_SODA)
# cv_SODA
</code></pre>


</div>