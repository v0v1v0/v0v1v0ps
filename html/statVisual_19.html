<div class="container">

<table style="width: 100%;"><tr>
<td>PVCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Principal Variance Component Analysis (PVCA)
</h2>

<h3>Description</h3>

<p>Plot of weighted average proportion variance versus effects in 
principal variance component analysis (PVCA).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PVCA(
    clin_data, 
    clin_subjid, 
    gene_data, 
    pct_threshold = 0.8, 
    batch.factors, 
    theme_classic = FALSE, 
    addThemeFlag = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clin_data</code></td>
<td>

<p>A data frame containing clinical information, including  an id variable that corresponds to rownames of <code>gene_data</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clin_subjid</code></td>
<td>

<p>character. The column name of <code>clin_data</code> that indicates subject id. It corresponds to the rowname of <code>gene_data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_data</code></td>
<td>

<p>A data frame with genes as rows and subjects as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_threshold</code></td>
<td>

<p>numeric. The percentile value of the minimum amount of the variabilities that the selected principal components need to explain
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch.factors</code></td>
<td>

<p>character. A vector of factors that the mixed linear model will be fit on.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme_classic</code></td>
<td>

<p>logical. Use classic background without grids (default: TRUE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addThemeFlag</code></td>
<td>

<p>logical. Indicates if light blue background and white grid should be added to the figure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other input parameters for facet &amp; theme
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with 9 elements.
<code>data</code>, <code>layers</code>, <code>scales</code>, <code>mapping</code>,
<code>theme</code>, <code>coordinates</code>,
<code>facet</code>, <code>plot_env</code>, and <code>labels</code>.
</p>


<h3>Author(s)</h3>

<p>Wenfei Zhang &lt;Wenfei.Zhang@sanofi.com&gt;,
Weiliang Qiu &lt;Weiliang.Qiu@sanofi.com&gt;,
Xuan Lin &lt;Xuan.Lin@sanofi.com&gt;,
Donghui Zhang &lt;Donghui.Zhang@sanofi.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(pvca)


data(esSim)
print(esSim)

# expression data
dat = exprs(esSim)
print(dim(dat))
print(dat[1:2,])

# create a fake Batch variable
esSim$Batch=c(rep("A", 4), rep("B", 6), rep("C", 10))
# phenotype data
pDat = pData(esSim)
print(dim(pDat))
print(pDat[1:2,])


# feature data
fDat = fData(esSim)
print(dim(fDat))
print(fDat[1:2,])


statVisual(type = 'PVCA',
           clin_data = pData(esSim), 
           clin_subjid = "sid", 
           gene_data = exprs(esSim), 
           batch.factors = c("grp", "Batch"))

PVCA( 
     clin_data = pData(esSim), 
     clin_subjid = "sid", 
     gene_data = exprs(esSim), 
     batch.factors = c("grp", "Batch"))

</code></pre>


</div>