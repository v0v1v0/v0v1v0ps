<div class="container">

<table style="width: 100%;"><tr>
<td>Filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter frequency peaks from an array</h2>

<h3>Description</h3>

<p>Filter out the selected frequency from a time series. The filtering is 
performed by dichotomy, seeking for a frequency around the parameter 'freq'
and the phase that maximizes the signal to subtract from the time series.
The maximization of the signal to subtract relies on a minimization of the 
mean square differences between the time series ('data') and the cosine of 
the specified frequency and phase.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Filter(data, freq, time_dim = "ftime", ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or array of the data to be filtered. 
If it's a vector, it should be a time series. If it's an array,
the  dimensions must have at least 'time_dim'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>A number of the frequency to filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the dimension along which to 
compute the filtering. The default value is 'ftime'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector or array of the filtered data with the dimensions
the same as 'data'.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load sample data as in Load() example:
example(Load)
ensmod &lt;- MeanDims(sampleData$mod, 2)
spectrum &lt;- Spectrum(ensmod)

for (jsdate in 1:dim(spectrum)['sdate']) {
 for (jlen in 1:dim(spectrum)['ftime']) {
   if (spectrum[jlen, 2, 1, jsdate] &gt; spectrum[jlen, 3, 1, jsdate]) {
     ensmod[1, jsdate, ] &lt;- Filter(ensmod[1, jsdate, ], spectrum[jlen, 1, 1, jsdate])
   }
 }
}
 
PlotAno(InsertDim(ensmod, 2, 1), sdates = startDates)
 

</code></pre>


</div>