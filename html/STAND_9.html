<div class="container">

<table style="width: 100%;"><tr>
<td>icfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the Self-Consistent Estimate of Survival from
Interval Censored Data </h2>

<h3>Description</h3>

<p>This function calculates the self-consistent estimate of survival
for interval censored data.
(i.e., the nonparametric maximum likelihood estimate that generalizes
the Kaplan-Meier estimate to interval censored data).
The censoring is such that if the i<em>th</em> observation fails at <code class="reqn">x</code>,
we only observe that <code class="reqn">L[i] &lt; x \le R[i]</code>. Data may be entered with
"exact" values, i.e., <code class="reqn">L[i] = x = R[i]</code>. In that case the <code class="reqn">L[i]</code> is
changed internally to <code class="reqn">L[i]*</code> which is the next lower of any of the
observed endpoints (unless <code class="reqn">R[i] = 0</code> then an error results).
</p>


<h3>Usage</h3>

<pre><code class="language-R">icfit(L, R, initp = NA, minerror = 1e-06, maxcount = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p> a vector of the left endpoints of the interval </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p> a vector of the right endpoints of the interval </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initp</code></td>
<td>
<p> a vector with an initial estimate of the density
function. This vector should sum to 1 and have a
length equal to the number of unique values of <code>L</code>
and <code>R</code> combined. If <code>initp</code> = NA (default) then an initial
value is estimated from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minerror</code></td>
<td>
<p>The minimum error for convergence purposes. The
EM algorithm stops when <code>error</code> &lt; <code>minerror</code>, where
error is the maximum of the reduced gradients (see Gentleman
and Geyer, 1994). Default = 1e-06.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcount</code></td>
<td>
<p> the maximum number of iterations. Default is 10000.  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm is basically an EM-algorithm applied to
interval censored data (see Turnbull, 1976); however,
first there is a primary reduction (See Aragon and
Eberly, 1992). Convergence is defined when the maximum
reduced gradient is less than minerror, and the
Kuhn-Tucker conditions are approximately met,
otherwise a warning will result.  (see Gentleman and
Geyer, 1994). There may be other faster algorithms,
but they are more complicated (see Aragon and Eberly,
1992). The output for time is <code>sort(unique(c(0,L,R,Inf)))</code>
without the Inf. The output for <code>p</code> keeps the value
related to Inf so that <code>p</code> may be inserted into <code>initp</code>
for another run. The outputs for <code>p</code> and <code>surv</code> act as if
the jumps in the survival curve happen at the largest
of the possible times (see Gentleman and Geyer, 1994,
Table 2, for a more accurate way to present <code>p</code>).
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of Lagrange multipliers. If there are any
negative values of <code>u</code> the Kuhn-Tucker conditions for
convergence are not met. If this happens a warning
will result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>this is the maximum of the reduced gradients. If
convergence is correct then <code>error</code> &lt; <code>minerror</code>
and all values of <code>u</code> are nonnegative,
otherwise a warning results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>number of iterations of the self-consistent algorithm
(i.e., EM-algorithm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>a vector of times (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of probabilities, all except the last
values are associated with the time
vector above, i.e., <code class="reqn">p[i] = Prob (X = time[i])</code>.
The last value is associated with time==Inf.
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>a vector of survival values associated with
the time vector above, i.e.,
<code class="reqn">surv[i] = Prob (X &gt; time[i] )</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> The functions <code>icfit</code>, <code>icplot</code>,
and  <code>ictest</code> and documentation for these functions are from  Michael P. Fay.
You are free to distribute these functions to whomever is
interested. They come with no warranty however.
</p>


<h3>Author(s)</h3>

<p>Michael P. Fay</p>


<h3>References</h3>

<p>Aragon, J. and Eberly, D. (1992), "On Convergence of Convex
Minorant Algorithms for Distribution Estimation with
Interval-Censored Data," <em>Journal of Computational and Graphical
Statistics.</em> 1: 129-140.
</p>
<p>Gentleman, R. and Geyer, C. J. (1994), "Maximum Likelihood
for Interval Censored Data: Consistency and Computation,"
<em>Biometrika</em>, 81, 618-623.
</p>
<p>Turnbull, B. W. (1976), "The Empirical Distribution Function
with Arbitrarily Grouped, Censored and Truncated Data,"
<em>Journal of the Royal Statistical Society</em>, Series B,(Methodological), 38(3), 290-295.
</p>


<h3>See Also</h3>

 <p><code>plekm</code> , <code>qq.lnorm</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate and plot a Kaplan-Meier type curve for interval censored data.
# This is S(x) = 1 - F(x) and is the sample estimate of the probability
# of exceeding x.  The filmbadge data is used as an example.
data(filmbadge)
out &lt;- icfit(filmbadge$dlow,filmbadge$dhigh)
icplot(out$surv, out$time,XLAB="Dose",YLAB="Exceedance Probability")
</code></pre>


</div>