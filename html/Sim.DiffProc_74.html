<div class="container">

<table style="width: 100%;"><tr>
<td>snssde3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of 3-D Stochastic Differential Equation</h2>

<h3>Description</h3>

<p>The (S3) generic function <code>snssde3d</code> of simulation of solutions to 3-dim stochastic differential equations of Itô or Stratonovich type, with different methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snssde3d(N, ...)
## Default S3 method:
snssde3d(N = 1000, M =1, x0=c(0,0,0), t0 = 0, T = 1, Dt, 
   drift, diffusion, corr = NULL, alpha = 0.5, mu = 0.5, type = c("ito", "str"), 
   method = c("euler", "milstein","predcorr", "smilstein", "taylor", 
   "heun", "rk1", "rk2", "rk3"), ...)	
   
## S3 method for class 'snssde3d'
summary(object, at, digits=NULL,...)
## S3 method for class 'snssde3d'
time(x, ...)
## S3 method for class 'snssde3d'
mean(x, at, ...)
## S3 method for class 'snssde3d'
Median(x, at, ...)
## S3 method for class 'snssde3d'
Mode(x, at, ...)
## S3 method for class 'snssde3d'
quantile(x, at, ...)
## S3 method for class 'snssde3d'
kurtosis(x, at, ...)
## S3 method for class 'snssde3d'
skewness(x, at, ...)
## S3 method for class 'snssde3d'
min(x, at, ...)
## S3 method for class 'snssde3d'
max(x, at, ...)
## S3 method for class 'snssde3d'
moment(x, at, ...)
## S3 method for class 'snssde3d'
cv(x, at, ...)
## S3 method for class 'snssde3d'
bconfint(x, at, ...)

## S3 method for class 'snssde3d'
plot(x, ...)
## S3 method for class 'snssde3d'
lines(x, ...)
## S3 method for class 'snssde3d'
points(x, ...)
## S3 method for class 'snssde3d'
plot3D(x, display = c("persp","rgl"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of simulation steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>number of trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>initial value of the process <code class="reqn">X_{t}</code>, <code class="reqn">Y_{t}</code> and <code class="reqn">Z_{t}</code> at time <code>t0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>initial time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>ending time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code>missing</code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drift</code></td>
<td>
<p>drift coefficient: an <code>expression</code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffusion</code></td>
<td>
<p>diffusion coefficient: an <code>expression</code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>the correlation structure of three Brownian motions W1(t), W2(t) and W3(t); must be a real symmetric positive-definite square matrix of dimension 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, mu </code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>type="ito"</code> simulation sde of Itô type, else <code>type="str"</code> simulation sde of Stratonovich type; the default <code>type="ito"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>an object inheriting from class <code>"snssde3d"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solutions <code class="reqn">(X_{t},Y_{t},Z_{t})</code> at time <code>at</code>. The default <code>at = T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p><code>"persp"</code> perspective or <code>"rgl"</code> plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>snssde3d</code> returns a <code>mts</code> x of length <code>N+1</code>; i.e. solution of the 3-dim sde <code class="reqn">(X_{t},Y_{t},Z_{t})</code>
of Ito or Stratonovich types; If <code>Dt</code> is not specified, then the best discretization <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>. 
</p>
<p>The 3-dim Ito stochastic differential equation is:
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{2}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dZ(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{3}(t)</code>
</p>

<p>3-dim Stratonovich sde :
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{2}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dZ(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{3}(t)</code>
</p>

<p><code class="reqn">W_{1}(t), W_{2}(t), W_{3}(t)</code> three standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>In the correlation case, currently we can use only the Euler-Maruyama and Milstein scheme.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code>browseVignettes('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>snssde3d</code> returns an object inheriting from <code>class</code> <code>"snssde3d"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X, Y, Z </code></td>
<td>
<p>an invisible <code>mts</code> (3-dim) object (X(t),Y(t),Z(t)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>driftx, drifty, driftz </code></td>
<td>
<p>drift coefficient of X(t), Y(t) and Z(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffx, diffy, diffz </code></td>
<td>
<p>diffusion coefficient of X(t), Y(t) and Z(t).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>type of sde.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>the numerical method used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
"Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc". 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1–82. doi:10.18637/jss.v096.i02
</p>
<p>Friedman, A. (1975). 
<em>Stochastic differential equations and applications</em>.
Volume 1, ACADEMIC PRESS.
</p>
<p>Henderson, D. and Plaschko,P. (2006). 
<em>Stochastic differential equations in science and engineering</em>.
World Scientific.
</p>
<p>Allen, E. (2007).
<em>Modeling with Ito stochastic differential equations</em>. 
Springer-Verlag.
</p>
<p>Jedrzejewski, F. (2009). 
<em>Modeles aleatoires et physique probabiliste</em>. 
Springer-Verlag.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Kloeden, P.E, and Platen, E. (1989). 
A survey of numerical methods for stochastic differential equations. 
<em>Stochastic Hydrology and Hydraulics</em>, <b>3</b>, 155–178.
</p>
<p>Kloeden, P.E, and Platen, E. (1991a).
Relations between multiple ito and stratonovich integrals.
<em>Stochastic Analysis and Applications</em>, <b>9</b>(3), 311–321.
</p>
<p>Kloeden, P.E, and Platen, E. (1991b).
Stratonovich and ito stochastic taylor expansions. 
<em>Mathematische Nachrichten</em>, <b>151</b>, 33–50.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>
<p>Platen, E. (1980).
Weak convergence of approximations of ito integral equations. 
<em>Z Angew Math Mech</em>. <b>60</b>, 609–614.
</p>
<p>Platen, E. and Bruti-Liberati, N. (2010).
<em>Numerical Solution of Stochastic Differential Equations with Jumps in Finance.</em> 
Springer-Verlag, New York
</p>
<p>Saito, Y, and Mitsui, T. (1993).
Simulation of Stochastic Differential Equations. 
<em>The Annals of the Institute of Statistical Mathematics</em>, <b>3</b>, 419–432.
</p>


<h3>See Also</h3>

<p><code>snssde1d</code> and <code>snssde2d</code> for 1- and 2-dim sde.
</p>
<p><code>sde.sim</code> in package "sde". <code>simulate</code> in package "yuima". 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Example 1: Ito sde
## dX(t) = (2*(Y(t)&gt;0)-2*(Z(t)&lt;=0)) dt + 0.2 * dW1(t) 
## dY(t) = -2*Y(t) dt + 0.2 * dW2(t) 
## dZ(t) = -2*Z(t) dt + 0.2 * dW3(t)        
## W1(t), W2(t) and W3(t) three independent Brownian motion
set.seed(1234)

fx &lt;- expression(2*(y&gt;0)-2*(z&lt;=0) , -2*y, -2*z)
gx &lt;- rep(expression(0.2),3)

mod3d1 &lt;- snssde3d(x0=c(0,2,-2),drift=fx,diffusion=gx,M=500,Dt=0.003)
mod3d1
summary(mod3d1)
##
dev.new()
plot(mod3d1,type="n")
mx &lt;- apply(mod3d1$X,1,mean)
my &lt;- apply(mod3d1$Y,1,mean)
mz &lt;- apply(mod3d1$Z,1,mean)
lines(time(mod3d1),mx,col=1)
lines(time(mod3d1),my,col=2)
lines(time(mod3d1),mz,col=3)
legend("topright",c(expression(E(X[t])),expression(E(Y[t])),
 expression(E(Z[t]))),lty=1,inset = .01,col=c(1,2,3),cex=0.95)
##
dev.new()
plot3D(mod3d1,display="persp") ## in space (O,X,Y,Z)

## Example 2: Stratonovich sde 
## dX(t) = Y(t)* dt  + 0.2 o dW3(t)         
## dY(t) = (4*( 1-X(t)^2 )* Y(t) - X(t))* dt + 0.2 o dW2(t)
## dZ(t) = (4*( 1-X(t)^2 )* Z(t) - X(t))* dt + 0.2 o dW3(t)
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma

fx &lt;- expression( y , (4*( 1-x^2 )* y - x), (4*( 1-x^2 )* z - x))
gx &lt;- expression( 0.2 , 0.2, 0.2)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 

mod3d2 &lt;- snssde3d(drift=fx,diffusion=gx,N=10000,T=100,type="str",corr=Sigma)
mod3d2
##
dev.new()
plot(mod3d2,pos=2)
##
dev.new()
plot(mod3d2,union = FALSE)
##
dev.new()
plot3D(mod3d2,display="persp") ## in space (O,X,Y,Z)
</code></pre>


</div>