<div class="container">

<table style="width: 100%;"><tr>
<td>options</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>spaMM options settings</h2>

<h3>Description</h3>

<p>Allow the user to set and examine a variety of <em>options</em>
which affect operations of the spaMM package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spaMM.options(..., warn = TRUE)

spaMM.getOption(x)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a character string holding an option name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>Boolean: whether to warn if a previously undefined options is being defined (a protection against typos).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>A named value or a list of named values. The following values, with their defaults, 
are used in <code>spaMM</code>:
</p>

<dl>
<dt>
<code>LevenbergM=NULL</code>:</dt>
<dd>
<p>NULL or boolean. Whether to use a Levenberg-Marquardt-like algorithm (see Details) by default in most computations. But it is advised to use instead <code>control.HLfit=list(LevenbergM=...)</code> to control this on a case-by-case basis. The joint default behaviour is that Levenberg-Marquardt is used by default for binomial response data that takes only extreme values (in particular, for binary 0/1 response), and that for other models the fitting algorithm switches to it if divergence is suspected. <code>FALSE</code> inhibits its use; <code>TRUE</code> forces its use for all iterative least-square fits, except when 'confint()' is called.</p>
</dd>
<dt>
<code>example_maxtime=0.7</code>:</dt>
<dd>
<p>Used in the documentation and tests to control whether the longer examples should be run. 
The approximate running time of given examples on one author's laptop is compared to this value.</p>
</dd> 
<dt>
<code>optimizer1D="optimize"</code>:</dt>
<dd>
<p>Optimizer for one-dimensional optimization. If you want to control the initial value, you should select another optimizer.</p>
</dd>
<dt>
<code>optimizer=".safe_opt"</code>:</dt>
<dd>
<p>Optimizer for optimization in several dimensions. Use <code>optimizer="nloptr"</code> to call <code>nloptr</code> with method <code>"NLOPT_LN_BOBYQA"</code>; use <code>optimizer="bobyqa"</code> to call <code>bobyqa</code>; and use <code>optimizer="L-BFGS-B"</code> to call <code>optim</code> with method <code>"L-BFGS-B"</code>. The default <code>".safe_opt"</code> uses <code>nloptr</code> except in some cases where it expects or detects problems with it (the source code should be consulted for details). The optimizer can also be specified on a fit-by-fit basis as the value of <code>control$optimizer</code> in a <code>fitme</code> call, or as the value of <code>control.corrHLfit$optimizer</code>.
</p>
</dd>
<dt>
<code>nloptr</code>:</dt>
<dd>
<p>Default control values of <code>nloptr</code> calls.</p>
</dd> 
<dt>
<code>bobyqa</code>:</dt>
<dd>
<p>Default control values of <code>bobyqa</code> calls.</p>
</dd> 
<dt>
<code>maxLambda=1e10</code>:</dt>
<dd>
<p>The maximum value of lambda: higher fitted lambda values in HLfit are reduced to this. Since version 3.1.0, a much smaller lambda bound is deduced from <code>maxLambda</code> for COMPoisson and log-link response families.</p>
</dd>
<dt><code>regul_lev_lambda</code></dt>
<dd>
<p>Numeric (default: 1e-8); lambda leverages numerically 1 are replaced by 1- <code>regul_lev_lambda</code></p>
</dd>  
<dt>
<code>COMP_maxn</code>:</dt>
<dd>
<p>Number of terms for truncation of infinite sums that are evaluated in the fitting of <code>COMPoisson</code> models.</p>
</dd>
<dt>
<code>CMP_asympto_cond</code>:</dt>
<dd>
<p>Function returning the condition for applying an approximation or the COMPoisson response family, as detailed in <code>COMPoisson</code>.</p>
</dd> 
<dt>
<code>Gamma_min_y=1e-10</code>:</dt>
<dd>
<p>A minimum response value in Gamma-response models; used to check data, and in <code>simulate()</code> to correct the simulation results.</p>
</dd> 
<dt>
<code>QRmethod</code>:</dt>
<dd>
<p>A character string, to control whether dense matrix or sparse matrix methods are used in intensive matrix computations, overcoming the default choices made by <code>spaMM</code> in this respect. Possible values are <code>"dense"</code> and <code>"sparse"</code>.</p>
</dd>
<dt>
<code>matrix_method</code>:</dt>
<dd>
<p>A character string, to control the factorization of dense model matrices. Default value is <code>"def_sXaug_EigenDense_QRP_scaled"</code>. The source code should be consulted for further information.</p>
</dd>
<dt>
<code>Matrix_method</code>:</dt>
<dd>
<p>A character string, to control the factorization of sparse model matrices. Default value is <code>"def_sXaug_Matrix_QRP_CHM_scaled"</code>. The source code should be consulted for further information.</p>
</dd>
<dt>
<code>stylefns</code>:</dt>
<dd>
<p>Default colors of some screen output (notably that of some fitting functions when called with argument <code>verbose=c(TRACE=TRUE)</code>)</p>
</dd>
<dt>
<code>barstyle</code>:</dt>
<dd>
<p>Integer, or Boolean interpreted as Integer, or quoted expression evaluating to such types; controlling the display of some progress bars. If zero, no progress bar should be displayed; otherwise, a bar should be displayed. Further, when <code>txtProgressBar</code> is called, <code>barstyle</code> is passed as its <code>style</code> argument. Default is <code>quote(if(interactive()) {3L} else {0L})</code> (in a parallel setting, child processes may display the bar if the parent process is interactive).</p>
</dd>
</dl>
<p>and many other undocumented values for programming or development purposes. Additional options without default values can also be used (e.g., see <code>algebra</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>spaMM.options() provides an interface for changing maximal values of parameters of the Matérn correlation function. However, 
it is not recommended to change these values unless a spaMM message specifically suggests so.
</p>
<p>By default spaMM use Iteratively Reweighted Least Squares (IRLS) methods to estimate fixed-effect parameters (jointly with predictions of random effects). However, a Levenberg-Marquardt algorithm, as described by Nocedal &amp; Wright (1999, p. 266), is also implemented. The Levenberg-Marquardt algorithm is designed to optimize a single objective function with respect to all its parameters. It is thus well suited to compute a PQL fit, which is based on maximization of a single function, the h-likelihood. By contrast, in a fit of a mixed model by (RE)ML, one computes jointly fixed-effect estimates that maximizes marginal likelihood, and random-effect values that maximize h-likelihood given the fixed-effect estimates. The gradient of marginal likelihood with respect to fixed-effect coefficients does not generally vanishes at the solution (although it remains close to zero except in “difficult” cases with typically little information in the data). The Levenberg-Marquardt algorithm is not directly applicable in this case, as it may produce random-effect values that increases marginal likelihood rather than h-likelihood. The (RE)ML variant of the algorithm implemented in spaMM may therefore use additional nested h-likelihood-maximizing steps for correcting random-effect values. In version 3.1.0 this variant was revised for improved performance in difficult cases. 
</p>


<h3>Value</h3>

<p>For <code>spaMM.getOption</code>, the current value set for option <code>x</code>, or
<code>NULL</code> if the option is unset.
</p>
<p>For <code>spaMM.options()</code>, a list of all set options.  For
<code>spaMM.options(&lt;name&gt;)</code>, a list of length one containing the set value,
or <code>NULL</code> if it is unset.  For uses setting one or more options,
a list with the previous values of the options changed (returned
invisibly).
</p>


<h3>References</h3>

<p>Jorge Nocedal and Stephen J. Wright (1999) Numerical Optimization. Springer-Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  spaMM.options()
  spaMM.getOption("example_maxtime")
  ## Not run: 
  spaMM.options(maxLambda=1e06)
  
## End(Not run)
</code></pre>


</div>