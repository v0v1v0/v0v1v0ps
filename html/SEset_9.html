<div class="container">

<table style="width: 100%;"><tr>
<td>r2_distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Controllability Distribution in the SE-set</h2>

<h3>Description</h3>

<p>A function used to analyse the SEset results. For each member of the SE-set,
calculate the proportion of explained variance in each child node, when
predicted by all of its parent nodes
</p>


<h3>Usage</h3>

<pre><code class="language-R">r2_distribution(SEmatrix, cormat, names = NULL, indices = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SEmatrix</code></td>
<td>
<p>An <code class="reqn">n \times p</code> matrix containing the SEset, where each row
represents a <code class="reqn">p \times p</code> weights matrix stacked column-wise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cormat</code></td>
<td>
<p>A <code class="reqn">p \times p</code> matrix containing the marginal covariances or correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>optional character vector containing dimension names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>option vector of matrix indices, indicating which variables to compute the R^2 distribution for</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an <code class="reqn">n \times p</code> matrix of <code class="reqn">R^2</code> values.
For each member of the SE-set, this represents the variance explained in node <code class="reqn">X_i</code> by it's parents
in that weighted DAG.
</p>


<h3>References</h3>

<p>Ryan O, Bringmann LF, Schuurman NK (upcoming).
“The challenge of generating causal hypotheses using network models.”
<em>in preperation</em>.
Haslbeck JM, Waldorp LJ (2018).
“How well do network models predict observations? On the importance of predictability in network models.”
<em>Behavior Research Methods</em>, <b>50</b>(2), 853–861.
</p>


<h3>See Also</h3>

<p><code>network_to_SEset, find_parents</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># first estimate the precision matrix
data(riskcor)
omega &lt;- (qgraph::EBICglasso(riskcor, n = 69, returnAllResults = TRUE))$optwi
# qgraph method estimates a non-symmetric omega matrix, but uses forceSymmetric to create
# a symmetric matrix (see qgraph:::EBICglassoCore line 65)
omega &lt;- as.matrix(Matrix::forceSymmetric(omega)) # returns the precision matrix

SEmatrix &lt;- network_to_SEset(omega, digits=3)

r2set  &lt;- r2_distribution(SEmatrix, cormat = riskcor, names = NULL, indices = c(1,3,4,5,6))
# Plot results
apply(r2set,2,hist)
# For ggplot format, execute
# r2set &lt;- tidyr::gather(r2set)
</code></pre>


</div>