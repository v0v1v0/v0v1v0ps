<div class="container">

<table style="width: 100%;"><tr>
<td>semisccs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semiparametric self-controlled case series method

</h2>

<h3>Description</h3>

<p>The function fits the semiparametric self-controlled case series method where the age effect is left unspecified, as published in Farrington and Whitaker (2006). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">semisccs(formula, indiv, astart, aend, aevent, adrug, aedrug, expogrp = list(), 
            washout = list(), sameexpopar = list(), dataformat="stack", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>model formula. The dependent variable should always be "event" e.g. event ~ itp. There is no need to specify age in the model formula.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indiv</code></td>
<td>

<p>a vector of individual identifiers of cases. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astart</code></td>
<td>

<p>a vector of ages at which the observation periods start.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aend</code></td>
<td>

<p>a vector of ages at end of observation periods. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aevent</code></td>
<td>

<p>a vector of ages at event, an individual can experience multiple events. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adrug</code></td>
<td>

<p>a list of vectors of ages at start of exposures or a list of matrices if the exposures have multiple episodes (<code>dataformat</code> multi). Multiple exposures of the same type can be recorded as multiple rows (<code>dataformat</code> stack). One list item per exposure type.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aedrug</code></td>
<td>

<p>a list of vectors of ages at which exposure-related risk ends or a list of matrices if there are multiple episodes (repeat exposures in different columns) of the same exposure type. The dimension of each item of <code>aedrug</code> has to be equal to that of <code>adrug</code>, that is <code>aedrug</code> should be given for each exposure in <code>adrug</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expogrp</code></td>
<td>

<p>list of vectors of days to the start of exposure-related risk, counted from <code>adrug</code>. E.g if the risk period is [<code>adrug</code>+c,<code>aedrug</code>], use expogrp = c. For multiple exposure types <code>expogrp</code> is a list of length as list <code>adrug</code>. The DEFAULT is a list of zeros where the exposure-related risk periods are [<code>adrug</code>, <code>aedrug</code>].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>washout</code></td>
<td>

<p>list of vectors with days to start of washout periods counted from <code>aedrug</code>, the number of vectors in the list is equal to the number of exposure types or the length of <code>adrug</code>. The default is  NULL, no washout periods. The order of the list items corresponds to the order of exposures in <code>adrug</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sameexpopar</code></td>
<td>

<p>a vector of logical values. If TRUE (the default) no dose effect is assumed: the same exposure parameters are used for multiple doses of the same exposure type, presented in <code>dataformat</code> 'multi'. If FALSE different relative incidences are estimated for different doses of the same exposure type. The length of the vector is equal to the length list <code>adrug</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataformat</code></td>
<td>

<p>the way the input data are assembled. It accepts "multi" or "stack" (the default), where "multi" refers to a data assembled with one row representing one event and "stack" refers to a data frame where repeated exposures of the same type are stack in one column. In the "multi" dataformat different episodes of the same type are recorded as separate columns in the dataframe. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the input data. The data should be in 'stack' or 'multi' (see <code>dataformat</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the standard SCCS method both age and exposure effects are modelled using step functions. However, mis-specification of age groups in the standard SCCS may lead to bias in the exposure related relative incidence estimates. In the semiparametric SCCS no age groups are pre-specified. A parameter for each day an event occurred is fitted, which means that this method is only suitable for small to medium sized data sets. An alternative for large data sets is provided by <code>smoothagesccs</code>.
</p>


<h3>Value</h3>






<p>The function returns age and exposure related relative incidence estimates along with 95% confidence limits.
</p>


<h3>Author(s)</h3>

<p>Yonas Ghebremichael-Weldeselassie, Heather Whitaker, Paddy Farrington.
</p>


<h3>References</h3>


<p>Farrington, C. P., Whitaker, H. J. (2006). Semiparametric analysis of case series data. Applied Statistics, 55(5): 553â€“594.
</p>
<p>Farrington, P., Whitaker, H., and Ghebremichael-Weldeselassie, Y. (2018). Self-controlled Case Series Studies: A modelling Guide with R. Boca Raton: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code>standardsccs</code>, <code>smoothagesccs</code>, <code>smoothexposccs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1
# Semiparametric model for the ITP and MMR vaccine data

itp.mod1 &lt;- semisccs(event~mmr, indiv=case, astart=sta,
                      aend=end, aevent=itp, adrug=mmr, aedrug=mmr+42,
                      expogrp=c(0,15,29), data=itpdat)

itp.mod1


# Example 2
# Data on itp and mmr vaccine
# Sex and mmr interaction included 

itp.mod2 &lt;- semisccs(event~factor(sex)*mmr, indiv=case,
                      astart=sta, aend=end, aevent=itp, adrug=mmr,
                      aedrug=mmr+42, expogrp=c(0,15,29), data=itpdat)


itp.mod2

</code></pre>


</div>