<div class="container">

<table style="width: 100%;"><tr>
<td>Hess_rho</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hessian matrix of LCV and LAML wrt rho (log smoothing parameters)</h2>

<h3>Description</h3>

<p>Hessian matrix of LCV and LAML wrt rho (log smoothing parameters)
</p>


<h3>Usage</h3>

<pre><code class="language-R">Hess_rho(
  X_GL,
  X_GL_Q,
  GL_temp,
  haz_GL,
  deriv2_rho_beta,
  deriv_rho_beta,
  weights,
  tm,
  nb_smooth,
  p,
  n_legendre,
  deriv_rho_inv_Hess_beta,
  deriv_rho_Hess_unpen_beta,
  S_list,
  minus_eigen_inv_Hess_beta,
  temp_LAML,
  temp_LAML2,
  Vp,
  S_beta,
  beta,
  inverse_new_S,
  X,
  X_Q,
  temp_deriv3,
  temp_deriv4,
  event,
  expected,
  type,
  Ve,
  deriv_rho_Ve,
  mat_temp,
  deriv_mat_temp,
  eigen_mat_temp,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_GL</code></td>
<td>
<p>list of matrices (<code>length(X.GL)=n.legendre</code>) for Gauss-Legendre quadrature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_GL_Q</code></td>
<td>
<p>list of transformed matrices from X_GL in order to calculate only the diagonal of the fourth derivative of the likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GL_temp</code></td>
<td>
<p>list of vectors used to make intermediate calculations and save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haz_GL</code></td>
<td>
<p>list of all the matrix-vector multiplications X.GL[[i]]%*%beta for Gauss Legendre integration in order to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv2_rho_beta</code></td>
<td>
<p>second derivatives of beta wrt rho (implicit differentiation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_beta</code></td>
<td>
<p>firt derivatives of beta wrt rho (implicit differentiation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of weights for Gauss-Legendre integration on [-1;1]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tm</code></td>
<td>
<p>vector of midpoints times for Gauss-Legendre integration; tm = 0.5*(t1 - t0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_smooth</code></td>
<td>
<p>number of smoothing parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_legendre</code></td>
<td>
<p>number of nodes for Gauss-Legendre quadrature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_inv_Hess_beta</code></td>
<td>
<p>list of first derivatives of Vp wrt rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_Hess_unpen_beta</code></td>
<td>
<p>list of first derivatives of Hessian of unpenalized log likelihood wrt rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_list</code></td>
<td>
<p>List of all the rescaled penalty matrices multiplied by their associated smoothing parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus_eigen_inv_Hess_beta</code></td>
<td>
<p>vector of eigenvalues of Vp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_LAML</code></td>
<td>
<p>temporary matrix used when method="LAML" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_LAML2</code></td>
<td>
<p>temporary matrix used when method="LAML" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vp</code></td>
<td>
<p>Bayesian covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_beta</code></td>
<td>
<p>List such that S_beta[[i]]=S_list[[i]]%*%beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of estimated regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_new_S</code></td>
<td>
<p>inverse of the penalty matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_Q</code></td>
<td>
<p>transformed design matrix in order to calculate only the diagonal of the fourth derivative of the likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_deriv3</code></td>
<td>
<p>temporary matrix for third derivatives calculation when type="net" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_deriv4</code></td>
<td>
<p>temporary matrix for fourth derivatives calculation when type="net" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>vector of right-censoring indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>vector of expected hazard rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>"net" or "overall"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ve</code></td>
<td>
<p>frequentist covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_rho_Ve</code></td>
<td>
<p>list of derivatives of Ve wrt rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_temp</code></td>
<td>
<p>temporary matrix used when method="LCV" to save computation time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv_mat_temp</code></td>
<td>
<p>list of derivatives of mat_temp wrt rho</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_mat_temp</code></td>
<td>
<p>vector of eigenvalues of mat_temp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>criterion used to select the smoothing parameters. Should be "LAML" or "LCV"; default is "LAML"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Hessian matrix of LCV or LAML wrt rho
</p>


</div>