<div class="container">

<table style="width: 100%;"><tr>
<td>sumouter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Quadratic Forms</h2>

<h3>Description</h3>

<p>Calculates certain quadratic forms of matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  sumouter(x, w=NULL, y=x)
  quadform(x, v)
  bilinearform(x, v, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y</code></td>
<td>
<p>A matrix, whose rows are the vectors in the quadratic form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Optional vector of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Matrix determining the quadratic form</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrices <code>x</code> and <code>y</code> will be interpreted as
collections of row vectors. They must have the same number of rows.
The entries of <code>x</code> and <code>y</code> may be
numeric, integer, logical or complex values.
</p>
<p>The command <code>sumouter</code> computes the sum of the outer
products of corresponding row vectors, weighted by the entries of <code>w</code>:
</p>
<p style="text-align: center;"><code class="reqn">
    M = \sum_i w_i x_i^\top y_i
  </code>
</p>

<p>where <code class="reqn">x_i</code> is the <code>i</code>-th row of <code>x</code>
and <code class="reqn">y_i</code> is the <code>i</code>-th row of <code>y</code>
(after removing any rows containing <code>NA</code> or other non-finite
values).
If <code>w</code> is missing or <code>NULL</code>, the weights will be taken as 1.
The result is a <code class="reqn">p \times q</code> matrix where
<code>p = ncol(x)</code> and <code>q = ncol(y)</code>.
</p>
<p>The command <code>quadform</code> evaluates the quadratic form, defined by
the matrix <code>v</code>, for each of the row vectors of <code>x</code>:
</p>
<p style="text-align: center;"><code class="reqn"> 
    y_i = x_i V x_i^\top
  </code>
</p>

<p>The result <code>y</code> is a numeric vector of length <code>n</code> where
<code>n = nrow(x)</code>. If <code>x[i,]</code> contains <code>NA</code> or
other non-finite values, then <code>y[i] = NA</code>.
If <code>v</code> is missing or <code>NULL</code>,
it will be taken as the identity matrix, so
that the resulting values will be
</p>
<p style="text-align: center;"><code class="reqn"> 
    y_i = x_i x_i^\top
  </code>
</p>

<p>The command <code>bilinearform</code> evaluates the more general bilinear
form defined by the matrix <code>v</code>. Here <code>x</code> and <code>y</code> must
be matrices of the same dimensions. For each row vector of
<code>x</code> and corresponding row vector of <code>y</code>, the bilinear form is
</p>
<p style="text-align: center;"><code class="reqn"> 
   z_i = x_i V y_i^\top
  </code>
</p>

<p>The result <code>z</code> is a numeric vector of length <code>n</code> where
<code>n = nrow(x)</code>. If <code>x[i,]</code> or <code>y[i,]</code> contains <code>NA</code> or
other non-finite values, then <code>z[i] = NA</code>.
If <code>v</code> is missing or <code>NULL</code>,
it will be taken as the identity matrix, so
that the resulting values will be
</p>
<p style="text-align: center;"><code class="reqn"> 
    z_i = x_i y_i^\top
  </code>
</p>



<h3>Value</h3>

<p>A vector or matrix.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- matrix(1:12, 4, 3)
  dimnames(x) &lt;- list(c("Wilma", "Fred", "Barney", "Betty"), letters[1:3])
  x

  sumouter(x)

  w &lt;- 4:1
  sumouter(x, w)
  v &lt;- matrix(1, 3, 3)
  quadform(x, v)

  # should be the same as quadform(x, v)
  bilinearform(x, v, x)

  # See what happens with NA's
  x[3,2] &lt;- NA
  sumouter(x, w)
  quadform(x, v)
</code></pre>


</div>