<div class="container">

<table style="width: 100%;"><tr>
<td>eblupfh_cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EBLUPs based on a Fay-Herriot Model with Cluster Information.</h2>

<h3>Description</h3>

<p>This function gives the Empirical Best Linear Unbiased Prediction (EBLUP) or Empirical Best (EB) predictor based on a Fay-Herriot model with cluster information for non-sampled areas.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eblupfh_cluster(
  formula,
  data,
  vardir,
  cluster,
  method = "REML",
  maxiter = 100,
  precision = 1e-04,
  scale = FALSE,
  print_result = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class formula that contains a description of the model to be fitted. The variables included in the formula must be contained in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or a data frame extension (e.g. a tibble).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>vector or column names from data that contain variance sampling from the direct estimator for each area.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>vector or column name from data that contain cluster information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Fitting method can be chosen between 'ML' and 'REML'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm. Default is 100 iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>scaling auxiliary variable or not, default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_result</code></td>
<td>
<p>print coefficient or not, default value is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model has a form that is response ~ auxiliary variables.
where numeric type response variables can contain NA.
When the response variable contains NA it will be estimated with cluster information.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects <code>df_res</code> and <code>fit</code>:
<code>df_res</code> a data frame that contains the following columns: <br></p>

<ul>
<li> <p><code>y</code> variable response <br></p>
</li>
<li> <p><code>eblup</code> estimated results for each area <br></p>
</li>
<li> <p><code>random_effect</code> random effect for each area <br></p>
</li>
<li> <p><code>vardir</code> variance sampling from the direct estimator for each area <br></p>
</li>
<li> <p><code>mse</code> Mean Square Error <br></p>
</li>
<li> <p><code>cluster</code> cluster information for each area <br></p>
</li>
<li> <p><code>rse</code> Relative Standart Error (%) <br></p>
</li>
</ul>
<p><code>fit</code> a list containing the following objects: <br></p>

<ul>
<li> <p><code>estcoef</code> a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error),
the t-statistics in the third column (tvalue) and the p-values of the significance of each coefficient
in last column (pvalue) <br></p>
</li>
<li> <p><code>model_formula</code> model formula applied <br></p>
</li>
<li> <p><code>method</code> type of fitting method applied (<code>ML</code> or <code>REML</code>) <br></p>
</li>
<li> <p><code>random_effect_var</code> estimated random effect variance <br></p>
</li>
<li> <p><code>convergence</code> logical value that indicates the Fisher-scoring algorithm has converged or not <br></p>
</li>
<li> <p><code>n_iter</code> number of iterations performed by the Fisher-scoring algorithm. <br></p>
</li>
<li> <p><code>goodness</code> vector containing several goodness-of-fit measures: loglikehood, AIC, and BIC <br></p>
</li>
</ul>
<h3>References</h3>


<ol>
<li>
<p> Rao, J. N., &amp; Molina, I. (2015). Small area estimation. John Wiley &amp; Sons.
</p>
</li>
<li>
<p> Anisa, R., Kurnia, A., &amp; Indahwati, I. (2013). Cluster information of non-sampled area in small area estimation. E-Prosiding Internasional| Departemen Statistika FMIPA Universitas Padjadjaran, 1(1), 69-76.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">library(saens)

m1 &lt;- eblupfh_cluster(y ~ x1 + x2 + x3, data = mys, vardir = "var", cluster = "clust")
m1 &lt;- eblupfh_cluster(y ~ x1 + x2 + x3, data = mys, vardir = ~var, cluster = ~clust)
</code></pre>


</div>