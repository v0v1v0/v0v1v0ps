<div class="container">

<table style="width: 100%;"><tr>
<td>plot.owin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a Spatial Window</h2>

<h3>Description</h3>

<p>Plot a two-dimensional window of observation for a spatial point pattern
</p>


<h3>Usage</h3>

<pre><code class="language-R"> ## S3 method for class 'owin'
plot(x, main, add=FALSE, ..., box, edge=0.04,
                      type=c("w","n"), show.all=!add, 
                      hatch=FALSE,
                      hatchargs=list(), 
                      invert=FALSE, do.plot=TRUE,
                      claim.title.space=FALSE, use.polypath=TRUE,
                      adj.main=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The window to be plotted.
An object of class <code>owin</code>,
or data which can be converted into 
this format by <code>as.owin()</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>text to be displayed as a title above the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical flag: if <code>TRUE</code>, draw the window in 
the current plot; if <code>FALSE</code>, generate a new plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>extra arguments controlling the appearance of the plot.
These arguments are passed to <code>polygon</code>
if <code>x</code> is a
polygonal or rectangular window, or passed to
<code>image.default</code>
if <code>x</code> is a binary mask.
Some arguments are passed to <code>plot.default</code>.
See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>

<p>logical flag; if <code>TRUE</code>, plot the enclosing rectangular box
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>

<p>nonnegative number; the plotting region will have coordinate limits
that are <code>1 + edge</code>
times as large as the limits of the rectangular box
that encloses the pattern.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Type of plot: either <code>"w"</code> or <code>"n"</code>.
If <code>type="w"</code> (the default), the window is plotted.
If <code>type="n"</code> and <code>add=TRUE</code>, a new plot is initialised
and the coordinate system is established, but nothing is drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.all</code></td>
<td>

<p>Logical value indicating whether to plot everything
including the main title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatch</code></td>
<td>

<p>logical flag; if <code>TRUE</code>, the interior of the window will
be shaded by texture, such as a grid of parallel lines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatchargs</code></td>
<td>

<p>List of arguments passed to <code>add.texture</code>
to control the texture shading when <code>hatch=TRUE</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invert</code></td>
<td>

<p>logical flag; when the window is a binary pixel mask,
the mask colours will be inverted if <code>invert=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>

<p>Logical value indicating whether to actually perform the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>claim.title.space</code></td>
<td>

<p>Logical value indicating whether extra space for the main title
should be allocated when declaring the plot dimensions.
Should be set to <code>FALSE</code> under normal conditions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.polypath</code></td>
<td>

<p>Logical value indicating what graphics capabilities should be used
to draw a polygon filled with colour when the polygon has holes.
If <code>TRUE</code> (the default), then the polygon will be filled using
<code>polypath</code>, provided the graphics device
supports this function. If <code>FALSE</code>, the polygon will be
decomposed into simple closed polygons, which will be colour filled
using <code>polygon</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.main</code></td>
<td>

<p>Numeric value specifying the justification of the text in the main
title. Possible values are <code>adj.main=0.5</code> (the default)
specifying that the main title will be centred, <code>adj.main=0</code>
specifying left-justified text, and <code>adj.main=1</code> specifying
right-justified text.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the <code>plot</code> method for the class <code>owin</code>.
The action is to plot the boundary of the window on the current plot device,
using equal scales on the <code>x</code> and <code>y</code> axes.
</p>
<p>If the window <code>x</code> is of type <code>"rectangle"</code> or <code>"polygonal"</code>,
the boundary of the window is plotted as a polygon or series of polygons.
If <code>x</code> is of type <code>"mask"</code> 
the discrete raster approximation of the window is displayed
as a binary image (white inside the window, black outside).
</p>
<p>Graphical parameters controlling the display (e.g. setting the
colours) may be passed directly via the <code>...</code> arguments,
or indirectly reset using 
<code>spatstat.options</code>.
</p>
<p>If <code>add=FALSE</code> (the default), the plot is initialised
by calling the base graphics function
<code>plot.default</code>
to create the plot area. By default, coordinate axes
and axis labels are not plotted. To plot coordinate axes,
use the argument <code>axes=TRUE</code>; 
to plot axis labels, use the argument <code>ann=TRUE</code>
and then specify the labels with <code>xlab</code> and <code>ylab</code>;
see the help file for <code>plot.default</code> for
information on these arguments, and for additional
arguments controlling the appearance of the axes.
See the Examples also.
</p>
<p>When <code>x</code> is of type <code>"rectangle"</code> or <code>"polygonal"</code>, it
is plotted by the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>polygon</code>. To control the
appearance (colour, fill density, line density etc) of the polygon
plot, determine the required argument of <code>polygon</code> and
pass it through <code>...</code> For example, to paint the interior of the
polygon in red, use the argument <code>col="red"</code>. To draw the polygon
edges in green, use <code>border="green"</code>. To suppress the drawing of
polygon edges, use <code>border=NA</code>.
</p>
<p>When <code>x</code> is of type <code>"mask"</code>, it is plotted by
<code>image.default</code>. The appearance of the image plot
can be controlled by passing arguments to
<code>image.default</code>
through <code>...</code>. The default appearance can also be changed
by setting the parameter <code>par.binary</code> of
<code>spatstat.options</code>. 
</p>
<p>To zoom in (to view only a subset of the window at higher
magnification), use the graphical arguments
<code>xlim</code> and <code>ylim</code> to specify the desired rectangular field of
view. (The actual field of view may be larger, depending on the
graphics device).
</p>


<h3>Value</h3>

<p>none.
</p>


<h3>Notes on Filled Polygons with Holes</h3>

<p>The function <code>polygon</code> can only handle
polygons without holes. To plot polygons with holes in a solid colour,
we have implemented two workarounds.
</p>

<dl>
<dt>polypath function:</dt>
<dd>
<p>The first workaround uses
the relatively new function <code>polypath</code> which
<em>does</em> have the capability to handle polygons with holes.
However, not all graphics devices support
<code>polypath</code>.
The older devices <code>xfig</code> and <code>pictex</code>
do not support <code>polypath</code>.
On a Windows system, the default graphics device
</p>
<p><code>windows</code>
supports <code>polypath</code>.
On a Linux system, the default graphics device
<code>X11(type="Xlib")</code> does <em>not</em> support
<code>polypath</code>
but <code>X11(type="cairo")</code> does support it.
See <code>X11</code> and the section on Cairo below.
</p>
</dd>
<dt>polygon decomposition:</dt>
<dd>
<p>The other workaround involves decomposing the polygonal window
into pieces which do not have holes. This code is experimental
but works in all our test cases. If this code fails, a warning
will be issued, and the filled colours will not be plotted.
</p>
</dd>
</dl>
<h3>Cairo graphics on a Linux system</h3>

<p>Linux systems support
the graphics device <code>X11(type="cairo")</code> (see <code>X11</code>)
provided the external library <span class="pkg">cairo</span> is installed
on the computer. See <code>www.cairographics.org</code>
for instructions on obtaining and installing <span class="pkg">cairo</span>.  After having
installed <span class="pkg">cairo</span> one needs to re-install <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> from source so
that it has <span class="pkg">cairo</span> capabilites.  To check whether your
current installation of R has <span class="pkg">cairo</span> capabilities, type
(in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>) <code>capabilities()["cairo"]</code>.
The default type for <code>X11</code> is controlled by
<code>X11.options</code>.
You may find it convenient to
make <span class="pkg">cairo</span> the default, e.g. via your <code>.Rprofile</code>.
The magic incantation to put into <code>.Rprofile</code> is
</p>
<pre>
    setHook(packageEvent("graphics", "onLoad"),
    function(...) grDevices::X11.options(type="cairo"))
  </pre>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code>owin.object</code>,
<code>plot.ppp</code>,
<code>polygon</code>,
<code>image.default</code>,
<code>spatstat.options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # rectangular window
   plot(Window(nztrees))
   abline(v=148, lty=2)

  # polygonal window
  w &lt;- Window(demopat)
  plot(w)
  plot(w, col="red", border="green", lwd=2)
  plot(w, hatch=TRUE, lwd=2)

  # binary mask
  we &lt;- as.mask(w)
  plot(we)
  op &lt;- spatstat.options(par.binary=list(col=grey(c(0.5,1))))
  plot(we)
  spatstat.options(op)

  ## axis annotation
  plot(letterR, axes=TRUE, ann=TRUE, xlab="Easting", ylab="Northing")
  plot(letterR,            ann=TRUE, xlab="Declination", ylab="Right Ascension")
</code></pre>


</div>