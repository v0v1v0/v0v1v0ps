<div class="container">

<table style="width: 100%;"><tr>
<td>snsp2mp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-biomarker paired comparison in specificity (or sensitivity) at a
controlled sensitivity (or specificity) level</h2>

<h3>Description</h3>

<p>Point estimation and exact bootstrap-based inference</p>


<h3>Usage</h3>

<pre><code class="language-R">snsp2mp(mk, n1, s0, covp=0.95, fixsens=TRUE, lbmdis=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mk</code></td>
<td>
<p>Each of two rows corresponds to a biomarker, cases followed by
controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>case size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>controlled level of sensitivity or specificity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covp</code></td>
<td>
<p>norminal level of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixsens</code></td>
<td>
<p>fixing sensitivity if True, and specificity otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbmdis</code></td>
<td>
<p>larger value of a biomarker is more associated with cases if
True, and controls otherwise.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>diff[1]: difference of empirical point estimates;
hss[2]: difference of oscillating bias-corrected estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btmn</code></td>
<td>
<p>bootstrap mean of the empirical difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btva</code></td>
<td>
<p>exact bootstrap variance estimate for diff[1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btdist</code></td>
<td>
<p>exact bootstrap probability mass function at (-n0:n0)/n0 with n0
being the size of controls if sensitivity is controlled, or at (-n1:n1)/n1
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald_ci</code></td>
<td>
<p>wald_ci[1,]: Wald confidence interval using diff[1];
wald_ci[2,]: Wald confidence interval using diff[2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_ci</code></td>
<td>
<p>percentile confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scr_ci</code></td>
<td>
<p>scr_ci[1,]: score confidence interval using diff[1];
scr_ci[2,]: score confidence interval using diff[2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zq_ci</code></td>
<td>
<p>extension of the BTII in Zhou and Qin (2005,
Statistics in Medicine 24, pp 465–477).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y., Parakati, I., Patil, D. H.,and Sanda, M. G. (2023).
Interval estimation for operating characteristic of continuous biomarkers with
controlled sensitivity or specificity, <em>Statistica Sinica</em> 33, 193–214.</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate paired biomarkers X and Y, with correlation 0.5, 100 cases and 100 controls
n1 &lt;- 100
n0 &lt;- 100
rho &lt;- 0.5
set.seed(1234)
mkx &lt;- rnorm(n1+n0,0,1)
mky &lt;- rho*mkx + sqrt(1-rho^2)*rnorm(n1+n0,0,1)
mkx &lt;- mkx + c(rep(2,n1),rep(0,n0))
mky &lt;- mky + c(rep(1,n1),rep(0,n0))
mk &lt;- rbind(mkx,mky)

## compare specificity at controlled 0.95 sensitivity
est &lt;- snsp2mp(mk, 100, 0.95)
</code></pre>


</div>