<div class="container">

<table style="width: 100%;"><tr>
<td>choynowski</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choynowski probability map values</h2>

<h3>Description</h3>

<p>Calculates Choynowski probability map values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choynowski(n, x, row.names=NULL, tol = .Machine$double.eps^0.5, legacy=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a numeric vector of counts of cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of populations at risk</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p>row names passed through to output data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>accumulate values for observed counts &gt;= expected until value less than tol</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legacy</code></td>
<td>
<p>default FALSE using vectorised alternating side <code>ppois</code> version, if true use original version written from sources and iterating down to <code>tol</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pmap</code></td>
<td>
<p>Poisson probability map values: probablility of getting a more “extreme” count than actually observed, one-tailed with less than expected and more than expected folded together</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>logical: TRUE if observed count less than expected</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>


<h3>References</h3>

<p>Choynowski, M (1959) Maps based on probabilities, Journal of
the American Statistical Association, 54, 385–388; Cressie, N, Read,
TRC (1985), Do sudden infant deaths come in clusters? Statistics and
Decisions, Supplement Issue 2, 333–349; Bailey T, Gatrell A (1995)
Interactive Spatial Data Analysis, Harlow: Longman, pp. 300–303.</p>


<h3>See Also</h3>

<p><code>probmap</code></p>


<h3>Examples</h3>

<pre><code class="language-R">auckland &lt;- st_read(system.file("shapes/auckland.gpkg", package="spData")[1], quiet=TRUE)
auckland.nb &lt;- poly2nb(auckland)
res &lt;- choynowski(auckland$M77_85, 9*auckland$Und5_81)
resl &lt;- choynowski(auckland$M77_85, 9*auckland$Und5_81, legacy=TRUE)
all.equal(res, resl)
rt &lt;- sum(auckland$M77_85)/sum(9*auckland$Und5_81)
ch_ppois_pmap &lt;- numeric(length(auckland$Und5_81))
side &lt;- c("greater", "less")
for (i in seq(along=ch_ppois_pmap)) {
  ch_ppois_pmap[i] &lt;- poisson.test(auckland$M77_85[i], r=rt,
    T=(9*auckland$Und5_81[i]), alternative=side[(res$type[i]+1)])$p.value
}
all.equal(ch_ppois_pmap, res$pmap)
res1 &lt;- probmap(auckland$M77_85, 9*auckland$Und5_81)
table(abs(res$pmap - res1$pmap) &lt; 0.00001, res$type)
lt005 &lt;- (res$pmap &lt; 0.05) &amp; (res$type)
ge005 &lt;- (res$pmap &lt; 0.05) &amp; (!res$type)
cols &lt;- rep("nonsig", length(lt005))
cols[lt005] &lt;- "low"
cols[ge005] &lt;- "high"
auckland$cols &lt;- factor(cols)
plot(auckland[,"cols"], main="Probability map")
</code></pre>


</div>