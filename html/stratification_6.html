<div class="container">

<table style="width: 100%;"><tr>
<td>var.strata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Anticipated Variances and RRMSE from a Stratified Design for a Survey Variable Y </h2>

<h3>Description</h3>

<p><code>var.strata</code> calculates the anticipated means, variances and relative root mean squared error (RRMSE) obtained when applying a stratified design to a survey variable <code class="reqn">Y</code>. The variable <code class="reqn">Y</code> can be input or it can be defined from <code class="reqn">X</code> by a specified loglinear with mortality, heteroscedastic linear or random replacement model.<br></p>
<p><code>print.var.strata</code> prints a "var.strata" object, presenting the stratification information into a table. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">var.strata(strata, y = NULL, rh = strata$args$rh, rh.postcorr = 
           FALSE, model = c("none", "loglinear", "linear", "random"), 
           model.control = list())

## S3 method for class 'var.strata'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p> An object of class "strata", which represents a stratified design. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> A vector containing the values of the survey variable <code class="reqn">Y</code> for every unit of the population, respecting the order of the units in the <code>x</code>-vector used to create <code>strata</code>. The default is that <code class="reqn">Y</code> is not given. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rh</code></td>
<td>
<p> A vector giving the anticipated response rates in each of the <code>Ls</code> sampled strata. A single number can be given if the rates do not vary among strata. The default is to use the rates given in the <code>strata.bh</code> object. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rh.postcorr</code></td>
<td>
<p> A logical. If TRUE, a posterior correction for non-response is applied. This correction takes into account the non-response in the <code>strata.bh</code> object. It is only available when the stratified design <code>strata</code> had a target CV. The default is FALSE, i.e. no posterior correction is made (see <b>Details</b>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> A character string identifying the model used to describe the discrepancy between the stratification variable <code class="reqn">X</code> and the survey variable <code class="reqn">Y</code>. It can be <code>"none"</code> if one assumes <code class="reqn">Y=X</code>, <code>"loglinear"</code> for the loglinear model with mortality, <code>"linear"</code> for the heteroscedastic linear model or <code>"random"</code> for the random replacement model (see <code>stratification-package</code> for a description of these models). The default is <code>"none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.control</code></td>
<td>
<p> A list of model parameters (see <code>stratification-package</code>). The default values of the parameters correspond to the model <code class="reqn">Y=X</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object of class "var.strata" to print. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments affecting the print produced. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>POSTERIOR CORRECTION FOR NON-RESPONSE (with a target CV only<br></p>
<p>The optional posterior correction for non-response is done as follows. For each take-some stratum, <code class="reqn">n_h</code> is increased if the input <code>rh</code> is lower than the anticipated response rate in the <code>strata.bh</code> object, and <code class="reqn">n_h</code> is decreased if the input <code>rh</code> is higher than the anticipated response rate given when creating the <code>strata.bh</code> object. The modification of <code class="reqn">n_h</code> is done by multiplying it by <code>strata$args$rh/rh</code>.<br></p>
<p>The weakness of this posterior correction is that it cannot take into account non-response in a take-all stratum. In that stratum, <code class="reqn">n_h</code> cannot be increased since it is equal to <code class="reqn">N_h</code>. To correctly account for non-response in a take-all stratum, the boundary of the stratum has to be lowered. This is what the generalized Lavallee-Hidiroglou method does (<code>strata.LH</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nh </code></td>
<td>
<p>A vector of length <code>L</code> containing the integer sample sizes <code class="reqn">n_h</code>, i.e. the number of units to sample in each stratum. This vector can be different than <code>strata$nh</code> if <code>rh.postcorr=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n </code></td>
<td>
<p>The total sample size (<code>sum(nh)</code>). This number can be different than <code>strata$n</code> if <code>rh.postcorr=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nhnonint </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the non-integer values of the sample sizes. This vector can be different than <code>strata$nhnonint</code> if <code>rh.postcorr=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>certain.info </code></td>
<td>
<p>A vector giving statistics for the certainty stratum (see <code>stratification-package</code>). It contains <code>Nc</code>, the number of units chosen a priori to be in the sample, and <code>meanc</code>, the anticipated mean of <code class="reqn">Y</code> for these units. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated means of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varh </code></td>
<td>
<p>A vector of length <code class="reqn">L</code> containing the anticipated variances of <code class="reqn">Y</code> in each stratum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean </code></td>
<td>
<p>A numeric: the anticipated global mean value of <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSE </code></td>
<td>
<p>A numeric: the root mean squared error (or standard error if <code>strata$args$takenone</code>=0) of the anticipated global mean of <code class="reqn">Y</code>. This is defined as the squared root of: (<code>bias.penalty</code> x bias of the mean)^2 + variance of the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RRMSE </code></td>
<td>
<p>A numeric: the anticipated relative root mean squared error (or coefficient of variation if  <code>strata$args$takenone</code>=0) for the mean of <code class="reqn">Y</code>, i.e. <code>RMSE</code> divided by <code>mean</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relativebias </code></td>
<td>
<p>A numeric: the anticipated relative bias of the estimator, i.e. (<code>bias.penalty</code> x bias of the mean) divided by <code>mean</code>. If  <code>strata$args$takenone</code>=0, this numeric is zero. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propbiasMSE </code></td>
<td>
<p>A numeric: the proportion of the MSE attributable to the bias of the estimator, i.e. (<code>bias.penalty</code> x bias of the mean)^2 divided by the MSE of the <code>mean</code>. If  <code>strata$args$takenone</code>=0, this numeric is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The function call (object of class "call").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date </code></td>
<td>
<p>A character string that contains the system date and time when the function ended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args </code></td>
<td>
<p>A list of all the arguments input to the function or used by default. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Sophie Baillargeon <a href="mailto:Sophie.Baillargeon@mat.ulaval.ca">Sophie.Baillargeon@mat.ulaval.ca</a> and<br>
Louis-Paul Rivest <a href="mailto:Louis-Paul.Rivest@mat.ulaval.ca">Louis-Paul.Rivest@mat.ulaval.ca</a> </p>


<h3>References</h3>

<p>Baillargeon, S. and  Rivest L.-P. (2011). The construction of stratified designs in R with the package stratification. <em>Survey Methodology</em>, <b>37</b>(1), 53-65.
</p>


<h3>See Also</h3>

 <p><code>strata.bh</code>, <code>strata.cumrootf</code>, <code>strata.geo</code>, <code>strata.LH</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">nomodel &lt;- strata.LH(x=Sweden$REV84, CV=0.05, Ls=3, alloc=c(0.5,0,0.5),
          takeall=1, model="none")
# We can give a vector of the Y values for every unit in the population
var.strata(nomodel, y=Sweden$RMT85) 
# Or specify a model between X and Y
var.strata(nomodel, model="loglinear", model.control=list(beta=1.058355,
           sig2=0.06593083, ph=1))
# Compared to taking into account the model in the optimization
model &lt;- strata.LH(x=Sweden$REV84, CV=0.05, Ls=3, alloc=c(0.5,0,0.5),
         takeall=1, model="loglinear", model.control=list(beta=1.058355,
		     sig2=0.06593083, ph=1))
var.strata(model, y=Sweden$RMT85)

### Examples of posterior correction for non-response
LH &lt;- strata.LH(x=MRTS, CV=0.01, Ls=4, alloc=c(0.5,0,0.5), takeall=1)
LH
# Without non-response in the take-all strata
var.strata(LH, rh.postcorr=TRUE, rh=c(0.85,0.9,0.9,1))
strata.LH(x=MRTS, CV=0.01, Ls=4, alloc=c(0.5,0,0.5), takeall=1, rh=c(0.85,0.9,0.9,1))
# With non-response in the take-all strata
var.strata(LH, rh.postcorr=TRUE, rh=0.9)
strata.LH(x=MRTS, CV=0.01, Ls=4, alloc=c(0.5,0,0.5), takeall=1, rh=0.9)
</code></pre>


</div>