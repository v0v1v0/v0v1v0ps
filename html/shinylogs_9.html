<div class="container">

<table style="width: 100%;"><tr>
<td>track_usage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Track usage of a Shiny app</h2>

<h3>Description</h3>

<p>Used in Shiny <code>server</code> it will record all inputs and
output changes and errors that occurs through an output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">track_usage(
  storage_mode,
  what = c("session", "input", "output", "error"),
  exclude_input_regex = NULL,
  exclude_input_id = NULL,
  on_unload = FALSE,
  app_name = NULL,
  exclude_users = NULL,
  get_user = NULL,
  dependencies = TRUE,
  session = getDefaultReactiveDomain()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>storage_mode</code></td>
<td>
<p>Storage mode to use : <code>store_json()</code>, <code>store_rds()</code>,
<code>store_sqlite()</code> or <code>store_null()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>Elements to record between <code>"session"</code>, <code>"input"</code>, <code>"output"</code> and <code>"error"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_input_regex</code></td>
<td>
<p>Regular expression to exclude inputs from tracking.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_input_id</code></td>
<td>
<p>Vector of <code>inputId</code> to exclude from tracking.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>on_unload</code></td>
<td>
<p>Logical, save log when user close the browser window or tab,
if <code>TRUE</code> it prevent to create <code>shinylogs</code>
input during normal use of the application, there will
be created only on close, downside is that a popup will appear asking to close the page.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>app_name</code></td>
<td>
<p>Name of the app as a character string.
If <code>NULL</code>, <code>basename(getwd())</code> (name of the folder where application is located) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_users</code></td>
<td>
<p>Character vectors of user for whom it is not necessary to save the log.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_user</code></td>
<td>
<p>A <code>function</code> to get user name, it should
return a character and take one argument: the Shiny session.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependencies</code></td>
<td>
<p>Load dependencies in client, can be set to <code>FALSE</code> if <code>use_tracking()</code> has been called in UI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>session</code></td>
<td>
<p>The shiny session.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The following <code>input</code>s will be accessible in the server:
</p>

<ul>
<li> <p><strong>.shinylogs_lastInput</strong> : last <code>input</code> used by the user
</p>
</li>
<li> <p><strong>.shinylogs_input</strong> : all <code>input</code>s send from the browser to the server
</p>
</li>
<li> <p><strong>.shinylogs_error</strong> : all errors generated by <code>output</code>s elements
</p>
</li>
<li> <p><strong>.shinylogs_output</strong> : all <code>output</code>s generated from the server
</p>
</li>
<li> <p><strong>.shinylogs_browserData</strong> : information about the browser where application is displayed.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Save logs on disk ----------------------------------

if (interactive()) {

  # temporary directory for writing logs
  tmp &lt;- tempdir()

  # when app stop,
  # navigate to the directory containing logs
  onStop(function() {
    browseURL(url = tmp)
  })

  # Classic Iris clustering with Shiny
  ui &lt;- fluidPage(

    headerPanel("Iris k-means clustering"),

    sidebarLayout(
      sidebarPanel(
        selectInput(
          inputId = "xcol",
          label = "X Variable",
          choices = names(iris)
        ),
        selectInput(
          inputId = "ycol",
          label = "Y Variable",
          choices = names(iris),
          selected = names(iris)[[2]]
        ),
        numericInput(
          inputId = "clusters",
          label = "Cluster count",
          value = 3,
          min = 1,
          max = 9
        )
      ),
      mainPanel(
        plotOutput("plot1")
      )
    )
  )

  server &lt;- function(input, output, session) {

    # Store JSON with logs in the temp dir
    track_usage(
      storage_mode = store_json(path = tmp)
    )

    # classic server logic

    selectedData &lt;- reactive({
      iris[, c(input$xcol, input$ycol)]
    })

    clusters &lt;- reactive({
      kmeans(selectedData(), input$clusters)
    })

    output$plot1 &lt;- renderPlot({
      palette(c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3",
                "#FF7F00", "#FFFF33", "#A65628", "#F781BF", "#999999"))

      par(mar = c(5.1, 4.1, 0, 1))
      plot(selectedData(),
           col = clusters()$cluster,
           pch = 20, cex = 3)
      points(clusters()$centers, pch = 4, cex = 4, lwd = 4)
    })

  }

  shinyApp(ui, server)

}

# Logs in console &amp; special inputs ------------------------

if (interactive()) {
  library(shiny)
  library(shinylogs)

  ui &lt;- fluidPage(
    tags$h2("Record inputs change"),
    fluidRow(
      column(
        width = 3,
        selectInput(
          inputId = "select",
          label = "Select input",
          choices = month.name
        ),
        numericInput(
          inputId = "numeric",
          label = "Numerci input",
          value = 4,
          min = 0, max = 20
        ),
        checkboxGroupInput(
          inputId = "checkboxGroup",
          label = "Checkbox group input",
          choices = LETTERS[1:5]
        ),
        sliderInput(
          inputId = "slider",
          label = "Slider input",
          min = 0, max = 100, value = 50
        )
      ),
      column(
        width = 9,
        tags$b("Last input triggered:"),
        verbatimTextOutput(outputId = "last_input"),
        tags$b("All inputs:"),
        verbatimTextOutput(outputId = "all_inputs")
      )
    )
  )

  server &lt;- function(input, output, session) {

    # dont store on disk, just show in R console
    track_usage(
      storage_mode = store_null()
    )

    # last input triggered
    output$last_input &lt;- renderPrint({
      input$.shinylogs_lastInput
    })

    # all inputs that have changed
    output$all_inputs &lt;- renderPrint({
      input$.shinylogs_input
    })

  }

  shinyApp(ui, server)
}
</code></pre>


</div>