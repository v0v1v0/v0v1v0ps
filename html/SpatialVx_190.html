<div class="container">

<table style="width: 100%;"><tr>
<td>wavePurifyVx</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Apply Traditional Forecast Verification After Wavelet Denoising
</h2>

<h3>Description</h3>

<p>Apply traditional forecast verification after wavelet denoising ala Briggs and Levine (1997).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wavePurifyVx( x, climate = NULL, which.stats = c("bias",
    "ts", "ets", "pod", "far", "f", "hk", "mse"), thresholds = NULL,
    rule = "&gt;=", return.fields = FALSE, verbose = FALSE, ...)

## S3 method for class 'SpatialVx'
wavePurifyVx( x, climate = NULL, which.stats = c("bias",
    "ts", "ets", "pod", "far", "f", "hk", "mse"), thresholds = NULL,
    rule = "&gt;=", return.fields = FALSE, verbose = FALSE, ...,
    time.point = 1, obs = 1, model = 1 )

## Default S3 method:
wavePurifyVx( x, climate = NULL, which.stats = c("bias",
    "ts", "ets", "pod", "far", "f", "hk", "mse"), thresholds = NULL,
    rule = "&gt;=", return.fields = FALSE, verbose = FALSE, ...)

## S3 method for class 'wavePurifyVx'
plot(x, ..., col = c("gray", tim.colors(64)), zlim, mfrow,
                 horizontal = TRUE, type = c("stats", "fields") )

## S3 method for class 'wavePurifyVx'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>For <code>wavePurifyVx</code>, either a list object of class “SpatialVx”, or a list with only two components consisting of m by n matrices giving the verification and forecast fields, resp., or a list with named components “X” and “Xhat”.
</p>
<p>For <code>plot.wavePurifyVx</code>, list object as output from <code>wavePurifyVx</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> list object as returned by <code>wavePurifyVx</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>climate</code></td>
<td>
<p>m by n matrix defining a climatology field.  If not NULL, then the anamoly correlation coefficient will be applied to the wavelet denoised fields.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.stats</code></td>
<td>

<p>character describing which traditional verification statistics to calculate on the wavelet denoised fields.  This is the argument passed to the argument of the same name in <code>vxstats</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>

<p>Either a numeric vector or a list with components named “X” and “Xhat” giving thresholds  used to define events for all of the verification statistics except MSE.  However, if supplied or other statistics are to be computed, then MSE will be calculated for the fields at values &gt;= <code>thresholds</code>.  If only MSE is to be computed, and <code>thresholds</code> is NULL, then no thresholding is applied.  If NULL, and any of the statistics besides MSE are to be calculated, then default values of the 0, 0.1, 0.25, 0.33, 0.5, 0.66, 0.75, 0.9 and 0.95 quantiles (for each field, so that the thresholds may differ between fields) are used.  The same holds for anamoly correlation coefficient.  The exception is that if the argument is null and <code>x</code> is a “SpatialVx” class object, then the thresholds are taken to be those associated with the “thresholds” attribute of this object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>character string giving the threshold rule to be applied.  See help file for <code>thresholder</code> function for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.fields</code></td>
<td>
<p>logical, should the denoised fields be returned (e.g., for subsequent plotting)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.point</code></td>
<td>
<p>numeric or character indicating which time point from the “SpatialVx” verification set to select for analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs, model</code></td>
<td>
<p>numeric indicating which observation/forecast model to select for the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, should progress information (including total run time) be printed to the screen?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, zlim, horizontal</code></td>
<td>
<p>optional arguments to <code>image</code>, and/or <span class="pkg">fields</span> functions <code>poly.image</code> and <code>image.plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>
<p> optionally set the plotting panel via <code>mfrow</code> (see help file for <code>par</code>).  Default sets a rgion that will show all plots in one set of panels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string stating whether to plot the resulting statistics or the original fields along with their de-noised counter parts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For <code>wavePurifyVx</code>, optional additional arguments to <code>denoise.dwt.2d</code> (or <code>denoise.modwt.2d</code>) from package <span class="pkg">waveslim</span>.  Note that if the argument <code>J</code> is not passed, then it will be determined as J=log2(min(m,n)).  If the fields are dyadic, then the usual DWT is used, otherwise the maximal overlap DWT is used instead.  For the plot and summary method functions, these are not used.  Also passed to <code>poly.image</code> and <code>image.plot</code> for plotting routine for “fields” type plots when the “maps” attribute from the “SpatialVx” object is TRUE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the fields are dyadic, then the <code>denoise.dwt.2d</code> function from package <span class="pkg">waveslim</span> is applied to each field before calculating the chosen verification statistics.  Otherwise <code>denoise.modwt.2d</code> from the same package is used.  The result is that high-frequency fluctuations in the two fields are removed before calculating verification statistics so that the resulting statistics are less susceptible to small-scale errors (see Briggs and Levine, 1997).  See Percival and Guttorp (1994) and Lindsay et al. (1996) for more on this type of wavelet analysis including maximal overlap DWT.
</p>


<h3>Value</h3>

<p>A list object of class “wavePurifyVx” is returned with possible components (depending on what is supplied in the arguments, etc.):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X2,Y2</code></td>
<td>
<p>m by n matrices of the denoised verification and forecast fields, resp. (only if return.fields is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds </code></td>
<td>
<p>q by 2 matrix of thresholds applied to the forecast (first column) and verification (second column) fields, resp.  If climate is not NULL, then the same thresholds for the forecast field are applied to the climatology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qs </code></td>
<td>
<p>If object and thresholds are NULL, and statistics other than MSE or ACC are desired, then this will be created along with the thresholds, and is just a character version of the trhesholds. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>list object containing all the optional arguments passed into ..., and the value of J used (e.g., even if not passed into ...).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias,ts,ets,pod,far,f,hk,mse,acc</code></td>
<td>
<p>numeric vectors of length q (i.e., the number of thresholds) giving the associated verification statistics.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eric Gilleland
</p>


<h3>References</h3>

<p>Briggs, W. M. and Levine, R. A. (1997) Wavelets and field forecast verification. <em>Mon. Wea. Rev.</em>, <b>125</b>, 1329–1341.
</p>
<p>Lindsay, R. W., Percival, D. B. and Rothrock, D. A. (1996)  The discrete wavelet transform and the scale analysis of the surface properties of sea ice.  <em>IEEE Transactions on Geoscience and Remote Sensing</em>, <b>34</b> (3), 771–787.
</p>
<p>Percival, D. B. and Guttorp, P. (1994)  Long-memory processes, the Allan variance and wavelets.  In <em>Wavelets in Geophysics</em>, Foufoula-Georgiou, E. and Kumar, P., Eds., New York: Academic, pp. 325–343.
</p>


<h3>See Also</h3>

<p><code>denoise.dwt.2d</code>, <code>denoise.modwt.2d</code>, <code>waverify2d</code>, <code>mowaverify2d</code>, <code>waveIS</code>, <code>vxstats</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">grid &lt;- list( x= seq( 0,5,,100), y= seq(0,5,,100))
obj &lt;- Exp.image.cov( grid=grid, theta=.5, setup=TRUE)
look &lt;- sim.rf( obj)
look[ look &lt; 0] &lt;- 0
look &lt;- zapsmall( look)
     
look2 &lt;- sim.rf( obj)
look2[ look2 &lt; 0] &lt;- 0
look2 &lt;- zapsmall( look2)

look3 &lt;- sim.rf( obj) 
look3[ look3 &lt; 0] &lt;- 0 
look3 &lt;- zapsmall( look3)

hold &lt;- make.SpatialVx( look, look2, thresholds = c(0.1, 1),
            field.type = "random", units = "units")

plot( hold )

res &lt;- wavePurifyVx( hold, climate = look3, return.fields = TRUE, verbose = TRUE )

plot(res, type="fields")
plot(res, type="stats")

summary(res)

## Not run: 
data( "UKobs6" )
data( "UKfcst6" )
data( "UKloc" )

hold &lt;- surrogater2d( UKobs6, n=1, maxiter=50, verbose=TRUE)
hold &lt;- matrix(hold, 256, 256)

UKobj &lt;- make.SpatialVx( UKobs6, UKfcst6, thresholds = c(0.1, 2, 5, 10),
    loc = UKloc, map = TRUE, field.type = "Rainfall", units = "mm/h",
    data.name = "Nimrod", obs.name = "obs 6", model.name = "fcst 6" )

plot(UKobj ) 

look &lt;- wavePurifyVx( object = UKobj, climate = hold,
    return.fields = TRUE, verbose = TRUE)

plot(look, type = "fields" )
plot(look, type = "stats" )

summary( look )


## End(Not run)

</code></pre>


</div>