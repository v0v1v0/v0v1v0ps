<div class="container">

<table style="width: 100%;"><tr>
<td>simBinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Synthetic point-referenced binomial count data</h2>

<h3>Description</h3>

<p>Dataset of size 500, with a binomial response variable indexed
by spatial coordinates sampled uniformly from the unit square. The model
includes one covariate and spatial random effects induced by a Matérn
covariogram. The number of trials at each location is sampled from a Poisson
distribution with mean 20.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(simBinom)
</code></pre>


<h3>Format</h3>

<p>a <code>data.frame</code> object.
</p>

<dl>
<dt><code style="white-space: pre;">⁠s1, s2⁠</code></dt>
<dd>
<p>2-D coordinates; latitude and longitude.</p>
</dd>
<dt><code>x1</code></dt>
<dd>
<p>a covariate sampled from the standard normal distribution.</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>response vector.</p>
</dd>
<dt><code>n_trials</code></dt>
<dd>
<p>Number of trials at that location.</p>
</dd>
<dt><code>z_true</code></dt>
<dd>
<p>true spatial random effects that generated the data.</p>
</dd>
</dl>
<h3>Details</h3>

<p>With <code class="reqn">n = 500</code>, the count data is simulated using
</p>
<p style="text-align: center;"><code class="reqn">
\begin{aligned}
y(s_i) &amp;\sim \mathrm{Binomial}(m(s_i), \pi(s_i)), i = 1, \ldots, n,\\
\pi(s_i) &amp;= \mathrm{ilogit}(x(s_i)^\top \beta + z(s_i))
\end{aligned}
</code>
</p>

<p>where the function <code class="reqn">\mathrm{ilogit}</code> refers to the inverse-logit
function, the number of trials <code class="reqn">m(s_i)</code> is sampled from a Poisson
distribution with mean 20, the spatial effects <code class="reqn">z \sim N(0, \sigma^2 R)</code>
with <code class="reqn">R</code> being a <code class="reqn">n \times n</code> correlation matrix given by the Matérn
covariogram
</p>
<p style="text-align: center;"><code class="reqn">
R(s, s') = \frac{(\phi |s-s'|)^\nu}{\Gamma(\nu) 2^{\nu - 1}}
K_\nu(\phi |s-s'|),
</code>
</p>

<p>where <code class="reqn">\phi</code> is the spatial decay parameter and <code class="reqn">\nu</code> the spatial
smoothness parameter. We have sampled the data with
<code class="reqn">\beta = (0.5, -0.5)</code>, <code class="reqn">\phi = 3</code>, <code class="reqn">\nu = 0.5</code>, and
<code class="reqn">\sigma^2 = 0.4</code>. This data can be generated with the code as given in
the example below.
</p>


<h3>Author(s)</h3>

<p>Soumyakanti Pan <a href="mailto:span18@ucla.edu">span18@ucla.edu</a>,<br>
Sudipto Banerjee <a href="mailto:sudipto@ucla.edu">sudipto@ucla.edu</a>
</p>


<h3>See Also</h3>

<p>simGaussian, simPoisson, simBinary
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1729)
n &lt;- 500
beta &lt;- c(0.5, -0.5)
phi0 &lt;- 3
nu0 &lt;- 0.5
spParams &lt;- c(phi0, nu0)
spvar &lt;- 0.4
sim1 &lt;- sim_spData(n = n, beta = beta, cor.fn = "matern",
                   spParams = spParams, spvar = spvar, deltasq = deltasq,
                   n_binom = rpois(n, 20),
                   family = "binomial")
plot1 &lt;- surfaceplot(sim1, coords_name = c("s1", "s2"), var_name = "z_true")

library(ggplot2)
plot2 &lt;- ggplot(sim1, aes(x = s1, y = s2)) +
  geom_point(aes(color = y), alpha = 0.75) +
  scale_color_distiller(palette = "RdYlGn", direction = -1,
                        label = function(x) sprintf("%.0f", x)) +
  guides(alpha = 'none') +
  theme_bw() +
  theme(axis.ticks = element_line(linewidth = 0.25),
        panel.background = element_blank(),
        panel.grid = element_blank(),
        legend.title = element_text(size = 10, hjust = 0.25),
        legend.box.just = "center", aspect.ratio = 1)
</code></pre>


</div>