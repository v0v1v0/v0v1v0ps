<div class="container">

<table style="width: 100%;"><tr>
<td>quench</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Simulation Adjuster Via Quenching Algorithm</h2>

<h3>Description</h3>

<p>The function adjusts a simulated random field generated by the <code>sim</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quench(x, data, coords, sim, GA = FALSE, optype = c("param", 
       "fullprobs", "semiprobs", "coordprobs"), max.it = 1000,
       knn = 12)</code></pre>


<h3>Arguments</h3>









<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>multi_tpfit</code>, typically with the output of the function <code>multi_tpfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a categorical data vector of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times d</code> matrix where each row denotes the <code class="reqn">d</code>-D coordinates of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>an object of the class <code>spsim</code>, it is usually the output of the function <code>sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GA</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, the function performs the Genetic Algorithm instead of the Simulated Annealing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optype</code></td>
<td>
<p>a character which denotes the objective function to compute when the optimization is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.it</code></td>
<td>
<p>a numerical value which specifies the maximum number of iterations to stop the optimization algorithm. For proper results, it should be a multiple of the number of simulation points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>an integer value which specifies the number of k-nearest neighbours for each simulation point. An optimal number is between 4 and 12. If <code>NULL</code> all observations are considered (just for very small dataset!!). It is <code>12</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method perform a simulated annealing or a genetic algorithm to modify the simulation results, in order to reduce artifacts effects. In practice, each simulated configuration is adjusted to reach a pattern similar to the observed sample data. There are several objective functions for this purpose, by setting <code>optype</code> equal to <code>"param"</code> the optimization is performed through parametric methods. The alternatives <code>"fullprobs"</code> and <code>"semiprobs"</code> are based on transition probabilities computed among simulation points, while the option <code>"coordprobs"</code> is based on transition probabilities calculated among observation and simulation points.
</p>
<p>This procedure should be executed by setting <code>max.it</code> equal at least to the simulation grid size, or its multiples.
</p>


<h3>Value</h3>

<p>A data frame containing the simulation grid, the simulated random field, predicted values and the approximated probabilities.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>Carle, S. F., Fogg, G. E. (1996) Transition Probability-Based Indicator Geostatistics. <em>Mathematical Geosciences</em>, <b>28</b>(4), 453-476.
</p>
<p>Carle, S. F. (1999) T-PROGS: Transition Probability Geostatistical Software. University of California, Davis.
</p>
<p>Sartore, L. (2010) Geostatistical models for 3-D data. M.Phil. thesis, Ca' Foscari University of Venice.
</p>

<p>Weise, T. (2009) <em>Global Optimization Algorithms - Theory and Application</em>. <a href="https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application">https://archive.org/details/Thomas_Weise__Global_Optimization_Algorithms_Theory_and_Application</a>.</p>


<h3>See Also</h3>

<p><code>sim_ck</code>, <code>sim_ik</code>, <code>sim_mcs</code>, <code>sim_path</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ACM)

# Model parameters estimation for the
# multinomial categorical simulation
x &lt;- multi_tpfit(ACM$MAT5, ACM[, 1:3])

# Generate the simulation grid
mygrid &lt;- list()
mygrid$X &lt;- seq(min(ACM$X), max(ACM$X), length = 20)
mygrid$Y &lt;- seq(min(ACM$Y), max(ACM$Y), length = 20)
mygrid$Z &lt;- -40 * 0:9 - 1
mygrid &lt;- as.matrix(expand.grid(mygrid$X, mygrid$Y, mygrid$Z))

# Simulate the random field through
# Ordinary Indicator Kriging algorithm
myOIKSim &lt;- sim_ik(x, ACM$MAT5, ACM[, 1:3], mygrid)
 
# Perform the quenching algorithm 
# to adjust simulation
quench(x, ACM$MAT5, ACM[, 1:3], myOIKSim, optype = "coordprobs",
       max.it = 2, knn = 12) 
</code></pre>


</div>